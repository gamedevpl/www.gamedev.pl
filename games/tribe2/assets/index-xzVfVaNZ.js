var BT=Object.defineProperty;var LT=(e,t,r)=>t in e?BT(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r;var Oe=(e,t,r)=>LT(e,typeof t!="symbol"?t+"":t,r);(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const l of document.querySelectorAll('link[rel="modulepreload"]'))o(l);new MutationObserver(l=>{for(const s of l)if(s.type==="childList")for(const u of s.addedNodes)u.tagName==="LINK"&&u.rel==="modulepreload"&&o(u)}).observe(document,{childList:!0,subtree:!0});function r(l){const s={};return l.integrity&&(s.integrity=l.integrity),l.referrerPolicy&&(s.referrerPolicy=l.referrerPolicy),l.crossOrigin==="use-credentials"?s.credentials="include":l.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function o(l){if(l.ep)return;l.ep=!0;const s=r(l);fetch(l.href,s)}})();function W0(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var Sd={exports:{}},Rs={},yd={exports:{}},Le={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var um;function HT(){if(um)return Le;um=1;var e=Symbol.for("react.element"),t=Symbol.for("react.portal"),r=Symbol.for("react.fragment"),o=Symbol.for("react.strict_mode"),l=Symbol.for("react.profiler"),s=Symbol.for("react.provider"),u=Symbol.for("react.context"),d=Symbol.for("react.forward_ref"),f=Symbol.for("react.suspense"),g=Symbol.for("react.memo"),m=Symbol.for("react.lazy"),v=Symbol.iterator;function y(P){return P===null||typeof P!="object"?null:(P=v&&P[v]||P["@@iterator"],typeof P=="function"?P:null)}var w={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},I=Object.assign,E={};function C(P,B,K){this.props=P,this.context=B,this.refs=E,this.updater=K||w}C.prototype.isReactComponent={},C.prototype.setState=function(P,B){if(typeof P!="object"&&typeof P!="function"&&P!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,P,B,"setState")},C.prototype.forceUpdate=function(P){this.updater.enqueueForceUpdate(this,P,"forceUpdate")};function F(){}F.prototype=C.prototype;function L(P,B,K){this.props=P,this.context=B,this.refs=E,this.updater=K||w}var D=L.prototype=new F;D.constructor=L,I(D,C.prototype),D.isPureReactComponent=!0;var H=Array.isArray,x=Object.prototype.hasOwnProperty,U={current:null},$={key:!0,ref:!0,__self:!0,__source:!0};function ee(P,B,K){var ie,Se={},ae=null,Ee=null;if(B!=null)for(ie in B.ref!==void 0&&(Ee=B.ref),B.key!==void 0&&(ae=""+B.key),B)x.call(B,ie)&&!$.hasOwnProperty(ie)&&(Se[ie]=B[ie]);var Ae=arguments.length-2;if(Ae===1)Se.children=K;else if(1<Ae){for(var Z=Array(Ae),re=0;re<Ae;re++)Z[re]=arguments[re+2];Se.children=Z}if(P&&P.defaultProps)for(ie in Ae=P.defaultProps,Ae)Se[ie]===void 0&&(Se[ie]=Ae[ie]);return{$$typeof:e,type:P,key:ae,ref:Ee,props:Se,_owner:U.current}}function _e(P,B){return{$$typeof:e,type:P.type,key:B,ref:P.ref,props:P.props,_owner:P._owner}}function Ce(P){return typeof P=="object"&&P!==null&&P.$$typeof===e}function Ge(P){var B={"=":"=0",":":"=2"};return"$"+P.replace(/[=:]/g,function(K){return B[K]})}var Ne=/\/+/g;function Pe(P,B){return typeof P=="object"&&P!==null&&P.key!=null?Ge(""+P.key):B.toString(36)}function de(P,B,K,ie,Se){var ae=typeof P;(ae==="undefined"||ae==="boolean")&&(P=null);var Ee=!1;if(P===null)Ee=!0;else switch(ae){case"string":case"number":Ee=!0;break;case"object":switch(P.$$typeof){case e:case t:Ee=!0}}if(Ee)return Ee=P,Se=Se(Ee),P=ie===""?"."+Pe(Ee,0):ie,H(Se)?(K="",P!=null&&(K=P.replace(Ne,"$&/")+"/"),de(Se,B,K,"",function(re){return re})):Se!=null&&(Ce(Se)&&(Se=_e(Se,K+(!Se.key||Ee&&Ee.key===Se.key?"":(""+Se.key).replace(Ne,"$&/")+"/")+P)),B.push(Se)),1;if(Ee=0,ie=ie===""?".":ie+":",H(P))for(var Ae=0;Ae<P.length;Ae++){ae=P[Ae];var Z=ie+Pe(ae,Ae);Ee+=de(ae,B,K,Z,Se)}else if(Z=y(P),typeof Z=="function")for(P=Z.call(P),Ae=0;!(ae=P.next()).done;)ae=ae.value,Z=ie+Pe(ae,Ae++),Ee+=de(ae,B,K,Z,Se);else if(ae==="object")throw B=String(P),Error("Objects are not valid as a React child (found: "+(B==="[object Object]"?"object with keys {"+Object.keys(P).join(", ")+"}":B)+"). If you meant to render a collection of children, use an array instead.");return Ee}function Ue(P,B,K){if(P==null)return P;var ie=[],Se=0;return de(P,ie,"","",function(ae){return B.call(K,ae,Se++)}),ie}function Te(P){if(P._status===-1){var B=P._result;B=B(),B.then(function(K){(P._status===0||P._status===-1)&&(P._status=1,P._result=K)},function(K){(P._status===0||P._status===-1)&&(P._status=2,P._result=K)}),P._status===-1&&(P._status=0,P._result=B)}if(P._status===1)return P._result.default;throw P._result}var ne={current:null},W={transition:null},X={ReactCurrentDispatcher:ne,ReactCurrentBatchConfig:W,ReactCurrentOwner:U};function Y(){throw Error("act(...) is not supported in production builds of React.")}return Le.Children={map:Ue,forEach:function(P,B,K){Ue(P,function(){B.apply(this,arguments)},K)},count:function(P){var B=0;return Ue(P,function(){B++}),B},toArray:function(P){return Ue(P,function(B){return B})||[]},only:function(P){if(!Ce(P))throw Error("React.Children.only expected to receive a single React element child.");return P}},Le.Component=C,Le.Fragment=r,Le.Profiler=l,Le.PureComponent=L,Le.StrictMode=o,Le.Suspense=f,Le.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=X,Le.act=Y,Le.cloneElement=function(P,B,K){if(P==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+P+".");var ie=I({},P.props),Se=P.key,ae=P.ref,Ee=P._owner;if(B!=null){if(B.ref!==void 0&&(ae=B.ref,Ee=U.current),B.key!==void 0&&(Se=""+B.key),P.type&&P.type.defaultProps)var Ae=P.type.defaultProps;for(Z in B)x.call(B,Z)&&!$.hasOwnProperty(Z)&&(ie[Z]=B[Z]===void 0&&Ae!==void 0?Ae[Z]:B[Z])}var Z=arguments.length-2;if(Z===1)ie.children=K;else if(1<Z){Ae=Array(Z);for(var re=0;re<Z;re++)Ae[re]=arguments[re+2];ie.children=Ae}return{$$typeof:e,type:P.type,key:Se,ref:ae,props:ie,_owner:Ee}},Le.createContext=function(P){return P={$$typeof:u,_currentValue:P,_currentValue2:P,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},P.Provider={$$typeof:s,_context:P},P.Consumer=P},Le.createElement=ee,Le.createFactory=function(P){var B=ee.bind(null,P);return B.type=P,B},Le.createRef=function(){return{current:null}},Le.forwardRef=function(P){return{$$typeof:d,render:P}},Le.isValidElement=Ce,Le.lazy=function(P){return{$$typeof:m,_payload:{_status:-1,_result:P},_init:Te}},Le.memo=function(P,B){return{$$typeof:g,type:P,compare:B===void 0?null:B}},Le.startTransition=function(P){var B=W.transition;W.transition={};try{P()}finally{W.transition=B}},Le.unstable_act=Y,Le.useCallback=function(P,B){return ne.current.useCallback(P,B)},Le.useContext=function(P){return ne.current.useContext(P)},Le.useDebugValue=function(){},Le.useDeferredValue=function(P){return ne.current.useDeferredValue(P)},Le.useEffect=function(P,B){return ne.current.useEffect(P,B)},Le.useId=function(){return ne.current.useId()},Le.useImperativeHandle=function(P,B,K){return ne.current.useImperativeHandle(P,B,K)},Le.useInsertionEffect=function(P,B){return ne.current.useInsertionEffect(P,B)},Le.useLayoutEffect=function(P,B){return ne.current.useLayoutEffect(P,B)},Le.useMemo=function(P,B){return ne.current.useMemo(P,B)},Le.useReducer=function(P,B,K){return ne.current.useReducer(P,B,K)},Le.useRef=function(P){return ne.current.useRef(P)},Le.useState=function(P){return ne.current.useState(P)},Le.useSyncExternalStore=function(P,B,K){return ne.current.useSyncExternalStore(P,B,K)},Le.useTransition=function(){return ne.current.useTransition()},Le.version="18.3.1",Le}var cm;function Uf(){return cm||(cm=1,yd.exports=HT()),yd.exports}/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var dm;function bT(){if(dm)return Rs;dm=1;var e=Uf(),t=Symbol.for("react.element"),r=Symbol.for("react.fragment"),o=Object.prototype.hasOwnProperty,l=e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,s={key:!0,ref:!0,__self:!0,__source:!0};function u(d,f,g){var m,v={},y=null,w=null;g!==void 0&&(y=""+g),f.key!==void 0&&(y=""+f.key),f.ref!==void 0&&(w=f.ref);for(m in f)o.call(f,m)&&!s.hasOwnProperty(m)&&(v[m]=f[m]);if(d&&d.defaultProps)for(m in f=d.defaultProps,f)v[m]===void 0&&(v[m]=f[m]);return{$$typeof:t,type:d,key:y,ref:w,props:v,_owner:l.current}}return Rs.Fragment=r,Rs.jsx=u,Rs.jsxs=u,Rs}var fm;function GT(){return fm||(fm=1,Sd.exports=bT()),Sd.exports}var Fe=GT(),Re=Uf();const qn=W0(Re);var wl={},Td={exports:{}},qt={},Ad={exports:{}},Id={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var hm;function xT(){return hm||(hm=1,function(e){function t(W,X){var Y=W.length;W.push(X);e:for(;0<Y;){var P=Y-1>>>1,B=W[P];if(0<l(B,X))W[P]=X,W[Y]=B,Y=P;else break e}}function r(W){return W.length===0?null:W[0]}function o(W){if(W.length===0)return null;var X=W[0],Y=W.pop();if(Y!==X){W[0]=Y;e:for(var P=0,B=W.length,K=B>>>1;P<K;){var ie=2*(P+1)-1,Se=W[ie],ae=ie+1,Ee=W[ae];if(0>l(Se,Y))ae<B&&0>l(Ee,Se)?(W[P]=Ee,W[ae]=Y,P=ae):(W[P]=Se,W[ie]=Y,P=ie);else if(ae<B&&0>l(Ee,Y))W[P]=Ee,W[ae]=Y,P=ae;else break e}}return X}function l(W,X){var Y=W.sortIndex-X.sortIndex;return Y!==0?Y:W.id-X.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;e.unstable_now=function(){return s.now()}}else{var u=Date,d=u.now();e.unstable_now=function(){return u.now()-d}}var f=[],g=[],m=1,v=null,y=3,w=!1,I=!1,E=!1,C=typeof setTimeout=="function"?setTimeout:null,F=typeof clearTimeout=="function"?clearTimeout:null,L=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function D(W){for(var X=r(g);X!==null;){if(X.callback===null)o(g);else if(X.startTime<=W)o(g),X.sortIndex=X.expirationTime,t(f,X);else break;X=r(g)}}function H(W){if(E=!1,D(W),!I)if(r(f)!==null)I=!0,Te(x);else{var X=r(g);X!==null&&ne(H,X.startTime-W)}}function x(W,X){I=!1,E&&(E=!1,F(ee),ee=-1),w=!0;var Y=y;try{for(D(X),v=r(f);v!==null&&(!(v.expirationTime>X)||W&&!Ge());){var P=v.callback;if(typeof P=="function"){v.callback=null,y=v.priorityLevel;var B=P(v.expirationTime<=X);X=e.unstable_now(),typeof B=="function"?v.callback=B:v===r(f)&&o(f),D(X)}else o(f);v=r(f)}if(v!==null)var K=!0;else{var ie=r(g);ie!==null&&ne(H,ie.startTime-X),K=!1}return K}finally{v=null,y=Y,w=!1}}var U=!1,$=null,ee=-1,_e=5,Ce=-1;function Ge(){return!(e.unstable_now()-Ce<_e)}function Ne(){if($!==null){var W=e.unstable_now();Ce=W;var X=!0;try{X=$(!0,W)}finally{X?Pe():(U=!1,$=null)}}else U=!1}var Pe;if(typeof L=="function")Pe=function(){L(Ne)};else if(typeof MessageChannel<"u"){var de=new MessageChannel,Ue=de.port2;de.port1.onmessage=Ne,Pe=function(){Ue.postMessage(null)}}else Pe=function(){C(Ne,0)};function Te(W){$=W,U||(U=!0,Pe())}function ne(W,X){ee=C(function(){W(e.unstable_now())},X)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(W){W.callback=null},e.unstable_continueExecution=function(){I||w||(I=!0,Te(x))},e.unstable_forceFrameRate=function(W){0>W||125<W?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):_e=0<W?Math.floor(1e3/W):5},e.unstable_getCurrentPriorityLevel=function(){return y},e.unstable_getFirstCallbackNode=function(){return r(f)},e.unstable_next=function(W){switch(y){case 1:case 2:case 3:var X=3;break;default:X=y}var Y=y;y=X;try{return W()}finally{y=Y}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(W,X){switch(W){case 1:case 2:case 3:case 4:case 5:break;default:W=3}var Y=y;y=W;try{return X()}finally{y=Y}},e.unstable_scheduleCallback=function(W,X,Y){var P=e.unstable_now();switch(typeof Y=="object"&&Y!==null?(Y=Y.delay,Y=typeof Y=="number"&&0<Y?P+Y:P):Y=P,W){case 1:var B=-1;break;case 2:B=250;break;case 5:B=1073741823;break;case 4:B=1e4;break;default:B=5e3}return B=Y+B,W={id:m++,callback:X,priorityLevel:W,startTime:Y,expirationTime:B,sortIndex:-1},Y>P?(W.sortIndex=Y,t(g,W),r(f)===null&&W===r(g)&&(E?(F(ee),ee=-1):E=!0,ne(H,Y-P))):(W.sortIndex=B,t(f,W),I||w||(I=!0,Te(x))),W},e.unstable_shouldYield=Ge,e.unstable_wrapCallback=function(W){var X=y;return function(){var Y=y;y=X;try{return W.apply(this,arguments)}finally{y=Y}}}}(Id)),Id}var gm;function $T(){return gm||(gm=1,Ad.exports=xT()),Ad.exports}/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var pm;function zT(){if(pm)return qt;pm=1;var e=Uf(),t=$T();function r(n){for(var i="https://reactjs.org/docs/error-decoder.html?invariant="+n,a=1;a<arguments.length;a++)i+="&args[]="+encodeURIComponent(arguments[a]);return"Minified React error #"+n+"; visit "+i+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var o=new Set,l={};function s(n,i){u(n,i),u(n+"Capture",i)}function u(n,i){for(l[n]=i,n=0;n<i.length;n++)o.add(i[n])}var d=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),f=Object.prototype.hasOwnProperty,g=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,m={},v={};function y(n){return f.call(v,n)?!0:f.call(m,n)?!1:g.test(n)?v[n]=!0:(m[n]=!0,!1)}function w(n,i,a,c){if(a!==null&&a.type===0)return!1;switch(typeof i){case"function":case"symbol":return!0;case"boolean":return c?!1:a!==null?!a.acceptsBooleans:(n=n.toLowerCase().slice(0,5),n!=="data-"&&n!=="aria-");default:return!1}}function I(n,i,a,c){if(i===null||typeof i>"u"||w(n,i,a,c))return!0;if(c)return!1;if(a!==null)switch(a.type){case 3:return!i;case 4:return i===!1;case 5:return isNaN(i);case 6:return isNaN(i)||1>i}return!1}function E(n,i,a,c,h,p,S){this.acceptsBooleans=i===2||i===3||i===4,this.attributeName=c,this.attributeNamespace=h,this.mustUseProperty=a,this.propertyName=n,this.type=i,this.sanitizeURL=p,this.removeEmptyString=S}var C={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(n){C[n]=new E(n,0,!1,n,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(n){var i=n[0];C[i]=new E(i,1,!1,n[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(n){C[n]=new E(n,2,!1,n.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(n){C[n]=new E(n,2,!1,n,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(n){C[n]=new E(n,3,!1,n.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(n){C[n]=new E(n,3,!0,n,null,!1,!1)}),["capture","download"].forEach(function(n){C[n]=new E(n,4,!1,n,null,!1,!1)}),["cols","rows","size","span"].forEach(function(n){C[n]=new E(n,6,!1,n,null,!1,!1)}),["rowSpan","start"].forEach(function(n){C[n]=new E(n,5,!1,n.toLowerCase(),null,!1,!1)});var F=/[\-:]([a-z])/g;function L(n){return n[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(n){var i=n.replace(F,L);C[i]=new E(i,1,!1,n,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(n){var i=n.replace(F,L);C[i]=new E(i,1,!1,n,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(n){var i=n.replace(F,L);C[i]=new E(i,1,!1,n,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(n){C[n]=new E(n,1,!1,n.toLowerCase(),null,!1,!1)}),C.xlinkHref=new E("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(n){C[n]=new E(n,1,!1,n.toLowerCase(),null,!0,!0)});function D(n,i,a,c){var h=C.hasOwnProperty(i)?C[i]:null;(h!==null?h.type!==0:c||!(2<i.length)||i[0]!=="o"&&i[0]!=="O"||i[1]!=="n"&&i[1]!=="N")&&(I(i,a,h,c)&&(a=null),c||h===null?y(i)&&(a===null?n.removeAttribute(i):n.setAttribute(i,""+a)):h.mustUseProperty?n[h.propertyName]=a===null?h.type===3?!1:"":a:(i=h.attributeName,c=h.attributeNamespace,a===null?n.removeAttribute(i):(h=h.type,a=h===3||h===4&&a===!0?"":""+a,c?n.setAttributeNS(c,i,a):n.setAttribute(i,a))))}var H=e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,x=Symbol.for("react.element"),U=Symbol.for("react.portal"),$=Symbol.for("react.fragment"),ee=Symbol.for("react.strict_mode"),_e=Symbol.for("react.profiler"),Ce=Symbol.for("react.provider"),Ge=Symbol.for("react.context"),Ne=Symbol.for("react.forward_ref"),Pe=Symbol.for("react.suspense"),de=Symbol.for("react.suspense_list"),Ue=Symbol.for("react.memo"),Te=Symbol.for("react.lazy"),ne=Symbol.for("react.offscreen"),W=Symbol.iterator;function X(n){return n===null||typeof n!="object"?null:(n=W&&n[W]||n["@@iterator"],typeof n=="function"?n:null)}var Y=Object.assign,P;function B(n){if(P===void 0)try{throw Error()}catch(a){var i=a.stack.trim().match(/\n( *(at )?)/);P=i&&i[1]||""}return`
`+P+n}var K=!1;function ie(n,i){if(!n||K)return"";K=!0;var a=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(i)if(i=function(){throw Error()},Object.defineProperty(i.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(i,[])}catch(M){var c=M}Reflect.construct(n,[],i)}else{try{i.call()}catch(M){c=M}n.call(i.prototype)}else{try{throw Error()}catch(M){c=M}n()}}catch(M){if(M&&c&&typeof M.stack=="string"){for(var h=M.stack.split(`
`),p=c.stack.split(`
`),S=h.length-1,A=p.length-1;1<=S&&0<=A&&h[S]!==p[A];)A--;for(;1<=S&&0<=A;S--,A--)if(h[S]!==p[A]){if(S!==1||A!==1)do if(S--,A--,0>A||h[S]!==p[A]){var R=`
`+h[S].replace(" at new "," at ");return n.displayName&&R.includes("<anonymous>")&&(R=R.replace("<anonymous>",n.displayName)),R}while(1<=S&&0<=A);break}}}finally{K=!1,Error.prepareStackTrace=a}return(n=n?n.displayName||n.name:"")?B(n):""}function Se(n){switch(n.tag){case 5:return B(n.type);case 16:return B("Lazy");case 13:return B("Suspense");case 19:return B("SuspenseList");case 0:case 2:case 15:return n=ie(n.type,!1),n;case 11:return n=ie(n.type.render,!1),n;case 1:return n=ie(n.type,!0),n;default:return""}}function ae(n){if(n==null)return null;if(typeof n=="function")return n.displayName||n.name||null;if(typeof n=="string")return n;switch(n){case $:return"Fragment";case U:return"Portal";case _e:return"Profiler";case ee:return"StrictMode";case Pe:return"Suspense";case de:return"SuspenseList"}if(typeof n=="object")switch(n.$$typeof){case Ge:return(n.displayName||"Context")+".Consumer";case Ce:return(n._context.displayName||"Context")+".Provider";case Ne:var i=n.render;return n=n.displayName,n||(n=i.displayName||i.name||"",n=n!==""?"ForwardRef("+n+")":"ForwardRef"),n;case Ue:return i=n.displayName||null,i!==null?i:ae(n.type)||"Memo";case Te:i=n._payload,n=n._init;try{return ae(n(i))}catch{}}return null}function Ee(n){var i=n.type;switch(n.tag){case 24:return"Cache";case 9:return(i.displayName||"Context")+".Consumer";case 10:return(i._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return n=i.render,n=n.displayName||n.name||"",i.displayName||(n!==""?"ForwardRef("+n+")":"ForwardRef");case 7:return"Fragment";case 5:return i;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return ae(i);case 8:return i===ee?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof i=="function")return i.displayName||i.name||null;if(typeof i=="string")return i}return null}function Ae(n){switch(typeof n){case"boolean":case"number":case"string":case"undefined":return n;case"object":return n;default:return""}}function Z(n){var i=n.type;return(n=n.nodeName)&&n.toLowerCase()==="input"&&(i==="checkbox"||i==="radio")}function re(n){var i=Z(n)?"checked":"value",a=Object.getOwnPropertyDescriptor(n.constructor.prototype,i),c=""+n[i];if(!n.hasOwnProperty(i)&&typeof a<"u"&&typeof a.get=="function"&&typeof a.set=="function"){var h=a.get,p=a.set;return Object.defineProperty(n,i,{configurable:!0,get:function(){return h.call(this)},set:function(S){c=""+S,p.call(this,S)}}),Object.defineProperty(n,i,{enumerable:a.enumerable}),{getValue:function(){return c},setValue:function(S){c=""+S},stopTracking:function(){n._valueTracker=null,delete n[i]}}}}function Be(n){n._valueTracker||(n._valueTracker=re(n))}function he(n){if(!n)return!1;var i=n._valueTracker;if(!i)return!0;var a=i.getValue(),c="";return n&&(c=Z(n)?n.checked?"true":"false":n.value),n=c,n!==a?(i.setValue(n),!0):!1}function Hn(n){if(n=n||(typeof document<"u"?document:void 0),typeof n>"u")return null;try{return n.activeElement||n.body}catch{return n.body}}function qe(n,i){var a=i.checked;return Y({},i,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:a??n._wrapperState.initialChecked})}function je(n,i){var a=i.defaultValue==null?"":i.defaultValue,c=i.checked!=null?i.checked:i.defaultChecked;a=Ae(i.value!=null?i.value:a),n._wrapperState={initialChecked:c,initialValue:a,controlled:i.type==="checkbox"||i.type==="radio"?i.checked!=null:i.value!=null}}function bn(n,i){i=i.checked,i!=null&&D(n,"checked",i,!1)}function Yt(n,i){bn(n,i);var a=Ae(i.value),c=i.type;if(a!=null)c==="number"?(a===0&&n.value===""||n.value!=a)&&(n.value=""+a):n.value!==""+a&&(n.value=""+a);else if(c==="submit"||c==="reset"){n.removeAttribute("value");return}i.hasOwnProperty("value")?Gn(n,i.type,a):i.hasOwnProperty("defaultValue")&&Gn(n,i.type,Ae(i.defaultValue)),i.checked==null&&i.defaultChecked!=null&&(n.defaultChecked=!!i.defaultChecked)}function un(n,i,a){if(i.hasOwnProperty("value")||i.hasOwnProperty("defaultValue")){var c=i.type;if(!(c!=="submit"&&c!=="reset"||i.value!==void 0&&i.value!==null))return;i=""+n._wrapperState.initialValue,a||i===n.value||(n.value=i),n.defaultValue=i}a=n.name,a!==""&&(n.name=""),n.defaultChecked=!!n._wrapperState.initialChecked,a!==""&&(n.name=a)}function Gn(n,i,a){(i!=="number"||Hn(n.ownerDocument)!==n)&&(a==null?n.defaultValue=""+n._wrapperState.initialValue:n.defaultValue!==""+a&&(n.defaultValue=""+a))}var xn=Array.isArray;function yi(n,i,a,c){if(n=n.options,i){i={};for(var h=0;h<a.length;h++)i["$"+a[h]]=!0;for(a=0;a<n.length;a++)h=i.hasOwnProperty("$"+n[a].value),n[a].selected!==h&&(n[a].selected=h),h&&c&&(n[a].defaultSelected=!0)}else{for(a=""+Ae(a),i=null,h=0;h<n.length;h++){if(n[h].value===a){n[h].selected=!0,c&&(n[h].defaultSelected=!0);return}i!==null||n[h].disabled||(i=n[h])}i!==null&&(i.selected=!0)}}function ir(n,i){if(i.dangerouslySetInnerHTML!=null)throw Error(r(91));return Y({},i,{value:void 0,defaultValue:void 0,children:""+n._wrapperState.initialValue})}function yh(n,i){var a=i.value;if(a==null){if(a=i.children,i=i.defaultValue,a!=null){if(i!=null)throw Error(r(92));if(xn(a)){if(1<a.length)throw Error(r(93));a=a[0]}i=a}i==null&&(i=""),a=i}n._wrapperState={initialValue:Ae(a)}}function Th(n,i){var a=Ae(i.value),c=Ae(i.defaultValue);a!=null&&(a=""+a,a!==n.value&&(n.value=a),i.defaultValue==null&&n.defaultValue!==a&&(n.defaultValue=a)),c!=null&&(n.defaultValue=""+c)}function Ah(n){var i=n.textContent;i===n._wrapperState.initialValue&&i!==""&&i!==null&&(n.value=i)}function Ih(n){switch(n){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Nu(n,i){return n==null||n==="http://www.w3.org/1999/xhtml"?Ih(i):n==="http://www.w3.org/2000/svg"&&i==="foreignObject"?"http://www.w3.org/1999/xhtml":n}var ma,Eh=function(n){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(i,a,c,h){MSApp.execUnsafeLocalFunction(function(){return n(i,a,c,h)})}:n}(function(n,i){if(n.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in n)n.innerHTML=i;else{for(ma=ma||document.createElement("div"),ma.innerHTML="<svg>"+i.valueOf().toString()+"</svg>",i=ma.firstChild;n.firstChild;)n.removeChild(n.firstChild);for(;i.firstChild;)n.appendChild(i.firstChild)}});function zo(n,i){if(i){var a=n.firstChild;if(a&&a===n.lastChild&&a.nodeType===3){a.nodeValue=i;return}}n.textContent=i}var Wo={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},GS=["Webkit","ms","Moz","O"];Object.keys(Wo).forEach(function(n){GS.forEach(function(i){i=i+n.charAt(0).toUpperCase()+n.substring(1),Wo[i]=Wo[n]})});function wh(n,i,a){return i==null||typeof i=="boolean"||i===""?"":a||typeof i!="number"||i===0||Wo.hasOwnProperty(n)&&Wo[n]?(""+i).trim():i+"px"}function _h(n,i){n=n.style;for(var a in i)if(i.hasOwnProperty(a)){var c=a.indexOf("--")===0,h=wh(a,i[a],c);a==="float"&&(a="cssFloat"),c?n.setProperty(a,h):n[a]=h}}var xS=Y({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Du(n,i){if(i){if(xS[n]&&(i.children!=null||i.dangerouslySetInnerHTML!=null))throw Error(r(137,n));if(i.dangerouslySetInnerHTML!=null){if(i.children!=null)throw Error(r(60));if(typeof i.dangerouslySetInnerHTML!="object"||!("__html"in i.dangerouslySetInnerHTML))throw Error(r(61))}if(i.style!=null&&typeof i.style!="object")throw Error(r(62))}}function ku(n,i){if(n.indexOf("-")===-1)return typeof i.is=="string";switch(n){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Ou=null;function Mu(n){return n=n.target||n.srcElement||window,n.correspondingUseElement&&(n=n.correspondingUseElement),n.nodeType===3?n.parentNode:n}var Fu=null,br=null,Gr=null;function Ch(n){if(n=fs(n)){if(typeof Fu!="function")throw Error(r(280));var i=n.stateNode;i&&(i=ba(i),Fu(n.stateNode,n.type,i))}}function Rh(n){br?Gr?Gr.push(n):Gr=[n]:br=n}function Ph(){if(br){var n=br,i=Gr;if(Gr=br=null,Ch(n),i)for(n=0;n<i.length;n++)Ch(i[n])}}function Nh(n,i){return n(i)}function Dh(){}var Uu=!1;function kh(n,i,a){if(Uu)return n(i,a);Uu=!0;try{return Nh(n,i,a)}finally{Uu=!1,(br!==null||Gr!==null)&&(Dh(),Ph())}}function Yo(n,i){var a=n.stateNode;if(a===null)return null;var c=ba(a);if(c===null)return null;a=c[i];e:switch(i){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(c=!c.disabled)||(n=n.type,c=!(n==="button"||n==="input"||n==="select"||n==="textarea")),n=!c;break e;default:n=!1}if(n)return null;if(a&&typeof a!="function")throw Error(r(231,i,typeof a));return a}var Bu=!1;if(d)try{var jo={};Object.defineProperty(jo,"passive",{get:function(){Bu=!0}}),window.addEventListener("test",jo,jo),window.removeEventListener("test",jo,jo)}catch{Bu=!1}function $S(n,i,a,c,h,p,S,A,R){var M=Array.prototype.slice.call(arguments,3);try{i.apply(a,M)}catch(G){this.onError(G)}}var Vo=!1,va=null,Sa=!1,Lu=null,zS={onError:function(n){Vo=!0,va=n}};function WS(n,i,a,c,h,p,S,A,R){Vo=!1,va=null,$S.apply(zS,arguments)}function YS(n,i,a,c,h,p,S,A,R){if(WS.apply(this,arguments),Vo){if(Vo){var M=va;Vo=!1,va=null}else throw Error(r(198));Sa||(Sa=!0,Lu=M)}}function rr(n){var i=n,a=n;if(n.alternate)for(;i.return;)i=i.return;else{n=i;do i=n,(i.flags&4098)!==0&&(a=i.return),n=i.return;while(n)}return i.tag===3?a:null}function Oh(n){if(n.tag===13){var i=n.memoizedState;if(i===null&&(n=n.alternate,n!==null&&(i=n.memoizedState)),i!==null)return i.dehydrated}return null}function Mh(n){if(rr(n)!==n)throw Error(r(188))}function jS(n){var i=n.alternate;if(!i){if(i=rr(n),i===null)throw Error(r(188));return i!==n?null:n}for(var a=n,c=i;;){var h=a.return;if(h===null)break;var p=h.alternate;if(p===null){if(c=h.return,c!==null){a=c;continue}break}if(h.child===p.child){for(p=h.child;p;){if(p===a)return Mh(h),n;if(p===c)return Mh(h),i;p=p.sibling}throw Error(r(188))}if(a.return!==c.return)a=h,c=p;else{for(var S=!1,A=h.child;A;){if(A===a){S=!0,a=h,c=p;break}if(A===c){S=!0,c=h,a=p;break}A=A.sibling}if(!S){for(A=p.child;A;){if(A===a){S=!0,a=p,c=h;break}if(A===c){S=!0,c=p,a=h;break}A=A.sibling}if(!S)throw Error(r(189))}}if(a.alternate!==c)throw Error(r(190))}if(a.tag!==3)throw Error(r(188));return a.stateNode.current===a?n:i}function Fh(n){return n=jS(n),n!==null?Uh(n):null}function Uh(n){if(n.tag===5||n.tag===6)return n;for(n=n.child;n!==null;){var i=Uh(n);if(i!==null)return i;n=n.sibling}return null}var Bh=t.unstable_scheduleCallback,Lh=t.unstable_cancelCallback,VS=t.unstable_shouldYield,XS=t.unstable_requestPaint,at=t.unstable_now,KS=t.unstable_getCurrentPriorityLevel,Hu=t.unstable_ImmediatePriority,Hh=t.unstable_UserBlockingPriority,ya=t.unstable_NormalPriority,ZS=t.unstable_LowPriority,bh=t.unstable_IdlePriority,Ta=null,$n=null;function qS(n){if($n&&typeof $n.onCommitFiberRoot=="function")try{$n.onCommitFiberRoot(Ta,n,void 0,(n.current.flags&128)===128)}catch{}}var En=Math.clz32?Math.clz32:ey,QS=Math.log,JS=Math.LN2;function ey(n){return n>>>=0,n===0?32:31-(QS(n)/JS|0)|0}var Aa=64,Ia=4194304;function Xo(n){switch(n&-n){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return n&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return n&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return n}}function Ea(n,i){var a=n.pendingLanes;if(a===0)return 0;var c=0,h=n.suspendedLanes,p=n.pingedLanes,S=a&268435455;if(S!==0){var A=S&~h;A!==0?c=Xo(A):(p&=S,p!==0&&(c=Xo(p)))}else S=a&~h,S!==0?c=Xo(S):p!==0&&(c=Xo(p));if(c===0)return 0;if(i!==0&&i!==c&&(i&h)===0&&(h=c&-c,p=i&-i,h>=p||h===16&&(p&4194240)!==0))return i;if((c&4)!==0&&(c|=a&16),i=n.entangledLanes,i!==0)for(n=n.entanglements,i&=c;0<i;)a=31-En(i),h=1<<a,c|=n[a],i&=~h;return c}function ty(n,i){switch(n){case 1:case 2:case 4:return i+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return i+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function ny(n,i){for(var a=n.suspendedLanes,c=n.pingedLanes,h=n.expirationTimes,p=n.pendingLanes;0<p;){var S=31-En(p),A=1<<S,R=h[S];R===-1?((A&a)===0||(A&c)!==0)&&(h[S]=ty(A,i)):R<=i&&(n.expiredLanes|=A),p&=~A}}function bu(n){return n=n.pendingLanes&-1073741825,n!==0?n:n&1073741824?1073741824:0}function Gh(){var n=Aa;return Aa<<=1,(Aa&4194240)===0&&(Aa=64),n}function Gu(n){for(var i=[],a=0;31>a;a++)i.push(n);return i}function Ko(n,i,a){n.pendingLanes|=i,i!==536870912&&(n.suspendedLanes=0,n.pingedLanes=0),n=n.eventTimes,i=31-En(i),n[i]=a}function iy(n,i){var a=n.pendingLanes&~i;n.pendingLanes=i,n.suspendedLanes=0,n.pingedLanes=0,n.expiredLanes&=i,n.mutableReadLanes&=i,n.entangledLanes&=i,i=n.entanglements;var c=n.eventTimes;for(n=n.expirationTimes;0<a;){var h=31-En(a),p=1<<h;i[h]=0,c[h]=-1,n[h]=-1,a&=~p}}function xu(n,i){var a=n.entangledLanes|=i;for(n=n.entanglements;a;){var c=31-En(a),h=1<<c;h&i|n[c]&i&&(n[c]|=i),a&=~h}}var We=0;function xh(n){return n&=-n,1<n?4<n?(n&268435455)!==0?16:536870912:4:1}var $h,$u,zh,Wh,Yh,zu=!1,wa=[],Ti=null,Ai=null,Ii=null,Zo=new Map,qo=new Map,Ei=[],ry="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function jh(n,i){switch(n){case"focusin":case"focusout":Ti=null;break;case"dragenter":case"dragleave":Ai=null;break;case"mouseover":case"mouseout":Ii=null;break;case"pointerover":case"pointerout":Zo.delete(i.pointerId);break;case"gotpointercapture":case"lostpointercapture":qo.delete(i.pointerId)}}function Qo(n,i,a,c,h,p){return n===null||n.nativeEvent!==p?(n={blockedOn:i,domEventName:a,eventSystemFlags:c,nativeEvent:p,targetContainers:[h]},i!==null&&(i=fs(i),i!==null&&$u(i)),n):(n.eventSystemFlags|=c,i=n.targetContainers,h!==null&&i.indexOf(h)===-1&&i.push(h),n)}function oy(n,i,a,c,h){switch(i){case"focusin":return Ti=Qo(Ti,n,i,a,c,h),!0;case"dragenter":return Ai=Qo(Ai,n,i,a,c,h),!0;case"mouseover":return Ii=Qo(Ii,n,i,a,c,h),!0;case"pointerover":var p=h.pointerId;return Zo.set(p,Qo(Zo.get(p)||null,n,i,a,c,h)),!0;case"gotpointercapture":return p=h.pointerId,qo.set(p,Qo(qo.get(p)||null,n,i,a,c,h)),!0}return!1}function Vh(n){var i=or(n.target);if(i!==null){var a=rr(i);if(a!==null){if(i=a.tag,i===13){if(i=Oh(a),i!==null){n.blockedOn=i,Yh(n.priority,function(){zh(a)});return}}else if(i===3&&a.stateNode.current.memoizedState.isDehydrated){n.blockedOn=a.tag===3?a.stateNode.containerInfo:null;return}}}n.blockedOn=null}function _a(n){if(n.blockedOn!==null)return!1;for(var i=n.targetContainers;0<i.length;){var a=Yu(n.domEventName,n.eventSystemFlags,i[0],n.nativeEvent);if(a===null){a=n.nativeEvent;var c=new a.constructor(a.type,a);Ou=c,a.target.dispatchEvent(c),Ou=null}else return i=fs(a),i!==null&&$u(i),n.blockedOn=a,!1;i.shift()}return!0}function Xh(n,i,a){_a(n)&&a.delete(i)}function sy(){zu=!1,Ti!==null&&_a(Ti)&&(Ti=null),Ai!==null&&_a(Ai)&&(Ai=null),Ii!==null&&_a(Ii)&&(Ii=null),Zo.forEach(Xh),qo.forEach(Xh)}function Jo(n,i){n.blockedOn===i&&(n.blockedOn=null,zu||(zu=!0,t.unstable_scheduleCallback(t.unstable_NormalPriority,sy)))}function es(n){function i(h){return Jo(h,n)}if(0<wa.length){Jo(wa[0],n);for(var a=1;a<wa.length;a++){var c=wa[a];c.blockedOn===n&&(c.blockedOn=null)}}for(Ti!==null&&Jo(Ti,n),Ai!==null&&Jo(Ai,n),Ii!==null&&Jo(Ii,n),Zo.forEach(i),qo.forEach(i),a=0;a<Ei.length;a++)c=Ei[a],c.blockedOn===n&&(c.blockedOn=null);for(;0<Ei.length&&(a=Ei[0],a.blockedOn===null);)Vh(a),a.blockedOn===null&&Ei.shift()}var xr=H.ReactCurrentBatchConfig,Ca=!0;function ay(n,i,a,c){var h=We,p=xr.transition;xr.transition=null;try{We=1,Wu(n,i,a,c)}finally{We=h,xr.transition=p}}function ly(n,i,a,c){var h=We,p=xr.transition;xr.transition=null;try{We=4,Wu(n,i,a,c)}finally{We=h,xr.transition=p}}function Wu(n,i,a,c){if(Ca){var h=Yu(n,i,a,c);if(h===null)lc(n,i,c,Ra,a),jh(n,c);else if(oy(h,n,i,a,c))c.stopPropagation();else if(jh(n,c),i&4&&-1<ry.indexOf(n)){for(;h!==null;){var p=fs(h);if(p!==null&&$h(p),p=Yu(n,i,a,c),p===null&&lc(n,i,c,Ra,a),p===h)break;h=p}h!==null&&c.stopPropagation()}else lc(n,i,c,null,a)}}var Ra=null;function Yu(n,i,a,c){if(Ra=null,n=Mu(c),n=or(n),n!==null)if(i=rr(n),i===null)n=null;else if(a=i.tag,a===13){if(n=Oh(i),n!==null)return n;n=null}else if(a===3){if(i.stateNode.current.memoizedState.isDehydrated)return i.tag===3?i.stateNode.containerInfo:null;n=null}else i!==n&&(n=null);return Ra=n,null}function Kh(n){switch(n){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(KS()){case Hu:return 1;case Hh:return 4;case ya:case ZS:return 16;case bh:return 536870912;default:return 16}default:return 16}}var wi=null,ju=null,Pa=null;function Zh(){if(Pa)return Pa;var n,i=ju,a=i.length,c,h="value"in wi?wi.value:wi.textContent,p=h.length;for(n=0;n<a&&i[n]===h[n];n++);var S=a-n;for(c=1;c<=S&&i[a-c]===h[p-c];c++);return Pa=h.slice(n,1<c?1-c:void 0)}function Na(n){var i=n.keyCode;return"charCode"in n?(n=n.charCode,n===0&&i===13&&(n=13)):n=i,n===10&&(n=13),32<=n||n===13?n:0}function Da(){return!0}function qh(){return!1}function en(n){function i(a,c,h,p,S){this._reactName=a,this._targetInst=h,this.type=c,this.nativeEvent=p,this.target=S,this.currentTarget=null;for(var A in n)n.hasOwnProperty(A)&&(a=n[A],this[A]=a?a(p):p[A]);return this.isDefaultPrevented=(p.defaultPrevented!=null?p.defaultPrevented:p.returnValue===!1)?Da:qh,this.isPropagationStopped=qh,this}return Y(i.prototype,{preventDefault:function(){this.defaultPrevented=!0;var a=this.nativeEvent;a&&(a.preventDefault?a.preventDefault():typeof a.returnValue!="unknown"&&(a.returnValue=!1),this.isDefaultPrevented=Da)},stopPropagation:function(){var a=this.nativeEvent;a&&(a.stopPropagation?a.stopPropagation():typeof a.cancelBubble!="unknown"&&(a.cancelBubble=!0),this.isPropagationStopped=Da)},persist:function(){},isPersistent:Da}),i}var $r={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(n){return n.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Vu=en($r),ts=Y({},$r,{view:0,detail:0}),uy=en(ts),Xu,Ku,ns,ka=Y({},ts,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:qu,button:0,buttons:0,relatedTarget:function(n){return n.relatedTarget===void 0?n.fromElement===n.srcElement?n.toElement:n.fromElement:n.relatedTarget},movementX:function(n){return"movementX"in n?n.movementX:(n!==ns&&(ns&&n.type==="mousemove"?(Xu=n.screenX-ns.screenX,Ku=n.screenY-ns.screenY):Ku=Xu=0,ns=n),Xu)},movementY:function(n){return"movementY"in n?n.movementY:Ku}}),Qh=en(ka),cy=Y({},ka,{dataTransfer:0}),dy=en(cy),fy=Y({},ts,{relatedTarget:0}),Zu=en(fy),hy=Y({},$r,{animationName:0,elapsedTime:0,pseudoElement:0}),gy=en(hy),py=Y({},$r,{clipboardData:function(n){return"clipboardData"in n?n.clipboardData:window.clipboardData}}),my=en(py),vy=Y({},$r,{data:0}),Jh=en(vy),Sy={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},yy={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Ty={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Ay(n){var i=this.nativeEvent;return i.getModifierState?i.getModifierState(n):(n=Ty[n])?!!i[n]:!1}function qu(){return Ay}var Iy=Y({},ts,{key:function(n){if(n.key){var i=Sy[n.key]||n.key;if(i!=="Unidentified")return i}return n.type==="keypress"?(n=Na(n),n===13?"Enter":String.fromCharCode(n)):n.type==="keydown"||n.type==="keyup"?yy[n.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:qu,charCode:function(n){return n.type==="keypress"?Na(n):0},keyCode:function(n){return n.type==="keydown"||n.type==="keyup"?n.keyCode:0},which:function(n){return n.type==="keypress"?Na(n):n.type==="keydown"||n.type==="keyup"?n.keyCode:0}}),Ey=en(Iy),wy=Y({},ka,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),eg=en(wy),_y=Y({},ts,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:qu}),Cy=en(_y),Ry=Y({},$r,{propertyName:0,elapsedTime:0,pseudoElement:0}),Py=en(Ry),Ny=Y({},ka,{deltaX:function(n){return"deltaX"in n?n.deltaX:"wheelDeltaX"in n?-n.wheelDeltaX:0},deltaY:function(n){return"deltaY"in n?n.deltaY:"wheelDeltaY"in n?-n.wheelDeltaY:"wheelDelta"in n?-n.wheelDelta:0},deltaZ:0,deltaMode:0}),Dy=en(Ny),ky=[9,13,27,32],Qu=d&&"CompositionEvent"in window,is=null;d&&"documentMode"in document&&(is=document.documentMode);var Oy=d&&"TextEvent"in window&&!is,tg=d&&(!Qu||is&&8<is&&11>=is),ng=" ",ig=!1;function rg(n,i){switch(n){case"keyup":return ky.indexOf(i.keyCode)!==-1;case"keydown":return i.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function og(n){return n=n.detail,typeof n=="object"&&"data"in n?n.data:null}var zr=!1;function My(n,i){switch(n){case"compositionend":return og(i);case"keypress":return i.which!==32?null:(ig=!0,ng);case"textInput":return n=i.data,n===ng&&ig?null:n;default:return null}}function Fy(n,i){if(zr)return n==="compositionend"||!Qu&&rg(n,i)?(n=Zh(),Pa=ju=wi=null,zr=!1,n):null;switch(n){case"paste":return null;case"keypress":if(!(i.ctrlKey||i.altKey||i.metaKey)||i.ctrlKey&&i.altKey){if(i.char&&1<i.char.length)return i.char;if(i.which)return String.fromCharCode(i.which)}return null;case"compositionend":return tg&&i.locale!=="ko"?null:i.data;default:return null}}var Uy={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function sg(n){var i=n&&n.nodeName&&n.nodeName.toLowerCase();return i==="input"?!!Uy[n.type]:i==="textarea"}function ag(n,i,a,c){Rh(c),i=Ba(i,"onChange"),0<i.length&&(a=new Vu("onChange","change",null,a,c),n.push({event:a,listeners:i}))}var rs=null,os=null;function By(n){_g(n,0)}function Oa(n){var i=Xr(n);if(he(i))return n}function Ly(n,i){if(n==="change")return i}var lg=!1;if(d){var Ju;if(d){var ec="oninput"in document;if(!ec){var ug=document.createElement("div");ug.setAttribute("oninput","return;"),ec=typeof ug.oninput=="function"}Ju=ec}else Ju=!1;lg=Ju&&(!document.documentMode||9<document.documentMode)}function cg(){rs&&(rs.detachEvent("onpropertychange",dg),os=rs=null)}function dg(n){if(n.propertyName==="value"&&Oa(os)){var i=[];ag(i,os,n,Mu(n)),kh(By,i)}}function Hy(n,i,a){n==="focusin"?(cg(),rs=i,os=a,rs.attachEvent("onpropertychange",dg)):n==="focusout"&&cg()}function by(n){if(n==="selectionchange"||n==="keyup"||n==="keydown")return Oa(os)}function Gy(n,i){if(n==="click")return Oa(i)}function xy(n,i){if(n==="input"||n==="change")return Oa(i)}function $y(n,i){return n===i&&(n!==0||1/n===1/i)||n!==n&&i!==i}var wn=typeof Object.is=="function"?Object.is:$y;function ss(n,i){if(wn(n,i))return!0;if(typeof n!="object"||n===null||typeof i!="object"||i===null)return!1;var a=Object.keys(n),c=Object.keys(i);if(a.length!==c.length)return!1;for(c=0;c<a.length;c++){var h=a[c];if(!f.call(i,h)||!wn(n[h],i[h]))return!1}return!0}function fg(n){for(;n&&n.firstChild;)n=n.firstChild;return n}function hg(n,i){var a=fg(n);n=0;for(var c;a;){if(a.nodeType===3){if(c=n+a.textContent.length,n<=i&&c>=i)return{node:a,offset:i-n};n=c}e:{for(;a;){if(a.nextSibling){a=a.nextSibling;break e}a=a.parentNode}a=void 0}a=fg(a)}}function gg(n,i){return n&&i?n===i?!0:n&&n.nodeType===3?!1:i&&i.nodeType===3?gg(n,i.parentNode):"contains"in n?n.contains(i):n.compareDocumentPosition?!!(n.compareDocumentPosition(i)&16):!1:!1}function pg(){for(var n=window,i=Hn();i instanceof n.HTMLIFrameElement;){try{var a=typeof i.contentWindow.location.href=="string"}catch{a=!1}if(a)n=i.contentWindow;else break;i=Hn(n.document)}return i}function tc(n){var i=n&&n.nodeName&&n.nodeName.toLowerCase();return i&&(i==="input"&&(n.type==="text"||n.type==="search"||n.type==="tel"||n.type==="url"||n.type==="password")||i==="textarea"||n.contentEditable==="true")}function zy(n){var i=pg(),a=n.focusedElem,c=n.selectionRange;if(i!==a&&a&&a.ownerDocument&&gg(a.ownerDocument.documentElement,a)){if(c!==null&&tc(a)){if(i=c.start,n=c.end,n===void 0&&(n=i),"selectionStart"in a)a.selectionStart=i,a.selectionEnd=Math.min(n,a.value.length);else if(n=(i=a.ownerDocument||document)&&i.defaultView||window,n.getSelection){n=n.getSelection();var h=a.textContent.length,p=Math.min(c.start,h);c=c.end===void 0?p:Math.min(c.end,h),!n.extend&&p>c&&(h=c,c=p,p=h),h=hg(a,p);var S=hg(a,c);h&&S&&(n.rangeCount!==1||n.anchorNode!==h.node||n.anchorOffset!==h.offset||n.focusNode!==S.node||n.focusOffset!==S.offset)&&(i=i.createRange(),i.setStart(h.node,h.offset),n.removeAllRanges(),p>c?(n.addRange(i),n.extend(S.node,S.offset)):(i.setEnd(S.node,S.offset),n.addRange(i)))}}for(i=[],n=a;n=n.parentNode;)n.nodeType===1&&i.push({element:n,left:n.scrollLeft,top:n.scrollTop});for(typeof a.focus=="function"&&a.focus(),a=0;a<i.length;a++)n=i[a],n.element.scrollLeft=n.left,n.element.scrollTop=n.top}}var Wy=d&&"documentMode"in document&&11>=document.documentMode,Wr=null,nc=null,as=null,ic=!1;function mg(n,i,a){var c=a.window===a?a.document:a.nodeType===9?a:a.ownerDocument;ic||Wr==null||Wr!==Hn(c)||(c=Wr,"selectionStart"in c&&tc(c)?c={start:c.selectionStart,end:c.selectionEnd}:(c=(c.ownerDocument&&c.ownerDocument.defaultView||window).getSelection(),c={anchorNode:c.anchorNode,anchorOffset:c.anchorOffset,focusNode:c.focusNode,focusOffset:c.focusOffset}),as&&ss(as,c)||(as=c,c=Ba(nc,"onSelect"),0<c.length&&(i=new Vu("onSelect","select",null,i,a),n.push({event:i,listeners:c}),i.target=Wr)))}function Ma(n,i){var a={};return a[n.toLowerCase()]=i.toLowerCase(),a["Webkit"+n]="webkit"+i,a["Moz"+n]="moz"+i,a}var Yr={animationend:Ma("Animation","AnimationEnd"),animationiteration:Ma("Animation","AnimationIteration"),animationstart:Ma("Animation","AnimationStart"),transitionend:Ma("Transition","TransitionEnd")},rc={},vg={};d&&(vg=document.createElement("div").style,"AnimationEvent"in window||(delete Yr.animationend.animation,delete Yr.animationiteration.animation,delete Yr.animationstart.animation),"TransitionEvent"in window||delete Yr.transitionend.transition);function Fa(n){if(rc[n])return rc[n];if(!Yr[n])return n;var i=Yr[n],a;for(a in i)if(i.hasOwnProperty(a)&&a in vg)return rc[n]=i[a];return n}var Sg=Fa("animationend"),yg=Fa("animationiteration"),Tg=Fa("animationstart"),Ag=Fa("transitionend"),Ig=new Map,Eg="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function _i(n,i){Ig.set(n,i),s(i,[n])}for(var oc=0;oc<Eg.length;oc++){var sc=Eg[oc],Yy=sc.toLowerCase(),jy=sc[0].toUpperCase()+sc.slice(1);_i(Yy,"on"+jy)}_i(Sg,"onAnimationEnd"),_i(yg,"onAnimationIteration"),_i(Tg,"onAnimationStart"),_i("dblclick","onDoubleClick"),_i("focusin","onFocus"),_i("focusout","onBlur"),_i(Ag,"onTransitionEnd"),u("onMouseEnter",["mouseout","mouseover"]),u("onMouseLeave",["mouseout","mouseover"]),u("onPointerEnter",["pointerout","pointerover"]),u("onPointerLeave",["pointerout","pointerover"]),s("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),s("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),s("onBeforeInput",["compositionend","keypress","textInput","paste"]),s("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),s("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),s("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var ls="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Vy=new Set("cancel close invalid load scroll toggle".split(" ").concat(ls));function wg(n,i,a){var c=n.type||"unknown-event";n.currentTarget=a,YS(c,i,void 0,n),n.currentTarget=null}function _g(n,i){i=(i&4)!==0;for(var a=0;a<n.length;a++){var c=n[a],h=c.event;c=c.listeners;e:{var p=void 0;if(i)for(var S=c.length-1;0<=S;S--){var A=c[S],R=A.instance,M=A.currentTarget;if(A=A.listener,R!==p&&h.isPropagationStopped())break e;wg(h,A,M),p=R}else for(S=0;S<c.length;S++){if(A=c[S],R=A.instance,M=A.currentTarget,A=A.listener,R!==p&&h.isPropagationStopped())break e;wg(h,A,M),p=R}}}if(Sa)throw n=Lu,Sa=!1,Lu=null,n}function Ve(n,i){var a=i[gc];a===void 0&&(a=i[gc]=new Set);var c=n+"__bubble";a.has(c)||(Cg(i,n,2,!1),a.add(c))}function ac(n,i,a){var c=0;i&&(c|=4),Cg(a,n,c,i)}var Ua="_reactListening"+Math.random().toString(36).slice(2);function us(n){if(!n[Ua]){n[Ua]=!0,o.forEach(function(a){a!=="selectionchange"&&(Vy.has(a)||ac(a,!1,n),ac(a,!0,n))});var i=n.nodeType===9?n:n.ownerDocument;i===null||i[Ua]||(i[Ua]=!0,ac("selectionchange",!1,i))}}function Cg(n,i,a,c){switch(Kh(i)){case 1:var h=ay;break;case 4:h=ly;break;default:h=Wu}a=h.bind(null,i,a,n),h=void 0,!Bu||i!=="touchstart"&&i!=="touchmove"&&i!=="wheel"||(h=!0),c?h!==void 0?n.addEventListener(i,a,{capture:!0,passive:h}):n.addEventListener(i,a,!0):h!==void 0?n.addEventListener(i,a,{passive:h}):n.addEventListener(i,a,!1)}function lc(n,i,a,c,h){var p=c;if((i&1)===0&&(i&2)===0&&c!==null)e:for(;;){if(c===null)return;var S=c.tag;if(S===3||S===4){var A=c.stateNode.containerInfo;if(A===h||A.nodeType===8&&A.parentNode===h)break;if(S===4)for(S=c.return;S!==null;){var R=S.tag;if((R===3||R===4)&&(R=S.stateNode.containerInfo,R===h||R.nodeType===8&&R.parentNode===h))return;S=S.return}for(;A!==null;){if(S=or(A),S===null)return;if(R=S.tag,R===5||R===6){c=p=S;continue e}A=A.parentNode}}c=c.return}kh(function(){var M=p,G=Mu(a),z=[];e:{var b=Ig.get(n);if(b!==void 0){var q=Vu,te=n;switch(n){case"keypress":if(Na(a)===0)break e;case"keydown":case"keyup":q=Ey;break;case"focusin":te="focus",q=Zu;break;case"focusout":te="blur",q=Zu;break;case"beforeblur":case"afterblur":q=Zu;break;case"click":if(a.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":q=Qh;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":q=dy;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":q=Cy;break;case Sg:case yg:case Tg:q=gy;break;case Ag:q=Py;break;case"scroll":q=uy;break;case"wheel":q=Dy;break;case"copy":case"cut":case"paste":q=my;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":q=eg}var oe=(i&4)!==0,lt=!oe&&n==="scroll",k=oe?b!==null?b+"Capture":null:b;oe=[];for(var N=M,O;N!==null;){O=N;var j=O.stateNode;if(O.tag===5&&j!==null&&(O=j,k!==null&&(j=Yo(N,k),j!=null&&oe.push(cs(N,j,O)))),lt)break;N=N.return}0<oe.length&&(b=new q(b,te,null,a,G),z.push({event:b,listeners:oe}))}}if((i&7)===0){e:{if(b=n==="mouseover"||n==="pointerover",q=n==="mouseout"||n==="pointerout",b&&a!==Ou&&(te=a.relatedTarget||a.fromElement)&&(or(te)||te[ei]))break e;if((q||b)&&(b=G.window===G?G:(b=G.ownerDocument)?b.defaultView||b.parentWindow:window,q?(te=a.relatedTarget||a.toElement,q=M,te=te?or(te):null,te!==null&&(lt=rr(te),te!==lt||te.tag!==5&&te.tag!==6)&&(te=null)):(q=null,te=M),q!==te)){if(oe=Qh,j="onMouseLeave",k="onMouseEnter",N="mouse",(n==="pointerout"||n==="pointerover")&&(oe=eg,j="onPointerLeave",k="onPointerEnter",N="pointer"),lt=q==null?b:Xr(q),O=te==null?b:Xr(te),b=new oe(j,N+"leave",q,a,G),b.target=lt,b.relatedTarget=O,j=null,or(G)===M&&(oe=new oe(k,N+"enter",te,a,G),oe.target=O,oe.relatedTarget=lt,j=oe),lt=j,q&&te)t:{for(oe=q,k=te,N=0,O=oe;O;O=jr(O))N++;for(O=0,j=k;j;j=jr(j))O++;for(;0<N-O;)oe=jr(oe),N--;for(;0<O-N;)k=jr(k),O--;for(;N--;){if(oe===k||k!==null&&oe===k.alternate)break t;oe=jr(oe),k=jr(k)}oe=null}else oe=null;q!==null&&Rg(z,b,q,oe,!1),te!==null&&lt!==null&&Rg(z,lt,te,oe,!0)}}e:{if(b=M?Xr(M):window,q=b.nodeName&&b.nodeName.toLowerCase(),q==="select"||q==="input"&&b.type==="file")var le=Ly;else if(sg(b))if(lg)le=xy;else{le=by;var me=Hy}else(q=b.nodeName)&&q.toLowerCase()==="input"&&(b.type==="checkbox"||b.type==="radio")&&(le=Gy);if(le&&(le=le(n,M))){ag(z,le,a,G);break e}me&&me(n,b,M),n==="focusout"&&(me=b._wrapperState)&&me.controlled&&b.type==="number"&&Gn(b,"number",b.value)}switch(me=M?Xr(M):window,n){case"focusin":(sg(me)||me.contentEditable==="true")&&(Wr=me,nc=M,as=null);break;case"focusout":as=nc=Wr=null;break;case"mousedown":ic=!0;break;case"contextmenu":case"mouseup":case"dragend":ic=!1,mg(z,a,G);break;case"selectionchange":if(Wy)break;case"keydown":case"keyup":mg(z,a,G)}var ve;if(Qu)e:{switch(n){case"compositionstart":var we="onCompositionStart";break e;case"compositionend":we="onCompositionEnd";break e;case"compositionupdate":we="onCompositionUpdate";break e}we=void 0}else zr?rg(n,a)&&(we="onCompositionEnd"):n==="keydown"&&a.keyCode===229&&(we="onCompositionStart");we&&(tg&&a.locale!=="ko"&&(zr||we!=="onCompositionStart"?we==="onCompositionEnd"&&zr&&(ve=Zh()):(wi=G,ju="value"in wi?wi.value:wi.textContent,zr=!0)),me=Ba(M,we),0<me.length&&(we=new Jh(we,n,null,a,G),z.push({event:we,listeners:me}),ve?we.data=ve:(ve=og(a),ve!==null&&(we.data=ve)))),(ve=Oy?My(n,a):Fy(n,a))&&(M=Ba(M,"onBeforeInput"),0<M.length&&(G=new Jh("onBeforeInput","beforeinput",null,a,G),z.push({event:G,listeners:M}),G.data=ve))}_g(z,i)})}function cs(n,i,a){return{instance:n,listener:i,currentTarget:a}}function Ba(n,i){for(var a=i+"Capture",c=[];n!==null;){var h=n,p=h.stateNode;h.tag===5&&p!==null&&(h=p,p=Yo(n,a),p!=null&&c.unshift(cs(n,p,h)),p=Yo(n,i),p!=null&&c.push(cs(n,p,h))),n=n.return}return c}function jr(n){if(n===null)return null;do n=n.return;while(n&&n.tag!==5);return n||null}function Rg(n,i,a,c,h){for(var p=i._reactName,S=[];a!==null&&a!==c;){var A=a,R=A.alternate,M=A.stateNode;if(R!==null&&R===c)break;A.tag===5&&M!==null&&(A=M,h?(R=Yo(a,p),R!=null&&S.unshift(cs(a,R,A))):h||(R=Yo(a,p),R!=null&&S.push(cs(a,R,A)))),a=a.return}S.length!==0&&n.push({event:i,listeners:S})}var Xy=/\r\n?/g,Ky=/\u0000|\uFFFD/g;function Pg(n){return(typeof n=="string"?n:""+n).replace(Xy,`
`).replace(Ky,"")}function La(n,i,a){if(i=Pg(i),Pg(n)!==i&&a)throw Error(r(425))}function Ha(){}var uc=null,cc=null;function dc(n,i){return n==="textarea"||n==="noscript"||typeof i.children=="string"||typeof i.children=="number"||typeof i.dangerouslySetInnerHTML=="object"&&i.dangerouslySetInnerHTML!==null&&i.dangerouslySetInnerHTML.__html!=null}var fc=typeof setTimeout=="function"?setTimeout:void 0,Zy=typeof clearTimeout=="function"?clearTimeout:void 0,Ng=typeof Promise=="function"?Promise:void 0,qy=typeof queueMicrotask=="function"?queueMicrotask:typeof Ng<"u"?function(n){return Ng.resolve(null).then(n).catch(Qy)}:fc;function Qy(n){setTimeout(function(){throw n})}function hc(n,i){var a=i,c=0;do{var h=a.nextSibling;if(n.removeChild(a),h&&h.nodeType===8)if(a=h.data,a==="/$"){if(c===0){n.removeChild(h),es(i);return}c--}else a!=="$"&&a!=="$?"&&a!=="$!"||c++;a=h}while(a);es(i)}function Ci(n){for(;n!=null;n=n.nextSibling){var i=n.nodeType;if(i===1||i===3)break;if(i===8){if(i=n.data,i==="$"||i==="$!"||i==="$?")break;if(i==="/$")return null}}return n}function Dg(n){n=n.previousSibling;for(var i=0;n;){if(n.nodeType===8){var a=n.data;if(a==="$"||a==="$!"||a==="$?"){if(i===0)return n;i--}else a==="/$"&&i++}n=n.previousSibling}return null}var Vr=Math.random().toString(36).slice(2),zn="__reactFiber$"+Vr,ds="__reactProps$"+Vr,ei="__reactContainer$"+Vr,gc="__reactEvents$"+Vr,Jy="__reactListeners$"+Vr,eT="__reactHandles$"+Vr;function or(n){var i=n[zn];if(i)return i;for(var a=n.parentNode;a;){if(i=a[ei]||a[zn]){if(a=i.alternate,i.child!==null||a!==null&&a.child!==null)for(n=Dg(n);n!==null;){if(a=n[zn])return a;n=Dg(n)}return i}n=a,a=n.parentNode}return null}function fs(n){return n=n[zn]||n[ei],!n||n.tag!==5&&n.tag!==6&&n.tag!==13&&n.tag!==3?null:n}function Xr(n){if(n.tag===5||n.tag===6)return n.stateNode;throw Error(r(33))}function ba(n){return n[ds]||null}var pc=[],Kr=-1;function Ri(n){return{current:n}}function Xe(n){0>Kr||(n.current=pc[Kr],pc[Kr]=null,Kr--)}function Ye(n,i){Kr++,pc[Kr]=n.current,n.current=i}var Pi={},Dt=Ri(Pi),jt=Ri(!1),sr=Pi;function Zr(n,i){var a=n.type.contextTypes;if(!a)return Pi;var c=n.stateNode;if(c&&c.__reactInternalMemoizedUnmaskedChildContext===i)return c.__reactInternalMemoizedMaskedChildContext;var h={},p;for(p in a)h[p]=i[p];return c&&(n=n.stateNode,n.__reactInternalMemoizedUnmaskedChildContext=i,n.__reactInternalMemoizedMaskedChildContext=h),h}function Vt(n){return n=n.childContextTypes,n!=null}function Ga(){Xe(jt),Xe(Dt)}function kg(n,i,a){if(Dt.current!==Pi)throw Error(r(168));Ye(Dt,i),Ye(jt,a)}function Og(n,i,a){var c=n.stateNode;if(i=i.childContextTypes,typeof c.getChildContext!="function")return a;c=c.getChildContext();for(var h in c)if(!(h in i))throw Error(r(108,Ee(n)||"Unknown",h));return Y({},a,c)}function xa(n){return n=(n=n.stateNode)&&n.__reactInternalMemoizedMergedChildContext||Pi,sr=Dt.current,Ye(Dt,n),Ye(jt,jt.current),!0}function Mg(n,i,a){var c=n.stateNode;if(!c)throw Error(r(169));a?(n=Og(n,i,sr),c.__reactInternalMemoizedMergedChildContext=n,Xe(jt),Xe(Dt),Ye(Dt,n)):Xe(jt),Ye(jt,a)}var ti=null,$a=!1,mc=!1;function Fg(n){ti===null?ti=[n]:ti.push(n)}function tT(n){$a=!0,Fg(n)}function Ni(){if(!mc&&ti!==null){mc=!0;var n=0,i=We;try{var a=ti;for(We=1;n<a.length;n++){var c=a[n];do c=c(!0);while(c!==null)}ti=null,$a=!1}catch(h){throw ti!==null&&(ti=ti.slice(n+1)),Bh(Hu,Ni),h}finally{We=i,mc=!1}}return null}var qr=[],Qr=0,za=null,Wa=0,cn=[],dn=0,ar=null,ni=1,ii="";function lr(n,i){qr[Qr++]=Wa,qr[Qr++]=za,za=n,Wa=i}function Ug(n,i,a){cn[dn++]=ni,cn[dn++]=ii,cn[dn++]=ar,ar=n;var c=ni;n=ii;var h=32-En(c)-1;c&=~(1<<h),a+=1;var p=32-En(i)+h;if(30<p){var S=h-h%5;p=(c&(1<<S)-1).toString(32),c>>=S,h-=S,ni=1<<32-En(i)+h|a<<h|c,ii=p+n}else ni=1<<p|a<<h|c,ii=n}function vc(n){n.return!==null&&(lr(n,1),Ug(n,1,0))}function Sc(n){for(;n===za;)za=qr[--Qr],qr[Qr]=null,Wa=qr[--Qr],qr[Qr]=null;for(;n===ar;)ar=cn[--dn],cn[dn]=null,ii=cn[--dn],cn[dn]=null,ni=cn[--dn],cn[dn]=null}var tn=null,nn=null,Qe=!1,_n=null;function Bg(n,i){var a=pn(5,null,null,0);a.elementType="DELETED",a.stateNode=i,a.return=n,i=n.deletions,i===null?(n.deletions=[a],n.flags|=16):i.push(a)}function Lg(n,i){switch(n.tag){case 5:var a=n.type;return i=i.nodeType!==1||a.toLowerCase()!==i.nodeName.toLowerCase()?null:i,i!==null?(n.stateNode=i,tn=n,nn=Ci(i.firstChild),!0):!1;case 6:return i=n.pendingProps===""||i.nodeType!==3?null:i,i!==null?(n.stateNode=i,tn=n,nn=null,!0):!1;case 13:return i=i.nodeType!==8?null:i,i!==null?(a=ar!==null?{id:ni,overflow:ii}:null,n.memoizedState={dehydrated:i,treeContext:a,retryLane:1073741824},a=pn(18,null,null,0),a.stateNode=i,a.return=n,n.child=a,tn=n,nn=null,!0):!1;default:return!1}}function yc(n){return(n.mode&1)!==0&&(n.flags&128)===0}function Tc(n){if(Qe){var i=nn;if(i){var a=i;if(!Lg(n,i)){if(yc(n))throw Error(r(418));i=Ci(a.nextSibling);var c=tn;i&&Lg(n,i)?Bg(c,a):(n.flags=n.flags&-4097|2,Qe=!1,tn=n)}}else{if(yc(n))throw Error(r(418));n.flags=n.flags&-4097|2,Qe=!1,tn=n}}}function Hg(n){for(n=n.return;n!==null&&n.tag!==5&&n.tag!==3&&n.tag!==13;)n=n.return;tn=n}function Ya(n){if(n!==tn)return!1;if(!Qe)return Hg(n),Qe=!0,!1;var i;if((i=n.tag!==3)&&!(i=n.tag!==5)&&(i=n.type,i=i!=="head"&&i!=="body"&&!dc(n.type,n.memoizedProps)),i&&(i=nn)){if(yc(n))throw bg(),Error(r(418));for(;i;)Bg(n,i),i=Ci(i.nextSibling)}if(Hg(n),n.tag===13){if(n=n.memoizedState,n=n!==null?n.dehydrated:null,!n)throw Error(r(317));e:{for(n=n.nextSibling,i=0;n;){if(n.nodeType===8){var a=n.data;if(a==="/$"){if(i===0){nn=Ci(n.nextSibling);break e}i--}else a!=="$"&&a!=="$!"&&a!=="$?"||i++}n=n.nextSibling}nn=null}}else nn=tn?Ci(n.stateNode.nextSibling):null;return!0}function bg(){for(var n=nn;n;)n=Ci(n.nextSibling)}function Jr(){nn=tn=null,Qe=!1}function Ac(n){_n===null?_n=[n]:_n.push(n)}var nT=H.ReactCurrentBatchConfig;function hs(n,i,a){if(n=a.ref,n!==null&&typeof n!="function"&&typeof n!="object"){if(a._owner){if(a=a._owner,a){if(a.tag!==1)throw Error(r(309));var c=a.stateNode}if(!c)throw Error(r(147,n));var h=c,p=""+n;return i!==null&&i.ref!==null&&typeof i.ref=="function"&&i.ref._stringRef===p?i.ref:(i=function(S){var A=h.refs;S===null?delete A[p]:A[p]=S},i._stringRef=p,i)}if(typeof n!="string")throw Error(r(284));if(!a._owner)throw Error(r(290,n))}return n}function ja(n,i){throw n=Object.prototype.toString.call(i),Error(r(31,n==="[object Object]"?"object with keys {"+Object.keys(i).join(", ")+"}":n))}function Gg(n){var i=n._init;return i(n._payload)}function xg(n){function i(k,N){if(n){var O=k.deletions;O===null?(k.deletions=[N],k.flags|=16):O.push(N)}}function a(k,N){if(!n)return null;for(;N!==null;)i(k,N),N=N.sibling;return null}function c(k,N){for(k=new Map;N!==null;)N.key!==null?k.set(N.key,N):k.set(N.index,N),N=N.sibling;return k}function h(k,N){return k=Li(k,N),k.index=0,k.sibling=null,k}function p(k,N,O){return k.index=O,n?(O=k.alternate,O!==null?(O=O.index,O<N?(k.flags|=2,N):O):(k.flags|=2,N)):(k.flags|=1048576,N)}function S(k){return n&&k.alternate===null&&(k.flags|=2),k}function A(k,N,O,j){return N===null||N.tag!==6?(N=fd(O,k.mode,j),N.return=k,N):(N=h(N,O),N.return=k,N)}function R(k,N,O,j){var le=O.type;return le===$?G(k,N,O.props.children,j,O.key):N!==null&&(N.elementType===le||typeof le=="object"&&le!==null&&le.$$typeof===Te&&Gg(le)===N.type)?(j=h(N,O.props),j.ref=hs(k,N,O),j.return=k,j):(j=ml(O.type,O.key,O.props,null,k.mode,j),j.ref=hs(k,N,O),j.return=k,j)}function M(k,N,O,j){return N===null||N.tag!==4||N.stateNode.containerInfo!==O.containerInfo||N.stateNode.implementation!==O.implementation?(N=hd(O,k.mode,j),N.return=k,N):(N=h(N,O.children||[]),N.return=k,N)}function G(k,N,O,j,le){return N===null||N.tag!==7?(N=mr(O,k.mode,j,le),N.return=k,N):(N=h(N,O),N.return=k,N)}function z(k,N,O){if(typeof N=="string"&&N!==""||typeof N=="number")return N=fd(""+N,k.mode,O),N.return=k,N;if(typeof N=="object"&&N!==null){switch(N.$$typeof){case x:return O=ml(N.type,N.key,N.props,null,k.mode,O),O.ref=hs(k,null,N),O.return=k,O;case U:return N=hd(N,k.mode,O),N.return=k,N;case Te:var j=N._init;return z(k,j(N._payload),O)}if(xn(N)||X(N))return N=mr(N,k.mode,O,null),N.return=k,N;ja(k,N)}return null}function b(k,N,O,j){var le=N!==null?N.key:null;if(typeof O=="string"&&O!==""||typeof O=="number")return le!==null?null:A(k,N,""+O,j);if(typeof O=="object"&&O!==null){switch(O.$$typeof){case x:return O.key===le?R(k,N,O,j):null;case U:return O.key===le?M(k,N,O,j):null;case Te:return le=O._init,b(k,N,le(O._payload),j)}if(xn(O)||X(O))return le!==null?null:G(k,N,O,j,null);ja(k,O)}return null}function q(k,N,O,j,le){if(typeof j=="string"&&j!==""||typeof j=="number")return k=k.get(O)||null,A(N,k,""+j,le);if(typeof j=="object"&&j!==null){switch(j.$$typeof){case x:return k=k.get(j.key===null?O:j.key)||null,R(N,k,j,le);case U:return k=k.get(j.key===null?O:j.key)||null,M(N,k,j,le);case Te:var me=j._init;return q(k,N,O,me(j._payload),le)}if(xn(j)||X(j))return k=k.get(O)||null,G(N,k,j,le,null);ja(N,j)}return null}function te(k,N,O,j){for(var le=null,me=null,ve=N,we=N=0,yt=null;ve!==null&&we<O.length;we++){ve.index>we?(yt=ve,ve=null):yt=ve.sibling;var xe=b(k,ve,O[we],j);if(xe===null){ve===null&&(ve=yt);break}n&&ve&&xe.alternate===null&&i(k,ve),N=p(xe,N,we),me===null?le=xe:me.sibling=xe,me=xe,ve=yt}if(we===O.length)return a(k,ve),Qe&&lr(k,we),le;if(ve===null){for(;we<O.length;we++)ve=z(k,O[we],j),ve!==null&&(N=p(ve,N,we),me===null?le=ve:me.sibling=ve,me=ve);return Qe&&lr(k,we),le}for(ve=c(k,ve);we<O.length;we++)yt=q(ve,k,we,O[we],j),yt!==null&&(n&&yt.alternate!==null&&ve.delete(yt.key===null?we:yt.key),N=p(yt,N,we),me===null?le=yt:me.sibling=yt,me=yt);return n&&ve.forEach(function(Hi){return i(k,Hi)}),Qe&&lr(k,we),le}function oe(k,N,O,j){var le=X(O);if(typeof le!="function")throw Error(r(150));if(O=le.call(O),O==null)throw Error(r(151));for(var me=le=null,ve=N,we=N=0,yt=null,xe=O.next();ve!==null&&!xe.done;we++,xe=O.next()){ve.index>we?(yt=ve,ve=null):yt=ve.sibling;var Hi=b(k,ve,xe.value,j);if(Hi===null){ve===null&&(ve=yt);break}n&&ve&&Hi.alternate===null&&i(k,ve),N=p(Hi,N,we),me===null?le=Hi:me.sibling=Hi,me=Hi,ve=yt}if(xe.done)return a(k,ve),Qe&&lr(k,we),le;if(ve===null){for(;!xe.done;we++,xe=O.next())xe=z(k,xe.value,j),xe!==null&&(N=p(xe,N,we),me===null?le=xe:me.sibling=xe,me=xe);return Qe&&lr(k,we),le}for(ve=c(k,ve);!xe.done;we++,xe=O.next())xe=q(ve,k,we,xe.value,j),xe!==null&&(n&&xe.alternate!==null&&ve.delete(xe.key===null?we:xe.key),N=p(xe,N,we),me===null?le=xe:me.sibling=xe,me=xe);return n&&ve.forEach(function(UT){return i(k,UT)}),Qe&&lr(k,we),le}function lt(k,N,O,j){if(typeof O=="object"&&O!==null&&O.type===$&&O.key===null&&(O=O.props.children),typeof O=="object"&&O!==null){switch(O.$$typeof){case x:e:{for(var le=O.key,me=N;me!==null;){if(me.key===le){if(le=O.type,le===$){if(me.tag===7){a(k,me.sibling),N=h(me,O.props.children),N.return=k,k=N;break e}}else if(me.elementType===le||typeof le=="object"&&le!==null&&le.$$typeof===Te&&Gg(le)===me.type){a(k,me.sibling),N=h(me,O.props),N.ref=hs(k,me,O),N.return=k,k=N;break e}a(k,me);break}else i(k,me);me=me.sibling}O.type===$?(N=mr(O.props.children,k.mode,j,O.key),N.return=k,k=N):(j=ml(O.type,O.key,O.props,null,k.mode,j),j.ref=hs(k,N,O),j.return=k,k=j)}return S(k);case U:e:{for(me=O.key;N!==null;){if(N.key===me)if(N.tag===4&&N.stateNode.containerInfo===O.containerInfo&&N.stateNode.implementation===O.implementation){a(k,N.sibling),N=h(N,O.children||[]),N.return=k,k=N;break e}else{a(k,N);break}else i(k,N);N=N.sibling}N=hd(O,k.mode,j),N.return=k,k=N}return S(k);case Te:return me=O._init,lt(k,N,me(O._payload),j)}if(xn(O))return te(k,N,O,j);if(X(O))return oe(k,N,O,j);ja(k,O)}return typeof O=="string"&&O!==""||typeof O=="number"?(O=""+O,N!==null&&N.tag===6?(a(k,N.sibling),N=h(N,O),N.return=k,k=N):(a(k,N),N=fd(O,k.mode,j),N.return=k,k=N),S(k)):a(k,N)}return lt}var eo=xg(!0),$g=xg(!1),Va=Ri(null),Xa=null,to=null,Ic=null;function Ec(){Ic=to=Xa=null}function wc(n){var i=Va.current;Xe(Va),n._currentValue=i}function _c(n,i,a){for(;n!==null;){var c=n.alternate;if((n.childLanes&i)!==i?(n.childLanes|=i,c!==null&&(c.childLanes|=i)):c!==null&&(c.childLanes&i)!==i&&(c.childLanes|=i),n===a)break;n=n.return}}function no(n,i){Xa=n,Ic=to=null,n=n.dependencies,n!==null&&n.firstContext!==null&&((n.lanes&i)!==0&&(Xt=!0),n.firstContext=null)}function fn(n){var i=n._currentValue;if(Ic!==n)if(n={context:n,memoizedValue:i,next:null},to===null){if(Xa===null)throw Error(r(308));to=n,Xa.dependencies={lanes:0,firstContext:n}}else to=to.next=n;return i}var ur=null;function Cc(n){ur===null?ur=[n]:ur.push(n)}function zg(n,i,a,c){var h=i.interleaved;return h===null?(a.next=a,Cc(i)):(a.next=h.next,h.next=a),i.interleaved=a,ri(n,c)}function ri(n,i){n.lanes|=i;var a=n.alternate;for(a!==null&&(a.lanes|=i),a=n,n=n.return;n!==null;)n.childLanes|=i,a=n.alternate,a!==null&&(a.childLanes|=i),a=n,n=n.return;return a.tag===3?a.stateNode:null}var Di=!1;function Rc(n){n.updateQueue={baseState:n.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Wg(n,i){n=n.updateQueue,i.updateQueue===n&&(i.updateQueue={baseState:n.baseState,firstBaseUpdate:n.firstBaseUpdate,lastBaseUpdate:n.lastBaseUpdate,shared:n.shared,effects:n.effects})}function oi(n,i){return{eventTime:n,lane:i,tag:0,payload:null,callback:null,next:null}}function ki(n,i,a){var c=n.updateQueue;if(c===null)return null;if(c=c.shared,(He&2)!==0){var h=c.pending;return h===null?i.next=i:(i.next=h.next,h.next=i),c.pending=i,ri(n,a)}return h=c.interleaved,h===null?(i.next=i,Cc(c)):(i.next=h.next,h.next=i),c.interleaved=i,ri(n,a)}function Ka(n,i,a){if(i=i.updateQueue,i!==null&&(i=i.shared,(a&4194240)!==0)){var c=i.lanes;c&=n.pendingLanes,a|=c,i.lanes=a,xu(n,a)}}function Yg(n,i){var a=n.updateQueue,c=n.alternate;if(c!==null&&(c=c.updateQueue,a===c)){var h=null,p=null;if(a=a.firstBaseUpdate,a!==null){do{var S={eventTime:a.eventTime,lane:a.lane,tag:a.tag,payload:a.payload,callback:a.callback,next:null};p===null?h=p=S:p=p.next=S,a=a.next}while(a!==null);p===null?h=p=i:p=p.next=i}else h=p=i;a={baseState:c.baseState,firstBaseUpdate:h,lastBaseUpdate:p,shared:c.shared,effects:c.effects},n.updateQueue=a;return}n=a.lastBaseUpdate,n===null?a.firstBaseUpdate=i:n.next=i,a.lastBaseUpdate=i}function Za(n,i,a,c){var h=n.updateQueue;Di=!1;var p=h.firstBaseUpdate,S=h.lastBaseUpdate,A=h.shared.pending;if(A!==null){h.shared.pending=null;var R=A,M=R.next;R.next=null,S===null?p=M:S.next=M,S=R;var G=n.alternate;G!==null&&(G=G.updateQueue,A=G.lastBaseUpdate,A!==S&&(A===null?G.firstBaseUpdate=M:A.next=M,G.lastBaseUpdate=R))}if(p!==null){var z=h.baseState;S=0,G=M=R=null,A=p;do{var b=A.lane,q=A.eventTime;if((c&b)===b){G!==null&&(G=G.next={eventTime:q,lane:0,tag:A.tag,payload:A.payload,callback:A.callback,next:null});e:{var te=n,oe=A;switch(b=i,q=a,oe.tag){case 1:if(te=oe.payload,typeof te=="function"){z=te.call(q,z,b);break e}z=te;break e;case 3:te.flags=te.flags&-65537|128;case 0:if(te=oe.payload,b=typeof te=="function"?te.call(q,z,b):te,b==null)break e;z=Y({},z,b);break e;case 2:Di=!0}}A.callback!==null&&A.lane!==0&&(n.flags|=64,b=h.effects,b===null?h.effects=[A]:b.push(A))}else q={eventTime:q,lane:b,tag:A.tag,payload:A.payload,callback:A.callback,next:null},G===null?(M=G=q,R=z):G=G.next=q,S|=b;if(A=A.next,A===null){if(A=h.shared.pending,A===null)break;b=A,A=b.next,b.next=null,h.lastBaseUpdate=b,h.shared.pending=null}}while(!0);if(G===null&&(R=z),h.baseState=R,h.firstBaseUpdate=M,h.lastBaseUpdate=G,i=h.shared.interleaved,i!==null){h=i;do S|=h.lane,h=h.next;while(h!==i)}else p===null&&(h.shared.lanes=0);fr|=S,n.lanes=S,n.memoizedState=z}}function jg(n,i,a){if(n=i.effects,i.effects=null,n!==null)for(i=0;i<n.length;i++){var c=n[i],h=c.callback;if(h!==null){if(c.callback=null,c=a,typeof h!="function")throw Error(r(191,h));h.call(c)}}}var gs={},Wn=Ri(gs),ps=Ri(gs),ms=Ri(gs);function cr(n){if(n===gs)throw Error(r(174));return n}function Pc(n,i){switch(Ye(ms,i),Ye(ps,n),Ye(Wn,gs),n=i.nodeType,n){case 9:case 11:i=(i=i.documentElement)?i.namespaceURI:Nu(null,"");break;default:n=n===8?i.parentNode:i,i=n.namespaceURI||null,n=n.tagName,i=Nu(i,n)}Xe(Wn),Ye(Wn,i)}function io(){Xe(Wn),Xe(ps),Xe(ms)}function Vg(n){cr(ms.current);var i=cr(Wn.current),a=Nu(i,n.type);i!==a&&(Ye(ps,n),Ye(Wn,a))}function Nc(n){ps.current===n&&(Xe(Wn),Xe(ps))}var it=Ri(0);function qa(n){for(var i=n;i!==null;){if(i.tag===13){var a=i.memoizedState;if(a!==null&&(a=a.dehydrated,a===null||a.data==="$?"||a.data==="$!"))return i}else if(i.tag===19&&i.memoizedProps.revealOrder!==void 0){if((i.flags&128)!==0)return i}else if(i.child!==null){i.child.return=i,i=i.child;continue}if(i===n)break;for(;i.sibling===null;){if(i.return===null||i.return===n)return null;i=i.return}i.sibling.return=i.return,i=i.sibling}return null}var Dc=[];function kc(){for(var n=0;n<Dc.length;n++)Dc[n]._workInProgressVersionPrimary=null;Dc.length=0}var Qa=H.ReactCurrentDispatcher,Oc=H.ReactCurrentBatchConfig,dr=0,rt=null,gt=null,vt=null,Ja=!1,vs=!1,Ss=0,iT=0;function kt(){throw Error(r(321))}function Mc(n,i){if(i===null)return!1;for(var a=0;a<i.length&&a<n.length;a++)if(!wn(n[a],i[a]))return!1;return!0}function Fc(n,i,a,c,h,p){if(dr=p,rt=i,i.memoizedState=null,i.updateQueue=null,i.lanes=0,Qa.current=n===null||n.memoizedState===null?aT:lT,n=a(c,h),vs){p=0;do{if(vs=!1,Ss=0,25<=p)throw Error(r(301));p+=1,vt=gt=null,i.updateQueue=null,Qa.current=uT,n=a(c,h)}while(vs)}if(Qa.current=nl,i=gt!==null&&gt.next!==null,dr=0,vt=gt=rt=null,Ja=!1,i)throw Error(r(300));return n}function Uc(){var n=Ss!==0;return Ss=0,n}function Yn(){var n={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return vt===null?rt.memoizedState=vt=n:vt=vt.next=n,vt}function hn(){if(gt===null){var n=rt.alternate;n=n!==null?n.memoizedState:null}else n=gt.next;var i=vt===null?rt.memoizedState:vt.next;if(i!==null)vt=i,gt=n;else{if(n===null)throw Error(r(310));gt=n,n={memoizedState:gt.memoizedState,baseState:gt.baseState,baseQueue:gt.baseQueue,queue:gt.queue,next:null},vt===null?rt.memoizedState=vt=n:vt=vt.next=n}return vt}function ys(n,i){return typeof i=="function"?i(n):i}function Bc(n){var i=hn(),a=i.queue;if(a===null)throw Error(r(311));a.lastRenderedReducer=n;var c=gt,h=c.baseQueue,p=a.pending;if(p!==null){if(h!==null){var S=h.next;h.next=p.next,p.next=S}c.baseQueue=h=p,a.pending=null}if(h!==null){p=h.next,c=c.baseState;var A=S=null,R=null,M=p;do{var G=M.lane;if((dr&G)===G)R!==null&&(R=R.next={lane:0,action:M.action,hasEagerState:M.hasEagerState,eagerState:M.eagerState,next:null}),c=M.hasEagerState?M.eagerState:n(c,M.action);else{var z={lane:G,action:M.action,hasEagerState:M.hasEagerState,eagerState:M.eagerState,next:null};R===null?(A=R=z,S=c):R=R.next=z,rt.lanes|=G,fr|=G}M=M.next}while(M!==null&&M!==p);R===null?S=c:R.next=A,wn(c,i.memoizedState)||(Xt=!0),i.memoizedState=c,i.baseState=S,i.baseQueue=R,a.lastRenderedState=c}if(n=a.interleaved,n!==null){h=n;do p=h.lane,rt.lanes|=p,fr|=p,h=h.next;while(h!==n)}else h===null&&(a.lanes=0);return[i.memoizedState,a.dispatch]}function Lc(n){var i=hn(),a=i.queue;if(a===null)throw Error(r(311));a.lastRenderedReducer=n;var c=a.dispatch,h=a.pending,p=i.memoizedState;if(h!==null){a.pending=null;var S=h=h.next;do p=n(p,S.action),S=S.next;while(S!==h);wn(p,i.memoizedState)||(Xt=!0),i.memoizedState=p,i.baseQueue===null&&(i.baseState=p),a.lastRenderedState=p}return[p,c]}function Xg(){}function Kg(n,i){var a=rt,c=hn(),h=i(),p=!wn(c.memoizedState,h);if(p&&(c.memoizedState=h,Xt=!0),c=c.queue,Hc(Qg.bind(null,a,c,n),[n]),c.getSnapshot!==i||p||vt!==null&&vt.memoizedState.tag&1){if(a.flags|=2048,Ts(9,qg.bind(null,a,c,h,i),void 0,null),St===null)throw Error(r(349));(dr&30)!==0||Zg(a,i,h)}return h}function Zg(n,i,a){n.flags|=16384,n={getSnapshot:i,value:a},i=rt.updateQueue,i===null?(i={lastEffect:null,stores:null},rt.updateQueue=i,i.stores=[n]):(a=i.stores,a===null?i.stores=[n]:a.push(n))}function qg(n,i,a,c){i.value=a,i.getSnapshot=c,Jg(i)&&ep(n)}function Qg(n,i,a){return a(function(){Jg(i)&&ep(n)})}function Jg(n){var i=n.getSnapshot;n=n.value;try{var a=i();return!wn(n,a)}catch{return!0}}function ep(n){var i=ri(n,1);i!==null&&Nn(i,n,1,-1)}function tp(n){var i=Yn();return typeof n=="function"&&(n=n()),i.memoizedState=i.baseState=n,n={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:ys,lastRenderedState:n},i.queue=n,n=n.dispatch=sT.bind(null,rt,n),[i.memoizedState,n]}function Ts(n,i,a,c){return n={tag:n,create:i,destroy:a,deps:c,next:null},i=rt.updateQueue,i===null?(i={lastEffect:null,stores:null},rt.updateQueue=i,i.lastEffect=n.next=n):(a=i.lastEffect,a===null?i.lastEffect=n.next=n:(c=a.next,a.next=n,n.next=c,i.lastEffect=n)),n}function np(){return hn().memoizedState}function el(n,i,a,c){var h=Yn();rt.flags|=n,h.memoizedState=Ts(1|i,a,void 0,c===void 0?null:c)}function tl(n,i,a,c){var h=hn();c=c===void 0?null:c;var p=void 0;if(gt!==null){var S=gt.memoizedState;if(p=S.destroy,c!==null&&Mc(c,S.deps)){h.memoizedState=Ts(i,a,p,c);return}}rt.flags|=n,h.memoizedState=Ts(1|i,a,p,c)}function ip(n,i){return el(8390656,8,n,i)}function Hc(n,i){return tl(2048,8,n,i)}function rp(n,i){return tl(4,2,n,i)}function op(n,i){return tl(4,4,n,i)}function sp(n,i){if(typeof i=="function")return n=n(),i(n),function(){i(null)};if(i!=null)return n=n(),i.current=n,function(){i.current=null}}function ap(n,i,a){return a=a!=null?a.concat([n]):null,tl(4,4,sp.bind(null,i,n),a)}function bc(){}function lp(n,i){var a=hn();i=i===void 0?null:i;var c=a.memoizedState;return c!==null&&i!==null&&Mc(i,c[1])?c[0]:(a.memoizedState=[n,i],n)}function up(n,i){var a=hn();i=i===void 0?null:i;var c=a.memoizedState;return c!==null&&i!==null&&Mc(i,c[1])?c[0]:(n=n(),a.memoizedState=[n,i],n)}function cp(n,i,a){return(dr&21)===0?(n.baseState&&(n.baseState=!1,Xt=!0),n.memoizedState=a):(wn(a,i)||(a=Gh(),rt.lanes|=a,fr|=a,n.baseState=!0),i)}function rT(n,i){var a=We;We=a!==0&&4>a?a:4,n(!0);var c=Oc.transition;Oc.transition={};try{n(!1),i()}finally{We=a,Oc.transition=c}}function dp(){return hn().memoizedState}function oT(n,i,a){var c=Ui(n);if(a={lane:c,action:a,hasEagerState:!1,eagerState:null,next:null},fp(n))hp(i,a);else if(a=zg(n,i,a,c),a!==null){var h=bt();Nn(a,n,c,h),gp(a,i,c)}}function sT(n,i,a){var c=Ui(n),h={lane:c,action:a,hasEagerState:!1,eagerState:null,next:null};if(fp(n))hp(i,h);else{var p=n.alternate;if(n.lanes===0&&(p===null||p.lanes===0)&&(p=i.lastRenderedReducer,p!==null))try{var S=i.lastRenderedState,A=p(S,a);if(h.hasEagerState=!0,h.eagerState=A,wn(A,S)){var R=i.interleaved;R===null?(h.next=h,Cc(i)):(h.next=R.next,R.next=h),i.interleaved=h;return}}catch{}finally{}a=zg(n,i,h,c),a!==null&&(h=bt(),Nn(a,n,c,h),gp(a,i,c))}}function fp(n){var i=n.alternate;return n===rt||i!==null&&i===rt}function hp(n,i){vs=Ja=!0;var a=n.pending;a===null?i.next=i:(i.next=a.next,a.next=i),n.pending=i}function gp(n,i,a){if((a&4194240)!==0){var c=i.lanes;c&=n.pendingLanes,a|=c,i.lanes=a,xu(n,a)}}var nl={readContext:fn,useCallback:kt,useContext:kt,useEffect:kt,useImperativeHandle:kt,useInsertionEffect:kt,useLayoutEffect:kt,useMemo:kt,useReducer:kt,useRef:kt,useState:kt,useDebugValue:kt,useDeferredValue:kt,useTransition:kt,useMutableSource:kt,useSyncExternalStore:kt,useId:kt,unstable_isNewReconciler:!1},aT={readContext:fn,useCallback:function(n,i){return Yn().memoizedState=[n,i===void 0?null:i],n},useContext:fn,useEffect:ip,useImperativeHandle:function(n,i,a){return a=a!=null?a.concat([n]):null,el(4194308,4,sp.bind(null,i,n),a)},useLayoutEffect:function(n,i){return el(4194308,4,n,i)},useInsertionEffect:function(n,i){return el(4,2,n,i)},useMemo:function(n,i){var a=Yn();return i=i===void 0?null:i,n=n(),a.memoizedState=[n,i],n},useReducer:function(n,i,a){var c=Yn();return i=a!==void 0?a(i):i,c.memoizedState=c.baseState=i,n={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:n,lastRenderedState:i},c.queue=n,n=n.dispatch=oT.bind(null,rt,n),[c.memoizedState,n]},useRef:function(n){var i=Yn();return n={current:n},i.memoizedState=n},useState:tp,useDebugValue:bc,useDeferredValue:function(n){return Yn().memoizedState=n},useTransition:function(){var n=tp(!1),i=n[0];return n=rT.bind(null,n[1]),Yn().memoizedState=n,[i,n]},useMutableSource:function(){},useSyncExternalStore:function(n,i,a){var c=rt,h=Yn();if(Qe){if(a===void 0)throw Error(r(407));a=a()}else{if(a=i(),St===null)throw Error(r(349));(dr&30)!==0||Zg(c,i,a)}h.memoizedState=a;var p={value:a,getSnapshot:i};return h.queue=p,ip(Qg.bind(null,c,p,n),[n]),c.flags|=2048,Ts(9,qg.bind(null,c,p,a,i),void 0,null),a},useId:function(){var n=Yn(),i=St.identifierPrefix;if(Qe){var a=ii,c=ni;a=(c&~(1<<32-En(c)-1)).toString(32)+a,i=":"+i+"R"+a,a=Ss++,0<a&&(i+="H"+a.toString(32)),i+=":"}else a=iT++,i=":"+i+"r"+a.toString(32)+":";return n.memoizedState=i},unstable_isNewReconciler:!1},lT={readContext:fn,useCallback:lp,useContext:fn,useEffect:Hc,useImperativeHandle:ap,useInsertionEffect:rp,useLayoutEffect:op,useMemo:up,useReducer:Bc,useRef:np,useState:function(){return Bc(ys)},useDebugValue:bc,useDeferredValue:function(n){var i=hn();return cp(i,gt.memoizedState,n)},useTransition:function(){var n=Bc(ys)[0],i=hn().memoizedState;return[n,i]},useMutableSource:Xg,useSyncExternalStore:Kg,useId:dp,unstable_isNewReconciler:!1},uT={readContext:fn,useCallback:lp,useContext:fn,useEffect:Hc,useImperativeHandle:ap,useInsertionEffect:rp,useLayoutEffect:op,useMemo:up,useReducer:Lc,useRef:np,useState:function(){return Lc(ys)},useDebugValue:bc,useDeferredValue:function(n){var i=hn();return gt===null?i.memoizedState=n:cp(i,gt.memoizedState,n)},useTransition:function(){var n=Lc(ys)[0],i=hn().memoizedState;return[n,i]},useMutableSource:Xg,useSyncExternalStore:Kg,useId:dp,unstable_isNewReconciler:!1};function Cn(n,i){if(n&&n.defaultProps){i=Y({},i),n=n.defaultProps;for(var a in n)i[a]===void 0&&(i[a]=n[a]);return i}return i}function Gc(n,i,a,c){i=n.memoizedState,a=a(c,i),a=a==null?i:Y({},i,a),n.memoizedState=a,n.lanes===0&&(n.updateQueue.baseState=a)}var il={isMounted:function(n){return(n=n._reactInternals)?rr(n)===n:!1},enqueueSetState:function(n,i,a){n=n._reactInternals;var c=bt(),h=Ui(n),p=oi(c,h);p.payload=i,a!=null&&(p.callback=a),i=ki(n,p,h),i!==null&&(Nn(i,n,h,c),Ka(i,n,h))},enqueueReplaceState:function(n,i,a){n=n._reactInternals;var c=bt(),h=Ui(n),p=oi(c,h);p.tag=1,p.payload=i,a!=null&&(p.callback=a),i=ki(n,p,h),i!==null&&(Nn(i,n,h,c),Ka(i,n,h))},enqueueForceUpdate:function(n,i){n=n._reactInternals;var a=bt(),c=Ui(n),h=oi(a,c);h.tag=2,i!=null&&(h.callback=i),i=ki(n,h,c),i!==null&&(Nn(i,n,c,a),Ka(i,n,c))}};function pp(n,i,a,c,h,p,S){return n=n.stateNode,typeof n.shouldComponentUpdate=="function"?n.shouldComponentUpdate(c,p,S):i.prototype&&i.prototype.isPureReactComponent?!ss(a,c)||!ss(h,p):!0}function mp(n,i,a){var c=!1,h=Pi,p=i.contextType;return typeof p=="object"&&p!==null?p=fn(p):(h=Vt(i)?sr:Dt.current,c=i.contextTypes,p=(c=c!=null)?Zr(n,h):Pi),i=new i(a,p),n.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,i.updater=il,n.stateNode=i,i._reactInternals=n,c&&(n=n.stateNode,n.__reactInternalMemoizedUnmaskedChildContext=h,n.__reactInternalMemoizedMaskedChildContext=p),i}function vp(n,i,a,c){n=i.state,typeof i.componentWillReceiveProps=="function"&&i.componentWillReceiveProps(a,c),typeof i.UNSAFE_componentWillReceiveProps=="function"&&i.UNSAFE_componentWillReceiveProps(a,c),i.state!==n&&il.enqueueReplaceState(i,i.state,null)}function xc(n,i,a,c){var h=n.stateNode;h.props=a,h.state=n.memoizedState,h.refs={},Rc(n);var p=i.contextType;typeof p=="object"&&p!==null?h.context=fn(p):(p=Vt(i)?sr:Dt.current,h.context=Zr(n,p)),h.state=n.memoizedState,p=i.getDerivedStateFromProps,typeof p=="function"&&(Gc(n,i,p,a),h.state=n.memoizedState),typeof i.getDerivedStateFromProps=="function"||typeof h.getSnapshotBeforeUpdate=="function"||typeof h.UNSAFE_componentWillMount!="function"&&typeof h.componentWillMount!="function"||(i=h.state,typeof h.componentWillMount=="function"&&h.componentWillMount(),typeof h.UNSAFE_componentWillMount=="function"&&h.UNSAFE_componentWillMount(),i!==h.state&&il.enqueueReplaceState(h,h.state,null),Za(n,a,h,c),h.state=n.memoizedState),typeof h.componentDidMount=="function"&&(n.flags|=4194308)}function ro(n,i){try{var a="",c=i;do a+=Se(c),c=c.return;while(c);var h=a}catch(p){h=`
Error generating stack: `+p.message+`
`+p.stack}return{value:n,source:i,stack:h,digest:null}}function $c(n,i,a){return{value:n,source:null,stack:a??null,digest:i??null}}function zc(n,i){try{console.error(i.value)}catch(a){setTimeout(function(){throw a})}}var cT=typeof WeakMap=="function"?WeakMap:Map;function Sp(n,i,a){a=oi(-1,a),a.tag=3,a.payload={element:null};var c=i.value;return a.callback=function(){cl||(cl=!0,rd=c),zc(n,i)},a}function yp(n,i,a){a=oi(-1,a),a.tag=3;var c=n.type.getDerivedStateFromError;if(typeof c=="function"){var h=i.value;a.payload=function(){return c(h)},a.callback=function(){zc(n,i)}}var p=n.stateNode;return p!==null&&typeof p.componentDidCatch=="function"&&(a.callback=function(){zc(n,i),typeof c!="function"&&(Mi===null?Mi=new Set([this]):Mi.add(this));var S=i.stack;this.componentDidCatch(i.value,{componentStack:S!==null?S:""})}),a}function Tp(n,i,a){var c=n.pingCache;if(c===null){c=n.pingCache=new cT;var h=new Set;c.set(i,h)}else h=c.get(i),h===void 0&&(h=new Set,c.set(i,h));h.has(a)||(h.add(a),n=wT.bind(null,n,i,a),i.then(n,n))}function Ap(n){do{var i;if((i=n.tag===13)&&(i=n.memoizedState,i=i!==null?i.dehydrated!==null:!0),i)return n;n=n.return}while(n!==null);return null}function Ip(n,i,a,c,h){return(n.mode&1)===0?(n===i?n.flags|=65536:(n.flags|=128,a.flags|=131072,a.flags&=-52805,a.tag===1&&(a.alternate===null?a.tag=17:(i=oi(-1,1),i.tag=2,ki(a,i,1))),a.lanes|=1),n):(n.flags|=65536,n.lanes=h,n)}var dT=H.ReactCurrentOwner,Xt=!1;function Ht(n,i,a,c){i.child=n===null?$g(i,null,a,c):eo(i,n.child,a,c)}function Ep(n,i,a,c,h){a=a.render;var p=i.ref;return no(i,h),c=Fc(n,i,a,c,p,h),a=Uc(),n!==null&&!Xt?(i.updateQueue=n.updateQueue,i.flags&=-2053,n.lanes&=~h,si(n,i,h)):(Qe&&a&&vc(i),i.flags|=1,Ht(n,i,c,h),i.child)}function wp(n,i,a,c,h){if(n===null){var p=a.type;return typeof p=="function"&&!dd(p)&&p.defaultProps===void 0&&a.compare===null&&a.defaultProps===void 0?(i.tag=15,i.type=p,_p(n,i,p,c,h)):(n=ml(a.type,null,c,i,i.mode,h),n.ref=i.ref,n.return=i,i.child=n)}if(p=n.child,(n.lanes&h)===0){var S=p.memoizedProps;if(a=a.compare,a=a!==null?a:ss,a(S,c)&&n.ref===i.ref)return si(n,i,h)}return i.flags|=1,n=Li(p,c),n.ref=i.ref,n.return=i,i.child=n}function _p(n,i,a,c,h){if(n!==null){var p=n.memoizedProps;if(ss(p,c)&&n.ref===i.ref)if(Xt=!1,i.pendingProps=c=p,(n.lanes&h)!==0)(n.flags&131072)!==0&&(Xt=!0);else return i.lanes=n.lanes,si(n,i,h)}return Wc(n,i,a,c,h)}function Cp(n,i,a){var c=i.pendingProps,h=c.children,p=n!==null?n.memoizedState:null;if(c.mode==="hidden")if((i.mode&1)===0)i.memoizedState={baseLanes:0,cachePool:null,transitions:null},Ye(so,rn),rn|=a;else{if((a&1073741824)===0)return n=p!==null?p.baseLanes|a:a,i.lanes=i.childLanes=1073741824,i.memoizedState={baseLanes:n,cachePool:null,transitions:null},i.updateQueue=null,Ye(so,rn),rn|=n,null;i.memoizedState={baseLanes:0,cachePool:null,transitions:null},c=p!==null?p.baseLanes:a,Ye(so,rn),rn|=c}else p!==null?(c=p.baseLanes|a,i.memoizedState=null):c=a,Ye(so,rn),rn|=c;return Ht(n,i,h,a),i.child}function Rp(n,i){var a=i.ref;(n===null&&a!==null||n!==null&&n.ref!==a)&&(i.flags|=512,i.flags|=2097152)}function Wc(n,i,a,c,h){var p=Vt(a)?sr:Dt.current;return p=Zr(i,p),no(i,h),a=Fc(n,i,a,c,p,h),c=Uc(),n!==null&&!Xt?(i.updateQueue=n.updateQueue,i.flags&=-2053,n.lanes&=~h,si(n,i,h)):(Qe&&c&&vc(i),i.flags|=1,Ht(n,i,a,h),i.child)}function Pp(n,i,a,c,h){if(Vt(a)){var p=!0;xa(i)}else p=!1;if(no(i,h),i.stateNode===null)ol(n,i),mp(i,a,c),xc(i,a,c,h),c=!0;else if(n===null){var S=i.stateNode,A=i.memoizedProps;S.props=A;var R=S.context,M=a.contextType;typeof M=="object"&&M!==null?M=fn(M):(M=Vt(a)?sr:Dt.current,M=Zr(i,M));var G=a.getDerivedStateFromProps,z=typeof G=="function"||typeof S.getSnapshotBeforeUpdate=="function";z||typeof S.UNSAFE_componentWillReceiveProps!="function"&&typeof S.componentWillReceiveProps!="function"||(A!==c||R!==M)&&vp(i,S,c,M),Di=!1;var b=i.memoizedState;S.state=b,Za(i,c,S,h),R=i.memoizedState,A!==c||b!==R||jt.current||Di?(typeof G=="function"&&(Gc(i,a,G,c),R=i.memoizedState),(A=Di||pp(i,a,A,c,b,R,M))?(z||typeof S.UNSAFE_componentWillMount!="function"&&typeof S.componentWillMount!="function"||(typeof S.componentWillMount=="function"&&S.componentWillMount(),typeof S.UNSAFE_componentWillMount=="function"&&S.UNSAFE_componentWillMount()),typeof S.componentDidMount=="function"&&(i.flags|=4194308)):(typeof S.componentDidMount=="function"&&(i.flags|=4194308),i.memoizedProps=c,i.memoizedState=R),S.props=c,S.state=R,S.context=M,c=A):(typeof S.componentDidMount=="function"&&(i.flags|=4194308),c=!1)}else{S=i.stateNode,Wg(n,i),A=i.memoizedProps,M=i.type===i.elementType?A:Cn(i.type,A),S.props=M,z=i.pendingProps,b=S.context,R=a.contextType,typeof R=="object"&&R!==null?R=fn(R):(R=Vt(a)?sr:Dt.current,R=Zr(i,R));var q=a.getDerivedStateFromProps;(G=typeof q=="function"||typeof S.getSnapshotBeforeUpdate=="function")||typeof S.UNSAFE_componentWillReceiveProps!="function"&&typeof S.componentWillReceiveProps!="function"||(A!==z||b!==R)&&vp(i,S,c,R),Di=!1,b=i.memoizedState,S.state=b,Za(i,c,S,h);var te=i.memoizedState;A!==z||b!==te||jt.current||Di?(typeof q=="function"&&(Gc(i,a,q,c),te=i.memoizedState),(M=Di||pp(i,a,M,c,b,te,R)||!1)?(G||typeof S.UNSAFE_componentWillUpdate!="function"&&typeof S.componentWillUpdate!="function"||(typeof S.componentWillUpdate=="function"&&S.componentWillUpdate(c,te,R),typeof S.UNSAFE_componentWillUpdate=="function"&&S.UNSAFE_componentWillUpdate(c,te,R)),typeof S.componentDidUpdate=="function"&&(i.flags|=4),typeof S.getSnapshotBeforeUpdate=="function"&&(i.flags|=1024)):(typeof S.componentDidUpdate!="function"||A===n.memoizedProps&&b===n.memoizedState||(i.flags|=4),typeof S.getSnapshotBeforeUpdate!="function"||A===n.memoizedProps&&b===n.memoizedState||(i.flags|=1024),i.memoizedProps=c,i.memoizedState=te),S.props=c,S.state=te,S.context=R,c=M):(typeof S.componentDidUpdate!="function"||A===n.memoizedProps&&b===n.memoizedState||(i.flags|=4),typeof S.getSnapshotBeforeUpdate!="function"||A===n.memoizedProps&&b===n.memoizedState||(i.flags|=1024),c=!1)}return Yc(n,i,a,c,p,h)}function Yc(n,i,a,c,h,p){Rp(n,i);var S=(i.flags&128)!==0;if(!c&&!S)return h&&Mg(i,a,!1),si(n,i,p);c=i.stateNode,dT.current=i;var A=S&&typeof a.getDerivedStateFromError!="function"?null:c.render();return i.flags|=1,n!==null&&S?(i.child=eo(i,n.child,null,p),i.child=eo(i,null,A,p)):Ht(n,i,A,p),i.memoizedState=c.state,h&&Mg(i,a,!0),i.child}function Np(n){var i=n.stateNode;i.pendingContext?kg(n,i.pendingContext,i.pendingContext!==i.context):i.context&&kg(n,i.context,!1),Pc(n,i.containerInfo)}function Dp(n,i,a,c,h){return Jr(),Ac(h),i.flags|=256,Ht(n,i,a,c),i.child}var jc={dehydrated:null,treeContext:null,retryLane:0};function Vc(n){return{baseLanes:n,cachePool:null,transitions:null}}function kp(n,i,a){var c=i.pendingProps,h=it.current,p=!1,S=(i.flags&128)!==0,A;if((A=S)||(A=n!==null&&n.memoizedState===null?!1:(h&2)!==0),A?(p=!0,i.flags&=-129):(n===null||n.memoizedState!==null)&&(h|=1),Ye(it,h&1),n===null)return Tc(i),n=i.memoizedState,n!==null&&(n=n.dehydrated,n!==null)?((i.mode&1)===0?i.lanes=1:n.data==="$!"?i.lanes=8:i.lanes=1073741824,null):(S=c.children,n=c.fallback,p?(c=i.mode,p=i.child,S={mode:"hidden",children:S},(c&1)===0&&p!==null?(p.childLanes=0,p.pendingProps=S):p=vl(S,c,0,null),n=mr(n,c,a,null),p.return=i,n.return=i,p.sibling=n,i.child=p,i.child.memoizedState=Vc(a),i.memoizedState=jc,n):Xc(i,S));if(h=n.memoizedState,h!==null&&(A=h.dehydrated,A!==null))return fT(n,i,S,c,A,h,a);if(p){p=c.fallback,S=i.mode,h=n.child,A=h.sibling;var R={mode:"hidden",children:c.children};return(S&1)===0&&i.child!==h?(c=i.child,c.childLanes=0,c.pendingProps=R,i.deletions=null):(c=Li(h,R),c.subtreeFlags=h.subtreeFlags&14680064),A!==null?p=Li(A,p):(p=mr(p,S,a,null),p.flags|=2),p.return=i,c.return=i,c.sibling=p,i.child=c,c=p,p=i.child,S=n.child.memoizedState,S=S===null?Vc(a):{baseLanes:S.baseLanes|a,cachePool:null,transitions:S.transitions},p.memoizedState=S,p.childLanes=n.childLanes&~a,i.memoizedState=jc,c}return p=n.child,n=p.sibling,c=Li(p,{mode:"visible",children:c.children}),(i.mode&1)===0&&(c.lanes=a),c.return=i,c.sibling=null,n!==null&&(a=i.deletions,a===null?(i.deletions=[n],i.flags|=16):a.push(n)),i.child=c,i.memoizedState=null,c}function Xc(n,i){return i=vl({mode:"visible",children:i},n.mode,0,null),i.return=n,n.child=i}function rl(n,i,a,c){return c!==null&&Ac(c),eo(i,n.child,null,a),n=Xc(i,i.pendingProps.children),n.flags|=2,i.memoizedState=null,n}function fT(n,i,a,c,h,p,S){if(a)return i.flags&256?(i.flags&=-257,c=$c(Error(r(422))),rl(n,i,S,c)):i.memoizedState!==null?(i.child=n.child,i.flags|=128,null):(p=c.fallback,h=i.mode,c=vl({mode:"visible",children:c.children},h,0,null),p=mr(p,h,S,null),p.flags|=2,c.return=i,p.return=i,c.sibling=p,i.child=c,(i.mode&1)!==0&&eo(i,n.child,null,S),i.child.memoizedState=Vc(S),i.memoizedState=jc,p);if((i.mode&1)===0)return rl(n,i,S,null);if(h.data==="$!"){if(c=h.nextSibling&&h.nextSibling.dataset,c)var A=c.dgst;return c=A,p=Error(r(419)),c=$c(p,c,void 0),rl(n,i,S,c)}if(A=(S&n.childLanes)!==0,Xt||A){if(c=St,c!==null){switch(S&-S){case 4:h=2;break;case 16:h=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:h=32;break;case 536870912:h=268435456;break;default:h=0}h=(h&(c.suspendedLanes|S))!==0?0:h,h!==0&&h!==p.retryLane&&(p.retryLane=h,ri(n,h),Nn(c,n,h,-1))}return cd(),c=$c(Error(r(421))),rl(n,i,S,c)}return h.data==="$?"?(i.flags|=128,i.child=n.child,i=_T.bind(null,n),h._reactRetry=i,null):(n=p.treeContext,nn=Ci(h.nextSibling),tn=i,Qe=!0,_n=null,n!==null&&(cn[dn++]=ni,cn[dn++]=ii,cn[dn++]=ar,ni=n.id,ii=n.overflow,ar=i),i=Xc(i,c.children),i.flags|=4096,i)}function Op(n,i,a){n.lanes|=i;var c=n.alternate;c!==null&&(c.lanes|=i),_c(n.return,i,a)}function Kc(n,i,a,c,h){var p=n.memoizedState;p===null?n.memoizedState={isBackwards:i,rendering:null,renderingStartTime:0,last:c,tail:a,tailMode:h}:(p.isBackwards=i,p.rendering=null,p.renderingStartTime=0,p.last=c,p.tail=a,p.tailMode=h)}function Mp(n,i,a){var c=i.pendingProps,h=c.revealOrder,p=c.tail;if(Ht(n,i,c.children,a),c=it.current,(c&2)!==0)c=c&1|2,i.flags|=128;else{if(n!==null&&(n.flags&128)!==0)e:for(n=i.child;n!==null;){if(n.tag===13)n.memoizedState!==null&&Op(n,a,i);else if(n.tag===19)Op(n,a,i);else if(n.child!==null){n.child.return=n,n=n.child;continue}if(n===i)break e;for(;n.sibling===null;){if(n.return===null||n.return===i)break e;n=n.return}n.sibling.return=n.return,n=n.sibling}c&=1}if(Ye(it,c),(i.mode&1)===0)i.memoizedState=null;else switch(h){case"forwards":for(a=i.child,h=null;a!==null;)n=a.alternate,n!==null&&qa(n)===null&&(h=a),a=a.sibling;a=h,a===null?(h=i.child,i.child=null):(h=a.sibling,a.sibling=null),Kc(i,!1,h,a,p);break;case"backwards":for(a=null,h=i.child,i.child=null;h!==null;){if(n=h.alternate,n!==null&&qa(n)===null){i.child=h;break}n=h.sibling,h.sibling=a,a=h,h=n}Kc(i,!0,a,null,p);break;case"together":Kc(i,!1,null,null,void 0);break;default:i.memoizedState=null}return i.child}function ol(n,i){(i.mode&1)===0&&n!==null&&(n.alternate=null,i.alternate=null,i.flags|=2)}function si(n,i,a){if(n!==null&&(i.dependencies=n.dependencies),fr|=i.lanes,(a&i.childLanes)===0)return null;if(n!==null&&i.child!==n.child)throw Error(r(153));if(i.child!==null){for(n=i.child,a=Li(n,n.pendingProps),i.child=a,a.return=i;n.sibling!==null;)n=n.sibling,a=a.sibling=Li(n,n.pendingProps),a.return=i;a.sibling=null}return i.child}function hT(n,i,a){switch(i.tag){case 3:Np(i),Jr();break;case 5:Vg(i);break;case 1:Vt(i.type)&&xa(i);break;case 4:Pc(i,i.stateNode.containerInfo);break;case 10:var c=i.type._context,h=i.memoizedProps.value;Ye(Va,c._currentValue),c._currentValue=h;break;case 13:if(c=i.memoizedState,c!==null)return c.dehydrated!==null?(Ye(it,it.current&1),i.flags|=128,null):(a&i.child.childLanes)!==0?kp(n,i,a):(Ye(it,it.current&1),n=si(n,i,a),n!==null?n.sibling:null);Ye(it,it.current&1);break;case 19:if(c=(a&i.childLanes)!==0,(n.flags&128)!==0){if(c)return Mp(n,i,a);i.flags|=128}if(h=i.memoizedState,h!==null&&(h.rendering=null,h.tail=null,h.lastEffect=null),Ye(it,it.current),c)break;return null;case 22:case 23:return i.lanes=0,Cp(n,i,a)}return si(n,i,a)}var Fp,Zc,Up,Bp;Fp=function(n,i){for(var a=i.child;a!==null;){if(a.tag===5||a.tag===6)n.appendChild(a.stateNode);else if(a.tag!==4&&a.child!==null){a.child.return=a,a=a.child;continue}if(a===i)break;for(;a.sibling===null;){if(a.return===null||a.return===i)return;a=a.return}a.sibling.return=a.return,a=a.sibling}},Zc=function(){},Up=function(n,i,a,c){var h=n.memoizedProps;if(h!==c){n=i.stateNode,cr(Wn.current);var p=null;switch(a){case"input":h=qe(n,h),c=qe(n,c),p=[];break;case"select":h=Y({},h,{value:void 0}),c=Y({},c,{value:void 0}),p=[];break;case"textarea":h=ir(n,h),c=ir(n,c),p=[];break;default:typeof h.onClick!="function"&&typeof c.onClick=="function"&&(n.onclick=Ha)}Du(a,c);var S;a=null;for(M in h)if(!c.hasOwnProperty(M)&&h.hasOwnProperty(M)&&h[M]!=null)if(M==="style"){var A=h[M];for(S in A)A.hasOwnProperty(S)&&(a||(a={}),a[S]="")}else M!=="dangerouslySetInnerHTML"&&M!=="children"&&M!=="suppressContentEditableWarning"&&M!=="suppressHydrationWarning"&&M!=="autoFocus"&&(l.hasOwnProperty(M)?p||(p=[]):(p=p||[]).push(M,null));for(M in c){var R=c[M];if(A=h!=null?h[M]:void 0,c.hasOwnProperty(M)&&R!==A&&(R!=null||A!=null))if(M==="style")if(A){for(S in A)!A.hasOwnProperty(S)||R&&R.hasOwnProperty(S)||(a||(a={}),a[S]="");for(S in R)R.hasOwnProperty(S)&&A[S]!==R[S]&&(a||(a={}),a[S]=R[S])}else a||(p||(p=[]),p.push(M,a)),a=R;else M==="dangerouslySetInnerHTML"?(R=R?R.__html:void 0,A=A?A.__html:void 0,R!=null&&A!==R&&(p=p||[]).push(M,R)):M==="children"?typeof R!="string"&&typeof R!="number"||(p=p||[]).push(M,""+R):M!=="suppressContentEditableWarning"&&M!=="suppressHydrationWarning"&&(l.hasOwnProperty(M)?(R!=null&&M==="onScroll"&&Ve("scroll",n),p||A===R||(p=[])):(p=p||[]).push(M,R))}a&&(p=p||[]).push("style",a);var M=p;(i.updateQueue=M)&&(i.flags|=4)}},Bp=function(n,i,a,c){a!==c&&(i.flags|=4)};function As(n,i){if(!Qe)switch(n.tailMode){case"hidden":i=n.tail;for(var a=null;i!==null;)i.alternate!==null&&(a=i),i=i.sibling;a===null?n.tail=null:a.sibling=null;break;case"collapsed":a=n.tail;for(var c=null;a!==null;)a.alternate!==null&&(c=a),a=a.sibling;c===null?i||n.tail===null?n.tail=null:n.tail.sibling=null:c.sibling=null}}function Ot(n){var i=n.alternate!==null&&n.alternate.child===n.child,a=0,c=0;if(i)for(var h=n.child;h!==null;)a|=h.lanes|h.childLanes,c|=h.subtreeFlags&14680064,c|=h.flags&14680064,h.return=n,h=h.sibling;else for(h=n.child;h!==null;)a|=h.lanes|h.childLanes,c|=h.subtreeFlags,c|=h.flags,h.return=n,h=h.sibling;return n.subtreeFlags|=c,n.childLanes=a,i}function gT(n,i,a){var c=i.pendingProps;switch(Sc(i),i.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Ot(i),null;case 1:return Vt(i.type)&&Ga(),Ot(i),null;case 3:return c=i.stateNode,io(),Xe(jt),Xe(Dt),kc(),c.pendingContext&&(c.context=c.pendingContext,c.pendingContext=null),(n===null||n.child===null)&&(Ya(i)?i.flags|=4:n===null||n.memoizedState.isDehydrated&&(i.flags&256)===0||(i.flags|=1024,_n!==null&&(ad(_n),_n=null))),Zc(n,i),Ot(i),null;case 5:Nc(i);var h=cr(ms.current);if(a=i.type,n!==null&&i.stateNode!=null)Up(n,i,a,c,h),n.ref!==i.ref&&(i.flags|=512,i.flags|=2097152);else{if(!c){if(i.stateNode===null)throw Error(r(166));return Ot(i),null}if(n=cr(Wn.current),Ya(i)){c=i.stateNode,a=i.type;var p=i.memoizedProps;switch(c[zn]=i,c[ds]=p,n=(i.mode&1)!==0,a){case"dialog":Ve("cancel",c),Ve("close",c);break;case"iframe":case"object":case"embed":Ve("load",c);break;case"video":case"audio":for(h=0;h<ls.length;h++)Ve(ls[h],c);break;case"source":Ve("error",c);break;case"img":case"image":case"link":Ve("error",c),Ve("load",c);break;case"details":Ve("toggle",c);break;case"input":je(c,p),Ve("invalid",c);break;case"select":c._wrapperState={wasMultiple:!!p.multiple},Ve("invalid",c);break;case"textarea":yh(c,p),Ve("invalid",c)}Du(a,p),h=null;for(var S in p)if(p.hasOwnProperty(S)){var A=p[S];S==="children"?typeof A=="string"?c.textContent!==A&&(p.suppressHydrationWarning!==!0&&La(c.textContent,A,n),h=["children",A]):typeof A=="number"&&c.textContent!==""+A&&(p.suppressHydrationWarning!==!0&&La(c.textContent,A,n),h=["children",""+A]):l.hasOwnProperty(S)&&A!=null&&S==="onScroll"&&Ve("scroll",c)}switch(a){case"input":Be(c),un(c,p,!0);break;case"textarea":Be(c),Ah(c);break;case"select":case"option":break;default:typeof p.onClick=="function"&&(c.onclick=Ha)}c=h,i.updateQueue=c,c!==null&&(i.flags|=4)}else{S=h.nodeType===9?h:h.ownerDocument,n==="http://www.w3.org/1999/xhtml"&&(n=Ih(a)),n==="http://www.w3.org/1999/xhtml"?a==="script"?(n=S.createElement("div"),n.innerHTML="<script><\/script>",n=n.removeChild(n.firstChild)):typeof c.is=="string"?n=S.createElement(a,{is:c.is}):(n=S.createElement(a),a==="select"&&(S=n,c.multiple?S.multiple=!0:c.size&&(S.size=c.size))):n=S.createElementNS(n,a),n[zn]=i,n[ds]=c,Fp(n,i,!1,!1),i.stateNode=n;e:{switch(S=ku(a,c),a){case"dialog":Ve("cancel",n),Ve("close",n),h=c;break;case"iframe":case"object":case"embed":Ve("load",n),h=c;break;case"video":case"audio":for(h=0;h<ls.length;h++)Ve(ls[h],n);h=c;break;case"source":Ve("error",n),h=c;break;case"img":case"image":case"link":Ve("error",n),Ve("load",n),h=c;break;case"details":Ve("toggle",n),h=c;break;case"input":je(n,c),h=qe(n,c),Ve("invalid",n);break;case"option":h=c;break;case"select":n._wrapperState={wasMultiple:!!c.multiple},h=Y({},c,{value:void 0}),Ve("invalid",n);break;case"textarea":yh(n,c),h=ir(n,c),Ve("invalid",n);break;default:h=c}Du(a,h),A=h;for(p in A)if(A.hasOwnProperty(p)){var R=A[p];p==="style"?_h(n,R):p==="dangerouslySetInnerHTML"?(R=R?R.__html:void 0,R!=null&&Eh(n,R)):p==="children"?typeof R=="string"?(a!=="textarea"||R!=="")&&zo(n,R):typeof R=="number"&&zo(n,""+R):p!=="suppressContentEditableWarning"&&p!=="suppressHydrationWarning"&&p!=="autoFocus"&&(l.hasOwnProperty(p)?R!=null&&p==="onScroll"&&Ve("scroll",n):R!=null&&D(n,p,R,S))}switch(a){case"input":Be(n),un(n,c,!1);break;case"textarea":Be(n),Ah(n);break;case"option":c.value!=null&&n.setAttribute("value",""+Ae(c.value));break;case"select":n.multiple=!!c.multiple,p=c.value,p!=null?yi(n,!!c.multiple,p,!1):c.defaultValue!=null&&yi(n,!!c.multiple,c.defaultValue,!0);break;default:typeof h.onClick=="function"&&(n.onclick=Ha)}switch(a){case"button":case"input":case"select":case"textarea":c=!!c.autoFocus;break e;case"img":c=!0;break e;default:c=!1}}c&&(i.flags|=4)}i.ref!==null&&(i.flags|=512,i.flags|=2097152)}return Ot(i),null;case 6:if(n&&i.stateNode!=null)Bp(n,i,n.memoizedProps,c);else{if(typeof c!="string"&&i.stateNode===null)throw Error(r(166));if(a=cr(ms.current),cr(Wn.current),Ya(i)){if(c=i.stateNode,a=i.memoizedProps,c[zn]=i,(p=c.nodeValue!==a)&&(n=tn,n!==null))switch(n.tag){case 3:La(c.nodeValue,a,(n.mode&1)!==0);break;case 5:n.memoizedProps.suppressHydrationWarning!==!0&&La(c.nodeValue,a,(n.mode&1)!==0)}p&&(i.flags|=4)}else c=(a.nodeType===9?a:a.ownerDocument).createTextNode(c),c[zn]=i,i.stateNode=c}return Ot(i),null;case 13:if(Xe(it),c=i.memoizedState,n===null||n.memoizedState!==null&&n.memoizedState.dehydrated!==null){if(Qe&&nn!==null&&(i.mode&1)!==0&&(i.flags&128)===0)bg(),Jr(),i.flags|=98560,p=!1;else if(p=Ya(i),c!==null&&c.dehydrated!==null){if(n===null){if(!p)throw Error(r(318));if(p=i.memoizedState,p=p!==null?p.dehydrated:null,!p)throw Error(r(317));p[zn]=i}else Jr(),(i.flags&128)===0&&(i.memoizedState=null),i.flags|=4;Ot(i),p=!1}else _n!==null&&(ad(_n),_n=null),p=!0;if(!p)return i.flags&65536?i:null}return(i.flags&128)!==0?(i.lanes=a,i):(c=c!==null,c!==(n!==null&&n.memoizedState!==null)&&c&&(i.child.flags|=8192,(i.mode&1)!==0&&(n===null||(it.current&1)!==0?pt===0&&(pt=3):cd())),i.updateQueue!==null&&(i.flags|=4),Ot(i),null);case 4:return io(),Zc(n,i),n===null&&us(i.stateNode.containerInfo),Ot(i),null;case 10:return wc(i.type._context),Ot(i),null;case 17:return Vt(i.type)&&Ga(),Ot(i),null;case 19:if(Xe(it),p=i.memoizedState,p===null)return Ot(i),null;if(c=(i.flags&128)!==0,S=p.rendering,S===null)if(c)As(p,!1);else{if(pt!==0||n!==null&&(n.flags&128)!==0)for(n=i.child;n!==null;){if(S=qa(n),S!==null){for(i.flags|=128,As(p,!1),c=S.updateQueue,c!==null&&(i.updateQueue=c,i.flags|=4),i.subtreeFlags=0,c=a,a=i.child;a!==null;)p=a,n=c,p.flags&=14680066,S=p.alternate,S===null?(p.childLanes=0,p.lanes=n,p.child=null,p.subtreeFlags=0,p.memoizedProps=null,p.memoizedState=null,p.updateQueue=null,p.dependencies=null,p.stateNode=null):(p.childLanes=S.childLanes,p.lanes=S.lanes,p.child=S.child,p.subtreeFlags=0,p.deletions=null,p.memoizedProps=S.memoizedProps,p.memoizedState=S.memoizedState,p.updateQueue=S.updateQueue,p.type=S.type,n=S.dependencies,p.dependencies=n===null?null:{lanes:n.lanes,firstContext:n.firstContext}),a=a.sibling;return Ye(it,it.current&1|2),i.child}n=n.sibling}p.tail!==null&&at()>ao&&(i.flags|=128,c=!0,As(p,!1),i.lanes=4194304)}else{if(!c)if(n=qa(S),n!==null){if(i.flags|=128,c=!0,a=n.updateQueue,a!==null&&(i.updateQueue=a,i.flags|=4),As(p,!0),p.tail===null&&p.tailMode==="hidden"&&!S.alternate&&!Qe)return Ot(i),null}else 2*at()-p.renderingStartTime>ao&&a!==1073741824&&(i.flags|=128,c=!0,As(p,!1),i.lanes=4194304);p.isBackwards?(S.sibling=i.child,i.child=S):(a=p.last,a!==null?a.sibling=S:i.child=S,p.last=S)}return p.tail!==null?(i=p.tail,p.rendering=i,p.tail=i.sibling,p.renderingStartTime=at(),i.sibling=null,a=it.current,Ye(it,c?a&1|2:a&1),i):(Ot(i),null);case 22:case 23:return ud(),c=i.memoizedState!==null,n!==null&&n.memoizedState!==null!==c&&(i.flags|=8192),c&&(i.mode&1)!==0?(rn&1073741824)!==0&&(Ot(i),i.subtreeFlags&6&&(i.flags|=8192)):Ot(i),null;case 24:return null;case 25:return null}throw Error(r(156,i.tag))}function pT(n,i){switch(Sc(i),i.tag){case 1:return Vt(i.type)&&Ga(),n=i.flags,n&65536?(i.flags=n&-65537|128,i):null;case 3:return io(),Xe(jt),Xe(Dt),kc(),n=i.flags,(n&65536)!==0&&(n&128)===0?(i.flags=n&-65537|128,i):null;case 5:return Nc(i),null;case 13:if(Xe(it),n=i.memoizedState,n!==null&&n.dehydrated!==null){if(i.alternate===null)throw Error(r(340));Jr()}return n=i.flags,n&65536?(i.flags=n&-65537|128,i):null;case 19:return Xe(it),null;case 4:return io(),null;case 10:return wc(i.type._context),null;case 22:case 23:return ud(),null;case 24:return null;default:return null}}var sl=!1,Mt=!1,mT=typeof WeakSet=="function"?WeakSet:Set,Q=null;function oo(n,i){var a=n.ref;if(a!==null)if(typeof a=="function")try{a(null)}catch(c){ot(n,i,c)}else a.current=null}function qc(n,i,a){try{a()}catch(c){ot(n,i,c)}}var Lp=!1;function vT(n,i){if(uc=Ca,n=pg(),tc(n)){if("selectionStart"in n)var a={start:n.selectionStart,end:n.selectionEnd};else e:{a=(a=n.ownerDocument)&&a.defaultView||window;var c=a.getSelection&&a.getSelection();if(c&&c.rangeCount!==0){a=c.anchorNode;var h=c.anchorOffset,p=c.focusNode;c=c.focusOffset;try{a.nodeType,p.nodeType}catch{a=null;break e}var S=0,A=-1,R=-1,M=0,G=0,z=n,b=null;t:for(;;){for(var q;z!==a||h!==0&&z.nodeType!==3||(A=S+h),z!==p||c!==0&&z.nodeType!==3||(R=S+c),z.nodeType===3&&(S+=z.nodeValue.length),(q=z.firstChild)!==null;)b=z,z=q;for(;;){if(z===n)break t;if(b===a&&++M===h&&(A=S),b===p&&++G===c&&(R=S),(q=z.nextSibling)!==null)break;z=b,b=z.parentNode}z=q}a=A===-1||R===-1?null:{start:A,end:R}}else a=null}a=a||{start:0,end:0}}else a=null;for(cc={focusedElem:n,selectionRange:a},Ca=!1,Q=i;Q!==null;)if(i=Q,n=i.child,(i.subtreeFlags&1028)!==0&&n!==null)n.return=i,Q=n;else for(;Q!==null;){i=Q;try{var te=i.alternate;if((i.flags&1024)!==0)switch(i.tag){case 0:case 11:case 15:break;case 1:if(te!==null){var oe=te.memoizedProps,lt=te.memoizedState,k=i.stateNode,N=k.getSnapshotBeforeUpdate(i.elementType===i.type?oe:Cn(i.type,oe),lt);k.__reactInternalSnapshotBeforeUpdate=N}break;case 3:var O=i.stateNode.containerInfo;O.nodeType===1?O.textContent="":O.nodeType===9&&O.documentElement&&O.removeChild(O.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(r(163))}}catch(j){ot(i,i.return,j)}if(n=i.sibling,n!==null){n.return=i.return,Q=n;break}Q=i.return}return te=Lp,Lp=!1,te}function Is(n,i,a){var c=i.updateQueue;if(c=c!==null?c.lastEffect:null,c!==null){var h=c=c.next;do{if((h.tag&n)===n){var p=h.destroy;h.destroy=void 0,p!==void 0&&qc(i,a,p)}h=h.next}while(h!==c)}}function al(n,i){if(i=i.updateQueue,i=i!==null?i.lastEffect:null,i!==null){var a=i=i.next;do{if((a.tag&n)===n){var c=a.create;a.destroy=c()}a=a.next}while(a!==i)}}function Qc(n){var i=n.ref;if(i!==null){var a=n.stateNode;switch(n.tag){case 5:n=a;break;default:n=a}typeof i=="function"?i(n):i.current=n}}function Hp(n){var i=n.alternate;i!==null&&(n.alternate=null,Hp(i)),n.child=null,n.deletions=null,n.sibling=null,n.tag===5&&(i=n.stateNode,i!==null&&(delete i[zn],delete i[ds],delete i[gc],delete i[Jy],delete i[eT])),n.stateNode=null,n.return=null,n.dependencies=null,n.memoizedProps=null,n.memoizedState=null,n.pendingProps=null,n.stateNode=null,n.updateQueue=null}function bp(n){return n.tag===5||n.tag===3||n.tag===4}function Gp(n){e:for(;;){for(;n.sibling===null;){if(n.return===null||bp(n.return))return null;n=n.return}for(n.sibling.return=n.return,n=n.sibling;n.tag!==5&&n.tag!==6&&n.tag!==18;){if(n.flags&2||n.child===null||n.tag===4)continue e;n.child.return=n,n=n.child}if(!(n.flags&2))return n.stateNode}}function Jc(n,i,a){var c=n.tag;if(c===5||c===6)n=n.stateNode,i?a.nodeType===8?a.parentNode.insertBefore(n,i):a.insertBefore(n,i):(a.nodeType===8?(i=a.parentNode,i.insertBefore(n,a)):(i=a,i.appendChild(n)),a=a._reactRootContainer,a!=null||i.onclick!==null||(i.onclick=Ha));else if(c!==4&&(n=n.child,n!==null))for(Jc(n,i,a),n=n.sibling;n!==null;)Jc(n,i,a),n=n.sibling}function ed(n,i,a){var c=n.tag;if(c===5||c===6)n=n.stateNode,i?a.insertBefore(n,i):a.appendChild(n);else if(c!==4&&(n=n.child,n!==null))for(ed(n,i,a),n=n.sibling;n!==null;)ed(n,i,a),n=n.sibling}var Ct=null,Rn=!1;function Oi(n,i,a){for(a=a.child;a!==null;)xp(n,i,a),a=a.sibling}function xp(n,i,a){if($n&&typeof $n.onCommitFiberUnmount=="function")try{$n.onCommitFiberUnmount(Ta,a)}catch{}switch(a.tag){case 5:Mt||oo(a,i);case 6:var c=Ct,h=Rn;Ct=null,Oi(n,i,a),Ct=c,Rn=h,Ct!==null&&(Rn?(n=Ct,a=a.stateNode,n.nodeType===8?n.parentNode.removeChild(a):n.removeChild(a)):Ct.removeChild(a.stateNode));break;case 18:Ct!==null&&(Rn?(n=Ct,a=a.stateNode,n.nodeType===8?hc(n.parentNode,a):n.nodeType===1&&hc(n,a),es(n)):hc(Ct,a.stateNode));break;case 4:c=Ct,h=Rn,Ct=a.stateNode.containerInfo,Rn=!0,Oi(n,i,a),Ct=c,Rn=h;break;case 0:case 11:case 14:case 15:if(!Mt&&(c=a.updateQueue,c!==null&&(c=c.lastEffect,c!==null))){h=c=c.next;do{var p=h,S=p.destroy;p=p.tag,S!==void 0&&((p&2)!==0||(p&4)!==0)&&qc(a,i,S),h=h.next}while(h!==c)}Oi(n,i,a);break;case 1:if(!Mt&&(oo(a,i),c=a.stateNode,typeof c.componentWillUnmount=="function"))try{c.props=a.memoizedProps,c.state=a.memoizedState,c.componentWillUnmount()}catch(A){ot(a,i,A)}Oi(n,i,a);break;case 21:Oi(n,i,a);break;case 22:a.mode&1?(Mt=(c=Mt)||a.memoizedState!==null,Oi(n,i,a),Mt=c):Oi(n,i,a);break;default:Oi(n,i,a)}}function $p(n){var i=n.updateQueue;if(i!==null){n.updateQueue=null;var a=n.stateNode;a===null&&(a=n.stateNode=new mT),i.forEach(function(c){var h=CT.bind(null,n,c);a.has(c)||(a.add(c),c.then(h,h))})}}function Pn(n,i){var a=i.deletions;if(a!==null)for(var c=0;c<a.length;c++){var h=a[c];try{var p=n,S=i,A=S;e:for(;A!==null;){switch(A.tag){case 5:Ct=A.stateNode,Rn=!1;break e;case 3:Ct=A.stateNode.containerInfo,Rn=!0;break e;case 4:Ct=A.stateNode.containerInfo,Rn=!0;break e}A=A.return}if(Ct===null)throw Error(r(160));xp(p,S,h),Ct=null,Rn=!1;var R=h.alternate;R!==null&&(R.return=null),h.return=null}catch(M){ot(h,i,M)}}if(i.subtreeFlags&12854)for(i=i.child;i!==null;)zp(i,n),i=i.sibling}function zp(n,i){var a=n.alternate,c=n.flags;switch(n.tag){case 0:case 11:case 14:case 15:if(Pn(i,n),jn(n),c&4){try{Is(3,n,n.return),al(3,n)}catch(oe){ot(n,n.return,oe)}try{Is(5,n,n.return)}catch(oe){ot(n,n.return,oe)}}break;case 1:Pn(i,n),jn(n),c&512&&a!==null&&oo(a,a.return);break;case 5:if(Pn(i,n),jn(n),c&512&&a!==null&&oo(a,a.return),n.flags&32){var h=n.stateNode;try{zo(h,"")}catch(oe){ot(n,n.return,oe)}}if(c&4&&(h=n.stateNode,h!=null)){var p=n.memoizedProps,S=a!==null?a.memoizedProps:p,A=n.type,R=n.updateQueue;if(n.updateQueue=null,R!==null)try{A==="input"&&p.type==="radio"&&p.name!=null&&bn(h,p),ku(A,S);var M=ku(A,p);for(S=0;S<R.length;S+=2){var G=R[S],z=R[S+1];G==="style"?_h(h,z):G==="dangerouslySetInnerHTML"?Eh(h,z):G==="children"?zo(h,z):D(h,G,z,M)}switch(A){case"input":Yt(h,p);break;case"textarea":Th(h,p);break;case"select":var b=h._wrapperState.wasMultiple;h._wrapperState.wasMultiple=!!p.multiple;var q=p.value;q!=null?yi(h,!!p.multiple,q,!1):b!==!!p.multiple&&(p.defaultValue!=null?yi(h,!!p.multiple,p.defaultValue,!0):yi(h,!!p.multiple,p.multiple?[]:"",!1))}h[ds]=p}catch(oe){ot(n,n.return,oe)}}break;case 6:if(Pn(i,n),jn(n),c&4){if(n.stateNode===null)throw Error(r(162));h=n.stateNode,p=n.memoizedProps;try{h.nodeValue=p}catch(oe){ot(n,n.return,oe)}}break;case 3:if(Pn(i,n),jn(n),c&4&&a!==null&&a.memoizedState.isDehydrated)try{es(i.containerInfo)}catch(oe){ot(n,n.return,oe)}break;case 4:Pn(i,n),jn(n);break;case 13:Pn(i,n),jn(n),h=n.child,h.flags&8192&&(p=h.memoizedState!==null,h.stateNode.isHidden=p,!p||h.alternate!==null&&h.alternate.memoizedState!==null||(id=at())),c&4&&$p(n);break;case 22:if(G=a!==null&&a.memoizedState!==null,n.mode&1?(Mt=(M=Mt)||G,Pn(i,n),Mt=M):Pn(i,n),jn(n),c&8192){if(M=n.memoizedState!==null,(n.stateNode.isHidden=M)&&!G&&(n.mode&1)!==0)for(Q=n,G=n.child;G!==null;){for(z=Q=G;Q!==null;){switch(b=Q,q=b.child,b.tag){case 0:case 11:case 14:case 15:Is(4,b,b.return);break;case 1:oo(b,b.return);var te=b.stateNode;if(typeof te.componentWillUnmount=="function"){c=b,a=b.return;try{i=c,te.props=i.memoizedProps,te.state=i.memoizedState,te.componentWillUnmount()}catch(oe){ot(c,a,oe)}}break;case 5:oo(b,b.return);break;case 22:if(b.memoizedState!==null){jp(z);continue}}q!==null?(q.return=b,Q=q):jp(z)}G=G.sibling}e:for(G=null,z=n;;){if(z.tag===5){if(G===null){G=z;try{h=z.stateNode,M?(p=h.style,typeof p.setProperty=="function"?p.setProperty("display","none","important"):p.display="none"):(A=z.stateNode,R=z.memoizedProps.style,S=R!=null&&R.hasOwnProperty("display")?R.display:null,A.style.display=wh("display",S))}catch(oe){ot(n,n.return,oe)}}}else if(z.tag===6){if(G===null)try{z.stateNode.nodeValue=M?"":z.memoizedProps}catch(oe){ot(n,n.return,oe)}}else if((z.tag!==22&&z.tag!==23||z.memoizedState===null||z===n)&&z.child!==null){z.child.return=z,z=z.child;continue}if(z===n)break e;for(;z.sibling===null;){if(z.return===null||z.return===n)break e;G===z&&(G=null),z=z.return}G===z&&(G=null),z.sibling.return=z.return,z=z.sibling}}break;case 19:Pn(i,n),jn(n),c&4&&$p(n);break;case 21:break;default:Pn(i,n),jn(n)}}function jn(n){var i=n.flags;if(i&2){try{e:{for(var a=n.return;a!==null;){if(bp(a)){var c=a;break e}a=a.return}throw Error(r(160))}switch(c.tag){case 5:var h=c.stateNode;c.flags&32&&(zo(h,""),c.flags&=-33);var p=Gp(n);ed(n,p,h);break;case 3:case 4:var S=c.stateNode.containerInfo,A=Gp(n);Jc(n,A,S);break;default:throw Error(r(161))}}catch(R){ot(n,n.return,R)}n.flags&=-3}i&4096&&(n.flags&=-4097)}function ST(n,i,a){Q=n,Wp(n)}function Wp(n,i,a){for(var c=(n.mode&1)!==0;Q!==null;){var h=Q,p=h.child;if(h.tag===22&&c){var S=h.memoizedState!==null||sl;if(!S){var A=h.alternate,R=A!==null&&A.memoizedState!==null||Mt;A=sl;var M=Mt;if(sl=S,(Mt=R)&&!M)for(Q=h;Q!==null;)S=Q,R=S.child,S.tag===22&&S.memoizedState!==null?Vp(h):R!==null?(R.return=S,Q=R):Vp(h);for(;p!==null;)Q=p,Wp(p),p=p.sibling;Q=h,sl=A,Mt=M}Yp(n)}else(h.subtreeFlags&8772)!==0&&p!==null?(p.return=h,Q=p):Yp(n)}}function Yp(n){for(;Q!==null;){var i=Q;if((i.flags&8772)!==0){var a=i.alternate;try{if((i.flags&8772)!==0)switch(i.tag){case 0:case 11:case 15:Mt||al(5,i);break;case 1:var c=i.stateNode;if(i.flags&4&&!Mt)if(a===null)c.componentDidMount();else{var h=i.elementType===i.type?a.memoizedProps:Cn(i.type,a.memoizedProps);c.componentDidUpdate(h,a.memoizedState,c.__reactInternalSnapshotBeforeUpdate)}var p=i.updateQueue;p!==null&&jg(i,p,c);break;case 3:var S=i.updateQueue;if(S!==null){if(a=null,i.child!==null)switch(i.child.tag){case 5:a=i.child.stateNode;break;case 1:a=i.child.stateNode}jg(i,S,a)}break;case 5:var A=i.stateNode;if(a===null&&i.flags&4){a=A;var R=i.memoizedProps;switch(i.type){case"button":case"input":case"select":case"textarea":R.autoFocus&&a.focus();break;case"img":R.src&&(a.src=R.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(i.memoizedState===null){var M=i.alternate;if(M!==null){var G=M.memoizedState;if(G!==null){var z=G.dehydrated;z!==null&&es(z)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(r(163))}Mt||i.flags&512&&Qc(i)}catch(b){ot(i,i.return,b)}}if(i===n){Q=null;break}if(a=i.sibling,a!==null){a.return=i.return,Q=a;break}Q=i.return}}function jp(n){for(;Q!==null;){var i=Q;if(i===n){Q=null;break}var a=i.sibling;if(a!==null){a.return=i.return,Q=a;break}Q=i.return}}function Vp(n){for(;Q!==null;){var i=Q;try{switch(i.tag){case 0:case 11:case 15:var a=i.return;try{al(4,i)}catch(R){ot(i,a,R)}break;case 1:var c=i.stateNode;if(typeof c.componentDidMount=="function"){var h=i.return;try{c.componentDidMount()}catch(R){ot(i,h,R)}}var p=i.return;try{Qc(i)}catch(R){ot(i,p,R)}break;case 5:var S=i.return;try{Qc(i)}catch(R){ot(i,S,R)}}}catch(R){ot(i,i.return,R)}if(i===n){Q=null;break}var A=i.sibling;if(A!==null){A.return=i.return,Q=A;break}Q=i.return}}var yT=Math.ceil,ll=H.ReactCurrentDispatcher,td=H.ReactCurrentOwner,gn=H.ReactCurrentBatchConfig,He=0,St=null,dt=null,Rt=0,rn=0,so=Ri(0),pt=0,Es=null,fr=0,ul=0,nd=0,ws=null,Kt=null,id=0,ao=1/0,ai=null,cl=!1,rd=null,Mi=null,dl=!1,Fi=null,fl=0,_s=0,od=null,hl=-1,gl=0;function bt(){return(He&6)!==0?at():hl!==-1?hl:hl=at()}function Ui(n){return(n.mode&1)===0?1:(He&2)!==0&&Rt!==0?Rt&-Rt:nT.transition!==null?(gl===0&&(gl=Gh()),gl):(n=We,n!==0||(n=window.event,n=n===void 0?16:Kh(n.type)),n)}function Nn(n,i,a,c){if(50<_s)throw _s=0,od=null,Error(r(185));Ko(n,a,c),((He&2)===0||n!==St)&&(n===St&&((He&2)===0&&(ul|=a),pt===4&&Bi(n,Rt)),Zt(n,c),a===1&&He===0&&(i.mode&1)===0&&(ao=at()+500,$a&&Ni()))}function Zt(n,i){var a=n.callbackNode;ny(n,i);var c=Ea(n,n===St?Rt:0);if(c===0)a!==null&&Lh(a),n.callbackNode=null,n.callbackPriority=0;else if(i=c&-c,n.callbackPriority!==i){if(a!=null&&Lh(a),i===1)n.tag===0?tT(Kp.bind(null,n)):Fg(Kp.bind(null,n)),qy(function(){(He&6)===0&&Ni()}),a=null;else{switch(xh(c)){case 1:a=Hu;break;case 4:a=Hh;break;case 16:a=ya;break;case 536870912:a=bh;break;default:a=ya}a=im(a,Xp.bind(null,n))}n.callbackPriority=i,n.callbackNode=a}}function Xp(n,i){if(hl=-1,gl=0,(He&6)!==0)throw Error(r(327));var a=n.callbackNode;if(lo()&&n.callbackNode!==a)return null;var c=Ea(n,n===St?Rt:0);if(c===0)return null;if((c&30)!==0||(c&n.expiredLanes)!==0||i)i=pl(n,c);else{i=c;var h=He;He|=2;var p=qp();(St!==n||Rt!==i)&&(ai=null,ao=at()+500,gr(n,i));do try{IT();break}catch(A){Zp(n,A)}while(!0);Ec(),ll.current=p,He=h,dt!==null?i=0:(St=null,Rt=0,i=pt)}if(i!==0){if(i===2&&(h=bu(n),h!==0&&(c=h,i=sd(n,h))),i===1)throw a=Es,gr(n,0),Bi(n,c),Zt(n,at()),a;if(i===6)Bi(n,c);else{if(h=n.current.alternate,(c&30)===0&&!TT(h)&&(i=pl(n,c),i===2&&(p=bu(n),p!==0&&(c=p,i=sd(n,p))),i===1))throw a=Es,gr(n,0),Bi(n,c),Zt(n,at()),a;switch(n.finishedWork=h,n.finishedLanes=c,i){case 0:case 1:throw Error(r(345));case 2:pr(n,Kt,ai);break;case 3:if(Bi(n,c),(c&130023424)===c&&(i=id+500-at(),10<i)){if(Ea(n,0)!==0)break;if(h=n.suspendedLanes,(h&c)!==c){bt(),n.pingedLanes|=n.suspendedLanes&h;break}n.timeoutHandle=fc(pr.bind(null,n,Kt,ai),i);break}pr(n,Kt,ai);break;case 4:if(Bi(n,c),(c&4194240)===c)break;for(i=n.eventTimes,h=-1;0<c;){var S=31-En(c);p=1<<S,S=i[S],S>h&&(h=S),c&=~p}if(c=h,c=at()-c,c=(120>c?120:480>c?480:1080>c?1080:1920>c?1920:3e3>c?3e3:4320>c?4320:1960*yT(c/1960))-c,10<c){n.timeoutHandle=fc(pr.bind(null,n,Kt,ai),c);break}pr(n,Kt,ai);break;case 5:pr(n,Kt,ai);break;default:throw Error(r(329))}}}return Zt(n,at()),n.callbackNode===a?Xp.bind(null,n):null}function sd(n,i){var a=ws;return n.current.memoizedState.isDehydrated&&(gr(n,i).flags|=256),n=pl(n,i),n!==2&&(i=Kt,Kt=a,i!==null&&ad(i)),n}function ad(n){Kt===null?Kt=n:Kt.push.apply(Kt,n)}function TT(n){for(var i=n;;){if(i.flags&16384){var a=i.updateQueue;if(a!==null&&(a=a.stores,a!==null))for(var c=0;c<a.length;c++){var h=a[c],p=h.getSnapshot;h=h.value;try{if(!wn(p(),h))return!1}catch{return!1}}}if(a=i.child,i.subtreeFlags&16384&&a!==null)a.return=i,i=a;else{if(i===n)break;for(;i.sibling===null;){if(i.return===null||i.return===n)return!0;i=i.return}i.sibling.return=i.return,i=i.sibling}}return!0}function Bi(n,i){for(i&=~nd,i&=~ul,n.suspendedLanes|=i,n.pingedLanes&=~i,n=n.expirationTimes;0<i;){var a=31-En(i),c=1<<a;n[a]=-1,i&=~c}}function Kp(n){if((He&6)!==0)throw Error(r(327));lo();var i=Ea(n,0);if((i&1)===0)return Zt(n,at()),null;var a=pl(n,i);if(n.tag!==0&&a===2){var c=bu(n);c!==0&&(i=c,a=sd(n,c))}if(a===1)throw a=Es,gr(n,0),Bi(n,i),Zt(n,at()),a;if(a===6)throw Error(r(345));return n.finishedWork=n.current.alternate,n.finishedLanes=i,pr(n,Kt,ai),Zt(n,at()),null}function ld(n,i){var a=He;He|=1;try{return n(i)}finally{He=a,He===0&&(ao=at()+500,$a&&Ni())}}function hr(n){Fi!==null&&Fi.tag===0&&(He&6)===0&&lo();var i=He;He|=1;var a=gn.transition,c=We;try{if(gn.transition=null,We=1,n)return n()}finally{We=c,gn.transition=a,He=i,(He&6)===0&&Ni()}}function ud(){rn=so.current,Xe(so)}function gr(n,i){n.finishedWork=null,n.finishedLanes=0;var a=n.timeoutHandle;if(a!==-1&&(n.timeoutHandle=-1,Zy(a)),dt!==null)for(a=dt.return;a!==null;){var c=a;switch(Sc(c),c.tag){case 1:c=c.type.childContextTypes,c!=null&&Ga();break;case 3:io(),Xe(jt),Xe(Dt),kc();break;case 5:Nc(c);break;case 4:io();break;case 13:Xe(it);break;case 19:Xe(it);break;case 10:wc(c.type._context);break;case 22:case 23:ud()}a=a.return}if(St=n,dt=n=Li(n.current,null),Rt=rn=i,pt=0,Es=null,nd=ul=fr=0,Kt=ws=null,ur!==null){for(i=0;i<ur.length;i++)if(a=ur[i],c=a.interleaved,c!==null){a.interleaved=null;var h=c.next,p=a.pending;if(p!==null){var S=p.next;p.next=h,c.next=S}a.pending=c}ur=null}return n}function Zp(n,i){do{var a=dt;try{if(Ec(),Qa.current=nl,Ja){for(var c=rt.memoizedState;c!==null;){var h=c.queue;h!==null&&(h.pending=null),c=c.next}Ja=!1}if(dr=0,vt=gt=rt=null,vs=!1,Ss=0,td.current=null,a===null||a.return===null){pt=1,Es=i,dt=null;break}e:{var p=n,S=a.return,A=a,R=i;if(i=Rt,A.flags|=32768,R!==null&&typeof R=="object"&&typeof R.then=="function"){var M=R,G=A,z=G.tag;if((G.mode&1)===0&&(z===0||z===11||z===15)){var b=G.alternate;b?(G.updateQueue=b.updateQueue,G.memoizedState=b.memoizedState,G.lanes=b.lanes):(G.updateQueue=null,G.memoizedState=null)}var q=Ap(S);if(q!==null){q.flags&=-257,Ip(q,S,A,p,i),q.mode&1&&Tp(p,M,i),i=q,R=M;var te=i.updateQueue;if(te===null){var oe=new Set;oe.add(R),i.updateQueue=oe}else te.add(R);break e}else{if((i&1)===0){Tp(p,M,i),cd();break e}R=Error(r(426))}}else if(Qe&&A.mode&1){var lt=Ap(S);if(lt!==null){(lt.flags&65536)===0&&(lt.flags|=256),Ip(lt,S,A,p,i),Ac(ro(R,A));break e}}p=R=ro(R,A),pt!==4&&(pt=2),ws===null?ws=[p]:ws.push(p),p=S;do{switch(p.tag){case 3:p.flags|=65536,i&=-i,p.lanes|=i;var k=Sp(p,R,i);Yg(p,k);break e;case 1:A=R;var N=p.type,O=p.stateNode;if((p.flags&128)===0&&(typeof N.getDerivedStateFromError=="function"||O!==null&&typeof O.componentDidCatch=="function"&&(Mi===null||!Mi.has(O)))){p.flags|=65536,i&=-i,p.lanes|=i;var j=yp(p,A,i);Yg(p,j);break e}}p=p.return}while(p!==null)}Jp(a)}catch(le){i=le,dt===a&&a!==null&&(dt=a=a.return);continue}break}while(!0)}function qp(){var n=ll.current;return ll.current=nl,n===null?nl:n}function cd(){(pt===0||pt===3||pt===2)&&(pt=4),St===null||(fr&268435455)===0&&(ul&268435455)===0||Bi(St,Rt)}function pl(n,i){var a=He;He|=2;var c=qp();(St!==n||Rt!==i)&&(ai=null,gr(n,i));do try{AT();break}catch(h){Zp(n,h)}while(!0);if(Ec(),He=a,ll.current=c,dt!==null)throw Error(r(261));return St=null,Rt=0,pt}function AT(){for(;dt!==null;)Qp(dt)}function IT(){for(;dt!==null&&!VS();)Qp(dt)}function Qp(n){var i=nm(n.alternate,n,rn);n.memoizedProps=n.pendingProps,i===null?Jp(n):dt=i,td.current=null}function Jp(n){var i=n;do{var a=i.alternate;if(n=i.return,(i.flags&32768)===0){if(a=gT(a,i,rn),a!==null){dt=a;return}}else{if(a=pT(a,i),a!==null){a.flags&=32767,dt=a;return}if(n!==null)n.flags|=32768,n.subtreeFlags=0,n.deletions=null;else{pt=6,dt=null;return}}if(i=i.sibling,i!==null){dt=i;return}dt=i=n}while(i!==null);pt===0&&(pt=5)}function pr(n,i,a){var c=We,h=gn.transition;try{gn.transition=null,We=1,ET(n,i,a,c)}finally{gn.transition=h,We=c}return null}function ET(n,i,a,c){do lo();while(Fi!==null);if((He&6)!==0)throw Error(r(327));a=n.finishedWork;var h=n.finishedLanes;if(a===null)return null;if(n.finishedWork=null,n.finishedLanes=0,a===n.current)throw Error(r(177));n.callbackNode=null,n.callbackPriority=0;var p=a.lanes|a.childLanes;if(iy(n,p),n===St&&(dt=St=null,Rt=0),(a.subtreeFlags&2064)===0&&(a.flags&2064)===0||dl||(dl=!0,im(ya,function(){return lo(),null})),p=(a.flags&15990)!==0,(a.subtreeFlags&15990)!==0||p){p=gn.transition,gn.transition=null;var S=We;We=1;var A=He;He|=4,td.current=null,vT(n,a),zp(a,n),zy(cc),Ca=!!uc,cc=uc=null,n.current=a,ST(a),XS(),He=A,We=S,gn.transition=p}else n.current=a;if(dl&&(dl=!1,Fi=n,fl=h),p=n.pendingLanes,p===0&&(Mi=null),qS(a.stateNode),Zt(n,at()),i!==null)for(c=n.onRecoverableError,a=0;a<i.length;a++)h=i[a],c(h.value,{componentStack:h.stack,digest:h.digest});if(cl)throw cl=!1,n=rd,rd=null,n;return(fl&1)!==0&&n.tag!==0&&lo(),p=n.pendingLanes,(p&1)!==0?n===od?_s++:(_s=0,od=n):_s=0,Ni(),null}function lo(){if(Fi!==null){var n=xh(fl),i=gn.transition,a=We;try{if(gn.transition=null,We=16>n?16:n,Fi===null)var c=!1;else{if(n=Fi,Fi=null,fl=0,(He&6)!==0)throw Error(r(331));var h=He;for(He|=4,Q=n.current;Q!==null;){var p=Q,S=p.child;if((Q.flags&16)!==0){var A=p.deletions;if(A!==null){for(var R=0;R<A.length;R++){var M=A[R];for(Q=M;Q!==null;){var G=Q;switch(G.tag){case 0:case 11:case 15:Is(8,G,p)}var z=G.child;if(z!==null)z.return=G,Q=z;else for(;Q!==null;){G=Q;var b=G.sibling,q=G.return;if(Hp(G),G===M){Q=null;break}if(b!==null){b.return=q,Q=b;break}Q=q}}}var te=p.alternate;if(te!==null){var oe=te.child;if(oe!==null){te.child=null;do{var lt=oe.sibling;oe.sibling=null,oe=lt}while(oe!==null)}}Q=p}}if((p.subtreeFlags&2064)!==0&&S!==null)S.return=p,Q=S;else e:for(;Q!==null;){if(p=Q,(p.flags&2048)!==0)switch(p.tag){case 0:case 11:case 15:Is(9,p,p.return)}var k=p.sibling;if(k!==null){k.return=p.return,Q=k;break e}Q=p.return}}var N=n.current;for(Q=N;Q!==null;){S=Q;var O=S.child;if((S.subtreeFlags&2064)!==0&&O!==null)O.return=S,Q=O;else e:for(S=N;Q!==null;){if(A=Q,(A.flags&2048)!==0)try{switch(A.tag){case 0:case 11:case 15:al(9,A)}}catch(le){ot(A,A.return,le)}if(A===S){Q=null;break e}var j=A.sibling;if(j!==null){j.return=A.return,Q=j;break e}Q=A.return}}if(He=h,Ni(),$n&&typeof $n.onPostCommitFiberRoot=="function")try{$n.onPostCommitFiberRoot(Ta,n)}catch{}c=!0}return c}finally{We=a,gn.transition=i}}return!1}function em(n,i,a){i=ro(a,i),i=Sp(n,i,1),n=ki(n,i,1),i=bt(),n!==null&&(Ko(n,1,i),Zt(n,i))}function ot(n,i,a){if(n.tag===3)em(n,n,a);else for(;i!==null;){if(i.tag===3){em(i,n,a);break}else if(i.tag===1){var c=i.stateNode;if(typeof i.type.getDerivedStateFromError=="function"||typeof c.componentDidCatch=="function"&&(Mi===null||!Mi.has(c))){n=ro(a,n),n=yp(i,n,1),i=ki(i,n,1),n=bt(),i!==null&&(Ko(i,1,n),Zt(i,n));break}}i=i.return}}function wT(n,i,a){var c=n.pingCache;c!==null&&c.delete(i),i=bt(),n.pingedLanes|=n.suspendedLanes&a,St===n&&(Rt&a)===a&&(pt===4||pt===3&&(Rt&130023424)===Rt&&500>at()-id?gr(n,0):nd|=a),Zt(n,i)}function tm(n,i){i===0&&((n.mode&1)===0?i=1:(i=Ia,Ia<<=1,(Ia&130023424)===0&&(Ia=4194304)));var a=bt();n=ri(n,i),n!==null&&(Ko(n,i,a),Zt(n,a))}function _T(n){var i=n.memoizedState,a=0;i!==null&&(a=i.retryLane),tm(n,a)}function CT(n,i){var a=0;switch(n.tag){case 13:var c=n.stateNode,h=n.memoizedState;h!==null&&(a=h.retryLane);break;case 19:c=n.stateNode;break;default:throw Error(r(314))}c!==null&&c.delete(i),tm(n,a)}var nm;nm=function(n,i,a){if(n!==null)if(n.memoizedProps!==i.pendingProps||jt.current)Xt=!0;else{if((n.lanes&a)===0&&(i.flags&128)===0)return Xt=!1,hT(n,i,a);Xt=(n.flags&131072)!==0}else Xt=!1,Qe&&(i.flags&1048576)!==0&&Ug(i,Wa,i.index);switch(i.lanes=0,i.tag){case 2:var c=i.type;ol(n,i),n=i.pendingProps;var h=Zr(i,Dt.current);no(i,a),h=Fc(null,i,c,n,h,a);var p=Uc();return i.flags|=1,typeof h=="object"&&h!==null&&typeof h.render=="function"&&h.$$typeof===void 0?(i.tag=1,i.memoizedState=null,i.updateQueue=null,Vt(c)?(p=!0,xa(i)):p=!1,i.memoizedState=h.state!==null&&h.state!==void 0?h.state:null,Rc(i),h.updater=il,i.stateNode=h,h._reactInternals=i,xc(i,c,n,a),i=Yc(null,i,c,!0,p,a)):(i.tag=0,Qe&&p&&vc(i),Ht(null,i,h,a),i=i.child),i;case 16:c=i.elementType;e:{switch(ol(n,i),n=i.pendingProps,h=c._init,c=h(c._payload),i.type=c,h=i.tag=PT(c),n=Cn(c,n),h){case 0:i=Wc(null,i,c,n,a);break e;case 1:i=Pp(null,i,c,n,a);break e;case 11:i=Ep(null,i,c,n,a);break e;case 14:i=wp(null,i,c,Cn(c.type,n),a);break e}throw Error(r(306,c,""))}return i;case 0:return c=i.type,h=i.pendingProps,h=i.elementType===c?h:Cn(c,h),Wc(n,i,c,h,a);case 1:return c=i.type,h=i.pendingProps,h=i.elementType===c?h:Cn(c,h),Pp(n,i,c,h,a);case 3:e:{if(Np(i),n===null)throw Error(r(387));c=i.pendingProps,p=i.memoizedState,h=p.element,Wg(n,i),Za(i,c,null,a);var S=i.memoizedState;if(c=S.element,p.isDehydrated)if(p={element:c,isDehydrated:!1,cache:S.cache,pendingSuspenseBoundaries:S.pendingSuspenseBoundaries,transitions:S.transitions},i.updateQueue.baseState=p,i.memoizedState=p,i.flags&256){h=ro(Error(r(423)),i),i=Dp(n,i,c,a,h);break e}else if(c!==h){h=ro(Error(r(424)),i),i=Dp(n,i,c,a,h);break e}else for(nn=Ci(i.stateNode.containerInfo.firstChild),tn=i,Qe=!0,_n=null,a=$g(i,null,c,a),i.child=a;a;)a.flags=a.flags&-3|4096,a=a.sibling;else{if(Jr(),c===h){i=si(n,i,a);break e}Ht(n,i,c,a)}i=i.child}return i;case 5:return Vg(i),n===null&&Tc(i),c=i.type,h=i.pendingProps,p=n!==null?n.memoizedProps:null,S=h.children,dc(c,h)?S=null:p!==null&&dc(c,p)&&(i.flags|=32),Rp(n,i),Ht(n,i,S,a),i.child;case 6:return n===null&&Tc(i),null;case 13:return kp(n,i,a);case 4:return Pc(i,i.stateNode.containerInfo),c=i.pendingProps,n===null?i.child=eo(i,null,c,a):Ht(n,i,c,a),i.child;case 11:return c=i.type,h=i.pendingProps,h=i.elementType===c?h:Cn(c,h),Ep(n,i,c,h,a);case 7:return Ht(n,i,i.pendingProps,a),i.child;case 8:return Ht(n,i,i.pendingProps.children,a),i.child;case 12:return Ht(n,i,i.pendingProps.children,a),i.child;case 10:e:{if(c=i.type._context,h=i.pendingProps,p=i.memoizedProps,S=h.value,Ye(Va,c._currentValue),c._currentValue=S,p!==null)if(wn(p.value,S)){if(p.children===h.children&&!jt.current){i=si(n,i,a);break e}}else for(p=i.child,p!==null&&(p.return=i);p!==null;){var A=p.dependencies;if(A!==null){S=p.child;for(var R=A.firstContext;R!==null;){if(R.context===c){if(p.tag===1){R=oi(-1,a&-a),R.tag=2;var M=p.updateQueue;if(M!==null){M=M.shared;var G=M.pending;G===null?R.next=R:(R.next=G.next,G.next=R),M.pending=R}}p.lanes|=a,R=p.alternate,R!==null&&(R.lanes|=a),_c(p.return,a,i),A.lanes|=a;break}R=R.next}}else if(p.tag===10)S=p.type===i.type?null:p.child;else if(p.tag===18){if(S=p.return,S===null)throw Error(r(341));S.lanes|=a,A=S.alternate,A!==null&&(A.lanes|=a),_c(S,a,i),S=p.sibling}else S=p.child;if(S!==null)S.return=p;else for(S=p;S!==null;){if(S===i){S=null;break}if(p=S.sibling,p!==null){p.return=S.return,S=p;break}S=S.return}p=S}Ht(n,i,h.children,a),i=i.child}return i;case 9:return h=i.type,c=i.pendingProps.children,no(i,a),h=fn(h),c=c(h),i.flags|=1,Ht(n,i,c,a),i.child;case 14:return c=i.type,h=Cn(c,i.pendingProps),h=Cn(c.type,h),wp(n,i,c,h,a);case 15:return _p(n,i,i.type,i.pendingProps,a);case 17:return c=i.type,h=i.pendingProps,h=i.elementType===c?h:Cn(c,h),ol(n,i),i.tag=1,Vt(c)?(n=!0,xa(i)):n=!1,no(i,a),mp(i,c,h),xc(i,c,h,a),Yc(null,i,c,!0,n,a);case 19:return Mp(n,i,a);case 22:return Cp(n,i,a)}throw Error(r(156,i.tag))};function im(n,i){return Bh(n,i)}function RT(n,i,a,c){this.tag=n,this.key=a,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=i,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=c,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function pn(n,i,a,c){return new RT(n,i,a,c)}function dd(n){return n=n.prototype,!(!n||!n.isReactComponent)}function PT(n){if(typeof n=="function")return dd(n)?1:0;if(n!=null){if(n=n.$$typeof,n===Ne)return 11;if(n===Ue)return 14}return 2}function Li(n,i){var a=n.alternate;return a===null?(a=pn(n.tag,i,n.key,n.mode),a.elementType=n.elementType,a.type=n.type,a.stateNode=n.stateNode,a.alternate=n,n.alternate=a):(a.pendingProps=i,a.type=n.type,a.flags=0,a.subtreeFlags=0,a.deletions=null),a.flags=n.flags&14680064,a.childLanes=n.childLanes,a.lanes=n.lanes,a.child=n.child,a.memoizedProps=n.memoizedProps,a.memoizedState=n.memoizedState,a.updateQueue=n.updateQueue,i=n.dependencies,a.dependencies=i===null?null:{lanes:i.lanes,firstContext:i.firstContext},a.sibling=n.sibling,a.index=n.index,a.ref=n.ref,a}function ml(n,i,a,c,h,p){var S=2;if(c=n,typeof n=="function")dd(n)&&(S=1);else if(typeof n=="string")S=5;else e:switch(n){case $:return mr(a.children,h,p,i);case ee:S=8,h|=8;break;case _e:return n=pn(12,a,i,h|2),n.elementType=_e,n.lanes=p,n;case Pe:return n=pn(13,a,i,h),n.elementType=Pe,n.lanes=p,n;case de:return n=pn(19,a,i,h),n.elementType=de,n.lanes=p,n;case ne:return vl(a,h,p,i);default:if(typeof n=="object"&&n!==null)switch(n.$$typeof){case Ce:S=10;break e;case Ge:S=9;break e;case Ne:S=11;break e;case Ue:S=14;break e;case Te:S=16,c=null;break e}throw Error(r(130,n==null?n:typeof n,""))}return i=pn(S,a,i,h),i.elementType=n,i.type=c,i.lanes=p,i}function mr(n,i,a,c){return n=pn(7,n,c,i),n.lanes=a,n}function vl(n,i,a,c){return n=pn(22,n,c,i),n.elementType=ne,n.lanes=a,n.stateNode={isHidden:!1},n}function fd(n,i,a){return n=pn(6,n,null,i),n.lanes=a,n}function hd(n,i,a){return i=pn(4,n.children!==null?n.children:[],n.key,i),i.lanes=a,i.stateNode={containerInfo:n.containerInfo,pendingChildren:null,implementation:n.implementation},i}function NT(n,i,a,c,h){this.tag=i,this.containerInfo=n,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Gu(0),this.expirationTimes=Gu(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Gu(0),this.identifierPrefix=c,this.onRecoverableError=h,this.mutableSourceEagerHydrationData=null}function gd(n,i,a,c,h,p,S,A,R){return n=new NT(n,i,a,A,R),i===1?(i=1,p===!0&&(i|=8)):i=0,p=pn(3,null,null,i),n.current=p,p.stateNode=n,p.memoizedState={element:c,isDehydrated:a,cache:null,transitions:null,pendingSuspenseBoundaries:null},Rc(p),n}function DT(n,i,a){var c=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:U,key:c==null?null:""+c,children:n,containerInfo:i,implementation:a}}function rm(n){if(!n)return Pi;n=n._reactInternals;e:{if(rr(n)!==n||n.tag!==1)throw Error(r(170));var i=n;do{switch(i.tag){case 3:i=i.stateNode.context;break e;case 1:if(Vt(i.type)){i=i.stateNode.__reactInternalMemoizedMergedChildContext;break e}}i=i.return}while(i!==null);throw Error(r(171))}if(n.tag===1){var a=n.type;if(Vt(a))return Og(n,a,i)}return i}function om(n,i,a,c,h,p,S,A,R){return n=gd(a,c,!0,n,h,p,S,A,R),n.context=rm(null),a=n.current,c=bt(),h=Ui(a),p=oi(c,h),p.callback=i??null,ki(a,p,h),n.current.lanes=h,Ko(n,h,c),Zt(n,c),n}function Sl(n,i,a,c){var h=i.current,p=bt(),S=Ui(h);return a=rm(a),i.context===null?i.context=a:i.pendingContext=a,i=oi(p,S),i.payload={element:n},c=c===void 0?null:c,c!==null&&(i.callback=c),n=ki(h,i,S),n!==null&&(Nn(n,h,S,p),Ka(n,h,S)),S}function yl(n){if(n=n.current,!n.child)return null;switch(n.child.tag){case 5:return n.child.stateNode;default:return n.child.stateNode}}function sm(n,i){if(n=n.memoizedState,n!==null&&n.dehydrated!==null){var a=n.retryLane;n.retryLane=a!==0&&a<i?a:i}}function pd(n,i){sm(n,i),(n=n.alternate)&&sm(n,i)}function kT(){return null}var am=typeof reportError=="function"?reportError:function(n){console.error(n)};function md(n){this._internalRoot=n}Tl.prototype.render=md.prototype.render=function(n){var i=this._internalRoot;if(i===null)throw Error(r(409));Sl(n,i,null,null)},Tl.prototype.unmount=md.prototype.unmount=function(){var n=this._internalRoot;if(n!==null){this._internalRoot=null;var i=n.containerInfo;hr(function(){Sl(null,n,null,null)}),i[ei]=null}};function Tl(n){this._internalRoot=n}Tl.prototype.unstable_scheduleHydration=function(n){if(n){var i=Wh();n={blockedOn:null,target:n,priority:i};for(var a=0;a<Ei.length&&i!==0&&i<Ei[a].priority;a++);Ei.splice(a,0,n),a===0&&Vh(n)}};function vd(n){return!(!n||n.nodeType!==1&&n.nodeType!==9&&n.nodeType!==11)}function Al(n){return!(!n||n.nodeType!==1&&n.nodeType!==9&&n.nodeType!==11&&(n.nodeType!==8||n.nodeValue!==" react-mount-point-unstable "))}function lm(){}function OT(n,i,a,c,h){if(h){if(typeof c=="function"){var p=c;c=function(){var M=yl(S);p.call(M)}}var S=om(i,c,n,0,null,!1,!1,"",lm);return n._reactRootContainer=S,n[ei]=S.current,us(n.nodeType===8?n.parentNode:n),hr(),S}for(;h=n.lastChild;)n.removeChild(h);if(typeof c=="function"){var A=c;c=function(){var M=yl(R);A.call(M)}}var R=gd(n,0,!1,null,null,!1,!1,"",lm);return n._reactRootContainer=R,n[ei]=R.current,us(n.nodeType===8?n.parentNode:n),hr(function(){Sl(i,R,a,c)}),R}function Il(n,i,a,c,h){var p=a._reactRootContainer;if(p){var S=p;if(typeof h=="function"){var A=h;h=function(){var R=yl(S);A.call(R)}}Sl(i,S,n,h)}else S=OT(a,i,n,h,c);return yl(S)}$h=function(n){switch(n.tag){case 3:var i=n.stateNode;if(i.current.memoizedState.isDehydrated){var a=Xo(i.pendingLanes);a!==0&&(xu(i,a|1),Zt(i,at()),(He&6)===0&&(ao=at()+500,Ni()))}break;case 13:hr(function(){var c=ri(n,1);if(c!==null){var h=bt();Nn(c,n,1,h)}}),pd(n,1)}},$u=function(n){if(n.tag===13){var i=ri(n,134217728);if(i!==null){var a=bt();Nn(i,n,134217728,a)}pd(n,134217728)}},zh=function(n){if(n.tag===13){var i=Ui(n),a=ri(n,i);if(a!==null){var c=bt();Nn(a,n,i,c)}pd(n,i)}},Wh=function(){return We},Yh=function(n,i){var a=We;try{return We=n,i()}finally{We=a}},Fu=function(n,i,a){switch(i){case"input":if(Yt(n,a),i=a.name,a.type==="radio"&&i!=null){for(a=n;a.parentNode;)a=a.parentNode;for(a=a.querySelectorAll("input[name="+JSON.stringify(""+i)+'][type="radio"]'),i=0;i<a.length;i++){var c=a[i];if(c!==n&&c.form===n.form){var h=ba(c);if(!h)throw Error(r(90));he(c),Yt(c,h)}}}break;case"textarea":Th(n,a);break;case"select":i=a.value,i!=null&&yi(n,!!a.multiple,i,!1)}},Nh=ld,Dh=hr;var MT={usingClientEntryPoint:!1,Events:[fs,Xr,ba,Rh,Ph,ld]},Cs={findFiberByHostInstance:or,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},FT={bundleType:Cs.bundleType,version:Cs.version,rendererPackageName:Cs.rendererPackageName,rendererConfig:Cs.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:H.ReactCurrentDispatcher,findHostInstanceByFiber:function(n){return n=Fh(n),n===null?null:n.stateNode},findFiberByHostInstance:Cs.findFiberByHostInstance||kT,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var El=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!El.isDisabled&&El.supportsFiber)try{Ta=El.inject(FT),$n=El}catch{}}return qt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=MT,qt.createPortal=function(n,i){var a=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!vd(i))throw Error(r(200));return DT(n,i,null,a)},qt.createRoot=function(n,i){if(!vd(n))throw Error(r(299));var a=!1,c="",h=am;return i!=null&&(i.unstable_strictMode===!0&&(a=!0),i.identifierPrefix!==void 0&&(c=i.identifierPrefix),i.onRecoverableError!==void 0&&(h=i.onRecoverableError)),i=gd(n,1,!1,null,null,a,!1,c,h),n[ei]=i.current,us(n.nodeType===8?n.parentNode:n),new md(i)},qt.findDOMNode=function(n){if(n==null)return null;if(n.nodeType===1)return n;var i=n._reactInternals;if(i===void 0)throw typeof n.render=="function"?Error(r(188)):(n=Object.keys(n).join(","),Error(r(268,n)));return n=Fh(i),n=n===null?null:n.stateNode,n},qt.flushSync=function(n){return hr(n)},qt.hydrate=function(n,i,a){if(!Al(i))throw Error(r(200));return Il(null,n,i,!0,a)},qt.hydrateRoot=function(n,i,a){if(!vd(n))throw Error(r(405));var c=a!=null&&a.hydratedSources||null,h=!1,p="",S=am;if(a!=null&&(a.unstable_strictMode===!0&&(h=!0),a.identifierPrefix!==void 0&&(p=a.identifierPrefix),a.onRecoverableError!==void 0&&(S=a.onRecoverableError)),i=om(i,null,n,1,a??null,h,!1,p,S),n[ei]=i.current,us(n),c)for(n=0;n<c.length;n++)a=c[n],h=a._getVersion,h=h(a._source),i.mutableSourceEagerHydrationData==null?i.mutableSourceEagerHydrationData=[a,h]:i.mutableSourceEagerHydrationData.push(a,h);return new Tl(i)},qt.render=function(n,i,a){if(!Al(i))throw Error(r(200));return Il(null,n,i,!1,a)},qt.unmountComponentAtNode=function(n){if(!Al(n))throw Error(r(40));return n._reactRootContainer?(hr(function(){Il(null,null,n,!1,function(){n._reactRootContainer=null,n[ei]=null})}),!0):!1},qt.unstable_batchedUpdates=ld,qt.unstable_renderSubtreeIntoContainer=function(n,i,a,c){if(!Al(a))throw Error(r(200));if(n==null||n._reactInternals===void 0)throw Error(r(38));return Il(n,i,a,!1,c)},qt.version="18.3.1-next-f1338f8080-20240426",qt}var mm;function WT(){if(mm)return Td.exports;mm=1;function e(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}return e(),Td.exports=zT(),Td.exports}var vm;function YT(){if(vm)return wl;vm=1;var e=WT();return wl.createRoot=e.createRoot,wl.hydrateRoot=e.hydrateRoot,wl}var jT=YT();const VT=W0(jT);class XT{constructor(){this.ids=[],this.values=[],this.length=0}clear(){this.length=0}push(t,r){let o=this.length++;for(;o>0;){const l=o-1>>1,s=this.values[l];if(r>=s)break;this.ids[o]=this.ids[l],this.values[o]=s,o=l}this.ids[o]=t,this.values[o]=r}pop(){if(this.length===0)return;const t=this.ids[0];if(this.length--,this.length>0){const r=this.ids[0]=this.ids[this.length],o=this.values[0]=this.values[this.length],l=this.length>>1;let s=0;for(;s<l;){let u=(s<<1)+1;const d=u+1;let f=this.ids[u],g=this.values[u];const m=this.values[d];if(d<this.length&&m<g&&(u=d,f=this.ids[d],g=m),g>=o)break;this.ids[s]=f,this.values[s]=g,s=u}this.ids[s]=r,this.values[s]=o}return t}peek(){if(this.length!==0)return this.ids[0]}peekValue(){if(this.length!==0)return this.values[0]}shrink(){this.ids.length=this.values.length=this.length}}const Sm=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array],Ed=3;class Bf{static from(t,r=0){if(r%8!==0)throw new Error("byteOffset must be 8-byte aligned.");if(!t||t.byteLength===void 0||t.buffer)throw new Error("Data must be an instance of ArrayBuffer or SharedArrayBuffer.");const[o,l]=new Uint8Array(t,r+0,2);if(o!==251)throw new Error("Data does not appear to be in a Flatbush format.");const s=l>>4;if(s!==Ed)throw new Error(`Got v${s} data when expected v${Ed}.`);const u=Sm[l&15];if(!u)throw new Error("Unrecognized array type.");const[d]=new Uint16Array(t,r+2,1),[f]=new Uint32Array(t,r+4,1);return new Bf(f,d,u,void 0,t,r)}constructor(t,r=16,o=Float64Array,l=ArrayBuffer,s,u=0){if(t===void 0)throw new Error("Missing required argument: numItems.");if(isNaN(t)||t<=0)throw new Error(`Unexpected numItems value: ${t}.`);this.numItems=+t,this.nodeSize=Math.min(Math.max(+r,2),65535),this.byteOffset=u;let d=t,f=d;this._levelBounds=[d*4];do d=Math.ceil(d/this.nodeSize),f+=d,this._levelBounds.push(f*4);while(d!==1);this.ArrayType=o,this.IndexArrayType=f<16384?Uint16Array:Uint32Array;const g=Sm.indexOf(this.ArrayType),m=f*4*this.ArrayType.BYTES_PER_ELEMENT;if(g<0)throw new Error(`Unexpected typed array class: ${o}.`);s&&s.byteLength!==void 0&&!s.buffer?(this.data=s,this._boxes=new this.ArrayType(this.data,u+8,f*4),this._indices=new this.IndexArrayType(this.data,u+8+m,f),this._pos=f*4,this.minX=this._boxes[this._pos-4],this.minY=this._boxes[this._pos-3],this.maxX=this._boxes[this._pos-2],this.maxY=this._boxes[this._pos-1]):(this.data=new l(8+m+f*this.IndexArrayType.BYTES_PER_ELEMENT),this._boxes=new this.ArrayType(this.data,8,f*4),this._indices=new this.IndexArrayType(this.data,8+m,f),this._pos=0,this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0,new Uint8Array(this.data,0,2).set([251,(Ed<<4)+g]),new Uint16Array(this.data,2,1)[0]=r,new Uint32Array(this.data,4,1)[0]=t),this._queue=new XT}add(t,r,o=t,l=r){const s=this._pos>>2,u=this._boxes;return this._indices[s]=s,u[this._pos++]=t,u[this._pos++]=r,u[this._pos++]=o,u[this._pos++]=l,t<this.minX&&(this.minX=t),r<this.minY&&(this.minY=r),o>this.maxX&&(this.maxX=o),l>this.maxY&&(this.maxY=l),s}finish(){if(this._pos>>2!==this.numItems)throw new Error(`Added ${this._pos>>2} items when expected ${this.numItems}.`);const t=this._boxes;if(this.numItems<=this.nodeSize){t[this._pos++]=this.minX,t[this._pos++]=this.minY,t[this._pos++]=this.maxX,t[this._pos++]=this.maxY;return}const r=this.maxX-this.minX||1,o=this.maxY-this.minY||1,l=new Uint32Array(this.numItems),s=65535;for(let u=0,d=0;u<this.numItems;u++){const f=t[d++],g=t[d++],m=t[d++],v=t[d++],y=Math.floor(s*((f+m)/2-this.minX)/r),w=Math.floor(s*((g+v)/2-this.minY)/o);l[u]=ZT(y,w)}sf(l,t,this._indices,0,this.numItems-1,this.nodeSize);for(let u=0,d=0;u<this._levelBounds.length-1;u++){const f=this._levelBounds[u];for(;d<f;){const g=d;let m=t[d++],v=t[d++],y=t[d++],w=t[d++];for(let I=1;I<this.nodeSize&&d<f;I++)m=Math.min(m,t[d++]),v=Math.min(v,t[d++]),y=Math.max(y,t[d++]),w=Math.max(w,t[d++]);this._indices[this._pos>>2]=g,t[this._pos++]=m,t[this._pos++]=v,t[this._pos++]=y,t[this._pos++]=w}}}search(t,r,o,l,s){if(this._pos!==this._boxes.length)throw new Error("Data not yet indexed - call index.finish().");let u=this._boxes.length-4;const d=[],f=[];for(;u!==void 0;){const g=Math.min(u+this.nodeSize*4,Tm(u,this._levelBounds));for(let m=u;m<g;m+=4){if(o<this._boxes[m]||l<this._boxes[m+1]||t>this._boxes[m+2]||r>this._boxes[m+3])continue;const v=this._indices[m>>2]|0;u>=this.numItems*4?d.push(v):(s===void 0||s(v))&&f.push(v)}u=d.pop()}return f}neighbors(t,r,o=1/0,l=1/0,s){if(this._pos!==this._boxes.length)throw new Error("Data not yet indexed - call index.finish().");let u=this._boxes.length-4;const d=this._queue,f=[],g=l*l;e:for(;u!==void 0;){const m=Math.min(u+this.nodeSize*4,Tm(u,this._levelBounds));for(let v=u;v<m;v+=4){const y=this._indices[v>>2]|0,w=ym(t,this._boxes[v],this._boxes[v+2]),I=ym(r,this._boxes[v+1],this._boxes[v+3]),E=w*w+I*I;E>g||(u>=this.numItems*4?d.push(y<<1,E):(s===void 0||s(y))&&d.push((y<<1)+1,E))}for(;d.length&&d.peek()&1;)if(d.peekValue()>g||(f.push(d.pop()>>1),f.length===o))break e;u=d.length?d.pop()>>1:void 0}return d.clear(),f}}function ym(e,t,r){return e<t?t-e:e<=r?0:e-r}function Tm(e,t){let r=0,o=t.length-1;for(;r<o;){const l=r+o>>1;t[l]>e?o=l:r=l+1}return t[r]}function sf(e,t,r,o,l,s){if(Math.floor(o/s)>=Math.floor(l/s))return;const u=e[o+l>>1];let d=o-1,f=l+1;for(;;){do d++;while(e[d]<u);do f--;while(e[f]>u);if(d>=f)break;KT(e,t,r,d,f)}sf(e,t,r,o,f,s),sf(e,t,r,f+1,l,s)}function KT(e,t,r,o,l){const s=e[o];e[o]=e[l],e[l]=s;const u=4*o,d=4*l,f=t[u],g=t[u+1],m=t[u+2],v=t[u+3];t[u]=t[d],t[u+1]=t[d+1],t[u+2]=t[d+2],t[u+3]=t[d+3],t[d]=f,t[d+1]=g,t[d+2]=m,t[d+3]=v;const y=r[o];r[o]=r[l],r[l]=y}function ZT(e,t){let r=e^t,o=65535^r,l=65535^(e|t),s=e&(t^65535),u=r|o>>1,d=r>>1^r,f=l>>1^o&s>>1^l,g=r&l>>1^s>>1^s;r=u,o=d,l=f,s=g,u=r&r>>2^o&o>>2,d=r&o>>2^o&(r^o)>>2,f^=r&l>>2^o&s>>2,g^=o&l>>2^(r^o)&s>>2,r=u,o=d,l=f,s=g,u=r&r>>4^o&o>>4,d=r&o>>4^o&(r^o)>>4,f^=r&l>>4^o&s>>4,g^=o&l>>4^(r^o)&s>>4,r=u,o=d,l=f,s=g,f^=r&l>>8^o&s>>8,g^=o&l>>8^(r^o)&s>>8,r=f^f>>1,o=g^g>>1;let m=e^t,v=o|65535^(m|r);return m=(m|m<<8)&16711935,m=(m|m<<4)&252645135,m=(m|m<<2)&858993459,m=(m|m<<1)&1431655765,v=(v|v<<8)&16711935,v=(v|v<<4)&252645135,v=(v|v<<2)&858993459,v=(v|v<<1)&1431655765,(v<<1|m)>>>0}function uo(e,t){if(e.length===0)return{all:()=>[],byRect:()=>[],byRadius:()=>[],byProperty:()=>[],resetPropertyCache:()=>{},count:()=>0};const r=new Bf(e.length),o=new Map;for(const s of e)r.add(s.position.x,s.position.y,s.position.x,s.position.y);return r.finish(),{all(){return e},byRect(s){return r.search(s.left,s.top,s.right,s.bottom).map(d=>e[d])},byRadius(s,u){return r.neighbors(s.x,s.y,void 0,u).map(f=>e[f])},byProperty(s,u){var d;if(!o.has(s)){const f=new Map;for(const g of e){const m=g[s];f.has(m)||f.set(m,[]),f.get(m).push(g)}o.set(s,f)}return((d=o.get(s))==null?void 0:d.get(u))||[]},resetPropertyCache(){o.clear()},count(){return e.length}}}function gu(e){const t=Object.values(e.entities.entities),r=t.filter(g=>g.type==="human"),o=t.filter(g=>g.type==="berryBush"),l=t.filter(g=>g.type==="corpse"),s=t.filter(g=>g.type==="prey"),u=t.filter(g=>g.type==="predator"),d=t.filter(g=>g.type==="building");return{...e,search:{human:uo(r),berryBush:uo(o),corpse:uo(l),prey:uo(s),predator:uo(u),building:uo(d)}}}const qT="tribe-game-db",Ji="save-files",Lf="tribe-game-save",af=1;async function Hf(e){try{const t={version:af,savedAt:Date.now(),gameState:e},r=JSON.stringify(t),o=await JT(r);await tA(Lf,o),console.log(`Game saved successfully. Size: ${(o.size/1024).toFixed(2)} KB`)}catch(t){throw console.error("Failed to save game:",t),t}}async function QT(){try{const e=await nA(Lf);if(!e)return null;const t=await eA(e),r=JSON.parse(t);return r.version!==af?(console.warn(`Save game version mismatch. Expected ${af}, found ${r.version}. Discarding save.`),await lf(),null):(console.log("Game loaded successfully."),gu(r.gameState))}catch(e){return console.error("Failed to load game:",e),await lf(),null}}async function lf(){try{await iA(Lf),console.log("Saved game cleared.")}catch(e){console.error("Failed to clear saved game:",e)}}async function JT(e){const r=new Blob([e]).stream().pipeThrough(new CompressionStream("gzip"));return await new Response(r).blob()}async function eA(e){const t=e.stream().pipeThrough(new DecompressionStream("gzip"));return await new Response(t).text()}function bf(){return new Promise((e,t)=>{const r=indexedDB.open(qT,1);r.onupgradeneeded=o=>{const l=o.target.result;l.objectStoreNames.contains(Ji)||l.createObjectStore(Ji)},r.onsuccess=()=>e(r.result),r.onerror=()=>t(r.error)})}async function tA(e,t){const r=await bf();return new Promise((o,l)=>{const d=r.transaction(Ji,"readwrite").objectStore(Ji).put(t,e);d.onsuccess=()=>o(),d.onerror=()=>l(d.error)})}async function nA(e){const t=await bf();return new Promise((r,o)=>{const u=t.transaction(Ji,"readonly").objectStore(Ji).get(e);u.onsuccess=()=>r(u.result),u.onerror=()=>o(u.error)})}async function iA(e){const t=await bf();return new Promise((r,o)=>{const u=t.transaction(Ji,"readwrite").objectStore(Ji).delete(e);u.onsuccess=()=>r(),u.onerror=()=>o(u.error)})}const Y0=Re.createContext(void 0),rA=({initialAppState:e,children:t})=>{const[r,o]=Re.useState(e),[l,s]=Re.useState(void 0),[u,d]=Re.useState(null),[f,g]=Re.useState(!1);Re.useEffect(()=>{QT().then(I=>{I&&d(I),g(!0)})},[]);const m=(I,E)=>{o(I),I==="gameOver"&&E?s(E):I!=="gameOver"&&s(void 0)},v=()=>{o("intro"),s(void 0),w()},y=I=>{Hf(I),d(I)},w=()=>{lf(),d(null)};return Fe.jsx(Y0.Provider,{value:{appState:r,setAppState:m,returnToIntro:v,gameOverDetails:l,contextReady:f,savedGameState:u,setSavedGameState:d,saveCurrentGame:y,clearCurrentSave:w},children:t})},Bo=()=>{const e=Re.useContext(Y0);if(e===void 0)throw new Error("useGameContext must be used within a GameProvider");return e};var Bt=function(){return Bt=Object.assign||function(t){for(var r,o=1,l=arguments.length;o<l;o++){r=arguments[o];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(t[s]=r[s])}return t},Bt.apply(this,arguments)};function Zs(e,t,r){if(r||arguments.length===2)for(var o=0,l=t.length,s;o<l;o++)(s||!(o in t))&&(s||(s=Array.prototype.slice.call(t,0,o)),s[o]=t[o]);return e.concat(s||Array.prototype.slice.call(t))}var Ke="-ms-",xs="-moz-",$e="-webkit-",j0="comm",pu="rule",Gf="decl",oA="@import",V0="@keyframes",sA="@layer",X0=Math.abs,xf=String.fromCharCode,uf=Object.assign;function aA(e,t){return Tt(e,0)^45?(((t<<2^Tt(e,0))<<2^Tt(e,1))<<2^Tt(e,2))<<2^Tt(e,3):0}function K0(e){return e.trim()}function ci(e,t){return(e=t.exec(e))?e[0]:e}function Me(e,t,r){return e.replace(t,r)}function Vl(e,t,r){return e.indexOf(t,r)}function Tt(e,t){return e.charCodeAt(t)|0}function Co(e,t,r){return e.slice(t,r)}function Zn(e){return e.length}function Z0(e){return e.length}function Bs(e,t){return t.push(e),e}function lA(e,t){return e.map(t).join("")}function Am(e,t){return e.filter(function(r){return!ci(r,t)})}var mu=1,Ro=1,q0=0,Tn=0,ft=0,Lo="";function vu(e,t,r,o,l,s,u,d){return{value:e,root:t,parent:r,type:o,props:l,children:s,line:mu,column:Ro,length:u,return:"",siblings:d}}function $i(e,t){return uf(vu("",null,null,"",null,null,0,e.siblings),e,{length:-e.length},t)}function co(e){for(;e.root;)e=$i(e.root,{children:[e]});Bs(e,e.siblings)}function uA(){return ft}function cA(){return ft=Tn>0?Tt(Lo,--Tn):0,Ro--,ft===10&&(Ro=1,mu--),ft}function On(){return ft=Tn<q0?Tt(Lo,Tn++):0,Ro++,ft===10&&(Ro=1,mu++),ft}function _r(){return Tt(Lo,Tn)}function Xl(){return Tn}function Su(e,t){return Co(Lo,e,t)}function cf(e){switch(e){case 0:case 9:case 10:case 13:case 32:return 5;case 33:case 43:case 44:case 47:case 62:case 64:case 126:case 59:case 123:case 125:return 4;case 58:return 3;case 34:case 39:case 40:case 91:return 2;case 41:case 93:return 1}return 0}function dA(e){return mu=Ro=1,q0=Zn(Lo=e),Tn=0,[]}function fA(e){return Lo="",e}function wd(e){return K0(Su(Tn-1,df(e===91?e+2:e===40?e+1:e)))}function hA(e){for(;(ft=_r())&&ft<33;)On();return cf(e)>2||cf(ft)>3?"":" "}function gA(e,t){for(;--t&&On()&&!(ft<48||ft>102||ft>57&&ft<65||ft>70&&ft<97););return Su(e,Xl()+(t<6&&_r()==32&&On()==32))}function df(e){for(;On();)switch(ft){case e:return Tn;case 34:case 39:e!==34&&e!==39&&df(ft);break;case 40:e===41&&df(e);break;case 92:On();break}return Tn}function pA(e,t){for(;On()&&e+ft!==57;)if(e+ft===84&&_r()===47)break;return"/*"+Su(t,Tn-1)+"*"+xf(e===47?e:On())}function mA(e){for(;!cf(_r());)On();return Su(e,Tn)}function vA(e){return fA(Kl("",null,null,null,[""],e=dA(e),0,[0],e))}function Kl(e,t,r,o,l,s,u,d,f){for(var g=0,m=0,v=u,y=0,w=0,I=0,E=1,C=1,F=1,L=0,D="",H=l,x=s,U=o,$=D;C;)switch(I=L,L=On()){case 40:if(I!=108&&Tt($,v-1)==58){Vl($+=Me(wd(L),"&","&\f"),"&\f",X0(g?d[g-1]:0))!=-1&&(F=-1);break}case 34:case 39:case 91:$+=wd(L);break;case 9:case 10:case 13:case 32:$+=hA(I);break;case 92:$+=gA(Xl()-1,7);continue;case 47:switch(_r()){case 42:case 47:Bs(SA(pA(On(),Xl()),t,r,f),f);break;default:$+="/"}break;case 123*E:d[g++]=Zn($)*F;case 125*E:case 59:case 0:switch(L){case 0:case 125:C=0;case 59+m:F==-1&&($=Me($,/\f/g,"")),w>0&&Zn($)-v&&Bs(w>32?Em($+";",o,r,v-1,f):Em(Me($," ","")+";",o,r,v-2,f),f);break;case 59:$+=";";default:if(Bs(U=Im($,t,r,g,m,l,d,D,H=[],x=[],v,s),s),L===123)if(m===0)Kl($,t,U,U,H,s,v,d,x);else switch(y===99&&Tt($,3)===110?100:y){case 100:case 108:case 109:case 115:Kl(e,U,U,o&&Bs(Im(e,U,U,0,0,l,d,D,l,H=[],v,x),x),l,x,v,d,o?H:x);break;default:Kl($,U,U,U,[""],x,0,d,x)}}g=m=w=0,E=F=1,D=$="",v=u;break;case 58:v=1+Zn($),w=I;default:if(E<1){if(L==123)--E;else if(L==125&&E++==0&&cA()==125)continue}switch($+=xf(L),L*E){case 38:F=m>0?1:($+="\f",-1);break;case 44:d[g++]=(Zn($)-1)*F,F=1;break;case 64:_r()===45&&($+=wd(On())),y=_r(),m=v=Zn(D=$+=mA(Xl())),L++;break;case 45:I===45&&Zn($)==2&&(E=0)}}return s}function Im(e,t,r,o,l,s,u,d,f,g,m,v){for(var y=l-1,w=l===0?s:[""],I=Z0(w),E=0,C=0,F=0;E<o;++E)for(var L=0,D=Co(e,y+1,y=X0(C=u[E])),H=e;L<I;++L)(H=K0(C>0?w[L]+" "+D:Me(D,/&\f/g,w[L])))&&(f[F++]=H);return vu(e,t,r,l===0?pu:d,f,g,m,v)}function SA(e,t,r,o){return vu(e,t,r,j0,xf(uA()),Co(e,2,-2),0,o)}function Em(e,t,r,o,l){return vu(e,t,r,Gf,Co(e,0,o),Co(e,o+1,-1),o,l)}function Q0(e,t,r){switch(aA(e,t)){case 5103:return $e+"print-"+e+e;case 5737:case 4201:case 3177:case 3433:case 1641:case 4457:case 2921:case 5572:case 6356:case 5844:case 3191:case 6645:case 3005:case 6391:case 5879:case 5623:case 6135:case 4599:case 4855:case 4215:case 6389:case 5109:case 5365:case 5621:case 3829:return $e+e+e;case 4789:return xs+e+e;case 5349:case 4246:case 4810:case 6968:case 2756:return $e+e+xs+e+Ke+e+e;case 5936:switch(Tt(e,t+11)){case 114:return $e+e+Ke+Me(e,/[svh]\w+-[tblr]{2}/,"tb")+e;case 108:return $e+e+Ke+Me(e,/[svh]\w+-[tblr]{2}/,"tb-rl")+e;case 45:return $e+e+Ke+Me(e,/[svh]\w+-[tblr]{2}/,"lr")+e}case 6828:case 4268:case 2903:return $e+e+Ke+e+e;case 6165:return $e+e+Ke+"flex-"+e+e;case 5187:return $e+e+Me(e,/(\w+).+(:[^]+)/,$e+"box-$1$2"+Ke+"flex-$1$2")+e;case 5443:return $e+e+Ke+"flex-item-"+Me(e,/flex-|-self/g,"")+(ci(e,/flex-|baseline/)?"":Ke+"grid-row-"+Me(e,/flex-|-self/g,""))+e;case 4675:return $e+e+Ke+"flex-line-pack"+Me(e,/align-content|flex-|-self/g,"")+e;case 5548:return $e+e+Ke+Me(e,"shrink","negative")+e;case 5292:return $e+e+Ke+Me(e,"basis","preferred-size")+e;case 6060:return $e+"box-"+Me(e,"-grow","")+$e+e+Ke+Me(e,"grow","positive")+e;case 4554:return $e+Me(e,/([^-])(transform)/g,"$1"+$e+"$2")+e;case 6187:return Me(Me(Me(e,/(zoom-|grab)/,$e+"$1"),/(image-set)/,$e+"$1"),e,"")+e;case 5495:case 3959:return Me(e,/(image-set\([^]*)/,$e+"$1$`$1");case 4968:return Me(Me(e,/(.+:)(flex-)?(.*)/,$e+"box-pack:$3"+Ke+"flex-pack:$3"),/s.+-b[^;]+/,"justify")+$e+e+e;case 4200:if(!ci(e,/flex-|baseline/))return Ke+"grid-column-align"+Co(e,t)+e;break;case 2592:case 3360:return Ke+Me(e,"template-","")+e;case 4384:case 3616:return r&&r.some(function(o,l){return t=l,ci(o.props,/grid-\w+-end/)})?~Vl(e+(r=r[t].value),"span",0)?e:Ke+Me(e,"-start","")+e+Ke+"grid-row-span:"+(~Vl(r,"span",0)?ci(r,/\d+/):+ci(r,/\d+/)-+ci(e,/\d+/))+";":Ke+Me(e,"-start","")+e;case 4896:case 4128:return r&&r.some(function(o){return ci(o.props,/grid-\w+-start/)})?e:Ke+Me(Me(e,"-end","-span"),"span ","")+e;case 4095:case 3583:case 4068:case 2532:return Me(e,/(.+)-inline(.+)/,$e+"$1$2")+e;case 8116:case 7059:case 5753:case 5535:case 5445:case 5701:case 4933:case 4677:case 5533:case 5789:case 5021:case 4765:if(Zn(e)-1-t>6)switch(Tt(e,t+1)){case 109:if(Tt(e,t+4)!==45)break;case 102:return Me(e,/(.+:)(.+)-([^]+)/,"$1"+$e+"$2-$3$1"+xs+(Tt(e,t+3)==108?"$3":"$2-$3"))+e;case 115:return~Vl(e,"stretch",0)?Q0(Me(e,"stretch","fill-available"),t,r)+e:e}break;case 5152:case 5920:return Me(e,/(.+?):(\d+)(\s*\/\s*(span)?\s*(\d+))?(.*)/,function(o,l,s,u,d,f,g){return Ke+l+":"+s+g+(u?Ke+l+"-span:"+(d?f:+f-+s)+g:"")+e});case 4949:if(Tt(e,t+6)===121)return Me(e,":",":"+$e)+e;break;case 6444:switch(Tt(e,Tt(e,14)===45?18:11)){case 120:return Me(e,/(.+:)([^;\s!]+)(;|(\s+)?!.+)?/,"$1"+$e+(Tt(e,14)===45?"inline-":"")+"box$3$1"+$e+"$2$3$1"+Ke+"$2box$3")+e;case 100:return Me(e,":",":"+Ke)+e}break;case 5719:case 2647:case 2135:case 3927:case 2391:return Me(e,"scroll-","scroll-snap-")+e}return e}function tu(e,t){for(var r="",o=0;o<e.length;o++)r+=t(e[o],o,e,t)||"";return r}function yA(e,t,r,o){switch(e.type){case sA:if(e.children.length)break;case oA:case Gf:return e.return=e.return||e.value;case j0:return"";case V0:return e.return=e.value+"{"+tu(e.children,o)+"}";case pu:if(!Zn(e.value=e.props.join(",")))return""}return Zn(r=tu(e.children,o))?e.return=e.value+"{"+r+"}":""}function TA(e){var t=Z0(e);return function(r,o,l,s){for(var u="",d=0;d<t;d++)u+=e[d](r,o,l,s)||"";return u}}function AA(e){return function(t){t.root||(t=t.return)&&e(t)}}function IA(e,t,r,o){if(e.length>-1&&!e.return)switch(e.type){case Gf:e.return=Q0(e.value,e.length,r);return;case V0:return tu([$i(e,{value:Me(e.value,"@","@"+$e)})],o);case pu:if(e.length)return lA(r=e.props,function(l){switch(ci(l,o=/(::plac\w+|:read-\w+)/)){case":read-only":case":read-write":co($i(e,{props:[Me(l,/:(read-\w+)/,":"+xs+"$1")]})),co($i(e,{props:[l]})),uf(e,{props:Am(r,o)});break;case"::placeholder":co($i(e,{props:[Me(l,/:(plac\w+)/,":"+$e+"input-$1")]})),co($i(e,{props:[Me(l,/:(plac\w+)/,":"+xs+"$1")]})),co($i(e,{props:[Me(l,/:(plac\w+)/,Ke+"input-$1")]})),co($i(e,{props:[l]})),uf(e,{props:Am(r,o)});break}return""})}}var EA={animationIterationCount:1,aspectRatio:1,borderImageOutset:1,borderImageSlice:1,borderImageWidth:1,boxFlex:1,boxFlexGroup:1,boxOrdinalGroup:1,columnCount:1,columns:1,flex:1,flexGrow:1,flexPositive:1,flexShrink:1,flexNegative:1,flexOrder:1,gridRow:1,gridRowEnd:1,gridRowSpan:1,gridRowStart:1,gridColumn:1,gridColumnEnd:1,gridColumnSpan:1,gridColumnStart:1,msGridRow:1,msGridRowSpan:1,msGridColumn:1,msGridColumnSpan:1,fontWeight:1,lineHeight:1,opacity:1,order:1,orphans:1,tabSize:1,widows:1,zIndex:1,zoom:1,WebkitLineClamp:1,fillOpacity:1,floodOpacity:1,stopOpacity:1,strokeDasharray:1,strokeDashoffset:1,strokeMiterlimit:1,strokeOpacity:1,strokeWidth:1},an={},Po=typeof process<"u"&&an!==void 0&&(an.REACT_APP_SC_ATTR||an.SC_ATTR)||"data-styled",J0="active",ev="data-styled-version",yu="6.1.13",$f=`/*!sc*/
`,nu=typeof window<"u"&&"HTMLElement"in window,wA=!!(typeof SC_DISABLE_SPEEDY=="boolean"?SC_DISABLE_SPEEDY:typeof process<"u"&&an!==void 0&&an.REACT_APP_SC_DISABLE_SPEEDY!==void 0&&an.REACT_APP_SC_DISABLE_SPEEDY!==""?an.REACT_APP_SC_DISABLE_SPEEDY!=="false"&&an.REACT_APP_SC_DISABLE_SPEEDY:typeof process<"u"&&an!==void 0&&an.SC_DISABLE_SPEEDY!==void 0&&an.SC_DISABLE_SPEEDY!==""&&an.SC_DISABLE_SPEEDY!=="false"&&an.SC_DISABLE_SPEEDY),_A={},Tu=Object.freeze([]),No=Object.freeze({});function tv(e,t,r){return r===void 0&&(r=No),e.theme!==r.theme&&e.theme||t||r.theme}var nv=new Set(["a","abbr","address","area","article","aside","audio","b","base","bdi","bdo","big","blockquote","body","br","button","canvas","caption","cite","code","col","colgroup","data","datalist","dd","del","details","dfn","dialog","div","dl","dt","em","embed","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","header","hgroup","hr","html","i","iframe","img","input","ins","kbd","keygen","label","legend","li","link","main","map","mark","menu","menuitem","meta","meter","nav","noscript","object","ol","optgroup","option","output","p","param","picture","pre","progress","q","rp","rt","ruby","s","samp","script","section","select","small","source","span","strong","style","sub","summary","sup","table","tbody","td","textarea","tfoot","th","thead","time","tr","track","u","ul","use","var","video","wbr","circle","clipPath","defs","ellipse","foreignObject","g","image","line","linearGradient","marker","mask","path","pattern","polygon","polyline","radialGradient","rect","stop","svg","text","tspan"]),CA=/[!"#$%&'()*+,./:;<=>?@[\\\]^`{|}~-]+/g,RA=/(^-|-$)/g;function wm(e){return e.replace(CA,"-").replace(RA,"")}var PA=/(a)(d)/gi,_l=52,_m=function(e){return String.fromCharCode(e+(e>25?39:97))};function ff(e){var t,r="";for(t=Math.abs(e);t>_l;t=t/_l|0)r=_m(t%_l)+r;return(_m(t%_l)+r).replace(PA,"$1-$2")}var _d,iv=5381,yo=function(e,t){for(var r=t.length;r;)e=33*e^t.charCodeAt(--r);return e},rv=function(e){return yo(iv,e)};function ov(e){return ff(rv(e)>>>0)}function NA(e){return e.displayName||e.name||"Component"}function Cd(e){return typeof e=="string"&&!0}var sv=typeof Symbol=="function"&&Symbol.for,av=sv?Symbol.for("react.memo"):60115,DA=sv?Symbol.for("react.forward_ref"):60112,kA={childContextTypes:!0,contextType:!0,contextTypes:!0,defaultProps:!0,displayName:!0,getDefaultProps:!0,getDerivedStateFromError:!0,getDerivedStateFromProps:!0,mixins:!0,propTypes:!0,type:!0},OA={name:!0,length:!0,prototype:!0,caller:!0,callee:!0,arguments:!0,arity:!0},lv={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},MA=((_d={})[DA]={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},_d[av]=lv,_d);function Cm(e){return("type"in(t=e)&&t.type.$$typeof)===av?lv:"$$typeof"in e?MA[e.$$typeof]:kA;var t}var FA=Object.defineProperty,UA=Object.getOwnPropertyNames,Rm=Object.getOwnPropertySymbols,BA=Object.getOwnPropertyDescriptor,LA=Object.getPrototypeOf,Pm=Object.prototype;function uv(e,t,r){if(typeof t!="string"){if(Pm){var o=LA(t);o&&o!==Pm&&uv(e,o,r)}var l=UA(t);Rm&&(l=l.concat(Rm(t)));for(var s=Cm(e),u=Cm(t),d=0;d<l.length;++d){var f=l[d];if(!(f in OA||r&&r[f]||u&&f in u||s&&f in s)){var g=BA(t,f);try{FA(e,f,g)}catch{}}}}return e}function Do(e){return typeof e=="function"}function zf(e){return typeof e=="object"&&"styledComponentId"in e}function Er(e,t){return e&&t?"".concat(e," ").concat(t):e||t||""}function hf(e,t){if(e.length===0)return"";for(var r=e[0],o=1;o<e.length;o++)r+=e[o];return r}function qs(e){return e!==null&&typeof e=="object"&&e.constructor.name===Object.name&&!("props"in e&&e.$$typeof)}function gf(e,t,r){if(r===void 0&&(r=!1),!r&&!qs(e)&&!Array.isArray(e))return t;if(Array.isArray(t))for(var o=0;o<t.length;o++)e[o]=gf(e[o],t[o]);else if(qs(t))for(var o in t)e[o]=gf(e[o],t[o]);return e}function Wf(e,t){Object.defineProperty(e,"toString",{value:t})}function da(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];return new Error("An error occurred. See https://github.com/styled-components/styled-components/blob/main/packages/styled-components/src/utils/errors.md#".concat(e," for more information.").concat(t.length>0?" Args: ".concat(t.join(", ")):""))}var HA=function(){function e(t){this.groupSizes=new Uint32Array(512),this.length=512,this.tag=t}return e.prototype.indexOfGroup=function(t){for(var r=0,o=0;o<t;o++)r+=this.groupSizes[o];return r},e.prototype.insertRules=function(t,r){if(t>=this.groupSizes.length){for(var o=this.groupSizes,l=o.length,s=l;t>=s;)if((s<<=1)<0)throw da(16,"".concat(t));this.groupSizes=new Uint32Array(s),this.groupSizes.set(o),this.length=s;for(var u=l;u<s;u++)this.groupSizes[u]=0}for(var d=this.indexOfGroup(t+1),f=(u=0,r.length);u<f;u++)this.tag.insertRule(d,r[u])&&(this.groupSizes[t]++,d++)},e.prototype.clearGroup=function(t){if(t<this.length){var r=this.groupSizes[t],o=this.indexOfGroup(t),l=o+r;this.groupSizes[t]=0;for(var s=o;s<l;s++)this.tag.deleteRule(o)}},e.prototype.getGroup=function(t){var r="";if(t>=this.length||this.groupSizes[t]===0)return r;for(var o=this.groupSizes[t],l=this.indexOfGroup(t),s=l+o,u=l;u<s;u++)r+="".concat(this.tag.getRule(u)).concat($f);return r},e}(),Zl=new Map,iu=new Map,ql=1,Cl=function(e){if(Zl.has(e))return Zl.get(e);for(;iu.has(ql);)ql++;var t=ql++;return Zl.set(e,t),iu.set(t,e),t},bA=function(e,t){ql=t+1,Zl.set(e,t),iu.set(t,e)},GA="style[".concat(Po,"][").concat(ev,'="').concat(yu,'"]'),xA=new RegExp("^".concat(Po,'\\.g(\\d+)\\[id="([\\w\\d-]+)"\\].*?"([^"]*)')),$A=function(e,t,r){for(var o,l=r.split(","),s=0,u=l.length;s<u;s++)(o=l[s])&&e.registerName(t,o)},zA=function(e,t){for(var r,o=((r=t.textContent)!==null&&r!==void 0?r:"").split($f),l=[],s=0,u=o.length;s<u;s++){var d=o[s].trim();if(d){var f=d.match(xA);if(f){var g=0|parseInt(f[1],10),m=f[2];g!==0&&(bA(m,g),$A(e,m,f[3]),e.getTag().insertRules(g,l)),l.length=0}else l.push(d)}}},Nm=function(e){for(var t=document.querySelectorAll(GA),r=0,o=t.length;r<o;r++){var l=t[r];l&&l.getAttribute(Po)!==J0&&(zA(e,l),l.parentNode&&l.parentNode.removeChild(l))}};function WA(){return typeof __webpack_nonce__<"u"?__webpack_nonce__:null}var cv=function(e){var t=document.head,r=e||t,o=document.createElement("style"),l=function(d){var f=Array.from(d.querySelectorAll("style[".concat(Po,"]")));return f[f.length-1]}(r),s=l!==void 0?l.nextSibling:null;o.setAttribute(Po,J0),o.setAttribute(ev,yu);var u=WA();return u&&o.setAttribute("nonce",u),r.insertBefore(o,s),o},YA=function(){function e(t){this.element=cv(t),this.element.appendChild(document.createTextNode("")),this.sheet=function(r){if(r.sheet)return r.sheet;for(var o=document.styleSheets,l=0,s=o.length;l<s;l++){var u=o[l];if(u.ownerNode===r)return u}throw da(17)}(this.element),this.length=0}return e.prototype.insertRule=function(t,r){try{return this.sheet.insertRule(r,t),this.length++,!0}catch{return!1}},e.prototype.deleteRule=function(t){this.sheet.deleteRule(t),this.length--},e.prototype.getRule=function(t){var r=this.sheet.cssRules[t];return r&&r.cssText?r.cssText:""},e}(),jA=function(){function e(t){this.element=cv(t),this.nodes=this.element.childNodes,this.length=0}return e.prototype.insertRule=function(t,r){if(t<=this.length&&t>=0){var o=document.createTextNode(r);return this.element.insertBefore(o,this.nodes[t]||null),this.length++,!0}return!1},e.prototype.deleteRule=function(t){this.element.removeChild(this.nodes[t]),this.length--},e.prototype.getRule=function(t){return t<this.length?this.nodes[t].textContent:""},e}(),VA=function(){function e(t){this.rules=[],this.length=0}return e.prototype.insertRule=function(t,r){return t<=this.length&&(this.rules.splice(t,0,r),this.length++,!0)},e.prototype.deleteRule=function(t){this.rules.splice(t,1),this.length--},e.prototype.getRule=function(t){return t<this.length?this.rules[t]:""},e}(),Dm=nu,XA={isServer:!nu,useCSSOMInjection:!wA},ru=function(){function e(t,r,o){t===void 0&&(t=No),r===void 0&&(r={});var l=this;this.options=Bt(Bt({},XA),t),this.gs=r,this.names=new Map(o),this.server=!!t.isServer,!this.server&&nu&&Dm&&(Dm=!1,Nm(this)),Wf(this,function(){return function(s){for(var u=s.getTag(),d=u.length,f="",g=function(v){var y=function(F){return iu.get(F)}(v);if(y===void 0)return"continue";var w=s.names.get(y),I=u.getGroup(v);if(w===void 0||!w.size||I.length===0)return"continue";var E="".concat(Po,".g").concat(v,'[id="').concat(y,'"]'),C="";w!==void 0&&w.forEach(function(F){F.length>0&&(C+="".concat(F,","))}),f+="".concat(I).concat(E,'{content:"').concat(C,'"}').concat($f)},m=0;m<d;m++)g(m);return f}(l)})}return e.registerId=function(t){return Cl(t)},e.prototype.rehydrate=function(){!this.server&&nu&&Nm(this)},e.prototype.reconstructWithOptions=function(t,r){return r===void 0&&(r=!0),new e(Bt(Bt({},this.options),t),this.gs,r&&this.names||void 0)},e.prototype.allocateGSInstance=function(t){return this.gs[t]=(this.gs[t]||0)+1},e.prototype.getTag=function(){return this.tag||(this.tag=(t=function(r){var o=r.useCSSOMInjection,l=r.target;return r.isServer?new VA(l):o?new YA(l):new jA(l)}(this.options),new HA(t)));var t},e.prototype.hasNameForId=function(t,r){return this.names.has(t)&&this.names.get(t).has(r)},e.prototype.registerName=function(t,r){if(Cl(t),this.names.has(t))this.names.get(t).add(r);else{var o=new Set;o.add(r),this.names.set(t,o)}},e.prototype.insertRules=function(t,r,o){this.registerName(t,r),this.getTag().insertRules(Cl(t),o)},e.prototype.clearNames=function(t){this.names.has(t)&&this.names.get(t).clear()},e.prototype.clearRules=function(t){this.getTag().clearGroup(Cl(t)),this.clearNames(t)},e.prototype.clearTag=function(){this.tag=void 0},e}(),KA=/&/g,ZA=/^\s*\/\/.*$/gm;function dv(e,t){return e.map(function(r){return r.type==="rule"&&(r.value="".concat(t," ").concat(r.value),r.value=r.value.replaceAll(",",",".concat(t," ")),r.props=r.props.map(function(o){return"".concat(t," ").concat(o)})),Array.isArray(r.children)&&r.type!=="@keyframes"&&(r.children=dv(r.children,t)),r})}function qA(e){var t,r,o,l=No,s=l.options,u=s===void 0?No:s,d=l.plugins,f=d===void 0?Tu:d,g=function(y,w,I){return I.startsWith(r)&&I.endsWith(r)&&I.replaceAll(r,"").length>0?".".concat(t):y},m=f.slice();m.push(function(y){y.type===pu&&y.value.includes("&")&&(y.props[0]=y.props[0].replace(KA,r).replace(o,g))}),u.prefix&&m.push(IA),m.push(yA);var v=function(y,w,I,E){w===void 0&&(w=""),I===void 0&&(I=""),E===void 0&&(E="&"),t=E,r=w,o=new RegExp("\\".concat(r,"\\b"),"g");var C=y.replace(ZA,""),F=vA(I||w?"".concat(I," ").concat(w," { ").concat(C," }"):C);u.namespace&&(F=dv(F,u.namespace));var L=[];return tu(F,TA(m.concat(AA(function(D){return L.push(D)})))),L};return v.hash=f.length?f.reduce(function(y,w){return w.name||da(15),yo(y,w.name)},iv).toString():"",v}var QA=new ru,pf=qA(),fv=qn.createContext({shouldForwardProp:void 0,styleSheet:QA,stylis:pf});fv.Consumer;qn.createContext(void 0);function mf(){return Re.useContext(fv)}var JA=function(){function e(t,r){var o=this;this.inject=function(l,s){s===void 0&&(s=pf);var u=o.name+s.hash;l.hasNameForId(o.id,u)||l.insertRules(o.id,u,s(o.rules,u,"@keyframes"))},this.name=t,this.id="sc-keyframes-".concat(t),this.rules=r,Wf(this,function(){throw da(12,String(o.name))})}return e.prototype.getName=function(t){return t===void 0&&(t=pf),this.name+t.hash},e}(),eI=function(e){return e>="A"&&e<="Z"};function km(e){for(var t="",r=0;r<e.length;r++){var o=e[r];if(r===1&&o==="-"&&e[0]==="-")return e;eI(o)?t+="-"+o.toLowerCase():t+=o}return t.startsWith("ms-")?"-"+t:t}var hv=function(e){return e==null||e===!1||e===""},gv=function(e){var t,r,o=[];for(var l in e){var s=e[l];e.hasOwnProperty(l)&&!hv(s)&&(Array.isArray(s)&&s.isCss||Do(s)?o.push("".concat(km(l),":"),s,";"):qs(s)?o.push.apply(o,Zs(Zs(["".concat(l," {")],gv(s),!1),["}"],!1)):o.push("".concat(km(l),": ").concat((t=l,(r=s)==null||typeof r=="boolean"||r===""?"":typeof r!="number"||r===0||t in EA||t.startsWith("--")?String(r).trim():"".concat(r,"px")),";")))}return o};function qi(e,t,r,o){if(hv(e))return[];if(zf(e))return[".".concat(e.styledComponentId)];if(Do(e)){if(!Do(s=e)||s.prototype&&s.prototype.isReactComponent||!t)return[e];var l=e(t);return qi(l,t,r,o)}var s;return e instanceof JA?r?(e.inject(r,o),[e.getName(o)]):[e]:qs(e)?gv(e):Array.isArray(e)?Array.prototype.concat.apply(Tu,e.map(function(u){return qi(u,t,r,o)})):[e.toString()]}function pv(e){for(var t=0;t<e.length;t+=1){var r=e[t];if(Do(r)&&!zf(r))return!1}return!0}var tI=rv(yu),nI=function(){function e(t,r,o){this.rules=t,this.staticRulesId="",this.isStatic=(o===void 0||o.isStatic)&&pv(t),this.componentId=r,this.baseHash=yo(tI,r),this.baseStyle=o,ru.registerId(r)}return e.prototype.generateAndInjectStyles=function(t,r,o){var l=this.baseStyle?this.baseStyle.generateAndInjectStyles(t,r,o):"";if(this.isStatic&&!o.hash)if(this.staticRulesId&&r.hasNameForId(this.componentId,this.staticRulesId))l=Er(l,this.staticRulesId);else{var s=hf(qi(this.rules,t,r,o)),u=ff(yo(this.baseHash,s)>>>0);if(!r.hasNameForId(this.componentId,u)){var d=o(s,".".concat(u),void 0,this.componentId);r.insertRules(this.componentId,u,d)}l=Er(l,u),this.staticRulesId=u}else{for(var f=yo(this.baseHash,o.hash),g="",m=0;m<this.rules.length;m++){var v=this.rules[m];if(typeof v=="string")g+=v;else if(v){var y=hf(qi(v,t,r,o));f=yo(f,y+m),g+=y}}if(g){var w=ff(f>>>0);r.hasNameForId(this.componentId,w)||r.insertRules(this.componentId,w,o(g,".".concat(w),void 0,this.componentId)),l=Er(l,w)}}return l},e}(),Yf=qn.createContext(void 0);Yf.Consumer;var Rd={};function iI(e,t,r){var o=zf(e),l=e,s=!Cd(e),u=t.attrs,d=u===void 0?Tu:u,f=t.componentId,g=f===void 0?function(H,x){var U=typeof H!="string"?"sc":wm(H);Rd[U]=(Rd[U]||0)+1;var $="".concat(U,"-").concat(ov(yu+U+Rd[U]));return x?"".concat(x,"-").concat($):$}(t.displayName,t.parentComponentId):f,m=t.displayName,v=m===void 0?function(H){return Cd(H)?"styled.".concat(H):"Styled(".concat(NA(H),")")}(e):m,y=t.displayName&&t.componentId?"".concat(wm(t.displayName),"-").concat(t.componentId):t.componentId||g,w=o&&l.attrs?l.attrs.concat(d).filter(Boolean):d,I=t.shouldForwardProp;if(o&&l.shouldForwardProp){var E=l.shouldForwardProp;if(t.shouldForwardProp){var C=t.shouldForwardProp;I=function(H,x){return E(H,x)&&C(H,x)}}else I=E}var F=new nI(r,y,o?l.componentStyle:void 0);function L(H,x){return function(U,$,ee){var _e=U.attrs,Ce=U.componentStyle,Ge=U.defaultProps,Ne=U.foldedComponentIds,Pe=U.styledComponentId,de=U.target,Ue=qn.useContext(Yf),Te=mf(),ne=U.shouldForwardProp||Te.shouldForwardProp,W=tv($,Ue,Ge)||No,X=function(Se,ae,Ee){for(var Ae,Z=Bt(Bt({},ae),{className:void 0,theme:Ee}),re=0;re<Se.length;re+=1){var Be=Do(Ae=Se[re])?Ae(Z):Ae;for(var he in Be)Z[he]=he==="className"?Er(Z[he],Be[he]):he==="style"?Bt(Bt({},Z[he]),Be[he]):Be[he]}return ae.className&&(Z.className=Er(Z.className,ae.className)),Z}(_e,$,W),Y=X.as||de,P={};for(var B in X)X[B]===void 0||B[0]==="$"||B==="as"||B==="theme"&&X.theme===W||(B==="forwardedAs"?P.as=X.forwardedAs:ne&&!ne(B,Y)||(P[B]=X[B]));var K=function(Se,ae){var Ee=mf(),Ae=Se.generateAndInjectStyles(ae,Ee.styleSheet,Ee.stylis);return Ae}(Ce,X),ie=Er(Ne,Pe);return K&&(ie+=" "+K),X.className&&(ie+=" "+X.className),P[Cd(Y)&&!nv.has(Y)?"class":"className"]=ie,P.ref=ee,Re.createElement(Y,P)}(D,H,x)}L.displayName=v;var D=qn.forwardRef(L);return D.attrs=w,D.componentStyle=F,D.displayName=v,D.shouldForwardProp=I,D.foldedComponentIds=o?Er(l.foldedComponentIds,l.styledComponentId):"",D.styledComponentId=y,D.target=o?l.target:e,Object.defineProperty(D,"defaultProps",{get:function(){return this._foldedDefaultProps},set:function(H){this._foldedDefaultProps=o?function(x){for(var U=[],$=1;$<arguments.length;$++)U[$-1]=arguments[$];for(var ee=0,_e=U;ee<_e.length;ee++)gf(x,_e[ee],!0);return x}({},l.defaultProps,H):H}}),Wf(D,function(){return".".concat(D.styledComponentId)}),s&&uv(D,e,{attrs:!0,componentStyle:!0,displayName:!0,foldedComponentIds:!0,shouldForwardProp:!0,styledComponentId:!0,target:!0}),D}function Om(e,t){for(var r=[e[0]],o=0,l=t.length;o<l;o+=1)r.push(t[o],e[o+1]);return r}var Mm=function(e){return Object.assign(e,{isCss:!0})};function mv(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];if(Do(e)||qs(e))return Mm(qi(Om(Tu,Zs([e],t,!0))));var o=e;return t.length===0&&o.length===1&&typeof o[0]=="string"?qi(o):Mm(qi(Om(o,t)))}function vf(e,t,r){if(r===void 0&&(r=No),!t)throw da(1,t);var o=function(l){for(var s=[],u=1;u<arguments.length;u++)s[u-1]=arguments[u];return e(t,r,mv.apply(void 0,Zs([l],s,!1)))};return o.attrs=function(l){return vf(e,t,Bt(Bt({},r),{attrs:Array.prototype.concat(r.attrs,l).filter(Boolean)}))},o.withConfig=function(l){return vf(e,t,Bt(Bt({},r),l))},o}var vv=function(e){return vf(iI,e)},In=vv;nv.forEach(function(e){In[e]=vv(e)});var rI=function(){function e(t,r){this.rules=t,this.componentId=r,this.isStatic=pv(t),ru.registerId(this.componentId+1)}return e.prototype.createStyles=function(t,r,o,l){var s=l(hf(qi(this.rules,r,o,l)),""),u=this.componentId+t;o.insertRules(u,u,s)},e.prototype.removeStyles=function(t,r){r.clearRules(this.componentId+t)},e.prototype.renderStyles=function(t,r,o,l){t>2&&ru.registerId(this.componentId+t),this.removeStyles(t,o),this.createStyles(t,r,o,l)},e}();function oI(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];var o=mv.apply(void 0,Zs([e],t,!1)),l="sc-global-".concat(ov(JSON.stringify(o))),s=new rI(o,l),u=function(f){var g=mf(),m=qn.useContext(Yf),v=qn.useRef(g.styleSheet.allocateGSInstance(l)).current;return g.styleSheet.server&&d(v,f,g.styleSheet,m,g.stylis),qn.useLayoutEffect(function(){if(!g.styleSheet.server)return d(v,f,g.styleSheet,m,g.stylis),function(){return s.removeStyles(v,g.styleSheet)}},[v,f,g.styleSheet,m,g.stylis]),null};function d(f,g,m,v,y){if(s.isStatic)s.renderStyles(f,_A,m,y);else{var w=Bt(Bt({},g),{theme:tv(g,v,u.defaultProps)});s.renderStyles(f,w,m,y)}}return qn.memo(u)}function Sv(e,t){var r=Re.useRef(null),o=Re.useRef(!1),l=Re.useRef(e);l.current=e;var s=Re.useCallback(function(d){o.current&&(l.current(d),r.current=requestAnimationFrame(s))},[]),u=Re.useMemo(function(){return[function(){o.current&&(o.current=!1,r.current&&cancelAnimationFrame(r.current))},function(){o.current||(o.current=!0,r.current=requestAnimationFrame(s))},function(){return o.current}]},[]);return Re.useEffect(function(){return u[0]},[]),u}function sI(e,t,r,o,l){var u;(u=e.onExit)==null||u.call(e,o,t);const s=l.find(({id:d})=>d===t);return s!=null&&s.onEnter?s.onEnter(o,r):{...r,enteredAt:o.updateContext.gameState.time}}function aI(e,t){return t.find(({id:r})=>r===e)}function lI(e,t){return e!==t}function uI(e){console.warn(`No handler found for state: ${e}`)}const $s="bushGrowing",Ir="bushFull",Ql="bushSpreading",Qs="bushDying",At=24,It=10,et=3e3,tt=3e3,jf=2,cI=15,dI=5e3,hi=100,gi=20,pi=60,fI=1e3,hI=5,gI=3,pI=12,mI=940,Sf=20,Fm=90,yv=45,Tv=240,Or=5,vI=.5,Um=100,er=30,mi=.1,Ls=.9,be=1,wr=3,SI=70;function ke(e,t,r,o,l){const s={id:e.nextVisualEffectId,type:t,position:r,startTime:e.time,duration:o,entityId:l};return e.visualEffects.push(s),e.nextVisualEffectId++,s.id}var ue=(e=>(e[e.Hunger=0]="Hunger",e[e.Procreation=1]="Procreation",e[e.Pregnant=2]="Pregnant",e[e.TargetAcquired=3]="TargetAcquired",e[e.Attack=4]="Attack",e[e.Partnered=5]="Partnered",e[e.BushClaimed=6]="BushClaimed",e[e.BushClaimLost=7]="BushClaimLost",e[e.Eating=8]="Eating",e[e.ChildFed=9]="ChildFed",e[e.AttackDeflected=10]="AttackDeflected",e[e.AttackResisted=11]="AttackResisted",e[e.Hit=12]="Hit",e[e.SeizeBuildup=13]="SeizeBuildup",e[e.Seize=14]="Seize",e[e.CallToAttack=15]="CallToAttack",e[e.CallToFollow=16]="CallToFollow",e[e.AutopilotMoveTarget=17]="AutopilotMoveTarget",e))(ue||{}),Fn=(e=>(e.Berry="berry",e.Meat="meat",e))(Fn||{});const Vf={berry:"",meat:""},yI={id:$s,update:(e,t)=>{const{entity:r,updateContext:o}=t,l=o.deltaTime*(At/It);return r.age+=l,r.age>=r.lifespan?{nextState:Qs,data:{...e,enteredAt:o.gameState.time}}:(r.ownerId&&r.claimedUntil&&o.gameState.time>r.claimedUntil&&(ke(o.gameState,ue.BushClaimLost,r.position,be),r.ownerId=void 0,r.claimedUntil=void 0),r.timeSinceLastBerryRegen+=l,r.timeSinceLastBerryRegen>=pI&&r.food.length<r.maxFood&&(r.food.push({type:Fn.Berry}),r.timeSinceLastBerryRegen=0),r.food.length>=r.maxFood?{nextState:Ir,data:{...e,enteredAt:o.gameState.time,previousState:$s}}:{nextState:$s,data:e})},onEnter:(e,t)=>({...t,enteredAt:e.updateContext.gameState.time})},TI={id:Ir,update:(e,t)=>{const{entity:r,updateContext:o}=t,l=o.deltaTime*(At/It);return r.age+=l,r.age>=r.lifespan?{nextState:Qs,data:{...e,enteredAt:o.gameState.time,previousState:Ir}}:r.food.length<r.maxFood?{nextState:$s,data:{...e,enteredAt:o.gameState.time,previousState:Ir}}:(r.ownerId&&r.claimedUntil&&o.gameState.time>r.claimedUntil&&(ke(o.gameState,ue.BushClaimLost,r.position,be),r.ownerId=void 0,r.claimedUntil=void 0),r.timeSinceLastSpreadAttempt+=l,r.timeSinceLastSpreadAttempt>=Fm&&(r.timeSinceLastSpreadAttempt=0,o.gameState.time-r.timeSinceLastHarvest>=Fm&&Math.random()<o.gameState.ecosystem.berryBushSpreadChance)?{nextState:Ql,data:{...e,enteredAt:o.gameState.time,previousState:Ir}}:{nextState:Ir,data:e})},onEnter:(e,t)=>({...t,enteredAt:e.updateContext.gameState.time})},Js=1,yf=150*.6,AI=150*.25,II=150*.7,EI=150*.8,wI=400,_I=800,Av=100,CI=250,RI=120,PI=2,Bm=400,NI=1e3,DI=150*.85,kI=100,OI=3,MI=96,FI=24,UI=600,Iv=600,BI=1,LI=24,HI=1,bI=.5,GI=2,Tf=24,Af=12,xI=24,Lm=24,$I=1500,Pd=500,zI=400,WI=10,YI=-5,jI=1.5,VI=1.5,XI=1.2,KI=10,ZI=150,qI=200,QI=100,JI=100,eE=.7,tE=300,nE=100,iE=120,Hm=400,Ev=.15,wv=200,Jl=30*.75*1.2,rE=20,oE=.3,sE=.6,aE=.8,lE=1,uE=3,cE=5,dE=6,bm=.5,fE=.4,hE=.6,gE=.8,Au=10,ea=80,pE=3,Ps=5,Mr=150,_v=Mr*.8,mE=Mr*.2,Fr=Mr*.95,tr=30,Cv=10,vE=10,SE=.5,Et=30,Ur=Et*.75,Rv=50,yE=20,TE=ea*.8,AE=.7,IE=16,Pv=40,EE=24,Xf=16,wE=72/3,Gm=24,_E=1.25,CE=1.5,Kf=Mr*.6,Zf=50,RE=1,PE=350,Nv=ea*.65,NE=80,DE=50,kE=1,OE=128,Dv=10,xm=100,qf=35,Qn=Et,kv=.5,Iu=2.5,ME=5,Qf=.5,Jf=1.5,FE=.1,UE=.5,BE=1.5,LE=.25,HE=2.5,bE=45,GE=.05;function Mn(e,t){return{x:e.x+t.x,y:e.y+t.y}}function Ov(e,t){return{x:e.x-t.x,y:e.y-t.y}}function Nt(e,t){return{x:e.x*t,y:e.y*t}}function ko(e){return Math.sqrt(e.x*e.x+e.y*e.y)}function nt(e){const t=ko(e);return t===0?{x:0,y:0}:Nt(e,1/t)}function xE(e,t){return ko(Ov(e,t))}function eh(e,t,r){return{x:e.x+(t.x-e.x)*r,y:e.y+(t.y-e.y)*r}}function ou(e){if(e.length===0)return{x:0,y:0};const t=e.reduce((r,o)=>({x:r.x+o.x,y:r.y+o.y}),{x:0,y:0});return{x:t.x/e.length,y:t.y/e.length}}function ze(e,t,r,o){let l=t.x-e.x,s=t.y-e.y;return Math.abs(l)>r/2&&(l=l-Math.sign(l)*r),Math.abs(s)>o/2&&(s=s-Math.sign(s)*o),{x:l,y:s}}function Ut(e,t,r){const o=ze(e,t,r.width,r.height);return nt(o)}function V(e,t,r,o){const l=ze(e,t,r,o);return ko(l)}function $E(e,t){return e.x*t.x+e.y*t.y}function zE(e,t){const r=$E(e,t),o=ko(e),l=ko(t);if(o===0||l===0)return 0;const s=Math.max(-1,Math.min(1,r/(o*l)));return Math.acos(s)}function WE(e,t,r){const o=Math.max(0,Math.min(1,r)),l={r:parseInt(e.substring(1,3),16),g:parseInt(e.substring(3,5),16),b:parseInt(e.substring(5,7),16)},s={r:parseInt(t.substring(1,3),16),g:parseInt(t.substring(3,5),16),b:parseInt(t.substring(5,7),16)},u=Math.round(l.r+(s.r-l.r)*o),d=Math.round(l.g+(s.g-l.g)*o),f=Math.round(l.b+(s.b-l.b)*o),g=m=>("00"+m.toString(16)).slice(-2);return`#${g(u)}${g(d)}${g(f)}`}var mt=(e=>(e.Friendly="Friendly",e.Hostile="Hostile",e))(mt||{}),Pt=(e=>(e[e.None=0]="None",e[e.General=1]="General",e[e.Performance=2]="Performance",e[e.Ecosystem=3]="Ecosystem",e))(Pt||{}),T=(e=>(e[e.SUCCESS=0]="SUCCESS",e[e.FAILURE=1]="FAILURE",e[e.RUNNING=2]="RUNNING",e[e.NOT_EVALUATED=3]="NOT_EVALUATED",e))(T||{});class Jn{constructor(){Oe(this,"name");Oe(this,"depth");Oe(this,"children");Oe(this,"child")}getLastStatus(t){return _.get(t.aiBlackboard,`${this.name}_lastStatus`)??3}setLastStatus(t,r){_.set(t.aiBlackboard,`${this.name}_lastStatus`,r)}getRunningChildIndex(t){return _.get(t.aiBlackboard,`${this.name}_runningChildIndex`)}setRunningChildIndex(t,r){_.set(t.aiBlackboard,`${this.name}_runningChildIndex`,r)}}const wt=30,Ho=wt*.6,th="#4CAF50",Mv="#FF5722",Fv="#9C27B0",YE="#2196F3",Uv="#FFC107",jE="#FFD700",Bv="#DC143C",nh="#FFFFFF",ih=[5,5],Eu=5,Oo=15,VE=20,XE=16,KE=10,ZE=16,qE=16,$m=["","","","","","","","","",""],If=8,QE="#FFFFFF",Sn=18,Ze=15,JE="rgba(0, 0, 0, 0.7)",ew=4,bi=150,on=15,li=10,Vi="#555",tw="#f44336",nw="#4CAF50",iw="#2196F3",rw="#FFC107",Rl=16,vr=32,Pl=28,ow=10,sw=8,aw=8,lw=8,mn=28,Nl=40,uw="rgba(255, 215, 0, 0.7)",cw="rgba(0, 0, 0, 0.3)",Vn=10,zm=8,Nd=11,Gi=20,Dd=40,Wm=5,dw=10,fw="#FFA500",hw="#808080",fi=120,Lv=30,gw=20,Yi="#2d3748",yn="#ffffff",Dl="#4a5568",Hv=5,rh="#bdc9f792",bv="#272c36ff",Gv="#a0aec0",su=300,xv="rgba(255, 255, 255, 0.5)",pw="rgba(0, 0, 0, 0.8)",mw="#FFFFFF",Ym=14,jm=8,Vm=-15,$v="#FFD700",zv=5,vw=60,Sw=-50,yw=10,kd=12,Xm=10,Tw="rgba(0, 0, 0, 0.5)",Aw="#4CAF50",Iw="#F44336",Ew="#FFC107",ww="rgba(255, 255, 255, 0.2)",Km="#FFFFFF",_w="#FF6B6B",Cw=5,Wv=30,Ns=50,kl=8,Zm=10,Rw="rgba(0, 0, 0, 0.5)",Pw="#FFFFFF",Nw=33,Dw=400,kw=20,Ow=10,Mw="rgba(0, 0, 0, 0.7)",Fw="#FFFFFF",Od=20,qm=16,Uw=.5,Qm=5,Yv="#FFD700",Bw=40,oh=4,jv=3,Lw=5,Vv=20,Xv=5,Hw="#FFFFFF",bw="#FF6B6B",sn=80,Sr=10,Ol=300,yr=15,Gw=8,xw="rgba(0, 0, 0, 0.8)",$w="#FFFFFF",Md=14,Jm=10,Xn=20,zw="#FF6B6B",Ww="#4CAF50",e0="#FFD700",Yw="rgba(255, 255, 0, 0.3)",jw=2,Vw=500,Xw=120,Kw=45,Zw="#FFD700",qw=3,Qw=4,_={create(){return{data:{},nodeExecutionData:{}}},set({data:e},t,r){e[t]=r},get(e,t){return e==null?void 0:e.data[t]},delete({data:e},t){delete e[t]},has({data:e},t){return t in e},recordNodeExecution({nodeExecutionData:e},t,r,o,l,s){const u=e[t]||{lastExecuted:0,status:T.FAILURE,depth:0,debugInfo:"",executionHistory:[]},d=u.executionHistory[u.executionHistory.length-1];d&&o-(d==null?void 0:d.time)>Js&&u.executionHistory.push({time:d.time+Js,status:T.NOT_EVALUATED}),u.executionHistory.push({time:o,status:r});const f=Wv/It*At,g=o-f;u.executionHistory=u.executionHistory.filter(v=>v.time>=g);const m={...u,lastExecuted:o,status:r,depth:l,debugInfo:s};e[t]=m},getNodeExecutionData({nodeExecutionData:e}){return e},cleanupOldEntries({nodeExecutionData:e},t){const r=FI,o=[];for(const[l,s]of Object.entries(e))t-s.lastExecuted>r&&o.push(l);for(const l of o)delete e[l]}},vi=24,t0=2,Kv=2;function st(e,t){if(e.leaderId){const r=t.entities.entities[e.leaderId];if(r&&r.aiBlackboard)return r}if(e.isAdult&&e.aiBlackboard)return e;if(!e.isAdult&&e.fatherId){const r=t.entities.entities[e.fatherId];if(r&&r.aiBlackboard)return r}return null}function Jw(e,t,r,o){if(!e.aiBlackboard)return;const l=`tribal_gather_${t}`,s={memberId:r,startTime:o};_.set(e.aiBlackboard,l,s)}function n0(e,t,r){if(!(e!=null&&e.aiBlackboard))return!1;const o=`tribal_gather_${t}`,l=_.get(e.aiBlackboard,o);return l?r-l.startTime>vi?(_.delete(e.aiBlackboard,o),!1):!0:!1}function i0(e,t){if(!(e!=null&&e.aiBlackboard))return null;const r=`tribal_gather_${t}`,o=_.get(e.aiBlackboard,r);return(o==null?void 0:o.memberId)??null}function r0(e,t){if(!e.aiBlackboard)return;const r=`tribal_gather_${t}`;_.delete(e.aiBlackboard,r)}function Zv(e,t,r,o){if(!e.aiBlackboard)return!1;const l=`tribal_hunt_${t}`;let s=_.get(e.aiBlackboard,l);return s?o-s.startTime>vi?(s={memberIds:[r],startTime:o,maxAssignments:t0},_.set(e.aiBlackboard,l,s),!0):s.memberIds.length>=s.maxAssignments?!1:(s.memberIds.includes(r)||(s.memberIds.push(r),_.set(e.aiBlackboard,l,s)),!0):(s={memberIds:[r],startTime:o,maxAssignments:t0},_.set(e.aiBlackboard,l,s),!0)}function Ef(e,t,r){if(!(e!=null&&e.aiBlackboard))return!0;const o=`tribal_hunt_${t}`,l=_.get(e.aiBlackboard,o);return!l||r-l.startTime>vi?!0:l.memberIds.includes(e.id)?l.memberIds.indexOf(e.id)<l.maxAssignments:l.memberIds.length<l.maxAssignments}function wf(e,t){if(!(e!=null&&e.aiBlackboard))return 0;const r=`tribal_hunt_${t}`,o=_.get(e.aiBlackboard,r);return(o==null?void 0:o.memberIds.length)??0}function _f(e,t,r){if(!e.aiBlackboard)return;const o=`tribal_hunt_${t}`,l=_.get(e.aiBlackboard,o);l&&(l.memberIds=l.memberIds.filter(s=>s!==r),l.memberIds.length===0?_.delete(e.aiBlackboard,o):_.set(e.aiBlackboard,o,l))}function e_(e,t,r,o){if(!e.aiBlackboard)return;const l=`tribal_plant_${Math.round(t.x)}_${Math.round(t.y)}`,s={memberId:r,startTime:o};_.set(e.aiBlackboard,l,s)}function t_(e,t,r,o=50){if(!(e!=null&&e.aiBlackboard))return!1;const l=e.aiBlackboard.data;for(const s in l)if(s.startsWith("tribal_plant_")){const u=l[s],d=s.split("_"),f=parseInt(d[2]),g=parseInt(d[3]),m=t.x-f,v=t.y-g;if(Math.sqrt(m*m+v*v)<=o){if(r-u.startTime>vi){_.delete(e.aiBlackboard,s);continue}return!0}}return!1}function o0(e,t){if(!e.aiBlackboard)return;const r=`tribal_plant_${Math.round(t.x)}_${Math.round(t.y)}`;_.delete(e.aiBlackboard,r)}function au(e,t,r,o,l){if(!e.aiBlackboard)return!1;const s=`tribal_storage_${t}`;let u=_.get(e.aiBlackboard,s);if(!u)return u={users:[{memberId:r,action:o,startTime:l}]},_.set(e.aiBlackboard,s,u),!0;if(u.users=u.users.filter(f=>l-f.startTime<=vi),u.users.length>=Kv){const f=u.users.find(g=>g.memberId===r);return f?(f.startTime=l,f.action=o,_.set(e.aiBlackboard,s,u),!0):!1}const d=u.users.find(f=>f.memberId===r);return d?(d.startTime=l,d.action=o):u.users.push({memberId:r,action:o,startTime:l}),_.set(e.aiBlackboard,s,u),!0}function Cf(e,t,r){if(!(e!=null&&e.aiBlackboard))return!0;const o=`tribal_storage_${t}`,l=_.get(e.aiBlackboard,o);return l?l.users.filter(u=>r-u.startTime<=vi).length<Kv:!0}function qv(e,t,r){if(!e.aiBlackboard)return;const o=`tribal_storage_${t}`,l=_.get(e.aiBlackboard,o);l&&(l.users=l.users.filter(s=>s.memberId!==r),l.users.length===0?_.delete(e.aiBlackboard,o):_.set(e.aiBlackboard,o,l))}function n_(e,t,r,o){if(!(e!=null&&e.aiBlackboard))return!1;const l=`tribal_procreation_${t}_${r}`,s=_.get(e.aiBlackboard,l);return s?o-s.startTime<=vi:!1}function i_(e,t){if(!e.aiBlackboard)return;const r=e.aiBlackboard.data,o=[];for(const l in r)if(l.startsWith("tribal_")){const s=r[l];if(s&&typeof s=="object")if(l.startsWith("tribal_storage_")){const u=s;u.users&&(u.users=u.users.filter(d=>t-d.startTime<=vi),u.users.length===0?o.push(l):_.set(e.aiBlackboard,l,u))}else"startTime"in s&&t-s.startTime>vi&&o.push(l)}for(const l of o)_.delete(e.aiBlackboard,l)}function s0(e,t,r){const l=t.search.human.byRadius(e.position,r),s=st(e,t);return l.filter(u=>{if(u.id===e.id||u.gender===e.gender||!u.isAdult||u.hunger>=Fr||(u.procreationCooldown||0)>0||u.gender==="female"&&u.isPregnant||n_(s,e.id,u.id,t.time))return!1;const d=u.id===e.motherId||u.id===e.fatherId,f=e.id===u.motherId||e.id===u.fatherId;return!d&&!f})}function Si(e){if(e.length===0)return;const t=e.filter(l=>l.gender==="male"),r=e.filter(l=>l.gender==="female"),o=(l,s)=>l.age!==s.age?s.age-l.age:l.id-s.id;if(t.sort(o),t.length>0)return t[0];if(r.sort(o),r.length>0)return r[0]}function Lt(e,t){const r=e,o=r.search.human.byProperty("motherId",t.id),l=r.search.human.byProperty("fatherId",t.id);return[...o,...l]}function Qv(e,t,r){var l;if(e.id===t.id||e.motherId===t.id||e.fatherId===t.id||t.motherId===e.id||t.fatherId===e.id||e.motherId&&e.motherId===t.motherId||e.fatherId&&e.fatherId===t.fatherId||(l=e.partnerIds)!=null&&l.includes(t.id))return!0;if(e.motherId){const s=r.entities.entities[e.motherId];if(s&&(s.motherId===t.id||s.fatherId===t.id))return!0}if(e.fatherId){const s=r.entities.entities[e.fatherId];if(s&&(s.motherId===t.id||s.fatherId===t.id))return!0}if(t.motherId){const s=r.entities.entities[t.motherId];if(s&&(s.motherId===e.id||s.fatherId===e.id))return!0}if(t.fatherId){const s=r.entities.entities[t.fatherId];if(s&&(s.motherId===e.id||s.fatherId===e.id))return!0}return!1}function Rf(e,t){var s,u,d,f;if(e.id===t.id||e.motherId===t.id||e.fatherId===t.id||t.motherId===e.id||t.fatherId===e.id||(s=e.partnerIds)!=null&&s.includes(t.id)||(u=t.partnerIds)!=null&&u.includes(e.id))return!0;if(e.fatherId===void 0&&e.motherId===void 0||t.fatherId===void 0&&t.motherId===void 0)return!1;const r=e.motherId===t.motherId||e.fatherId===t.fatherId,o=t.motherId===e.motherId||t.fatherId===e.fatherId,l=((d=e.ancestorIds)==null?void 0:d.some(g=>t.ancestorIds.includes(g)))||((f=t.ancestorIds)==null?void 0:f.some(g=>e.ancestorIds.includes(g)));return r||o||l}function r_(e,t){const r=[];if(e.motherId){const o=t.entities.entities[e.motherId];o&&r.push(o)}if(e.fatherId){const o=t.entities.entities[e.fatherId];o&&r.push(o)}return r}function o_(e,t){if(e.gender!=="female"||!e.partnerIds||e.partnerIds.length===0)return null;for(const r of e.partnerIds){const o=t.entities.entities[r];if(o&&o.gender==="male")return o}return null}function s_(e,t){var r;if(!e.isAdult&&e.fatherId){const o=t.entities.entities[e.fatherId];if(o&&o.type==="human")return o}if(e.isAdult&&e.fatherId){const o=t.entities.entities[e.fatherId];if(o&&o.type==="human"&&((r=Si(Lt(t,o)))==null?void 0:r.id)===e.id)return o}return e.isAdult&&e.gender==="female"&&e.partnerIds&&e.partnerIds.length>0?o_(e,t):null}function lu(e,t){var o;const r=new Set;if(e.motherId){const l=t.entities.entities[e.motherId];l&&r.add(l)}if(e.fatherId){const l=t.entities.entities[e.fatherId];l&&r.add(l)}return(o=e.partnerIds)==null||o.forEach(l=>{const s=t.entities.entities[l];s&&r.add(s)}),Lt(t,e).forEach(l=>r.add(l)),Array.from(r)}function Jv(e,t){const r=new Map;function o(l){const s=Lt(t,l);for(const u of s)r.has(u.id)||(r.set(u.id,u),o(u))}return o(e),Array.from(r.values())}function ta(e,t){return t.search.human.byProperty("leaderId",e)}function eS(e,t){var u,d;const r=new Map,o=Object.values(e.entities.entities).filter(f=>f.type==="human");for(const f of o)f.leaderId&&(r.has(f.leaderId)||r.set(f.leaderId,{leaderId:f.leaderId,tribeBadge:f.tribeBadge||"?",members:[]}),(u=r.get(f.leaderId))==null||u.members.push(f));const l=t?(d=e.entities.entities[t])==null?void 0:d.diplomacy:void 0,s=Array.from(r.values()).map(f=>{const g=e.entities.entities[f.leaderId],m=f.members.filter(y=>y.isAdult).length,v=f.members.length-m;return{leaderId:f.leaderId,tribeBadge:f.tribeBadge,adultCount:m,childCount:v,isPlayerTribe:f.leaderId===t,leaderAge:(g==null?void 0:g.age)??0,leaderGender:(g==null?void 0:g.gender)??"male",diplomacyStatus:(l==null?void 0:l[f.leaderId??-1])??mt.Friendly}});return s.sort((f,g)=>f.isPlayerTribe?-1:g.isPlayerTribe?1:g.adultCount+g.childCount-(f.adultCount+f.childCount)),s}function Un(e,t){return e.leaderId?t.search.human.byProperty("leaderId",e.leaderId):[]}function De(e,t,r,o,l){const s=t,u=o,d="position"in e&&e.id?e:null,f=d?d.position:e,g=s.search[r].byRadius(f,u);let m=null,v=u;for(const y of g){if(y.id===(d==null?void 0:d.id)||l&&!l(y))continue;const w=V(f,y.position,t.mapDimensions.width,t.mapDimensions.height);w<v&&(v=w,m=y)}return m}function a_(e,t,r,o){return t.search[r].byRadius(e,o)}function a0(e,t,r,o){return a_(e,t,r,o).length}function _t(e){const r=e.search.human.byProperty("isPlayer",!0);return r.length>0?r[0]:void 0}function l_(e,t){var u;const o=t.search.human.byProperty("activeAction","attacking");let l=null,s=1/0;for(const d of o){if(d.attackTargetId!==e)continue;const f=V(d.position,((u=t.entities.entities[e])==null?void 0:u.position)||{x:0,y:0},t.mapDimensions.width,t.mapDimensions.height);f<s&&(l=d,s=f)}return l}function u_(e){return Object.values(e.entities.entities).filter(t=>t.type==="human")}function c_(e,t,r){const o=Object.values(t.entities.entities).reverse();for(const l of o)if(xE(e,l.position)<l.radius)return l}function sh(e,t,r,o){const l=Math.random()*Math.PI*2,s=Math.sqrt(Math.random())*t,u={x:Math.cos(l)*s,y:Math.sin(l)*s},d=Mn(e,u);return{x:(d.x%r+r)%r,y:(d.y%o+o)%o}}function Bn(e,t,r,o){const l=t,s={left:e.x-r,top:e.y-r,right:e.x+r,bottom:e.y+r},u=[...l.search.human.byRect(s),...l.search.berryBush.byRect(s),...l.search.corpse.byRect(s)];for(const d of u){if(o!==void 0&&d.id===o)continue;if(V(e,d.position,t.mapDimensions.width,t.mapDimensions.height)<r+d.radius)return!0}return!1}function tS(e,t,r,o,l){const s=t.mapDimensions.width,u=t.mapDimensions.height;if(!Bn(e,t,o,l))return e;const d=o;for(let f=d;f<=r;f+=d){const g=Math.ceil(2*Math.PI*f/d);for(let m=0;m<g;m++){const v=m/g*2*Math.PI,y={x:Math.cos(v)*f,y:Math.sin(v)*f},w=Mn(e,y),I={x:(w.x%s+s)%s,y:(w.y%u+u)%u};if(!Bn(I,t,o,l))return I}}return null}function Br(e,t){const r=t.search.building.byProperty("ownerId",e);if(r.length>0){const s=r.map(u=>u.position);return ou(s)}const o=ta(e,t);if(o.length===0){const s=t.entities.entities[e];return s?s.position:{x:0,y:0}}const l=o.map(s=>s.position);return ou(l)}function l0(e,t){const o=[...lu(e,t),e].map(l=>l.position);return ou(o)}function d_(e,t,r){const o=r.mapDimensions.width,l=r.mapDimensions.height;let s=e.x-t.position.x,u=e.y-t.position.y;return Math.abs(s)>o/2&&(s-=Math.sign(s)*o),Math.abs(u)>l/2&&(u-=Math.sign(u)*l),Math.abs(s)<=t.width/2&&Math.abs(u)<=t.height/2}function f_(e,t,r){return t.search.human.byRadius(e.position,r).filter(l=>{var s;return l.activeAction==="procreating"&&l.gender===e.gender&&typeof l.target=="number"&&((s=e.partnerIds)==null?void 0:s.includes(l.target))})[0]}function h_(e,t,r){if(!e.leaderId)return;const o=t,l=o.search.berryBush.byRadius(e.position,r).filter(s=>s.ownerId===e.id);for(const s of l)if(s.claimedUntil&&t.time<s.claimedUntil){const u=o.search.human.byRadius(s.position,Et);for(const d of u)if(!Rf(d,e)&&d.activeAction==="gathering"&&d.target===s.id)return d}}function g_(e,t,r){const o=lu(e,t),l=t;for(const s of o){if(V(e.position,s.position,t.mapDimensions.width,t.mapDimensions.height)>r)continue;const d=l.search.human.byProperty("attackTargetId",s.id);for(const f of d)if(f.leaderId!==e.leaderId)return{familyMember:s,aggressor:f}}}function p_(e,t){const o=t.search.human.byRadius(e.position,tE);let l,s=1/0;for(const u of o){if(u.id===e.id||u.hitpoints<=0||u.hitpoints/u.maxHitpoints>eE||Qv(e,u,t))continue;const d=V(e.position,u.position,t.mapDimensions.width,t.mapDimensions.height);d<s&&(s=d,l=u)}return l}function m_(e,t){const r=De(e,t,"berryBush",Um,l=>l.ownerId===e.id);return r?tS(r.position,t,Um,er,r.id):null}function ah(e,t,r){return t.search.human.byRadius(e.position,r).filter(l=>bo(e,l,t))}function v_(e,t,r){const o=r.search.human.byProperty("leaderId",e);let l=0;for(const s of o)s.attackTargetId===t&&l++;return l}function u0(e,t,r,o){const l=r.search.berryBush.byRadius(e,t),s=r.search.human.byRadius(e,t).filter(f=>f.leaderId!==o);let u=l.length*WI;u+=s.length*YI;let d;if(s.length>0){const f={};for(const m of s)m.leaderId&&(f[m.leaderId]=(f[m.leaderId]||0)+1);let g=0;for(const m in f)f[m]>g&&(g=f[m],d=parseInt(m,10))}return{score:u,occupyingTribeId:d}}function uu(e){return e.filter(t=>t.isAdult).reduce((t,r)=>{let o=r.hitpoints;return o+=(r.maxAge-r.age)*.5,o+=r.food.length*2,t+o},0)}function S_(e,t){if(e.id!==e.leaderId)return null;const r=t,o=Br(e.id,t),{score:l}=u0(o,Pd/2,r,e.id);let s=null,u=l;const d=zI,f=$I;for(let g=e.position.x-f;g<e.position.x+f;g+=d)for(let m=e.position.y-f;m<e.position.y+f;m+=d){const v={x:(g%t.mapDimensions.width+t.mapDimensions.width)%t.mapDimensions.width,y:(m%t.mapDimensions.height+t.mapDimensions.height)%t.mapDimensions.height};if(V(o,v,t.mapDimensions.width,t.mapDimensions.height)<Pd*2)continue;const{score:w}=u0(v,Pd/2,r,e.id);w>u*jI&&(u=w,s=v)}return s}let Fd=0;function Pf(){const e=$m[Fd];return Fd=(Fd+1)%$m.length,e}const c0=40,y_=.3,T_=24,d0=500,Mo=10,nS=250,na=12,iS=10;var se=(e=>(e.Gather="Gather",e.Eat="Eat",e.Procreate="Procreate",e.Attack="Attack",e.Plant="Plant",e.CallToAttack="CallToAttack",e.TribeSplit="TribeSplit",e.FollowMe="FollowMe",e.FeedChild="FeedChild",e.HuntPrey="HuntPrey",e.DefendAgainstPredator="DefendAgainstPredator",e.Build="Build",e.Removal="Removal",e.Deposit="Deposit",e.Retrieve="Retrieve",e.AutopilotMove="AutopilotMove",e.AutopilotGather="AutopilotGather",e.AutopilotAttack="AutopilotAttack",e.AutopilotProcreate="AutopilotProcreate",e.AutopilotPlant="AutopilotPlant",e.AutopilotFeedChild="AutopilotFeedChild",e.AutopilotFollowMe="AutopilotFollowMe",e.AutopilotDeposit="AutopilotDeposit",e.AutopilotRetrieve="AutopilotRetrieve",e))(se||{});const wu={Gather:"",Eat:"",Procreate:"",Attack:"",Plant:"",CallToAttack:"",TribeSplit:"",FollowMe:"",FeedChild:"",HuntPrey:"",DefendAgainstPredator:"",Build:"",Removal:"",Deposit:"",Retrieve:"",AutopilotMove:"",AutopilotGather:"",AutopilotAttack:"",AutopilotProcreate:"",AutopilotPlant:"",AutopilotFeedChild:"",AutopilotFollowMe:"",AutopilotDeposit:"",AutopilotRetrieve:""},rS={Gather:"Gather",Eat:"Eat",Procreate:"Procreate",Attack:"Attack",Plant:"Plant",CallToAttack:"Call to Attack",TribeSplit:"Split Tribe",FollowMe:"Follow Me",FeedChild:"Feed Child",HuntPrey:"Hunt Prey",DefendAgainstPredator:"Defend",Build:"Build",Removal:"Remove",Deposit:"Deposit",Retrieve:"Retrieve",AutopilotMove:"Walk",AutopilotGather:"Gather",AutopilotAttack:"Attack",AutopilotProcreate:"Procreate",AutopilotPlant:"Plant",AutopilotFeedChild:"Feed",AutopilotFollowMe:"Follow",AutopilotDeposit:"Deposit",AutopilotRetrieve:"Retrieve"};var mo=(e=>(e.Time="Time",e.Hunger="Hunger",e.Hitpoints="Hitpoints",e.Food="Food",e.Autopilot="Autopilot",e.Muted="Muted",e.Family="Family",e.Tribes="Tribes",e))(mo||{});const Ds={Time:"",Hunger:"",Hitpoints:"",Food:"",Autopilot:"",Muted:"",Family:"",Tribes:""};var ge=(e=>(e.ToggleMute="ToggleMute",e.TogglePause="TogglePause",e.FastForward="FastForward",e.DismissTutorial="DismissTutorial",e.ReturnToIntro="ReturnToIntro",e.ConfirmExitYes="ConfirmExitYes",e.ConfirmExitNo="ConfirmExitNo",e.CommandEat="CommandEat",e.CommandPlant="CommandPlant",e.CommandCallToAttack="CommandCallToAttack",e.CommandFollowMe="CommandFollowMe",e.CommandGather="CommandGather",e.CommandTribeSplit="CommandTribeSplit",e.CommandBuild="CommandBuild",e.SelectStorageSpot="SelectStorageSpot",e.SelectPlantingZone="SelectPlantingZone",e.SelectRemovalTool="SelectRemovalTool",e.ToggleProcreationBehavior="ToggleProcreationBehavior",e.ToggleAttackBehavior="ToggleAttackBehavior",e.ToggleFeedChildBehavior="ToggleFeedChildBehavior",e.TogglePlantingBehavior="TogglePlantingBehavior",e.ToggleGatheringBehavior="ToggleGatheringBehavior",e.ToggleAutopilotFollowLeaderBehavior="ToggleAutopilotFollowLeaderBehavior",e.ToggleDiplomacy="ToggleDiplomacy",e))(ge||{});const A_=12,I_=24,E_=150*.9,w_=24;var ia=(e=>(e.Hello="HELLO",e.NewTribeFormed="NEW_TRIBE_FORMED",e.NoHeir="NO_HEIR",e.ChildrenStarving="CHILDREN_STARVING",e))(ia||{});let __=0;function C_(){return`notification-${Date.now()}-${__++}`}function Nf(e,t){if(t.identifier){const o=e.notifications.find(l=>l.identifier===t.identifier);if(o){if(o.dismissedUntil&&e.time<o.dismissedUntil)return;o.message=t.message,o.timestamp=e.time,o.creationTime=Date.now(),o.duration=t.duration,o.targetEntityIds=t.targetEntityIds,o.highlightedEntityIds=t.highlightedEntityIds,o.targetPosition=t.targetPosition,o.targetArea=t.targetArea,o.targetRadius=t.targetRadius,o.isDismissed=!1,o.dismissedUntil=void 0;return}}const r={...t,id:C_(),timestamp:e.time,creationTime:Date.now(),isDismissed:!1};e.notifications.push(r)}function R_(e,t){const r=e.notifications.find(o=>o.id===t);r&&(r.isDismissed=!0,r.identifier&&(r.dismissedUntil=e.time+w_))}function P_(e){const t=e.time;e.notifications=e.notifications.filter(r=>r.duration===0?!0:!(t-r.timestamp>r.duration))}function N_(e){for(const r of Object.values(e.entities.entities))r.isHighlighted=!1;const t=e.notifications.filter(r=>!r.isDismissed);for(const r of t)if(r.highlightedEntityIds)for(const o of r.highlightedEntityIds){const l=e.entities.entities[o];l&&(l.isHighlighted=!0)}}const f0=600,D_=1.5,oS=.1,Ml=""+new URL("attack-D4MA8VWK.mp3",import.meta.url).href,Ud=""+new URL("gather-CU75596W.mp3",import.meta.url).href,k_=""+new URL("eat-DCjHq2QD.mp3",import.meta.url).href,Bd=""+new URL("procreate-CfE4r5Cp.mp3",import.meta.url).href,O_=""+new URL("birth-Cbd67GHT.mp3",import.meta.url).href,M_=""+new URL("child-fed-DzEPuMid.mp3",import.meta.url).href,F_=""+new URL("human-death-B6HFLXES.mp3",import.meta.url).href,U_=""+new URL("game-over-C5dqkyER.mp3",import.meta.url).href,B_=""+new URL("button-click-DomLUeaU.mp3",import.meta.url).href,L_=""+new URL("soundtrack-1-BdlYUGye.mp3",import.meta.url).href;var fe=(e=>(e[e.Attack=0]="Attack",e[e.Gather=1]="Gather",e[e.Eat=2]="Eat",e[e.Procreate=3]="Procreate",e[e.Birth=4]="Birth",e[e.ChildFed=5]="ChildFed",e[e.HumanDeath=6]="HumanDeath",e[e.Seize=7]="Seize",e[e.CallToAttack=8]="CallToAttack",e[e.TribeSplit=9]="TribeSplit",e[e.CallToFollow=10]="CallToFollow",e[e.StorageDeposit=11]="StorageDeposit",e[e.StorageRetrieve=12]="StorageRetrieve",e[e.StorageSteal=13]="StorageSteal",e[e.GameOver=14]="GameOver",e[e.ButtonClick=15]="ButtonClick",e[e.SoundTrack1=16]="SoundTrack1",e))(fe||{});const H_=new Map([[0,Ml],[1,Ud],[2,k_],[3,Bd],[4,O_],[5,M_],[6,F_],[14,U_],[15,B_],[7,Ml],[8,Ml],[9,Bd],[10,Bd],[11,Ud],[12,Ud],[13,Ml],[16,L_]]);let ks,ra;function b_(){if(!(typeof window>"u"))return ra}function lh(){if(!(typeof window>"u"))return!ks&&typeof window.AudioContext=="function"&&(ks=new window.AudioContext,ra=ks.createGain(),ra.connect(ks.destination),zs(.1,!1)),ks}function zs(e,t){ra&&(ra.gain.value=t?0:e/10)}const sS=new Map;let Fl=!1,h0=!1;async function G_(){if(h0||Fl)return;const e=lh();if(!e){console.error("AudioContext not supported. Cannot load sounds.");return}e.state==="suspended"&&e.resume(),Fl=!0,console.log("Starting sound loading...");const t=[];H_.forEach((r,o)=>{const l=fetch(r).then(s=>{if(!s.ok)throw new Error(`Failed to fetch sound: ${r}`);return s.arrayBuffer()}).then(s=>e.decodeAudioData(s)).then(s=>{sS.set(o,s)}).catch(s=>{console.error(`Error loading sound ${fe[o]} from ${r}:`,s)});t.push(l)});try{await Promise.all(t),h0=!0,Fl=!1,console.log("All sounds loaded successfully.")}catch(r){Fl=!1,console.error("An error occurred while loading sounds:",r)}}const Ws=new Map;function uh(e,t){const r=lh(),o=b_();if(!r||!o||o.gain.value===0&&(t==null?void 0:t.trackId)===void 0)return;r.state==="suspended"&&r.resume();const l=sS.get(e);if(!l){console.warn(`Sound buffer not found for type: ${fe[e]}`);return}if(t!=null&&t.trackId&&Ws.has(t.trackId))return;const s=r.createBufferSource();s.buffer=l,s.loop=(t==null?void 0:t.loop)??!1;const u=r.createGain(),d=r.createStereoPanner();let f=u;if(t!=null&&t.position&&(t!=null&&t.listenerPosition)&&(t!=null&&t.worldDimensions)){const g=ze(t.listenerPosition,t.position,t.worldDimensions.width,t.worldDimensions.height),m=V(t.listenerPosition,t.position,t.worldDimensions.width,t.worldDimensions.height);if(m>f0)return;const v=1-Math.pow(m/f0,D_);u.gain.value=Math.max(0,v);const y=Math.sin(g.x/m*(Math.PI/2));d.pan.value=isNaN(y)?0:y,u.connect(d),f=d}else{const g=e===fe.GameOver?.4:e===fe.SoundTrack1?1:.2;u.gain.value=g}s.connect(f),f.connect(o),s.start(0),t!=null&&t.trackId&&(Ws.set(t.trackId,{sourceNode:s,gainNode:u}),s.onended=()=>{Ws.delete(t.trackId)})}function Ld(e,t=1){const r=Ws.get(e),o=lh();if(r&&o){const{sourceNode:l,gainNode:s}=r,u=o.currentTime;s.gain.setValueAtTime(s.gain.value,u),s.gain.linearRampToValueAtTime(0,u+t),l.stop(u+t),l.onended=null,Ws.delete(e)}}function Ie(e,t,r){const o=_t(e.gameState);o&&uh(t,{position:r,listenerPosition:o.position,worldDimensions:e.gameState.mapDimensions,masterVolume:e.gameState.masterVolume,isMuted:e.gameState.isMuted})}function x_(e,t,r){const o=r.mapDimensions.width,l=r.mapDimensions.height,s=t.radius*2;for(let u=d0;u<o/2;u+=50)for(let d=0;d<10;d++){const f=sh(e,u,o,l);if(!(V(e,f,o,l)<d0)&&!Bn(f,r,s,t.id))return f}return null}function ch(e,t){if(!e.isAdult||e.gender!=="male"||e.leaderId===e.id||!e.leaderId)return{canSplit:!1};if(!e.leaderId)return{canSplit:!1};const r=t.entities.entities[e.leaderId];if(!r||r.type!=="human")return{canSplit:!1};const o=Si(Lt(t,r));if(o&&o.id===e.id)return{canSplit:!1};const l=ta(e.leaderId,t);if(l.length<c0)return{canSplit:!1};const u=Jv(e,t).length+1,d=Math.min(l.length*y_,c0);return{canSplit:u>=d,progress:u/d}}function dh(e,t){if(!ch(e,t).canSplit)return;const r=e.leaderId?t.entities.entities[e.leaderId]:void 0,o=Pf(),l=Jv(e,t);e.leaderId=e.id,e.tribeBadge=o,e.diplomacy={},r&&r.diplomacy&&(r.diplomacy[e.id]=mt.Hostile);for(const u of l)u.leaderId=e.id,u.tribeBadge=o;Nf(t,{type:ia.NewTribeFormed,message:`A new tribe has formed! ${o}`,duration:I_,targetEntityIds:[e.id],highlightedEntityIds:[e.id,...l.map(u=>u.id)]}),Ie({gameState:t},fe.TribeSplit,e.position)}const $_=20,An=30,z_=.5,W_=.3,Y_=2,Df=50;function fh(e,t){const r=[];if(t.food.length>0&&t.hunger>tr&&r.push({type:se.Eat,action:"eating",key:"f"}),t.food.length<t.maxFood){const s=De(t,e,"berryBush",Et,f=>f.food.length>0),u=De(t,e,"corpse",Et,f=>f.food.length>0);let d=null;s&&u?d=V(t.position,s.position,e.mapDimensions.width,e.mapDimensions.height)<=V(t.position,u.position,e.mapDimensions.width,e.mapDimensions.height)?s:u:d=s||u,d&&r.push({type:se.Gather,action:"gathering",key:"e",targetEntity:d})}const o=De(t,e,"human",Et,s=>Lr(t,s,e));if(o&&r.push({type:se.Procreate,action:"procreating",key:"r",targetEntity:o}),t.food.length>0&&t.isAdult){const s=De(t,e,"human",Et,u=>{const d=u;return!d.isAdult&&(d.motherId===t.id||d.fatherId===t.id)&&d.hunger>=tr});s&&r.push({type:se.FeedChild,action:"feeding",key:"h",targetEntity:s})}const l=De(t,e,"human",Qn,s=>bo(t,s,e))??De(t,e,"predator",Qn)??De(t,e,"prey",Qn);if(l&&r.push({type:se.Attack,action:"attacking",key:"q",targetEntity:l}),t.food.filter(s=>s.type===Fn.Berry).length>=Or&&r.push({type:se.Plant,action:"planting",key:"b"}),t.food.length>0&&t.isAdult){const s=De(t,e,"building",An,u=>{const d=u;return d.buildingType==="storageSpot"&&d.ownerId===t.leaderId&&d.isConstructed&&d.storedFood!==void 0&&d.storageCapacity!==void 0&&d.storedFood.length<d.storageCapacity});s&&r.push({type:se.Deposit,action:"idle",key:"x",targetEntity:s})}if(t.food.length<t.maxFood&&t.isAdult){const s=De(t,e,"building",An,u=>{const d=u;return d.buildingType==="storageSpot"&&d.ownerId===t.leaderId&&d.isConstructed&&d.storedFood!==void 0&&d.storedFood.length>0});s&&r.push({type:se.Retrieve,action:"idle",key:"z",targetEntity:s})}return t.leaderId===t.id&&!t.isCallingToAttack&&ah(t,e,nS).length>0&&r.push({type:se.CallToAttack,action:"idle",key:"v"}),ch(t,e).canSplit&&r.push({type:se.TribeSplit,action:"idle",key:"k"}),t.leaderId===t.id&&!t.isCallingToFollow&&r.push({type:se.FollowMe,action:"idle",key:"c"}),r}const bo=(e,t,r)=>{var o,l,s,u;if(e.id===t.id)return!1;if(e.leaderId&&!t.leaderId)return!0;if(e.leaderId===t.leaderId)return!1;if(e.leaderId&&t.leaderId){const d=(l=(o=r.entities.entities[e.leaderId])==null?void 0:o.diplomacy)==null?void 0:l[t.leaderId],f=(u=(s=r.entities.entities[t.leaderId])==null?void 0:s.diplomacy)==null?void 0:u[e.leaderId];return d===mt.Hostile||f===mt.Hostile}return!1},Lr=(e,t,r)=>{if(e.id===t.id||e.gender===t.gender||!e.isAdult||!t.isAdult||e.hunger>=Fr||t.hunger>=Fr||(e.procreationCooldown||0)>0||(t.procreationCooldown||0)>0||bo(e,t,r))return!1;const o=e.gender==="female"?e:t;return!(o.isPregnant||o.age>Pv)},oa={StorageSpot:"storageSpot",PlantingZone:"plantingZone"},fa={[oa.StorageSpot]:{name:"Storage Spot",description:"A designated area for storing excess food.",icon:"",dimensions:{width:40,height:40},constructionTimeHours:.1,destructionTimeHours:.1,cost:{}},[oa.PlantingZone]:{name:"Planting Zone",description:"An area marked for agricultural use.",icon:"",dimensions:{width:60,height:60},constructionTimeHours:.1,destructionTimeHours:.1,cost:{}}},j_=.5,V_="#FFA500",X_="#FF4500",g0=4,K_=10;function aS(e){return fa[e].dimensions}function Z_(e){return fa[e].constructionTimeHours}function q_(e){return fa[e].destructionTimeHours}function lS(e,t,r,o){if(r===void 0)return!1;const l=aS(t),s=Math.sqrt(l.width*l.width+l.height*l.height)/2;if(Bn(e,o,s*.8))return!1;const d=o.search.building.byRadius(e,s*2);for(const f of d){const g=V(e,f.position,o.mapDimensions.width,o.mapDimensions.height),m=(Math.max(l.width,l.height)+Math.max(f.width,f.height))/2;if(g<m*.9)return!1}return!0}function Q_(e,t,r,o){return RR(o.entities,e,t,r)}function J_(e,t){const r=t.entities.entities[e];r&&r.type==="building"&&!r.isBeingDestroyed&&(r.isBeingDestroyed=!0,r.destructionProgress=0)}function eC(e,t){const l=t.search.building.byRadius(e,100);for(const s of l){let u=e.x-s.position.x,d=e.y-s.position.y;const f=t.mapDimensions.width,g=t.mapDimensions.height;if(Math.abs(u)>f/2&&(u-=Math.sign(u)*f),Math.abs(d)>g/2&&(d-=Math.sign(d)*g),Math.abs(u)<=s.width/2&&Math.abs(d)<=s.height/2)return s}}const tC=500,nC=500;function iC(e,t){if(!e.leaderId)return 0;const r=rC(e.leaderId,t),o=oC(e.leaderId,t);return o===0?0:Math.min(1,r/o)}function rC(e,t){const r=Un({leaderId:e},t),o=_u(e,t),l=r.reduce((u,d)=>u+d.food.length,0),s=o.reduce((u,d)=>{var f;return u+(((f=d.storedFood)==null?void 0:f.length)||0)},0);return l+s}function oC(e,t){const r=Un({leaderId:e},t),o=_u(e,t),l=r.reduce((u,d)=>u+d.maxFood,0),s=o.reduce((u,d)=>u+(d.storageCapacity||0),0);return l+s}function sC(e,t){const r=_u(e,t);if(r.length===0)return 0;const o=r.reduce((s,u)=>{var d;return s+(((d=u.storedFood)==null?void 0:d.length)||0)},0),l=r.reduce((s,u)=>s+(u.storageCapacity||0),0);return l===0?0:Math.min(1,o/l)}function aC(e,t){const r=Un({leaderId:e},t);return r.length===0?0:lC(e,t)/r.length}function lC(e,t){const r=t,o=Br(e,t);return r.search.berryBush.byRadius(o,tC).filter(u=>{const d=u.stateMachine&&u.stateMachine[0]==="bushDying",f=u.food.length>0;return!d&&f}).length}function hh(e,t){return e.leaderId?t.search.building.all().filter(l=>{if(l.buildingType!==oa.PlantingZone||!l.isConstructed)return!1;if(l.ownerId){const s=t.entities.entities[l.ownerId];return s&&s.leaderId===e.leaderId}return!1}):[]}function uS(e){const t=er*2,r=Math.floor(e.width/t),o=Math.floor(e.height/t);return r*o}function cS(e,t){const r=t,o=Math.max(e.width,e.height);return r.search.berryBush.byRadius(e.position,o).filter(u=>{const d=Math.abs(u.position.x-e.position.x),f=Math.abs(u.position.y-e.position.y);return d<=e.width/2&&f<=e.height/2}).length}function uC(e,t){const r=hh(e,t),o=Un(e,t);return r.map(l=>{const s=uS(l),u=cS(l,t),d=o.filter(f=>{if(f.activeAction!=="planting")return!1;if(typeof f.target=="object"&&"x"in f.target){const g=f.target,m=V(g,l.position,t.mapDimensions.width,t.mapDimensions.height),v=Math.sqrt(l.width*l.width+l.height*l.height)/2;return m<=v}return!1}).length;return{zone:l,capacity:s,currentBushes:u,assignedPlanters:d}})}function cC(e,t){const r=uC(e,t);if(r.length===0)return null;const o=r.filter(l=>l.currentBushes<l.capacity);return o.length===0?null:(o.sort((l,s)=>{const u=l.currentBushes/l.capacity,d=s.currentBushes/s.capacity;return Math.abs(u-d)>.01?u-d:l.assignedPlanters-s.assignedPlanters}),o[0].zone)}function dC(e,t){if(!e.leaderId)return[];const r=_u(e.leaderId,t),o=Un(e,t);return r.map(l=>{var g;const s=l.storageCapacity||0,u=((g=l.storedFood)==null?void 0:g.length)||0,d=o.filter(m=>{if(m.activeAction!=="depositing")return!1;if(typeof m.target=="object"&&"x"in m.target){const v=m.target;return V(v,l.position,t.mapDimensions.width,t.mapDimensions.height)<=50}return!1}).length,f=V(e.position,l.position,t.mapDimensions.width,t.mapDimensions.height);return{storage:l,capacity:s,currentFood:u,assignedDepositors:d,distance:f}})}function p0(e,t){const r=dC(e,t);if(r.length===0)return null;const o=r.filter(l=>{const s=l.currentFood<l.capacity,u=l.distance<=nC;return s&&u});return o.length===0?null:(o.sort((l,s)=>{const u=l.currentFood/l.capacity,d=s.currentFood/s.capacity;return Math.abs(u-d)>.1?u-d:l.assignedDepositors!==s.assignedDepositors?l.assignedDepositors-s.assignedDepositors:l.distance-s.distance}),o[0].storage)}function dS(e,t,r){return Un({leaderId:e},t).filter(l=>l.activeAction===r).length}function _u(e,t){return t.search.building.all().filter(l=>{if(l.buildingType!==oa.StorageSpot||!l.isConstructed)return!1;if(l.ownerId){const s=t.entities.entities[l.ownerId];return s&&s.leaderId===e}return!1})}function fC(e,t){const r=hh(e,t);if(r.length===0)return null;const o=t.mapDimensions.width,l=t.mapDimensions.height;for(const s of r){const u=uS(s);if(cS(s,t)>=u)continue;const f=20;for(let g=0;g<f;g++){const m=s.position.x+(Math.random()-.5)*s.width,v=s.position.y+(Math.random()-.5)*s.height,y={x:(m%o+o)%o,y:(v%l+l)%l};if(!Bn(y,t,er))return y}}return null}function hC(e,t,r){return hh(t,r).some(s=>d_(e,s,r))?!Bn(e,r,er):!1}const gC={id:Ql,update:(e,t)=>{const{entity:r,updateContext:o}=t,{gameState:l}=o,s=o.deltaTime*(At/It);if(r.age+=s,r.age>=r.lifespan)return{nextState:Qs,data:{...e,enteredAt:l.time,previousState:Ql}};const u=sh(r.position,r.spreadRadius,l.mapDimensions.width,l.mapDimensions.height);return Bn(u,l,15)||pa(l.entities,u,l.time),{nextState:Ir,data:{...e,enteredAt:l.time,previousState:Ql}}},onEnter:(e,t)=>({...t,enteredAt:e.updateContext.gameState.time})},pC={id:Qs,update:e=>({nextState:Qs,data:e}),onEnter:(e,t)=>($o(e.updateContext.gameState.entities,e.entity.id),{...t,enteredAt:e.updateContext.gameState.time})},mC=[yI,TI,gC,pC],ct="humanIdle",Ar="humanMoving",Hs="humanEating",ha="humanGathering",Ys="humanDepositing",js="humanRetrieving",sa="humanProcreating",nr="humanAttacking",eu="humanPlanting",vC={id:ct,update:(e,t)=>{const{entity:r,updateContext:o}=t;return r.activeAction==="attacking"&&r.attackTargetId?{nextState:nr,data:{...e,enteredAt:o.gameState.time,previousState:ct,attackTargetId:r.attackTargetId,attackStartTime:o.gameState.time}}:(r.hunger>=_v?(r.debuffs=r.debuffs.filter(l=>l.type!=="slow"),r.debuffs.push({type:"slow",startTime:o.gameState.time,duration:.1})):r.debuffs=r.debuffs.filter(l=>l.type!=="slow"),r.activeAction==="moving"?{nextState:Ar,data:{...e,enteredAt:o.gameState.time,previousState:ct,target:r.target}}:r.activeAction==="gathering"?{nextState:ha,data:{...e,enteredAt:o.gameState.time,previousState:ct,target:r.target}}:r.activeAction==="eating"?{nextState:Hs,data:{...e,enteredAt:o.gameState.time,previousState:ct}}:r.activeAction==="planting"&&r.target?{nextState:eu,data:{...e,enteredAt:o.gameState.time,previousState:ct,plantingSpot:r.target}}:r.activeAction==="depositing"?{nextState:Ys,data:{...e,enteredAt:o.gameState.time,previousState:ct}}:r.activeAction==="retrieving"?{nextState:js,data:{...e,enteredAt:o.gameState.time,previousState:ct}}:{nextState:ct,data:e})},onEnter:(e,t)=>(e.entity.acceleration=0,e.entity.velocity={x:0,y:0},{...t,enteredAt:e.updateContext.gameState.time})};function fS(e){let t=vE;return e.hunger>=_v&&(t*=SE),e.age>=TE&&(t*=AE),e.movementSlowdown&&(t*=e.movementSlowdown.modifier),t}const Hd=7.5;class SC{constructor(){Oe(this,"id",Ar)}update(t,r){var f;const{entity:o,updateContext:l}=r;if(o.activeAction==="attacking"&&o.attackTargetId)return{nextState:nr,data:{...t,enteredAt:l.gameState.time,previousState:Ar,attackTargetId:o.attackTargetId,attackStartTime:l.gameState.time}};if(o.activeAction!=="moving")return{nextState:ct,data:{...t,enteredAt:l.gameState.time,previousState:Ar}};let s;if(typeof o.target=="object"?s=o.target:typeof o.target=="number"&&(s=(f=r.updateContext.gameState.entities.entities[o.target])==null?void 0:f.position),!s&&(o.direction.x!==0||o.direction.y!==0)&&(s={x:o.position.x+o.direction.x*Hd*2,y:o.position.y+o.direction.y*Hd*2}),!s)return{nextState:ct,data:{...t,enteredAt:l.gameState.time,previousState:Ar}};const u=ze(o.position,s,r.updateContext.gameState.mapDimensions.width,r.updateContext.gameState.mapDimensions.height);return o.direction=nt(u),o.acceleration=fS(o),V(o.position,s,l.gameState.mapDimensions.width,l.gameState.mapDimensions.height)<Hd?{nextState:ct,data:{...t,enteredAt:l.gameState.time,previousState:Ar}}:{nextState:Ar,data:t}}onExit(t){const{entity:r}=t;r.acceleration=0}}const yC=new SC,TC={id:Hs,update:(e,t)=>{const{entity:r,updateContext:o}=t;return r.activeAction!=="eating"?{nextState:ct,data:{...e,enteredAt:o.gameState.time,previousState:Hs}}:(r.food.length>0&&(!r.eatingCooldownTime||o.gameState.time>=r.eatingCooldownTime)&&r.hunger>tr&&(r.hunger=Math.max(0,r.hunger-tr),r.food.pop(),r.eatingCooldownTime=o.gameState.time+1,Ie(o,fe.Eat,r.position),(!r.lastEatingEffectTime||o.gameState.time-r.lastEatingEffectTime>2)&&(ke(o.gameState,ue.Eating,r.position,be,r.id),r.lastEatingEffectTime=o.gameState.time)),r.hunger<=0||r.food.length<=0?{nextState:ct,data:{...e,enteredAt:o.gameState.time,previousState:Hs}}:{nextState:Hs,data:e})},onEnter:(e,t)=>(e.entity.acceleration=0,e.entity.velocity={x:0,y:0},{...t,enteredAt:e.updateContext.gameState.time})};class AC{constructor(){Oe(this,"id",ha)}update(t,r){return r.entity.activeAction!=="gathering"?{nextState:"humanIdle",data:{...t,enteredAt:r.updateContext.gameState.time,previousState:this.id}}:{nextState:this.id,data:t}}}const IC=new AC,EC={id:Ys,update:(e,t)=>{const{entity:r}=t;return r.activeAction!=="depositing"?{nextState:ct,data:{...e,enteredAt:t.updateContext.gameState.time,previousState:Ys}}:{nextState:Ys,data:e}},onEnter:(e,t)=>{const{entity:r}=e;return r.activeAction="depositing",t},onExit:e=>{const{entity:t}=e;t.activeAction==="depositing"&&(t.activeAction="idle")}},wC={id:js,update:(e,t)=>{const{entity:r}=t;return r.activeAction!=="retrieving"?{nextState:ct,data:{...e,enteredAt:t.updateContext.gameState.time,previousState:js}}:{nextState:js,data:e}},onEnter:(e,t)=>{const{entity:r}=e;return r.activeAction="retrieving",t},onExit:e=>{const{entity:t}=e;t.activeAction==="retrieving"&&(t.activeAction="idle")}},_C=(e,t)=>(t.procreationEndTime=e.updateContext.gameState.time+(t.duration||2),t),CC=(e,t)=>{const{entity:r,updateContext:o}=t,{gameState:l}=o;if(l.time<(e.procreationEndTime||0))return{nextState:sa,data:e};const s=l.entities.entities[e.partnerId];if(s&&s.type==="human"&&!s.isPregnant&&r.hunger<Fr&&s.hunger<Fr&&!r.procreationCooldown&&!s.procreationCooldown){const u=r.gender==="female"?r:s.gender==="female"?s:void 0,d=r.gender==="male"?r:s.gender==="male"?s:void 0;u&&d&&(u.isPregnant=!0,u.gestationTime=wE,u.pregnancyFatherId=d.id,r.procreationCooldown=Gm,s.procreationCooldown=Gm,Ie(o,fe.Procreate,u.position))}return r.activeAction="idle",s&&(s.activeAction="idle"),{nextState:ct,data:{...e,enteredAt:l.time,previousState:sa}}},RC={id:sa,onEnter:_C,update:CC},PC={id:nr,onEnter:(e,t)=>({...t,enteredAt:e.updateContext.gameState.time,attackStartTime:e.updateContext.gameState.time}),update:(e,t)=>{if(t.entity.activeAction!=="attacking"||!t.entity.attackTargetId)return t.entity.activeAction="idle",{nextState:ct,data:{...e}};const r=t.updateContext.gameState.entities.entities[t.entity.attackTargetId];if(!r)return t.entity.activeAction="idle",{nextState:ct,data:{...e}};const o=V(t.entity.position,r.position,t.updateContext.gameState.mapDimensions.width,t.updateContext.gameState.mapDimensions.height),l=ze(t.entity.position,r.position,t.updateContext.gameState.mapDimensions.width,t.updateContext.gameState.mapDimensions.height);return t.entity.direction=nt(l),o>Qn?t.entity.acceleration=fS(t.entity):t.entity.acceleration=0,{nextState:nr,data:e}}},NC={id:eu,update:(e,t)=>{const{entity:r,updateContext:o}=t,{gameState:l}=o;if(l.time-e.enteredAt>=vI){if(r.food.filter(d=>d.type===Fn.Berry).length>=Or){for(let f=0;f<Or;f++){const g=r.food.findIndex(m=>m.type===Fn.Berry);g>-1&&r.food.splice(g,1)}const d=pa(l.entities,e.plantingSpot,l.time);d.ownerId=r.id,d.claimedUntil=l.time+Tv}return{nextState:ct,data:{...e,enteredAt:l.time,previousState:eu}}}return{nextState:eu,data:e}},onEnter:(e,t)=>(e.entity.acceleration=0,e.entity.velocity={x:0,y:0},{...t,enteredAt:e.updateContext.gameState.time})},DC=[vC,yC,TC,IC,EC,wC,RC,PC,NC],Dn="preyIdle",ji="preyMoving",bs="preyGrazing",Gs="preyProcreating",kC={id:Dn,update:(e,t)=>{const{entity:r,updateContext:o}=t;return r.activeAction==="moving"?{nextState:ji,data:{...e,enteredAt:o.gameState.time,previousState:Dn,target:r.target}}:r.activeAction==="grazing"?{nextState:bs,data:{...e,enteredAt:o.gameState.time,previousState:Dn}}:r.activeAction==="procreating"?{nextState:Gs,data:{...e,enteredAt:o.gameState.time,previousState:Dn}}:{nextState:Dn,data:e}},onEnter:(e,t)=>(e.entity.acceleration=0,e.entity.velocity={x:0,y:0},{...t,enteredAt:e.updateContext.gameState.time})},hS=12,OC=120,m0=50,MC=12,gS=30,FC=2,Wt=50,UC=100,Vs=2,bd=3,BC=.9,LC=1,HC=50,bC=.5,pS=20,GC=140,v0=40,xC=12,mS=40,$C=3,Qi=60,kn=40,vo=50,S0=320,vS=25,zC=60,SS=2,WC=90,YC=.7,jC=1,Xs=3,Gd=15,gh=80,yS=10,Cu=80,Go=40,TS=2,cu=30,To=20,Cr=40,Ao=24,Rr=48,Io=12,Pr=40,Eo=20,Nr=60,wo=.75,Xi=2.5,_o=.25,Ki=2;function VC(e){let t=MC;return e.isAdult||(t*=.7),e.hunger>=HC&&(t*=bC),e.movementSlowdown&&(t*=e.movementSlowdown.modifier),t}function XC(e,t){const r=e>>16&255,o=e>>8&255,l=e&255,s=t>>16&255,u=t>>8&255,d=t&255;let f=Math.floor((r+s)/2),g=Math.floor((o+u)/2),m=Math.floor((l+d)/2);return Math.random()<.05&&(f=Math.max(0,Math.min(255,f+(Math.random()-.5)*60))),Math.random()<.05&&(g=Math.max(0,Math.min(255,g+(Math.random()-.5)*60))),Math.random()<.05&&(m=Math.max(0,Math.min(255,m+(Math.random()-.5)*60))),f<<16|g<<8|m}function aa(){const e=Math.floor(Math.random()*100)+100,t=Math.floor(Math.random()*80)+60,r=Math.floor(Math.random()*60)+20;return e<<16|t<<8|r}const xd=10;class KC{constructor(){Oe(this,"id",ji)}update(t,r){var f;const{entity:o,updateContext:l}=r;if(o.activeAction!=="moving")return{nextState:Dn,data:{...t,enteredAt:l.gameState.time,previousState:ji}};let s;if(typeof o.target=="object"?s=o.target:typeof o.target=="number"&&(s=(f=r.updateContext.gameState.entities.entities[o.target])==null?void 0:f.position),!s&&(o.direction.x!==0||o.direction.y!==0)&&(s={x:o.position.x+o.direction.x*xd*2,y:o.position.y+o.direction.y*xd*2}),!s)return{nextState:Dn,data:{...t,enteredAt:l.gameState.time,previousState:ji}};const u=ze(o.position,s,r.updateContext.gameState.mapDimensions.width,r.updateContext.gameState.mapDimensions.height);return o.direction=nt(u),o.acceleration=VC(o),V(o.position,s,l.gameState.mapDimensions.width,l.gameState.mapDimensions.height)<xd?{nextState:Dn,data:{...t,enteredAt:l.gameState.time,previousState:ji}}:{nextState:ji,data:t}}onExit(t){const{entity:r}=t;r.acceleration=0}onEnter(t,r){return{...r,enteredAt:t.updateContext.gameState.time}}}const ZC=new KC,qC={id:bs,update:(e,t)=>{const{entity:r,updateContext:o}=t;return r.activeAction==="moving"?{nextState:ji,data:{...e,enteredAt:o.gameState.time,previousState:bs,target:r.target}}:r.activeAction!=="grazing"?{nextState:Dn,data:{...e,enteredAt:o.gameState.time,previousState:bs}}:{nextState:bs,data:e}},onEnter:(e,t)=>(e.entity.acceleration=0,e.entity.velocity={x:0,y:0},{...t,enteredAt:e.updateContext.gameState.time})},QC={id:Gs,update:(e,t)=>{const{entity:r,updateContext:o}=t;return r.activeAction==="moving"?{nextState:ji,data:{...e,enteredAt:o.gameState.time,previousState:Gs,target:r.target}}:r.activeAction!=="procreating"?{nextState:Dn,data:{...e,enteredAt:o.gameState.time,previousState:Gs}}:{nextState:Gs,data:e}},onEnter:(e,t)=>(e.entity.acceleration=0,e.entity.velocity={x:0,y:0},{...t,enteredAt:e.updateContext.gameState.time})},JC=[kC,ZC,qC,QC],zt="predatorIdle",zi="predatorMoving",di="predatorAttacking",So="predatorProcreating",Dr="predatorEating",e1={id:zt,update:(e,t)=>{const{entity:r,updateContext:o}=t;return r.activeAction==="eating"?{nextState:Dr,data:{...e,enteredAt:o.gameState.time,previousState:zt,preyId:r.attackTargetId,eatingStartTime:o.gameState.time}}:r.activeAction==="attacking"&&r.attackTargetId?{nextState:di,data:{...e,enteredAt:o.gameState.time,previousState:zt,attackTargetId:r.attackTargetId,attackStartTime:o.gameState.time}}:r.activeAction==="moving"?{nextState:zi,data:{...e,enteredAt:o.gameState.time,previousState:zt,target:r.target}}:r.activeAction==="procreating"?{nextState:So,data:{...e,enteredAt:o.gameState.time,previousState:zt}}:{nextState:zt,data:e}},onEnter:(e,t)=>(e.entity.acceleration=0,e.entity.velocity={x:0,y:0},{...t,enteredAt:e.updateContext.gameState.time})};function AS(e){let t=xC;return e.hunger>=WC&&(t*=YC),e.isAdult||(t*=.7),e.movementSlowdown&&(t*=e.movementSlowdown.modifier),t}function t1(e,t){const r=e>>16&255,o=e>>8&255,l=e&255,s=t>>16&255,u=t>>8&255,d=t&255;let f=Math.floor((r+s)/2),g=Math.floor((o+u)/2),m=Math.floor((l+d)/2);return Math.random()<.05&&(f=Math.max(0,Math.min(255,f+(Math.random()-.5)*60))),Math.random()<.05&&(g=Math.max(0,Math.min(255,g+(Math.random()-.5)*60))),Math.random()<.05&&(m=Math.max(0,Math.min(255,m+(Math.random()-.5)*60))),f<<16|g<<8|m}function la(){const e=Math.floor(Math.random()*60)+60,t=Math.floor(Math.random()*50)+40,r=Math.floor(Math.random()*40)+20;return e<<16|t<<8|r}const $d=12;class n1{constructor(){Oe(this,"id",zi)}update(t,r){var f;const{entity:o,updateContext:l}=r;if(o.activeAction==="eating")return{nextState:Dr,data:{...t,enteredAt:l.gameState.time,previousState:zi,preyId:o.attackTargetId,eatingStartTime:l.gameState.time}};if(o.activeAction==="attacking"&&o.attackTargetId)return{nextState:di,data:{...t,enteredAt:l.gameState.time,previousState:zi,attackTargetId:o.attackTargetId,attackStartTime:l.gameState.time}};if(o.activeAction!=="moving")return{nextState:zt,data:{...t,enteredAt:l.gameState.time,previousState:zi}};let s;if(typeof o.target=="object"?s=o.target:typeof o.target=="number"&&(s=(f=r.updateContext.gameState.entities.entities[o.target])==null?void 0:f.position),!s&&(o.direction.x!==0||o.direction.y!==0)&&(s={x:o.position.x+o.direction.x*$d*2,y:o.position.y+o.direction.y*$d*2}),!s)return{nextState:zt,data:{...t,enteredAt:l.gameState.time,previousState:zi}};const u=ze(o.position,s,r.updateContext.gameState.mapDimensions.width,r.updateContext.gameState.mapDimensions.height);return o.direction=nt(u),o.acceleration=AS(o),V(o.position,s,l.gameState.mapDimensions.width,l.gameState.mapDimensions.height)<$d?{nextState:zt,data:{...t,enteredAt:l.gameState.time,previousState:zi}}:{nextState:zi,data:t}}onExit(t){const{entity:r}=t;r.acceleration=0}onEnter(t,r){return{...r,enteredAt:t.updateContext.gameState.time}}}const i1=new n1,r1={id:di,update:(e,t)=>{const{entity:r,updateContext:o}=t;if(r.activeAction==="eating")return{nextState:Dr,data:{...e,enteredAt:o.gameState.time,previousState:di,preyId:r.attackTargetId,eatingStartTime:o.gameState.time}};if(r.activeAction!=="attacking"||!r.attackTargetId)return r.activeAction="idle",{nextState:zt,data:{...e,enteredAt:o.gameState.time,previousState:di}};const l=o.gameState.entities.entities[r.attackTargetId];if(!l)return r.activeAction="idle",{nextState:zt,data:{...e,enteredAt:o.gameState.time,previousState:di}};if(l.type==="prey"&&l.hitpoints<=0||l.type==="predator"&&l.hitpoints<=0||l.type==="human"&&l.hitpoints<=0)return r.activeAction="idle",{nextState:zt,data:{...e,enteredAt:o.gameState.time,previousState:di}};const u=V(r.position,l.position,o.gameState.mapDimensions.width,o.gameState.mapDimensions.height),d=ze(r.position,l.position,o.gameState.mapDimensions.width,o.gameState.mapDimensions.height);return r.direction=nt(d),u>kn?r.acceleration=AS(r):r.acceleration=0,{nextState:di,data:e}},onEnter:(e,t)=>({...t,enteredAt:e.updateContext.gameState.time})},o1={id:So,update:(e,t)=>{const{entity:r,updateContext:o}=t;return r.activeAction==="eating"?{nextState:Dr,data:{...e,enteredAt:o.gameState.time,previousState:So,preyId:r.attackTargetId,eatingStartTime:o.gameState.time}}:r.activeAction==="attacking"&&r.attackTargetId?{nextState:di,data:{...e,enteredAt:o.gameState.time,previousState:So,attackTargetId:r.attackTargetId,attackStartTime:o.gameState.time}}:r.activeAction!=="procreating"?{nextState:zt,data:{...e,enteredAt:o.gameState.time,previousState:So}}:{nextState:So,data:e}},onEnter:(e,t)=>(e.entity.acceleration=0,e.entity.velocity={x:0,y:0},{...t,enteredAt:e.updateContext.gameState.time})},s1={id:Dr,update:(e,t)=>{const{entity:r,updateContext:o}=t;return r.activeAction!=="eating"?{nextState:zt,data:{...e,enteredAt:o.gameState.time,previousState:Dr}}:{nextState:Dr,data:e}},onEnter:(e,t)=>(e.entity.acceleration=0,e.entity.velocity={x:0,y:0},{...t,enteredAt:e.updateContext.gameState.time})},a1=[e1,i1,r1,o1,s1],y0=[...mC,...DC,...JC,...a1];function l1(e,t,r){const o=aI(e,y0);if(!o)return uI(e),[e,t];const{nextState:l,data:s}=o.update(t,r);return lI(e,l)?[l,sI(o,l,s,r,y0)]:[l,s]}function u1(e,t,r){const{gameState:o}=t,l=r*(At/It);if(e.isAdult=e.age>=Xf,e.isCallingToAttack&&e.callToAttackEndTime&&o.time>e.callToAttackEndTime&&(e.isCallingToAttack=!1,e.callToAttackEndTime=void 0),e.isCallingToFollow&&e.callToFollowEndTime&&o.time>e.callToFollowEndTime&&(e.isCallingToFollow=!1,e.callToFollowEndTime=void 0),e.movementSlowdown&&o.time>e.movementSlowdown.endTime&&(e.movementSlowdown=void 0),e.hitpoints<e.maxHitpoints){const u=1-e.hunger/100*UE,d=FE*u*l;e.hitpoints=Math.min(e.maxHitpoints,e.hitpoints+d)}if(e.hunger+=r*(Ps/(At/It)),e.hunger>SI&&(!e.lastHungerEffectTime||o.time-e.lastHungerEffectTime>wr*2)&&(ke(o,ue.Hunger,e.position,wr,e.id),e.lastHungerEffectTime=o.time),e.age+=r/Au,e.isPlayer){const u=Lt(o,e).filter(d=>d.hunger>=E_);if(u.length>0){const d=u.map(f=>f.id);Nf(o,{identifier:"children_starving",type:ia.ChildrenStarving,message:"Your children are starving!",duration:A_,targetEntityIds:d,highlightedEntityIds:d})}}if(e.gender==="female"&&e.isPregnant&&e.gestationTime&&(e.gestationTime-=l,e.hunger+=r*((Ps*_E-Ps)/(At/It)),(!e.lastPregnantEffectTime||o.time-e.lastPregnantEffectTime>wr*3)&&(ke(o,ue.Pregnant,e.position,wr,e.id),e.lastPregnantEffectTime=o.time),e.gestationTime<=0&&(CR(e,e.pregnancyFatherId,t),e.isPregnant=!1,e.gestationTime=0,e.pregnancyFatherId=void 0)),e.procreationCooldown&&(e.procreationCooldown-=l,e.procreationCooldown<0&&(e.procreationCooldown=0)),e.attackCooldown&&(e.attackCooldown-=l,e.attackCooldown<0&&(e.attackCooldown=0)),e.feedParentCooldownTime&&(e.feedParentCooldownTime-=l,e.feedParentCooldownTime<0&&(e.feedParentCooldownTime=0)),e.feedChildCooldownTime&&(e.feedChildCooldownTime-=l,e.feedChildCooldownTime<0&&(e.feedChildCooldownTime=0)),e.leaderMetaStrategyCooldown&&(e.leaderMetaStrategyCooldown-=l,e.leaderMetaStrategyCooldown<0&&(e.leaderMetaStrategyCooldown=0)),e.isAdult?e.radius===Ho&&(e.radius=wt):e.hunger+=r*((Ps*CE-Ps)/(At/It)),e.isAdult&&e.food.length>0&&(!e.feedParentCooldownTime||e.feedParentCooldownTime<=0)){const u=[];if(e.motherId){const d=o.entities.entities[e.motherId];d&&u.push(d)}if(e.fatherId){const d=o.entities.entities[e.fatherId];d&&u.push(d)}for(const d of u)if(d.age>=Nv&&d.hunger>=NE&&V(e.position,d.position,o.mapDimensions.width,o.mapDimensions.height)<=DE){e.food.pop(),d.hunger=Math.max(0,d.hunger-tr),e.feedParentCooldownTime=kE;break}}let s;if(e.hitpoints<=0?s="killed":e.hunger>=Mr?e.food.length>0&&e.isAdult?(e.food.pop(),e.hunger=Math.max(0,e.hunger-tr)):s="hunger":e.age>=e.maxAge&&(s="oldAge"),s){if(e.leaderId===e.id){const u=Si(Lt(o,e));u?(u.leaderId=u.id,u.tribeBadge=e.tribeBadge,u.diplomacy={...e.diplomacy},Object.values(o.entities.entities).forEach(d=>{if(d.type==="human"&&d.leaderId===e.id){const f=d;f.leaderId=u.id}if(d.type==="building"&&d.ownerId===e.id){const f=d;f.ownerId=u.id}})):Object.values(o.entities.entities).forEach(d=>{if(d.type==="human"&&d.leaderId===e.id){const f=d;f.leaderId=void 0,f.tribeBadge=void 0}if(d.type==="building"&&d.ownerId===e.id){const f=d;f.ownerId=void 0}})}if(e.isPlayer){const u=Si(Lt(o,e));u?(u.isPlayer=!0,o.generationCount++):(o.gameOver=!0,o.causeOfGameOver=s,Nf(o,{identifier:"no_heir",type:ia.NoHeir,message:"Your lineage has ended. You have no heir.",duration:0}))}ER(o.entities,e.position,e.gender,e.age,e.radius,e.id,o.time,e.food,e.hunger),$o(o.entities,e.id);return}e.animationProgress===void 0&&(e.animationProgress=0),e.animationSpeed===void 0&&(e.animationSpeed=1),e.animationProgress+=r*e.animationSpeed,e.animationProgress>=1&&(e.animationProgress=0)}function c1(e,t){const r=t.gameState.time-e.timeOfDeath;e.decayProgress=Math.min(1,r/OE);const o=Math.floor(Dv*(1-e.decayProgress));e.food.length>o&&e.food.splice(o),e.decayProgress>=1&&e.food.length<=0&&$o(t.gameState.entities,e.id)}function d1(e,t,r){const o=r*(At/It);e.age+=r/Au,e.isAdult=e.age>=Vs;let l=t.gameState.ecosystem.preyHungerIncreasePerHour*o;if(e.isPregnant&&(l*=1.2),e.hunger+=l,e.isPregnant&&e.gestationTime!==void 0&&(e.gestationTime-=o,e.gestationTime<=0)){const u={x:e.position.x+(Math.random()-.5)*40,y:e.position.y+(Math.random()-.5)*40};u.x=Math.max(20,Math.min(t.gameState.mapDimensions.width-20,u.x)),u.y=Math.max(20,Math.min(t.gameState.mapDimensions.height-20,u.y));const d=Math.random()<.5?"male":"female",f=e,g=e.fatherId?t.gameState.entities.entities[e.fatherId]:void 0;let m;if(g)m=XC(f.geneCode,g.geneCode);else{m=f.geneCode;const v=Math.floor((Math.random()-.5)*4096);m=Math.max(0,Math.min(16777215,m+v))}Fo(t.gameState.entities,u,d,0,gS*.5,m,e.id,e.fatherId),ke(t.gameState,ue.Procreation,e.position,wr,e.id),Ie(t,fe.Birth,e.position),e.isPregnant=!1,e.gestationTime=0,e.procreationCooldown=t.gameState.ecosystem.preyProcreationCooldown,e.fatherId=void 0}e.procreationCooldown&&e.procreationCooldown>0&&(e.procreationCooldown-=o,e.procreationCooldown<0&&(e.procreationCooldown=0)),e.eatingCooldownTime&&e.eatingCooldownTime>t.gameState.time||(e.eatingCooldownTime=void 0),e.fleeCooldown&&e.fleeCooldown>0&&(e.fleeCooldown-=o,e.fleeCooldown<0&&(e.fleeCooldown=0)),e.feedChildCooldownTime&&e.feedChildCooldownTime>0&&(e.feedChildCooldownTime-=o,e.feedChildCooldownTime<0&&(e.feedChildCooldownTime=0));let s=!1;e.hunger>=OC&&(s=!0),e.hitpoints<=0&&(s=!0),e.age>=hS&&(s=!0),s&&(wR(t.gameState.entities,e.position,e.gender,e.age,e.radius,e.id,t.gameState.time,e.geneCode),$o(t.gameState.entities,e.id))}function f1(e,t,r){const o=r*(At/It);e.age+=r/Au,e.isAdult=e.age>=Xs;let l=t.gameState.ecosystem.predatorHungerIncreasePerHour*o;if(e.isPregnant&&(l*=1.3),e.hunger+=l,e.isPregnant&&e.gestationTime!==void 0&&(e.gestationTime-=o,e.gestationTime<=0)){const u={x:e.position.x+(Math.random()-.5)*50,y:e.position.y+(Math.random()-.5)*50};u.x=Math.max(25,Math.min(t.gameState.mapDimensions.width-25,u.x)),u.y=Math.max(25,Math.min(t.gameState.mapDimensions.height-25,u.y));const d=Math.random()<.5?"male":"female",f=e,g=e.pregnancyFatherId?t.gameState.entities.entities[e.pregnancyFatherId]:void 0;let m;if(g)m=t1(f.geneCode,g.geneCode);else{m=f.geneCode;const v=Math.floor((Math.random()-.5)*4096);m=Math.max(0,Math.min(16777215,m+v))}Uo(t.gameState.entities,u,d,0,mS*.6,m,e.id,e.pregnancyFatherId),ke(t.gameState,ue.Procreation,e.position,wr,e.id),Ie(t,fe.Birth,e.position),e.isPregnant=!1,e.gestationTime=0,e.procreationCooldown=t.gameState.ecosystem.predatorProcreationCooldown,e.pregnancyFatherId=void 0}e.procreationCooldown&&e.procreationCooldown>0&&(e.procreationCooldown-=o,e.procreationCooldown<0&&(e.procreationCooldown=0)),e.attackCooldown&&e.attackCooldown>0&&(e.attackCooldown-=o,e.attackCooldown<0&&(e.attackCooldown=0)),e.huntCooldown&&e.huntCooldown>0&&(e.huntCooldown-=o,e.huntCooldown<0&&(e.huntCooldown=0)),e.feedChildCooldownTime&&e.feedChildCooldownTime>0&&(e.feedChildCooldownTime-=o,e.feedChildCooldownTime<0&&(e.feedChildCooldownTime=0));let s=!1;e.hunger>=GC&&(s=!0),e.hitpoints<=0&&(s=!0),e.age>=pS&&(s=!0),s&&(_R(t.gameState.entities,e.position,e.gender,e.age,e.radius,e.id,t.gameState.time,e.geneCode),$o(t.gameState.entities,e.id))}var ga=(e=>(e[e.BehaviorTreeBased=0]="BehaviorTreeBased",e))(ga||{});function ph(e,t,r){if(e.aiBlackboard){const o=_.get(e.aiBlackboard,"lastAiUpdateTime")??0;t.gameState.time-o>=Js&&(r.execute(e,t,e.aiBlackboard),_.set(e.aiBlackboard,"lastAiUpdateTime",t.gameState.time))}else console.warn(`Behavior Tree AI ticked for human ${e.id}, but the tree or blackboard was missing.`),e.activeAction="idle"}const T0="Human Behavior",h1=1;class g1{constructor(){Oe(this,"nodeData",new Map);Oe(this,"pathStack",[]);Oe(this,"startTimeStack",[])}nodeStart(t){this.pathStack.push(t),this.startTimeStack.push(performance.now())}nodeEnd(){if(this.startTimeStack.length===0||this.pathStack.length===0){console.error("BTProfiler: nodeEnd() called without a matching nodeStart().");return}const t=performance.now(),r=this.startTimeStack.pop(),o=t-r,l=this.pathStack.join(" > "),s=this.nodeData.get(l)??{path:l,totalTime:0,callCount:0,minTime:1/0,maxTime:-1/0};s.totalTime+=o,s.callCount++,s.minTime=Math.min(s.minTime,o),s.maxTime=Math.max(s.maxTime,o),this.nodeData.set(l,s),this.pathStack.pop()}report(t={}){const{showAll:r=!1}=t,o=Array.from(this.nodeData.values());if(o.length===0){console.log("--- Behavior Tree Profiler: No data collected. ---");return}let l=o,s="--- Behavior Tree Full Report ---";if(!r){const d=this.nodeData.get(T0);if(d){const f=d.totalTime*h1/100;l=o.filter(g=>g.totalTime>f&&g.path!==T0),s="--- Behavior Tree Problem Report ---"}else console.log('BTProfiler: Root node "Human Behavior" not found. Showing full report.'),s="--- Behavior Tree Full Report (Root Not Found) ---"}const u=l.sort((d,f)=>f.totalTime-d.totalTime);console.log(s),u.length>0?console.table(u.map(d=>({Path:d.path,"Total Time (ms)":d.totalTime.toFixed(3),Calls:d.callCount,"Avg Time (ms)":(d.totalTime/d.callCount).toFixed(3),"Min Time (ms)":d.minTime.toFixed(3),"Max Time (ms)":d.maxTime.toFixed(3)}))):console.log("No significant performance problems detected."),console.log("------------------------------------")}reset(){this.nodeData.clear(),this.pathStack=[],this.startTimeStack=[]}}const ht=new g1;function Ln(e){return Array.isArray(e)?e:[e,""]}class pe extends Jn{constructor(r,o,l=0){super();Oe(this,"name");Oe(this,"depth");this.children=r,this.name=o,this.depth=l,this.children.forEach(s=>{s.depth=(this.depth??0)+1})}execute(r,o,l){this.name&&ht.nodeStart(this.name);try{for(const s of this.children){const[u,d]=Ln(s.execute(r,o,l));if(u!==T.SUCCESS)return this.setLastStatus(r,u),this.name&&_.recordNodeExecution(l,this.name,u,o.gameState.time,this.depth,d),u}return this.setLastStatus(r,T.SUCCESS),this.name&&_.recordNodeExecution(l,this.name,T.SUCCESS,o.gameState.time,this.depth,""),T.SUCCESS}finally{this.name&&ht.nodeEnd()}}}class Jt extends Jn{constructor(r,o,l=0){super();Oe(this,"name");Oe(this,"depth");this.children=r,this.name=o,this.depth=l,this.children.forEach(s=>{s.depth=(this.depth??0)+1})}execute(r,o,l){this.name&&ht.nodeStart(this.name);try{const s=this.getRunningChildIndex(r)??0;for(let u=s;u<this.children.length;u++){const d=this.children[u],[f,g]=Ln(d.execute(r,o,l));if(f!==T.FAILURE){if(f===T.SUCCESS)return this.setRunningChildIndex(r,void 0),this.setLastStatus(r,T.SUCCESS),this.name&&_.recordNodeExecution(l,this.name,T.SUCCESS,o.gameState.time,this.depth,g),T.SUCCESS;if(f===T.RUNNING)return this.setRunningChildIndex(r,u),this.setLastStatus(r,T.RUNNING),this.name&&_.recordNodeExecution(l,this.name,T.RUNNING,o.gameState.time,this.depth,g),T.RUNNING}}return this.setRunningChildIndex(r,void 0),this.setLastStatus(r,T.FAILURE),this.name&&_.recordNodeExecution(l,this.name,T.FAILURE,o.gameState.time,this.depth,""),T.FAILURE}finally{this.name&&ht.nodeEnd()}}}class ce extends Jn{constructor(r,o,l=0){super();Oe(this,"name");Oe(this,"depth");this.action=r,this.name=o,this.depth=l}execute(r,o,l){this.name&&ht.nodeStart(this.name);try{const[s,u]=Ln(this.action(r,o,l));return this.setLastStatus(r,s),this.name&&_.recordNodeExecution(l,this.name,s,o.gameState.time,this.depth,u),s}finally{this.name&&ht.nodeEnd()}}}class J extends Jn{constructor(r,o,l=0){super();Oe(this,"name");Oe(this,"depth");this.condition=r,this.name=o,this.depth=l}execute(r,o,l){this.name&&ht.nodeStart(this.name);try{const[s,u]=Ln(this.condition(r,o,l)),d=s?T.SUCCESS:T.FAILURE;return this.setLastStatus(r,d),this.name&&_.recordNodeExecution(l,this.name,d,o.gameState.time,this.depth,u),d}finally{this.name&&ht.nodeEnd()}}}class du extends Jn{constructor(r,o,l,s=0){super();Oe(this,"name");Oe(this,"depth");Oe(this,"startTimeKey");this.child=r,this.timeoutDurationHours=o,this.name=l,this.depth=s,this.child.depth=(this.depth??0)+1,this.startTimeKey=`timeout_${this.name}_startTime`}execute(r,o,l){ht.nodeStart(this.name);try{const s=o.gameState.time;let u=_.get(l,this.startTimeKey);const[d,f]=Ln(this.child.execute(r,o,l));if(d===T.RUNNING){u===void 0&&(_.set(l,this.startTimeKey,s),u=s);const g=s-u;if(g>this.timeoutDurationHours){_.delete(l,this.startTimeKey),this.setLastStatus(r,T.FAILURE);const v=`Timed out after ${g.toFixed(2)}h.`;return _.recordNodeExecution(l,this.name,this.getLastStatus(r),s,this.depth,v),this.getLastStatus(r)}this.setLastStatus(r,T.RUNNING);const m=`Running for ${g.toFixed(2)}h. ${f}`;return _.recordNodeExecution(l,this.name,this.getLastStatus(r),s,this.depth,m),this.getLastStatus(r)}return u!==void 0&&_.delete(l,this.startTimeKey),this.setLastStatus(r,d),_.recordNodeExecution(l,this.name,this.getLastStatus(r),s,this.depth,f),this.getLastStatus(r)}finally{ht.nodeEnd()}}}class ua extends Jn{constructor(r,o,l,s=0,u){super();Oe(this,"name");Oe(this,"depth");Oe(this,"statusKey");Oe(this,"timestampKey");this.child=r,this.cacheDurationHours=o,this.validityCheck=u,this.name=l,this.depth=s,this.child.depth=(this.depth??0)+1,this.statusKey=`caching_${this.name}_status`,this.timestampKey=`caching_${this.name}_timestamp`}execute(r,o,l){ht.nodeStart(this.name);try{const s=o.gameState.time,u=_.get(l,this.statusKey),d=_.get(l,this.timestampKey);if(u!==void 0&&d!==void 0){const v=s-d>this.cacheDurationHours,y=this.validityCheck?this.validityCheck(r,o,l):!0;if(!v&&y){const w=(d+this.cacheDurationHours-s).toFixed(2),I=`Cache hit. Status: ${T[u]}. ${w}h left.`;return this.setLastStatus(r,u),_.recordNodeExecution(l,this.name,this.getLastStatus(r),s,this.depth,I),this.getLastStatus(r)}}const[f,g]=Ln(this.child.execute(r,o,l));(f===T.SUCCESS||f===T.FAILURE)&&(_.set(l,this.statusKey,f),_.set(l,this.timestampKey,s)),this.setLastStatus(r,f);const m=`Cache miss. Child returned ${T[f]}. ${g}`;return _.recordNodeExecution(l,this.name,this.getLastStatus(r),s,this.depth,m),this.getLastStatus(r)}finally{ht.nodeEnd()}}}class Hr extends Jn{constructor(r,o,l,s=0){super();Oe(this,"name");Oe(this,"depth");Oe(this,"cooldownKey");this.cooldownDurationHours=r,this.child=o,this.name=l,this.depth=s,this.child.depth=(this.depth??0)+1,this.cooldownKey=`cooldown_${this.name}`}execute(r,o,l){ht.nodeStart(this.name);try{const s=o.gameState.time,u=_.get(l,this.cooldownKey);if(this.child.getLastStatus(r)===T.RUNNING){const[g,m]=Ln(this.child.execute(r,o,l));if(this.setLastStatus(r,g),this.name){const v=`Continuing running child. ${m}`;_.recordNodeExecution(l,this.name,this.getLastStatus(r),s,this.depth,v)}return this.getLastStatus(r)}if(u!==void 0&&s<u){const m=`Cooldown active, ${(u-s).toFixed(2)}h left`;return this.setLastStatus(r,T.FAILURE),this.name&&_.recordNodeExecution(l,this.name,this.getLastStatus(r),s,this.depth,m),this.getLastStatus(r)}const[d,f]=Ln(this.child.execute(r,o,l));return d===T.SUCCESS&&_.set(l,this.cooldownKey,s+this.cooldownDurationHours),this.setLastStatus(r,d),this.name&&_.recordNodeExecution(l,this.name,this.getLastStatus(r),s,this.depth,f),this.getLastStatus(r)}finally{ht.nodeEnd()}}}class Qt extends Jn{constructor(r,o,l,s=0){super();Oe(this,"name");Oe(this,"depth");this.child=r,this.behaviorKey=o,this.name=l,this.depth=s;const u=(d,f)=>{d.depth=f,d.children?d.children.forEach(g=>u(g,f+1)):d.child&&u(d.child,f+1)};u(this.child,(this.depth??0)+1)}execute(r,o,l){this.name&&ht.nodeStart(this.name);try{if(r.isPlayer&&!o.gameState.autopilotControls.behaviors[this.behaviorKey]){const f=`Player autopilot for '${this.behaviorKey}' is disabled.`;return this.setLastStatus(r,T.FAILURE),this.name&&_.recordNodeExecution(l,this.name,this.getLastStatus(r),o.gameState.time,this.depth,f),this.getLastStatus(r)}const[u,d]=Ln(this.child.execute(r,o,l));return this.setLastStatus(r,u),this.name&&_.recordNodeExecution(l,this.name,this.getLastStatus(r),o.gameState.time,this.depth,d),this.getLastStatus(r)}finally{this.name&&ht.nodeEnd()}}}class p1 extends Jn{constructor(r,o,l=0){super();Oe(this,"name");Oe(this,"depth");this.child=r,this.name=o,this.depth=l;const s=(u,d)=>{u.depth=d,u.children?u.children.forEach(f=>s(f,d+1)):u.child&&s(u.child,d+1)};s(this.child,(this.depth??0)+1)}execute(r,o,l){this.name&&ht.nodeStart(this.name);try{if(r.isPlayer&&o.gameState.autopilotControls.isManuallyMoving)return this.setLastStatus(r,T.FAILURE),this.name&&_.recordNodeExecution(l,this.name,this.getLastStatus(r),o.gameState.time,this.depth,"Manual movement active, AI blocked."),this.getLastStatus(r);const[s,u]=Ln(this.child.execute(r,o,l));return this.setLastStatus(r,s),this.name&&_.recordNodeExecution(l,this.name,this.getLastStatus(r),o.gameState.time,this.depth,u),this.getLastStatus(r)}finally{this.name&&ht.nodeEnd()}}}class Os extends Jn{constructor(r,o,l=0){super();Oe(this,"name");Oe(this,"depth");this.child=r,this.name=o,this.depth=l;const s=(u,d)=>{u.depth=d,u.children?u.children.forEach(f=>s(f,d+1)):u.child&&s(u.child,d+1)};s(this.child,(this.depth??0)+1)}execute(r,o,l){this.name&&ht.nodeStart(this.name);try{if(r.isPlayer)return this.setLastStatus(r,T.FAILURE),this.name&&_.recordNodeExecution(l,this.name,this.getLastStatus(r),o.gameState.time,this.depth,"Player controlled, AI blocked."),this.getLastStatus(r);const[s,u]=Ln(this.child.execute(r,o,l));return this.setLastStatus(r,s),this.name&&_.recordNodeExecution(l,this.name,this.getLastStatus(r),o.gameState.time,this.depth,u),this.getLastStatus(r)}finally{this.name&&ht.nodeEnd()}}}function m1(e){return new pe([new J((t,r)=>{const o=t.hunger>=yf,l=t.food.length>0,s=!t.eatingCooldownTime||r.gameState.time>=t.eatingCooldownTime;return[!!(o&&l&&s),`${Math.floor(t.hunger-yf)}, ${t.food.length}, ${t.eatingCooldownTime?Math.floor(t.eatingCooldownTime-r.gameState.time):""}`]},"Can Eat",e+1),new ce(t=>(t.direction={x:0,y:0},t.target=void 0,t.activeAction="eating",T.RUNNING),"Eat",e+1)],"Eating",e)}function v1(e){return new pe([new J((t,r,o)=>{if(t.isAdult&&t.hitpoints>t.maxHitpoints*Ev||!(t.hitpoints<t.maxHitpoints*.1)&&t.isAdult&&t.hunger>DI)return!1;const s=l_(t.id,r.gameState);return s?(_.set(o,"fleeThreat",s.id),!0):!1},"Should Flee",e+1),new ce((t,r,o)=>{const l=_.get(o,"fleeThreat"),s=l&&r.gameState.entities.entities[l];if(!s)return T.FAILURE;t.activeAction="moving";const u=ze(s.position,t.position,r.gameState.mapDimensions.width,r.gameState.mapDimensions.height),d=nt(u),f=Mn(t.position,Nt(d,wv));return t.target={x:(f.x%r.gameState.mapDimensions.width+r.gameState.mapDimensions.width)%r.gameState.mapDimensions.width,y:(f.y%r.gameState.mapDimensions.height+r.gameState.mapDimensions.height)%r.gameState.mapDimensions.height},t.direction=d,T.RUNNING},"Execute Flee",e+1)],"Flee",e)}const IS=100,S1=25;function A0(e){const t=Math.sin(e)*1e4;return t-Math.floor(t)}function y1(e,t,r=IS){return t.search.building.byRadius(e.position,r).some(s=>{const u=s;return u.buildingType==="storageSpot"&&u.ownerId===e.leaderId&&u.isConstructed&&u.storedFood&&u.storageCapacity&&u.storedFood.length<u.storageCapacity})}function I0(e,t,r=IS){return t.search.building.byRadius(e.position,r).filter(s=>{const u=s;return u.buildingType==="storageSpot"&&u.ownerId===e.leaderId&&u.isConstructed&&u.storedFood&&u.storedFood.length>0})}function E0(e,t,r){if(t.length===0)return null;let o=null,l=1/0;for(const s of t){const u=V(e.position,s.position,r.mapDimensions.width,r.mapDimensions.height);u<l&&(l=u,o=s)}return o?{storage:o,distance:l}:null}function ES(e){const t=e.storedFood?e.storedFood.length:0,r=A0(t+e.id)*2*Math.PI,o=A0(t+e.id+1)*S1;return{x:Math.cos(r)*o,y:Math.sin(r)*o}}const Ms="foodSource";function T1(e){const t=new ce((o,l,s)=>{const u=st(o,l.gameState),d=new Map,f=De(o,l.gameState,"berryBush",Hm,v=>{if(v.food.length===0||u&&n0(u,v.id,l.gameState.time)&&i0(u,v.id)!==o.id)return!1;if(!v.ownerId||!v.claimedUntil||l.gameState.time>=v.claimedUntil)return!0;const y=l.gameState.entities.entities[v.ownerId];if(!y||y.leaderId===o.leaderId)return!0;const w=d.get(y.id)??V(o.position,y.position,l.gameState.mapDimensions.width,l.gameState.mapDimensions.height);return d.set(y.id,w),w>iE}),g=De(o,l.gameState,"corpse",Hm,v=>!(v.food.length===0||u&&n0(u,v.id,l.gameState.time)&&i0(u,v.id)!==o.id));let m=null;if(f&&g){const v=V(o.position,f.position,l.gameState.mapDimensions.width,l.gameState.mapDimensions.height),y=V(o.position,g.position,l.gameState.mapDimensions.width,l.gameState.mapDimensions.height);m=v<=y?f:g}else m=f||g;return m?(u&&Jw(u,m.id,o.id,l.gameState.time),_.set(s,Ms,m.id),[T.SUCCESS,`Found food: ${m.type} at ${m.position.x.toFixed(0)},${m.position.y.toFixed(0)}`]):[T.FAILURE,"No food source found"]},"Find Closest Food Source",e+4),r=new ce((o,l,s)=>{const u=_.get(s,Ms);if(!u)return[T.FAILURE,"No target in blackboard"];const d=l.gameState.entities.entities[u];if(!d||d.food.length===0){const g=st(o,l.gameState);return g&&d&&r0(g,d.id),_.delete(s,Ms),[T.FAILURE,"Food source is invalid or depleted"]}if(V(o.position,d.position,l.gameState.mapDimensions.width,l.gameState.mapDimensions.height)<Ur){o.activeAction="gathering",o.direction={x:0,y:0},o.target=d.id;const g=st(o,l.gameState);return g&&r0(g,d.id),_.delete(s,Ms),[T.SUCCESS,`Gathering from ${d.type}`]}else return o.activeAction="moving",o.target=d.id,o.direction=Ut(o.position,d.position,l.gameState.mapDimensions),[T.RUNNING,`Moving to ${d.type}`]},"Move To Food and Gather",e+3);return new pe([new J((o,l)=>{const s=o.food.length<o.maxFood,u=o.hunger>AI,d=Lt(l.gameState,o).filter(g=>g.hunger>Kf),f=y1(o,l.gameState);return[(o.isAdult&&s&&(u||d.length>0||f))??!1,`${u?"H":""}${d.length>0?" HC("+d.length+")":""}${f?" S":""}`]},"Should Gather Food",e+1),new Jt([new pe([new J((o,l,s)=>_.has(s,Ms),"Has Food Source?",e+2),r],"Continue Gathering Action",e+2),new pe([new ua(t,bI,"Cache Food Source Search",e+3),r],"Find New Food Source and Gather",e+2)],"Perform or Start Gathering",e+1)],"Gather Food",e)}function A1(e){return new ce((t,r,o)=>(t.activeAction="idle",t.direction={x:0,y:0},t.target=void 0,_.set(o,"wanderTarget",void 0),T.SUCCESS),"Idle",e)}const Ul="procreationWanderStartTime",w0=(e,t,r)=>t.find(o=>Lr(e,o,r));function I1(e){const t=new J((s,u,d)=>{const f=s0(s,u.gameState,Ur),g=w0(s,f,u.gameState);return g?(_.set(d,"procreationPartner",g.id),!0):!1},"Find Immediate Partner"),r=new ce((s,u,d)=>{var m;const f=_.get(d,"procreationPartner"),g=f&&u.gameState.entities.entities[f];return g?(s.activeAction="procreating",s.target=void 0,_.delete(d,"procreationPartner"),_.delete(d,Ul),(m=s.partnerIds)!=null&&m.includes(g.id)||(s.partnerIds=s.partnerIds?[...s.partnerIds,g.id]:[g.id]),T.SUCCESS):T.FAILURE},"Start Procreating"),o=new J((s,u,d)=>{const f=s0(s,u.gameState,NI),g=w0(s,f,u.gameState);return g?(_.set(d,"procreationPartner",g.id),!0):!1},"Locate Distant Partner"),l=new ce((s,u,d)=>{const f=_.get(d,"procreationPartner"),g=f&&u.gameState.entities.entities[f];if(!g)return T.FAILURE;if(V(s.position,g.position,u.gameState.mapDimensions.width,u.gameState.mapDimensions.height)<Ur)return T.SUCCESS;s.activeAction="moving",s.target=g.id;const v=ze(s.position,g.position,u.gameState.mapDimensions.width,u.gameState.mapDimensions.height);return s.direction=nt(v),T.RUNNING},"Move Towards Partner");return new pe([new J(s=>!(!s.isAdult||s.gender==="female"&&s.isPregnant||s.age<IE||s.gender==="female"&&s.age>Pv),"Is Fertile (age, not pregnant)",e+1),new J(s=>s.hunger<Fr,"Is Healthy (hunger)",e+1),new J(s=>(s.procreationCooldown||0)<=0,"Is Ready (cooldown)",e+1),new Jt([new pe([new J((s,u)=>a0(s.position,u.gameState,"berryBush",Bm)>=PI,"Is Environment Viable (food)",e+3),new ce((s,u,d)=>(_.delete(d,Ul),T.SUCCESS),"Clear Wander Timer",e+3)],"Sufficient Food Path",e+2),new pe([new J((s,u)=>{if(s.gender==="male"){const d=Lt(u.gameState,s);return!Si(d)}return!1},"Is Male Without Heir",e+3),new ce((s,u,d)=>{const f=_.get(d,Ul);if(f===void 0)return _.set(d,Ul,u.gameState.time),[T.FAILURE,"Starting heirless wander timer"];const g=u.gameState.time-f;return g>=EE?a0(s.position,u.gameState,"berryBush",Bm)>=1?[T.SUCCESS,`Wandered for ${g.toFixed(1)}h, minimum food found`]:[T.FAILURE,"Desperate but no food sources nearby"]:[T.FAILURE,`Wandering for heir, ${g.toFixed(1)}h elapsed`]},"Check Wander Timer",e+3)],"Heirless Desperation Path",e+2)],"Check Environment Or Desperation",e+1),new J((s,u,d)=>{var g;const f=_.get(d,"procreationPartner");return f&&((g=f.partnerIds)!=null&&g.length)&&!f.partnerIds.includes(s.id)&&f.partnerIds.map(m=>u.gameState.entities.entities[m]).filter(m=>!!m).some(m=>V(s.position,m.position,u.gameState.mapDimensions.width,u.gameState.mapDimensions.height)<nE)?[!1,"Partner's primary partner is too close"]:!0},"Is Partner's Primary Partner Nearby",e+1),new Jt([new pe([t,r],"Procreate With Immediate Partner",e+2),new Hr(BI,new pe([o,l],"Seek Distant Partner Action",e+3),"Seek Distant Partner Cooldown",e+2)],"Find Partner And Procreate",e+1)],"Procreate",e)}const fo="attackTarget",Tr="homeCenter",zd=150;function E1(e){return new pe([new J((t,r,o)=>{if(!t.isAdult)return[!1,"Not an adult"];const{gameState:l}=r;if(t.activeAction==="attacking"&&t.attackTargetId){const u=l.entities.entities[t.attackTargetId];if(u&&u.hitpoints>0&&V(t.position,u.position,l.mapDimensions.width,l.mapDimensions.height)<=zd){if(_.set(o,fo,u.id),!_.get(o,Tr)){const d=t.leaderId?Br(t.leaderId,l):lu(t,l).length>0?l0(t,l):t.position;_.set(o,Tr,d)}return!0}}const s=De(t,l,"human",zd,u=>u.hitpoints>0&&bo(t,u,l));if(s){_.set(o,fo,s.id);const u=t.leaderId?Br(t.leaderId,l):lu(t,l).length>0?l0(t,l):t.position;return _.set(o,Tr,u),!0}return _.set(o,fo,void 0),_.set(o,Tr,void 0),!1},"Find Attack Target",e+1),new ce((t,r,o)=>{const l=_.get(o,fo),s=l&&r.gameState.entities.entities[l],u=_.get(o,Tr);if(!s||!u)return T.FAILURE;const{gameState:d}=r;return V(t.position,u,d.mapDimensions.width,d.mapDimensions.height)>Iv?(t.activeAction="idle",t.attackTargetId=void 0,_.set(o,fo,void 0),_.set(o,Tr,void 0),T.FAILURE):s.hitpoints<=0||V(t.position,s.position,d.mapDimensions.width,d.mapDimensions.height)>zd?(t.activeAction==="attacking"&&(t.activeAction="idle",t.attackTargetId=void 0),_.set(o,fo,void 0),_.set(o,Tr,void 0),T.SUCCESS):(t.activeAction==="attacking"&&t.attackTargetId===s.id||(t.activeAction="attacking",t.attackTargetId=s.id),T.RUNNING)},"Execute Attack",e+1)],"Attack",e)}const w1=(e,t,r)=>{const o=Lt(t.gameState,e).filter(u=>!u.isAdult);if(o.length===0)return T.FAILURE;let l=null,s=Kf;for(const u of o)u.hunger>=s&&(s=u.hunger,l=u);return l?(_.set(r,"targetChild",l.id),T.SUCCESS):T.FAILURE},_1=(e,t,r)=>{const o=_.get(r,"targetChild"),l=o&&t.gameState.entities.entities[o];return l?V(e.position,l.position,t.gameState.mapDimensions.width,t.gameState.mapDimensions.height)>Zf?(e.activeAction="moving",e.target=l.id,e.direction=Ut(e.position,l.position,t.gameState.mapDimensions),T.RUNNING):(e.activeAction="feeding",e.target=void 0,_.set(r,"targetChild",void 0),T.SUCCESS):T.FAILURE};function C1(e){return new pe([new J(t=>(t.isAdult&&t.food.length>0&&(!t.feedChildCooldownTime||t.feedChildCooldownTime<=0))??!1,"Can Feed Child",e+1),new ce(w1,"Find Hungriest Child",e+1),new ce(_1,"Move To Child and Feed",e+1)],"Feed Child",e)}function R1(e){return new pe([new J(t=>!t.isAdult&&t.hunger>=Kf,"Is Hungry Child",e+1),new ce((t,r,o)=>{const l=r_(t,r.gameState);if(l.length===0)return T.FAILURE;const s=De(t,r.gameState,"human",PE,u=>l.some(d=>d.id===u.id)&&u.food.length>0);return s?(_.set(o,"targetParent",s.id),T.SUCCESS):T.FAILURE},"Find Parent With Food",e+1),new ce((t,r,o)=>{const l=_.get(o,"targetParent"),s=l&&r.gameState.entities.entities[l];if(!s)return T.FAILURE;const u=V(t.position,s.position,r.gameState.mapDimensions.width,r.gameState.mapDimensions.height);return t.activeAction="idle",u<=Zf?(t.target=void 0,T.SUCCESS):(t.target=s.id,t.activeAction="moving",T.RUNNING)},"Move To Parent",e+1)],"Seek Food From Parent",e)}const ho="plantingSpot",P1="assignedPlantingZone",N1=50;function D1(e,t,r,o){const l=ze(e,t,r,o);return Mn(e,l)}function k1(e){const t=new ce((o,l,s)=>{const u=_.get(s,ho),d=st(o,l.gameState);if(!u)return _.delete(s,ho),[T.FAILURE,"Planting spot is missing"];if(Bn(u,l.gameState,er,o.id))return d&&o0(d,u),_.delete(s,ho),[T.FAILURE,"Planting spot is occupied"];d&&e_(d,u,o.id,l.gameState.time);const f=D1(o.position,u,l.gameState.mapDimensions.width,l.gameState.mapDimensions.height),g=V(o.position,f,l.gameState.mapDimensions.width,l.gameState.mapDimensions.height);return g>Ur?(o.activeAction="moving",o.target=f,o.direction=Ut(o.position,f,l.gameState.mapDimensions),[T.RUNNING,"Moving to planting spot: "+g.toFixed(2)+" units away"]):Bn(u,l.gameState,er,o.id)?(d&&o0(d,u),_.delete(s,ho),[T.FAILURE,"Planting spot is now occupied"]):(o.activeAction="planting",o.target=u,[T.RUNNING,"Planting state initiated"])},"Move To Spot and Plant",e+3),r=new ce((o,l,s)=>{const u=st(o,l.gameState),d=cC(o,l.gameState);d&&_.set(s,P1,d.id);let f=fC(o,l.gameState);return f||(f=m_(o,l.gameState)),f?u&&t_(u,f,l.gameState.time,N1)?[T.FAILURE,"Spot already assigned to another tribe member"]:(_.set(s,ho,f),[T.SUCCESS,`Found new spot at ${f.x.toFixed(0)}, ${f.y.toFixed(0)}`]):[T.FAILURE,"No suitable planting spot found"]},"Find Optimal Planting Spot",e+3);return new pe([new J(o=>{const l=o.food.filter(d=>d.type===Fn.Berry).length>=Or,s=o.hunger<II,u=(o.isAdult&&l&&s)??!1;return[u,u?"Can plant":`Cannot plant: adult=${o.isAdult}, berries=${o.food.filter(d=>d.type===Fn.Berry).length}/${Or}, hunger=${o.hunger.toFixed(0)}`]},"Can Plant",e+1),new J((o,l)=>{if(!o.leaderId)return[!1,"No tribe"];const s=iC(o,l.gameState),u=aC(o.leaderId,l.gameState);let d;return s<oE?d=lE:s<sE?d=uE:s<aE?d=cE:d=dE,[u<d,`Food security: ${(s*100).toFixed(0)}%, Bush density: ${u.toFixed(1)}/${d}`]},"Needs More Bushes (Adaptive)",e+1),new J((o,l)=>{if(!o.leaderId)return[!0,"No tribe coordination needed"];const s=Un(o,l.gameState),u=dS(o.leaderId,l.gameState,"planting"),d=Math.max(1,Math.ceil(s.length*.3));return[u<d,`Active planters: ${u}/${d}`]},"Not Too Many Planters",e+1),new Jt([new pe([new J((o,l,s)=>_.has(s,ho),"Has Planting Spot?",e+2),t],"Continue Planting Action",e+2),new Hr(HI,r,"Find Planting Spot Cooldown",e+2)],"Perform or Start Planting",e+1)],"Plant Bush",e)}const _0="lastDepositTime",Wd="assignedStorageSpot";function O1(e){return new Jt([new pe([new J((t,r,o)=>{const l=_.get(o,_0)||0,s=r.gameState.time-l;if(s<bm)return[!1,`Cooldown: ${(bm-s).toFixed(1)}h remaining`];if(!t.isAdult)return[!1,"Not an adult"];if(!t.leaderId)return[!1,"No tribe"];const u=sC(t.leaderId,r.gameState);let d;u<.3?d=fE:u<.7?d=hE:d=gE;const f=t.food.length/t.maxFood;if(f<=d)return[!1,`Food ${(f*100).toFixed(0)}% < threshold ${(d*100).toFixed(0)}%`];const g=p0(t,r.gameState);if(!g)return[!1,"No available tribe storage nearby"];const m=st(t,r.gameState);return m&&!Cf(m,g.id,r.gameState.time)?[!1,"Storage busy"]:[!0,`Storage util: ${(u*100).toFixed(0)}%, Personal: ${(f*100).toFixed(0)}%`]},"Check for Excess Food and Storage",e+1),new J((t,r)=>{if(!t.leaderId)return[!0,"No tribe coordination needed"];const o=dS(t.leaderId,r.gameState,"depositing"),l=Un(t,r.gameState),s=Math.max(1,Math.ceil(l.length*.4));return[o<s,`Active depositors: ${o}/${s}`]},"Not Too Many Depositors",e+1),new ce((t,r,o)=>{const l=st(t,r.gameState);let s=_.get(o,Wd),u=null;if(s&&(u=r.gameState.entities.entities[s]||null),!u){if(u=p0(t,r.gameState),!u)return[T.FAILURE,"No storage available"];_.set(o,Wd,u.id)}const d=V(t.position,u.position,r.gameState.mapDimensions.width,r.gameState.mapDimensions.height);return d<=An?(l&&au(l,u.id,t.id,"deposit",r.gameState.time),t.activeAction="depositing",t.target=void 0,_.set(o,_0,r.gameState.time),_.delete(o,Wd),[T.SUCCESS,"Depositing food"]):(l&&au(l,u.id,t.id,"deposit",r.gameState.time),t.activeAction="moving",t.target=u.position,[T.RUNNING,`Moving to storage (${d.toFixed(1)}px away)`])},"Navigate to Storage and Deposit",e+1)],"Deposit Sequence",e)],"Storage Deposit Behavior",e)}function M1(e){return new Jt([new pe([new J((t,r,o)=>{if(t.hunger<=yf)return[!1,"Not hungry enough"];if(t.food.length>=t.maxFood)return[!1,"Inventory full"];const l=I0(t,r.gameState),s=E0(t,l,r.gameState),u=s==null?void 0:s.storage;if(!u)return[!1,"No tribe storage with food nearby"];const d=st(t,r.gameState);return d&&!Cf(d,u.id,r.gameState.time)?[!1,"Storage busy"]:[!0,`Storage with food found at distance ${s.distance.toFixed(1)}`]},"Check for Hunger and Storage Food",e+1),new ce((t,r,o)=>{const l=st(t,r.gameState),s=I0(t,r.gameState);if(s.length===0)return[T.FAILURE,"No storage with food available"];const u=E0(t,s,r.gameState);if(!u)return[T.FAILURE,"No storage found"];const d=u.storage,f=u.distance;return l&&!Cf(l,d.id,r.gameState.time)?[T.FAILURE,"Storage busy"]:f<=An?(l&&au(l,d.id,t.id,"retrieve",r.gameState.time),t.activeAction="retrieving",t.target=void 0,[T.SUCCESS,"Retrieving food"]):(l&&au(l,d.id,t.id,"retrieve",r.gameState.time),t.activeAction="moving",t.target=d.position,[T.RUNNING,`Moving to storage (${f.toFixed(1)}px away)`])},"Navigate to Storage and Retrieve",e+1)],"Retrieve Sequence",e)],"Storage Retrieve Behavior",e)}function F1(e){return new Jt([new pe([new J((t,r,o)=>{if(!t.isAdult)return[!1,"Not an adult"];if(t.food.length>=t.maxFood)return[!1,"Inventory full"];if(!t.leaderId)return[!1,"No tribe leader"];const l=r.gameState.entities.entities[t.leaderId];if(!l||!l.diplomacy)return[!1,"No diplomacy info"];const d=r.gameState.search.building.byRadius(t.position,150).find(f=>{const g=f;if(g.buildingType!=="storageSpot"||!g.isConstructed||!g.storedFood||g.storedFood.length===0||g.ownerId===t.leaderId||l.diplomacy[g.ownerId]!==mt.Hostile)return!1;const v=Un({leaderId:g.ownerId},r.gameState);for(const y of v)if(V(t.position,y.position,r.gameState.mapDimensions.width,r.gameState.mapDimensions.height)<=Df)return!1;return!0});return d?[!0,`Undefended enemy storage found at distance ${V(t.position,d.position,r.gameState.mapDimensions.width,r.gameState.mapDimensions.height).toFixed(1)}`]:[!1,"No undefended enemy storage nearby"]},"Check for Undefended Enemy Storage",e+1),new ce((t,r,o)=>{if(!t.leaderId)return[T.FAILURE,"No tribe leader"];const l=r.gameState.entities.entities[t.leaderId];if(!l||!l.diplomacy)return[T.FAILURE,"No diplomacy info"];const d=r.gameState.search.building.byRadius(t.position,150).filter(m=>{const v=m;if(v.buildingType!=="storageSpot"||!v.isConstructed||!v.storedFood||v.storedFood.length===0||v.ownerId===t.leaderId||l.diplomacy[v.ownerId]!==mt.Hostile)return!1;const w=Un({leaderId:v.ownerId},r.gameState);for(const I of w)if(V(t.position,I.position,r.gameState.mapDimensions.width,r.gameState.mapDimensions.height)<=Df)return!1;return!0});if(d.length===0)return[T.FAILURE,"No undefended storage available"];let f=null,g=1/0;for(const m of d){const v=V(t.position,m.position,r.gameState.mapDimensions.width,r.gameState.mapDimensions.height);v<g&&(g=v,f=m)}return f?g<=An?(t.activeAction="idle",t.target=void 0,[T.SUCCESS,"Stealing food"]):(t.activeAction="moving",t.target=f.position,[T.RUNNING,`Moving to enemy storage (${g.toFixed(1)}px away)`]):[T.FAILURE,"No storage found"]},"Navigate to Enemy Storage and Steal",e+1)],"Steal Sequence",e)],"Storage Steal Behavior",e)}const Yd="enemiesNearby";function U1(e){const t=new J(s=>s.id===s.leaderId,"Is Leader?",e+1),r=new J(s=>!s.isCallingToAttack,"Is Not Already Calling?",e+1),o=new ce((s,u,d)=>{const f=ah(s,u.gameState,nS);return f.length>0?(_.set(d,Yd,f.map(g=>g.id)),T.SUCCESS):T.FAILURE},"Find Nearby Enemies",e+1),l=new Jt([new pe([new J((s,u,d)=>{const f=_.get(d,Yd),g=f==null?void 0:f.map(w=>u.gameState.entities.entities[w]).filter(w=>!!w);if(!g||g.length===0)return!1;const m=ta(s.id,u.gameState),v=uu(m),y=uu(g);return v>y*XI},"Is Strong Enough?",e+3),new ce((s,u)=>(s.isCallingToAttack=!0,s.callToAttackEndTime=u.gameState.time+Mo,ke(u.gameState,ue.CallToAttack,s.position,Mo),Ie(u,fe.CallToAttack,s.position),s.activeAction="idle",s.target=void 0,T.SUCCESS),"Issue Call to Attack",e+3)],"Attack",e+2),new ce((s,u,d)=>{const f=_.get(d,Yd),g=f==null?void 0:f.map(E=>u.gameState.entities.entities[E]).filter(E=>!!E);if(!g||g.length===0)return T.FAILURE;const m=g.map(E=>E.position),v=ou(m),y=ze(v,s.position,u.gameState.mapDimensions.width,u.gameState.mapDimensions.height),w=nt(y),I=Mn(s.position,Nt(w,wv*2));return s.activeAction="moving",s.target={x:(I.x%u.gameState.mapDimensions.width+u.gameState.mapDimensions.width)%u.gameState.mapDimensions.width,y:(I.y%u.gameState.mapDimensions.height+u.gameState.mapDimensions.height)%u.gameState.mapDimensions.height},s.direction=w,T.SUCCESS},"Retreat",e+2)],"Attack or Retreat",e+2);return new pe([t,r,o,new Hr(KI,l,"Leader Combat Cooldown",e+1)],"Leader Combat Strategy",e)}const jd="combatTarget",Vd="homeCenter";function B1(e){const t=new J(u=>u.isAdult&&u.leaderId?u.id!==u.leaderId:!1,"Is Tribe Follower?",e+1),r=new J(u=>u.hunger<EI&&u.hitpoints>=u.maxHitpoints*Ev,"Is Fit for Combat?",e+1),o=new J((u,d)=>{const f=d.gameState.entities.entities[u.leaderId];return!!(f!=null&&f.isCallingToAttack)},"Is Leader Calling to Attack?",e+1),l=new ce((u,d,f)=>{const{gameState:g}=d,m=g.entities.entities[u.leaderId];if(!m)return T.FAILURE;const v=ah(m,g,kI);if(v.length===0)return T.FAILURE;v.sort((y,w)=>{const I=V(u.position,y.position,g.mapDimensions.width,g.mapDimensions.height),E=V(u.position,w.position,g.mapDimensions.width,g.mapDimensions.height);return I-E});for(const y of v)if(v_(m.id,y.id,g)<OI){_.set(f,jd,y.id);const I=Br(m.id,g);return _.set(f,Vd,I),T.SUCCESS}return T.FAILURE},"Find Best Target",e+1),s=new ce((u,d,f)=>{const g=_.get(f,jd),m=g&&d.gameState.entities.entities[g],v=_.get(f,Vd);if(!m||!v)return T.FAILURE;const{gameState:y}=d;return V(u.position,v,y.mapDimensions.width,y.mapDimensions.height)>Iv?(u.activeAction==="attacking"&&u.attackTargetId===m.id&&(u.activeAction="idle",u.attackTargetId=void 0),_.set(f,jd,void 0),_.set(f,Vd,void 0),T.FAILURE):((!u.lastTargetAcquiredEffectTime||d.gameState.time-u.lastTargetAcquiredEffectTime>be*5)&&(ke(d.gameState,ue.TargetAcquired,u.position,be,u.id),u.lastTargetAcquiredEffectTime=d.gameState.time),u.activeAction="attacking",u.attackTargetId=m.id,u.target=void 0,T.RUNNING)},"Attack Target",e+1);return new pe([t,r,o,l,s],"Tribe Member Combat",e)}function L1(e){const t=new J((m,v)=>{if(!m.isAdult||m.gender!=="male")return!1;const y=m.partnerIds&&m.partnerIds.length>0,w=Lt(v.gameState,m).length>0;return y||w},"Is Adult Male With Family?",e+1),r=new J((m,v)=>{var E;const y=_t(v.gameState);if(y){const C=Si(Lt(v.gameState,y));if((C==null?void 0:C.id)===m.id)return!1}if(!m.fatherId)return!1;const w=v.gameState.entities.entities[m.fatherId];return!w||((E=Si(Lt(v.gameState,w)))==null?void 0:E.id)===m.id?!1:V(m.position,w.position,v.gameState.mapDimensions.width,v.gameState.mapDimensions.height)<UI},"Is Too Close To Father?",e+1),o=new J((m,v,y)=>_.get(y,"territoryMoveTarget")!==void 0,"Is Moving To Territory?",e+3),l=new ce((m,v,y)=>{const w=_.get(y,"territoryMoveTarget"),I=_.get(y,"territoryMoveStartTime");if(!w||!I)return[T.FAILURE,"Missing move data"];if(v.gameState.time-I>MI)return _.delete(y,"territoryMoveTarget"),_.delete(y,"territoryMoveStartTime"),[T.FAILURE,"Territory move timed out"];if(V(m.position,w,v.gameState.mapDimensions.width,v.gameState.mapDimensions.height)<Ur)return _.delete(y,"territoryMoveTarget"),_.delete(y,"territoryMoveStartTime"),[T.SUCCESS,"Arrived at new territory"];m.activeAction="moving",m.target=w;const F=ze(m.position,m.target,v.gameState.mapDimensions.width,v.gameState.mapDimensions.height);return m.direction=nt(F),[T.RUNNING,"Continuing move to territory"]},"Check Timeout & Arrival",e+3),s=new pe([o,l],"Handle In-Progress Move",e+2),u=new J((m,v,y)=>_.get(y,"territoryMoveTarget")===void 0,"Should Start New Move?",e+4),d=new ce((m,v,y)=>{const w=sh(m.position,v.gameState.mapDimensions.width/4,v.gameState.mapDimensions.width,v.gameState.mapDimensions.height);_.set(y,"territoryMoveTarget",w),_.set(y,"territoryMoveStartTime",v.gameState.time),m.activeAction="moving",m.target=w;const I=ze(m.position,m.target,v.gameState.mapDimensions.width,v.gameState.mapDimensions.height);return m.direction=nt(I),[T.RUNNING,"Started moving to new territory"]},"Start New Territory Move",e+4),f=new pe([u,d],"Start New Territory Move Action",e+3),g=new Jt([s,new Hr(LI,f,"Establish Territory Cooldown",e+2)],"Establish or Continue Move",e+1);return new pe([t,r,g],"Establish Family Territory",e)}function H1(e){return new pe([new ce((t,r,o)=>{const l=s_(t,r.gameState);return l?(_.set(o,"patriarchTarget",l.id),[T.SUCCESS,`Found patriarch: ${l.id}`]):(_.delete(o,"patriarchTarget"),[T.FAILURE,"No patriarch found"])},"Find Patriarch",e+1),new ce((t,r,o)=>{const l=_.get(o,"patriarchTarget"),s=l&&r.gameState.entities.entities[l];if(!s)return[T.FAILURE,"Patriarch target missing from blackboard"];const u=V(t.position,s.position,r.gameState.mapDimensions.width,r.gameState.mapDimensions.height);if(u>Av){t.activeAction="moving",t.target=s.id;const d=ze(t.position,s.position,r.gameState.mapDimensions.width,r.gameState.mapDimensions.height);return t.direction=nt(d),[T.RUNNING,`Moving to patriarch at ${u.toFixed(0)}`]}return t.activeAction="idle",t.target=void 0,t.direction={x:0,y:0},[T.SUCCESS,`Arrived at patriarch at ${u.toFixed(0)}`]},"Move Towards Patriarch",e+1)],"Follow Patriarch",e)}const Xd="tribeSplitMigrationTarget";function b1(e){const t=new pe([new J((r,o)=>{const{canSplit:l,progress:s}=ch(r,o.gameState);return l?[!0,`Progress: ${(s??0)*100}%`]:[!1,"Cannot split"]},"Can Split Tribe?",e+2),new ce((r,o,l)=>{const{gameState:s}=o;let u=_.get(l,Xd);if(!u){if(!r.leaderId)return T.FAILURE;const f=Br(r.leaderId,s),g=x_(f,r,s);if(g)_.set(l,Xd,g),u=g;else return T.FAILURE}return V(r.position,u,s.mapDimensions.width,s.mapDimensions.height)<Ur?(_.delete(l,Xd),r.activeAction="idle",r.target=void 0,T.SUCCESS):(r.activeAction="moving",r.target=u,T.RUNNING)},"Move to New Territory",e+2),new ce((r,o)=>(dh(r,o.gameState),T.SUCCESS),"Perform Tribe Split",e+2)],"Tribe Split Action",e+1);return new Hr(T_,t,"Tribe Split Cooldown",e)}const Bl="jealousyAttackTarget";function G1(e){return new pe([new J((t,r,o)=>{if(!t.isAdult)return[!1,"Not an adult"];const l=f_(t,r.gameState,ZI);return l?t.leaderId&&l.id===t.leaderId?[!1,"Stranger is in same tribe - no attack"]:(_.set(o,Bl,l.id),[!0,`Partner cheating with ${l.id}`]):(_.delete(o,Bl),!1)},"Check for Infidelity",e+1),new ce((t,r,o)=>{const l=_.get(o,Bl),s=l&&r.gameState.entities.entities[l];return!s||s.hitpoints<=0?(_.delete(o,Bl),[T.FAILURE,"Target is invalid or dead"]):t.activeAction==="attacking"&&t.attackTargetId===s.id?T.RUNNING:(t.activeAction="attacking",t.attackTargetId=s.id,[T.RUNNING,`Attacking ${s.id}`])},"Execute Jealousy Attack",e+1)],"Jealousy Attack",e)}const Ll="defendAggressor";function x1(e){return new pe([new J((t,r,o)=>{if(!t.isAdult)return[!1,"Not an adult"];const l=g_(t,r.gameState,qI);return l?(_.set(o,Ll,l.aggressor.id),[!0,`Family member ${l.familyMember.id} attacked by ${l.aggressor.id}`]):(_.delete(o,Ll),!1)},"Check Family Under Attack",e+1),new ce((t,r,o)=>{const l=_.get(o,Ll),s=l&&r.gameState.entities.entities[l];return!s||s.hitpoints<=0?(_.delete(o,Ll),[T.FAILURE,"Target invalid/dead"]):t.activeAction==="attacking"&&t.attackTargetId===s.id?T.RUNNING:(t.activeAction="attacking",t.attackTargetId=s.id,[T.RUNNING,`Attacking aggressor ${s.id}`])},"Execute Family Defense Attack",e+1)],"Defend Family",e)}const Hl="bushIntruder";function $1(e){return new pe([new J((t,r,o)=>{if(!t.isAdult)return[!1,"Not an adult"];const l=h_(t,r.gameState,QI);return l?(_.set(o,Hl,l.id),[!0,`Intruder ${l.id} stealing berries`]):(_.delete(o,Hl),!1)},"Check For Intruders on Bushes",e+1),new ce((t,r,o)=>{const l=_.get(o,Hl),s=l&&r.gameState.entities.entities[l];return!s||s.hitpoints<=0?(_.delete(o,Hl),[T.FAILURE,"Intruder is invalid or dead"]):t.activeAction==="attacking"&&t.attackTargetId===s.id?T.RUNNING:(t.activeAction="attacking",t.attackTargetId=s.id,[T.RUNNING,`Attacking intruder ${s.id}`])},"Execute Bush Defense Attack",e+1)],"Defend Claimed Bush",e)}const bl="desperateAttackTarget";function z1(e){return new pe([new J(t=>t.hunger>JI,"Is Starving",e+1),new J((t,r)=>{if(!t.isAdult)return[!1,"Not an adult"];const o=De(t,r.gameState,"berryBush",Et,s=>s.food.length>0),l=De(t,r.gameState,"corpse",Et,s=>s.food.length>0);return!o&&!l},"No Other Food Available",e+1),new J((t,r,o)=>{const l=p_(t,r.gameState);return l?(_.set(o,bl,l.id),[!0,`Found weak target ${l.id}`]):(_.delete(o,bl),!1)},"Find Weak Target",e+1),new ce((t,r,o)=>{const l=_.get(o,bl),s=l&&r.gameState.entities.entities[l];return!s||s.hitpoints<=0?(_.delete(o,bl),[T.FAILURE,"Target is invalid or dead"]):t.activeAction==="attacking"&&t.attackTargetId===s.id?T.RUNNING:(t.activeAction="attacking",t.attackTargetId=s.id,[T.RUNNING,`Desperately attacking ${s.id}`])},"Execute Desperate Attack",e+1)],"Desperate Attack",e)}function W1(e,t,r,o){const l=e.entities.entities[r.targetEntityId];return!l||!("hitpoints"in l)||l.hitpoints<=0?(e.autopilotControls.activeAutopilotAction=void 0,T.FAILURE):V(t.position,l.position,e.mapDimensions.width,e.mapDimensions.height)<=Jl?(t.activeAction="attacking",t.attackTargetId=l.id,e.autopilotControls.activeAutopilotAction=void 0,T.SUCCESS):(t.activeAction="moving",t.target=l.id,t.direction=Ut(t.position,l.position,e.mapDimensions),T.RUNNING)}function Y1(e){return new pe([new J((t,r)=>t.isPlayer===!0&&!!r.gameState.autopilotControls.activeAutopilotAction,"Has Player Command",e+1),new ce((t,r)=>{var s;const{gameState:o}=r,l=o.autopilotControls.activeAutopilotAction;if(!l)return T.FAILURE;switch(l.action){case se.AutopilotMove:{const u=l.position;return V(t.position,u,o.mapDimensions.width,o.mapDimensions.height)<rE?(o.autopilotControls.activeAutopilotAction=void 0,t.activeAction==="moving"&&(t.activeAction="idle",t.target=void 0),T.SUCCESS):(t.activeAction="moving",t.target=u,t.direction=Ut(t.position,u,o.mapDimensions),T.RUNNING)}case se.AutopilotGather:{const u=o.entities.entities[l.targetEntityId];return!u||u.food.length===0?(o.autopilotControls.activeAutopilotAction=void 0,T.FAILURE):V(t.position,u.position,o.mapDimensions.width,o.mapDimensions.height)>Ur?(t.activeAction="moving",t.target=u.id,t.direction=Ut(t.position,u.position,o.mapDimensions),T.RUNNING):(t.activeAction="gathering",t.target=u.id,o.autopilotControls.activeAutopilotAction=void 0,T.SUCCESS)}case se.AutopilotAttack:return W1(o,t,l);case se.AutopilotProcreate:{const u=o.entities.entities[l.targetEntityId];return!u||u.type!=="human"||!Lr(t,u,r.gameState)?(o.autopilotControls.activeAutopilotAction=void 0,T.FAILURE):V(t.position,u.position,o.mapDimensions.width,o.mapDimensions.height)<=Jl?(t.activeAction="procreating",o.autopilotControls.activeAutopilotAction=void 0,T.SUCCESS):(t.activeAction="moving",t.target=u.id,t.direction=Ut(t.position,u.position,o.mapDimensions),T.RUNNING)}case se.AutopilotPlant:{if(t.activeAction==="planting")return T.RUNNING;const u=l.position;return Bn(u,o,er,t.id)?(o.autopilotControls.activeAutopilotAction=void 0,T.FAILURE):V(t.position,u,o.mapDimensions.width,o.mapDimensions.height)<=Jl?(t.activeAction="planting",t.target=u,o.autopilotControls.activeAutopilotAction=void 0,o.hasPlayerPlantedBush=!0,T.RUNNING):(t.activeAction="moving",t.target=u,t.direction=Ut(t.position,u,o.mapDimensions),T.RUNNING)}case se.AutopilotFeedChild:{const u=o.entities.entities[l.targetEntityId];return!u||u.type!=="human"||u.isAdult||t.food.length===0?(o.autopilotControls.activeAutopilotAction=void 0,T.FAILURE):V(t.position,u.position,o.mapDimensions.width,o.mapDimensions.height)<=Jl?(o.autopilotControls.activeAutopilotAction=void 0,t.activeAction="feeding",T.SUCCESS):(t.activeAction="moving",t.target=u.id,t.direction=Ut(t.position,u.position,o.mapDimensions),T.RUNNING)}case se.AutopilotDeposit:{const u=o.entities.entities[l.targetEntityId];if(!u||u.buildingType!=="storageSpot"||!u.isConstructed)return o.autopilotControls.activeAutopilotAction=void 0,T.FAILURE;const d=u.storageCapacity??0;return(((s=u.storedFood)==null?void 0:s.length)??0)>=d||t.leaderId!==u.ownerId||t.food.length===0?(o.autopilotControls.activeAutopilotAction=void 0,T.FAILURE):V(t.position,u.position,o.mapDimensions.width,o.mapDimensions.height)<=An?(t.activeAction="depositing",t.target=void 0,o.autopilotControls.activeAutopilotAction=void 0,T.SUCCESS):(t.activeAction="moving",t.target=u.id,t.direction=Ut(t.position,u.position,o.mapDimensions),T.RUNNING)}case se.AutopilotRetrieve:{const u=o.entities.entities[l.targetEntityId];return!u||u.buildingType!=="storageSpot"||!u.isConstructed||!u.storedFood||u.storedFood.length===0||t.leaderId!==u.ownerId||t.food.length>=t.maxFood?(o.autopilotControls.activeAutopilotAction=void 0,T.FAILURE):V(t.position,u.position,o.mapDimensions.width,o.mapDimensions.height)<=An?(t.activeAction="retrieving",t.target=void 0,o.autopilotControls.activeAutopilotAction=void 0,T.SUCCESS):(t.activeAction="moving",t.target=u.id,t.direction=Ut(t.position,u.position,o.mapDimensions),T.RUNNING)}case se.AutopilotFollowMe:{const u=o.entities.entities[l.targetEntityId];return!u||u.type!=="human"||u.id!==u.leaderId?(o.autopilotControls.activeAutopilotAction=void 0,T.FAILURE):V(t.position,u.position,o.mapDimensions.width,o.mapDimensions.height)<=Av?(o.autopilotControls.activeAutopilotAction=void 0,t.activeAction==="moving"&&(t.activeAction="idle"),T.SUCCESS):(t.activeAction="moving",t.target=u.id,t.direction=Ut(t.position,u.position,o.mapDimensions),T.RUNNING)}default:return o.autopilotControls.activeAutopilotAction=void 0,T.FAILURE}},"Execute Player Command",e+1)],"Player Command Handler",e)}function j1(e){return new pe([new J(t=>!!t.leaderId&&t.leaderId!==t.id,"Is Follower",e+1),new J((t,r)=>{if(!t.leaderId)return!1;const o=r.gameState.entities.entities[t.leaderId];return!!o&&o.isCallingToFollow===!0},"Is Leader Calling To Follow",e+1),new J(t=>t.hunger<RI,"Is Not Critically Hungry",e+1),new ce((t,r)=>{if(!t.leaderId)return T.FAILURE;const o=r.gameState.entities.entities[t.leaderId];return o?V(t.position,o.position,r.gameState.mapDimensions.width,r.gameState.mapDimensions.height)>CI?(t.activeAction="moving",t.target=o.id,t.direction=Ut(t.position,o.position,r.gameState.mapDimensions),T.RUNNING):(t.activeAction==="moving"&&t.target===o.id&&(t.activeAction="idle",t.target=void 0),T.SUCCESS):T.FAILURE},"Execute Follow Leader",e+1)],"Follow Leader Command",e)}const C0="tribeMigrationCheckCooldown";function V1(e){const t=new pe([new J(o=>!!o.leaderId&&o.leaderId===o.id,"Is Tribe Leader",e+2),new J((o,l)=>{const s=_.get(o.aiBlackboard,C0);return s?l.gameState.time-s>=Lm:!0},"Is Migration Check Cooldown Over",e+2),new ce((o,l)=>{o.aiBlackboard&&_.set(o.aiBlackboard,C0,l.gameState.time);const s=S_(o,l.gameState);return s?(o.isCallingToFollow=!0,o.callToFollowEndTime=l.gameState.time+na,o.target=s,o.activeAction="moving",T.SUCCESS):T.FAILURE},"Execute Tribe Migration",e+2)],"Tribe Migration Strategy",e+1),r=new ua(t,Af,"Cache Tribe Migration",e+1);return new Hr(Lm,r,"Tribe Migration Cooldown",e)}function X1(e){const t=new J(o=>o.id===o.leaderId,"Is Leader?",e+1),r=new ce((o,l)=>{var g;const{gameState:s}=l,u=ta(o.id,s),d=uu(u),f=eS(s).filter(m=>m.leaderId!==o.id);for(const m of f){const v=ta(m.leaderId,s),y=uu(v),w=((g=o.diplomacy)==null?void 0:g[m.leaderId])||mt.Friendly;d>y*VI?w!==mt.Hostile&&o.diplomacy&&(o.diplomacy[m.leaderId]=mt.Hostile):w!==mt.Friendly&&o.diplomacy&&(o.diplomacy[m.leaderId]=mt.Friendly)}return T.SUCCESS},"Evaluate Diplomacy",e+2);return new pe([t,new Hr(xI,r,"Diplomacy Cooldown",e+1)],"Manage Diplomacy",e)}const Fs="huntTarget",Gl="huntTaskRegistered";function K1(e){return new pe([new ua(new J((r,o,l)=>{if(!r.isAdult)return[!1,"Not an adult"];if(!r.leaderId)return[!1,"Not in a tribe"];const s=De(r.position,o.gameState,"prey",wI,u=>{const d=st(r,o.gameState);return!!Ef(d,u.id,o.gameState.time)});if(s){_.set(l,Fs,s.id);const u=st(r,o.gameState);return[!0,`Found prey (${wf(u,s.id)} hunters)`]}return[!1,"No suitable prey found"]},"Find Prey Target",e+2),GI,"Cache Find Prey",e+1),new du(new ce((r,o,l)=>{if(!r.leaderId)return T.FAILURE;const s=_.get(l,Fs);if(!s)return T.FAILURE;const u=st(r,o.gameState),d=o.gameState.entities.entities[s];if(!d||d.hitpoints<=0)return u&&_f(u,s,r.id),_.delete(l,Fs),_.delete(l,Gl),r.activeAction="idle",r.attackTargetId=void 0,T.SUCCESS;const{gameState:f}=o,g=Br(r.leaderId,f);if(V(r.position,g,f.mapDimensions.width,f.mapDimensions.height)>_I||!Ef(u,s,f.time)){const y=st(r,f);return y&&_f(y,s,r.id),_.delete(l,Fs),_.delete(l,Gl),r.activeAction="idle",r.attackTargetId=void 0,T.FAILURE}if(!_.get(l,Gl)){const y=st(r,f);if(y){if(!Zv(y,s,r.id,f.time))return _.delete(l,Fs),r.activeAction="idle",r.attackTargetId=void 0,T.FAILURE;_.set(l,Gl,!0)}}return r.activeAction="attacking",r.attackTargetId=d.id,T.RUNNING},"Hunt Prey Action",e+2),Tf,"Hunt Prey Timeout",e+1)],"Human Hunt Prey Sequence",e)}const xl="defendTarget",Kd=150;function Z1(e){return new pe([new J((t,r,o)=>{if(!t.isAdult)return[!1,"Not an adult - children flee instead"];if(t.hitpoints<=t.maxHitpoints*.3)return[!1,"Too injured to defend"];const{gameState:l}=r;if(t.activeAction==="attacking"&&t.attackTargetId){const u=l.entities.entities[t.attackTargetId];if(u&&u.type==="predator"&&u.hitpoints>0&&V(t.position,u.position,l.mapDimensions.width,l.mapDimensions.height)<=Kd)return _.set(o,xl,u.id),[!0,"Continuing defense"]}const s=De(t,l,"predator",Kd,u=>u.hitpoints>0&&(u.isAdult||!1));if(s){const u=V(t.position,s.position,l.mapDimensions.width,l.mapDimensions.height),d=s.attackTargetId===t.id,f=u<80;if(d||f)return _.set(o,xl,s.id),[!0,"Predator threat detected"]}return _.set(o,xl,void 0),[!1,"No predator threat"]},"Detect Predator Threat",e+1),new ce((t,r,o)=>{const l=_.get(o,xl),s=l&&r.gameState.entities.entities[l];if(!s)return T.FAILURE;const{gameState:u}=r,d=V(t.position,s.position,u.mapDimensions.width,u.mapDimensions.height);return t.hitpoints<t.maxHitpoints*.3?T.FAILURE:s.hitpoints<=0||d>Kd*1.5?(t.activeAction="idle",t.attackTargetId=void 0,T.SUCCESS):(t.activeAction="attacking",t.attackTargetId=s.id,T.RUNNING)},"Defend Against Predator",e+1)],"Human Defend Against Predator",e)}function q1(e){return new pe([new J((t,r,o)=>{const l=De(t,r.gameState,"predator",Wt*2,()=>!0),s=De(t,r.gameState,"human",Wt*2,()=>!0);let u=null,d=1/0;if(l){const f=V(t.position,l.position,r.gameState.mapDimensions.width,r.gameState.mapDimensions.height);f<d&&(d=f,u=l)}if(s){const f=V(t.position,s.position,r.gameState.mapDimensions.width,r.gameState.mapDimensions.height);f<d&&(d=f,u=s)}return u&&d<Wt*1.5?(_.set(o,"fleeThreat",u.id),_.set(o,"fleeDistance",d),!0):!1},"Detect Threat",e+1),new ce((t,r,o)=>{const l=_.get(o,"fleeThreat"),s=l&&r.gameState.entities.entities[l];if(!s)return T.FAILURE;t.activeAction="moving";const u=ze(s.position,t.position,r.gameState.mapDimensions.width,r.gameState.mapDimensions.height),d=nt(u),f=Mn(t.position,Nt(d,UC));return t.target={x:(f.x%r.gameState.mapDimensions.width+r.gameState.mapDimensions.width)%r.gameState.mapDimensions.width,y:(f.y%r.gameState.mapDimensions.height+r.gameState.mapDimensions.height)%r.gameState.mapDimensions.height},t.direction=d,t.fleeCooldown=r.gameState.time+2,T.RUNNING},"Execute Flee",e+1)],"Prey Flee",e)}function Q1(e){return new pe([new J((t,r,o)=>{if(!t.isAdult)return[!1,"Not an adult"];if(t.hunger<=30||t.eatingCooldownTime&&t.eatingCooldownTime>r.gameState.time)return!1;const l=De(t,r.gameState,"berryBush",Wt*10,s=>s.food.length>0);return l?V(t.position,l.position,r.gameState.mapDimensions.width,r.gameState.mapDimensions.height)<=Wt?(_.set(o,"grazingTarget",l.id),!0):(_.set(o,"grazingTarget",l.id),_.set(o,"needToMoveToTarget",!0),!0):!1},"Find Berry Bush",e+1),new ce((t,r,o)=>{const l=_.get(o,"grazingTarget"),s=l&&r.gameState.entities.entities[l],u=_.get(o,"needToMoveToTarget");if(!s)return T.FAILURE;const d=V(t.position,s.position,r.gameState.mapDimensions.width,r.gameState.mapDimensions.height);if(d<=Wt)return t.activeAction="grazing",t.target=s.id,t.direction={x:0,y:0},_.delete(o,"needToMoveToTarget"),T.RUNNING;if(u||d>Wt){t.activeAction="moving",t.target=s.id;const f=Ut(t.position,s.position,r.gameState.mapDimensions);return t.direction=f,T.RUNNING}return T.FAILURE},"Move to Bush or Graze",e+1)],"Prey Graze",e)}function J1(e){const t=new J((s,u,d)=>{const f=De(s,u.gameState,"prey",Wt,g=>g.id!==s.id&&g.gender!==s.gender&&!!g.isAdult&&g.age>=Vs&&g.age<=bd&&!g.isPregnant&&(!g.procreationCooldown||g.procreationCooldown<=0)&&g.hunger<200);return f?(_.set(d,"procreationPartner",f.id),!0):!1},"Find Immediate Partner",e+2),r=new ce((s,u,d)=>{const f=_.get(d,"procreationPartner"),g=f&&u.gameState.entities.entities[f];return g?(s.activeAction="procreating",s.target=g.id,s.direction={x:0,y:0},_.delete(d,"procreationPartner"),T.SUCCESS):T.FAILURE},"Start Procreating",e+2),o=new J((s,u,d)=>{const f=De(s,u.gameState,"prey",Wt*10,g=>g.id!==s.id&&g.gender!==s.gender&&!!g.isAdult&&g.age>=Vs&&g.age<=bd&&!g.isPregnant&&(!g.procreationCooldown||g.procreationCooldown<=0)&&g.hunger<200);return f?(_.set(d,"procreationPartner",f.id),!0):!1},"Locate Distant Partner",e+2),l=new ce((s,u,d)=>{const f=_.get(d,"procreationPartner"),g=f&&u.gameState.entities.entities[f];if(!g)return T.FAILURE;if(V(s.position,g.position,u.gameState.mapDimensions.width,u.gameState.mapDimensions.height)<=Wt)return T.SUCCESS;s.activeAction="moving",s.target=g.id;const v=ze(s.position,g.position,u.gameState.mapDimensions.width,u.gameState.mapDimensions.height);return s.direction=nt(v),T.RUNNING},"Move Towards Partner",e+2);return new pe([new J(s=>!!(s.isAdult&&!s.isPregnant&&s.age>=Vs&&s.age<=bd&&s.hunger<200&&(!s.procreationCooldown||s.procreationCooldown<=0)),"Is Fertile and Ready",e+1),new Jt([new pe([t,r],"Procreate With Immediate Partner",e+2),new pe([o,l],"Seek Distant Partner",e+2)],"Find Partner And Procreate",e+1)],"Prey Procreate",e)}const eR=(e,t,r)=>{const o=t.gameState.search.prey.byProperty("motherId",e.id).filter(u=>!u.isAdult&&u.type==="prey");if(o.length===0)return T.FAILURE;let l=null,s=Cu;for(const u of o)u.hunger>=s&&(s=u.hunger,l=u);return l?(_.set(r,"targetChild",l.id),T.SUCCESS):T.FAILURE},tR=(e,t,r)=>{const o=_.get(r,"targetChild"),l=o&&t.gameState.entities.entities[o];return l?V(e.position,l.position,t.gameState.mapDimensions.width,t.gameState.mapDimensions.height)>Go?(e.activeAction="moving",e.target=l.id,e.direction=Ut(e.position,l.position,t.gameState.mapDimensions),T.RUNNING):(e.activeAction="feeding",e.target=void 0,_.set(r,"targetChild",void 0),T.SUCCESS):T.FAILURE};function nR(e){return new pe([new J(t=>(t.isAdult&&t.gender==="female"&&t.hunger<80&&(!t.feedChildCooldownTime||t.feedChildCooldownTime<=0))??!1,"Can Feed Child (Female Only)",e+1),new ce(eR,"Find Hungriest Prey Child",e+1),new ce(tR,"Move To Child and Feed",e+1)],"Feed Prey Child",e)}function iR(e){return new pe([new J(t=>!t.isAdult&&t.hunger>=Cu,"Is Hungry Prey Child",e+1),new ce((t,r,o)=>{if(!t.motherId)return T.FAILURE;const l=r.gameState.entities.entities[t.motherId];return l?(_.set(o,"targetParent",l.id),T.SUCCESS):T.FAILURE},"Find Female Parent",e+1),new ce((t,r,o)=>{const l=_.get(o,"targetParent"),s=l&&r.gameState.entities.entities[l];if(!s)return T.FAILURE;const u=V(t.position,s.position,r.gameState.mapDimensions.width,r.gameState.mapDimensions.height);return t.activeAction="idle",u<=Go?(t.target=void 0,T.SUCCESS):(t.target=s.id,t.activeAction="moving",T.RUNNING)},"Move To Female Parent",e+1)],"Seek Food From Female Parent",e)}const Zd="huntTarget",qd="huntRegistered";function rR(e){return new pe([new J((t,r,o)=>{if(!t.isAdult)return[!1,"Not an adult"];if(t.hunger<=50||t.huntCooldown&&t.huntCooldown>0)return!1;const l=De(t,r.gameState,"prey",vo*10,s=>{if(s.hitpoints<=0)return!1;const u=st(t,r.gameState);return!(u&&wf(u,s.id)>=3)});if(l){const s=V(t.position,l.position,r.gameState.mapDimensions.width,r.gameState.mapDimensions.height),u=st(t,r.gameState);if(u&&!Ef(u,l.id,r.gameState.time))return[!1,"Hunt is full"];const d=u?wf(u,l.id):0;if(s<=vo)return _.set(o,Zd,l.id),[!0,`Prey in range (${d??0} hunters)`];if(s<=vo*10)return _.set(o,Zd,l.id),_.set(o,"needToApproach",!0),[!0,`Approaching prey (${d??0} hunters)`]}return!1},"Find Prey Target",e+1),new du(new ce((t,r,o)=>{const l=_.get(o,Zd),s=l&&r.gameState.entities.entities[l],u=_.get(o,"needToApproach"),d=_.get(o,qd);if(!s||s.hitpoints<=0){if(d&&l){const g=st(t,r.gameState);g&&_f(g,l,t.id),_.delete(o,qd)}return T.SUCCESS}if(!d){const g=st(t,r.gameState);if(g){if(!Zv(g,s.id,t.id,r.gameState.time))return T.FAILURE;_.set(o,qd,!0)}}const f=V(t.position,s.position,r.gameState.mapDimensions.width,r.gameState.mapDimensions.height);if(f<=vo)return t.activeAction="attacking",t.attackTargetId=s.id,t.target=s.id,t.direction={x:0,y:0},_.delete(o,"needToApproach"),T.RUNNING;if(u||f>vo){t.activeAction="moving",t.target=s.id;const g=ze(t.position,s.position,r.gameState.mapDimensions.width,r.gameState.mapDimensions.height);return t.direction=nt(g),T.RUNNING}return T.FAILURE},"Hunt or Approach Prey",e+2),10,"Hunt Timeout (10 hour)",e+1)],"Predator Hunt",e)}function oR(e){return new pe([new J((t,r,o)=>{const l=t.hunger>100,s=t.hitpoints<t.maxHitpoints*.5;if(!l&&!s||t.attackCooldown&&t.attackCooldown>0)return!1;const u=De(t,r.gameState,"human",kn*2,d=>d.hitpoints>0);if(u){const d=V(t.position,u.position,r.gameState.mapDimensions.width,r.gameState.mapDimensions.height);if(d<=kn)return _.set(o,"attackTarget",u.id),!0;if(l&&d<=kn*2)return _.set(o,"attackTarget",u.id),_.set(o,"needToApproach",!0),!0}return!1},"Find Human Target",e+1),new ce((t,r,o)=>{const l=_.get(o,"attackTarget"),s=l&&r.gameState.entities.entities[l],u=_.get(o,"needToApproach");if(!s||s.hitpoints<=0)return T.FAILURE;const d=V(t.position,s.position,r.gameState.mapDimensions.width,r.gameState.mapDimensions.height);if(d<=kn)return t.activeAction="attacking",t.attackTargetId=s.id,t.target=s.id,t.direction={x:0,y:0},_.delete(o,"needToApproach"),T.RUNNING;if(u||d>kn){t.activeAction="moving",t.target=s.id;const f=ze(t.position,s.position,r.gameState.mapDimensions.width,r.gameState.mapDimensions.height);return t.direction=nt(f),T.RUNNING}return T.FAILURE},"Attack or Approach Human",e+1)],"Predator Attack Human",e)}function sR(e){const t=new J((s,u,d)=>{const f=De(s,u.gameState,"predator",Qi,g=>g.id!==s.id&&g.gender!==s.gender&&!!g.isAdult&&g.age>=Xs&&g.age<=Gd&&!g.isPregnant&&(!g.procreationCooldown||g.procreationCooldown<=0)&&g.hunger<200);return f?(_.set(d,"procreationPartner",f.id),!0):!1},"Find Immediate Partner",e+2),r=new ce((s,u,d)=>{const f=_.get(d,"procreationPartner"),g=f&&u.gameState.entities.entities[f];return g?(s.activeAction="procreating",s.target=g.id,s.direction={x:0,y:0},_.delete(d,"procreationPartner"),T.SUCCESS):T.FAILURE},"Start Procreating",e+2),o=new J((s,u,d)=>{const f=De(s,u.gameState,"predator",Qi*10,g=>g.id!==s.id&&g.gender!==s.gender&&!!g.isAdult&&g.age>=Xs&&g.age<=Gd&&!g.isPregnant&&(!g.procreationCooldown||g.procreationCooldown<=0)&&g.hunger<200);return f?(_.set(d,"procreationPartner",f.id),!0):!1},"Locate Distant Partner",e+2),l=new ce((s,u,d)=>{const f=_.get(d,"procreationPartner"),g=f&&u.gameState.entities.entities[f];if(!g)return T.FAILURE;if(V(s.position,g.position,u.gameState.mapDimensions.width,u.gameState.mapDimensions.height)<=Qi)return T.SUCCESS;s.activeAction="moving",s.target=g.id;const v=ze(s.position,g.position,u.gameState.mapDimensions.width,u.gameState.mapDimensions.height);return s.direction=nt(v),T.RUNNING},"Move Towards Partner",e+2);return new pe([new J(s=>!!(s.isAdult&&!s.isPregnant&&s.age>=Xs&&s.age<=Gd&&s.hunger<200&&(!s.procreationCooldown||s.procreationCooldown<=0)),"Is Fertile and Ready",e+1),new Jt([new pe([t,r],"Procreate With Immediate Partner",e+2),new pe([o,l],"Seek Distant Partner",e+2)],"Find Partner And Procreate",e+1)],"Predator Procreate",e)}const aR=(e,t,r)=>{const o=t.gameState.search.predator.byProperty("motherId",e.id).filter(u=>!u.isAdult&&u.type==="predator");if(o.length===0)return T.FAILURE;let l=null,s=Cu;for(const u of o)u.hunger>=s&&(s=u.hunger,l=u);return l?(_.set(r,"targetChild",l.id),T.SUCCESS):T.FAILURE},lR=(e,t,r)=>{const o=_.get(r,"targetChild"),l=o&&t.gameState.entities.entities[o];return l?V(e.position,l.position,t.gameState.mapDimensions.width,t.gameState.mapDimensions.height)>Go?(e.activeAction="moving",e.target=l.id,e.direction=Ut(e.position,l.position,t.gameState.mapDimensions),T.RUNNING):(e.activeAction="feeding",e.target=void 0,_.set(r,"targetChild",void 0),T.SUCCESS):T.FAILURE};function uR(e){return new pe([new J(t=>(t.isAdult&&t.gender==="female"&&t.hunger<90&&(!t.feedChildCooldownTime||t.feedChildCooldownTime<=0))??!1,"Can Feed Child (Female Only)",e+1),new ce(aR,"Find Hungriest Predator Child",e+1),new ce(lR,"Move To Child and Feed",e+1)],"Feed Predator Child",e)}function cR(e){return new pe([new J(t=>!t.isAdult&&t.hunger>=Cu,"Is Hungry Predator Child",e+1),new ce((t,r,o)=>{if(!t.motherId)return T.FAILURE;const l=r.gameState.entities.entities[t.motherId];return l?(_.set(o,"targetParent",l.id),T.SUCCESS):T.FAILURE},"Find Female Parent",e+1),new ce((t,r,o)=>{const l=_.get(o,"targetParent"),s=l&&r.gameState.entities.entities[l];if(!s)return T.FAILURE;const u=V(t.position,s.position,r.gameState.mapDimensions.width,r.gameState.mapDimensions.height);return t.activeAction="idle",u<=Go?(t.target=void 0,T.SUCCESS):(t.target=s.id,t.activeAction="moving",T.RUNNING)},"Move To Female Parent",e+1)],"Seek Food From Female Parent",e)}function wS(e){return new ce((t,r,o)=>{t.activeAction="idle";let l=_.get(o,"wanderTarget"),s=_.get(o,"wanderStartTime");const u=r.gameState.time;if(!l||!s||u-s>2){const d=Math.random()*2*Math.PI,f=50+Math.random()*100,g={x:Math.cos(d),y:Math.sin(d)},m=Mn(t.position,Nt(g,f));l={x:(m.x%r.gameState.mapDimensions.width+r.gameState.mapDimensions.width)%r.gameState.mapDimensions.width,y:(m.y%r.gameState.mapDimensions.height+r.gameState.mapDimensions.height)%r.gameState.mapDimensions.height},_.set(o,"wanderTarget",l),_.set(o,"wanderStartTime",u)}if(l){t.target=l;let d=l.x-t.position.x,f=l.y-t.position.y;const g=r.gameState.mapDimensions.width,m=r.gameState.mapDimensions.height;Math.abs(d)>g/2&&(d=d>0?d-g:d+g),Math.abs(f)>m/2&&(f=f>0?f-m:f+m);const v=nt({x:d,y:f});t.direction=v}return T.SUCCESS},"Animal Wander",e)}function dR(e){return new pe([new J((t,r,o)=>{if(t.hunger>90||t.hitpoints<t.maxHitpoints*.3||t.activeAction==="grazing"||t.activeAction==="procreating")return!1;const l=Object.values(r.gameState.entities.entities),s=[];for(const u of l)if(u.type==="prey"&&u.id!==t.id){const d=u;d.hitpoints>0&&d.isAdult&&V(t.position,d.position,r.gameState.mapDimensions.width,r.gameState.mapDimensions.height)<=Wt*5&&s.push(d)}if(s.length>=2){let u=0,d=0;for(const m of s)u+=m.position.x,d+=m.position.y;u/=s.length,d/=s.length;const f={x:u,y:d};if(V(t.position,f,r.gameState.mapDimensions.width,r.gameState.mapDimensions.height)>Wt*2)return _.set(o,"herdCenter",f),_.set(o,"herdSize",s.length),!0}return!1},"Find Herd",e+1),new ce((t,r,o)=>{const l=_.get(o,"herdCenter");if(!l)return T.FAILURE;if(V(t.position,l,r.gameState.mapDimensions.width,r.gameState.mapDimensions.height)>Wt*2){t.activeAction="moving",t.target=l;const u=ze(t.position,l,r.gameState.mapDimensions.width,r.gameState.mapDimensions.height);return t.direction=nt(u),T.RUNNING}else return t.activeAction="idle",t.direction={x:0,y:0},T.SUCCESS},"Join Herd",e+1)],"Prey Herd Behavior",e)}function fR(e){return new pe([new J((t,r,o)=>{if(t.hunger>100||t.hitpoints<t.maxHitpoints*.4||t.activeAction==="attacking"||t.activeAction==="procreating")return!1;const l=De(t,r.gameState,"predator",Qi*4,s=>s.id!==t.id&&s.hitpoints>0&&s.isAdult&&t.fatherId!==void 0&&s.fatherId===t.fatherId&&s.age>=t.age||s.hitpoints>t.hitpoints);return l&&V(t.position,l.position,r.gameState.mapDimensions.width,r.gameState.mapDimensions.height)>Qi*2?(_.set(o,"packLeader",l.id),!0):!1},"Find Pack Leader",e+1),new ce((t,r,o)=>{const l=_.get(o,"packLeader"),s=l&&r.gameState.entities.entities[l];if(!s||s.hitpoints<=0)return T.FAILURE;if(V(t.position,s.position,r.gameState.mapDimensions.width,r.gameState.mapDimensions.height)>Qi*2){t.activeAction="moving",t.target=s.id;const d=ze(t.position,s.position,r.gameState.mapDimensions.width,r.gameState.mapDimensions.height);return t.direction=nt(d),T.RUNNING}else return t.activeAction="idle",t.direction={x:0,y:0},T.SUCCESS},"Follow Pack Leader",e+1)],"Predator Pack Behavior",e)}function hR(e){return new pe([new J((t,r,o)=>{if(!t.isAdult||t.hitpoints<t.maxHitpoints*.6||t.hunger>120||t.attackCooldown&&t.attackCooldown>0)return!1;const l=De(t,r.gameState,"predator",S0,s=>!!(s.id!==t.id&&s.hitpoints>0&&s.isAdult&&t.fatherId!==s.fatherId&&t.gender===s.gender&&t.fatherId!==void 0&&s.fatherId!==void 0));if(l){const s=V(t.position,l.position,r.gameState.mapDimensions.width,r.gameState.mapDimensions.height);if(s<=kn)return _.set(o,"territorialTarget",l.id),!0;if(s<=S0)return _.set(o,"territorialTarget",l.id),_.set(o,"needToApproach",!0),!0}return!1},"Find Territorial Rival",e+1),new ce((t,r,o)=>{const l=_.get(o,"territorialTarget"),s=l&&r.gameState.entities.entities[l],u=_.get(o,"needToApproach");if(!s||s.hitpoints<=0)return T.FAILURE;const d=V(t.position,s.position,r.gameState.mapDimensions.width,r.gameState.mapDimensions.height);if(d<=kn)return t.activeAction="attacking",t.attackTargetId=s.id,t.target=s.id,t.direction={x:0,y:0},_.delete(o,"needToApproach"),T.RUNNING;if(u||d>kn){t.activeAction="moving",t.target=s.id;const f=ze(t.position,s.position,r.gameState.mapDimensions.width,r.gameState.mapDimensions.height);return t.direction=nt(f),T.RUNNING}return T.FAILURE},"Territorial Fight or Approach",e+1)],"Predator Territorial Defense",e)}function gR(){const e=new Jt([v1(2),x1(2),new Qt(Z1(2),"attack","Gated Defend Against Predator",2),new Qt(G1(2),"attack","Gated Jealousy Attack",2),new Qt($1(2),"attack","Gated Defend Claimed Bush",2),new Qt(z1(2),"attack","Gated Desperate Attack",2),Y1(2),new Os(U1(3),"Gated Leader Combat Strategy",2),new Os(X1(3),"Gated Diplomacy",2),B1(2),new Qt(F1(3),"attack","Gated Storage Steal",2),new Qt(E1(3),"attack","Gated Attacking",2),m1(2),new Qt(M1(3),"gathering","Gated Storage Retrieve",2),new du(new Qt(T1(4),"gathering","Gated Gathering",3),Tf,"Timeout Gathering",2),new Qt(O1(3),"gathering","Gated Storage Deposit",2),new Qt(C1(3),"feedChildren","Gated Feed Child",2),R1(2),new du(new Qt(k1(4),"planting","Gated Planting",3),Tf,"Timeout Planting",2),new Qt(K1(3),"attack","Gated Hunt Prey",2),new Qt(I1(3),"procreation","Gated Procreation",2),new ua(b1(3),Af,"Cache Tribe Split",2),new Os(V1(3),"Gated Tribe Migration",2),new ua(L1(3),Af,"Cache Establish Territory",2),new Qt(j1(3),"followLeader","Gated Follow Leader",2),new Os(H1(2),"Gated Follow Patriarch",2),new Os(A1(2),"Gated Idle Wander",2)],"AI Root Selector",1);return new p1(e,"Manual Control Gate",0)}const _S=gR();function pR(e,t){e.aiBlackboard&&_.cleanupOldEntries(e.aiBlackboard,t.gameState.time);const r=st(e,t.gameState);r&&r.id===e.id&&r.aiBlackboard&&i_(r,t.gameState.time);const o=performance.now();switch(e.aiType){case ga.BehaviorTreeBased:default:ph(e,t,_S);break}t.gameState.performanceMetrics.currentBucket.aiUpdateTime+=performance.now()-o}function mR(){return new Jt([q1(1),nR(1),iR(1),Q1(1),J1(1),dR(1),wS(1)],"Prey Behavior Root",0)}function vR(){return new Jt([rR(1),oR(1),uR(1),cR(1),hR(1),sR(1),fR(1),wS(1)],"Predator Behavior Root",0)}const CS=mR();function SR(e,t){e.aiBlackboard?ph(e,t,CS):(console.warn(`Behavior Tree AI ticked for prey ${e.id}, but the tree or blackboard was missing.`),e.activeAction="idle")}const RS=vR();function yR(e,t){e.aiBlackboard?ph(e,t,RS):(console.warn(`Behavior Tree AI ticked for predator ${e.id}, but the tree or blackboard was missing.`),e.activeAction="idle")}function TR(e,t){const{gameState:r,deltaTime:o}=t,l=o*(At/It);if(e.isBeingDestroyed){const s=q_(e.buildingType);if(s>0?e.destructionProgress+=l/s:e.destructionProgress=1,e.destructionProgress>=1){$o(r.entities,e.id);return}}if(!e.isConstructed&&!e.isBeingDestroyed){const s=Z_(e.buildingType);s>0?e.constructionProgress+=l/s:e.constructionProgress=1,e.constructionProgress>=1&&(e.constructionProgress=1,e.isConstructed=!0)}}function AR(e,t){e.forces.push(Nt(e.velocity,-.1));const r=Nt(nt(e.direction),e.acceleration);e.forces.push(r),e.debuffs.forEach(o=>{t.gameState.time-o.startTime<o.duration&&o.type==="slow"&&(e.velocity=Nt(e.velocity,.5))}),e.debuffs=e.debuffs.filter(o=>t.gameState.time-o.startTime<o.duration),e.velocity=Mn(e.velocity,e.forces.reduce(Mn,{x:0,y:0})),ko(e.velocity)<.001&&(e.velocity={x:0,y:0}),e.position=Mn(e.position,Nt(e.velocity,t.deltaTime)),e.position.x=(e.position.x%t.gameState.mapDimensions.width+t.gameState.mapDimensions.width)%t.gameState.mapDimensions.width,e.position.y=(e.position.y%t.gameState.mapDimensions.height+t.gameState.mapDimensions.height)%t.gameState.mapDimensions.height,e.forces=[],e.type==="human"?u1(e,t,t.deltaTime):e.type==="corpse"?c1(e,t):e.type==="prey"?d1(e,t,t.deltaTime):e.type==="predator"?f1(e,t,t.deltaTime):e.type==="building"&&TR(e,t),e.type==="human"&&pR(e,t),e.type==="prey"?SR(e,t):e.type==="predator"&&yR(e,t),e.stateMachine&&(e.stateMachine=l1(...e.stateMachine,{entity:e,updateContext:t}))}function IR(e){const t=e.gameState.entities;Object.values(t.entities).forEach(r=>{AR(r,e)})}function PS(){return{entities:{},nextEntityId:1}}function xo(e,t,r){const o={id:e.nextEntityId++,type:t,velocity:{x:0,y:0},direction:{x:0,y:0},acceleration:0,forces:[],debuffs:[],...r};return e.entities[o.id]=o,o}function pa(e,t,r){return xo(e,"berryBush",{position:t,radius:Sf,food:Array.from({length:gI},()=>({type:Fn.Berry})).map(l=>({...l,id:e.nextEntityId++})),maxFood:hI,lifespan:mI,age:0,spreadRadius:Sf,timeSinceLastBerryRegen:0,timeSinceLastSpreadAttempt:0,timeSinceLastHarvest:0,stateMachine:[$s,{enteredAt:r,previousState:void 0}]})}function fu(e,t,r,o,l=!1,s=yE,u=Rv,d,f,g=[],m,v){const y=s>=Xf;return xo(e,"human",{position:t,radius:y?wt:Ho,hunger:u,hitpoints:xm,maxHitpoints:xm,age:s,gender:o,isPlayer:l,food:[],maxFood:Cv,maxAge:ea,isAdult:y,isPregnant:!1,gestationTime:0,procreationCooldown:0,attackCooldown:0,motherId:d,fatherId:f,ancestorIds:g,stateMachine:[ct,{enteredAt:r,previousState:void 0}],leaderId:m,tribeBadge:v,aiType:ga.BehaviorTreeBased,aiBlackboard:_.create()})}function mh(e,t,r,o,l,s,u,d,f,g,m){let v,y;switch(u){case"human":v=Dv,y=Fr;break;case"prey":v=2,y=120;break;case"predator":v=4,y=140;break}return xo(e,"corpse",{position:t,radius:l,gender:r,age:o,originalEntityId:s,originalEntityType:u,timeOfDeath:d,decayProgress:0,geneCode:m,food:[...Array.from({length:Math.max(v*Math.max(y-g,0)/y,0)},()=>({type:Fn.Meat})),...f].map(I=>({...I,id:e.nextEntityId++})),stateMachine:void 0})}function ER(e,t,r,o,l,s,u,d,f){return mh(e,t,r,o,l,s,"human",u,d,f)}function wR(e,t,r,o,l,s,u,d){return mh(e,t,r,o,l,s,"prey",u,[],0,d)}function _R(e,t,r,o,l,s,u,d){return mh(e,t,r,o,l,s,"predator",u,[],0,d)}function CR(e,t,r){const o=t?r.gameState.entities.entities[t]:void 0,l=[...e.ancestorIds||[],e.id],s=o?[...o.ancestorIds||[],o.id]:[],u=[...l,...s],d=[...new Set(u)],f=d.slice(Math.max(d.length-pE,0)),g=Math.random()<.5?"male":"female",m=Mn(e.position,{x:5,y:5}),v=fu(r.gameState.entities,m,r.gameState.time,g,!1,0,Rv/2,e.id,t,f,(o==null?void 0:o.leaderId)??e.leaderId,(o==null?void 0:o.tribeBadge)??e.tribeBadge);return Ie(r,fe.Birth,e.position),v}function $o(e,t){return e.entities[t]?(delete e.entities[t],!0):!1}function Fo(e,t,r,o=FC,l=gS,s,u,d){const f=o>=Vs,g=Date.now();return xo(e,"prey",{position:t,radius:f?wt*.7:Ho*.7,hunger:l,hitpoints:m0,maxHitpoints:m0,age:o,maxAge:hS,gender:r,isAdult:f,isPregnant:!1,gestationTime:0,procreationCooldown:0,geneCode:s,motherId:u,fatherId:d,stateMachine:[Dn,{enteredAt:g,previousState:void 0}],aiType:ga.BehaviorTreeBased,aiBlackboard:_.create()})}function Uo(e,t,r,o=$C,l=mS,s,u,d){const f=o>=Xs,g=Date.now();return xo(e,"predator",{position:t,radius:f?wt*.9:Ho*.9,hunger:l,hitpoints:v0,maxHitpoints:v0,age:o,maxAge:pS,gender:r,isAdult:f,isPregnant:!1,gestationTime:0,procreationCooldown:0,geneCode:s,motherId:u,fatherId:d,stateMachine:[zt,{enteredAt:g,previousState:void 0}],aiType:ga.BehaviorTreeBased,aiBlackboard:_.create()})}function RR(e,t,r,o){const l=aS(r),s={position:t,radius:Math.max(l.width,l.height)/2,buildingType:r,ownerId:o,width:l.width,height:l.height,constructionProgress:0,destructionProgress:0,isConstructed:!1,isBeingDestroyed:!1};return xo(e,"building",{...s,...r===oa.StorageSpot&&{storedFood:[],storageCapacity:$_,lastDepositTime:0,lastRetrieveTime:0,lastStealTime:0}})}var xt=(e=>(e.MOVE="MOVE",e.HUNGER="HUNGER",e.EAT="EAT",e.FIND_BUSH="FIND_BUSH",e.GATHER="GATHER",e.PROCREATE="PROCREATE",e.PLANT_BUSH="PLANT_BUSH",e.AUTOPILOT="AUTOPILOT",e.ANIMALS_INTRODUCTION="ANIMALS_INTRODUCTION",e.HUNT_PREY="HUNT_PREY",e.DEFEND_FROM_PREDATORS="DEFEND_FROM_PREDATORS",e))(xt||{}),kr=(e=>(e.HUNGER_BAR="HUNGER_BAR",e.FOOD_BAR="FOOD_BAR",e.COMMAND_BUTTONS="COMMAND_BUTTONS",e))(kr||{}),$t=(e=>(e[e.FADING_IN=0]="FADING_IN",e[e.ACTIVE=1]="ACTIVE",e[e.FADING_OUT=2]="FADING_OUT",e[e.INACTIVE=3]="INACTIVE",e))($t||{});const kf={},Of={},PR=[{key:xt.MOVE,title:"Movement",text:"Use WASD or Arrow Keys to move your character around the world.",condition:e=>e.hasPlayerMovedEver||e.hasPlayerEnabledAutopilot>2,isCompleted:!1},{key:xt.HUNGER,title:"Hunger",text:"Your character gets hungry over time. Watch the hunger bar!",condition:(e,t)=>t.hunger>mE,isCompleted:!1,minDisplayTime:Qm,highlightedUIElements:[kr.HUNGER_BAR]},{key:xt.FIND_BUSH,title:"Find Food",text:"Look for berry bushes. They are your primary source of food.",condition:(e,t)=>!!De(t,e,"berryBush",Et*5,o=>o.food.length>0),getTargets:(e,t)=>{const r=[];for(const o of Object.values(e.entities.entities))o.type==="berryBush"&&o.food.length>0&&V(t.position,o.position,e.mapDimensions.width,e.mapDimensions.height)<500&&r.push(o);return r.map(o=>o.id)},isCompleted:!1,minDisplayTime:Qm},{key:xt.GATHER,title:"Gather Berries",text:"Get close to a bush and press 'E' to gather berries.",condition:(e,t)=>t.food.length>0,getTargets:(e,t)=>{const r=De(t,e,"berryBush",Et,o=>o.food.length>0);return r?[r.id]:[]},isCompleted:!1},{key:xt.EAT,title:"Eat",text:"When you are hungry and have food, press 'F' to eat.",condition:(e,t)=>t.activeAction==="eating",isCompleted:!1,highlightedUIElements:[kr.FOOD_BAR]},{key:xt.PROCREATE,title:"Procreate",text:"Find a mate and press 'R' to start a family. This is how you continue your lineage.",condition:(e,t)=>Lt(e,t).length>0,getTargets:(e,t)=>{const r=De(t,e,"human",Et,o=>Lr(t,o,e));return r?[r.id]:[]},isCompleted:!1},{key:xt.PLANT_BUSH,title:"Farming",text:"You can plant new berry bushes. Carry some berries and press 'B' to plant.",condition:(e,t)=>fh(e,t).some(o=>o.type===se.Plant)||e.hasPlayerPlantedBush===!0,isCompleted:!1},{key:xt.AUTOPILOT,title:"Autopilot!",text:"You can turn autopilot for specific actions, press Shift and click on the action button to enable it.",condition:e=>e.hasPlayerEnabledAutopilot>2,highlightedUIElements:[kr.COMMAND_BUTTONS],isCompleted:!1},{key:xt.ANIMALS_INTRODUCTION,title:"Wild Animals!",text:"Your world now has wild animals! Prey provide meat when hunted, but beware of predators that may attack.",condition:e=>Object.values(e.entities.entities).some(r=>r.type==="prey"||r.type==="predator"),isCompleted:!1,dependsOn:xt.AUTOPILOT},{key:xt.HUNT_PREY,title:"Hunt for Meat",text:"Click on prey animals to hunt them for meat. Hunting provides more food than gathering berries!",condition:(e,t)=>{const r=De(t,e,"prey",150);return t.hunger>40&&!!r},getTargets:(e,t)=>{const r=De(t,e,"prey",150);return r?[r.id]:[]},isCompleted:!1,dependsOn:xt.ANIMALS_INTRODUCTION},{key:xt.DEFEND_FROM_PREDATORS,title:"Predators",text:"Predators may attack when hungry! Click on them to fight back. Fighting together with family is more effective.",condition:(e,t)=>!!De(t,e,"predator",120),getTargets:(e,t)=>{const r=De(t,e,"predator",120);return r?[r.id]:[]},isCompleted:!1,dependsOn:xt.HUNT_PREY}].map(e=>({...e,condition:e.condition?kR(e.condition):void 0,getTargets:e.getTargets?OR(e.getTargets):void 0}));function NS(){return{steps:PR.map(e=>({...e,isCompleted:!1}))}}function DS(){return{currentStepIndex:0,completedSteps:[],isActive:!0,transitionState:$t.FADING_IN,transitionAlpha:0,highlightedEntityIds:[],stepStartTime:null,activeUIHighlights:[]}}function NR(e){for(let t=0;t<e.tutorial.steps.length;t++){const r=e.tutorial.steps[t];if(!r.isCompleted)if(r.dependsOn){if(e.tutorialState.completedSteps.includes(r.dependsOn))return t}else return t}return null}function DR(e,t){const r=e.tutorialState;if(!r.isActive){r.transitionState=$t.INACTIVE,r.highlightedEntityIds=[],r.activeUIHighlights=[];return}const o=_t(e);if(!o){r.isActive=!1,r.transitionState=$t.INACTIVE,r.highlightedEntityIds=[],r.activeUIHighlights=[];return}const l=e.tutorial.steps[r.currentStepIndex];if(!l){r.isActive=!1,r.transitionState=$t.INACTIVE,r.highlightedEntityIds=[],r.activeUIHighlights=[];return}const s=1/Uw;switch(r.transitionState){case $t.FADING_IN:r.stepStartTime===null&&(r.stepStartTime=e.time),r.transitionAlpha+=s*t,r.transitionAlpha>=1&&(r.transitionAlpha=1,r.transitionState=$t.ACTIVE);break;case $t.ACTIVE:{const f=e.time-(r.stepStartTime||e.time)>=(l.minDisplayTime||0),g=kf[l.condition];g&&f&&g(e,o)&&(l.isCompleted=!0,r.completedSteps.includes(l.key)||r.completedSteps.push(l.key),r.transitionState=$t.FADING_OUT);break}case $t.FADING_OUT:if(r.transitionAlpha-=s*t,r.transitionAlpha<=0){r.transitionAlpha=0,r.stepStartTime=null;const d=NR(e);d!==null?(r.currentStepIndex=d,r.transitionState=$t.FADING_IN):(r.isActive=!1,r.transitionState=$t.INACTIVE)}break}if(r.transitionState!==$t.FADING_OUT&&r.transitionState!==$t.INACTIVE){const d=Of[l.getTargets||""];d?r.highlightedEntityIds=[...d(e,o)]:r.highlightedEntityIds=[],l.highlightedUIElements?r.activeUIHighlights=[...l.highlightedUIElements]:r.activeUIHighlights=[]}else r.highlightedEntityIds=[],r.activeUIHighlights=[]}function kR(e){const t=`condition_${Object.keys(kf).length+1}`;return kf[t]=e,t}function OR(e){const t=`getTargets_${Object.keys(Of).length+1}`;return Of[t]=e,t}function MR(){const e=PS(),t=0;for(let v=0;v<yv;v++){const y={x:Math.random()*et,y:Math.random()*tt};pa(e,y,t)}const r=et/2,o=tt/2,l=fu(e,{x:r,y:o},t,"male",!0);fu(e,{x:r+50,y:o},t,"female",!1);for(let v=0;v<yS;v++){const y={x:r+et*(Math.random()-Math.random()),y:o+tt*(Math.random()-Math.random())};Fo(e,y,"male",void 0,void 0,aa()),Fo(e,{x:y.x+20,y:y.y},"female",void 0,void 0,aa())}const s={x:r+et*(Math.random()-Math.random()),y:o+tt*(Math.random()-Math.random())};Uo(e,s,"male",void 0,void 0,la()),Uo(e,{x:s.x+20,y:s.y},"female",void 0,void 0,la());const u=[{id:"muteButton",action:ge.ToggleMute,currentWidth:fi,rect:{x:0,y:0,width:0,height:0},text:"",backgroundColor:"",textColor:yn},{id:"pauseButton",action:ge.TogglePause,currentWidth:fi,rect:{x:0,y:0,width:0,height:0},text:"",backgroundColor:"",textColor:yn},{id:"returnToIntroButton",action:ge.ReturnToIntro,currentWidth:fi,rect:{x:0,y:0,width:0,height:0},text:"EXIT",backgroundColor:"",textColor:yn}],d=NS(),f=DS(),g={time:t,entities:e,mapDimensions:{width:et,height:tt},generationCount:1,gameOver:!1,visualEffects:[],nextVisualEffectId:0,viewportCenter:{...l.position},isPaused:!1,exitConfirmation:"inactive",autopilotControls:{behaviors:{procreation:!1,planting:!1,gathering:!1,attack:!1,feedChildren:!0,followLeader:!1},hoveredAutopilotAction:void 0,activeAutopilotAction:void 0,isManuallyMoving:!1},buildMenuOpen:!1,selectedBuildingType:null,selectedBuildingForRemoval:null,hasPlayerMovedEver:!1,hasPlayerPlantedBush:!1,hasPlayerEnabledAutopilot:0,masterVolume:oS,isMuted:!1,uiButtons:u,tutorial:d,tutorialState:f,debugPanel:Pt.None,performanceMetrics:{currentBucket:{renderTime:0,worldUpdateTime:0,aiUpdateTime:0},history:[]},hoveredButtonId:void 0,mousePosition:{x:0,y:0},notifications:[{id:"welcome",type:ia.Hello,message:"Welcome to the game!",duration:50,targetEntityIds:[l.id],highlightedEntityIds:[l.id],timestamp:0,isDismissed:!1,creationTime:Date.now()}],ecosystem:{preyGestationPeriod:Cr,preyProcreationCooldown:Rr,predatorGestationPeriod:Pr,predatorProcreationCooldown:Nr,preyHungerIncreasePerHour:Xi,predatorHungerIncreasePerHour:Ki,berryBushSpreadChance:mi},autosaveIntervalSeconds:5,lastAutosaveTime:Date.now()},m=gu(g);return console.log("Game world initialized:",m),m}function FR(){const e=PS(),t=0;for(let u=0;u<yv;u++){const d={x:Math.random()*et,y:Math.random()*tt};pa(e,d,t)}for(let u=0;u<cI;u++){const d={x:Math.random()*et,y:Math.random()*tt},f=Math.random()<.5?"male":"female";fu(e,d,t,f,!1)}for(let u=0;u<yS;u++){const d={x:Math.random()*et,y:Math.random()*tt};Fo(e,d,"male",void 0,void 0,aa()),Fo(e,{x:d.x+20,y:d.y},"female",void 0,void 0,aa())}const r={x:Math.random()*et,y:Math.random()*tt};Uo(e,r,"male",void 0,void 0,la()),Uo(e,{x:r.x+20,y:r.y},"female",void 0,void 0,la());const o=NS(),l=DS(),s={time:t,entities:e,mapDimensions:{width:et,height:tt},generationCount:0,gameOver:!1,visualEffects:[],nextVisualEffectId:0,viewportCenter:{x:et/2,y:tt/2},isPaused:!1,exitConfirmation:"inactive",autopilotControls:{behaviors:{procreation:!1,planting:!1,gathering:!1,attack:!1,feedChildren:!0,followLeader:!1},hoveredAutopilotAction:void 0,activeAutopilotAction:void 0,isManuallyMoving:!1},buildMenuOpen:!1,selectedBuildingType:null,selectedBuildingForRemoval:null,hasPlayerMovedEver:!1,hasPlayerPlantedBush:!1,hasPlayerEnabledAutopilot:0,masterVolume:oS,isMuted:!0,uiButtons:[],tutorial:o,tutorialState:l,debugPanel:Pt.None,performanceMetrics:{currentBucket:{renderTime:0,worldUpdateTime:0,aiUpdateTime:0},history:[]},hoveredButtonId:void 0,mousePosition:{x:0,y:0},notifications:[],ecosystem:{preyGestationPeriod:Cr,preyProcreationCooldown:Rr,predatorGestationPeriod:Pr,predatorProcreationCooldown:Nr,preyHungerIncreasePerHour:Xi,predatorHungerIncreasePerHour:Ki,berryBushSpreadChance:mi},lastAutosaveTime:0};return gu(s)}const UR="humanProcreation",BR="human",LR="human",HR=Et,bR=(e,t,r)=>Lr(e,t,r.gameState)?e.gender==="male"?e.activeAction==="procreating":e.activeAction==="procreating"&&t.activeAction==="procreating":!1,GR=(e,t,r)=>{var f,g;const{gameState:o}=r,l={x:(e.position.x+t.position.x)/2,y:(e.position.y+t.position.y)/2},s=e.gender==="male"?e:t,u=e.gender==="female"?e:t,d=(s.partnerIds||[]).length===0;if(e.stateMachine=[sa,{partnerId:t.id,previousState:(f=e.stateMachine)==null?void 0:f[0]}],t.stateMachine=[sa,{partnerId:e.id,previousState:(g=t.stateMachine)==null?void 0:g[0]}],e.partnerIds||(e.partnerIds=[]),e.partnerIds.includes(t.id)||e.partnerIds.push(t.id),t.partnerIds||(t.partnerIds=[]),t.partnerIds.includes(e.id)||t.partnerIds.push(e.id),d&&s.leaderId&&s.leaderId!==s.id){const m=o.entities.entities[s.leaderId];if(m){const v=Rf(s,m),y=Rf(u,m);if(!v&&!y){const w=Pf();s.leaderId=s.id,s.tribeBadge=w,s.diplomacy={},u.leaderId=s.id,u.tribeBadge=w}}}else if(!e.leaderId&&!t.leaderId&&s&&u){const m=Pf();s.leaderId=s.id,s.tribeBadge=m,s.diplomacy={},u.leaderId=s.id,u.tribeBadge=m}e.activeAction=void 0,ke(o,ue.Procreation,l,wr),ke(o,ue.Partnered,e.position,be,e.id),ke(o,ue.Partnered,t.position,be,t.id),e.lastPartneredEffectTime=o.time,t.lastPartneredEffectTime=o.time,t.activeAction=void 0,Ie(r,fe.Procreate,l)},xR={id:UR,sourceType:BR,targetType:LR,maxDistance:HR,checker:bR,perform:GR},$R={id:"humanChildFeeding",sourceType:"human",targetType:"human",maxDistance:Zf,checker:(e,t)=>e.isAdult===!0&&e.food.length>0&&(!e.feedChildCooldownTime||e.feedChildCooldownTime<=0)&&t.isAdult===!1&&(t.motherId===e.id||t.fatherId===e.id)&&t.hunger>=tr&&e.activeAction==="feeding",perform:(e,t,r)=>{e.food.pop(),t.hunger=Math.max(0,t.hunger-tr),e.feedChildCooldownTime=RE,(!t.lastChildFedEffectTime||r.gameState.time-t.lastChildFedEffectTime>2)&&(ke(r.gameState,ue.ChildFed,t.position,be,t.id),t.lastChildFedEffectTime=r.gameState.time),Ie(r,fe.ChildFed,t.position)}},zR={id:"human-attack",sourceType:"human",targetType:"human",maxDistance:Qn,checker:(e,t,r)=>{var s;if(((s=e.stateMachine)==null?void 0:s[0])!==nr||e.attackTargetId!==t.id||(e.attackCooldown||0)>0)return!1;const o=e.stateMachine[1];return r.gameState.time-o.attackStartTime>=kv},perform:(e,t,r)=>{const o=ze(e.position,t.position,r.gameState.mapDimensions.width,r.gameState.mapDimensions.height),l=zE(nt(o),t.direction);if(Math.abs(l)<bE*Math.PI/180&&Math.random()<GE)ke(r.gameState,ue.AttackDeflected,t.position,be,t.id);else{let d=qf;e.gender==="male"&&(d*=BE),e.isAdult||(d*=LE),(!t.isAdult||t.age>=Nv)&&e.isAdult&&(d*=HE),t.hitpoints-=d,t.movementSlowdown={modifier:Qf,endTime:r.gameState.time+Jf},ke(r.gameState,ue.Hit,t.position,be,t.id);const g=ze(e.position,t.position,r.gameState.mapDimensions.width,r.gameState.mapDimensions.height),m=Nt(g,ME);t.forces.push(m),t.hitpoints<=0?Ie(r,fe.HumanDeath,t.position):Ie(r,fe.Attack,e.position)}e.attackCooldown=Iu;const u=e.stateMachine[1];u.attackStartTime=r.gameState.time,ke(r.gameState,ue.Attack,e.position,be,e.id)}},WR={id:"human-collision",sourceType:"human",targetType:"human",maxDistance:wt*2,checker:(e,t,{gameState:r})=>V(e.position,t.position,r.mapDimensions.width,r.mapDimensions.height)<(e.radius+t.radius)/3,perform:(e,t,{gameState:r})=>{const o=V(e.position,t.position,r.mapDimensions.width,r.mapDimensions.height);if(o===0){e.forces.push({x:.1,y:0}),t.forces.push({x:-.1,y:0});return}const s=(e.radius+t.radius-o)*.05,u=nt(Ov(e.position,t.position)),d=Nt(u,s);e.forces.push(d),t.forces.push(Nt(d,-1))}},YR={id:"humanBerryBushGather",sourceType:"human",targetType:"berryBush",maxDistance:Et,checker:(e,t,r)=>{var o;return e.isAdult&&t.food.length>0&&((o=e.stateMachine)==null?void 0:o[0])===ha&&e.food.length<e.maxFood&&(!e.gatheringCooldownTime||e.gatheringCooldownTime<r.gameState.time)||!1},perform:(e,t,r)=>{const o=t.food.pop();o&&e.food.push(o),e.gatheringCooldownTime=r.gameState.time+1,t.timeSinceLastHarvest=r.gameState.time,t.ownerId=e.id,t.claimedUntil=r.gameState.time+Tv,ke(r.gameState,ue.BushClaimed,t.position,be),Ie(r,fe.Gather,e.position)}},jR={id:"corpseGather",sourceType:"human",targetType:"corpse",maxDistance:Et,checker:(e,t,r)=>{var o;return e.isAdult&&t.food.length>0&&((o=e.stateMachine)==null?void 0:o[0])===ha&&e.food.length<e.maxFood&&(!e.gatheringCooldownTime||e.gatheringCooldownTime<r.gameState.time)||!1},perform:(e,t,r)=>{const o=t.food.pop();o&&e.food.push(o),e.gatheringCooldownTime=r.gameState.time+1,Ie(r,fe.Gather,e.position)}},VR=[YR,jR],XR={id:"prey-eat-berry-bush",sourceType:"prey",targetType:"berryBush",maxDistance:Wt,checker:(e,t,r)=>!!(e.isAdult&&t.food.length>0&&e.hunger>30&&(!e.eatingCooldownTime||e.eatingCooldownTime<r.gameState.time)),perform:(e,t,r)=>{t.food.pop()&&(e.hunger=Math.max(0,e.hunger-25),t.lifespan-=LC,t.timeSinceLastHarvest=r.gameState.time,e.eatingCooldownTime=r.gameState.time+BC,ke(r.gameState,ue.BushClaimed,t.position,be,e.id),Ie(r,fe.Gather,e.position))}},KR={id:"predator-hunt-prey",sourceType:"predator",targetType:"prey",maxDistance:vo,checker:(e,t,r)=>!!(e.isAdult&&e.hunger>50&&(!e.huntCooldown||e.huntCooldown<=0)&&t.hitpoints>0),perform:(e,t,r)=>{t.hitpoints-=zC;const o=ze(e.position,t.position,r.gameState.mapDimensions.width,r.gameState.mapDimensions.height),l=Nt(o,8);t.forces.push(l),e.huntCooldown=jC,t.hitpoints<=0?(Ie(r,fe.HumanDeath,t.position),ke(r.gameState,ue.Hit,t.position,be,t.id)):(ke(r.gameState,ue.Hit,t.position,be,t.id),t.fleeCooldown=5,Ie(r,fe.Attack,e.position)),ke(r.gameState,ue.Attack,e.position,be,e.id)}},ZR={id:"human-hunt-prey",sourceType:"human",targetType:"prey",maxDistance:Qn,checker:(e,t,r)=>{var o;return!!(((o=e.stateMachine)==null?void 0:o[0])===nr&&e.attackTargetId===t.id&&(!e.attackCooldown||e.attackCooldown<=0)&&t.hitpoints>0&&e.isAdult)},perform:(e,t,r)=>{let o=qf*1.2;e.gender==="male"&&(o*=1.3),t.hitpoints-=o;const l=ze(e.position,t.position,r.gameState.mapDimensions.width,r.gameState.mapDimensions.height),s=Nt(l,6);t.forces.push(s),e.attackCooldown=Iu,t.hitpoints<=0?(Ie(r,fe.HumanDeath,t.position),ke(r.gameState,ue.Hit,t.position,be,t.id)):(ke(r.gameState,ue.Hit,t.position,be,t.id),t.fleeCooldown=8,Ie(r,fe.Attack,e.position)),ke(r.gameState,ue.Attack,e.position,be,e.id)}},qR={id:"predator-attack-human",sourceType:"predator",targetType:"human",maxDistance:kn,checker:(e,t,r)=>{var o;return!!(e.isAdult&&(!e.attackCooldown||e.attackCooldown<=0)&&t.hitpoints>0&&(e.hunger>100||t.attackTargetId===e.id||t.attackTargetId&&((o=r.gameState.entities.entities[t.attackTargetId])==null?void 0:o.type)==="predator"))},perform:(e,t,r)=>{let o=vS;e.hunger>120&&(o*=1.3),t.hitpoints-=o,t.movementSlowdown={modifier:Qf,endTime:r.gameState.time+Jf};const l=ze(e.position,t.position,r.gameState.mapDimensions.width,r.gameState.mapDimensions.height),s=Nt(l,7);t.forces.push(s),e.attackCooldown=SS,t.hitpoints<=0?(e.hunger=Math.max(0,e.hunger-gh),Ie(r,fe.HumanDeath,t.position),ke(r.gameState,ue.Hit,t.position,be,t.id)):(ke(r.gameState,ue.Hit,t.position,be,t.id),Ie(r,fe.Attack,e.position)),ke(r.gameState,ue.Attack,e.position,be,e.id)}},QR={id:"human-attack-predator",sourceType:"human",targetType:"predator",maxDistance:Qn,checker:(e,t,r)=>{var o;return!!(((o=e.stateMachine)==null?void 0:o[0])===nr&&e.attackTargetId===t.id&&(!e.attackCooldown||e.attackCooldown<=0)&&t.hitpoints>0&&e.isAdult)},perform:(e,t,r)=>{let o=qf*.8;e.gender==="male"&&(o*=1.2);const l=Object.values(r.gameState.entities.entities).filter(d=>d.type==="human"&&d.id!==e.id).filter(d=>{const f=d;return Math.sqrt(Math.pow(f.position.x-e.position.x,2)+Math.pow(f.position.y-e.position.y,2))<100&&f.activeAction==="attacking"&&f.attackTargetId===t.id}).length;l>0&&(o*=1+l*.2),t.hitpoints-=o;const s=ze(e.position,t.position,r.gameState.mapDimensions.width,r.gameState.mapDimensions.height),u=Nt(s,8);t.forces.push(u),e.attackCooldown=Iu,t.hitpoints<=0?(Ie(r,fe.HumanDeath,t.position),ke(r.gameState,ue.Hit,t.position,be,t.id)):(ke(r.gameState,ue.Hit,t.position,be,t.id),t.hitpoints<t.maxHitpoints*.3&&(t.hunger+=20),Ie(r,fe.Attack,e.position)),ke(r.gameState,ue.Attack,e.position,be,e.id)}},JR={id:"prey-procreation",sourceType:"prey",targetType:"prey",maxDistance:Wt,checker:(e,t,r)=>!!(e.isAdult&&t.isAdult&&e.gender!==t.gender&&e.id!==t.id&&!e.isPregnant&&!t.isPregnant&&e.hunger<200&&t.hunger<200&&(!e.procreationCooldown||e.procreationCooldown<=0)&&(!t.procreationCooldown||t.procreationCooldown<=0)),perform:(e,t,r)=>{const o=e.gender==="female"?e:t;o.isPregnant=!0,o.gestationTime=r.gameState.ecosystem.preyGestationPeriod,e.procreationCooldown=r.gameState.ecosystem.preyProcreationCooldown,t.procreationCooldown=r.gameState.ecosystem.preyProcreationCooldown,ke(r.gameState,ue.Procreation,o.position,be,o.id),Ie(r,fe.Procreate,o.position)}},eP={id:"predator-procreation",sourceType:"predator",targetType:"predator",maxDistance:Qi,checker:(e,t,r)=>!!(e.isAdult&&t.isAdult&&e.gender!==t.gender&&e.id!==t.id&&!e.isPregnant&&!t.isPregnant&&e.hunger<200&&t.hunger<200&&(!e.procreationCooldown||e.procreationCooldown<=0)&&(!t.procreationCooldown||t.procreationCooldown<=0)),perform:(e,t,r)=>{const o=e.gender==="female"?e:t;o.isPregnant=!0,o.pregnancyFatherId=e.gender==="male"?e.id:t.id,o.gestationTime=r.gameState.ecosystem.predatorGestationPeriod,e.procreationCooldown=r.gameState.ecosystem.predatorProcreationCooldown,t.procreationCooldown=r.gameState.ecosystem.predatorProcreationCooldown,ke(r.gameState,ue.Procreation,o.position,be,o.id),Ie(r,fe.Procreate,o.position)}},tP={id:"preyChildFeeding",sourceType:"prey",targetType:"prey",maxDistance:Go,checker:(e,t)=>e.isAdult===!0&&e.gender==="female"&&e.hunger<80&&(!e.feedChildCooldownTime||e.feedChildCooldownTime<=0)&&t.isAdult===!1&&(t.motherId===e.id||t.fatherId===e.id)&&t.hunger>=cu&&e.activeAction==="feeding",perform:(e,t,r)=>{e.hunger=Math.min(120,e.hunger+10),t.hunger=Math.max(0,t.hunger-cu),e.feedChildCooldownTime=TS,(!t.lastChildFedEffectTime||r.gameState.time-t.lastChildFedEffectTime>2)&&(ke(r.gameState,ue.ChildFed,t.position,be,t.id),t.lastChildFedEffectTime=r.gameState.time),Ie(r,fe.ChildFed,t.position)}},nP={id:"predatorChildFeeding",sourceType:"predator",targetType:"predator",maxDistance:Go,checker:(e,t)=>e.isAdult===!0&&e.gender==="female"&&e.hunger<90&&(!e.feedChildCooldownTime||e.feedChildCooldownTime<=0)&&t.isAdult===!1&&(t.motherId===e.id||t.fatherId===e.id)&&t.hunger>=cu&&e.activeAction==="feeding",perform:(e,t,r)=>{e.hunger=Math.min(140,e.hunger+15),t.hunger=Math.max(0,t.hunger-cu),e.feedChildCooldownTime=TS,(!t.lastChildFedEffectTime||r.gameState.time-t.lastChildFedEffectTime>2)&&(ke(r.gameState,ue.ChildFed,t.position,be,t.id),t.lastChildFedEffectTime=r.gameState.time),Ie(r,fe.ChildFed,t.position)}},iP={id:"predator-eat-corpse",sourceType:"predator",targetType:"corpse",maxDistance:Qi,checker:(e,t,r)=>!!(e.isAdult&&e.hunger>30&&t.food.length>0&&(!e.eatingCooldownTime||e.eatingCooldownTime<=r.gameState.time)),perform:(e,t,r)=>{t.food.pop()&&(e.hunger=Math.max(0,e.hunger-gh),e.eatingCooldownTime=r.gameState.time+2,ke(r.gameState,ue.Eating,e.position,be,e.id),Ie(r,fe.Gather,e.position))}},rP={id:"predator-attack-rival",sourceType:"predator",targetType:"predator",maxDistance:kn,checker:(e,t,r)=>{var o;return!!(e.isAdult&&(!e.attackCooldown||e.attackCooldown<=0)&&t.hitpoints>0&&(e.hunger>100||t.attackTargetId===e.id||t.attackTargetId&&((o=r.gameState.entities.entities[t.attackTargetId])==null?void 0:o.type)==="predator"))},perform:(e,t,r)=>{let o=vS;e.hunger>120&&(o*=1.3),t.hitpoints-=o,t.movementSlowdown={modifier:Qf,endTime:r.gameState.time+Jf};const l=ze(e.position,t.position,r.gameState.mapDimensions.width,r.gameState.mapDimensions.height),s=Nt(l,7);t.forces.push(s),e.attackCooldown=SS,t.hitpoints<=0?(e.hunger=Math.max(0,e.hunger-gh),Ie(r,fe.HumanDeath,t.position),ke(r.gameState,ue.Hit,t.position,be,t.id)):(ke(r.gameState,ue.Hit,t.position,be,t.id),Ie(r,fe.Attack,e.position)),ke(r.gameState,ue.Attack,e.position,be,e.id)}},oP={id:"storageDeposit",sourceType:"human",targetType:"building",maxDistance:An,checker:(e,t,r)=>{var s;if(t.buildingType!=="storageSpot"||((s=e.stateMachine)==null?void 0:s[0])!==Ys||!t.isConstructed||e.food.length===0)return!1;t.storedFood||(t.storedFood=[]);const o=t.storageCapacity??0;return!(t.storedFood.length>=o||e.leaderId!==t.ownerId||r.gameState.time-(t.lastDepositTime??0)<z_)},perform:(e,t,r)=>{t.storedFood||(t.storedFood=[]);const o=e.food.pop();if(o&&t.storedFood.push({item:o,positionOffset:ES(t)}),t.lastDepositTime=r.gameState.time,Ie(r,fe.StorageDeposit,t.position),e.food.length===0||t.storedFood.length>=(t.storageCapacity??0)){const s=st(e,r.gameState);s&&qv(s,t.id,e.id)}}},sP={id:"storageRetrieve",sourceType:"human",targetType:"building",maxDistance:An,checker:(e,t,r)=>{var l;return!(t.buildingType!=="storageSpot"||((l=e.stateMachine)==null?void 0:l[0])!==js||!t.isConstructed||!t.storedFood||t.storedFood.length===0||e.food.length>=e.maxFood||e.leaderId!==t.ownerId||r.gameState.time-(t.lastRetrieveTime??0)<W_)},perform:(e,t,r)=>{if(!t.storedFood||t.storedFood.length===0)return;const o=t.storedFood.pop();if(o&&(e.food.push(o.item),ES(t)),t.lastRetrieveTime=r.gameState.time,Ie(r,fe.StorageRetrieve,t.position),e.food.length>=e.maxFood||t.storedFood.length===0){const s=st(e,r.gameState);s&&qv(s,t.id,e.id)}}},aP={id:"storageSteal",sourceType:"human",targetType:"building",maxDistance:An,checker:(e,t,r)=>{var d;if(t.buildingType!=="storageSpot"||((d=e.stateMachine)==null?void 0:d[0])!==ha||!t.isConstructed||!t.storedFood||t.storedFood.length===0||e.food.length>=e.maxFood||e.leaderId===t.ownerId)return!1;const o=e.leaderId?r.gameState.entities.entities[e.leaderId]:void 0;if(!o||!o.diplomacy||o.diplomacy[t.ownerId]!==mt.Hostile||r.gameState.time-(t.lastStealTime??0)<Y_)return!1;const u=Un({leaderId:t.ownerId},r.gameState);for(const f of u)if(V(e.position,f.position,r.gameState.mapDimensions.width,r.gameState.mapDimensions.height)<=Df)return!1;return!0},perform:(e,t,r)=>{if(!t.storedFood||t.storedFood.length===0)return;const o=t.storedFood.pop();o&&e.food.push(o.item),t.lastStealTime=r.gameState.time,Ie(r,fe.StorageSteal,t.position),ke(r.gameState,ue.Attack,t.position,.5)}},lP=[WR,...VR,xR,$R,zR,oP,sP,aP,XR,tP,nP,iP,KR,ZR,QR,qR,rP,JR,eP];function uP(e){const{gameState:t}=e,r=t,o=Object.values(t.entities.entities);for(const l of lP)for(const s of o){if(l.sourceType&&s.type!==l.sourceType)continue;const u=r.search[l.targetType].byRadius(s.position,l.maxDistance);for(const d of u){if(s.id===d.id)continue;V(s.position,d.position,t.mapDimensions.width,t.mapDimensions.height)<=l.maxDistance&&l.checker(s,d,e)&&l.perform(s,d,e)}}}function cP(e){e.visualEffects=e.visualEffects.filter(t=>e.time-t.startTime<=t.duration)}function dP(e){const t=e.search.berryBush.byProperty("type","berryBush"),r=e.search.predator.byProperty("type","predator"),o=e.search.human.byProperty("type","human");for(let l=0;l<20;l++){let s;if(t.length>0&&l<15){const f=t[Math.floor(Math.random()*t.length)],g=Math.random()*2*Math.PI,m=50+Math.random()*100;s={x:Math.max(50,Math.min(et-50,f.position.x+Math.cos(g)*m)),y:Math.max(50,Math.min(tt-50,f.position.y+Math.sin(g)*m))}}else s={x:50+Math.random()*(et-100),y:50+Math.random()*(tt-100)};let u=!0;const d=100;for(const f of r)if(Math.sqrt((s.x-f.position.x)**2+(s.y-f.position.y)**2)<d){u=!1;break}if(u){for(const f of o)if(Math.sqrt((s.x-f.position.x)**2+(s.y-f.position.y)**2)<d){u=!1;break}}if(u)return s}return{x:et*.3+Math.random()*et*.4,y:tt*.3+Math.random()*tt*.4}}function fP(e){const t=e.search.prey.byProperty("type","prey"),r=e.search.human.byProperty("type","human");for(let l=0;l<15;l++){let s;if(t.length>0&&l<10){const f=t[Math.floor(Math.random()*t.length)],g=Math.random()*2*Math.PI,m=100+Math.random()*150;s={x:Math.max(50,Math.min(et-50,f.position.x+Math.cos(g)*m)),y:Math.max(50,Math.min(tt-50,f.position.y+Math.sin(g)*m))}}else s={x:50+Math.random()*(et-100),y:50+Math.random()*(tt-100)};let u=!0;const d=150;for(const f of r)if(Math.sqrt((s.x-f.position.x)**2+(s.y-f.position.y)**2)<d){u=!1;break}if(u)return s}switch(Math.floor(Math.random()*4)){case 0:return{x:Math.random()*et,y:50+Math.random()*100};case 1:return{x:et-150+Math.random()*100,y:Math.random()*tt};case 2:return{x:Math.random()*et,y:tt-150+Math.random()*100};default:return{x:50+Math.random()*100,y:Math.random()*tt}}}function hP(e){const t=e.search.human.byProperty("type","human"),r=e.search.berryBush.byProperty("type","berryBush");for(let o=0;o<20;o++){const l={x:50+Math.random()*(et-100),y:50+Math.random()*(tt-100)};let s=!0;const u=80,d=60;for(const f of t)if(Math.sqrt((l.x-f.position.x)**2+(l.y-f.position.y)**2)<u){s=!1;break}if(s){for(const f of r)if(Math.sqrt((l.x-f.position.x)**2+(l.y-f.position.y)**2)<d){s=!1;break}}if(s)return l}return{x:Math.random()*et,y:Math.random()*tt}}function kS(e,t=4){console.log(` Respawning ${t} prey to prevent extinction`);const r=e;for(let o=0;o<t;o++){const l=dP(r),s=o%2===0?"male":"female";Fo(e.entities,l,s,void 0,void 0,aa())}}function OS(e,t=2){console.log(` Respawning ${t} predators to prevent extinction`);const r=e;for(let o=0;o<t;o++){const l=fP(r),s=o%2===0?"male":"female";Uo(e.entities,l,s,void 0,void 0,la())}}function gP(e){const t=e,r=t.search.prey.count(),o=t.search.predator.count();let l=!1;return r===0&&(kS(e,6),l=!0),o===0&&(OS(e,3),l=!0),l}function pP(e){const t=e,r=t.search.prey.count(),o=t.search.predator.count(),l=t.search.berryBush.count();let s=!1;if(r>0&&r<5){const u=Math.max(2,Math.floor(8-r));kS(e,u),s=!0}if(o>0&&o<2){const u=Math.max(1,Math.floor(3-o));OS(e,u),s=!0}if(l<5){console.log(` Boosting bush count from ${l} to help ecosystem`);for(let u=0;u<5;u++){const d=hP(t);pa(e.entities,d,e.time)}s=!0}return s}const mP=1,vP=.3,SP=.8,R0=.8,yP=.99,TP=.05;var MS=(e=>(e[e.INCREASE_PREY_GESTATION=0]="INCREASE_PREY_GESTATION",e[e.DECREASE_PREY_GESTATION=1]="DECREASE_PREY_GESTATION",e[e.INCREASE_PREY_PROCREATION_COOLDOWN=2]="INCREASE_PREY_PROCREATION_COOLDOWN",e[e.DECREASE_PREY_PROCREATION_COOLDOWN=3]="DECREASE_PREY_PROCREATION_COOLDOWN",e[e.INCREASE_PREY_HUNGER=4]="INCREASE_PREY_HUNGER",e[e.DECREASE_PREY_HUNGER=5]="DECREASE_PREY_HUNGER",e[e.INCREASE_PREDATOR_GESTATION=6]="INCREASE_PREDATOR_GESTATION",e[e.DECREASE_PREDATOR_GESTATION=7]="DECREASE_PREDATOR_GESTATION",e[e.INCREASE_PREDATOR_PROCREATION_COOLDOWN=8]="INCREASE_PREDATOR_PROCREATION_COOLDOWN",e[e.DECREASE_PREDATOR_PROCREATION_COOLDOWN=9]="DECREASE_PREDATOR_PROCREATION_COOLDOWN",e[e.INCREASE_PREDATOR_HUNGER=10]="INCREASE_PREDATOR_HUNGER",e[e.DECREASE_PREDATOR_HUNGER=11]="DECREASE_PREDATOR_HUNGER",e[e.INCREASE_BUSH_SPREAD=12]="INCREASE_BUSH_SPREAD",e[e.DECREASE_BUSH_SPREAD=13]="DECREASE_BUSH_SPREAD",e[e.NO_ACTION=14]="NO_ACTION",e))(MS||{});const Qd=Object.keys(MS).length/2;class AP{constructor(){Oe(this,"qTable",new Map);Oe(this,"epsilon",R0);Oe(this,"lastState",null);Oe(this,"lastAction",null)}discretizeState(t,r,o){const l=Math.min(4,Math.floor(t/25)),s=Math.min(4,Math.floor(r/5)),u=Math.min(4,Math.floor(o/15));return`${l}-${s}-${u}`}getQValue(t,r){return this.qTable.has(t)||this.qTable.set(t,new Map),this.qTable.get(t).get(r)||0}setQValue(t,r,o){this.qTable.has(t)||this.qTable.set(t,new Map),this.qTable.get(t).set(r,o)}getBestAction(t){let r=0,o=this.getQValue(t,0);for(let l=1;l<Qd;l++){const s=this.getQValue(t,l);s>o&&(o=s,r=l)}return r}chooseAction(t){return Math.random()<this.epsilon?Math.floor(Math.random()*Qd):this.getBestAction(t)}applyEmergencyCorrections(t,r,o,l){t<hi*.5&&(l.ecosystem.preyGestationPeriod=Math.max(To,l.ecosystem.preyGestationPeriod*.8),l.ecosystem.preyProcreationCooldown=Math.max(Ao,l.ecosystem.preyProcreationCooldown*.8),l.ecosystem.preyHungerIncreasePerHour=Math.max(wo,l.ecosystem.preyHungerIncreasePerHour*.9)),r<gi*.6&&(l.ecosystem.predatorGestationPeriod=Math.max(Io,l.ecosystem.predatorGestationPeriod*.75),l.ecosystem.predatorProcreationCooldown=Math.max(Eo,l.ecosystem.predatorProcreationCooldown*.75),l.ecosystem.predatorHungerIncreasePerHour=Math.max(_o,l.ecosystem.predatorHungerIncreasePerHour*.85)),o<pi*.5&&(l.ecosystem.berryBushSpreadChance=Math.min(Ls,l.ecosystem.berryBushSpreadChance*1.2)),t>hi*1.4&&(l.ecosystem.preyHungerIncreasePerHour=Math.min(Xi,l.ecosystem.preyHungerIncreasePerHour*1.05)),r>gi*1.4&&(l.ecosystem.predatorHungerIncreasePerHour=Math.min(Ki,l.ecosystem.predatorHungerIncreasePerHour*1.05)),o>pi*1.4&&(l.ecosystem.berryBushSpreadChance=Math.max(mi,l.ecosystem.berryBushSpreadChance*.95))}calculateReward(t,r,o){const l=Math.abs(t-hi),s=Math.abs(r-gi),u=Math.abs(o-pi),d=l/hi,f=s/gi,g=u/pi,m=d+f+g;return 100*Math.exp(-m*2)-50}applyAction(t,r){switch(t){case 0:r.ecosystem.preyGestationPeriod=Math.min(Cr,r.ecosystem.preyGestationPeriod+.2*(Cr-To));break;case 1:r.ecosystem.preyGestationPeriod=Math.max(To,r.ecosystem.preyGestationPeriod-.2*(Cr-To));break;case 2:r.ecosystem.preyProcreationCooldown=Math.min(Rr,r.ecosystem.preyProcreationCooldown+.2*(Rr-Ao));break;case 3:r.ecosystem.preyProcreationCooldown=Math.max(Ao,r.ecosystem.preyProcreationCooldown-.2*(Rr-Ao));break;case 4:r.ecosystem.preyHungerIncreasePerHour=Math.min(Xi,r.ecosystem.preyHungerIncreasePerHour+.2*(Xi-wo));break;case 5:r.ecosystem.preyHungerIncreasePerHour=Math.max(wo,r.ecosystem.preyHungerIncreasePerHour-.2*(Xi-wo));break;case 6:r.ecosystem.predatorGestationPeriod=Math.min(Pr,r.ecosystem.predatorGestationPeriod+.2*(Pr-Io));break;case 7:r.ecosystem.predatorGestationPeriod=Math.max(Io,r.ecosystem.predatorGestationPeriod-.2*(Pr-Io));break;case 8:r.ecosystem.predatorProcreationCooldown=Math.min(Nr,r.ecosystem.predatorProcreationCooldown+.2*(Nr-Eo));break;case 9:r.ecosystem.predatorProcreationCooldown=Math.max(Eo,r.ecosystem.predatorProcreationCooldown-.2*(Nr-Eo));break;case 10:r.ecosystem.predatorHungerIncreasePerHour=Math.min(Ki,r.ecosystem.predatorHungerIncreasePerHour+.2*(Ki-_o));break;case 11:r.ecosystem.predatorHungerIncreasePerHour=Math.max(_o,r.ecosystem.predatorHungerIncreasePerHour-.2*(Ki-_o));break;case 12:r.ecosystem.berryBushSpreadChance=Math.min(Ls,r.ecosystem.berryBushSpreadChance+.2*(Ls-mi));break;case 13:r.ecosystem.berryBushSpreadChance=Math.max(mi,r.ecosystem.berryBushSpreadChance-.2*(Ls-mi));break}}updateQTable(t,r,o,l){const s=this.getQValue(t,r),u=Math.max(...Array.from({length:Qd},(f,g)=>this.getQValue(l,g))),d=s+vP*(o+SP*u-s);this.setQValue(t,r,d)}step(t){const r=t,o=r.search.prey.count(),l=r.search.predator.count(),s=r.search.berryBush.count();this.applyEmergencyCorrections(o,l,s,t);const u=this.discretizeState(o,l,s);if(this.lastState!==null&&this.lastAction!==null){const f=this.calculateReward(o,l,s);this.updateQTable(this.lastState,this.lastAction,f,u)}const d=this.chooseAction(u);this.applyAction(d,t),this.epsilon=Math.max(TP,this.epsilon*yP),this.lastState=u,this.lastAction=d}reset(){this.qTable.clear(),this.epsilon=R0,this.lastState=null,this.lastAction=null}getStats(){return{qTableSize:this.qTable.size,explorationRate:this.epsilon}}}let FS=new AP;function IP(e){gP(e),pP(e),e.ecosystem.lastUpdateTime||(e.ecosystem.preyGestationPeriod=To+(Cr-To)*.3,e.ecosystem.preyProcreationCooldown=Ao+(Rr-Ao)*.3,e.ecosystem.preyHungerIncreasePerHour=wo+(Xi-wo)*.3,e.ecosystem.predatorGestationPeriod=Io+(Pr-Io)*.3,e.ecosystem.predatorProcreationCooldown=Eo+(Nr-Eo)*.3,e.ecosystem.predatorHungerIncreasePerHour=_o+(Ki-_o)*.3,e.ecosystem.berryBushSpreadChance=mi+(Ls-mi)*.7),FS.step(e)}function EP(e){e.ecosystem.lastUpdateTime||(e.ecosystem.lastUpdateTime=0),!(e.time-e.ecosystem.lastUpdateTime<mP)&&(e.ecosystem.lastUpdateTime=e.time,IP(e))}function wP(){return FS.getStats()}function _P(e,t){e.selectedBuildingType&&e.selectedBuildingType!=="removal"&&(e.autopilotControls.activeAutopilotAction=void 0,e.autopilotControls.hoveredAutopilotAction=void 0)}const CP=1/60;function RP(e,t){const r=_t(e);r&&(e.viewportCenter=eh(e.viewportCenter,r.position,jf*t))}function Ru(e,t){if(e.isPaused)return e;if(e.autosaveIntervalSeconds){const r=Date.now();r-e.lastAutosaveTime>e.autosaveIntervalSeconds*1e3&&(Hf(e),e.lastAutosaveTime=r)}for(;t>0;){const r=gu(e),o=Math.min(t,CP),l=o*(At/It);r.time+=l,RP(r,o),P_(r),EP(r),N_(r),IR({gameState:r,deltaTime:o}),uP({gameState:r,deltaTime:o}),cP(r),DR(r,o),_P(r),e=r,t-=o}return e}function Jd(e,t,r){e.save();const{x:o,y:l,width:s,height:u}=t.rect,d=Hv;if(e.beginPath(),e.moveTo(o+d,l),e.lineTo(o+s-d,l),e.quadraticCurveTo(o+s,l,o+s,l+d),e.lineTo(o+s,l+u-d),e.quadraticCurveTo(o+s,l+u,o+s-d,l+u),e.lineTo(o+d,l+u),e.quadraticCurveTo(o,l+u,o,l+u-d),e.lineTo(o,l+d),e.quadraticCurveTo(o,l,o+d,l),e.closePath(),e.fillStyle=t.isDisabled?bv:t.backgroundColor,e.fill(),t.activated){e.save();const f=(Math.sin(Date.now()/1e3*zv)+1)/2;e.strokeStyle=$v,e.lineWidth=2+f*2,e.globalAlpha=.7+f*.3,e.stroke(),e.restore()}if(t.lastActivated){const f=Date.now()-t.lastActivated;if(f<su){const g=1-f/su;e.fillStyle=xv,e.globalAlpha=g,e.fill(),e.globalAlpha=1}}r&&!t.isDisabled&&(e.fillStyle=rh,e.globalAlpha=.5,e.fill(),e.globalAlpha=1),e.fillStyle=t.isDisabled?Gv:t.textColor,t.icon?(e.font=`${u*.55}px "Press Start 2P", Arial`,e.textAlign="center",e.textBaseline="middle",e.fillText(t.icon,o+s/2,l+u/2),t.text&&(e.font=`${u*.18}px "Press Start 2P", Arial`,e.textAlign="right",e.textBaseline="bottom",e.fillText(t.text,o+s-4,l+u-2))):(e.textAlign="center",e.textBaseline="middle",e.fillText(t.text,o+s/2,l+u/2)),e.restore()}function PP(e,t,r,o){e.save(),e.font=`${Ym}px "Press Start 2P", Arial`,e.textAlign="center",e.textBaseline="bottom";const s=e.measureText(r).width,u=Ym,d=s+jm*2,f=u+jm*2,g=o.x-d/2,m=e.canvas.height,v=t.y<m/2?t.y+t.height-Vm:t.y-f+Vm;e.fillStyle=pw,e.fillRect(g,v,d,f),e.fillStyle=mw,e.fillText(r,o.x,v+f/2+u/2),e.restore()}function NP(e,t,r){e.save();const o=_t(t),l=[{id:"fastForwardButton",action:ge.FastForward,text:"FFWD [T]",currentWidth:fi*1.3,backgroundColor:Yi,textColor:yn,tooltip:"Fast-forward time",rect:{x:0,y:0,width:0,height:0}},{id:"pauseButton",action:ge.TogglePause,text:t.isPaused?"UN[P]AUSE":"[P]AUSE",backgroundColor:t.isPaused?Dl:Yi,currentWidth:t.isPaused?fi*1.4:fi*1.1,tooltip:t.isPaused?"Resume Game":"Pause Game",rect:{x:0,y:0,width:0,height:0},textColor:yn},{id:"muteButton",action:ge.ToggleMute,text:t.isMuted?"UN[M]UTE":"[M]UTE",backgroundColor:t.isMuted?Dl:Yi,tooltip:`Toggle Sound (${t.isMuted?"Muted":"Enabled"})`,currentWidth:fi,rect:{x:0,y:0,width:0,height:0},textColor:yn},{id:"returnToIntroButton",action:ge.ReturnToIntro,text:"EXIT",backgroundColor:Yi,tooltip:"Return to Main Menu [ESC]",currentWidth:fi*.9,rect:{x:0,y:0,width:0,height:0},textColor:yn}];if(t.uiButtons.push(...l),o){const g=fh(t,o),m=new Set(g.map(L=>L.type));let v=[{playerAction:se.Gather,buttonAction:ge.CommandGather,shortcut:"E",name:"Gather",toggleKey:"gathering",condition:()=>o.isAdult===!0},{playerAction:se.Eat,buttonAction:ge.CommandEat,shortcut:"F",name:"Eat"},{playerAction:se.Plant,buttonAction:ge.CommandPlant,shortcut:"B",name:"Plant",toggleKey:"planting",condition:()=>o.isAdult===!0},{playerAction:se.Procreate,buttonAction:ge.ToggleProcreationBehavior,shortcut:"R",name:"Procreation",toggleKey:"procreation",condition:()=>o.isAdult===!0},{playerAction:se.FeedChild,buttonAction:ge.ToggleFeedChildBehavior,shortcut:"H",name:"Feed Child",toggleKey:"feedChildren",condition:()=>o.isAdult===!0},{playerAction:se.Attack,buttonAction:ge.ToggleAttackBehavior,shortcut:"Q",name:"Attack",toggleKey:"attack",condition:()=>o.isAdult===!0&&o.leaderId===o.id},{playerAction:se.FollowMe,buttonAction:ge.CommandFollowMe,shortcut:"C",name:"Follow Me",toggleKey:"followLeader",condition:()=>o.isAdult===!0&&o.leaderId===o.id},{playerAction:se.CallToAttack,buttonAction:ge.CommandCallToAttack,shortcut:"V",name:"Call to Attack",condition:()=>o.isAdult===!0&&o.leaderId===o.id},{playerAction:se.TribeSplit,buttonAction:ge.CommandTribeSplit,shortcut:"K",name:"Split Tribe",condition:()=>o.leaderId!==void 0&&o.leaderId!==o.id&&o.isAdult===!0},{playerAction:se.Build,buttonAction:ge.CommandBuild,shortcut:"L",name:"Build",condition:()=>o.isAdult===!0&&o.leaderId===o.id}];v=v.filter(L=>L.condition?L.condition():!0);const y=1,w=v.length,I=w*sn+(w-1)*Sr,E=y*sn+(y-1)*Sr,C=(r-I)/2,F=e.canvas.height-E-20;if(v.forEach((L,D)=>{const H=D%w,x=Math.floor(D/w),U=C+H*(sn+Sr),$=F+x*(sn+Sr),ee=!!L.toggleKey,_e=ee&&t.autopilotControls.behaviors[L.toggleKey],Ce=!m.has(L.playerAction),Ne=L.playerAction===se.Build&&t.buildMenuOpen,Pe=!t.hasPlayerEnabledAutopilot||t.hasPlayerEnabledAutopilot<3?" (Press Shift to toggle Auto)":"",de=ee?`${L.name}${Pe}`:L.name,Ue=_e||Ne?Dl:Yi,Te={id:`commandButton_${L.name}`,action:L.buttonAction,rect:{x:U,y:$,width:sn,height:sn},icon:wu[L.playerAction],text:L.shortcut,backgroundColor:Ue,textColor:yn,currentWidth:sn,tooltip:de,isDisabled:Ce,activated:_e||Ne};t.uiButtons.push(Te)}),t.buildMenuOpen){const L=[{id:"buildMenu_storageSpot",action:ge.SelectStorageSpot,icon:"",shortcut:"1",name:"Storage Spot"},{id:"buildMenu_plantingZone",action:ge.SelectPlantingZone,icon:"",shortcut:"2",name:"Planting Zone"},{id:"buildMenu_removal",action:ge.SelectRemovalTool,icon:"",shortcut:"3",name:"Remove Building"}],D=L.length,H=D*sn+(D-1)*Sr,x=(r-H)/2,U=F-sn-Sr;L.forEach(($,ee)=>{const _e=x+ee*(sn+Sr),Ce=U,Ge=$.action===ge.SelectStorageSpot&&t.selectedBuildingType==="storageSpot"||$.action===ge.SelectPlantingZone&&t.selectedBuildingType==="plantingZone"||$.action===ge.SelectRemovalTool&&t.selectedBuildingType==="removal",Ne={id:$.id,action:$.action,rect:{x:_e,y:Ce,width:sn,height:sn},icon:$.icon,text:$.shortcut,backgroundColor:Ge?Dl:Yi,textColor:yn,currentWidth:sn,tooltip:$.name,activated:Ge};t.uiButtons.push(Ne),Jd(e,Ne,t.hoveredButtonId===Ne.id)})}}let s=r-Ze;l.forEach(g=>{const m=Ze,v=s-g.currentWidth;g.rect={x:v,y:m,width:g.currentWidth,height:Lv},Jd(e,g,t.hoveredButtonId===g.id),s-=g.currentWidth+gw});let u=null;t.uiButtons.filter(g=>g.id.startsWith("commandButton_")||g.id.startsWith("buildMenu_")).forEach(g=>{u||(u={x:g.rect.x,y:g.rect.y,width:g.rect.width,height:g.rect.height}),u.x=Math.min(u.x,g.rect.x),u.y=Math.min(u.y,g.rect.y),u.width=Math.max(u.width,g.rect.x+g.rect.width-u.x),u.height=Math.max(u.height,g.rect.y+g.rect.height-u.y),g.id.startsWith("commandButton_")&&Jd(e,g,t.hoveredButtonId===g.id)});const f=t.hoveredButtonId?t.uiButtons.find(g=>g.id===t.hoveredButtonId):void 0;return f&&f.tooltip&&t.mousePosition&&PP(e,f.rect,f.tooltip,t.mousePosition),e.restore(),{commandButtonsRect:u}}function DP(e){e.save(),e.fillStyle=Rw,e.fillRect(0,0,e.canvas.width,e.canvas.height),e.fillStyle=Pw,e.font=`${Nw}px "Press Start 2P", Arial`,e.textAlign="center",e.textBaseline="middle",e.fillText("PAUSED",e.canvas.width/2,e.canvas.height/2),e.restore()}function Mf(e,t,r,o){const l=t.x-r.width/2,s=t.y-r.height/2,u=l+e.x,d=s+e.y,f=(u%o.width+o.width)%o.width,g=(d%o.height+o.height)%o.height;return{x:f,y:g}}function Pu(e,t,r,o){let l=e.x-t.x,s=e.y-t.y;return Math.abs(l)>o.width/2&&(l=l-Math.sign(l)*o.width),Math.abs(s)>o.height/2&&(s=s-Math.sign(s)*o.height),{x:l+r.width/2,y:s+r.height/2}}function $l(e,t,r,o){const l=Pu(e.position,t,r,o),u=("radius"in e?e.radius:20)+20;return l.x>=-u&&l.x<=r.width+u&&l.y>=-u&&l.y<=r.height+u}function ln(e,t,r,o,l,...s){const u={...l.position};for(let d=-r;d<=r;d+=r)for(let f=-t;f<=t;f+=t)l.position.x=u.x+f,l.position.y=u.y+d,o(e,l,...s);l.position=u}const kP=25,OP=0,P0=28;function US(e,t,r,o,l,s,u,d,f,g){e.save();const{x:m,y:v}=Pu(t,u,{width:d,height:f},g);e.strokeStyle=o,e.lineWidth=s,e.setLineDash(l),e.beginPath(),e.arc(m,v,r+Eu,0,2*Math.PI),e.stroke(),e.restore()}function MP(e,t,r,o,l,s,u){if(t=t.filter(v=>v.type!==se.FollowMe),t.length===0)return;e.save(),t.forEach(v=>{v.targetEntity&&US(e,v.targetEntity.position,v.targetEntity.radius,nh,ih,2,o,l,s,u)}),e.font=`${Oo}px "Press Start 2P", Arial`,e.fillStyle="white",e.textAlign="center",e.textBaseline="bottom",e.shadowColor="black",e.shadowBlur=5;const{x:d,y:f}=Pu(r.position,o,{width:l,height:s},u);let g=0,m={};t.forEach(v=>{const y=wu[v.type];if(v.targetEntity){m[v.targetEntity.id]=(m[v.targetEntity.id]||0)+1;const w=v.targetEntity.position.x-o.x+l/2,I=v.targetEntity.position.y-o.y+s/2,E=`${y}${v.key.toUpperCase()}`,C=I-v.targetEntity.radius-Eu-Oo/2-(m[v.targetEntity.id]-1)*P0;e.fillText(E,w,C)}else{e.textAlign="left";const w=`${y}${v.key.toUpperCase()}`,I=d+kP,C=f+OP+g*P0;e.fillText(w,I,C),g++,e.textAlign="center"}}),e.restore()}const ye=(e,t,r,o,l,s,u)=>{s==="transparent"||o<=0||l<=0||(e.fillStyle=s,e.fillRect(Math.floor(t*u),Math.floor(r*u),Math.ceil(o*u),Math.ceil(l*u)))},N0=10,D0=10,Kn=6,ui=4,zl=2,FP=5,vn=4,UP=2,Ft=4,BP=2,Je=3,go=2,Wi=0,Ks=Wi+ui-1,Gt=Ks,ut=Ks+vn-1,LP="rgba(0, 0, 0, 0.4)",HP=4,bP=1,vh={name:"tribe-human-2d",referenceImage:"swos.png",description:`A 2D human character asset for the Tribe game. This includes ensuring that the unique animations for stances like 'eat' and 'procreate' do not erroneously appear in other stances, such as 'walk', which was observed in the provided rendered media. The 'idle' animation was updated to a leg sway to better match the provided video for that stance, replacing a simpler body bob.

# Visual style

Human characters in the Tribe game are inspired by classic 2D pixel art, they look like Sensible Soccer players(Sensible Soccer game visual style is IMPORTANT), with a simple and recognizable design. The characters are designed to be easily distinguishable and animated in a way that conveys their actions clearly.

Character in Tribe game look like people from stone age, they have simple clothing, no shoes, and no modern accessories. The characters are designed to be easily distinguishable and animated in a way that conveys their actions clearly.

# Technical details

The asset is rendered on a canvas using the CanvasRenderingContext2D API. The rendering function takes parameters for position, size, progress, stance, direction, gender, and age. The character can face left or right, and the rendering adapts based on the stance (e.g., idle, walk, eat, procreate).
The rendering function must be simple and efficient, it should not use complex patterns or gradients, and should focus on solid colors and basic shapes to maintain the pixel art aesthetic.

15% padding from all edges of the rendering box is required to ensure the character is not cut off during rendering.

Subtle shadow should be drawn under the character to give it a sense of depth.

# Rendering parameters

- age: The age of the character, which affects the size and proportions of the body parts. Age is a number between 1 and 60, with 20 being the average age.
- gender: 
  - The male characters should have only pants, while female cover their breasts with a top. The clothing should be simple and muted, reflecting a stone-age style.
  - Female characters should have long hair, while male should have short hair and beard.
  - Male characters should have a more robust, muscular build
  - Female characters should have thinner arms and legs, with a more pronounced waist and hips.
- isPregnant: (applicable only for females) Indicates if the character is pregnant, like very large belly. Pregnant characters should have a larger torso.
- direction: A vector indicating the character's facing direction. There should be at least 8 directions (like in Sensible Soccer): top left, top, top right, left, right, bottom left, bottom, bottom right. The character should be flipped horizontally if the direction vector's X component is negative.
             When moving up(top, top left, top right), the character back of the head should be visible, when moving down(Y > 0), the character face should be visible.
- hungryLevel: A number between 0 and 100 indicating how hungry the character is, hunger level 100 means the character is starving, 0 means the character is not hungry at all. So hungry characters should be thinner, with less body fat, and more pronounced muscles. The character's hunger level affects the size and proportions of the body parts, with hungrier characters being smaller and more gaunt.

# Rendering details

- All parts of the body must be connected
- Rendering must take into account direction vector (X and Y) to flip the character horizontally if needed
- The character's age affects the size and proportions of the body parts, with older characters being larger and more robust. Hair color should become gray for older characters.

# Stances

- 'idle': The character stands still, with a slight leg sway to indicate life.
- 'walk': The character moves forward, with legs and arms in motion.
- 'gathering': The character is gathering food from berry bushes, with arms reaching out and a slight bend at the knees.
- 'eat': The character holds food and brings it to their mouth, with a slight bend at the knees.
- 'procreate': The character performs a mating animation, with a specific pose and movement. There should be some additional visual effects to indicate this action, such as a slight glow or aura around the characters, or dust particles to indicate movement.
- 'attacking': The character performs an attack animation, with arms raised and a forward motion.
- 'defending': The character takes a defensive stance, with arms raised and a slight bend at the knees.
- 'stunned': The character is stunned and laying on the ground, with limbs relaxed and a neutral expression.
- 'dead': The character lies on the ground, with limbs relaxed and a neutral expression, slowly turns into a skeleton over time.

`,stances:["idle","walk","gathering","eat","procreate","dead","attacking","defending","stunned"],render(e,t,r,o,l,s,u,d="male",f=20,g=[1,0],m=!1,v=0){const y=["dead","stunned"].includes(u),w=y?D0+4:N0,I=y?N0+4:D0+Je,E=.15,C=Math.min(o*(1-2*E)/w,l*(1-2*E)/I),F=w*C,L=I*C,D=t+(o-F)/2,H=r+(l-L)/2;e.save(),g[0]<0&&!y?(e.translate(D+F,H),e.scale(-1,1)):e.translate(D,H);const U="#D09A5A",$=f>50?"#BDBDBD":"#281808",ee="#7F5C4A",_e="#6B4F3A",Ce="#E0D8C0",Ge="#A0522D",Ne=1-Math.max(0,Math.min(100,v))/100*.2,Pe=d==="male"?1.1:.9,de=.8+(Math.max(1,Math.min(f,60))-1)/59*.2;let Ue=FP*Ne*Pe*de,Te=UP*Ne*Pe*de,ne=BP*Ne*de;m&&d==="female"&&(Ue*=1.5);const W=Math.round((w-Ue)/2),X=Math.round((w-Kn)/2),Y=W-Te,P=W+Ue,B=1,K=W+(Ue/2-B/2)-ne,ie=W+(Ue/2+B/2),Se=g[1]<-.2&&Math.abs(g[0])<.7,ae=Z=>{e.fillStyle=LP,e.beginPath();const re=w/2,Be=Z;e.ellipse(Math.floor(re*C),Math.floor(Be*C),Math.max(1,Math.floor(HP*C)),Math.max(1,Math.floor(bP*C)),0,0,2*Math.PI),e.fill()},Ee=(Z,re)=>{d==="male"?(ye(e,W,Ks+Z,Ue,vn-go,re,C),ye(e,W,Ks+vn-go+Z,Ue,go,ee,C)):ye(e,W,Ks+Z,Ue,vn,_e,C)},Ae=(Z,re)=>{Se?ye(e,X,Wi+Z,Kn,ui,$,C):(ye(e,X,Wi+Z,Kn,ui,re,C),ye(e,X,Wi+Z,Kn,zl,$,C),d==="female"?(ye(e,X-1,Wi+zl+Z,1,ui,$,C),ye(e,X+Kn,Wi+zl+Z,1,ui,$,C)):ye(e,X+1,Wi+2+Z,Kn-2,ui-2,$,C))};switch(u){case"idle":{const Z=s*Math.PI*2,re=Math.sin(Z)*.5,he=(Math.cos(Z*2)+1)*.25;ae(ut+Je+1),ye(e,K+re,ut+he,ne,Je,U,C),ye(e,ie-re,ut+he,ne,Je,U,C),Ee(he,U),ye(e,Y,Gt+he,Te,Ft,U,C),ye(e,P,Gt+he,Te,Ft,U,C),Ae(he,U);break}case"walk":{const Z=s*Math.PI*2,re=Math.sin(Z)*2,he=Math.abs(Math.cos(Z))*1;ae(ut+Je+1),ye(e,K+re,ut+he,ne,Je,U,C),ye(e,ie-re,ut+he,ne,Je,U,C),Ee(he,U),ye(e,Y-re,Gt+he,Te,Ft,U,C),ye(e,P+re,Gt+he,Te,Ft,U,C),Ae(he,U);break}case"gathering":{const Z=s*Math.PI*2,re=1,Be=(Math.sin(Z)+1)/2*2,he=re+Math.abs(Math.cos(Z))*.5;ae(ut+Je+1),ye(e,K,ut+he,ne,Je-re,U,C),ye(e,ie,ut+he,ne,Je-re,U,C),Ee(he,U),ye(e,Y+1,Gt+he-Be,Te,Ft,U,C),ye(e,P-1,Gt+he-Be,Te,Ft,U,C),Ae(he,U);break}case"eat":{ae(ut+Je+1),ye(e,K,ut+1,ne,Je-1,U,C),ye(e,ie,ut+1,ne,Je-1,U,C),Ee(1,U);const Be=(Math.sin(s*Math.PI*4)+1)/2,he=X+Kn/2,Hn=Wi+ui/2,qe=P+(he-P)*Be,je=Gt+1+(Hn-(Gt+1))*Be;ye(e,Y,Gt+1,Te,Ft,U,C),ye(e,qe,je,Te,Ft,U,C),ye(e,qe,je-1,1,1,Ge,C),Ae(1,U);break}case"procreate":{const Z=(Math.sin(s*Math.PI*8)+1)/4,re=(Math.sin(s*Math.PI*6)+1)*.5,Be=1.5,he=Be-re;ae(ut+Je+1),ye(e,K,ut+he,ne,Je-Be,U,C),ye(e,ie,ut+he,ne,Je-Be,U,C),Ee(he,U),ye(e,Y,Gt+he,Te,Ft,U,C),ye(e,P,Gt+he,Te,Ft,U,C),Ae(he,U),e.globalAlpha=Z,Ee(he,"white"),e.globalAlpha=1;break}case"attacking":{const Z=Math.sin(s*Math.PI)*1.5,re=Math.abs(Math.sin(s*Math.PI));ae(ut+Je+1),ye(e,K-Z,ut+re,ne,Je,U,C),ye(e,ie+Z*.5,ut+re,ne,Je,U,C),Ee(re,U),ye(e,Y,Gt+re-2,Te,Ft,U,C),ye(e,P,Gt+re-2.5,Te,Ft,U,C),Ae(re,U);break}case"defending":{ae(ut+Je+1),ye(e,K,ut+1,ne,Je-1,U,C),ye(e,ie,ut+1,ne,Je-1,U,C),Ee(1,U),ye(e,Y-1,Gt+1-1,Te,Ft,U,C),ye(e,P+1,Gt+1-1,Te,Ft,U,C),Ae(1,U);break}case"stunned":case"dead":{const Z=u==="dead",re=Z?Math.min(1,s):0,Be=re>.5?Ce:U,he=d==="male"?ee:_e,Hn=re>.8?"transparent":$,qe=w/2,je=I/2,bn=2;ae(I-1),ye(e,qe-ne-bn,je,ne,Je,Be,C),ye(e,qe+bn,je,ne,Je,Be,C),ye(e,qe-Te-bn,je-vn+1,Te,Ft,Be,C),ye(e,qe+bn,je-vn+1,Te,Ft,Be,C);const Yt=qe-Ue/2,un=je-vn/2;d==="male"?(re<.7&&ye(e,Yt,un+vn-go,Ue,go,he,C),ye(e,Yt,un,Ue,vn-go,Be,C)):re<.7?ye(e,Yt,un,Ue,vn,he,C):ye(e,Yt,un,Ue,vn,Be,C);const Gn=qe-Kn/2,xn=je-vn/2-ui+1;if(ye(e,Gn,xn,Kn,ui,Be,C),Hn!=="transparent"&&ye(e,Gn,xn,Kn,zl,Hn,C),Z&&re>.6){const yi="#B0A890";for(let ir=0;ir<3;ir++)ye(e,Yt+1,un+ir*1+1,Ue-2,.5,yi,C)}break}default:ye(e,0,0,w,I,"magenta",C);break}e.restore()}};function GP(e,t,r,o,l){const s=t.x,u=t.y-r-o/2;e.save(),e.fillStyle=l,e.strokeStyle=l,e.lineWidth=1.5,e.beginPath(),e.rect(s-o/2,u,o,o/2),e.fill(),e.beginPath(),e.moveTo(s-o/2,u),e.lineTo(s-o/4,u-o/3),e.lineTo(s-o/6,u),e.moveTo(s-o/6,u),e.lineTo(s,u-o/2),e.lineTo(s+o/6,u),e.moveTo(s+o/6,u),e.lineTo(s+o/4,u-o/3),e.lineTo(s+o/2,u),e.stroke(),e.restore()}function ca(e,t,r,o,l,s=!1,u=!1,d=!1,f=!1){o<Xf&&(r=r*.75),vh.render(e,t.x-r/2,t.y-r/2,r,r,0,"idle",l,o,[0,0],!1,0);let g,m;s?(g=ow,m=th):u?(g=sw,m=Uv):d?(g=aw,m=Fv):f&&(g=lw,m=Mv),g&&m&&GP(e,t,r/2,g,m)}function xP(e,t,r,o,l,s){if(e.save(),o.length===0){e.restore();return}const u=o.length*l,d=4;let f;const g=u+(o.length-1)*d;o.length>1&&g>s?f=(s-u)/(o.length-1):f=d,o.length<=1&&(f=0);for(let m=0;m<o.length;m++){const{member:v,isPlayer:y,isHeir:w,isPartner:I,isParent:E}=o[m],C=t+m*(l+f)+l/2,F=r+l/4;ca(e,{x:C,y:F},l,v.age,v.gender,y,w,I,E)}e.restore()}function $P(e,t,r,o,l){if(r.length===0)return;e.save();const s=Vn,u=" 00",d=" 00";e.font=`${Nd}px "Press Start 2P", Arial`;const f=e.measureText(u).width,g=e.measureText(d).width,m=Vn+mn+Vn+mn+Vn+Gi+f+Vn/2+Gi+g,v=r.length*Nl+(r.length-1)*zm,y=l-v-Vn;e.fillStyle=cw,e.fillRect(s,y,m,v);for(let w=0;w<r.length;w++){const I=r[w],E=y+w*(Nl+zm),C=E+Nl/2;I.isPlayerTribe&&(e.fillStyle=uw,e.fillRect(s,E,m,Nl));let F=s+Vn;if(e.font=`${mn}px "Press Start 2P", Arial`,e.textBaseline="middle",e.textAlign="left",e.fillText(I.tribeBadge,F,C-mn/4),F+=mn+Vn,!I.isPlayerTribe){const L=I.diplomacyStatus===mt.Friendly?"":"",D=`diplomacyButton_${I.leaderId}`,H={x:F-2,y:C-mn/2-2,width:mn+4,height:mn+4},x={id:D,action:ge.ToggleDiplomacy,rect:H,text:"",icon:L,backgroundColor:"transparent",textColor:"white",currentWidth:mn,tooltip:`Toggle diplomacy with this tribe (Currently: ${I.diplomacyStatus})`,targetTribeId:I.leaderId};t.uiButtons.push(x),t.hoveredButtonId===D&&(e.fillStyle=rh,e.globalAlpha=.5,e.fillRect(H.x,H.y,H.width,H.height),e.globalAlpha=1),e.font=`${mn*.8}px "Press Start 2P", Arial`,e.textBaseline="middle",e.textAlign="center",e.fillText(L,F+mn/2,C)}F+=mn+Vn,I.adultCount>0&&(ca(e,{x:F+Gi/2,y:C},Gi,25,"male"),F+=Gi/2,e.font=`${Nd}px "Press Start 2P", Arial`,e.fillStyle="white",e.textBaseline="middle",e.textAlign="left",e.fillText(` ${I.adultCount}`,F,C),F+=e.measureText(` ${I.adultCount}`).width+Vn/2),I.childCount>0&&(ca(e,{x:F+Gi/2,y:C},Gi,1,"female"),F+=Gi/2,e.font=`${Nd}px "Press Start 2P", Arial`,e.fillStyle="white",e.textBaseline="middle",e.textAlign="left",e.fillText(` ${I.childCount}`,F,C))}e.restore()}function zP(e,t,r,o,l){const s=Vv,u=Xv,d=t+o-s-u,f=r+u;e.save(),e.lineWidth=2,e.strokeStyle=l?bw:Hw,e.beginPath();const g=5;e.moveTo(d+g,f+g),e.lineTo(d+s-g,f+s-g),e.moveTo(d+s-g,f+g),e.lineTo(d+g,f+s-g),e.stroke(),e.restore()}function WP(e,t,r,o){const{tutorialState:l,tutorial:s}=t;if(l.transitionState===$t.INACTIVE)return;const u=s.steps[l.currentStepIndex];if(!u)return;e.save(),e.globalAlpha=l.transitionAlpha;const d=Dw,f=kw,g=Ow,m=`${Od}px "Press Start 2P", Arial`,v=`${qm}px "Press Start 2P", Arial`,y=Fw,w=qm*1.5;e.font=v;const I=u.text.split(" ");let E="";const C=[];for(let Ce=0;Ce<I.length;Ce++){const Ge=E+I[Ce]+" ";e.measureText(Ge).width>d-f*2&&Ce>0?(C.push(E),E=I[Ce]+" "):E=Ge}C.push(E);const F=f*2+Od+f/2+C.length*w,L=(r-d)/2,D=o-F-160;e.fillStyle=Mw,e.beginPath(),e.moveTo(L+g,D),e.lineTo(L+d-g,D),e.quadraticCurveTo(L+d,D,L+d,D+g),e.lineTo(L+d,D+F-g),e.quadraticCurveTo(L+d,D+F,L+d-g,D+F),e.lineTo(L+g,D+F),e.quadraticCurveTo(L,D+F,L,D+F-g),e.lineTo(L,D+g),e.quadraticCurveTo(L,D,L+g,D),e.closePath(),e.fill(),e.fillStyle=y,e.textAlign="center",e.textBaseline="top",e.font=m,e.fillText(u.title,L+d/2,D+f),e.font=v;let H=D+f+Od+f/2;for(const Ce of C)e.fillText(Ce,L+d/2,H),H+=w;const x=t.hoveredButtonId==="tutorial-dismiss";zP(e,L,D,d,x),e.restore();const U=Vv,$=Xv,ee=L+d-U-$,_e=D+$;return{x:ee,y:_e,width:U,height:U}}function ef(e,t,r){e.save();const o=Lw,l={x:t.x-o,y:t.y-o,width:t.width+o*2,height:t.height+o*2};e.strokeStyle=Yv,e.lineWidth=jv+Math.sin(r*oh)*1.5,e.setLineDash([8,8]),e.strokeRect(l.x,l.y,l.width,l.height),e.restore()}function YP(e,t){e.fillStyle="white",e.font='30px "Press Start 2P", Arial',e.textAlign="center",e.fillText("Game Over!",e.canvas.width/2,e.canvas.height/2-60),e.font='20px "Press Start 2P", Arial',e.fillText("Lineage Extinct.",e.canvas.width/2,e.canvas.height/2-20),e.fillText(`Cause: ${t.causeOfGameOver||"Unknown"}`,e.canvas.width/2,e.canvas.height/2+20)}const Ff=10,jP=3,k0=Ff*.7;function VP(e,t,r,o,l){const{position:s,food:u,maxFood:d,ownerId:f,claimedUntil:g}=t;if(e.beginPath(),e.arc(s.x,s.y,Ff,0,Math.PI*2),e.fillStyle="#228B22",e.fill(),e.strokeStyle="#006400",e.lineWidth=1,e.stroke(),f&&g&&g>l&&o){const m=r.entities.entities[f];if(m){let v;m.id===o.id?v=th:Qv(o,m,r)?v=jE:v=Bv,v&&(e.strokeStyle=v,e.lineWidth=1+Math.sin(l*2)*.5,e.beginPath(),e.arc(s.x,s.y,Ff+2,0,Math.PI*2),e.stroke())}}if(u.length>0){const m=Math.PI*2/Math.min(u.length,d);for(let v=0;v<u.length;v++){const y=v*m,w=s.x+k0*Math.cos(y),I=s.y+k0*Math.sin(y);e.beginPath(),e.arc(w,I,jP,0,Math.PI*2),e.fillStyle="#FF0000",e.fill()}}}const O0=(e,t,r=70,o=50)=>{const l=e>>t&255;return`hsl(${Math.floor(l/255*360)}, ${r}%, ${o}%)`},XP=(e,t)=>{const r=e.match(/hsl\((\d+),\s*(\d+)%,\s*(\d+)%\)/);if(!r)return e;const[o,l,s]=[parseInt(r[1]),parseInt(r[2]),parseInt(r[3])];return`hsl(${o}, ${l}%, ${Math.max(0,s-t)}%)`},Wl=(e,t,r,o,l,s,u,d=!1)=>{e.save(),e.translate(t,r),e.rotate(s),e.fillStyle=d?XP(u,15):u,e.beginPath(),e.roundRect(-o/2,0,o,l,o/2),e.fill(),e.restore()},tf=(e,t)=>{const r=e.match(/hsl\((\d+),\s*(\d+)%,\s*(\d+)%\)/),o=75;if(!r)return`hsl(0, 0%, ${o}%)`;const[,l,s,u]=r.map(Number),d=s*(1-t),f=u+(o-u)*t;return`hsl(${l}, ${d}%, ${f}%)`},BS={name:"tribe-prey-2d",referenceImage:"swos.png",description:`A 2D prey asset for the Tribe game, featuring various stances and animations.

Prey is an animal which can be hunted by predators or humans in the Tribe game.

Preys look like small 4 leg mammals, with a simple and recognizable design. The characters are designed to be easily distinguishable and animated in a way that conveys their actions clearly.

# Visual style

Prey characters in the Tribe game are inspired by classic 2D pixel art, they look like Sensible Soccer players(Sensible Soccer game visual style is IMPORTANT), with a simple and recognizable design. The characters are designed to be easily distinguishable and animated in a way that conveys their actions clearly.

Character in Tribe game look like creatures from stone age, they have simple clothing, no shoes, and no modern accessories. The characters are designed to be easily distinguishable and animated in away that conveys their actions clearly.

Prey walks on all fours, unlike human (two legs).

Each prey is described by a unique gene code, which is a number that defines its appearance, size, and other characteristics. The gene code is used to generate the character's appearance, including body proportions, color, and other visual features. The gene code is a 32-bit integer, with each bit representing a specific characteristic of the character.

Prey should have should have visible body parts, such as head, torso, arms, and legs. The body parts should be connected and should not overlap. The character's body parts should be simple shapes, such as circles and rectangles, with solid colors and no gradients or patterns.

Preys are supposed to be sympathetic and friendly, so the character's face should have a friendly expression, with a smile and bright eyes. The character's eyes should be large and expressive, with a simple design.

# Technical details

The asset is rendered on a canvas using the CanvasRenderingContext2D API. The rendering function takes parameters for position, size, progress, stance, direction, gender, and age. The character can face left or right, and the rendering adapts based on the stance (e.g., idle, walk, eat, procreate).
The rendering function must be simple and efficient, it should not use complex patterns or gradients, and should focus on solid colors and basic shapes to maintain the pixel art aesthetic.

15% padding from all edges of the rendering box is required to ensure the character is not cut off during rendering.

Subtle shadow should be drawn under the a character to give it a sense of depth.

IMPORTANT: The character is visible from the side, just like in Sensible Soccer.

# Rendering parameters

- age: The age of the character, which affects the size and proportions of the body parts. Age is a number between 0 and 12, with 2 being the average age.
- gender:
  - 'male': Male prey are larger and more robust, with a more pronounced musculature.
  - 'female': Female prey are smaller and more agile, with a leaner build.
- isPregnant: (applicable only for females) Indicates if the character is pregnant, like very large belly. Pregnant characters should have a larger torso.
- direction: A vector indicating the character's facing direction. There should be at least 8 directions (like in Sensible Soccer): top left, top, top right, left, right, bottom left, bottom, bottom right. The character should be flipped horizontally if the direction vector's X component is negative.
             When moving up(top, top left, top right), the character back of the head should be visible, when moving down(Y > 0), the character face should be visible.
- hungryLevel: A number between 0 and 100 indicating how hungry the character is, hunger level 100 means the character is starving, 0 means the character is not hungry at all. So hungry characters should be thinner, with less body fat, and more pronounced muscles. The character's hunger level affects the size and proportions of the body parts, with hungrier characters being smaller and more gaunt.

# Rendering details

- All parts of the body must be connected
- Rendering must take into account direction vector (X and Y) to flip the character horizontally if needed
- The character's age affects the size and proportions of the body parts, with older characters being larger and more robust. Hair color should become gray for older characters.

# Stances

- 'idle': The character stands still, with a slight leg sway to indicate life.
- 'walk': The character moves forward, with legs and arms in motion.
- 'eat': The character holds food and brings it to their mouth, with a slight bend at the knees.
- 'procreate': The character performs a mating animation, with a specific pose and movement. There should be some additional visual effects to indicate this action, such as a slight glow or aura around the characters, or a dust particles to indicate movement.
- 'dead': The character lies on the ground, with limbs relaxed and a neutral expression, slowly turns into a grey skeleton over time. The character pose and body parts should not be animated in this stance, as the character is dead so it should not move.`,stances:["idle","walk","eat","dead","procreate"],render(e,t,r,o,l,s,u,d={gender:"male",age:2,direction:[1,0],isPregnant:!1,hungryLevel:0,geneCode:8405024}){e.save(),e.imageSmoothingEnabled=!1;const f=o*.15,g=t+o/2,m=r+l/2,v=o-f*2,y=l-f*2,{gender:w,age:I,direction:E,isPregnant:C,hungryLevel:F,geneCode:L}=d,D=.8+Math.min(I,10)/10*.4,H=w==="male"?1.05:.95,x=1-F/100*.3,U=v*.5*x*D*H;let $=y*.3*D*H;const ee=v*.15*D*H,_e=U*.2,Ce=y*.3,Ge=O0(L,0,30,50);let Ne=O0(L,8,50,40);if(I>45){const ae=Math.min(1,(I-45)/15);Ne=tf(Ne,ae)}e.translate(g,m),E[0]<0&&e.scale(-1,1);const Pe=Math.sin(s*Math.PI*2),de=Math.cos(s*Math.PI*2),Ue=Ce+$*.2;if(u==="dead"){const ae=Math.min(s,1);e.translate(0,y*.2),e.rotate(Math.PI/2);const Ee=tf(Ne,ae),Ae=tf(Ge,ae);e.globalAlpha=.5+ae*.5,e.strokeStyle=Ee,e.lineWidth=_e*.5,e.beginPath(),e.moveTo(-U*.4,0),e.lineTo(U*.4,0),e.stroke();for(let Z=-1;Z<=1;Z+=1)e.beginPath(),e.arc(0,0,$*.4,Math.PI*.4*Z-Math.PI*.2,Math.PI*.4*Z+Math.PI*.2),e.stroke();e.fillStyle=Ae,e.beginPath(),e.arc(U*.5,0,ee,0,Math.PI*2),e.fill(),e.fillStyle="black",e.beginPath(),e.arc(U*.55,0,ee*.3,0,Math.PI*2),e.fill(),e.restore();return}e.fillStyle="rgba(0, 0, 0, 0.1)",e.beginPath(),e.ellipse(0,Ue,U*.7,U*.25,0,0,2*Math.PI),e.fill();let Te=0,ne=0,W=0,X=0,Y=0,P=0;switch(u){case"idle":ne=Pe*(y*.02),W=Pe*.05,X=-Pe*.05,Y=-Pe*.05,P=Pe*.05;break;case"walk":ne=Math.abs(de)*(y*-.04),W=Pe*.7,X=-Pe*.7,Y=-Pe*.7,P=Pe*.7;break;case"eat":Te=y*.1,ne=y*.05,Te+=Pe*(y*.02);break;case"procreate":ne=y*.05;const ae=(1-de)*-v*.05;e.translate(ae,0),e.shadowColor="rgba(255, 182, 193, 0.9)",e.shadowBlur=10;break}C&&w==="female"&&($*=1.6);const B=ne,K=B-$*.2;Wl(e,U*-.35,K,_e,Ce,Y,Ne,!0),Wl(e,U*.35,K,_e,Ce,P,Ne,!0),e.fillStyle=Ne,e.beginPath(),e.ellipse(0,B,U/2,$/2,0,0,2*Math.PI),e.fill();const ie=U*.45,Se=K+Te;e.fillStyle=Ge,e.beginPath(),e.arc(ie,Se,ee,0,Math.PI*2),e.fill(),E[1]>=0&&(e.fillStyle="black",e.beginPath(),e.arc(ie+ee*.3,Se-ee*.2,ee*.15,0,Math.PI*2),e.fill()),Wl(e,U*-.35,K,_e,Ce,W,Ne),Wl(e,U*.35,K,_e,Ce,X,Ne),e.restore()}};function KP(e,t){let[r,o,l]=e.match(/\d+/g).map(Number);return r=Math.max(0,r-t),o=Math.max(0,o-t),l=Math.max(0,l-t),`rgb(${r}, ${o}, ${l})`}function ZP(e){const t=(e&16711680)>>16,r=(e&65280)>>8,o=e&255,l=`rgb(${t}, ${r}, ${o})`,s=KP(l,40),u=(e&255)%100+50,d=(e>>8&255)%100,f=(e>>16&255)%100,g=`rgb(${u}, ${d}, ${f})`,m=(e&8388608)!==0?"#00aaff":"#ffaa00";return{furColor:l,darkerFurColor:s,skinColor:g,eyeColor:m}}const LS={name:"tribe-predator-2d",referenceImage:"swos.png",description:`A 2D predator asset for the Tribe game, featuring various stances and animations.

Predator is an animal which can hunt and attack humans in the Tribe game. It is designed to be a threat to the player, adding an element of danger and challenge to the game world.

Predator look like bears or wolves, with a simple and recognizable design. The characters are designed to be easily distinguishable and animated in a way that conveys their actions clearly.

# Visual style

Predator characters in the Tribe game are inspired by classic 2D pixel art, they look like Sensible Soccer players(Sensible Soccer game visual style is IMPORTANT), with a simple and recognizable design. The characters are designed to be easily distinguishable and animated in a way that conveys their actions clearly.

Character in Tribe game look like creatures from stone age, they have simple clothing, no shoes, and no modern accessories. The characters are designed to be easily distinguishable and animated in away that conveys their actions clearly.

Predator walks on arms and legs, unlike human (two legs).

Each predator is described by a unique gene code, which is a number that defines its appearance, size, and other characteristics. The gene code is used to generate the character's appearance, including body proportions, color, and other visual features. The gene code is a 32-bit integer, with each bit representing a specific characteristic of the character.

Predator should have visible ears, eyes, and mouth with teeth. It must have a tail. Front legs should be shorter than back legs, and they should be positioned closer to the body. The character's body should be wider at the top and narrower at the bottom, with a slight curve to the back. The character's head should be larger than the body, with a pronounced jaw and sharp teeth.

# Technical details

The asset is rendered on a canvas using the CanvasRenderingContext2D API. The rendering function takes parameters for position, size, progress, stance, direction, gender, and age. The character can face left or right, and the rendering adapts based on the stance (e.g., idle, walk, eat, procreate).
The rendering function must be simple and efficient, it should not use complex patterns or gradients, and should focus on solid colors and basic shapes to maintain the pixel art aesthetic.

15% padding from all edges of the rendering box is required to ensure the character is not cut off during rendering.

Subtle shadow should be drawn under the a character to give it a sense of depth.

IMPORTANT: The character is visible from the side, just like in Sensible Soccer.

# Rendering parameters

- age: The age of the character, which affects the size and proportions of the body parts. Age is a number between 1 and 20, with 3 being the average age.
- gender:
  - 'male': Male predators are larger and more robust, with a more pronounced musculature.
  - 'female': Female predators are smaller and more agile, with a leaner build.
- isPregnant: (applicable only for females) Indicates if the character is pregnant, like very large belly. Pregnant characters should have a larger torso.
- direction: A vector indicating the character's facing direction. There should be at least 8 directions (like in Sensible Soccer): top left, top, top right, left, right, bottom left, bottom, bottom right. The character should be flipped horizontally if the direction vector's X component is negative.
             When moving up(top, top left, top right), the character back of the head should be visible, when moving down(Y > 0), the character face should be visible.
- hungryLevel: A number between 0 and 100 indicating how hungry the character is, hunger level 100 means the character is starving, 0 means the character is not hungry at all. So hungry characters should be thinner, with less body fat, and more pronounced muscles. The character's hunger level affects the size and proportions of the body parts, with hungrier characters being smaller and more gaunt.

# Rendering details

- All parts of the body must be connected
- Rendering must take into account direction vector (X and Y) to flip the character horizontally if needed
- The character's age affects the size and proportions of the body parts, with older characters being larger and more robust. Hair color should become gray for older characters.

# Stances

- 'idle': The character stands still, with a slight leg sway to indicate life.
- 'walk': The character moves forward, with legs and arms in motion.
- 'eat': The character holds food and brings it to their mouth, with a slight bend at the knees.
- 'procreate': The character performs a mating animation, with a specific pose and movement. There should be some additional visual effects to indicate this action, such as a slight glow or aura around the characters, or a dust particles to indicate movement.
- 'attacking': The character performs an attack animation, with arms raised and a forward motion.
- 'dead': The character lies on the ground, with limbs relaxed and a neutral expression, slowly turns into a grey skeleton over time. The character pose and body parts should not be animated in this stance, as the character is dead so it should not move.`,stances:["idle","walk","eat","dead","attacking","procreate"],render(e,t,r,o,l,s,u,d={gender:"male",age:20,direction:[1,0],isPregnant:!1,hungryLevel:0,geneCode:8405024}){const{gender:f,age:g,direction:m,isPregnant:v,hungryLevel:y,geneCode:w}=d;e.save();const I=o*.15,E=Math.max(1,Math.floor((o-I*2)/10)),C=m[0]<0;e.translate(t+o/2,r+l/2),C&&e.scale(-1,1);const F=ZP(w),L=.8+Math.min(g,20)/20*.4,D=f==="male"?1.05:.95,H=1-y/100*.25,x=L*D*H,U=Math.max(0,Math.min(1,(g-15)/5));e.filter=`grayscale(${U})`;const $=F.furColor,ee=F.darkerFurColor,_e=F.eyeColor,Ce="#FFFFFF",Ge="#c75c5c",Ne="#E0E0E0",Pe="#A0A0A0",de=l/2-2*E,Ue=Math.sin(s*Math.PI*2),Te=Math.abs(Ue);if(e.fillStyle="rgba(0,0,0,0.15)",e.beginPath(),e.ellipse(0,de,E*4,E,0,0,2*Math.PI),e.fill(),e.filter="none",u==="dead"){const qe=Math.min(1,s*2);e.save(),e.translate(0,de-E*3),e.rotate(-Math.PI/2);const je=(bn,Yt,un,Gn,xn=!1)=>{e.fillStyle=xn?Pe:Ne,e.fillRect(bn*E,Yt*E,un*E,Gn*E)};qe<1&&(e.globalAlpha=1-qe,e.fillStyle=$,e.beginPath(),e.ellipse(0,0,E*3,E*5,0,0,Math.PI*2),e.fill(),e.globalAlpha=1),qe>0&&(e.globalAlpha=qe,je(-1,-4,2,2),je(1,-3.5,1,1,!0),je(-.5,-2,1,5,!0),je(-2.5,-1,5,.5),je(-2.5,0,5,.5),je(-2.5,1,5,.5),je(-3,-2,-1,2,!0),je(3,-2,1,2),je(-3,2,-1,2,!0),je(3,2,1,2),e.globalAlpha=1),e.restore(),e.restore();return}e.fillStyle=$;let ne=0,W=0,X=0,Y=[0,0,0,0];switch(u){case"idle":ne=Ue*E*.1;break;case"walk":const qe=Math.sin(s*Math.PI*4);ne=Math.abs(qe)*-E*.5,Y=[qe*E,-qe*E,-qe*E,qe*E];break;case"attacking":const je=Math.sin(s*Math.PI*4);W=E*2+je*E,X=E*2,ne=E;break;case"eat":X=E*3+Te*E,ne=E*1.5,e.fillStyle=Ge,e.fillRect(-E,de-E,E*2,E);break;case"procreate":ne=Math.sin(s*Math.PI*8)*E*.3,e.fillStyle="rgba(139, 69, 19, 0.5)";for(let Yt=0;Yt<5;Yt++){const un=(Math.random()-.5)*E*8,Gn=de+(Math.random()-.5)*E*2;Te>.5&&e.fillRect(un,Gn,E*.5,E*.5)}break}const P=E*3*x*(v?1.3:1),B=E*5*x,K=-B/1.5,ie=de-P-E*2.5+ne;e.fillStyle=$,e.beginPath(),e.moveTo(K-E*.5,ie+P*.5),e.quadraticCurveTo(K-E*3,ie-E,K-E*2+Ue*E,ie+P+E),e.fill();const Se=E*1.2*x,ae=E*3*x,Ee=E*2.5*x,Ae=K+B*.8,Z=K+B*.2;e.fillStyle=ee,e.fillRect(Z,de-Ee,Se,Ee+Y[2]),e.fillRect(Ae,de-ae,Se,ae+Y[0]),e.fillStyle=$,e.beginPath(),e.moveTo(K,ie+P),e.lineTo(K,ie+E),e.quadraticCurveTo(K+B/2,ie,K+B,ie+E),e.lineTo(K+B,ie+P),e.fill(),e.fillStyle=$,e.fillRect(Z+E/2,de-Ee,Se,Ee+Y[3]),e.fillRect(Ae+E/2,de-ae,Se,ae+Y[1]);const re=E*3.5*x,Be=K+B-re*.3+W,he=ie-re*.3+X;e.fillStyle=$,e.beginPath(),e.arc(Be,he,re/2,0,Math.PI*2),e.fill(),e.beginPath(),e.ellipse(Be+re*.4,he+re*.2,E*1.5,E,0,0,Math.PI*2),e.fill(),m[1]>=0&&(e.fillStyle=_e,e.fillRect(Be+E*.5,he-E*.5,E*.5,E*.5),u==="attacking"&&(e.fillStyle=Ce,e.fillRect(Be+re*.5,he+re*.4,E,E*.4))),e.fillStyle=ee,e.beginPath(),e.moveTo(Be-re*.4,he-re*.3),e.lineTo(Be,he-re*.7),e.lineTo(Be,he-re*.2),e.fill(),e.restore()}},qP=9;function QP(e,t){const{position:r,gender:o,age:l,decayProgress:s,food:u,radius:d,originalEntityType:f,geneCode:g}=t;if(e.save(),e.globalAlpha=1-s,f==="human"?vh.render(e,r.x-d,r.y-d,d*2,d*2,s,"dead",o,l,[0,0],!1,0):f==="prey"?BS.render(e,r.x-d,r.y-d,d*2,d*2,s,"dead",{gender:o,age:l,direction:[0,0],isPregnant:!1,hungryLevel:0,geneCode:g||8405024}):f==="predator"&&LS.render(e,r.x-d,r.y-d,d*2,d*2,s,"dead",{gender:o,age:l,direction:[0,0],isPregnant:!1,hungryLevel:0,geneCode:g||8405024}),e.restore(),u.length>0){e.save(),e.font=`${qP}px Arial`,e.textAlign="center",e.textBaseline="middle";const m=wt*.9,v=Math.PI/Cv*3;u.forEach((y,w)=>{const I=w*v,E=r.x+m*Math.cos(I)*Math.atan2(w,w),C=r.y+m*Math.sin(I)*Math.atan2(w,w),F=Vf[y.type];e.fillText(F,E,C)}),e.restore()}}function Zi(e,t,r,o,l,s,u,d){e.save(),e.fillStyle=u,e.fillRect(t,r,o,l),e.fillStyle=d,e.fillRect(t,r,o*Math.max(0,s),l),e.restore()}function JP(e,t,r,o,l,s){if(e.save(),o.length===0){e.restore();return}const u=o.length*l;let d;u>s||u+(o.length-1)*4>s?d=(s-u)/(o.length-1):d=4,o.length===1&&(d=0);for(let f=0;f<o.length;f++){const g=Vf[o[f].type];e.fillText(g,t+f*(l+d),r)}e.restore()}function eN(e,t,r,o,l){const s=t.autopilotControls.hoveredAutopilotAction;if(!s)return;let u,d=wt/2;const f=wu[s.action],g=rS[s.action],m=`${f} ${g}`;if("targetEntityId"in s){const v=t.entities.entities[s.targetEntityId];v&&(u=v.position,d=v.radius)}else"position"in s&&(u=s.position);if(u){US(e,u,d,nh,ih,2,r,o,l,t.mapDimensions),e.save(),e.font=`${Oo}px "Press Start 2P", Arial`,e.fillStyle="white",e.textAlign="center",e.textBaseline="bottom",e.shadowColor="black",e.shadowBlur=5;const{x:v,y}=Pu(u,r,{width:o,height:l},t.mapDimensions),w=y-d-Eu-Oo/2;e.fillText(m,v,w),e.restore()}}function tN(e,t,r,o,l){e.save();const s=(Math.sin(l*oh)+1)/2,u=r+Eu+s*5;e.strokeStyle=nh,e.lineWidth=2,e.setLineDash(ih),e.beginPath(),e.arc(t.x,t.y,u,0,Math.PI*2),e.stroke(),e.setLineDash([]);const d=wu[o],f=rS[o];if(d){e.font=`${Oo*1.5}px "Press Start 2P", Arial`,e.textAlign="center",e.textBaseline="middle";const g=t.y-u-25;e.fillText(d,t.x,g),e.font=`${Oo*.8}px "Press Start 2P", Arial`,e.fillText(f,t.x,g+25)}e.restore()}function nN(e,t,r){e.save();const o=30,l=70,s=3,u=l/s;for(let d=0;d<s;d++){const f=d*u,g=(r*o+f)%l,m=1-g/l;e.strokeStyle=`rgba(255, 215, 0, ${m*.7})`,e.lineWidth=1+(1-m)*2,e.beginPath(),e.arc(t.x,t.y,g,0,Math.PI*2),e.stroke()}e.restore()}function iN(e,t){const{activeAutopilotAction:r,behaviors:o}=t.autopilotControls,l=_t(t);if(!l)return;const s=(u,d)=>{nN(u,d.position,t.time)};if(l.isCallingToFollow&&ln(e,t.mapDimensions.width,t.mapDimensions.height,s,{position:l.position}),o.followLeader&&!r&&ln(e,t.mapDimensions.width,t.mapDimensions.height,s,{position:l.position},70),r){let u,d=15;if("position"in r)u=r.position;else if("targetEntityId"in r){const f=t.entities.entities[r.targetEntityId];f&&(u=f.position,d=f.radius||30)}if(u&&r.action!==se.AutopilotFollowMe&&!l.isCallingToFollow){const f=(g,m)=>{tN(g,m.position,d,r.action,t.time)};ln(e,t.mapDimensions.width,t.mapDimensions.height,f,{position:{...u}},u,d+30)}}}function M0(e,t,r,o,l,s,u=!0){const d=t.split(" ");let f="";const g=[];for(let m=0;m<d.length;m++){const v=f+d[m]+" ";e.measureText(v).width>l&&m>0?(g.push(f),f=d[m]+" "):f=v}if(g.push(f),u)for(let m=0;m<g.length;m++)e.fillText(g[m],r,o+m*s);return g.length*s}function rN(e){return 1-Math.pow(1-e,3)}function oN(e,t,r,o){t.notificationButtonRects={dismiss:{},view:{}};const l=t.notifications.filter(u=>!u.isDismissed);if(l.length===0)return;e.save();let s=o-Xw;for(const u of l){const d=r-Ol-yr;e.font=`${Md}px "Press Start 2P", Arial`;const f=d+yr,g=Ol-yr*2,m=M0(e,u.message,-9999,-9999,g,Md*1.2,!1),v=yr*2+m+Xn,y=s-v,w=Date.now()-u.creationTime,I=Math.min(w/Vw,1),E=rN(I),C=o,F=C+(y-C)*E;e.fillStyle=xw,e.beginPath(),e.roundRect(d,F,Ol,v,Gw),e.fill(),e.fillStyle=$w,e.textBaseline="top",M0(e,u.message,f,F+yr,g,Md*1.2,!0);const L=F+v-Xn-yr/2,D=d+Ol-Xn-yr/2,H={x:D,y:L,width:Xn,height:Xn};t.notificationButtonRects&&(t.notificationButtonRects.dismiss[u.id]=H);const x=t.hoveredButtonId===`notification-dismiss-${u.id}`;if(e.fillStyle=x?e0:zw,e.font=`${Xn}px Arial`,e.textAlign="center",e.textBaseline="middle",e.fillText("",H.x+H.width/2,H.y+H.height/2),u.targetEntityIds||u.targetPosition||u.targetArea||u.targetRadius){const ee={x:D-Xn-Jm,y:L,width:Xn,height:Xn};t.notificationButtonRects&&(t.notificationButtonRects.view[u.id]=ee);const _e=t.hoveredButtonId===`notification-view-${u.id}`;e.fillStyle=_e?e0:Ww,e.font=`${Xn*(_e?1.5:1.2)}px Arial`,e.fillText("",ee.x+ee.width/2,ee.y+ee.height/2)}s-=v+Jm}e.restore()}function sN(e){return e.length===0?0:e.reduce((r,o)=>r+o,0)/e.length}function nf(e,t,r,o,l,s,u,d){e.save(),e.fillStyle="rgba(255, 255, 255, 0.1)",e.fillRect(o,l,s,u),e.strokeStyle="#555",e.lineWidth=1,e.strokeRect(o,l,s,u);const f=sN(r);e.fillStyle="white",e.font="11px monospace",e.textAlign="left",e.fillText(`${t}: ${f.toFixed(2)}ms`,o+Ze,l+Ze+8);const g=Math.max(...r,1),m=r.map(v=>v/g*u);if(e.beginPath(),e.strokeStyle=d,e.lineWidth=2,m.length>1){e.moveTo(o,l+u-m[0]);for(let v=1;v<m.length;v++){const y=o+v/(m.length-1)*s,w=l+u-m[v];e.lineTo(y,w)}}else if(m.length===1){const v=l+u-m[0];e.moveTo(o,v),e.lineTo(o+s,v)}e.stroke(),e.fillStyle="rgba(255, 255, 255, 0.7)",e.font="10px monospace",e.textAlign="right",e.fillText(`${g.toFixed(2)}ms`,o+s-Ze,l+Ze+8),e.restore()}function aN(e,t,r){const{performanceMetrics:o}=t;if(!o)return;const l=280,s=240,u=r-l-Ze,d=Ze+Sn*2;e.save(),e.fillStyle="rgba(0, 0, 0, 0.8)",e.fillRect(u,d,l,s),e.strokeStyle="#444",e.lineWidth=2,e.strokeRect(u,d,l,s),e.fillStyle="white",e.font="12px monospace",e.textAlign="left";let f=d+Ze+5;const g=u+Ze;e.fillStyle="#66ccff",e.font="bold 14px monospace",e.fillText(" Performance Debugger",g,f),f+=25,e.fillStyle="white",e.font="12px monospace";const m=lN(t);e.fillText(`FPS: ${m.toFixed(1)}`,g,f),f+=20;const v=l-Ze*2,y=45,w=10;nf(e,"Render",rf(t,"renderTime"),g,f,v,y,"#4CAF50"),f+=y+w,nf(e,"World Update",rf(t,"worldUpdateTime"),g,f,v,y,"#2196F3"),f+=y+w,nf(e,"AI Update",rf(t,"aiUpdateTime"),g,f,v,y,"#FFC107"),e.fillStyle="#888",e.font="10px monospace",e.textAlign="center",e.fillText("Press '2' to toggle this panel",u+l/2,d+s-10),e.restore()}function lN(e){const{performanceMetrics:t}=e;if(!t||t.history.length===0)return 0;const r=t.history[t.history.length-1].bucketTime/(At/It);return t.history.filter(s=>r-s.bucketTime/(At/It)<1).length}function uN(e,t){if(e.length===0)return[];const r=new Map;for(const s of e){const u=Math.floor(s.bucketTime/(At/It));r.set(u,(r.get(u)||0)+s[t])}return Array.from(r.keys()).sort().map(s=>r.get(s)).slice(0,-1).slice(1).reverse()}function rf(e,t){return uN(e.performanceMetrics.history,t)}function Sh(e,t,r){if(!t.aiBlackboard)return;const o=t.aiBlackboard.nodeExecutionData,l=t.type==="human"?_S:t.type==="predator"?RS:t.type==="prey"?CS:null;if(!l)return;e.save(),e.font=`${yw}px Arial`,e.textAlign="left",e.textBaseline="top";const s=y=>{switch(y){case T.SUCCESS:return Aw;case T.FAILURE:return Iw;case T.RUNNING:return Ew;case T.NOT_EVALUATED:case null:default:return ww}},u=y=>{if(!y.name||!o[y.name])return{width:0,height:0};let w=0,I=0;const E=o[y.name],C=` ${y.name}`+(E!=null&&E.debugInfo?`: ${E.debugInfo}`:""),F=e.measureText(C).width,L=(y.depth??0)*Xm+8+F+Zm+Ns+20;if(w=Math.max(w,L),I+=kd,y.children)for(const D of y.children){const H=u(D);w=Math.max(w,H.width),I+=H.height}else if(y.child){const D=u(y.child);w=Math.max(w,D.width),I+=D.height}return{width:w,height:I}},d=(y,w,I,E)=>{if(!y.name||!o[y.name])return w;let C=w;const F=o[y.name],L=I+2+(y.depth??0)*Xm;let D=T.NOT_EVALUATED,H=Km,x="";if(F){D=F.status,x=F.debugInfo;const ee=Cw/It*At,_e=r-F.lastExecuted,Ce=Math.max(0,1-_e/ee);H=WE(Km,_w,Ce),_e>Js&&(D=T.NOT_EVALUATED)}const U=s(D);e.fillStyle=U,e.fillText("",L,C),e.fillStyle=H;const $=` ${y.name}`+(x?`: ${x}`:"");if(e.fillText($,L+8,C),F&&F.executionHistory.length>0){const{executionHistory:ee}=F,_e=Wv/It*At,Ce=r,Ge=Ce-_e,Ne=I+E-Ns-Zm;let Pe=Ne;const de=C+(kd-kl)/2,Ue=ee.filter(K=>K.time<Ge);let Te=Ue.length>0?Ue[Ue.length-1].status:null,ne=Ge;const W=ee.filter(K=>K.time>=Ge&&K.time<=Ce),X=Ns/_e;e.fillStyle="rgba(255, 255, 255, 0.1)",e.fillRect(Ne,de,Ns,kl);for(const K of W){const Se=(K.time-ne)*X;Se>0&&(e.fillStyle=s(Te),e.fillRect(Pe,de,Se,kl),Pe+=Se),Te=K.status,ne=K.time}r-ne>Js&&(Te=T.NOT_EVALUATED);const P=(Ce-ne)*X;e.fillStyle=s(Te);const B=Ne+Ns-Pe;e.fillRect(Pe,de,Math.min(P,B),kl)}if(C+=kd,y.children)for(const ee of y.children)C=d(ee,C,I,E);else y.child&&(C=d(y.child,C,I,E));return C},{width:f,height:g}=u(l);if(g===0){e.restore();return}const m=t.position.x+vw,v=t.position.y+Sw-g/2;e.fillStyle=Tw,e.fillRect(m,v,f,g+4),d(l,v+2,m,f),e.restore()}const cN={moving:"walk",gathering:"gathering",eating:"eat",feeding:"eat",procreating:"procreate",idle:"idle",attacking:"attacking",planting:"gathering",depositing:"gathering",retrieving:"gathering"};function dN(e,t){var d;const{radius:r,position:o,activeAction:l="idle"}=t,s=((d=t.stateMachine)==null?void 0:d[0])||"N/A",u=t.isAdult?wt+20:wt*.6+20;e.save(),e.fillStyle="white",e.font="10px Arial",e.textAlign="center",e.fillText(`Action: ${l}`,o.x,o.y-u),e.fillText(`State: ${s}`,o.x,o.y-u+10),e.fillText(`HP: ${t.hitpoints}`,o.x,o.y-u+20),e.fillText(`Cooldown: ${t.attackCooldown||"N/A"}`,o.x,o.y-u+30),e.fillText(`Tribe: ${t.leaderId||"N/A"}`,o.x,o.y-u+40),e.restore(),e.beginPath(),e.arc(o.x,o.y,r,0,Math.PI*2),e.strokeStyle="rgba(255, 0, 0, 0.5)",e.lineWidth=1,e.stroke(),e.closePath()}function fN(e,t,r,o,l){e.save(),e.font=`${If}px Arial`,e.textAlign="center",e.textBaseline="middle",e.fillText(r,t.x,t.y-(o?wt:Ho)-If-l),e.restore()}function hN(e,t,r,o,l){const s=t.x,u=t.y-r-o/2;e.save(),e.fillStyle=l,e.strokeStyle=l,e.lineWidth=1.5,e.beginPath(),e.rect(s-o/2,u,o,o/2),e.fill(),e.beginPath(),e.moveTo(s-o/2,u),e.lineTo(s-o/4,u-o/3),e.lineTo(s-o/6,u),e.moveTo(s-o/6,u),e.lineTo(s,u-o/2),e.lineTo(s+o/6,u),e.moveTo(s+o/6,u),e.lineTo(s+o/4,u-o/3),e.lineTo(s+o/2,u),e.stroke(),e.restore()}function gN(e,t,r){var d;const{position:o,radius:l}=t,s=o.x-Dd/2,u=o.y-l-dw;if(((d=t.stateMachine)==null?void 0:d[0])===nr){const f=t.stateMachine[1],g=r-f.attackStartTime,m=Math.min(g/kv,1);Zi(e,s,u,Dd,Wm,m,Vi,fw)}else if(t.attackCooldown&&t.attackCooldown>0){const f=1-t.attackCooldown/Iu;Zi(e,s,u,Dd,Wm,f,Vi,hw)}}function pN(e,t,r){const l="";e.save(),e.font="15px Arial",e.textAlign="center",e.textBaseline="bottom",e.shadowColor="black",e.shadowBlur=3,e.fillText(l,t.x,t.y-r),e.restore()}function mN(e,t,r=!1,o=!1,l=!1,s=!1,u=!1,d=!1,f=!1,g=!1,m,v){const{position:y,activeAction:w="idle"}=t,I=t.isAdult?wt:wt*.6,E=cN[w]||"idle";vh.render(e,y.x-I,y.y-I,I*2,I*2,t.animationProgress||0,E,t.gender,t.age,[t.direction.x,t.direction.y],t.isPregnant??!1,t.hunger),d&&(e.save(),e.strokeStyle=Bv,e.lineWidth=2,e.beginPath(),e.arc(y.x,y.y,I+3,0,2*Math.PI),e.stroke(),e.restore());let C,F;if(u?(C=XE,F=Uv):r?(C=VE,F=th):l?(C=KE,F=YE):o?(C=ZE,F=Mv):s&&(C=qE,F=Fv),C&&F&&hN(e,y,I,C,F),t.tribeBadge&&fN(e,y,t.tribeBadge,t.isAdult??!1,C??0),f){let D=(t.isAdult?wt:Ho)+5;C&&(D+=C),t.tribeBadge&&(D+=If),pN(e,y,D)}const L=g&&(v===void 0||t.id===v);L&&t.aiBlackboard&&Sh(e,t,m),gN(e,t,m),L&&dN(e,t)}const vN={grazing:"eat",moving:"walk",procreating:"procreate",feeding:"eat",idle:"idle"};function SN(e,t){var d;const{radius:r,position:o,activeAction:l="idle"}=t,s=((d=t.stateMachine)==null?void 0:d[0])||"N/A",u=t.isAdult?wt+20:wt*.6+20;e.save(),e.fillStyle="white",e.font="10px Arial",e.textAlign="center",e.fillText(`Action: ${l}`,o.x,o.y-u),e.fillText(`State: ${s}`,o.x,o.y-u+10),e.fillText(`HP: ${t.hitpoints}`,o.x,o.y-u+20),e.fillText(`Hunger: ${Math.round(t.hunger)}`,o.x,o.y-u+30),e.fillText(`Age: ${Math.round(t.age)}`,o.x,o.y-u+40),e.restore(),e.beginPath(),e.arc(o.x,o.y,r,0,Math.PI*2),e.strokeStyle="rgba(0, 255, 0, 0.5)",e.lineWidth=1,e.stroke(),e.closePath()}function yN(e,t,r=!1,o=0,l){var m,v;const{position:s,activeAction:u="idle"}=t,d=t.isAdult?t.radius:t.radius*.6,f=vN[u]||"idle";if(BS.render(e,s.x-d,s.y-d,d*2,d*2,t.animationProgress||0,f,{gender:t.gender,age:t.age,direction:[((m=t.direction)==null?void 0:m.x)||1,((v=t.direction)==null?void 0:v.y)||0],isPregnant:t.isPregnant??!1,hungryLevel:t.hunger,geneCode:t.geneCode}),t.hitpoints<t.maxHitpoints){const y=d*1.5,w=3,I=s.x-y/2,E=s.y-d-8;e.fillStyle="#555",e.fillRect(I,E,y,w);const C=t.hitpoints/t.maxHitpoints;e.fillStyle=C>.5?"#4CAF50":C>.25?"#FFC107":"#F44336",e.fillRect(I,E,y*C,w)}const g=r&&(l===void 0||t.id===l);g&&t.aiBlackboard&&Sh(e,t,o),g&&SN(e,t)}const TN={attacking:"attacking",eating:"eat",moving:"walk",procreating:"procreate",feeding:"eat",idle:"idle"};function AN(e,t){var d;const{radius:r,position:o,activeAction:l="idle"}=t,s=((d=t.stateMachine)==null?void 0:d[0])||"N/A",u=t.isAdult?wt+20:wt*.6+20;e.save(),e.fillStyle="white",e.font="10px Arial",e.textAlign="center",e.fillText(`Action: ${l}`,o.x,o.y-u),e.fillText(`State: ${s}`,o.x,o.y-u+10),e.fillText(`HP: ${t.hitpoints}`,o.x,o.y-u+20),e.fillText(`Hunger: ${Math.round(t.hunger)}`,o.x,o.y-u+30),e.fillText(`Age: ${Math.round(t.age)}`,o.x,o.y-u+40),e.restore(),e.beginPath(),e.arc(o.x,o.y,r,0,Math.PI*2),e.strokeStyle="rgba(255, 0, 0, 0.5)",e.lineWidth=1,e.stroke(),e.closePath()}function IN(e,t,r=!1,o=0,l){var m,v;const{position:s,activeAction:u="idle"}=t,d=t.isAdult?t.radius:t.radius*.6,f=TN[u]||"idle";if(LS.render(e,s.x-d,s.y-d,d*2,d*2,t.animationProgress||0,f,{gender:t.gender,age:t.age,direction:[((m=t.direction)==null?void 0:m.x)||1,((v=t.direction)==null?void 0:v.y)||0],isPregnant:t.isPregnant??!1,hungryLevel:t.hunger,geneCode:t.geneCode}),t.hitpoints<t.maxHitpoints){const y=d*1.5,w=3,I=s.x-y/2,E=s.y-d-8;e.fillStyle="#555",e.fillRect(I,E,y,w);const C=t.hitpoints/t.maxHitpoints;e.fillStyle=C>.5?"#4CAF50":C>.25?"#FFC107":"#F44336",e.fillRect(I,E,y*C,w)}(t.attackCooldown&&t.attackCooldown>0||t.huntCooldown&&t.huntCooldown>0)&&(e.strokeStyle="#FF8C00",e.lineWidth=3,e.beginPath(),e.arc(s.x,s.y,d+3,0,2*Math.PI),e.stroke());const g=r&&(l===void 0||t.id===l);g&&t.aiBlackboard&&Sh(e,t,o),g&&AN(e,t)}const HS=15;function F0(e,t,r,o,l=1.5){const s=r-t.startTime,u=Math.min(s/t.duration,1),d=1-u,g=1+Math.sin(u*Math.PI*2)*(l-1),m=HS*g;e.save(),e.globalAlpha=d,e.beginPath(),e.arc(t.position.x,t.position.y,Math.max(0,m),0,Math.PI*2),e.fillStyle=o,e.fill(),e.restore()}function po(e,t,r,o,l=2){const s=r-t.startTime,u=Math.min(s/t.duration,1),d=1-u,f=HS*2*u;e.save(),e.globalAlpha=d,e.beginPath(),e.arc(t.position.x,t.position.y,f,0,Math.PI*2),e.strokeStyle=o,e.lineWidth=l,e.stroke(),e.restore()}function xi(e,t,r,o){const l=r-t.startTime,s=Math.min(l/t.duration,1),u=1-s,d=-20*s;e.save(),e.globalAlpha=u,e.font="20px Arial",e.textAlign="center",e.fillText(o,t.position.x,t.position.y+d),e.restore()}function EN(e,t,r){switch(t.type){case ue.Hunger:F0(e,t,r,"rgba(255, 165, 0, 0.7)",1);break;case ue.Procreation:xi(e,t,r,"");break;case ue.Pregnant:F0(e,t,r,"rgba(255, 105, 180, 0.7)",1.2);break;case ue.TargetAcquired:po(e,t,r,"rgba(255, 0, 0, 0.8)",3);break;case ue.Attack:xi(e,t,r,"");break;case ue.Partnered:xi(e,t,r,"");break;case ue.BushClaimed:po(e,t,r,"rgba(0, 255, 0, 0.7)",2);break;case ue.BushClaimLost:po(e,t,r,"rgba(128, 128, 128, 0.7)",2);break;case ue.Eating:xi(e,t,r,"");break;case ue.ChildFed:xi(e,t,r,"");break;case ue.AttackDeflected:xi(e,t,r,"");break;case ue.AttackResisted:xi(e,t,r,"");break;case ue.Hit:xi(e,t,r,"");break;case ue.SeizeBuildup:po(e,t,r,"rgba(255, 215, 0, 0.8)",4);break;case ue.Seize:po(e,t,r,"rgba(148, 0, 211, 0.8)",4);break;case ue.CallToAttack:po(e,t,r,"rgba(255, 255, 0, 0.8)",4);break}}function U0(e,t,r,o,l,s,u){e.save();const{position:d}=t;e.strokeStyle=o,e.lineWidth=l+Math.sin(u*s)*(l/2),e.setLineDash([8,8]),e.beginPath(),e.arc(d.x,d.y,r,0,2*Math.PI),e.stroke(),e.restore()}const B0=8,wN=1.5,_N=.5,L0=2,CN="#5a5a5a",RN="#7e7e7e",PN=6;function of(e){const t=Math.sin(e)*1e4;return t-Math.floor(t)}function bS(e,t,r,o,l){const s=(t+r)*2,u=Math.floor(s/B0),d=-t/2,f=t/2,g=-r/2,m=r/2;for(let v=0;v<u;v++){const y=o+v*13,w=of(y),I=of(y+1);let E=v*B0,C=0,F=0;E<t?(C=d+E,F=g):E<t+r?(C=f,F=g+(E-t)):E<t*2+r?(C=f-(E-(t+r)),F=m):(C=d,F=m-(E-(t*2+r)));const L=(I-.5)*L0,D=(of(y+2)-.5)*L0;e.beginPath();const H=wN+w*_N;e.fillStyle=l||(w>.5?RN:CN),e.ellipse(C+L,F+D,H,H*.85,I*Math.PI,0,Math.PI*2),e.fill(),l||(e.strokeStyle="#2b2b2b",e.lineWidth=1,e.stroke())}}function NN(e,t){if(!t.storedFood||t.storedFood.length===0)return;const{position:r,storedFood:o}=t;e.save(),e.font=`${PN}px Arial`,e.textAlign="center",e.textBaseline="middle",e.shadowColor="rgba(0,0,0,0.5)",e.shadowBlur=2,o.forEach(l=>{const s=Vf[l.item.type],u={x:r.x+l.positionOffset.x,y:r.y+l.positionOffset.y};e.fillText(s,u.x,u.y)}),e.shadowBlur=0,e.shadowColor="transparent",e.restore()}function DN(e,t,r){const{position:o,width:l,height:s,constructionProgress:u,destructionProgress:d,isConstructed:f,isBeingDestroyed:g,id:m}=t,v=fa[t.buildingType];e.save(),e.translate(o.x,o.y),f||(e.globalAlpha=.3+u*.7),bS(e,l,s,m),e.globalAlpha=.5,e.font=`${Math.min(l,s,30)*.5}px Arial`,e.textAlign="center",e.textBaseline="middle",e.shadowColor="rgba(0,0,0,0.5)",e.shadowBlur=4,e.fillStyle="#FFFFFF",e.fillText(v.icon,0,0),e.shadowBlur=0,e.restore();const y=l,w=o.x-y/2,I=o.y+s/2+K_;f?g&&Zi(e,w,I,y,g0,1-d,Vi,X_):Zi(e,w,I,y,g0,u,Vi,V_),t.buildingType==="storageSpot"&&f&&NN(e,t)}function kN(e,t,r,o,l){const s=fa[r],{width:u,height:d}=s.dimensions,f=(m,v)=>{m.save(),m.translate(v.x,v.y),m.globalAlpha=j_;const y=o?"#4CAF50":"#F44336";bS(m,u,d,9999,y),m.font=`${Math.min(u,d)*.5}px Arial`,m.textAlign="center",m.textBaseline="middle",m.fillStyle=y,m.fillText(s.icon,0,0),m.restore()},g={position:{...t},radius:Math.max(u,d)/2,id:0,type:"building",direction:{x:0,y:0},acceleration:0,forces:[],velocity:{x:0,y:0},debuffs:[]};ln(e,l.width,l.height,(m,v)=>f(m,v.position),g)}function ON(e,t,r,o,l){const s=_t(t),u=s?Lt(t,s):[],d=Si(u),{width:f,height:g}=t.mapDimensions;Object.values(t.entities.entities).sort((I,E)=>r&&I.id===t.debugCharacterId&&I.id!==E.id||I.type==="building"&&E.type!=="building"?-1:I.position.y-E.position.y||I.id-E.id).filter(I=>$l(I,o,l,t.mapDimensions)).forEach(I=>{var E,C;if(I.type==="building")ln(e,f,g,DN,I,t,s,t.time);else if(I.type==="berryBush")ln(e,f,g,VP,I,t,s,t.time);else if(I.type==="human"){const F=I,L=F.id===(s==null?void 0:s.id),D=u.some(Ce=>Ce.id===F.id),H=F.id===(d==null?void 0:d.id),x=s&&(F.id===s.motherId||F.id===s.fatherId),U=s&&(((E=F.partnerIds)==null?void 0:E.includes(s.id))||((C=s.partnerIds)==null?void 0:C.includes(F.id))),$=(s==null?void 0:s.attackTargetId)===F.id,ee=F.leaderId?t.entities.entities[F.leaderId]:void 0,_e=s?F.leaderId===s.id&&F.activeAction==="moving"&&F.target===F.leaderId&&(ee==null?void 0:ee.isCallingToFollow):!1;ln(e,f,g,mN,F,L,x,D,U,H,$,_e,r,t.time,t.debugCharacterId)}else I.type==="corpse"?ln(e,f,g,QP,I):I.type==="prey"?ln(e,f,g,yN,I,r,t.time,t.debugCharacterId):I.type==="predator"&&ln(e,f,g,IN,I,r,t.time,t.debugCharacterId)}),t.visualEffects.filter(I=>$l(I,o,l,t.mapDimensions)).forEach(I=>{ln(e,f,g,EN,I,t.time)});const w=t.notifications.filter(I=>!I.isDismissed);for(const I of w)if(I.highlightedEntityIds&&I.renderHighlights)for(const E of I.highlightedEntityIds){const C=t.entities.entities[E];C&&$l(C,o,l,t.mapDimensions)&&ln(e,f,g,U0,C,Kw,Zw,Qw,qw,t.time)}if(t.tutorialState.isActive&&t.tutorialState.highlightedEntityIds.length>0)for(const I of t.tutorialState.highlightedEntityIds){const E=t.entities.entities[I];E&&$l(E,o,l,t.mapDimensions)&&ln(e,f,g,U0,E,Bw,Yv,jv,oh,t.time)}}function MN(e,t,r,o,l,s){let u=null,d=null;e.textAlign="left";let f=Ze+Sn;const m=t.time/(At/It)/Au%1,v=Ds[mo.Time],y=25,w=Ze+y;e.fillText(v,Ze,f+on/2+Sn/3),Zi(e,w,f,bi,on,m,Vi,rw),f+=on+li;const I=f+vr/2,E=f+(vr-on)/2,C=5;ca(e,{x:Ze*2,y:I},vr,5,r.gender,!1,!1,!1);const F=Ze+vr+C,L=bi+y-(vr+C)*2;Zi(e,F,E,L,on,Math.floor(r.age)/ea,Vi,iw),ca(e,{x:F+L+C+vr/2,y:I},vr,ea,r.gender,!1,!1,!1),f+=on+li*2;const D=[],H=new Set;if(D.push({member:r,isPlayer:!0,isHeir:!1,isPartner:!1,isParent:!1}),H.add(r.id),o&&!H.has(o.id)&&(D.push({member:o,isPlayer:!1,isHeir:!0,isPartner:!1,isParent:!1}),H.add(o.id)),l.forEach(de=>{H.has(de.id)||(D.push({member:de,isPlayer:!1,isHeir:!1,isPartner:!0,isParent:!1}),H.add(de.id))}),s.forEach(de=>{H.has(de.id)||(D.push({member:de,isPlayer:!1,isHeir:!1,isPartner:!1,isParent:!1}),H.add(de.id))}),r.motherId&&!H.has(r.motherId)){const de=t.entities.entities[r.motherId];de&&(D.push({member:de,isPlayer:!1,isHeir:!1,isPartner:!1,isParent:!0}),H.add(de.id))}if(r.fatherId&&!H.has(r.fatherId)){const de=t.entities.entities[r.fatherId];de&&(D.push({member:de,isPlayer:!1,isHeir:!1,isPartner:!1,isParent:!0}),H.add(de.id))}const x=Ds[mo.Family],U=10,$=Ze+Sn+U,ee=bi+y-(Sn+U),_e=f+Pl/2;e.font=`${Sn}px "Press Start 2P", Arial`,e.textBaseline="middle",e.fillText(x,Ze,_e);const Ce=f+Pl/2;xP(e,$,Ce,D,Pl,ee),f+=Pl+li,e.textBaseline="alphabetic";const Ge=Ds[mo.Hitpoints];e.fillText(Ge,Ze,f+on/2+Sn/3),Zi(e,w,f,bi,on,r.hitpoints/r.maxHitpoints,Vi,nw),f+=on+li;const Ne=Ds[mo.Hunger];e.fillText(Ne,Ze,f+on/2+Sn/3),Zi(e,w,f,bi,on,(Mr-r.hunger)/Mr,Vi,tw),u={x:Ze,y:f-li/2,width:bi+y,height:on+li},f+=on+li,e.textBaseline="middle";const Pe=Ds[mo.Food];return e.fillText(Pe,Ze,f+Rl/2),JP(e,w,f+Rl/2,r.food,Rl,bi),d={x:Ze,y:f-li/5,width:bi+y,height:Rl+li},e.textBaseline="alphabetic",{hungerBarRect:u,foodBarRect:d}}let Us=[],H0=0;const FN=36,UN=200;function BN(e,t,r,o){const l=t.search.prey.count(),s=t.search.predator.count(),u=t.search.berryBush.count();t.time-H0>=FN&&(Us.push({time:t.time,prey:l,predators:s,bushes:u}),Us.length>UN&&(Us=Us.slice(-200)),H0=t.time);const d=et*tt,f=l/d*1e6,g=s/d*1e6,m=u/d*1e6,v=wP(),y=Math.floor(t.time/(24*365)),w=Math.floor(t.time%(24*365)/24),I=Math.floor(t.time%24),E=400,C=Math.min(o*.8,600),F=r-E-10,L=Ze+Sn*2;e.save(),e.fillStyle="rgba(0, 0, 0, 0.9)",e.fillRect(F,L,E,C),e.strokeStyle="#444",e.lineWidth=2,e.strokeRect(F,L,E,C),e.fillStyle="white",e.font="12px monospace",e.textAlign="left";let D=L+20;const H=14,x=F+15;e.fillStyle="#66ccff",e.font="bold 14px monospace",e.fillText(" Ecosystem Debugger",x,D),D+=25,e.fillStyle="white",e.font="12px monospace",e.fillText(`Game Time: Year ${y}, Day ${w}, Hour ${I}`,x,D),D+=H,e.fillText(`Map Size: ${et}  ${tt} pixels`,x,D),D+=20,e.fillStyle="#66ccff",e.font="bold 13px monospace",e.fillText(" Q-Learning Status",x,D),D+=18,v&&(e.fillText(`Q-Table Size: ${v.qTableSize} entries`,x,D),D+=H,e.fillText(`Exploration Rate: ${(v.explorationRate*100).toFixed(1)}%`,x,D),D+=H);const U=Us.slice(-20);U.length>1&&(e.fillStyle="#66ccff",e.font="bold 13px monospace",e.fillText(" Population Trends (Last 20 Points)",x,D),D+=30,LN(e,x,D,U),D+=50),e.fillStyle="#66ccff",e.font="bold 13px monospace",e.fillText(" Density (per 1000 px)",x,D),D+=18,e.fillStyle="white",e.font="12px monospace";const $=(hi/d*1e6).toFixed(2),ee=(gi/d*1e6).toFixed(2),_e=(pi/d*1e6).toFixed(2);e.fillText(`Prey: ${f.toFixed(2)} (target: ${$})`,x,D),D+=H,e.fillText(`Predators: ${g.toFixed(2)} (target: ${ee})`,x,D),D+=H,e.fillText(`Bushes: ${m.toFixed(2)} (target: ${_e})`,x,D),D+=20,e.fillStyle="#66ccff",e.font="bold 13px monospace",e.fillText(" Current Population Status",x,D),D+=18,e.fillStyle="white",e.font="12px monospace";const Ce=Math.round(l/hi*100),Ge=Math.round(s/gi*100),Ne=Math.round(u/pi*100),Pe=de=>de<50?"#ff4444":de<80?"#ffaa44":de>120?"#44aaff":"#44ff44";e.fillStyle=Pe(Ce),e.fillText(`Prey: ${l}/${hi} (${Ce}%)`,x,D),D+=H,e.fillStyle=Pe(Ge),e.fillText(`Predators: ${s}/${gi} (${Ge}%)`,x,D),D+=H,e.fillStyle=Pe(Ne),e.fillText(`Bushes: ${u}/${pi} (${Ne}%)`,x,D),D+=20,e.fillStyle="#66ccff",e.font="bold 13px monospace",e.fillText(" Current Parameters",x,D),D+=18,e.fillStyle="white",e.font="10px monospace",e.fillText("Prey:",x,D),D+=13,e.fillText(` Gestation: ${t.ecosystem.preyGestationPeriod.toFixed(1)}h`,x,D),D+=11,e.fillText(` Procreation: ${t.ecosystem.preyProcreationCooldown.toFixed(1)}h`,x,D),D+=11,e.fillText(` Hunger: ${t.ecosystem.preyHungerIncreasePerHour.toFixed(1)}/h`,x,D),D+=13,e.fillText("Predators:",x,D),D+=13,e.fillText(` Gestation: ${t.ecosystem.predatorGestationPeriod.toFixed(1)}h`,x,D),D+=11,e.fillText(` Procreation: ${t.ecosystem.predatorProcreationCooldown.toFixed(1)}h`,x,D),D+=11,e.fillText(` Hunger: ${t.ecosystem.predatorHungerIncreasePerHour.toFixed(1)}/h`,x,D),D+=13,e.fillText("Bushes:",x,D),D+=13,e.fillText(` Spread Chance: ${(t.ecosystem.berryBushSpreadChance*100).toFixed(1)}%`,x,D),D+=15,e.fillStyle="#888",e.font="10px monospace",e.textAlign="center",e.fillText("Press '1' to toggle this debugger",F+E/2,L+C-10),e.restore()}function LN(e,t,r,o){if(o.length<2)return;const d={prey:Math.max(...o.map(g=>g.prey),hi),predators:Math.max(...o.map(g=>g.predators),gi),bushes:Math.max(...o.map(g=>g.bushes),pi)};[{data:o.map(g=>g.prey),color:"#44ff44",label:"Prey",target:hi,max:d.prey},{data:o.map(g=>g.predators),color:"#ff4444",label:"Predators",target:gi,max:d.predators},{data:o.map(g=>g.bushes),color:"#ffaa44",label:"Bushes",target:pi,max:d.bushes}].forEach((g,m)=>{const v=t+m*115,y=r;e.fillStyle=g.color,e.font="10px monospace",e.fillText(g.label,v,y-5),e.strokeStyle="#333",e.lineWidth=1,e.strokeRect(v,y,100,30),e.beginPath(),e.strokeStyle=g.color;for(let I=0;I<g.data.length;I++){const E=v+I/(g.data.length-1)*100,C=y+30-g.data[I]/g.max*30;I===0?e.moveTo(E,C):e.lineTo(E,C)}e.stroke(),e.beginPath(),e.strokeStyle="#888",e.setLineDash([2,2]);const w=y+30-g.target/g.max*30;e.moveTo(v,w),e.lineTo(v+100,w),e.stroke(),e.setLineDash([])})}function b0(e,t,r){e.save();const{x:o,y:l,width:s,height:u}=t.rect,d=Hv;if(e.beginPath(),e.moveTo(o+d,l),e.lineTo(o+s-d,l),e.quadraticCurveTo(o+s,l,o+s,l+d),e.lineTo(o+s,l+u-d),e.quadraticCurveTo(o+s,l+u,o+s-d,l+u),e.lineTo(o+d,l+u),e.quadraticCurveTo(o,l+u,o,l+u-d),e.lineTo(o,l+d),e.quadraticCurveTo(o,l,o+d,l),e.closePath(),e.fillStyle=t.isDisabled?bv:t.backgroundColor,e.fill(),t.activated){e.save();const f=(Math.sin(Date.now()/1e3*zv)+1)/2;e.strokeStyle=$v,e.lineWidth=2+f*2,e.globalAlpha=.7+f*.3,e.stroke(),e.restore()}if(t.lastActivated){const f=Date.now()-t.lastActivated;if(f<su){const g=1-f/su;e.fillStyle=xv,e.globalAlpha=g,e.fill(),e.globalAlpha=1}}r&&!t.isDisabled&&(e.fillStyle=rh,e.globalAlpha=.5,e.fill(),e.globalAlpha=1),e.fillStyle=t.isDisabled?Gv:t.textColor,t.icon?(e.font=`${u*.55}px "Press Start 2P", Arial`,e.textAlign="center",e.textBaseline="middle",e.fillText(t.icon,o+s/2,l+u/2),t.text&&(e.font=`${u*.18}px "Press Start 2P", Arial`,e.textAlign="right",e.textBaseline="bottom",e.fillText(t.text,o+s-4,l+u-2))):(e.font=`${Sn*1.5}px "Press Start 2P", Arial`,e.textAlign="center",e.textBaseline="middle",e.fillText(t.text,o+s/2,l+u/2)),e.restore()}function HN(e,t,r,o){e.save(),e.fillStyle="rgba(0, 0, 0, 0.6)",e.fillRect(0,0,r,o);const l=500,s=150,u=(r-l)/2,d=(o-s)/2;e.fillStyle=yn,e.font=`${Sn*1.1}px "Press Start 2P", Arial`,e.textAlign="center",e.textBaseline="middle",e.fillText("Are you sure you want to exit",r/2,d+s/3-10),e.fillText("to the main menu?",r/2,d+s/3+10);const f=fi*1.5,g=Lv,m=d+s-g-Ze*2,v=20,y=f*2+v,w=u+(l-y)/2,I={id:"confirmExitYes",action:ge.ConfirmExitYes,rect:{x:w,y:m,width:f,height:g},text:"Yes",backgroundColor:Yi,textColor:yn,currentWidth:f},E=w+f+v,C={id:"confirmExitNo",action:ge.ConfirmExitNo,rect:{x:E,y:m,width:f,height:g},text:"No",backgroundColor:Yi,textColor:yn,currentWidth:f};t.uiButtons.push(I,C),b0(e,I,t.hoveredButtonId===I.id),b0(e,C,t.hoveredButtonId===C.id),e.restore()}function hu(e,t,r,o,l,s=!1){var f;if(e.save(),e.clearRect(0,0,e.canvas.width,e.canvas.height),e.fillStyle="#2c5234",e.fillRect(0,0,e.canvas.width,e.canvas.height),e.translate(e.canvas.width/2-r.x,e.canvas.height/2-r.y),!s&&t.gameOver){e.restore(),YP(e,t);return}ON(e,t,t.debugPanel===Pt.General,r,l);const u=_t(t);if(u&&t.selectedBuildingType&&t.selectedBuildingType!=="removal"&&t.mousePosition){const g=Mf(t.mousePosition,r,l,t.mapDimensions),m=lS(g,t.selectedBuildingType,u.leaderId,t);kN(e,g,t.selectedBuildingType,m,t.mapDimensions)}const d=t.notifications.filter(g=>!g.isDismissed);for(const g of d){const m=(Math.sin(t.time*jw)+1)/2;e.globalAlpha=m*.5+.25,e.fillStyle=Yw,g.targetArea&&e.fillRect(g.targetArea.x,g.targetArea.y,g.targetArea.width,g.targetArea.height),g.targetRadius&&(e.beginPath(),e.arc(g.targetRadius.x,g.targetRadius.y,g.targetRadius.radius,0,Math.PI*2),e.fill())}if(e.globalAlpha=1,iN(e,t),e.restore(),!s){e.fillStyle=QE,e.font=`${Sn}px "Press Start 2P", Arial`,e.shadowColor=JE,e.shadowBlur=ew,t.uiButtons=[];let g=null,m=null;if(u){const w=Lt(t,u),I=Si(w),E=((f=u.partnerIds)==null?void 0:f.map(F=>t.entities.entities[F]).filter(F=>F!==void 0))||[],C=MN(e,t,u,I,E,w);g=C.hungerBarRect,m=C.foodBarRect}const v=eS(t,u==null?void 0:u.leaderId);$P(e,t,v,e.canvas.width,e.canvas.height);const{commandButtonsRect:y}=NP(e,t,e.canvas.width);if(e.shadowColor="transparent",e.shadowBlur=0,u&&(eN(e,t,r,e.canvas.width,e.canvas.height),o.length>0&&MP(e,o,u,r,e.canvas.width,e.canvas.height,t.mapDimensions)),t.tutorialState.activeUIHighlights.length>0){const{activeUIHighlights:w}=t.tutorialState;w.includes(kr.HUNGER_BAR)&&g&&ef(e,g,t.time),w.includes(kr.FOOD_BAR)&&m&&ef(e,m,t.time),w.includes(kr.COMMAND_BUTTONS)&&y&&ef(e,y,t.time)}if(t.tutorialState.isActive){const w=WP(e,t,e.canvas.width,e.canvas.height);w&&t.uiButtons.push({id:"tutorial-dismiss",action:ge.DismissTutorial,rect:w,text:"",currentWidth:w.width,backgroundColor:"transparent",textColor:"transparent"})}switch(oN(e,t,e.canvas.width,e.canvas.height),t.debugPanel){case Pt.Ecosystem:BN(e,t,e.canvas.width,e.canvas.height);break;case Pt.Performance:aN(e,t,l.width);break}t.isPaused&&t.exitConfirmation!=="pending"&&DP(e),t.exitConfirmation==="pending"&&HN(e,t,e.canvas.width,e.canvas.height)}}const bN=In.div`
  position: relative;
  width: 100vw;
  height: 100vh;
  overflow: hidden;
`,GN=In.canvas`
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background-color: #2c5234;
`,xN=In.div`
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  text-align: center;
  z-index: 1;
  background: linear-gradient(to bottom, rgba(0, 0, 0, 0.7) 0%, rgba(0, 0, 0, 0) 50%, rgba(0, 0, 0, 0.7) 100%);
`,$N=In.h1`
  font-family: 'Press Start 2P', cursive;
  font-size: 4rem;
  color: #fff;
  text-shadow: 4px 4px 0px #ff0000;
  margin-bottom: 2rem;
`,G0=In.button`
  font-family: 'Press Start 2P', cursive;
  font-size: 1.5rem;
  padding: 1rem 2rem;
  color: #fff;
  background-color: #ff0000;
  border: 2px solid #fff;
  box-shadow: 4px 4px 0px #fff;
  cursor: pointer;
  transition: all 0.2s ease-in-out;

  &:hover {
    background-color: #fff;
    color: #ff0000;
    box-shadow: 4px 4px 0px #ff0000;
  }
`,zN=In.div`
  display: flex;
  flex-direction: column;
  gap: 1.5rem;
  align-items: center;
`,WN=In.div`
  position: absolute;
  bottom: 1rem;
  font-family: 'Press Start 2P', cursive;
  font-size: 0.8rem;
  color: #fff;
  text-shadow: 2px 2px 0px #000;
  a {
    color: #fff;
    text-decoration: none;
    &:hover {
      text-decoration: underline;
    }
  }
`,Yl="intro-soundtrack",x0=()=>{const{setAppState:e,savedGameState:t,clearCurrentSave:r}=Bo(),o=Re.useRef(null),l=Re.useRef(null),s=Re.useRef(FR()),u=Re.useRef(),d=Re.useRef(s.current.viewportCenter),f=Re.useRef(),g=Re.useCallback(()=>{Ld(Yl,2),r(),e("game")},[e,r]),m=Re.useCallback(()=>{t&&(Ld(Yl,2),e("game"))},[e,t]);Re.useEffect(()=>{const w=I=>{(I.key==="Enter"||I.key===" ")&&(t?m():g())};return window.addEventListener("keydown",w),()=>{window.removeEventListener("keydown",w)}},[g,m,t]),Re.useEffect(()=>(uh(fe.SoundTrack1,{loop:!0,trackId:Yl}),()=>{Ld(Yl,2)}),[]),Re.useEffect(()=>{const w=o.current;if(!w)return;l.current=w.getContext("2d");const I=()=>{w&&l.current&&(w.width=window.innerWidth,w.height=window.innerHeight,hu(l.current,s.current,d.current,[],{width:w.width,height:w.height},!0))};return I(),window.addEventListener("resize",I),()=>window.removeEventListener("resize",I)},[]),Re.useEffect(()=>{const w=()=>{const E=u_(s.current);if(E.length>0){const C=Math.floor(Math.random()*E.length);f.current=E[C].id}};w();const I=setInterval(w,dI);return()=>clearInterval(I)},[]);const[v,y]=Sv(w=>{var C,F;if(!l.current)return;if(u.current===void 0){u.current=w;return}const I=Math.min((w-u.current)/1e3,1);s.current=Ru(s.current,I);const E=f.current?s.current.entities.entities[f.current]:void 0;if(E){const{mapDimensions:L}=s.current,{width:D,height:H}=L;let x={...E.position};const U=x.x-d.current.x;Math.abs(U)>D/2&&(U>0?x.x-=D:x.x+=D);const $=x.y-d.current.y;Math.abs($)>H/2&&($>0?x.y-=H:x.y+=H);let ee=eh(d.current,x,jf*I);ee={x:(ee.x%D+D)%D,y:(ee.y%H+H)%H},d.current=ee}hu(l.current,s.current,d.current,[],{width:((C=o.current)==null?void 0:C.width)||800,height:((F=o.current)==null?void 0:F.height)||600},!0),u.current=w});return Re.useEffect(()=>(y(),v),[y,v]),Fe.jsxs(bN,{children:[Fe.jsx(GN,{ref:o}),Fe.jsxs(xN,{children:[Fe.jsx($N,{children:"Tribe2"}),Fe.jsxs(zN,{children:[Fe.jsx(G0,{onClick:g,children:"New Game"}),t&&Fe.jsx(G0,{onClick:m,children:"Load Game"})]}),Fe.jsxs(WN,{children:["by"," ",Fe.jsx("a",{href:"https://github.com/gtanczyk",target:"_blank",rel:"noopener noreferrer",children:"gtanczyk"})]})]})]})};function YN(){console.log("Tribe game initialized with detailed 2D world state.");const e=MR();return e.ecosystem={preyGestationPeriod:Cr,preyProcreationCooldown:Rr,predatorGestationPeriod:Pr,predatorProcreationCooldown:Nr,preyHungerIncreasePerHour:Xi,predatorHungerIncreasePerHour:Ki,berryBushSpreadChance:mi},e.debugPanel=Pt.None,e.performanceMetrics={currentBucket:{renderTime:0,worldUpdateTime:0,aiUpdateTime:0},history:[]},e}const jN=({canvasRef:e,ctxRef:t,gameStateRef:r,viewportCenterRef:o,playerActionHintsRef:l})=>(Re.useEffect(()=>{const s=e.current;if(!s)return;t.current=s.getContext("2d");const u=()=>{s&&t.current&&r.current&&(s.width=window.innerWidth,s.height=window.innerHeight,hu(t.current,r.current,o.current,l.current,{width:s.width,height:s.height},!1))};return u(),window.addEventListener("resize",u),()=>window.removeEventListener("resize",u)},[]),Fe.jsx("canvas",{ref:e,style:{display:"block",background:"#2c5234"}})),VN=(e,t,r,o=!1)=>{let l;const s=c_(e,r);if(s){if(t.isAdult&&s.type==="berryBush"&&s.food.length>0)l={action:se.AutopilotGather,targetEntityId:s.id};else if(t.isAdult&&s.type==="corpse"&&s.food.length>0)l={action:se.AutopilotGather,targetEntityId:s.id};else if(s.type==="human"){const u=s;t.isAdult&&bo(t,u,r)?l={action:se.AutopilotAttack,targetEntityId:u.id}:Lr(t,u,r)?l={action:se.AutopilotProcreate,targetEntityId:u.id}:t.food.length>0&&!u.isAdult&&(u.motherId===t.id||u.fatherId===t.id)&&(l={action:se.AutopilotFeedChild,targetEntityId:u.id})}else if(s.type==="prey")l={action:se.AutopilotAttack,targetEntityId:s.id};else if(s.type==="predator")l={action:se.AutopilotAttack,targetEntityId:s.id};else if(s.type==="building"){const u=s;if(r.selectedBuildingType==="removal")l={action:se.Removal,position:s.position};else if(u.buildingType==="storageSpot"){const d=u.ownerId===t.leaderId,f=u.storedFood!==void 0&&u.storedFood.length>0,g=u.storedFood!==void 0&&u.storageCapacity!==void 0&&u.storedFood.length<u.storageCapacity;if(o&&u.isConstructed&&f&&t.food.length<t.maxFood)if(d)l={action:se.AutopilotRetrieve,targetEntityId:s.id};else{const m=t.leaderId?r.entities.entities[t.leaderId]:void 0;m&&m.diplomacy?m.diplomacy[u.ownerId]===mt.Hostile?l={action:se.AutopilotGather,targetEntityId:s.id}:l={action:se.AutopilotMove,position:e}:l={action:se.AutopilotMove,position:e}}else d&&u.isConstructed?t.food.length>0&&g?l={action:se.AutopilotDeposit,targetEntityId:s.id}:t.food.length<t.maxFood&&f?l={action:se.AutopilotRetrieve,targetEntityId:s.id}:l={action:se.AutopilotMove,position:e}:l={action:se.AutopilotMove,position:e}}else u.buildingType==="plantingZone"&&t.food.filter(d=>d.type===Fn.Berry).length>=Or&&!Bn(e,r,er)?l={action:se.AutopilotPlant,position:e}:l={action:se.AutopilotMove,position:e}}}else t.food.filter(u=>u.type===Fn.Berry).length>=Or&&(r.autopilotControls.isManuallyPlanting||hC(e,t,r))?l={action:se.AutopilotPlant,position:e}:l={action:se.AutopilotMove,position:e};return l},XN=(e,t)=>{if(e.isPaused)return;const r=_t(e);if(!r)return;if(e.selectedBuildingType&&e.selectedBuildingType!=="removal"){lS(t,e.selectedBuildingType,r.leaderId,e)&&(Q_(t,e.selectedBuildingType,r.leaderId,e),e.selectedBuildingType=null);return}if(e.selectedBuildingType==="removal"){const l=eC(t,e);l&&J_(l.id,e);return}const o=e.autopilotControls.hoveredAutopilotAction;e.autopilotControls.activeAutopilotAction=void 0,o?(e.autopilotControls.activeAutopilotAction=o,(o.action===se.AutopilotMove||o.action===se.AutopilotGather)&&(e.hasPlayerMovedEver=!0),o.action===se.AutopilotPlant&&(e.hasPlayerPlantedBush=!0)):e.autopilotControls.activeAutopilotAction={action:se.AutopilotMove,position:t},e.autopilotControls.isManuallyMoving=!1,e.autopilotControls.isManuallyPlanting=!1},KN=(e,t)=>{var u,d,f,g;const r=e.key.toLowerCase(),o=e.ctrlKey||e.metaKey;let l=!0,s=t;if(o){switch(r){case"s":Hf(t);break;default:l=!1;break}return{newState:s,handled:l}}switch(r){case"escape":const{autopilotControls:m}=t;m.activeAutopilotAction||m.isManuallyMoving||m.isManuallyPlanting||t.buildMenuOpen||t.selectedBuildingType?(m.activeAutopilotAction=void 0,m.isManuallyMoving=!1,m.isManuallyPlanting=!1,t.buildMenuOpen=!1,t.selectedBuildingType=null):s.exitConfirmation==="pending"?(s.exitConfirmation="inactive",s.isPaused=!1):(s.exitConfirmation="pending",s.isPaused=!0);break;case"m":t.isMuted=!t.isMuted,zs(t.masterVolume,t.isMuted);break;case"=":case"+":const v=Math.min(1,t.masterVolume+.1);t.masterVolume=parseFloat(v.toFixed(1)),zs(t.masterVolume,t.isMuted);break;case"-":const y=Math.max(0,t.masterVolume-.1);t.masterVolume=parseFloat(y.toFixed(1)),zs(t.masterVolume,t.isMuted);break;case"t":s=Ru(t,iS);break;case" ":case"p":t.isPaused=!t.isPaused;break;case"":case"`":s.debugPanel===Pt.General?(s.debugPanel=Pt.None,s.debugCharacterId=void 0):(s.debugPanel=Pt.General,s.debugCharacterId||(s.debugCharacterId=((u=_t(s))==null?void 0:u.id)??((d=Object.values(s.entities.entities).find(I=>I.type==="human"||I.type==="prey"||I.type==="predator"))==null?void 0:d.id)));break;case"!":if(e.shiftKey){if(s.debugPanel===Pt.Ecosystem){s.debugPanel=Pt.None;break}s.debugPanel=Pt.Ecosystem,s.debugCharacterId||(s.debugCharacterId=((f=_t(s))==null?void 0:f.id)??((g=Object.values(s.entities.entities).find(I=>I.type==="human"||I.type==="prey"||I.type==="predator"))==null?void 0:g.id))}else l=!1;break;case"@":if(e.shiftKey){if(s.debugPanel===Pt.Performance){s.debugPanel=Pt.None;break}s.debugPanel=Pt.Performance}else l=!1;break;case"tab":s.debugPanel=Pt.General;const w=Object.values(s.entities.entities).filter(I=>I.type==="human"||I.type==="prey"||I.type==="predator");if(w.length>0){const I=w.sort((L,D)=>{if(L.type==="human"&&L.isPlayer)return-1;if(D.type==="human"&&D.isPlayer)return 1;if(L.type!==D.type){const H={human:0,prey:1,predator:2},x=H[L.type]??999,U=H[D.type]??999;return x-U}return L.id-D.id}),E=s.debugCharacterId,F=((E?I.findIndex(L=>L.id===E):-1)+1)%I.length;s.debugCharacterId=I[F].id}else s.debugCharacterId=void 0;break;default:l=!1;break}return{newState:s,handled:l}},ZN=(e,t,r,o,l)=>{const s={gameState:r};if(t&&["e","b","r","h"].includes(e)&&r.hasPlayerEnabledAutopilot++,r.buildMenuOpen){if(e==="1"){r.selectedBuildingType="storageSpot",Ie(s,fe.ButtonClick,o.position);return}else if(e==="2"){r.selectedBuildingType="plantingZone",Ie(s,fe.ButtonClick,o.position);return}else if(e==="3"){r.selectedBuildingType="removal",Ie(s,fe.ButtonClick,o.position);return}}if(e==="escape"&&r.selectedBuildingType){r.selectedBuildingType=null;return}if(e==="e"){if(t){r.autopilotControls.behaviors.gathering=!r.autopilotControls.behaviors.gathering;return}const u=De(o,r,"berryBush",Et,g=>g.food.length>0&&o.food.length<o.maxFood),d=De(o,r,"corpse",Et,g=>g.food.length>0&&o.food.length<o.maxFood);let f=null;u&&d?f=V(o.position,u.position,r.mapDimensions.width,r.mapDimensions.height)<=V(o.position,d.position,r.mapDimensions.width,r.mapDimensions.height)?u:d:f=u||d,f&&(o.activeAction="gathering",Ie(s,fe.Gather,o.position))}else if(e==="r"){if(t){r.autopilotControls.behaviors.procreation=!r.autopilotControls.behaviors.procreation;return}De(o,r,"human",Et,d=>Lr(o,d,r))&&(o.activeAction="procreating",Ie(s,fe.Procreate,o.position))}else if(e==="f")o.food.length>0&&(o.activeAction="eating",Ie(s,fe.Eat,o.position));else if(e==="h"){if(t){r.autopilotControls.behaviors.feedChildren=!r.autopilotControls.behaviors.feedChildren;return}const u=l.find(d=>d.type===se.FeedChild);u&&u.targetEntity&&(o.activeAction="feeding",o.target=u.targetEntity.id)}else if(e==="arrowup"||e==="w")o.direction.y=-1,o.activeAction="moving",o.target=void 0,r.hasPlayerMovedEver=!0,r.autopilotControls.isManuallyMoving=!0,r.autopilotControls.activeAutopilotAction=void 0;else if(e==="arrowdown"||e==="s")o.direction.y=1,o.activeAction="moving",o.target=void 0,r.hasPlayerMovedEver=!0,r.autopilotControls.isManuallyMoving=!0,r.autopilotControls.activeAutopilotAction=void 0;else if(e==="arrowleft"||e==="a")o.direction.x=-1,o.activeAction="moving",o.target=void 0,r.hasPlayerMovedEver=!0,r.autopilotControls.isManuallyMoving=!0,r.autopilotControls.activeAutopilotAction=void 0;else if(e==="arrowright"||e==="d")o.direction.x=1,o.activeAction="moving",o.target=void 0,r.hasPlayerMovedEver=!0,r.autopilotControls.isManuallyMoving=!0,r.autopilotControls.activeAutopilotAction=void 0;else if(e==="q"){if(t){r.autopilotControls.behaviors.attack=!r.autopilotControls.behaviors.attack;return}const u=De(o,r,"human",Qn,d=>bo(o,d,r))??De(o,r,"predator",Qn)??De(o,r,"prey",Qn);u&&(o.activeAction="attacking",o.attackTargetId=u.id)}else if(e==="b"){if(t){r.autopilotControls.behaviors.planting=!r.autopilotControls.behaviors.planting;return}if(l.find(d=>d.type===se.Plant)){const d=tS(o.position,r,50,Sf);d&&(o.activeAction="planting",o.target=d,r.hasPlayerPlantedBush=!0)}}else if(e==="x"){if(t){r.autopilotControls.behaviors.gathering=!r.autopilotControls.behaviors.gathering;return}const u=De(o,r,"building",An,d=>{const f=d;return f.buildingType==="storageSpot"&&f.ownerId===o.leaderId&&f.isConstructed&&f.storedFood!==void 0&&f.storageCapacity!==void 0&&f.storedFood.length<f.storageCapacity});u&&(o.activeAction="idle",o.target=u.id,Ie(s,fe.StorageDeposit,o.position))}else if(e==="z"){if(t){r.autopilotControls.behaviors.feedChildren=!r.autopilotControls.behaviors.feedChildren;return}const u=De(o,r,"building",An,d=>{const f=d;return f.buildingType==="storageSpot"&&f.ownerId===o.leaderId&&f.isConstructed&&f.storedFood!==void 0&&f.storedFood.length>0});u&&(o.activeAction="idle",o.target=u.id,Ie(s,fe.StorageRetrieve,o.position))}else e==="v"?(o.isCallingToAttack=!0,o.callToAttackEndTime=r.time+Mo,ke(r,ue.CallToAttack,o.position,Mo),Ie(s,fe.CallToAttack,o.position)):e==="c"?(o.isCallingToFollow=!0,o.callToFollowEndTime=r.time+na,ke(r,ue.CallToFollow,o.position,na),Ie(s,fe.CallToFollow,o.position)):e==="k"?dh(o,r):e==="l"&&(r.buildMenuOpen=!r.buildMenuOpen,Ie(s,fe.ButtonClick,o.position))},qN=(e,t,r,o)=>{e==="arrowup"||e==="w"||e==="arrowdown"||e==="s"?t.direction.y=0:(e==="arrowleft"||e==="a"||e==="arrowright"||e==="d")&&(t.direction.x=0),!o.current.has("arrowup")&&!o.current.has("arrowdown")&&!o.current.has("arrowleft")&&!o.current.has("arrowright")&&!o.current.has("w")&&!o.current.has("a")&&!o.current.has("s")&&!o.current.has("d")&&(t.activeAction==="moving"&&(t.activeAction="idle"),r.autopilotControls.isManuallyMoving=!1),!o.current.has("e")&&t.activeAction==="gathering"&&(t.activeAction="idle"),!o.current.has("f")&&t.activeAction==="eating"&&(t.activeAction="idle"),!o.current.has("r")&&t.activeAction==="procreating"&&(t.activeAction="idle"),!o.current.has("h")&&t.activeAction==="feeding"&&(t.activeAction="idle")},QN=(e,t,r)=>{let l=_t(e);if(e.debugCharacterId){const s=e.entities.entities[e.debugCharacterId];s&&"position"in s&&(l=s)}if(l){const{mapDimensions:s}=e,{width:u,height:d}=s;let f={...l.position};const g=f.x-t.x;Math.abs(g)>u/2&&(g>0?f.x-=u:f.x+=u);const m=f.y-t.y;Math.abs(m)>d/2&&(m>0?f.y-=d:f.y+=d);let v=eh(t,f,jf*r);return v={x:(v.x%u+u)%u,y:(v.y%d+d)%d},v}return e.viewportCenter};function JN(e,t){const{width:r,height:o}=e.mapDimensions;e.viewportCenter={x:(t.x%r+r)%r,y:(t.y%o+o)%o}}const eD=(e,t,r,o)=>{const l={gameState:r},s=_t(r);s&&Ie(l,fe.ButtonClick,s.position);const u=r.uiButtons.find(f=>f.id===e.id);u&&(u.lastActivated=Date.now()),t&&[ge.CommandGather,ge.CommandPlant,ge.ToggleProcreationBehavior].includes(e.action)&&r.hasPlayerEnabledAutopilot++;const{behaviors:d}=r.autopilotControls;switch(e.action){case ge.ReturnToIntro:r.exitConfirmation="pending",r.isPaused=!0;break;case ge.ConfirmExitYes:o(),r.exitConfirmation="inactive";break;case ge.ConfirmExitNo:r.exitConfirmation="inactive",r.isPaused=!1;break;case ge.ToggleMute:r.isMuted=!r.isMuted,zs(r.masterVolume,r.isMuted);break;case ge.TogglePause:r.isPaused=!r.isPaused;break;case ge.FastForward:return Ru(r,iS);case ge.DismissTutorial:r.tutorialState.isActive=!1;break;case ge.CommandEat:s&&s.food.length>0&&(s.activeAction="eating");break;case ge.CommandGather:t?d.gathering=!d.gathering:s&&(s.activeAction="gathering");break;case ge.CommandPlant:t?d.planting=!d.planting:s&&(r.autopilotControls.isManuallyPlanting=!0);break;case ge.ToggleProcreationBehavior:d.procreation=!d.procreation;break;case ge.ToggleAttackBehavior:d.attack=!d.attack;break;case ge.ToggleFeedChildBehavior:d.feedChildren=!d.feedChildren;break;case ge.ToggleAutopilotFollowLeaderBehavior:d.followLeader=!d.followLeader;break;case ge.CommandCallToAttack:s&&s.leaderId===s.id&&(s.isCallingToAttack=!0,s.callToAttackEndTime=r.time+Mo,ke(r,ue.CallToAttack,s.position,Mo),Ie(l,fe.CallToAttack,s.position));break;case ge.CommandFollowMe:t?d.followLeader=!d.followLeader:s&&s.leaderId===s.id&&(s.isCallingToFollow=!0,s.callToFollowEndTime=r.time+na,ke(r,ue.CallToFollow,s.position,na),Ie(l,fe.CallToFollow,s.position));break;case ge.CommandTribeSplit:s&&dh(s,r);break;case ge.CommandBuild:r.buildMenuOpen=!r.buildMenuOpen;break;case ge.SelectStorageSpot:r.selectedBuildingType="storageSpot";break;case ge.SelectPlantingZone:r.selectedBuildingType="plantingZone";break;case ge.SelectRemovalTool:r.selectedBuildingType="removal";break;case ge.ToggleDiplomacy:if(s&&s.leaderId&&e.targetTribeId){const f=s.leaderId,g=e.targetTribeId,m=r.entities.entities[g],v=s.diplomacy,y=m==null?void 0:m.diplomacy;if(v&&y){const I=(v[g]||mt.Friendly)===mt.Friendly?mt.Hostile:mt.Friendly;v[g]=I,y[f]=I}}break}return r};function tD(e,t,r){if(!e.notificationButtonRects)return!1;const o=_t(e);for(const[l,s]of Object.entries(e.notificationButtonRects.dismiss))if(t>=s.x&&t<=s.x+s.width&&r>=s.y&&r<=s.y+s.height)return R_(e,l),o&&Ie({gameState:e},fe.ButtonClick,o.position),!0;for(const[l,s]of Object.entries(e.notificationButtonRects.view))if(t>=s.x&&t<=s.x+s.width&&r>=s.y&&r<=s.y+s.height){const u=e.notifications.find(d=>d.id===l);if(u){let d=u.targetPosition;if(!d&&u.targetEntityIds&&u.targetEntityIds.length>0){const f=e.entities.entities[u.targetEntityIds[0]];f&&(d=f.position)}return d&&JN(e,d),o&&Ie({gameState:e},fe.ButtonClick,o.position),u.highlightedEntityIds&&(u.renderHighlights=!u.renderHighlights),!0}}return!1}const nD=({isActive:e,gameStateRef:t,canvasRef:r,viewportCenterRef:o,playerActionHintsRef:l,keysPressed:s,returnToIntro:u})=>(Re.useEffect(()=>{const d=f=>{if(!e()||t.current.gameOver||!r.current||!f.target||f.target!==r.current)return;const g=r.current.getBoundingClientRect(),m=f.clientX-g.left,v=f.clientY-g.top;if(tD(t.current,m,v))return;const w=t.current.uiButtons.find(E=>m>=E.rect.x&&m<=E.rect.x+E.rect.width&&v>=E.rect.y&&v<=E.rect.y+E.rect.height);if(w){t.current=eD(w,f.shiftKey,t.current,u);return}const I=Mf({x:m,y:v},o.current,{width:r.current.width,height:r.current.height},t.current.mapDimensions);XN(t.current,I)};return window.addEventListener("mousedown",d),()=>{window.removeEventListener("mousedown",d)}},[e,r,t,o,u]),Re.useEffect(()=>{const d=f=>{if(!e()||!r.current)return;const g=r.current.getBoundingClientRect(),m=f.clientX-g.left,v=f.clientY-g.top;t.current.mousePosition={x:m,y:v};let y;if(t.current.notificationButtonRects){for(const[I,E]of Object.entries(t.current.notificationButtonRects.dismiss))if(m>=E.x&&m<=E.x+E.width&&v>=E.y&&v<=E.y+E.height){y=`notification-dismiss-${I}`;break}if(!y){for(const[I,E]of Object.entries(t.current.notificationButtonRects.view))if(m>=E.x&&m<=E.x+E.width&&v>=E.y&&v<=E.y+E.height){y=`notification-view-${I}`;break}}}if(!y)for(let I=t.current.uiButtons.length-1;I>=0;I--){const E=t.current.uiButtons[I];if(m>=E.rect.x&&m<=E.rect.x+E.rect.width&&v>=E.rect.y&&v<=E.rect.y+E.rect.height){y=E.id;break}}if(t.current.hoveredButtonId=y,y){t.current.autopilotControls.hoveredAutopilotAction=void 0;return}const w=_t(t.current);if(w){const I=Mf({x:m,y:v},o.current,{width:r.current.width,height:r.current.height},t.current.mapDimensions);t.current.autopilotControls.hoveredAutopilotAction=VN(I,w,t.current,f.shiftKey)}else t.current.autopilotControls.hoveredAutopilotAction=void 0};return window.addEventListener("mousemove",d),()=>{window.removeEventListener("mousemove",d)}},[e,r,t,o]),Re.useEffect(()=>{const d=g=>{if(!e()||t.current.gameOver)return;const m=g.key.toLowerCase();(m===" "||m==="p"||m==="tab"||(g.ctrlKey||g.metaKey)&&(m==="s"||m==="a"))&&g.preventDefault();const v=KN(g,t.current);if(t.current=v.newState,v.handled)return;const y=_t(t.current);y&&(s.current.add(m),ZN(m,g.shiftKey,t.current,y,l.current))},f=g=>{if(!e()||t.current.gameOver)return;const m=g.key.toLowerCase();s.current.delete(m);const v=_t(t.current);v&&qN(m,v,t.current,s)};return window.addEventListener("keydown",d),window.addEventListener("keyup",f),()=>{window.removeEventListener("keydown",d),window.removeEventListener("keyup",f)}},[e,t,l,s,u]),null),iD=({gameStateRef:e,ctxRef:t,debugPanelTypeRef:r,viewportCenterRef:o,playerActionHintsRef:l,keysPressed:s,canvasRef:u,setAppState:d,appState:f})=>{const g=Re.useRef(),{returnToIntro:m}=Bo(),[v,y,w]=Sv(I=>{var H,x;if(!t.current||!g.current){g.current=I;return}const E=Math.min(I-g.current,1e3)/1e3,{performanceMetrics:C}=e.current;C.currentBucket={renderTime:0,worldUpdateTime:0,aiUpdateTime:0};const F=performance.now();e.current=Ru(e.current,E),C.currentBucket.worldUpdateTime=performance.now()-F;const L=_t(e.current);L?l.current=fh(e.current,L):l.current=[],o.current=QN(e.current,o.current,E);const D=performance.now();hu(t.current,e.current,o.current,l.current,{width:((H=u.current)==null?void 0:H.width)||800,height:((x=u.current)==null?void 0:x.height)||600},!1),C.currentBucket.renderTime=performance.now()-D,C.history.push({bucketTime:e.current.time,...C.currentBucket}),C.history.length>fI&&C.history.shift(),g.current=I,e.current.gameOver&&f!=="gameOver"&&(uh(fe.GameOver,{masterVolume:e.current.masterVolume,isMuted:e.current.isMuted}),d("gameOver",{generations:e.current.generationCount,cause:e.current.causeOfGameOver||"Unknown"}))});return Re.useEffect(()=>(y(),v),[y,v]),Fe.jsx(nD,{isActive:w,gameStateRef:e,canvasRef:u,viewportCenterRef:o,playerActionHintsRef:l,debugPanelTypeRef:r,keysPressed:s,returnToIntro:m})},$0=()=>{const{savedGameState:e,contextReady:t}=Bo(),[r,o]=Re.useState(null);return Re.useEffect(()=>{t&&(e?(console.log("Loading saved game state..."),o(e)):(console.log("Initializing new game state..."),o(YN())))},[t,e]),!t||!r?Fe.jsx("div",{children:"Loading..."}):Fe.jsx(rD,{initialState:r})},rD=({initialState:e})=>{const t=Re.useRef(null),r=Re.useRef(null),o=Re.useRef(e),l=Re.useRef(new Set),s=Re.useRef(e.debugPanel),u=Re.useRef(e.viewportCenter),d=Re.useRef([]),{appState:f,setAppState:g}=Bo();return Fe.jsxs(Fe.Fragment,{children:[Fe.jsx(jN,{canvasRef:t,ctxRef:r,gameStateRef:o,debugPanelTypeRef:s,viewportCenterRef:u,playerActionHintsRef:d}),Fe.jsx(iD,{gameStateRef:o,ctxRef:r,debugPanelTypeRef:s,viewportCenterRef:u,playerActionHintsRef:d,keysPressed:l,canvasRef:t,setAppState:g,appState:f})]})},oD=In.div`
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  text-align: center;
  background-color: rgba(0, 0, 0, 0.75); // Semi-transparent overlay
  color: #fff;
  padding: 20px;
  z-index: 10; // Ensure it's on top
`,sD=In.h1`
  font-family: 'Press Start 2P', cursive;
  font-size: 4rem;
  color: #ff4136; // Red for emphasis
  text-shadow: 4px 4px 0px #000;
  margin-bottom: 1.5rem;
`,jl=In.p`
  font-family: 'Press Start 2P', cursive;
  font-size: 1.2rem;
  margin: 0.5em 0;
  color: #fff;
  text-shadow: 2px 2px 0px #000;
`,aD=In.button`
  font-family: 'Press Start 2P', cursive;
  font-size: 1rem;
  padding: 1rem 2rem;
  margin-top: 2em;
  color: #fff;
  background-color: #ff4136; // Red button
  border: 2px solid #fff;
  box-shadow: 4px 4px 0px #fff;
  cursor: pointer;
  transition: all 0.2s ease-in-out;
  text-transform: uppercase;

  &:hover {
    background-color: #fff;
    color: #ff4136;
    box-shadow: 4px 4px 0px #ff4136;
  }
`,lD=()=>{const{setAppState:e,gameOverDetails:t}=Bo(),r=()=>{e("intro")};return Fe.jsxs(oD,{children:[Fe.jsx(sD,{children:"Game Over"}),Fe.jsx(jl,{children:"Your tribe's lineage has ended."}),t&&Fe.jsxs(Fe.Fragment,{children:[Fe.jsxs(jl,{children:["Generations Survived: ",t.generations]}),Fe.jsxs(jl,{children:["Cause of Extinction: ",t.cause]})]}),!t&&Fe.jsx(jl,{children:"Game details are unavailable."}),Fe.jsx(aD,{onClick:r,children:"Return to Menu"})]})},uD=oI`
  /* CSS Reset */
  *, *::before, *::after {
    box-sizing: border-box;
  }

  body {
    margin: 0;
    padding: 0;
    font-family: 'Press Start 2P', 'Arial', sans-serif;
    background-color: #121212;
    color: #f0f0f0;
    line-height: 1.6;
  }

  /* Additional global styles */
  h1, h2, h3, h4, h5, h6 {
    margin-top: 0;
  }

  button {
    cursor: pointer;
    font-family: inherit;
  }

  /* Prevent overflow issues */
  html, body {
    height: 100%;
    overflow-x: hidden;
  }

  /* Root element for React app */
  #root {
    height: 100%;
  }
`;function cD(e,t){Re.useEffect(()=>{const r=()=>{const o=document.location.hash==="#game"?"game":"intro";t(o)};return window.addEventListener("hashchange",r),r(),()=>{window.removeEventListener("hashchange",r)}},[]),Re.useEffect(()=>{e==="game"?document.location.hash="#game":e==="intro"&&(document.location.hash="")},[e])}const dD=()=>{const{appState:e,setAppState:t}=Bo();cD(e,t);const r=()=>{switch(e){case"intro":return Fe.jsx(x0,{});case"game":return Fe.jsx($0,{});case"gameOver":return Fe.jsxs(Fe.Fragment,{children:[Fe.jsx($0,{}),Fe.jsx(lD,{})]});default:return Fe.jsx(x0,{})}};return Fe.jsxs(Fe.Fragment,{children:[Fe.jsx(uD,{}),r()]})},z0=document.getElementById("root");z0?G_().then(()=>{VT.createRoot(z0).render(Fe.jsx(qn.StrictMode,{children:Fe.jsx(rA,{initialAppState:document.location.hash==="#game"?"game":"intro",children:Fe.jsx(dD,{})})}))}):console.error("Failed to find the root element");
