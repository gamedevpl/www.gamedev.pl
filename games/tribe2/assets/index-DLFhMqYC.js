var zA=Object.defineProperty;var YA=(e,t,i)=>t in e?zA(e,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[t]=i;var Ne=(e,t,i)=>YA(e,typeof t!="symbol"?t+"":t,i);(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))o(a);new MutationObserver(a=>{for(const s of a)if(s.type==="childList")for(const u of s.addedNodes)u.tagName==="LINK"&&u.rel==="modulepreload"&&o(u)}).observe(document,{childList:!0,subtree:!0});function i(a){const s={};return a.integrity&&(s.integrity=a.integrity),a.referrerPolicy&&(s.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?s.credentials="include":a.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function o(a){if(a.ep)return;a.ep=!0;const s=i(a);fetch(a.href,s)}})();function tv(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var Ld={exports:{}},Ys={},Ud={exports:{}},He={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var vm;function jA(){if(vm)return He;vm=1;var e=Symbol.for("react.element"),t=Symbol.for("react.portal"),i=Symbol.for("react.fragment"),o=Symbol.for("react.strict_mode"),a=Symbol.for("react.profiler"),s=Symbol.for("react.provider"),u=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),f=Symbol.for("react.suspense"),g=Symbol.for("react.memo"),m=Symbol.for("react.lazy"),S=Symbol.iterator;function T(N){return N===null||typeof N!="object"?null:(N=S&&N[S]||N["@@iterator"],typeof N=="function"?N:null)}var A={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},I=Object.assign,y={};function C(N,b,K){this.props=N,this.context=b,this.refs=y,this.updater=K||A}C.prototype.isReactComponent={},C.prototype.setState=function(N,b){if(typeof N!="object"&&typeof N!="function"&&N!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,N,b,"setState")},C.prototype.forceUpdate=function(N){this.updater.enqueueForceUpdate(this,N,"forceUpdate")};function O(){}O.prototype=C.prototype;function F(N,b,K){this.props=N,this.context=b,this.refs=y,this.updater=K||A}var P=F.prototype=new O;P.constructor=F,I(P,C.prototype),P.isPureReactComponent=!0;var H=Array.isArray,B=Object.prototype.hasOwnProperty,U={current:null},G={key:!0,ref:!0,__self:!0,__source:!0};function Z(N,b,K){var J,pe={},ae=null,Re=null;if(b!=null)for(J in b.ref!==void 0&&(Re=b.ref),b.key!==void 0&&(ae=""+b.key),b)B.call(b,J)&&!G.hasOwnProperty(J)&&(pe[J]=b[J]);var Ce=arguments.length-2;if(Ce===1)pe.children=K;else if(1<Ce){for(var q=Array(Ce),le=0;le<Ce;le++)q[le]=arguments[le+2];pe.children=q}if(N&&N.defaultProps)for(J in Ce=N.defaultProps,Ce)pe[J]===void 0&&(pe[J]=Ce[J]);return{$$typeof:e,type:N,key:ae,ref:Re,props:pe,_owner:U.current}}function te(N,b){return{$$typeof:e,type:N.type,key:b,ref:N.ref,props:N.props,_owner:N._owner}}function ve(N){return typeof N=="object"&&N!==null&&N.$$typeof===e}function be(N){var b={"=":"=0",":":"=2"};return"$"+N.replace(/[=:]/g,function(K){return b[K]})}var De=/\/+/g;function Ie(N,b){return typeof N=="object"&&N!==null&&N.key!=null?be(""+N.key):b.toString(36)}function he(N,b,K,J,pe){var ae=typeof N;(ae==="undefined"||ae==="boolean")&&(N=null);var Re=!1;if(N===null)Re=!0;else switch(ae){case"string":case"number":Re=!0;break;case"object":switch(N.$$typeof){case e:case t:Re=!0}}if(Re)return Re=N,pe=pe(Re),N=J===""?"."+Ie(Re,0):J,H(pe)?(K="",N!=null&&(K=N.replace(De,"$&/")+"/"),he(pe,b,K,"",function(le){return le})):pe!=null&&(ve(pe)&&(pe=te(pe,K+(!pe.key||Re&&Re.key===pe.key?"":(""+pe.key).replace(De,"$&/")+"/")+N)),b.push(pe)),1;if(Re=0,J=J===""?".":J+":",H(N))for(var Ce=0;Ce<N.length;Ce++){ae=N[Ce];var q=J+Ie(ae,Ce);Re+=he(ae,b,K,q,pe)}else if(q=T(N),typeof q=="function")for(N=q.call(N),Ce=0;!(ae=N.next()).done;)ae=ae.value,q=J+Ie(ae,Ce++),Re+=he(ae,b,K,q,pe);else if(ae==="object")throw b=String(N),Error("Objects are not valid as a React child (found: "+(b==="[object Object]"?"object with keys {"+Object.keys(N).join(", ")+"}":b)+"). If you meant to render a collection of children, use an array instead.");return Re}function Fe(N,b,K){if(N==null)return N;var J=[],pe=0;return he(N,J,"","",function(ae){return b.call(K,ae,pe++)}),J}function Se(N){if(N._status===-1){var b=N._result;b=b(),b.then(function(K){(N._status===0||N._status===-1)&&(N._status=1,N._result=K)},function(K){(N._status===0||N._status===-1)&&(N._status=2,N._result=K)}),N._status===-1&&(N._status=0,N._result=b)}if(N._status===1)return N._result.default;throw N._result}var ne={current:null},z={transition:null},X={ReactCurrentDispatcher:ne,ReactCurrentBatchConfig:z,ReactCurrentOwner:U};function Y(){throw Error("act(...) is not supported in production builds of React.")}return He.Children={map:Fe,forEach:function(N,b,K){Fe(N,function(){b.apply(this,arguments)},K)},count:function(N){var b=0;return Fe(N,function(){b++}),b},toArray:function(N){return Fe(N,function(b){return b})||[]},only:function(N){if(!ve(N))throw Error("React.Children.only expected to receive a single React element child.");return N}},He.Component=C,He.Fragment=i,He.Profiler=a,He.PureComponent=F,He.StrictMode=o,He.Suspense=f,He.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=X,He.act=Y,He.cloneElement=function(N,b,K){if(N==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+N+".");var J=I({},N.props),pe=N.key,ae=N.ref,Re=N._owner;if(b!=null){if(b.ref!==void 0&&(ae=b.ref,Re=U.current),b.key!==void 0&&(pe=""+b.key),N.type&&N.type.defaultProps)var Ce=N.type.defaultProps;for(q in b)B.call(b,q)&&!G.hasOwnProperty(q)&&(J[q]=b[q]===void 0&&Ce!==void 0?Ce[q]:b[q])}var q=arguments.length-2;if(q===1)J.children=K;else if(1<q){Ce=Array(q);for(var le=0;le<q;le++)Ce[le]=arguments[le+2];J.children=Ce}return{$$typeof:e,type:N.type,key:pe,ref:ae,props:J,_owner:Re}},He.createContext=function(N){return N={$$typeof:u,_currentValue:N,_currentValue2:N,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},N.Provider={$$typeof:s,_context:N},N.Consumer=N},He.createElement=Z,He.createFactory=function(N){var b=Z.bind(null,N);return b.type=N,b},He.createRef=function(){return{current:null}},He.forwardRef=function(N){return{$$typeof:c,render:N}},He.isValidElement=ve,He.lazy=function(N){return{$$typeof:m,_payload:{_status:-1,_result:N},_init:Se}},He.memo=function(N,b){return{$$typeof:g,type:N,compare:b===void 0?null:b}},He.startTransition=function(N){var b=z.transition;z.transition={};try{N()}finally{z.transition=b}},He.unstable_act=Y,He.useCallback=function(N,b){return ne.current.useCallback(N,b)},He.useContext=function(N){return ne.current.useContext(N)},He.useDebugValue=function(){},He.useDeferredValue=function(N){return ne.current.useDeferredValue(N)},He.useEffect=function(N,b){return ne.current.useEffect(N,b)},He.useId=function(){return ne.current.useId()},He.useImperativeHandle=function(N,b,K){return ne.current.useImperativeHandle(N,b,K)},He.useInsertionEffect=function(N,b){return ne.current.useInsertionEffect(N,b)},He.useLayoutEffect=function(N,b){return ne.current.useLayoutEffect(N,b)},He.useMemo=function(N,b){return ne.current.useMemo(N,b)},He.useReducer=function(N,b,K){return ne.current.useReducer(N,b,K)},He.useRef=function(N){return ne.current.useRef(N)},He.useState=function(N){return ne.current.useState(N)},He.useSyncExternalStore=function(N,b,K){return ne.current.useSyncExternalStore(N,b,K)},He.useTransition=function(){return ne.current.useTransition()},He.version="18.3.1",He}var Sm;function $f(){return Sm||(Sm=1,Ud.exports=jA()),Ud.exports}/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ym;function VA(){if(ym)return Ys;ym=1;var e=$f(),t=Symbol.for("react.element"),i=Symbol.for("react.fragment"),o=Object.prototype.hasOwnProperty,a=e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,s={key:!0,ref:!0,__self:!0,__source:!0};function u(c,f,g){var m,S={},T=null,A=null;g!==void 0&&(T=""+g),f.key!==void 0&&(T=""+f.key),f.ref!==void 0&&(A=f.ref);for(m in f)o.call(f,m)&&!s.hasOwnProperty(m)&&(S[m]=f[m]);if(c&&c.defaultProps)for(m in f=c.defaultProps,f)S[m]===void 0&&(S[m]=f[m]);return{$$typeof:t,type:c,key:T,ref:A,props:S,_owner:a.current}}return Ys.Fragment=i,Ys.jsx=u,Ys.jsxs=u,Ys}var Am;function XA(){return Am||(Am=1,Ld.exports=VA()),Ld.exports}var Ue=XA(),Oe=$f();const ti=tv(Oe);var $l={},Bd={exports:{}},tn={},Hd={exports:{}},bd={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Tm;function KA(){return Tm||(Tm=1,function(e){function t(z,X){var Y=z.length;z.push(X);e:for(;0<Y;){var N=Y-1>>>1,b=z[N];if(0<a(b,X))z[N]=X,z[Y]=b,Y=N;else break e}}function i(z){return z.length===0?null:z[0]}function o(z){if(z.length===0)return null;var X=z[0],Y=z.pop();if(Y!==X){z[0]=Y;e:for(var N=0,b=z.length,K=b>>>1;N<K;){var J=2*(N+1)-1,pe=z[J],ae=J+1,Re=z[ae];if(0>a(pe,Y))ae<b&&0>a(Re,pe)?(z[N]=Re,z[ae]=Y,N=ae):(z[N]=pe,z[J]=Y,N=J);else if(ae<b&&0>a(Re,Y))z[N]=Re,z[ae]=Y,N=ae;else break e}}return X}function a(z,X){var Y=z.sortIndex-X.sortIndex;return Y!==0?Y:z.id-X.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;e.unstable_now=function(){return s.now()}}else{var u=Date,c=u.now();e.unstable_now=function(){return u.now()-c}}var f=[],g=[],m=1,S=null,T=3,A=!1,I=!1,y=!1,C=typeof setTimeout=="function"?setTimeout:null,O=typeof clearTimeout=="function"?clearTimeout:null,F=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function P(z){for(var X=i(g);X!==null;){if(X.callback===null)o(g);else if(X.startTime<=z)o(g),X.sortIndex=X.expirationTime,t(f,X);else break;X=i(g)}}function H(z){if(y=!1,P(z),!I)if(i(f)!==null)I=!0,Se(B);else{var X=i(g);X!==null&&ne(H,X.startTime-z)}}function B(z,X){I=!1,y&&(y=!1,O(Z),Z=-1),A=!0;var Y=T;try{for(P(X),S=i(f);S!==null&&(!(S.expirationTime>X)||z&&!be());){var N=S.callback;if(typeof N=="function"){S.callback=null,T=S.priorityLevel;var b=N(S.expirationTime<=X);X=e.unstable_now(),typeof b=="function"?S.callback=b:S===i(f)&&o(f),P(X)}else o(f);S=i(f)}if(S!==null)var K=!0;else{var J=i(g);J!==null&&ne(H,J.startTime-X),K=!1}return K}finally{S=null,T=Y,A=!1}}var U=!1,G=null,Z=-1,te=5,ve=-1;function be(){return!(e.unstable_now()-ve<te)}function De(){if(G!==null){var z=e.unstable_now();ve=z;var X=!0;try{X=G(!0,z)}finally{X?Ie():(U=!1,G=null)}}else U=!1}var Ie;if(typeof F=="function")Ie=function(){F(De)};else if(typeof MessageChannel<"u"){var he=new MessageChannel,Fe=he.port2;he.port1.onmessage=De,Ie=function(){Fe.postMessage(null)}}else Ie=function(){C(De,0)};function Se(z){G=z,U||(U=!0,Ie())}function ne(z,X){Z=C(function(){z(e.unstable_now())},X)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(z){z.callback=null},e.unstable_continueExecution=function(){I||A||(I=!0,Se(B))},e.unstable_forceFrameRate=function(z){0>z||125<z?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):te=0<z?Math.floor(1e3/z):5},e.unstable_getCurrentPriorityLevel=function(){return T},e.unstable_getFirstCallbackNode=function(){return i(f)},e.unstable_next=function(z){switch(T){case 1:case 2:case 3:var X=3;break;default:X=T}var Y=T;T=X;try{return z()}finally{T=Y}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(z,X){switch(z){case 1:case 2:case 3:case 4:case 5:break;default:z=3}var Y=T;T=z;try{return X()}finally{T=Y}},e.unstable_scheduleCallback=function(z,X,Y){var N=e.unstable_now();switch(typeof Y=="object"&&Y!==null?(Y=Y.delay,Y=typeof Y=="number"&&0<Y?N+Y:N):Y=N,z){case 1:var b=-1;break;case 2:b=250;break;case 5:b=1073741823;break;case 4:b=1e4;break;default:b=5e3}return b=Y+b,z={id:m++,callback:X,priorityLevel:z,startTime:Y,expirationTime:b,sortIndex:-1},Y>N?(z.sortIndex=Y,t(g,z),i(f)===null&&z===i(g)&&(y?(O(Z),Z=-1):y=!0,ne(H,Y-N))):(z.sortIndex=b,t(f,z),I||A||(I=!0,Se(B))),z},e.unstable_shouldYield=be,e.unstable_wrapCallback=function(z){var X=T;return function(){var Y=T;T=X;try{return z.apply(this,arguments)}finally{T=Y}}}}(bd)),bd}var Im;function ZA(){return Im||(Im=1,Hd.exports=KA()),Hd.exports}/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Em;function qA(){if(Em)return tn;Em=1;var e=$f(),t=ZA();function i(n){for(var r="https://reactjs.org/docs/error-decoder.html?invariant="+n,l=1;l<arguments.length;l++)r+="&args[]="+encodeURIComponent(arguments[l]);return"Minified React error #"+n+"; visit "+r+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var o=new Set,a={};function s(n,r){u(n,r),u(n+"Capture",r)}function u(n,r){for(a[n]=r,n=0;n<r.length;n++)o.add(r[n])}var c=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),f=Object.prototype.hasOwnProperty,g=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,m={},S={};function T(n){return f.call(S,n)?!0:f.call(m,n)?!1:g.test(n)?S[n]=!0:(m[n]=!0,!1)}function A(n,r,l,d){if(l!==null&&l.type===0)return!1;switch(typeof r){case"function":case"symbol":return!0;case"boolean":return d?!1:l!==null?!l.acceptsBooleans:(n=n.toLowerCase().slice(0,5),n!=="data-"&&n!=="aria-");default:return!1}}function I(n,r,l,d){if(r===null||typeof r>"u"||A(n,r,l,d))return!0;if(d)return!1;if(l!==null)switch(l.type){case 3:return!r;case 4:return r===!1;case 5:return isNaN(r);case 6:return isNaN(r)||1>r}return!1}function y(n,r,l,d,h,p,v){this.acceptsBooleans=r===2||r===3||r===4,this.attributeName=d,this.attributeNamespace=h,this.mustUseProperty=l,this.propertyName=n,this.type=r,this.sanitizeURL=p,this.removeEmptyString=v}var C={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(n){C[n]=new y(n,0,!1,n,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(n){var r=n[0];C[r]=new y(r,1,!1,n[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(n){C[n]=new y(n,2,!1,n.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(n){C[n]=new y(n,2,!1,n,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(n){C[n]=new y(n,3,!1,n.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(n){C[n]=new y(n,3,!0,n,null,!1,!1)}),["capture","download"].forEach(function(n){C[n]=new y(n,4,!1,n,null,!1,!1)}),["cols","rows","size","span"].forEach(function(n){C[n]=new y(n,6,!1,n,null,!1,!1)}),["rowSpan","start"].forEach(function(n){C[n]=new y(n,5,!1,n.toLowerCase(),null,!1,!1)});var O=/[\-:]([a-z])/g;function F(n){return n[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(n){var r=n.replace(O,F);C[r]=new y(r,1,!1,n,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(n){var r=n.replace(O,F);C[r]=new y(r,1,!1,n,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(n){var r=n.replace(O,F);C[r]=new y(r,1,!1,n,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(n){C[n]=new y(n,1,!1,n.toLowerCase(),null,!1,!1)}),C.xlinkHref=new y("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(n){C[n]=new y(n,1,!1,n.toLowerCase(),null,!0,!0)});function P(n,r,l,d){var h=C.hasOwnProperty(r)?C[r]:null;(h!==null?h.type!==0:d||!(2<r.length)||r[0]!=="o"&&r[0]!=="O"||r[1]!=="n"&&r[1]!=="N")&&(I(r,l,h,d)&&(l=null),d||h===null?T(r)&&(l===null?n.removeAttribute(r):n.setAttribute(r,""+l)):h.mustUseProperty?n[h.propertyName]=l===null?h.type===3?!1:"":l:(r=h.attributeName,d=h.attributeNamespace,l===null?n.removeAttribute(r):(h=h.type,l=h===3||h===4&&l===!0?"":""+l,d?n.setAttributeNS(d,r,l):n.setAttribute(r,l))))}var H=e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,B=Symbol.for("react.element"),U=Symbol.for("react.portal"),G=Symbol.for("react.fragment"),Z=Symbol.for("react.strict_mode"),te=Symbol.for("react.profiler"),ve=Symbol.for("react.provider"),be=Symbol.for("react.context"),De=Symbol.for("react.forward_ref"),Ie=Symbol.for("react.suspense"),he=Symbol.for("react.suspense_list"),Fe=Symbol.for("react.memo"),Se=Symbol.for("react.lazy"),ne=Symbol.for("react.offscreen"),z=Symbol.iterator;function X(n){return n===null||typeof n!="object"?null:(n=z&&n[z]||n["@@iterator"],typeof n=="function"?n:null)}var Y=Object.assign,N;function b(n){if(N===void 0)try{throw Error()}catch(l){var r=l.stack.trim().match(/\n( *(at )?)/);N=r&&r[1]||""}return`
`+N+n}var K=!1;function J(n,r){if(!n||K)return"";K=!0;var l=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(r)if(r=function(){throw Error()},Object.defineProperty(r.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(r,[])}catch(L){var d=L}Reflect.construct(n,[],r)}else{try{r.call()}catch(L){d=L}n.call(r.prototype)}else{try{throw Error()}catch(L){d=L}n()}}catch(L){if(L&&d&&typeof L.stack=="string"){for(var h=L.stack.split(`
`),p=d.stack.split(`
`),v=h.length-1,w=p.length-1;1<=v&&0<=w&&h[v]!==p[w];)w--;for(;1<=v&&0<=w;v--,w--)if(h[v]!==p[w]){if(v!==1||w!==1)do if(v--,w--,0>w||h[v]!==p[w]){var R=`
`+h[v].replace(" at new "," at ");return n.displayName&&R.includes("<anonymous>")&&(R=R.replace("<anonymous>",n.displayName)),R}while(1<=v&&0<=w);break}}}finally{K=!1,Error.prepareStackTrace=l}return(n=n?n.displayName||n.name:"")?b(n):""}function pe(n){switch(n.tag){case 5:return b(n.type);case 16:return b("Lazy");case 13:return b("Suspense");case 19:return b("SuspenseList");case 0:case 2:case 15:return n=J(n.type,!1),n;case 11:return n=J(n.type.render,!1),n;case 1:return n=J(n.type,!0),n;default:return""}}function ae(n){if(n==null)return null;if(typeof n=="function")return n.displayName||n.name||null;if(typeof n=="string")return n;switch(n){case G:return"Fragment";case U:return"Portal";case te:return"Profiler";case Z:return"StrictMode";case Ie:return"Suspense";case he:return"SuspenseList"}if(typeof n=="object")switch(n.$$typeof){case be:return(n.displayName||"Context")+".Consumer";case ve:return(n._context.displayName||"Context")+".Provider";case De:var r=n.render;return n=n.displayName,n||(n=r.displayName||r.name||"",n=n!==""?"ForwardRef("+n+")":"ForwardRef"),n;case Fe:return r=n.displayName||null,r!==null?r:ae(n.type)||"Memo";case Se:r=n._payload,n=n._init;try{return ae(n(r))}catch{}}return null}function Re(n){var r=n.type;switch(n.tag){case 24:return"Cache";case 9:return(r.displayName||"Context")+".Consumer";case 10:return(r._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return n=r.render,n=n.displayName||n.name||"",r.displayName||(n!==""?"ForwardRef("+n+")":"ForwardRef");case 7:return"Fragment";case 5:return r;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return ae(r);case 8:return r===Z?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof r=="function")return r.displayName||r.name||null;if(typeof r=="string")return r}return null}function Ce(n){switch(typeof n){case"boolean":case"number":case"string":case"undefined":return n;case"object":return n;default:return""}}function q(n){var r=n.type;return(n=n.nodeName)&&n.toLowerCase()==="input"&&(r==="checkbox"||r==="radio")}function le(n){var r=q(n)?"checked":"value",l=Object.getOwnPropertyDescriptor(n.constructor.prototype,r),d=""+n[r];if(!n.hasOwnProperty(r)&&typeof l<"u"&&typeof l.get=="function"&&typeof l.set=="function"){var h=l.get,p=l.set;return Object.defineProperty(n,r,{configurable:!0,get:function(){return h.call(this)},set:function(v){d=""+v,p.call(this,v)}}),Object.defineProperty(n,r,{enumerable:l.enumerable}),{getValue:function(){return d},setValue:function(v){d=""+v},stopTracking:function(){n._valueTracker=null,delete n[r]}}}}function Be(n){n._valueTracker||(n._valueTracker=le(n))}function ye(n){if(!n)return!1;var r=n._valueTracker;if(!r)return!0;var l=r.getValue(),d="";return n&&(d=q(n)?n.checked?"true":"false":n.value),n=d,n!==l?(r.setValue(n),!0):!1}function Gn(n){if(n=n||(typeof document<"u"?document:void 0),typeof n>"u")return null;try{return n.activeElement||n.body}catch{return n.body}}function nt(n,r){var l=r.checked;return Y({},r,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:l??n._wrapperState.initialChecked})}function qe(n,r){var l=r.defaultValue==null?"":r.defaultValue,d=r.checked!=null?r.checked:r.defaultChecked;l=Ce(r.value!=null?r.value:l),n._wrapperState={initialChecked:d,initialValue:l,controlled:r.type==="checkbox"||r.type==="radio"?r.checked!=null:r.value!=null}}function xn(n,r){r=r.checked,r!=null&&P(n,"checked",r,!1)}function Kt(n,r){xn(n,r);var l=Ce(r.value),d=r.type;if(l!=null)d==="number"?(l===0&&n.value===""||n.value!=l)&&(n.value=""+l):n.value!==""+l&&(n.value=""+l);else if(d==="submit"||d==="reset"){n.removeAttribute("value");return}r.hasOwnProperty("value")?$n(n,r.type,l):r.hasOwnProperty("defaultValue")&&$n(n,r.type,Ce(r.defaultValue)),r.checked==null&&r.defaultChecked!=null&&(n.defaultChecked=!!r.defaultChecked)}function hn(n,r,l){if(r.hasOwnProperty("value")||r.hasOwnProperty("defaultValue")){var d=r.type;if(!(d!=="submit"&&d!=="reset"||r.value!==void 0&&r.value!==null))return;r=""+n._wrapperState.initialValue,l||r===n.value||(n.value=r),n.defaultValue=r}l=n.name,l!==""&&(n.name=""),n.defaultChecked=!!n._wrapperState.initialChecked,l!==""&&(n.name=l)}function $n(n,r,l){(r!=="number"||Gn(n.ownerDocument)!==n)&&(l==null?n.defaultValue=""+n._wrapperState.initialValue:n.defaultValue!==""+l&&(n.defaultValue=""+l))}var Wn=Array.isArray;function Ei(n,r,l,d){if(n=n.options,r){r={};for(var h=0;h<l.length;h++)r["$"+l[h]]=!0;for(l=0;l<n.length;l++)h=r.hasOwnProperty("$"+n[l].value),n[l].selected!==h&&(n[l].selected=h),h&&d&&(n[l].defaultSelected=!0)}else{for(l=""+Ce(l),r=null,h=0;h<n.length;h++){if(n[h].value===l){n[h].selected=!0,d&&(n[h].defaultSelected=!0);return}r!==null||n[h].disabled||(r=n[h])}r!==null&&(r.selected=!0)}}function dr(n,r){if(r.dangerouslySetInnerHTML!=null)throw Error(i(91));return Y({},r,{value:void 0,defaultValue:void 0,children:""+n._wrapperState.initialValue})}function Rh(n,r){var l=r.value;if(l==null){if(l=r.children,r=r.defaultValue,l!=null){if(r!=null)throw Error(i(92));if(Wn(l)){if(1<l.length)throw Error(i(93));l=l[0]}r=l}r==null&&(r=""),l=r}n._wrapperState={initialValue:Ce(l)}}function Ph(n,r){var l=Ce(r.value),d=Ce(r.defaultValue);l!=null&&(l=""+l,l!==n.value&&(n.value=l),r.defaultValue==null&&n.defaultValue!==l&&(n.defaultValue=l)),d!=null&&(n.defaultValue=""+d)}function Nh(n){var r=n.textContent;r===n._wrapperState.initialValue&&r!==""&&r!==null&&(n.value=r)}function Dh(n){switch(n){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function ju(n,r){return n==null||n==="http://www.w3.org/1999/xhtml"?Dh(r):n==="http://www.w3.org/2000/svg"&&r==="foreignObject"?"http://www.w3.org/1999/xhtml":n}var Fa,Oh=function(n){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(r,l,d,h){MSApp.execUnsafeLocalFunction(function(){return n(r,l,d,h)})}:n}(function(n,r){if(n.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in n)n.innerHTML=r;else{for(Fa=Fa||document.createElement("div"),Fa.innerHTML="<svg>"+r.valueOf().toString()+"</svg>",r=Fa.firstChild;n.firstChild;)n.removeChild(n.firstChild);for(;r.firstChild;)n.appendChild(r.firstChild)}});function as(n,r){if(r){var l=n.firstChild;if(l&&l===n.lastChild&&l.nodeType===3){l.nodeValue=r;return}}n.textContent=r}var ls={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},XS=["Webkit","ms","Moz","O"];Object.keys(ls).forEach(function(n){XS.forEach(function(r){r=r+n.charAt(0).toUpperCase()+n.substring(1),ls[r]=ls[n]})});function Mh(n,r,l){return r==null||typeof r=="boolean"||r===""?"":l||typeof r!="number"||r===0||ls.hasOwnProperty(n)&&ls[n]?(""+r).trim():r+"px"}function kh(n,r){n=n.style;for(var l in r)if(r.hasOwnProperty(l)){var d=l.indexOf("--")===0,h=Mh(l,r[l],d);l==="float"&&(l="cssFloat"),d?n.setProperty(l,h):n[l]=h}}var KS=Y({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Vu(n,r){if(r){if(KS[n]&&(r.children!=null||r.dangerouslySetInnerHTML!=null))throw Error(i(137,n));if(r.dangerouslySetInnerHTML!=null){if(r.children!=null)throw Error(i(60));if(typeof r.dangerouslySetInnerHTML!="object"||!("__html"in r.dangerouslySetInnerHTML))throw Error(i(61))}if(r.style!=null&&typeof r.style!="object")throw Error(i(62))}}function Xu(n,r){if(n.indexOf("-")===-1)return typeof r.is=="string";switch(n){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Ku=null;function Zu(n){return n=n.target||n.srcElement||window,n.correspondingUseElement&&(n=n.correspondingUseElement),n.nodeType===3?n.parentNode:n}var qu=null,Xr=null,Kr=null;function Fh(n){if(n=Ds(n)){if(typeof qu!="function")throw Error(i(280));var r=n.stateNode;r&&(r=il(r),qu(n.stateNode,n.type,r))}}function Lh(n){Xr?Kr?Kr.push(n):Kr=[n]:Xr=n}function Uh(){if(Xr){var n=Xr,r=Kr;if(Kr=Xr=null,Fh(n),r)for(n=0;n<r.length;n++)Fh(r[n])}}function Bh(n,r){return n(r)}function Hh(){}var Qu=!1;function bh(n,r,l){if(Qu)return n(r,l);Qu=!0;try{return Bh(n,r,l)}finally{Qu=!1,(Xr!==null||Kr!==null)&&(Hh(),Uh())}}function us(n,r){var l=n.stateNode;if(l===null)return null;var d=il(l);if(d===null)return null;l=d[r];e:switch(r){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(d=!d.disabled)||(n=n.type,d=!(n==="button"||n==="input"||n==="select"||n==="textarea")),n=!d;break e;default:n=!1}if(n)return null;if(l&&typeof l!="function")throw Error(i(231,r,typeof l));return l}var Ju=!1;if(c)try{var cs={};Object.defineProperty(cs,"passive",{get:function(){Ju=!0}}),window.addEventListener("test",cs,cs),window.removeEventListener("test",cs,cs)}catch{Ju=!1}function ZS(n,r,l,d,h,p,v,w,R){var L=Array.prototype.slice.call(arguments,3);try{r.apply(l,L)}catch($){this.onError($)}}var ds=!1,La=null,Ua=!1,ec=null,qS={onError:function(n){ds=!0,La=n}};function QS(n,r,l,d,h,p,v,w,R){ds=!1,La=null,ZS.apply(qS,arguments)}function JS(n,r,l,d,h,p,v,w,R){if(QS.apply(this,arguments),ds){if(ds){var L=La;ds=!1,La=null}else throw Error(i(198));Ua||(Ua=!0,ec=L)}}function fr(n){var r=n,l=n;if(n.alternate)for(;r.return;)r=r.return;else{n=r;do r=n,(r.flags&4098)!==0&&(l=r.return),n=r.return;while(n)}return r.tag===3?l:null}function Gh(n){if(n.tag===13){var r=n.memoizedState;if(r===null&&(n=n.alternate,n!==null&&(r=n.memoizedState)),r!==null)return r.dehydrated}return null}function xh(n){if(fr(n)!==n)throw Error(i(188))}function ey(n){var r=n.alternate;if(!r){if(r=fr(n),r===null)throw Error(i(188));return r!==n?null:n}for(var l=n,d=r;;){var h=l.return;if(h===null)break;var p=h.alternate;if(p===null){if(d=h.return,d!==null){l=d;continue}break}if(h.child===p.child){for(p=h.child;p;){if(p===l)return xh(h),n;if(p===d)return xh(h),r;p=p.sibling}throw Error(i(188))}if(l.return!==d.return)l=h,d=p;else{for(var v=!1,w=h.child;w;){if(w===l){v=!0,l=h,d=p;break}if(w===d){v=!0,d=h,l=p;break}w=w.sibling}if(!v){for(w=p.child;w;){if(w===l){v=!0,l=p,d=h;break}if(w===d){v=!0,d=p,l=h;break}w=w.sibling}if(!v)throw Error(i(189))}}if(l.alternate!==d)throw Error(i(190))}if(l.tag!==3)throw Error(i(188));return l.stateNode.current===l?n:r}function $h(n){return n=ey(n),n!==null?Wh(n):null}function Wh(n){if(n.tag===5||n.tag===6)return n;for(n=n.child;n!==null;){var r=Wh(n);if(r!==null)return r;n=n.sibling}return null}var zh=t.unstable_scheduleCallback,Yh=t.unstable_cancelCallback,ty=t.unstable_shouldYield,ny=t.unstable_requestPaint,ut=t.unstable_now,iy=t.unstable_getCurrentPriorityLevel,tc=t.unstable_ImmediatePriority,jh=t.unstable_UserBlockingPriority,Ba=t.unstable_NormalPriority,ry=t.unstable_LowPriority,Vh=t.unstable_IdlePriority,Ha=null,zn=null;function oy(n){if(zn&&typeof zn.onCommitFiberRoot=="function")try{zn.onCommitFiberRoot(Ha,n,void 0,(n.current.flags&128)===128)}catch{}}var wn=Math.clz32?Math.clz32:ly,sy=Math.log,ay=Math.LN2;function ly(n){return n>>>=0,n===0?32:31-(sy(n)/ay|0)|0}var ba=64,Ga=4194304;function fs(n){switch(n&-n){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return n&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return n&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return n}}function xa(n,r){var l=n.pendingLanes;if(l===0)return 0;var d=0,h=n.suspendedLanes,p=n.pingedLanes,v=l&268435455;if(v!==0){var w=v&~h;w!==0?d=fs(w):(p&=v,p!==0&&(d=fs(p)))}else v=l&~h,v!==0?d=fs(v):p!==0&&(d=fs(p));if(d===0)return 0;if(r!==0&&r!==d&&(r&h)===0&&(h=d&-d,p=r&-r,h>=p||h===16&&(p&4194240)!==0))return r;if((d&4)!==0&&(d|=l&16),r=n.entangledLanes,r!==0)for(n=n.entanglements,r&=d;0<r;)l=31-wn(r),h=1<<l,d|=n[l],r&=~h;return d}function uy(n,r){switch(n){case 1:case 2:case 4:return r+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return r+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function cy(n,r){for(var l=n.suspendedLanes,d=n.pingedLanes,h=n.expirationTimes,p=n.pendingLanes;0<p;){var v=31-wn(p),w=1<<v,R=h[v];R===-1?((w&l)===0||(w&d)!==0)&&(h[v]=uy(w,r)):R<=r&&(n.expiredLanes|=w),p&=~w}}function nc(n){return n=n.pendingLanes&-1073741825,n!==0?n:n&1073741824?1073741824:0}function Xh(){var n=ba;return ba<<=1,(ba&4194240)===0&&(ba=64),n}function ic(n){for(var r=[],l=0;31>l;l++)r.push(n);return r}function hs(n,r,l){n.pendingLanes|=r,r!==536870912&&(n.suspendedLanes=0,n.pingedLanes=0),n=n.eventTimes,r=31-wn(r),n[r]=l}function dy(n,r){var l=n.pendingLanes&~r;n.pendingLanes=r,n.suspendedLanes=0,n.pingedLanes=0,n.expiredLanes&=r,n.mutableReadLanes&=r,n.entangledLanes&=r,r=n.entanglements;var d=n.eventTimes;for(n=n.expirationTimes;0<l;){var h=31-wn(l),p=1<<h;r[h]=0,d[h]=-1,n[h]=-1,l&=~p}}function rc(n,r){var l=n.entangledLanes|=r;for(n=n.entanglements;l;){var d=31-wn(l),h=1<<d;h&r|n[d]&r&&(n[d]|=r),l&=~h}}var ze=0;function Kh(n){return n&=-n,1<n?4<n?(n&268435455)!==0?16:536870912:4:1}var Zh,oc,qh,Qh,Jh,sc=!1,$a=[],Ci=null,_i=null,wi=null,gs=new Map,ps=new Map,Ri=[],fy="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function eg(n,r){switch(n){case"focusin":case"focusout":Ci=null;break;case"dragenter":case"dragleave":_i=null;break;case"mouseover":case"mouseout":wi=null;break;case"pointerover":case"pointerout":gs.delete(r.pointerId);break;case"gotpointercapture":case"lostpointercapture":ps.delete(r.pointerId)}}function ms(n,r,l,d,h,p){return n===null||n.nativeEvent!==p?(n={blockedOn:r,domEventName:l,eventSystemFlags:d,nativeEvent:p,targetContainers:[h]},r!==null&&(r=Ds(r),r!==null&&oc(r)),n):(n.eventSystemFlags|=d,r=n.targetContainers,h!==null&&r.indexOf(h)===-1&&r.push(h),n)}function hy(n,r,l,d,h){switch(r){case"focusin":return Ci=ms(Ci,n,r,l,d,h),!0;case"dragenter":return _i=ms(_i,n,r,l,d,h),!0;case"mouseover":return wi=ms(wi,n,r,l,d,h),!0;case"pointerover":var p=h.pointerId;return gs.set(p,ms(gs.get(p)||null,n,r,l,d,h)),!0;case"gotpointercapture":return p=h.pointerId,ps.set(p,ms(ps.get(p)||null,n,r,l,d,h)),!0}return!1}function tg(n){var r=hr(n.target);if(r!==null){var l=fr(r);if(l!==null){if(r=l.tag,r===13){if(r=Gh(l),r!==null){n.blockedOn=r,Jh(n.priority,function(){qh(l)});return}}else if(r===3&&l.stateNode.current.memoizedState.isDehydrated){n.blockedOn=l.tag===3?l.stateNode.containerInfo:null;return}}}n.blockedOn=null}function Wa(n){if(n.blockedOn!==null)return!1;for(var r=n.targetContainers;0<r.length;){var l=lc(n.domEventName,n.eventSystemFlags,r[0],n.nativeEvent);if(l===null){l=n.nativeEvent;var d=new l.constructor(l.type,l);Ku=d,l.target.dispatchEvent(d),Ku=null}else return r=Ds(l),r!==null&&oc(r),n.blockedOn=l,!1;r.shift()}return!0}function ng(n,r,l){Wa(n)&&l.delete(r)}function gy(){sc=!1,Ci!==null&&Wa(Ci)&&(Ci=null),_i!==null&&Wa(_i)&&(_i=null),wi!==null&&Wa(wi)&&(wi=null),gs.forEach(ng),ps.forEach(ng)}function vs(n,r){n.blockedOn===r&&(n.blockedOn=null,sc||(sc=!0,t.unstable_scheduleCallback(t.unstable_NormalPriority,gy)))}function Ss(n){function r(h){return vs(h,n)}if(0<$a.length){vs($a[0],n);for(var l=1;l<$a.length;l++){var d=$a[l];d.blockedOn===n&&(d.blockedOn=null)}}for(Ci!==null&&vs(Ci,n),_i!==null&&vs(_i,n),wi!==null&&vs(wi,n),gs.forEach(r),ps.forEach(r),l=0;l<Ri.length;l++)d=Ri[l],d.blockedOn===n&&(d.blockedOn=null);for(;0<Ri.length&&(l=Ri[0],l.blockedOn===null);)tg(l),l.blockedOn===null&&Ri.shift()}var Zr=H.ReactCurrentBatchConfig,za=!0;function py(n,r,l,d){var h=ze,p=Zr.transition;Zr.transition=null;try{ze=1,ac(n,r,l,d)}finally{ze=h,Zr.transition=p}}function my(n,r,l,d){var h=ze,p=Zr.transition;Zr.transition=null;try{ze=4,ac(n,r,l,d)}finally{ze=h,Zr.transition=p}}function ac(n,r,l,d){if(za){var h=lc(n,r,l,d);if(h===null)_c(n,r,d,Ya,l),eg(n,d);else if(hy(h,n,r,l,d))d.stopPropagation();else if(eg(n,d),r&4&&-1<fy.indexOf(n)){for(;h!==null;){var p=Ds(h);if(p!==null&&Zh(p),p=lc(n,r,l,d),p===null&&_c(n,r,d,Ya,l),p===h)break;h=p}h!==null&&d.stopPropagation()}else _c(n,r,d,null,l)}}var Ya=null;function lc(n,r,l,d){if(Ya=null,n=Zu(d),n=hr(n),n!==null)if(r=fr(n),r===null)n=null;else if(l=r.tag,l===13){if(n=Gh(r),n!==null)return n;n=null}else if(l===3){if(r.stateNode.current.memoizedState.isDehydrated)return r.tag===3?r.stateNode.containerInfo:null;n=null}else r!==n&&(n=null);return Ya=n,null}function ig(n){switch(n){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(iy()){case tc:return 1;case jh:return 4;case Ba:case ry:return 16;case Vh:return 536870912;default:return 16}default:return 16}}var Pi=null,uc=null,ja=null;function rg(){if(ja)return ja;var n,r=uc,l=r.length,d,h="value"in Pi?Pi.value:Pi.textContent,p=h.length;for(n=0;n<l&&r[n]===h[n];n++);var v=l-n;for(d=1;d<=v&&r[l-d]===h[p-d];d++);return ja=h.slice(n,1<d?1-d:void 0)}function Va(n){var r=n.keyCode;return"charCode"in n?(n=n.charCode,n===0&&r===13&&(n=13)):n=r,n===10&&(n=13),32<=n||n===13?n:0}function Xa(){return!0}function og(){return!1}function nn(n){function r(l,d,h,p,v){this._reactName=l,this._targetInst=h,this.type=d,this.nativeEvent=p,this.target=v,this.currentTarget=null;for(var w in n)n.hasOwnProperty(w)&&(l=n[w],this[w]=l?l(p):p[w]);return this.isDefaultPrevented=(p.defaultPrevented!=null?p.defaultPrevented:p.returnValue===!1)?Xa:og,this.isPropagationStopped=og,this}return Y(r.prototype,{preventDefault:function(){this.defaultPrevented=!0;var l=this.nativeEvent;l&&(l.preventDefault?l.preventDefault():typeof l.returnValue!="unknown"&&(l.returnValue=!1),this.isDefaultPrevented=Xa)},stopPropagation:function(){var l=this.nativeEvent;l&&(l.stopPropagation?l.stopPropagation():typeof l.cancelBubble!="unknown"&&(l.cancelBubble=!0),this.isPropagationStopped=Xa)},persist:function(){},isPersistent:Xa}),r}var qr={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(n){return n.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},cc=nn(qr),ys=Y({},qr,{view:0,detail:0}),vy=nn(ys),dc,fc,As,Ka=Y({},ys,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:gc,button:0,buttons:0,relatedTarget:function(n){return n.relatedTarget===void 0?n.fromElement===n.srcElement?n.toElement:n.fromElement:n.relatedTarget},movementX:function(n){return"movementX"in n?n.movementX:(n!==As&&(As&&n.type==="mousemove"?(dc=n.screenX-As.screenX,fc=n.screenY-As.screenY):fc=dc=0,As=n),dc)},movementY:function(n){return"movementY"in n?n.movementY:fc}}),sg=nn(Ka),Sy=Y({},Ka,{dataTransfer:0}),yy=nn(Sy),Ay=Y({},ys,{relatedTarget:0}),hc=nn(Ay),Ty=Y({},qr,{animationName:0,elapsedTime:0,pseudoElement:0}),Iy=nn(Ty),Ey=Y({},qr,{clipboardData:function(n){return"clipboardData"in n?n.clipboardData:window.clipboardData}}),Cy=nn(Ey),_y=Y({},qr,{data:0}),ag=nn(_y),wy={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Ry={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Py={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Ny(n){var r=this.nativeEvent;return r.getModifierState?r.getModifierState(n):(n=Py[n])?!!r[n]:!1}function gc(){return Ny}var Dy=Y({},ys,{key:function(n){if(n.key){var r=wy[n.key]||n.key;if(r!=="Unidentified")return r}return n.type==="keypress"?(n=Va(n),n===13?"Enter":String.fromCharCode(n)):n.type==="keydown"||n.type==="keyup"?Ry[n.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:gc,charCode:function(n){return n.type==="keypress"?Va(n):0},keyCode:function(n){return n.type==="keydown"||n.type==="keyup"?n.keyCode:0},which:function(n){return n.type==="keypress"?Va(n):n.type==="keydown"||n.type==="keyup"?n.keyCode:0}}),Oy=nn(Dy),My=Y({},Ka,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),lg=nn(My),ky=Y({},ys,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:gc}),Fy=nn(ky),Ly=Y({},qr,{propertyName:0,elapsedTime:0,pseudoElement:0}),Uy=nn(Ly),By=Y({},Ka,{deltaX:function(n){return"deltaX"in n?n.deltaX:"wheelDeltaX"in n?-n.wheelDeltaX:0},deltaY:function(n){return"deltaY"in n?n.deltaY:"wheelDeltaY"in n?-n.wheelDeltaY:"wheelDelta"in n?-n.wheelDelta:0},deltaZ:0,deltaMode:0}),Hy=nn(By),by=[9,13,27,32],pc=c&&"CompositionEvent"in window,Ts=null;c&&"documentMode"in document&&(Ts=document.documentMode);var Gy=c&&"TextEvent"in window&&!Ts,ug=c&&(!pc||Ts&&8<Ts&&11>=Ts),cg=" ",dg=!1;function fg(n,r){switch(n){case"keyup":return by.indexOf(r.keyCode)!==-1;case"keydown":return r.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function hg(n){return n=n.detail,typeof n=="object"&&"data"in n?n.data:null}var Qr=!1;function xy(n,r){switch(n){case"compositionend":return hg(r);case"keypress":return r.which!==32?null:(dg=!0,cg);case"textInput":return n=r.data,n===cg&&dg?null:n;default:return null}}function $y(n,r){if(Qr)return n==="compositionend"||!pc&&fg(n,r)?(n=rg(),ja=uc=Pi=null,Qr=!1,n):null;switch(n){case"paste":return null;case"keypress":if(!(r.ctrlKey||r.altKey||r.metaKey)||r.ctrlKey&&r.altKey){if(r.char&&1<r.char.length)return r.char;if(r.which)return String.fromCharCode(r.which)}return null;case"compositionend":return ug&&r.locale!=="ko"?null:r.data;default:return null}}var Wy={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function gg(n){var r=n&&n.nodeName&&n.nodeName.toLowerCase();return r==="input"?!!Wy[n.type]:r==="textarea"}function pg(n,r,l,d){Lh(d),r=el(r,"onChange"),0<r.length&&(l=new cc("onChange","change",null,l,d),n.push({event:l,listeners:r}))}var Is=null,Es=null;function zy(n){kg(n,0)}function Za(n){var r=io(n);if(ye(r))return n}function Yy(n,r){if(n==="change")return r}var mg=!1;if(c){var mc;if(c){var vc="oninput"in document;if(!vc){var vg=document.createElement("div");vg.setAttribute("oninput","return;"),vc=typeof vg.oninput=="function"}mc=vc}else mc=!1;mg=mc&&(!document.documentMode||9<document.documentMode)}function Sg(){Is&&(Is.detachEvent("onpropertychange",yg),Es=Is=null)}function yg(n){if(n.propertyName==="value"&&Za(Es)){var r=[];pg(r,Es,n,Zu(n)),bh(zy,r)}}function jy(n,r,l){n==="focusin"?(Sg(),Is=r,Es=l,Is.attachEvent("onpropertychange",yg)):n==="focusout"&&Sg()}function Vy(n){if(n==="selectionchange"||n==="keyup"||n==="keydown")return Za(Es)}function Xy(n,r){if(n==="click")return Za(r)}function Ky(n,r){if(n==="input"||n==="change")return Za(r)}function Zy(n,r){return n===r&&(n!==0||1/n===1/r)||n!==n&&r!==r}var Rn=typeof Object.is=="function"?Object.is:Zy;function Cs(n,r){if(Rn(n,r))return!0;if(typeof n!="object"||n===null||typeof r!="object"||r===null)return!1;var l=Object.keys(n),d=Object.keys(r);if(l.length!==d.length)return!1;for(d=0;d<l.length;d++){var h=l[d];if(!f.call(r,h)||!Rn(n[h],r[h]))return!1}return!0}function Ag(n){for(;n&&n.firstChild;)n=n.firstChild;return n}function Tg(n,r){var l=Ag(n);n=0;for(var d;l;){if(l.nodeType===3){if(d=n+l.textContent.length,n<=r&&d>=r)return{node:l,offset:r-n};n=d}e:{for(;l;){if(l.nextSibling){l=l.nextSibling;break e}l=l.parentNode}l=void 0}l=Ag(l)}}function Ig(n,r){return n&&r?n===r?!0:n&&n.nodeType===3?!1:r&&r.nodeType===3?Ig(n,r.parentNode):"contains"in n?n.contains(r):n.compareDocumentPosition?!!(n.compareDocumentPosition(r)&16):!1:!1}function Eg(){for(var n=window,r=Gn();r instanceof n.HTMLIFrameElement;){try{var l=typeof r.contentWindow.location.href=="string"}catch{l=!1}if(l)n=r.contentWindow;else break;r=Gn(n.document)}return r}function Sc(n){var r=n&&n.nodeName&&n.nodeName.toLowerCase();return r&&(r==="input"&&(n.type==="text"||n.type==="search"||n.type==="tel"||n.type==="url"||n.type==="password")||r==="textarea"||n.contentEditable==="true")}function qy(n){var r=Eg(),l=n.focusedElem,d=n.selectionRange;if(r!==l&&l&&l.ownerDocument&&Ig(l.ownerDocument.documentElement,l)){if(d!==null&&Sc(l)){if(r=d.start,n=d.end,n===void 0&&(n=r),"selectionStart"in l)l.selectionStart=r,l.selectionEnd=Math.min(n,l.value.length);else if(n=(r=l.ownerDocument||document)&&r.defaultView||window,n.getSelection){n=n.getSelection();var h=l.textContent.length,p=Math.min(d.start,h);d=d.end===void 0?p:Math.min(d.end,h),!n.extend&&p>d&&(h=d,d=p,p=h),h=Tg(l,p);var v=Tg(l,d);h&&v&&(n.rangeCount!==1||n.anchorNode!==h.node||n.anchorOffset!==h.offset||n.focusNode!==v.node||n.focusOffset!==v.offset)&&(r=r.createRange(),r.setStart(h.node,h.offset),n.removeAllRanges(),p>d?(n.addRange(r),n.extend(v.node,v.offset)):(r.setEnd(v.node,v.offset),n.addRange(r)))}}for(r=[],n=l;n=n.parentNode;)n.nodeType===1&&r.push({element:n,left:n.scrollLeft,top:n.scrollTop});for(typeof l.focus=="function"&&l.focus(),l=0;l<r.length;l++)n=r[l],n.element.scrollLeft=n.left,n.element.scrollTop=n.top}}var Qy=c&&"documentMode"in document&&11>=document.documentMode,Jr=null,yc=null,_s=null,Ac=!1;function Cg(n,r,l){var d=l.window===l?l.document:l.nodeType===9?l:l.ownerDocument;Ac||Jr==null||Jr!==Gn(d)||(d=Jr,"selectionStart"in d&&Sc(d)?d={start:d.selectionStart,end:d.selectionEnd}:(d=(d.ownerDocument&&d.ownerDocument.defaultView||window).getSelection(),d={anchorNode:d.anchorNode,anchorOffset:d.anchorOffset,focusNode:d.focusNode,focusOffset:d.focusOffset}),_s&&Cs(_s,d)||(_s=d,d=el(yc,"onSelect"),0<d.length&&(r=new cc("onSelect","select",null,r,l),n.push({event:r,listeners:d}),r.target=Jr)))}function qa(n,r){var l={};return l[n.toLowerCase()]=r.toLowerCase(),l["Webkit"+n]="webkit"+r,l["Moz"+n]="moz"+r,l}var eo={animationend:qa("Animation","AnimationEnd"),animationiteration:qa("Animation","AnimationIteration"),animationstart:qa("Animation","AnimationStart"),transitionend:qa("Transition","TransitionEnd")},Tc={},_g={};c&&(_g=document.createElement("div").style,"AnimationEvent"in window||(delete eo.animationend.animation,delete eo.animationiteration.animation,delete eo.animationstart.animation),"TransitionEvent"in window||delete eo.transitionend.transition);function Qa(n){if(Tc[n])return Tc[n];if(!eo[n])return n;var r=eo[n],l;for(l in r)if(r.hasOwnProperty(l)&&l in _g)return Tc[n]=r[l];return n}var wg=Qa("animationend"),Rg=Qa("animationiteration"),Pg=Qa("animationstart"),Ng=Qa("transitionend"),Dg=new Map,Og="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Ni(n,r){Dg.set(n,r),s(r,[n])}for(var Ic=0;Ic<Og.length;Ic++){var Ec=Og[Ic],Jy=Ec.toLowerCase(),eA=Ec[0].toUpperCase()+Ec.slice(1);Ni(Jy,"on"+eA)}Ni(wg,"onAnimationEnd"),Ni(Rg,"onAnimationIteration"),Ni(Pg,"onAnimationStart"),Ni("dblclick","onDoubleClick"),Ni("focusin","onFocus"),Ni("focusout","onBlur"),Ni(Ng,"onTransitionEnd"),u("onMouseEnter",["mouseout","mouseover"]),u("onMouseLeave",["mouseout","mouseover"]),u("onPointerEnter",["pointerout","pointerover"]),u("onPointerLeave",["pointerout","pointerover"]),s("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),s("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),s("onBeforeInput",["compositionend","keypress","textInput","paste"]),s("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),s("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),s("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var ws="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),tA=new Set("cancel close invalid load scroll toggle".split(" ").concat(ws));function Mg(n,r,l){var d=n.type||"unknown-event";n.currentTarget=l,JS(d,r,void 0,n),n.currentTarget=null}function kg(n,r){r=(r&4)!==0;for(var l=0;l<n.length;l++){var d=n[l],h=d.event;d=d.listeners;e:{var p=void 0;if(r)for(var v=d.length-1;0<=v;v--){var w=d[v],R=w.instance,L=w.currentTarget;if(w=w.listener,R!==p&&h.isPropagationStopped())break e;Mg(h,w,L),p=R}else for(v=0;v<d.length;v++){if(w=d[v],R=w.instance,L=w.currentTarget,w=w.listener,R!==p&&h.isPropagationStopped())break e;Mg(h,w,L),p=R}}}if(Ua)throw n=ec,Ua=!1,ec=null,n}function Qe(n,r){var l=r[Oc];l===void 0&&(l=r[Oc]=new Set);var d=n+"__bubble";l.has(d)||(Fg(r,n,2,!1),l.add(d))}function Cc(n,r,l){var d=0;r&&(d|=4),Fg(l,n,d,r)}var Ja="_reactListening"+Math.random().toString(36).slice(2);function Rs(n){if(!n[Ja]){n[Ja]=!0,o.forEach(function(l){l!=="selectionchange"&&(tA.has(l)||Cc(l,!1,n),Cc(l,!0,n))});var r=n.nodeType===9?n:n.ownerDocument;r===null||r[Ja]||(r[Ja]=!0,Cc("selectionchange",!1,r))}}function Fg(n,r,l,d){switch(ig(r)){case 1:var h=py;break;case 4:h=my;break;default:h=ac}l=h.bind(null,r,l,n),h=void 0,!Ju||r!=="touchstart"&&r!=="touchmove"&&r!=="wheel"||(h=!0),d?h!==void 0?n.addEventListener(r,l,{capture:!0,passive:h}):n.addEventListener(r,l,!0):h!==void 0?n.addEventListener(r,l,{passive:h}):n.addEventListener(r,l,!1)}function _c(n,r,l,d,h){var p=d;if((r&1)===0&&(r&2)===0&&d!==null)e:for(;;){if(d===null)return;var v=d.tag;if(v===3||v===4){var w=d.stateNode.containerInfo;if(w===h||w.nodeType===8&&w.parentNode===h)break;if(v===4)for(v=d.return;v!==null;){var R=v.tag;if((R===3||R===4)&&(R=v.stateNode.containerInfo,R===h||R.nodeType===8&&R.parentNode===h))return;v=v.return}for(;w!==null;){if(v=hr(w),v===null)return;if(R=v.tag,R===5||R===6){d=p=v;continue e}w=w.parentNode}}d=d.return}bh(function(){var L=p,$=Zu(l),W=[];e:{var x=Dg.get(n);if(x!==void 0){var Q=cc,se=n;switch(n){case"keypress":if(Va(l)===0)break e;case"keydown":case"keyup":Q=Oy;break;case"focusin":se="focus",Q=hc;break;case"focusout":se="blur",Q=hc;break;case"beforeblur":case"afterblur":Q=hc;break;case"click":if(l.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":Q=sg;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":Q=yy;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":Q=Fy;break;case wg:case Rg:case Pg:Q=Iy;break;case Ng:Q=Uy;break;case"scroll":Q=vy;break;case"wheel":Q=Hy;break;case"copy":case"cut":case"paste":Q=Cy;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":Q=lg}var ue=(r&4)!==0,ct=!ue&&n==="scroll",M=ue?x!==null?x+"Capture":null:x;ue=[];for(var D=L,k;D!==null;){k=D;var j=k.stateNode;if(k.tag===5&&j!==null&&(k=j,M!==null&&(j=us(D,M),j!=null&&ue.push(Ps(D,j,k)))),ct)break;D=D.return}0<ue.length&&(x=new Q(x,se,null,l,$),W.push({event:x,listeners:ue}))}}if((r&7)===0){e:{if(x=n==="mouseover"||n==="pointerover",Q=n==="mouseout"||n==="pointerout",x&&l!==Ku&&(se=l.relatedTarget||l.fromElement)&&(hr(se)||se[oi]))break e;if((Q||x)&&(x=$.window===$?$:(x=$.ownerDocument)?x.defaultView||x.parentWindow:window,Q?(se=l.relatedTarget||l.toElement,Q=L,se=se?hr(se):null,se!==null&&(ct=fr(se),se!==ct||se.tag!==5&&se.tag!==6)&&(se=null)):(Q=null,se=L),Q!==se)){if(ue=sg,j="onMouseLeave",M="onMouseEnter",D="mouse",(n==="pointerout"||n==="pointerover")&&(ue=lg,j="onPointerLeave",M="onPointerEnter",D="pointer"),ct=Q==null?x:io(Q),k=se==null?x:io(se),x=new ue(j,D+"leave",Q,l,$),x.target=ct,x.relatedTarget=k,j=null,hr($)===L&&(ue=new ue(M,D+"enter",se,l,$),ue.target=k,ue.relatedTarget=ct,j=ue),ct=j,Q&&se)t:{for(ue=Q,M=se,D=0,k=ue;k;k=to(k))D++;for(k=0,j=M;j;j=to(j))k++;for(;0<D-k;)ue=to(ue),D--;for(;0<k-D;)M=to(M),k--;for(;D--;){if(ue===M||M!==null&&ue===M.alternate)break t;ue=to(ue),M=to(M)}ue=null}else ue=null;Q!==null&&Lg(W,x,Q,ue,!1),se!==null&&ct!==null&&Lg(W,ct,se,ue,!0)}}e:{if(x=L?io(L):window,Q=x.nodeName&&x.nodeName.toLowerCase(),Q==="select"||Q==="input"&&x.type==="file")var de=Yy;else if(gg(x))if(mg)de=Ky;else{de=Vy;var Ae=jy}else(Q=x.nodeName)&&Q.toLowerCase()==="input"&&(x.type==="checkbox"||x.type==="radio")&&(de=Xy);if(de&&(de=de(n,L))){pg(W,de,l,$);break e}Ae&&Ae(n,x,L),n==="focusout"&&(Ae=x._wrapperState)&&Ae.controlled&&x.type==="number"&&$n(x,"number",x.value)}switch(Ae=L?io(L):window,n){case"focusin":(gg(Ae)||Ae.contentEditable==="true")&&(Jr=Ae,yc=L,_s=null);break;case"focusout":_s=yc=Jr=null;break;case"mousedown":Ac=!0;break;case"contextmenu":case"mouseup":case"dragend":Ac=!1,Cg(W,l,$);break;case"selectionchange":if(Qy)break;case"keydown":case"keyup":Cg(W,l,$)}var Te;if(pc)e:{switch(n){case"compositionstart":var Pe="onCompositionStart";break e;case"compositionend":Pe="onCompositionEnd";break e;case"compositionupdate":Pe="onCompositionUpdate";break e}Pe=void 0}else Qr?fg(n,l)&&(Pe="onCompositionEnd"):n==="keydown"&&l.keyCode===229&&(Pe="onCompositionStart");Pe&&(ug&&l.locale!=="ko"&&(Qr||Pe!=="onCompositionStart"?Pe==="onCompositionEnd"&&Qr&&(Te=rg()):(Pi=$,uc="value"in Pi?Pi.value:Pi.textContent,Qr=!0)),Ae=el(L,Pe),0<Ae.length&&(Pe=new ag(Pe,n,null,l,$),W.push({event:Pe,listeners:Ae}),Te?Pe.data=Te:(Te=hg(l),Te!==null&&(Pe.data=Te)))),(Te=Gy?xy(n,l):$y(n,l))&&(L=el(L,"onBeforeInput"),0<L.length&&($=new ag("onBeforeInput","beforeinput",null,l,$),W.push({event:$,listeners:L}),$.data=Te))}kg(W,r)})}function Ps(n,r,l){return{instance:n,listener:r,currentTarget:l}}function el(n,r){for(var l=r+"Capture",d=[];n!==null;){var h=n,p=h.stateNode;h.tag===5&&p!==null&&(h=p,p=us(n,l),p!=null&&d.unshift(Ps(n,p,h)),p=us(n,r),p!=null&&d.push(Ps(n,p,h))),n=n.return}return d}function to(n){if(n===null)return null;do n=n.return;while(n&&n.tag!==5);return n||null}function Lg(n,r,l,d,h){for(var p=r._reactName,v=[];l!==null&&l!==d;){var w=l,R=w.alternate,L=w.stateNode;if(R!==null&&R===d)break;w.tag===5&&L!==null&&(w=L,h?(R=us(l,p),R!=null&&v.unshift(Ps(l,R,w))):h||(R=us(l,p),R!=null&&v.push(Ps(l,R,w)))),l=l.return}v.length!==0&&n.push({event:r,listeners:v})}var nA=/\r\n?/g,iA=/\u0000|\uFFFD/g;function Ug(n){return(typeof n=="string"?n:""+n).replace(nA,`
`).replace(iA,"")}function tl(n,r,l){if(r=Ug(r),Ug(n)!==r&&l)throw Error(i(425))}function nl(){}var wc=null,Rc=null;function Pc(n,r){return n==="textarea"||n==="noscript"||typeof r.children=="string"||typeof r.children=="number"||typeof r.dangerouslySetInnerHTML=="object"&&r.dangerouslySetInnerHTML!==null&&r.dangerouslySetInnerHTML.__html!=null}var Nc=typeof setTimeout=="function"?setTimeout:void 0,rA=typeof clearTimeout=="function"?clearTimeout:void 0,Bg=typeof Promise=="function"?Promise:void 0,oA=typeof queueMicrotask=="function"?queueMicrotask:typeof Bg<"u"?function(n){return Bg.resolve(null).then(n).catch(sA)}:Nc;function sA(n){setTimeout(function(){throw n})}function Dc(n,r){var l=r,d=0;do{var h=l.nextSibling;if(n.removeChild(l),h&&h.nodeType===8)if(l=h.data,l==="/$"){if(d===0){n.removeChild(h),Ss(r);return}d--}else l!=="$"&&l!=="$?"&&l!=="$!"||d++;l=h}while(l);Ss(r)}function Di(n){for(;n!=null;n=n.nextSibling){var r=n.nodeType;if(r===1||r===3)break;if(r===8){if(r=n.data,r==="$"||r==="$!"||r==="$?")break;if(r==="/$")return null}}return n}function Hg(n){n=n.previousSibling;for(var r=0;n;){if(n.nodeType===8){var l=n.data;if(l==="$"||l==="$!"||l==="$?"){if(r===0)return n;r--}else l==="/$"&&r++}n=n.previousSibling}return null}var no=Math.random().toString(36).slice(2),Yn="__reactFiber$"+no,Ns="__reactProps$"+no,oi="__reactContainer$"+no,Oc="__reactEvents$"+no,aA="__reactListeners$"+no,lA="__reactHandles$"+no;function hr(n){var r=n[Yn];if(r)return r;for(var l=n.parentNode;l;){if(r=l[oi]||l[Yn]){if(l=r.alternate,r.child!==null||l!==null&&l.child!==null)for(n=Hg(n);n!==null;){if(l=n[Yn])return l;n=Hg(n)}return r}n=l,l=n.parentNode}return null}function Ds(n){return n=n[Yn]||n[oi],!n||n.tag!==5&&n.tag!==6&&n.tag!==13&&n.tag!==3?null:n}function io(n){if(n.tag===5||n.tag===6)return n.stateNode;throw Error(i(33))}function il(n){return n[Ns]||null}var Mc=[],ro=-1;function Oi(n){return{current:n}}function Je(n){0>ro||(n.current=Mc[ro],Mc[ro]=null,ro--)}function je(n,r){ro++,Mc[ro]=n.current,n.current=r}var Mi={},Mt=Oi(Mi),Zt=Oi(!1),gr=Mi;function oo(n,r){var l=n.type.contextTypes;if(!l)return Mi;var d=n.stateNode;if(d&&d.__reactInternalMemoizedUnmaskedChildContext===r)return d.__reactInternalMemoizedMaskedChildContext;var h={},p;for(p in l)h[p]=r[p];return d&&(n=n.stateNode,n.__reactInternalMemoizedUnmaskedChildContext=r,n.__reactInternalMemoizedMaskedChildContext=h),h}function qt(n){return n=n.childContextTypes,n!=null}function rl(){Je(Zt),Je(Mt)}function bg(n,r,l){if(Mt.current!==Mi)throw Error(i(168));je(Mt,r),je(Zt,l)}function Gg(n,r,l){var d=n.stateNode;if(r=r.childContextTypes,typeof d.getChildContext!="function")return l;d=d.getChildContext();for(var h in d)if(!(h in r))throw Error(i(108,Re(n)||"Unknown",h));return Y({},l,d)}function ol(n){return n=(n=n.stateNode)&&n.__reactInternalMemoizedMergedChildContext||Mi,gr=Mt.current,je(Mt,n),je(Zt,Zt.current),!0}function xg(n,r,l){var d=n.stateNode;if(!d)throw Error(i(169));l?(n=Gg(n,r,gr),d.__reactInternalMemoizedMergedChildContext=n,Je(Zt),Je(Mt),je(Mt,n)):Je(Zt),je(Zt,l)}var si=null,sl=!1,kc=!1;function $g(n){si===null?si=[n]:si.push(n)}function uA(n){sl=!0,$g(n)}function ki(){if(!kc&&si!==null){kc=!0;var n=0,r=ze;try{var l=si;for(ze=1;n<l.length;n++){var d=l[n];do d=d(!0);while(d!==null)}si=null,sl=!1}catch(h){throw si!==null&&(si=si.slice(n+1)),zh(tc,ki),h}finally{ze=r,kc=!1}}return null}var so=[],ao=0,al=null,ll=0,gn=[],pn=0,pr=null,ai=1,li="";function mr(n,r){so[ao++]=ll,so[ao++]=al,al=n,ll=r}function Wg(n,r,l){gn[pn++]=ai,gn[pn++]=li,gn[pn++]=pr,pr=n;var d=ai;n=li;var h=32-wn(d)-1;d&=~(1<<h),l+=1;var p=32-wn(r)+h;if(30<p){var v=h-h%5;p=(d&(1<<v)-1).toString(32),d>>=v,h-=v,ai=1<<32-wn(r)+h|l<<h|d,li=p+n}else ai=1<<p|l<<h|d,li=n}function Fc(n){n.return!==null&&(mr(n,1),Wg(n,1,0))}function Lc(n){for(;n===al;)al=so[--ao],so[ao]=null,ll=so[--ao],so[ao]=null;for(;n===pr;)pr=gn[--pn],gn[pn]=null,li=gn[--pn],gn[pn]=null,ai=gn[--pn],gn[pn]=null}var rn=null,on=null,it=!1,Pn=null;function zg(n,r){var l=yn(5,null,null,0);l.elementType="DELETED",l.stateNode=r,l.return=n,r=n.deletions,r===null?(n.deletions=[l],n.flags|=16):r.push(l)}function Yg(n,r){switch(n.tag){case 5:var l=n.type;return r=r.nodeType!==1||l.toLowerCase()!==r.nodeName.toLowerCase()?null:r,r!==null?(n.stateNode=r,rn=n,on=Di(r.firstChild),!0):!1;case 6:return r=n.pendingProps===""||r.nodeType!==3?null:r,r!==null?(n.stateNode=r,rn=n,on=null,!0):!1;case 13:return r=r.nodeType!==8?null:r,r!==null?(l=pr!==null?{id:ai,overflow:li}:null,n.memoizedState={dehydrated:r,treeContext:l,retryLane:1073741824},l=yn(18,null,null,0),l.stateNode=r,l.return=n,n.child=l,rn=n,on=null,!0):!1;default:return!1}}function Uc(n){return(n.mode&1)!==0&&(n.flags&128)===0}function Bc(n){if(it){var r=on;if(r){var l=r;if(!Yg(n,r)){if(Uc(n))throw Error(i(418));r=Di(l.nextSibling);var d=rn;r&&Yg(n,r)?zg(d,l):(n.flags=n.flags&-4097|2,it=!1,rn=n)}}else{if(Uc(n))throw Error(i(418));n.flags=n.flags&-4097|2,it=!1,rn=n}}}function jg(n){for(n=n.return;n!==null&&n.tag!==5&&n.tag!==3&&n.tag!==13;)n=n.return;rn=n}function ul(n){if(n!==rn)return!1;if(!it)return jg(n),it=!0,!1;var r;if((r=n.tag!==3)&&!(r=n.tag!==5)&&(r=n.type,r=r!=="head"&&r!=="body"&&!Pc(n.type,n.memoizedProps)),r&&(r=on)){if(Uc(n))throw Vg(),Error(i(418));for(;r;)zg(n,r),r=Di(r.nextSibling)}if(jg(n),n.tag===13){if(n=n.memoizedState,n=n!==null?n.dehydrated:null,!n)throw Error(i(317));e:{for(n=n.nextSibling,r=0;n;){if(n.nodeType===8){var l=n.data;if(l==="/$"){if(r===0){on=Di(n.nextSibling);break e}r--}else l!=="$"&&l!=="$!"&&l!=="$?"||r++}n=n.nextSibling}on=null}}else on=rn?Di(n.stateNode.nextSibling):null;return!0}function Vg(){for(var n=on;n;)n=Di(n.nextSibling)}function lo(){on=rn=null,it=!1}function Hc(n){Pn===null?Pn=[n]:Pn.push(n)}var cA=H.ReactCurrentBatchConfig;function Os(n,r,l){if(n=l.ref,n!==null&&typeof n!="function"&&typeof n!="object"){if(l._owner){if(l=l._owner,l){if(l.tag!==1)throw Error(i(309));var d=l.stateNode}if(!d)throw Error(i(147,n));var h=d,p=""+n;return r!==null&&r.ref!==null&&typeof r.ref=="function"&&r.ref._stringRef===p?r.ref:(r=function(v){var w=h.refs;v===null?delete w[p]:w[p]=v},r._stringRef=p,r)}if(typeof n!="string")throw Error(i(284));if(!l._owner)throw Error(i(290,n))}return n}function cl(n,r){throw n=Object.prototype.toString.call(r),Error(i(31,n==="[object Object]"?"object with keys {"+Object.keys(r).join(", ")+"}":n))}function Xg(n){var r=n._init;return r(n._payload)}function Kg(n){function r(M,D){if(n){var k=M.deletions;k===null?(M.deletions=[D],M.flags|=16):k.push(D)}}function l(M,D){if(!n)return null;for(;D!==null;)r(M,D),D=D.sibling;return null}function d(M,D){for(M=new Map;D!==null;)D.key!==null?M.set(D.key,D):M.set(D.index,D),D=D.sibling;return M}function h(M,D){return M=xi(M,D),M.index=0,M.sibling=null,M}function p(M,D,k){return M.index=k,n?(k=M.alternate,k!==null?(k=k.index,k<D?(M.flags|=2,D):k):(M.flags|=2,D)):(M.flags|=1048576,D)}function v(M){return n&&M.alternate===null&&(M.flags|=2),M}function w(M,D,k,j){return D===null||D.tag!==6?(D=Nd(k,M.mode,j),D.return=M,D):(D=h(D,k),D.return=M,D)}function R(M,D,k,j){var de=k.type;return de===G?$(M,D,k.props.children,j,k.key):D!==null&&(D.elementType===de||typeof de=="object"&&de!==null&&de.$$typeof===Se&&Xg(de)===D.type)?(j=h(D,k.props),j.ref=Os(M,D,k),j.return=M,j):(j=Fl(k.type,k.key,k.props,null,M.mode,j),j.ref=Os(M,D,k),j.return=M,j)}function L(M,D,k,j){return D===null||D.tag!==4||D.stateNode.containerInfo!==k.containerInfo||D.stateNode.implementation!==k.implementation?(D=Dd(k,M.mode,j),D.return=M,D):(D=h(D,k.children||[]),D.return=M,D)}function $(M,D,k,j,de){return D===null||D.tag!==7?(D=Cr(k,M.mode,j,de),D.return=M,D):(D=h(D,k),D.return=M,D)}function W(M,D,k){if(typeof D=="string"&&D!==""||typeof D=="number")return D=Nd(""+D,M.mode,k),D.return=M,D;if(typeof D=="object"&&D!==null){switch(D.$$typeof){case B:return k=Fl(D.type,D.key,D.props,null,M.mode,k),k.ref=Os(M,null,D),k.return=M,k;case U:return D=Dd(D,M.mode,k),D.return=M,D;case Se:var j=D._init;return W(M,j(D._payload),k)}if(Wn(D)||X(D))return D=Cr(D,M.mode,k,null),D.return=M,D;cl(M,D)}return null}function x(M,D,k,j){var de=D!==null?D.key:null;if(typeof k=="string"&&k!==""||typeof k=="number")return de!==null?null:w(M,D,""+k,j);if(typeof k=="object"&&k!==null){switch(k.$$typeof){case B:return k.key===de?R(M,D,k,j):null;case U:return k.key===de?L(M,D,k,j):null;case Se:return de=k._init,x(M,D,de(k._payload),j)}if(Wn(k)||X(k))return de!==null?null:$(M,D,k,j,null);cl(M,k)}return null}function Q(M,D,k,j,de){if(typeof j=="string"&&j!==""||typeof j=="number")return M=M.get(k)||null,w(D,M,""+j,de);if(typeof j=="object"&&j!==null){switch(j.$$typeof){case B:return M=M.get(j.key===null?k:j.key)||null,R(D,M,j,de);case U:return M=M.get(j.key===null?k:j.key)||null,L(D,M,j,de);case Se:var Ae=j._init;return Q(M,D,k,Ae(j._payload),de)}if(Wn(j)||X(j))return M=M.get(k)||null,$(D,M,j,de,null);cl(D,j)}return null}function se(M,D,k,j){for(var de=null,Ae=null,Te=D,Pe=D=0,Tt=null;Te!==null&&Pe<k.length;Pe++){Te.index>Pe?(Tt=Te,Te=null):Tt=Te.sibling;var xe=x(M,Te,k[Pe],j);if(xe===null){Te===null&&(Te=Tt);break}n&&Te&&xe.alternate===null&&r(M,Te),D=p(xe,D,Pe),Ae===null?de=xe:Ae.sibling=xe,Ae=xe,Te=Tt}if(Pe===k.length)return l(M,Te),it&&mr(M,Pe),de;if(Te===null){for(;Pe<k.length;Pe++)Te=W(M,k[Pe],j),Te!==null&&(D=p(Te,D,Pe),Ae===null?de=Te:Ae.sibling=Te,Ae=Te);return it&&mr(M,Pe),de}for(Te=d(M,Te);Pe<k.length;Pe++)Tt=Q(Te,M,Pe,k[Pe],j),Tt!==null&&(n&&Tt.alternate!==null&&Te.delete(Tt.key===null?Pe:Tt.key),D=p(Tt,D,Pe),Ae===null?de=Tt:Ae.sibling=Tt,Ae=Tt);return n&&Te.forEach(function($i){return r(M,$i)}),it&&mr(M,Pe),de}function ue(M,D,k,j){var de=X(k);if(typeof de!="function")throw Error(i(150));if(k=de.call(k),k==null)throw Error(i(151));for(var Ae=de=null,Te=D,Pe=D=0,Tt=null,xe=k.next();Te!==null&&!xe.done;Pe++,xe=k.next()){Te.index>Pe?(Tt=Te,Te=null):Tt=Te.sibling;var $i=x(M,Te,xe.value,j);if($i===null){Te===null&&(Te=Tt);break}n&&Te&&$i.alternate===null&&r(M,Te),D=p($i,D,Pe),Ae===null?de=$i:Ae.sibling=$i,Ae=$i,Te=Tt}if(xe.done)return l(M,Te),it&&mr(M,Pe),de;if(Te===null){for(;!xe.done;Pe++,xe=k.next())xe=W(M,xe.value,j),xe!==null&&(D=p(xe,D,Pe),Ae===null?de=xe:Ae.sibling=xe,Ae=xe);return it&&mr(M,Pe),de}for(Te=d(M,Te);!xe.done;Pe++,xe=k.next())xe=Q(Te,M,Pe,xe.value,j),xe!==null&&(n&&xe.alternate!==null&&Te.delete(xe.key===null?Pe:xe.key),D=p(xe,D,Pe),Ae===null?de=xe:Ae.sibling=xe,Ae=xe);return n&&Te.forEach(function(WA){return r(M,WA)}),it&&mr(M,Pe),de}function ct(M,D,k,j){if(typeof k=="object"&&k!==null&&k.type===G&&k.key===null&&(k=k.props.children),typeof k=="object"&&k!==null){switch(k.$$typeof){case B:e:{for(var de=k.key,Ae=D;Ae!==null;){if(Ae.key===de){if(de=k.type,de===G){if(Ae.tag===7){l(M,Ae.sibling),D=h(Ae,k.props.children),D.return=M,M=D;break e}}else if(Ae.elementType===de||typeof de=="object"&&de!==null&&de.$$typeof===Se&&Xg(de)===Ae.type){l(M,Ae.sibling),D=h(Ae,k.props),D.ref=Os(M,Ae,k),D.return=M,M=D;break e}l(M,Ae);break}else r(M,Ae);Ae=Ae.sibling}k.type===G?(D=Cr(k.props.children,M.mode,j,k.key),D.return=M,M=D):(j=Fl(k.type,k.key,k.props,null,M.mode,j),j.ref=Os(M,D,k),j.return=M,M=j)}return v(M);case U:e:{for(Ae=k.key;D!==null;){if(D.key===Ae)if(D.tag===4&&D.stateNode.containerInfo===k.containerInfo&&D.stateNode.implementation===k.implementation){l(M,D.sibling),D=h(D,k.children||[]),D.return=M,M=D;break e}else{l(M,D);break}else r(M,D);D=D.sibling}D=Dd(k,M.mode,j),D.return=M,M=D}return v(M);case Se:return Ae=k._init,ct(M,D,Ae(k._payload),j)}if(Wn(k))return se(M,D,k,j);if(X(k))return ue(M,D,k,j);cl(M,k)}return typeof k=="string"&&k!==""||typeof k=="number"?(k=""+k,D!==null&&D.tag===6?(l(M,D.sibling),D=h(D,k),D.return=M,M=D):(l(M,D),D=Nd(k,M.mode,j),D.return=M,M=D),v(M)):l(M,D)}return ct}var uo=Kg(!0),Zg=Kg(!1),dl=Oi(null),fl=null,co=null,bc=null;function Gc(){bc=co=fl=null}function xc(n){var r=dl.current;Je(dl),n._currentValue=r}function $c(n,r,l){for(;n!==null;){var d=n.alternate;if((n.childLanes&r)!==r?(n.childLanes|=r,d!==null&&(d.childLanes|=r)):d!==null&&(d.childLanes&r)!==r&&(d.childLanes|=r),n===l)break;n=n.return}}function fo(n,r){fl=n,bc=co=null,n=n.dependencies,n!==null&&n.firstContext!==null&&((n.lanes&r)!==0&&(Qt=!0),n.firstContext=null)}function mn(n){var r=n._currentValue;if(bc!==n)if(n={context:n,memoizedValue:r,next:null},co===null){if(fl===null)throw Error(i(308));co=n,fl.dependencies={lanes:0,firstContext:n}}else co=co.next=n;return r}var vr=null;function Wc(n){vr===null?vr=[n]:vr.push(n)}function qg(n,r,l,d){var h=r.interleaved;return h===null?(l.next=l,Wc(r)):(l.next=h.next,h.next=l),r.interleaved=l,ui(n,d)}function ui(n,r){n.lanes|=r;var l=n.alternate;for(l!==null&&(l.lanes|=r),l=n,n=n.return;n!==null;)n.childLanes|=r,l=n.alternate,l!==null&&(l.childLanes|=r),l=n,n=n.return;return l.tag===3?l.stateNode:null}var Fi=!1;function zc(n){n.updateQueue={baseState:n.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Qg(n,r){n=n.updateQueue,r.updateQueue===n&&(r.updateQueue={baseState:n.baseState,firstBaseUpdate:n.firstBaseUpdate,lastBaseUpdate:n.lastBaseUpdate,shared:n.shared,effects:n.effects})}function ci(n,r){return{eventTime:n,lane:r,tag:0,payload:null,callback:null,next:null}}function Li(n,r,l){var d=n.updateQueue;if(d===null)return null;if(d=d.shared,(Ge&2)!==0){var h=d.pending;return h===null?r.next=r:(r.next=h.next,h.next=r),d.pending=r,ui(n,l)}return h=d.interleaved,h===null?(r.next=r,Wc(d)):(r.next=h.next,h.next=r),d.interleaved=r,ui(n,l)}function hl(n,r,l){if(r=r.updateQueue,r!==null&&(r=r.shared,(l&4194240)!==0)){var d=r.lanes;d&=n.pendingLanes,l|=d,r.lanes=l,rc(n,l)}}function Jg(n,r){var l=n.updateQueue,d=n.alternate;if(d!==null&&(d=d.updateQueue,l===d)){var h=null,p=null;if(l=l.firstBaseUpdate,l!==null){do{var v={eventTime:l.eventTime,lane:l.lane,tag:l.tag,payload:l.payload,callback:l.callback,next:null};p===null?h=p=v:p=p.next=v,l=l.next}while(l!==null);p===null?h=p=r:p=p.next=r}else h=p=r;l={baseState:d.baseState,firstBaseUpdate:h,lastBaseUpdate:p,shared:d.shared,effects:d.effects},n.updateQueue=l;return}n=l.lastBaseUpdate,n===null?l.firstBaseUpdate=r:n.next=r,l.lastBaseUpdate=r}function gl(n,r,l,d){var h=n.updateQueue;Fi=!1;var p=h.firstBaseUpdate,v=h.lastBaseUpdate,w=h.shared.pending;if(w!==null){h.shared.pending=null;var R=w,L=R.next;R.next=null,v===null?p=L:v.next=L,v=R;var $=n.alternate;$!==null&&($=$.updateQueue,w=$.lastBaseUpdate,w!==v&&(w===null?$.firstBaseUpdate=L:w.next=L,$.lastBaseUpdate=R))}if(p!==null){var W=h.baseState;v=0,$=L=R=null,w=p;do{var x=w.lane,Q=w.eventTime;if((d&x)===x){$!==null&&($=$.next={eventTime:Q,lane:0,tag:w.tag,payload:w.payload,callback:w.callback,next:null});e:{var se=n,ue=w;switch(x=r,Q=l,ue.tag){case 1:if(se=ue.payload,typeof se=="function"){W=se.call(Q,W,x);break e}W=se;break e;case 3:se.flags=se.flags&-65537|128;case 0:if(se=ue.payload,x=typeof se=="function"?se.call(Q,W,x):se,x==null)break e;W=Y({},W,x);break e;case 2:Fi=!0}}w.callback!==null&&w.lane!==0&&(n.flags|=64,x=h.effects,x===null?h.effects=[w]:x.push(w))}else Q={eventTime:Q,lane:x,tag:w.tag,payload:w.payload,callback:w.callback,next:null},$===null?(L=$=Q,R=W):$=$.next=Q,v|=x;if(w=w.next,w===null){if(w=h.shared.pending,w===null)break;x=w,w=x.next,x.next=null,h.lastBaseUpdate=x,h.shared.pending=null}}while(!0);if($===null&&(R=W),h.baseState=R,h.firstBaseUpdate=L,h.lastBaseUpdate=$,r=h.shared.interleaved,r!==null){h=r;do v|=h.lane,h=h.next;while(h!==r)}else p===null&&(h.shared.lanes=0);Ar|=v,n.lanes=v,n.memoizedState=W}}function ep(n,r,l){if(n=r.effects,r.effects=null,n!==null)for(r=0;r<n.length;r++){var d=n[r],h=d.callback;if(h!==null){if(d.callback=null,d=l,typeof h!="function")throw Error(i(191,h));h.call(d)}}}var Ms={},jn=Oi(Ms),ks=Oi(Ms),Fs=Oi(Ms);function Sr(n){if(n===Ms)throw Error(i(174));return n}function Yc(n,r){switch(je(Fs,r),je(ks,n),je(jn,Ms),n=r.nodeType,n){case 9:case 11:r=(r=r.documentElement)?r.namespaceURI:ju(null,"");break;default:n=n===8?r.parentNode:r,r=n.namespaceURI||null,n=n.tagName,r=ju(r,n)}Je(jn),je(jn,r)}function ho(){Je(jn),Je(ks),Je(Fs)}function tp(n){Sr(Fs.current);var r=Sr(jn.current),l=ju(r,n.type);r!==l&&(je(ks,n),je(jn,l))}function jc(n){ks.current===n&&(Je(jn),Je(ks))}var ot=Oi(0);function pl(n){for(var r=n;r!==null;){if(r.tag===13){var l=r.memoizedState;if(l!==null&&(l=l.dehydrated,l===null||l.data==="$?"||l.data==="$!"))return r}else if(r.tag===19&&r.memoizedProps.revealOrder!==void 0){if((r.flags&128)!==0)return r}else if(r.child!==null){r.child.return=r,r=r.child;continue}if(r===n)break;for(;r.sibling===null;){if(r.return===null||r.return===n)return null;r=r.return}r.sibling.return=r.return,r=r.sibling}return null}var Vc=[];function Xc(){for(var n=0;n<Vc.length;n++)Vc[n]._workInProgressVersionPrimary=null;Vc.length=0}var ml=H.ReactCurrentDispatcher,Kc=H.ReactCurrentBatchConfig,yr=0,st=null,mt=null,yt=null,vl=!1,Ls=!1,Us=0,dA=0;function kt(){throw Error(i(321))}function Zc(n,r){if(r===null)return!1;for(var l=0;l<r.length&&l<n.length;l++)if(!Rn(n[l],r[l]))return!1;return!0}function qc(n,r,l,d,h,p){if(yr=p,st=r,r.memoizedState=null,r.updateQueue=null,r.lanes=0,ml.current=n===null||n.memoizedState===null?pA:mA,n=l(d,h),Ls){p=0;do{if(Ls=!1,Us=0,25<=p)throw Error(i(301));p+=1,yt=mt=null,r.updateQueue=null,ml.current=vA,n=l(d,h)}while(Ls)}if(ml.current=Al,r=mt!==null&&mt.next!==null,yr=0,yt=mt=st=null,vl=!1,r)throw Error(i(300));return n}function Qc(){var n=Us!==0;return Us=0,n}function Vn(){var n={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return yt===null?st.memoizedState=yt=n:yt=yt.next=n,yt}function vn(){if(mt===null){var n=st.alternate;n=n!==null?n.memoizedState:null}else n=mt.next;var r=yt===null?st.memoizedState:yt.next;if(r!==null)yt=r,mt=n;else{if(n===null)throw Error(i(310));mt=n,n={memoizedState:mt.memoizedState,baseState:mt.baseState,baseQueue:mt.baseQueue,queue:mt.queue,next:null},yt===null?st.memoizedState=yt=n:yt=yt.next=n}return yt}function Bs(n,r){return typeof r=="function"?r(n):r}function Jc(n){var r=vn(),l=r.queue;if(l===null)throw Error(i(311));l.lastRenderedReducer=n;var d=mt,h=d.baseQueue,p=l.pending;if(p!==null){if(h!==null){var v=h.next;h.next=p.next,p.next=v}d.baseQueue=h=p,l.pending=null}if(h!==null){p=h.next,d=d.baseState;var w=v=null,R=null,L=p;do{var $=L.lane;if((yr&$)===$)R!==null&&(R=R.next={lane:0,action:L.action,hasEagerState:L.hasEagerState,eagerState:L.eagerState,next:null}),d=L.hasEagerState?L.eagerState:n(d,L.action);else{var W={lane:$,action:L.action,hasEagerState:L.hasEagerState,eagerState:L.eagerState,next:null};R===null?(w=R=W,v=d):R=R.next=W,st.lanes|=$,Ar|=$}L=L.next}while(L!==null&&L!==p);R===null?v=d:R.next=w,Rn(d,r.memoizedState)||(Qt=!0),r.memoizedState=d,r.baseState=v,r.baseQueue=R,l.lastRenderedState=d}if(n=l.interleaved,n!==null){h=n;do p=h.lane,st.lanes|=p,Ar|=p,h=h.next;while(h!==n)}else h===null&&(l.lanes=0);return[r.memoizedState,l.dispatch]}function ed(n){var r=vn(),l=r.queue;if(l===null)throw Error(i(311));l.lastRenderedReducer=n;var d=l.dispatch,h=l.pending,p=r.memoizedState;if(h!==null){l.pending=null;var v=h=h.next;do p=n(p,v.action),v=v.next;while(v!==h);Rn(p,r.memoizedState)||(Qt=!0),r.memoizedState=p,r.baseQueue===null&&(r.baseState=p),l.lastRenderedState=p}return[p,d]}function np(){}function ip(n,r){var l=st,d=vn(),h=r(),p=!Rn(d.memoizedState,h);if(p&&(d.memoizedState=h,Qt=!0),d=d.queue,td(sp.bind(null,l,d,n),[n]),d.getSnapshot!==r||p||yt!==null&&yt.memoizedState.tag&1){if(l.flags|=2048,Hs(9,op.bind(null,l,d,h,r),void 0,null),At===null)throw Error(i(349));(yr&30)!==0||rp(l,r,h)}return h}function rp(n,r,l){n.flags|=16384,n={getSnapshot:r,value:l},r=st.updateQueue,r===null?(r={lastEffect:null,stores:null},st.updateQueue=r,r.stores=[n]):(l=r.stores,l===null?r.stores=[n]:l.push(n))}function op(n,r,l,d){r.value=l,r.getSnapshot=d,ap(r)&&lp(n)}function sp(n,r,l){return l(function(){ap(r)&&lp(n)})}function ap(n){var r=n.getSnapshot;n=n.value;try{var l=r();return!Rn(n,l)}catch{return!0}}function lp(n){var r=ui(n,1);r!==null&&Mn(r,n,1,-1)}function up(n){var r=Vn();return typeof n=="function"&&(n=n()),r.memoizedState=r.baseState=n,n={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Bs,lastRenderedState:n},r.queue=n,n=n.dispatch=gA.bind(null,st,n),[r.memoizedState,n]}function Hs(n,r,l,d){return n={tag:n,create:r,destroy:l,deps:d,next:null},r=st.updateQueue,r===null?(r={lastEffect:null,stores:null},st.updateQueue=r,r.lastEffect=n.next=n):(l=r.lastEffect,l===null?r.lastEffect=n.next=n:(d=l.next,l.next=n,n.next=d,r.lastEffect=n)),n}function cp(){return vn().memoizedState}function Sl(n,r,l,d){var h=Vn();st.flags|=n,h.memoizedState=Hs(1|r,l,void 0,d===void 0?null:d)}function yl(n,r,l,d){var h=vn();d=d===void 0?null:d;var p=void 0;if(mt!==null){var v=mt.memoizedState;if(p=v.destroy,d!==null&&Zc(d,v.deps)){h.memoizedState=Hs(r,l,p,d);return}}st.flags|=n,h.memoizedState=Hs(1|r,l,p,d)}function dp(n,r){return Sl(8390656,8,n,r)}function td(n,r){return yl(2048,8,n,r)}function fp(n,r){return yl(4,2,n,r)}function hp(n,r){return yl(4,4,n,r)}function gp(n,r){if(typeof r=="function")return n=n(),r(n),function(){r(null)};if(r!=null)return n=n(),r.current=n,function(){r.current=null}}function pp(n,r,l){return l=l!=null?l.concat([n]):null,yl(4,4,gp.bind(null,r,n),l)}function nd(){}function mp(n,r){var l=vn();r=r===void 0?null:r;var d=l.memoizedState;return d!==null&&r!==null&&Zc(r,d[1])?d[0]:(l.memoizedState=[n,r],n)}function vp(n,r){var l=vn();r=r===void 0?null:r;var d=l.memoizedState;return d!==null&&r!==null&&Zc(r,d[1])?d[0]:(n=n(),l.memoizedState=[n,r],n)}function Sp(n,r,l){return(yr&21)===0?(n.baseState&&(n.baseState=!1,Qt=!0),n.memoizedState=l):(Rn(l,r)||(l=Xh(),st.lanes|=l,Ar|=l,n.baseState=!0),r)}function fA(n,r){var l=ze;ze=l!==0&&4>l?l:4,n(!0);var d=Kc.transition;Kc.transition={};try{n(!1),r()}finally{ze=l,Kc.transition=d}}function yp(){return vn().memoizedState}function hA(n,r,l){var d=bi(n);if(l={lane:d,action:l,hasEagerState:!1,eagerState:null,next:null},Ap(n))Tp(r,l);else if(l=qg(n,r,l,d),l!==null){var h=xt();Mn(l,n,d,h),Ip(l,r,d)}}function gA(n,r,l){var d=bi(n),h={lane:d,action:l,hasEagerState:!1,eagerState:null,next:null};if(Ap(n))Tp(r,h);else{var p=n.alternate;if(n.lanes===0&&(p===null||p.lanes===0)&&(p=r.lastRenderedReducer,p!==null))try{var v=r.lastRenderedState,w=p(v,l);if(h.hasEagerState=!0,h.eagerState=w,Rn(w,v)){var R=r.interleaved;R===null?(h.next=h,Wc(r)):(h.next=R.next,R.next=h),r.interleaved=h;return}}catch{}finally{}l=qg(n,r,h,d),l!==null&&(h=xt(),Mn(l,n,d,h),Ip(l,r,d))}}function Ap(n){var r=n.alternate;return n===st||r!==null&&r===st}function Tp(n,r){Ls=vl=!0;var l=n.pending;l===null?r.next=r:(r.next=l.next,l.next=r),n.pending=r}function Ip(n,r,l){if((l&4194240)!==0){var d=r.lanes;d&=n.pendingLanes,l|=d,r.lanes=l,rc(n,l)}}var Al={readContext:mn,useCallback:kt,useContext:kt,useEffect:kt,useImperativeHandle:kt,useInsertionEffect:kt,useLayoutEffect:kt,useMemo:kt,useReducer:kt,useRef:kt,useState:kt,useDebugValue:kt,useDeferredValue:kt,useTransition:kt,useMutableSource:kt,useSyncExternalStore:kt,useId:kt,unstable_isNewReconciler:!1},pA={readContext:mn,useCallback:function(n,r){return Vn().memoizedState=[n,r===void 0?null:r],n},useContext:mn,useEffect:dp,useImperativeHandle:function(n,r,l){return l=l!=null?l.concat([n]):null,Sl(4194308,4,gp.bind(null,r,n),l)},useLayoutEffect:function(n,r){return Sl(4194308,4,n,r)},useInsertionEffect:function(n,r){return Sl(4,2,n,r)},useMemo:function(n,r){var l=Vn();return r=r===void 0?null:r,n=n(),l.memoizedState=[n,r],n},useReducer:function(n,r,l){var d=Vn();return r=l!==void 0?l(r):r,d.memoizedState=d.baseState=r,n={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:n,lastRenderedState:r},d.queue=n,n=n.dispatch=hA.bind(null,st,n),[d.memoizedState,n]},useRef:function(n){var r=Vn();return n={current:n},r.memoizedState=n},useState:up,useDebugValue:nd,useDeferredValue:function(n){return Vn().memoizedState=n},useTransition:function(){var n=up(!1),r=n[0];return n=fA.bind(null,n[1]),Vn().memoizedState=n,[r,n]},useMutableSource:function(){},useSyncExternalStore:function(n,r,l){var d=st,h=Vn();if(it){if(l===void 0)throw Error(i(407));l=l()}else{if(l=r(),At===null)throw Error(i(349));(yr&30)!==0||rp(d,r,l)}h.memoizedState=l;var p={value:l,getSnapshot:r};return h.queue=p,dp(sp.bind(null,d,p,n),[n]),d.flags|=2048,Hs(9,op.bind(null,d,p,l,r),void 0,null),l},useId:function(){var n=Vn(),r=At.identifierPrefix;if(it){var l=li,d=ai;l=(d&~(1<<32-wn(d)-1)).toString(32)+l,r=":"+r+"R"+l,l=Us++,0<l&&(r+="H"+l.toString(32)),r+=":"}else l=dA++,r=":"+r+"r"+l.toString(32)+":";return n.memoizedState=r},unstable_isNewReconciler:!1},mA={readContext:mn,useCallback:mp,useContext:mn,useEffect:td,useImperativeHandle:pp,useInsertionEffect:fp,useLayoutEffect:hp,useMemo:vp,useReducer:Jc,useRef:cp,useState:function(){return Jc(Bs)},useDebugValue:nd,useDeferredValue:function(n){var r=vn();return Sp(r,mt.memoizedState,n)},useTransition:function(){var n=Jc(Bs)[0],r=vn().memoizedState;return[n,r]},useMutableSource:np,useSyncExternalStore:ip,useId:yp,unstable_isNewReconciler:!1},vA={readContext:mn,useCallback:mp,useContext:mn,useEffect:td,useImperativeHandle:pp,useInsertionEffect:fp,useLayoutEffect:hp,useMemo:vp,useReducer:ed,useRef:cp,useState:function(){return ed(Bs)},useDebugValue:nd,useDeferredValue:function(n){var r=vn();return mt===null?r.memoizedState=n:Sp(r,mt.memoizedState,n)},useTransition:function(){var n=ed(Bs)[0],r=vn().memoizedState;return[n,r]},useMutableSource:np,useSyncExternalStore:ip,useId:yp,unstable_isNewReconciler:!1};function Nn(n,r){if(n&&n.defaultProps){r=Y({},r),n=n.defaultProps;for(var l in n)r[l]===void 0&&(r[l]=n[l]);return r}return r}function id(n,r,l,d){r=n.memoizedState,l=l(d,r),l=l==null?r:Y({},r,l),n.memoizedState=l,n.lanes===0&&(n.updateQueue.baseState=l)}var Tl={isMounted:function(n){return(n=n._reactInternals)?fr(n)===n:!1},enqueueSetState:function(n,r,l){n=n._reactInternals;var d=xt(),h=bi(n),p=ci(d,h);p.payload=r,l!=null&&(p.callback=l),r=Li(n,p,h),r!==null&&(Mn(r,n,h,d),hl(r,n,h))},enqueueReplaceState:function(n,r,l){n=n._reactInternals;var d=xt(),h=bi(n),p=ci(d,h);p.tag=1,p.payload=r,l!=null&&(p.callback=l),r=Li(n,p,h),r!==null&&(Mn(r,n,h,d),hl(r,n,h))},enqueueForceUpdate:function(n,r){n=n._reactInternals;var l=xt(),d=bi(n),h=ci(l,d);h.tag=2,r!=null&&(h.callback=r),r=Li(n,h,d),r!==null&&(Mn(r,n,d,l),hl(r,n,d))}};function Ep(n,r,l,d,h,p,v){return n=n.stateNode,typeof n.shouldComponentUpdate=="function"?n.shouldComponentUpdate(d,p,v):r.prototype&&r.prototype.isPureReactComponent?!Cs(l,d)||!Cs(h,p):!0}function Cp(n,r,l){var d=!1,h=Mi,p=r.contextType;return typeof p=="object"&&p!==null?p=mn(p):(h=qt(r)?gr:Mt.current,d=r.contextTypes,p=(d=d!=null)?oo(n,h):Mi),r=new r(l,p),n.memoizedState=r.state!==null&&r.state!==void 0?r.state:null,r.updater=Tl,n.stateNode=r,r._reactInternals=n,d&&(n=n.stateNode,n.__reactInternalMemoizedUnmaskedChildContext=h,n.__reactInternalMemoizedMaskedChildContext=p),r}function _p(n,r,l,d){n=r.state,typeof r.componentWillReceiveProps=="function"&&r.componentWillReceiveProps(l,d),typeof r.UNSAFE_componentWillReceiveProps=="function"&&r.UNSAFE_componentWillReceiveProps(l,d),r.state!==n&&Tl.enqueueReplaceState(r,r.state,null)}function rd(n,r,l,d){var h=n.stateNode;h.props=l,h.state=n.memoizedState,h.refs={},zc(n);var p=r.contextType;typeof p=="object"&&p!==null?h.context=mn(p):(p=qt(r)?gr:Mt.current,h.context=oo(n,p)),h.state=n.memoizedState,p=r.getDerivedStateFromProps,typeof p=="function"&&(id(n,r,p,l),h.state=n.memoizedState),typeof r.getDerivedStateFromProps=="function"||typeof h.getSnapshotBeforeUpdate=="function"||typeof h.UNSAFE_componentWillMount!="function"&&typeof h.componentWillMount!="function"||(r=h.state,typeof h.componentWillMount=="function"&&h.componentWillMount(),typeof h.UNSAFE_componentWillMount=="function"&&h.UNSAFE_componentWillMount(),r!==h.state&&Tl.enqueueReplaceState(h,h.state,null),gl(n,l,h,d),h.state=n.memoizedState),typeof h.componentDidMount=="function"&&(n.flags|=4194308)}function go(n,r){try{var l="",d=r;do l+=pe(d),d=d.return;while(d);var h=l}catch(p){h=`
Error generating stack: `+p.message+`
`+p.stack}return{value:n,source:r,stack:h,digest:null}}function od(n,r,l){return{value:n,source:null,stack:l??null,digest:r??null}}function sd(n,r){try{console.error(r.value)}catch(l){setTimeout(function(){throw l})}}var SA=typeof WeakMap=="function"?WeakMap:Map;function wp(n,r,l){l=ci(-1,l),l.tag=3,l.payload={element:null};var d=r.value;return l.callback=function(){Pl||(Pl=!0,Td=d),sd(n,r)},l}function Rp(n,r,l){l=ci(-1,l),l.tag=3;var d=n.type.getDerivedStateFromError;if(typeof d=="function"){var h=r.value;l.payload=function(){return d(h)},l.callback=function(){sd(n,r)}}var p=n.stateNode;return p!==null&&typeof p.componentDidCatch=="function"&&(l.callback=function(){sd(n,r),typeof d!="function"&&(Bi===null?Bi=new Set([this]):Bi.add(this));var v=r.stack;this.componentDidCatch(r.value,{componentStack:v!==null?v:""})}),l}function Pp(n,r,l){var d=n.pingCache;if(d===null){d=n.pingCache=new SA;var h=new Set;d.set(r,h)}else h=d.get(r),h===void 0&&(h=new Set,d.set(r,h));h.has(l)||(h.add(l),n=MA.bind(null,n,r,l),r.then(n,n))}function Np(n){do{var r;if((r=n.tag===13)&&(r=n.memoizedState,r=r!==null?r.dehydrated!==null:!0),r)return n;n=n.return}while(n!==null);return null}function Dp(n,r,l,d,h){return(n.mode&1)===0?(n===r?n.flags|=65536:(n.flags|=128,l.flags|=131072,l.flags&=-52805,l.tag===1&&(l.alternate===null?l.tag=17:(r=ci(-1,1),r.tag=2,Li(l,r,1))),l.lanes|=1),n):(n.flags|=65536,n.lanes=h,n)}var yA=H.ReactCurrentOwner,Qt=!1;function Gt(n,r,l,d){r.child=n===null?Zg(r,null,l,d):uo(r,n.child,l,d)}function Op(n,r,l,d,h){l=l.render;var p=r.ref;return fo(r,h),d=qc(n,r,l,d,p,h),l=Qc(),n!==null&&!Qt?(r.updateQueue=n.updateQueue,r.flags&=-2053,n.lanes&=~h,di(n,r,h)):(it&&l&&Fc(r),r.flags|=1,Gt(n,r,d,h),r.child)}function Mp(n,r,l,d,h){if(n===null){var p=l.type;return typeof p=="function"&&!Pd(p)&&p.defaultProps===void 0&&l.compare===null&&l.defaultProps===void 0?(r.tag=15,r.type=p,kp(n,r,p,d,h)):(n=Fl(l.type,null,d,r,r.mode,h),n.ref=r.ref,n.return=r,r.child=n)}if(p=n.child,(n.lanes&h)===0){var v=p.memoizedProps;if(l=l.compare,l=l!==null?l:Cs,l(v,d)&&n.ref===r.ref)return di(n,r,h)}return r.flags|=1,n=xi(p,d),n.ref=r.ref,n.return=r,r.child=n}function kp(n,r,l,d,h){if(n!==null){var p=n.memoizedProps;if(Cs(p,d)&&n.ref===r.ref)if(Qt=!1,r.pendingProps=d=p,(n.lanes&h)!==0)(n.flags&131072)!==0&&(Qt=!0);else return r.lanes=n.lanes,di(n,r,h)}return ad(n,r,l,d,h)}function Fp(n,r,l){var d=r.pendingProps,h=d.children,p=n!==null?n.memoizedState:null;if(d.mode==="hidden")if((r.mode&1)===0)r.memoizedState={baseLanes:0,cachePool:null,transitions:null},je(mo,sn),sn|=l;else{if((l&1073741824)===0)return n=p!==null?p.baseLanes|l:l,r.lanes=r.childLanes=1073741824,r.memoizedState={baseLanes:n,cachePool:null,transitions:null},r.updateQueue=null,je(mo,sn),sn|=n,null;r.memoizedState={baseLanes:0,cachePool:null,transitions:null},d=p!==null?p.baseLanes:l,je(mo,sn),sn|=d}else p!==null?(d=p.baseLanes|l,r.memoizedState=null):d=l,je(mo,sn),sn|=d;return Gt(n,r,h,l),r.child}function Lp(n,r){var l=r.ref;(n===null&&l!==null||n!==null&&n.ref!==l)&&(r.flags|=512,r.flags|=2097152)}function ad(n,r,l,d,h){var p=qt(l)?gr:Mt.current;return p=oo(r,p),fo(r,h),l=qc(n,r,l,d,p,h),d=Qc(),n!==null&&!Qt?(r.updateQueue=n.updateQueue,r.flags&=-2053,n.lanes&=~h,di(n,r,h)):(it&&d&&Fc(r),r.flags|=1,Gt(n,r,l,h),r.child)}function Up(n,r,l,d,h){if(qt(l)){var p=!0;ol(r)}else p=!1;if(fo(r,h),r.stateNode===null)El(n,r),Cp(r,l,d),rd(r,l,d,h),d=!0;else if(n===null){var v=r.stateNode,w=r.memoizedProps;v.props=w;var R=v.context,L=l.contextType;typeof L=="object"&&L!==null?L=mn(L):(L=qt(l)?gr:Mt.current,L=oo(r,L));var $=l.getDerivedStateFromProps,W=typeof $=="function"||typeof v.getSnapshotBeforeUpdate=="function";W||typeof v.UNSAFE_componentWillReceiveProps!="function"&&typeof v.componentWillReceiveProps!="function"||(w!==d||R!==L)&&_p(r,v,d,L),Fi=!1;var x=r.memoizedState;v.state=x,gl(r,d,v,h),R=r.memoizedState,w!==d||x!==R||Zt.current||Fi?(typeof $=="function"&&(id(r,l,$,d),R=r.memoizedState),(w=Fi||Ep(r,l,w,d,x,R,L))?(W||typeof v.UNSAFE_componentWillMount!="function"&&typeof v.componentWillMount!="function"||(typeof v.componentWillMount=="function"&&v.componentWillMount(),typeof v.UNSAFE_componentWillMount=="function"&&v.UNSAFE_componentWillMount()),typeof v.componentDidMount=="function"&&(r.flags|=4194308)):(typeof v.componentDidMount=="function"&&(r.flags|=4194308),r.memoizedProps=d,r.memoizedState=R),v.props=d,v.state=R,v.context=L,d=w):(typeof v.componentDidMount=="function"&&(r.flags|=4194308),d=!1)}else{v=r.stateNode,Qg(n,r),w=r.memoizedProps,L=r.type===r.elementType?w:Nn(r.type,w),v.props=L,W=r.pendingProps,x=v.context,R=l.contextType,typeof R=="object"&&R!==null?R=mn(R):(R=qt(l)?gr:Mt.current,R=oo(r,R));var Q=l.getDerivedStateFromProps;($=typeof Q=="function"||typeof v.getSnapshotBeforeUpdate=="function")||typeof v.UNSAFE_componentWillReceiveProps!="function"&&typeof v.componentWillReceiveProps!="function"||(w!==W||x!==R)&&_p(r,v,d,R),Fi=!1,x=r.memoizedState,v.state=x,gl(r,d,v,h);var se=r.memoizedState;w!==W||x!==se||Zt.current||Fi?(typeof Q=="function"&&(id(r,l,Q,d),se=r.memoizedState),(L=Fi||Ep(r,l,L,d,x,se,R)||!1)?($||typeof v.UNSAFE_componentWillUpdate!="function"&&typeof v.componentWillUpdate!="function"||(typeof v.componentWillUpdate=="function"&&v.componentWillUpdate(d,se,R),typeof v.UNSAFE_componentWillUpdate=="function"&&v.UNSAFE_componentWillUpdate(d,se,R)),typeof v.componentDidUpdate=="function"&&(r.flags|=4),typeof v.getSnapshotBeforeUpdate=="function"&&(r.flags|=1024)):(typeof v.componentDidUpdate!="function"||w===n.memoizedProps&&x===n.memoizedState||(r.flags|=4),typeof v.getSnapshotBeforeUpdate!="function"||w===n.memoizedProps&&x===n.memoizedState||(r.flags|=1024),r.memoizedProps=d,r.memoizedState=se),v.props=d,v.state=se,v.context=R,d=L):(typeof v.componentDidUpdate!="function"||w===n.memoizedProps&&x===n.memoizedState||(r.flags|=4),typeof v.getSnapshotBeforeUpdate!="function"||w===n.memoizedProps&&x===n.memoizedState||(r.flags|=1024),d=!1)}return ld(n,r,l,d,p,h)}function ld(n,r,l,d,h,p){Lp(n,r);var v=(r.flags&128)!==0;if(!d&&!v)return h&&xg(r,l,!1),di(n,r,p);d=r.stateNode,yA.current=r;var w=v&&typeof l.getDerivedStateFromError!="function"?null:d.render();return r.flags|=1,n!==null&&v?(r.child=uo(r,n.child,null,p),r.child=uo(r,null,w,p)):Gt(n,r,w,p),r.memoizedState=d.state,h&&xg(r,l,!0),r.child}function Bp(n){var r=n.stateNode;r.pendingContext?bg(n,r.pendingContext,r.pendingContext!==r.context):r.context&&bg(n,r.context,!1),Yc(n,r.containerInfo)}function Hp(n,r,l,d,h){return lo(),Hc(h),r.flags|=256,Gt(n,r,l,d),r.child}var ud={dehydrated:null,treeContext:null,retryLane:0};function cd(n){return{baseLanes:n,cachePool:null,transitions:null}}function bp(n,r,l){var d=r.pendingProps,h=ot.current,p=!1,v=(r.flags&128)!==0,w;if((w=v)||(w=n!==null&&n.memoizedState===null?!1:(h&2)!==0),w?(p=!0,r.flags&=-129):(n===null||n.memoizedState!==null)&&(h|=1),je(ot,h&1),n===null)return Bc(r),n=r.memoizedState,n!==null&&(n=n.dehydrated,n!==null)?((r.mode&1)===0?r.lanes=1:n.data==="$!"?r.lanes=8:r.lanes=1073741824,null):(v=d.children,n=d.fallback,p?(d=r.mode,p=r.child,v={mode:"hidden",children:v},(d&1)===0&&p!==null?(p.childLanes=0,p.pendingProps=v):p=Ll(v,d,0,null),n=Cr(n,d,l,null),p.return=r,n.return=r,p.sibling=n,r.child=p,r.child.memoizedState=cd(l),r.memoizedState=ud,n):dd(r,v));if(h=n.memoizedState,h!==null&&(w=h.dehydrated,w!==null))return AA(n,r,v,d,w,h,l);if(p){p=d.fallback,v=r.mode,h=n.child,w=h.sibling;var R={mode:"hidden",children:d.children};return(v&1)===0&&r.child!==h?(d=r.child,d.childLanes=0,d.pendingProps=R,r.deletions=null):(d=xi(h,R),d.subtreeFlags=h.subtreeFlags&14680064),w!==null?p=xi(w,p):(p=Cr(p,v,l,null),p.flags|=2),p.return=r,d.return=r,d.sibling=p,r.child=d,d=p,p=r.child,v=n.child.memoizedState,v=v===null?cd(l):{baseLanes:v.baseLanes|l,cachePool:null,transitions:v.transitions},p.memoizedState=v,p.childLanes=n.childLanes&~l,r.memoizedState=ud,d}return p=n.child,n=p.sibling,d=xi(p,{mode:"visible",children:d.children}),(r.mode&1)===0&&(d.lanes=l),d.return=r,d.sibling=null,n!==null&&(l=r.deletions,l===null?(r.deletions=[n],r.flags|=16):l.push(n)),r.child=d,r.memoizedState=null,d}function dd(n,r){return r=Ll({mode:"visible",children:r},n.mode,0,null),r.return=n,n.child=r}function Il(n,r,l,d){return d!==null&&Hc(d),uo(r,n.child,null,l),n=dd(r,r.pendingProps.children),n.flags|=2,r.memoizedState=null,n}function AA(n,r,l,d,h,p,v){if(l)return r.flags&256?(r.flags&=-257,d=od(Error(i(422))),Il(n,r,v,d)):r.memoizedState!==null?(r.child=n.child,r.flags|=128,null):(p=d.fallback,h=r.mode,d=Ll({mode:"visible",children:d.children},h,0,null),p=Cr(p,h,v,null),p.flags|=2,d.return=r,p.return=r,d.sibling=p,r.child=d,(r.mode&1)!==0&&uo(r,n.child,null,v),r.child.memoizedState=cd(v),r.memoizedState=ud,p);if((r.mode&1)===0)return Il(n,r,v,null);if(h.data==="$!"){if(d=h.nextSibling&&h.nextSibling.dataset,d)var w=d.dgst;return d=w,p=Error(i(419)),d=od(p,d,void 0),Il(n,r,v,d)}if(w=(v&n.childLanes)!==0,Qt||w){if(d=At,d!==null){switch(v&-v){case 4:h=2;break;case 16:h=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:h=32;break;case 536870912:h=268435456;break;default:h=0}h=(h&(d.suspendedLanes|v))!==0?0:h,h!==0&&h!==p.retryLane&&(p.retryLane=h,ui(n,h),Mn(d,n,h,-1))}return Rd(),d=od(Error(i(421))),Il(n,r,v,d)}return h.data==="$?"?(r.flags|=128,r.child=n.child,r=kA.bind(null,n),h._reactRetry=r,null):(n=p.treeContext,on=Di(h.nextSibling),rn=r,it=!0,Pn=null,n!==null&&(gn[pn++]=ai,gn[pn++]=li,gn[pn++]=pr,ai=n.id,li=n.overflow,pr=r),r=dd(r,d.children),r.flags|=4096,r)}function Gp(n,r,l){n.lanes|=r;var d=n.alternate;d!==null&&(d.lanes|=r),$c(n.return,r,l)}function fd(n,r,l,d,h){var p=n.memoizedState;p===null?n.memoizedState={isBackwards:r,rendering:null,renderingStartTime:0,last:d,tail:l,tailMode:h}:(p.isBackwards=r,p.rendering=null,p.renderingStartTime=0,p.last=d,p.tail=l,p.tailMode=h)}function xp(n,r,l){var d=r.pendingProps,h=d.revealOrder,p=d.tail;if(Gt(n,r,d.children,l),d=ot.current,(d&2)!==0)d=d&1|2,r.flags|=128;else{if(n!==null&&(n.flags&128)!==0)e:for(n=r.child;n!==null;){if(n.tag===13)n.memoizedState!==null&&Gp(n,l,r);else if(n.tag===19)Gp(n,l,r);else if(n.child!==null){n.child.return=n,n=n.child;continue}if(n===r)break e;for(;n.sibling===null;){if(n.return===null||n.return===r)break e;n=n.return}n.sibling.return=n.return,n=n.sibling}d&=1}if(je(ot,d),(r.mode&1)===0)r.memoizedState=null;else switch(h){case"forwards":for(l=r.child,h=null;l!==null;)n=l.alternate,n!==null&&pl(n)===null&&(h=l),l=l.sibling;l=h,l===null?(h=r.child,r.child=null):(h=l.sibling,l.sibling=null),fd(r,!1,h,l,p);break;case"backwards":for(l=null,h=r.child,r.child=null;h!==null;){if(n=h.alternate,n!==null&&pl(n)===null){r.child=h;break}n=h.sibling,h.sibling=l,l=h,h=n}fd(r,!0,l,null,p);break;case"together":fd(r,!1,null,null,void 0);break;default:r.memoizedState=null}return r.child}function El(n,r){(r.mode&1)===0&&n!==null&&(n.alternate=null,r.alternate=null,r.flags|=2)}function di(n,r,l){if(n!==null&&(r.dependencies=n.dependencies),Ar|=r.lanes,(l&r.childLanes)===0)return null;if(n!==null&&r.child!==n.child)throw Error(i(153));if(r.child!==null){for(n=r.child,l=xi(n,n.pendingProps),r.child=l,l.return=r;n.sibling!==null;)n=n.sibling,l=l.sibling=xi(n,n.pendingProps),l.return=r;l.sibling=null}return r.child}function TA(n,r,l){switch(r.tag){case 3:Bp(r),lo();break;case 5:tp(r);break;case 1:qt(r.type)&&ol(r);break;case 4:Yc(r,r.stateNode.containerInfo);break;case 10:var d=r.type._context,h=r.memoizedProps.value;je(dl,d._currentValue),d._currentValue=h;break;case 13:if(d=r.memoizedState,d!==null)return d.dehydrated!==null?(je(ot,ot.current&1),r.flags|=128,null):(l&r.child.childLanes)!==0?bp(n,r,l):(je(ot,ot.current&1),n=di(n,r,l),n!==null?n.sibling:null);je(ot,ot.current&1);break;case 19:if(d=(l&r.childLanes)!==0,(n.flags&128)!==0){if(d)return xp(n,r,l);r.flags|=128}if(h=r.memoizedState,h!==null&&(h.rendering=null,h.tail=null,h.lastEffect=null),je(ot,ot.current),d)break;return null;case 22:case 23:return r.lanes=0,Fp(n,r,l)}return di(n,r,l)}var $p,hd,Wp,zp;$p=function(n,r){for(var l=r.child;l!==null;){if(l.tag===5||l.tag===6)n.appendChild(l.stateNode);else if(l.tag!==4&&l.child!==null){l.child.return=l,l=l.child;continue}if(l===r)break;for(;l.sibling===null;){if(l.return===null||l.return===r)return;l=l.return}l.sibling.return=l.return,l=l.sibling}},hd=function(){},Wp=function(n,r,l,d){var h=n.memoizedProps;if(h!==d){n=r.stateNode,Sr(jn.current);var p=null;switch(l){case"input":h=nt(n,h),d=nt(n,d),p=[];break;case"select":h=Y({},h,{value:void 0}),d=Y({},d,{value:void 0}),p=[];break;case"textarea":h=dr(n,h),d=dr(n,d),p=[];break;default:typeof h.onClick!="function"&&typeof d.onClick=="function"&&(n.onclick=nl)}Vu(l,d);var v;l=null;for(L in h)if(!d.hasOwnProperty(L)&&h.hasOwnProperty(L)&&h[L]!=null)if(L==="style"){var w=h[L];for(v in w)w.hasOwnProperty(v)&&(l||(l={}),l[v]="")}else L!=="dangerouslySetInnerHTML"&&L!=="children"&&L!=="suppressContentEditableWarning"&&L!=="suppressHydrationWarning"&&L!=="autoFocus"&&(a.hasOwnProperty(L)?p||(p=[]):(p=p||[]).push(L,null));for(L in d){var R=d[L];if(w=h!=null?h[L]:void 0,d.hasOwnProperty(L)&&R!==w&&(R!=null||w!=null))if(L==="style")if(w){for(v in w)!w.hasOwnProperty(v)||R&&R.hasOwnProperty(v)||(l||(l={}),l[v]="");for(v in R)R.hasOwnProperty(v)&&w[v]!==R[v]&&(l||(l={}),l[v]=R[v])}else l||(p||(p=[]),p.push(L,l)),l=R;else L==="dangerouslySetInnerHTML"?(R=R?R.__html:void 0,w=w?w.__html:void 0,R!=null&&w!==R&&(p=p||[]).push(L,R)):L==="children"?typeof R!="string"&&typeof R!="number"||(p=p||[]).push(L,""+R):L!=="suppressContentEditableWarning"&&L!=="suppressHydrationWarning"&&(a.hasOwnProperty(L)?(R!=null&&L==="onScroll"&&Qe("scroll",n),p||w===R||(p=[])):(p=p||[]).push(L,R))}l&&(p=p||[]).push("style",l);var L=p;(r.updateQueue=L)&&(r.flags|=4)}},zp=function(n,r,l,d){l!==d&&(r.flags|=4)};function bs(n,r){if(!it)switch(n.tailMode){case"hidden":r=n.tail;for(var l=null;r!==null;)r.alternate!==null&&(l=r),r=r.sibling;l===null?n.tail=null:l.sibling=null;break;case"collapsed":l=n.tail;for(var d=null;l!==null;)l.alternate!==null&&(d=l),l=l.sibling;d===null?r||n.tail===null?n.tail=null:n.tail.sibling=null:d.sibling=null}}function Ft(n){var r=n.alternate!==null&&n.alternate.child===n.child,l=0,d=0;if(r)for(var h=n.child;h!==null;)l|=h.lanes|h.childLanes,d|=h.subtreeFlags&14680064,d|=h.flags&14680064,h.return=n,h=h.sibling;else for(h=n.child;h!==null;)l|=h.lanes|h.childLanes,d|=h.subtreeFlags,d|=h.flags,h.return=n,h=h.sibling;return n.subtreeFlags|=d,n.childLanes=l,r}function IA(n,r,l){var d=r.pendingProps;switch(Lc(r),r.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Ft(r),null;case 1:return qt(r.type)&&rl(),Ft(r),null;case 3:return d=r.stateNode,ho(),Je(Zt),Je(Mt),Xc(),d.pendingContext&&(d.context=d.pendingContext,d.pendingContext=null),(n===null||n.child===null)&&(ul(r)?r.flags|=4:n===null||n.memoizedState.isDehydrated&&(r.flags&256)===0||(r.flags|=1024,Pn!==null&&(Cd(Pn),Pn=null))),hd(n,r),Ft(r),null;case 5:jc(r);var h=Sr(Fs.current);if(l=r.type,n!==null&&r.stateNode!=null)Wp(n,r,l,d,h),n.ref!==r.ref&&(r.flags|=512,r.flags|=2097152);else{if(!d){if(r.stateNode===null)throw Error(i(166));return Ft(r),null}if(n=Sr(jn.current),ul(r)){d=r.stateNode,l=r.type;var p=r.memoizedProps;switch(d[Yn]=r,d[Ns]=p,n=(r.mode&1)!==0,l){case"dialog":Qe("cancel",d),Qe("close",d);break;case"iframe":case"object":case"embed":Qe("load",d);break;case"video":case"audio":for(h=0;h<ws.length;h++)Qe(ws[h],d);break;case"source":Qe("error",d);break;case"img":case"image":case"link":Qe("error",d),Qe("load",d);break;case"details":Qe("toggle",d);break;case"input":qe(d,p),Qe("invalid",d);break;case"select":d._wrapperState={wasMultiple:!!p.multiple},Qe("invalid",d);break;case"textarea":Rh(d,p),Qe("invalid",d)}Vu(l,p),h=null;for(var v in p)if(p.hasOwnProperty(v)){var w=p[v];v==="children"?typeof w=="string"?d.textContent!==w&&(p.suppressHydrationWarning!==!0&&tl(d.textContent,w,n),h=["children",w]):typeof w=="number"&&d.textContent!==""+w&&(p.suppressHydrationWarning!==!0&&tl(d.textContent,w,n),h=["children",""+w]):a.hasOwnProperty(v)&&w!=null&&v==="onScroll"&&Qe("scroll",d)}switch(l){case"input":Be(d),hn(d,p,!0);break;case"textarea":Be(d),Nh(d);break;case"select":case"option":break;default:typeof p.onClick=="function"&&(d.onclick=nl)}d=h,r.updateQueue=d,d!==null&&(r.flags|=4)}else{v=h.nodeType===9?h:h.ownerDocument,n==="http://www.w3.org/1999/xhtml"&&(n=Dh(l)),n==="http://www.w3.org/1999/xhtml"?l==="script"?(n=v.createElement("div"),n.innerHTML="<script><\/script>",n=n.removeChild(n.firstChild)):typeof d.is=="string"?n=v.createElement(l,{is:d.is}):(n=v.createElement(l),l==="select"&&(v=n,d.multiple?v.multiple=!0:d.size&&(v.size=d.size))):n=v.createElementNS(n,l),n[Yn]=r,n[Ns]=d,$p(n,r,!1,!1),r.stateNode=n;e:{switch(v=Xu(l,d),l){case"dialog":Qe("cancel",n),Qe("close",n),h=d;break;case"iframe":case"object":case"embed":Qe("load",n),h=d;break;case"video":case"audio":for(h=0;h<ws.length;h++)Qe(ws[h],n);h=d;break;case"source":Qe("error",n),h=d;break;case"img":case"image":case"link":Qe("error",n),Qe("load",n),h=d;break;case"details":Qe("toggle",n),h=d;break;case"input":qe(n,d),h=nt(n,d),Qe("invalid",n);break;case"option":h=d;break;case"select":n._wrapperState={wasMultiple:!!d.multiple},h=Y({},d,{value:void 0}),Qe("invalid",n);break;case"textarea":Rh(n,d),h=dr(n,d),Qe("invalid",n);break;default:h=d}Vu(l,h),w=h;for(p in w)if(w.hasOwnProperty(p)){var R=w[p];p==="style"?kh(n,R):p==="dangerouslySetInnerHTML"?(R=R?R.__html:void 0,R!=null&&Oh(n,R)):p==="children"?typeof R=="string"?(l!=="textarea"||R!=="")&&as(n,R):typeof R=="number"&&as(n,""+R):p!=="suppressContentEditableWarning"&&p!=="suppressHydrationWarning"&&p!=="autoFocus"&&(a.hasOwnProperty(p)?R!=null&&p==="onScroll"&&Qe("scroll",n):R!=null&&P(n,p,R,v))}switch(l){case"input":Be(n),hn(n,d,!1);break;case"textarea":Be(n),Nh(n);break;case"option":d.value!=null&&n.setAttribute("value",""+Ce(d.value));break;case"select":n.multiple=!!d.multiple,p=d.value,p!=null?Ei(n,!!d.multiple,p,!1):d.defaultValue!=null&&Ei(n,!!d.multiple,d.defaultValue,!0);break;default:typeof h.onClick=="function"&&(n.onclick=nl)}switch(l){case"button":case"input":case"select":case"textarea":d=!!d.autoFocus;break e;case"img":d=!0;break e;default:d=!1}}d&&(r.flags|=4)}r.ref!==null&&(r.flags|=512,r.flags|=2097152)}return Ft(r),null;case 6:if(n&&r.stateNode!=null)zp(n,r,n.memoizedProps,d);else{if(typeof d!="string"&&r.stateNode===null)throw Error(i(166));if(l=Sr(Fs.current),Sr(jn.current),ul(r)){if(d=r.stateNode,l=r.memoizedProps,d[Yn]=r,(p=d.nodeValue!==l)&&(n=rn,n!==null))switch(n.tag){case 3:tl(d.nodeValue,l,(n.mode&1)!==0);break;case 5:n.memoizedProps.suppressHydrationWarning!==!0&&tl(d.nodeValue,l,(n.mode&1)!==0)}p&&(r.flags|=4)}else d=(l.nodeType===9?l:l.ownerDocument).createTextNode(d),d[Yn]=r,r.stateNode=d}return Ft(r),null;case 13:if(Je(ot),d=r.memoizedState,n===null||n.memoizedState!==null&&n.memoizedState.dehydrated!==null){if(it&&on!==null&&(r.mode&1)!==0&&(r.flags&128)===0)Vg(),lo(),r.flags|=98560,p=!1;else if(p=ul(r),d!==null&&d.dehydrated!==null){if(n===null){if(!p)throw Error(i(318));if(p=r.memoizedState,p=p!==null?p.dehydrated:null,!p)throw Error(i(317));p[Yn]=r}else lo(),(r.flags&128)===0&&(r.memoizedState=null),r.flags|=4;Ft(r),p=!1}else Pn!==null&&(Cd(Pn),Pn=null),p=!0;if(!p)return r.flags&65536?r:null}return(r.flags&128)!==0?(r.lanes=l,r):(d=d!==null,d!==(n!==null&&n.memoizedState!==null)&&d&&(r.child.flags|=8192,(r.mode&1)!==0&&(n===null||(ot.current&1)!==0?vt===0&&(vt=3):Rd())),r.updateQueue!==null&&(r.flags|=4),Ft(r),null);case 4:return ho(),hd(n,r),n===null&&Rs(r.stateNode.containerInfo),Ft(r),null;case 10:return xc(r.type._context),Ft(r),null;case 17:return qt(r.type)&&rl(),Ft(r),null;case 19:if(Je(ot),p=r.memoizedState,p===null)return Ft(r),null;if(d=(r.flags&128)!==0,v=p.rendering,v===null)if(d)bs(p,!1);else{if(vt!==0||n!==null&&(n.flags&128)!==0)for(n=r.child;n!==null;){if(v=pl(n),v!==null){for(r.flags|=128,bs(p,!1),d=v.updateQueue,d!==null&&(r.updateQueue=d,r.flags|=4),r.subtreeFlags=0,d=l,l=r.child;l!==null;)p=l,n=d,p.flags&=14680066,v=p.alternate,v===null?(p.childLanes=0,p.lanes=n,p.child=null,p.subtreeFlags=0,p.memoizedProps=null,p.memoizedState=null,p.updateQueue=null,p.dependencies=null,p.stateNode=null):(p.childLanes=v.childLanes,p.lanes=v.lanes,p.child=v.child,p.subtreeFlags=0,p.deletions=null,p.memoizedProps=v.memoizedProps,p.memoizedState=v.memoizedState,p.updateQueue=v.updateQueue,p.type=v.type,n=v.dependencies,p.dependencies=n===null?null:{lanes:n.lanes,firstContext:n.firstContext}),l=l.sibling;return je(ot,ot.current&1|2),r.child}n=n.sibling}p.tail!==null&&ut()>vo&&(r.flags|=128,d=!0,bs(p,!1),r.lanes=4194304)}else{if(!d)if(n=pl(v),n!==null){if(r.flags|=128,d=!0,l=n.updateQueue,l!==null&&(r.updateQueue=l,r.flags|=4),bs(p,!0),p.tail===null&&p.tailMode==="hidden"&&!v.alternate&&!it)return Ft(r),null}else 2*ut()-p.renderingStartTime>vo&&l!==1073741824&&(r.flags|=128,d=!0,bs(p,!1),r.lanes=4194304);p.isBackwards?(v.sibling=r.child,r.child=v):(l=p.last,l!==null?l.sibling=v:r.child=v,p.last=v)}return p.tail!==null?(r=p.tail,p.rendering=r,p.tail=r.sibling,p.renderingStartTime=ut(),r.sibling=null,l=ot.current,je(ot,d?l&1|2:l&1),r):(Ft(r),null);case 22:case 23:return wd(),d=r.memoizedState!==null,n!==null&&n.memoizedState!==null!==d&&(r.flags|=8192),d&&(r.mode&1)!==0?(sn&1073741824)!==0&&(Ft(r),r.subtreeFlags&6&&(r.flags|=8192)):Ft(r),null;case 24:return null;case 25:return null}throw Error(i(156,r.tag))}function EA(n,r){switch(Lc(r),r.tag){case 1:return qt(r.type)&&rl(),n=r.flags,n&65536?(r.flags=n&-65537|128,r):null;case 3:return ho(),Je(Zt),Je(Mt),Xc(),n=r.flags,(n&65536)!==0&&(n&128)===0?(r.flags=n&-65537|128,r):null;case 5:return jc(r),null;case 13:if(Je(ot),n=r.memoizedState,n!==null&&n.dehydrated!==null){if(r.alternate===null)throw Error(i(340));lo()}return n=r.flags,n&65536?(r.flags=n&-65537|128,r):null;case 19:return Je(ot),null;case 4:return ho(),null;case 10:return xc(r.type._context),null;case 22:case 23:return wd(),null;case 24:return null;default:return null}}var Cl=!1,Lt=!1,CA=typeof WeakSet=="function"?WeakSet:Set,ie=null;function po(n,r){var l=n.ref;if(l!==null)if(typeof l=="function")try{l(null)}catch(d){at(n,r,d)}else l.current=null}function gd(n,r,l){try{l()}catch(d){at(n,r,d)}}var Yp=!1;function _A(n,r){if(wc=za,n=Eg(),Sc(n)){if("selectionStart"in n)var l={start:n.selectionStart,end:n.selectionEnd};else e:{l=(l=n.ownerDocument)&&l.defaultView||window;var d=l.getSelection&&l.getSelection();if(d&&d.rangeCount!==0){l=d.anchorNode;var h=d.anchorOffset,p=d.focusNode;d=d.focusOffset;try{l.nodeType,p.nodeType}catch{l=null;break e}var v=0,w=-1,R=-1,L=0,$=0,W=n,x=null;t:for(;;){for(var Q;W!==l||h!==0&&W.nodeType!==3||(w=v+h),W!==p||d!==0&&W.nodeType!==3||(R=v+d),W.nodeType===3&&(v+=W.nodeValue.length),(Q=W.firstChild)!==null;)x=W,W=Q;for(;;){if(W===n)break t;if(x===l&&++L===h&&(w=v),x===p&&++$===d&&(R=v),(Q=W.nextSibling)!==null)break;W=x,x=W.parentNode}W=Q}l=w===-1||R===-1?null:{start:w,end:R}}else l=null}l=l||{start:0,end:0}}else l=null;for(Rc={focusedElem:n,selectionRange:l},za=!1,ie=r;ie!==null;)if(r=ie,n=r.child,(r.subtreeFlags&1028)!==0&&n!==null)n.return=r,ie=n;else for(;ie!==null;){r=ie;try{var se=r.alternate;if((r.flags&1024)!==0)switch(r.tag){case 0:case 11:case 15:break;case 1:if(se!==null){var ue=se.memoizedProps,ct=se.memoizedState,M=r.stateNode,D=M.getSnapshotBeforeUpdate(r.elementType===r.type?ue:Nn(r.type,ue),ct);M.__reactInternalSnapshotBeforeUpdate=D}break;case 3:var k=r.stateNode.containerInfo;k.nodeType===1?k.textContent="":k.nodeType===9&&k.documentElement&&k.removeChild(k.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(i(163))}}catch(j){at(r,r.return,j)}if(n=r.sibling,n!==null){n.return=r.return,ie=n;break}ie=r.return}return se=Yp,Yp=!1,se}function Gs(n,r,l){var d=r.updateQueue;if(d=d!==null?d.lastEffect:null,d!==null){var h=d=d.next;do{if((h.tag&n)===n){var p=h.destroy;h.destroy=void 0,p!==void 0&&gd(r,l,p)}h=h.next}while(h!==d)}}function _l(n,r){if(r=r.updateQueue,r=r!==null?r.lastEffect:null,r!==null){var l=r=r.next;do{if((l.tag&n)===n){var d=l.create;l.destroy=d()}l=l.next}while(l!==r)}}function pd(n){var r=n.ref;if(r!==null){var l=n.stateNode;switch(n.tag){case 5:n=l;break;default:n=l}typeof r=="function"?r(n):r.current=n}}function jp(n){var r=n.alternate;r!==null&&(n.alternate=null,jp(r)),n.child=null,n.deletions=null,n.sibling=null,n.tag===5&&(r=n.stateNode,r!==null&&(delete r[Yn],delete r[Ns],delete r[Oc],delete r[aA],delete r[lA])),n.stateNode=null,n.return=null,n.dependencies=null,n.memoizedProps=null,n.memoizedState=null,n.pendingProps=null,n.stateNode=null,n.updateQueue=null}function Vp(n){return n.tag===5||n.tag===3||n.tag===4}function Xp(n){e:for(;;){for(;n.sibling===null;){if(n.return===null||Vp(n.return))return null;n=n.return}for(n.sibling.return=n.return,n=n.sibling;n.tag!==5&&n.tag!==6&&n.tag!==18;){if(n.flags&2||n.child===null||n.tag===4)continue e;n.child.return=n,n=n.child}if(!(n.flags&2))return n.stateNode}}function md(n,r,l){var d=n.tag;if(d===5||d===6)n=n.stateNode,r?l.nodeType===8?l.parentNode.insertBefore(n,r):l.insertBefore(n,r):(l.nodeType===8?(r=l.parentNode,r.insertBefore(n,l)):(r=l,r.appendChild(n)),l=l._reactRootContainer,l!=null||r.onclick!==null||(r.onclick=nl));else if(d!==4&&(n=n.child,n!==null))for(md(n,r,l),n=n.sibling;n!==null;)md(n,r,l),n=n.sibling}function vd(n,r,l){var d=n.tag;if(d===5||d===6)n=n.stateNode,r?l.insertBefore(n,r):l.appendChild(n);else if(d!==4&&(n=n.child,n!==null))for(vd(n,r,l),n=n.sibling;n!==null;)vd(n,r,l),n=n.sibling}var Rt=null,Dn=!1;function Ui(n,r,l){for(l=l.child;l!==null;)Kp(n,r,l),l=l.sibling}function Kp(n,r,l){if(zn&&typeof zn.onCommitFiberUnmount=="function")try{zn.onCommitFiberUnmount(Ha,l)}catch{}switch(l.tag){case 5:Lt||po(l,r);case 6:var d=Rt,h=Dn;Rt=null,Ui(n,r,l),Rt=d,Dn=h,Rt!==null&&(Dn?(n=Rt,l=l.stateNode,n.nodeType===8?n.parentNode.removeChild(l):n.removeChild(l)):Rt.removeChild(l.stateNode));break;case 18:Rt!==null&&(Dn?(n=Rt,l=l.stateNode,n.nodeType===8?Dc(n.parentNode,l):n.nodeType===1&&Dc(n,l),Ss(n)):Dc(Rt,l.stateNode));break;case 4:d=Rt,h=Dn,Rt=l.stateNode.containerInfo,Dn=!0,Ui(n,r,l),Rt=d,Dn=h;break;case 0:case 11:case 14:case 15:if(!Lt&&(d=l.updateQueue,d!==null&&(d=d.lastEffect,d!==null))){h=d=d.next;do{var p=h,v=p.destroy;p=p.tag,v!==void 0&&((p&2)!==0||(p&4)!==0)&&gd(l,r,v),h=h.next}while(h!==d)}Ui(n,r,l);break;case 1:if(!Lt&&(po(l,r),d=l.stateNode,typeof d.componentWillUnmount=="function"))try{d.props=l.memoizedProps,d.state=l.memoizedState,d.componentWillUnmount()}catch(w){at(l,r,w)}Ui(n,r,l);break;case 21:Ui(n,r,l);break;case 22:l.mode&1?(Lt=(d=Lt)||l.memoizedState!==null,Ui(n,r,l),Lt=d):Ui(n,r,l);break;default:Ui(n,r,l)}}function Zp(n){var r=n.updateQueue;if(r!==null){n.updateQueue=null;var l=n.stateNode;l===null&&(l=n.stateNode=new CA),r.forEach(function(d){var h=FA.bind(null,n,d);l.has(d)||(l.add(d),d.then(h,h))})}}function On(n,r){var l=r.deletions;if(l!==null)for(var d=0;d<l.length;d++){var h=l[d];try{var p=n,v=r,w=v;e:for(;w!==null;){switch(w.tag){case 5:Rt=w.stateNode,Dn=!1;break e;case 3:Rt=w.stateNode.containerInfo,Dn=!0;break e;case 4:Rt=w.stateNode.containerInfo,Dn=!0;break e}w=w.return}if(Rt===null)throw Error(i(160));Kp(p,v,h),Rt=null,Dn=!1;var R=h.alternate;R!==null&&(R.return=null),h.return=null}catch(L){at(h,r,L)}}if(r.subtreeFlags&12854)for(r=r.child;r!==null;)qp(r,n),r=r.sibling}function qp(n,r){var l=n.alternate,d=n.flags;switch(n.tag){case 0:case 11:case 14:case 15:if(On(r,n),Xn(n),d&4){try{Gs(3,n,n.return),_l(3,n)}catch(ue){at(n,n.return,ue)}try{Gs(5,n,n.return)}catch(ue){at(n,n.return,ue)}}break;case 1:On(r,n),Xn(n),d&512&&l!==null&&po(l,l.return);break;case 5:if(On(r,n),Xn(n),d&512&&l!==null&&po(l,l.return),n.flags&32){var h=n.stateNode;try{as(h,"")}catch(ue){at(n,n.return,ue)}}if(d&4&&(h=n.stateNode,h!=null)){var p=n.memoizedProps,v=l!==null?l.memoizedProps:p,w=n.type,R=n.updateQueue;if(n.updateQueue=null,R!==null)try{w==="input"&&p.type==="radio"&&p.name!=null&&xn(h,p),Xu(w,v);var L=Xu(w,p);for(v=0;v<R.length;v+=2){var $=R[v],W=R[v+1];$==="style"?kh(h,W):$==="dangerouslySetInnerHTML"?Oh(h,W):$==="children"?as(h,W):P(h,$,W,L)}switch(w){case"input":Kt(h,p);break;case"textarea":Ph(h,p);break;case"select":var x=h._wrapperState.wasMultiple;h._wrapperState.wasMultiple=!!p.multiple;var Q=p.value;Q!=null?Ei(h,!!p.multiple,Q,!1):x!==!!p.multiple&&(p.defaultValue!=null?Ei(h,!!p.multiple,p.defaultValue,!0):Ei(h,!!p.multiple,p.multiple?[]:"",!1))}h[Ns]=p}catch(ue){at(n,n.return,ue)}}break;case 6:if(On(r,n),Xn(n),d&4){if(n.stateNode===null)throw Error(i(162));h=n.stateNode,p=n.memoizedProps;try{h.nodeValue=p}catch(ue){at(n,n.return,ue)}}break;case 3:if(On(r,n),Xn(n),d&4&&l!==null&&l.memoizedState.isDehydrated)try{Ss(r.containerInfo)}catch(ue){at(n,n.return,ue)}break;case 4:On(r,n),Xn(n);break;case 13:On(r,n),Xn(n),h=n.child,h.flags&8192&&(p=h.memoizedState!==null,h.stateNode.isHidden=p,!p||h.alternate!==null&&h.alternate.memoizedState!==null||(Ad=ut())),d&4&&Zp(n);break;case 22:if($=l!==null&&l.memoizedState!==null,n.mode&1?(Lt=(L=Lt)||$,On(r,n),Lt=L):On(r,n),Xn(n),d&8192){if(L=n.memoizedState!==null,(n.stateNode.isHidden=L)&&!$&&(n.mode&1)!==0)for(ie=n,$=n.child;$!==null;){for(W=ie=$;ie!==null;){switch(x=ie,Q=x.child,x.tag){case 0:case 11:case 14:case 15:Gs(4,x,x.return);break;case 1:po(x,x.return);var se=x.stateNode;if(typeof se.componentWillUnmount=="function"){d=x,l=x.return;try{r=d,se.props=r.memoizedProps,se.state=r.memoizedState,se.componentWillUnmount()}catch(ue){at(d,l,ue)}}break;case 5:po(x,x.return);break;case 22:if(x.memoizedState!==null){em(W);continue}}Q!==null?(Q.return=x,ie=Q):em(W)}$=$.sibling}e:for($=null,W=n;;){if(W.tag===5){if($===null){$=W;try{h=W.stateNode,L?(p=h.style,typeof p.setProperty=="function"?p.setProperty("display","none","important"):p.display="none"):(w=W.stateNode,R=W.memoizedProps.style,v=R!=null&&R.hasOwnProperty("display")?R.display:null,w.style.display=Mh("display",v))}catch(ue){at(n,n.return,ue)}}}else if(W.tag===6){if($===null)try{W.stateNode.nodeValue=L?"":W.memoizedProps}catch(ue){at(n,n.return,ue)}}else if((W.tag!==22&&W.tag!==23||W.memoizedState===null||W===n)&&W.child!==null){W.child.return=W,W=W.child;continue}if(W===n)break e;for(;W.sibling===null;){if(W.return===null||W.return===n)break e;$===W&&($=null),W=W.return}$===W&&($=null),W.sibling.return=W.return,W=W.sibling}}break;case 19:On(r,n),Xn(n),d&4&&Zp(n);break;case 21:break;default:On(r,n),Xn(n)}}function Xn(n){var r=n.flags;if(r&2){try{e:{for(var l=n.return;l!==null;){if(Vp(l)){var d=l;break e}l=l.return}throw Error(i(160))}switch(d.tag){case 5:var h=d.stateNode;d.flags&32&&(as(h,""),d.flags&=-33);var p=Xp(n);vd(n,p,h);break;case 3:case 4:var v=d.stateNode.containerInfo,w=Xp(n);md(n,w,v);break;default:throw Error(i(161))}}catch(R){at(n,n.return,R)}n.flags&=-3}r&4096&&(n.flags&=-4097)}function wA(n,r,l){ie=n,Qp(n)}function Qp(n,r,l){for(var d=(n.mode&1)!==0;ie!==null;){var h=ie,p=h.child;if(h.tag===22&&d){var v=h.memoizedState!==null||Cl;if(!v){var w=h.alternate,R=w!==null&&w.memoizedState!==null||Lt;w=Cl;var L=Lt;if(Cl=v,(Lt=R)&&!L)for(ie=h;ie!==null;)v=ie,R=v.child,v.tag===22&&v.memoizedState!==null?tm(h):R!==null?(R.return=v,ie=R):tm(h);for(;p!==null;)ie=p,Qp(p),p=p.sibling;ie=h,Cl=w,Lt=L}Jp(n)}else(h.subtreeFlags&8772)!==0&&p!==null?(p.return=h,ie=p):Jp(n)}}function Jp(n){for(;ie!==null;){var r=ie;if((r.flags&8772)!==0){var l=r.alternate;try{if((r.flags&8772)!==0)switch(r.tag){case 0:case 11:case 15:Lt||_l(5,r);break;case 1:var d=r.stateNode;if(r.flags&4&&!Lt)if(l===null)d.componentDidMount();else{var h=r.elementType===r.type?l.memoizedProps:Nn(r.type,l.memoizedProps);d.componentDidUpdate(h,l.memoizedState,d.__reactInternalSnapshotBeforeUpdate)}var p=r.updateQueue;p!==null&&ep(r,p,d);break;case 3:var v=r.updateQueue;if(v!==null){if(l=null,r.child!==null)switch(r.child.tag){case 5:l=r.child.stateNode;break;case 1:l=r.child.stateNode}ep(r,v,l)}break;case 5:var w=r.stateNode;if(l===null&&r.flags&4){l=w;var R=r.memoizedProps;switch(r.type){case"button":case"input":case"select":case"textarea":R.autoFocus&&l.focus();break;case"img":R.src&&(l.src=R.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(r.memoizedState===null){var L=r.alternate;if(L!==null){var $=L.memoizedState;if($!==null){var W=$.dehydrated;W!==null&&Ss(W)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(i(163))}Lt||r.flags&512&&pd(r)}catch(x){at(r,r.return,x)}}if(r===n){ie=null;break}if(l=r.sibling,l!==null){l.return=r.return,ie=l;break}ie=r.return}}function em(n){for(;ie!==null;){var r=ie;if(r===n){ie=null;break}var l=r.sibling;if(l!==null){l.return=r.return,ie=l;break}ie=r.return}}function tm(n){for(;ie!==null;){var r=ie;try{switch(r.tag){case 0:case 11:case 15:var l=r.return;try{_l(4,r)}catch(R){at(r,l,R)}break;case 1:var d=r.stateNode;if(typeof d.componentDidMount=="function"){var h=r.return;try{d.componentDidMount()}catch(R){at(r,h,R)}}var p=r.return;try{pd(r)}catch(R){at(r,p,R)}break;case 5:var v=r.return;try{pd(r)}catch(R){at(r,v,R)}}}catch(R){at(r,r.return,R)}if(r===n){ie=null;break}var w=r.sibling;if(w!==null){w.return=r.return,ie=w;break}ie=r.return}}var RA=Math.ceil,wl=H.ReactCurrentDispatcher,Sd=H.ReactCurrentOwner,Sn=H.ReactCurrentBatchConfig,Ge=0,At=null,ht=null,Pt=0,sn=0,mo=Oi(0),vt=0,xs=null,Ar=0,Rl=0,yd=0,$s=null,Jt=null,Ad=0,vo=1/0,fi=null,Pl=!1,Td=null,Bi=null,Nl=!1,Hi=null,Dl=0,Ws=0,Id=null,Ol=-1,Ml=0;function xt(){return(Ge&6)!==0?ut():Ol!==-1?Ol:Ol=ut()}function bi(n){return(n.mode&1)===0?1:(Ge&2)!==0&&Pt!==0?Pt&-Pt:cA.transition!==null?(Ml===0&&(Ml=Xh()),Ml):(n=ze,n!==0||(n=window.event,n=n===void 0?16:ig(n.type)),n)}function Mn(n,r,l,d){if(50<Ws)throw Ws=0,Id=null,Error(i(185));hs(n,l,d),((Ge&2)===0||n!==At)&&(n===At&&((Ge&2)===0&&(Rl|=l),vt===4&&Gi(n,Pt)),en(n,d),l===1&&Ge===0&&(r.mode&1)===0&&(vo=ut()+500,sl&&ki()))}function en(n,r){var l=n.callbackNode;cy(n,r);var d=xa(n,n===At?Pt:0);if(d===0)l!==null&&Yh(l),n.callbackNode=null,n.callbackPriority=0;else if(r=d&-d,n.callbackPriority!==r){if(l!=null&&Yh(l),r===1)n.tag===0?uA(im.bind(null,n)):$g(im.bind(null,n)),oA(function(){(Ge&6)===0&&ki()}),l=null;else{switch(Kh(d)){case 1:l=tc;break;case 4:l=jh;break;case 16:l=Ba;break;case 536870912:l=Vh;break;default:l=Ba}l=dm(l,nm.bind(null,n))}n.callbackPriority=r,n.callbackNode=l}}function nm(n,r){if(Ol=-1,Ml=0,(Ge&6)!==0)throw Error(i(327));var l=n.callbackNode;if(So()&&n.callbackNode!==l)return null;var d=xa(n,n===At?Pt:0);if(d===0)return null;if((d&30)!==0||(d&n.expiredLanes)!==0||r)r=kl(n,d);else{r=d;var h=Ge;Ge|=2;var p=om();(At!==n||Pt!==r)&&(fi=null,vo=ut()+500,Ir(n,r));do try{DA();break}catch(w){rm(n,w)}while(!0);Gc(),wl.current=p,Ge=h,ht!==null?r=0:(At=null,Pt=0,r=vt)}if(r!==0){if(r===2&&(h=nc(n),h!==0&&(d=h,r=Ed(n,h))),r===1)throw l=xs,Ir(n,0),Gi(n,d),en(n,ut()),l;if(r===6)Gi(n,d);else{if(h=n.current.alternate,(d&30)===0&&!PA(h)&&(r=kl(n,d),r===2&&(p=nc(n),p!==0&&(d=p,r=Ed(n,p))),r===1))throw l=xs,Ir(n,0),Gi(n,d),en(n,ut()),l;switch(n.finishedWork=h,n.finishedLanes=d,r){case 0:case 1:throw Error(i(345));case 2:Er(n,Jt,fi);break;case 3:if(Gi(n,d),(d&130023424)===d&&(r=Ad+500-ut(),10<r)){if(xa(n,0)!==0)break;if(h=n.suspendedLanes,(h&d)!==d){xt(),n.pingedLanes|=n.suspendedLanes&h;break}n.timeoutHandle=Nc(Er.bind(null,n,Jt,fi),r);break}Er(n,Jt,fi);break;case 4:if(Gi(n,d),(d&4194240)===d)break;for(r=n.eventTimes,h=-1;0<d;){var v=31-wn(d);p=1<<v,v=r[v],v>h&&(h=v),d&=~p}if(d=h,d=ut()-d,d=(120>d?120:480>d?480:1080>d?1080:1920>d?1920:3e3>d?3e3:4320>d?4320:1960*RA(d/1960))-d,10<d){n.timeoutHandle=Nc(Er.bind(null,n,Jt,fi),d);break}Er(n,Jt,fi);break;case 5:Er(n,Jt,fi);break;default:throw Error(i(329))}}}return en(n,ut()),n.callbackNode===l?nm.bind(null,n):null}function Ed(n,r){var l=$s;return n.current.memoizedState.isDehydrated&&(Ir(n,r).flags|=256),n=kl(n,r),n!==2&&(r=Jt,Jt=l,r!==null&&Cd(r)),n}function Cd(n){Jt===null?Jt=n:Jt.push.apply(Jt,n)}function PA(n){for(var r=n;;){if(r.flags&16384){var l=r.updateQueue;if(l!==null&&(l=l.stores,l!==null))for(var d=0;d<l.length;d++){var h=l[d],p=h.getSnapshot;h=h.value;try{if(!Rn(p(),h))return!1}catch{return!1}}}if(l=r.child,r.subtreeFlags&16384&&l!==null)l.return=r,r=l;else{if(r===n)break;for(;r.sibling===null;){if(r.return===null||r.return===n)return!0;r=r.return}r.sibling.return=r.return,r=r.sibling}}return!0}function Gi(n,r){for(r&=~yd,r&=~Rl,n.suspendedLanes|=r,n.pingedLanes&=~r,n=n.expirationTimes;0<r;){var l=31-wn(r),d=1<<l;n[l]=-1,r&=~d}}function im(n){if((Ge&6)!==0)throw Error(i(327));So();var r=xa(n,0);if((r&1)===0)return en(n,ut()),null;var l=kl(n,r);if(n.tag!==0&&l===2){var d=nc(n);d!==0&&(r=d,l=Ed(n,d))}if(l===1)throw l=xs,Ir(n,0),Gi(n,r),en(n,ut()),l;if(l===6)throw Error(i(345));return n.finishedWork=n.current.alternate,n.finishedLanes=r,Er(n,Jt,fi),en(n,ut()),null}function _d(n,r){var l=Ge;Ge|=1;try{return n(r)}finally{Ge=l,Ge===0&&(vo=ut()+500,sl&&ki())}}function Tr(n){Hi!==null&&Hi.tag===0&&(Ge&6)===0&&So();var r=Ge;Ge|=1;var l=Sn.transition,d=ze;try{if(Sn.transition=null,ze=1,n)return n()}finally{ze=d,Sn.transition=l,Ge=r,(Ge&6)===0&&ki()}}function wd(){sn=mo.current,Je(mo)}function Ir(n,r){n.finishedWork=null,n.finishedLanes=0;var l=n.timeoutHandle;if(l!==-1&&(n.timeoutHandle=-1,rA(l)),ht!==null)for(l=ht.return;l!==null;){var d=l;switch(Lc(d),d.tag){case 1:d=d.type.childContextTypes,d!=null&&rl();break;case 3:ho(),Je(Zt),Je(Mt),Xc();break;case 5:jc(d);break;case 4:ho();break;case 13:Je(ot);break;case 19:Je(ot);break;case 10:xc(d.type._context);break;case 22:case 23:wd()}l=l.return}if(At=n,ht=n=xi(n.current,null),Pt=sn=r,vt=0,xs=null,yd=Rl=Ar=0,Jt=$s=null,vr!==null){for(r=0;r<vr.length;r++)if(l=vr[r],d=l.interleaved,d!==null){l.interleaved=null;var h=d.next,p=l.pending;if(p!==null){var v=p.next;p.next=h,d.next=v}l.pending=d}vr=null}return n}function rm(n,r){do{var l=ht;try{if(Gc(),ml.current=Al,vl){for(var d=st.memoizedState;d!==null;){var h=d.queue;h!==null&&(h.pending=null),d=d.next}vl=!1}if(yr=0,yt=mt=st=null,Ls=!1,Us=0,Sd.current=null,l===null||l.return===null){vt=1,xs=r,ht=null;break}e:{var p=n,v=l.return,w=l,R=r;if(r=Pt,w.flags|=32768,R!==null&&typeof R=="object"&&typeof R.then=="function"){var L=R,$=w,W=$.tag;if(($.mode&1)===0&&(W===0||W===11||W===15)){var x=$.alternate;x?($.updateQueue=x.updateQueue,$.memoizedState=x.memoizedState,$.lanes=x.lanes):($.updateQueue=null,$.memoizedState=null)}var Q=Np(v);if(Q!==null){Q.flags&=-257,Dp(Q,v,w,p,r),Q.mode&1&&Pp(p,L,r),r=Q,R=L;var se=r.updateQueue;if(se===null){var ue=new Set;ue.add(R),r.updateQueue=ue}else se.add(R);break e}else{if((r&1)===0){Pp(p,L,r),Rd();break e}R=Error(i(426))}}else if(it&&w.mode&1){var ct=Np(v);if(ct!==null){(ct.flags&65536)===0&&(ct.flags|=256),Dp(ct,v,w,p,r),Hc(go(R,w));break e}}p=R=go(R,w),vt!==4&&(vt=2),$s===null?$s=[p]:$s.push(p),p=v;do{switch(p.tag){case 3:p.flags|=65536,r&=-r,p.lanes|=r;var M=wp(p,R,r);Jg(p,M);break e;case 1:w=R;var D=p.type,k=p.stateNode;if((p.flags&128)===0&&(typeof D.getDerivedStateFromError=="function"||k!==null&&typeof k.componentDidCatch=="function"&&(Bi===null||!Bi.has(k)))){p.flags|=65536,r&=-r,p.lanes|=r;var j=Rp(p,w,r);Jg(p,j);break e}}p=p.return}while(p!==null)}am(l)}catch(de){r=de,ht===l&&l!==null&&(ht=l=l.return);continue}break}while(!0)}function om(){var n=wl.current;return wl.current=Al,n===null?Al:n}function Rd(){(vt===0||vt===3||vt===2)&&(vt=4),At===null||(Ar&268435455)===0&&(Rl&268435455)===0||Gi(At,Pt)}function kl(n,r){var l=Ge;Ge|=2;var d=om();(At!==n||Pt!==r)&&(fi=null,Ir(n,r));do try{NA();break}catch(h){rm(n,h)}while(!0);if(Gc(),Ge=l,wl.current=d,ht!==null)throw Error(i(261));return At=null,Pt=0,vt}function NA(){for(;ht!==null;)sm(ht)}function DA(){for(;ht!==null&&!ty();)sm(ht)}function sm(n){var r=cm(n.alternate,n,sn);n.memoizedProps=n.pendingProps,r===null?am(n):ht=r,Sd.current=null}function am(n){var r=n;do{var l=r.alternate;if(n=r.return,(r.flags&32768)===0){if(l=IA(l,r,sn),l!==null){ht=l;return}}else{if(l=EA(l,r),l!==null){l.flags&=32767,ht=l;return}if(n!==null)n.flags|=32768,n.subtreeFlags=0,n.deletions=null;else{vt=6,ht=null;return}}if(r=r.sibling,r!==null){ht=r;return}ht=r=n}while(r!==null);vt===0&&(vt=5)}function Er(n,r,l){var d=ze,h=Sn.transition;try{Sn.transition=null,ze=1,OA(n,r,l,d)}finally{Sn.transition=h,ze=d}return null}function OA(n,r,l,d){do So();while(Hi!==null);if((Ge&6)!==0)throw Error(i(327));l=n.finishedWork;var h=n.finishedLanes;if(l===null)return null;if(n.finishedWork=null,n.finishedLanes=0,l===n.current)throw Error(i(177));n.callbackNode=null,n.callbackPriority=0;var p=l.lanes|l.childLanes;if(dy(n,p),n===At&&(ht=At=null,Pt=0),(l.subtreeFlags&2064)===0&&(l.flags&2064)===0||Nl||(Nl=!0,dm(Ba,function(){return So(),null})),p=(l.flags&15990)!==0,(l.subtreeFlags&15990)!==0||p){p=Sn.transition,Sn.transition=null;var v=ze;ze=1;var w=Ge;Ge|=4,Sd.current=null,_A(n,l),qp(l,n),qy(Rc),za=!!wc,Rc=wc=null,n.current=l,wA(l),ny(),Ge=w,ze=v,Sn.transition=p}else n.current=l;if(Nl&&(Nl=!1,Hi=n,Dl=h),p=n.pendingLanes,p===0&&(Bi=null),oy(l.stateNode),en(n,ut()),r!==null)for(d=n.onRecoverableError,l=0;l<r.length;l++)h=r[l],d(h.value,{componentStack:h.stack,digest:h.digest});if(Pl)throw Pl=!1,n=Td,Td=null,n;return(Dl&1)!==0&&n.tag!==0&&So(),p=n.pendingLanes,(p&1)!==0?n===Id?Ws++:(Ws=0,Id=n):Ws=0,ki(),null}function So(){if(Hi!==null){var n=Kh(Dl),r=Sn.transition,l=ze;try{if(Sn.transition=null,ze=16>n?16:n,Hi===null)var d=!1;else{if(n=Hi,Hi=null,Dl=0,(Ge&6)!==0)throw Error(i(331));var h=Ge;for(Ge|=4,ie=n.current;ie!==null;){var p=ie,v=p.child;if((ie.flags&16)!==0){var w=p.deletions;if(w!==null){for(var R=0;R<w.length;R++){var L=w[R];for(ie=L;ie!==null;){var $=ie;switch($.tag){case 0:case 11:case 15:Gs(8,$,p)}var W=$.child;if(W!==null)W.return=$,ie=W;else for(;ie!==null;){$=ie;var x=$.sibling,Q=$.return;if(jp($),$===L){ie=null;break}if(x!==null){x.return=Q,ie=x;break}ie=Q}}}var se=p.alternate;if(se!==null){var ue=se.child;if(ue!==null){se.child=null;do{var ct=ue.sibling;ue.sibling=null,ue=ct}while(ue!==null)}}ie=p}}if((p.subtreeFlags&2064)!==0&&v!==null)v.return=p,ie=v;else e:for(;ie!==null;){if(p=ie,(p.flags&2048)!==0)switch(p.tag){case 0:case 11:case 15:Gs(9,p,p.return)}var M=p.sibling;if(M!==null){M.return=p.return,ie=M;break e}ie=p.return}}var D=n.current;for(ie=D;ie!==null;){v=ie;var k=v.child;if((v.subtreeFlags&2064)!==0&&k!==null)k.return=v,ie=k;else e:for(v=D;ie!==null;){if(w=ie,(w.flags&2048)!==0)try{switch(w.tag){case 0:case 11:case 15:_l(9,w)}}catch(de){at(w,w.return,de)}if(w===v){ie=null;break e}var j=w.sibling;if(j!==null){j.return=w.return,ie=j;break e}ie=w.return}}if(Ge=h,ki(),zn&&typeof zn.onPostCommitFiberRoot=="function")try{zn.onPostCommitFiberRoot(Ha,n)}catch{}d=!0}return d}finally{ze=l,Sn.transition=r}}return!1}function lm(n,r,l){r=go(l,r),r=wp(n,r,1),n=Li(n,r,1),r=xt(),n!==null&&(hs(n,1,r),en(n,r))}function at(n,r,l){if(n.tag===3)lm(n,n,l);else for(;r!==null;){if(r.tag===3){lm(r,n,l);break}else if(r.tag===1){var d=r.stateNode;if(typeof r.type.getDerivedStateFromError=="function"||typeof d.componentDidCatch=="function"&&(Bi===null||!Bi.has(d))){n=go(l,n),n=Rp(r,n,1),r=Li(r,n,1),n=xt(),r!==null&&(hs(r,1,n),en(r,n));break}}r=r.return}}function MA(n,r,l){var d=n.pingCache;d!==null&&d.delete(r),r=xt(),n.pingedLanes|=n.suspendedLanes&l,At===n&&(Pt&l)===l&&(vt===4||vt===3&&(Pt&130023424)===Pt&&500>ut()-Ad?Ir(n,0):yd|=l),en(n,r)}function um(n,r){r===0&&((n.mode&1)===0?r=1:(r=Ga,Ga<<=1,(Ga&130023424)===0&&(Ga=4194304)));var l=xt();n=ui(n,r),n!==null&&(hs(n,r,l),en(n,l))}function kA(n){var r=n.memoizedState,l=0;r!==null&&(l=r.retryLane),um(n,l)}function FA(n,r){var l=0;switch(n.tag){case 13:var d=n.stateNode,h=n.memoizedState;h!==null&&(l=h.retryLane);break;case 19:d=n.stateNode;break;default:throw Error(i(314))}d!==null&&d.delete(r),um(n,l)}var cm;cm=function(n,r,l){if(n!==null)if(n.memoizedProps!==r.pendingProps||Zt.current)Qt=!0;else{if((n.lanes&l)===0&&(r.flags&128)===0)return Qt=!1,TA(n,r,l);Qt=(n.flags&131072)!==0}else Qt=!1,it&&(r.flags&1048576)!==0&&Wg(r,ll,r.index);switch(r.lanes=0,r.tag){case 2:var d=r.type;El(n,r),n=r.pendingProps;var h=oo(r,Mt.current);fo(r,l),h=qc(null,r,d,n,h,l);var p=Qc();return r.flags|=1,typeof h=="object"&&h!==null&&typeof h.render=="function"&&h.$$typeof===void 0?(r.tag=1,r.memoizedState=null,r.updateQueue=null,qt(d)?(p=!0,ol(r)):p=!1,r.memoizedState=h.state!==null&&h.state!==void 0?h.state:null,zc(r),h.updater=Tl,r.stateNode=h,h._reactInternals=r,rd(r,d,n,l),r=ld(null,r,d,!0,p,l)):(r.tag=0,it&&p&&Fc(r),Gt(null,r,h,l),r=r.child),r;case 16:d=r.elementType;e:{switch(El(n,r),n=r.pendingProps,h=d._init,d=h(d._payload),r.type=d,h=r.tag=UA(d),n=Nn(d,n),h){case 0:r=ad(null,r,d,n,l);break e;case 1:r=Up(null,r,d,n,l);break e;case 11:r=Op(null,r,d,n,l);break e;case 14:r=Mp(null,r,d,Nn(d.type,n),l);break e}throw Error(i(306,d,""))}return r;case 0:return d=r.type,h=r.pendingProps,h=r.elementType===d?h:Nn(d,h),ad(n,r,d,h,l);case 1:return d=r.type,h=r.pendingProps,h=r.elementType===d?h:Nn(d,h),Up(n,r,d,h,l);case 3:e:{if(Bp(r),n===null)throw Error(i(387));d=r.pendingProps,p=r.memoizedState,h=p.element,Qg(n,r),gl(r,d,null,l);var v=r.memoizedState;if(d=v.element,p.isDehydrated)if(p={element:d,isDehydrated:!1,cache:v.cache,pendingSuspenseBoundaries:v.pendingSuspenseBoundaries,transitions:v.transitions},r.updateQueue.baseState=p,r.memoizedState=p,r.flags&256){h=go(Error(i(423)),r),r=Hp(n,r,d,l,h);break e}else if(d!==h){h=go(Error(i(424)),r),r=Hp(n,r,d,l,h);break e}else for(on=Di(r.stateNode.containerInfo.firstChild),rn=r,it=!0,Pn=null,l=Zg(r,null,d,l),r.child=l;l;)l.flags=l.flags&-3|4096,l=l.sibling;else{if(lo(),d===h){r=di(n,r,l);break e}Gt(n,r,d,l)}r=r.child}return r;case 5:return tp(r),n===null&&Bc(r),d=r.type,h=r.pendingProps,p=n!==null?n.memoizedProps:null,v=h.children,Pc(d,h)?v=null:p!==null&&Pc(d,p)&&(r.flags|=32),Lp(n,r),Gt(n,r,v,l),r.child;case 6:return n===null&&Bc(r),null;case 13:return bp(n,r,l);case 4:return Yc(r,r.stateNode.containerInfo),d=r.pendingProps,n===null?r.child=uo(r,null,d,l):Gt(n,r,d,l),r.child;case 11:return d=r.type,h=r.pendingProps,h=r.elementType===d?h:Nn(d,h),Op(n,r,d,h,l);case 7:return Gt(n,r,r.pendingProps,l),r.child;case 8:return Gt(n,r,r.pendingProps.children,l),r.child;case 12:return Gt(n,r,r.pendingProps.children,l),r.child;case 10:e:{if(d=r.type._context,h=r.pendingProps,p=r.memoizedProps,v=h.value,je(dl,d._currentValue),d._currentValue=v,p!==null)if(Rn(p.value,v)){if(p.children===h.children&&!Zt.current){r=di(n,r,l);break e}}else for(p=r.child,p!==null&&(p.return=r);p!==null;){var w=p.dependencies;if(w!==null){v=p.child;for(var R=w.firstContext;R!==null;){if(R.context===d){if(p.tag===1){R=ci(-1,l&-l),R.tag=2;var L=p.updateQueue;if(L!==null){L=L.shared;var $=L.pending;$===null?R.next=R:(R.next=$.next,$.next=R),L.pending=R}}p.lanes|=l,R=p.alternate,R!==null&&(R.lanes|=l),$c(p.return,l,r),w.lanes|=l;break}R=R.next}}else if(p.tag===10)v=p.type===r.type?null:p.child;else if(p.tag===18){if(v=p.return,v===null)throw Error(i(341));v.lanes|=l,w=v.alternate,w!==null&&(w.lanes|=l),$c(v,l,r),v=p.sibling}else v=p.child;if(v!==null)v.return=p;else for(v=p;v!==null;){if(v===r){v=null;break}if(p=v.sibling,p!==null){p.return=v.return,v=p;break}v=v.return}p=v}Gt(n,r,h.children,l),r=r.child}return r;case 9:return h=r.type,d=r.pendingProps.children,fo(r,l),h=mn(h),d=d(h),r.flags|=1,Gt(n,r,d,l),r.child;case 14:return d=r.type,h=Nn(d,r.pendingProps),h=Nn(d.type,h),Mp(n,r,d,h,l);case 15:return kp(n,r,r.type,r.pendingProps,l);case 17:return d=r.type,h=r.pendingProps,h=r.elementType===d?h:Nn(d,h),El(n,r),r.tag=1,qt(d)?(n=!0,ol(r)):n=!1,fo(r,l),Cp(r,d,h),rd(r,d,h,l),ld(null,r,d,!0,n,l);case 19:return xp(n,r,l);case 22:return Fp(n,r,l)}throw Error(i(156,r.tag))};function dm(n,r){return zh(n,r)}function LA(n,r,l,d){this.tag=n,this.key=l,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=r,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=d,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function yn(n,r,l,d){return new LA(n,r,l,d)}function Pd(n){return n=n.prototype,!(!n||!n.isReactComponent)}function UA(n){if(typeof n=="function")return Pd(n)?1:0;if(n!=null){if(n=n.$$typeof,n===De)return 11;if(n===Fe)return 14}return 2}function xi(n,r){var l=n.alternate;return l===null?(l=yn(n.tag,r,n.key,n.mode),l.elementType=n.elementType,l.type=n.type,l.stateNode=n.stateNode,l.alternate=n,n.alternate=l):(l.pendingProps=r,l.type=n.type,l.flags=0,l.subtreeFlags=0,l.deletions=null),l.flags=n.flags&14680064,l.childLanes=n.childLanes,l.lanes=n.lanes,l.child=n.child,l.memoizedProps=n.memoizedProps,l.memoizedState=n.memoizedState,l.updateQueue=n.updateQueue,r=n.dependencies,l.dependencies=r===null?null:{lanes:r.lanes,firstContext:r.firstContext},l.sibling=n.sibling,l.index=n.index,l.ref=n.ref,l}function Fl(n,r,l,d,h,p){var v=2;if(d=n,typeof n=="function")Pd(n)&&(v=1);else if(typeof n=="string")v=5;else e:switch(n){case G:return Cr(l.children,h,p,r);case Z:v=8,h|=8;break;case te:return n=yn(12,l,r,h|2),n.elementType=te,n.lanes=p,n;case Ie:return n=yn(13,l,r,h),n.elementType=Ie,n.lanes=p,n;case he:return n=yn(19,l,r,h),n.elementType=he,n.lanes=p,n;case ne:return Ll(l,h,p,r);default:if(typeof n=="object"&&n!==null)switch(n.$$typeof){case ve:v=10;break e;case be:v=9;break e;case De:v=11;break e;case Fe:v=14;break e;case Se:v=16,d=null;break e}throw Error(i(130,n==null?n:typeof n,""))}return r=yn(v,l,r,h),r.elementType=n,r.type=d,r.lanes=p,r}function Cr(n,r,l,d){return n=yn(7,n,d,r),n.lanes=l,n}function Ll(n,r,l,d){return n=yn(22,n,d,r),n.elementType=ne,n.lanes=l,n.stateNode={isHidden:!1},n}function Nd(n,r,l){return n=yn(6,n,null,r),n.lanes=l,n}function Dd(n,r,l){return r=yn(4,n.children!==null?n.children:[],n.key,r),r.lanes=l,r.stateNode={containerInfo:n.containerInfo,pendingChildren:null,implementation:n.implementation},r}function BA(n,r,l,d,h){this.tag=r,this.containerInfo=n,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=ic(0),this.expirationTimes=ic(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=ic(0),this.identifierPrefix=d,this.onRecoverableError=h,this.mutableSourceEagerHydrationData=null}function Od(n,r,l,d,h,p,v,w,R){return n=new BA(n,r,l,w,R),r===1?(r=1,p===!0&&(r|=8)):r=0,p=yn(3,null,null,r),n.current=p,p.stateNode=n,p.memoizedState={element:d,isDehydrated:l,cache:null,transitions:null,pendingSuspenseBoundaries:null},zc(p),n}function HA(n,r,l){var d=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:U,key:d==null?null:""+d,children:n,containerInfo:r,implementation:l}}function fm(n){if(!n)return Mi;n=n._reactInternals;e:{if(fr(n)!==n||n.tag!==1)throw Error(i(170));var r=n;do{switch(r.tag){case 3:r=r.stateNode.context;break e;case 1:if(qt(r.type)){r=r.stateNode.__reactInternalMemoizedMergedChildContext;break e}}r=r.return}while(r!==null);throw Error(i(171))}if(n.tag===1){var l=n.type;if(qt(l))return Gg(n,l,r)}return r}function hm(n,r,l,d,h,p,v,w,R){return n=Od(l,d,!0,n,h,p,v,w,R),n.context=fm(null),l=n.current,d=xt(),h=bi(l),p=ci(d,h),p.callback=r??null,Li(l,p,h),n.current.lanes=h,hs(n,h,d),en(n,d),n}function Ul(n,r,l,d){var h=r.current,p=xt(),v=bi(h);return l=fm(l),r.context===null?r.context=l:r.pendingContext=l,r=ci(p,v),r.payload={element:n},d=d===void 0?null:d,d!==null&&(r.callback=d),n=Li(h,r,v),n!==null&&(Mn(n,h,v,p),hl(n,h,v)),v}function Bl(n){if(n=n.current,!n.child)return null;switch(n.child.tag){case 5:return n.child.stateNode;default:return n.child.stateNode}}function gm(n,r){if(n=n.memoizedState,n!==null&&n.dehydrated!==null){var l=n.retryLane;n.retryLane=l!==0&&l<r?l:r}}function Md(n,r){gm(n,r),(n=n.alternate)&&gm(n,r)}function bA(){return null}var pm=typeof reportError=="function"?reportError:function(n){console.error(n)};function kd(n){this._internalRoot=n}Hl.prototype.render=kd.prototype.render=function(n){var r=this._internalRoot;if(r===null)throw Error(i(409));Ul(n,r,null,null)},Hl.prototype.unmount=kd.prototype.unmount=function(){var n=this._internalRoot;if(n!==null){this._internalRoot=null;var r=n.containerInfo;Tr(function(){Ul(null,n,null,null)}),r[oi]=null}};function Hl(n){this._internalRoot=n}Hl.prototype.unstable_scheduleHydration=function(n){if(n){var r=Qh();n={blockedOn:null,target:n,priority:r};for(var l=0;l<Ri.length&&r!==0&&r<Ri[l].priority;l++);Ri.splice(l,0,n),l===0&&tg(n)}};function Fd(n){return!(!n||n.nodeType!==1&&n.nodeType!==9&&n.nodeType!==11)}function bl(n){return!(!n||n.nodeType!==1&&n.nodeType!==9&&n.nodeType!==11&&(n.nodeType!==8||n.nodeValue!==" react-mount-point-unstable "))}function mm(){}function GA(n,r,l,d,h){if(h){if(typeof d=="function"){var p=d;d=function(){var L=Bl(v);p.call(L)}}var v=hm(r,d,n,0,null,!1,!1,"",mm);return n._reactRootContainer=v,n[oi]=v.current,Rs(n.nodeType===8?n.parentNode:n),Tr(),v}for(;h=n.lastChild;)n.removeChild(h);if(typeof d=="function"){var w=d;d=function(){var L=Bl(R);w.call(L)}}var R=Od(n,0,!1,null,null,!1,!1,"",mm);return n._reactRootContainer=R,n[oi]=R.current,Rs(n.nodeType===8?n.parentNode:n),Tr(function(){Ul(r,R,l,d)}),R}function Gl(n,r,l,d,h){var p=l._reactRootContainer;if(p){var v=p;if(typeof h=="function"){var w=h;h=function(){var R=Bl(v);w.call(R)}}Ul(r,v,n,h)}else v=GA(l,r,n,h,d);return Bl(v)}Zh=function(n){switch(n.tag){case 3:var r=n.stateNode;if(r.current.memoizedState.isDehydrated){var l=fs(r.pendingLanes);l!==0&&(rc(r,l|1),en(r,ut()),(Ge&6)===0&&(vo=ut()+500,ki()))}break;case 13:Tr(function(){var d=ui(n,1);if(d!==null){var h=xt();Mn(d,n,1,h)}}),Md(n,1)}},oc=function(n){if(n.tag===13){var r=ui(n,134217728);if(r!==null){var l=xt();Mn(r,n,134217728,l)}Md(n,134217728)}},qh=function(n){if(n.tag===13){var r=bi(n),l=ui(n,r);if(l!==null){var d=xt();Mn(l,n,r,d)}Md(n,r)}},Qh=function(){return ze},Jh=function(n,r){var l=ze;try{return ze=n,r()}finally{ze=l}},qu=function(n,r,l){switch(r){case"input":if(Kt(n,l),r=l.name,l.type==="radio"&&r!=null){for(l=n;l.parentNode;)l=l.parentNode;for(l=l.querySelectorAll("input[name="+JSON.stringify(""+r)+'][type="radio"]'),r=0;r<l.length;r++){var d=l[r];if(d!==n&&d.form===n.form){var h=il(d);if(!h)throw Error(i(90));ye(d),Kt(d,h)}}}break;case"textarea":Ph(n,l);break;case"select":r=l.value,r!=null&&Ei(n,!!l.multiple,r,!1)}},Bh=_d,Hh=Tr;var xA={usingClientEntryPoint:!1,Events:[Ds,io,il,Lh,Uh,_d]},zs={findFiberByHostInstance:hr,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},$A={bundleType:zs.bundleType,version:zs.version,rendererPackageName:zs.rendererPackageName,rendererConfig:zs.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:H.ReactCurrentDispatcher,findHostInstanceByFiber:function(n){return n=$h(n),n===null?null:n.stateNode},findFiberByHostInstance:zs.findFiberByHostInstance||bA,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var xl=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!xl.isDisabled&&xl.supportsFiber)try{Ha=xl.inject($A),zn=xl}catch{}}return tn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=xA,tn.createPortal=function(n,r){var l=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Fd(r))throw Error(i(200));return HA(n,r,null,l)},tn.createRoot=function(n,r){if(!Fd(n))throw Error(i(299));var l=!1,d="",h=pm;return r!=null&&(r.unstable_strictMode===!0&&(l=!0),r.identifierPrefix!==void 0&&(d=r.identifierPrefix),r.onRecoverableError!==void 0&&(h=r.onRecoverableError)),r=Od(n,1,!1,null,null,l,!1,d,h),n[oi]=r.current,Rs(n.nodeType===8?n.parentNode:n),new kd(r)},tn.findDOMNode=function(n){if(n==null)return null;if(n.nodeType===1)return n;var r=n._reactInternals;if(r===void 0)throw typeof n.render=="function"?Error(i(188)):(n=Object.keys(n).join(","),Error(i(268,n)));return n=$h(r),n=n===null?null:n.stateNode,n},tn.flushSync=function(n){return Tr(n)},tn.hydrate=function(n,r,l){if(!bl(r))throw Error(i(200));return Gl(null,n,r,!0,l)},tn.hydrateRoot=function(n,r,l){if(!Fd(n))throw Error(i(405));var d=l!=null&&l.hydratedSources||null,h=!1,p="",v=pm;if(l!=null&&(l.unstable_strictMode===!0&&(h=!0),l.identifierPrefix!==void 0&&(p=l.identifierPrefix),l.onRecoverableError!==void 0&&(v=l.onRecoverableError)),r=hm(r,null,n,1,l??null,h,!1,p,v),n[oi]=r.current,Rs(n),d)for(n=0;n<d.length;n++)l=d[n],h=l._getVersion,h=h(l._source),r.mutableSourceEagerHydrationData==null?r.mutableSourceEagerHydrationData=[l,h]:r.mutableSourceEagerHydrationData.push(l,h);return new Hl(r)},tn.render=function(n,r,l){if(!bl(r))throw Error(i(200));return Gl(null,n,r,!1,l)},tn.unmountComponentAtNode=function(n){if(!bl(n))throw Error(i(40));return n._reactRootContainer?(Tr(function(){Gl(null,null,n,!1,function(){n._reactRootContainer=null,n[oi]=null})}),!0):!1},tn.unstable_batchedUpdates=_d,tn.unstable_renderSubtreeIntoContainer=function(n,r,l,d){if(!bl(l))throw Error(i(200));if(n==null||n._reactInternals===void 0)throw Error(i(38));return Gl(n,r,l,!1,d)},tn.version="18.3.1-next-f1338f8080-20240426",tn}var Cm;function QA(){if(Cm)return Bd.exports;Cm=1;function e(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}return e(),Bd.exports=qA(),Bd.exports}var _m;function JA(){if(_m)return $l;_m=1;var e=QA();return $l.createRoot=e.createRoot,$l.hydrateRoot=e.hydrateRoot,$l}var eT=JA();const tT=tv(eT);class nT{constructor(){this.ids=[],this.values=[],this.length=0}clear(){this.length=0}push(t,i){let o=this.length++;for(;o>0;){const a=o-1>>1,s=this.values[a];if(i>=s)break;this.ids[o]=this.ids[a],this.values[o]=s,o=a}this.ids[o]=t,this.values[o]=i}pop(){if(this.length===0)return;const t=this.ids[0];if(this.length--,this.length>0){const i=this.ids[0]=this.ids[this.length],o=this.values[0]=this.values[this.length],a=this.length>>1;let s=0;for(;s<a;){let u=(s<<1)+1;const c=u+1;let f=this.ids[u],g=this.values[u];const m=this.values[c];if(c<this.length&&m<g&&(u=c,f=this.ids[c],g=m),g>=o)break;this.ids[s]=f,this.values[s]=g,s=u}this.ids[s]=i,this.values[s]=o}return t}peek(){if(this.length!==0)return this.ids[0]}peekValue(){if(this.length!==0)return this.values[0]}shrink(){this.ids.length=this.values.length=this.length}}const wm=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array],Gd=3;class Wf{static from(t,i=0){if(i%8!==0)throw new Error("byteOffset must be 8-byte aligned.");if(!t||t.byteLength===void 0||t.buffer)throw new Error("Data must be an instance of ArrayBuffer or SharedArrayBuffer.");const[o,a]=new Uint8Array(t,i+0,2);if(o!==251)throw new Error("Data does not appear to be in a Flatbush format.");const s=a>>4;if(s!==Gd)throw new Error(`Got v${s} data when expected v${Gd}.`);const u=wm[a&15];if(!u)throw new Error("Unrecognized array type.");const[c]=new Uint16Array(t,i+2,1),[f]=new Uint32Array(t,i+4,1);return new Wf(f,c,u,void 0,t,i)}constructor(t,i=16,o=Float64Array,a=ArrayBuffer,s,u=0){if(t===void 0)throw new Error("Missing required argument: numItems.");if(isNaN(t)||t<=0)throw new Error(`Unexpected numItems value: ${t}.`);this.numItems=+t,this.nodeSize=Math.min(Math.max(+i,2),65535),this.byteOffset=u;let c=t,f=c;this._levelBounds=[c*4];do c=Math.ceil(c/this.nodeSize),f+=c,this._levelBounds.push(f*4);while(c!==1);this.ArrayType=o,this.IndexArrayType=f<16384?Uint16Array:Uint32Array;const g=wm.indexOf(this.ArrayType),m=f*4*this.ArrayType.BYTES_PER_ELEMENT;if(g<0)throw new Error(`Unexpected typed array class: ${o}.`);s&&s.byteLength!==void 0&&!s.buffer?(this.data=s,this._boxes=new this.ArrayType(this.data,u+8,f*4),this._indices=new this.IndexArrayType(this.data,u+8+m,f),this._pos=f*4,this.minX=this._boxes[this._pos-4],this.minY=this._boxes[this._pos-3],this.maxX=this._boxes[this._pos-2],this.maxY=this._boxes[this._pos-1]):(this.data=new a(8+m+f*this.IndexArrayType.BYTES_PER_ELEMENT),this._boxes=new this.ArrayType(this.data,8,f*4),this._indices=new this.IndexArrayType(this.data,8+m,f),this._pos=0,this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0,new Uint8Array(this.data,0,2).set([251,(Gd<<4)+g]),new Uint16Array(this.data,2,1)[0]=i,new Uint32Array(this.data,4,1)[0]=t),this._queue=new nT}add(t,i,o=t,a=i){const s=this._pos>>2,u=this._boxes;return this._indices[s]=s,u[this._pos++]=t,u[this._pos++]=i,u[this._pos++]=o,u[this._pos++]=a,t<this.minX&&(this.minX=t),i<this.minY&&(this.minY=i),o>this.maxX&&(this.maxX=o),a>this.maxY&&(this.maxY=a),s}finish(){if(this._pos>>2!==this.numItems)throw new Error(`Added ${this._pos>>2} items when expected ${this.numItems}.`);const t=this._boxes;if(this.numItems<=this.nodeSize){t[this._pos++]=this.minX,t[this._pos++]=this.minY,t[this._pos++]=this.maxX,t[this._pos++]=this.maxY;return}const i=this.maxX-this.minX||1,o=this.maxY-this.minY||1,a=new Uint32Array(this.numItems),s=65535;for(let u=0,c=0;u<this.numItems;u++){const f=t[c++],g=t[c++],m=t[c++],S=t[c++],T=Math.floor(s*((f+m)/2-this.minX)/i),A=Math.floor(s*((g+S)/2-this.minY)/o);a[u]=rT(T,A)}yf(a,t,this._indices,0,this.numItems-1,this.nodeSize);for(let u=0,c=0;u<this._levelBounds.length-1;u++){const f=this._levelBounds[u];for(;c<f;){const g=c;let m=t[c++],S=t[c++],T=t[c++],A=t[c++];for(let I=1;I<this.nodeSize&&c<f;I++)m=Math.min(m,t[c++]),S=Math.min(S,t[c++]),T=Math.max(T,t[c++]),A=Math.max(A,t[c++]);this._indices[this._pos>>2]=g,t[this._pos++]=m,t[this._pos++]=S,t[this._pos++]=T,t[this._pos++]=A}}}search(t,i,o,a,s){if(this._pos!==this._boxes.length)throw new Error("Data not yet indexed - call index.finish().");let u=this._boxes.length-4;const c=[],f=[];for(;u!==void 0;){const g=Math.min(u+this.nodeSize*4,Pm(u,this._levelBounds));for(let m=u;m<g;m+=4){if(o<this._boxes[m]||a<this._boxes[m+1]||t>this._boxes[m+2]||i>this._boxes[m+3])continue;const S=this._indices[m>>2]|0;u>=this.numItems*4?c.push(S):(s===void 0||s(S))&&f.push(S)}u=c.pop()}return f}neighbors(t,i,o=1/0,a=1/0,s){if(this._pos!==this._boxes.length)throw new Error("Data not yet indexed - call index.finish().");let u=this._boxes.length-4;const c=this._queue,f=[],g=a*a;e:for(;u!==void 0;){const m=Math.min(u+this.nodeSize*4,Pm(u,this._levelBounds));for(let S=u;S<m;S+=4){const T=this._indices[S>>2]|0,A=Rm(t,this._boxes[S],this._boxes[S+2]),I=Rm(i,this._boxes[S+1],this._boxes[S+3]),y=A*A+I*I;y>g||(u>=this.numItems*4?c.push(T<<1,y):(s===void 0||s(T))&&c.push((T<<1)+1,y))}for(;c.length&&c.peek()&1;)if(c.peekValue()>g||(f.push(c.pop()>>1),f.length===o))break e;u=c.length?c.pop()>>1:void 0}return c.clear(),f}}function Rm(e,t,i){return e<t?t-e:e<=i?0:e-i}function Pm(e,t){let i=0,o=t.length-1;for(;i<o;){const a=i+o>>1;t[a]>e?o=a:i=a+1}return t[i]}function yf(e,t,i,o,a,s){if(Math.floor(o/s)>=Math.floor(a/s))return;const u=e[o+a>>1];let c=o-1,f=a+1;for(;;){do c++;while(e[c]<u);do f--;while(e[f]>u);if(c>=f)break;iT(e,t,i,c,f)}yf(e,t,i,o,f,s),yf(e,t,i,f+1,a,s)}function iT(e,t,i,o,a){const s=e[o];e[o]=e[a],e[a]=s;const u=4*o,c=4*a,f=t[u],g=t[u+1],m=t[u+2],S=t[u+3];t[u]=t[c],t[u+1]=t[c+1],t[u+2]=t[c+2],t[u+3]=t[c+3],t[c]=f,t[c+1]=g,t[c+2]=m,t[c+3]=S;const T=i[o];i[o]=i[a],i[a]=T}function rT(e,t){let i=e^t,o=65535^i,a=65535^(e|t),s=e&(t^65535),u=i|o>>1,c=i>>1^i,f=a>>1^o&s>>1^a,g=i&a>>1^s>>1^s;i=u,o=c,a=f,s=g,u=i&i>>2^o&o>>2,c=i&o>>2^o&(i^o)>>2,f^=i&a>>2^o&s>>2,g^=o&a>>2^(i^o)&s>>2,i=u,o=c,a=f,s=g,u=i&i>>4^o&o>>4,c=i&o>>4^o&(i^o)>>4,f^=i&a>>4^o&s>>4,g^=o&a>>4^(i^o)&s>>4,i=u,o=c,a=f,s=g,f^=i&a>>8^o&s>>8,g^=o&a>>8^(i^o)&s>>8,i=f^f>>1,o=g^g>>1;let m=e^t,S=o|65535^(m|i);return m=(m|m<<8)&16711935,m=(m|m<<4)&252645135,m=(m|m<<2)&858993459,m=(m|m<<1)&1431655765,S=(S|S<<8)&16711935,S=(S|S<<4)&252645135,S=(S|S<<2)&858993459,S=(S|S<<1)&1431655765,(S<<1|m)>>>0}function yo(e,t){if(e.length===0)return{all:()=>[],byRect:()=>[],byRadius:()=>[],byProperty:()=>[],resetPropertyCache:()=>{},count:()=>0};const i=new Wf(e.length),o=new Map;for(const s of e)i.add(s.position.x,s.position.y,s.position.x,s.position.y);return i.finish(),{all(){return e},byRect(s){return i.search(s.left,s.top,s.right,s.bottom).map(c=>e[c])},byRadius(s,u){return i.neighbors(s.x,s.y,void 0,u).map(f=>e[f])},byProperty(s,u){var c;if(!o.has(s)){const f=new Map;for(const g of e){const m=g[s];f.has(m)||f.set(m,[]),f.get(m).push(g)}o.set(s,f)}return((c=o.get(s))==null?void 0:c.get(u))||[]},resetPropertyCache(){o.clear()},count(){return e.length}}}function Ou(e){const t=Object.values(e.entities.entities),i=t.filter(g=>g.type==="human"),o=t.filter(g=>g.type==="berryBush"),a=t.filter(g=>g.type==="corpse"),s=t.filter(g=>g.type==="prey"),u=t.filter(g=>g.type==="predator"),c=t.filter(g=>g.type==="building");return{...e,search:{human:yo(i),berryBush:yo(o),corpse:yo(a),prey:yo(s),predator:yo(u),building:yo(c)}}}const oT="tribe-game-db",or="save-files",zf="tribe-game-save",Af=1;async function Yf(e){try{const t={version:Af,savedAt:Date.now(),gameState:e},i=JSON.stringify(t),o=await aT(i);await uT(zf,o),console.log(`Game saved successfully. Size: ${(o.size/1024).toFixed(2)} KB`)}catch(t){throw console.error("Failed to save game:",t),t}}async function sT(){try{const e=await cT(zf);if(!e)return null;const t=await lT(e),i=JSON.parse(t);return i.version!==Af?(console.warn(`Save game version mismatch. Expected ${Af}, found ${i.version}. Discarding save.`),await Tf(),null):(console.log("Game loaded successfully."),Ou(i.gameState))}catch(e){return console.error("Failed to load game:",e),await Tf(),null}}async function Tf(){try{await dT(zf),console.log("Saved game cleared.")}catch(e){console.error("Failed to clear saved game:",e)}}async function aT(e){const i=new Blob([e]).stream().pipeThrough(new CompressionStream("gzip"));return await new Response(i).blob()}async function lT(e){const t=e.stream().pipeThrough(new DecompressionStream("gzip"));return await new Response(t).text()}function jf(){return new Promise((e,t)=>{const i=indexedDB.open(oT,1);i.onupgradeneeded=o=>{const a=o.target.result;a.objectStoreNames.contains(or)||a.createObjectStore(or)},i.onsuccess=()=>e(i.result),i.onerror=()=>t(i.error)})}async function uT(e,t){const i=await jf();return new Promise((o,a)=>{const c=i.transaction(or,"readwrite").objectStore(or).put(t,e);c.onsuccess=()=>o(),c.onerror=()=>a(c.error)})}async function cT(e){const t=await jf();return new Promise((i,o)=>{const u=t.transaction(or,"readonly").objectStore(or).get(e);u.onsuccess=()=>i(u.result),u.onerror=()=>o(u.error)})}async function dT(e){const t=await jf();return new Promise((i,o)=>{const u=t.transaction(or,"readwrite").objectStore(or).delete(e);u.onsuccess=()=>i(),u.onerror=()=>o(u.error)})}const nv=Oe.createContext(void 0),fT=({initialAppState:e,children:t})=>{const[i,o]=Oe.useState(e),[a,s]=Oe.useState(void 0),[u,c]=Oe.useState(null),[f,g]=Oe.useState(!1);Oe.useEffect(()=>{sT().then(I=>{I&&c(I),g(!0)})},[]);const m=(I,y)=>{o(I),I==="gameOver"&&y?s(y):I!=="gameOver"&&s(void 0)},S=()=>{o("intro"),s(void 0),A()},T=I=>{Yf(I),c(I)},A=()=>{Tf(),c(null)};return Ue.jsx(nv.Provider,{value:{appState:i,setAppState:m,returnToIntro:S,gameOverDetails:a,contextReady:f,savedGameState:u,setSavedGameState:c,saveCurrentGame:T,clearCurrentSave:A},children:t})},es=()=>{const e=Oe.useContext(nv);if(e===void 0)throw new Error("useGameContext must be used within a GameProvider");return e};var Ht=function(){return Ht=Object.assign||function(t){for(var i,o=1,a=arguments.length;o<a;o++){i=arguments[o];for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&(t[s]=i[s])}return t},Ht.apply(this,arguments)};function ma(e,t,i){if(i||arguments.length===2)for(var o=0,a=t.length,s;o<a;o++)(s||!(o in t))&&(s||(s=Array.prototype.slice.call(t,0,o)),s[o]=t[o]);return e.concat(s||Array.prototype.slice.call(t))}var et="-ms-",sa="-moz-",We="-webkit-",iv="comm",Mu="rule",Vf="decl",hT="@import",rv="@keyframes",gT="@layer",ov=Math.abs,Xf=String.fromCharCode,If=Object.assign;function pT(e,t){return It(e,0)^45?(((t<<2^It(e,0))<<2^It(e,1))<<2^It(e,2))<<2^It(e,3):0}function sv(e){return e.trim()}function pi(e,t){return(e=t.exec(e))?e[0]:e}function Le(e,t,i){return e.replace(t,i)}function fu(e,t,i){return e.indexOf(t,i)}function It(e,t){return e.charCodeAt(t)|0}function Go(e,t,i){return e.slice(t,i)}function ei(e){return e.length}function av(e){return e.length}function ta(e,t){return t.push(e),e}function mT(e,t){return e.map(t).join("")}function Nm(e,t){return e.filter(function(i){return!pi(i,t)})}var ku=1,xo=1,lv=0,En=0,gt=0,ts="";function Fu(e,t,i,o,a,s,u,c){return{value:e,root:t,parent:i,type:o,props:a,children:s,line:ku,column:xo,length:u,return:"",siblings:c}}function Xi(e,t){return If(Fu("",null,null,"",null,null,0,e.siblings),e,{length:-e.length},t)}function Ao(e){for(;e.root;)e=Xi(e.root,{children:[e]});ta(e,e.siblings)}function vT(){return gt}function ST(){return gt=En>0?It(ts,--En):0,xo--,gt===10&&(xo=1,ku--),gt}function Un(){return gt=En<lv?It(ts,En++):0,xo++,gt===10&&(xo=1,ku++),gt}function Fr(){return It(ts,En)}function hu(){return En}function Lu(e,t){return Go(ts,e,t)}function Ef(e){switch(e){case 0:case 9:case 10:case 13:case 32:return 5;case 33:case 43:case 44:case 47:case 62:case 64:case 126:case 59:case 123:case 125:return 4;case 58:return 3;case 34:case 39:case 40:case 91:return 2;case 41:case 93:return 1}return 0}function yT(e){return ku=xo=1,lv=ei(ts=e),En=0,[]}function AT(e){return ts="",e}function xd(e){return sv(Lu(En-1,Cf(e===91?e+2:e===40?e+1:e)))}function TT(e){for(;(gt=Fr())&&gt<33;)Un();return Ef(e)>2||Ef(gt)>3?"":" "}function IT(e,t){for(;--t&&Un()&&!(gt<48||gt>102||gt>57&&gt<65||gt>70&&gt<97););return Lu(e,hu()+(t<6&&Fr()==32&&Un()==32))}function Cf(e){for(;Un();)switch(gt){case e:return En;case 34:case 39:e!==34&&e!==39&&Cf(gt);break;case 40:e===41&&Cf(e);break;case 92:Un();break}return En}function ET(e,t){for(;Un()&&e+gt!==57;)if(e+gt===84&&Fr()===47)break;return"/*"+Lu(t,En-1)+"*"+Xf(e===47?e:Un())}function CT(e){for(;!Ef(Fr());)Un();return Lu(e,En)}function _T(e){return AT(gu("",null,null,null,[""],e=yT(e),0,[0],e))}function gu(e,t,i,o,a,s,u,c,f){for(var g=0,m=0,S=u,T=0,A=0,I=0,y=1,C=1,O=1,F=0,P="",H=a,B=s,U=o,G=P;C;)switch(I=F,F=Un()){case 40:if(I!=108&&It(G,S-1)==58){fu(G+=Le(xd(F),"&","&\f"),"&\f",ov(g?c[g-1]:0))!=-1&&(O=-1);break}case 34:case 39:case 91:G+=xd(F);break;case 9:case 10:case 13:case 32:G+=TT(I);break;case 92:G+=IT(hu()-1,7);continue;case 47:switch(Fr()){case 42:case 47:ta(wT(ET(Un(),hu()),t,i,f),f);break;default:G+="/"}break;case 123*y:c[g++]=ei(G)*O;case 125*y:case 59:case 0:switch(F){case 0:case 125:C=0;case 59+m:O==-1&&(G=Le(G,/\f/g,"")),A>0&&ei(G)-S&&ta(A>32?Om(G+";",o,i,S-1,f):Om(Le(G," ","")+";",o,i,S-2,f),f);break;case 59:G+=";";default:if(ta(U=Dm(G,t,i,g,m,a,c,P,H=[],B=[],S,s),s),F===123)if(m===0)gu(G,t,U,U,H,s,S,c,B);else switch(T===99&&It(G,3)===110?100:T){case 100:case 108:case 109:case 115:gu(e,U,U,o&&ta(Dm(e,U,U,0,0,a,c,P,a,H=[],S,B),B),a,B,S,c,o?H:B);break;default:gu(G,U,U,U,[""],B,0,c,B)}}g=m=A=0,y=O=1,P=G="",S=u;break;case 58:S=1+ei(G),A=I;default:if(y<1){if(F==123)--y;else if(F==125&&y++==0&&ST()==125)continue}switch(G+=Xf(F),F*y){case 38:O=m>0?1:(G+="\f",-1);break;case 44:c[g++]=(ei(G)-1)*O,O=1;break;case 64:Fr()===45&&(G+=xd(Un())),T=Fr(),m=S=ei(P=G+=CT(hu())),F++;break;case 45:I===45&&ei(G)==2&&(y=0)}}return s}function Dm(e,t,i,o,a,s,u,c,f,g,m,S){for(var T=a-1,A=a===0?s:[""],I=av(A),y=0,C=0,O=0;y<o;++y)for(var F=0,P=Go(e,T+1,T=ov(C=u[y])),H=e;F<I;++F)(H=sv(C>0?A[F]+" "+P:Le(P,/&\f/g,A[F])))&&(f[O++]=H);return Fu(e,t,i,a===0?Mu:c,f,g,m,S)}function wT(e,t,i,o){return Fu(e,t,i,iv,Xf(vT()),Go(e,2,-2),0,o)}function Om(e,t,i,o,a){return Fu(e,t,i,Vf,Go(e,0,o),Go(e,o+1,-1),o,a)}function uv(e,t,i){switch(pT(e,t)){case 5103:return We+"print-"+e+e;case 5737:case 4201:case 3177:case 3433:case 1641:case 4457:case 2921:case 5572:case 6356:case 5844:case 3191:case 6645:case 3005:case 6391:case 5879:case 5623:case 6135:case 4599:case 4855:case 4215:case 6389:case 5109:case 5365:case 5621:case 3829:return We+e+e;case 4789:return sa+e+e;case 5349:case 4246:case 4810:case 6968:case 2756:return We+e+sa+e+et+e+e;case 5936:switch(It(e,t+11)){case 114:return We+e+et+Le(e,/[svh]\w+-[tblr]{2}/,"tb")+e;case 108:return We+e+et+Le(e,/[svh]\w+-[tblr]{2}/,"tb-rl")+e;case 45:return We+e+et+Le(e,/[svh]\w+-[tblr]{2}/,"lr")+e}case 6828:case 4268:case 2903:return We+e+et+e+e;case 6165:return We+e+et+"flex-"+e+e;case 5187:return We+e+Le(e,/(\w+).+(:[^]+)/,We+"box-$1$2"+et+"flex-$1$2")+e;case 5443:return We+e+et+"flex-item-"+Le(e,/flex-|-self/g,"")+(pi(e,/flex-|baseline/)?"":et+"grid-row-"+Le(e,/flex-|-self/g,""))+e;case 4675:return We+e+et+"flex-line-pack"+Le(e,/align-content|flex-|-self/g,"")+e;case 5548:return We+e+et+Le(e,"shrink","negative")+e;case 5292:return We+e+et+Le(e,"basis","preferred-size")+e;case 6060:return We+"box-"+Le(e,"-grow","")+We+e+et+Le(e,"grow","positive")+e;case 4554:return We+Le(e,/([^-])(transform)/g,"$1"+We+"$2")+e;case 6187:return Le(Le(Le(e,/(zoom-|grab)/,We+"$1"),/(image-set)/,We+"$1"),e,"")+e;case 5495:case 3959:return Le(e,/(image-set\([^]*)/,We+"$1$`$1");case 4968:return Le(Le(e,/(.+:)(flex-)?(.*)/,We+"box-pack:$3"+et+"flex-pack:$3"),/s.+-b[^;]+/,"justify")+We+e+e;case 4200:if(!pi(e,/flex-|baseline/))return et+"grid-column-align"+Go(e,t)+e;break;case 2592:case 3360:return et+Le(e,"template-","")+e;case 4384:case 3616:return i&&i.some(function(o,a){return t=a,pi(o.props,/grid-\w+-end/)})?~fu(e+(i=i[t].value),"span",0)?e:et+Le(e,"-start","")+e+et+"grid-row-span:"+(~fu(i,"span",0)?pi(i,/\d+/):+pi(i,/\d+/)-+pi(e,/\d+/))+";":et+Le(e,"-start","")+e;case 4896:case 4128:return i&&i.some(function(o){return pi(o.props,/grid-\w+-start/)})?e:et+Le(Le(e,"-end","-span"),"span ","")+e;case 4095:case 3583:case 4068:case 2532:return Le(e,/(.+)-inline(.+)/,We+"$1$2")+e;case 8116:case 7059:case 5753:case 5535:case 5445:case 5701:case 4933:case 4677:case 5533:case 5789:case 5021:case 4765:if(ei(e)-1-t>6)switch(It(e,t+1)){case 109:if(It(e,t+4)!==45)break;case 102:return Le(e,/(.+:)(.+)-([^]+)/,"$1"+We+"$2-$3$1"+sa+(It(e,t+3)==108?"$3":"$2-$3"))+e;case 115:return~fu(e,"stretch",0)?uv(Le(e,"stretch","fill-available"),t,i)+e:e}break;case 5152:case 5920:return Le(e,/(.+?):(\d+)(\s*\/\s*(span)?\s*(\d+))?(.*)/,function(o,a,s,u,c,f,g){return et+a+":"+s+g+(u?et+a+"-span:"+(c?f:+f-+s)+g:"")+e});case 4949:if(It(e,t+6)===121)return Le(e,":",":"+We)+e;break;case 6444:switch(It(e,It(e,14)===45?18:11)){case 120:return Le(e,/(.+:)([^;\s!]+)(;|(\s+)?!.+)?/,"$1"+We+(It(e,14)===45?"inline-":"")+"box$3$1"+We+"$2$3$1"+et+"$2box$3")+e;case 100:return Le(e,":",":"+et)+e}break;case 5719:case 2647:case 2135:case 3927:case 2391:return Le(e,"scroll-","scroll-snap-")+e}return e}function Au(e,t){for(var i="",o=0;o<e.length;o++)i+=t(e[o],o,e,t)||"";return i}function RT(e,t,i,o){switch(e.type){case gT:if(e.children.length)break;case hT:case Vf:return e.return=e.return||e.value;case iv:return"";case rv:return e.return=e.value+"{"+Au(e.children,o)+"}";case Mu:if(!ei(e.value=e.props.join(",")))return""}return ei(i=Au(e.children,o))?e.return=e.value+"{"+i+"}":""}function PT(e){var t=av(e);return function(i,o,a,s){for(var u="",c=0;c<t;c++)u+=e[c](i,o,a,s)||"";return u}}function NT(e){return function(t){t.root||(t=t.return)&&e(t)}}function DT(e,t,i,o){if(e.length>-1&&!e.return)switch(e.type){case Vf:e.return=uv(e.value,e.length,i);return;case rv:return Au([Xi(e,{value:Le(e.value,"@","@"+We)})],o);case Mu:if(e.length)return mT(i=e.props,function(a){switch(pi(a,o=/(::plac\w+|:read-\w+)/)){case":read-only":case":read-write":Ao(Xi(e,{props:[Le(a,/:(read-\w+)/,":"+sa+"$1")]})),Ao(Xi(e,{props:[a]})),If(e,{props:Nm(i,o)});break;case"::placeholder":Ao(Xi(e,{props:[Le(a,/:(plac\w+)/,":"+We+"input-$1")]})),Ao(Xi(e,{props:[Le(a,/:(plac\w+)/,":"+sa+"$1")]})),Ao(Xi(e,{props:[Le(a,/:(plac\w+)/,et+"input-$1")]})),Ao(Xi(e,{props:[a]})),If(e,{props:Nm(i,o)});break}return""})}}var OT={animationIterationCount:1,aspectRatio:1,borderImageOutset:1,borderImageSlice:1,borderImageWidth:1,boxFlex:1,boxFlexGroup:1,boxOrdinalGroup:1,columnCount:1,columns:1,flex:1,flexGrow:1,flexPositive:1,flexShrink:1,flexNegative:1,flexOrder:1,gridRow:1,gridRowEnd:1,gridRowSpan:1,gridRowStart:1,gridColumn:1,gridColumnEnd:1,gridColumnSpan:1,gridColumnStart:1,msGridRow:1,msGridRowSpan:1,msGridColumn:1,msGridColumnSpan:1,fontWeight:1,lineHeight:1,opacity:1,order:1,orphans:1,tabSize:1,widows:1,zIndex:1,zoom:1,WebkitLineClamp:1,fillOpacity:1,floodOpacity:1,stopOpacity:1,strokeDasharray:1,strokeDashoffset:1,strokeMiterlimit:1,strokeOpacity:1,strokeWidth:1},un={},$o=typeof process<"u"&&un!==void 0&&(un.REACT_APP_SC_ATTR||un.SC_ATTR)||"data-styled",cv="active",dv="data-styled-version",Uu="6.1.13",Kf=`/*!sc*/
`,Tu=typeof window<"u"&&"HTMLElement"in window,MT=!!(typeof SC_DISABLE_SPEEDY=="boolean"?SC_DISABLE_SPEEDY:typeof process<"u"&&un!==void 0&&un.REACT_APP_SC_DISABLE_SPEEDY!==void 0&&un.REACT_APP_SC_DISABLE_SPEEDY!==""?un.REACT_APP_SC_DISABLE_SPEEDY!=="false"&&un.REACT_APP_SC_DISABLE_SPEEDY:typeof process<"u"&&un!==void 0&&un.SC_DISABLE_SPEEDY!==void 0&&un.SC_DISABLE_SPEEDY!==""&&un.SC_DISABLE_SPEEDY!=="false"&&un.SC_DISABLE_SPEEDY),kT={},Bu=Object.freeze([]),Wo=Object.freeze({});function fv(e,t,i){return i===void 0&&(i=Wo),e.theme!==i.theme&&e.theme||t||i.theme}var hv=new Set(["a","abbr","address","area","article","aside","audio","b","base","bdi","bdo","big","blockquote","body","br","button","canvas","caption","cite","code","col","colgroup","data","datalist","dd","del","details","dfn","dialog","div","dl","dt","em","embed","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","header","hgroup","hr","html","i","iframe","img","input","ins","kbd","keygen","label","legend","li","link","main","map","mark","menu","menuitem","meta","meter","nav","noscript","object","ol","optgroup","option","output","p","param","picture","pre","progress","q","rp","rt","ruby","s","samp","script","section","select","small","source","span","strong","style","sub","summary","sup","table","tbody","td","textarea","tfoot","th","thead","time","tr","track","u","ul","use","var","video","wbr","circle","clipPath","defs","ellipse","foreignObject","g","image","line","linearGradient","marker","mask","path","pattern","polygon","polyline","radialGradient","rect","stop","svg","text","tspan"]),FT=/[!"#$%&'()*+,./:;<=>?@[\\\]^`{|}~-]+/g,LT=/(^-|-$)/g;function Mm(e){return e.replace(FT,"-").replace(LT,"")}var UT=/(a)(d)/gi,Wl=52,km=function(e){return String.fromCharCode(e+(e>25?39:97))};function _f(e){var t,i="";for(t=Math.abs(e);t>Wl;t=t/Wl|0)i=km(t%Wl)+i;return(km(t%Wl)+i).replace(UT,"$1-$2")}var $d,gv=5381,Mo=function(e,t){for(var i=t.length;i;)e=33*e^t.charCodeAt(--i);return e},pv=function(e){return Mo(gv,e)};function mv(e){return _f(pv(e)>>>0)}function BT(e){return e.displayName||e.name||"Component"}function Wd(e){return typeof e=="string"&&!0}var vv=typeof Symbol=="function"&&Symbol.for,Sv=vv?Symbol.for("react.memo"):60115,HT=vv?Symbol.for("react.forward_ref"):60112,bT={childContextTypes:!0,contextType:!0,contextTypes:!0,defaultProps:!0,displayName:!0,getDefaultProps:!0,getDerivedStateFromError:!0,getDerivedStateFromProps:!0,mixins:!0,propTypes:!0,type:!0},GT={name:!0,length:!0,prototype:!0,caller:!0,callee:!0,arguments:!0,arity:!0},yv={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},xT=(($d={})[HT]={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},$d[Sv]=yv,$d);function Fm(e){return("type"in(t=e)&&t.type.$$typeof)===Sv?yv:"$$typeof"in e?xT[e.$$typeof]:bT;var t}var $T=Object.defineProperty,WT=Object.getOwnPropertyNames,Lm=Object.getOwnPropertySymbols,zT=Object.getOwnPropertyDescriptor,YT=Object.getPrototypeOf,Um=Object.prototype;function Av(e,t,i){if(typeof t!="string"){if(Um){var o=YT(t);o&&o!==Um&&Av(e,o,i)}var a=WT(t);Lm&&(a=a.concat(Lm(t)));for(var s=Fm(e),u=Fm(t),c=0;c<a.length;++c){var f=a[c];if(!(f in GT||i&&i[f]||u&&f in u||s&&f in s)){var g=zT(t,f);try{$T(e,f,g)}catch{}}}}return e}function zo(e){return typeof e=="function"}function Zf(e){return typeof e=="object"&&"styledComponentId"in e}function Mr(e,t){return e&&t?"".concat(e," ").concat(t):e||t||""}function wf(e,t){if(e.length===0)return"";for(var i=e[0],o=1;o<e.length;o++)i+=e[o];return i}function va(e){return e!==null&&typeof e=="object"&&e.constructor.name===Object.name&&!("props"in e&&e.$$typeof)}function Rf(e,t,i){if(i===void 0&&(i=!1),!i&&!va(e)&&!Array.isArray(e))return t;if(Array.isArray(t))for(var o=0;o<t.length;o++)e[o]=Rf(e[o],t[o]);else if(va(t))for(var o in t)e[o]=Rf(e[o],t[o]);return e}function qf(e,t){Object.defineProperty(e,"toString",{value:t})}function Pa(e){for(var t=[],i=1;i<arguments.length;i++)t[i-1]=arguments[i];return new Error("An error occurred. See https://github.com/styled-components/styled-components/blob/main/packages/styled-components/src/utils/errors.md#".concat(e," for more information.").concat(t.length>0?" Args: ".concat(t.join(", ")):""))}var jT=function(){function e(t){this.groupSizes=new Uint32Array(512),this.length=512,this.tag=t}return e.prototype.indexOfGroup=function(t){for(var i=0,o=0;o<t;o++)i+=this.groupSizes[o];return i},e.prototype.insertRules=function(t,i){if(t>=this.groupSizes.length){for(var o=this.groupSizes,a=o.length,s=a;t>=s;)if((s<<=1)<0)throw Pa(16,"".concat(t));this.groupSizes=new Uint32Array(s),this.groupSizes.set(o),this.length=s;for(var u=a;u<s;u++)this.groupSizes[u]=0}for(var c=this.indexOfGroup(t+1),f=(u=0,i.length);u<f;u++)this.tag.insertRule(c,i[u])&&(this.groupSizes[t]++,c++)},e.prototype.clearGroup=function(t){if(t<this.length){var i=this.groupSizes[t],o=this.indexOfGroup(t),a=o+i;this.groupSizes[t]=0;for(var s=o;s<a;s++)this.tag.deleteRule(o)}},e.prototype.getGroup=function(t){var i="";if(t>=this.length||this.groupSizes[t]===0)return i;for(var o=this.groupSizes[t],a=this.indexOfGroup(t),s=a+o,u=a;u<s;u++)i+="".concat(this.tag.getRule(u)).concat(Kf);return i},e}(),pu=new Map,Iu=new Map,mu=1,zl=function(e){if(pu.has(e))return pu.get(e);for(;Iu.has(mu);)mu++;var t=mu++;return pu.set(e,t),Iu.set(t,e),t},VT=function(e,t){mu=t+1,pu.set(e,t),Iu.set(t,e)},XT="style[".concat($o,"][").concat(dv,'="').concat(Uu,'"]'),KT=new RegExp("^".concat($o,'\\.g(\\d+)\\[id="([\\w\\d-]+)"\\].*?"([^"]*)')),ZT=function(e,t,i){for(var o,a=i.split(","),s=0,u=a.length;s<u;s++)(o=a[s])&&e.registerName(t,o)},qT=function(e,t){for(var i,o=((i=t.textContent)!==null&&i!==void 0?i:"").split(Kf),a=[],s=0,u=o.length;s<u;s++){var c=o[s].trim();if(c){var f=c.match(KT);if(f){var g=0|parseInt(f[1],10),m=f[2];g!==0&&(VT(m,g),ZT(e,m,f[3]),e.getTag().insertRules(g,a)),a.length=0}else a.push(c)}}},Bm=function(e){for(var t=document.querySelectorAll(XT),i=0,o=t.length;i<o;i++){var a=t[i];a&&a.getAttribute($o)!==cv&&(qT(e,a),a.parentNode&&a.parentNode.removeChild(a))}};function QT(){return typeof __webpack_nonce__<"u"?__webpack_nonce__:null}var Tv=function(e){var t=document.head,i=e||t,o=document.createElement("style"),a=function(c){var f=Array.from(c.querySelectorAll("style[".concat($o,"]")));return f[f.length-1]}(i),s=a!==void 0?a.nextSibling:null;o.setAttribute($o,cv),o.setAttribute(dv,Uu);var u=QT();return u&&o.setAttribute("nonce",u),i.insertBefore(o,s),o},JT=function(){function e(t){this.element=Tv(t),this.element.appendChild(document.createTextNode("")),this.sheet=function(i){if(i.sheet)return i.sheet;for(var o=document.styleSheets,a=0,s=o.length;a<s;a++){var u=o[a];if(u.ownerNode===i)return u}throw Pa(17)}(this.element),this.length=0}return e.prototype.insertRule=function(t,i){try{return this.sheet.insertRule(i,t),this.length++,!0}catch{return!1}},e.prototype.deleteRule=function(t){this.sheet.deleteRule(t),this.length--},e.prototype.getRule=function(t){var i=this.sheet.cssRules[t];return i&&i.cssText?i.cssText:""},e}(),eI=function(){function e(t){this.element=Tv(t),this.nodes=this.element.childNodes,this.length=0}return e.prototype.insertRule=function(t,i){if(t<=this.length&&t>=0){var o=document.createTextNode(i);return this.element.insertBefore(o,this.nodes[t]||null),this.length++,!0}return!1},e.prototype.deleteRule=function(t){this.element.removeChild(this.nodes[t]),this.length--},e.prototype.getRule=function(t){return t<this.length?this.nodes[t].textContent:""},e}(),tI=function(){function e(t){this.rules=[],this.length=0}return e.prototype.insertRule=function(t,i){return t<=this.length&&(this.rules.splice(t,0,i),this.length++,!0)},e.prototype.deleteRule=function(t){this.rules.splice(t,1),this.length--},e.prototype.getRule=function(t){return t<this.length?this.rules[t]:""},e}(),Hm=Tu,nI={isServer:!Tu,useCSSOMInjection:!MT},Eu=function(){function e(t,i,o){t===void 0&&(t=Wo),i===void 0&&(i={});var a=this;this.options=Ht(Ht({},nI),t),this.gs=i,this.names=new Map(o),this.server=!!t.isServer,!this.server&&Tu&&Hm&&(Hm=!1,Bm(this)),qf(this,function(){return function(s){for(var u=s.getTag(),c=u.length,f="",g=function(S){var T=function(O){return Iu.get(O)}(S);if(T===void 0)return"continue";var A=s.names.get(T),I=u.getGroup(S);if(A===void 0||!A.size||I.length===0)return"continue";var y="".concat($o,".g").concat(S,'[id="').concat(T,'"]'),C="";A!==void 0&&A.forEach(function(O){O.length>0&&(C+="".concat(O,","))}),f+="".concat(I).concat(y,'{content:"').concat(C,'"}').concat(Kf)},m=0;m<c;m++)g(m);return f}(a)})}return e.registerId=function(t){return zl(t)},e.prototype.rehydrate=function(){!this.server&&Tu&&Bm(this)},e.prototype.reconstructWithOptions=function(t,i){return i===void 0&&(i=!0),new e(Ht(Ht({},this.options),t),this.gs,i&&this.names||void 0)},e.prototype.allocateGSInstance=function(t){return this.gs[t]=(this.gs[t]||0)+1},e.prototype.getTag=function(){return this.tag||(this.tag=(t=function(i){var o=i.useCSSOMInjection,a=i.target;return i.isServer?new tI(a):o?new JT(a):new eI(a)}(this.options),new jT(t)));var t},e.prototype.hasNameForId=function(t,i){return this.names.has(t)&&this.names.get(t).has(i)},e.prototype.registerName=function(t,i){if(zl(t),this.names.has(t))this.names.get(t).add(i);else{var o=new Set;o.add(i),this.names.set(t,o)}},e.prototype.insertRules=function(t,i,o){this.registerName(t,i),this.getTag().insertRules(zl(t),o)},e.prototype.clearNames=function(t){this.names.has(t)&&this.names.get(t).clear()},e.prototype.clearRules=function(t){this.getTag().clearGroup(zl(t)),this.clearNames(t)},e.prototype.clearTag=function(){this.tag=void 0},e}(),iI=/&/g,rI=/^\s*\/\/.*$/gm;function Iv(e,t){return e.map(function(i){return i.type==="rule"&&(i.value="".concat(t," ").concat(i.value),i.value=i.value.replaceAll(",",",".concat(t," ")),i.props=i.props.map(function(o){return"".concat(t," ").concat(o)})),Array.isArray(i.children)&&i.type!=="@keyframes"&&(i.children=Iv(i.children,t)),i})}function oI(e){var t,i,o,a=Wo,s=a.options,u=s===void 0?Wo:s,c=a.plugins,f=c===void 0?Bu:c,g=function(T,A,I){return I.startsWith(i)&&I.endsWith(i)&&I.replaceAll(i,"").length>0?".".concat(t):T},m=f.slice();m.push(function(T){T.type===Mu&&T.value.includes("&")&&(T.props[0]=T.props[0].replace(iI,i).replace(o,g))}),u.prefix&&m.push(DT),m.push(RT);var S=function(T,A,I,y){A===void 0&&(A=""),I===void 0&&(I=""),y===void 0&&(y="&"),t=y,i=A,o=new RegExp("\\".concat(i,"\\b"),"g");var C=T.replace(rI,""),O=_T(I||A?"".concat(I," ").concat(A," { ").concat(C," }"):C);u.namespace&&(O=Iv(O,u.namespace));var F=[];return Au(O,PT(m.concat(NT(function(P){return F.push(P)})))),F};return S.hash=f.length?f.reduce(function(T,A){return A.name||Pa(15),Mo(T,A.name)},gv).toString():"",S}var sI=new Eu,Pf=oI(),Ev=ti.createContext({shouldForwardProp:void 0,styleSheet:sI,stylis:Pf});Ev.Consumer;ti.createContext(void 0);function Nf(){return Oe.useContext(Ev)}var aI=function(){function e(t,i){var o=this;this.inject=function(a,s){s===void 0&&(s=Pf);var u=o.name+s.hash;a.hasNameForId(o.id,u)||a.insertRules(o.id,u,s(o.rules,u,"@keyframes"))},this.name=t,this.id="sc-keyframes-".concat(t),this.rules=i,qf(this,function(){throw Pa(12,String(o.name))})}return e.prototype.getName=function(t){return t===void 0&&(t=Pf),this.name+t.hash},e}(),lI=function(e){return e>="A"&&e<="Z"};function bm(e){for(var t="",i=0;i<e.length;i++){var o=e[i];if(i===1&&o==="-"&&e[0]==="-")return e;lI(o)?t+="-"+o.toLowerCase():t+=o}return t.startsWith("ms-")?"-"+t:t}var Cv=function(e){return e==null||e===!1||e===""},_v=function(e){var t,i,o=[];for(var a in e){var s=e[a];e.hasOwnProperty(a)&&!Cv(s)&&(Array.isArray(s)&&s.isCss||zo(s)?o.push("".concat(bm(a),":"),s,";"):va(s)?o.push.apply(o,ma(ma(["".concat(a," {")],_v(s),!1),["}"],!1)):o.push("".concat(bm(a),": ").concat((t=a,(i=s)==null||typeof i=="boolean"||i===""?"":typeof i!="number"||i===0||t in OT||t.startsWith("--")?String(i).trim():"".concat(i,"px")),";")))}return o};function ir(e,t,i,o){if(Cv(e))return[];if(Zf(e))return[".".concat(e.styledComponentId)];if(zo(e)){if(!zo(s=e)||s.prototype&&s.prototype.isReactComponent||!t)return[e];var a=e(t);return ir(a,t,i,o)}var s;return e instanceof aI?i?(e.inject(i,o),[e.getName(o)]):[e]:va(e)?_v(e):Array.isArray(e)?Array.prototype.concat.apply(Bu,e.map(function(u){return ir(u,t,i,o)})):[e.toString()]}function wv(e){for(var t=0;t<e.length;t+=1){var i=e[t];if(zo(i)&&!Zf(i))return!1}return!0}var uI=pv(Uu),cI=function(){function e(t,i,o){this.rules=t,this.staticRulesId="",this.isStatic=(o===void 0||o.isStatic)&&wv(t),this.componentId=i,this.baseHash=Mo(uI,i),this.baseStyle=o,Eu.registerId(i)}return e.prototype.generateAndInjectStyles=function(t,i,o){var a=this.baseStyle?this.baseStyle.generateAndInjectStyles(t,i,o):"";if(this.isStatic&&!o.hash)if(this.staticRulesId&&i.hasNameForId(this.componentId,this.staticRulesId))a=Mr(a,this.staticRulesId);else{var s=wf(ir(this.rules,t,i,o)),u=_f(Mo(this.baseHash,s)>>>0);if(!i.hasNameForId(this.componentId,u)){var c=o(s,".".concat(u),void 0,this.componentId);i.insertRules(this.componentId,u,c)}a=Mr(a,u),this.staticRulesId=u}else{for(var f=Mo(this.baseHash,o.hash),g="",m=0;m<this.rules.length;m++){var S=this.rules[m];if(typeof S=="string")g+=S;else if(S){var T=wf(ir(S,t,i,o));f=Mo(f,T+m),g+=T}}if(g){var A=_f(f>>>0);i.hasNameForId(this.componentId,A)||i.insertRules(this.componentId,A,o(g,".".concat(A),void 0,this.componentId)),a=Mr(a,A)}}return a},e}(),Qf=ti.createContext(void 0);Qf.Consumer;var zd={};function dI(e,t,i){var o=Zf(e),a=e,s=!Wd(e),u=t.attrs,c=u===void 0?Bu:u,f=t.componentId,g=f===void 0?function(H,B){var U=typeof H!="string"?"sc":Mm(H);zd[U]=(zd[U]||0)+1;var G="".concat(U,"-").concat(mv(Uu+U+zd[U]));return B?"".concat(B,"-").concat(G):G}(t.displayName,t.parentComponentId):f,m=t.displayName,S=m===void 0?function(H){return Wd(H)?"styled.".concat(H):"Styled(".concat(BT(H),")")}(e):m,T=t.displayName&&t.componentId?"".concat(Mm(t.displayName),"-").concat(t.componentId):t.componentId||g,A=o&&a.attrs?a.attrs.concat(c).filter(Boolean):c,I=t.shouldForwardProp;if(o&&a.shouldForwardProp){var y=a.shouldForwardProp;if(t.shouldForwardProp){var C=t.shouldForwardProp;I=function(H,B){return y(H,B)&&C(H,B)}}else I=y}var O=new cI(i,T,o?a.componentStyle:void 0);function F(H,B){return function(U,G,Z){var te=U.attrs,ve=U.componentStyle,be=U.defaultProps,De=U.foldedComponentIds,Ie=U.styledComponentId,he=U.target,Fe=ti.useContext(Qf),Se=Nf(),ne=U.shouldForwardProp||Se.shouldForwardProp,z=fv(G,Fe,be)||Wo,X=function(pe,ae,Re){for(var Ce,q=Ht(Ht({},ae),{className:void 0,theme:Re}),le=0;le<pe.length;le+=1){var Be=zo(Ce=pe[le])?Ce(q):Ce;for(var ye in Be)q[ye]=ye==="className"?Mr(q[ye],Be[ye]):ye==="style"?Ht(Ht({},q[ye]),Be[ye]):Be[ye]}return ae.className&&(q.className=Mr(q.className,ae.className)),q}(te,G,z),Y=X.as||he,N={};for(var b in X)X[b]===void 0||b[0]==="$"||b==="as"||b==="theme"&&X.theme===z||(b==="forwardedAs"?N.as=X.forwardedAs:ne&&!ne(b,Y)||(N[b]=X[b]));var K=function(pe,ae){var Re=Nf(),Ce=pe.generateAndInjectStyles(ae,Re.styleSheet,Re.stylis);return Ce}(ve,X),J=Mr(De,Ie);return K&&(J+=" "+K),X.className&&(J+=" "+X.className),N[Wd(Y)&&!hv.has(Y)?"class":"className"]=J,N.ref=Z,Oe.createElement(Y,N)}(P,H,B)}F.displayName=S;var P=ti.forwardRef(F);return P.attrs=A,P.componentStyle=O,P.displayName=S,P.shouldForwardProp=I,P.foldedComponentIds=o?Mr(a.foldedComponentIds,a.styledComponentId):"",P.styledComponentId=T,P.target=o?a.target:e,Object.defineProperty(P,"defaultProps",{get:function(){return this._foldedDefaultProps},set:function(H){this._foldedDefaultProps=o?function(B){for(var U=[],G=1;G<arguments.length;G++)U[G-1]=arguments[G];for(var Z=0,te=U;Z<te.length;Z++)Rf(B,te[Z],!0);return B}({},a.defaultProps,H):H}}),qf(P,function(){return".".concat(P.styledComponentId)}),s&&Av(P,e,{attrs:!0,componentStyle:!0,displayName:!0,foldedComponentIds:!0,shouldForwardProp:!0,styledComponentId:!0,target:!0}),P}function Gm(e,t){for(var i=[e[0]],o=0,a=t.length;o<a;o+=1)i.push(t[o],e[o+1]);return i}var xm=function(e){return Object.assign(e,{isCss:!0})};function Rv(e){for(var t=[],i=1;i<arguments.length;i++)t[i-1]=arguments[i];if(zo(e)||va(e))return xm(ir(Gm(Bu,ma([e],t,!0))));var o=e;return t.length===0&&o.length===1&&typeof o[0]=="string"?ir(o):xm(ir(Gm(o,t)))}function Df(e,t,i){if(i===void 0&&(i=Wo),!t)throw Pa(1,t);var o=function(a){for(var s=[],u=1;u<arguments.length;u++)s[u-1]=arguments[u];return e(t,i,Rv.apply(void 0,ma([a],s,!1)))};return o.attrs=function(a){return Df(e,t,Ht(Ht({},i),{attrs:Array.prototype.concat(i.attrs,a).filter(Boolean)}))},o.withConfig=function(a){return Df(e,t,Ht(Ht({},i),a))},o}var Pv=function(e){return Df(dI,e)},_n=Pv;hv.forEach(function(e){_n[e]=Pv(e)});var fI=function(){function e(t,i){this.rules=t,this.componentId=i,this.isStatic=wv(t),Eu.registerId(this.componentId+1)}return e.prototype.createStyles=function(t,i,o,a){var s=a(wf(ir(this.rules,i,o,a)),""),u=this.componentId+t;o.insertRules(u,u,s)},e.prototype.removeStyles=function(t,i){i.clearRules(this.componentId+t)},e.prototype.renderStyles=function(t,i,o,a){t>2&&Eu.registerId(this.componentId+t),this.removeStyles(t,o),this.createStyles(t,i,o,a)},e}();function hI(e){for(var t=[],i=1;i<arguments.length;i++)t[i-1]=arguments[i];var o=Rv.apply(void 0,ma([e],t,!1)),a="sc-global-".concat(mv(JSON.stringify(o))),s=new fI(o,a),u=function(f){var g=Nf(),m=ti.useContext(Qf),S=ti.useRef(g.styleSheet.allocateGSInstance(a)).current;return g.styleSheet.server&&c(S,f,g.styleSheet,m,g.stylis),ti.useLayoutEffect(function(){if(!g.styleSheet.server)return c(S,f,g.styleSheet,m,g.stylis),function(){return s.removeStyles(S,g.styleSheet)}},[S,f,g.styleSheet,m,g.stylis]),null};function c(f,g,m,S,T){if(s.isStatic)s.renderStyles(f,kT,m,T);else{var A=Ht(Ht({},g),{theme:fv(g,S,u.defaultProps)});s.renderStyles(f,A,m,T)}}return ti.memo(u)}function Nv(e,t){var i=Oe.useRef(null),o=Oe.useRef(!1),a=Oe.useRef(e);a.current=e;var s=Oe.useCallback(function(c){o.current&&(a.current(c),i.current=requestAnimationFrame(s))},[]),u=Oe.useMemo(function(){return[function(){o.current&&(o.current=!1,i.current&&cancelAnimationFrame(i.current))},function(){o.current||(o.current=!0,i.current=requestAnimationFrame(s))},function(){return o.current}]},[]);return Oe.useEffect(function(){return u[0]},[]),u}function gI(e,t,i,o,a){var u;(u=e.onExit)==null||u.call(e,o,t);const s=a.find(({id:c})=>c===t);return s!=null&&s.onEnter?s.onEnter(o,i):{...i,enteredAt:o.updateContext.gameState.time}}function pI(e,t){return t.find(({id:i})=>i===e)}function mI(e,t){return e!==t}function vI(e){console.warn(`No handler found for state: ${e}`)}const aa="bushGrowing",Or="bushFull",vu="bushSpreading",Sa="bushDying",Ct=24,_t=10,Ke=4e3,tt=4e3,Jf=2,SI=15,yI=5e3,Si=100,yi=20,Ai=60,AI=1e3,TI=5,II=3,EI=12,CI=940,Of=20,$m=90,Dv=45,xr=5,_I=.5,$r=30,Ti=.1,na=.9;var Hn=(e=>(e.Berry="berry",e.Meat="meat",e))(Hn||{});const eh={berry:"",meat:""},wI={id:aa,update:(e,t)=>{const{entity:i,updateContext:o}=t,a=o.deltaTime*(Ct/_t);return i.age+=a,i.age>=i.lifespan?{nextState:Sa,data:{...e,enteredAt:o.gameState.time}}:(i.timeSinceLastBerryRegen+=a,i.timeSinceLastBerryRegen>=EI&&i.food.length<i.maxFood&&(i.food.push({type:Hn.Berry}),i.timeSinceLastBerryRegen=0),i.food.length>=i.maxFood?{nextState:Or,data:{...e,enteredAt:o.gameState.time,previousState:aa}}:{nextState:aa,data:e})},onEnter:(e,t)=>({...t,enteredAt:e.updateContext.gameState.time})},RI={id:Or,update:(e,t)=>{const{entity:i,updateContext:o}=t,a=o.deltaTime*(Ct/_t);return i.age+=a,i.age>=i.lifespan?{nextState:Sa,data:{...e,enteredAt:o.gameState.time,previousState:Or}}:i.food.length<i.maxFood?{nextState:aa,data:{...e,enteredAt:o.gameState.time,previousState:Or}}:(i.timeSinceLastSpreadAttempt+=a,i.timeSinceLastSpreadAttempt>=$m&&(i.timeSinceLastSpreadAttempt=0,o.gameState.time-i.timeSinceLastHarvest>=$m&&Math.random()<o.gameState.ecosystem.berryBushSpreadChance)?{nextState:vu,data:{...e,enteredAt:o.gameState.time,previousState:Or}}:{nextState:Or,data:e})},onEnter:(e,t)=>({...t,enteredAt:e.updateContext.gameState.time})},ya=1,Mf=150*.6,PI=150*.25,NI=150*.7,DI=150*.8,OI=400,MI=800,Ov=300,kI=350,FI=120,LI=2,Wm=400,UI=1e3,BI=150*.85,HI=100,bI=3,GI=24,Mv=600,xI=1,$I=1,WI=.5,zI=2,kf=24,la=12,YI=24,zm=24,jI=1500,Yd=500,VI=400,XI=10,KI=-5,ZI=1.5,qI=1.5,QI=1.2,JI=10,eE=150,tE=200,nE=100,iE=.7,rE=300,oE=100,sE=120,Ym=600,kv=.15,Fv=200,Su=30*.75*1.2,aE=20,lE=.3,uE=.6,cE=.8,dE=1,fE=3,hE=5,gE=6,jm=.5,pE=.4,mE=.6,vE=.8,SE=2,Yl=Ke/2,Vm=60,Xm=2,Km=.7,Zm=.2,qm=5,Qm=50,yE=.1,Jm=400,AE=800,Lv=5,Uv=600,Hu=10,Aa=80,TE=3,js=5,Wr=150,Bv=Wr*.8,IE=Wr*.2,zr=Wr*.95,sr=30,Hv=10,EE=10,CE=.5,St=30,Yo=St*.75,bv=50,_E=20,wE=Aa*.8,RE=.7,PE=16,Gv=40,NE=24,th=16,DE=72/3,e0=24,OE=1.25,ME=1.5,nh=Wr*.6,ih=50,kE=1,FE=350,rh=Aa*.65,LE=80,UE=50,BE=1,HE=128,xv=10,t0=100,oh=35,ii=St,$v=.5,bu=2.5,bE=5,sh=.5,ah=1.5,GE=.1,xE=.5,$E=1.5,WE=.25,zE=2.5,YE=45,jE=.05;function Bn(e,t){return{x:e.x+t.x,y:e.y+t.y}}function Wv(e,t){return{x:e.x-t.x,y:e.y-t.y}}function Ot(e,t){return{x:e.x*t,y:e.y*t}}function jo(e){return Math.sqrt(e.x*e.x+e.y*e.y)}function lt(e){const t=jo(e);return t===0?{x:0,y:0}:Ot(e,1/t)}function VE(e,t){return jo(Wv(e,t))}function lh(e,t,i){return{x:e.x+(t.x-e.x)*i,y:e.y+(t.y-e.y)*i}}function Cu(e){if(e.length===0)return{x:0,y:0};const t=e.reduce((i,o)=>({x:i.x+o.x,y:i.y+o.y}),{x:0,y:0});return{x:t.x/e.length,y:t.y/e.length}}function Ye(e,t,i,o){let a=t.x-e.x,s=t.y-e.y;return Math.abs(a)>i/2&&(a=a-Math.sign(a)*i),Math.abs(s)>o/2&&(s=s-Math.sign(s)*o),{x:a,y:s}}function Bt(e,t,i){const o=Ye(e,t,i.width,i.height);return lt(o)}function V(e,t,i,o){const a=Ye(e,t,i,o);return jo(a)}function XE(e,t){return e.x*t.x+e.y*t.y}function KE(e,t){const i=XE(e,t),o=jo(e),a=jo(t);if(o===0||a===0)return 0;const s=Math.max(-1,Math.min(1,i/(o*a)));return Math.acos(s)}function ZE(e,t,i){const o=Math.max(0,Math.min(1,i)),a={r:parseInt(e.substring(1,3),16),g:parseInt(e.substring(3,5),16),b:parseInt(e.substring(5,7),16)},s={r:parseInt(t.substring(1,3),16),g:parseInt(t.substring(3,5),16),b:parseInt(t.substring(5,7),16)},u=Math.round(a.r+(s.r-a.r)*o),c=Math.round(a.g+(s.g-a.g)*o),f=Math.round(a.b+(s.b-a.b)*o),g=m=>("00"+m.toString(16)).slice(-2);return`#${g(u)}${g(c)}${g(f)}`}var Dt=(e=>(e.Friendly="Friendly",e.Hostile="Hostile",e))(Dt||{}),Ve=(e=>(e[e.None=0]="None",e[e.General=1]="General",e[e.Performance=2]="Performance",e[e.Ecosystem=3]="Ecosystem",e[e.Tribe=4]="Tribe",e))(Ve||{});function n0(e,t,i){return t.search.human.byRadius(e.position,i).filter(s=>{var c;return!(s.id===e.id||s.gender===e.gender||!s.isAdult||s.hunger>=zr||(s.procreationCooldown||0)>0||s.gender==="female"&&s.isPregnant||(e.motherId===s.id||e.fatherId===s.id)&&((c=s.partnerIds)!=null&&c.length))}).sort((s,u)=>{const c=s.id===e.motherId||s.id===e.fatherId,f=e.id===s.motherId||e.id===s.fatherId,g=u.id===e.motherId||u.id===e.fatherId,m=e.id===u.motherId||e.id===u.fatherId;return c||f?1:g||m?-1:s.age-u.age})}function Yr(e){if(e.length===0)return;const t=e.filter(a=>a.gender==="male"),i=e.filter(a=>a.gender==="female"),o=(a,s)=>a.age!==s.age?s.age-a.age:a.id-s.id;if(t.sort(o),t.length>0)return t[0];if(i.sort(o),i.length>0)return i[0]}function dn(e,t){const i=e,o=i.search.human.byProperty("motherId",t.id),a=i.search.human.byProperty("fatherId",t.id);return[...o,...a]}function qE(e,t,i){var a;if(e.id===t.id||e.motherId===t.id||e.fatherId===t.id||t.motherId===e.id||t.fatherId===e.id||e.motherId&&e.motherId===t.motherId||e.fatherId&&e.fatherId===t.fatherId||(a=e.partnerIds)!=null&&a.includes(t.id))return!0;if(e.motherId){const s=i.entities.entities[e.motherId];if(s&&(s.motherId===t.id||s.fatherId===t.id))return!0}if(e.fatherId){const s=i.entities.entities[e.fatherId];if(s&&(s.motherId===t.id||s.fatherId===t.id))return!0}if(t.motherId){const s=i.entities.entities[t.motherId];if(s&&(s.motherId===e.id||s.fatherId===e.id))return!0}if(t.fatherId){const s=i.entities.entities[t.fatherId];if(s&&(s.motherId===e.id||s.fatherId===e.id))return!0}return!1}function i0(e,t){var s,u,c,f;if(e.id===t.id||e.motherId===t.id||e.fatherId===t.id||t.motherId===e.id||t.fatherId===e.id||(s=e.partnerIds)!=null&&s.includes(t.id)||(u=t.partnerIds)!=null&&u.includes(e.id))return!0;if(e.fatherId===void 0&&e.motherId===void 0||t.fatherId===void 0&&t.motherId===void 0)return!1;const i=e.motherId===t.motherId||e.fatherId===t.fatherId,o=t.motherId===e.motherId||t.fatherId===e.fatherId,a=((c=e.ancestorIds)==null?void 0:c.some(g=>t.ancestorIds.includes(g)))||((f=t.ancestorIds)==null?void 0:f.some(g=>e.ancestorIds.includes(g)));return i||o||a}function QE(e,t){const i=[];if(e.motherId){const o=t.entities.entities[e.motherId];o&&i.push(o)}if(e.fatherId){const o=t.entities.entities[e.fatherId];o&&i.push(o)}return i}function JE(e,t){if(e.gender!=="female"||!e.partnerIds||e.partnerIds.length===0)return null;for(const i of e.partnerIds){const o=t.entities.entities[i];if(o&&o.gender==="male")return o}return null}function eC(e,t){var i;if(!e.isAdult&&e.fatherId){const o=t.entities.entities[e.fatherId];if(o&&o.type==="human")return o}if(e.isAdult&&e.fatherId){const o=t.entities.entities[e.fatherId];if(o&&o.type==="human"&&((i=Yr(dn(t,o)))==null?void 0:i.id)===e.id)return o}return e.isAdult&&e.gender==="female"&&e.partnerIds&&e.partnerIds.length>0?JE(e,t):null}function _u(e,t){var o;const i=new Set;if(e.motherId){const a=t.entities.entities[e.motherId];a&&i.add(a)}if(e.fatherId){const a=t.entities.entities[e.fatherId];a&&i.add(a)}return(o=e.partnerIds)==null||o.forEach(a=>{const s=t.entities.entities[a];s&&i.add(s)}),dn(t,e).forEach(a=>i.add(a)),Array.from(i)}function zv(e,t){const i=new Map;function o(a){const s=dn(t,a);for(const u of s)i.has(u.id)||(i.set(u.id,u),o(u))}return o(e),Array.from(i.values())}function Vo(e,t){return t.search.human.byProperty("leaderId",e)}function Yv(e,t){var u,c,f;const i=new Map,o=Object.values(e.entities.entities).filter(g=>g.type==="human");for(const g of o)g.leaderId&&(i.has(g.leaderId)||i.set(g.leaderId,{leaderId:g.leaderId,tribeBadge:g.tribeBadge||"?",members:[]}),(u=i.get(g.leaderId))==null||u.members.push(g));const a=t?(f=(c=e.entities.entities[t])==null?void 0:c.tribeControl)==null?void 0:f.diplomacy:void 0,s=Array.from(i.values()).map(g=>{const m=e.entities.entities[g.leaderId],S=g.members.filter(A=>A.isAdult).length,T=g.members.length-S;return{leaderId:g.leaderId,tribeBadge:g.tribeBadge,adultCount:S,childCount:T,isPlayerTribe:g.leaderId===t,leaderAge:(m==null?void 0:m.age)??0,leaderGender:(m==null?void 0:m.gender)??"male",diplomacyStatus:(a==null?void 0:a[g.leaderId??-1])??Dt.Friendly}});return s.sort((g,m)=>g.isPlayerTribe?-1:m.isPlayerTribe?1:m.adultCount+m.childCount-(g.adultCount+g.childCount)),s}function ri(e,t){return e.leaderId?t.search.human.byProperty("leaderId",e.leaderId):[]}function jv(e,t,i,o){const a=Math.random()*Math.PI*2,s=Math.sqrt(Math.random())*t,u={x:Math.cos(a)*s,y:Math.sin(a)*s},c=Bn(e,u);return{x:(c.x%i+i)%i,y:(c.y%o+o)%o}}function bn(e,t,i,o){const a=t,s={left:e.x-i,top:e.y-i,right:e.x+i,bottom:e.y+i},u=[...a.search.human.byRect(s),...a.search.berryBush.byRect(s),...a.search.corpse.byRect(s)];for(const c of u){if(o!==void 0&&c.id===o)continue;if(V(e,c.position,t.mapDimensions.width,t.mapDimensions.height)<i+c.radius)return!0}return!1}function tC(e,t,i,o,a){const s=t.mapDimensions.width,u=t.mapDimensions.height;if(!bn(e,t,o,a))return e;const c=o;for(let f=c;f<=i;f+=c){const g=Math.ceil(2*Math.PI*f/c);for(let m=0;m<g;m++){const S=m/g*2*Math.PI,T={x:Math.cos(S)*f,y:Math.sin(S)*f},A=Bn(e,T),I={x:(A.x%s+s)%s,y:(A.y%u+u)%u};if(!bn(I,t,o,a))return I}}return null}function ar(e,t){const i=t.search.building.byProperty("ownerId",e);if(i.length>0){const s=i.map(u=>u.position);return Cu(s)}const o=Vo(e,t);if(o.length===0){const s=t.entities.entities[e];return s?s.position:{x:0,y:0}}const a=o.map(s=>s.position);return Cu(a)}function r0(e,t){const o=[..._u(e,t),e].map(a=>a.position);return Cu(o)}function nC(e,t,i){const o=i.mapDimensions.width,a=i.mapDimensions.height;let s=e.x-t.position.x,u=e.y-t.position.y;return Math.abs(s)>o/2&&(s-=Math.sign(s)*o),Math.abs(u)>a/2&&(u-=Math.sign(u)*a),Math.abs(s)<=t.width/2&&Math.abs(u)<=t.height/2}function iC(e,t,i){return t.search.human.byRadius(e.position,i).filter(a=>{var s;return a.activeAction==="procreating"&&a.gender===e.gender&&typeof a.target=="number"&&((s=e.partnerIds)==null?void 0:s.includes(a.target))})[0]}function rC(e,t,i){const o=_u(e,t),a=t;for(const s of o){if(V(e.position,s.position,t.mapDimensions.width,t.mapDimensions.height)>i)continue;const c=a.search.human.byProperty("attackTargetId",s.id);for(const f of c)if(f.leaderId!==e.leaderId)return{familyMember:s,aggressor:f}}}function oC(e,t){const o=t.search.human.byRadius(e.position,rE);let a,s=1/0;for(const u of o){if(u.id===e.id||u.hitpoints<=0||u.hitpoints/u.maxHitpoints>iE||qE(e,u,t))continue;const c=V(e.position,u.position,t.mapDimensions.width,t.mapDimensions.height);c<s&&(s=c,a=u)}return a}function uh(e,t,i){return t.search.human.byRadius(e.position,i).filter(a=>is(e,a,t))}function sC(e,t,i){const o=i.search.human.byProperty("leaderId",e);let a=0;for(const s of o)s.attackTargetId===t&&a++;return a}function o0(e,t,i,o){const a=i.search.berryBush.byRadius(e,t),s=i.search.human.byRadius(e,t).filter(f=>f.leaderId!==o);let u=a.length*XI;u+=s.length*KI;let c;if(s.length>0){const f={};for(const m of s)m.leaderId&&(f[m.leaderId]=(f[m.leaderId]||0)+1);let g=0;for(const m in f)f[m]>g&&(g=f[m],c=parseInt(m,10))}return{score:u,occupyingTribeId:c}}function wu(e){return e.filter(t=>t.isAdult).reduce((t,i)=>{let o=i.hitpoints;return o+=(i.maxAge-i.age)*.5,o+=i.food.length*2,t+o},0)}function aC(e,t){if(e.id!==e.leaderId)return null;const i=t,o=ar(e.id,t),{score:a}=o0(o,Yd/2,i,e.id);let s=null,u=a;const c=VI,f=jI;for(let g=e.position.x-f;g<e.position.x+f;g+=c)for(let m=e.position.y-f;m<e.position.y+f;m+=c){const S={x:(g%t.mapDimensions.width+t.mapDimensions.width)%t.mapDimensions.width,y:(m%t.mapDimensions.height+t.mapDimensions.height)%t.mapDimensions.height};if(V(o,S,t.mapDimensions.width,t.mapDimensions.height)<Yd*2)continue;const{score:A}=o0(S,Yd/2,i,e.id);A>u*ZI&&(u=A,s=S)}return s}function Me(e,t,i,o,a){const s=t,u=o,c="position"in e&&e.id?e:null,f=c?c.position:e,g=s.search[i].byRadius(f,u);let m=null,S=u;for(const T of g){if(T.id===(c==null?void 0:c.id)||a&&!a(T))continue;const A=V(f,T.position,t.mapDimensions.width,t.mapDimensions.height);A<S&&(S=A,m=T)}return m}function lC(e,t,i,o){return t.search[i].byRadius(e,o)}function s0(e,t,i,o){return lC(e,t,i,o).length}function pt(e){const i=e.search.human.byProperty("isPlayer",!0);return i.length>0?i[0]:void 0}function uC(e,t){var u;const o=t.search.human.byProperty("activeAction","attacking");let a=null,s=1/0;for(const c of o){if(c.attackTargetId!==e)continue;const f=V(c.position,((u=t.entities.entities[e])==null?void 0:u.position)||{x:0,y:0},t.mapDimensions.width,t.mapDimensions.height);f<s&&(a=c,s=f)}return a}function Vv(e){return Object.values(e.entities.entities).filter(t=>t.type==="human")}function cC(e,t,i){const o=Object.values(t.entities.entities).reverse();for(const a of o)if(VE(e,a.position)<a.radius)return a}function dC(e,t,i,o){const a=Vv(o),s={};for(const u of a)!u.leaderId||u.leaderId===t||(s[u.leaderId]||(s[u.leaderId]={sumX:0,sumY:0,count:0}),s[u.leaderId].sumX+=u.position.x,s[u.leaderId].sumY+=u.position.y,s[u.leaderId].count++);for(const u in s){const c=s[u],f={x:c.sumX/c.count,y:c.sumY/c.count};if(V(e,f,o.mapDimensions.width,o.mapDimensions.height)<i)return!0}return!1}const wt=30,ns=wt*.6,Xv="#4CAF50",Kv="#FF5722",Zv="#9C27B0",fC="#2196F3",qv="#FFC107",hC="#DC143C",ch="#FFFFFF",dh=[5,5],Gu=5,Xo=15,gC=20,pC=16,mC=10,vC=16,SC=16,a0=["","","","","","","","","",""],Ff=8,yC="#FFFFFF",Et=18,Xe=15,AC="rgba(0, 0, 0, 0.7)",TC=4,Wi=150,an=15,hi=10,Ji="#555",IC="#f44336",EC="#4CAF50",CC="#2196F3",_C="#FFC107",jl=16,_r=32,Vl=28,wC=10,RC=8,PC=8,NC=8,An=28,Xl=40,DC="rgba(255, 215, 0, 0.7)",OC="rgba(0, 0, 0, 0.3)",Kn=10,l0=8,jd=11,zi=20,Vd=40,u0=5,MC=10,kC="#FFA500",FC="#808080",vi=120,Qv=30,LC=20,qi="#2d3748",Yt="#ffffff",Kl="#4a5568",Jv=5,fh="#bdc9f792",eS="#272c36ff",tS="#a0aec0",Ru=300,nS="rgba(255, 255, 255, 0.5)",UC="rgba(0, 0, 0, 0.8)",BC="#FFFFFF",c0=14,d0=8,f0=-15,iS="#FFD700",rS=5,HC=60,bC=-50,GC=10,Xd=12,h0=10,xC="rgba(0, 0, 0, 0.5)",$C="#4CAF50",WC="#F44336",zC="#FFC107",YC="rgba(255, 255, 255, 0.2)",g0="#FFFFFF",jC="#FF6B6B",VC=5,oS=30,Vs=50,Zl=8,p0=10,XC="rgba(0, 0, 0, 0.5)",KC="#FFFFFF",ZC=33,qC=400,QC=20,JC=10,e_="rgba(0, 0, 0, 0.7)",t_="#FFFFFF",Kd=20,m0=16,n_=.5,v0=5,sS="#FFD700",i_=40,hh=4,aS=3,r_=5,lS=20,uS=5,o_="#FFFFFF",s_="#FF6B6B",ln=80,wr=10,ql=300,Rr=15,a_=8,l_="rgba(0, 0, 0, 0.8)",u_="#FFFFFF",Zd=14,S0=10,Zn=20,c_="#FF6B6B",d_="#4CAF50",y0="#FFD700",f_="rgba(255, 255, 0, 0.3)",h_=2,g_=500,p_=120,m_=45,v_="#FFD700",S_=3,y_=4;let qd=0;function Lf(){const e=a0[qd];return qd=(qd+1)%a0.length,e}const A0=20,A_=.3,T_=24,T0=250,Ko=10,cS=250,Ta=12,dS=10,I_=10;var _e=(e=>(e.Leader="leader",e.Gatherer="gatherer",e.Planter="planter",e.Hunter="hunter",e.Mover="mover",e.Warrior="warrior",e))(_e||{}),ce=(e=>(e.Gather="Gather",e.Eat="Eat",e.Procreate="Procreate",e.Attack="Attack",e.Plant="Plant",e.CallToAttack="CallToAttack",e.TribeSplit="TribeSplit",e.FollowMe="FollowMe",e.FeedChild="FeedChild",e.HuntPrey="HuntPrey",e.DefendAgainstPredator="DefendAgainstPredator",e.Build="Build",e.Removal="Removal",e.Deposit="Deposit",e.Retrieve="Retrieve",e.TakeOverBuilding="TakeOverBuilding",e.RemoveEnemyBuilding="RemoveEnemyBuilding",e.AutopilotMove="AutopilotMove",e.AutopilotGather="AutopilotGather",e.AutopilotAttack="AutopilotAttack",e.AutopilotProcreate="AutopilotProcreate",e.AutopilotPlant="AutopilotPlant",e.AutopilotFeedChild="AutopilotFeedChild",e.AutopilotFollowMe="AutopilotFollowMe",e.AutopilotDeposit="AutopilotDeposit",e.AutopilotRetrieve="AutopilotRetrieve",e))(ce||{});const xu={Gather:"",Eat:"",Procreate:"",Attack:"",Plant:"",CallToAttack:"",TribeSplit:"",FollowMe:"",FeedChild:"",HuntPrey:"",DefendAgainstPredator:"",Build:"",Removal:"",Deposit:"",Retrieve:"",TakeOverBuilding:"",RemoveEnemyBuilding:"",AutopilotMove:"",AutopilotGather:"",AutopilotAttack:"",AutopilotProcreate:"",AutopilotPlant:"",AutopilotFeedChild:"",AutopilotFollowMe:"",AutopilotDeposit:"",AutopilotRetrieve:""},fS={Gather:"Gather",Eat:"Eat",Procreate:"Procreate",Attack:"Attack",Plant:"Plant",CallToAttack:"Call to Attack",TribeSplit:"Split Tribe",FollowMe:"Follow Me",FeedChild:"Feed Child",HuntPrey:"Hunt Prey",DefendAgainstPredator:"Defend",Build:"Build",Removal:"Remove",Deposit:"Deposit",Retrieve:"Retrieve",TakeOverBuilding:"Take Over",RemoveEnemyBuilding:"Destroy Enemy Building",AutopilotMove:"Walk",AutopilotGather:"Gather",AutopilotAttack:"Attack",AutopilotProcreate:"Procreate",AutopilotPlant:"Plant",AutopilotFeedChild:"Feed",AutopilotFollowMe:"Follow",AutopilotDeposit:"Deposit",AutopilotRetrieve:"Retrieve"};_e.Leader+"",_e.Gatherer+"",_e.Planter+"",_e.Hunter+"",_e.Mover+"",_e.Warrior+"";_e.Leader+"",_e.Gatherer+"",_e.Planter+"",_e.Hunter+"",_e.Mover+"",_e.Warrior+"";var No=(e=>(e.Time="Time",e.Hunger="Hunger",e.Hitpoints="Hitpoints",e.Food="Food",e.Autopilot="Autopilot",e.Muted="Muted",e.Family="Family",e.Tribes="Tribes",e))(No||{});const Xs={Time:"",Hunger:"",Hitpoints:"",Food:"",Autopilot:"",Muted:"",Family:"",Tribes:""};var re=(e=>(e.ToggleMute="ToggleMute",e.TogglePause="TogglePause",e.FastForward="FastForward",e.DismissTutorial="DismissTutorial",e.ReturnToIntro="ReturnToIntro",e.ConfirmExitYes="ConfirmExitYes",e.ConfirmExitNo="ConfirmExitNo",e.CommandEat="CommandEat",e.CommandPlant="CommandPlant",e.CommandCallToAttack="CommandCallToAttack",e.CommandFollowMe="CommandFollowMe",e.CommandGather="CommandGather",e.CommandTribeSplit="CommandTribeSplit",e.CommandBuild="CommandBuild",e.SelectStorageSpot="SelectStorageSpot",e.SelectPlantingZone="SelectPlantingZone",e.SelectRemovalTool="SelectRemovalTool",e.ToggleProcreationBehavior="ToggleProcreationBehavior",e.ToggleAttackBehavior="ToggleAttackBehavior",e.ToggleFeedChildBehavior="ToggleFeedChildBehavior",e.TogglePlantingBehavior="TogglePlantingBehavior",e.ToggleGatheringBehavior="ToggleGatheringBehavior",e.ToggleAutopilotFollowLeaderBehavior="ToggleAutopilotFollowLeaderBehavior",e.ToggleDiplomacy="ToggleDiplomacy",e.OpenRoleManager="OpenRoleManager",e.CloseRoleManager="CloseRoleManager",e.IncreaseRoleWeight="IncreaseRoleWeight",e.DecreaseRoleWeight="DecreaseRoleWeight",e))(re||{});const E_=12,C_=24,__=150*.9,w_=24;var Ia=(e=>(e.Hello="HELLO",e.NewTribeFormed="NEW_TRIBE_FORMED",e.NoHeir="NO_HEIR",e.ChildrenStarving="CHILDREN_STARVING",e))(Ia||{});let R_=0;function P_(){return`notification-${Date.now()}-${R_++}`}function Uf(e,t){if(t.identifier){const o=e.notifications.find(a=>a.identifier===t.identifier);if(o){if(o.dismissedUntil&&e.time<o.dismissedUntil)return;o.message=t.message,o.timestamp=e.time,o.creationTime=Date.now(),o.duration=t.duration,o.targetEntityIds=t.targetEntityIds,o.highlightedEntityIds=t.highlightedEntityIds,o.targetPosition=t.targetPosition,o.targetArea=t.targetArea,o.targetRadius=t.targetRadius,o.isDismissed=!1,o.dismissedUntil=void 0;return}}const i={...t,id:P_(),timestamp:e.time,creationTime:Date.now(),isDismissed:!1};e.notifications.push(i)}function N_(e,t){const i=e.notifications.find(o=>o.id===t);i&&(i.isDismissed=!0,i.identifier&&(i.dismissedUntil=e.time+w_))}function D_(e){const t=e.time;e.notifications=e.notifications.filter(i=>i.duration===0?!0:!(t-i.timestamp>i.duration))}function O_(e){for(const i of Object.values(e.entities.entities))i.isHighlighted=!1;const t=e.notifications.filter(i=>!i.isDismissed);for(const i of t)if(i.highlightedEntityIds)for(const o of i.highlightedEntityIds){const a=e.entities.entities[o];a&&(a.isHighlighted=!0)}}const I0=600,M_=1.5,hS=.1,Ql=""+new URL("attack-D4MA8VWK.mp3",import.meta.url).href,Qd=""+new URL("gather-CU75596W.mp3",import.meta.url).href,k_=""+new URL("eat-DCjHq2QD.mp3",import.meta.url).href,Jd=""+new URL("procreate-CfE4r5Cp.mp3",import.meta.url).href,F_=""+new URL("birth-Cbd67GHT.mp3",import.meta.url).href,L_=""+new URL("child-fed-DzEPuMid.mp3",import.meta.url).href,U_=""+new URL("human-death-B6HFLXES.mp3",import.meta.url).href,B_=""+new URL("game-over-C5dqkyER.mp3",import.meta.url).href,H_=""+new URL("button-click-DomLUeaU.mp3",import.meta.url).href,b_=""+new URL("soundtrack-1-BdlYUGye.mp3",import.meta.url).href;var ge=(e=>(e[e.Attack=0]="Attack",e[e.Gather=1]="Gather",e[e.Eat=2]="Eat",e[e.Procreate=3]="Procreate",e[e.Birth=4]="Birth",e[e.ChildFed=5]="ChildFed",e[e.HumanDeath=6]="HumanDeath",e[e.Seize=7]="Seize",e[e.CallToAttack=8]="CallToAttack",e[e.TribeSplit=9]="TribeSplit",e[e.CallToFollow=10]="CallToFollow",e[e.StorageDeposit=11]="StorageDeposit",e[e.StorageRetrieve=12]="StorageRetrieve",e[e.StorageSteal=13]="StorageSteal",e[e.GameOver=14]="GameOver",e[e.ButtonClick=15]="ButtonClick",e[e.SoundTrack1=16]="SoundTrack1",e))(ge||{});const G_=new Map([[0,Ql],[1,Qd],[2,k_],[3,Jd],[4,F_],[5,L_],[6,U_],[14,B_],[15,H_],[7,Ql],[8,Ql],[9,Jd],[10,Jd],[11,Qd],[12,Qd],[13,Ql],[16,b_]]);let Ks,Ea;function x_(){if(!(typeof window>"u"))return Ea}function gh(){if(!(typeof window>"u"))return!Ks&&typeof window.AudioContext=="function"&&(Ks=new window.AudioContext,Ea=Ks.createGain(),Ea.connect(Ks.destination),ua(.1,!1)),Ks}function ua(e,t){Ea&&(Ea.gain.value=t?0:e/10)}const gS=new Map;let Jl=!1,E0=!1;async function $_(){if(E0||Jl)return;const e=gh();if(!e){console.error("AudioContext not supported. Cannot load sounds.");return}e.state==="suspended"&&e.resume(),Jl=!0,console.log("Starting sound loading...");const t=[];G_.forEach((i,o)=>{const a=fetch(i).then(s=>{if(!s.ok)throw new Error(`Failed to fetch sound: ${i}`);return s.arrayBuffer()}).then(s=>e.decodeAudioData(s)).then(s=>{gS.set(o,s)}).catch(s=>{console.error(`Error loading sound ${ge[o]} from ${i}:`,s)});t.push(a)});try{await Promise.all(t),E0=!0,Jl=!1,console.log("All sounds loaded successfully.")}catch(i){Jl=!1,console.error("An error occurred while loading sounds:",i)}}const ca=new Map;function ph(e,t){const i=gh(),o=x_();if(!i||!o||o.gain.value===0&&(t==null?void 0:t.trackId)===void 0)return;i.state==="suspended"&&i.resume();const a=gS.get(e);if(!a){console.warn(`Sound buffer not found for type: ${ge[e]}`);return}if(t!=null&&t.trackId&&ca.has(t.trackId))return;const s=i.createBufferSource();s.buffer=a,s.loop=(t==null?void 0:t.loop)??!1;const u=i.createGain(),c=i.createStereoPanner();let f=u;if(t!=null&&t.position&&(t!=null&&t.listenerPosition)&&(t!=null&&t.worldDimensions)){const g=Ye(t.listenerPosition,t.position,t.worldDimensions.width,t.worldDimensions.height),m=V(t.listenerPosition,t.position,t.worldDimensions.width,t.worldDimensions.height);if(m>I0)return;const S=1-Math.pow(m/I0,M_);u.gain.value=Math.max(0,S);const T=Math.sin(g.x/m*(Math.PI/2));c.pan.value=isNaN(T)?0:T,u.connect(c),f=c}else{const g=e===ge.GameOver?.4:e===ge.SoundTrack1?1:.2;u.gain.value=g}s.connect(f),f.connect(o),s.start(0),t!=null&&t.trackId&&(ca.set(t.trackId,{sourceNode:s,gainNode:u}),s.onended=()=>{ca.delete(t.trackId)})}function ef(e,t=1){const i=ca.get(e),o=gh();if(i&&o){const{sourceNode:a,gainNode:s}=i,u=o.currentTime;s.gain.setValueAtTime(s.gain.value,u),s.gain.linearRampToValueAtTime(0,u+t),a.stop(u+t),a.onended=null,ca.delete(e)}}function we(e,t,i){const o=pt(e.gameState);o&&ph(t,{position:i,listenerPosition:o.position,worldDimensions:e.gameState.mapDimensions,masterVolume:e.gameState.masterVolume,isMuted:e.gameState.isMuted})}function W_(e,t,i){const o=i.mapDimensions.width,a=i.mapDimensions.height,s=t.radius*2;for(let u=T0;u<o/2;u+=50)for(let c=0;c<10;c++){const f=jv(e,u,o,a);if(!(V(e,f,o,a)<T0)&&!bn(f,i,s,t.id))return f}return null}function $u(e,t){if(!e.isAdult||e.gender!=="male"||e.leaderId===e.id||!e.leaderId)return{canSplit:!1};if(!e.leaderId)return{canSplit:!1};const i=t.entities.entities[e.leaderId];if(!i||i.type!=="human")return{canSplit:!1};const o=Yr(dn(t,i));if(o&&o.id===e.id)return{canSplit:!1};const a=Vo(e.leaderId,t).filter(f=>f.isAdult);if(a.length<A0)return{canSplit:!1};const u=zv(e,t).filter(f=>f.isAdult).length+1,c=Math.min(a.length*A_,A0);return{canSplit:u>=c,progress:u/c}}function mh(e,t){var u;if(!$u(e,t).canSplit)return;const i=e.leaderId?t.entities.entities[e.leaderId]:void 0,o=Lf(),a=zv(e,t);e.leaderId=e.id,e.tribeBadge=o,e.tribeRole=_e.Leader,e.tribeControl={roleWeights:{gatherer:1,planter:1,hunter:1,mover:1,warrior:1,leader:0},diplomacy:{}},i&&((u=i.tribeControl)!=null&&u.diplomacy)&&(i.tribeControl.diplomacy[e.id]=Dt.Hostile);for(const c of a)c.leaderId=e.id,c.tribeBadge=o;Uf(t,{type:Ia.NewTribeFormed,message:`A new tribe has formed! ${o}`,duration:C_,targetEntityIds:[e.id],highlightedEntityIds:[e.id,...a.map(c=>c.id)]}),we({gameState:t},ge.TribeSplit,e.position)}const is=(e,t,i)=>{var o,a;return e.id===t.id?!1:e.leaderId&&!t.leaderId?!0:e.leaderId===t.leaderId?!1:e.leaderId&&t.leaderId?((a=(o=i.entities.entities[e.leaderId])==null?void 0:o.tribeControl)==null?void 0:a.diplomacy[t.leaderId])===Dt.Hostile:!1},Ln=(e,t,i)=>{var a,s;return!e.leaderId||!t.ownerId||t.ownerId===e.leaderId?!1:((s=(a=i.entities.entities[e.leaderId])==null?void 0:a.tribeControl)==null?void 0:s.diplomacy[t.ownerId])===Dt.Hostile},Vr=(e,t,i)=>{if(e.id===t.id||e.gender===t.gender||!e.isAdult||!t.isAdult||e.hunger>=zr||t.hunger>=zr||(e.procreationCooldown||0)>0||(t.procreationCooldown||0)>0||is(e,t,i))return!1;const o=e.gender==="female"?e:t;return!(o.isPregnant||o.age>Gv)},z_=20,Cn=30,Y_=.5,j_=.3,V_=2,X_=50;function vh(e,t){const i=[];if(t.food.length>0&&t.hunger>sr&&i.push({type:ce.Eat,action:"eating",key:"f"}),t.food.length<t.maxFood){const s=Me(t,e,"berryBush",St,f=>f.food.length>0),u=Me(t,e,"corpse",St,f=>f.food.length>0);let c=null;s&&u?c=V(t.position,s.position,e.mapDimensions.width,e.mapDimensions.height)<=V(t.position,u.position,e.mapDimensions.width,e.mapDimensions.height)?s:u:c=s||u,c&&i.push({type:ce.Gather,action:"gathering",key:"e",targetEntity:c})}const o=Me(t,e,"human",St,s=>Vr(t,s,e));if(o&&i.push({type:ce.Procreate,action:"procreating",key:"r",targetEntity:o}),t.food.length>0&&t.isAdult){const s=Me(t,e,"human",St,u=>{const c=u;return!c.isAdult&&(c.motherId===t.id||c.fatherId===t.id)&&c.hunger>=sr});s&&i.push({type:ce.FeedChild,action:"feeding",key:"h",targetEntity:s})}const a=Me(t,e,"human",ii,s=>is(t,s,e))??Me(t,e,"predator",ii)??Me(t,e,"prey",ii);if(a&&i.push({type:ce.Attack,action:"attacking",key:"q",targetEntity:a}),t.food.filter(s=>s.type===Hn.Berry).length>=xr&&i.push({type:ce.Plant,action:"planting",key:"b"}),t.food.length>0&&t.isAdult){const s=Me(t,e,"building",Cn,u=>{const c=u;return c.buildingType==="storageSpot"&&c.ownerId===t.leaderId&&c.isConstructed&&c.storedFood!==void 0&&c.storageCapacity!==void 0&&c.storedFood.length<c.storageCapacity});s&&i.push({type:ce.Deposit,action:"idle",key:"x",targetEntity:s})}if(t.food.length<t.maxFood&&t.isAdult){const s=Me(t,e,"building",Cn,u=>{const c=u;return c.buildingType==="storageSpot"&&c.ownerId===t.leaderId&&c.isConstructed&&c.storedFood!==void 0&&c.storedFood.length>0});s&&i.push({type:ce.Retrieve,action:"idle",key:"z",targetEntity:s})}return t.leaderId===t.id&&!t.isCallingToAttack&&uh(t,e,cS).length>0&&i.push({type:ce.CallToAttack,action:"idle",key:"v"}),$u(t,e).canSplit&&i.push({type:ce.TribeSplit,action:"idle",key:"k"}),t.leaderId===t.id&&!t.isCallingToFollow&&i.push({type:ce.FollowMe,action:"idle",key:"c"}),i}const ni={StorageSpot:"storageSpot",PlantingZone:"plantingZone"},Na={[ni.StorageSpot]:{name:"Storage Spot",description:"A designated area for storing excess food.",icon:"",dimensions:{width:40,height:40},constructionTimeHours:.1,destructionTimeHours:.1,cost:{}},[ni.PlantingZone]:{name:"Planting Zone",description:"An area marked for agricultural use.",icon:"",dimensions:{width:60,height:60},constructionTimeHours:.1,destructionTimeHours:.1,cost:{}}},K_=.5,Z_="#FFA500",q_="#FF4500",C0=4,Q_=10;function pS(e){return Na[e].dimensions}function J_(e){return Na[e].constructionTimeHours}function ew(e){return Na[e].destructionTimeHours}function Sh(e,t,i,o){if(i===void 0)return!1;const a=pS(t),s=Math.sqrt(a.width*a.width+a.height*a.height)/2;if(bn(e,o,s*.8))return!1;const c=o.search.building.byRadius(e,s*2);for(const f of c){const g=V(e,f.position,o.mapDimensions.width,o.mapDimensions.height),m=(Math.max(a.width,a.height)+Math.max(f.width,f.height))/2;if(g<m*.9)return!1}return!0}function Bf(e,t,i,o){return BR(o.entities,e,t,i)}function tw(e,t){const i=t.entities.entities[e];i&&i.type==="building"&&!i.isBeingDestroyed&&(i.isBeingDestroyed=!0,i.destructionProgress=0)}function nw(e,t){const a=t.search.building.byRadius(e,100);for(const s of a){let u=e.x-s.position.x,c=e.y-s.position.y;const f=t.mapDimensions.width,g=t.mapDimensions.height;if(Math.abs(u)>f/2&&(u-=Math.sign(u)*f),Math.abs(c)>g/2&&(c-=Math.sign(c)*g),Math.abs(u)<=s.width/2&&Math.abs(c)<=s.height/2)return s}}const iw=500,rw=500;function ow(e,t){if(!e.leaderId)return 0;const i=sw(e.leaderId,t),o=aw(e.leaderId,t);return o===0?0:Math.min(1,i/o)}function sw(e,t){const i=ri({leaderId:e},t),o=Da(e,t),a=i.reduce((u,c)=>u+c.food.length,0),s=o.reduce((u,c)=>{var f;return u+(((f=c.storedFood)==null?void 0:f.length)||0)},0);return a+s}function aw(e,t){const i=ri({leaderId:e},t),o=Da(e,t),a=i.reduce((u,c)=>u+c.maxFood,0),s=o.reduce((u,c)=>u+(c.storageCapacity||0),0);return a+s}function mS(e,t){const i=Da(e,t);if(i.length===0)return 0;const o=i.reduce((s,u)=>{var c;return s+(((c=u.storedFood)==null?void 0:c.length)||0)},0),a=i.reduce((s,u)=>s+(u.storageCapacity||0),0);return a===0?0:Math.min(1,o/a)}function vS(e,t){const i=ri({leaderId:e},t);return i.length===0?0:lw(e,t)/i.length}function lw(e,t){const i=t,o=ar(e,t);return i.search.berryBush.byRadius(o,iw).filter(u=>{const c=u.stateMachine&&u.stateMachine[0]==="bushDying",f=u.food.length>0;return!c&&f}).length}function yh(e,t){return e.leaderId?t.search.building.all().filter(a=>{if(a.buildingType!==ni.PlantingZone||!a.isConstructed)return!1;if(a.ownerId){const s=t.entities.entities[a.ownerId];return s&&s.leaderId===e.leaderId}return!1}):[]}function uw(e){const t=$r*2,i=Math.floor(e.width/t),o=Math.floor(e.height/t);return i*o}function cw(e,t){const i=t,o=Math.max(e.width,e.height);return i.search.berryBush.byRadius(e.position,o).filter(u=>{const c=Math.abs(u.position.x-e.position.x),f=Math.abs(u.position.y-e.position.y);return c<=e.width/2&&f<=e.height/2}).length}function dw(e,t){if(!e.leaderId)return[];const i=Da(e.leaderId,t),o=ri(e,t);return i.map(a=>{var g;const s=a.storageCapacity||0,u=((g=a.storedFood)==null?void 0:g.length)||0,c=o.filter(m=>{if(m.activeAction!=="depositing")return!1;if(typeof m.target=="object"&&"x"in m.target){const S=m.target;return V(S,a.position,t.mapDimensions.width,t.mapDimensions.height)<=50}return!1}).length,f=V(e.position,a.position,t.mapDimensions.width,t.mapDimensions.height);return{storage:a,capacity:s,currentFood:u,assignedDepositors:c,distance:f}})}function fw(e,t){const i=dw(e,t);if(i.length===0)return null;const o=i.filter(a=>{const s=a.currentFood<a.capacity,u=a.distance<=rw;return s&&u});return o.length===0?null:(o.sort((a,s)=>{const u=a.currentFood/a.capacity,c=s.currentFood/s.capacity;return Math.abs(u-c)>.1?u-c:a.assignedDepositors!==s.assignedDepositors?a.assignedDepositors-s.assignedDepositors:a.distance-s.distance}),o[0].storage)}function SS(e,t,i){return ri({leaderId:e},t).filter(a=>a.activeAction===i).length}function Da(e,t){return t.search.building.all().filter(a=>{if(a.buildingType!==ni.StorageSpot||!a.isConstructed)return!1;if(a.ownerId){const s=t.entities.entities[a.ownerId];return s&&s.leaderId===e}return!1})}function hw(e,t){const i=yh(e,t);if(i.length===0)return null;const o=t.mapDimensions.width,a=t.mapDimensions.height;for(const s of i){const u=uw(s);if(cw(s,t)>=u)continue;const f=20;for(let g=0;g<f;g++){const m=s.position.x+(Math.random()-.5)*s.width,S=s.position.y+(Math.random()-.5)*s.height,T={x:(m%o+o)%o,y:(S%a+a)%a};if(!bn(T,t,$r))return{position:T,zoneId:s.id}}}return null}function gw(e,t,i){return yh(t,i).some(s=>nC(e,s,i))?!bn(e,i,$r):!1}const pw={id:vu,update:(e,t)=>{const{entity:i,updateContext:o}=t,{gameState:a}=o,s=o.deltaTime*(Ct/_t);if(i.age+=s,i.age>=i.lifespan)return{nextState:Sa,data:{...e,enteredAt:a.time,previousState:vu}};const u=jv(i.position,i.spreadRadius,a.mapDimensions.width,a.mapDimensions.height);return bn(u,a,15)||ka(a.entities,u,a.time),{nextState:Or,data:{...e,enteredAt:a.time,previousState:vu}}},onEnter:(e,t)=>({...t,enteredAt:e.updateContext.gameState.time})},mw={id:Sa,update:e=>({nextState:Sa,data:e}),onEnter:(e,t)=>(ss(e.updateContext.gameState.entities,e.entity.id),{...t,enteredAt:e.updateContext.gameState.time})},vw=[wI,RI,pw,mw],ft="humanIdle",Dr="humanMoving",ia="humanEating",Oa="humanGathering",da="humanDepositing",fa="humanRetrieving",Ca="humanProcreating",lr="humanAttacking",yu="humanPlanting",Sw={id:ft,update:(e,t)=>{const{entity:i,updateContext:o}=t;return i.activeAction==="attacking"&&i.attackTargetId?{nextState:lr,data:{...e,enteredAt:o.gameState.time,previousState:ft,attackTargetId:i.attackTargetId,attackStartTime:o.gameState.time}}:(i.hunger>=Bv?(i.debuffs=i.debuffs.filter(a=>a.type!=="slow"),i.debuffs.push({type:"slow",startTime:o.gameState.time,duration:.1})):i.debuffs=i.debuffs.filter(a=>a.type!=="slow"),i.activeAction==="moving"?{nextState:Dr,data:{...e,enteredAt:o.gameState.time,previousState:ft,target:i.target}}:i.activeAction==="gathering"?{nextState:Oa,data:{...e,enteredAt:o.gameState.time,previousState:ft,target:i.target}}:i.activeAction==="eating"?{nextState:ia,data:{...e,enteredAt:o.gameState.time,previousState:ft}}:i.activeAction==="planting"&&i.target?{nextState:yu,data:{...e,enteredAt:o.gameState.time,previousState:ft,plantingSpot:i.target}}:i.activeAction==="depositing"?{nextState:da,data:{...e,enteredAt:o.gameState.time,previousState:ft}}:i.activeAction==="retrieving"?{nextState:fa,data:{...e,enteredAt:o.gameState.time,previousState:ft}}:{nextState:ft,data:e})},onEnter:(e,t)=>(e.entity.acceleration=0,e.entity.velocity={x:0,y:0},{...t,enteredAt:e.updateContext.gameState.time})};function yS(e){let t=EE;return e.hunger>=Bv&&(t*=CE),e.age>=wE&&(t*=RE),e.movementSlowdown&&(t*=e.movementSlowdown.modifier),t}const tf=7.5;class yw{constructor(){Ne(this,"id",Dr)}update(t,i){var f;const{entity:o,updateContext:a}=i;if(o.activeAction==="attacking"&&o.attackTargetId)return{nextState:lr,data:{...t,enteredAt:a.gameState.time,previousState:Dr,attackTargetId:o.attackTargetId,attackStartTime:a.gameState.time}};if(o.activeAction!=="moving")return{nextState:ft,data:{...t,enteredAt:a.gameState.time,previousState:Dr}};let s;if(typeof o.target=="object"?s=o.target:typeof o.target=="number"&&(s=(f=i.updateContext.gameState.entities.entities[o.target])==null?void 0:f.position),!s&&(o.direction.x!==0||o.direction.y!==0)&&(s={x:o.position.x+o.direction.x*tf*2,y:o.position.y+o.direction.y*tf*2}),!s)return{nextState:ft,data:{...t,enteredAt:a.gameState.time,previousState:Dr}};const u=Ye(o.position,s,i.updateContext.gameState.mapDimensions.width,i.updateContext.gameState.mapDimensions.height);return o.direction=lt(u),o.acceleration=yS(o),V(o.position,s,a.gameState.mapDimensions.width,a.gameState.mapDimensions.height)<tf?{nextState:ft,data:{...t,enteredAt:a.gameState.time,previousState:Dr}}:{nextState:Dr,data:t}}onExit(t){const{entity:i}=t;i.acceleration=0}}const Aw=new yw,$e=1,kr=3,Tw=70;function ke(e,t,i,o,a){const s={id:e.nextVisualEffectId,type:t,position:i,startTime:e.time,duration:o,entityId:a};return e.visualEffects.push(s),e.nextVisualEffectId++,s.id}var fe=(e=>(e[e.Hunger=0]="Hunger",e[e.Procreation=1]="Procreation",e[e.Pregnant=2]="Pregnant",e[e.TargetAcquired=3]="TargetAcquired",e[e.Attack=4]="Attack",e[e.Partnered=5]="Partnered",e[e.BushClaimed=6]="BushClaimed",e[e.BushClaimLost=7]="BushClaimLost",e[e.Eating=8]="Eating",e[e.ChildFed=9]="ChildFed",e[e.AttackDeflected=10]="AttackDeflected",e[e.AttackResisted=11]="AttackResisted",e[e.Hit=12]="Hit",e[e.SeizeBuildup=13]="SeizeBuildup",e[e.Seize=14]="Seize",e[e.CallToAttack=15]="CallToAttack",e[e.CallToFollow=16]="CallToFollow",e[e.AutopilotMoveTarget=17]="AutopilotMoveTarget",e))(fe||{});const Iw={id:ia,update:(e,t)=>{const{entity:i,updateContext:o}=t;return i.activeAction!=="eating"?{nextState:ft,data:{...e,enteredAt:o.gameState.time,previousState:ia}}:(i.food.length>0&&(!i.eatingCooldownTime||o.gameState.time>=i.eatingCooldownTime)&&i.hunger>sr&&(i.hunger=Math.max(0,i.hunger-sr),i.food.pop(),i.eatingCooldownTime=o.gameState.time+1,we(o,ge.Eat,i.position),(!i.lastEatingEffectTime||o.gameState.time-i.lastEatingEffectTime>2)&&(ke(o.gameState,fe.Eating,i.position,$e,i.id),i.lastEatingEffectTime=o.gameState.time)),i.hunger<=0||i.food.length<=0?{nextState:ft,data:{...e,enteredAt:o.gameState.time,previousState:ia}}:{nextState:ia,data:e})},onEnter:(e,t)=>(e.entity.acceleration=0,e.entity.velocity={x:0,y:0},{...t,enteredAt:e.updateContext.gameState.time})};class Ew{constructor(){Ne(this,"id",Oa)}update(t,i){return i.entity.activeAction!=="gathering"?{nextState:"humanIdle",data:{...t,enteredAt:i.updateContext.gameState.time,previousState:this.id}}:{nextState:this.id,data:t}}}const Cw=new Ew,_w={id:da,update:(e,t)=>{const{entity:i}=t;return i.activeAction!=="depositing"?{nextState:ft,data:{...e,enteredAt:t.updateContext.gameState.time,previousState:da}}:{nextState:da,data:e}},onEnter:(e,t)=>{const{entity:i}=e;return i.activeAction="depositing",t},onExit:e=>{const{entity:t}=e;t.activeAction==="depositing"&&(t.activeAction="idle")}},ww={id:fa,update:(e,t)=>{const{entity:i}=t;return i.activeAction!=="retrieving"?{nextState:ft,data:{...e,enteredAt:t.updateContext.gameState.time,previousState:fa}}:{nextState:fa,data:e}},onEnter:(e,t)=>{const{entity:i}=e;return i.activeAction="retrieving",t},onExit:e=>{const{entity:t}=e;t.activeAction==="retrieving"&&(t.activeAction="idle")}},Rw=(e,t)=>(t.procreationEndTime=e.updateContext.gameState.time+(t.duration||2),t),Pw=(e,t)=>{const{entity:i,updateContext:o}=t,{gameState:a}=o;if(a.time<(e.procreationEndTime||0))return{nextState:Ca,data:e};const s=a.entities.entities[e.partnerId];if(s&&s.type==="human"&&!s.isPregnant&&i.hunger<zr&&s.hunger<zr&&!i.procreationCooldown&&!s.procreationCooldown){const u=i.gender==="female"?i:s.gender==="female"?s:void 0,c=i.gender==="male"?i:s.gender==="male"?s:void 0;u&&c&&(u.isPregnant=!0,u.gestationTime=DE,u.pregnancyFatherId=c.id,i.procreationCooldown=e0,s.procreationCooldown=e0,we(o,ge.Procreate,u.position))}return i.activeAction="idle",s&&(s.activeAction="idle"),{nextState:ft,data:{...e,enteredAt:a.time,previousState:Ca}}},Nw={id:Ca,onEnter:Rw,update:Pw},Dw={id:lr,onEnter:(e,t)=>({...t,enteredAt:e.updateContext.gameState.time,attackStartTime:e.updateContext.gameState.time}),update:(e,t)=>{if(t.entity.activeAction!=="attacking"||!t.entity.attackTargetId)return t.entity.activeAction="idle",{nextState:ft,data:{...e}};const i=t.updateContext.gameState.entities.entities[t.entity.attackTargetId];if(!i)return t.entity.activeAction="idle",{nextState:ft,data:{...e}};const o=V(t.entity.position,i.position,t.updateContext.gameState.mapDimensions.width,t.updateContext.gameState.mapDimensions.height),a=Ye(t.entity.position,i.position,t.updateContext.gameState.mapDimensions.width,t.updateContext.gameState.mapDimensions.height);return t.entity.direction=lt(a),o>ii?t.entity.acceleration=yS(t.entity):t.entity.acceleration=0,{nextState:lr,data:e}}},Ow={id:yu,update:(e,t)=>{const{entity:i,updateContext:o}=t,{gameState:a}=o;if(a.time-e.enteredAt>=_I){if(i.food.filter(c=>c.type===Hn.Berry).length>=xr){for(let c=0;c<xr;c++){const f=i.food.findIndex(g=>g.type===Hn.Berry);f>-1&&i.food.splice(f,1)}ka(a.entities,e.plantingSpot,a.time)}return{nextState:ft,data:{...e,enteredAt:a.time,previousState:yu}}}return{nextState:yu,data:e}},onEnter:(e,t)=>(e.entity.acceleration=0,e.entity.velocity={x:0,y:0},{...t,enteredAt:e.updateContext.gameState.time})},Mw=[Sw,Aw,Iw,Cw,_w,ww,Nw,Dw,Ow],kn="preyIdle",Qi="preyMoving",ra="preyGrazing",oa="preyProcreating",kw={id:kn,update:(e,t)=>{const{entity:i,updateContext:o}=t;return i.activeAction==="moving"?{nextState:Qi,data:{...e,enteredAt:o.gameState.time,previousState:kn,target:i.target}}:i.activeAction==="grazing"?{nextState:ra,data:{...e,enteredAt:o.gameState.time,previousState:kn}}:i.activeAction==="procreating"?{nextState:oa,data:{...e,enteredAt:o.gameState.time,previousState:kn}}:{nextState:kn,data:e}},onEnter:(e,t)=>(e.entity.acceleration=0,e.entity.velocity={x:0,y:0},{...t,enteredAt:e.updateContext.gameState.time})},AS=12,Fw=120,_0=50,Lw=12,TS=30,Uw=2,Vt=50,Bw=100,ha=2,nf=3,Hw=.9,bw=1,Gw=50,xw=.5,IS=20,$w=140,w0=40,Ww=12,ES=40,zw=3,rr=60,Fn=40,Do=50,R0=320,CS=25,Yw=60,_S=2,jw=90,Vw=.7,Xw=1,ga=3,rf=15,Ah=80,wS=10,Wu=80,rs=40,RS=2,Pu=30,ko=20,Lr=40,Fo=24,Ur=48,Lo=12,Br=40,Uo=20,Hr=60,Bo=.75,er=2.5,Ho=.25,tr=2;function Kw(e){let t=Lw;return e.isAdult||(t*=.7),e.hunger>=Gw&&(t*=xw),e.movementSlowdown&&(t*=e.movementSlowdown.modifier),t}function Zw(e,t){const i=e>>16&255,o=e>>8&255,a=e&255,s=t>>16&255,u=t>>8&255,c=t&255;let f=Math.floor((i+s)/2),g=Math.floor((o+u)/2),m=Math.floor((a+c)/2);return Math.random()<.05&&(f=Math.max(0,Math.min(255,f+(Math.random()-.5)*60))),Math.random()<.05&&(g=Math.max(0,Math.min(255,g+(Math.random()-.5)*60))),Math.random()<.05&&(m=Math.max(0,Math.min(255,m+(Math.random()-.5)*60))),f<<16|g<<8|m}function _a(){const e=Math.floor(Math.random()*100)+100,t=Math.floor(Math.random()*80)+60,i=Math.floor(Math.random()*60)+20;return e<<16|t<<8|i}const of=10;class qw{constructor(){Ne(this,"id",Qi)}update(t,i){var f;const{entity:o,updateContext:a}=i;if(o.activeAction!=="moving")return{nextState:kn,data:{...t,enteredAt:a.gameState.time,previousState:Qi}};let s;if(typeof o.target=="object"?s=o.target:typeof o.target=="number"&&(s=(f=i.updateContext.gameState.entities.entities[o.target])==null?void 0:f.position),!s&&(o.direction.x!==0||o.direction.y!==0)&&(s={x:o.position.x+o.direction.x*of*2,y:o.position.y+o.direction.y*of*2}),!s)return{nextState:kn,data:{...t,enteredAt:a.gameState.time,previousState:Qi}};const u=Ye(o.position,s,i.updateContext.gameState.mapDimensions.width,i.updateContext.gameState.mapDimensions.height);return o.direction=lt(u),o.acceleration=Kw(o),V(o.position,s,a.gameState.mapDimensions.width,a.gameState.mapDimensions.height)<of?{nextState:kn,data:{...t,enteredAt:a.gameState.time,previousState:Qi}}:{nextState:Qi,data:t}}onExit(t){const{entity:i}=t;i.acceleration=0}onEnter(t,i){return{...i,enteredAt:t.updateContext.gameState.time}}}const Qw=new qw,Jw={id:ra,update:(e,t)=>{const{entity:i,updateContext:o}=t;return i.activeAction==="moving"?{nextState:Qi,data:{...e,enteredAt:o.gameState.time,previousState:ra,target:i.target}}:i.activeAction!=="grazing"?{nextState:kn,data:{...e,enteredAt:o.gameState.time,previousState:ra}}:{nextState:ra,data:e}},onEnter:(e,t)=>(e.entity.acceleration=0,e.entity.velocity={x:0,y:0},{...t,enteredAt:e.updateContext.gameState.time})},e1={id:oa,update:(e,t)=>{const{entity:i,updateContext:o}=t;return i.activeAction==="moving"?{nextState:Qi,data:{...e,enteredAt:o.gameState.time,previousState:oa,target:i.target}}:i.activeAction!=="procreating"?{nextState:kn,data:{...e,enteredAt:o.gameState.time,previousState:oa}}:{nextState:oa,data:e}},onEnter:(e,t)=>(e.entity.acceleration=0,e.entity.velocity={x:0,y:0},{...t,enteredAt:e.updateContext.gameState.time})},t1=[kw,Qw,Jw,e1],jt="predatorIdle",Ki="predatorMoving",mi="predatorAttacking",Oo="predatorProcreating",br="predatorEating",n1={id:jt,update:(e,t)=>{const{entity:i,updateContext:o}=t;return i.activeAction==="eating"?{nextState:br,data:{...e,enteredAt:o.gameState.time,previousState:jt,preyId:i.attackTargetId,eatingStartTime:o.gameState.time}}:i.activeAction==="attacking"&&i.attackTargetId?{nextState:mi,data:{...e,enteredAt:o.gameState.time,previousState:jt,attackTargetId:i.attackTargetId,attackStartTime:o.gameState.time}}:i.activeAction==="moving"?{nextState:Ki,data:{...e,enteredAt:o.gameState.time,previousState:jt,target:i.target}}:i.activeAction==="procreating"?{nextState:Oo,data:{...e,enteredAt:o.gameState.time,previousState:jt}}:{nextState:jt,data:e}},onEnter:(e,t)=>(e.entity.acceleration=0,e.entity.velocity={x:0,y:0},{...t,enteredAt:e.updateContext.gameState.time})};function PS(e){let t=Ww;return e.hunger>=jw&&(t*=Vw),e.isAdult||(t*=.7),e.movementSlowdown&&(t*=e.movementSlowdown.modifier),t}function i1(e,t){const i=e>>16&255,o=e>>8&255,a=e&255,s=t>>16&255,u=t>>8&255,c=t&255;let f=Math.floor((i+s)/2),g=Math.floor((o+u)/2),m=Math.floor((a+c)/2);return Math.random()<.05&&(f=Math.max(0,Math.min(255,f+(Math.random()-.5)*60))),Math.random()<.05&&(g=Math.max(0,Math.min(255,g+(Math.random()-.5)*60))),Math.random()<.05&&(m=Math.max(0,Math.min(255,m+(Math.random()-.5)*60))),f<<16|g<<8|m}function wa(){const e=Math.floor(Math.random()*60)+60,t=Math.floor(Math.random()*50)+40,i=Math.floor(Math.random()*40)+20;return e<<16|t<<8|i}const sf=12;class r1{constructor(){Ne(this,"id",Ki)}update(t,i){var f;const{entity:o,updateContext:a}=i;if(o.activeAction==="eating")return{nextState:br,data:{...t,enteredAt:a.gameState.time,previousState:Ki,preyId:o.attackTargetId,eatingStartTime:a.gameState.time}};if(o.activeAction==="attacking"&&o.attackTargetId)return{nextState:mi,data:{...t,enteredAt:a.gameState.time,previousState:Ki,attackTargetId:o.attackTargetId,attackStartTime:a.gameState.time}};if(o.activeAction!=="moving")return{nextState:jt,data:{...t,enteredAt:a.gameState.time,previousState:Ki}};let s;if(typeof o.target=="object"?s=o.target:typeof o.target=="number"&&(s=(f=i.updateContext.gameState.entities.entities[o.target])==null?void 0:f.position),!s&&(o.direction.x!==0||o.direction.y!==0)&&(s={x:o.position.x+o.direction.x*sf*2,y:o.position.y+o.direction.y*sf*2}),!s)return{nextState:jt,data:{...t,enteredAt:a.gameState.time,previousState:Ki}};const u=Ye(o.position,s,i.updateContext.gameState.mapDimensions.width,i.updateContext.gameState.mapDimensions.height);return o.direction=lt(u),o.acceleration=PS(o),V(o.position,s,a.gameState.mapDimensions.width,a.gameState.mapDimensions.height)<sf?{nextState:jt,data:{...t,enteredAt:a.gameState.time,previousState:Ki}}:{nextState:Ki,data:t}}onExit(t){const{entity:i}=t;i.acceleration=0}onEnter(t,i){return{...i,enteredAt:t.updateContext.gameState.time}}}const o1=new r1,s1={id:mi,update:(e,t)=>{const{entity:i,updateContext:o}=t;if(i.activeAction==="eating")return{nextState:br,data:{...e,enteredAt:o.gameState.time,previousState:mi,preyId:i.attackTargetId,eatingStartTime:o.gameState.time}};if(i.activeAction!=="attacking"||!i.attackTargetId)return i.activeAction="idle",{nextState:jt,data:{...e,enteredAt:o.gameState.time,previousState:mi}};const a=o.gameState.entities.entities[i.attackTargetId];if(!a)return i.activeAction="idle",{nextState:jt,data:{...e,enteredAt:o.gameState.time,previousState:mi}};if(a.type==="prey"&&a.hitpoints<=0||a.type==="predator"&&a.hitpoints<=0||a.type==="human"&&a.hitpoints<=0)return i.activeAction="idle",{nextState:jt,data:{...e,enteredAt:o.gameState.time,previousState:mi}};const u=V(i.position,a.position,o.gameState.mapDimensions.width,o.gameState.mapDimensions.height),c=Ye(i.position,a.position,o.gameState.mapDimensions.width,o.gameState.mapDimensions.height);return i.direction=lt(c),u>Fn?i.acceleration=PS(i):i.acceleration=0,{nextState:mi,data:e}},onEnter:(e,t)=>({...t,enteredAt:e.updateContext.gameState.time})},a1={id:Oo,update:(e,t)=>{const{entity:i,updateContext:o}=t;return i.activeAction==="eating"?{nextState:br,data:{...e,enteredAt:o.gameState.time,previousState:Oo,preyId:i.attackTargetId,eatingStartTime:o.gameState.time}}:i.activeAction==="attacking"&&i.attackTargetId?{nextState:mi,data:{...e,enteredAt:o.gameState.time,previousState:Oo,attackTargetId:i.attackTargetId,attackStartTime:o.gameState.time}}:i.activeAction!=="procreating"?{nextState:jt,data:{...e,enteredAt:o.gameState.time,previousState:Oo}}:{nextState:Oo,data:e}},onEnter:(e,t)=>(e.entity.acceleration=0,e.entity.velocity={x:0,y:0},{...t,enteredAt:e.updateContext.gameState.time})},l1={id:br,update:(e,t)=>{const{entity:i,updateContext:o}=t;return i.activeAction!=="eating"?{nextState:jt,data:{...e,enteredAt:o.gameState.time,previousState:br}}:{nextState:br,data:e}},onEnter:(e,t)=>(e.entity.acceleration=0,e.entity.velocity={x:0,y:0},{...t,enteredAt:e.updateContext.gameState.time})},u1=[n1,o1,s1,a1,l1],P0=[...vw,...Mw,...t1,...u1];function c1(e,t,i){const o=pI(e,P0);if(!o)return vI(e),[e,t];const{nextState:a,data:s}=o.update(t,i);return mI(e,a)?[a,gI(o,a,s,i,P0)]:[a,s]}function d1(e,t,i){const{gameState:o}=t,a=i*(Ct/_t);if(e.isAdult=e.age>=th,e.isCallingToAttack&&e.callToAttackEndTime&&o.time>e.callToAttackEndTime&&(e.isCallingToAttack=!1,e.callToAttackEndTime=void 0),e.isCallingToFollow&&e.callToFollowEndTime&&o.time>e.callToFollowEndTime&&(e.isCallingToFollow=!1,e.callToFollowEndTime=void 0),e.movementSlowdown&&o.time>e.movementSlowdown.endTime&&(e.movementSlowdown=void 0),e.hitpoints<e.maxHitpoints){const u=1-e.hunger/100*xE,c=GE*u*a;e.hitpoints=Math.min(e.maxHitpoints,e.hitpoints+c)}if(e.hunger+=i*(js/(Ct/_t)),e.hunger>Tw&&(!e.lastHungerEffectTime||o.time-e.lastHungerEffectTime>kr*2)&&(ke(o,fe.Hunger,e.position,kr,e.id),e.lastHungerEffectTime=o.time),e.age+=i/Hu,e.isPlayer){const u=dn(o,e).filter(c=>c.hunger>=__);if(u.length>0){const c=u.map(f=>f.id);Uf(o,{identifier:"children_starving",type:Ia.ChildrenStarving,message:"Your children are starving!",duration:E_,targetEntityIds:c,highlightedEntityIds:c})}}if(e.gender==="female"&&e.isPregnant&&e.gestationTime&&(e.gestationTime-=a,e.hunger+=i*((js*OE-js)/(Ct/_t)),(!e.lastPregnantEffectTime||o.time-e.lastPregnantEffectTime>kr*3)&&(ke(o,fe.Pregnant,e.position,kr,e.id),e.lastPregnantEffectTime=o.time),e.gestationTime<=0&&(UR(e,e.pregnancyFatherId,t),e.isPregnant=!1,e.gestationTime=0,e.pregnancyFatherId=void 0)),e.procreationCooldown&&(e.procreationCooldown-=a,e.procreationCooldown<0&&(e.procreationCooldown=0)),e.attackCooldown&&(e.attackCooldown-=a,e.attackCooldown<0&&(e.attackCooldown=0)),e.feedParentCooldownTime&&(e.feedParentCooldownTime-=a,e.feedParentCooldownTime<0&&(e.feedParentCooldownTime=0)),e.feedChildCooldownTime&&(e.feedChildCooldownTime-=a,e.feedChildCooldownTime<0&&(e.feedChildCooldownTime=0)),e.leaderMetaStrategyCooldown&&(e.leaderMetaStrategyCooldown-=a,e.leaderMetaStrategyCooldown<0&&(e.leaderMetaStrategyCooldown=0)),e.isAdult?e.radius===ns&&(e.radius=wt):e.hunger+=i*((js*ME-js)/(Ct/_t)),e.isAdult&&e.food.length>0&&(!e.feedParentCooldownTime||e.feedParentCooldownTime<=0)){const u=[];if(e.motherId){const c=o.entities.entities[e.motherId];c&&u.push(c)}if(e.fatherId){const c=o.entities.entities[e.fatherId];c&&u.push(c)}for(const c of u)if(c.age>=rh&&c.hunger>=LE&&V(e.position,c.position,o.mapDimensions.width,o.mapDimensions.height)<=UE){e.food.pop(),c.hunger=Math.max(0,c.hunger-sr),e.feedParentCooldownTime=BE;break}}let s;if(e.hitpoints<=0?s="killed":e.hunger>=Wr?e.food.length>0&&e.isAdult?(e.food.pop(),e.hunger=Math.max(0,e.hunger-sr)):s="hunger":e.age>=e.maxAge&&(s="oldAge"),s){if(e.leaderId===e.id){const u=Yr(dn(o,e));u?(u.leaderId=u.id,u.tribeBadge=e.tribeBadge,u.tribeRole=_e.Leader,u.tribeControl=e.tribeControl??{roleWeights:{[_e.Leader]:0,[_e.Gatherer]:2,[_e.Planter]:2,[_e.Hunter]:2,[_e.Mover]:2,[_e.Warrior]:2},diplomacy:{}},Object.values(o.entities.entities).forEach(c=>{if(c.type==="human"&&c.leaderId===e.id){const f=c;f.leaderId=u.id}if(c.type==="building"&&c.ownerId===e.id){const f=c;f.ownerId=u.id}})):Object.values(o.entities.entities).forEach(c=>{if(c.type==="human"&&c.leaderId===e.id){const f=c;f.leaderId=void 0,f.tribeBadge=void 0}if(c.type==="building"&&c.ownerId===e.id){const f=c;f.ownerId=void 0}})}if(e.isPlayer){const u=Yr(dn(o,e));u?(u.isPlayer=!0,o.generationCount++):(o.gameOver=!0,o.causeOfGameOver=s,Uf(o,{identifier:"no_heir",type:Ia.NoHeir,message:"Your lineage has ended. You have no heir.",duration:0}))}kR(o.entities,e.position,e.gender,e.age,e.radius,e.id,o.time,e.food,e.hunger),ss(o.entities,e.id);return}e.animationProgress===void 0&&(e.animationProgress=0),e.animationSpeed===void 0&&(e.animationSpeed=1),e.animationProgress+=i*e.animationSpeed,e.animationProgress>=1&&(e.animationProgress=0)}function f1(e,t){const i=t.gameState.time-e.timeOfDeath;e.decayProgress=Math.min(1,i/HE);const o=Math.floor(xv*(1-e.decayProgress));e.food.length>o&&e.food.splice(o),e.decayProgress>=1&&e.food.length<=0&&ss(t.gameState.entities,e.id)}function h1(e,t,i){const o=i*(Ct/_t);e.age+=i/Hu,e.isAdult=e.age>=ha;let a=t.gameState.ecosystem.preyHungerIncreasePerHour*o;if(e.isPregnant&&(a*=1.2),e.hunger+=a,e.isPregnant&&e.gestationTime!==void 0&&(e.gestationTime-=o,e.gestationTime<=0)){const u={x:e.position.x+(Math.random()-.5)*40,y:e.position.y+(Math.random()-.5)*40};u.x=Math.max(20,Math.min(t.gameState.mapDimensions.width-20,u.x)),u.y=Math.max(20,Math.min(t.gameState.mapDimensions.height-20,u.y));const c=Math.random()<.5?"male":"female",f=e,g=e.fatherId?t.gameState.entities.entities[e.fatherId]:void 0;let m;if(g)m=Zw(f.geneCode,g.geneCode);else{m=f.geneCode;const S=Math.floor((Math.random()-.5)*4096);m=Math.max(0,Math.min(16777215,m+S))}Qo(t.gameState.entities,u,c,0,TS*.5,m,e.id,e.fatherId),ke(t.gameState,fe.Procreation,e.position,kr,e.id),we(t,ge.Birth,e.position),e.isPregnant=!1,e.gestationTime=0,e.procreationCooldown=t.gameState.ecosystem.preyProcreationCooldown,e.fatherId=void 0}e.procreationCooldown&&e.procreationCooldown>0&&(e.procreationCooldown-=o,e.procreationCooldown<0&&(e.procreationCooldown=0)),e.eatingCooldownTime&&e.eatingCooldownTime>t.gameState.time||(e.eatingCooldownTime=void 0),e.fleeCooldown&&e.fleeCooldown>0&&(e.fleeCooldown-=o,e.fleeCooldown<0&&(e.fleeCooldown=0)),e.feedChildCooldownTime&&e.feedChildCooldownTime>0&&(e.feedChildCooldownTime-=o,e.feedChildCooldownTime<0&&(e.feedChildCooldownTime=0));let s=!1;e.hunger>=Fw&&(s=!0),e.hitpoints<=0&&(s=!0),e.age>=AS&&(s=!0),s&&(FR(t.gameState.entities,e.position,e.gender,e.age,e.radius,e.id,t.gameState.time,e.geneCode),ss(t.gameState.entities,e.id))}function g1(e,t,i){const o=i*(Ct/_t);e.age+=i/Hu,e.isAdult=e.age>=ga;let a=t.gameState.ecosystem.predatorHungerIncreasePerHour*o;if(e.isPregnant&&(a*=1.3),e.hunger+=a,e.isPregnant&&e.gestationTime!==void 0&&(e.gestationTime-=o,e.gestationTime<=0)){const u={x:e.position.x+(Math.random()-.5)*50,y:e.position.y+(Math.random()-.5)*50};u.x=Math.max(25,Math.min(t.gameState.mapDimensions.width-25,u.x)),u.y=Math.max(25,Math.min(t.gameState.mapDimensions.height-25,u.y));const c=Math.random()<.5?"male":"female",f=e,g=e.pregnancyFatherId?t.gameState.entities.entities[e.pregnancyFatherId]:void 0;let m;if(g)m=i1(f.geneCode,g.geneCode);else{m=f.geneCode;const S=Math.floor((Math.random()-.5)*4096);m=Math.max(0,Math.min(16777215,m+S))}Jo(t.gameState.entities,u,c,0,ES*.6,m,e.id,e.pregnancyFatherId),ke(t.gameState,fe.Procreation,e.position,kr,e.id),we(t,ge.Birth,e.position),e.isPregnant=!1,e.gestationTime=0,e.procreationCooldown=t.gameState.ecosystem.predatorProcreationCooldown,e.pregnancyFatherId=void 0}e.procreationCooldown&&e.procreationCooldown>0&&(e.procreationCooldown-=o,e.procreationCooldown<0&&(e.procreationCooldown=0)),e.attackCooldown&&e.attackCooldown>0&&(e.attackCooldown-=o,e.attackCooldown<0&&(e.attackCooldown=0)),e.huntCooldown&&e.huntCooldown>0&&(e.huntCooldown-=o,e.huntCooldown<0&&(e.huntCooldown=0)),e.feedChildCooldownTime&&e.feedChildCooldownTime>0&&(e.feedChildCooldownTime-=o,e.feedChildCooldownTime<0&&(e.feedChildCooldownTime=0));let s=!1;e.hunger>=$w&&(s=!0),e.hitpoints<=0&&(s=!0),e.age>=IS&&(s=!0),s&&(LR(t.gameState.entities,e.position,e.gender,e.age,e.radius,e.id,t.gameState.time,e.geneCode),ss(t.gameState.entities,e.id))}var Ma=(e=>(e[e.BehaviorTreeBased=0]="BehaviorTreeBased",e))(Ma||{}),E=(e=>(e[e.SUCCESS=0]="SUCCESS",e[e.FAILURE=1]="FAILURE",e[e.RUNNING=2]="RUNNING",e[e.NOT_EVALUATED=3]="NOT_EVALUATED",e))(E||{});class fn{constructor(){Ne(this,"name");Ne(this,"depth");Ne(this,"children");Ne(this,"child")}getLastStatus(t){return _.get(t.aiBlackboard,`${this.name}_lastStatus`)??3}setLastStatus(t,i){_.set(t.aiBlackboard,`${this.name}_lastStatus`,i)}getRunningChildIndex(t){return _.get(t.aiBlackboard,`${this.name}_runningChildIndex`)}setRunningChildIndex(t,i){_.set(t.aiBlackboard,`${this.name}_runningChildIndex`,i)}}const _={create(){return{data:{},nodeExecutionData:{}}},set({data:e},t,i){e[t]=i},get(e,t){return e==null?void 0:e.data[t]},delete({data:e},t){delete e[t]},has({data:e},t){return t in e},recordNodeExecution({nodeExecutionData:e},t,i,o,a,s){const u=e[t]||{lastExecuted:0,status:E.FAILURE,depth:0,debugInfo:"",executionHistory:[]},c=u.executionHistory[u.executionHistory.length-1];c&&o-(c==null?void 0:c.time)>ya&&u.executionHistory.push({time:c.time+ya,status:E.NOT_EVALUATED}),u.executionHistory.push({time:o,status:i});const f=oS/_t*Ct,g=o-f;u.executionHistory=u.executionHistory.filter(S=>S.time>=g);const m={...u,lastExecuted:o,status:i,depth:a,debugInfo:s};e[t]=m},getNodeExecutionData({nodeExecutionData:e}){return e},cleanupOldEntries({nodeExecutionData:e},t){const i=GI,o=[];for(const[a,s]of Object.entries(e))t-s.lastExecuted>i&&o.push(a);for(const a of o)delete e[a]}};function Th(e,t,i){if(e.aiBlackboard){const o=_.get(e.aiBlackboard,"lastAiUpdateTime")??0;t.gameState.time-o>=ya&&(i.execute(e,t,e.aiBlackboard),_.set(e.aiBlackboard,"lastAiUpdateTime",t.gameState.time))}else console.warn(`Behavior Tree AI ticked for human ${e.id}, but the tree or blackboard was missing.`),e.activeAction="idle"}const N0="Human Behavior",p1=1;class m1{constructor(){Ne(this,"nodeData",new Map);Ne(this,"pathStack",[]);Ne(this,"startTimeStack",[])}nodeStart(t){this.pathStack.push(t),this.startTimeStack.push(performance.now())}nodeEnd(){if(this.startTimeStack.length===0||this.pathStack.length===0){console.error("BTProfiler: nodeEnd() called without a matching nodeStart().");return}const t=performance.now(),i=this.startTimeStack.pop(),o=t-i,a=this.pathStack.join(" > "),s=this.nodeData.get(a)??{path:a,totalTime:0,callCount:0,minTime:1/0,maxTime:-1/0};s.totalTime+=o,s.callCount++,s.minTime=Math.min(s.minTime,o),s.maxTime=Math.max(s.maxTime,o),this.nodeData.set(a,s),this.pathStack.pop()}report(t={}){const{showAll:i=!1}=t,o=Array.from(this.nodeData.values());if(o.length===0){console.log("--- Behavior Tree Profiler: No data collected. ---");return}let a=o,s="--- Behavior Tree Full Report ---";if(!i){const c=this.nodeData.get(N0);if(c){const f=c.totalTime*p1/100;a=o.filter(g=>g.totalTime>f&&g.path!==N0),s="--- Behavior Tree Problem Report ---"}else console.log('BTProfiler: Root node "Human Behavior" not found. Showing full report.'),s="--- Behavior Tree Full Report (Root Not Found) ---"}const u=a.sort((c,f)=>f.totalTime-c.totalTime);console.log(s),u.length>0?console.table(u.map(c=>({Path:c.path,"Total Time (ms)":c.totalTime.toFixed(3),Calls:c.callCount,"Avg Time (ms)":(c.totalTime/c.callCount).toFixed(3),"Min Time (ms)":c.minTime.toFixed(3),"Max Time (ms)":c.maxTime.toFixed(3)}))):console.log("No significant performance problems detected."),console.log("------------------------------------")}reset(){this.nodeData.clear(),this.pathStack=[],this.startTimeStack=[]}}const Ze=new m1;function bt(e){return Array.isArray(e)?e:[e,""]}class me extends fn{constructor(i,o,a=0){super();Ne(this,"name");Ne(this,"depth");this.children=i,this.name=o,this.depth=a,this.children.forEach(s=>{s.depth=(this.depth??0)+1})}execute(i,o,a){this.name&&Ze.nodeStart(this.name);try{for(const s of this.children){const[u,c]=bt(s.execute(i,o,a));if(u!==E.SUCCESS)return this.setLastStatus(i,u),this.name&&_.recordNodeExecution(a,this.name,u,o.gameState.time,this.depth,c),u}return this.setLastStatus(i,E.SUCCESS),this.name&&_.recordNodeExecution(a,this.name,E.SUCCESS,o.gameState.time,this.depth,""),E.SUCCESS}finally{this.name&&Ze.nodeEnd()}}}class Xt extends fn{constructor(i,o,a=0){super();Ne(this,"name");Ne(this,"depth");this.children=i,this.name=o,this.depth=a,this.children.forEach(s=>{s.depth=(this.depth??0)+1})}execute(i,o,a){this.name&&Ze.nodeStart(this.name);try{const s=this.getRunningChildIndex(i)??0;for(let u=s;u<this.children.length;u++){const c=this.children[u],[f,g]=bt(c.execute(i,o,a));if(f!==E.FAILURE){if(f===E.SUCCESS)return this.setRunningChildIndex(i,void 0),this.setLastStatus(i,E.SUCCESS),this.name&&_.recordNodeExecution(a,this.name,E.SUCCESS,o.gameState.time,this.depth,g),E.SUCCESS;if(f===E.RUNNING)return this.setRunningChildIndex(i,u),this.setLastStatus(i,E.RUNNING),this.name&&_.recordNodeExecution(a,this.name,E.RUNNING,o.gameState.time,this.depth,g),E.RUNNING}}return this.setRunningChildIndex(i,void 0),this.setLastStatus(i,E.FAILURE),this.name&&_.recordNodeExecution(a,this.name,E.FAILURE,o.gameState.time,this.depth,""),E.FAILURE}finally{this.name&&Ze.nodeEnd()}}}class oe extends fn{constructor(i,o,a=0){super();Ne(this,"name");Ne(this,"depth");this.action=i,this.name=o,this.depth=a}execute(i,o,a){this.name&&Ze.nodeStart(this.name);try{const[s,u]=bt(this.action(i,o,a));return this.setLastStatus(i,s),this.name&&_.recordNodeExecution(a,this.name,s,o.gameState.time,this.depth,u),s}finally{this.name&&Ze.nodeEnd()}}}class ee extends fn{constructor(i,o,a=0){super();Ne(this,"name");Ne(this,"depth");this.condition=i,this.name=o,this.depth=a}execute(i,o,a){this.name&&Ze.nodeStart(this.name);try{const[s,u]=bt(this.condition(i,o,a)),c=s?E.SUCCESS:E.FAILURE;return this.setLastStatus(i,c),this.name&&_.recordNodeExecution(a,this.name,c,o.gameState.time,this.depth,u),c}finally{this.name&&Ze.nodeEnd()}}}class v1 extends fn{constructor(i,o,a=0){super();Ne(this,"name");Ne(this,"depth");this.child=i,this.name=o,this.depth=a,this.child.depth=(this.depth??0)+1}execute(i,o,a){this.name&&Ze.nodeStart(this.name);try{const[s,u]=bt(this.child.execute(i,o,a));let c;switch(s){case E.SUCCESS:c=E.FAILURE;break;case E.FAILURE:c=E.SUCCESS;break;case E.RUNNING:default:c=s;break}return this.setLastStatus(i,c),this.name&&_.recordNodeExecution(a,this.name,c,o.gameState.time,this.depth,u),c}finally{this.name&&Ze.nodeEnd()}}}class S1 extends fn{constructor(i,o,a=0){super();Ne(this,"name");Ne(this,"depth");this.child=i,this.name=o,this.depth=a,this.child.depth=(this.depth??0)+1}execute(i,o,a){this.name&&Ze.nodeStart(this.name);try{const[,s]=bt(this.child.execute(i,o,a)),u=E.SUCCESS;return this.setLastStatus(i,u),this.name&&_.recordNodeExecution(a,this.name,u,o.gameState.time,this.depth,s),u}finally{this.name&&Ze.nodeEnd()}}}class Nu extends fn{constructor(i,o,a,s=0){super();Ne(this,"name");Ne(this,"depth");Ne(this,"startTimeKey");this.child=i,this.timeoutDurationHours=o,this.name=a,this.depth=s,this.child.depth=(this.depth??0)+1,this.startTimeKey=`timeout_${this.name}_startTime`}execute(i,o,a){Ze.nodeStart(this.name);try{const s=o.gameState.time;let u=_.get(a,this.startTimeKey);const[c,f]=bt(this.child.execute(i,o,a));if(c===E.RUNNING){u===void 0&&(_.set(a,this.startTimeKey,s),u=s);const g=s-u;if(g>this.timeoutDurationHours){_.delete(a,this.startTimeKey),this.setLastStatus(i,E.FAILURE);const S=`Timed out after ${g.toFixed(2)}h.`;return _.recordNodeExecution(a,this.name,this.getLastStatus(i),s,this.depth,S),this.getLastStatus(i)}this.setLastStatus(i,E.RUNNING);const m=`Running for ${g.toFixed(2)}h. ${f}`;return _.recordNodeExecution(a,this.name,this.getLastStatus(i),s,this.depth,m),this.getLastStatus(i)}return u!==void 0&&_.delete(a,this.startTimeKey),this.setLastStatus(i,c),_.recordNodeExecution(a,this.name,this.getLastStatus(i),s,this.depth,f),this.getLastStatus(i)}finally{Ze.nodeEnd()}}}class Ii extends fn{constructor(i,o,a,s=0,u){super();Ne(this,"name");Ne(this,"depth");Ne(this,"statusKey");Ne(this,"timestampKey");this.child=i,this.cacheDurationHours=o,this.validityCheck=u,this.name=a,this.depth=s,this.child.depth=(this.depth??0)+1,this.statusKey=`caching_${this.name}_status`,this.timestampKey=`caching_${this.name}_timestamp`}execute(i,o,a){Ze.nodeStart(this.name);try{const s=o.gameState.time,u=_.get(a,this.statusKey),c=_.get(a,this.timestampKey);if(u!==void 0&&c!==void 0){const S=s-c>this.cacheDurationHours,T=this.validityCheck?this.validityCheck(i,o,a):!0;if(!S&&T){const A=(c+this.cacheDurationHours-s).toFixed(2),I=`Cache hit. Status: ${E[u]}. ${A}h left.`;return this.setLastStatus(i,u),_.recordNodeExecution(a,this.name,this.getLastStatus(i),s,this.depth,I),this.getLastStatus(i)}}const[f,g]=bt(this.child.execute(i,o,a));(f===E.SUCCESS||f===E.FAILURE)&&(_.set(a,this.statusKey,f),_.set(a,this.timestampKey,s)),this.setLastStatus(i,f);const m=`Cache miss. Child returned ${E[f]}. ${g}`;return _.recordNodeExecution(a,this.name,this.getLastStatus(i),s,this.depth,m),this.getLastStatus(i)}finally{Ze.nodeEnd()}}}class cr extends fn{constructor(i,o,a,s=0){super();Ne(this,"name");Ne(this,"depth");Ne(this,"cooldownKey");this.cooldownDurationHours=i,this.child=o,this.name=a,this.depth=s,this.child.depth=(this.depth??0)+1,this.cooldownKey=`cooldown_${this.name}`}execute(i,o,a){Ze.nodeStart(this.name);try{const s=o.gameState.time,u=_.get(a,this.cooldownKey);if(this.child.getLastStatus(i)===E.RUNNING){const[g,m]=bt(this.child.execute(i,o,a));if(this.setLastStatus(i,g),this.name){const S=`Continuing running child. ${m}`;_.recordNodeExecution(a,this.name,this.getLastStatus(i),s,this.depth,S)}return this.getLastStatus(i)}if(u!==void 0&&s<u){const m=`Cooldown active, ${(u-s).toFixed(2)}h left`;return this.setLastStatus(i,E.FAILURE),this.name&&_.recordNodeExecution(a,this.name,this.getLastStatus(i),s,this.depth,m),this.getLastStatus(i)}const[c,f]=bt(this.child.execute(i,o,a));return c===E.SUCCESS&&_.set(a,this.cooldownKey,s+this.cooldownDurationHours),this.setLastStatus(i,c),this.name&&_.recordNodeExecution(a,this.name,this.getLastStatus(i),s,this.depth,f),this.getLastStatus(i)}finally{Ze.nodeEnd()}}}class Tn extends fn{constructor(i,o,a,s=0){super();Ne(this,"name");Ne(this,"depth");this.child=i,this.behaviorKey=o,this.name=a,this.depth=s;const u=(c,f)=>{c.depth=f,c.children?c.children.forEach(g=>u(g,f+1)):c.child&&u(c.child,f+1)};u(this.child,(this.depth??0)+1)}execute(i,o,a){this.name&&Ze.nodeStart(this.name);try{if(i.isPlayer&&!o.gameState.autopilotControls.behaviors[this.behaviorKey]){const f=`Player autopilot for '${this.behaviorKey}' is disabled.`;return this.setLastStatus(i,E.FAILURE),this.name&&_.recordNodeExecution(a,this.name,this.getLastStatus(i),o.gameState.time,this.depth,f),this.getLastStatus(i)}const[u,c]=bt(this.child.execute(i,o,a));return this.setLastStatus(i,u),this.name&&_.recordNodeExecution(a,this.name,this.getLastStatus(i),o.gameState.time,this.depth,c),this.getLastStatus(i)}finally{this.name&&Ze.nodeEnd()}}}class y1 extends fn{constructor(i,o,a=0){super();Ne(this,"name");Ne(this,"depth");this.child=i,this.name=o,this.depth=a;const s=(u,c)=>{u.depth=c,u.children?u.children.forEach(f=>s(f,c+1)):u.child&&s(u.child,c+1)};s(this.child,(this.depth??0)+1)}execute(i,o,a){this.name&&Ze.nodeStart(this.name);try{if(i.isPlayer&&o.gameState.autopilotControls.isManuallyMoving)return this.setLastStatus(i,E.FAILURE),this.name&&_.recordNodeExecution(a,this.name,this.getLastStatus(i),o.gameState.time,this.depth,"Manual movement active, AI blocked."),this.getLastStatus(i);const[s,u]=bt(this.child.execute(i,o,a));return this.setLastStatus(i,s),this.name&&_.recordNodeExecution(a,this.name,this.getLastStatus(i),o.gameState.time,this.depth,u),this.getLastStatus(i)}finally{this.name&&Ze.nodeEnd()}}}class To extends fn{constructor(i,o,a=0){super();Ne(this,"name");Ne(this,"depth");this.child=i,this.name=o,this.depth=a;const s=(u,c)=>{u.depth=c,u.children?u.children.forEach(f=>s(f,c+1)):u.child&&s(u.child,c+1)};s(this.child,(this.depth??0)+1)}execute(i,o,a){this.name&&Ze.nodeStart(this.name);try{if(i.isPlayer)return this.setLastStatus(i,E.FAILURE),this.name&&_.recordNodeExecution(a,this.name,this.getLastStatus(i),o.gameState.time,this.depth,"Player controlled, AI blocked."),this.getLastStatus(i);const[s,u]=bt(this.child.execute(i,o,a));return this.setLastStatus(i,s),this.name&&_.recordNodeExecution(a,this.name,this.getLastStatus(i),o.gameState.time,this.depth,u),this.getLastStatus(i)}finally{this.name&&Ze.nodeEnd()}}}const Zo=24,Ih=2,Eh=3;function jr(e,t){if(e.leaderId){const i=t.entities.entities[e.leaderId];if(i&&i.aiBlackboard)return i}if(e.isAdult&&e.aiBlackboard)return e;if(!e.isAdult&&e.fatherId){const i=t.entities.entities[e.fatherId];if(i&&i.aiBlackboard)return i}return null}function A1(e,t){if(!e.aiBlackboard)return;const i=e.aiBlackboard.data,o=[];for(const a in i)if(a.startsWith("tribal_")){const s=i[a];s&&typeof s=="object"&&"startTime"in s&&t-s.startTime>Zo&&o.push(a)}for(const a of o)_.delete(e.aiBlackboard,a)}class ur extends fn{constructor(i,o,a,s=0){super();Ne(this,"name");Ne(this,"depth");Ne(this,"registeredKey");this.child=i,this.config=o,this.name=a,this.depth=s,this.child.depth=(this.depth??0)+1,this.registeredKey=`${this.name}_registered`}execute(i,o,a){Ze.nodeStart(this.name);try{const s=jr(i,o.gameState);if(!s||!s.aiBlackboard){const[I,y]=bt(this.child.execute(i,o,a));return this.setLastStatus(i,I),_.recordNodeExecution(a,this.name,I,o.gameState.time,this.depth,`No coordination: ${y}`),I}const u=o.gameState.time,c=_.get(a,this.registeredKey)??!1,f=this.getTaskTarget(i,o,a);if(!f)return this.setLastStatus(i,E.FAILURE),_.recordNodeExecution(a,this.name,E.FAILURE,u,this.depth,"No task target found"),E.FAILURE;const g=this.getTaskKey(f);if(c){const[I,y]=bt(this.child.execute(i,o,a));return I===E.RUNNING?(this.refreshTaskTimestamp(s.aiBlackboard,g,i.id,u),this.setLastStatus(i,I),_.recordNodeExecution(a,this.name,I,u,this.depth,`Continuing: ${y}`),I):(this.removeFromTask(s.aiBlackboard,g,i.id),_.delete(a,this.registeredKey),this.setLastStatus(i,I),_.recordNodeExecution(a,this.name,I,u,this.depth,`Completed: ${y}`),I)}if(!this.canJoinTask(s.aiBlackboard,g,i.id,u)){this.setLastStatus(i,E.FAILURE);const I=_.get(s.aiBlackboard,g),y=(I==null?void 0:I.memberIds.length)??0,C=this.config.maxCapacity??1;return _.recordNodeExecution(a,this.name,E.FAILURE,u,this.depth,`Task full: ${y}/${C}`),E.FAILURE}if(!this.registerTask(s.aiBlackboard,g,i.id,u))return this.setLastStatus(i,E.FAILURE),_.recordNodeExecution(a,this.name,E.FAILURE,u,this.depth,"Failed to register task"),E.FAILURE;_.set(a,this.registeredKey,!0);const[T,A]=bt(this.child.execute(i,o,a));if(T===E.RUNNING){this.setLastStatus(i,T);const I=_.get(s.aiBlackboard,g),y=(I==null?void 0:I.memberIds.length)??0,C=this.config.maxCapacity??1;return _.recordNodeExecution(a,this.name,T,u,this.depth,`Started (${y}/${C}): ${A}`),T}else return this.removeFromTask(s.aiBlackboard,g,i.id),_.delete(a,this.registeredKey),this.setLastStatus(i,T),_.recordNodeExecution(a,this.name,T,u,this.depth,`Immediate result: ${A}`),T}finally{Ze.nodeEnd()}}getTaskTarget(i,o,a){var u,c,f,g;if(this.config.taskType==="procreation")return((c=(u=this.config).getTargetId)==null?void 0:c.call(u,i,o,a))??null;const s=(g=(f=this.config).getTargetId)==null?void 0:g.call(f,i,o,a);return s??null}getTaskKey(i){return this.config.generateTaskKey?this.config.generateTaskKey(this.config.taskType,i):`tribal_${this.config.taskType}_${i}`}canJoinTask(i,o,a,s){const u=_.get(i,o);if(!u||s-u.startTime>Zo||u.memberIds.includes(a))return!0;const c=this.config.maxCapacity??1;return u.memberIds.length<c}registerTask(i,o,a,s){let u=_.get(i,o);return u?s-u.startTime>Zo?(u={memberIds:[a],startTime:s,maxCapacity:this.config.maxCapacity??1},_.set(i,o,u),!0):u.memberIds.length>=(this.config.maxCapacity??1)?!!u.memberIds.includes(a):(u.memberIds.includes(a)||(u.memberIds.push(a),_.set(i,o,u)),!0):(u={memberIds:[a],startTime:s,maxCapacity:this.config.maxCapacity??1},_.set(i,o,u),!0)}refreshTaskTimestamp(i,o,a,s){const u=_.get(i,o);u&&u.memberIds.includes(a)&&(u.startTime=s,_.set(i,o,u))}removeFromTask(i,o,a){const s=_.get(i,o);s&&(s.memberIds=s.memberIds.filter(u=>u!==a),s.memberIds.length===0?_.delete(i,o):_.set(i,o,s))}}function T1(e){return new me([new ee((t,i)=>{const o=t.hunger>=Mf,a=t.food.length>0,s=!t.eatingCooldownTime||i.gameState.time>=t.eatingCooldownTime;return[!!(o&&a&&s),`${Math.floor(t.hunger-Mf)}, ${t.food.length}, ${t.eatingCooldownTime?Math.floor(t.eatingCooldownTime-i.gameState.time):""}`]},"Can Eat",e+1),new oe(t=>(t.direction={x:0,y:0},t.target=void 0,t.activeAction="eating",E.RUNNING),"Eat",e+1)],"Eating",e)}function I1(e){return new me([new ee((t,i,o)=>{if(t.isAdult&&t.hitpoints>t.maxHitpoints*kv||!(t.hitpoints<t.maxHitpoints*.1)&&t.isAdult&&t.hunger>BI)return!1;const s=uC(t.id,i.gameState);return s?(_.set(o,"fleeThreat",s.id),!0):!1},"Should Flee",e+1),new oe((t,i,o)=>{const a=_.get(o,"fleeThreat"),s=a&&i.gameState.entities.entities[a];if(!s)return E.FAILURE;t.activeAction="moving";const u=Ye(s.position,t.position,i.gameState.mapDimensions.width,i.gameState.mapDimensions.height),c=lt(u),f=Bn(t.position,Ot(c,Fv));return t.target={x:(f.x%i.gameState.mapDimensions.width+i.gameState.mapDimensions.width)%i.gameState.mapDimensions.width,y:(f.y%i.gameState.mapDimensions.height+i.gameState.mapDimensions.height)%i.gameState.mapDimensions.height},t.direction=c,E.RUNNING},"Execute Flee",e+1)],"Flee",e)}const NS=400,E1=25;function D0(e){const t=Math.sin(e)*1e4;return t-Math.floor(t)}function C1(e,t,i=NS){return t.search.building.byRadius(e.position,i).some(s=>{const u=s;return u.buildingType==="storageSpot"&&u.ownerId===e.leaderId&&u.isConstructed&&u.storedFood&&u.storageCapacity&&u.storedFood.length<u.storageCapacity/2})}function _1(e,t,i=NS,o,a){return t.search.building.byRadius(e.position,i).filter(c=>{const f=c;return f.buildingType==="storageSpot"&&f.ownerId===e.leaderId&&f.isConstructed&&f.storedFood&&f.storedFood.length>0}).filter(c=>{if(o){const f=`tribal_storage_${c.id}`,g=_.get(o,f);if(g&&g.memberIds.length>=Eh&&(!a||!g.memberIds.includes(a)))return!1}return!0})}function w1(e,t,i){if(t.length===0)return null;let o=null,a=1/0;for(const s of t){const u=V(e.position,s.position,i.mapDimensions.width,i.mapDimensions.height);u<a&&(a=u,o=s)}return o?{storage:o,distance:a}:null}function DS(e){const t=e.storedFood?e.storedFood.length:0,i=D0(t+e.id)*2*Math.PI,o=D0(t+e.id+1)*E1;return{x:Math.cos(i)*o,y:Math.sin(i)*o}}function qo(e,t,i){return OS(e,i)?e.tribeRole===t:!0}function OS(e,t){if(!e.leaderId)return!1;const i=t.entities.entities[e.leaderId];return!i||!i.tribeControl?!1:t.search.human.byProperty("leaderId",i.id).filter(a=>a.isAdult).length>=I_}const Io="foodSource";function R1(e){const t=new oe((o,a,s)=>{const u=jr(o,a.gameState),c=new Map,f=Me(o,a.gameState,"berryBush",Ym,S=>{var y;if(S.food.length===0)return!1;if(u&&u.aiBlackboard){const C=`tribal_gather_${S.id}`,O=_.get(u.aiBlackboard,C);if(O&&a.gameState.time-O.startTime<=Zo&&!O.memberIds.includes(o.id))return!1}const T=(y=a.gameState.search.building.byRadius(S.position,S.radius)[0])==null?void 0:y.ownerId,A=a.gameState.entities.entities[T];if(!A||A.leaderId===o.leaderId)return!0;const I=c.get(A.id)??V(o.position,A.position,a.gameState.mapDimensions.width,a.gameState.mapDimensions.height);return c.set(A.id,I),I>sE}),g=Me(o,a.gameState,"corpse",Ym,S=>{if(S.food.length===0)return!1;if(u&&u.aiBlackboard){const T=`tribal_gather_${S.id}`,A=_.get(u.aiBlackboard,T);if(A&&a.gameState.time-A.startTime<=Zo&&!A.memberIds.includes(o.id))return!1}return!0});let m=null;if(f&&g){const S=V(o.position,f.position,a.gameState.mapDimensions.width,a.gameState.mapDimensions.height),T=V(o.position,g.position,a.gameState.mapDimensions.width,a.gameState.mapDimensions.height);m=S<=T?f:g}else m=f||g;return m?(_.set(s,Io,m.id),[E.SUCCESS,`Found food: ${m.type} at ${m.position.x.toFixed(0)},${m.position.y.toFixed(0)}`]):[E.FAILURE,"No food source found"]},"Find Closest Food Source",e+4),i=new ur(new oe((o,a,s)=>{const u=_.get(s,Io);if(!u)return[E.FAILURE,"No target in blackboard"];const c=a.gameState.entities.entities[u];return!c||c.food.length===0?(_.delete(s,Io),[E.FAILURE,"Food source is invalid or depleted"]):V(o.position,c.position,a.gameState.mapDimensions.width,a.gameState.mapDimensions.height)<Yo?(o.activeAction="gathering",o.direction={x:0,y:0},o.target=c.id,_.delete(s,Io),[E.SUCCESS,`Gathering from ${c.type}`]):(o.activeAction="moving",o.target=c.id,o.direction=Bt(o.position,c.position,a.gameState.mapDimensions),[E.RUNNING,`Moving to ${c.type}`])},"Move To Food and Gather",e+3),{taskType:"gather",maxCapacity:2,getTargetId:(o,a,s)=>_.get(s,Io)??null},"Tribal Gather Task",e+3);return new me([new ee((o,a)=>{const s=o.food.length<o.maxFood,u=o.hunger>PI,c=dn(a.gameState,o).filter(g=>g.hunger>nh),f=C1(o,a.gameState);return[(o.isAdult&&s&&(u||c.length>0||f&&qo(o,_e.Gatherer,a.gameState)))??!1,`${u?"Hungry":""}${c.length>0?" Children("+c.length+")":""}${f?" Storage":""}`]},"Should Gather Food",e+1),new Xt([new me([new ee((o,a,s)=>_.has(s,Io),"Has Food Source?",e+2),i],"Continue Gathering Action",e+2),new me([new Ii(t,WI,"Cache Food Source Search",e+3),i],"Find New Food Source and Gather",e+2)],"Perform or Start Gathering",e+1)],"Gather Food",e)}function P1(e){return new oe((t,i,o)=>(t.activeAction="idle",t.direction={x:0,y:0},t.target=void 0,_.set(o,"wanderTarget",void 0),E.SUCCESS),"Idle",e)}const eu="procreationWanderStartTime",O0=(e,t,i)=>t.find(o=>Vr(e,o,i)),M0={taskType:"procreation",maxCapacity:2,getTargetId:(e,t,i)=>_.get(i,"procreationPartner")??null};function N1(e){const t=new ee((s,u,c)=>{const f=n0(s,u.gameState,Yo),g=O0(s,f,u.gameState);return g?(_.set(c,"procreationPartner",g.id),!0):[!1,"No immediate partner found"]},"Find Immediate Partner"),i=new ur(new oe((s,u,c)=>{var m;const f=_.get(c,"procreationPartner"),g=f&&u.gameState.entities.entities[f];return g?(s.activeAction="procreating",s.target=void 0,_.delete(c,"procreationPartner"),_.delete(c,eu),(m=s.partnerIds)!=null&&m.includes(g.id)||(s.partnerIds=s.partnerIds?[...s.partnerIds,g.id]:[g.id]),E.SUCCESS):E.FAILURE},"Start Procreating"),M0,"Tribal Start Procreating",e+2),o=new ee((s,u,c)=>{const f=n0(s,u.gameState,UI),g=O0(s,f,u.gameState);return g?(_.set(c,"procreationPartner",g.id),!0):[!1,"No distant partner found"]},"Locate Distant Partner"),a=new ur(new oe((s,u,c)=>{const f=_.get(c,"procreationPartner"),g=f&&u.gameState.entities.entities[f];if(!g||g.isPregnant)return E.FAILURE;if(V(s.position,g.position,u.gameState.mapDimensions.width,u.gameState.mapDimensions.height)<Yo)return E.SUCCESS;s.activeAction="moving",s.target=g.id;const S=Ye(s.position,g.position,u.gameState.mapDimensions.width,u.gameState.mapDimensions.height);return s.direction=lt(S),E.RUNNING},"Move Towards Partner"),M0,"Tribal Move To Partner",e+3);return new me([new ee(s=>!s.isAdult||s.gender==="female"&&s.isPregnant?[!1,"Not adult or pregnant"]:s.age<PE||s.gender==="female"&&s.age>Gv?[!1,"Not fertile due to age or pregnancy status"]:!0,"Is Fertile (age, not pregnant)",e+1),new ee(s=>s.hunger<zr,"Is Healthy (hunger)",e+1),new ee(s=>(s.procreationCooldown||0)<=0,"Is Ready (cooldown)",e+1),new Xt([new me([new ee((s,u)=>{const c=s0(s.position,u.gameState,"berryBush",Wm);return[c>=LI,`Found ${c} bushes`]},"Is Environment Viable (food)",e+3),new oe((s,u,c)=>(_.delete(c,eu),E.SUCCESS),"Clear Wander Timer",e+3)],"Sufficient Food Path",e+2),new me([new ee((s,u)=>{const c=dn(u.gameState,s);return Yr(c)?[!1,"Has an heir"]:!0},"Is Male Without Heir",e+3),new oe((s,u,c)=>{const f=_.get(c,eu);if(f===void 0)return _.set(c,eu,u.gameState.time),[E.FAILURE,"Starting heirless wander timer"];const g=u.gameState.time-f;return g>=NE?s0(s.position,u.gameState,"berryBush",Wm)>=1?[E.SUCCESS,`Wandered for ${g.toFixed(1)}h, minimum food found`]:[E.FAILURE,"Desperate but no food sources nearby"]:[E.FAILURE,`Wandering for heir, ${g.toFixed(1)}h elapsed`]},"Check Wander Timer",e+3)],"Heirless Desperation Path",e+2)],"Check Environment Or Desperation",e+1),new ee((s,u,c)=>{var g;const f=_.get(c,"procreationPartner");return f&&((g=f.partnerIds)!=null&&g.length)&&!f.partnerIds.includes(s.id)&&f.partnerIds.map(m=>u.gameState.entities.entities[m]).filter(m=>!!m).some(m=>V(s.position,m.position,u.gameState.mapDimensions.width,u.gameState.mapDimensions.height)<oE)?[!1,"Partner's primary partner is too close"]:!0},"Is Partner's Primary Partner Nearby",e+1),new Xt([new me([t,i],"Procreate With Immediate Partner",e+2),new cr(xI,new me([o,a],"Seek Distant Partner Action",e+3),"Seek Distant Partner Cooldown",e+2)],"Find Partner And Procreate",e+1)],"Procreate",e)}const Eo="attackTarget",Pr="homeCenter",af=150;function D1(e){return new me([new ee((t,i,o)=>{if(!t.isAdult)return[!1,"Not an adult"];const{gameState:a}=i;if(t.activeAction==="attacking"&&t.attackTargetId){const u=a.entities.entities[t.attackTargetId];if(u&&u.hitpoints>0&&V(t.position,u.position,a.mapDimensions.width,a.mapDimensions.height)<=af){if(_.set(o,Eo,u.id),!_.get(o,Pr)){const c=t.leaderId?ar(t.leaderId,a):_u(t,a).length>0?r0(t,a):t.position;_.set(o,Pr,c)}return!0}}if(!qo(t,_e.Warrior,a))return[!1,"Not a Warrior"];const s=Me(t,a,"human",af,u=>u.hitpoints>0&&is(t,u,a));if(s){_.set(o,Eo,s.id);const u=t.leaderId?ar(t.leaderId,a):_u(t,a).length>0?r0(t,a):t.position;return _.set(o,Pr,u),!0}return _.set(o,Eo,void 0),_.set(o,Pr,void 0),!1},"Find Attack Target",e+1),new oe((t,i,o)=>{const a=_.get(o,Eo),s=a&&i.gameState.entities.entities[a],u=_.get(o,Pr);if(!s||!u)return E.FAILURE;const{gameState:c}=i;return V(t.position,u,c.mapDimensions.width,c.mapDimensions.height)>Mv?(t.activeAction="idle",t.attackTargetId=void 0,_.set(o,Eo,void 0),_.set(o,Pr,void 0),E.FAILURE):s.hitpoints<=0||V(t.position,s.position,c.mapDimensions.width,c.mapDimensions.height)>af?(t.activeAction==="attacking"&&(t.activeAction="idle",t.attackTargetId=void 0),_.set(o,Eo,void 0),_.set(o,Pr,void 0),E.SUCCESS):(t.activeAction==="attacking"&&t.attackTargetId===s.id||(t.activeAction="attacking",t.attackTargetId=s.id),E.RUNNING)},"Execute Attack",e+1)],"Attack",e)}const O1=(e,t,i)=>{const o=dn(t.gameState,e).filter(u=>!u.isAdult);if(o.length===0)return E.FAILURE;let a=null,s=nh;for(const u of o)u.hunger>=s&&(s=u.hunger,a=u);return a?(_.set(i,"targetChild",a.id),E.SUCCESS):E.FAILURE},M1=(e,t,i)=>{const o=_.get(i,"targetChild"),a=o&&t.gameState.entities.entities[o];return a?V(e.position,a.position,t.gameState.mapDimensions.width,t.gameState.mapDimensions.height)>ih?(e.activeAction="moving",e.target=a.id,e.direction=Bt(e.position,a.position,t.gameState.mapDimensions),E.RUNNING):(e.activeAction="feeding",e.target=void 0,_.set(i,"targetChild",void 0),E.SUCCESS):E.FAILURE};function k1(e){return new me([new ee(t=>(t.isAdult&&t.food.length>0&&(!t.feedChildCooldownTime||t.feedChildCooldownTime<=0))??!1,"Can Feed Child",e+1),new oe(O1,"Find Hungriest Child",e+1),new oe(M1,"Move To Child and Feed",e+1)],"Feed Child",e)}function F1(e){return new me([new ee(t=>!t.isAdult&&t.hunger>=nh,"Is Hungry Child",e+1),new oe((t,i,o)=>{const a=QE(t,i.gameState);if(a.length===0)return E.FAILURE;const s=Me(t,i.gameState,"human",FE,u=>a.some(c=>c.id===u.id)&&u.food.length>0);return s?(_.set(o,"targetParent",s.id),E.SUCCESS):E.FAILURE},"Find Parent With Food",e+1),new oe((t,i,o)=>{const a=_.get(o,"targetParent"),s=a&&i.gameState.entities.entities[a];if(!s)return E.FAILURE;const u=V(t.position,s.position,i.gameState.mapDimensions.width,i.gameState.mapDimensions.height);return t.activeAction="idle",u<=ih?(t.target=void 0,E.SUCCESS):(t.target=s.id,t.activeAction="moving",E.RUNNING)},"Move To Parent",e+1)],"Seek Food From Parent",e)}const Co="plantingSpot",Zs="plantingZoneId",L1=50;function U1(e,t,i,o){const a=Ye(e,t,i,o);return Bn(e,a)}function B1(e){const t=new oe((a,s,u)=>{const c=_.get(u,Co);if(!c)return _.delete(u,Co),_.delete(u,Zs),[E.FAILURE,"Planting spot is missing"];if(bn(c,s.gameState,$r,a.id))return _.delete(u,Co),_.delete(u,Zs),[E.FAILURE,"Planting spot is occupied"];const f=U1(a.position,c,s.gameState.mapDimensions.width,s.gameState.mapDimensions.height),g=V(a.position,f,s.gameState.mapDimensions.width,s.gameState.mapDimensions.height);return g>Yo?(a.activeAction="moving",a.target=f,a.direction=Bt(a.position,f,s.gameState.mapDimensions),[E.RUNNING,"Moving to planting spot: "+g.toFixed(2)+" units away"]):bn(c,s.gameState,$r,a.id)?(_.delete(u,Co),_.delete(u,Zs),[E.FAILURE,"Planting spot is now occupied"]):(a.activeAction="planting",a.target=c,[E.RUNNING,"Planting state initiated"])},"Move To Spot and Plant",e+4),i=new ur(t,{taskType:"plant",maxCapacity:2,proximityRadius:L1,getTargetId:(a,s,u)=>_.get(u,Zs)??null},"Coordinated Planting",e+3),o=new oe((a,s,u)=>{const c=hw(a,s.gameState);return c?(_.set(u,Co,c.position),_.set(u,Zs,c.zoneId),[E.SUCCESS,`Found new spot at ${c.position.x.toFixed(0)}, ${c.position.y.toFixed(0)} (Zone ${c.zoneId})`]):[E.FAILURE,"No suitable planting spot found"]},"Find Optimal Planting Spot",e+3);return new me([new ee((a,s)=>{if(!qo(a,_e.Planter,s.gameState))return[!1,"Not a Planter"];const u=a.food.filter(g=>g.type===Hn.Berry).length>=xr,c=a.hunger<NI,f=(a.isAdult&&u&&c)??!1;return[f,f?"Can plant":`Cannot plant: adult=${a.isAdult}, berries=${a.food.filter(g=>g.type===Hn.Berry).length}/${xr}, hunger=${a.hunger.toFixed(0)}`]},"Can Plant",e+1),new ee((a,s)=>{if(!a.leaderId)return[!1,"No tribe"];const u=ow(a,s.gameState),c=vS(a.leaderId,s.gameState);let f;return u<lE?f=dE:u<uE?f=fE:u<cE?f=hE:f=gE,[c<f,`Food security: ${(u*100).toFixed(0)}%, Bush density: ${c.toFixed(1)}/${f}`]},"Needs More Bushes (Adaptive)",e+1),new ee((a,s)=>{if(!a.leaderId)return[!0,"No tribe coordination needed"];const u=ri(a,s.gameState),c=SS(a.leaderId,s.gameState,"planting"),f=Math.max(1,Math.ceil(u.length*.3));return[c<f,`Active planters: ${c}/${f}`]},"Not Too Many Planters",e+1),new Xt([new me([new ee((a,s,u)=>_.has(u,Co),"Has Planting Spot?",e+2),i],"Continue Planting Action",e+2),new cr($I,o,"Find Planting Spot Cooldown",e+2)],"Perform or Start Planting",e+1)],"Plant Bush",e)}const k0="lastDepositTime",_o="assignedStorageSpot";function H1(e){return new Xt([new me([new ee((t,i,o)=>{if(!qo(t,_e.Gatherer,i.gameState)&&!qo(t,_e.Mover,i.gameState))return[!1,"Not a Gatherer/Mover"];const a=_.get(o,k0)||0,s=i.gameState.time-a;if(s<jm)return[!1,`Cooldown: ${(jm-s).toFixed(1)}h remaining`];if(!t.isAdult)return[!1,"Not an adult"];if(!t.leaderId)return[!1,"No tribe"];const u=mS(t.leaderId,i.gameState);let c;u<.3?c=pE:u<.7?c=mE:c=vE;const f=t.food.length/t.maxFood;if(f<=c)return[!1,`Food ${(f*100).toFixed(0)}% < threshold ${(c*100).toFixed(0)}%`];const g=fw(t,i.gameState);return g?(_.set(o,_o,g.id),[!0,`Storage util: ${(u*100).toFixed(0)}%, Personal: ${(f*100).toFixed(0)}%`]):[!1,"No available tribe storage nearby"]},"Check for Excess Food and Storage",e+1),new ee((t,i)=>{if(!t.leaderId)return[!0,"No tribe coordination needed"];const o=SS(t.leaderId,i.gameState,"depositing"),a=ri(t,i.gameState),s=Math.max(1,Math.ceil(a.length*.4));return[o<s,`Active depositors: ${o}/${s}`]},"Not Too Many Depositors",e+1),new ur(new oe((t,i,o)=>{var c;const a=_.get(o,_o);if(!a)return[E.FAILURE,"No storage assigned"];const s=i.gameState.entities.entities[a];if(!s)return _.delete(o,_o),[E.FAILURE,"Storage entity missing"];if((((c=s.storedFood)==null?void 0:c.length)??0)>=(s.storageCapacity??0))return _.delete(o,_o),[E.FAILURE,"Storage full"];const u=V(t.position,s.position,i.gameState.mapDimensions.width,i.gameState.mapDimensions.height);return u<=Cn?(t.activeAction="depositing",t.target=void 0,_.set(o,k0,i.gameState.time),_.delete(o,_o),[E.SUCCESS,"Depositing food"]):(t.activeAction="moving",t.target=s.position,[E.RUNNING,`Moving to storage (${u.toFixed(1)}px away)`])},"Navigate to Storage and Deposit",e+2),{taskType:"storage",maxCapacity:Eh,storageAction:"deposit",getTargetId:(t,i,o)=>_.get(o,_o)??null},"Tribal Storage Deposit Task",e+1)],"Deposit Sequence",e)],"Storage Deposit Behavior",e)}const tu="retrievalStorageId";function b1(e){return new Xt([new me([new ee((t,i,o)=>{if(t.hunger<=Mf)return[!1,"Not hungry enough"];if(t.food.length>=t.maxFood)return[!1,"Inventory full"];const a=jr(t,i.gameState),s=_1(t,i.gameState,void 0,a==null?void 0:a.aiBlackboard,t.id),u=w1(t,s,i.gameState),c=u==null?void 0:u.storage;return c?(_.set(o,tu,c.id),[!0,`Storage with food found at distance ${u.distance.toFixed(1)}`]):[!1,"No tribe storage with food nearby"]},"Check for Hunger and Storage Food",e+1),new ur(new oe((t,i,o)=>{const a=_.get(o,tu);if(!a)return[E.FAILURE,"No storage target"];const s=i.gameState.entities.entities[a];if(!s)return _.delete(o,tu),[E.FAILURE,"Storage not found"];const u=V(t.position,s.position,i.gameState.mapDimensions.width,i.gameState.mapDimensions.height);return u<=Cn?(t.activeAction="retrieving",t.target=void 0,[E.SUCCESS,"Retrieving food"]):(t.activeAction="moving",t.target=s.position,[E.RUNNING,`Moving to storage (${u.toFixed(1)}px away)`])},"Navigate to Storage and Retrieve",e+2),{taskType:"storage",maxCapacity:Eh,storageAction:"retrieve",getTargetId:(t,i,o)=>_.get(o,tu)??null},"Coordinated Storage Retrieve",e+1)],"Retrieve Sequence",e)],"Storage Retrieve Behavior",e)}function G1(e){return new Xt([new me([new ee((t,i,o)=>{if(!t.isAdult)return[!1,"Not an adult"];if(t.food.length>=t.maxFood)return[!1,"Inventory full"];const u=i.gameState.search.building.byRadius(t.position,150).find(c=>{const f=c;return!(f.buildingType!=="storageSpot"||!f.isConstructed||!f.storedFood||f.storedFood.length===0||f.ownerId===t.leaderId)});return u?[!0,`Storage for stealing found at distance ${V(t.position,u.position,i.gameState.mapDimensions.width,i.gameState.mapDimensions.height).toFixed(1)}`]:[!1,"No storage for stealing nearby"]},"Check for Storage for Stealing",e+1),new oe((t,i,o)=>{const u=i.gameState.search.building.byRadius(t.position,150).filter(g=>{const m=g;return!(m.buildingType!=="storageSpot"||!m.isConstructed||!m.storedFood||m.storedFood.length===0||m.ownerId===t.leaderId)});if(u.length===0)return[E.FAILURE,"No undefended storage available"];let c=null,f=1/0;for(const g of u){const m=V(t.position,g.position,i.gameState.mapDimensions.width,i.gameState.mapDimensions.height);m<f&&(f=m,c=g)}return c?f<=Cn?(t.activeAction="idle",t.target=void 0,[E.SUCCESS,"Stealing food"]):(t.activeAction="moving",t.target=c.position,[E.RUNNING,`Moving to storage (${f.toFixed(1)}px away)`]):[E.FAILURE,"No storage found"]},"Navigate to Storage and Steal",e+1)],"Steal Sequence",e)],"Storage Steal Behavior",e)}const lf="enemiesNearby";function x1(e){const t=new ee(s=>s.id===s.leaderId,"Is Leader?",e+1),i=new ee(s=>!s.isCallingToAttack,"Is Not Already Calling?",e+1),o=new oe((s,u,c)=>{const f=uh(s,u.gameState,cS);return f.length>0?(_.set(c,lf,f.map(g=>g.id)),E.SUCCESS):E.FAILURE},"Find Nearby Enemies",e+1),a=new Xt([new me([new ee((s,u,c)=>{const f=_.get(c,lf),g=f==null?void 0:f.map(A=>u.gameState.entities.entities[A]).filter(A=>!!A);if(!g||g.length===0)return!1;const m=Vo(s.id,u.gameState),S=wu(m),T=wu(g);return S>T*QI},"Is Strong Enough?",e+3),new oe((s,u)=>(s.isCallingToAttack=!0,s.callToAttackEndTime=u.gameState.time+Ko,ke(u.gameState,fe.CallToAttack,s.position,Ko),we(u,ge.CallToAttack,s.position),s.activeAction="idle",s.target=void 0,E.SUCCESS),"Issue Call to Attack",e+3)],"Attack",e+2),new oe((s,u,c)=>{const f=_.get(c,lf),g=f==null?void 0:f.map(y=>u.gameState.entities.entities[y]).filter(y=>!!y);if(!g||g.length===0)return E.FAILURE;const m=g.map(y=>y.position),S=Cu(m),T=Ye(S,s.position,u.gameState.mapDimensions.width,u.gameState.mapDimensions.height),A=lt(T),I=Bn(s.position,Ot(A,Fv*2));return s.activeAction="moving",s.target={x:(I.x%u.gameState.mapDimensions.width+u.gameState.mapDimensions.width)%u.gameState.mapDimensions.width,y:(I.y%u.gameState.mapDimensions.height+u.gameState.mapDimensions.height)%u.gameState.mapDimensions.height},s.direction=A,E.SUCCESS},"Retreat",e+2)],"Attack or Retreat",e+2);return new me([t,i,o,new cr(JI,a,"Leader Combat Cooldown",e+1)],"Leader Combat Strategy",e)}const uf="combatTarget",cf="homeCenter";function $1(e){const t=new ee(u=>u.isAdult&&u.leaderId?u.id!==u.leaderId:!1,"Is Tribe Follower?",e+1),i=new ee(u=>u.hunger<DI&&u.hitpoints>=u.maxHitpoints*kv,"Is Fit for Combat?",e+1),o=new ee((u,c)=>{const f=c.gameState.entities.entities[u.leaderId];return!!(f!=null&&f.isCallingToAttack)},"Is Leader Calling to Attack?",e+1),a=new oe((u,c,f)=>{const{gameState:g}=c,m=g.entities.entities[u.leaderId];if(!m)return E.FAILURE;const S=uh(m,g,HI);if(S.length===0)return E.FAILURE;S.sort((T,A)=>{const I=V(u.position,T.position,g.mapDimensions.width,g.mapDimensions.height),y=V(u.position,A.position,g.mapDimensions.width,g.mapDimensions.height);return I-y});for(const T of S)if(sC(m.id,T.id,g)<bI){_.set(f,uf,T.id);const I=ar(m.id,g);return _.set(f,cf,I),E.SUCCESS}return E.FAILURE},"Find Best Target",e+1),s=new oe((u,c,f)=>{const g=_.get(f,uf),m=g&&c.gameState.entities.entities[g],S=_.get(f,cf);if(!m||!S)return E.FAILURE;const{gameState:T}=c;return V(u.position,S,T.mapDimensions.width,T.mapDimensions.height)>Mv?(u.activeAction==="attacking"&&u.attackTargetId===m.id&&(u.activeAction="idle",u.attackTargetId=void 0),_.set(f,uf,void 0),_.set(f,cf,void 0),E.FAILURE):((!u.lastTargetAcquiredEffectTime||c.gameState.time-u.lastTargetAcquiredEffectTime>$e*5)&&(ke(c.gameState,fe.TargetAcquired,u.position,$e,u.id),u.lastTargetAcquiredEffectTime=c.gameState.time),u.activeAction="attacking",u.attackTargetId=m.id,u.target=void 0,E.RUNNING)},"Attack Target",e+1);return new me([t,i,o,a,s],"Tribe Member Combat",e)}function F0(e,t,i,o,a,s,u){const c=u.mapDimensions.width,f=u.mapDimensions.height,g=Math.PI/8,S=i*2/(2*Math.PI);let T=0,A=0;for(;A<=t;){const I=e.x+A*Math.cos(T),y=e.y+A*Math.sin(T),C={x:(I%c+c)%c,y:(y%f+f)%f};if(Sh(C,a,s,u)&&!dC(C,void 0,o,u))return C;T+=g,A=S*T}}function W1(e){const t=new ee(A=>!A.leaderId||A.leaderId!==A.id?[!1,"Not a tribe leader"]:[!0,"Is tribe leader"],"Is Leader",e+1),i=new oe((A,I,y)=>(_.delete(y,"tribeAnalysis_adultCount"),_.delete(y,"tribeAnalysis_existingStorageSpots"),_.delete(y,"tribeAnalysis_existingPlantingZones"),_.delete(y,"tribeAnalysis_storageUtilization"),_.delete(y,"tribeAnalysis_bushDensity"),_.delete(y,"tribeAnalysis_zoneDensity"),_.delete(y,"tribeAnalysis_projectedAdultCount"),[E.SUCCESS,"Reset tribe analysis from blackboard"]),"Reset Tribe Analysis",e+2),o=new oe((A,I,y)=>{const C=ri(A,I.gameState),O=C.filter(Z=>Z.isAdult),F=Da(A.leaderId,I.gameState),P=yh(A,I.gameState),H=mS(A.leaderId,I.gameState),B=vS(A.leaderId,I.gameState),U=P.length/Math.max(1,C.length),G=Math.ceil(O.length*(1+yE));return _.set(y,"tribeAnalysis_adultCount",O.length),_.set(y,"tribeAnalysis_existingStorageSpots",F.length),_.set(y,"tribeAnalysis_existingPlantingZones",P.length),_.set(y,"tribeAnalysis_storageUtilization",H),_.set(y,"tribeAnalysis_bushDensity",B),_.set(y,"tribeAnalysis_zoneDensity",U),_.set(y,"tribeAnalysis_projectedAdultCount",G),[E.SUCCESS,`Analyzed tribe: ${O.length} adults, ${F.length} storage, ${P.length} planting zones`]},"Analyze Tribe",e+1),a=new Ii(o,1,"Cached Tribe Analysis",e+1),s=new ee((A,I,y)=>{const C=_.get(y,"tribeAnalysis_adultCount");return C===void 0?[!1,"No tribe analysis available"]:C<Xm?[!1,`Tribe too small: ${C}/${Xm} adults`]:[!0,`Tribe size sufficient: ${C} adults`]},"Has Minimum Tribe Size",e+1),u=new ee((A,I,y)=>{const C=_.get(y,"tribeAnalysis_adultCount"),O=_.get(y,"tribeAnalysis_existingStorageSpots"),F=_.get(y,"tribeAnalysis_storageUtilization"),P=_.get(y,"tribeAnalysis_projectedAdultCount");if(C===void 0||O===void 0||F===void 0||P===void 0)return[!1,"No tribe analysis available"];const H=O===0,B=F*(P/Math.max(1,C));return O<qm&&(H||F>Km||B>Km)?[!0,H?"Bootstrap: First storage spot":`Utilization: ${(F*100).toFixed(0)}% (projected: ${(B*100).toFixed(0)}%)`]:[!1,`Storage adequate: ${O}/${qm}, util: ${(F*100).toFixed(0)}%`]},"Needs Storage",e+2),c=new oe((A,I,y)=>{const C=_.get(y,"tribeAnalysis_existingStorageSpots");if(C===void 0)return[E.FAILURE,"No tribe analysis available"];const F=C===0?AE:Jm,P=ar(A.leaderId,I.gameState),H=F0(P,Yl,Vm,F,ni.StorageSpot,A.id,I.gameState);return H?(Bf(H,ni.StorageSpot,A.id,I.gameState),[E.SUCCESS,`Placed storage at (${H.x.toFixed(0)}, ${H.y.toFixed(0)})`]):[E.FAILURE,`No valid location found for storage within ${Yl}px`]},"Place Storage",e+2),f=new me([u,c,i],"Storage Sequence",e+1),g=new ee((A,I,y)=>{const C=_.get(y,"tribeAnalysis_adultCount"),O=_.get(y,"tribeAnalysis_existingPlantingZones"),F=_.get(y,"tribeAnalysis_bushDensity"),P=_.get(y,"tribeAnalysis_zoneDensity"),H=_.get(y,"tribeAnalysis_projectedAdultCount");if(C===void 0||O===void 0||F===void 0||P===void 0||H===void 0)return[!1,"No tribe analysis available"];const B=F*(C/Math.max(1,H)),G=O===0||O<Qm&&(F<Zm||B<Zm);return G&&P>B?[!1,`Planting zone density (${P.toFixed(2)}) exceeds projected density (${B.toFixed(2)})`]:G?[!0,`Low bush density: ${F.toFixed(1)} (projected: ${B.toFixed(1)})`]:[!1,`Planting zones adequate: ${O}/${Qm}, density: ${F.toFixed(1)}`]},"Needs Planting Zone",e+2),m=new oe((A,I)=>{const y=ar(A.leaderId,I.gameState),C=F0(y,Yl,Vm,Jm,ni.PlantingZone,A.id,I.gameState);return C?(Bf(C,ni.PlantingZone,A.id,I.gameState),[E.SUCCESS,`Placed planting zone at (${C.x.toFixed(0)}, ${C.y.toFixed(0)})`]):[E.FAILURE,`No valid location found for planting zone within ${Yl}px`]},"Place Planting Zone",e+2),S=new me([g,m,i],"Planting Zone Sequence",e+1),T=new Xt([f,S],"Building Type Selector",e+1);return new me([t,a,s,T],"Leader Building Placement",e)}const Yi="takeOverBuildingTarget";function z1(e){const t=new me([new ee((i,o,a)=>{if(!i.leaderId||i.leaderId!==i.id)return[!1,"Not a tribe leader"];const s=_.get(a,Yi);if(s){const c=o.gameState.entities.entities[s];if(c&&c.type==="building"&&Ln(i,c,o.gameState))return[!0,`Continuing to target building ${s}`];_.delete(a,Yi)}const u=Me(i,o.gameState,"building",Uv,c=>Ln(i,c,o.gameState)&&c.isConstructed);return u?(_.set(a,Yi,u.id),[!0,`Found enemy building at distance ${V(i.position,u.position,o.gameState.mapDimensions.width,o.gameState.mapDimensions.height).toFixed(0)}px`]):[!1,"No enemy buildings found within range"]},"Find Enemy Building to Take Over",e+2),new oe((i,o,a)=>{const s=_.get(a,Yi);if(!s)return E.FAILURE;const u=o.gameState.entities.entities[s];return!u||u.type!=="building"||!Ln(i,u,o.gameState)?(_.delete(a,Yi),i.activeAction="idle",i.target=void 0,E.FAILURE):V(i.position,u.position,o.gameState.mapDimensions.width,o.gameState.mapDimensions.height)<St?(i.activeAction="idle",i.target=void 0,E.SUCCESS):(i.activeAction="moving",i.target=u.id,E.RUNNING)},"Move to Enemy Building",e+2),new oe((i,o,a)=>{const s=_.get(a,Yi);if(!s)return E.FAILURE;const u=o.gameState.entities.entities[s];return!u||u.type!=="building"||!Ln(i,u,o.gameState)?(_.delete(a,Yi),E.FAILURE):(i.activeAction="takingOverBuilding",i.target=u.id,_.delete(a,Yi),E.SUCCESS)},"Initiate Building Takeover",e+2)],"Take Over Building Action",e+1);return new cr(Lv,t,"Take Over Building Cooldown",e)}const ji="removeEnemyBuildingTarget";function Y1(e){const t=new me([new ee((i,o,a)=>{if(!i.leaderId||i.leaderId!==i.id)return[!1,"Not a tribe leader"];const s=_.get(a,ji);if(s){const c=o.gameState.entities.entities[s];if(c&&c.type==="building"&&Ln(i,c,o.gameState))return[!0,`Continuing to target building ${s}`];_.delete(a,ji)}const u=Me(i,o.gameState,"building",Uv,c=>Ln(i,c,o.gameState)&&c.isConstructed);return u?(_.set(a,ji,u.id),[!0,`Found enemy building at distance ${V(i.position,u.position,o.gameState.mapDimensions.width,o.gameState.mapDimensions.height).toFixed(0)}px`]):[!1,"No enemy buildings found within range"]},"Find Enemy Building to Destroy",e+2),new oe((i,o,a)=>{const s=_.get(a,ji);if(!s)return E.FAILURE;const u=o.gameState.entities.entities[s];return!u||u.type!=="building"||!Ln(i,u,o.gameState)?(_.delete(a,ji),i.activeAction="idle",i.target=void 0,E.FAILURE):V(i.position,u.position,o.gameState.mapDimensions.width,o.gameState.mapDimensions.height)<St?(i.activeAction="idle",i.target=void 0,E.SUCCESS):(i.activeAction="moving",i.target=u.id,E.RUNNING)},"Move to Enemy Building",e+2),new oe((i,o,a)=>{const s=_.get(a,ji);if(!s)return E.FAILURE;const u=o.gameState.entities.entities[s];return!u||u.type!=="building"||!Ln(i,u,o.gameState)?(_.delete(a,ji),E.FAILURE):(i.activeAction="destroyingBuilding",i.target=u.id,_.delete(a,ji),E.SUCCESS)},"Initiate Building Destruction",e+2)],"Remove Enemy Building Action",e+1);return new cr(Lv,t,"Remove Enemy Building Cooldown",e)}function j1(e){return new me([new oe((t,i,o)=>{const a=eC(t,i.gameState);return a?(_.set(o,"patriarchTarget",a.id),[E.SUCCESS,`Found patriarch: ${a.id}`]):(_.delete(o,"patriarchTarget"),[E.FAILURE,"No patriarch found"])},"Find Patriarch",e+1),new oe((t,i,o)=>{const a=_.get(o,"patriarchTarget"),s=a&&i.gameState.entities.entities[a];if(!s)return[E.FAILURE,"Patriarch target missing from blackboard"];const u=V(t.position,s.position,i.gameState.mapDimensions.width,i.gameState.mapDimensions.height);if(u>Ov){t.activeAction="moving",t.target=s.id;const c=Ye(t.position,s.position,i.gameState.mapDimensions.width,i.gameState.mapDimensions.height);return t.direction=lt(c),[E.RUNNING,`Moving to patriarch at ${u.toFixed(0)}`]}return t.activeAction="idle",t.target=void 0,t.direction={x:0,y:0},[E.SUCCESS,`Arrived at patriarch at ${u.toFixed(0)}`]},"Move Towards Patriarch",e+1)],"Follow Patriarch",e)}const nu="tribeSplitMigrationTarget";function V1(e){const t=new me([new ee((i,o,a)=>{if(_.get(a,nu))return[!0,"Already migrating"];const{canSplit:u,progress:c}=$u(i,o.gameState);return u?[!0,`Progress: ${(c??0)*100}%`]:[!1,"Cannot split"]},"Can Split Tribe?",e+2),new oe((i,o,a)=>{const{gameState:s}=o;let u=_.get(a,nu);if(!u){if(!i.leaderId)return E.FAILURE;const f=s.entities.entities[i.leaderId];if(!f)return E.FAILURE;const g=W_(f.position,i,s);if(g)_.set(a,nu,g),u=g;else return E.FAILURE}return V(i.position,u,s.mapDimensions.width,s.mapDimensions.height)<Yo?(_.delete(a,nu),i.activeAction="idle",i.target=void 0,E.SUCCESS):(i.activeAction="moving",i.target=u,E.RUNNING)},"Move to New Territory",e+2),new oe((i,o)=>(mh(i,o.gameState),E.SUCCESS),"Perform Tribe Split",e+2)],"Tribe Split Action",e+1);return new cr(T_,t,"Tribe Split Cooldown",e)}const iu="jealousyAttackTarget";function X1(e){return new me([new ee((t,i,o)=>{if(!t.isAdult)return[!1,"Not an adult"];const a=iC(t,i.gameState,eE);return a?t.leaderId&&a.id===t.leaderId?[!1,"Stranger is in same tribe - no attack"]:(_.set(o,iu,a.id),[!0,`Partner cheating with ${a.id}`]):(_.delete(o,iu),!1)},"Check for Infidelity",e+1),new oe((t,i,o)=>{const a=_.get(o,iu),s=a&&i.gameState.entities.entities[a];return!s||s.hitpoints<=0?(_.delete(o,iu),[E.FAILURE,"Target is invalid or dead"]):t.activeAction==="attacking"&&t.attackTargetId===s.id?E.RUNNING:(t.activeAction="attacking",t.attackTargetId=s.id,[E.RUNNING,`Attacking ${s.id}`])},"Execute Jealousy Attack",e+1)],"Jealousy Attack",e)}const ru="defendAggressor";function K1(e){return new me([new ee((t,i,o)=>{if(!t.isAdult)return[!1,"Not an adult"];const a=rC(t,i.gameState,tE);return a?(_.set(o,ru,a.aggressor.id),[!0,`Family member ${a.familyMember.id} attacked by ${a.aggressor.id}`]):(_.delete(o,ru),!1)},"Check Family Under Attack",e+1),new oe((t,i,o)=>{const a=_.get(o,ru),s=a&&i.gameState.entities.entities[a];return!s||s.hitpoints<=0?(_.delete(o,ru),[E.FAILURE,"Target invalid/dead"]):t.activeAction==="attacking"&&t.attackTargetId===s.id?E.RUNNING:(t.activeAction="attacking",t.attackTargetId=s.id,[E.RUNNING,`Attacking aggressor ${s.id}`])},"Execute Family Defense Attack",e+1)],"Defend Family",e)}const ou="desperateAttackTarget";function Z1(e){return new me([new ee(t=>t.hunger>nE,"Is Starving",e+1),new ee((t,i)=>{if(!t.isAdult)return[!1,"Not an adult"];const o=Me(t,i.gameState,"berryBush",St,s=>s.food.length>0),a=Me(t,i.gameState,"corpse",St,s=>s.food.length>0);return!o&&!a},"No Other Food Available",e+1),new ee((t,i,o)=>{const a=oC(t,i.gameState);return a?(_.set(o,ou,a.id),[!0,`Found weak target ${a.id}`]):(_.delete(o,ou),!1)},"Find Weak Target",e+1),new oe((t,i,o)=>{const a=_.get(o,ou),s=a&&i.gameState.entities.entities[a];return!s||s.hitpoints<=0?(_.delete(o,ou),[E.FAILURE,"Target is invalid or dead"]):t.activeAction==="attacking"&&t.attackTargetId===s.id?E.RUNNING:(t.activeAction="attacking",t.attackTargetId=s.id,[E.RUNNING,`Desperately attacking ${s.id}`])},"Execute Desperate Attack",e+1)],"Desperate Attack",e)}function q1(e,t,i,o){const a=e.entities.entities[i.targetEntityId];return!a||!("hitpoints"in a)||a.hitpoints<=0?(e.autopilotControls.activeAutopilotAction=void 0,E.FAILURE):V(t.position,a.position,e.mapDimensions.width,e.mapDimensions.height)<=Su?(t.activeAction="attacking",t.attackTargetId=a.id,e.autopilotControls.activeAutopilotAction=void 0,E.SUCCESS):(t.activeAction="moving",t.target=a.id,t.direction=Bt(t.position,a.position,e.mapDimensions),E.RUNNING)}function Q1(e){return new me([new ee((t,i)=>t.isPlayer===!0&&!!i.gameState.autopilotControls.activeAutopilotAction,"Has Player Command",e+1),new oe((t,i)=>{var s;const{gameState:o}=i,a=o.autopilotControls.activeAutopilotAction;if(!a)return E.FAILURE;switch(a.action){case ce.AutopilotMove:{const u=a.position;return V(t.position,u,o.mapDimensions.width,o.mapDimensions.height)<aE?(o.autopilotControls.activeAutopilotAction=void 0,t.activeAction==="moving"&&(t.activeAction="idle",t.target=void 0),E.SUCCESS):(t.activeAction="moving",t.target=u,t.direction=Bt(t.position,u,o.mapDimensions),E.RUNNING)}case ce.AutopilotGather:{const u=o.entities.entities[a.targetEntityId];return!u||u.food.length===0?(o.autopilotControls.activeAutopilotAction=void 0,E.FAILURE):V(t.position,u.position,o.mapDimensions.width,o.mapDimensions.height)>Yo?(t.activeAction="moving",t.target=u.id,t.direction=Bt(t.position,u.position,o.mapDimensions),E.RUNNING):(t.activeAction="gathering",t.target=u.id,o.autopilotControls.activeAutopilotAction=void 0,E.SUCCESS)}case ce.AutopilotAttack:return q1(o,t,a);case ce.AutopilotProcreate:{const u=o.entities.entities[a.targetEntityId];return!u||u.type!=="human"||!Vr(t,u,i.gameState)?(o.autopilotControls.activeAutopilotAction=void 0,E.FAILURE):V(t.position,u.position,o.mapDimensions.width,o.mapDimensions.height)<=Su?(t.activeAction="procreating",o.autopilotControls.activeAutopilotAction=void 0,E.SUCCESS):(t.activeAction="moving",t.target=u.id,t.direction=Bt(t.position,u.position,o.mapDimensions),E.RUNNING)}case ce.AutopilotPlant:{if(t.activeAction==="planting")return E.RUNNING;const u=a.position;return bn(u,o,$r,t.id)?(o.autopilotControls.activeAutopilotAction=void 0,E.FAILURE):V(t.position,u,o.mapDimensions.width,o.mapDimensions.height)<=Su?(t.activeAction="planting",t.target=u,o.autopilotControls.activeAutopilotAction=void 0,o.hasPlayerPlantedBush=!0,E.RUNNING):(t.activeAction="moving",t.target=u,t.direction=Bt(t.position,u,o.mapDimensions),E.RUNNING)}case ce.AutopilotFeedChild:{const u=o.entities.entities[a.targetEntityId];return!u||u.type!=="human"||u.isAdult||t.food.length===0?(o.autopilotControls.activeAutopilotAction=void 0,E.FAILURE):V(t.position,u.position,o.mapDimensions.width,o.mapDimensions.height)<=Su?(o.autopilotControls.activeAutopilotAction=void 0,t.activeAction="feeding",E.SUCCESS):(t.activeAction="moving",t.target=u.id,t.direction=Bt(t.position,u.position,o.mapDimensions),E.RUNNING)}case ce.AutopilotDeposit:{const u=o.entities.entities[a.targetEntityId];if(!u||u.buildingType!=="storageSpot"||!u.isConstructed)return o.autopilotControls.activeAutopilotAction=void 0,E.FAILURE;const c=u.storageCapacity??0;return(((s=u.storedFood)==null?void 0:s.length)??0)>=c||t.leaderId!==u.ownerId||t.food.length===0?(o.autopilotControls.activeAutopilotAction=void 0,E.FAILURE):V(t.position,u.position,o.mapDimensions.width,o.mapDimensions.height)<=Cn?(t.activeAction="depositing",t.target=void 0,o.autopilotControls.activeAutopilotAction=void 0,E.SUCCESS):(t.activeAction="moving",t.target=u.id,t.direction=Bt(t.position,u.position,o.mapDimensions),E.RUNNING)}case ce.AutopilotRetrieve:{const u=o.entities.entities[a.targetEntityId];return!u||u.buildingType!=="storageSpot"||!u.isConstructed||!u.storedFood||u.storedFood.length===0||t.leaderId!==u.ownerId||t.food.length>=t.maxFood?(o.autopilotControls.activeAutopilotAction=void 0,E.FAILURE):V(t.position,u.position,o.mapDimensions.width,o.mapDimensions.height)<=Cn?(t.activeAction="retrieving",t.target=void 0,o.autopilotControls.activeAutopilotAction=void 0,E.SUCCESS):(t.activeAction="moving",t.target=u.id,t.direction=Bt(t.position,u.position,o.mapDimensions),E.RUNNING)}case ce.AutopilotFollowMe:{const u=o.entities.entities[a.targetEntityId];return!u||u.type!=="human"||u.id!==u.leaderId?(o.autopilotControls.activeAutopilotAction=void 0,E.FAILURE):V(t.position,u.position,o.mapDimensions.width,o.mapDimensions.height)<=Ov?(o.autopilotControls.activeAutopilotAction=void 0,t.activeAction==="moving"&&(t.activeAction="idle"),E.SUCCESS):(t.activeAction="moving",t.target=u.id,t.direction=Bt(t.position,u.position,o.mapDimensions),E.RUNNING)}default:return o.autopilotControls.activeAutopilotAction=void 0,E.FAILURE}},"Execute Player Command",e+1)],"Player Command Handler",e)}function J1(e){return new me([new ee(t=>!!t.leaderId&&t.leaderId!==t.id,"Is Follower",e+1),new ee((t,i)=>{if(!t.leaderId)return!1;const o=i.gameState.entities.entities[t.leaderId];return!!o&&o.isCallingToFollow===!0},"Is Leader Calling To Follow",e+1),new ee(t=>t.hunger<FI,"Is Not Critically Hungry",e+1),new oe((t,i)=>{if(!t.leaderId)return E.FAILURE;const o=i.gameState.entities.entities[t.leaderId];return o?V(t.position,o.position,i.gameState.mapDimensions.width,i.gameState.mapDimensions.height)>kI?(t.activeAction="moving",t.target=o.id,t.direction=Bt(t.position,o.position,i.gameState.mapDimensions),E.RUNNING):(t.activeAction==="moving"&&t.target===o.id&&(t.activeAction="idle",t.target=void 0),E.SUCCESS):E.FAILURE},"Execute Follow Leader",e+1)],"Follow Leader Command",e)}const L0="tribeMigrationCheckCooldown";function eR(e){const t=new me([new ee(o=>!!o.leaderId&&o.leaderId===o.id,"Is Tribe Leader",e+2),new ee((o,a)=>{const s=_.get(o.aiBlackboard,L0);return s?a.gameState.time-s>=zm:!0},"Is Migration Check Cooldown Over",e+2),new oe((o,a)=>{o.aiBlackboard&&_.set(o.aiBlackboard,L0,a.gameState.time);const s=aC(o,a.gameState);return s?(o.isCallingToFollow=!0,o.callToFollowEndTime=a.gameState.time+Ta,o.target=s,o.activeAction="moving",E.SUCCESS):E.FAILURE},"Execute Tribe Migration",e+2)],"Tribe Migration Strategy",e+1),i=new Ii(t,la,"Cache Tribe Migration",e+1);return new cr(zm,i,"Tribe Migration Cooldown",e)}function tR(e){const t=new ee(o=>o.id===o.leaderId,"Is Leader?",e+1),i=new oe((o,a)=>{var g,m,S,T;const{gameState:s}=a,u=Vo(o.id,s),c=wu(u),f=Yv(s).filter(A=>A.leaderId!==o.id);for(const A of f){const I=Vo(A.leaderId,s),y=wu(I),C=((m=(g=o.tribeControl)==null?void 0:g.diplomacy)==null?void 0:m[A.leaderId])||Dt.Friendly;c>y*qI?C!==Dt.Hostile&&((S=o.tribeControl)!=null&&S.diplomacy)&&(o.tribeControl.diplomacy[A.leaderId]=Dt.Hostile):C!==Dt.Friendly&&((T=o.tribeControl)!=null&&T.diplomacy)&&(o.tribeControl.diplomacy[A.leaderId]=Dt.Friendly)}return E.SUCCESS},"Evaluate Diplomacy",e+2);return new me([t,new cr(YI,i,"Diplomacy Cooldown",e+1)],"Manage Diplomacy",e)}const qs="huntTarget";function nR(e){return new me([new Ii(new ee((i,o,a)=>{if(!i.isAdult)return[!1,"Not an adult"];if(!i.leaderId)return[!1,"Not in a tribe"];if(!qo(i,_e.Hunter,o.gameState))return[!1,"Not a Hunter"];const s=Me(i.position,o.gameState,"prey",OI,()=>!0);return s?(_.set(a,qs,s.id),[!0,"Found prey"]):[!1,"No suitable prey found"]},"Find Prey Target",e+2),zI,"Cache Find Prey",e+1),new ur(new Nu(new oe((i,o,a)=>{if(!i.leaderId)return E.FAILURE;const s=_.get(a,qs);if(!s)return E.FAILURE;const u=o.gameState.entities.entities[s];if(!u||u.hitpoints<=0)return _.delete(a,qs),i.activeAction="idle",i.attackTargetId=void 0,E.SUCCESS;const{gameState:c}=o,f=ar(i.leaderId,c);return V(i.position,f,c.mapDimensions.width,c.mapDimensions.height)>MI?(_.delete(a,qs),i.activeAction="idle",i.attackTargetId=void 0,E.FAILURE):(i.activeAction="attacking",i.attackTargetId=u.id,E.RUNNING)},"Hunt Prey Action",e+3),kf,"Hunt Prey Timeout",e+2),{taskType:"hunt",maxCapacity:Ih,getTargetId:(i,o,a)=>_.get(a,qs)??null},"Tribal Hunt Task",e+1)],"Human Hunt Prey Sequence",e)}const su="defendTarget",df=150;function iR(e){return new me([new ee((t,i,o)=>{if(!t.isAdult)return[!1,"Not an adult - children flee instead"];if(t.hitpoints<=t.maxHitpoints*.3)return[!1,"Too injured to defend"];const{gameState:a}=i;if(t.activeAction==="attacking"&&t.attackTargetId){const u=a.entities.entities[t.attackTargetId];if(u&&u.type==="predator"&&u.hitpoints>0&&V(t.position,u.position,a.mapDimensions.width,a.mapDimensions.height)<=df)return _.set(o,su,u.id),[!0,"Continuing defense"]}const s=Me(t,a,"predator",df,u=>u.hitpoints>0&&(u.isAdult||!1));if(s){const u=V(t.position,s.position,a.mapDimensions.width,a.mapDimensions.height),c=s.attackTargetId===t.id,f=u<80;if(c||f)return _.set(o,su,s.id),[!0,"Predator threat detected"]}return _.set(o,su,void 0),[!1,"No predator threat"]},"Detect Predator Threat",e+1),new oe((t,i,o)=>{const a=_.get(o,su),s=a&&i.gameState.entities.entities[a];if(!s)return E.FAILURE;const{gameState:u}=i,c=V(t.position,s.position,u.mapDimensions.width,u.mapDimensions.height);return t.hitpoints<t.maxHitpoints*.3?E.FAILURE:s.hitpoints<=0||c>df*1.5?(t.activeAction="idle",t.attackTargetId=void 0,E.SUCCESS):(t.activeAction="attacking",t.attackTargetId=s.id,E.RUNNING)},"Defend Against Predator",e+1)],"Human Defend Against Predator",e)}function rR(e){const t=new oe((i,o)=>{if(!i.leaderId||!i.isAdult)return E.FAILURE;const a=o.gameState.entities.entities[i.leaderId];if(!a||!a.tribeControl)return E.FAILURE;if(i.id===a.id)return i.tribeRole!==_e.Leader&&(i.tribeRole=_e.Leader),E.SUCCESS;const u=ri(a,o.gameState).filter(y=>y.id!==a.id),c=u.length;if(c===0)return E.SUCCESS;const f=a.tribeControl.roleWeights;let g=0;const m=[];for(const y of Object.values(_e))y!==_e.Leader&&(g+=f[y]||0,m.push(y));if(g===0)return i.tribeRole||(i.tribeRole=_e.Gatherer),E.SUCCESS;const S={},T={},A={};for(const y of m)S[y]=0,T[y]=f[y]/g*c;for(const y of u)y.tribeRole&&y.tribeRole!==_e.Leader&&(S[y.tribeRole]=(S[y.tribeRole]||0)+1);for(const y of m)A[y]=T[y]-S[y];let I=!1;if((!i.tribeRole||i.tribeRole===_e.Leader||A[i.tribeRole]<-.5&&m.some(O=>A[O]>.5))&&(I=!0),I){let y=null,C=-1/0;const O=[...m].sort(()=>Math.random()-.5);for(const F of O){const P=A[F];P>C&&(C=P,y=F)}if(y)i.tribeRole=y;else{const F=Math.random()*g;let P=0;for(const H of m)if(P+=f[H],F<=P){i.tribeRole=H;break}}}return E.SUCCESS},"Assign Tribe Role",e+1);return new Ii(t,la,"Cache Tribe Role Assignment",e)}function oR(e){return new me([new ee((t,i,o)=>{const a=Me(t,i.gameState,"predator",Vt*2,()=>!0),s=Me(t,i.gameState,"human",Vt*2,()=>!0);let u=null,c=1/0;if(a){const f=V(t.position,a.position,i.gameState.mapDimensions.width,i.gameState.mapDimensions.height);f<c&&(c=f,u=a)}if(s){const f=V(t.position,s.position,i.gameState.mapDimensions.width,i.gameState.mapDimensions.height);f<c&&(c=f,u=s)}return u&&c<Vt*1.5?(_.set(o,"fleeThreat",u.id),_.set(o,"fleeDistance",c),!0):!1},"Detect Threat",e+1),new oe((t,i,o)=>{const a=_.get(o,"fleeThreat"),s=a&&i.gameState.entities.entities[a];if(!s)return E.FAILURE;t.activeAction="moving";const u=Ye(s.position,t.position,i.gameState.mapDimensions.width,i.gameState.mapDimensions.height),c=lt(u),f=Bn(t.position,Ot(c,Bw));return t.target={x:(f.x%i.gameState.mapDimensions.width+i.gameState.mapDimensions.width)%i.gameState.mapDimensions.width,y:(f.y%i.gameState.mapDimensions.height+i.gameState.mapDimensions.height)%i.gameState.mapDimensions.height},t.direction=c,t.fleeCooldown=i.gameState.time+2,E.RUNNING},"Execute Flee",e+1)],"Prey Flee",e)}function sR(e){return new me([new ee((t,i,o)=>{if(!t.isAdult)return[!1,"Not an adult"];if(t.hunger<=30||t.eatingCooldownTime&&t.eatingCooldownTime>i.gameState.time)return!1;const a=Me(t,i.gameState,"berryBush",Vt*10,s=>s.food.length>0);return a?V(t.position,a.position,i.gameState.mapDimensions.width,i.gameState.mapDimensions.height)<=Vt?(_.set(o,"grazingTarget",a.id),!0):(_.set(o,"grazingTarget",a.id),_.set(o,"needToMoveToTarget",!0),!0):!1},"Find Berry Bush",e+1),new oe((t,i,o)=>{const a=_.get(o,"grazingTarget"),s=a&&i.gameState.entities.entities[a],u=_.get(o,"needToMoveToTarget");if(!s)return E.FAILURE;const c=V(t.position,s.position,i.gameState.mapDimensions.width,i.gameState.mapDimensions.height);if(c<=Vt)return t.activeAction="grazing",t.target=s.id,t.direction={x:0,y:0},_.delete(o,"needToMoveToTarget"),E.RUNNING;if(u||c>Vt){t.activeAction="moving",t.target=s.id;const f=Bt(t.position,s.position,i.gameState.mapDimensions);return t.direction=f,E.RUNNING}return E.FAILURE},"Move to Bush or Graze",e+1)],"Prey Graze",e)}function aR(e){const t=new ee((s,u,c)=>{const f=Me(s,u.gameState,"prey",Vt,g=>g.id!==s.id&&g.gender!==s.gender&&!!g.isAdult&&g.age>=ha&&g.age<=nf&&!g.isPregnant&&(!g.procreationCooldown||g.procreationCooldown<=0)&&g.hunger<200);return f?(_.set(c,"procreationPartner",f.id),!0):!1},"Find Immediate Partner",e+2),i=new oe((s,u,c)=>{const f=_.get(c,"procreationPartner"),g=f&&u.gameState.entities.entities[f];return g?(s.activeAction="procreating",s.target=g.id,s.direction={x:0,y:0},_.delete(c,"procreationPartner"),E.SUCCESS):E.FAILURE},"Start Procreating",e+2),o=new ee((s,u,c)=>{const f=Me(s,u.gameState,"prey",Vt*10,g=>g.id!==s.id&&g.gender!==s.gender&&!!g.isAdult&&g.age>=ha&&g.age<=nf&&!g.isPregnant&&(!g.procreationCooldown||g.procreationCooldown<=0)&&g.hunger<200);return f?(_.set(c,"procreationPartner",f.id),!0):!1},"Locate Distant Partner",e+2),a=new oe((s,u,c)=>{const f=_.get(c,"procreationPartner"),g=f&&u.gameState.entities.entities[f];if(!g)return E.FAILURE;if(V(s.position,g.position,u.gameState.mapDimensions.width,u.gameState.mapDimensions.height)<=Vt)return E.SUCCESS;s.activeAction="moving",s.target=g.id;const S=Ye(s.position,g.position,u.gameState.mapDimensions.width,u.gameState.mapDimensions.height);return s.direction=lt(S),E.RUNNING},"Move Towards Partner",e+2);return new me([new ee(s=>!!(s.isAdult&&!s.isPregnant&&s.age>=ha&&s.age<=nf&&s.hunger<200&&(!s.procreationCooldown||s.procreationCooldown<=0)),"Is Fertile and Ready",e+1),new Xt([new me([t,i],"Procreate With Immediate Partner",e+2),new me([o,a],"Seek Distant Partner",e+2)],"Find Partner And Procreate",e+1)],"Prey Procreate",e)}const lR=(e,t,i)=>{const o=t.gameState.search.prey.byProperty("motherId",e.id).filter(u=>!u.isAdult&&u.type==="prey");if(o.length===0)return E.FAILURE;let a=null,s=Wu;for(const u of o)u.hunger>=s&&(s=u.hunger,a=u);return a?(_.set(i,"targetChild",a.id),E.SUCCESS):E.FAILURE},uR=(e,t,i)=>{const o=_.get(i,"targetChild"),a=o&&t.gameState.entities.entities[o];return a?V(e.position,a.position,t.gameState.mapDimensions.width,t.gameState.mapDimensions.height)>rs?(e.activeAction="moving",e.target=a.id,e.direction=Bt(e.position,a.position,t.gameState.mapDimensions),E.RUNNING):(e.activeAction="feeding",e.target=void 0,_.set(i,"targetChild",void 0),E.SUCCESS):E.FAILURE};function cR(e){return new me([new ee(t=>(t.isAdult&&t.gender==="female"&&t.hunger<80&&(!t.feedChildCooldownTime||t.feedChildCooldownTime<=0))??!1,"Can Feed Child (Female Only)",e+1),new oe(lR,"Find Hungriest Prey Child",e+1),new oe(uR,"Move To Child and Feed",e+1)],"Feed Prey Child",e)}function dR(e){return new me([new ee(t=>!t.isAdult&&t.hunger>=Wu,"Is Hungry Prey Child",e+1),new oe((t,i,o)=>{if(!t.motherId)return E.FAILURE;const a=i.gameState.entities.entities[t.motherId];return a?(_.set(o,"targetParent",a.id),E.SUCCESS):E.FAILURE},"Find Female Parent",e+1),new oe((t,i,o)=>{const a=_.get(o,"targetParent"),s=a&&i.gameState.entities.entities[a];if(!s)return E.FAILURE;const u=V(t.position,s.position,i.gameState.mapDimensions.width,i.gameState.mapDimensions.height);return t.activeAction="idle",u<=rs?(t.target=void 0,E.SUCCESS):(t.target=s.id,t.activeAction="moving",E.RUNNING)},"Move To Female Parent",e+1)],"Seek Food From Female Parent",e)}const Qs="huntTarget";function fR(e,t,i){if(!(e!=null&&e.aiBlackboard))return!0;const o=`tribal_hunt_${t}`,a=_.get(e.aiBlackboard,o);return!a||i-a.startTime>Zo?!0:a.memberIds.length<(a.maxCapacity||Ih)}function hR(e,t){if(!(e!=null&&e.aiBlackboard))return 0;const i=`tribal_hunt_${t}`,o=_.get(e.aiBlackboard,i);return(o==null?void 0:o.memberIds.length)??0}function gR(e){return new me([new ee((t,i,o)=>{if(!t.isAdult)return[!1,"Not an adult"];if(t.hunger<=50||t.huntCooldown&&t.huntCooldown>0)return!1;const a=Me(t,i.gameState,"prey",Do*10,s=>{if(s.hitpoints<=0)return!1;const u=jr(t,i.gameState);return!(u&&!fR(u,s.id,i.gameState.time))});if(a){const s=V(t.position,a.position,i.gameState.mapDimensions.width,i.gameState.mapDimensions.height),u=jr(t,i.gameState),c=u?hR(u,a.id):0;if(s<=Do)return _.set(o,Qs,a.id),[!0,`Prey in range (${c} hunters)`];if(s<=Do*10)return _.set(o,Qs,a.id),_.set(o,"needToApproach",!0),[!0,`Approaching prey (${c} hunters)`]}return!1},"Find Prey Target",e+1),new ur(new Nu(new oe((t,i,o)=>{const a=_.get(o,Qs),s=a&&i.gameState.entities.entities[a],u=_.get(o,"needToApproach");if(!s||s.hitpoints<=0)return _.delete(o,Qs),_.delete(o,"needToApproach"),E.SUCCESS;const c=V(t.position,s.position,i.gameState.mapDimensions.width,i.gameState.mapDimensions.height);if(c<=Do)return t.activeAction="attacking",t.attackTargetId=s.id,t.target=s.id,t.direction={x:0,y:0},_.delete(o,"needToApproach"),E.RUNNING;if(u||c>Do){t.activeAction="moving",t.target=s.id;const f=Ye(t.position,s.position,i.gameState.mapDimensions.width,i.gameState.mapDimensions.height);return t.direction=lt(f),E.RUNNING}return E.FAILURE},"Hunt or Approach Prey",e+3),10,"Hunt Timeout (10 hour)",e+2),{taskType:"hunt",maxCapacity:Ih,getTargetId:(t,i,o)=>_.get(o,Qs)},"Tribal Hunt Decorator",e+1)],"Predator Hunt",e)}function pR(e){return new me([new ee((t,i,o)=>{const a=t.hunger>100,s=t.hitpoints<t.maxHitpoints*.5;if(!a&&!s||t.attackCooldown&&t.attackCooldown>0)return!1;const u=Me(t,i.gameState,"human",Fn*2,c=>c.hitpoints>0);if(u){const c=V(t.position,u.position,i.gameState.mapDimensions.width,i.gameState.mapDimensions.height);if(c<=Fn)return _.set(o,"attackTarget",u.id),!0;if(a&&c<=Fn*2)return _.set(o,"attackTarget",u.id),_.set(o,"needToApproach",!0),!0}return!1},"Find Human Target",e+1),new oe((t,i,o)=>{const a=_.get(o,"attackTarget"),s=a&&i.gameState.entities.entities[a],u=_.get(o,"needToApproach");if(!s||s.hitpoints<=0)return E.FAILURE;const c=V(t.position,s.position,i.gameState.mapDimensions.width,i.gameState.mapDimensions.height);if(c<=Fn)return t.activeAction="attacking",t.attackTargetId=s.id,t.target=s.id,t.direction={x:0,y:0},_.delete(o,"needToApproach"),E.RUNNING;if(u||c>Fn){t.activeAction="moving",t.target=s.id;const f=Ye(t.position,s.position,i.gameState.mapDimensions.width,i.gameState.mapDimensions.height);return t.direction=lt(f),E.RUNNING}return E.FAILURE},"Attack or Approach Human",e+1)],"Predator Attack Human",e)}function mR(e){const t=new ee((s,u,c)=>{const f=Me(s,u.gameState,"predator",rr,g=>g.id!==s.id&&g.gender!==s.gender&&!!g.isAdult&&g.age>=ga&&g.age<=rf&&!g.isPregnant&&(!g.procreationCooldown||g.procreationCooldown<=0)&&g.hunger<200);return f?(_.set(c,"procreationPartner",f.id),!0):!1},"Find Immediate Partner",e+2),i=new oe((s,u,c)=>{const f=_.get(c,"procreationPartner"),g=f&&u.gameState.entities.entities[f];return g?(s.activeAction="procreating",s.target=g.id,s.direction={x:0,y:0},_.delete(c,"procreationPartner"),E.SUCCESS):E.FAILURE},"Start Procreating",e+2),o=new ee((s,u,c)=>{const f=Me(s,u.gameState,"predator",rr*10,g=>g.id!==s.id&&g.gender!==s.gender&&!!g.isAdult&&g.age>=ga&&g.age<=rf&&!g.isPregnant&&(!g.procreationCooldown||g.procreationCooldown<=0)&&g.hunger<200);return f?(_.set(c,"procreationPartner",f.id),!0):!1},"Locate Distant Partner",e+2),a=new oe((s,u,c)=>{const f=_.get(c,"procreationPartner"),g=f&&u.gameState.entities.entities[f];if(!g)return E.FAILURE;if(V(s.position,g.position,u.gameState.mapDimensions.width,u.gameState.mapDimensions.height)<=rr)return E.SUCCESS;s.activeAction="moving",s.target=g.id;const S=Ye(s.position,g.position,u.gameState.mapDimensions.width,u.gameState.mapDimensions.height);return s.direction=lt(S),E.RUNNING},"Move Towards Partner",e+2);return new me([new ee(s=>!!(s.isAdult&&!s.isPregnant&&s.age>=ga&&s.age<=rf&&s.hunger<200&&(!s.procreationCooldown||s.procreationCooldown<=0)),"Is Fertile and Ready",e+1),new Xt([new me([t,i],"Procreate With Immediate Partner",e+2),new me([o,a],"Seek Distant Partner",e+2)],"Find Partner And Procreate",e+1)],"Predator Procreate",e)}const vR=(e,t,i)=>{const o=t.gameState.search.predator.byProperty("motherId",e.id).filter(u=>!u.isAdult&&u.type==="predator");if(o.length===0)return E.FAILURE;let a=null,s=Wu;for(const u of o)u.hunger>=s&&(s=u.hunger,a=u);return a?(_.set(i,"targetChild",a.id),E.SUCCESS):E.FAILURE},SR=(e,t,i)=>{const o=_.get(i,"targetChild"),a=o&&t.gameState.entities.entities[o];return a?V(e.position,a.position,t.gameState.mapDimensions.width,t.gameState.mapDimensions.height)>rs?(e.activeAction="moving",e.target=a.id,e.direction=Bt(e.position,a.position,t.gameState.mapDimensions),E.RUNNING):(e.activeAction="feeding",e.target=void 0,_.set(i,"targetChild",void 0),E.SUCCESS):E.FAILURE};function yR(e){return new me([new ee(t=>(t.isAdult&&t.gender==="female"&&t.hunger<90&&(!t.feedChildCooldownTime||t.feedChildCooldownTime<=0))??!1,"Can Feed Child (Female Only)",e+1),new oe(vR,"Find Hungriest Predator Child",e+1),new oe(SR,"Move To Child and Feed",e+1)],"Feed Predator Child",e)}function AR(e){return new me([new ee(t=>!t.isAdult&&t.hunger>=Wu,"Is Hungry Predator Child",e+1),new oe((t,i,o)=>{if(!t.motherId)return E.FAILURE;const a=i.gameState.entities.entities[t.motherId];return a?(_.set(o,"targetParent",a.id),E.SUCCESS):E.FAILURE},"Find Female Parent",e+1),new oe((t,i,o)=>{const a=_.get(o,"targetParent"),s=a&&i.gameState.entities.entities[a];if(!s)return E.FAILURE;const u=V(t.position,s.position,i.gameState.mapDimensions.width,i.gameState.mapDimensions.height);return t.activeAction="idle",u<=rs?(t.target=void 0,E.SUCCESS):(t.target=s.id,t.activeAction="moving",E.RUNNING)},"Move To Female Parent",e+1)],"Seek Food From Female Parent",e)}function MS(e){return new oe((t,i,o)=>{t.activeAction="idle";let a=_.get(o,"wanderTarget"),s=_.get(o,"wanderStartTime");const u=i.gameState.time;if(!a||!s||u-s>2){const c=Math.random()*2*Math.PI,f=50+Math.random()*100,g={x:Math.cos(c),y:Math.sin(c)},m=Bn(t.position,Ot(g,f));a={x:(m.x%i.gameState.mapDimensions.width+i.gameState.mapDimensions.width)%i.gameState.mapDimensions.width,y:(m.y%i.gameState.mapDimensions.height+i.gameState.mapDimensions.height)%i.gameState.mapDimensions.height},_.set(o,"wanderTarget",a),_.set(o,"wanderStartTime",u)}if(a){t.target=a;let c=a.x-t.position.x,f=a.y-t.position.y;const g=i.gameState.mapDimensions.width,m=i.gameState.mapDimensions.height;Math.abs(c)>g/2&&(c=c>0?c-g:c+g),Math.abs(f)>m/2&&(f=f>0?f-m:f+m);const S=lt({x:c,y:f});t.direction=S}return E.SUCCESS},"Animal Wander",e)}function TR(e){return new me([new ee((t,i,o)=>{if(t.hunger>90||t.hitpoints<t.maxHitpoints*.3||t.activeAction==="grazing"||t.activeAction==="procreating")return!1;const a=Object.values(i.gameState.entities.entities),s=[];for(const u of a)if(u.type==="prey"&&u.id!==t.id){const c=u;c.hitpoints>0&&c.isAdult&&V(t.position,c.position,i.gameState.mapDimensions.width,i.gameState.mapDimensions.height)<=Vt*5&&s.push(c)}if(s.length>=2){let u=0,c=0;for(const m of s)u+=m.position.x,c+=m.position.y;u/=s.length,c/=s.length;const f={x:u,y:c};if(V(t.position,f,i.gameState.mapDimensions.width,i.gameState.mapDimensions.height)>Vt*2)return _.set(o,"herdCenter",f),_.set(o,"herdSize",s.length),!0}return!1},"Find Herd",e+1),new oe((t,i,o)=>{const a=_.get(o,"herdCenter");if(!a)return E.FAILURE;if(V(t.position,a,i.gameState.mapDimensions.width,i.gameState.mapDimensions.height)>Vt*2){t.activeAction="moving",t.target=a;const u=Ye(t.position,a,i.gameState.mapDimensions.width,i.gameState.mapDimensions.height);return t.direction=lt(u),E.RUNNING}else return t.activeAction="idle",t.direction={x:0,y:0},E.SUCCESS},"Join Herd",e+1)],"Prey Herd Behavior",e)}function IR(e){return new me([new ee((t,i,o)=>{if(t.hunger>100||t.hitpoints<t.maxHitpoints*.4||t.activeAction==="attacking"||t.activeAction==="procreating")return!1;const a=Me(t,i.gameState,"predator",rr*4,s=>s.id!==t.id&&s.hitpoints>0&&s.isAdult&&t.fatherId!==void 0&&s.fatherId===t.fatherId&&s.age>=t.age||s.hitpoints>t.hitpoints);return a&&V(t.position,a.position,i.gameState.mapDimensions.width,i.gameState.mapDimensions.height)>rr*2?(_.set(o,"packLeader",a.id),!0):!1},"Find Pack Leader",e+1),new oe((t,i,o)=>{const a=_.get(o,"packLeader"),s=a&&i.gameState.entities.entities[a];if(!s||s.hitpoints<=0)return E.FAILURE;if(V(t.position,s.position,i.gameState.mapDimensions.width,i.gameState.mapDimensions.height)>rr*2){t.activeAction="moving",t.target=s.id;const c=Ye(t.position,s.position,i.gameState.mapDimensions.width,i.gameState.mapDimensions.height);return t.direction=lt(c),E.RUNNING}else return t.activeAction="idle",t.direction={x:0,y:0},E.SUCCESS},"Follow Pack Leader",e+1)],"Predator Pack Behavior",e)}function ER(e){return new me([new ee((t,i,o)=>{if(!t.isAdult||t.hitpoints<t.maxHitpoints*.6||t.hunger>120||t.attackCooldown&&t.attackCooldown>0)return!1;const a=Me(t,i.gameState,"predator",R0,s=>!!(s.id!==t.id&&s.hitpoints>0&&s.isAdult&&t.fatherId!==s.fatherId&&t.gender===s.gender&&t.fatherId!==void 0&&s.fatherId!==void 0));if(a){const s=V(t.position,a.position,i.gameState.mapDimensions.width,i.gameState.mapDimensions.height);if(s<=Fn)return _.set(o,"territorialTarget",a.id),!0;if(s<=R0)return _.set(o,"territorialTarget",a.id),_.set(o,"needToApproach",!0),!0}return!1},"Find Territorial Rival",e+1),new oe((t,i,o)=>{const a=_.get(o,"territorialTarget"),s=a&&i.gameState.entities.entities[a],u=_.get(o,"needToApproach");if(!s||s.hitpoints<=0)return E.FAILURE;const c=V(t.position,s.position,i.gameState.mapDimensions.width,i.gameState.mapDimensions.height);if(c<=Fn)return t.activeAction="attacking",t.attackTargetId=s.id,t.target=s.id,t.direction={x:0,y:0},_.delete(o,"needToApproach"),E.RUNNING;if(u||c>Fn){t.activeAction="moving",t.target=s.id;const f=Ye(t.position,s.position,i.gameState.mapDimensions.width,i.gameState.mapDimensions.height);return t.direction=lt(f),E.RUNNING}return E.FAILURE},"Territorial Fight or Approach",e+1)],"Predator Territorial Defense",e)}function CR(){const e=new Xt([I1(2),K1(2),new Tn(iR(2),"attack","Gated Defend Against Predator",2),new Tn(X1(2),"attack","Gated Jealousy Attack",2),new Tn(Z1(2),"attack","Gated Desperate Attack",2),Q1(2),new v1(new S1(rR(4),"Role Assignment Success",3),"Role Assignment Gate",2),new To(x1(3),"Gated Leader Combat Strategy",2),new To(tR(3),"Gated Diplomacy",2),new To(new Xt([new Ii(z1(5),la,"Cache Take Over Building",4),new Ii(Y1(5),la,"Cache Remove Enemy Building",4)],"Building Interaction Selector",3),"Gated Leader Building Interactions",2),new Tn(new Ii(W1(4),SE,"Cache Building Placement",3),"build","Gated Leader Building Placement",2),$1(2),G1(2),new Tn(D1(3),"attack","Gated Attacking",2),T1(2),b1(2),new Tn(N1(3),"procreation","Gated Procreation",2),new Nu(new Tn(R1(4),"gathering","Gated Gathering",3),kf,"Timeout Gathering",2),new Tn(H1(3),"gathering","Gated Storage Deposit",2),new Tn(k1(3),"feedChildren","Gated Feed Child",2),F1(2),new Nu(new Tn(B1(4),"planting","Gated Planting",3),kf,"Timeout Planting",2),new Tn(nR(3),"attack","Gated Hunt Prey",2),new Ii(V1(3),la,"Cache Tribe Split",2),new To(eR(3),"Gated Tribe Migration",2),new Tn(J1(3),"followLeader","Gated Follow Leader",2),new To(j1(2),"Gated Follow Patriarch",2),new To(P1(2),"Gated Idle Wander",2)],"AI Root Selector",1);return new y1(e,"Manual Control Gate",0)}const kS=CR();function _R(e,t){e.aiBlackboard&&_.cleanupOldEntries(e.aiBlackboard,t.gameState.time);const i=jr(e,t.gameState);i&&i.id===e.id&&i.aiBlackboard&&A1(i,t.gameState.time);const o=performance.now();switch(e.aiType){case Ma.BehaviorTreeBased:default:Th(e,t,kS);break}t.gameState.performanceMetrics.currentBucket.aiUpdateTime+=performance.now()-o}function wR(){return new Xt([oR(1),cR(1),dR(1),sR(1),aR(1),TR(1),MS(1)],"Prey Behavior Root",0)}function RR(){return new Xt([gR(1),pR(1),yR(1),AR(1),ER(1),mR(1),IR(1),MS(1)],"Predator Behavior Root",0)}const FS=wR();function PR(e,t){e.aiBlackboard?Th(e,t,FS):(console.warn(`Behavior Tree AI ticked for prey ${e.id}, but the tree or blackboard was missing.`),e.activeAction="idle")}const LS=RR();function NR(e,t){e.aiBlackboard?Th(e,t,LS):(console.warn(`Behavior Tree AI ticked for predator ${e.id}, but the tree or blackboard was missing.`),e.activeAction="idle")}function DR(e,t){const{gameState:i,deltaTime:o}=t,a=o*(Ct/_t);if(e.isBeingDestroyed){const s=ew(e.buildingType);if(s>0?e.destructionProgress+=a/s:e.destructionProgress=1,e.destructionProgress>=1){ss(i.entities,e.id);return}}if(!e.isConstructed&&!e.isBeingDestroyed){const s=J_(e.buildingType);s>0?e.constructionProgress+=a/s:e.constructionProgress=1,e.constructionProgress>=1&&(e.constructionProgress=1,e.isConstructed=!0)}}function OR(e,t){e.forces.push(Ot(e.velocity,-.1));const i=Ot(lt(e.direction),e.acceleration);e.forces.push(i),e.debuffs.forEach(o=>{t.gameState.time-o.startTime<o.duration&&o.type==="slow"&&(e.velocity=Ot(e.velocity,.5))}),e.debuffs=e.debuffs.filter(o=>t.gameState.time-o.startTime<o.duration),e.velocity=Bn(e.velocity,e.forces.reduce(Bn,{x:0,y:0})),jo(e.velocity)<.001&&(e.velocity={x:0,y:0}),e.position=Bn(e.position,Ot(e.velocity,t.deltaTime)),e.position.x=(e.position.x%t.gameState.mapDimensions.width+t.gameState.mapDimensions.width)%t.gameState.mapDimensions.width,e.position.y=(e.position.y%t.gameState.mapDimensions.height+t.gameState.mapDimensions.height)%t.gameState.mapDimensions.height,e.forces=[],e.type==="human"?d1(e,t,t.deltaTime):e.type==="corpse"?f1(e,t):e.type==="prey"?h1(e,t,t.deltaTime):e.type==="predator"?g1(e,t,t.deltaTime):e.type==="building"&&DR(e,t),e.type==="human"&&_R(e,t),e.type==="prey"?PR(e,t):e.type==="predator"&&NR(e,t),e.stateMachine&&(e.stateMachine=c1(...e.stateMachine,{entity:e,updateContext:t}))}function MR(e){const t=e.gameState.entities;Object.values(t.entities).forEach(i=>{OR(i,e)})}function US(){return{entities:{},nextEntityId:1}}function os(e,t,i){const o={id:e.nextEntityId++,type:t,velocity:{x:0,y:0},direction:{x:0,y:0},acceleration:0,forces:[],debuffs:[],...i};return e.entities[o.id]=o,o}function ka(e,t,i){return os(e,"berryBush",{position:t,radius:Of,food:Array.from({length:II},()=>({type:Hn.Berry})).map(a=>({...a,id:e.nextEntityId++})),maxFood:TI,lifespan:CI,age:0,spreadRadius:Of,timeSinceLastBerryRegen:0,timeSinceLastSpreadAttempt:0,timeSinceLastHarvest:0,stateMachine:[aa,{enteredAt:i,previousState:void 0}]})}function bo(e,t,i,o,a=!1,s=_E,u=bv,c,f,g=[],m,S){const T=s>=th;return os(e,"human",{position:t,radius:T?wt:ns,hunger:u,hitpoints:t0,maxHitpoints:t0,age:s,gender:o,isPlayer:a,food:[],maxFood:Hv,maxAge:Aa,isAdult:T,isPregnant:!1,gestationTime:0,procreationCooldown:0,attackCooldown:0,motherId:c,fatherId:f,ancestorIds:g,stateMachine:[ft,{enteredAt:i,previousState:void 0}],leaderId:m,tribeBadge:S,aiType:Ma.BehaviorTreeBased,aiBlackboard:_.create()})}function Ch(e,t,i,o,a,s,u,c,f,g,m){let S,T;switch(u){case"human":S=xv,T=zr;break;case"prey":S=2,T=120;break;case"predator":S=4,T=140;break}return os(e,"corpse",{position:t,radius:a,gender:i,age:o,originalEntityId:s,originalEntityType:u,timeOfDeath:c,decayProgress:0,geneCode:m,food:[...Array.from({length:Math.max(S*Math.max(T-g,0)/T,0)},()=>({type:Hn.Meat})),...f].map(I=>({...I,id:e.nextEntityId++})),stateMachine:void 0})}function kR(e,t,i,o,a,s,u,c,f){return Ch(e,t,i,o,a,s,"human",u,c,f)}function FR(e,t,i,o,a,s,u,c){return Ch(e,t,i,o,a,s,"prey",u,[],0,c)}function LR(e,t,i,o,a,s,u,c){return Ch(e,t,i,o,a,s,"predator",u,[],0,c)}function UR(e,t,i){const o=t?i.gameState.entities.entities[t]:void 0,a=[...e.ancestorIds||[],e.id],s=o?[...o.ancestorIds||[],o.id]:[],u=[...a,...s],c=[...new Set(u)],f=c.slice(Math.max(c.length-TE,0)),g=Math.random()<.5?"male":"female",m=Bn(e.position,{x:5,y:5}),S=bo(i.gameState.entities,m,i.gameState.time,g,!1,0,bv/2,e.id,t,f,(o==null?void 0:o.leaderId)??e.leaderId,(o==null?void 0:o.tribeBadge)??e.tribeBadge);return we(i,ge.Birth,e.position),S}function ss(e,t){return e.entities[t]?(delete e.entities[t],!0):!1}function Qo(e,t,i,o=Uw,a=TS,s,u,c){const f=o>=ha,g=Date.now();return os(e,"prey",{position:t,radius:f?wt*.7:ns*.7,hunger:a,hitpoints:_0,maxHitpoints:_0,age:o,maxAge:AS,gender:i,isAdult:f,isPregnant:!1,gestationTime:0,procreationCooldown:0,geneCode:s,motherId:u,fatherId:c,stateMachine:[kn,{enteredAt:g,previousState:void 0}],aiType:Ma.BehaviorTreeBased,aiBlackboard:_.create()})}function Jo(e,t,i,o=zw,a=ES,s,u,c){const f=o>=ga,g=Date.now();return os(e,"predator",{position:t,radius:f?wt*.9:ns*.9,hunger:a,hitpoints:w0,maxHitpoints:w0,age:o,maxAge:IS,gender:i,isAdult:f,isPregnant:!1,gestationTime:0,procreationCooldown:0,geneCode:s,motherId:u,fatherId:c,stateMachine:[jt,{enteredAt:g,previousState:void 0}],aiType:Ma.BehaviorTreeBased,aiBlackboard:_.create()})}function BR(e,t,i,o){const a=pS(i),s={position:t,radius:Math.max(a.width,a.height)/2,buildingType:i,ownerId:o,width:a.width,height:a.height,constructionProgress:0,destructionProgress:0,isConstructed:!1,isBeingDestroyed:!1};return os(e,"building",{...s,...i===ni.StorageSpot&&{storedFood:[],storageCapacity:z_,lastDepositTime:0,lastRetrieveTime:0,lastStealTime:0}})}var Wt=(e=>(e.MOVE="MOVE",e.HUNGER="HUNGER",e.EAT="EAT",e.FIND_BUSH="FIND_BUSH",e.GATHER="GATHER",e.PROCREATE="PROCREATE",e.PLANT_BUSH="PLANT_BUSH",e.AUTOPILOT="AUTOPILOT",e.ANIMALS_INTRODUCTION="ANIMALS_INTRODUCTION",e.HUNT_PREY="HUNT_PREY",e.DEFEND_FROM_PREDATORS="DEFEND_FROM_PREDATORS",e))(Wt||{}),Gr=(e=>(e.HUNGER_BAR="HUNGER_BAR",e.FOOD_BAR="FOOD_BAR",e.COMMAND_BUTTONS="COMMAND_BUTTONS",e))(Gr||{}),zt=(e=>(e[e.FADING_IN=0]="FADING_IN",e[e.ACTIVE=1]="ACTIVE",e[e.FADING_OUT=2]="FADING_OUT",e[e.INACTIVE=3]="INACTIVE",e))(zt||{});const Hf={},bf={},HR=[{key:Wt.MOVE,title:"Movement",text:"Use WASD or Arrow Keys to move your character around the world.",condition:e=>e.hasPlayerMovedEver||e.hasPlayerEnabledAutopilot>2,isCompleted:!1},{key:Wt.HUNGER,title:"Hunger",text:"Your character gets hungry over time. Watch the hunger bar!",condition:(e,t)=>t.hunger>IE,isCompleted:!1,minDisplayTime:v0,highlightedUIElements:[Gr.HUNGER_BAR]},{key:Wt.FIND_BUSH,title:"Find Food",text:"Look for berry bushes. They are your primary source of food.",condition:(e,t)=>!!Me(t,e,"berryBush",St*5,o=>o.food.length>0),getTargets:(e,t)=>{const i=[];for(const o of Object.values(e.entities.entities))o.type==="berryBush"&&o.food.length>0&&V(t.position,o.position,e.mapDimensions.width,e.mapDimensions.height)<500&&i.push(o);return i.map(o=>o.id)},isCompleted:!1,minDisplayTime:v0},{key:Wt.GATHER,title:"Gather Berries",text:"Get close to a bush and press 'E' to gather berries.",condition:(e,t)=>t.food.length>0,getTargets:(e,t)=>{const i=Me(t,e,"berryBush",St,o=>o.food.length>0);return i?[i.id]:[]},isCompleted:!1},{key:Wt.EAT,title:"Eat",text:"When you are hungry and have food, press 'F' to eat.",condition:(e,t)=>t.activeAction==="eating",isCompleted:!1,highlightedUIElements:[Gr.FOOD_BAR]},{key:Wt.PROCREATE,title:"Procreate",text:"Find a mate and press 'R' to start a family. This is how you continue your lineage.",condition:(e,t)=>dn(e,t).length>0,getTargets:(e,t)=>{const i=Me(t,e,"human",St,o=>Vr(t,o,e));return i?[i.id]:[]},isCompleted:!1},{key:Wt.PLANT_BUSH,title:"Farming",text:"You can plant new berry bushes. Carry some berries and press 'B' to plant.",condition:(e,t)=>vh(e,t).some(o=>o.type===ce.Plant)||e.hasPlayerPlantedBush===!0,isCompleted:!1},{key:Wt.AUTOPILOT,title:"Autopilot!",text:"You can turn autopilot for specific actions, press Shift and click on the action button to enable it.",condition:e=>e.hasPlayerEnabledAutopilot>2,highlightedUIElements:[Gr.COMMAND_BUTTONS],isCompleted:!1},{key:Wt.ANIMALS_INTRODUCTION,title:"Wild Animals!",text:"Your world now has wild animals! Prey provide meat when hunted, but beware of predators that may attack.",condition:e=>Object.values(e.entities.entities).some(i=>i.type==="prey"||i.type==="predator"),isCompleted:!1,dependsOn:Wt.AUTOPILOT},{key:Wt.HUNT_PREY,title:"Hunt for Meat",text:"Click on prey animals to hunt them for meat. Hunting provides more food than gathering berries!",condition:(e,t)=>{const i=Me(t,e,"prey",150);return t.hunger>40&&!!i},getTargets:(e,t)=>{const i=Me(t,e,"prey",150);return i?[i.id]:[]},isCompleted:!1,dependsOn:Wt.ANIMALS_INTRODUCTION},{key:Wt.DEFEND_FROM_PREDATORS,title:"Predators",text:"Predators may attack when hungry! Click on them to fight back. Fighting together with family is more effective.",condition:(e,t)=>!!Me(t,e,"predator",120),getTargets:(e,t)=>{const i=Me(t,e,"predator",120);return i?[i.id]:[]},isCompleted:!1,dependsOn:Wt.HUNT_PREY}].map(e=>({...e,condition:e.condition?xR(e.condition):void 0,getTargets:e.getTargets?$R(e.getTargets):void 0}));function BS(){return{steps:HR.map(e=>({...e,isCompleted:!1}))}}function HS(){return{currentStepIndex:0,completedSteps:[],isActive:!0,transitionState:zt.FADING_IN,transitionAlpha:0,highlightedEntityIds:[],stepStartTime:null,activeUIHighlights:[]}}function bR(e){for(let t=0;t<e.tutorial.steps.length;t++){const i=e.tutorial.steps[t];if(!i.isCompleted)if(i.dependsOn){if(e.tutorialState.completedSteps.includes(i.dependsOn))return t}else return t}return null}function GR(e,t){const i=e.tutorialState;if(!i.isActive){i.transitionState=zt.INACTIVE,i.highlightedEntityIds=[],i.activeUIHighlights=[];return}const o=pt(e);if(!o){i.isActive=!1,i.transitionState=zt.INACTIVE,i.highlightedEntityIds=[],i.activeUIHighlights=[];return}const a=e.tutorial.steps[i.currentStepIndex];if(!a){i.isActive=!1,i.transitionState=zt.INACTIVE,i.highlightedEntityIds=[],i.activeUIHighlights=[];return}const s=1/n_;switch(i.transitionState){case zt.FADING_IN:i.stepStartTime===null&&(i.stepStartTime=e.time),i.transitionAlpha+=s*t,i.transitionAlpha>=1&&(i.transitionAlpha=1,i.transitionState=zt.ACTIVE);break;case zt.ACTIVE:{const f=e.time-(i.stepStartTime||e.time)>=(a.minDisplayTime||0),g=Hf[a.condition];g&&f&&g(e,o)&&(a.isCompleted=!0,i.completedSteps.includes(a.key)||i.completedSteps.push(a.key),i.transitionState=zt.FADING_OUT);break}case zt.FADING_OUT:if(i.transitionAlpha-=s*t,i.transitionAlpha<=0){i.transitionAlpha=0,i.stepStartTime=null;const c=bR(e);c!==null?(i.currentStepIndex=c,i.transitionState=zt.FADING_IN):(i.isActive=!1,i.transitionState=zt.INACTIVE)}break}if(i.transitionState!==zt.FADING_OUT&&i.transitionState!==zt.INACTIVE){const c=bf[a.getTargets||""];c?i.highlightedEntityIds=[...c(e,o)]:i.highlightedEntityIds=[],a.highlightedUIElements?i.activeUIHighlights=[...a.highlightedUIElements]:i.activeUIHighlights=[]}else i.highlightedEntityIds=[],i.activeUIHighlights=[]}function xR(e){const t=`condition_${Object.keys(Hf).length+1}`;return Hf[t]=e,t}function $R(e){const t=`getTargets_${Object.keys(bf).length+1}`;return bf[t]=e,t}function WR(){const e=US(),t=0;for(let S=0;S<Dv;S++){const T={x:Math.random()*Ke,y:Math.random()*tt};ka(e,T,t)}const i=Ke/2,o=tt/2,a=bo(e,{x:i-25,y:o},t,"male",!0);bo(e,{x:i+25,y:o},t,"female",!1);for(let S=0;S<5;S++){const T=S/5*Math.PI*2,A=Ke/2,I=tt/2,y={x:i+Math.cos(T)*A,y:o+Math.sin(T)*I};bo(e,{x:y.x,y:y.y},t,"male",!1),bo(e,{x:y.x+50,y:y.y},t,"female",!1)}for(let S=0;S<wS;S++){const T={x:i+Ke*(Math.random()-Math.random()),y:o+tt*(Math.random()-Math.random())};Qo(e,T,"male",void 0,void 0,_a()),Qo(e,{x:T.x+20,y:T.y},"female",void 0,void 0,_a())}const s={x:i+Ke*(Math.random()-Math.random()),y:o+tt*(Math.random()-Math.random())};Jo(e,s,"male",void 0,void 0,wa()),Jo(e,{x:s.x+20,y:s.y},"female",void 0,void 0,wa());const u=[{id:"muteButton",action:re.ToggleMute,currentWidth:vi,rect:{x:0,y:0,width:0,height:0},text:"",backgroundColor:"",textColor:Yt},{id:"pauseButton",action:re.TogglePause,currentWidth:vi,rect:{x:0,y:0,width:0,height:0},text:"",backgroundColor:"",textColor:Yt},{id:"returnToIntroButton",action:re.ReturnToIntro,currentWidth:vi,rect:{x:0,y:0,width:0,height:0},text:"EXIT",backgroundColor:"",textColor:Yt}],c=BS(),f=HS(),g={time:t,entities:e,mapDimensions:{width:Ke,height:tt},generationCount:1,gameOver:!1,visualEffects:[],nextVisualEffectId:0,viewportCenter:{...a.position},isPaused:!1,exitConfirmation:"inactive",autopilotControls:{behaviors:{procreation:!1,planting:!1,gathering:!1,attack:!1,feedChildren:!0,followLeader:!1,build:!1},hoveredAutopilotAction:void 0,activeAutopilotAction:void 0,isManuallyMoving:!1},buildMenuOpen:!1,roleManagerOpen:!1,selectedBuildingType:null,selectedBuildingForRemoval:null,hasPlayerMovedEver:!1,hasPlayerPlantedBush:!1,hasPlayerEnabledAutopilot:0,masterVolume:hS,isMuted:!1,uiButtons:u,tutorial:c,tutorialState:f,debugPanel:Ve.None,performanceMetrics:{currentBucket:{renderTime:0,worldUpdateTime:0,aiUpdateTime:0},history:[]},hoveredButtonId:void 0,mousePosition:{x:0,y:0},notifications:[{id:"welcome",type:Ia.Hello,message:"Welcome to the game!",duration:50,targetEntityIds:[a.id],highlightedEntityIds:[a.id],timestamp:0,isDismissed:!1,creationTime:Date.now()}],ecosystem:{preyGestationPeriod:Lr,preyProcreationCooldown:Ur,predatorGestationPeriod:Br,predatorProcreationCooldown:Hr,preyHungerIncreasePerHour:er,predatorHungerIncreasePerHour:tr,berryBushSpreadChance:Ti},autosaveIntervalSeconds:5,lastAutosaveTime:Date.now()},m=Ou(g);return console.log("Game world initialized:",m),m}function zR(){const e=US(),t=0;for(let u=0;u<Dv;u++){const c={x:Math.random()*Ke,y:Math.random()*tt};ka(e,c,t)}for(let u=0;u<SI;u++){const c={x:Math.random()*Ke,y:Math.random()*tt},f=Math.random()<.5?"male":"female";bo(e,c,t,f,!1)}for(let u=0;u<wS;u++){const c={x:Math.random()*Ke,y:Math.random()*tt};Qo(e,c,"male",void 0,void 0,_a()),Qo(e,{x:c.x+20,y:c.y},"female",void 0,void 0,_a())}const i={x:Math.random()*Ke,y:Math.random()*tt};Jo(e,i,"male",void 0,void 0,wa()),Jo(e,{x:i.x+20,y:i.y},"female",void 0,void 0,wa());const o=BS(),a=HS(),s={time:t,entities:e,mapDimensions:{width:Ke,height:tt},generationCount:0,gameOver:!1,visualEffects:[],nextVisualEffectId:0,viewportCenter:{x:Ke/2,y:tt/2},isPaused:!1,exitConfirmation:"inactive",autopilotControls:{behaviors:{procreation:!1,planting:!1,gathering:!1,attack:!1,feedChildren:!0,followLeader:!1,build:!1},hoveredAutopilotAction:void 0,activeAutopilotAction:void 0,isManuallyMoving:!1},buildMenuOpen:!1,roleManagerOpen:!1,selectedBuildingType:null,selectedBuildingForRemoval:null,hasPlayerMovedEver:!1,hasPlayerPlantedBush:!1,hasPlayerEnabledAutopilot:0,masterVolume:hS,isMuted:!0,uiButtons:[],tutorial:o,tutorialState:a,debugPanel:Ve.None,performanceMetrics:{currentBucket:{renderTime:0,worldUpdateTime:0,aiUpdateTime:0},history:[]},hoveredButtonId:void 0,mousePosition:{x:0,y:0},notifications:[],ecosystem:{preyGestationPeriod:Lr,preyProcreationCooldown:Ur,predatorGestationPeriod:Br,predatorProcreationCooldown:Hr,preyHungerIncreasePerHour:er,predatorHungerIncreasePerHour:tr,berryBushSpreadChance:Ti},lastAutosaveTime:0};return Ou(s)}const YR="humanProcreation",jR="human",VR="human",XR=St,KR=(e,t,i)=>Vr(e,t,i.gameState)?e.gender==="male"?e.activeAction==="procreating":e.activeAction==="procreating"&&t.activeAction==="procreating":!1,ZR=(e,t,i)=>{var f,g;const{gameState:o}=i,a={x:(e.position.x+t.position.x)/2,y:(e.position.y+t.position.y)/2},s=e.gender==="male"?e:t,u=e.gender==="female"?e:t,c=(s.partnerIds||[]).length===0;if(e.stateMachine=[Ca,{partnerId:t.id,previousState:(f=e.stateMachine)==null?void 0:f[0]}],t.stateMachine=[Ca,{partnerId:e.id,previousState:(g=t.stateMachine)==null?void 0:g[0]}],e.partnerIds||(e.partnerIds=[]),e.partnerIds.includes(t.id)||e.partnerIds.push(t.id),t.partnerIds||(t.partnerIds=[]),t.partnerIds.includes(e.id)||t.partnerIds.push(e.id),c&&s.leaderId&&s.leaderId!==s.id){const m=o.entities.entities[s.leaderId];if(m){const S=i0(s,m),T=i0(u,m);if(!S&&!T){const A=Lf();s.leaderId=s.id,s.tribeBadge=A,s.tribeRole=_e.Leader,s.tribeControl={roleWeights:{gatherer:1,planter:1,hunter:1,mover:1,warrior:1,leader:0},diplomacy:{}},u.leaderId=s.id,u.tribeBadge=A}}}else if(!e.leaderId&&!t.leaderId&&s&&u){const m=Lf();s.leaderId=s.id,s.tribeBadge=m,s.tribeRole=_e.Leader,s.tribeControl={roleWeights:{gatherer:1,planter:1,hunter:1,mover:1,warrior:1,leader:0},diplomacy:{}},u.leaderId=s.id,u.tribeBadge=m}e.activeAction=void 0,ke(o,fe.Procreation,a,kr),ke(o,fe.Partnered,e.position,$e,e.id),ke(o,fe.Partnered,t.position,$e,t.id),e.lastPartneredEffectTime=o.time,t.lastPartneredEffectTime=o.time,t.activeAction=void 0,we(i,ge.Procreate,a)},qR={id:YR,sourceType:jR,targetType:VR,maxDistance:XR,checker:KR,perform:ZR},QR={id:"humanChildFeeding",sourceType:"human",targetType:"human",maxDistance:ih,checker:(e,t)=>e.isAdult===!0&&e.food.length>0&&(!e.feedChildCooldownTime||e.feedChildCooldownTime<=0)&&t.isAdult===!1&&(t.motherId===e.id||t.fatherId===e.id)&&t.hunger>=sr&&e.activeAction==="feeding",perform:(e,t,i)=>{e.food.pop(),t.hunger=Math.max(0,t.hunger-sr),e.feedChildCooldownTime=kE,(!t.lastChildFedEffectTime||i.gameState.time-t.lastChildFedEffectTime>2)&&(ke(i.gameState,fe.ChildFed,t.position,$e,t.id),t.lastChildFedEffectTime=i.gameState.time),we(i,ge.ChildFed,t.position)}},JR={id:"human-attack",sourceType:"human",targetType:"human",maxDistance:ii,checker:(e,t,i)=>{var s;if(((s=e.stateMachine)==null?void 0:s[0])!==lr||e.attackTargetId!==t.id||(e.attackCooldown||0)>0)return!1;const o=e.stateMachine[1];return i.gameState.time-o.attackStartTime>=$v},perform:(e,t,i)=>{const o=Ye(e.position,t.position,i.gameState.mapDimensions.width,i.gameState.mapDimensions.height),a=KE(lt(o),t.direction);if(Math.abs(a)<YE*Math.PI/180&&Math.random()<jE)ke(i.gameState,fe.AttackDeflected,t.position,$e,t.id);else{let c=oh;e.gender==="male"&&(c*=$E),e.isAdult||(c*=WE),(!t.isAdult||t.age>=rh)&&e.isAdult&&(c*=zE),t.hitpoints-=c,t.movementSlowdown={modifier:sh,endTime:i.gameState.time+ah},ke(i.gameState,fe.Hit,t.position,$e,t.id);const g=Ye(e.position,t.position,i.gameState.mapDimensions.width,i.gameState.mapDimensions.height),m=Ot(g,bE);t.forces.push(m),t.hitpoints<=0?we(i,ge.HumanDeath,t.position):we(i,ge.Attack,e.position)}e.attackCooldown=bu;const u=e.stateMachine[1];u.attackStartTime=i.gameState.time,ke(i.gameState,fe.Attack,e.position,$e,e.id)}},eP={id:"human-collision",sourceType:"human",targetType:"human",maxDistance:wt*2,checker:(e,t,{gameState:i})=>V(e.position,t.position,i.mapDimensions.width,i.mapDimensions.height)<(e.radius+t.radius)/3,perform:(e,t,{gameState:i})=>{const o=V(e.position,t.position,i.mapDimensions.width,i.mapDimensions.height);if(o===0){e.forces.push({x:.1,y:0}),t.forces.push({x:-.1,y:0});return}const s=(e.radius+t.radius-o)*.05,u=lt(Wv(e.position,t.position)),c=Ot(u,s);e.forces.push(c),t.forces.push(Ot(c,-1))}},tP={id:"humanBerryBushGather",sourceType:"human",targetType:"berryBush",maxDistance:St,checker:(e,t,i)=>{var o;return e.isAdult&&t.food.length>0&&((o=e.stateMachine)==null?void 0:o[0])===Oa&&e.food.length<e.maxFood&&(!e.gatheringCooldownTime||e.gatheringCooldownTime<i.gameState.time)||!1},perform:(e,t,i)=>{const o=t.food.pop();o&&e.food.push(o),e.gatheringCooldownTime=i.gameState.time+1,t.timeSinceLastHarvest=i.gameState.time,ke(i.gameState,fe.BushClaimed,t.position,$e),we(i,ge.Gather,e.position)}},nP={id:"corpseGather",sourceType:"human",targetType:"corpse",maxDistance:St,checker:(e,t,i)=>{var o;return e.isAdult&&t.food.length>0&&((o=e.stateMachine)==null?void 0:o[0])===Oa&&e.food.length<e.maxFood&&(!e.gatheringCooldownTime||e.gatheringCooldownTime<i.gameState.time)||!1},perform:(e,t,i)=>{const o=t.food.pop();o&&e.food.push(o),e.gatheringCooldownTime=i.gameState.time+1,we(i,ge.Gather,e.position)}},iP=[tP,nP],rP={id:"prey-eat-berry-bush",sourceType:"prey",targetType:"berryBush",maxDistance:Vt,checker:(e,t,i)=>!!(e.isAdult&&t.food.length>0&&e.hunger>30&&(!e.eatingCooldownTime||e.eatingCooldownTime<i.gameState.time)),perform:(e,t,i)=>{t.food.pop()&&(e.hunger=Math.max(0,e.hunger-25),t.lifespan-=bw,t.timeSinceLastHarvest=i.gameState.time,e.eatingCooldownTime=i.gameState.time+Hw,ke(i.gameState,fe.BushClaimed,t.position,$e,e.id),we(i,ge.Gather,e.position))}},oP={id:"predator-hunt-prey",sourceType:"predator",targetType:"prey",maxDistance:Do,checker:(e,t,i)=>!!(e.isAdult&&e.hunger>50&&(!e.huntCooldown||e.huntCooldown<=0)&&t.hitpoints>0),perform:(e,t,i)=>{t.hitpoints-=Yw;const o=Ye(e.position,t.position,i.gameState.mapDimensions.width,i.gameState.mapDimensions.height),a=Ot(o,8);t.forces.push(a),e.huntCooldown=Xw,t.hitpoints<=0?(we(i,ge.HumanDeath,t.position),ke(i.gameState,fe.Hit,t.position,$e,t.id)):(ke(i.gameState,fe.Hit,t.position,$e,t.id),t.fleeCooldown=5,we(i,ge.Attack,e.position)),ke(i.gameState,fe.Attack,e.position,$e,e.id)}},sP={id:"human-hunt-prey",sourceType:"human",targetType:"prey",maxDistance:ii,checker:(e,t,i)=>{var o;return!!(((o=e.stateMachine)==null?void 0:o[0])===lr&&e.attackTargetId===t.id&&(!e.attackCooldown||e.attackCooldown<=0)&&t.hitpoints>0&&e.isAdult)},perform:(e,t,i)=>{let o=oh*1.2;e.gender==="male"&&(o*=1.3),t.hitpoints-=o;const a=Ye(e.position,t.position,i.gameState.mapDimensions.width,i.gameState.mapDimensions.height),s=Ot(a,6);t.forces.push(s),e.attackCooldown=bu,t.hitpoints<=0?(we(i,ge.HumanDeath,t.position),ke(i.gameState,fe.Hit,t.position,$e,t.id)):(ke(i.gameState,fe.Hit,t.position,$e,t.id),t.fleeCooldown=8,we(i,ge.Attack,e.position)),ke(i.gameState,fe.Attack,e.position,$e,e.id)}},aP={id:"predator-attack-human",sourceType:"predator",targetType:"human",maxDistance:Fn,checker:(e,t,i)=>{var o;return!!(e.isAdult&&(!e.attackCooldown||e.attackCooldown<=0)&&t.hitpoints>0&&(e.hunger>100||t.attackTargetId===e.id||t.attackTargetId&&((o=i.gameState.entities.entities[t.attackTargetId])==null?void 0:o.type)==="predator"))},perform:(e,t,i)=>{let o=CS;e.hunger>120&&(o*=1.3),t.hitpoints-=o,t.movementSlowdown={modifier:sh,endTime:i.gameState.time+ah};const a=Ye(e.position,t.position,i.gameState.mapDimensions.width,i.gameState.mapDimensions.height),s=Ot(a,7);t.forces.push(s),e.attackCooldown=_S,t.hitpoints<=0?(e.hunger=Math.max(0,e.hunger-Ah),we(i,ge.HumanDeath,t.position),ke(i.gameState,fe.Hit,t.position,$e,t.id)):(ke(i.gameState,fe.Hit,t.position,$e,t.id),we(i,ge.Attack,e.position)),ke(i.gameState,fe.Attack,e.position,$e,e.id)}},lP={id:"human-attack-predator",sourceType:"human",targetType:"predator",maxDistance:ii,checker:(e,t,i)=>{var o;return!!(((o=e.stateMachine)==null?void 0:o[0])===lr&&e.attackTargetId===t.id&&(!e.attackCooldown||e.attackCooldown<=0)&&t.hitpoints>0&&e.isAdult)},perform:(e,t,i)=>{let o=oh*.8;e.gender==="male"&&(o*=1.2);const a=Object.values(i.gameState.entities.entities).filter(c=>c.type==="human"&&c.id!==e.id).filter(c=>{const f=c;return Math.sqrt(Math.pow(f.position.x-e.position.x,2)+Math.pow(f.position.y-e.position.y,2))<100&&f.activeAction==="attacking"&&f.attackTargetId===t.id}).length;a>0&&(o*=1+a*.2),t.hitpoints-=o;const s=Ye(e.position,t.position,i.gameState.mapDimensions.width,i.gameState.mapDimensions.height),u=Ot(s,8);t.forces.push(u),e.attackCooldown=bu,t.hitpoints<=0?(we(i,ge.HumanDeath,t.position),ke(i.gameState,fe.Hit,t.position,$e,t.id)):(ke(i.gameState,fe.Hit,t.position,$e,t.id),t.hitpoints<t.maxHitpoints*.3&&(t.hunger+=20),we(i,ge.Attack,e.position)),ke(i.gameState,fe.Attack,e.position,$e,e.id)}},uP={id:"prey-procreation",sourceType:"prey",targetType:"prey",maxDistance:Vt,checker:(e,t,i)=>!!(e.isAdult&&t.isAdult&&e.gender!==t.gender&&e.id!==t.id&&!e.isPregnant&&!t.isPregnant&&e.hunger<200&&t.hunger<200&&(!e.procreationCooldown||e.procreationCooldown<=0)&&(!t.procreationCooldown||t.procreationCooldown<=0)),perform:(e,t,i)=>{const o=e.gender==="female"?e:t;o.isPregnant=!0,o.gestationTime=i.gameState.ecosystem.preyGestationPeriod,e.procreationCooldown=i.gameState.ecosystem.preyProcreationCooldown,t.procreationCooldown=i.gameState.ecosystem.preyProcreationCooldown,ke(i.gameState,fe.Procreation,o.position,$e,o.id),we(i,ge.Procreate,o.position)}},cP={id:"predator-procreation",sourceType:"predator",targetType:"predator",maxDistance:rr,checker:(e,t,i)=>!!(e.isAdult&&t.isAdult&&e.gender!==t.gender&&e.id!==t.id&&!e.isPregnant&&!t.isPregnant&&e.hunger<200&&t.hunger<200&&(!e.procreationCooldown||e.procreationCooldown<=0)&&(!t.procreationCooldown||t.procreationCooldown<=0)),perform:(e,t,i)=>{const o=e.gender==="female"?e:t;o.isPregnant=!0,o.pregnancyFatherId=e.gender==="male"?e.id:t.id,o.gestationTime=i.gameState.ecosystem.predatorGestationPeriod,e.procreationCooldown=i.gameState.ecosystem.predatorProcreationCooldown,t.procreationCooldown=i.gameState.ecosystem.predatorProcreationCooldown,ke(i.gameState,fe.Procreation,o.position,$e,o.id),we(i,ge.Procreate,o.position)}},dP={id:"preyChildFeeding",sourceType:"prey",targetType:"prey",maxDistance:rs,checker:(e,t)=>e.isAdult===!0&&e.gender==="female"&&e.hunger<80&&(!e.feedChildCooldownTime||e.feedChildCooldownTime<=0)&&t.isAdult===!1&&(t.motherId===e.id||t.fatherId===e.id)&&t.hunger>=Pu&&e.activeAction==="feeding",perform:(e,t,i)=>{e.hunger=Math.min(120,e.hunger+10),t.hunger=Math.max(0,t.hunger-Pu),e.feedChildCooldownTime=RS,(!t.lastChildFedEffectTime||i.gameState.time-t.lastChildFedEffectTime>2)&&(ke(i.gameState,fe.ChildFed,t.position,$e,t.id),t.lastChildFedEffectTime=i.gameState.time),we(i,ge.ChildFed,t.position)}},fP={id:"predatorChildFeeding",sourceType:"predator",targetType:"predator",maxDistance:rs,checker:(e,t)=>e.isAdult===!0&&e.gender==="female"&&e.hunger<90&&(!e.feedChildCooldownTime||e.feedChildCooldownTime<=0)&&t.isAdult===!1&&(t.motherId===e.id||t.fatherId===e.id)&&t.hunger>=Pu&&e.activeAction==="feeding",perform:(e,t,i)=>{e.hunger=Math.min(140,e.hunger+15),t.hunger=Math.max(0,t.hunger-Pu),e.feedChildCooldownTime=RS,(!t.lastChildFedEffectTime||i.gameState.time-t.lastChildFedEffectTime>2)&&(ke(i.gameState,fe.ChildFed,t.position,$e,t.id),t.lastChildFedEffectTime=i.gameState.time),we(i,ge.ChildFed,t.position)}},hP={id:"predator-eat-corpse",sourceType:"predator",targetType:"corpse",maxDistance:rr,checker:(e,t,i)=>!!(e.isAdult&&e.hunger>30&&t.food.length>0&&(!e.eatingCooldownTime||e.eatingCooldownTime<=i.gameState.time)),perform:(e,t,i)=>{t.food.pop()&&(e.hunger=Math.max(0,e.hunger-Ah),e.eatingCooldownTime=i.gameState.time+2,ke(i.gameState,fe.Eating,e.position,$e,e.id),we(i,ge.Gather,e.position))}},gP={id:"predator-attack-rival",sourceType:"predator",targetType:"predator",maxDistance:Fn,checker:(e,t,i)=>{var o;return!!(e.isAdult&&(!e.attackCooldown||e.attackCooldown<=0)&&t.hitpoints>0&&(e.hunger>100||t.attackTargetId===e.id||t.attackTargetId&&((o=i.gameState.entities.entities[t.attackTargetId])==null?void 0:o.type)==="predator"))},perform:(e,t,i)=>{let o=CS;e.hunger>120&&(o*=1.3),t.hitpoints-=o,t.movementSlowdown={modifier:sh,endTime:i.gameState.time+ah};const a=Ye(e.position,t.position,i.gameState.mapDimensions.width,i.gameState.mapDimensions.height),s=Ot(a,7);t.forces.push(s),e.attackCooldown=_S,t.hitpoints<=0?(e.hunger=Math.max(0,e.hunger-Ah),we(i,ge.HumanDeath,t.position),ke(i.gameState,fe.Hit,t.position,$e,t.id)):(ke(i.gameState,fe.Hit,t.position,$e,t.id),we(i,ge.Attack,e.position)),ke(i.gameState,fe.Attack,e.position,$e,e.id)}},pP={id:"storageDeposit",sourceType:"human",targetType:"building",maxDistance:Cn,checker:(e,t,i)=>{var s;if(t.buildingType!=="storageSpot"||((s=e.stateMachine)==null?void 0:s[0])!==da||!t.isConstructed||e.food.length===0)return!1;t.storedFood||(t.storedFood=[]);const o=t.storageCapacity??0;return!(t.storedFood.length>=o||e.leaderId!==t.ownerId||i.gameState.time-(t.lastDepositTime??0)<Y_)},perform:(e,t,i)=>{t.storedFood||(t.storedFood=[]);const o=e.food.pop();o&&t.storedFood.push({item:o,positionOffset:DS(t)}),t.lastDepositTime=i.gameState.time,we(i,ge.StorageDeposit,t.position)}},mP={id:"storageRetrieve",sourceType:"human",targetType:"building",maxDistance:Cn,checker:(e,t,i)=>{var a;return!(t.buildingType!=="storageSpot"||((a=e.stateMachine)==null?void 0:a[0])!==fa||!t.isConstructed||!t.storedFood||t.storedFood.length===0||e.food.length>=e.maxFood||e.leaderId!==t.ownerId||i.gameState.time-(t.lastRetrieveTime??0)<j_)},perform:(e,t,i)=>{if(!t.storedFood||t.storedFood.length===0)return;const o=t.storedFood.pop();o&&(e.food.push(o.item),DS(t)),t.lastRetrieveTime=i.gameState.time,we(i,ge.StorageRetrieve,t.position)}},vP={id:"storageSteal",sourceType:"human",targetType:"building",maxDistance:Cn,checker:(e,t,i)=>{var c,f;if(t.buildingType!=="storageSpot"||((c=e.stateMachine)==null?void 0:c[0])!==Oa||!t.isConstructed||!t.storedFood||t.storedFood.length===0||e.food.length>=e.maxFood||e.leaderId===t.ownerId)return!1;const o=e.leaderId?i.gameState.entities.entities[e.leaderId]:void 0;if(!o||!((f=o.tribeControl)!=null&&f.diplomacy)||o.tribeControl.diplomacy[t.ownerId]!==Dt.Hostile||i.gameState.time-(t.lastStealTime??0)<V_)return!1;const u=ri({leaderId:t.ownerId},i.gameState);for(const g of u)if(V(e.position,g.position,i.gameState.mapDimensions.width,i.gameState.mapDimensions.height)<=X_)return!1;return!0},perform:(e,t,i)=>{if(!t.storedFood||t.storedFood.length===0)return;const o=t.storedFood.pop();o&&e.food.push(o.item),t.lastStealTime=i.gameState.time,we(i,ge.StorageSteal,t.position),ke(i.gameState,fe.Attack,t.position,.5)}},SP={id:"human-takeover-building",sourceType:"human",targetType:"building",maxDistance:20,checker:(e,t,i)=>e.leaderId!==e.id||e.activeAction!=="takingOverBuilding"?!1:Ln(e,t,i.gameState),perform:(e,t,i)=>{t.ownerId=e.id,t.constructionProgress=1,t.isConstructed=!0,t.isBeingDestroyed=!1,t.destructionProgress=0,e.activeAction="idle",ke(i.gameState,fe.BushClaimed,t.position,2,t.id)}},yP={id:"human-remove-enemy-building",sourceType:"human",targetType:"building",maxDistance:20,checker:(e,t,i)=>!(e.leaderId!==e.id||e.activeAction!=="destroyingBuilding"||!Ln(e,t,i.gameState)||t.isBeingDestroyed),perform:(e,t,i)=>{t.isBeingDestroyed=!0,e.activeAction="idle",ke(i.gameState,fe.Hit,t.position,1,t.id)}},AP=[eP,...iP,qR,QR,JR,pP,mP,vP,SP,yP,rP,dP,fP,hP,oP,sP,lP,aP,gP,uP,cP];function TP(e){const{gameState:t}=e,i=t,o=Object.values(t.entities.entities);for(const a of AP)for(const s of o){if(a.sourceType&&s.type!==a.sourceType)continue;const u=i.search[a.targetType].byRadius(s.position,a.maxDistance);for(const c of u){if(s.id===c.id)continue;V(s.position,c.position,t.mapDimensions.width,t.mapDimensions.height)<=a.maxDistance&&a.checker(s,c,e)&&a.perform(s,c,e)}}}function IP(e){e.visualEffects=e.visualEffects.filter(t=>e.time-t.startTime<=t.duration)}function EP(e){const t=e.search.berryBush.byProperty("type","berryBush"),i=e.search.predator.byProperty("type","predator"),o=e.search.human.byProperty("type","human");for(let a=0;a<20;a++){let s;if(t.length>0&&a<15){const f=t[Math.floor(Math.random()*t.length)],g=Math.random()*2*Math.PI,m=50+Math.random()*100;s={x:Math.max(50,Math.min(Ke-50,f.position.x+Math.cos(g)*m)),y:Math.max(50,Math.min(tt-50,f.position.y+Math.sin(g)*m))}}else s={x:50+Math.random()*(Ke-100),y:50+Math.random()*(tt-100)};let u=!0;const c=100;for(const f of i)if(Math.sqrt((s.x-f.position.x)**2+(s.y-f.position.y)**2)<c){u=!1;break}if(u){for(const f of o)if(Math.sqrt((s.x-f.position.x)**2+(s.y-f.position.y)**2)<c){u=!1;break}}if(u)return s}return{x:Ke*.3+Math.random()*Ke*.4,y:tt*.3+Math.random()*tt*.4}}function CP(e){const t=e.search.prey.byProperty("type","prey"),i=e.search.human.byProperty("type","human");for(let a=0;a<15;a++){let s;if(t.length>0&&a<10){const f=t[Math.floor(Math.random()*t.length)],g=Math.random()*2*Math.PI,m=100+Math.random()*150;s={x:Math.max(50,Math.min(Ke-50,f.position.x+Math.cos(g)*m)),y:Math.max(50,Math.min(tt-50,f.position.y+Math.sin(g)*m))}}else s={x:50+Math.random()*(Ke-100),y:50+Math.random()*(tt-100)};let u=!0;const c=150;for(const f of i)if(Math.sqrt((s.x-f.position.x)**2+(s.y-f.position.y)**2)<c){u=!1;break}if(u)return s}switch(Math.floor(Math.random()*4)){case 0:return{x:Math.random()*Ke,y:50+Math.random()*100};case 1:return{x:Ke-150+Math.random()*100,y:Math.random()*tt};case 2:return{x:Math.random()*Ke,y:tt-150+Math.random()*100};default:return{x:50+Math.random()*100,y:Math.random()*tt}}}function _P(e){const t=e.search.human.byProperty("type","human"),i=e.search.berryBush.byProperty("type","berryBush");for(let o=0;o<20;o++){const a={x:50+Math.random()*(Ke-100),y:50+Math.random()*(tt-100)};let s=!0;const u=80,c=60;for(const f of t)if(Math.sqrt((a.x-f.position.x)**2+(a.y-f.position.y)**2)<u){s=!1;break}if(s){for(const f of i)if(Math.sqrt((a.x-f.position.x)**2+(a.y-f.position.y)**2)<c){s=!1;break}}if(s)return a}return{x:Math.random()*Ke,y:Math.random()*tt}}function bS(e,t=4){console.log(` Respawning ${t} prey to prevent extinction`);const i=e;for(let o=0;o<t;o++){const a=EP(i),s=o%2===0?"male":"female";Qo(e.entities,a,s,void 0,void 0,_a())}}function GS(e,t=2){console.log(` Respawning ${t} predators to prevent extinction`);const i=e;for(let o=0;o<t;o++){const a=CP(i),s=o%2===0?"male":"female";Jo(e.entities,a,s,void 0,void 0,wa())}}function wP(e){const t=e,i=t.search.prey.count(),o=t.search.predator.count();let a=!1;return i===0&&(bS(e,6),a=!0),o===0&&(GS(e,3),a=!0),a}function RP(e){const t=e,i=t.search.prey.count(),o=t.search.predator.count(),a=t.search.berryBush.count();let s=!1;if(i>0&&i<5){const u=Math.max(2,Math.floor(8-i));bS(e,u),s=!0}if(o>0&&o<2){const u=Math.max(1,Math.floor(3-o));GS(e,u),s=!0}if(a<5){console.log(` Boosting bush count from ${a} to help ecosystem`);for(let u=0;u<5;u++){const c=_P(t);ka(e.entities,c,e.time)}s=!0}return s}const PP=1,NP=.3,DP=.8,U0=.8,OP=.99,MP=.05;var xS=(e=>(e[e.INCREASE_PREY_GESTATION=0]="INCREASE_PREY_GESTATION",e[e.DECREASE_PREY_GESTATION=1]="DECREASE_PREY_GESTATION",e[e.INCREASE_PREY_PROCREATION_COOLDOWN=2]="INCREASE_PREY_PROCREATION_COOLDOWN",e[e.DECREASE_PREY_PROCREATION_COOLDOWN=3]="DECREASE_PREY_PROCREATION_COOLDOWN",e[e.INCREASE_PREY_HUNGER=4]="INCREASE_PREY_HUNGER",e[e.DECREASE_PREY_HUNGER=5]="DECREASE_PREY_HUNGER",e[e.INCREASE_PREDATOR_GESTATION=6]="INCREASE_PREDATOR_GESTATION",e[e.DECREASE_PREDATOR_GESTATION=7]="DECREASE_PREDATOR_GESTATION",e[e.INCREASE_PREDATOR_PROCREATION_COOLDOWN=8]="INCREASE_PREDATOR_PROCREATION_COOLDOWN",e[e.DECREASE_PREDATOR_PROCREATION_COOLDOWN=9]="DECREASE_PREDATOR_PROCREATION_COOLDOWN",e[e.INCREASE_PREDATOR_HUNGER=10]="INCREASE_PREDATOR_HUNGER",e[e.DECREASE_PREDATOR_HUNGER=11]="DECREASE_PREDATOR_HUNGER",e[e.INCREASE_BUSH_SPREAD=12]="INCREASE_BUSH_SPREAD",e[e.DECREASE_BUSH_SPREAD=13]="DECREASE_BUSH_SPREAD",e[e.NO_ACTION=14]="NO_ACTION",e))(xS||{});const ff=Object.keys(xS).length/2;class kP{constructor(){Ne(this,"qTable",new Map);Ne(this,"epsilon",U0);Ne(this,"lastState",null);Ne(this,"lastAction",null)}discretizeState(t,i,o){const a=Math.min(4,Math.floor(t/25)),s=Math.min(4,Math.floor(i/5)),u=Math.min(4,Math.floor(o/15));return`${a}-${s}-${u}`}getQValue(t,i){return this.qTable.has(t)||this.qTable.set(t,new Map),this.qTable.get(t).get(i)||0}setQValue(t,i,o){this.qTable.has(t)||this.qTable.set(t,new Map),this.qTable.get(t).set(i,o)}getBestAction(t){let i=0,o=this.getQValue(t,0);for(let a=1;a<ff;a++){const s=this.getQValue(t,a);s>o&&(o=s,i=a)}return i}chooseAction(t){return Math.random()<this.epsilon?Math.floor(Math.random()*ff):this.getBestAction(t)}applyEmergencyCorrections(t,i,o,a){t<Si*.5&&(a.ecosystem.preyGestationPeriod=Math.max(ko,a.ecosystem.preyGestationPeriod*.8),a.ecosystem.preyProcreationCooldown=Math.max(Fo,a.ecosystem.preyProcreationCooldown*.8),a.ecosystem.preyHungerIncreasePerHour=Math.max(Bo,a.ecosystem.preyHungerIncreasePerHour*.9)),i<yi*.6&&(a.ecosystem.predatorGestationPeriod=Math.max(Lo,a.ecosystem.predatorGestationPeriod*.75),a.ecosystem.predatorProcreationCooldown=Math.max(Uo,a.ecosystem.predatorProcreationCooldown*.75),a.ecosystem.predatorHungerIncreasePerHour=Math.max(Ho,a.ecosystem.predatorHungerIncreasePerHour*.85)),o<Ai*.5&&(a.ecosystem.berryBushSpreadChance=Math.min(na,a.ecosystem.berryBushSpreadChance*1.2)),t>Si*1.4&&(a.ecosystem.preyHungerIncreasePerHour=Math.min(er,a.ecosystem.preyHungerIncreasePerHour*1.05)),i>yi*1.4&&(a.ecosystem.predatorHungerIncreasePerHour=Math.min(tr,a.ecosystem.predatorHungerIncreasePerHour*1.05)),o>Ai*1.4&&(a.ecosystem.berryBushSpreadChance=Math.max(Ti,a.ecosystem.berryBushSpreadChance*.95))}calculateReward(t,i,o){const a=Math.abs(t-Si),s=Math.abs(i-yi),u=Math.abs(o-Ai),c=a/Si,f=s/yi,g=u/Ai,m=c+f+g;return 100*Math.exp(-m*2)-50}applyAction(t,i){switch(t){case 0:i.ecosystem.preyGestationPeriod=Math.min(Lr,i.ecosystem.preyGestationPeriod+.2*(Lr-ko));break;case 1:i.ecosystem.preyGestationPeriod=Math.max(ko,i.ecosystem.preyGestationPeriod-.2*(Lr-ko));break;case 2:i.ecosystem.preyProcreationCooldown=Math.min(Ur,i.ecosystem.preyProcreationCooldown+.2*(Ur-Fo));break;case 3:i.ecosystem.preyProcreationCooldown=Math.max(Fo,i.ecosystem.preyProcreationCooldown-.2*(Ur-Fo));break;case 4:i.ecosystem.preyHungerIncreasePerHour=Math.min(er,i.ecosystem.preyHungerIncreasePerHour+.2*(er-Bo));break;case 5:i.ecosystem.preyHungerIncreasePerHour=Math.max(Bo,i.ecosystem.preyHungerIncreasePerHour-.2*(er-Bo));break;case 6:i.ecosystem.predatorGestationPeriod=Math.min(Br,i.ecosystem.predatorGestationPeriod+.2*(Br-Lo));break;case 7:i.ecosystem.predatorGestationPeriod=Math.max(Lo,i.ecosystem.predatorGestationPeriod-.2*(Br-Lo));break;case 8:i.ecosystem.predatorProcreationCooldown=Math.min(Hr,i.ecosystem.predatorProcreationCooldown+.2*(Hr-Uo));break;case 9:i.ecosystem.predatorProcreationCooldown=Math.max(Uo,i.ecosystem.predatorProcreationCooldown-.2*(Hr-Uo));break;case 10:i.ecosystem.predatorHungerIncreasePerHour=Math.min(tr,i.ecosystem.predatorHungerIncreasePerHour+.2*(tr-Ho));break;case 11:i.ecosystem.predatorHungerIncreasePerHour=Math.max(Ho,i.ecosystem.predatorHungerIncreasePerHour-.2*(tr-Ho));break;case 12:i.ecosystem.berryBushSpreadChance=Math.min(na,i.ecosystem.berryBushSpreadChance+.2*(na-Ti));break;case 13:i.ecosystem.berryBushSpreadChance=Math.max(Ti,i.ecosystem.berryBushSpreadChance-.2*(na-Ti));break}}updateQTable(t,i,o,a){const s=this.getQValue(t,i),u=Math.max(...Array.from({length:ff},(f,g)=>this.getQValue(a,g))),c=s+NP*(o+DP*u-s);this.setQValue(t,i,c)}step(t){const i=t,o=i.search.prey.count(),a=i.search.predator.count(),s=i.search.berryBush.count();this.applyEmergencyCorrections(o,a,s,t);const u=this.discretizeState(o,a,s);if(this.lastState!==null&&this.lastAction!==null){const f=this.calculateReward(o,a,s);this.updateQTable(this.lastState,this.lastAction,f,u)}const c=this.chooseAction(u);this.applyAction(c,t),this.epsilon=Math.max(MP,this.epsilon*OP),this.lastState=u,this.lastAction=c}reset(){this.qTable.clear(),this.epsilon=U0,this.lastState=null,this.lastAction=null}getStats(){return{qTableSize:this.qTable.size,explorationRate:this.epsilon}}}let $S=new kP;function FP(e){wP(e),RP(e),e.ecosystem.lastUpdateTime||(e.ecosystem.preyGestationPeriod=ko+(Lr-ko)*.3,e.ecosystem.preyProcreationCooldown=Fo+(Ur-Fo)*.3,e.ecosystem.preyHungerIncreasePerHour=Bo+(er-Bo)*.3,e.ecosystem.predatorGestationPeriod=Lo+(Br-Lo)*.3,e.ecosystem.predatorProcreationCooldown=Uo+(Hr-Uo)*.3,e.ecosystem.predatorHungerIncreasePerHour=Ho+(tr-Ho)*.3,e.ecosystem.berryBushSpreadChance=Ti+(na-Ti)*.7),$S.step(e)}function LP(e){e.ecosystem.lastUpdateTime||(e.ecosystem.lastUpdateTime=0),!(e.time-e.ecosystem.lastUpdateTime<PP)&&(e.ecosystem.lastUpdateTime=e.time,FP(e))}function UP(){return $S.getStats()}function BP(e,t){e.selectedBuildingType&&e.selectedBuildingType!=="removal"&&(e.autopilotControls.activeAutopilotAction=void 0,e.autopilotControls.hoveredAutopilotAction=void 0)}const HP=1/60;function bP(e,t){const i=pt(e);i&&(e.viewportCenter=lh(e.viewportCenter,i.position,Jf*t))}function zu(e,t){if(e.isPaused)return e;if(e.autosaveIntervalSeconds){const i=Date.now();i-e.lastAutosaveTime>e.autosaveIntervalSeconds*1e3&&(Yf(e),e.lastAutosaveTime=i)}for(;t>0;){const i=Ou(e),o=Math.min(t,HP),a=o*(Ct/_t);i.time+=a,bP(i,o),D_(i),LP(i),O_(i),MR({gameState:i,deltaTime:o}),TP({gameState:i,deltaTime:o}),IP(i),GR(i,o),BP(i),e=i,t-=o}return e}function hf(e,t,i){e.save();const{x:o,y:a,width:s,height:u}=t.rect,c=Jv;if(e.beginPath(),e.moveTo(o+c,a),e.lineTo(o+s-c,a),e.quadraticCurveTo(o+s,a,o+s,a+c),e.lineTo(o+s,a+u-c),e.quadraticCurveTo(o+s,a+u,o+s-c,a+u),e.lineTo(o+c,a+u),e.quadraticCurveTo(o,a+u,o,a+u-c),e.lineTo(o,a+c),e.quadraticCurveTo(o,a,o+c,a),e.closePath(),e.fillStyle=t.isDisabled?eS:t.backgroundColor,e.fill(),t.activated){e.save();const f=(Math.sin(Date.now()/1e3*rS)+1)/2;e.strokeStyle=iS,e.lineWidth=2+f*2,e.globalAlpha=.7+f*.3,e.stroke(),e.restore()}if(t.lastActivated){const f=Date.now()-t.lastActivated;if(f<Ru){const g=1-f/Ru;e.fillStyle=nS,e.globalAlpha=g,e.fill(),e.globalAlpha=1}}i&&!t.isDisabled&&(e.fillStyle=fh,e.globalAlpha=.5,e.fill(),e.globalAlpha=1),e.fillStyle=t.isDisabled?tS:t.textColor,t.icon?(e.font=`${u*.55}px "Press Start 2P", Arial`,e.textAlign="center",e.textBaseline="middle",e.fillText(t.icon,o+s/2,a+u/2),t.text&&(e.font=`${u*.18}px "Press Start 2P", Arial`,e.textAlign="right",e.textBaseline="bottom",e.fillText(t.text,o+s-4,a+u-2))):(e.textAlign="center",e.textBaseline="middle",e.fillText(t.text,o+s/2,a+u/2)),e.restore()}function GP(e,t,i,o){e.save(),e.font=`${c0}px "Press Start 2P", Arial`,e.textAlign="center",e.textBaseline="bottom";const s=e.measureText(i).width,u=c0,c=s+d0*2,f=u+d0*2,g=o.x-c/2,m=e.canvas.height,S=t.y<m/2?t.y+t.height-f0:t.y-f+f0;e.fillStyle=UC,e.fillRect(g,S,c,f),e.fillStyle=BC,e.fillText(i,o.x,S+f/2+u/2),e.restore()}function xP(e,t,i){e.save();const o=pt(t),a=[{id:"fastForwardButton",action:re.FastForward,text:"FFWD [T]",currentWidth:vi*1.3,backgroundColor:qi,textColor:Yt,tooltip:"Fast-forward time",rect:{x:0,y:0,width:0,height:0}},{id:"pauseButton",action:re.TogglePause,text:t.isPaused?"UN[P]AUSE":"[P]AUSE",backgroundColor:t.isPaused?Kl:qi,currentWidth:t.isPaused?vi*1.4:vi*1.1,tooltip:t.isPaused?"Resume Game":"Pause Game",rect:{x:0,y:0,width:0,height:0},textColor:Yt},{id:"muteButton",action:re.ToggleMute,text:t.isMuted?"UN[M]UTE":"[M]UTE",backgroundColor:t.isMuted?Kl:qi,tooltip:`Toggle Sound (${t.isMuted?"Muted":"Enabled"})`,currentWidth:vi,rect:{x:0,y:0,width:0,height:0},textColor:Yt},{id:"returnToIntroButton",action:re.ReturnToIntro,text:"EXIT",backgroundColor:qi,tooltip:"Return to Main Menu [ESC]",currentWidth:vi*.9,rect:{x:0,y:0,width:0,height:0},textColor:Yt}];if(t.uiButtons.push(...a),o){const g=vh(t,o),m=new Set(g.map(F=>F.type));let S=[{playerAction:ce.Gather,buttonAction:re.CommandGather,shortcut:"E",name:"Gather",toggleKey:"gathering",condition:()=>o.isAdult===!0},{playerAction:ce.Eat,buttonAction:re.CommandEat,shortcut:"F",name:"Eat"},{playerAction:ce.Plant,buttonAction:re.CommandPlant,shortcut:"B",name:"Plant",toggleKey:"planting",condition:()=>o.isAdult===!0},{playerAction:ce.Procreate,buttonAction:re.ToggleProcreationBehavior,shortcut:"R",name:"Procreation",toggleKey:"procreation",condition:()=>o.isAdult===!0},{playerAction:ce.FeedChild,buttonAction:re.ToggleFeedChildBehavior,shortcut:"H",name:"Feed Child",toggleKey:"feedChildren",condition:()=>o.isAdult===!0},{playerAction:ce.Attack,buttonAction:re.ToggleAttackBehavior,shortcut:"Q",name:"Attack",toggleKey:"attack",condition:()=>o.isAdult===!0&&o.leaderId===o.id},{playerAction:ce.FollowMe,buttonAction:re.CommandFollowMe,shortcut:"C",name:"Follow Me",toggleKey:"followLeader",condition:()=>o.isAdult===!0&&o.leaderId===o.id},{playerAction:ce.CallToAttack,buttonAction:re.CommandCallToAttack,shortcut:"V",name:"Call to Attack",condition:()=>o.isAdult===!0&&o.leaderId===o.id},{playerAction:ce.TribeSplit,buttonAction:re.CommandTribeSplit,shortcut:"K",name:"Split Tribe",condition:()=>o.leaderId!==void 0&&o.leaderId!==o.id&&o.isAdult===!0},{playerAction:ce.Build,buttonAction:re.CommandBuild,shortcut:"L",name:"Build",toggleKey:"build",condition:()=>o.isAdult===!0&&o.leaderId===o.id},{playerAction:ce.Build,buttonAction:re.OpenRoleManager,shortcut:"U",name:"Roles",condition:()=>o.isAdult===!0&&o.leaderId===o.id&&OS(o,t)}];S=S.filter(F=>F.condition?F.condition():!0);const T=1,A=S.length,I=A*ln+(A-1)*wr,y=T*ln+(T-1)*wr,C=(i-I)/2,O=e.canvas.height-y-20;if(S.forEach((F,P)=>{const H=P%A,B=Math.floor(P/A),U=C+H*(ln+wr),G=O+B*(ln+wr),Z=!!F.toggleKey,te=Z&&t.autopilotControls.behaviors[F.toggleKey],ve=!m.has(F.playerAction),De=F.playerAction===ce.Build&&t.buildMenuOpen,Ie=!t.hasPlayerEnabledAutopilot||t.hasPlayerEnabledAutopilot<4?" (Press Shift to toggle Auto)":"",he=Z?`${F.name}${Ie}`:F.name,Fe=te||De||F.buttonAction===re.OpenRoleManager&&t.roleManagerOpen?Kl:qi,Se={id:`commandButton_${F.name}`,action:F.buttonAction,rect:{x:U,y:G,width:ln,height:ln},icon:F.buttonAction===re.OpenRoleManager?"":xu[F.playerAction],text:F.shortcut,backgroundColor:Fe,textColor:Yt,currentWidth:ln,tooltip:he,isDisabled:ve,activated:te||F.buttonAction===re.CommandBuild&&De||F.buttonAction===re.OpenRoleManager&&t.roleManagerOpen};t.uiButtons.push(Se)}),t.buildMenuOpen){const F=[{id:"buildMenu_storageSpot",action:re.SelectStorageSpot,icon:"",shortcut:"1",name:"Storage Spot"},{id:"buildMenu_plantingZone",action:re.SelectPlantingZone,icon:"",shortcut:"2",name:"Planting Zone"},{id:"buildMenu_removal",action:re.SelectRemovalTool,icon:"",shortcut:"3",name:"Remove Building"}],P=F.length,H=P*ln+(P-1)*wr,B=(i-H)/2,U=O-ln-wr;F.forEach((G,Z)=>{const te=B+Z*(ln+wr),ve=U,be=G.action===re.SelectStorageSpot&&t.selectedBuildingType==="storageSpot"||G.action===re.SelectPlantingZone&&t.selectedBuildingType==="plantingZone"||G.action===re.SelectRemovalTool&&t.selectedBuildingType==="removal",De={id:G.id,action:G.action,rect:{x:te,y:ve,width:ln,height:ln},icon:G.icon,text:G.shortcut,backgroundColor:be?Kl:qi,textColor:Yt,currentWidth:ln,tooltip:G.name,activated:be};t.uiButtons.push(De),hf(e,De,t.hoveredButtonId===De.id)})}}let s=i-Xe;a.forEach(g=>{const m=Xe,S=s-g.currentWidth;g.rect={x:S,y:m,width:g.currentWidth,height:Qv},hf(e,g,t.hoveredButtonId===g.id),s-=g.currentWidth+LC});let u=null;t.uiButtons.filter(g=>g.id.startsWith("commandButton_")||g.id.startsWith("buildMenu_")).forEach(g=>{u||(u={x:g.rect.x,y:g.rect.y,width:g.rect.width,height:g.rect.height}),u.x=Math.min(u.x,g.rect.x),u.y=Math.min(u.y,g.rect.y),u.width=Math.max(u.width,g.rect.x+g.rect.width-u.x),u.height=Math.max(u.height,g.rect.y+g.rect.height-u.y),g.id.startsWith("commandButton_")&&hf(e,g,t.hoveredButtonId===g.id)});const f=t.hoveredButtonId?t.uiButtons.find(g=>g.id===t.hoveredButtonId):void 0;return f&&f.tooltip&&t.mousePosition&&GP(e,f.rect,f.tooltip,t.mousePosition),e.restore(),{commandButtonsRect:u}}function $P(e){e.save(),e.fillStyle=XC,e.fillRect(0,0,e.canvas.width,e.canvas.height),e.fillStyle=KC,e.font=`${ZC}px "Press Start 2P", Arial`,e.textAlign="center",e.textBaseline="middle",e.fillText("PAUSED",e.canvas.width/2,e.canvas.height/2),e.restore()}function Gf(e,t,i,o){const a=t.x-i.width/2,s=t.y-i.height/2,u=a+e.x,c=s+e.y,f=(u%o.width+o.width)%o.width,g=(c%o.height+o.height)%o.height;return{x:f,y:g}}function Yu(e,t,i,o){let a=e.x-t.x,s=e.y-t.y;return Math.abs(a)>o.width/2&&(a=a-Math.sign(a)*o.width),Math.abs(s)>o.height/2&&(s=s-Math.sign(s)*o.height),{x:a+i.width/2,y:s+i.height/2}}function au(e,t,i,o){const a=Yu(e.position,t,i,o),u=("radius"in e?e.radius:20)+20;return a.x>=-u&&a.x<=i.width+u&&a.y>=-u&&a.y<=i.height+u}function cn(e,t,i,o,a,...s){const u={...a.position};for(let c=-i;c<=i;c+=i)for(let f=-t;f<=t;f+=t)a.position.x=u.x+f,a.position.y=u.y+c,o(e,a,...s);a.position=u}const WP=25,zP=0,B0=28;function WS(e,t,i,o,a,s,u,c,f,g){e.save();const{x:m,y:S}=Yu(t,u,{width:c,height:f},g);e.strokeStyle=o,e.lineWidth=s,e.setLineDash(a),e.beginPath(),e.arc(m,S,i+Gu,0,2*Math.PI),e.stroke(),e.restore()}function YP(e,t,i,o,a,s,u){if(t=t.filter(S=>S.type!==ce.FollowMe),t.length===0)return;e.save(),t.forEach(S=>{S.targetEntity&&WS(e,S.targetEntity.position,S.targetEntity.radius,ch,dh,2,o,a,s,u)}),e.font=`${Xo}px "Press Start 2P", Arial`,e.fillStyle="white",e.textAlign="center",e.textBaseline="bottom",e.shadowColor="black",e.shadowBlur=5;const{x:c,y:f}=Yu(i.position,o,{width:a,height:s},u);let g=0,m={};t.forEach(S=>{const T=xu[S.type];if(S.targetEntity){m[S.targetEntity.id]=(m[S.targetEntity.id]||0)+1;const A=S.targetEntity.position.x-o.x+a/2,I=S.targetEntity.position.y-o.y+s/2,y=`${T}${S.key.toUpperCase()}`,C=I-S.targetEntity.radius-Gu-Xo/2-(m[S.targetEntity.id]-1)*B0;e.fillText(y,A,C)}else{e.textAlign="left";const A=`${T}${S.key.toUpperCase()}`,I=c+WP,C=f+zP+g*B0;e.fillText(A,I,C),g++,e.textAlign="center"}}),e.restore()}const Ee=(e,t,i,o,a,s,u)=>{s==="transparent"||o<=0||a<=0||(e.fillStyle=s,e.fillRect(Math.floor(t*u),Math.floor(i*u),Math.ceil(o*u),Math.ceil(a*u)))},H0=10,b0=10,qn=6,gi=4,lu=2,jP=5,In=4,VP=2,Ut=4,XP=2,rt=3,wo=2,Zi=0,pa=Zi+gi-1,$t=pa,dt=pa+In-1,KP="rgba(0, 0, 0, 0.4)",ZP=4,qP=1,_h={name:"tribe-human-2d",referenceImage:"swos.png",description:`A 2D human character asset for the Tribe game. This includes ensuring that the unique animations for stances like 'eat' and 'procreate' do not erroneously appear in other stances, such as 'walk', which was observed in the provided rendered media. The 'idle' animation was updated to a leg sway to better match the provided video for that stance, replacing a simpler body bob.

# Visual style

Human characters in the Tribe game are inspired by classic 2D pixel art, they look like Sensible Soccer players(Sensible Soccer game visual style is IMPORTANT), with a simple and recognizable design. The characters are designed to be easily distinguishable and animated in a way that conveys their actions clearly.

Character in Tribe game look like people from stone age, they have simple clothing, no shoes, and no modern accessories. The characters are designed to be easily distinguishable and animated in a way that conveys their actions clearly.

# Technical details

The asset is rendered on a canvas using the CanvasRenderingContext2D API. The rendering function takes parameters for position, size, progress, stance, direction, gender, and age. The character can face left or right, and the rendering adapts based on the stance (e.g., idle, walk, eat, procreate).
The rendering function must be simple and efficient, it should not use complex patterns or gradients, and should focus on solid colors and basic shapes to maintain the pixel art aesthetic.

15% padding from all edges of the rendering box is required to ensure the character is not cut off during rendering.

Subtle shadow should be drawn under the character to give it a sense of depth.

# Rendering parameters

- age: The age of the character, which affects the size and proportions of the body parts. Age is a number between 1 and 60, with 20 being the average age.
- gender: 
  - The male characters should have only pants, while female cover their breasts with a top. The clothing should be simple and muted, reflecting a stone-age style.
  - Female characters should have long hair, while male should have short hair and beard.
  - Male characters should have a more robust, muscular build
  - Female characters should have thinner arms and legs, with a more pronounced waist and hips.
- isPregnant: (applicable only for females) Indicates if the character is pregnant, like very large belly. Pregnant characters should have a larger torso.
- direction: A vector indicating the character's facing direction. There should be at least 8 directions (like in Sensible Soccer): top left, top, top right, left, right, bottom left, bottom, bottom right. The character should be flipped horizontally if the direction vector's X component is negative.
             When moving up(top, top left, top right), the character back of the head should be visible, when moving down(Y > 0), the character face should be visible.
- hungryLevel: A number between 0 and 100 indicating how hungry the character is, hunger level 100 means the character is starving, 0 means the character is not hungry at all. So hungry characters should be thinner, with less body fat, and more pronounced muscles. The character's hunger level affects the size and proportions of the body parts, with hungrier characters being smaller and more gaunt.

# Rendering details

- All parts of the body must be connected
- Rendering must take into account direction vector (X and Y) to flip the character horizontally if needed
- The character's age affects the size and proportions of the body parts, with older characters being larger and more robust. Hair color should become gray for older characters.

# Stances

- 'idle': The character stands still, with a slight leg sway to indicate life.
- 'walk': The character moves forward, with legs and arms in motion.
- 'gathering': The character is gathering food from berry bushes, with arms reaching out and a slight bend at the knees.
- 'eat': The character holds food and brings it to their mouth, with a slight bend at the knees.
- 'procreate': The character performs a mating animation, with a specific pose and movement. There should be some additional visual effects to indicate this action, such as a slight glow or aura around the characters, or dust particles to indicate movement.
- 'attacking': The character performs an attack animation, with arms raised and a forward motion.
- 'defending': The character takes a defensive stance, with arms raised and a slight bend at the knees.
- 'stunned': The character is stunned and laying on the ground, with limbs relaxed and a neutral expression.
- 'dead': The character lies on the ground, with limbs relaxed and a neutral expression, slowly turns into a skeleton over time.

`,stances:["idle","walk","gathering","eat","procreate","dead","attacking","defending","stunned"],render(e,t,i,o,a,s,u,c="male",f=20,g=[1,0],m=!1,S=0){const T=["dead","stunned"].includes(u),A=T?b0+4:H0,I=T?H0+4:b0+rt,y=.15,C=Math.min(o*(1-2*y)/A,a*(1-2*y)/I),O=A*C,F=I*C,P=t+(o-O)/2,H=i+(a-F)/2;e.save(),g[0]<0&&!T?(e.translate(P+O,H),e.scale(-1,1)):e.translate(P,H);const U="#D09A5A",G=f>50?"#BDBDBD":"#281808",Z="#7F5C4A",te="#6B4F3A",ve="#E0D8C0",be="#A0522D",De=1-Math.max(0,Math.min(100,S))/100*.2,Ie=c==="male"?1.1:.9,he=.8+(Math.max(1,Math.min(f,60))-1)/59*.2;let Fe=jP*De*Ie*he,Se=VP*De*Ie*he,ne=XP*De*he;m&&c==="female"&&(Fe*=1.5);const z=Math.round((A-Fe)/2),X=Math.round((A-qn)/2),Y=z-Se,N=z+Fe,b=1,K=z+(Fe/2-b/2)-ne,J=z+(Fe/2+b/2),pe=g[1]<-.2&&Math.abs(g[0])<.7,ae=q=>{e.fillStyle=KP,e.beginPath();const le=A/2,Be=q;e.ellipse(Math.floor(le*C),Math.floor(Be*C),Math.max(1,Math.floor(ZP*C)),Math.max(1,Math.floor(qP*C)),0,0,2*Math.PI),e.fill()},Re=(q,le)=>{c==="male"?(Ee(e,z,pa+q,Fe,In-wo,le,C),Ee(e,z,pa+In-wo+q,Fe,wo,Z,C)):Ee(e,z,pa+q,Fe,In,te,C)},Ce=(q,le)=>{pe?Ee(e,X,Zi+q,qn,gi,G,C):(Ee(e,X,Zi+q,qn,gi,le,C),Ee(e,X,Zi+q,qn,lu,G,C),c==="female"?(Ee(e,X-1,Zi+lu+q,1,gi,G,C),Ee(e,X+qn,Zi+lu+q,1,gi,G,C)):Ee(e,X+1,Zi+2+q,qn-2,gi-2,G,C))};switch(u){case"idle":{const q=s*Math.PI*2,le=Math.sin(q)*.5,ye=(Math.cos(q*2)+1)*.25;ae(dt+rt+1),Ee(e,K+le,dt+ye,ne,rt,U,C),Ee(e,J-le,dt+ye,ne,rt,U,C),Re(ye,U),Ee(e,Y,$t+ye,Se,Ut,U,C),Ee(e,N,$t+ye,Se,Ut,U,C),Ce(ye,U);break}case"walk":{const q=s*Math.PI*2,le=Math.sin(q)*2,ye=Math.abs(Math.cos(q))*1;ae(dt+rt+1),Ee(e,K+le,dt+ye,ne,rt,U,C),Ee(e,J-le,dt+ye,ne,rt,U,C),Re(ye,U),Ee(e,Y-le,$t+ye,Se,Ut,U,C),Ee(e,N+le,$t+ye,Se,Ut,U,C),Ce(ye,U);break}case"gathering":{const q=s*Math.PI*2,le=1,Be=(Math.sin(q)+1)/2*2,ye=le+Math.abs(Math.cos(q))*.5;ae(dt+rt+1),Ee(e,K,dt+ye,ne,rt-le,U,C),Ee(e,J,dt+ye,ne,rt-le,U,C),Re(ye,U),Ee(e,Y+1,$t+ye-Be,Se,Ut,U,C),Ee(e,N-1,$t+ye-Be,Se,Ut,U,C),Ce(ye,U);break}case"eat":{ae(dt+rt+1),Ee(e,K,dt+1,ne,rt-1,U,C),Ee(e,J,dt+1,ne,rt-1,U,C),Re(1,U);const Be=(Math.sin(s*Math.PI*4)+1)/2,ye=X+qn/2,Gn=Zi+gi/2,nt=N+(ye-N)*Be,qe=$t+1+(Gn-($t+1))*Be;Ee(e,Y,$t+1,Se,Ut,U,C),Ee(e,nt,qe,Se,Ut,U,C),Ee(e,nt,qe-1,1,1,be,C),Ce(1,U);break}case"procreate":{const q=(Math.sin(s*Math.PI*8)+1)/4,le=(Math.sin(s*Math.PI*6)+1)*.5,Be=1.5,ye=Be-le;ae(dt+rt+1),Ee(e,K,dt+ye,ne,rt-Be,U,C),Ee(e,J,dt+ye,ne,rt-Be,U,C),Re(ye,U),Ee(e,Y,$t+ye,Se,Ut,U,C),Ee(e,N,$t+ye,Se,Ut,U,C),Ce(ye,U),e.globalAlpha=q,Re(ye,"white"),e.globalAlpha=1;break}case"attacking":{const q=Math.sin(s*Math.PI)*1.5,le=Math.abs(Math.sin(s*Math.PI));ae(dt+rt+1),Ee(e,K-q,dt+le,ne,rt,U,C),Ee(e,J+q*.5,dt+le,ne,rt,U,C),Re(le,U),Ee(e,Y,$t+le-2,Se,Ut,U,C),Ee(e,N,$t+le-2.5,Se,Ut,U,C),Ce(le,U);break}case"defending":{ae(dt+rt+1),Ee(e,K,dt+1,ne,rt-1,U,C),Ee(e,J,dt+1,ne,rt-1,U,C),Re(1,U),Ee(e,Y-1,$t+1-1,Se,Ut,U,C),Ee(e,N+1,$t+1-1,Se,Ut,U,C),Ce(1,U);break}case"stunned":case"dead":{const q=u==="dead",le=q?Math.min(1,s):0,Be=le>.5?ve:U,ye=c==="male"?Z:te,Gn=le>.8?"transparent":G,nt=A/2,qe=I/2,xn=2;ae(I-1),Ee(e,nt-ne-xn,qe,ne,rt,Be,C),Ee(e,nt+xn,qe,ne,rt,Be,C),Ee(e,nt-Se-xn,qe-In+1,Se,Ut,Be,C),Ee(e,nt+xn,qe-In+1,Se,Ut,Be,C);const Kt=nt-Fe/2,hn=qe-In/2;c==="male"?(le<.7&&Ee(e,Kt,hn+In-wo,Fe,wo,ye,C),Ee(e,Kt,hn,Fe,In-wo,Be,C)):le<.7?Ee(e,Kt,hn,Fe,In,ye,C):Ee(e,Kt,hn,Fe,In,Be,C);const $n=nt-qn/2,Wn=qe-In/2-gi+1;if(Ee(e,$n,Wn,qn,gi,Be,C),Gn!=="transparent"&&Ee(e,$n,Wn,qn,lu,Gn,C),q&&le>.6){const Ei="#B0A890";for(let dr=0;dr<3;dr++)Ee(e,Kt+1,hn+dr*1+1,Fe-2,.5,Ei,C)}break}default:Ee(e,0,0,A,I,"magenta",C);break}e.restore()}};function QP(e,t,i,o,a){const s=t.x,u=t.y-i-o/2;e.save(),e.fillStyle=a,e.strokeStyle=a,e.lineWidth=1.5,e.beginPath(),e.rect(s-o/2,u,o,o/2),e.fill(),e.beginPath(),e.moveTo(s-o/2,u),e.lineTo(s-o/4,u-o/3),e.lineTo(s-o/6,u),e.moveTo(s-o/6,u),e.lineTo(s,u-o/2),e.lineTo(s+o/6,u),e.moveTo(s+o/6,u),e.lineTo(s+o/4,u-o/3),e.lineTo(s+o/2,u),e.stroke(),e.restore()}function Ra(e,t,i,o,a,s=!1,u=!1,c=!1,f=!1){o<th&&(i=i*.75),_h.render(e,t.x-i/2,t.y-i/2,i,i,0,"idle",a,o,[0,0],!1,0);let g,m;s?(g=wC,m=Xv):u?(g=RC,m=qv):c?(g=PC,m=Zv):f&&(g=NC,m=Kv),g&&m&&QP(e,t,i/2,g,m)}function JP(e,t,i,o,a,s){if(e.save(),o.length===0){e.restore();return}const u=o.length*a,c=4;let f;const g=u+(o.length-1)*c;o.length>1&&g>s?f=(s-u)/(o.length-1):f=c,o.length<=1&&(f=0);for(let m=0;m<o.length;m++){const{member:S,isPlayer:T,isHeir:A,isPartner:I,isParent:y}=o[m],C=t+m*(a+f)+a/2,O=i+a/4;Ra(e,{x:C,y:O},a,S.age,S.gender,T,A,I,y)}e.restore()}function eN(e,t,i,o,a){if(i.length===0)return;e.save();const s=Kn,u=" 00",c=" 00";e.font=`${jd}px "Press Start 2P", Arial`;const f=e.measureText(u).width,g=e.measureText(c).width,m=Kn+An+Kn+An+Kn+zi+f+Kn/2+zi+g,S=i.length*Xl+(i.length-1)*l0,T=a-S-Kn;e.fillStyle=OC,e.fillRect(s,T,m,S);for(let A=0;A<i.length;A++){const I=i[A],y=T+A*(Xl+l0),C=y+Xl/2;I.isPlayerTribe&&(e.fillStyle=DC,e.fillRect(s,y,m,Xl));let O=s+Kn;if(e.font=`${An}px "Press Start 2P", Arial`,e.textBaseline="middle",e.textAlign="left",e.fillText(I.tribeBadge,O,C-An/4),O+=An+Kn,!I.isPlayerTribe){const F=I.diplomacyStatus===Dt.Friendly?"":"",P=`diplomacyButton_${I.leaderId}`,H={x:O-2,y:C-An/2-2,width:An+4,height:An+4},B={id:P,action:re.ToggleDiplomacy,rect:H,text:"",icon:F,backgroundColor:"transparent",textColor:"white",currentWidth:An,tooltip:`Toggle diplomacy with this tribe (Currently: ${I.diplomacyStatus})`,targetTribeId:I.leaderId};t.uiButtons.push(B),t.hoveredButtonId===P&&(e.fillStyle=fh,e.globalAlpha=.5,e.fillRect(H.x,H.y,H.width,H.height),e.globalAlpha=1),e.font=`${An*.8}px "Press Start 2P", Arial`,e.textBaseline="middle",e.textAlign="center",e.fillText(F,O+An/2,C)}O+=An+Kn,I.adultCount>0&&(Ra(e,{x:O+zi/2,y:C},zi,25,"male"),O+=zi/2,e.font=`${jd}px "Press Start 2P", Arial`,e.fillStyle="white",e.textBaseline="middle",e.textAlign="left",e.fillText(` ${I.adultCount}`,O,C),O+=e.measureText(` ${I.adultCount}`).width+Kn/2),I.childCount>0&&(Ra(e,{x:O+zi/2,y:C},zi,1,"female"),O+=zi/2,e.font=`${jd}px "Press Start 2P", Arial`,e.fillStyle="white",e.textBaseline="middle",e.textAlign="left",e.fillText(` ${I.childCount}`,O,C))}e.restore()}function tN(e,t,i,o,a){const s=lS,u=uS,c=t+o-s-u,f=i+u;e.save(),e.lineWidth=2,e.strokeStyle=a?s_:o_,e.beginPath();const g=5;e.moveTo(c+g,f+g),e.lineTo(c+s-g,f+s-g),e.moveTo(c+s-g,f+g),e.lineTo(c+g,f+s-g),e.stroke(),e.restore()}function nN(e,t,i,o){const{tutorialState:a,tutorial:s}=t;if(a.transitionState===zt.INACTIVE)return;const u=s.steps[a.currentStepIndex];if(!u)return;e.save(),e.globalAlpha=a.transitionAlpha;const c=qC,f=QC,g=JC,m=`${Kd}px "Press Start 2P", Arial`,S=`${m0}px "Press Start 2P", Arial`,T=t_,A=m0*1.5;e.font=S;const I=u.text.split(" ");let y="";const C=[];for(let ve=0;ve<I.length;ve++){const be=y+I[ve]+" ";e.measureText(be).width>c-f*2&&ve>0?(C.push(y),y=I[ve]+" "):y=be}C.push(y);const O=f*2+Kd+f/2+C.length*A,F=(i-c)/2,P=o-O-160;e.fillStyle=e_,e.beginPath(),e.moveTo(F+g,P),e.lineTo(F+c-g,P),e.quadraticCurveTo(F+c,P,F+c,P+g),e.lineTo(F+c,P+O-g),e.quadraticCurveTo(F+c,P+O,F+c-g,P+O),e.lineTo(F+g,P+O),e.quadraticCurveTo(F,P+O,F,P+O-g),e.lineTo(F,P+g),e.quadraticCurveTo(F,P,F+g,P),e.closePath(),e.fill(),e.fillStyle=T,e.textAlign="center",e.textBaseline="top",e.font=m,e.fillText(u.title,F+c/2,P+f),e.font=S;let H=P+f+Kd+f/2;for(const ve of C)e.fillText(ve,F+c/2,H),H+=A;const B=t.hoveredButtonId==="tutorial-dismiss";tN(e,F,P,c,B),e.restore();const U=lS,G=uS,Z=F+c-U-G,te=P+G;return{x:Z,y:te,width:U,height:U}}function gf(e,t,i){e.save();const o=r_,a={x:t.x-o,y:t.y-o,width:t.width+o*2,height:t.height+o*2};e.strokeStyle=sS,e.lineWidth=aS+Math.sin(i*hh)*1.5,e.setLineDash([8,8]),e.strokeRect(a.x,a.y,a.width,a.height),e.restore()}function iN(e,t){e.fillStyle="white",e.font='30px "Press Start 2P", Arial',e.textAlign="center",e.fillText("Game Over!",e.canvas.width/2,e.canvas.height/2-60),e.font='20px "Press Start 2P", Arial',e.fillText("Lineage Extinct.",e.canvas.width/2,e.canvas.height/2-20),e.fillText(`Cause: ${t.causeOfGameOver||"Unknown"}`,e.canvas.width/2,e.canvas.height/2+20)}const zS=10,rN=3,G0=zS*.7;function oN(e,t){const{position:i,food:o,maxFood:a}=t;if(e.beginPath(),e.arc(i.x,i.y,zS,0,Math.PI*2),e.fillStyle="#228B22",e.fill(),e.strokeStyle="#006400",e.lineWidth=1,e.stroke(),o.length>0){const s=Math.PI*2/Math.min(o.length,a);for(let u=0;u<o.length;u++){const c=u*s,f=i.x+G0*Math.cos(c),g=i.y+G0*Math.sin(c);e.beginPath(),e.arc(f,g,rN,0,Math.PI*2),e.fillStyle="#FF0000",e.fill()}}}const x0=(e,t,i=70,o=50)=>{const a=e>>t&255;return`hsl(${Math.floor(a/255*360)}, ${i}%, ${o}%)`},sN=(e,t)=>{const i=e.match(/hsl\((\d+),\s*(\d+)%,\s*(\d+)%\)/);if(!i)return e;const[o,a,s]=[parseInt(i[1]),parseInt(i[2]),parseInt(i[3])];return`hsl(${o}, ${a}%, ${Math.max(0,s-t)}%)`},uu=(e,t,i,o,a,s,u,c=!1)=>{e.save(),e.translate(t,i),e.rotate(s),e.fillStyle=c?sN(u,15):u,e.beginPath(),e.roundRect(-o/2,0,o,a,o/2),e.fill(),e.restore()},pf=(e,t)=>{const i=e.match(/hsl\((\d+),\s*(\d+)%,\s*(\d+)%\)/),o=75;if(!i)return`hsl(0, 0%, ${o}%)`;const[,a,s,u]=i.map(Number),c=s*(1-t),f=u+(o-u)*t;return`hsl(${a}, ${c}%, ${f}%)`},YS={name:"tribe-prey-2d",referenceImage:"swos.png",description:`A 2D prey asset for the Tribe game, featuring various stances and animations.

Prey is an animal which can be hunted by predators or humans in the Tribe game.

Preys look like small 4 leg mammals, with a simple and recognizable design. The characters are designed to be easily distinguishable and animated in a way that conveys their actions clearly.

# Visual style

Prey characters in the Tribe game are inspired by classic 2D pixel art, they look like Sensible Soccer players(Sensible Soccer game visual style is IMPORTANT), with a simple and recognizable design. The characters are designed to be easily distinguishable and animated in a way that conveys their actions clearly.

Character in Tribe game look like creatures from stone age, they have simple clothing, no shoes, and no modern accessories. The characters are designed to be easily distinguishable and animated in away that conveys their actions clearly.

Prey walks on all fours, unlike human (two legs).

Each prey is described by a unique gene code, which is a number that defines its appearance, size, and other characteristics. The gene code is used to generate the character's appearance, including body proportions, color, and other visual features. The gene code is a 32-bit integer, with each bit representing a specific characteristic of the character.

Prey should have should have visible body parts, such as head, torso, arms, and legs. The body parts should be connected and should not overlap. The character's body parts should be simple shapes, such as circles and rectangles, with solid colors and no gradients or patterns.

Preys are supposed to be sympathetic and friendly, so the character's face should have a friendly expression, with a smile and bright eyes. The character's eyes should be large and expressive, with a simple design.

# Technical details

The asset is rendered on a canvas using the CanvasRenderingContext2D API. The rendering function takes parameters for position, size, progress, stance, direction, gender, and age. The character can face left or right, and the rendering adapts based on the stance (e.g., idle, walk, eat, procreate).
The rendering function must be simple and efficient, it should not use complex patterns or gradients, and should focus on solid colors and basic shapes to maintain the pixel art aesthetic.

15% padding from all edges of the rendering box is required to ensure the character is not cut off during rendering.

Subtle shadow should be drawn under the a character to give it a sense of depth.

IMPORTANT: The character is visible from the side, just like in Sensible Soccer.

# Rendering parameters

- age: The age of the character, which affects the size and proportions of the body parts. Age is a number between 0 and 12, with 2 being the average age.
- gender:
  - 'male': Male prey are larger and more robust, with a more pronounced musculature.
  - 'female': Female prey are smaller and more agile, with a leaner build.
- isPregnant: (applicable only for females) Indicates if the character is pregnant, like very large belly. Pregnant characters should have a larger torso.
- direction: A vector indicating the character's facing direction. There should be at least 8 directions (like in Sensible Soccer): top left, top, top right, left, right, bottom left, bottom, bottom right. The character should be flipped horizontally if the direction vector's X component is negative.
             When moving up(top, top left, top right), the character back of the head should be visible, when moving down(Y > 0), the character face should be visible.
- hungryLevel: A number between 0 and 100 indicating how hungry the character is, hunger level 100 means the character is starving, 0 means the character is not hungry at all. So hungry characters should be thinner, with less body fat, and more pronounced muscles. The character's hunger level affects the size and proportions of the body parts, with hungrier characters being smaller and more gaunt.

# Rendering details

- All parts of the body must be connected
- Rendering must take into account direction vector (X and Y) to flip the character horizontally if needed
- The character's age affects the size and proportions of the body parts, with older characters being larger and more robust. Hair color should become gray for older characters.

# Stances

- 'idle': The character stands still, with a slight leg sway to indicate life.
- 'walk': The character moves forward, with legs and arms in motion.
- 'eat': The character holds food and brings it to their mouth, with a slight bend at the knees.
- 'procreate': The character performs a mating animation, with a specific pose and movement. There should be some additional visual effects to indicate this action, such as a slight glow or aura around the characters, or a dust particles to indicate movement.
- 'dead': The character lies on the ground, with limbs relaxed and a neutral expression, slowly turns into a grey skeleton over time. The character pose and body parts should not be animated in this stance, as the character is dead so it should not move.`,stances:["idle","walk","eat","dead","procreate"],render(e,t,i,o,a,s,u,c={gender:"male",age:2,direction:[1,0],isPregnant:!1,hungryLevel:0,geneCode:8405024}){e.save(),e.imageSmoothingEnabled=!1;const f=o*.15,g=t+o/2,m=i+a/2,S=o-f*2,T=a-f*2,{gender:A,age:I,direction:y,isPregnant:C,hungryLevel:O,geneCode:F}=c,P=.8+Math.min(I,10)/10*.4,H=A==="male"?1.05:.95,B=1-O/100*.3,U=S*.5*B*P*H;let G=T*.3*P*H;const Z=S*.15*P*H,te=U*.2,ve=T*.3,be=x0(F,0,30,50);let De=x0(F,8,50,40);if(I>45){const ae=Math.min(1,(I-45)/15);De=pf(De,ae)}e.translate(g,m),y[0]<0&&e.scale(-1,1);const Ie=Math.sin(s*Math.PI*2),he=Math.cos(s*Math.PI*2),Fe=ve+G*.2;if(u==="dead"){const ae=Math.min(s,1);e.translate(0,T*.2),e.rotate(Math.PI/2);const Re=pf(De,ae),Ce=pf(be,ae);e.globalAlpha=.5+ae*.5,e.strokeStyle=Re,e.lineWidth=te*.5,e.beginPath(),e.moveTo(-U*.4,0),e.lineTo(U*.4,0),e.stroke();for(let q=-1;q<=1;q+=1)e.beginPath(),e.arc(0,0,G*.4,Math.PI*.4*q-Math.PI*.2,Math.PI*.4*q+Math.PI*.2),e.stroke();e.fillStyle=Ce,e.beginPath(),e.arc(U*.5,0,Z,0,Math.PI*2),e.fill(),e.fillStyle="black",e.beginPath(),e.arc(U*.55,0,Z*.3,0,Math.PI*2),e.fill(),e.restore();return}e.fillStyle="rgba(0, 0, 0, 0.1)",e.beginPath(),e.ellipse(0,Fe,U*.7,U*.25,0,0,2*Math.PI),e.fill();let Se=0,ne=0,z=0,X=0,Y=0,N=0;switch(u){case"idle":ne=Ie*(T*.02),z=Ie*.05,X=-Ie*.05,Y=-Ie*.05,N=Ie*.05;break;case"walk":ne=Math.abs(he)*(T*-.04),z=Ie*.7,X=-Ie*.7,Y=-Ie*.7,N=Ie*.7;break;case"eat":Se=T*.1,ne=T*.05,Se+=Ie*(T*.02);break;case"procreate":ne=T*.05;const ae=(1-he)*-S*.05;e.translate(ae,0),e.shadowColor="rgba(255, 182, 193, 0.9)",e.shadowBlur=10;break}C&&A==="female"&&(G*=1.6);const b=ne,K=b-G*.2;uu(e,U*-.35,K,te,ve,Y,De,!0),uu(e,U*.35,K,te,ve,N,De,!0),e.fillStyle=De,e.beginPath(),e.ellipse(0,b,U/2,G/2,0,0,2*Math.PI),e.fill();const J=U*.45,pe=K+Se;e.fillStyle=be,e.beginPath(),e.arc(J,pe,Z,0,Math.PI*2),e.fill(),y[1]>=0&&(e.fillStyle="black",e.beginPath(),e.arc(J+Z*.3,pe-Z*.2,Z*.15,0,Math.PI*2),e.fill()),uu(e,U*-.35,K,te,ve,z,De),uu(e,U*.35,K,te,ve,X,De),e.restore()}};function aN(e,t){let[i,o,a]=e.match(/\d+/g).map(Number);return i=Math.max(0,i-t),o=Math.max(0,o-t),a=Math.max(0,a-t),`rgb(${i}, ${o}, ${a})`}function lN(e){const t=(e&16711680)>>16,i=(e&65280)>>8,o=e&255,a=`rgb(${t}, ${i}, ${o})`,s=aN(a,40),u=(e&255)%100+50,c=(e>>8&255)%100,f=(e>>16&255)%100,g=`rgb(${u}, ${c}, ${f})`,m=(e&8388608)!==0?"#00aaff":"#ffaa00";return{furColor:a,darkerFurColor:s,skinColor:g,eyeColor:m}}const jS={name:"tribe-predator-2d",referenceImage:"swos.png",description:`A 2D predator asset for the Tribe game, featuring various stances and animations.

Predator is an animal which can hunt and attack humans in the Tribe game. It is designed to be a threat to the player, adding an element of danger and challenge to the game world.

Predator look like bears or wolves, with a simple and recognizable design. The characters are designed to be easily distinguishable and animated in a way that conveys their actions clearly.

# Visual style

Predator characters in the Tribe game are inspired by classic 2D pixel art, they look like Sensible Soccer players(Sensible Soccer game visual style is IMPORTANT), with a simple and recognizable design. The characters are designed to be easily distinguishable and animated in a way that conveys their actions clearly.

Character in Tribe game look like creatures from stone age, they have simple clothing, no shoes, and no modern accessories. The characters are designed to be easily distinguishable and animated in away that conveys their actions clearly.

Predator walks on arms and legs, unlike human (two legs).

Each predator is described by a unique gene code, which is a number that defines its appearance, size, and other characteristics. The gene code is used to generate the character's appearance, including body proportions, color, and other visual features. The gene code is a 32-bit integer, with each bit representing a specific characteristic of the character.

Predator should have visible ears, eyes, and mouth with teeth. It must have a tail. Front legs should be shorter than back legs, and they should be positioned closer to the body. The character's body should be wider at the top and narrower at the bottom, with a slight curve to the back. The character's head should be larger than the body, with a pronounced jaw and sharp teeth.

# Technical details

The asset is rendered on a canvas using the CanvasRenderingContext2D API. The rendering function takes parameters for position, size, progress, stance, direction, gender, and age. The character can face left or right, and the rendering adapts based on the stance (e.g., idle, walk, eat, procreate).
The rendering function must be simple and efficient, it should not use complex patterns or gradients, and should focus on solid colors and basic shapes to maintain the pixel art aesthetic.

15% padding from all edges of the rendering box is required to ensure the character is not cut off during rendering.

Subtle shadow should be drawn under the a character to give it a sense of depth.

IMPORTANT: The character is visible from the side, just like in Sensible Soccer.

# Rendering parameters

- age: The age of the character, which affects the size and proportions of the body parts. Age is a number between 1 and 20, with 3 being the average age.
- gender:
  - 'male': Male predators are larger and more robust, with a more pronounced musculature.
  - 'female': Female predators are smaller and more agile, with a leaner build.
- isPregnant: (applicable only for females) Indicates if the character is pregnant, like very large belly. Pregnant characters should have a larger torso.
- direction: A vector indicating the character's facing direction. There should be at least 8 directions (like in Sensible Soccer): top left, top, top right, left, right, bottom left, bottom, bottom right. The character should be flipped horizontally if the direction vector's X component is negative.
             When moving up(top, top left, top right), the character back of the head should be visible, when moving down(Y > 0), the character face should be visible.
- hungryLevel: A number between 0 and 100 indicating how hungry the character is, hunger level 100 means the character is starving, 0 means the character is not hungry at all. So hungry characters should be thinner, with less body fat, and more pronounced muscles. The character's hunger level affects the size and proportions of the body parts, with hungrier characters being smaller and more gaunt.

# Rendering details

- All parts of the body must be connected
- Rendering must take into account direction vector (X and Y) to flip the character horizontally if needed
- The character's age affects the size and proportions of the body parts, with older characters being larger and more robust. Hair color should become gray for older characters.

# Stances

- 'idle': The character stands still, with a slight leg sway to indicate life.
- 'walk': The character moves forward, with legs and arms in motion.
- 'eat': The character holds food and brings it to their mouth, with a slight bend at the knees.
- 'procreate': The character performs a mating animation, with a specific pose and movement. There should be some additional visual effects to indicate this action, such as a slight glow or aura around the characters, or a dust particles to indicate movement.
- 'attacking': The character performs an attack animation, with arms raised and a forward motion.
- 'dead': The character lies on the ground, with limbs relaxed and a neutral expression, slowly turns into a grey skeleton over time. The character pose and body parts should not be animated in this stance, as the character is dead so it should not move.`,stances:["idle","walk","eat","dead","attacking","procreate"],render(e,t,i,o,a,s,u,c={gender:"male",age:20,direction:[1,0],isPregnant:!1,hungryLevel:0,geneCode:8405024}){const{gender:f,age:g,direction:m,isPregnant:S,hungryLevel:T,geneCode:A}=c;e.save();const I=o*.15,y=Math.max(1,Math.floor((o-I*2)/10)),C=m[0]<0;e.translate(t+o/2,i+a/2),C&&e.scale(-1,1);const O=lN(A),F=.8+Math.min(g,20)/20*.4,P=f==="male"?1.05:.95,H=1-T/100*.25,B=F*P*H,U=Math.max(0,Math.min(1,(g-15)/5));e.filter=`grayscale(${U})`;const G=O.furColor,Z=O.darkerFurColor,te=O.eyeColor,ve="#FFFFFF",be="#c75c5c",De="#E0E0E0",Ie="#A0A0A0",he=a/2-2*y,Fe=Math.sin(s*Math.PI*2),Se=Math.abs(Fe);if(e.fillStyle="rgba(0,0,0,0.15)",e.beginPath(),e.ellipse(0,he,y*4,y,0,0,2*Math.PI),e.fill(),e.filter="none",u==="dead"){const nt=Math.min(1,s*2);e.save(),e.translate(0,he-y*3),e.rotate(-Math.PI/2);const qe=(xn,Kt,hn,$n,Wn=!1)=>{e.fillStyle=Wn?Ie:De,e.fillRect(xn*y,Kt*y,hn*y,$n*y)};nt<1&&(e.globalAlpha=1-nt,e.fillStyle=G,e.beginPath(),e.ellipse(0,0,y*3,y*5,0,0,Math.PI*2),e.fill(),e.globalAlpha=1),nt>0&&(e.globalAlpha=nt,qe(-1,-4,2,2),qe(1,-3.5,1,1,!0),qe(-.5,-2,1,5,!0),qe(-2.5,-1,5,.5),qe(-2.5,0,5,.5),qe(-2.5,1,5,.5),qe(-3,-2,-1,2,!0),qe(3,-2,1,2),qe(-3,2,-1,2,!0),qe(3,2,1,2),e.globalAlpha=1),e.restore(),e.restore();return}e.fillStyle=G;let ne=0,z=0,X=0,Y=[0,0,0,0];switch(u){case"idle":ne=Fe*y*.1;break;case"walk":const nt=Math.sin(s*Math.PI*4);ne=Math.abs(nt)*-y*.5,Y=[nt*y,-nt*y,-nt*y,nt*y];break;case"attacking":const qe=Math.sin(s*Math.PI*4);z=y*2+qe*y,X=y*2,ne=y;break;case"eat":X=y*3+Se*y,ne=y*1.5,e.fillStyle=be,e.fillRect(-y,he-y,y*2,y);break;case"procreate":ne=Math.sin(s*Math.PI*8)*y*.3,e.fillStyle="rgba(139, 69, 19, 0.5)";for(let Kt=0;Kt<5;Kt++){const hn=(Math.random()-.5)*y*8,$n=he+(Math.random()-.5)*y*2;Se>.5&&e.fillRect(hn,$n,y*.5,y*.5)}break}const N=y*3*B*(S?1.3:1),b=y*5*B,K=-b/1.5,J=he-N-y*2.5+ne;e.fillStyle=G,e.beginPath(),e.moveTo(K-y*.5,J+N*.5),e.quadraticCurveTo(K-y*3,J-y,K-y*2+Fe*y,J+N+y),e.fill();const pe=y*1.2*B,ae=y*3*B,Re=y*2.5*B,Ce=K+b*.8,q=K+b*.2;e.fillStyle=Z,e.fillRect(q,he-Re,pe,Re+Y[2]),e.fillRect(Ce,he-ae,pe,ae+Y[0]),e.fillStyle=G,e.beginPath(),e.moveTo(K,J+N),e.lineTo(K,J+y),e.quadraticCurveTo(K+b/2,J,K+b,J+y),e.lineTo(K+b,J+N),e.fill(),e.fillStyle=G,e.fillRect(q+y/2,he-Re,pe,Re+Y[3]),e.fillRect(Ce+y/2,he-ae,pe,ae+Y[1]);const le=y*3.5*B,Be=K+b-le*.3+z,ye=J-le*.3+X;e.fillStyle=G,e.beginPath(),e.arc(Be,ye,le/2,0,Math.PI*2),e.fill(),e.beginPath(),e.ellipse(Be+le*.4,ye+le*.2,y*1.5,y,0,0,Math.PI*2),e.fill(),m[1]>=0&&(e.fillStyle=te,e.fillRect(Be+y*.5,ye-y*.5,y*.5,y*.5),u==="attacking"&&(e.fillStyle=ve,e.fillRect(Be+le*.5,ye+le*.4,y,y*.4))),e.fillStyle=Z,e.beginPath(),e.moveTo(Be-le*.4,ye-le*.3),e.lineTo(Be,ye-le*.7),e.lineTo(Be,ye-le*.2),e.fill(),e.restore()}},uN=9;function cN(e,t){const{position:i,gender:o,age:a,decayProgress:s,food:u,radius:c,originalEntityType:f,geneCode:g}=t;if(e.save(),e.globalAlpha=1-s,f==="human"?_h.render(e,i.x-c,i.y-c,c*2,c*2,s,"dead",o,a,[0,0],!1,0):f==="prey"?YS.render(e,i.x-c,i.y-c,c*2,c*2,s,"dead",{gender:o,age:a,direction:[0,0],isPregnant:!1,hungryLevel:0,geneCode:g||8405024}):f==="predator"&&jS.render(e,i.x-c,i.y-c,c*2,c*2,s,"dead",{gender:o,age:a,direction:[0,0],isPregnant:!1,hungryLevel:0,geneCode:g||8405024}),e.restore(),u.length>0){e.save(),e.font=`${uN}px Arial`,e.textAlign="center",e.textBaseline="middle";const m=wt*.9,S=Math.PI/Hv*3;u.forEach((T,A)=>{const I=A*S,y=i.x+m*Math.cos(I)*Math.atan2(A,A),C=i.y+m*Math.sin(I)*Math.atan2(A,A),O=eh[T.type];e.fillText(O,y,C)}),e.restore()}}function nr(e,t,i,o,a,s,u,c){e.save(),e.fillStyle=u,e.fillRect(t,i,o,a),e.fillStyle=c,e.fillRect(t,i,o*Math.max(0,s),a),e.restore()}function dN(e,t,i,o,a,s){if(e.save(),o.length===0){e.restore();return}const u=o.length*a;let c;u>s||u+(o.length-1)*4>s?c=(s-u)/(o.length-1):c=4,o.length===1&&(c=0);for(let f=0;f<o.length;f++){const g=eh[o[f].type];e.fillText(g,t+f*(a+c),i)}e.restore()}function fN(e,t,i,o,a){const s=t.autopilotControls.hoveredAutopilotAction;if(!s)return;let u,c=wt/2;const f=xu[s.action],g=fS[s.action],m=`${f} ${g}`;if("targetEntityId"in s){const S=t.entities.entities[s.targetEntityId];S&&(u=S.position,c=S.radius)}else"position"in s&&(u=s.position);if(u){WS(e,u,c,ch,dh,2,i,o,a,t.mapDimensions),e.save(),e.font=`${Xo}px "Press Start 2P", Arial`,e.fillStyle="white",e.textAlign="center",e.textBaseline="bottom",e.shadowColor="black",e.shadowBlur=5;const{x:S,y:T}=Yu(u,i,{width:o,height:a},t.mapDimensions),A=T-c-Gu-Xo/2;e.fillText(m,S,A),e.restore()}}function hN(e,t,i,o,a){e.save();const s=(Math.sin(a*hh)+1)/2,u=i+Gu+s*5;e.strokeStyle=ch,e.lineWidth=2,e.setLineDash(dh),e.beginPath(),e.arc(t.x,t.y,u,0,Math.PI*2),e.stroke(),e.setLineDash([]);const c=xu[o],f=fS[o];if(c){e.font=`${Xo*1.5}px "Press Start 2P", Arial`,e.textAlign="center",e.textBaseline="middle";const g=t.y-u-25;e.fillText(c,t.x,g),e.font=`${Xo*.8}px "Press Start 2P", Arial`,e.fillText(f,t.x,g+25)}e.restore()}function gN(e,t,i){e.save();const o=30,a=70,s=3,u=a/s;for(let c=0;c<s;c++){const f=c*u,g=(i*o+f)%a,m=1-g/a;e.strokeStyle=`rgba(255, 215, 0, ${m*.7})`,e.lineWidth=1+(1-m)*2,e.beginPath(),e.arc(t.x,t.y,g,0,Math.PI*2),e.stroke()}e.restore()}function pN(e,t){const{activeAutopilotAction:i,behaviors:o}=t.autopilotControls,a=pt(t);if(!a)return;const s=(u,c)=>{gN(u,c.position,t.time)};if(a.isCallingToFollow&&cn(e,t.mapDimensions.width,t.mapDimensions.height,s,{position:a.position}),o.followLeader&&!i&&cn(e,t.mapDimensions.width,t.mapDimensions.height,s,{position:a.position},70),i){let u,c=15;if("position"in i)u=i.position;else if("targetEntityId"in i){const f=t.entities.entities[i.targetEntityId];f&&(u=f.position,c=f.radius||30)}if(u&&i.action!==ce.AutopilotFollowMe&&!a.isCallingToFollow){const f=(g,m)=>{hN(g,m.position,c,i.action,t.time)};cn(e,t.mapDimensions.width,t.mapDimensions.height,f,{position:{...u}},u,c+30)}}}function $0(e,t,i,o,a,s,u=!0){const c=t.split(" ");let f="";const g=[];for(let m=0;m<c.length;m++){const S=f+c[m]+" ";e.measureText(S).width>a&&m>0?(g.push(f),f=c[m]+" "):f=S}if(g.push(f),u)for(let m=0;m<g.length;m++)e.fillText(g[m],i,o+m*s);return g.length*s}function mN(e){return 1-Math.pow(1-e,3)}function vN(e,t,i,o){t.notificationButtonRects={dismiss:{},view:{}};const a=t.notifications.filter(u=>!u.isDismissed);if(a.length===0)return;e.save();let s=o-p_;for(const u of a){const c=i-ql-Rr;e.font=`${Zd}px "Press Start 2P", Arial`;const f=c+Rr,g=ql-Rr*2,m=$0(e,u.message,-9999,-9999,g,Zd*1.2,!1),S=Rr*2+m+Zn,T=s-S,A=Date.now()-u.creationTime,I=Math.min(A/g_,1),y=mN(I),C=o,O=C+(T-C)*y;e.fillStyle=l_,e.beginPath(),e.roundRect(c,O,ql,S,a_),e.fill(),e.fillStyle=u_,e.textBaseline="top",$0(e,u.message,f,O+Rr,g,Zd*1.2,!0);const F=O+S-Zn-Rr/2,P=c+ql-Zn-Rr/2,H={x:P,y:F,width:Zn,height:Zn};t.notificationButtonRects&&(t.notificationButtonRects.dismiss[u.id]=H);const B=t.hoveredButtonId===`notification-dismiss-${u.id}`;if(e.fillStyle=B?y0:c_,e.font=`${Zn}px Arial`,e.textAlign="center",e.textBaseline="middle",e.fillText("",H.x+H.width/2,H.y+H.height/2),u.targetEntityIds||u.targetPosition||u.targetArea||u.targetRadius){const Z={x:P-Zn-S0,y:F,width:Zn,height:Zn};t.notificationButtonRects&&(t.notificationButtonRects.view[u.id]=Z);const te=t.hoveredButtonId===`notification-view-${u.id}`;e.fillStyle=te?y0:d_,e.font=`${Zn*(te?1.5:1.2)}px Arial`,e.fillText("",Z.x+Z.width/2,Z.y+Z.height/2)}s-=S+S0}e.restore()}function SN(e){return e.length===0?0:e.reduce((i,o)=>i+o,0)/e.length}function mf(e,t,i,o,a,s,u,c){e.save(),e.fillStyle="rgba(255, 255, 255, 0.1)",e.fillRect(o,a,s,u),e.strokeStyle="#555",e.lineWidth=1,e.strokeRect(o,a,s,u);const f=SN(i);e.fillStyle="white",e.font="11px monospace",e.textAlign="left",e.fillText(`${t}: ${f.toFixed(2)}ms`,o+Xe,a+Xe+8);const g=Math.max(...i,1),m=i.map(S=>S/g*u);if(e.beginPath(),e.strokeStyle=c,e.lineWidth=2,m.length>1){e.moveTo(o,a+u-m[0]);for(let S=1;S<m.length;S++){const T=o+S/(m.length-1)*s,A=a+u-m[S];e.lineTo(T,A)}}else if(m.length===1){const S=a+u-m[0];e.moveTo(o,S),e.lineTo(o+s,S)}e.stroke(),e.fillStyle="rgba(255, 255, 255, 0.7)",e.font="10px monospace",e.textAlign="right",e.fillText(`${g.toFixed(2)}ms`,o+s-Xe,a+Xe+8),e.restore()}function yN(e,t,i){const{performanceMetrics:o}=t;if(!o)return;const a=280,s=240,u=i-a-Xe,c=Xe+Et*2;e.save(),e.fillStyle="rgba(0, 0, 0, 0.8)",e.fillRect(u,c,a,s),e.strokeStyle="#444",e.lineWidth=2,e.strokeRect(u,c,a,s),e.fillStyle="white",e.font="12px monospace",e.textAlign="left";let f=c+Xe+5;const g=u+Xe;e.fillStyle="#66ccff",e.font="bold 14px monospace",e.fillText(" Performance Debugger",g,f),f+=25,e.fillStyle="white",e.font="12px monospace";const m=AN(t);e.fillText(`FPS: ${m.toFixed(1)}`,g,f),f+=20;const S=a-Xe*2,T=45,A=10;mf(e,"Render",vf(t,"renderTime"),g,f,S,T,"#4CAF50"),f+=T+A,mf(e,"World Update",vf(t,"worldUpdateTime"),g,f,S,T,"#2196F3"),f+=T+A,mf(e,"AI Update",vf(t,"aiUpdateTime"),g,f,S,T,"#FFC107"),e.fillStyle="#888",e.font="10px monospace",e.textAlign="center",e.fillText("Press '2' to toggle this panel",u+a/2,c+s-10),e.restore()}function AN(e){const{performanceMetrics:t}=e;if(!t||t.history.length===0)return 0;const i=t.history[t.history.length-1].bucketTime/(Ct/_t);return t.history.filter(s=>i-s.bucketTime/(Ct/_t)<1).length}function TN(e,t){if(e.length===0)return[];const i=new Map;for(const s of e){const u=Math.floor(s.bucketTime/(Ct/_t));i.set(u,(i.get(u)||0)+s[t])}return Array.from(i.keys()).sort().map(s=>i.get(s)).slice(0,-1).slice(1).reverse()}function vf(e,t){return TN(e.performanceMetrics.history,t)}function wh(e,t,i){if(!t.aiBlackboard)return;const o=t.aiBlackboard.nodeExecutionData,a=t.type==="human"?kS:t.type==="predator"?LS:t.type==="prey"?FS:null;if(!a)return;e.save(),e.font=`${GC}px Arial`,e.textAlign="left",e.textBaseline="top";const s=T=>{switch(T){case E.SUCCESS:return $C;case E.FAILURE:return WC;case E.RUNNING:return zC;case E.NOT_EVALUATED:case null:default:return YC}},u=T=>{if(!T.name||!o[T.name])return{width:0,height:0};let A=0,I=0;const y=o[T.name],C=` ${T.name}`+(y!=null&&y.debugInfo?`: ${y.debugInfo}`:""),O=e.measureText(C).width,F=(T.depth??0)*h0+8+O+p0+Vs+20;if(A=Math.max(A,F),I+=Xd,T.children)for(const P of T.children){const H=u(P);A=Math.max(A,H.width),I+=H.height}else if(T.child){const P=u(T.child);A=Math.max(A,P.width),I+=P.height}return{width:A,height:I}},c=(T,A,I,y)=>{if(!T.name||!o[T.name])return A;let C=A;const O=o[T.name],F=I+2+(T.depth??0)*h0;let P=E.NOT_EVALUATED,H=g0,B="";if(O){P=O.status,B=O.debugInfo;const Z=VC/_t*Ct,te=i-O.lastExecuted,ve=Math.max(0,1-te/Z);H=ZE(g0,jC,ve),te>ya&&(P=E.NOT_EVALUATED)}const U=s(P);e.fillStyle=U,e.fillText("",F,C),e.fillStyle=H;const G=` ${T.name}`+(B?`: ${B}`:"");if(e.fillText(G,F+8,C),O&&O.executionHistory.length>0){const{executionHistory:Z}=O,te=oS/_t*Ct,ve=i,be=ve-te,De=I+y-Vs-p0;let Ie=De;const he=C+(Xd-Zl)/2,Fe=Z.filter(K=>K.time<be);let Se=Fe.length>0?Fe[Fe.length-1].status:null,ne=be;const z=Z.filter(K=>K.time>=be&&K.time<=ve),X=Vs/te;e.fillStyle="rgba(255, 255, 255, 0.1)",e.fillRect(De,he,Vs,Zl);for(const K of z){const pe=(K.time-ne)*X;pe>0&&(e.fillStyle=s(Se),e.fillRect(Ie,he,pe,Zl),Ie+=pe),Se=K.status,ne=K.time}i-ne>ya&&(Se=E.NOT_EVALUATED);const N=(ve-ne)*X;e.fillStyle=s(Se);const b=De+Vs-Ie;e.fillRect(Ie,he,Math.min(N,b),Zl)}if(C+=Xd,T.children)for(const Z of T.children)C=c(Z,C,I,y);else T.child&&(C=c(T.child,C,I,y));return C},{width:f,height:g}=u(a);if(g===0){e.restore();return}const m=t.position.x+HC,S=t.position.y+bC-g/2;e.fillStyle=xC,e.fillRect(m,S,f,g+4),c(a,S+2,m,f),e.restore()}const IN={moving:"walk",gathering:"gathering",eating:"eat",feeding:"eat",procreating:"procreate",idle:"idle",attacking:"attacking",planting:"gathering",depositing:"gathering",retrieving:"gathering",takingOverBuilding:"attacking",destroyingBuilding:"attacking"};function EN(e,t){var c;const{radius:i,position:o,activeAction:a="idle"}=t,s=((c=t.stateMachine)==null?void 0:c[0])||"N/A",u=t.isAdult?wt+20:wt*.6+20;e.save(),e.fillStyle="white",e.font="10px Arial",e.textAlign="center",e.fillText(`Action: ${a}`,o.x,o.y-u),e.fillText(`State: ${s}`,o.x,o.y-u+10),e.fillText(`HP: ${t.hitpoints}`,o.x,o.y-u+20),e.fillText(`Cooldown: ${t.attackCooldown||"N/A"}`,o.x,o.y-u+30),e.fillText(`Tribe: ${t.leaderId||"N/A"}`,o.x,o.y-u+40),e.restore(),e.beginPath(),e.arc(o.x,o.y,i,0,Math.PI*2),e.strokeStyle="rgba(255, 0, 0, 0.5)",e.lineWidth=1,e.stroke(),e.closePath()}function CN(e,t,i,o,a){e.save(),e.font=`${Ff}px Arial`,e.textAlign="center",e.textBaseline="middle",e.fillText(i,t.x,t.y-(o?wt:ns)-Ff-a),e.restore()}function _N(e,t,i,o,a){const s=t.x,u=t.y-i-o/2;e.save(),e.fillStyle=a,e.strokeStyle=a,e.lineWidth=1.5,e.beginPath(),e.rect(s-o/2,u,o,o/2),e.fill(),e.beginPath(),e.moveTo(s-o/2,u),e.lineTo(s-o/4,u-o/3),e.lineTo(s-o/6,u),e.moveTo(s-o/6,u),e.lineTo(s,u-o/2),e.lineTo(s+o/6,u),e.moveTo(s+o/6,u),e.lineTo(s+o/4,u-o/3),e.lineTo(s+o/2,u),e.stroke(),e.restore()}function wN(e,t,i){var c;const{position:o,radius:a}=t,s=o.x-Vd/2,u=o.y-a-MC;if(((c=t.stateMachine)==null?void 0:c[0])===lr){const f=t.stateMachine[1],g=i-f.attackStartTime,m=Math.min(g/$v,1);nr(e,s,u,Vd,u0,m,Ji,kC)}else if(t.attackCooldown&&t.attackCooldown>0){const f=1-t.attackCooldown/bu;nr(e,s,u,Vd,u0,f,Ji,FC)}}function RN(e,t,i){const a="";e.save(),e.font="15px Arial",e.textAlign="center",e.textBaseline="bottom",e.shadowColor="black",e.shadowBlur=3,e.fillText(a,t.x,t.y-i),e.restore()}function PN(e,t,i=!1,o=!1,a=!1,s=!1,u=!1,c=!1,f=!1,g=!1,m,S){const{position:T,activeAction:A="idle"}=t,I=t.isAdult?wt:wt*.6,y=IN[A]||"idle";_h.render(e,T.x-I,T.y-I,I*2,I*2,t.animationProgress||0,y,t.gender,t.age,[t.direction.x,t.direction.y],t.isPregnant??!1,t.hunger),c&&(e.save(),e.strokeStyle=hC,e.lineWidth=2,e.beginPath(),e.arc(T.x,T.y,I+3,0,2*Math.PI),e.stroke(),e.restore());let C,O;if(u?(C=pC,O=qv):i?(C=gC,O=Xv):a?(C=mC,O=fC):o?(C=vC,O=Kv):s&&(C=SC,O=Zv),C&&O&&_N(e,T,I,C,O),t.tribeBadge&&CN(e,T,t.tribeBadge,t.isAdult??!1,C??0),f){let P=(t.isAdult?wt:ns)+5;C&&(P+=C),t.tribeBadge&&(P+=Ff),RN(e,T,P)}const F=g&&(S===void 0||t.id===S);F&&t.aiBlackboard&&wh(e,t,m),wN(e,t,m),F&&EN(e,t)}const NN={grazing:"eat",moving:"walk",procreating:"procreate",feeding:"eat",idle:"idle"};function DN(e,t){var c;const{radius:i,position:o,activeAction:a="idle"}=t,s=((c=t.stateMachine)==null?void 0:c[0])||"N/A",u=t.isAdult?wt+20:wt*.6+20;e.save(),e.fillStyle="white",e.font="10px Arial",e.textAlign="center",e.fillText(`Action: ${a}`,o.x,o.y-u),e.fillText(`State: ${s}`,o.x,o.y-u+10),e.fillText(`HP: ${t.hitpoints}`,o.x,o.y-u+20),e.fillText(`Hunger: ${Math.round(t.hunger)}`,o.x,o.y-u+30),e.fillText(`Age: ${Math.round(t.age)}`,o.x,o.y-u+40),e.restore(),e.beginPath(),e.arc(o.x,o.y,i,0,Math.PI*2),e.strokeStyle="rgba(0, 255, 0, 0.5)",e.lineWidth=1,e.stroke(),e.closePath()}function ON(e,t,i=!1,o=0,a){var m,S;const{position:s,activeAction:u="idle"}=t,c=t.isAdult?t.radius:t.radius*.6,f=NN[u]||"idle";if(YS.render(e,s.x-c,s.y-c,c*2,c*2,t.animationProgress||0,f,{gender:t.gender,age:t.age,direction:[((m=t.direction)==null?void 0:m.x)||1,((S=t.direction)==null?void 0:S.y)||0],isPregnant:t.isPregnant??!1,hungryLevel:t.hunger,geneCode:t.geneCode}),t.hitpoints<t.maxHitpoints){const T=c*1.5,A=3,I=s.x-T/2,y=s.y-c-8;e.fillStyle="#555",e.fillRect(I,y,T,A);const C=t.hitpoints/t.maxHitpoints;e.fillStyle=C>.5?"#4CAF50":C>.25?"#FFC107":"#F44336",e.fillRect(I,y,T*C,A)}const g=i&&(a===void 0||t.id===a);g&&t.aiBlackboard&&wh(e,t,o),g&&DN(e,t)}const MN={attacking:"attacking",eating:"eat",moving:"walk",procreating:"procreate",feeding:"eat",idle:"idle"};function kN(e,t){var c;const{radius:i,position:o,activeAction:a="idle"}=t,s=((c=t.stateMachine)==null?void 0:c[0])||"N/A",u=t.isAdult?wt+20:wt*.6+20;e.save(),e.fillStyle="white",e.font="10px Arial",e.textAlign="center",e.fillText(`Action: ${a}`,o.x,o.y-u),e.fillText(`State: ${s}`,o.x,o.y-u+10),e.fillText(`HP: ${t.hitpoints}`,o.x,o.y-u+20),e.fillText(`Hunger: ${Math.round(t.hunger)}`,o.x,o.y-u+30),e.fillText(`Age: ${Math.round(t.age)}`,o.x,o.y-u+40),e.restore(),e.beginPath(),e.arc(o.x,o.y,i,0,Math.PI*2),e.strokeStyle="rgba(255, 0, 0, 0.5)",e.lineWidth=1,e.stroke(),e.closePath()}function FN(e,t,i=!1,o=0,a){var m,S;const{position:s,activeAction:u="idle"}=t,c=t.isAdult?t.radius:t.radius*.6,f=MN[u]||"idle";if(jS.render(e,s.x-c,s.y-c,c*2,c*2,t.animationProgress||0,f,{gender:t.gender,age:t.age,direction:[((m=t.direction)==null?void 0:m.x)||1,((S=t.direction)==null?void 0:S.y)||0],isPregnant:t.isPregnant??!1,hungryLevel:t.hunger,geneCode:t.geneCode}),t.hitpoints<t.maxHitpoints){const T=c*1.5,A=3,I=s.x-T/2,y=s.y-c-8;e.fillStyle="#555",e.fillRect(I,y,T,A);const C=t.hitpoints/t.maxHitpoints;e.fillStyle=C>.5?"#4CAF50":C>.25?"#FFC107":"#F44336",e.fillRect(I,y,T*C,A)}(t.attackCooldown&&t.attackCooldown>0||t.huntCooldown&&t.huntCooldown>0)&&(e.strokeStyle="#FF8C00",e.lineWidth=3,e.beginPath(),e.arc(s.x,s.y,c+3,0,2*Math.PI),e.stroke());const g=i&&(a===void 0||t.id===a);g&&t.aiBlackboard&&wh(e,t,o),g&&kN(e,t)}const VS=15;function W0(e,t,i,o,a=1.5){const s=i-t.startTime,u=Math.min(s/t.duration,1),c=1-u,g=1+Math.sin(u*Math.PI*2)*(a-1),m=VS*g;e.save(),e.globalAlpha=c,e.beginPath(),e.arc(t.position.x,t.position.y,Math.max(0,m),0,Math.PI*2),e.fillStyle=o,e.fill(),e.restore()}function Ro(e,t,i,o,a=2){const s=i-t.startTime,u=Math.min(s/t.duration,1),c=1-u,f=VS*2*u;e.save(),e.globalAlpha=c,e.beginPath(),e.arc(t.position.x,t.position.y,f,0,Math.PI*2),e.strokeStyle=o,e.lineWidth=a,e.stroke(),e.restore()}function Vi(e,t,i,o){const a=i-t.startTime,s=Math.min(a/t.duration,1),u=1-s,c=-20*s;e.save(),e.globalAlpha=u,e.font="20px Arial",e.textAlign="center",e.fillText(o,t.position.x,t.position.y+c),e.restore()}function LN(e,t,i){switch(t.type){case fe.Hunger:W0(e,t,i,"rgba(255, 165, 0, 0.7)",1);break;case fe.Procreation:Vi(e,t,i,"");break;case fe.Pregnant:W0(e,t,i,"rgba(255, 105, 180, 0.7)",1.2);break;case fe.TargetAcquired:Ro(e,t,i,"rgba(255, 0, 0, 0.8)",3);break;case fe.Attack:Vi(e,t,i,"");break;case fe.Partnered:Vi(e,t,i,"");break;case fe.BushClaimed:Ro(e,t,i,"rgba(0, 255, 0, 0.7)",2);break;case fe.BushClaimLost:Ro(e,t,i,"rgba(128, 128, 128, 0.7)",2);break;case fe.Eating:Vi(e,t,i,"");break;case fe.ChildFed:Vi(e,t,i,"");break;case fe.AttackDeflected:Vi(e,t,i,"");break;case fe.AttackResisted:Vi(e,t,i,"");break;case fe.Hit:Vi(e,t,i,"");break;case fe.SeizeBuildup:Ro(e,t,i,"rgba(255, 215, 0, 0.8)",4);break;case fe.Seize:Ro(e,t,i,"rgba(148, 0, 211, 0.8)",4);break;case fe.CallToAttack:Ro(e,t,i,"rgba(255, 255, 0, 0.8)",4);break}}function z0(e,t,i,o,a,s,u){e.save();const{position:c}=t;e.strokeStyle=o,e.lineWidth=a+Math.sin(u*s)*(a/2),e.setLineDash([8,8]),e.beginPath(),e.arc(c.x,c.y,i,0,2*Math.PI),e.stroke(),e.restore()}const Y0=8,UN=1.5,BN=.5,j0=2,HN="#5a5a5a",bN="#7e7e7e",GN="#8B0000",xN="#FF4444",$N=6;function Sf(e){const t=Math.sin(e)*1e4;return t-Math.floor(t)}function xf(e,t,i,o,a,s){const u=(t+i)*2,c=Math.floor(u/Y0),f=-t/2,g=t/2,m=-i/2,S=i/2;for(let T=0;T<c;T++){const A=o+T*13,I=Sf(A),y=Sf(A+1);let C=T*Y0,O=0,F=0;C<t?(O=f+C,F=m):C<t+i?(O=g,F=m+(C-t)):C<t*2+i?(O=g-(C-(t+i)),F=S):(O=f,F=S-(C-(t*2+i)));const P=(y-.5)*j0,H=(Sf(A+2)-.5)*j0;e.beginPath();const B=UN+I*BN;a?e.fillStyle=a:e.fillStyle=I>.5?s||bN:a||HN,e.ellipse(O+P,F+H,B,B*.85,y*Math.PI,0,Math.PI*2),e.fill(),a||(e.strokeStyle="#2b2b2b",e.lineWidth=1,e.stroke())}}function WN(e,t){if(!t.storedFood||t.storedFood.length===0)return;const{position:i,storedFood:o}=t;e.save(),e.font=`${$N}px Arial`,e.textAlign="center",e.textBaseline="middle",e.shadowColor="rgba(0,0,0,0.5)",e.shadowBlur=2,o.forEach(a=>{const s=eh[a.item.type],u={x:i.x+a.positionOffset.x,y:i.y+a.positionOffset.y};e.fillText(s,u.x,u.y)}),e.shadowBlur=0,e.shadowColor="transparent",e.restore()}function zN(e,t,i){const{position:o,width:a,height:s,constructionProgress:u,destructionProgress:c,isConstructed:f,isBeingDestroyed:g,id:m}=t,S=Na[t.buildingType],T=pt(i),A=T&&Ln(T,t,i);e.save(),e.translate(o.x,o.y),f||(e.globalAlpha=.3+u*.7),A?xf(e,a,s,m,GN,xN):xf(e,a,s,m),e.globalAlpha=.5,e.font=`${Math.min(a,s,30)*.5}px Arial`,e.textAlign="center",e.textBaseline="middle",e.shadowColor="rgba(0,0,0,0.5)",e.shadowBlur=4,e.fillStyle="#FFFFFF",e.fillText(S.icon,0,0),e.shadowBlur=0,e.restore();const I=a,y=o.x-I/2,C=o.y+s/2+Q_;f?g&&nr(e,y,C,I,C0,1-c,Ji,q_):nr(e,y,C,I,C0,u,Ji,Z_),t.buildingType==="storageSpot"&&f&&WN(e,t)}function YN(e,t,i,o,a){const s=Na[i],{width:u,height:c}=s.dimensions,f=(m,S)=>{m.save(),m.translate(S.x,S.y),m.globalAlpha=K_;const T=o?"#4CAF50":"#F44336";xf(m,u,c,9999,T),m.font=`${Math.min(u,c)*.5}px Arial`,m.textAlign="center",m.textBaseline="middle",m.fillStyle=T,m.fillText(s.icon,0,0),m.restore()},g={position:{...t},radius:Math.max(u,c)/2,id:0,type:"building",direction:{x:0,y:0},acceleration:0,forces:[],velocity:{x:0,y:0},debuffs:[]};cn(e,a.width,a.height,(m,S)=>f(m,S.position),g)}function jN(e,t,i,o,a){const s=pt(t),u=s?dn(t,s):[],c=Yr(u),{width:f,height:g}=t.mapDimensions;Object.values(t.entities.entities).sort((I,y)=>i&&I.id===t.debugCharacterId&&I.id!==y.id||I.type==="building"&&y.type!=="building"?-1:I.position.y-y.position.y||I.id-y.id).filter(I=>au(I,o,a,t.mapDimensions)).forEach(I=>{var y,C;if(I.type==="building")cn(e,f,g,zN,I,t,s,t.time);else if(I.type==="berryBush")cn(e,f,g,oN,I,t,s,t.time);else if(I.type==="human"){const O=I,F=O.id===(s==null?void 0:s.id),P=u.some(ve=>ve.id===O.id),H=O.id===(c==null?void 0:c.id),B=s&&(O.id===s.motherId||O.id===s.fatherId),U=s&&(((y=O.partnerIds)==null?void 0:y.includes(s.id))||((C=s.partnerIds)==null?void 0:C.includes(O.id))),G=(s==null?void 0:s.attackTargetId)===O.id,Z=O.leaderId?t.entities.entities[O.leaderId]:void 0,te=s?O.leaderId===s.id&&O.activeAction==="moving"&&O.target===O.leaderId&&(Z==null?void 0:Z.isCallingToFollow):!1;cn(e,f,g,PN,O,F,B,P,U,H,G,te,i,t.time,t.debugCharacterId)}else I.type==="corpse"?cn(e,f,g,cN,I):I.type==="prey"?cn(e,f,g,ON,I,i,t.time,t.debugCharacterId):I.type==="predator"&&cn(e,f,g,FN,I,i,t.time,t.debugCharacterId)}),t.visualEffects.filter(I=>au(I,o,a,t.mapDimensions)).forEach(I=>{cn(e,f,g,LN,I,t.time)});const A=t.notifications.filter(I=>!I.isDismissed);for(const I of A)if(I.highlightedEntityIds&&I.renderHighlights)for(const y of I.highlightedEntityIds){const C=t.entities.entities[y];C&&au(C,o,a,t.mapDimensions)&&cn(e,f,g,z0,C,m_,v_,y_,S_,t.time)}if(t.tutorialState.isActive&&t.tutorialState.highlightedEntityIds.length>0)for(const I of t.tutorialState.highlightedEntityIds){const y=t.entities.entities[I];y&&au(y,o,a,t.mapDimensions)&&cn(e,f,g,z0,y,i_,sS,aS,hh,t.time)}}function VN(e,t,i,o,a,s){let u=null,c=null;e.textAlign="left";let f=Xe+Et;const m=t.time/(Ct/_t)/Hu%1,S=Xs[No.Time],T=25,A=Xe+T;e.fillText(S,Xe,f+an/2+Et/3),nr(e,A,f,Wi,an,m,Ji,_C),f+=an+hi;const I=f+_r/2,y=f+(_r-an)/2,C=5;Ra(e,{x:Xe*2,y:I},_r,5,i.gender,!1,!1,!1);const O=Xe+_r+C,F=Wi+T-(_r+C)*2;nr(e,O,y,F,an,Math.floor(i.age)/Aa,Ji,CC),Ra(e,{x:O+F+C+_r/2,y:I},_r,Aa,i.gender,!1,!1,!1),f+=an+hi*2;const P=[],H=new Set;if(P.push({member:i,isPlayer:!0,isHeir:!1,isPartner:!1,isParent:!1}),H.add(i.id),o&&!H.has(o.id)&&(P.push({member:o,isPlayer:!1,isHeir:!0,isPartner:!1,isParent:!1}),H.add(o.id)),a.forEach(he=>{H.has(he.id)||(P.push({member:he,isPlayer:!1,isHeir:!1,isPartner:!0,isParent:!1}),H.add(he.id))}),s.forEach(he=>{H.has(he.id)||(P.push({member:he,isPlayer:!1,isHeir:!1,isPartner:!1,isParent:!1}),H.add(he.id))}),i.motherId&&!H.has(i.motherId)){const he=t.entities.entities[i.motherId];he&&(P.push({member:he,isPlayer:!1,isHeir:!1,isPartner:!1,isParent:!0}),H.add(he.id))}if(i.fatherId&&!H.has(i.fatherId)){const he=t.entities.entities[i.fatherId];he&&(P.push({member:he,isPlayer:!1,isHeir:!1,isPartner:!1,isParent:!0}),H.add(he.id))}const B=Xs[No.Family],U=10,G=Xe+Et+U,Z=Wi+T-(Et+U),te=f+Vl/2;e.font=`${Et}px "Press Start 2P", Arial`,e.textBaseline="middle",e.fillText(B,Xe,te);const ve=f+Vl/2;JP(e,G,ve,P,Vl,Z),f+=Vl+hi,e.textBaseline="alphabetic";const be=Xs[No.Hitpoints];e.fillText(be,Xe,f+an/2+Et/3),nr(e,A,f,Wi,an,i.hitpoints/i.maxHitpoints,Ji,EC),f+=an+hi;const De=Xs[No.Hunger];e.fillText(De,Xe,f+an/2+Et/3),nr(e,A,f,Wi,an,(Wr-i.hunger)/Wr,Ji,IC),u={x:Xe,y:f-hi/2,width:Wi+T,height:an+hi},f+=an+hi,e.textBaseline="middle";const Ie=Xs[No.Food];return e.fillText(Ie,Xe,f+jl/2),dN(e,A,f+jl/2,i.food,jl,Wi),c={x:Xe,y:f-hi/5,width:Wi+T,height:jl+hi},e.textBaseline="alphabetic",{hungerBarRect:u,foodBarRect:c}}let Js=[],V0=0;const XN=36,KN=200;function ZN(e,t,i,o){const a=t.search.prey.count(),s=t.search.predator.count(),u=t.search.berryBush.count();t.time-V0>=XN&&(Js.push({time:t.time,prey:a,predators:s,bushes:u}),Js.length>KN&&(Js=Js.slice(-200)),V0=t.time);const c=Ke*tt,f=a/c*1e6,g=s/c*1e6,m=u/c*1e6,S=UP(),T=Math.floor(t.time/(24*365)),A=Math.floor(t.time%(24*365)/24),I=Math.floor(t.time%24),y=400,C=Math.min(o*.8,600),O=i-y-10,F=Xe+Et*2;e.save(),e.fillStyle="rgba(0, 0, 0, 0.9)",e.fillRect(O,F,y,C),e.strokeStyle="#444",e.lineWidth=2,e.strokeRect(O,F,y,C),e.fillStyle="white",e.font="12px monospace",e.textAlign="left";let P=F+20;const H=14,B=O+15;e.fillStyle="#66ccff",e.font="bold 14px monospace",e.fillText(" Ecosystem Debugger",B,P),P+=25,e.fillStyle="white",e.font="12px monospace",e.fillText(`Game Time: Year ${T}, Day ${A}, Hour ${I}`,B,P),P+=H,e.fillText(`Map Size: ${Ke}  ${tt} pixels`,B,P),P+=20,e.fillStyle="#66ccff",e.font="bold 13px monospace",e.fillText(" Q-Learning Status",B,P),P+=18,S&&(e.fillText(`Q-Table Size: ${S.qTableSize} entries`,B,P),P+=H,e.fillText(`Exploration Rate: ${(S.explorationRate*100).toFixed(1)}%`,B,P),P+=H);const U=Js.slice(-20);U.length>1&&(e.fillStyle="#66ccff",e.font="bold 13px monospace",e.fillText(" Population Trends (Last 20 Points)",B,P),P+=30,qN(e,B,P,U),P+=50),e.fillStyle="#66ccff",e.font="bold 13px monospace",e.fillText(" Density (per 1000 px)",B,P),P+=18,e.fillStyle="white",e.font="12px monospace";const G=(Si/c*1e6).toFixed(2),Z=(yi/c*1e6).toFixed(2),te=(Ai/c*1e6).toFixed(2);e.fillText(`Prey: ${f.toFixed(2)} (target: ${G})`,B,P),P+=H,e.fillText(`Predators: ${g.toFixed(2)} (target: ${Z})`,B,P),P+=H,e.fillText(`Bushes: ${m.toFixed(2)} (target: ${te})`,B,P),P+=20,e.fillStyle="#66ccff",e.font="bold 13px monospace",e.fillText(" Current Population Status",B,P),P+=18,e.fillStyle="white",e.font="12px monospace";const ve=Math.round(a/Si*100),be=Math.round(s/yi*100),De=Math.round(u/Ai*100),Ie=he=>he<50?"#ff4444":he<80?"#ffaa44":he>120?"#44aaff":"#44ff44";e.fillStyle=Ie(ve),e.fillText(`Prey: ${a}/${Si} (${ve}%)`,B,P),P+=H,e.fillStyle=Ie(be),e.fillText(`Predators: ${s}/${yi} (${be}%)`,B,P),P+=H,e.fillStyle=Ie(De),e.fillText(`Bushes: ${u}/${Ai} (${De}%)`,B,P),P+=20,e.fillStyle="#66ccff",e.font="bold 13px monospace",e.fillText(" Current Parameters",B,P),P+=18,e.fillStyle="white",e.font="10px monospace",e.fillText("Prey:",B,P),P+=13,e.fillText(` Gestation: ${t.ecosystem.preyGestationPeriod.toFixed(1)}h`,B,P),P+=11,e.fillText(` Procreation: ${t.ecosystem.preyProcreationCooldown.toFixed(1)}h`,B,P),P+=11,e.fillText(` Hunger: ${t.ecosystem.preyHungerIncreasePerHour.toFixed(1)}/h`,B,P),P+=13,e.fillText("Predators:",B,P),P+=13,e.fillText(` Gestation: ${t.ecosystem.predatorGestationPeriod.toFixed(1)}h`,B,P),P+=11,e.fillText(` Procreation: ${t.ecosystem.predatorProcreationCooldown.toFixed(1)}h`,B,P),P+=11,e.fillText(` Hunger: ${t.ecosystem.predatorHungerIncreasePerHour.toFixed(1)}/h`,B,P),P+=13,e.fillText("Bushes:",B,P),P+=13,e.fillText(` Spread Chance: ${(t.ecosystem.berryBushSpreadChance*100).toFixed(1)}%`,B,P),P+=15,e.fillStyle="#888",e.font="10px monospace",e.textAlign="center",e.fillText("Press '1' to toggle this debugger",O+y/2,F+C-10),e.restore()}function qN(e,t,i,o){if(o.length<2)return;const c={prey:Math.max(...o.map(g=>g.prey),Si),predators:Math.max(...o.map(g=>g.predators),yi),bushes:Math.max(...o.map(g=>g.bushes),Ai)};[{data:o.map(g=>g.prey),color:"#44ff44",label:"Prey",target:Si,max:c.prey},{data:o.map(g=>g.predators),color:"#ff4444",label:"Predators",target:yi,max:c.predators},{data:o.map(g=>g.bushes),color:"#ffaa44",label:"Bushes",target:Ai,max:c.bushes}].forEach((g,m)=>{const S=t+m*115,T=i;e.fillStyle=g.color,e.font="10px monospace",e.fillText(g.label,S,T-5),e.strokeStyle="#333",e.lineWidth=1,e.strokeRect(S,T,100,30),e.beginPath(),e.strokeStyle=g.color;for(let I=0;I<g.data.length;I++){const y=S+I/(g.data.length-1)*100,C=T+30-g.data[I]/g.max*30;I===0?e.moveTo(y,C):e.lineTo(y,C)}e.stroke(),e.beginPath(),e.strokeStyle="#888",e.setLineDash([2,2]);const A=T+30-g.target/g.max*30;e.moveTo(S,A),e.lineTo(S+100,A),e.stroke(),e.setLineDash([])})}function QN(e,t){const i=t.search.human.byProperty("leaderId",e),o={total:i.length,children:0,males:0,females:0,old:0};for(const a of i)a.isAdult||o.children++,a.gender==="male"?o.males++:a.gender==="female"&&o.females++,a.age>=rh&&o.old++;return o}function JN(e,t){const i=t.search,s=i.building.byProperty("ownerId",e).flatMap(g=>i.berryBush.byRadius(g.position,g.radius)).reduce((g,m)=>g+m.food.length,0),f=i.building.byProperty("ownerId",e).filter(g=>g.buildingType===ni.StorageSpot).reduce((g,m)=>{var S;return g+(((S=m.storedFood)==null?void 0:S.length)||0)},0);return{totalBushFood:s,totalStorageFood:f,consumptionRate:0}}function eD(e,t,i){const a=t.search.human.byProperty("leaderId",e),s=t.entities.entities,u=new Map,c=(m,S=new Set)=>{var A;if(u.has(m))return u.get(m);if(S.has(m))return m;S.add(m);const T=s[m];if(!T)return m;if(T.gender==="female"&&((A=T.partnerIds)!=null&&A.length)){const I=T.partnerIds.find(y=>{const C=s[y];return C&&C.gender==="male"});if(I){const y=c(I,S);return u.set(m,y),y}}if(T.fatherId&&s[T.fatherId]){const I=c(T.fatherId,S);return u.set(m,I),I}return u.set(m,m),m},f=new Map;for(const m of a){const S=c(m.id);f.has(S)||f.set(S,[]),f.get(S).push(m)}const g=[];for(const[m,S]of f.entries()){const T=s[m];T&&g.push({patriarch:T,memberCount:S.length,members:S.map(A=>A.id)})}return g.sort((m,S)=>S.memberCount-m.memberCount),g.slice(0,i)}let ea=[],Qn=[],X0=0;const tD=36,K0=200;function nD(e,t,i,o){var H;if(!t.debugCharacterId)return;const a=t.search.human.byProperty("id",t.debugCharacterId)[0];if(!a)return;let s=(H=jr(a,t))==null?void 0:H.id;if(!s)return;const u=QN(s,t),c=JN(s,t);if(t.time-X0>=tD){ea.push({time:t.time,total:u.total,children:u.children,males:u.males,females:u.females,old:u.old});const B=c.totalBushFood+c.totalStorageFood;Qn.push({time:t.time,bushFood:c.totalBushFood,storageFood:c.totalStorageFood,totalFood:B}),ea.length>K0&&(ea=ea.slice(-200)),Qn.length>K0&&(Qn=Qn.slice(-200)),X0=t.time}let f=0;if(Qn.length>=2){const B=Qn[Qn.length-1],U=Qn[Qn.length-2],G=B.time-U.time;G>0&&(f=(U.totalFood-B.totalFood)/G)}const g=400,m=Math.min(o*.9,700),S=i-g-10,T=Xe+Et*2;e.save(),e.fillStyle="rgba(0, 0, 0, 0.9)",e.fillRect(S,T,g,m),e.strokeStyle="#444",e.lineWidth=2,e.strokeRect(S,T,g,m),e.fillStyle="white",e.font="12px monospace",e.textAlign="left";let A=T+20;const I=13,y=S+15;e.fillStyle="#66ccff",e.font="bold 14px monospace",e.fillText(" Tribe Debugger",y,A),A+=25,e.fillStyle="#66ccff",e.font="bold 13px monospace",e.fillText(" Population Over Time",y,A),A+=18,e.fillStyle="white",e.font="11px monospace",e.fillText(`Total: ${u.total}`,y,A),A+=I,e.fillStyle="#00ffff",e.fillText(`Children: ${u.children}`,y,A),A+=I,e.fillStyle="#4488ff",e.fillText(`Males: ${u.males}`,y,A),A+=I,e.fillStyle="#ff88ff",e.fillText(`Females: ${u.females}`,y,A),A+=I,e.fillStyle="#888888",e.fillText(`Old (${u.old})`,y,A),A+=20;const C=ea.slice(-50);C.length>1&&(iD(e,y,A,C),A+=100),e.fillStyle="#66ccff",e.font="bold 13px monospace",e.fillText(" Food Metrics",y,A),A+=18;const O=c.totalBushFood+c.totalStorageFood;e.fillStyle="#ffff00",e.font="11px monospace",e.fillText(`Total Food: ${O}`,y,A),A+=I,e.fillStyle="#44ff44",e.fillText(`Bush Food: ${c.totalBushFood}`,y,A),A+=I,e.fillStyle="#ffaa44",e.fillText(`Storage Food: ${c.totalStorageFood}`,y,A),A+=I,e.fillStyle="#ff4444",e.fillText(`Consumption: ${f.toFixed(2)}/hour`,y,A),A+=20;const F=Qn.slice(-50);F.length>1&&(rD(e,y,A,F),A+=100),e.fillStyle="#66ccff",e.font="bold 13px monospace",e.fillText(" Top 5 Families",y,A),A+=18;const P=eD(s,t,5);e.fillStyle="white",e.font="11px monospace",P.length===0?(e.fillText("No families found",y,A),A+=I):P.forEach((B,U)=>{const Z=`${U+1}. ${B.patriarch.isPlayer?"Player":"#"+B.patriarch.id} (${B.memberCount} members, can split: ${$u(B.patriarch,t).canSplit})`;e.fillText(Z,y,A),A+=I}),A+=10,e.fillStyle="#888",e.font="10px monospace",e.textAlign="center",e.fillText("Press 'Shift+3' to toggle this debugger",S+g/2,T+m-10),e.restore()}function iD(e,t,i,o){if(o.length<2)return;const u=Math.max(...o.map(f=>Math.max(f.total,f.children,f.males,f.females,f.old)),10);e.strokeStyle="#333",e.lineWidth=1,e.strokeRect(t,i,350,80),[{data:o.map(f=>f.total),color:"#ffffff",label:"Total"},{data:o.map(f=>f.children),color:"#00ffff",label:"Children"},{data:o.map(f=>f.males),color:"#4488ff",label:"Males"},{data:o.map(f=>f.females),color:"#ff88ff",label:"Females"},{data:o.map(f=>f.old),color:"#888888",label:"Old"}].forEach(f=>{e.beginPath(),e.strokeStyle=f.color,e.lineWidth=2;for(let g=0;g<f.data.length;g++){const m=t+g/(f.data.length-1)*350,S=i+80-f.data[g]/u*80;g===0?e.moveTo(m,S):e.lineTo(m,S)}e.stroke()})}function rD(e,t,i,o){if(o.length<2)return;const u=Math.max(...o.map(f=>Math.max(f.totalFood,f.bushFood,f.storageFood)),10);e.strokeStyle="#333",e.lineWidth=1,e.strokeRect(t,i,350,80),[{data:o.map(f=>f.totalFood),color:"#ffff00",label:"Total"},{data:o.map(f=>f.bushFood),color:"#44ff44",label:"Bush"},{data:o.map(f=>f.storageFood),color:"#ffaa44",label:"Storage"}].forEach(f=>{e.beginPath(),e.strokeStyle=f.color,e.lineWidth=2;for(let g=0;g<f.data.length;g++){const m=t+g/(f.data.length-1)*350,S=i+80-f.data[g]/u*80;g===0?e.moveTo(m,S):e.lineTo(m,S)}e.stroke()})}function Z0(e,t,i){e.save();const{x:o,y:a,width:s,height:u}=t.rect,c=Jv;if(e.beginPath(),e.moveTo(o+c,a),e.lineTo(o+s-c,a),e.quadraticCurveTo(o+s,a,o+s,a+c),e.lineTo(o+s,a+u-c),e.quadraticCurveTo(o+s,a+u,o+s-c,a+u),e.lineTo(o+c,a+u),e.quadraticCurveTo(o,a+u,o,a+u-c),e.lineTo(o,a+c),e.quadraticCurveTo(o,a,o+c,a),e.closePath(),e.fillStyle=t.isDisabled?eS:t.backgroundColor,e.fill(),t.activated){e.save();const f=(Math.sin(Date.now()/1e3*rS)+1)/2;e.strokeStyle=iS,e.lineWidth=2+f*2,e.globalAlpha=.7+f*.3,e.stroke(),e.restore()}if(t.lastActivated){const f=Date.now()-t.lastActivated;if(f<Ru){const g=1-f/Ru;e.fillStyle=nS,e.globalAlpha=g,e.fill(),e.globalAlpha=1}}i&&!t.isDisabled&&(e.fillStyle=fh,e.globalAlpha=.5,e.fill(),e.globalAlpha=1),e.fillStyle=t.isDisabled?tS:t.textColor,t.icon?(e.font=`${u*.55}px "Press Start 2P", Arial`,e.textAlign="center",e.textBaseline="middle",e.fillText(t.icon,o+s/2,a+u/2),t.text&&(e.font=`${u*.18}px "Press Start 2P", Arial`,e.textAlign="right",e.textBaseline="bottom",e.fillText(t.text,o+s-4,a+u-2))):(e.font=`${Et*1.5}px "Press Start 2P", Arial`,e.textAlign="center",e.textBaseline="middle",e.fillText(t.text,o+s/2,a+u/2)),e.restore()}function oD(e,t,i,o){e.save(),e.fillStyle="rgba(0, 0, 0, 0.6)",e.fillRect(0,0,i,o);const a=500,s=150,u=(i-a)/2,c=(o-s)/2;e.fillStyle=Yt,e.font=`${Et*1.1}px "Press Start 2P", Arial`,e.textAlign="center",e.textBaseline="middle",e.fillText("Are you sure you want to exit",i/2,c+s/3-10),e.fillText("to the main menu?",i/2,c+s/3+10);const f=vi*1.5,g=Qv,m=c+s-g-Xe*2,S=20,T=f*2+S,A=u+(a-T)/2,I={id:"confirmExitYes",action:re.ConfirmExitYes,rect:{x:A,y:m,width:f,height:g},text:"Yes",backgroundColor:qi,textColor:Yt,currentWidth:f},y=A+f+S,C={id:"confirmExitNo",action:re.ConfirmExitNo,rect:{x:y,y:m,width:f,height:g},text:"No",backgroundColor:qi,textColor:Yt,currentWidth:f};t.uiButtons.push(I,C),Z0(e,I,t.hoveredButtonId===I.id),Z0(e,C,t.hoveredButtonId===C.id),e.restore()}const Nr=600,Po=30,Jn=60,Nt=30,sD="";function aD(e,t,i){const o=[];if(!i.tribeControl||!i.leaderId)return o;const{width:a,height:s}=e.canvas,u=(a-Nr)/2,c=450,f=(s-c)/2;e.save(),e.fillStyle="rgba(0, 0, 0, 0.9)",e.beginPath(),e.roundRect(u,f,Nr,c,10),e.fill(),e.strokeStyle="#444",e.lineWidth=2,e.stroke(),e.fillStyle=Yt,e.font=`${Et*1.2}px "Press Start 2P", Arial`,e.textAlign="center",e.textBaseline="top",e.fillText("Tribe Roles",u+Nr/2,f+Po);const g=30,m=u+Nr-Po-g,S=f+Po,T=t.hoveredButtonId==="roleManager_close";e.fillStyle=T?"#ff7777":"#ff5555",e.fillRect(m,S,g,g),e.fillStyle="#ffffff",e.font="20px Arial",e.textAlign="center",e.textBaseline="middle",e.fillText("X",m+g/2,S+g/2),o.push({id:"roleManager_close",action:re.CloseRoleManager,rect:{x:m,y:S,width:g,height:g},text:"X",currentWidth:g,backgroundColor:"#ff5555",textColor:"#ffffff"});const I=Vo(i.leaderId,t).filter(te=>te.isAdult),y={[_e.Leader]:0,[_e.Gatherer]:0,[_e.Planter]:0,[_e.Hunter]:0,[_e.Mover]:0,[_e.Warrior]:0};I.forEach(te=>{te.tribeRole&&y[te.tribeRole]++});const C=i.tribeControl.roleWeights,O=[{role:_e.Gatherer,emoji:"",name:"Gatherer"},{role:_e.Planter,emoji:"",name:"Planter"},{role:_e.Hunter,emoji:"",name:"Hunter"},{role:_e.Mover,emoji:"",name:"Mover"},{role:_e.Warrior,emoji:"",name:"Warrior"}];let F=0;O.forEach(te=>{F+=C[te.role]||0});let P=f+Po+70;const H=u+Po,B=u+Nr-Po;O.forEach(te=>{const ve=C[te.role]||0,be=F>0?Math.round(ve/F*100):0,De=y[te.role]||0;e.textAlign="left",e.textBaseline="middle",e.font=`${Et*.8}px "Press Start 2P", Arial`,e.fillStyle=Yt,e.fillText(`${te.emoji} ${De} ${te.name}`,H,P+Jn/2);const Ie=u+220,he=Ie+Nt+15,Se=he+200+15,ne=`role_minus_${te.role}`,z=t.hoveredButtonId===ne,X=ve<=0,Y=X?"#555":z?"#dd6666":"#cc4444";e.fillStyle=Y,e.fillRect(Ie,P+(Jn-Nt)/2,Nt,Nt),e.fillStyle=X?"#888":"#fff",e.textAlign="center",e.fillText("-",Ie+Nt/2,P+Jn/2+2),o.push({id:ne,action:re.DecreaseRoleWeight,targetRole:te.role,rect:{x:Ie,y:P+(Jn-Nt)/2,width:Nt,height:Nt},text:"-",currentWidth:Nt,backgroundColor:Y,textColor:"#fff",isDisabled:X}),e.textAlign="left",e.font="16px Arial",e.fillStyle="#fff";let N=he;for(let ae=0;ae<ve;ae++)e.fillText(sD,N,P+Jn/2+2),N+=18;const b=`role_plus_${te.role}`,K=t.hoveredButtonId===b,J=ve>=10,pe=J?"#555":K?"#66dd66":"#44cc44";e.fillStyle=pe,e.fillRect(Se,P+(Jn-Nt)/2,Nt,Nt),e.fillStyle=J?"#888":"#fff",e.textAlign="center",e.font=`${Et*.8}px "Press Start 2P", Arial`,e.fillText("+",Se+Nt/2,P+Jn/2+4),o.push({id:b,action:re.IncreaseRoleWeight,targetRole:te.role,rect:{x:Se,y:P+(Jn-Nt)/2,width:Nt,height:Nt},text:"+",currentWidth:Nt,backgroundColor:pe,textColor:"#fff",isDisabled:J}),e.textAlign="right",e.font=`${Et*.8}px "Press Start 2P", Arial`,e.fillStyle=Yt,e.fillText(`${be}%`,B,P+Jn/2),P+=Jn});const U=y[_e.Leader],G=Object.values(y).reduce((te,ve)=>te+ve,0),Z=I.length-G;return e.textAlign="center",e.fillStyle="#aaa",e.font=`${Et*.6}px "Press Start 2P", Arial`,e.fillText(`Adults: ${I.length} | Leader: ${U} | Assigned: ${G} | Unassigned: ${Z}`,u+Nr/2,P+10),e.fillText("(Adjust weights to control role distribution)",u+Nr/2,P+30),e.restore(),o}function Du(e,t,i,o,a,s=!1){var f;if(e.save(),e.clearRect(0,0,e.canvas.width,e.canvas.height),e.fillStyle="#2c5234",e.fillRect(0,0,e.canvas.width,e.canvas.height),e.translate(e.canvas.width/2-i.x,e.canvas.height/2-i.y),!s&&t.gameOver){e.restore(),iN(e,t);return}jN(e,t,t.debugPanel===Ve.General,i,a);const u=pt(t);if(u&&t.selectedBuildingType&&t.selectedBuildingType!=="removal"&&t.mousePosition){const g=Gf(t.mousePosition,i,a,t.mapDimensions),m=Sh(g,t.selectedBuildingType,u.leaderId,t);YN(e,g,t.selectedBuildingType,m,t.mapDimensions)}const c=t.notifications.filter(g=>!g.isDismissed);for(const g of c){const m=(Math.sin(t.time*h_)+1)/2;e.globalAlpha=m*.5+.25,e.fillStyle=f_,g.targetArea&&e.fillRect(g.targetArea.x,g.targetArea.y,g.targetArea.width,g.targetArea.height),g.targetRadius&&(e.beginPath(),e.arc(g.targetRadius.x,g.targetRadius.y,g.targetRadius.radius,0,Math.PI*2),e.fill())}if(e.globalAlpha=1,pN(e,t),e.restore(),!s){e.fillStyle=yC,e.font=`${Et}px "Press Start 2P", Arial`,e.shadowColor=AC,e.shadowBlur=TC,t.uiButtons=[];let g=null,m=null;if(u){const A=dn(t,u),I=Yr(A),y=((f=u.partnerIds)==null?void 0:f.map(O=>t.entities.entities[O]).filter(O=>O!==void 0))||[],C=VN(e,t,u,I,y,A);g=C.hungerBarRect,m=C.foodBarRect}const S=Yv(t,u==null?void 0:u.leaderId);eN(e,t,S,e.canvas.width,e.canvas.height);const{commandButtonsRect:T}=xP(e,t,e.canvas.width);if(e.shadowColor="transparent",e.shadowBlur=0,u&&(fN(e,t,i,e.canvas.width,e.canvas.height),o.length>0&&YP(e,o,u,i,e.canvas.width,e.canvas.height,t.mapDimensions)),t.tutorialState.activeUIHighlights.length>0){const{activeUIHighlights:A}=t.tutorialState;A.includes(Gr.HUNGER_BAR)&&g&&gf(e,g,t.time),A.includes(Gr.FOOD_BAR)&&m&&gf(e,m,t.time),A.includes(Gr.COMMAND_BUTTONS)&&T&&gf(e,T,t.time)}if(t.tutorialState.isActive){const A=nN(e,t,e.canvas.width,e.canvas.height);A&&t.uiButtons.push({id:"tutorial-dismiss",action:re.DismissTutorial,rect:A,text:"",currentWidth:A.width,backgroundColor:"transparent",textColor:"transparent"})}switch(vN(e,t,e.canvas.width,e.canvas.height),t.debugPanel){case Ve.Ecosystem:ZN(e,t,e.canvas.width,e.canvas.height);break;case Ve.Tribe:nD(e,t,e.canvas.width,e.canvas.height);break;case Ve.Performance:yN(e,t,a.width);break}if(t.roleManagerOpen&&u&&u.leaderId===u.id){const A=aD(e,t,u);t.uiButtons.push(...A)}t.isPaused&&t.exitConfirmation!=="pending"&&$P(e),t.exitConfirmation==="pending"&&oD(e,t,e.canvas.width,e.canvas.height)}}const lD=_n.div`
  position: relative;
  width: 100vw;
  height: 100vh;
  overflow: hidden;
`,uD=_n.canvas`
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background-color: #2c5234;
`,cD=_n.div`
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  text-align: center;
  z-index: 1;
  background: linear-gradient(to bottom, rgba(0, 0, 0, 0.7) 0%, rgba(0, 0, 0, 0) 50%, rgba(0, 0, 0, 0.7) 100%);
`,dD=_n.h1`
  font-family: 'Press Start 2P', cursive;
  font-size: 4rem;
  color: #fff;
  text-shadow: 4px 4px 0px #ff0000;
  margin-bottom: 2rem;
`,q0=_n.button`
  font-family: 'Press Start 2P', cursive;
  font-size: 1.5rem;
  padding: 1rem 2rem;
  color: #fff;
  background-color: #ff0000;
  border: 2px solid #fff;
  box-shadow: 4px 4px 0px #fff;
  cursor: pointer;
  transition: all 0.2s ease-in-out;

  &:hover {
    background-color: #fff;
    color: #ff0000;
    box-shadow: 4px 4px 0px #ff0000;
  }
`,fD=_n.div`
  display: flex;
  flex-direction: column;
  gap: 1.5rem;
  align-items: center;
`,hD=_n.div`
  position: absolute;
  bottom: 1rem;
  font-family: 'Press Start 2P', cursive;
  font-size: 0.8rem;
  color: #fff;
  text-shadow: 2px 2px 0px #000;
  a {
    color: #fff;
    text-decoration: none;
    &:hover {
      text-decoration: underline;
    }
  }
`,cu="intro-soundtrack",Q0=()=>{const{setAppState:e,savedGameState:t,clearCurrentSave:i}=es(),o=Oe.useRef(null),a=Oe.useRef(null),s=Oe.useRef(zR()),u=Oe.useRef(),c=Oe.useRef(s.current.viewportCenter),f=Oe.useRef(),g=Oe.useCallback(()=>{ef(cu,2),i(),e("game")},[e,i]),m=Oe.useCallback(()=>{t&&(ef(cu,2),e("game"))},[e,t]);Oe.useEffect(()=>{const A=I=>{(I.key==="Enter"||I.key===" ")&&(t?m():g())};return window.addEventListener("keydown",A),()=>{window.removeEventListener("keydown",A)}},[g,m,t]),Oe.useEffect(()=>(ph(ge.SoundTrack1,{loop:!0,trackId:cu}),()=>{ef(cu,2)}),[]),Oe.useEffect(()=>{const A=o.current;if(!A)return;a.current=A.getContext("2d");const I=()=>{A&&a.current&&(A.width=window.innerWidth,A.height=window.innerHeight,Du(a.current,s.current,c.current,[],{width:A.width,height:A.height},!0))};return I(),window.addEventListener("resize",I),()=>window.removeEventListener("resize",I)},[]),Oe.useEffect(()=>{const A=()=>{const y=Vv(s.current);if(y.length>0){const C=Math.floor(Math.random()*y.length);f.current=y[C].id}};A();const I=setInterval(A,yI);return()=>clearInterval(I)},[]);const[S,T]=Nv(A=>{var C,O;if(!a.current)return;if(u.current===void 0){u.current=A;return}const I=Math.min((A-u.current)/1e3,1);s.current=zu(s.current,I);const y=f.current?s.current.entities.entities[f.current]:void 0;if(y){const{mapDimensions:F}=s.current,{width:P,height:H}=F;let B={...y.position};const U=B.x-c.current.x;Math.abs(U)>P/2&&(U>0?B.x-=P:B.x+=P);const G=B.y-c.current.y;Math.abs(G)>H/2&&(G>0?B.y-=H:B.y+=H);let Z=lh(c.current,B,Jf*I);Z={x:(Z.x%P+P)%P,y:(Z.y%H+H)%H},c.current=Z}Du(a.current,s.current,c.current,[],{width:((C=o.current)==null?void 0:C.width)||800,height:((O=o.current)==null?void 0:O.height)||600},!0),u.current=A});return Oe.useEffect(()=>(T(),S),[T,S]),Ue.jsxs(lD,{children:[Ue.jsx(uD,{ref:o}),Ue.jsxs(cD,{children:[Ue.jsx(dD,{children:"Tribe2"}),Ue.jsxs(fD,{children:[Ue.jsx(q0,{onClick:g,children:"New Game"}),t&&Ue.jsx(q0,{onClick:m,children:"Load Game"})]}),Ue.jsxs(hD,{children:["by"," ",Ue.jsx("a",{href:"https://github.com/gtanczyk",target:"_blank",rel:"noopener noreferrer",children:"gtanczyk"})]})]})]})};function gD(){console.log("Tribe game initialized with detailed 2D world state.");const e=WR();return e.ecosystem={preyGestationPeriod:Lr,preyProcreationCooldown:Ur,predatorGestationPeriod:Br,predatorProcreationCooldown:Hr,preyHungerIncreasePerHour:er,predatorHungerIncreasePerHour:tr,berryBushSpreadChance:Ti},e.debugPanel=Ve.None,e.performanceMetrics={currentBucket:{renderTime:0,worldUpdateTime:0,aiUpdateTime:0},history:[]},e}const pD=({canvasRef:e,ctxRef:t,gameStateRef:i,viewportCenterRef:o,playerActionHintsRef:a})=>(Oe.useEffect(()=>{const s=e.current;if(!s)return;t.current=s.getContext("2d");const u=()=>{s&&t.current&&i.current&&(s.width=window.innerWidth,s.height=window.innerHeight,Du(t.current,i.current,o.current,a.current,{width:s.width,height:s.height},!1))};return u(),window.addEventListener("resize",u),()=>window.removeEventListener("resize",u)},[]),Ue.jsx("canvas",{ref:e,style:{display:"block",background:"#2c5234"}})),mD=(e,t,i,o=!1)=>{var u;let a;const s=cC(e,i);if(s){if(t.isAdult&&s.type==="berryBush"&&s.food.length>0)a={action:ce.AutopilotGather,targetEntityId:s.id};else if(t.isAdult&&s.type==="corpse"&&s.food.length>0)a={action:ce.AutopilotGather,targetEntityId:s.id};else if(s.type==="human"){const c=s;t.isAdult&&is(t,c,i)?a={action:ce.AutopilotAttack,targetEntityId:c.id}:Vr(t,c,i)?a={action:ce.AutopilotProcreate,targetEntityId:c.id}:t.food.length>0&&!c.isAdult&&(c.motherId===t.id||c.fatherId===t.id)&&(a={action:ce.AutopilotFeedChild,targetEntityId:c.id})}else if(s.type==="prey")a={action:ce.AutopilotAttack,targetEntityId:s.id};else if(s.type==="predator")a={action:ce.AutopilotAttack,targetEntityId:s.id};else if(s.type==="building"){const c=s;if(i.selectedBuildingType==="removal")a={action:ce.Removal,position:s.position};else if(c.buildingType==="storageSpot"){const f=c.ownerId===t.leaderId,g=c.storedFood!==void 0&&c.storedFood.length>0,m=c.storedFood!==void 0&&c.storageCapacity!==void 0&&c.storedFood.length<c.storageCapacity;if(o&&c.isConstructed&&g&&t.food.length<t.maxFood)if(f)a={action:ce.AutopilotRetrieve,targetEntityId:s.id};else{const S=t.leaderId?i.entities.entities[t.leaderId]:void 0;S&&((u=S.tribeControl)!=null&&u.diplomacy)?S.tribeControl.diplomacy[c.ownerId]===Dt.Hostile?a={action:ce.AutopilotGather,targetEntityId:s.id}:a={action:ce.AutopilotMove,position:e}:a={action:ce.AutopilotMove,position:e}}else f&&c.isConstructed?t.food.length>0&&m?a={action:ce.AutopilotDeposit,targetEntityId:s.id}:t.food.length<t.maxFood&&g?a={action:ce.AutopilotRetrieve,targetEntityId:s.id}:a={action:ce.AutopilotMove,position:e}:a={action:ce.AutopilotMove,position:e}}else c.buildingType==="plantingZone"&&t.food.filter(f=>f.type===Hn.Berry).length>=xr&&!bn(e,i,$r)?a={action:ce.AutopilotPlant,position:e}:a={action:ce.AutopilotMove,position:e}}}else t.food.filter(c=>c.type===Hn.Berry).length>=xr&&(i.autopilotControls.isManuallyPlanting||gw(e,t,i))?a={action:ce.AutopilotPlant,position:e}:a={action:ce.AutopilotMove,position:e};return a},vD=(e,t)=>{if(e.isPaused)return;const i=pt(e);if(!i)return;if(e.selectedBuildingType&&e.selectedBuildingType!=="removal"){Sh(t,e.selectedBuildingType,i.leaderId,e)&&(Bf(t,e.selectedBuildingType,i.leaderId,e),e.selectedBuildingType=null);return}if(e.selectedBuildingType==="removal"){const a=nw(t,e);a&&tw(a.id,e);return}const o=e.autopilotControls.hoveredAutopilotAction;e.autopilotControls.activeAutopilotAction=void 0,o?(e.autopilotControls.activeAutopilotAction=o,(o.action===ce.AutopilotMove||o.action===ce.AutopilotGather)&&(e.hasPlayerMovedEver=!0),o.action===ce.AutopilotPlant&&(e.hasPlayerPlantedBush=!0)):e.autopilotControls.activeAutopilotAction={action:ce.AutopilotMove,position:t},e.autopilotControls.isManuallyMoving=!1,e.autopilotControls.isManuallyPlanting=!1},SD=(e,t)=>{var u,c,f,g,m,S;const i=e.key.toLowerCase(),o=e.ctrlKey||e.metaKey;let a=!0,s=t;if(o){switch(i){case"s":Yf(t);break;default:a=!1;break}return{newState:s,handled:a}}switch(i){case"escape":const{autopilotControls:T}=t;T.activeAutopilotAction||T.isManuallyMoving||T.isManuallyPlanting||t.buildMenuOpen||t.selectedBuildingType?(T.activeAutopilotAction=void 0,T.isManuallyMoving=!1,T.isManuallyPlanting=!1,t.buildMenuOpen=!1,t.selectedBuildingType=null):s.exitConfirmation==="pending"?(s.exitConfirmation="inactive",s.isPaused=!1):(s.exitConfirmation="pending",s.isPaused=!0);break;case"u":const A=pt(t);A&&A.isAdult&&A.leaderId===A.id&&(t.roleManagerOpen=!t.roleManagerOpen);break;case"m":t.isMuted=!t.isMuted,ua(t.masterVolume,t.isMuted);break;case"=":case"+":const I=Math.min(1,t.masterVolume+.1);t.masterVolume=parseFloat(I.toFixed(1)),ua(t.masterVolume,t.isMuted);break;case"-":const y=Math.max(0,t.masterVolume-.1);t.masterVolume=parseFloat(y.toFixed(1)),ua(t.masterVolume,t.isMuted);break;case"t":s=zu(t,dS);break;case" ":case"p":t.isPaused=!t.isPaused;break;case"":case"`":s.debugPanel===Ve.General?(s.debugPanel=Ve.None,s.debugCharacterId=void 0):(s.debugPanel=Ve.General,s.debugCharacterId||(s.debugCharacterId=((u=pt(s))==null?void 0:u.id)??((c=Object.values(s.entities.entities).find(C=>C.type==="human"||C.type==="prey"||C.type==="predator"))==null?void 0:c.id)));break;case"!":if(e.shiftKey){if(s.debugPanel===Ve.Ecosystem){s.debugPanel=Ve.None;break}s.debugPanel=Ve.Ecosystem,s.debugCharacterId||(s.debugCharacterId=((f=pt(s))==null?void 0:f.id)??((g=Object.values(s.entities.entities).find(C=>C.type==="human"||C.type==="prey"||C.type==="predator"))==null?void 0:g.id))}else a=!1;break;case"#":if(e.shiftKey&&s.debugPanel===Ve.Tribe){s.debugPanel=Ve.None;break}s.debugPanel=Ve.Tribe,s.debugCharacterId?a=!1:s.debugCharacterId=((m=pt(s))==null?void 0:m.id)??((S=s.search.human.all().find(C=>C.leaderId===C.id))==null?void 0:S.id);break;case"@":if(e.shiftKey){if(s.debugPanel===Ve.Performance){s.debugPanel=Ve.None;break}s.debugPanel=Ve.Performance}else a=!1;break;case"tab":if(s.debugPanel!==Ve.General&&s.debugPanel!==Ve.Tribe&&(s.debugPanel=Ve.General),s.debugPanel===Ve.General){const C=Object.values(s.entities.entities).filter(O=>O.type==="human"||O.type==="prey"||O.type==="predator");if(C.length>0){const O=C.sort((B,U)=>{if(B.type==="human"&&B.isPlayer)return-1;if(U.type==="human"&&U.isPlayer)return 1;if(B.type!==U.type){const G={human:0,prey:1,predator:2},Z=G[B.type]??999,te=G[U.type]??999;return Z-te}return B.id-U.id}),F=s.debugCharacterId,H=((F?O.findIndex(B=>B.id===F):-1)+1)%O.length;s.debugCharacterId=O[H].id}else s.debugCharacterId=void 0}else if(s.debugPanel===Ve.Tribe){const C=s.search.human.all().filter(F=>F.leaderId===F.id);let O=C.findIndex(F=>F.id===s.debugCharacterId)+1;(O===-1||O>=C.length-1)&&(O=0),s.debugCharacterId=C[O].id}else s.debugPanel=Ve.None,s.debugCharacterId=void 0;break;default:a=!1;break}return{newState:s,handled:a}},yD=(e,t,i,o,a)=>{const s={gameState:i};if(t&&["e","b","r","h"].includes(e)&&i.hasPlayerEnabledAutopilot++,i.buildMenuOpen){if(e==="1"){i.selectedBuildingType="storageSpot",we(s,ge.ButtonClick,o.position);return}else if(e==="2"){i.selectedBuildingType="plantingZone",we(s,ge.ButtonClick,o.position);return}else if(e==="3"){i.selectedBuildingType="removal",we(s,ge.ButtonClick,o.position);return}}if(e==="escape"&&i.selectedBuildingType){i.selectedBuildingType=null;return}if(e==="e"){if(t){i.autopilotControls.behaviors.gathering=!i.autopilotControls.behaviors.gathering;return}const u=Me(o,i,"berryBush",St,g=>g.food.length>0&&o.food.length<o.maxFood),c=Me(o,i,"corpse",St,g=>g.food.length>0&&o.food.length<o.maxFood);let f=null;u&&c?f=V(o.position,u.position,i.mapDimensions.width,i.mapDimensions.height)<=V(o.position,c.position,i.mapDimensions.width,i.mapDimensions.height)?u:c:f=u||c,f&&(o.activeAction="gathering",we(s,ge.Gather,o.position))}else if(e==="r"){if(t){i.autopilotControls.behaviors.procreation=!i.autopilotControls.behaviors.procreation;return}Me(o,i,"human",St,c=>Vr(o,c,i))&&(o.activeAction="procreating",we(s,ge.Procreate,o.position))}else if(e==="f")o.food.length>0&&(o.activeAction="eating",we(s,ge.Eat,o.position));else if(e==="h"){if(t){i.autopilotControls.behaviors.feedChildren=!i.autopilotControls.behaviors.feedChildren;return}const u=a.find(c=>c.type===ce.FeedChild);u&&u.targetEntity&&(o.activeAction="feeding",o.target=u.targetEntity.id)}else if(e==="arrowup"||e==="w")o.direction.y=-1,o.activeAction="moving",o.target=void 0,i.hasPlayerMovedEver=!0,i.autopilotControls.isManuallyMoving=!0,i.autopilotControls.activeAutopilotAction=void 0;else if(e==="arrowdown"||e==="s")o.direction.y=1,o.activeAction="moving",o.target=void 0,i.hasPlayerMovedEver=!0,i.autopilotControls.isManuallyMoving=!0,i.autopilotControls.activeAutopilotAction=void 0;else if(e==="arrowleft"||e==="a")o.direction.x=-1,o.activeAction="moving",o.target=void 0,i.hasPlayerMovedEver=!0,i.autopilotControls.isManuallyMoving=!0,i.autopilotControls.activeAutopilotAction=void 0;else if(e==="arrowright"||e==="d")o.direction.x=1,o.activeAction="moving",o.target=void 0,i.hasPlayerMovedEver=!0,i.autopilotControls.isManuallyMoving=!0,i.autopilotControls.activeAutopilotAction=void 0;else if(e==="q"){if(t){i.autopilotControls.behaviors.attack=!i.autopilotControls.behaviors.attack;return}const u=Me(o,i,"human",ii,c=>is(o,c,i))??Me(o,i,"predator",ii)??Me(o,i,"prey",ii);u&&(o.activeAction="attacking",o.attackTargetId=u.id)}else if(e==="b"){if(t){i.autopilotControls.behaviors.planting=!i.autopilotControls.behaviors.planting;return}if(a.find(c=>c.type===ce.Plant)){const c=tC(o.position,i,50,Of);c&&(o.activeAction="planting",o.target=c,i.hasPlayerPlantedBush=!0)}}else if(e==="x"){if(t){i.autopilotControls.behaviors.gathering=!i.autopilotControls.behaviors.gathering;return}const u=Me(o,i,"building",Cn,c=>{const f=c;return f.buildingType==="storageSpot"&&f.ownerId===o.leaderId&&f.isConstructed&&f.storedFood!==void 0&&f.storageCapacity!==void 0&&f.storedFood.length<f.storageCapacity});u&&(o.activeAction="idle",o.target=u.id,we(s,ge.StorageDeposit,o.position))}else if(e==="z"){if(t){i.autopilotControls.behaviors.feedChildren=!i.autopilotControls.behaviors.feedChildren;return}const u=Me(o,i,"building",Cn,c=>{const f=c;return f.buildingType==="storageSpot"&&f.ownerId===o.leaderId&&f.isConstructed&&f.storedFood!==void 0&&f.storedFood.length>0});u&&(o.activeAction="idle",o.target=u.id,we(s,ge.StorageRetrieve,o.position))}else e==="v"?(o.isCallingToAttack=!0,o.callToAttackEndTime=i.time+Ko,ke(i,fe.CallToAttack,o.position,Ko),we(s,ge.CallToAttack,o.position)):e==="c"?(o.isCallingToFollow=!0,o.callToFollowEndTime=i.time+Ta,ke(i,fe.CallToFollow,o.position,Ta),we(s,ge.CallToFollow,o.position)):e==="k"?mh(o,i):e==="l"&&(i.buildMenuOpen=!i.buildMenuOpen,we(s,ge.ButtonClick,o.position))},AD=(e,t,i,o)=>{e==="arrowup"||e==="w"||e==="arrowdown"||e==="s"?t.direction.y=0:(e==="arrowleft"||e==="a"||e==="arrowright"||e==="d")&&(t.direction.x=0),!o.current.has("arrowup")&&!o.current.has("arrowdown")&&!o.current.has("arrowleft")&&!o.current.has("arrowright")&&!o.current.has("w")&&!o.current.has("a")&&!o.current.has("s")&&!o.current.has("d")&&(t.activeAction==="moving"&&(t.activeAction="idle"),i.autopilotControls.isManuallyMoving=!1),!o.current.has("e")&&t.activeAction==="gathering"&&(t.activeAction="idle"),!o.current.has("f")&&t.activeAction==="eating"&&(t.activeAction="idle"),!o.current.has("r")&&t.activeAction==="procreating"&&(t.activeAction="idle"),!o.current.has("h")&&t.activeAction==="feeding"&&(t.activeAction="idle")},TD=(e,t,i)=>{let a=pt(e);if(e.debugCharacterId){const s=e.entities.entities[e.debugCharacterId];s&&"position"in s&&(a=s)}if(a){const{mapDimensions:s}=e,{width:u,height:c}=s;let f={...a.position};const g=f.x-t.x;Math.abs(g)>u/2&&(g>0?f.x-=u:f.x+=u);const m=f.y-t.y;Math.abs(m)>c/2&&(m>0?f.y-=c:f.y+=c);let S=lh(t,f,Jf*i);return S={x:(S.x%u+u)%u,y:(S.y%c+c)%c},S}return e.viewportCenter};function ID(e,t){const{width:i,height:o}=e.mapDimensions;e.viewportCenter={x:(t.x%i+i)%i,y:(t.y%o+o)%o}}const ED=(e,t,i,o)=>{var f,g;const a={gameState:i},s=pt(i);s&&we(a,ge.ButtonClick,s.position);const u=i.uiButtons.find(m=>m.id===e.id);u&&(u.lastActivated=Date.now()),t&&[re.CommandGather,re.CommandPlant,re.ToggleProcreationBehavior,re.CommandBuild].includes(e.action)&&i.hasPlayerEnabledAutopilot++;const{behaviors:c}=i.autopilotControls;switch(e.action){case re.ReturnToIntro:i.exitConfirmation="pending",i.isPaused=!0;break;case re.ConfirmExitYes:o(),i.exitConfirmation="inactive";break;case re.ConfirmExitNo:i.exitConfirmation="inactive",i.isPaused=!1;break;case re.ToggleMute:i.isMuted=!i.isMuted,ua(i.masterVolume,i.isMuted);break;case re.TogglePause:i.isPaused=!i.isPaused;break;case re.FastForward:return zu(i,dS);case re.DismissTutorial:i.tutorialState.isActive=!1;break;case re.CommandEat:s&&s.food.length>0&&(s.activeAction="eating");break;case re.CommandGather:t?c.gathering=!c.gathering:s&&(s.activeAction="gathering");break;case re.CommandPlant:t?c.planting=!c.planting:s&&(i.autopilotControls.isManuallyPlanting=!0);break;case re.ToggleProcreationBehavior:c.procreation=!c.procreation;break;case re.ToggleAttackBehavior:c.attack=!c.attack;break;case re.ToggleFeedChildBehavior:c.feedChildren=!c.feedChildren;break;case re.ToggleAutopilotFollowLeaderBehavior:c.followLeader=!c.followLeader;break;case re.CommandCallToAttack:s&&s.leaderId===s.id&&(s.isCallingToAttack=!0,s.callToAttackEndTime=i.time+Ko,ke(i,fe.CallToAttack,s.position,Ko),we(a,ge.CallToAttack,s.position));break;case re.CommandFollowMe:t?c.followLeader=!c.followLeader:s&&s.leaderId===s.id&&(s.isCallingToFollow=!0,s.callToFollowEndTime=i.time+Ta,ke(i,fe.CallToFollow,s.position,Ta),we(a,ge.CallToFollow,s.position));break;case re.CommandTribeSplit:s&&mh(s,i);break;case re.CommandBuild:t?c.build=!c.build:i.buildMenuOpen=!i.buildMenuOpen;break;case re.SelectStorageSpot:i.selectedBuildingType="storageSpot";break;case re.SelectPlantingZone:i.selectedBuildingType="plantingZone";break;case re.SelectRemovalTool:i.selectedBuildingType="removal";break;case re.ToggleDiplomacy:if(s&&s.leaderId&&e.targetTribeId){const m=s.leaderId,S=e.targetTribeId,T=i.entities.entities[S],A=(f=s.tribeControl)==null?void 0:f.diplomacy,I=(g=T==null?void 0:T.tribeControl)==null?void 0:g.diplomacy;if(A&&I){const C=(A[S]||Dt.Friendly)===Dt.Friendly?Dt.Hostile:Dt.Friendly;A[S]=C,I[m]=C}}break;case re.OpenRoleManager:i.roleManagerOpen=!0;break;case re.CloseRoleManager:i.roleManagerOpen=!1;break;case re.IncreaseRoleWeight:if(s&&s.tribeControl&&e.targetRole){const m=s.tribeControl.roleWeights[e.targetRole]||0;m<10&&(s.tribeControl.roleWeights[e.targetRole]=m+1)}break;case re.DecreaseRoleWeight:if(s&&s.tribeControl&&e.targetRole){const m=s.tribeControl.roleWeights[e.targetRole]||0;m>0&&(s.tribeControl.roleWeights[e.targetRole]=m-1)}break}return i};function CD(e,t,i){if(!e.notificationButtonRects)return!1;const o=pt(e);for(const[a,s]of Object.entries(e.notificationButtonRects.dismiss))if(t>=s.x&&t<=s.x+s.width&&i>=s.y&&i<=s.y+s.height)return N_(e,a),o&&we({gameState:e},ge.ButtonClick,o.position),!0;for(const[a,s]of Object.entries(e.notificationButtonRects.view))if(t>=s.x&&t<=s.x+s.width&&i>=s.y&&i<=s.y+s.height){const u=e.notifications.find(c=>c.id===a);if(u){let c=u.targetPosition;if(!c&&u.targetEntityIds&&u.targetEntityIds.length>0){const f=e.entities.entities[u.targetEntityIds[0]];f&&(c=f.position)}return c&&ID(e,c),o&&we({gameState:e},ge.ButtonClick,o.position),u.highlightedEntityIds&&(u.renderHighlights=!u.renderHighlights),!0}}return!1}const _D=({isActive:e,gameStateRef:t,canvasRef:i,viewportCenterRef:o,playerActionHintsRef:a,keysPressed:s,returnToIntro:u})=>(Oe.useEffect(()=>{const c=f=>{if(!e()||t.current.gameOver||!i.current||!f.target||f.target!==i.current)return;const g=i.current.getBoundingClientRect(),m=f.clientX-g.left,S=f.clientY-g.top;if(CD(t.current,m,S))return;const A=t.current.uiButtons.find(y=>m>=y.rect.x&&m<=y.rect.x+y.rect.width&&S>=y.rect.y&&S<=y.rect.y+y.rect.height);if(A){t.current=ED(A,f.shiftKey,t.current,u);return}const I=Gf({x:m,y:S},o.current,{width:i.current.width,height:i.current.height},t.current.mapDimensions);vD(t.current,I)};return window.addEventListener("mousedown",c),()=>{window.removeEventListener("mousedown",c)}},[e,i,t,o,u]),Oe.useEffect(()=>{const c=f=>{if(!e()||!i.current)return;const g=i.current.getBoundingClientRect(),m=f.clientX-g.left,S=f.clientY-g.top;t.current.mousePosition={x:m,y:S};let T;if(t.current.notificationButtonRects){for(const[I,y]of Object.entries(t.current.notificationButtonRects.dismiss))if(m>=y.x&&m<=y.x+y.width&&S>=y.y&&S<=y.y+y.height){T=`notification-dismiss-${I}`;break}if(!T){for(const[I,y]of Object.entries(t.current.notificationButtonRects.view))if(m>=y.x&&m<=y.x+y.width&&S>=y.y&&S<=y.y+y.height){T=`notification-view-${I}`;break}}}if(!T)for(let I=t.current.uiButtons.length-1;I>=0;I--){const y=t.current.uiButtons[I];if(m>=y.rect.x&&m<=y.rect.x+y.rect.width&&S>=y.rect.y&&S<=y.rect.y+y.rect.height){T=y.id;break}}if(t.current.hoveredButtonId=T,T){t.current.autopilotControls.hoveredAutopilotAction=void 0;return}const A=pt(t.current);if(A){const I=Gf({x:m,y:S},o.current,{width:i.current.width,height:i.current.height},t.current.mapDimensions);t.current.autopilotControls.hoveredAutopilotAction=mD(I,A,t.current,f.shiftKey)}else t.current.autopilotControls.hoveredAutopilotAction=void 0};return window.addEventListener("mousemove",c),()=>{window.removeEventListener("mousemove",c)}},[e,i,t,o]),Oe.useEffect(()=>{const c=g=>{if(!e()||t.current.gameOver)return;const m=g.key.toLowerCase();(m===" "||m==="p"||m==="tab"||(g.ctrlKey||g.metaKey)&&(m==="s"||m==="a"))&&g.preventDefault();const S=SD(g,t.current);if(t.current=S.newState,S.handled)return;const T=pt(t.current);T&&(s.current.add(m),yD(m,g.shiftKey,t.current,T,a.current))},f=g=>{if(!e()||t.current.gameOver)return;const m=g.key.toLowerCase();s.current.delete(m);const S=pt(t.current);S&&AD(m,S,t.current,s)};return window.addEventListener("keydown",c),window.addEventListener("keyup",f),()=>{window.removeEventListener("keydown",c),window.removeEventListener("keyup",f)}},[e,t,a,s,u]),null),wD=({gameStateRef:e,ctxRef:t,debugPanelTypeRef:i,viewportCenterRef:o,playerActionHintsRef:a,keysPressed:s,canvasRef:u,setAppState:c,appState:f})=>{const g=Oe.useRef(),{returnToIntro:m}=es(),[S,T,A]=Nv(I=>{var H,B;if(!t.current||!g.current){g.current=I;return}const y=Math.min(I-g.current,1e3)/1e3,{performanceMetrics:C}=e.current;C.currentBucket={renderTime:0,worldUpdateTime:0,aiUpdateTime:0};const O=performance.now();e.current=zu(e.current,y),C.currentBucket.worldUpdateTime=performance.now()-O;const F=pt(e.current);F?a.current=vh(e.current,F):a.current=[],o.current=TD(e.current,o.current,y);const P=performance.now();Du(t.current,e.current,o.current,a.current,{width:((H=u.current)==null?void 0:H.width)||800,height:((B=u.current)==null?void 0:B.height)||600},!1),C.currentBucket.renderTime=performance.now()-P,C.history.push({bucketTime:e.current.time,...C.currentBucket}),C.history.length>AI&&C.history.shift(),g.current=I,e.current.gameOver&&f!=="gameOver"&&(ph(ge.GameOver,{masterVolume:e.current.masterVolume,isMuted:e.current.isMuted}),c("gameOver",{generations:e.current.generationCount,cause:e.current.causeOfGameOver||"Unknown"}))});return Oe.useEffect(()=>(T(),S),[T,S]),Ue.jsx(_D,{isActive:A,gameStateRef:e,canvasRef:u,viewportCenterRef:o,playerActionHintsRef:a,debugPanelTypeRef:i,keysPressed:s,returnToIntro:m})},J0=()=>{const{savedGameState:e,contextReady:t}=es(),[i,o]=Oe.useState(null);return Oe.useEffect(()=>{t&&(e?(console.log("Loading saved game state..."),o(e)):(console.log("Initializing new game state..."),o(gD())))},[t,e]),!t||!i?Ue.jsx("div",{children:"Loading..."}):Ue.jsx(RD,{initialState:i})},RD=({initialState:e})=>{const t=Oe.useRef(null),i=Oe.useRef(null),o=Oe.useRef(e),a=Oe.useRef(new Set),s=Oe.useRef(e.debugPanel),u=Oe.useRef(e.viewportCenter),c=Oe.useRef([]),{appState:f,setAppState:g}=es();return Ue.jsxs(Ue.Fragment,{children:[Ue.jsx(pD,{canvasRef:t,ctxRef:i,gameStateRef:o,debugPanelTypeRef:s,viewportCenterRef:u,playerActionHintsRef:c}),Ue.jsx(wD,{gameStateRef:o,ctxRef:i,debugPanelTypeRef:s,viewportCenterRef:u,playerActionHintsRef:c,keysPressed:a,canvasRef:t,setAppState:g,appState:f})]})},PD=_n.div`
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  text-align: center;
  background-color: rgba(0, 0, 0, 0.75); // Semi-transparent overlay
  color: #fff;
  padding: 20px;
  z-index: 10; // Ensure it's on top
`,ND=_n.h1`
  font-family: 'Press Start 2P', cursive;
  font-size: 4rem;
  color: #ff4136; // Red for emphasis
  text-shadow: 4px 4px 0px #000;
  margin-bottom: 1.5rem;
`,du=_n.p`
  font-family: 'Press Start 2P', cursive;
  font-size: 1.2rem;
  margin: 0.5em 0;
  color: #fff;
  text-shadow: 2px 2px 0px #000;
`,DD=_n.button`
  font-family: 'Press Start 2P', cursive;
  font-size: 1rem;
  padding: 1rem 2rem;
  margin-top: 2em;
  color: #fff;
  background-color: #ff4136; // Red button
  border: 2px solid #fff;
  box-shadow: 4px 4px 0px #fff;
  cursor: pointer;
  transition: all 0.2s ease-in-out;
  text-transform: uppercase;

  &:hover {
    background-color: #fff;
    color: #ff4136;
    box-shadow: 4px 4px 0px #ff4136;
  }
`,OD=()=>{const{setAppState:e,gameOverDetails:t}=es(),i=()=>{e("intro")};return Ue.jsxs(PD,{children:[Ue.jsx(ND,{children:"Game Over"}),Ue.jsx(du,{children:"Your tribe's lineage has ended."}),t&&Ue.jsxs(Ue.Fragment,{children:[Ue.jsxs(du,{children:["Generations Survived: ",t.generations]}),Ue.jsxs(du,{children:["Cause of Extinction: ",t.cause]})]}),!t&&Ue.jsx(du,{children:"Game details are unavailable."}),Ue.jsx(DD,{onClick:i,children:"Return to Menu"})]})},MD=hI`
  /* CSS Reset */
  *, *::before, *::after {
    box-sizing: border-box;
  }

  body {
    margin: 0;
    padding: 0;
    font-family: 'Press Start 2P', 'Arial', sans-serif;
    background-color: #121212;
    color: #f0f0f0;
    line-height: 1.6;
  }

  /* Additional global styles */
  h1, h2, h3, h4, h5, h6 {
    margin-top: 0;
  }

  button {
    cursor: pointer;
    font-family: inherit;
  }

  /* Prevent overflow issues */
  html, body {
    height: 100%;
    overflow-x: hidden;
  }

  /* Root element for React app */
  #root {
    height: 100%;
  }
`;function kD(e,t){Oe.useEffect(()=>{const i=()=>{const o=document.location.hash==="#game"?"game":"intro";t(o)};return window.addEventListener("hashchange",i),i(),()=>{window.removeEventListener("hashchange",i)}},[]),Oe.useEffect(()=>{e==="game"?document.location.hash="#game":e==="intro"&&(document.location.hash="")},[e])}const FD=()=>{const{appState:e,setAppState:t}=es();kD(e,t);const i=()=>{switch(e){case"intro":return Ue.jsx(Q0,{});case"game":return Ue.jsx(J0,{});case"gameOver":return Ue.jsxs(Ue.Fragment,{children:[Ue.jsx(J0,{}),Ue.jsx(OD,{})]});default:return Ue.jsx(Q0,{})}};return Ue.jsxs(Ue.Fragment,{children:[Ue.jsx(MD,{}),i()]})},ev=document.getElementById("root");ev?$_().then(()=>{tT.createRoot(ev).render(Ue.jsx(ti.StrictMode,{children:Ue.jsx(fT,{initialAppState:document.location.hash==="#game"?"game":"intro",children:Ue.jsx(FD,{})})}))}):console.error("Failed to find the root element");
