var _T=Object.defineProperty;var CT=(e,t,r)=>t in e?_T(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r;var De=(e,t,r)=>CT(e,typeof t!="symbol"?t+"":t,r);(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const l of document.querySelectorAll('link[rel="modulepreload"]'))o(l);new MutationObserver(l=>{for(const s of l)if(s.type==="childList")for(const u of s.addedNodes)u.tagName==="LINK"&&u.rel==="modulepreload"&&o(u)}).observe(document,{childList:!0,subtree:!0});function r(l){const s={};return l.integrity&&(s.integrity=l.integrity),l.referrerPolicy&&(s.referrerPolicy=l.referrerPolicy),l.crossOrigin==="use-credentials"?s.credentials="include":l.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function o(l){if(l.ep)return;l.ep=!0;const s=r(l);fetch(l.href,s)}})();function L0(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var yd={exports:{}},Os={},Td={exports:{}},Be={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var nm;function RT(){if(nm)return Be;nm=1;var e=Symbol.for("react.element"),t=Symbol.for("react.portal"),r=Symbol.for("react.fragment"),o=Symbol.for("react.strict_mode"),l=Symbol.for("react.profiler"),s=Symbol.for("react.provider"),u=Symbol.for("react.context"),d=Symbol.for("react.forward_ref"),f=Symbol.for("react.suspense"),g=Symbol.for("react.memo"),m=Symbol.for("react.lazy"),S=Symbol.iterator;function y(P){return P===null||typeof P!="object"?null:(P=S&&P[S]||P["@@iterator"],typeof P=="function"?P:null)}var E={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},T=Object.assign,A={};function C(P,L,K){this.props=P,this.context=L,this.refs=A,this.updater=K||E}C.prototype.isReactComponent={},C.prototype.setState=function(P,L){if(typeof P!="object"&&typeof P!="function"&&P!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,P,L,"setState")},C.prototype.forceUpdate=function(P){this.updater.enqueueForceUpdate(this,P,"forceUpdate")};function F(){}F.prototype=C.prototype;function B(P,L,K){this.props=P,this.context=L,this.refs=A,this.updater=K||E}var D=B.prototype=new F;D.constructor=B,T(D,C.prototype),D.isPureReactComponent=!0;var H=Array.isArray,x=Object.prototype.hasOwnProperty,U={current:null},$={key:!0,ref:!0,__self:!0,__source:!0};function ee(P,L,K){var ie,Se={},ae=null,Ee=null;if(L!=null)for(ie in L.ref!==void 0&&(Ee=L.ref),L.key!==void 0&&(ae=""+L.key),L)x.call(L,ie)&&!$.hasOwnProperty(ie)&&(Se[ie]=L[ie]);var Ae=arguments.length-2;if(Ae===1)Se.children=K;else if(1<Ae){for(var Z=Array(Ae),re=0;re<Ae;re++)Z[re]=arguments[re+2];Se.children=Z}if(P&&P.defaultProps)for(ie in Ae=P.defaultProps,Ae)Se[ie]===void 0&&(Se[ie]=Ae[ie]);return{$$typeof:e,type:P,key:ae,ref:Ee,props:Se,_owner:U.current}}function _e(P,L){return{$$typeof:e,type:P.type,key:L,ref:P.ref,props:P.props,_owner:P._owner}}function Ce(P){return typeof P=="object"&&P!==null&&P.$$typeof===e}function be(P){var L={"=":"=0",":":"=2"};return"$"+P.replace(/[=:]/g,function(K){return L[K]})}var Ne=/\/+/g;function Pe(P,L){return typeof P=="object"&&P!==null&&P.key!=null?be(""+P.key):L.toString(36)}function de(P,L,K,ie,Se){var ae=typeof P;(ae==="undefined"||ae==="boolean")&&(P=null);var Ee=!1;if(P===null)Ee=!0;else switch(ae){case"string":case"number":Ee=!0;break;case"object":switch(P.$$typeof){case e:case t:Ee=!0}}if(Ee)return Ee=P,Se=Se(Ee),P=ie===""?"."+Pe(Ee,0):ie,H(Se)?(K="",P!=null&&(K=P.replace(Ne,"$&/")+"/"),de(Se,L,K,"",function(re){return re})):Se!=null&&(Ce(Se)&&(Se=_e(Se,K+(!Se.key||Ee&&Ee.key===Se.key?"":(""+Se.key).replace(Ne,"$&/")+"/")+P)),L.push(Se)),1;if(Ee=0,ie=ie===""?".":ie+":",H(P))for(var Ae=0;Ae<P.length;Ae++){ae=P[Ae];var Z=ie+Pe(ae,Ae);Ee+=de(ae,L,K,Z,Se)}else if(Z=y(P),typeof Z=="function")for(P=Z.call(P),Ae=0;!(ae=P.next()).done;)ae=ae.value,Z=ie+Pe(ae,Ae++),Ee+=de(ae,L,K,Z,Se);else if(ae==="object")throw L=String(P),Error("Objects are not valid as a React child (found: "+(L==="[object Object]"?"object with keys {"+Object.keys(P).join(", ")+"}":L)+"). If you meant to render a collection of children, use an array instead.");return Ee}function Ue(P,L,K){if(P==null)return P;var ie=[],Se=0;return de(P,ie,"","",function(ae){return L.call(K,ae,Se++)}),ie}function Te(P){if(P._status===-1){var L=P._result;L=L(),L.then(function(K){(P._status===0||P._status===-1)&&(P._status=1,P._result=K)},function(K){(P._status===0||P._status===-1)&&(P._status=2,P._result=K)}),P._status===-1&&(P._status=0,P._result=L)}if(P._status===1)return P._result.default;throw P._result}var ne={current:null},W={transition:null},X={ReactCurrentDispatcher:ne,ReactCurrentBatchConfig:W,ReactCurrentOwner:U};function Y(){throw Error("act(...) is not supported in production builds of React.")}return Be.Children={map:Ue,forEach:function(P,L,K){Ue(P,function(){L.apply(this,arguments)},K)},count:function(P){var L=0;return Ue(P,function(){L++}),L},toArray:function(P){return Ue(P,function(L){return L})||[]},only:function(P){if(!Ce(P))throw Error("React.Children.only expected to receive a single React element child.");return P}},Be.Component=C,Be.Fragment=r,Be.Profiler=l,Be.PureComponent=B,Be.StrictMode=o,Be.Suspense=f,Be.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=X,Be.act=Y,Be.cloneElement=function(P,L,K){if(P==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+P+".");var ie=T({},P.props),Se=P.key,ae=P.ref,Ee=P._owner;if(L!=null){if(L.ref!==void 0&&(ae=L.ref,Ee=U.current),L.key!==void 0&&(Se=""+L.key),P.type&&P.type.defaultProps)var Ae=P.type.defaultProps;for(Z in L)x.call(L,Z)&&!$.hasOwnProperty(Z)&&(ie[Z]=L[Z]===void 0&&Ae!==void 0?Ae[Z]:L[Z])}var Z=arguments.length-2;if(Z===1)ie.children=K;else if(1<Z){Ae=Array(Z);for(var re=0;re<Z;re++)Ae[re]=arguments[re+2];ie.children=Ae}return{$$typeof:e,type:P.type,key:Se,ref:ae,props:ie,_owner:Ee}},Be.createContext=function(P){return P={$$typeof:u,_currentValue:P,_currentValue2:P,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},P.Provider={$$typeof:s,_context:P},P.Consumer=P},Be.createElement=ee,Be.createFactory=function(P){var L=ee.bind(null,P);return L.type=P,L},Be.createRef=function(){return{current:null}},Be.forwardRef=function(P){return{$$typeof:d,render:P}},Be.isValidElement=Ce,Be.lazy=function(P){return{$$typeof:m,_payload:{_status:-1,_result:P},_init:Te}},Be.memo=function(P,L){return{$$typeof:g,type:P,compare:L===void 0?null:L}},Be.startTransition=function(P){var L=W.transition;W.transition={};try{P()}finally{W.transition=L}},Be.unstable_act=Y,Be.useCallback=function(P,L){return ne.current.useCallback(P,L)},Be.useContext=function(P){return ne.current.useContext(P)},Be.useDebugValue=function(){},Be.useDeferredValue=function(P){return ne.current.useDeferredValue(P)},Be.useEffect=function(P,L){return ne.current.useEffect(P,L)},Be.useId=function(){return ne.current.useId()},Be.useImperativeHandle=function(P,L,K){return ne.current.useImperativeHandle(P,L,K)},Be.useInsertionEffect=function(P,L){return ne.current.useInsertionEffect(P,L)},Be.useLayoutEffect=function(P,L){return ne.current.useLayoutEffect(P,L)},Be.useMemo=function(P,L){return ne.current.useMemo(P,L)},Be.useReducer=function(P,L,K){return ne.current.useReducer(P,L,K)},Be.useRef=function(P){return ne.current.useRef(P)},Be.useState=function(P){return ne.current.useState(P)},Be.useSyncExternalStore=function(P,L,K){return ne.current.useSyncExternalStore(P,L,K)},Be.useTransition=function(){return ne.current.useTransition()},Be.version="18.3.1",Be}var im;function Rf(){return im||(im=1,Td.exports=RT()),Td.exports}/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var rm;function PT(){if(rm)return Os;rm=1;var e=Rf(),t=Symbol.for("react.element"),r=Symbol.for("react.fragment"),o=Object.prototype.hasOwnProperty,l=e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,s={key:!0,ref:!0,__self:!0,__source:!0};function u(d,f,g){var m,S={},y=null,E=null;g!==void 0&&(y=""+g),f.key!==void 0&&(y=""+f.key),f.ref!==void 0&&(E=f.ref);for(m in f)o.call(f,m)&&!s.hasOwnProperty(m)&&(S[m]=f[m]);if(d&&d.defaultProps)for(m in f=d.defaultProps,f)S[m]===void 0&&(S[m]=f[m]);return{$$typeof:t,type:d,key:y,ref:E,props:S,_owner:l.current}}return Os.Fragment=r,Os.jsx=u,Os.jsxs=u,Os}var om;function NT(){return om||(om=1,yd.exports=PT()),yd.exports}var Fe=NT(),Re=Rf();const Qn=L0(Re);var Pl={},Ad={exports:{}},Zt={},Id={exports:{}},Ed={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var sm;function DT(){return sm||(sm=1,function(e){function t(W,X){var Y=W.length;W.push(X);e:for(;0<Y;){var P=Y-1>>>1,L=W[P];if(0<l(L,X))W[P]=X,W[Y]=L,Y=P;else break e}}function r(W){return W.length===0?null:W[0]}function o(W){if(W.length===0)return null;var X=W[0],Y=W.pop();if(Y!==X){W[0]=Y;e:for(var P=0,L=W.length,K=L>>>1;P<K;){var ie=2*(P+1)-1,Se=W[ie],ae=ie+1,Ee=W[ae];if(0>l(Se,Y))ae<L&&0>l(Ee,Se)?(W[P]=Ee,W[ae]=Y,P=ae):(W[P]=Se,W[ie]=Y,P=ie);else if(ae<L&&0>l(Ee,Y))W[P]=Ee,W[ae]=Y,P=ae;else break e}}return X}function l(W,X){var Y=W.sortIndex-X.sortIndex;return Y!==0?Y:W.id-X.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;e.unstable_now=function(){return s.now()}}else{var u=Date,d=u.now();e.unstable_now=function(){return u.now()-d}}var f=[],g=[],m=1,S=null,y=3,E=!1,T=!1,A=!1,C=typeof setTimeout=="function"?setTimeout:null,F=typeof clearTimeout=="function"?clearTimeout:null,B=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function D(W){for(var X=r(g);X!==null;){if(X.callback===null)o(g);else if(X.startTime<=W)o(g),X.sortIndex=X.expirationTime,t(f,X);else break;X=r(g)}}function H(W){if(A=!1,D(W),!T)if(r(f)!==null)T=!0,Te(x);else{var X=r(g);X!==null&&ne(H,X.startTime-W)}}function x(W,X){T=!1,A&&(A=!1,F(ee),ee=-1),E=!0;var Y=y;try{for(D(X),S=r(f);S!==null&&(!(S.expirationTime>X)||W&&!be());){var P=S.callback;if(typeof P=="function"){S.callback=null,y=S.priorityLevel;var L=P(S.expirationTime<=X);X=e.unstable_now(),typeof L=="function"?S.callback=L:S===r(f)&&o(f),D(X)}else o(f);S=r(f)}if(S!==null)var K=!0;else{var ie=r(g);ie!==null&&ne(H,ie.startTime-X),K=!1}return K}finally{S=null,y=Y,E=!1}}var U=!1,$=null,ee=-1,_e=5,Ce=-1;function be(){return!(e.unstable_now()-Ce<_e)}function Ne(){if($!==null){var W=e.unstable_now();Ce=W;var X=!0;try{X=$(!0,W)}finally{X?Pe():(U=!1,$=null)}}else U=!1}var Pe;if(typeof B=="function")Pe=function(){B(Ne)};else if(typeof MessageChannel<"u"){var de=new MessageChannel,Ue=de.port2;de.port1.onmessage=Ne,Pe=function(){Ue.postMessage(null)}}else Pe=function(){C(Ne,0)};function Te(W){$=W,U||(U=!0,Pe())}function ne(W,X){ee=C(function(){W(e.unstable_now())},X)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(W){W.callback=null},e.unstable_continueExecution=function(){T||E||(T=!0,Te(x))},e.unstable_forceFrameRate=function(W){0>W||125<W?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):_e=0<W?Math.floor(1e3/W):5},e.unstable_getCurrentPriorityLevel=function(){return y},e.unstable_getFirstCallbackNode=function(){return r(f)},e.unstable_next=function(W){switch(y){case 1:case 2:case 3:var X=3;break;default:X=y}var Y=y;y=X;try{return W()}finally{y=Y}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(W,X){switch(W){case 1:case 2:case 3:case 4:case 5:break;default:W=3}var Y=y;y=W;try{return X()}finally{y=Y}},e.unstable_scheduleCallback=function(W,X,Y){var P=e.unstable_now();switch(typeof Y=="object"&&Y!==null?(Y=Y.delay,Y=typeof Y=="number"&&0<Y?P+Y:P):Y=P,W){case 1:var L=-1;break;case 2:L=250;break;case 5:L=1073741823;break;case 4:L=1e4;break;default:L=5e3}return L=Y+L,W={id:m++,callback:X,priorityLevel:W,startTime:Y,expirationTime:L,sortIndex:-1},Y>P?(W.sortIndex=Y,t(g,W),r(f)===null&&W===r(g)&&(A?(F(ee),ee=-1):A=!0,ne(H,Y-P))):(W.sortIndex=L,t(f,W),T||E||(T=!0,Te(x))),W},e.unstable_shouldYield=be,e.unstable_wrapCallback=function(W){var X=y;return function(){var Y=y;y=X;try{return W.apply(this,arguments)}finally{y=Y}}}}(Ed)),Ed}var am;function OT(){return am||(am=1,Id.exports=DT()),Id.exports}/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var lm;function MT(){if(lm)return Zt;lm=1;var e=Rf(),t=OT();function r(n){for(var i="https://reactjs.org/docs/error-decoder.html?invariant="+n,a=1;a<arguments.length;a++)i+="&args[]="+encodeURIComponent(arguments[a]);return"Minified React error #"+n+"; visit "+i+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var o=new Set,l={};function s(n,i){u(n,i),u(n+"Capture",i)}function u(n,i){for(l[n]=i,n=0;n<i.length;n++)o.add(i[n])}var d=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),f=Object.prototype.hasOwnProperty,g=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,m={},S={};function y(n){return f.call(S,n)?!0:f.call(m,n)?!1:g.test(n)?S[n]=!0:(m[n]=!0,!1)}function E(n,i,a,c){if(a!==null&&a.type===0)return!1;switch(typeof i){case"function":case"symbol":return!0;case"boolean":return c?!1:a!==null?!a.acceptsBooleans:(n=n.toLowerCase().slice(0,5),n!=="data-"&&n!=="aria-");default:return!1}}function T(n,i,a,c){if(i===null||typeof i>"u"||E(n,i,a,c))return!0;if(c)return!1;if(a!==null)switch(a.type){case 3:return!i;case 4:return i===!1;case 5:return isNaN(i);case 6:return isNaN(i)||1>i}return!1}function A(n,i,a,c,h,p,v){this.acceptsBooleans=i===2||i===3||i===4,this.attributeName=c,this.attributeNamespace=h,this.mustUseProperty=a,this.propertyName=n,this.type=i,this.sanitizeURL=p,this.removeEmptyString=v}var C={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(n){C[n]=new A(n,0,!1,n,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(n){var i=n[0];C[i]=new A(i,1,!1,n[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(n){C[n]=new A(n,2,!1,n.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(n){C[n]=new A(n,2,!1,n,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(n){C[n]=new A(n,3,!1,n.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(n){C[n]=new A(n,3,!0,n,null,!1,!1)}),["capture","download"].forEach(function(n){C[n]=new A(n,4,!1,n,null,!1,!1)}),["cols","rows","size","span"].forEach(function(n){C[n]=new A(n,6,!1,n,null,!1,!1)}),["rowSpan","start"].forEach(function(n){C[n]=new A(n,5,!1,n.toLowerCase(),null,!1,!1)});var F=/[\-:]([a-z])/g;function B(n){return n[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(n){var i=n.replace(F,B);C[i]=new A(i,1,!1,n,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(n){var i=n.replace(F,B);C[i]=new A(i,1,!1,n,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(n){var i=n.replace(F,B);C[i]=new A(i,1,!1,n,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(n){C[n]=new A(n,1,!1,n.toLowerCase(),null,!1,!1)}),C.xlinkHref=new A("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(n){C[n]=new A(n,1,!1,n.toLowerCase(),null,!0,!0)});function D(n,i,a,c){var h=C.hasOwnProperty(i)?C[i]:null;(h!==null?h.type!==0:c||!(2<i.length)||i[0]!=="o"&&i[0]!=="O"||i[1]!=="n"&&i[1]!=="N")&&(T(i,a,h,c)&&(a=null),c||h===null?y(i)&&(a===null?n.removeAttribute(i):n.setAttribute(i,""+a)):h.mustUseProperty?n[h.propertyName]=a===null?h.type===3?!1:"":a:(i=h.attributeName,c=h.attributeNamespace,a===null?n.removeAttribute(i):(h=h.type,a=h===3||h===4&&a===!0?"":""+a,c?n.setAttributeNS(c,i,a):n.setAttribute(i,a))))}var H=e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,x=Symbol.for("react.element"),U=Symbol.for("react.portal"),$=Symbol.for("react.fragment"),ee=Symbol.for("react.strict_mode"),_e=Symbol.for("react.profiler"),Ce=Symbol.for("react.provider"),be=Symbol.for("react.context"),Ne=Symbol.for("react.forward_ref"),Pe=Symbol.for("react.suspense"),de=Symbol.for("react.suspense_list"),Ue=Symbol.for("react.memo"),Te=Symbol.for("react.lazy"),ne=Symbol.for("react.offscreen"),W=Symbol.iterator;function X(n){return n===null||typeof n!="object"?null:(n=W&&n[W]||n["@@iterator"],typeof n=="function"?n:null)}var Y=Object.assign,P;function L(n){if(P===void 0)try{throw Error()}catch(a){var i=a.stack.trim().match(/\n( *(at )?)/);P=i&&i[1]||""}return`
`+P+n}var K=!1;function ie(n,i){if(!n||K)return"";K=!0;var a=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(i)if(i=function(){throw Error()},Object.defineProperty(i.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(i,[])}catch(k){var c=k}Reflect.construct(n,[],i)}else{try{i.call()}catch(k){c=k}n.call(i.prototype)}else{try{throw Error()}catch(k){c=k}n()}}catch(k){if(k&&c&&typeof k.stack=="string"){for(var h=k.stack.split(`
`),p=c.stack.split(`
`),v=h.length-1,w=p.length-1;1<=v&&0<=w&&h[v]!==p[w];)w--;for(;1<=v&&0<=w;v--,w--)if(h[v]!==p[w]){if(v!==1||w!==1)do if(v--,w--,0>w||h[v]!==p[w]){var R=`
`+h[v].replace(" at new "," at ");return n.displayName&&R.includes("<anonymous>")&&(R=R.replace("<anonymous>",n.displayName)),R}while(1<=v&&0<=w);break}}}finally{K=!1,Error.prepareStackTrace=a}return(n=n?n.displayName||n.name:"")?L(n):""}function Se(n){switch(n.tag){case 5:return L(n.type);case 16:return L("Lazy");case 13:return L("Suspense");case 19:return L("SuspenseList");case 0:case 2:case 15:return n=ie(n.type,!1),n;case 11:return n=ie(n.type.render,!1),n;case 1:return n=ie(n.type,!0),n;default:return""}}function ae(n){if(n==null)return null;if(typeof n=="function")return n.displayName||n.name||null;if(typeof n=="string")return n;switch(n){case $:return"Fragment";case U:return"Portal";case _e:return"Profiler";case ee:return"StrictMode";case Pe:return"Suspense";case de:return"SuspenseList"}if(typeof n=="object")switch(n.$$typeof){case be:return(n.displayName||"Context")+".Consumer";case Ce:return(n._context.displayName||"Context")+".Provider";case Ne:var i=n.render;return n=n.displayName,n||(n=i.displayName||i.name||"",n=n!==""?"ForwardRef("+n+")":"ForwardRef"),n;case Ue:return i=n.displayName||null,i!==null?i:ae(n.type)||"Memo";case Te:i=n._payload,n=n._init;try{return ae(n(i))}catch{}}return null}function Ee(n){var i=n.type;switch(n.tag){case 24:return"Cache";case 9:return(i.displayName||"Context")+".Consumer";case 10:return(i._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return n=i.render,n=n.displayName||n.name||"",i.displayName||(n!==""?"ForwardRef("+n+")":"ForwardRef");case 7:return"Fragment";case 5:return i;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return ae(i);case 8:return i===ee?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof i=="function")return i.displayName||i.name||null;if(typeof i=="string")return i}return null}function Ae(n){switch(typeof n){case"boolean":case"number":case"string":case"undefined":return n;case"object":return n;default:return""}}function Z(n){var i=n.type;return(n=n.nodeName)&&n.toLowerCase()==="input"&&(i==="checkbox"||i==="radio")}function re(n){var i=Z(n)?"checked":"value",a=Object.getOwnPropertyDescriptor(n.constructor.prototype,i),c=""+n[i];if(!n.hasOwnProperty(i)&&typeof a<"u"&&typeof a.get=="function"&&typeof a.set=="function"){var h=a.get,p=a.set;return Object.defineProperty(n,i,{configurable:!0,get:function(){return h.call(this)},set:function(v){c=""+v,p.call(this,v)}}),Object.defineProperty(n,i,{enumerable:a.enumerable}),{getValue:function(){return c},setValue:function(v){c=""+v},stopTracking:function(){n._valueTracker=null,delete n[i]}}}}function Le(n){n._valueTracker||(n._valueTracker=re(n))}function he(n){if(!n)return!1;var i=n._valueTracker;if(!i)return!0;var a=i.getValue(),c="";return n&&(c=Z(n)?n.checked?"true":"false":n.value),n=c,n!==a?(i.setValue(n),!0):!1}function bn(n){if(n=n||(typeof document<"u"?document:void 0),typeof n>"u")return null;try{return n.activeElement||n.body}catch{return n.body}}function qe(n,i){var a=i.checked;return Y({},i,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:a??n._wrapperState.initialChecked})}function je(n,i){var a=i.defaultValue==null?"":i.defaultValue,c=i.checked!=null?i.checked:i.defaultChecked;a=Ae(i.value!=null?i.value:a),n._wrapperState={initialChecked:c,initialValue:a,controlled:i.type==="checkbox"||i.type==="radio"?i.checked!=null:i.value!=null}}function Gn(n,i){i=i.checked,i!=null&&D(n,"checked",i,!1)}function Wt(n,i){Gn(n,i);var a=Ae(i.value),c=i.type;if(a!=null)c==="number"?(a===0&&n.value===""||n.value!=a)&&(n.value=""+a):n.value!==""+a&&(n.value=""+a);else if(c==="submit"||c==="reset"){n.removeAttribute("value");return}i.hasOwnProperty("value")?xn(n,i.type,a):i.hasOwnProperty("defaultValue")&&xn(n,i.type,Ae(i.defaultValue)),i.checked==null&&i.defaultChecked!=null&&(n.defaultChecked=!!i.defaultChecked)}function un(n,i,a){if(i.hasOwnProperty("value")||i.hasOwnProperty("defaultValue")){var c=i.type;if(!(c!=="submit"&&c!=="reset"||i.value!==void 0&&i.value!==null))return;i=""+n._wrapperState.initialValue,a||i===n.value||(n.value=i),n.defaultValue=i}a=n.name,a!==""&&(n.name=""),n.defaultChecked=!!n._wrapperState.initialChecked,a!==""&&(n.name=a)}function xn(n,i,a){(i!=="number"||bn(n.ownerDocument)!==n)&&(a==null?n.defaultValue=""+n._wrapperState.initialValue:n.defaultValue!==""+a&&(n.defaultValue=""+a))}var $n=Array.isArray;function Si(n,i,a,c){if(n=n.options,i){i={};for(var h=0;h<a.length;h++)i["$"+a[h]]=!0;for(a=0;a<n.length;a++)h=i.hasOwnProperty("$"+n[a].value),n[a].selected!==h&&(n[a].selected=h),h&&c&&(n[a].defaultSelected=!0)}else{for(a=""+Ae(a),i=null,h=0;h<n.length;h++){if(n[h].value===a){n[h].selected=!0,c&&(n[h].defaultSelected=!0);return}i!==null||n[h].disabled||(i=n[h])}i!==null&&(i.selected=!0)}}function ir(n,i){if(i.dangerouslySetInnerHTML!=null)throw Error(r(91));return Y({},i,{value:void 0,defaultValue:void 0,children:""+n._wrapperState.initialValue})}function fh(n,i){var a=i.value;if(a==null){if(a=i.children,i=i.defaultValue,a!=null){if(i!=null)throw Error(r(92));if($n(a)){if(1<a.length)throw Error(r(93));a=a[0]}i=a}i==null&&(i=""),a=i}n._wrapperState={initialValue:Ae(a)}}function hh(n,i){var a=Ae(i.value),c=Ae(i.defaultValue);a!=null&&(a=""+a,a!==n.value&&(n.value=a),i.defaultValue==null&&n.defaultValue!==a&&(n.defaultValue=a)),c!=null&&(n.defaultValue=""+c)}function gh(n){var i=n.textContent;i===n._wrapperState.initialValue&&i!==""&&i!==null&&(n.value=i)}function ph(n){switch(n){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Du(n,i){return n==null||n==="http://www.w3.org/1999/xhtml"?ph(i):n==="http://www.w3.org/2000/svg"&&i==="foreignObject"?"http://www.w3.org/1999/xhtml":n}var Ta,mh=function(n){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(i,a,c,h){MSApp.execUnsafeLocalFunction(function(){return n(i,a,c,h)})}:n}(function(n,i){if(n.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in n)n.innerHTML=i;else{for(Ta=Ta||document.createElement("div"),Ta.innerHTML="<svg>"+i.valueOf().toString()+"</svg>",i=Ta.firstChild;n.firstChild;)n.removeChild(n.firstChild);for(;i.firstChild;)n.appendChild(i.firstChild)}});function Vo(n,i){if(i){var a=n.firstChild;if(a&&a===n.lastChild&&a.nodeType===3){a.nodeValue=i;return}}n.textContent=i}var Xo={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},NS=["Webkit","ms","Moz","O"];Object.keys(Xo).forEach(function(n){NS.forEach(function(i){i=i+n.charAt(0).toUpperCase()+n.substring(1),Xo[i]=Xo[n]})});function vh(n,i,a){return i==null||typeof i=="boolean"||i===""?"":a||typeof i!="number"||i===0||Xo.hasOwnProperty(n)&&Xo[n]?(""+i).trim():i+"px"}function Sh(n,i){n=n.style;for(var a in i)if(i.hasOwnProperty(a)){var c=a.indexOf("--")===0,h=vh(a,i[a],c);a==="float"&&(a="cssFloat"),c?n.setProperty(a,h):n[a]=h}}var DS=Y({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Ou(n,i){if(i){if(DS[n]&&(i.children!=null||i.dangerouslySetInnerHTML!=null))throw Error(r(137,n));if(i.dangerouslySetInnerHTML!=null){if(i.children!=null)throw Error(r(60));if(typeof i.dangerouslySetInnerHTML!="object"||!("__html"in i.dangerouslySetInnerHTML))throw Error(r(61))}if(i.style!=null&&typeof i.style!="object")throw Error(r(62))}}function Mu(n,i){if(n.indexOf("-")===-1)return typeof i.is=="string";switch(n){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var ku=null;function Fu(n){return n=n.target||n.srcElement||window,n.correspondingUseElement&&(n=n.correspondingUseElement),n.nodeType===3?n.parentNode:n}var Uu=null,Gr=null,xr=null;function yh(n){if(n=ms(n)){if(typeof Uu!="function")throw Error(r(280));var i=n.stateNode;i&&(i=za(i),Uu(n.stateNode,n.type,i))}}function Th(n){Gr?xr?xr.push(n):xr=[n]:Gr=n}function Ah(){if(Gr){var n=Gr,i=xr;if(xr=Gr=null,yh(n),i)for(n=0;n<i.length;n++)yh(i[n])}}function Ih(n,i){return n(i)}function Eh(){}var Lu=!1;function wh(n,i,a){if(Lu)return n(i,a);Lu=!0;try{return Ih(n,i,a)}finally{Lu=!1,(Gr!==null||xr!==null)&&(Eh(),Ah())}}function Ko(n,i){var a=n.stateNode;if(a===null)return null;var c=za(a);if(c===null)return null;a=c[i];e:switch(i){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(c=!c.disabled)||(n=n.type,c=!(n==="button"||n==="input"||n==="select"||n==="textarea")),n=!c;break e;default:n=!1}if(n)return null;if(a&&typeof a!="function")throw Error(r(231,i,typeof a));return a}var Bu=!1;if(d)try{var Zo={};Object.defineProperty(Zo,"passive",{get:function(){Bu=!0}}),window.addEventListener("test",Zo,Zo),window.removeEventListener("test",Zo,Zo)}catch{Bu=!1}function OS(n,i,a,c,h,p,v,w,R){var k=Array.prototype.slice.call(arguments,3);try{i.apply(a,k)}catch(G){this.onError(G)}}var qo=!1,Aa=null,Ia=!1,Hu=null,MS={onError:function(n){qo=!0,Aa=n}};function kS(n,i,a,c,h,p,v,w,R){qo=!1,Aa=null,OS.apply(MS,arguments)}function FS(n,i,a,c,h,p,v,w,R){if(kS.apply(this,arguments),qo){if(qo){var k=Aa;qo=!1,Aa=null}else throw Error(r(198));Ia||(Ia=!0,Hu=k)}}function rr(n){var i=n,a=n;if(n.alternate)for(;i.return;)i=i.return;else{n=i;do i=n,(i.flags&4098)!==0&&(a=i.return),n=i.return;while(n)}return i.tag===3?a:null}function _h(n){if(n.tag===13){var i=n.memoizedState;if(i===null&&(n=n.alternate,n!==null&&(i=n.memoizedState)),i!==null)return i.dehydrated}return null}function Ch(n){if(rr(n)!==n)throw Error(r(188))}function US(n){var i=n.alternate;if(!i){if(i=rr(n),i===null)throw Error(r(188));return i!==n?null:n}for(var a=n,c=i;;){var h=a.return;if(h===null)break;var p=h.alternate;if(p===null){if(c=h.return,c!==null){a=c;continue}break}if(h.child===p.child){for(p=h.child;p;){if(p===a)return Ch(h),n;if(p===c)return Ch(h),i;p=p.sibling}throw Error(r(188))}if(a.return!==c.return)a=h,c=p;else{for(var v=!1,w=h.child;w;){if(w===a){v=!0,a=h,c=p;break}if(w===c){v=!0,c=h,a=p;break}w=w.sibling}if(!v){for(w=p.child;w;){if(w===a){v=!0,a=p,c=h;break}if(w===c){v=!0,c=p,a=h;break}w=w.sibling}if(!v)throw Error(r(189))}}if(a.alternate!==c)throw Error(r(190))}if(a.tag!==3)throw Error(r(188));return a.stateNode.current===a?n:i}function Rh(n){return n=US(n),n!==null?Ph(n):null}function Ph(n){if(n.tag===5||n.tag===6)return n;for(n=n.child;n!==null;){var i=Ph(n);if(i!==null)return i;n=n.sibling}return null}var Nh=t.unstable_scheduleCallback,Dh=t.unstable_cancelCallback,LS=t.unstable_shouldYield,BS=t.unstable_requestPaint,at=t.unstable_now,HS=t.unstable_getCurrentPriorityLevel,bu=t.unstable_ImmediatePriority,Oh=t.unstable_UserBlockingPriority,Ea=t.unstable_NormalPriority,bS=t.unstable_LowPriority,Mh=t.unstable_IdlePriority,wa=null,zn=null;function GS(n){if(zn&&typeof zn.onCommitFiberRoot=="function")try{zn.onCommitFiberRoot(wa,n,void 0,(n.current.flags&128)===128)}catch{}}var wn=Math.clz32?Math.clz32:zS,xS=Math.log,$S=Math.LN2;function zS(n){return n>>>=0,n===0?32:31-(xS(n)/$S|0)|0}var _a=64,Ca=4194304;function Qo(n){switch(n&-n){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return n&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return n&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return n}}function Ra(n,i){var a=n.pendingLanes;if(a===0)return 0;var c=0,h=n.suspendedLanes,p=n.pingedLanes,v=a&268435455;if(v!==0){var w=v&~h;w!==0?c=Qo(w):(p&=v,p!==0&&(c=Qo(p)))}else v=a&~h,v!==0?c=Qo(v):p!==0&&(c=Qo(p));if(c===0)return 0;if(i!==0&&i!==c&&(i&h)===0&&(h=c&-c,p=i&-i,h>=p||h===16&&(p&4194240)!==0))return i;if((c&4)!==0&&(c|=a&16),i=n.entangledLanes,i!==0)for(n=n.entanglements,i&=c;0<i;)a=31-wn(i),h=1<<a,c|=n[a],i&=~h;return c}function WS(n,i){switch(n){case 1:case 2:case 4:return i+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return i+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function YS(n,i){for(var a=n.suspendedLanes,c=n.pingedLanes,h=n.expirationTimes,p=n.pendingLanes;0<p;){var v=31-wn(p),w=1<<v,R=h[v];R===-1?((w&a)===0||(w&c)!==0)&&(h[v]=WS(w,i)):R<=i&&(n.expiredLanes|=w),p&=~w}}function Gu(n){return n=n.pendingLanes&-1073741825,n!==0?n:n&1073741824?1073741824:0}function kh(){var n=_a;return _a<<=1,(_a&4194240)===0&&(_a=64),n}function xu(n){for(var i=[],a=0;31>a;a++)i.push(n);return i}function Jo(n,i,a){n.pendingLanes|=i,i!==536870912&&(n.suspendedLanes=0,n.pingedLanes=0),n=n.eventTimes,i=31-wn(i),n[i]=a}function jS(n,i){var a=n.pendingLanes&~i;n.pendingLanes=i,n.suspendedLanes=0,n.pingedLanes=0,n.expiredLanes&=i,n.mutableReadLanes&=i,n.entangledLanes&=i,i=n.entanglements;var c=n.eventTimes;for(n=n.expirationTimes;0<a;){var h=31-wn(a),p=1<<h;i[h]=0,c[h]=-1,n[h]=-1,a&=~p}}function $u(n,i){var a=n.entangledLanes|=i;for(n=n.entanglements;a;){var c=31-wn(a),h=1<<c;h&i|n[c]&i&&(n[c]|=i),a&=~h}}var We=0;function Fh(n){return n&=-n,1<n?4<n?(n&268435455)!==0?16:536870912:4:1}var Uh,zu,Lh,Bh,Hh,Wu=!1,Pa=[],yi=null,Ti=null,Ai=null,es=new Map,ts=new Map,Ii=[],VS="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function bh(n,i){switch(n){case"focusin":case"focusout":yi=null;break;case"dragenter":case"dragleave":Ti=null;break;case"mouseover":case"mouseout":Ai=null;break;case"pointerover":case"pointerout":es.delete(i.pointerId);break;case"gotpointercapture":case"lostpointercapture":ts.delete(i.pointerId)}}function ns(n,i,a,c,h,p){return n===null||n.nativeEvent!==p?(n={blockedOn:i,domEventName:a,eventSystemFlags:c,nativeEvent:p,targetContainers:[h]},i!==null&&(i=ms(i),i!==null&&zu(i)),n):(n.eventSystemFlags|=c,i=n.targetContainers,h!==null&&i.indexOf(h)===-1&&i.push(h),n)}function XS(n,i,a,c,h){switch(i){case"focusin":return yi=ns(yi,n,i,a,c,h),!0;case"dragenter":return Ti=ns(Ti,n,i,a,c,h),!0;case"mouseover":return Ai=ns(Ai,n,i,a,c,h),!0;case"pointerover":var p=h.pointerId;return es.set(p,ns(es.get(p)||null,n,i,a,c,h)),!0;case"gotpointercapture":return p=h.pointerId,ts.set(p,ns(ts.get(p)||null,n,i,a,c,h)),!0}return!1}function Gh(n){var i=or(n.target);if(i!==null){var a=rr(i);if(a!==null){if(i=a.tag,i===13){if(i=_h(a),i!==null){n.blockedOn=i,Hh(n.priority,function(){Lh(a)});return}}else if(i===3&&a.stateNode.current.memoizedState.isDehydrated){n.blockedOn=a.tag===3?a.stateNode.containerInfo:null;return}}}n.blockedOn=null}function Na(n){if(n.blockedOn!==null)return!1;for(var i=n.targetContainers;0<i.length;){var a=ju(n.domEventName,n.eventSystemFlags,i[0],n.nativeEvent);if(a===null){a=n.nativeEvent;var c=new a.constructor(a.type,a);ku=c,a.target.dispatchEvent(c),ku=null}else return i=ms(a),i!==null&&zu(i),n.blockedOn=a,!1;i.shift()}return!0}function xh(n,i,a){Na(n)&&a.delete(i)}function KS(){Wu=!1,yi!==null&&Na(yi)&&(yi=null),Ti!==null&&Na(Ti)&&(Ti=null),Ai!==null&&Na(Ai)&&(Ai=null),es.forEach(xh),ts.forEach(xh)}function is(n,i){n.blockedOn===i&&(n.blockedOn=null,Wu||(Wu=!0,t.unstable_scheduleCallback(t.unstable_NormalPriority,KS)))}function rs(n){function i(h){return is(h,n)}if(0<Pa.length){is(Pa[0],n);for(var a=1;a<Pa.length;a++){var c=Pa[a];c.blockedOn===n&&(c.blockedOn=null)}}for(yi!==null&&is(yi,n),Ti!==null&&is(Ti,n),Ai!==null&&is(Ai,n),es.forEach(i),ts.forEach(i),a=0;a<Ii.length;a++)c=Ii[a],c.blockedOn===n&&(c.blockedOn=null);for(;0<Ii.length&&(a=Ii[0],a.blockedOn===null);)Gh(a),a.blockedOn===null&&Ii.shift()}var $r=H.ReactCurrentBatchConfig,Da=!0;function ZS(n,i,a,c){var h=We,p=$r.transition;$r.transition=null;try{We=1,Yu(n,i,a,c)}finally{We=h,$r.transition=p}}function qS(n,i,a,c){var h=We,p=$r.transition;$r.transition=null;try{We=4,Yu(n,i,a,c)}finally{We=h,$r.transition=p}}function Yu(n,i,a,c){if(Da){var h=ju(n,i,a,c);if(h===null)uc(n,i,c,Oa,a),bh(n,c);else if(XS(h,n,i,a,c))c.stopPropagation();else if(bh(n,c),i&4&&-1<VS.indexOf(n)){for(;h!==null;){var p=ms(h);if(p!==null&&Uh(p),p=ju(n,i,a,c),p===null&&uc(n,i,c,Oa,a),p===h)break;h=p}h!==null&&c.stopPropagation()}else uc(n,i,c,null,a)}}var Oa=null;function ju(n,i,a,c){if(Oa=null,n=Fu(c),n=or(n),n!==null)if(i=rr(n),i===null)n=null;else if(a=i.tag,a===13){if(n=_h(i),n!==null)return n;n=null}else if(a===3){if(i.stateNode.current.memoizedState.isDehydrated)return i.tag===3?i.stateNode.containerInfo:null;n=null}else i!==n&&(n=null);return Oa=n,null}function $h(n){switch(n){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(HS()){case bu:return 1;case Oh:return 4;case Ea:case bS:return 16;case Mh:return 536870912;default:return 16}default:return 16}}var Ei=null,Vu=null,Ma=null;function zh(){if(Ma)return Ma;var n,i=Vu,a=i.length,c,h="value"in Ei?Ei.value:Ei.textContent,p=h.length;for(n=0;n<a&&i[n]===h[n];n++);var v=a-n;for(c=1;c<=v&&i[a-c]===h[p-c];c++);return Ma=h.slice(n,1<c?1-c:void 0)}function ka(n){var i=n.keyCode;return"charCode"in n?(n=n.charCode,n===0&&i===13&&(n=13)):n=i,n===10&&(n=13),32<=n||n===13?n:0}function Fa(){return!0}function Wh(){return!1}function Jt(n){function i(a,c,h,p,v){this._reactName=a,this._targetInst=h,this.type=c,this.nativeEvent=p,this.target=v,this.currentTarget=null;for(var w in n)n.hasOwnProperty(w)&&(a=n[w],this[w]=a?a(p):p[w]);return this.isDefaultPrevented=(p.defaultPrevented!=null?p.defaultPrevented:p.returnValue===!1)?Fa:Wh,this.isPropagationStopped=Wh,this}return Y(i.prototype,{preventDefault:function(){this.defaultPrevented=!0;var a=this.nativeEvent;a&&(a.preventDefault?a.preventDefault():typeof a.returnValue!="unknown"&&(a.returnValue=!1),this.isDefaultPrevented=Fa)},stopPropagation:function(){var a=this.nativeEvent;a&&(a.stopPropagation?a.stopPropagation():typeof a.cancelBubble!="unknown"&&(a.cancelBubble=!0),this.isPropagationStopped=Fa)},persist:function(){},isPersistent:Fa}),i}var zr={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(n){return n.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Xu=Jt(zr),os=Y({},zr,{view:0,detail:0}),QS=Jt(os),Ku,Zu,ss,Ua=Y({},os,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Qu,button:0,buttons:0,relatedTarget:function(n){return n.relatedTarget===void 0?n.fromElement===n.srcElement?n.toElement:n.fromElement:n.relatedTarget},movementX:function(n){return"movementX"in n?n.movementX:(n!==ss&&(ss&&n.type==="mousemove"?(Ku=n.screenX-ss.screenX,Zu=n.screenY-ss.screenY):Zu=Ku=0,ss=n),Ku)},movementY:function(n){return"movementY"in n?n.movementY:Zu}}),Yh=Jt(Ua),JS=Y({},Ua,{dataTransfer:0}),ey=Jt(JS),ty=Y({},os,{relatedTarget:0}),qu=Jt(ty),ny=Y({},zr,{animationName:0,elapsedTime:0,pseudoElement:0}),iy=Jt(ny),ry=Y({},zr,{clipboardData:function(n){return"clipboardData"in n?n.clipboardData:window.clipboardData}}),oy=Jt(ry),sy=Y({},zr,{data:0}),jh=Jt(sy),ay={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},ly={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},uy={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function cy(n){var i=this.nativeEvent;return i.getModifierState?i.getModifierState(n):(n=uy[n])?!!i[n]:!1}function Qu(){return cy}var dy=Y({},os,{key:function(n){if(n.key){var i=ay[n.key]||n.key;if(i!=="Unidentified")return i}return n.type==="keypress"?(n=ka(n),n===13?"Enter":String.fromCharCode(n)):n.type==="keydown"||n.type==="keyup"?ly[n.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Qu,charCode:function(n){return n.type==="keypress"?ka(n):0},keyCode:function(n){return n.type==="keydown"||n.type==="keyup"?n.keyCode:0},which:function(n){return n.type==="keypress"?ka(n):n.type==="keydown"||n.type==="keyup"?n.keyCode:0}}),fy=Jt(dy),hy=Y({},Ua,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Vh=Jt(hy),gy=Y({},os,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Qu}),py=Jt(gy),my=Y({},zr,{propertyName:0,elapsedTime:0,pseudoElement:0}),vy=Jt(my),Sy=Y({},Ua,{deltaX:function(n){return"deltaX"in n?n.deltaX:"wheelDeltaX"in n?-n.wheelDeltaX:0},deltaY:function(n){return"deltaY"in n?n.deltaY:"wheelDeltaY"in n?-n.wheelDeltaY:"wheelDelta"in n?-n.wheelDelta:0},deltaZ:0,deltaMode:0}),yy=Jt(Sy),Ty=[9,13,27,32],Ju=d&&"CompositionEvent"in window,as=null;d&&"documentMode"in document&&(as=document.documentMode);var Ay=d&&"TextEvent"in window&&!as,Xh=d&&(!Ju||as&&8<as&&11>=as),Kh=" ",Zh=!1;function qh(n,i){switch(n){case"keyup":return Ty.indexOf(i.keyCode)!==-1;case"keydown":return i.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Qh(n){return n=n.detail,typeof n=="object"&&"data"in n?n.data:null}var Wr=!1;function Iy(n,i){switch(n){case"compositionend":return Qh(i);case"keypress":return i.which!==32?null:(Zh=!0,Kh);case"textInput":return n=i.data,n===Kh&&Zh?null:n;default:return null}}function Ey(n,i){if(Wr)return n==="compositionend"||!Ju&&qh(n,i)?(n=zh(),Ma=Vu=Ei=null,Wr=!1,n):null;switch(n){case"paste":return null;case"keypress":if(!(i.ctrlKey||i.altKey||i.metaKey)||i.ctrlKey&&i.altKey){if(i.char&&1<i.char.length)return i.char;if(i.which)return String.fromCharCode(i.which)}return null;case"compositionend":return Xh&&i.locale!=="ko"?null:i.data;default:return null}}var wy={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Jh(n){var i=n&&n.nodeName&&n.nodeName.toLowerCase();return i==="input"?!!wy[n.type]:i==="textarea"}function eg(n,i,a,c){Th(c),i=Ga(i,"onChange"),0<i.length&&(a=new Xu("onChange","change",null,a,c),n.push({event:a,listeners:i}))}var ls=null,us=null;function _y(n){Sg(n,0)}function La(n){var i=Kr(n);if(he(i))return n}function Cy(n,i){if(n==="change")return i}var tg=!1;if(d){var ec;if(d){var tc="oninput"in document;if(!tc){var ng=document.createElement("div");ng.setAttribute("oninput","return;"),tc=typeof ng.oninput=="function"}ec=tc}else ec=!1;tg=ec&&(!document.documentMode||9<document.documentMode)}function ig(){ls&&(ls.detachEvent("onpropertychange",rg),us=ls=null)}function rg(n){if(n.propertyName==="value"&&La(us)){var i=[];eg(i,us,n,Fu(n)),wh(_y,i)}}function Ry(n,i,a){n==="focusin"?(ig(),ls=i,us=a,ls.attachEvent("onpropertychange",rg)):n==="focusout"&&ig()}function Py(n){if(n==="selectionchange"||n==="keyup"||n==="keydown")return La(us)}function Ny(n,i){if(n==="click")return La(i)}function Dy(n,i){if(n==="input"||n==="change")return La(i)}function Oy(n,i){return n===i&&(n!==0||1/n===1/i)||n!==n&&i!==i}var _n=typeof Object.is=="function"?Object.is:Oy;function cs(n,i){if(_n(n,i))return!0;if(typeof n!="object"||n===null||typeof i!="object"||i===null)return!1;var a=Object.keys(n),c=Object.keys(i);if(a.length!==c.length)return!1;for(c=0;c<a.length;c++){var h=a[c];if(!f.call(i,h)||!_n(n[h],i[h]))return!1}return!0}function og(n){for(;n&&n.firstChild;)n=n.firstChild;return n}function sg(n,i){var a=og(n);n=0;for(var c;a;){if(a.nodeType===3){if(c=n+a.textContent.length,n<=i&&c>=i)return{node:a,offset:i-n};n=c}e:{for(;a;){if(a.nextSibling){a=a.nextSibling;break e}a=a.parentNode}a=void 0}a=og(a)}}function ag(n,i){return n&&i?n===i?!0:n&&n.nodeType===3?!1:i&&i.nodeType===3?ag(n,i.parentNode):"contains"in n?n.contains(i):n.compareDocumentPosition?!!(n.compareDocumentPosition(i)&16):!1:!1}function lg(){for(var n=window,i=bn();i instanceof n.HTMLIFrameElement;){try{var a=typeof i.contentWindow.location.href=="string"}catch{a=!1}if(a)n=i.contentWindow;else break;i=bn(n.document)}return i}function nc(n){var i=n&&n.nodeName&&n.nodeName.toLowerCase();return i&&(i==="input"&&(n.type==="text"||n.type==="search"||n.type==="tel"||n.type==="url"||n.type==="password")||i==="textarea"||n.contentEditable==="true")}function My(n){var i=lg(),a=n.focusedElem,c=n.selectionRange;if(i!==a&&a&&a.ownerDocument&&ag(a.ownerDocument.documentElement,a)){if(c!==null&&nc(a)){if(i=c.start,n=c.end,n===void 0&&(n=i),"selectionStart"in a)a.selectionStart=i,a.selectionEnd=Math.min(n,a.value.length);else if(n=(i=a.ownerDocument||document)&&i.defaultView||window,n.getSelection){n=n.getSelection();var h=a.textContent.length,p=Math.min(c.start,h);c=c.end===void 0?p:Math.min(c.end,h),!n.extend&&p>c&&(h=c,c=p,p=h),h=sg(a,p);var v=sg(a,c);h&&v&&(n.rangeCount!==1||n.anchorNode!==h.node||n.anchorOffset!==h.offset||n.focusNode!==v.node||n.focusOffset!==v.offset)&&(i=i.createRange(),i.setStart(h.node,h.offset),n.removeAllRanges(),p>c?(n.addRange(i),n.extend(v.node,v.offset)):(i.setEnd(v.node,v.offset),n.addRange(i)))}}for(i=[],n=a;n=n.parentNode;)n.nodeType===1&&i.push({element:n,left:n.scrollLeft,top:n.scrollTop});for(typeof a.focus=="function"&&a.focus(),a=0;a<i.length;a++)n=i[a],n.element.scrollLeft=n.left,n.element.scrollTop=n.top}}var ky=d&&"documentMode"in document&&11>=document.documentMode,Yr=null,ic=null,ds=null,rc=!1;function ug(n,i,a){var c=a.window===a?a.document:a.nodeType===9?a:a.ownerDocument;rc||Yr==null||Yr!==bn(c)||(c=Yr,"selectionStart"in c&&nc(c)?c={start:c.selectionStart,end:c.selectionEnd}:(c=(c.ownerDocument&&c.ownerDocument.defaultView||window).getSelection(),c={anchorNode:c.anchorNode,anchorOffset:c.anchorOffset,focusNode:c.focusNode,focusOffset:c.focusOffset}),ds&&cs(ds,c)||(ds=c,c=Ga(ic,"onSelect"),0<c.length&&(i=new Xu("onSelect","select",null,i,a),n.push({event:i,listeners:c}),i.target=Yr)))}function Ba(n,i){var a={};return a[n.toLowerCase()]=i.toLowerCase(),a["Webkit"+n]="webkit"+i,a["Moz"+n]="moz"+i,a}var jr={animationend:Ba("Animation","AnimationEnd"),animationiteration:Ba("Animation","AnimationIteration"),animationstart:Ba("Animation","AnimationStart"),transitionend:Ba("Transition","TransitionEnd")},oc={},cg={};d&&(cg=document.createElement("div").style,"AnimationEvent"in window||(delete jr.animationend.animation,delete jr.animationiteration.animation,delete jr.animationstart.animation),"TransitionEvent"in window||delete jr.transitionend.transition);function Ha(n){if(oc[n])return oc[n];if(!jr[n])return n;var i=jr[n],a;for(a in i)if(i.hasOwnProperty(a)&&a in cg)return oc[n]=i[a];return n}var dg=Ha("animationend"),fg=Ha("animationiteration"),hg=Ha("animationstart"),gg=Ha("transitionend"),pg=new Map,mg="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function wi(n,i){pg.set(n,i),s(i,[n])}for(var sc=0;sc<mg.length;sc++){var ac=mg[sc],Fy=ac.toLowerCase(),Uy=ac[0].toUpperCase()+ac.slice(1);wi(Fy,"on"+Uy)}wi(dg,"onAnimationEnd"),wi(fg,"onAnimationIteration"),wi(hg,"onAnimationStart"),wi("dblclick","onDoubleClick"),wi("focusin","onFocus"),wi("focusout","onBlur"),wi(gg,"onTransitionEnd"),u("onMouseEnter",["mouseout","mouseover"]),u("onMouseLeave",["mouseout","mouseover"]),u("onPointerEnter",["pointerout","pointerover"]),u("onPointerLeave",["pointerout","pointerover"]),s("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),s("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),s("onBeforeInput",["compositionend","keypress","textInput","paste"]),s("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),s("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),s("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var fs="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Ly=new Set("cancel close invalid load scroll toggle".split(" ").concat(fs));function vg(n,i,a){var c=n.type||"unknown-event";n.currentTarget=a,FS(c,i,void 0,n),n.currentTarget=null}function Sg(n,i){i=(i&4)!==0;for(var a=0;a<n.length;a++){var c=n[a],h=c.event;c=c.listeners;e:{var p=void 0;if(i)for(var v=c.length-1;0<=v;v--){var w=c[v],R=w.instance,k=w.currentTarget;if(w=w.listener,R!==p&&h.isPropagationStopped())break e;vg(h,w,k),p=R}else for(v=0;v<c.length;v++){if(w=c[v],R=w.instance,k=w.currentTarget,w=w.listener,R!==p&&h.isPropagationStopped())break e;vg(h,w,k),p=R}}}if(Ia)throw n=Hu,Ia=!1,Hu=null,n}function Ve(n,i){var a=i[pc];a===void 0&&(a=i[pc]=new Set);var c=n+"__bubble";a.has(c)||(yg(i,n,2,!1),a.add(c))}function lc(n,i,a){var c=0;i&&(c|=4),yg(a,n,c,i)}var ba="_reactListening"+Math.random().toString(36).slice(2);function hs(n){if(!n[ba]){n[ba]=!0,o.forEach(function(a){a!=="selectionchange"&&(Ly.has(a)||lc(a,!1,n),lc(a,!0,n))});var i=n.nodeType===9?n:n.ownerDocument;i===null||i[ba]||(i[ba]=!0,lc("selectionchange",!1,i))}}function yg(n,i,a,c){switch($h(i)){case 1:var h=ZS;break;case 4:h=qS;break;default:h=Yu}a=h.bind(null,i,a,n),h=void 0,!Bu||i!=="touchstart"&&i!=="touchmove"&&i!=="wheel"||(h=!0),c?h!==void 0?n.addEventListener(i,a,{capture:!0,passive:h}):n.addEventListener(i,a,!0):h!==void 0?n.addEventListener(i,a,{passive:h}):n.addEventListener(i,a,!1)}function uc(n,i,a,c,h){var p=c;if((i&1)===0&&(i&2)===0&&c!==null)e:for(;;){if(c===null)return;var v=c.tag;if(v===3||v===4){var w=c.stateNode.containerInfo;if(w===h||w.nodeType===8&&w.parentNode===h)break;if(v===4)for(v=c.return;v!==null;){var R=v.tag;if((R===3||R===4)&&(R=v.stateNode.containerInfo,R===h||R.nodeType===8&&R.parentNode===h))return;v=v.return}for(;w!==null;){if(v=or(w),v===null)return;if(R=v.tag,R===5||R===6){c=p=v;continue e}w=w.parentNode}}c=c.return}wh(function(){var k=p,G=Fu(a),z=[];e:{var b=pg.get(n);if(b!==void 0){var q=Xu,te=n;switch(n){case"keypress":if(ka(a)===0)break e;case"keydown":case"keyup":q=fy;break;case"focusin":te="focus",q=qu;break;case"focusout":te="blur",q=qu;break;case"beforeblur":case"afterblur":q=qu;break;case"click":if(a.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":q=Yh;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":q=ey;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":q=py;break;case dg:case fg:case hg:q=iy;break;case gg:q=vy;break;case"scroll":q=QS;break;case"wheel":q=yy;break;case"copy":case"cut":case"paste":q=oy;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":q=Vh}var oe=(i&4)!==0,lt=!oe&&n==="scroll",O=oe?b!==null?b+"Capture":null:b;oe=[];for(var N=k,M;N!==null;){M=N;var j=M.stateNode;if(M.tag===5&&j!==null&&(M=j,O!==null&&(j=Ko(N,O),j!=null&&oe.push(gs(N,j,M)))),lt)break;N=N.return}0<oe.length&&(b=new q(b,te,null,a,G),z.push({event:b,listeners:oe}))}}if((i&7)===0){e:{if(b=n==="mouseover"||n==="pointerover",q=n==="mouseout"||n==="pointerout",b&&a!==ku&&(te=a.relatedTarget||a.fromElement)&&(or(te)||te[ei]))break e;if((q||b)&&(b=G.window===G?G:(b=G.ownerDocument)?b.defaultView||b.parentWindow:window,q?(te=a.relatedTarget||a.toElement,q=k,te=te?or(te):null,te!==null&&(lt=rr(te),te!==lt||te.tag!==5&&te.tag!==6)&&(te=null)):(q=null,te=k),q!==te)){if(oe=Yh,j="onMouseLeave",O="onMouseEnter",N="mouse",(n==="pointerout"||n==="pointerover")&&(oe=Vh,j="onPointerLeave",O="onPointerEnter",N="pointer"),lt=q==null?b:Kr(q),M=te==null?b:Kr(te),b=new oe(j,N+"leave",q,a,G),b.target=lt,b.relatedTarget=M,j=null,or(G)===k&&(oe=new oe(O,N+"enter",te,a,G),oe.target=M,oe.relatedTarget=lt,j=oe),lt=j,q&&te)t:{for(oe=q,O=te,N=0,M=oe;M;M=Vr(M))N++;for(M=0,j=O;j;j=Vr(j))M++;for(;0<N-M;)oe=Vr(oe),N--;for(;0<M-N;)O=Vr(O),M--;for(;N--;){if(oe===O||O!==null&&oe===O.alternate)break t;oe=Vr(oe),O=Vr(O)}oe=null}else oe=null;q!==null&&Tg(z,b,q,oe,!1),te!==null&&lt!==null&&Tg(z,lt,te,oe,!0)}}e:{if(b=k?Kr(k):window,q=b.nodeName&&b.nodeName.toLowerCase(),q==="select"||q==="input"&&b.type==="file")var le=Cy;else if(Jh(b))if(tg)le=Dy;else{le=Py;var pe=Ry}else(q=b.nodeName)&&q.toLowerCase()==="input"&&(b.type==="checkbox"||b.type==="radio")&&(le=Ny);if(le&&(le=le(n,k))){eg(z,le,a,G);break e}pe&&pe(n,b,k),n==="focusout"&&(pe=b._wrapperState)&&pe.controlled&&b.type==="number"&&xn(b,"number",b.value)}switch(pe=k?Kr(k):window,n){case"focusin":(Jh(pe)||pe.contentEditable==="true")&&(Yr=pe,ic=k,ds=null);break;case"focusout":ds=ic=Yr=null;break;case"mousedown":rc=!0;break;case"contextmenu":case"mouseup":case"dragend":rc=!1,ug(z,a,G);break;case"selectionchange":if(ky)break;case"keydown":case"keyup":ug(z,a,G)}var me;if(Ju)e:{switch(n){case"compositionstart":var we="onCompositionStart";break e;case"compositionend":we="onCompositionEnd";break e;case"compositionupdate":we="onCompositionUpdate";break e}we=void 0}else Wr?qh(n,a)&&(we="onCompositionEnd"):n==="keydown"&&a.keyCode===229&&(we="onCompositionStart");we&&(Xh&&a.locale!=="ko"&&(Wr||we!=="onCompositionStart"?we==="onCompositionEnd"&&Wr&&(me=zh()):(Ei=G,Vu="value"in Ei?Ei.value:Ei.textContent,Wr=!0)),pe=Ga(k,we),0<pe.length&&(we=new jh(we,n,null,a,G),z.push({event:we,listeners:pe}),me?we.data=me:(me=Qh(a),me!==null&&(we.data=me)))),(me=Ay?Iy(n,a):Ey(n,a))&&(k=Ga(k,"onBeforeInput"),0<k.length&&(G=new jh("onBeforeInput","beforeinput",null,a,G),z.push({event:G,listeners:k}),G.data=me))}Sg(z,i)})}function gs(n,i,a){return{instance:n,listener:i,currentTarget:a}}function Ga(n,i){for(var a=i+"Capture",c=[];n!==null;){var h=n,p=h.stateNode;h.tag===5&&p!==null&&(h=p,p=Ko(n,a),p!=null&&c.unshift(gs(n,p,h)),p=Ko(n,i),p!=null&&c.push(gs(n,p,h))),n=n.return}return c}function Vr(n){if(n===null)return null;do n=n.return;while(n&&n.tag!==5);return n||null}function Tg(n,i,a,c,h){for(var p=i._reactName,v=[];a!==null&&a!==c;){var w=a,R=w.alternate,k=w.stateNode;if(R!==null&&R===c)break;w.tag===5&&k!==null&&(w=k,h?(R=Ko(a,p),R!=null&&v.unshift(gs(a,R,w))):h||(R=Ko(a,p),R!=null&&v.push(gs(a,R,w)))),a=a.return}v.length!==0&&n.push({event:i,listeners:v})}var By=/\r\n?/g,Hy=/\u0000|\uFFFD/g;function Ag(n){return(typeof n=="string"?n:""+n).replace(By,`
`).replace(Hy,"")}function xa(n,i,a){if(i=Ag(i),Ag(n)!==i&&a)throw Error(r(425))}function $a(){}var cc=null,dc=null;function fc(n,i){return n==="textarea"||n==="noscript"||typeof i.children=="string"||typeof i.children=="number"||typeof i.dangerouslySetInnerHTML=="object"&&i.dangerouslySetInnerHTML!==null&&i.dangerouslySetInnerHTML.__html!=null}var hc=typeof setTimeout=="function"?setTimeout:void 0,by=typeof clearTimeout=="function"?clearTimeout:void 0,Ig=typeof Promise=="function"?Promise:void 0,Gy=typeof queueMicrotask=="function"?queueMicrotask:typeof Ig<"u"?function(n){return Ig.resolve(null).then(n).catch(xy)}:hc;function xy(n){setTimeout(function(){throw n})}function gc(n,i){var a=i,c=0;do{var h=a.nextSibling;if(n.removeChild(a),h&&h.nodeType===8)if(a=h.data,a==="/$"){if(c===0){n.removeChild(h),rs(i);return}c--}else a!=="$"&&a!=="$?"&&a!=="$!"||c++;a=h}while(a);rs(i)}function _i(n){for(;n!=null;n=n.nextSibling){var i=n.nodeType;if(i===1||i===3)break;if(i===8){if(i=n.data,i==="$"||i==="$!"||i==="$?")break;if(i==="/$")return null}}return n}function Eg(n){n=n.previousSibling;for(var i=0;n;){if(n.nodeType===8){var a=n.data;if(a==="$"||a==="$!"||a==="$?"){if(i===0)return n;i--}else a==="/$"&&i++}n=n.previousSibling}return null}var Xr=Math.random().toString(36).slice(2),Wn="__reactFiber$"+Xr,ps="__reactProps$"+Xr,ei="__reactContainer$"+Xr,pc="__reactEvents$"+Xr,$y="__reactListeners$"+Xr,zy="__reactHandles$"+Xr;function or(n){var i=n[Wn];if(i)return i;for(var a=n.parentNode;a;){if(i=a[ei]||a[Wn]){if(a=i.alternate,i.child!==null||a!==null&&a.child!==null)for(n=Eg(n);n!==null;){if(a=n[Wn])return a;n=Eg(n)}return i}n=a,a=n.parentNode}return null}function ms(n){return n=n[Wn]||n[ei],!n||n.tag!==5&&n.tag!==6&&n.tag!==13&&n.tag!==3?null:n}function Kr(n){if(n.tag===5||n.tag===6)return n.stateNode;throw Error(r(33))}function za(n){return n[ps]||null}var mc=[],Zr=-1;function Ci(n){return{current:n}}function Xe(n){0>Zr||(n.current=mc[Zr],mc[Zr]=null,Zr--)}function Ye(n,i){Zr++,mc[Zr]=n.current,n.current=i}var Ri={},Nt=Ci(Ri),Yt=Ci(!1),sr=Ri;function qr(n,i){var a=n.type.contextTypes;if(!a)return Ri;var c=n.stateNode;if(c&&c.__reactInternalMemoizedUnmaskedChildContext===i)return c.__reactInternalMemoizedMaskedChildContext;var h={},p;for(p in a)h[p]=i[p];return c&&(n=n.stateNode,n.__reactInternalMemoizedUnmaskedChildContext=i,n.__reactInternalMemoizedMaskedChildContext=h),h}function jt(n){return n=n.childContextTypes,n!=null}function Wa(){Xe(Yt),Xe(Nt)}function wg(n,i,a){if(Nt.current!==Ri)throw Error(r(168));Ye(Nt,i),Ye(Yt,a)}function _g(n,i,a){var c=n.stateNode;if(i=i.childContextTypes,typeof c.getChildContext!="function")return a;c=c.getChildContext();for(var h in c)if(!(h in i))throw Error(r(108,Ee(n)||"Unknown",h));return Y({},a,c)}function Ya(n){return n=(n=n.stateNode)&&n.__reactInternalMemoizedMergedChildContext||Ri,sr=Nt.current,Ye(Nt,n),Ye(Yt,Yt.current),!0}function Cg(n,i,a){var c=n.stateNode;if(!c)throw Error(r(169));a?(n=_g(n,i,sr),c.__reactInternalMemoizedMergedChildContext=n,Xe(Yt),Xe(Nt),Ye(Nt,n)):Xe(Yt),Ye(Yt,a)}var ti=null,ja=!1,vc=!1;function Rg(n){ti===null?ti=[n]:ti.push(n)}function Wy(n){ja=!0,Rg(n)}function Pi(){if(!vc&&ti!==null){vc=!0;var n=0,i=We;try{var a=ti;for(We=1;n<a.length;n++){var c=a[n];do c=c(!0);while(c!==null)}ti=null,ja=!1}catch(h){throw ti!==null&&(ti=ti.slice(n+1)),Nh(bu,Pi),h}finally{We=i,vc=!1}}return null}var Qr=[],Jr=0,Va=null,Xa=0,cn=[],dn=0,ar=null,ni=1,ii="";function lr(n,i){Qr[Jr++]=Xa,Qr[Jr++]=Va,Va=n,Xa=i}function Pg(n,i,a){cn[dn++]=ni,cn[dn++]=ii,cn[dn++]=ar,ar=n;var c=ni;n=ii;var h=32-wn(c)-1;c&=~(1<<h),a+=1;var p=32-wn(i)+h;if(30<p){var v=h-h%5;p=(c&(1<<v)-1).toString(32),c>>=v,h-=v,ni=1<<32-wn(i)+h|a<<h|c,ii=p+n}else ni=1<<p|a<<h|c,ii=n}function Sc(n){n.return!==null&&(lr(n,1),Pg(n,1,0))}function yc(n){for(;n===Va;)Va=Qr[--Jr],Qr[Jr]=null,Xa=Qr[--Jr],Qr[Jr]=null;for(;n===ar;)ar=cn[--dn],cn[dn]=null,ii=cn[--dn],cn[dn]=null,ni=cn[--dn],cn[dn]=null}var en=null,tn=null,Qe=!1,Cn=null;function Ng(n,i){var a=pn(5,null,null,0);a.elementType="DELETED",a.stateNode=i,a.return=n,i=n.deletions,i===null?(n.deletions=[a],n.flags|=16):i.push(a)}function Dg(n,i){switch(n.tag){case 5:var a=n.type;return i=i.nodeType!==1||a.toLowerCase()!==i.nodeName.toLowerCase()?null:i,i!==null?(n.stateNode=i,en=n,tn=_i(i.firstChild),!0):!1;case 6:return i=n.pendingProps===""||i.nodeType!==3?null:i,i!==null?(n.stateNode=i,en=n,tn=null,!0):!1;case 13:return i=i.nodeType!==8?null:i,i!==null?(a=ar!==null?{id:ni,overflow:ii}:null,n.memoizedState={dehydrated:i,treeContext:a,retryLane:1073741824},a=pn(18,null,null,0),a.stateNode=i,a.return=n,n.child=a,en=n,tn=null,!0):!1;default:return!1}}function Tc(n){return(n.mode&1)!==0&&(n.flags&128)===0}function Ac(n){if(Qe){var i=tn;if(i){var a=i;if(!Dg(n,i)){if(Tc(n))throw Error(r(418));i=_i(a.nextSibling);var c=en;i&&Dg(n,i)?Ng(c,a):(n.flags=n.flags&-4097|2,Qe=!1,en=n)}}else{if(Tc(n))throw Error(r(418));n.flags=n.flags&-4097|2,Qe=!1,en=n}}}function Og(n){for(n=n.return;n!==null&&n.tag!==5&&n.tag!==3&&n.tag!==13;)n=n.return;en=n}function Ka(n){if(n!==en)return!1;if(!Qe)return Og(n),Qe=!0,!1;var i;if((i=n.tag!==3)&&!(i=n.tag!==5)&&(i=n.type,i=i!=="head"&&i!=="body"&&!fc(n.type,n.memoizedProps)),i&&(i=tn)){if(Tc(n))throw Mg(),Error(r(418));for(;i;)Ng(n,i),i=_i(i.nextSibling)}if(Og(n),n.tag===13){if(n=n.memoizedState,n=n!==null?n.dehydrated:null,!n)throw Error(r(317));e:{for(n=n.nextSibling,i=0;n;){if(n.nodeType===8){var a=n.data;if(a==="/$"){if(i===0){tn=_i(n.nextSibling);break e}i--}else a!=="$"&&a!=="$!"&&a!=="$?"||i++}n=n.nextSibling}tn=null}}else tn=en?_i(n.stateNode.nextSibling):null;return!0}function Mg(){for(var n=tn;n;)n=_i(n.nextSibling)}function eo(){tn=en=null,Qe=!1}function Ic(n){Cn===null?Cn=[n]:Cn.push(n)}var Yy=H.ReactCurrentBatchConfig;function vs(n,i,a){if(n=a.ref,n!==null&&typeof n!="function"&&typeof n!="object"){if(a._owner){if(a=a._owner,a){if(a.tag!==1)throw Error(r(309));var c=a.stateNode}if(!c)throw Error(r(147,n));var h=c,p=""+n;return i!==null&&i.ref!==null&&typeof i.ref=="function"&&i.ref._stringRef===p?i.ref:(i=function(v){var w=h.refs;v===null?delete w[p]:w[p]=v},i._stringRef=p,i)}if(typeof n!="string")throw Error(r(284));if(!a._owner)throw Error(r(290,n))}return n}function Za(n,i){throw n=Object.prototype.toString.call(i),Error(r(31,n==="[object Object]"?"object with keys {"+Object.keys(i).join(", ")+"}":n))}function kg(n){var i=n._init;return i(n._payload)}function Fg(n){function i(O,N){if(n){var M=O.deletions;M===null?(O.deletions=[N],O.flags|=16):M.push(N)}}function a(O,N){if(!n)return null;for(;N!==null;)i(O,N),N=N.sibling;return null}function c(O,N){for(O=new Map;N!==null;)N.key!==null?O.set(N.key,N):O.set(N.index,N),N=N.sibling;return O}function h(O,N){return O=Li(O,N),O.index=0,O.sibling=null,O}function p(O,N,M){return O.index=M,n?(M=O.alternate,M!==null?(M=M.index,M<N?(O.flags|=2,N):M):(O.flags|=2,N)):(O.flags|=1048576,N)}function v(O){return n&&O.alternate===null&&(O.flags|=2),O}function w(O,N,M,j){return N===null||N.tag!==6?(N=hd(M,O.mode,j),N.return=O,N):(N=h(N,M),N.return=O,N)}function R(O,N,M,j){var le=M.type;return le===$?G(O,N,M.props.children,j,M.key):N!==null&&(N.elementType===le||typeof le=="object"&&le!==null&&le.$$typeof===Te&&kg(le)===N.type)?(j=h(N,M.props),j.ref=vs(O,N,M),j.return=O,j):(j=Tl(M.type,M.key,M.props,null,O.mode,j),j.ref=vs(O,N,M),j.return=O,j)}function k(O,N,M,j){return N===null||N.tag!==4||N.stateNode.containerInfo!==M.containerInfo||N.stateNode.implementation!==M.implementation?(N=gd(M,O.mode,j),N.return=O,N):(N=h(N,M.children||[]),N.return=O,N)}function G(O,N,M,j,le){return N===null||N.tag!==7?(N=mr(M,O.mode,j,le),N.return=O,N):(N=h(N,M),N.return=O,N)}function z(O,N,M){if(typeof N=="string"&&N!==""||typeof N=="number")return N=hd(""+N,O.mode,M),N.return=O,N;if(typeof N=="object"&&N!==null){switch(N.$$typeof){case x:return M=Tl(N.type,N.key,N.props,null,O.mode,M),M.ref=vs(O,null,N),M.return=O,M;case U:return N=gd(N,O.mode,M),N.return=O,N;case Te:var j=N._init;return z(O,j(N._payload),M)}if($n(N)||X(N))return N=mr(N,O.mode,M,null),N.return=O,N;Za(O,N)}return null}function b(O,N,M,j){var le=N!==null?N.key:null;if(typeof M=="string"&&M!==""||typeof M=="number")return le!==null?null:w(O,N,""+M,j);if(typeof M=="object"&&M!==null){switch(M.$$typeof){case x:return M.key===le?R(O,N,M,j):null;case U:return M.key===le?k(O,N,M,j):null;case Te:return le=M._init,b(O,N,le(M._payload),j)}if($n(M)||X(M))return le!==null?null:G(O,N,M,j,null);Za(O,M)}return null}function q(O,N,M,j,le){if(typeof j=="string"&&j!==""||typeof j=="number")return O=O.get(M)||null,w(N,O,""+j,le);if(typeof j=="object"&&j!==null){switch(j.$$typeof){case x:return O=O.get(j.key===null?M:j.key)||null,R(N,O,j,le);case U:return O=O.get(j.key===null?M:j.key)||null,k(N,O,j,le);case Te:var pe=j._init;return q(O,N,M,pe(j._payload),le)}if($n(j)||X(j))return O=O.get(M)||null,G(N,O,j,le,null);Za(N,j)}return null}function te(O,N,M,j){for(var le=null,pe=null,me=N,we=N=0,vt=null;me!==null&&we<M.length;we++){me.index>we?(vt=me,me=null):vt=me.sibling;var Ge=b(O,me,M[we],j);if(Ge===null){me===null&&(me=vt);break}n&&me&&Ge.alternate===null&&i(O,me),N=p(Ge,N,we),pe===null?le=Ge:pe.sibling=Ge,pe=Ge,me=vt}if(we===M.length)return a(O,me),Qe&&lr(O,we),le;if(me===null){for(;we<M.length;we++)me=z(O,M[we],j),me!==null&&(N=p(me,N,we),pe===null?le=me:pe.sibling=me,pe=me);return Qe&&lr(O,we),le}for(me=c(O,me);we<M.length;we++)vt=q(me,O,we,M[we],j),vt!==null&&(n&&vt.alternate!==null&&me.delete(vt.key===null?we:vt.key),N=p(vt,N,we),pe===null?le=vt:pe.sibling=vt,pe=vt);return n&&me.forEach(function(Bi){return i(O,Bi)}),Qe&&lr(O,we),le}function oe(O,N,M,j){var le=X(M);if(typeof le!="function")throw Error(r(150));if(M=le.call(M),M==null)throw Error(r(151));for(var pe=le=null,me=N,we=N=0,vt=null,Ge=M.next();me!==null&&!Ge.done;we++,Ge=M.next()){me.index>we?(vt=me,me=null):vt=me.sibling;var Bi=b(O,me,Ge.value,j);if(Bi===null){me===null&&(me=vt);break}n&&me&&Bi.alternate===null&&i(O,me),N=p(Bi,N,we),pe===null?le=Bi:pe.sibling=Bi,pe=Bi,me=vt}if(Ge.done)return a(O,me),Qe&&lr(O,we),le;if(me===null){for(;!Ge.done;we++,Ge=M.next())Ge=z(O,Ge.value,j),Ge!==null&&(N=p(Ge,N,we),pe===null?le=Ge:pe.sibling=Ge,pe=Ge);return Qe&&lr(O,we),le}for(me=c(O,me);!Ge.done;we++,Ge=M.next())Ge=q(me,O,we,Ge.value,j),Ge!==null&&(n&&Ge.alternate!==null&&me.delete(Ge.key===null?we:Ge.key),N=p(Ge,N,we),pe===null?le=Ge:pe.sibling=Ge,pe=Ge);return n&&me.forEach(function(wT){return i(O,wT)}),Qe&&lr(O,we),le}function lt(O,N,M,j){if(typeof M=="object"&&M!==null&&M.type===$&&M.key===null&&(M=M.props.children),typeof M=="object"&&M!==null){switch(M.$$typeof){case x:e:{for(var le=M.key,pe=N;pe!==null;){if(pe.key===le){if(le=M.type,le===$){if(pe.tag===7){a(O,pe.sibling),N=h(pe,M.props.children),N.return=O,O=N;break e}}else if(pe.elementType===le||typeof le=="object"&&le!==null&&le.$$typeof===Te&&kg(le)===pe.type){a(O,pe.sibling),N=h(pe,M.props),N.ref=vs(O,pe,M),N.return=O,O=N;break e}a(O,pe);break}else i(O,pe);pe=pe.sibling}M.type===$?(N=mr(M.props.children,O.mode,j,M.key),N.return=O,O=N):(j=Tl(M.type,M.key,M.props,null,O.mode,j),j.ref=vs(O,N,M),j.return=O,O=j)}return v(O);case U:e:{for(pe=M.key;N!==null;){if(N.key===pe)if(N.tag===4&&N.stateNode.containerInfo===M.containerInfo&&N.stateNode.implementation===M.implementation){a(O,N.sibling),N=h(N,M.children||[]),N.return=O,O=N;break e}else{a(O,N);break}else i(O,N);N=N.sibling}N=gd(M,O.mode,j),N.return=O,O=N}return v(O);case Te:return pe=M._init,lt(O,N,pe(M._payload),j)}if($n(M))return te(O,N,M,j);if(X(M))return oe(O,N,M,j);Za(O,M)}return typeof M=="string"&&M!==""||typeof M=="number"?(M=""+M,N!==null&&N.tag===6?(a(O,N.sibling),N=h(N,M),N.return=O,O=N):(a(O,N),N=hd(M,O.mode,j),N.return=O,O=N),v(O)):a(O,N)}return lt}var to=Fg(!0),Ug=Fg(!1),qa=Ci(null),Qa=null,no=null,Ec=null;function wc(){Ec=no=Qa=null}function _c(n){var i=qa.current;Xe(qa),n._currentValue=i}function Cc(n,i,a){for(;n!==null;){var c=n.alternate;if((n.childLanes&i)!==i?(n.childLanes|=i,c!==null&&(c.childLanes|=i)):c!==null&&(c.childLanes&i)!==i&&(c.childLanes|=i),n===a)break;n=n.return}}function io(n,i){Qa=n,Ec=no=null,n=n.dependencies,n!==null&&n.firstContext!==null&&((n.lanes&i)!==0&&(Vt=!0),n.firstContext=null)}function fn(n){var i=n._currentValue;if(Ec!==n)if(n={context:n,memoizedValue:i,next:null},no===null){if(Qa===null)throw Error(r(308));no=n,Qa.dependencies={lanes:0,firstContext:n}}else no=no.next=n;return i}var ur=null;function Rc(n){ur===null?ur=[n]:ur.push(n)}function Lg(n,i,a,c){var h=i.interleaved;return h===null?(a.next=a,Rc(i)):(a.next=h.next,h.next=a),i.interleaved=a,ri(n,c)}function ri(n,i){n.lanes|=i;var a=n.alternate;for(a!==null&&(a.lanes|=i),a=n,n=n.return;n!==null;)n.childLanes|=i,a=n.alternate,a!==null&&(a.childLanes|=i),a=n,n=n.return;return a.tag===3?a.stateNode:null}var Ni=!1;function Pc(n){n.updateQueue={baseState:n.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Bg(n,i){n=n.updateQueue,i.updateQueue===n&&(i.updateQueue={baseState:n.baseState,firstBaseUpdate:n.firstBaseUpdate,lastBaseUpdate:n.lastBaseUpdate,shared:n.shared,effects:n.effects})}function oi(n,i){return{eventTime:n,lane:i,tag:0,payload:null,callback:null,next:null}}function Di(n,i,a){var c=n.updateQueue;if(c===null)return null;if(c=c.shared,(He&2)!==0){var h=c.pending;return h===null?i.next=i:(i.next=h.next,h.next=i),c.pending=i,ri(n,a)}return h=c.interleaved,h===null?(i.next=i,Rc(c)):(i.next=h.next,h.next=i),c.interleaved=i,ri(n,a)}function Ja(n,i,a){if(i=i.updateQueue,i!==null&&(i=i.shared,(a&4194240)!==0)){var c=i.lanes;c&=n.pendingLanes,a|=c,i.lanes=a,$u(n,a)}}function Hg(n,i){var a=n.updateQueue,c=n.alternate;if(c!==null&&(c=c.updateQueue,a===c)){var h=null,p=null;if(a=a.firstBaseUpdate,a!==null){do{var v={eventTime:a.eventTime,lane:a.lane,tag:a.tag,payload:a.payload,callback:a.callback,next:null};p===null?h=p=v:p=p.next=v,a=a.next}while(a!==null);p===null?h=p=i:p=p.next=i}else h=p=i;a={baseState:c.baseState,firstBaseUpdate:h,lastBaseUpdate:p,shared:c.shared,effects:c.effects},n.updateQueue=a;return}n=a.lastBaseUpdate,n===null?a.firstBaseUpdate=i:n.next=i,a.lastBaseUpdate=i}function el(n,i,a,c){var h=n.updateQueue;Ni=!1;var p=h.firstBaseUpdate,v=h.lastBaseUpdate,w=h.shared.pending;if(w!==null){h.shared.pending=null;var R=w,k=R.next;R.next=null,v===null?p=k:v.next=k,v=R;var G=n.alternate;G!==null&&(G=G.updateQueue,w=G.lastBaseUpdate,w!==v&&(w===null?G.firstBaseUpdate=k:w.next=k,G.lastBaseUpdate=R))}if(p!==null){var z=h.baseState;v=0,G=k=R=null,w=p;do{var b=w.lane,q=w.eventTime;if((c&b)===b){G!==null&&(G=G.next={eventTime:q,lane:0,tag:w.tag,payload:w.payload,callback:w.callback,next:null});e:{var te=n,oe=w;switch(b=i,q=a,oe.tag){case 1:if(te=oe.payload,typeof te=="function"){z=te.call(q,z,b);break e}z=te;break e;case 3:te.flags=te.flags&-65537|128;case 0:if(te=oe.payload,b=typeof te=="function"?te.call(q,z,b):te,b==null)break e;z=Y({},z,b);break e;case 2:Ni=!0}}w.callback!==null&&w.lane!==0&&(n.flags|=64,b=h.effects,b===null?h.effects=[w]:b.push(w))}else q={eventTime:q,lane:b,tag:w.tag,payload:w.payload,callback:w.callback,next:null},G===null?(k=G=q,R=z):G=G.next=q,v|=b;if(w=w.next,w===null){if(w=h.shared.pending,w===null)break;b=w,w=b.next,b.next=null,h.lastBaseUpdate=b,h.shared.pending=null}}while(!0);if(G===null&&(R=z),h.baseState=R,h.firstBaseUpdate=k,h.lastBaseUpdate=G,i=h.shared.interleaved,i!==null){h=i;do v|=h.lane,h=h.next;while(h!==i)}else p===null&&(h.shared.lanes=0);fr|=v,n.lanes=v,n.memoizedState=z}}function bg(n,i,a){if(n=i.effects,i.effects=null,n!==null)for(i=0;i<n.length;i++){var c=n[i],h=c.callback;if(h!==null){if(c.callback=null,c=a,typeof h!="function")throw Error(r(191,h));h.call(c)}}}var Ss={},Yn=Ci(Ss),ys=Ci(Ss),Ts=Ci(Ss);function cr(n){if(n===Ss)throw Error(r(174));return n}function Nc(n,i){switch(Ye(Ts,i),Ye(ys,n),Ye(Yn,Ss),n=i.nodeType,n){case 9:case 11:i=(i=i.documentElement)?i.namespaceURI:Du(null,"");break;default:n=n===8?i.parentNode:i,i=n.namespaceURI||null,n=n.tagName,i=Du(i,n)}Xe(Yn),Ye(Yn,i)}function ro(){Xe(Yn),Xe(ys),Xe(Ts)}function Gg(n){cr(Ts.current);var i=cr(Yn.current),a=Du(i,n.type);i!==a&&(Ye(ys,n),Ye(Yn,a))}function Dc(n){ys.current===n&&(Xe(Yn),Xe(ys))}var it=Ci(0);function tl(n){for(var i=n;i!==null;){if(i.tag===13){var a=i.memoizedState;if(a!==null&&(a=a.dehydrated,a===null||a.data==="$?"||a.data==="$!"))return i}else if(i.tag===19&&i.memoizedProps.revealOrder!==void 0){if((i.flags&128)!==0)return i}else if(i.child!==null){i.child.return=i,i=i.child;continue}if(i===n)break;for(;i.sibling===null;){if(i.return===null||i.return===n)return null;i=i.return}i.sibling.return=i.return,i=i.sibling}return null}var Oc=[];function Mc(){for(var n=0;n<Oc.length;n++)Oc[n]._workInProgressVersionPrimary=null;Oc.length=0}var nl=H.ReactCurrentDispatcher,kc=H.ReactCurrentBatchConfig,dr=0,rt=null,ht=null,pt=null,il=!1,As=!1,Is=0,jy=0;function Dt(){throw Error(r(321))}function Fc(n,i){if(i===null)return!1;for(var a=0;a<i.length&&a<n.length;a++)if(!_n(n[a],i[a]))return!1;return!0}function Uc(n,i,a,c,h,p){if(dr=p,rt=i,i.memoizedState=null,i.updateQueue=null,i.lanes=0,nl.current=n===null||n.memoizedState===null?Zy:qy,n=a(c,h),As){p=0;do{if(As=!1,Is=0,25<=p)throw Error(r(301));p+=1,pt=ht=null,i.updateQueue=null,nl.current=Qy,n=a(c,h)}while(As)}if(nl.current=sl,i=ht!==null&&ht.next!==null,dr=0,pt=ht=rt=null,il=!1,i)throw Error(r(300));return n}function Lc(){var n=Is!==0;return Is=0,n}function jn(){var n={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return pt===null?rt.memoizedState=pt=n:pt=pt.next=n,pt}function hn(){if(ht===null){var n=rt.alternate;n=n!==null?n.memoizedState:null}else n=ht.next;var i=pt===null?rt.memoizedState:pt.next;if(i!==null)pt=i,ht=n;else{if(n===null)throw Error(r(310));ht=n,n={memoizedState:ht.memoizedState,baseState:ht.baseState,baseQueue:ht.baseQueue,queue:ht.queue,next:null},pt===null?rt.memoizedState=pt=n:pt=pt.next=n}return pt}function Es(n,i){return typeof i=="function"?i(n):i}function Bc(n){var i=hn(),a=i.queue;if(a===null)throw Error(r(311));a.lastRenderedReducer=n;var c=ht,h=c.baseQueue,p=a.pending;if(p!==null){if(h!==null){var v=h.next;h.next=p.next,p.next=v}c.baseQueue=h=p,a.pending=null}if(h!==null){p=h.next,c=c.baseState;var w=v=null,R=null,k=p;do{var G=k.lane;if((dr&G)===G)R!==null&&(R=R.next={lane:0,action:k.action,hasEagerState:k.hasEagerState,eagerState:k.eagerState,next:null}),c=k.hasEagerState?k.eagerState:n(c,k.action);else{var z={lane:G,action:k.action,hasEagerState:k.hasEagerState,eagerState:k.eagerState,next:null};R===null?(w=R=z,v=c):R=R.next=z,rt.lanes|=G,fr|=G}k=k.next}while(k!==null&&k!==p);R===null?v=c:R.next=w,_n(c,i.memoizedState)||(Vt=!0),i.memoizedState=c,i.baseState=v,i.baseQueue=R,a.lastRenderedState=c}if(n=a.interleaved,n!==null){h=n;do p=h.lane,rt.lanes|=p,fr|=p,h=h.next;while(h!==n)}else h===null&&(a.lanes=0);return[i.memoizedState,a.dispatch]}function Hc(n){var i=hn(),a=i.queue;if(a===null)throw Error(r(311));a.lastRenderedReducer=n;var c=a.dispatch,h=a.pending,p=i.memoizedState;if(h!==null){a.pending=null;var v=h=h.next;do p=n(p,v.action),v=v.next;while(v!==h);_n(p,i.memoizedState)||(Vt=!0),i.memoizedState=p,i.baseQueue===null&&(i.baseState=p),a.lastRenderedState=p}return[p,c]}function xg(){}function $g(n,i){var a=rt,c=hn(),h=i(),p=!_n(c.memoizedState,h);if(p&&(c.memoizedState=h,Vt=!0),c=c.queue,bc(Yg.bind(null,a,c,n),[n]),c.getSnapshot!==i||p||pt!==null&&pt.memoizedState.tag&1){if(a.flags|=2048,ws(9,Wg.bind(null,a,c,h,i),void 0,null),mt===null)throw Error(r(349));(dr&30)!==0||zg(a,i,h)}return h}function zg(n,i,a){n.flags|=16384,n={getSnapshot:i,value:a},i=rt.updateQueue,i===null?(i={lastEffect:null,stores:null},rt.updateQueue=i,i.stores=[n]):(a=i.stores,a===null?i.stores=[n]:a.push(n))}function Wg(n,i,a,c){i.value=a,i.getSnapshot=c,jg(i)&&Vg(n)}function Yg(n,i,a){return a(function(){jg(i)&&Vg(n)})}function jg(n){var i=n.getSnapshot;n=n.value;try{var a=i();return!_n(n,a)}catch{return!0}}function Vg(n){var i=ri(n,1);i!==null&&Dn(i,n,1,-1)}function Xg(n){var i=jn();return typeof n=="function"&&(n=n()),i.memoizedState=i.baseState=n,n={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Es,lastRenderedState:n},i.queue=n,n=n.dispatch=Ky.bind(null,rt,n),[i.memoizedState,n]}function ws(n,i,a,c){return n={tag:n,create:i,destroy:a,deps:c,next:null},i=rt.updateQueue,i===null?(i={lastEffect:null,stores:null},rt.updateQueue=i,i.lastEffect=n.next=n):(a=i.lastEffect,a===null?i.lastEffect=n.next=n:(c=a.next,a.next=n,n.next=c,i.lastEffect=n)),n}function Kg(){return hn().memoizedState}function rl(n,i,a,c){var h=jn();rt.flags|=n,h.memoizedState=ws(1|i,a,void 0,c===void 0?null:c)}function ol(n,i,a,c){var h=hn();c=c===void 0?null:c;var p=void 0;if(ht!==null){var v=ht.memoizedState;if(p=v.destroy,c!==null&&Fc(c,v.deps)){h.memoizedState=ws(i,a,p,c);return}}rt.flags|=n,h.memoizedState=ws(1|i,a,p,c)}function Zg(n,i){return rl(8390656,8,n,i)}function bc(n,i){return ol(2048,8,n,i)}function qg(n,i){return ol(4,2,n,i)}function Qg(n,i){return ol(4,4,n,i)}function Jg(n,i){if(typeof i=="function")return n=n(),i(n),function(){i(null)};if(i!=null)return n=n(),i.current=n,function(){i.current=null}}function ep(n,i,a){return a=a!=null?a.concat([n]):null,ol(4,4,Jg.bind(null,i,n),a)}function Gc(){}function tp(n,i){var a=hn();i=i===void 0?null:i;var c=a.memoizedState;return c!==null&&i!==null&&Fc(i,c[1])?c[0]:(a.memoizedState=[n,i],n)}function np(n,i){var a=hn();i=i===void 0?null:i;var c=a.memoizedState;return c!==null&&i!==null&&Fc(i,c[1])?c[0]:(n=n(),a.memoizedState=[n,i],n)}function ip(n,i,a){return(dr&21)===0?(n.baseState&&(n.baseState=!1,Vt=!0),n.memoizedState=a):(_n(a,i)||(a=kh(),rt.lanes|=a,fr|=a,n.baseState=!0),i)}function Vy(n,i){var a=We;We=a!==0&&4>a?a:4,n(!0);var c=kc.transition;kc.transition={};try{n(!1),i()}finally{We=a,kc.transition=c}}function rp(){return hn().memoizedState}function Xy(n,i,a){var c=Fi(n);if(a={lane:c,action:a,hasEagerState:!1,eagerState:null,next:null},op(n))sp(i,a);else if(a=Lg(n,i,a,c),a!==null){var h=Ht();Dn(a,n,c,h),ap(a,i,c)}}function Ky(n,i,a){var c=Fi(n),h={lane:c,action:a,hasEagerState:!1,eagerState:null,next:null};if(op(n))sp(i,h);else{var p=n.alternate;if(n.lanes===0&&(p===null||p.lanes===0)&&(p=i.lastRenderedReducer,p!==null))try{var v=i.lastRenderedState,w=p(v,a);if(h.hasEagerState=!0,h.eagerState=w,_n(w,v)){var R=i.interleaved;R===null?(h.next=h,Rc(i)):(h.next=R.next,R.next=h),i.interleaved=h;return}}catch{}finally{}a=Lg(n,i,h,c),a!==null&&(h=Ht(),Dn(a,n,c,h),ap(a,i,c))}}function op(n){var i=n.alternate;return n===rt||i!==null&&i===rt}function sp(n,i){As=il=!0;var a=n.pending;a===null?i.next=i:(i.next=a.next,a.next=i),n.pending=i}function ap(n,i,a){if((a&4194240)!==0){var c=i.lanes;c&=n.pendingLanes,a|=c,i.lanes=a,$u(n,a)}}var sl={readContext:fn,useCallback:Dt,useContext:Dt,useEffect:Dt,useImperativeHandle:Dt,useInsertionEffect:Dt,useLayoutEffect:Dt,useMemo:Dt,useReducer:Dt,useRef:Dt,useState:Dt,useDebugValue:Dt,useDeferredValue:Dt,useTransition:Dt,useMutableSource:Dt,useSyncExternalStore:Dt,useId:Dt,unstable_isNewReconciler:!1},Zy={readContext:fn,useCallback:function(n,i){return jn().memoizedState=[n,i===void 0?null:i],n},useContext:fn,useEffect:Zg,useImperativeHandle:function(n,i,a){return a=a!=null?a.concat([n]):null,rl(4194308,4,Jg.bind(null,i,n),a)},useLayoutEffect:function(n,i){return rl(4194308,4,n,i)},useInsertionEffect:function(n,i){return rl(4,2,n,i)},useMemo:function(n,i){var a=jn();return i=i===void 0?null:i,n=n(),a.memoizedState=[n,i],n},useReducer:function(n,i,a){var c=jn();return i=a!==void 0?a(i):i,c.memoizedState=c.baseState=i,n={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:n,lastRenderedState:i},c.queue=n,n=n.dispatch=Xy.bind(null,rt,n),[c.memoizedState,n]},useRef:function(n){var i=jn();return n={current:n},i.memoizedState=n},useState:Xg,useDebugValue:Gc,useDeferredValue:function(n){return jn().memoizedState=n},useTransition:function(){var n=Xg(!1),i=n[0];return n=Vy.bind(null,n[1]),jn().memoizedState=n,[i,n]},useMutableSource:function(){},useSyncExternalStore:function(n,i,a){var c=rt,h=jn();if(Qe){if(a===void 0)throw Error(r(407));a=a()}else{if(a=i(),mt===null)throw Error(r(349));(dr&30)!==0||zg(c,i,a)}h.memoizedState=a;var p={value:a,getSnapshot:i};return h.queue=p,Zg(Yg.bind(null,c,p,n),[n]),c.flags|=2048,ws(9,Wg.bind(null,c,p,a,i),void 0,null),a},useId:function(){var n=jn(),i=mt.identifierPrefix;if(Qe){var a=ii,c=ni;a=(c&~(1<<32-wn(c)-1)).toString(32)+a,i=":"+i+"R"+a,a=Is++,0<a&&(i+="H"+a.toString(32)),i+=":"}else a=jy++,i=":"+i+"r"+a.toString(32)+":";return n.memoizedState=i},unstable_isNewReconciler:!1},qy={readContext:fn,useCallback:tp,useContext:fn,useEffect:bc,useImperativeHandle:ep,useInsertionEffect:qg,useLayoutEffect:Qg,useMemo:np,useReducer:Bc,useRef:Kg,useState:function(){return Bc(Es)},useDebugValue:Gc,useDeferredValue:function(n){var i=hn();return ip(i,ht.memoizedState,n)},useTransition:function(){var n=Bc(Es)[0],i=hn().memoizedState;return[n,i]},useMutableSource:xg,useSyncExternalStore:$g,useId:rp,unstable_isNewReconciler:!1},Qy={readContext:fn,useCallback:tp,useContext:fn,useEffect:bc,useImperativeHandle:ep,useInsertionEffect:qg,useLayoutEffect:Qg,useMemo:np,useReducer:Hc,useRef:Kg,useState:function(){return Hc(Es)},useDebugValue:Gc,useDeferredValue:function(n){var i=hn();return ht===null?i.memoizedState=n:ip(i,ht.memoizedState,n)},useTransition:function(){var n=Hc(Es)[0],i=hn().memoizedState;return[n,i]},useMutableSource:xg,useSyncExternalStore:$g,useId:rp,unstable_isNewReconciler:!1};function Rn(n,i){if(n&&n.defaultProps){i=Y({},i),n=n.defaultProps;for(var a in n)i[a]===void 0&&(i[a]=n[a]);return i}return i}function xc(n,i,a,c){i=n.memoizedState,a=a(c,i),a=a==null?i:Y({},i,a),n.memoizedState=a,n.lanes===0&&(n.updateQueue.baseState=a)}var al={isMounted:function(n){return(n=n._reactInternals)?rr(n)===n:!1},enqueueSetState:function(n,i,a){n=n._reactInternals;var c=Ht(),h=Fi(n),p=oi(c,h);p.payload=i,a!=null&&(p.callback=a),i=Di(n,p,h),i!==null&&(Dn(i,n,h,c),Ja(i,n,h))},enqueueReplaceState:function(n,i,a){n=n._reactInternals;var c=Ht(),h=Fi(n),p=oi(c,h);p.tag=1,p.payload=i,a!=null&&(p.callback=a),i=Di(n,p,h),i!==null&&(Dn(i,n,h,c),Ja(i,n,h))},enqueueForceUpdate:function(n,i){n=n._reactInternals;var a=Ht(),c=Fi(n),h=oi(a,c);h.tag=2,i!=null&&(h.callback=i),i=Di(n,h,c),i!==null&&(Dn(i,n,c,a),Ja(i,n,c))}};function lp(n,i,a,c,h,p,v){return n=n.stateNode,typeof n.shouldComponentUpdate=="function"?n.shouldComponentUpdate(c,p,v):i.prototype&&i.prototype.isPureReactComponent?!cs(a,c)||!cs(h,p):!0}function up(n,i,a){var c=!1,h=Ri,p=i.contextType;return typeof p=="object"&&p!==null?p=fn(p):(h=jt(i)?sr:Nt.current,c=i.contextTypes,p=(c=c!=null)?qr(n,h):Ri),i=new i(a,p),n.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,i.updater=al,n.stateNode=i,i._reactInternals=n,c&&(n=n.stateNode,n.__reactInternalMemoizedUnmaskedChildContext=h,n.__reactInternalMemoizedMaskedChildContext=p),i}function cp(n,i,a,c){n=i.state,typeof i.componentWillReceiveProps=="function"&&i.componentWillReceiveProps(a,c),typeof i.UNSAFE_componentWillReceiveProps=="function"&&i.UNSAFE_componentWillReceiveProps(a,c),i.state!==n&&al.enqueueReplaceState(i,i.state,null)}function $c(n,i,a,c){var h=n.stateNode;h.props=a,h.state=n.memoizedState,h.refs={},Pc(n);var p=i.contextType;typeof p=="object"&&p!==null?h.context=fn(p):(p=jt(i)?sr:Nt.current,h.context=qr(n,p)),h.state=n.memoizedState,p=i.getDerivedStateFromProps,typeof p=="function"&&(xc(n,i,p,a),h.state=n.memoizedState),typeof i.getDerivedStateFromProps=="function"||typeof h.getSnapshotBeforeUpdate=="function"||typeof h.UNSAFE_componentWillMount!="function"&&typeof h.componentWillMount!="function"||(i=h.state,typeof h.componentWillMount=="function"&&h.componentWillMount(),typeof h.UNSAFE_componentWillMount=="function"&&h.UNSAFE_componentWillMount(),i!==h.state&&al.enqueueReplaceState(h,h.state,null),el(n,a,h,c),h.state=n.memoizedState),typeof h.componentDidMount=="function"&&(n.flags|=4194308)}function oo(n,i){try{var a="",c=i;do a+=Se(c),c=c.return;while(c);var h=a}catch(p){h=`
Error generating stack: `+p.message+`
`+p.stack}return{value:n,source:i,stack:h,digest:null}}function zc(n,i,a){return{value:n,source:null,stack:a??null,digest:i??null}}function Wc(n,i){try{console.error(i.value)}catch(a){setTimeout(function(){throw a})}}var Jy=typeof WeakMap=="function"?WeakMap:Map;function dp(n,i,a){a=oi(-1,a),a.tag=3,a.payload={element:null};var c=i.value;return a.callback=function(){gl||(gl=!0,od=c),Wc(n,i)},a}function fp(n,i,a){a=oi(-1,a),a.tag=3;var c=n.type.getDerivedStateFromError;if(typeof c=="function"){var h=i.value;a.payload=function(){return c(h)},a.callback=function(){Wc(n,i)}}var p=n.stateNode;return p!==null&&typeof p.componentDidCatch=="function"&&(a.callback=function(){Wc(n,i),typeof c!="function"&&(Mi===null?Mi=new Set([this]):Mi.add(this));var v=i.stack;this.componentDidCatch(i.value,{componentStack:v!==null?v:""})}),a}function hp(n,i,a){var c=n.pingCache;if(c===null){c=n.pingCache=new Jy;var h=new Set;c.set(i,h)}else h=c.get(i),h===void 0&&(h=new Set,c.set(i,h));h.has(a)||(h.add(a),n=hT.bind(null,n,i,a),i.then(n,n))}function gp(n){do{var i;if((i=n.tag===13)&&(i=n.memoizedState,i=i!==null?i.dehydrated!==null:!0),i)return n;n=n.return}while(n!==null);return null}function pp(n,i,a,c,h){return(n.mode&1)===0?(n===i?n.flags|=65536:(n.flags|=128,a.flags|=131072,a.flags&=-52805,a.tag===1&&(a.alternate===null?a.tag=17:(i=oi(-1,1),i.tag=2,Di(a,i,1))),a.lanes|=1),n):(n.flags|=65536,n.lanes=h,n)}var eT=H.ReactCurrentOwner,Vt=!1;function Bt(n,i,a,c){i.child=n===null?Ug(i,null,a,c):to(i,n.child,a,c)}function mp(n,i,a,c,h){a=a.render;var p=i.ref;return io(i,h),c=Uc(n,i,a,c,p,h),a=Lc(),n!==null&&!Vt?(i.updateQueue=n.updateQueue,i.flags&=-2053,n.lanes&=~h,si(n,i,h)):(Qe&&a&&Sc(i),i.flags|=1,Bt(n,i,c,h),i.child)}function vp(n,i,a,c,h){if(n===null){var p=a.type;return typeof p=="function"&&!fd(p)&&p.defaultProps===void 0&&a.compare===null&&a.defaultProps===void 0?(i.tag=15,i.type=p,Sp(n,i,p,c,h)):(n=Tl(a.type,null,c,i,i.mode,h),n.ref=i.ref,n.return=i,i.child=n)}if(p=n.child,(n.lanes&h)===0){var v=p.memoizedProps;if(a=a.compare,a=a!==null?a:cs,a(v,c)&&n.ref===i.ref)return si(n,i,h)}return i.flags|=1,n=Li(p,c),n.ref=i.ref,n.return=i,i.child=n}function Sp(n,i,a,c,h){if(n!==null){var p=n.memoizedProps;if(cs(p,c)&&n.ref===i.ref)if(Vt=!1,i.pendingProps=c=p,(n.lanes&h)!==0)(n.flags&131072)!==0&&(Vt=!0);else return i.lanes=n.lanes,si(n,i,h)}return Yc(n,i,a,c,h)}function yp(n,i,a){var c=i.pendingProps,h=c.children,p=n!==null?n.memoizedState:null;if(c.mode==="hidden")if((i.mode&1)===0)i.memoizedState={baseLanes:0,cachePool:null,transitions:null},Ye(ao,nn),nn|=a;else{if((a&1073741824)===0)return n=p!==null?p.baseLanes|a:a,i.lanes=i.childLanes=1073741824,i.memoizedState={baseLanes:n,cachePool:null,transitions:null},i.updateQueue=null,Ye(ao,nn),nn|=n,null;i.memoizedState={baseLanes:0,cachePool:null,transitions:null},c=p!==null?p.baseLanes:a,Ye(ao,nn),nn|=c}else p!==null?(c=p.baseLanes|a,i.memoizedState=null):c=a,Ye(ao,nn),nn|=c;return Bt(n,i,h,a),i.child}function Tp(n,i){var a=i.ref;(n===null&&a!==null||n!==null&&n.ref!==a)&&(i.flags|=512,i.flags|=2097152)}function Yc(n,i,a,c,h){var p=jt(a)?sr:Nt.current;return p=qr(i,p),io(i,h),a=Uc(n,i,a,c,p,h),c=Lc(),n!==null&&!Vt?(i.updateQueue=n.updateQueue,i.flags&=-2053,n.lanes&=~h,si(n,i,h)):(Qe&&c&&Sc(i),i.flags|=1,Bt(n,i,a,h),i.child)}function Ap(n,i,a,c,h){if(jt(a)){var p=!0;Ya(i)}else p=!1;if(io(i,h),i.stateNode===null)ul(n,i),up(i,a,c),$c(i,a,c,h),c=!0;else if(n===null){var v=i.stateNode,w=i.memoizedProps;v.props=w;var R=v.context,k=a.contextType;typeof k=="object"&&k!==null?k=fn(k):(k=jt(a)?sr:Nt.current,k=qr(i,k));var G=a.getDerivedStateFromProps,z=typeof G=="function"||typeof v.getSnapshotBeforeUpdate=="function";z||typeof v.UNSAFE_componentWillReceiveProps!="function"&&typeof v.componentWillReceiveProps!="function"||(w!==c||R!==k)&&cp(i,v,c,k),Ni=!1;var b=i.memoizedState;v.state=b,el(i,c,v,h),R=i.memoizedState,w!==c||b!==R||Yt.current||Ni?(typeof G=="function"&&(xc(i,a,G,c),R=i.memoizedState),(w=Ni||lp(i,a,w,c,b,R,k))?(z||typeof v.UNSAFE_componentWillMount!="function"&&typeof v.componentWillMount!="function"||(typeof v.componentWillMount=="function"&&v.componentWillMount(),typeof v.UNSAFE_componentWillMount=="function"&&v.UNSAFE_componentWillMount()),typeof v.componentDidMount=="function"&&(i.flags|=4194308)):(typeof v.componentDidMount=="function"&&(i.flags|=4194308),i.memoizedProps=c,i.memoizedState=R),v.props=c,v.state=R,v.context=k,c=w):(typeof v.componentDidMount=="function"&&(i.flags|=4194308),c=!1)}else{v=i.stateNode,Bg(n,i),w=i.memoizedProps,k=i.type===i.elementType?w:Rn(i.type,w),v.props=k,z=i.pendingProps,b=v.context,R=a.contextType,typeof R=="object"&&R!==null?R=fn(R):(R=jt(a)?sr:Nt.current,R=qr(i,R));var q=a.getDerivedStateFromProps;(G=typeof q=="function"||typeof v.getSnapshotBeforeUpdate=="function")||typeof v.UNSAFE_componentWillReceiveProps!="function"&&typeof v.componentWillReceiveProps!="function"||(w!==z||b!==R)&&cp(i,v,c,R),Ni=!1,b=i.memoizedState,v.state=b,el(i,c,v,h);var te=i.memoizedState;w!==z||b!==te||Yt.current||Ni?(typeof q=="function"&&(xc(i,a,q,c),te=i.memoizedState),(k=Ni||lp(i,a,k,c,b,te,R)||!1)?(G||typeof v.UNSAFE_componentWillUpdate!="function"&&typeof v.componentWillUpdate!="function"||(typeof v.componentWillUpdate=="function"&&v.componentWillUpdate(c,te,R),typeof v.UNSAFE_componentWillUpdate=="function"&&v.UNSAFE_componentWillUpdate(c,te,R)),typeof v.componentDidUpdate=="function"&&(i.flags|=4),typeof v.getSnapshotBeforeUpdate=="function"&&(i.flags|=1024)):(typeof v.componentDidUpdate!="function"||w===n.memoizedProps&&b===n.memoizedState||(i.flags|=4),typeof v.getSnapshotBeforeUpdate!="function"||w===n.memoizedProps&&b===n.memoizedState||(i.flags|=1024),i.memoizedProps=c,i.memoizedState=te),v.props=c,v.state=te,v.context=R,c=k):(typeof v.componentDidUpdate!="function"||w===n.memoizedProps&&b===n.memoizedState||(i.flags|=4),typeof v.getSnapshotBeforeUpdate!="function"||w===n.memoizedProps&&b===n.memoizedState||(i.flags|=1024),c=!1)}return jc(n,i,a,c,p,h)}function jc(n,i,a,c,h,p){Tp(n,i);var v=(i.flags&128)!==0;if(!c&&!v)return h&&Cg(i,a,!1),si(n,i,p);c=i.stateNode,eT.current=i;var w=v&&typeof a.getDerivedStateFromError!="function"?null:c.render();return i.flags|=1,n!==null&&v?(i.child=to(i,n.child,null,p),i.child=to(i,null,w,p)):Bt(n,i,w,p),i.memoizedState=c.state,h&&Cg(i,a,!0),i.child}function Ip(n){var i=n.stateNode;i.pendingContext?wg(n,i.pendingContext,i.pendingContext!==i.context):i.context&&wg(n,i.context,!1),Nc(n,i.containerInfo)}function Ep(n,i,a,c,h){return eo(),Ic(h),i.flags|=256,Bt(n,i,a,c),i.child}var Vc={dehydrated:null,treeContext:null,retryLane:0};function Xc(n){return{baseLanes:n,cachePool:null,transitions:null}}function wp(n,i,a){var c=i.pendingProps,h=it.current,p=!1,v=(i.flags&128)!==0,w;if((w=v)||(w=n!==null&&n.memoizedState===null?!1:(h&2)!==0),w?(p=!0,i.flags&=-129):(n===null||n.memoizedState!==null)&&(h|=1),Ye(it,h&1),n===null)return Ac(i),n=i.memoizedState,n!==null&&(n=n.dehydrated,n!==null)?((i.mode&1)===0?i.lanes=1:n.data==="$!"?i.lanes=8:i.lanes=1073741824,null):(v=c.children,n=c.fallback,p?(c=i.mode,p=i.child,v={mode:"hidden",children:v},(c&1)===0&&p!==null?(p.childLanes=0,p.pendingProps=v):p=Al(v,c,0,null),n=mr(n,c,a,null),p.return=i,n.return=i,p.sibling=n,i.child=p,i.child.memoizedState=Xc(a),i.memoizedState=Vc,n):Kc(i,v));if(h=n.memoizedState,h!==null&&(w=h.dehydrated,w!==null))return tT(n,i,v,c,w,h,a);if(p){p=c.fallback,v=i.mode,h=n.child,w=h.sibling;var R={mode:"hidden",children:c.children};return(v&1)===0&&i.child!==h?(c=i.child,c.childLanes=0,c.pendingProps=R,i.deletions=null):(c=Li(h,R),c.subtreeFlags=h.subtreeFlags&14680064),w!==null?p=Li(w,p):(p=mr(p,v,a,null),p.flags|=2),p.return=i,c.return=i,c.sibling=p,i.child=c,c=p,p=i.child,v=n.child.memoizedState,v=v===null?Xc(a):{baseLanes:v.baseLanes|a,cachePool:null,transitions:v.transitions},p.memoizedState=v,p.childLanes=n.childLanes&~a,i.memoizedState=Vc,c}return p=n.child,n=p.sibling,c=Li(p,{mode:"visible",children:c.children}),(i.mode&1)===0&&(c.lanes=a),c.return=i,c.sibling=null,n!==null&&(a=i.deletions,a===null?(i.deletions=[n],i.flags|=16):a.push(n)),i.child=c,i.memoizedState=null,c}function Kc(n,i){return i=Al({mode:"visible",children:i},n.mode,0,null),i.return=n,n.child=i}function ll(n,i,a,c){return c!==null&&Ic(c),to(i,n.child,null,a),n=Kc(i,i.pendingProps.children),n.flags|=2,i.memoizedState=null,n}function tT(n,i,a,c,h,p,v){if(a)return i.flags&256?(i.flags&=-257,c=zc(Error(r(422))),ll(n,i,v,c)):i.memoizedState!==null?(i.child=n.child,i.flags|=128,null):(p=c.fallback,h=i.mode,c=Al({mode:"visible",children:c.children},h,0,null),p=mr(p,h,v,null),p.flags|=2,c.return=i,p.return=i,c.sibling=p,i.child=c,(i.mode&1)!==0&&to(i,n.child,null,v),i.child.memoizedState=Xc(v),i.memoizedState=Vc,p);if((i.mode&1)===0)return ll(n,i,v,null);if(h.data==="$!"){if(c=h.nextSibling&&h.nextSibling.dataset,c)var w=c.dgst;return c=w,p=Error(r(419)),c=zc(p,c,void 0),ll(n,i,v,c)}if(w=(v&n.childLanes)!==0,Vt||w){if(c=mt,c!==null){switch(v&-v){case 4:h=2;break;case 16:h=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:h=32;break;case 536870912:h=268435456;break;default:h=0}h=(h&(c.suspendedLanes|v))!==0?0:h,h!==0&&h!==p.retryLane&&(p.retryLane=h,ri(n,h),Dn(c,n,h,-1))}return dd(),c=zc(Error(r(421))),ll(n,i,v,c)}return h.data==="$?"?(i.flags|=128,i.child=n.child,i=gT.bind(null,n),h._reactRetry=i,null):(n=p.treeContext,tn=_i(h.nextSibling),en=i,Qe=!0,Cn=null,n!==null&&(cn[dn++]=ni,cn[dn++]=ii,cn[dn++]=ar,ni=n.id,ii=n.overflow,ar=i),i=Kc(i,c.children),i.flags|=4096,i)}function _p(n,i,a){n.lanes|=i;var c=n.alternate;c!==null&&(c.lanes|=i),Cc(n.return,i,a)}function Zc(n,i,a,c,h){var p=n.memoizedState;p===null?n.memoizedState={isBackwards:i,rendering:null,renderingStartTime:0,last:c,tail:a,tailMode:h}:(p.isBackwards=i,p.rendering=null,p.renderingStartTime=0,p.last=c,p.tail=a,p.tailMode=h)}function Cp(n,i,a){var c=i.pendingProps,h=c.revealOrder,p=c.tail;if(Bt(n,i,c.children,a),c=it.current,(c&2)!==0)c=c&1|2,i.flags|=128;else{if(n!==null&&(n.flags&128)!==0)e:for(n=i.child;n!==null;){if(n.tag===13)n.memoizedState!==null&&_p(n,a,i);else if(n.tag===19)_p(n,a,i);else if(n.child!==null){n.child.return=n,n=n.child;continue}if(n===i)break e;for(;n.sibling===null;){if(n.return===null||n.return===i)break e;n=n.return}n.sibling.return=n.return,n=n.sibling}c&=1}if(Ye(it,c),(i.mode&1)===0)i.memoizedState=null;else switch(h){case"forwards":for(a=i.child,h=null;a!==null;)n=a.alternate,n!==null&&tl(n)===null&&(h=a),a=a.sibling;a=h,a===null?(h=i.child,i.child=null):(h=a.sibling,a.sibling=null),Zc(i,!1,h,a,p);break;case"backwards":for(a=null,h=i.child,i.child=null;h!==null;){if(n=h.alternate,n!==null&&tl(n)===null){i.child=h;break}n=h.sibling,h.sibling=a,a=h,h=n}Zc(i,!0,a,null,p);break;case"together":Zc(i,!1,null,null,void 0);break;default:i.memoizedState=null}return i.child}function ul(n,i){(i.mode&1)===0&&n!==null&&(n.alternate=null,i.alternate=null,i.flags|=2)}function si(n,i,a){if(n!==null&&(i.dependencies=n.dependencies),fr|=i.lanes,(a&i.childLanes)===0)return null;if(n!==null&&i.child!==n.child)throw Error(r(153));if(i.child!==null){for(n=i.child,a=Li(n,n.pendingProps),i.child=a,a.return=i;n.sibling!==null;)n=n.sibling,a=a.sibling=Li(n,n.pendingProps),a.return=i;a.sibling=null}return i.child}function nT(n,i,a){switch(i.tag){case 3:Ip(i),eo();break;case 5:Gg(i);break;case 1:jt(i.type)&&Ya(i);break;case 4:Nc(i,i.stateNode.containerInfo);break;case 10:var c=i.type._context,h=i.memoizedProps.value;Ye(qa,c._currentValue),c._currentValue=h;break;case 13:if(c=i.memoizedState,c!==null)return c.dehydrated!==null?(Ye(it,it.current&1),i.flags|=128,null):(a&i.child.childLanes)!==0?wp(n,i,a):(Ye(it,it.current&1),n=si(n,i,a),n!==null?n.sibling:null);Ye(it,it.current&1);break;case 19:if(c=(a&i.childLanes)!==0,(n.flags&128)!==0){if(c)return Cp(n,i,a);i.flags|=128}if(h=i.memoizedState,h!==null&&(h.rendering=null,h.tail=null,h.lastEffect=null),Ye(it,it.current),c)break;return null;case 22:case 23:return i.lanes=0,yp(n,i,a)}return si(n,i,a)}var Rp,qc,Pp,Np;Rp=function(n,i){for(var a=i.child;a!==null;){if(a.tag===5||a.tag===6)n.appendChild(a.stateNode);else if(a.tag!==4&&a.child!==null){a.child.return=a,a=a.child;continue}if(a===i)break;for(;a.sibling===null;){if(a.return===null||a.return===i)return;a=a.return}a.sibling.return=a.return,a=a.sibling}},qc=function(){},Pp=function(n,i,a,c){var h=n.memoizedProps;if(h!==c){n=i.stateNode,cr(Yn.current);var p=null;switch(a){case"input":h=qe(n,h),c=qe(n,c),p=[];break;case"select":h=Y({},h,{value:void 0}),c=Y({},c,{value:void 0}),p=[];break;case"textarea":h=ir(n,h),c=ir(n,c),p=[];break;default:typeof h.onClick!="function"&&typeof c.onClick=="function"&&(n.onclick=$a)}Ou(a,c);var v;a=null;for(k in h)if(!c.hasOwnProperty(k)&&h.hasOwnProperty(k)&&h[k]!=null)if(k==="style"){var w=h[k];for(v in w)w.hasOwnProperty(v)&&(a||(a={}),a[v]="")}else k!=="dangerouslySetInnerHTML"&&k!=="children"&&k!=="suppressContentEditableWarning"&&k!=="suppressHydrationWarning"&&k!=="autoFocus"&&(l.hasOwnProperty(k)?p||(p=[]):(p=p||[]).push(k,null));for(k in c){var R=c[k];if(w=h!=null?h[k]:void 0,c.hasOwnProperty(k)&&R!==w&&(R!=null||w!=null))if(k==="style")if(w){for(v in w)!w.hasOwnProperty(v)||R&&R.hasOwnProperty(v)||(a||(a={}),a[v]="");for(v in R)R.hasOwnProperty(v)&&w[v]!==R[v]&&(a||(a={}),a[v]=R[v])}else a||(p||(p=[]),p.push(k,a)),a=R;else k==="dangerouslySetInnerHTML"?(R=R?R.__html:void 0,w=w?w.__html:void 0,R!=null&&w!==R&&(p=p||[]).push(k,R)):k==="children"?typeof R!="string"&&typeof R!="number"||(p=p||[]).push(k,""+R):k!=="suppressContentEditableWarning"&&k!=="suppressHydrationWarning"&&(l.hasOwnProperty(k)?(R!=null&&k==="onScroll"&&Ve("scroll",n),p||w===R||(p=[])):(p=p||[]).push(k,R))}a&&(p=p||[]).push("style",a);var k=p;(i.updateQueue=k)&&(i.flags|=4)}},Np=function(n,i,a,c){a!==c&&(i.flags|=4)};function _s(n,i){if(!Qe)switch(n.tailMode){case"hidden":i=n.tail;for(var a=null;i!==null;)i.alternate!==null&&(a=i),i=i.sibling;a===null?n.tail=null:a.sibling=null;break;case"collapsed":a=n.tail;for(var c=null;a!==null;)a.alternate!==null&&(c=a),a=a.sibling;c===null?i||n.tail===null?n.tail=null:n.tail.sibling=null:c.sibling=null}}function Ot(n){var i=n.alternate!==null&&n.alternate.child===n.child,a=0,c=0;if(i)for(var h=n.child;h!==null;)a|=h.lanes|h.childLanes,c|=h.subtreeFlags&14680064,c|=h.flags&14680064,h.return=n,h=h.sibling;else for(h=n.child;h!==null;)a|=h.lanes|h.childLanes,c|=h.subtreeFlags,c|=h.flags,h.return=n,h=h.sibling;return n.subtreeFlags|=c,n.childLanes=a,i}function iT(n,i,a){var c=i.pendingProps;switch(yc(i),i.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Ot(i),null;case 1:return jt(i.type)&&Wa(),Ot(i),null;case 3:return c=i.stateNode,ro(),Xe(Yt),Xe(Nt),Mc(),c.pendingContext&&(c.context=c.pendingContext,c.pendingContext=null),(n===null||n.child===null)&&(Ka(i)?i.flags|=4:n===null||n.memoizedState.isDehydrated&&(i.flags&256)===0||(i.flags|=1024,Cn!==null&&(ld(Cn),Cn=null))),qc(n,i),Ot(i),null;case 5:Dc(i);var h=cr(Ts.current);if(a=i.type,n!==null&&i.stateNode!=null)Pp(n,i,a,c,h),n.ref!==i.ref&&(i.flags|=512,i.flags|=2097152);else{if(!c){if(i.stateNode===null)throw Error(r(166));return Ot(i),null}if(n=cr(Yn.current),Ka(i)){c=i.stateNode,a=i.type;var p=i.memoizedProps;switch(c[Wn]=i,c[ps]=p,n=(i.mode&1)!==0,a){case"dialog":Ve("cancel",c),Ve("close",c);break;case"iframe":case"object":case"embed":Ve("load",c);break;case"video":case"audio":for(h=0;h<fs.length;h++)Ve(fs[h],c);break;case"source":Ve("error",c);break;case"img":case"image":case"link":Ve("error",c),Ve("load",c);break;case"details":Ve("toggle",c);break;case"input":je(c,p),Ve("invalid",c);break;case"select":c._wrapperState={wasMultiple:!!p.multiple},Ve("invalid",c);break;case"textarea":fh(c,p),Ve("invalid",c)}Ou(a,p),h=null;for(var v in p)if(p.hasOwnProperty(v)){var w=p[v];v==="children"?typeof w=="string"?c.textContent!==w&&(p.suppressHydrationWarning!==!0&&xa(c.textContent,w,n),h=["children",w]):typeof w=="number"&&c.textContent!==""+w&&(p.suppressHydrationWarning!==!0&&xa(c.textContent,w,n),h=["children",""+w]):l.hasOwnProperty(v)&&w!=null&&v==="onScroll"&&Ve("scroll",c)}switch(a){case"input":Le(c),un(c,p,!0);break;case"textarea":Le(c),gh(c);break;case"select":case"option":break;default:typeof p.onClick=="function"&&(c.onclick=$a)}c=h,i.updateQueue=c,c!==null&&(i.flags|=4)}else{v=h.nodeType===9?h:h.ownerDocument,n==="http://www.w3.org/1999/xhtml"&&(n=ph(a)),n==="http://www.w3.org/1999/xhtml"?a==="script"?(n=v.createElement("div"),n.innerHTML="<script><\/script>",n=n.removeChild(n.firstChild)):typeof c.is=="string"?n=v.createElement(a,{is:c.is}):(n=v.createElement(a),a==="select"&&(v=n,c.multiple?v.multiple=!0:c.size&&(v.size=c.size))):n=v.createElementNS(n,a),n[Wn]=i,n[ps]=c,Rp(n,i,!1,!1),i.stateNode=n;e:{switch(v=Mu(a,c),a){case"dialog":Ve("cancel",n),Ve("close",n),h=c;break;case"iframe":case"object":case"embed":Ve("load",n),h=c;break;case"video":case"audio":for(h=0;h<fs.length;h++)Ve(fs[h],n);h=c;break;case"source":Ve("error",n),h=c;break;case"img":case"image":case"link":Ve("error",n),Ve("load",n),h=c;break;case"details":Ve("toggle",n),h=c;break;case"input":je(n,c),h=qe(n,c),Ve("invalid",n);break;case"option":h=c;break;case"select":n._wrapperState={wasMultiple:!!c.multiple},h=Y({},c,{value:void 0}),Ve("invalid",n);break;case"textarea":fh(n,c),h=ir(n,c),Ve("invalid",n);break;default:h=c}Ou(a,h),w=h;for(p in w)if(w.hasOwnProperty(p)){var R=w[p];p==="style"?Sh(n,R):p==="dangerouslySetInnerHTML"?(R=R?R.__html:void 0,R!=null&&mh(n,R)):p==="children"?typeof R=="string"?(a!=="textarea"||R!=="")&&Vo(n,R):typeof R=="number"&&Vo(n,""+R):p!=="suppressContentEditableWarning"&&p!=="suppressHydrationWarning"&&p!=="autoFocus"&&(l.hasOwnProperty(p)?R!=null&&p==="onScroll"&&Ve("scroll",n):R!=null&&D(n,p,R,v))}switch(a){case"input":Le(n),un(n,c,!1);break;case"textarea":Le(n),gh(n);break;case"option":c.value!=null&&n.setAttribute("value",""+Ae(c.value));break;case"select":n.multiple=!!c.multiple,p=c.value,p!=null?Si(n,!!c.multiple,p,!1):c.defaultValue!=null&&Si(n,!!c.multiple,c.defaultValue,!0);break;default:typeof h.onClick=="function"&&(n.onclick=$a)}switch(a){case"button":case"input":case"select":case"textarea":c=!!c.autoFocus;break e;case"img":c=!0;break e;default:c=!1}}c&&(i.flags|=4)}i.ref!==null&&(i.flags|=512,i.flags|=2097152)}return Ot(i),null;case 6:if(n&&i.stateNode!=null)Np(n,i,n.memoizedProps,c);else{if(typeof c!="string"&&i.stateNode===null)throw Error(r(166));if(a=cr(Ts.current),cr(Yn.current),Ka(i)){if(c=i.stateNode,a=i.memoizedProps,c[Wn]=i,(p=c.nodeValue!==a)&&(n=en,n!==null))switch(n.tag){case 3:xa(c.nodeValue,a,(n.mode&1)!==0);break;case 5:n.memoizedProps.suppressHydrationWarning!==!0&&xa(c.nodeValue,a,(n.mode&1)!==0)}p&&(i.flags|=4)}else c=(a.nodeType===9?a:a.ownerDocument).createTextNode(c),c[Wn]=i,i.stateNode=c}return Ot(i),null;case 13:if(Xe(it),c=i.memoizedState,n===null||n.memoizedState!==null&&n.memoizedState.dehydrated!==null){if(Qe&&tn!==null&&(i.mode&1)!==0&&(i.flags&128)===0)Mg(),eo(),i.flags|=98560,p=!1;else if(p=Ka(i),c!==null&&c.dehydrated!==null){if(n===null){if(!p)throw Error(r(318));if(p=i.memoizedState,p=p!==null?p.dehydrated:null,!p)throw Error(r(317));p[Wn]=i}else eo(),(i.flags&128)===0&&(i.memoizedState=null),i.flags|=4;Ot(i),p=!1}else Cn!==null&&(ld(Cn),Cn=null),p=!0;if(!p)return i.flags&65536?i:null}return(i.flags&128)!==0?(i.lanes=a,i):(c=c!==null,c!==(n!==null&&n.memoizedState!==null)&&c&&(i.child.flags|=8192,(i.mode&1)!==0&&(n===null||(it.current&1)!==0?gt===0&&(gt=3):dd())),i.updateQueue!==null&&(i.flags|=4),Ot(i),null);case 4:return ro(),qc(n,i),n===null&&hs(i.stateNode.containerInfo),Ot(i),null;case 10:return _c(i.type._context),Ot(i),null;case 17:return jt(i.type)&&Wa(),Ot(i),null;case 19:if(Xe(it),p=i.memoizedState,p===null)return Ot(i),null;if(c=(i.flags&128)!==0,v=p.rendering,v===null)if(c)_s(p,!1);else{if(gt!==0||n!==null&&(n.flags&128)!==0)for(n=i.child;n!==null;){if(v=tl(n),v!==null){for(i.flags|=128,_s(p,!1),c=v.updateQueue,c!==null&&(i.updateQueue=c,i.flags|=4),i.subtreeFlags=0,c=a,a=i.child;a!==null;)p=a,n=c,p.flags&=14680066,v=p.alternate,v===null?(p.childLanes=0,p.lanes=n,p.child=null,p.subtreeFlags=0,p.memoizedProps=null,p.memoizedState=null,p.updateQueue=null,p.dependencies=null,p.stateNode=null):(p.childLanes=v.childLanes,p.lanes=v.lanes,p.child=v.child,p.subtreeFlags=0,p.deletions=null,p.memoizedProps=v.memoizedProps,p.memoizedState=v.memoizedState,p.updateQueue=v.updateQueue,p.type=v.type,n=v.dependencies,p.dependencies=n===null?null:{lanes:n.lanes,firstContext:n.firstContext}),a=a.sibling;return Ye(it,it.current&1|2),i.child}n=n.sibling}p.tail!==null&&at()>lo&&(i.flags|=128,c=!0,_s(p,!1),i.lanes=4194304)}else{if(!c)if(n=tl(v),n!==null){if(i.flags|=128,c=!0,a=n.updateQueue,a!==null&&(i.updateQueue=a,i.flags|=4),_s(p,!0),p.tail===null&&p.tailMode==="hidden"&&!v.alternate&&!Qe)return Ot(i),null}else 2*at()-p.renderingStartTime>lo&&a!==1073741824&&(i.flags|=128,c=!0,_s(p,!1),i.lanes=4194304);p.isBackwards?(v.sibling=i.child,i.child=v):(a=p.last,a!==null?a.sibling=v:i.child=v,p.last=v)}return p.tail!==null?(i=p.tail,p.rendering=i,p.tail=i.sibling,p.renderingStartTime=at(),i.sibling=null,a=it.current,Ye(it,c?a&1|2:a&1),i):(Ot(i),null);case 22:case 23:return cd(),c=i.memoizedState!==null,n!==null&&n.memoizedState!==null!==c&&(i.flags|=8192),c&&(i.mode&1)!==0?(nn&1073741824)!==0&&(Ot(i),i.subtreeFlags&6&&(i.flags|=8192)):Ot(i),null;case 24:return null;case 25:return null}throw Error(r(156,i.tag))}function rT(n,i){switch(yc(i),i.tag){case 1:return jt(i.type)&&Wa(),n=i.flags,n&65536?(i.flags=n&-65537|128,i):null;case 3:return ro(),Xe(Yt),Xe(Nt),Mc(),n=i.flags,(n&65536)!==0&&(n&128)===0?(i.flags=n&-65537|128,i):null;case 5:return Dc(i),null;case 13:if(Xe(it),n=i.memoizedState,n!==null&&n.dehydrated!==null){if(i.alternate===null)throw Error(r(340));eo()}return n=i.flags,n&65536?(i.flags=n&-65537|128,i):null;case 19:return Xe(it),null;case 4:return ro(),null;case 10:return _c(i.type._context),null;case 22:case 23:return cd(),null;case 24:return null;default:return null}}var cl=!1,Mt=!1,oT=typeof WeakSet=="function"?WeakSet:Set,Q=null;function so(n,i){var a=n.ref;if(a!==null)if(typeof a=="function")try{a(null)}catch(c){ot(n,i,c)}else a.current=null}function Qc(n,i,a){try{a()}catch(c){ot(n,i,c)}}var Dp=!1;function sT(n,i){if(cc=Da,n=lg(),nc(n)){if("selectionStart"in n)var a={start:n.selectionStart,end:n.selectionEnd};else e:{a=(a=n.ownerDocument)&&a.defaultView||window;var c=a.getSelection&&a.getSelection();if(c&&c.rangeCount!==0){a=c.anchorNode;var h=c.anchorOffset,p=c.focusNode;c=c.focusOffset;try{a.nodeType,p.nodeType}catch{a=null;break e}var v=0,w=-1,R=-1,k=0,G=0,z=n,b=null;t:for(;;){for(var q;z!==a||h!==0&&z.nodeType!==3||(w=v+h),z!==p||c!==0&&z.nodeType!==3||(R=v+c),z.nodeType===3&&(v+=z.nodeValue.length),(q=z.firstChild)!==null;)b=z,z=q;for(;;){if(z===n)break t;if(b===a&&++k===h&&(w=v),b===p&&++G===c&&(R=v),(q=z.nextSibling)!==null)break;z=b,b=z.parentNode}z=q}a=w===-1||R===-1?null:{start:w,end:R}}else a=null}a=a||{start:0,end:0}}else a=null;for(dc={focusedElem:n,selectionRange:a},Da=!1,Q=i;Q!==null;)if(i=Q,n=i.child,(i.subtreeFlags&1028)!==0&&n!==null)n.return=i,Q=n;else for(;Q!==null;){i=Q;try{var te=i.alternate;if((i.flags&1024)!==0)switch(i.tag){case 0:case 11:case 15:break;case 1:if(te!==null){var oe=te.memoizedProps,lt=te.memoizedState,O=i.stateNode,N=O.getSnapshotBeforeUpdate(i.elementType===i.type?oe:Rn(i.type,oe),lt);O.__reactInternalSnapshotBeforeUpdate=N}break;case 3:var M=i.stateNode.containerInfo;M.nodeType===1?M.textContent="":M.nodeType===9&&M.documentElement&&M.removeChild(M.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(r(163))}}catch(j){ot(i,i.return,j)}if(n=i.sibling,n!==null){n.return=i.return,Q=n;break}Q=i.return}return te=Dp,Dp=!1,te}function Cs(n,i,a){var c=i.updateQueue;if(c=c!==null?c.lastEffect:null,c!==null){var h=c=c.next;do{if((h.tag&n)===n){var p=h.destroy;h.destroy=void 0,p!==void 0&&Qc(i,a,p)}h=h.next}while(h!==c)}}function dl(n,i){if(i=i.updateQueue,i=i!==null?i.lastEffect:null,i!==null){var a=i=i.next;do{if((a.tag&n)===n){var c=a.create;a.destroy=c()}a=a.next}while(a!==i)}}function Jc(n){var i=n.ref;if(i!==null){var a=n.stateNode;switch(n.tag){case 5:n=a;break;default:n=a}typeof i=="function"?i(n):i.current=n}}function Op(n){var i=n.alternate;i!==null&&(n.alternate=null,Op(i)),n.child=null,n.deletions=null,n.sibling=null,n.tag===5&&(i=n.stateNode,i!==null&&(delete i[Wn],delete i[ps],delete i[pc],delete i[$y],delete i[zy])),n.stateNode=null,n.return=null,n.dependencies=null,n.memoizedProps=null,n.memoizedState=null,n.pendingProps=null,n.stateNode=null,n.updateQueue=null}function Mp(n){return n.tag===5||n.tag===3||n.tag===4}function kp(n){e:for(;;){for(;n.sibling===null;){if(n.return===null||Mp(n.return))return null;n=n.return}for(n.sibling.return=n.return,n=n.sibling;n.tag!==5&&n.tag!==6&&n.tag!==18;){if(n.flags&2||n.child===null||n.tag===4)continue e;n.child.return=n,n=n.child}if(!(n.flags&2))return n.stateNode}}function ed(n,i,a){var c=n.tag;if(c===5||c===6)n=n.stateNode,i?a.nodeType===8?a.parentNode.insertBefore(n,i):a.insertBefore(n,i):(a.nodeType===8?(i=a.parentNode,i.insertBefore(n,a)):(i=a,i.appendChild(n)),a=a._reactRootContainer,a!=null||i.onclick!==null||(i.onclick=$a));else if(c!==4&&(n=n.child,n!==null))for(ed(n,i,a),n=n.sibling;n!==null;)ed(n,i,a),n=n.sibling}function td(n,i,a){var c=n.tag;if(c===5||c===6)n=n.stateNode,i?a.insertBefore(n,i):a.appendChild(n);else if(c!==4&&(n=n.child,n!==null))for(td(n,i,a),n=n.sibling;n!==null;)td(n,i,a),n=n.sibling}var wt=null,Pn=!1;function Oi(n,i,a){for(a=a.child;a!==null;)Fp(n,i,a),a=a.sibling}function Fp(n,i,a){if(zn&&typeof zn.onCommitFiberUnmount=="function")try{zn.onCommitFiberUnmount(wa,a)}catch{}switch(a.tag){case 5:Mt||so(a,i);case 6:var c=wt,h=Pn;wt=null,Oi(n,i,a),wt=c,Pn=h,wt!==null&&(Pn?(n=wt,a=a.stateNode,n.nodeType===8?n.parentNode.removeChild(a):n.removeChild(a)):wt.removeChild(a.stateNode));break;case 18:wt!==null&&(Pn?(n=wt,a=a.stateNode,n.nodeType===8?gc(n.parentNode,a):n.nodeType===1&&gc(n,a),rs(n)):gc(wt,a.stateNode));break;case 4:c=wt,h=Pn,wt=a.stateNode.containerInfo,Pn=!0,Oi(n,i,a),wt=c,Pn=h;break;case 0:case 11:case 14:case 15:if(!Mt&&(c=a.updateQueue,c!==null&&(c=c.lastEffect,c!==null))){h=c=c.next;do{var p=h,v=p.destroy;p=p.tag,v!==void 0&&((p&2)!==0||(p&4)!==0)&&Qc(a,i,v),h=h.next}while(h!==c)}Oi(n,i,a);break;case 1:if(!Mt&&(so(a,i),c=a.stateNode,typeof c.componentWillUnmount=="function"))try{c.props=a.memoizedProps,c.state=a.memoizedState,c.componentWillUnmount()}catch(w){ot(a,i,w)}Oi(n,i,a);break;case 21:Oi(n,i,a);break;case 22:a.mode&1?(Mt=(c=Mt)||a.memoizedState!==null,Oi(n,i,a),Mt=c):Oi(n,i,a);break;default:Oi(n,i,a)}}function Up(n){var i=n.updateQueue;if(i!==null){n.updateQueue=null;var a=n.stateNode;a===null&&(a=n.stateNode=new oT),i.forEach(function(c){var h=pT.bind(null,n,c);a.has(c)||(a.add(c),c.then(h,h))})}}function Nn(n,i){var a=i.deletions;if(a!==null)for(var c=0;c<a.length;c++){var h=a[c];try{var p=n,v=i,w=v;e:for(;w!==null;){switch(w.tag){case 5:wt=w.stateNode,Pn=!1;break e;case 3:wt=w.stateNode.containerInfo,Pn=!0;break e;case 4:wt=w.stateNode.containerInfo,Pn=!0;break e}w=w.return}if(wt===null)throw Error(r(160));Fp(p,v,h),wt=null,Pn=!1;var R=h.alternate;R!==null&&(R.return=null),h.return=null}catch(k){ot(h,i,k)}}if(i.subtreeFlags&12854)for(i=i.child;i!==null;)Lp(i,n),i=i.sibling}function Lp(n,i){var a=n.alternate,c=n.flags;switch(n.tag){case 0:case 11:case 14:case 15:if(Nn(i,n),Vn(n),c&4){try{Cs(3,n,n.return),dl(3,n)}catch(oe){ot(n,n.return,oe)}try{Cs(5,n,n.return)}catch(oe){ot(n,n.return,oe)}}break;case 1:Nn(i,n),Vn(n),c&512&&a!==null&&so(a,a.return);break;case 5:if(Nn(i,n),Vn(n),c&512&&a!==null&&so(a,a.return),n.flags&32){var h=n.stateNode;try{Vo(h,"")}catch(oe){ot(n,n.return,oe)}}if(c&4&&(h=n.stateNode,h!=null)){var p=n.memoizedProps,v=a!==null?a.memoizedProps:p,w=n.type,R=n.updateQueue;if(n.updateQueue=null,R!==null)try{w==="input"&&p.type==="radio"&&p.name!=null&&Gn(h,p),Mu(w,v);var k=Mu(w,p);for(v=0;v<R.length;v+=2){var G=R[v],z=R[v+1];G==="style"?Sh(h,z):G==="dangerouslySetInnerHTML"?mh(h,z):G==="children"?Vo(h,z):D(h,G,z,k)}switch(w){case"input":Wt(h,p);break;case"textarea":hh(h,p);break;case"select":var b=h._wrapperState.wasMultiple;h._wrapperState.wasMultiple=!!p.multiple;var q=p.value;q!=null?Si(h,!!p.multiple,q,!1):b!==!!p.multiple&&(p.defaultValue!=null?Si(h,!!p.multiple,p.defaultValue,!0):Si(h,!!p.multiple,p.multiple?[]:"",!1))}h[ps]=p}catch(oe){ot(n,n.return,oe)}}break;case 6:if(Nn(i,n),Vn(n),c&4){if(n.stateNode===null)throw Error(r(162));h=n.stateNode,p=n.memoizedProps;try{h.nodeValue=p}catch(oe){ot(n,n.return,oe)}}break;case 3:if(Nn(i,n),Vn(n),c&4&&a!==null&&a.memoizedState.isDehydrated)try{rs(i.containerInfo)}catch(oe){ot(n,n.return,oe)}break;case 4:Nn(i,n),Vn(n);break;case 13:Nn(i,n),Vn(n),h=n.child,h.flags&8192&&(p=h.memoizedState!==null,h.stateNode.isHidden=p,!p||h.alternate!==null&&h.alternate.memoizedState!==null||(rd=at())),c&4&&Up(n);break;case 22:if(G=a!==null&&a.memoizedState!==null,n.mode&1?(Mt=(k=Mt)||G,Nn(i,n),Mt=k):Nn(i,n),Vn(n),c&8192){if(k=n.memoizedState!==null,(n.stateNode.isHidden=k)&&!G&&(n.mode&1)!==0)for(Q=n,G=n.child;G!==null;){for(z=Q=G;Q!==null;){switch(b=Q,q=b.child,b.tag){case 0:case 11:case 14:case 15:Cs(4,b,b.return);break;case 1:so(b,b.return);var te=b.stateNode;if(typeof te.componentWillUnmount=="function"){c=b,a=b.return;try{i=c,te.props=i.memoizedProps,te.state=i.memoizedState,te.componentWillUnmount()}catch(oe){ot(c,a,oe)}}break;case 5:so(b,b.return);break;case 22:if(b.memoizedState!==null){bp(z);continue}}q!==null?(q.return=b,Q=q):bp(z)}G=G.sibling}e:for(G=null,z=n;;){if(z.tag===5){if(G===null){G=z;try{h=z.stateNode,k?(p=h.style,typeof p.setProperty=="function"?p.setProperty("display","none","important"):p.display="none"):(w=z.stateNode,R=z.memoizedProps.style,v=R!=null&&R.hasOwnProperty("display")?R.display:null,w.style.display=vh("display",v))}catch(oe){ot(n,n.return,oe)}}}else if(z.tag===6){if(G===null)try{z.stateNode.nodeValue=k?"":z.memoizedProps}catch(oe){ot(n,n.return,oe)}}else if((z.tag!==22&&z.tag!==23||z.memoizedState===null||z===n)&&z.child!==null){z.child.return=z,z=z.child;continue}if(z===n)break e;for(;z.sibling===null;){if(z.return===null||z.return===n)break e;G===z&&(G=null),z=z.return}G===z&&(G=null),z.sibling.return=z.return,z=z.sibling}}break;case 19:Nn(i,n),Vn(n),c&4&&Up(n);break;case 21:break;default:Nn(i,n),Vn(n)}}function Vn(n){var i=n.flags;if(i&2){try{e:{for(var a=n.return;a!==null;){if(Mp(a)){var c=a;break e}a=a.return}throw Error(r(160))}switch(c.tag){case 5:var h=c.stateNode;c.flags&32&&(Vo(h,""),c.flags&=-33);var p=kp(n);td(n,p,h);break;case 3:case 4:var v=c.stateNode.containerInfo,w=kp(n);ed(n,w,v);break;default:throw Error(r(161))}}catch(R){ot(n,n.return,R)}n.flags&=-3}i&4096&&(n.flags&=-4097)}function aT(n,i,a){Q=n,Bp(n)}function Bp(n,i,a){for(var c=(n.mode&1)!==0;Q!==null;){var h=Q,p=h.child;if(h.tag===22&&c){var v=h.memoizedState!==null||cl;if(!v){var w=h.alternate,R=w!==null&&w.memoizedState!==null||Mt;w=cl;var k=Mt;if(cl=v,(Mt=R)&&!k)for(Q=h;Q!==null;)v=Q,R=v.child,v.tag===22&&v.memoizedState!==null?Gp(h):R!==null?(R.return=v,Q=R):Gp(h);for(;p!==null;)Q=p,Bp(p),p=p.sibling;Q=h,cl=w,Mt=k}Hp(n)}else(h.subtreeFlags&8772)!==0&&p!==null?(p.return=h,Q=p):Hp(n)}}function Hp(n){for(;Q!==null;){var i=Q;if((i.flags&8772)!==0){var a=i.alternate;try{if((i.flags&8772)!==0)switch(i.tag){case 0:case 11:case 15:Mt||dl(5,i);break;case 1:var c=i.stateNode;if(i.flags&4&&!Mt)if(a===null)c.componentDidMount();else{var h=i.elementType===i.type?a.memoizedProps:Rn(i.type,a.memoizedProps);c.componentDidUpdate(h,a.memoizedState,c.__reactInternalSnapshotBeforeUpdate)}var p=i.updateQueue;p!==null&&bg(i,p,c);break;case 3:var v=i.updateQueue;if(v!==null){if(a=null,i.child!==null)switch(i.child.tag){case 5:a=i.child.stateNode;break;case 1:a=i.child.stateNode}bg(i,v,a)}break;case 5:var w=i.stateNode;if(a===null&&i.flags&4){a=w;var R=i.memoizedProps;switch(i.type){case"button":case"input":case"select":case"textarea":R.autoFocus&&a.focus();break;case"img":R.src&&(a.src=R.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(i.memoizedState===null){var k=i.alternate;if(k!==null){var G=k.memoizedState;if(G!==null){var z=G.dehydrated;z!==null&&rs(z)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(r(163))}Mt||i.flags&512&&Jc(i)}catch(b){ot(i,i.return,b)}}if(i===n){Q=null;break}if(a=i.sibling,a!==null){a.return=i.return,Q=a;break}Q=i.return}}function bp(n){for(;Q!==null;){var i=Q;if(i===n){Q=null;break}var a=i.sibling;if(a!==null){a.return=i.return,Q=a;break}Q=i.return}}function Gp(n){for(;Q!==null;){var i=Q;try{switch(i.tag){case 0:case 11:case 15:var a=i.return;try{dl(4,i)}catch(R){ot(i,a,R)}break;case 1:var c=i.stateNode;if(typeof c.componentDidMount=="function"){var h=i.return;try{c.componentDidMount()}catch(R){ot(i,h,R)}}var p=i.return;try{Jc(i)}catch(R){ot(i,p,R)}break;case 5:var v=i.return;try{Jc(i)}catch(R){ot(i,v,R)}}}catch(R){ot(i,i.return,R)}if(i===n){Q=null;break}var w=i.sibling;if(w!==null){w.return=i.return,Q=w;break}Q=i.return}}var lT=Math.ceil,fl=H.ReactCurrentDispatcher,nd=H.ReactCurrentOwner,gn=H.ReactCurrentBatchConfig,He=0,mt=null,dt=null,_t=0,nn=0,ao=Ci(0),gt=0,Rs=null,fr=0,hl=0,id=0,Ps=null,Xt=null,rd=0,lo=1/0,ai=null,gl=!1,od=null,Mi=null,pl=!1,ki=null,ml=0,Ns=0,sd=null,vl=-1,Sl=0;function Ht(){return(He&6)!==0?at():vl!==-1?vl:vl=at()}function Fi(n){return(n.mode&1)===0?1:(He&2)!==0&&_t!==0?_t&-_t:Yy.transition!==null?(Sl===0&&(Sl=kh()),Sl):(n=We,n!==0||(n=window.event,n=n===void 0?16:$h(n.type)),n)}function Dn(n,i,a,c){if(50<Ns)throw Ns=0,sd=null,Error(r(185));Jo(n,a,c),((He&2)===0||n!==mt)&&(n===mt&&((He&2)===0&&(hl|=a),gt===4&&Ui(n,_t)),Kt(n,c),a===1&&He===0&&(i.mode&1)===0&&(lo=at()+500,ja&&Pi()))}function Kt(n,i){var a=n.callbackNode;YS(n,i);var c=Ra(n,n===mt?_t:0);if(c===0)a!==null&&Dh(a),n.callbackNode=null,n.callbackPriority=0;else if(i=c&-c,n.callbackPriority!==i){if(a!=null&&Dh(a),i===1)n.tag===0?Wy($p.bind(null,n)):Rg($p.bind(null,n)),Gy(function(){(He&6)===0&&Pi()}),a=null;else{switch(Fh(c)){case 1:a=bu;break;case 4:a=Oh;break;case 16:a=Ea;break;case 536870912:a=Mh;break;default:a=Ea}a=Zp(a,xp.bind(null,n))}n.callbackPriority=i,n.callbackNode=a}}function xp(n,i){if(vl=-1,Sl=0,(He&6)!==0)throw Error(r(327));var a=n.callbackNode;if(uo()&&n.callbackNode!==a)return null;var c=Ra(n,n===mt?_t:0);if(c===0)return null;if((c&30)!==0||(c&n.expiredLanes)!==0||i)i=yl(n,c);else{i=c;var h=He;He|=2;var p=Wp();(mt!==n||_t!==i)&&(ai=null,lo=at()+500,gr(n,i));do try{dT();break}catch(w){zp(n,w)}while(!0);wc(),fl.current=p,He=h,dt!==null?i=0:(mt=null,_t=0,i=gt)}if(i!==0){if(i===2&&(h=Gu(n),h!==0&&(c=h,i=ad(n,h))),i===1)throw a=Rs,gr(n,0),Ui(n,c),Kt(n,at()),a;if(i===6)Ui(n,c);else{if(h=n.current.alternate,(c&30)===0&&!uT(h)&&(i=yl(n,c),i===2&&(p=Gu(n),p!==0&&(c=p,i=ad(n,p))),i===1))throw a=Rs,gr(n,0),Ui(n,c),Kt(n,at()),a;switch(n.finishedWork=h,n.finishedLanes=c,i){case 0:case 1:throw Error(r(345));case 2:pr(n,Xt,ai);break;case 3:if(Ui(n,c),(c&130023424)===c&&(i=rd+500-at(),10<i)){if(Ra(n,0)!==0)break;if(h=n.suspendedLanes,(h&c)!==c){Ht(),n.pingedLanes|=n.suspendedLanes&h;break}n.timeoutHandle=hc(pr.bind(null,n,Xt,ai),i);break}pr(n,Xt,ai);break;case 4:if(Ui(n,c),(c&4194240)===c)break;for(i=n.eventTimes,h=-1;0<c;){var v=31-wn(c);p=1<<v,v=i[v],v>h&&(h=v),c&=~p}if(c=h,c=at()-c,c=(120>c?120:480>c?480:1080>c?1080:1920>c?1920:3e3>c?3e3:4320>c?4320:1960*lT(c/1960))-c,10<c){n.timeoutHandle=hc(pr.bind(null,n,Xt,ai),c);break}pr(n,Xt,ai);break;case 5:pr(n,Xt,ai);break;default:throw Error(r(329))}}}return Kt(n,at()),n.callbackNode===a?xp.bind(null,n):null}function ad(n,i){var a=Ps;return n.current.memoizedState.isDehydrated&&(gr(n,i).flags|=256),n=yl(n,i),n!==2&&(i=Xt,Xt=a,i!==null&&ld(i)),n}function ld(n){Xt===null?Xt=n:Xt.push.apply(Xt,n)}function uT(n){for(var i=n;;){if(i.flags&16384){var a=i.updateQueue;if(a!==null&&(a=a.stores,a!==null))for(var c=0;c<a.length;c++){var h=a[c],p=h.getSnapshot;h=h.value;try{if(!_n(p(),h))return!1}catch{return!1}}}if(a=i.child,i.subtreeFlags&16384&&a!==null)a.return=i,i=a;else{if(i===n)break;for(;i.sibling===null;){if(i.return===null||i.return===n)return!0;i=i.return}i.sibling.return=i.return,i=i.sibling}}return!0}function Ui(n,i){for(i&=~id,i&=~hl,n.suspendedLanes|=i,n.pingedLanes&=~i,n=n.expirationTimes;0<i;){var a=31-wn(i),c=1<<a;n[a]=-1,i&=~c}}function $p(n){if((He&6)!==0)throw Error(r(327));uo();var i=Ra(n,0);if((i&1)===0)return Kt(n,at()),null;var a=yl(n,i);if(n.tag!==0&&a===2){var c=Gu(n);c!==0&&(i=c,a=ad(n,c))}if(a===1)throw a=Rs,gr(n,0),Ui(n,i),Kt(n,at()),a;if(a===6)throw Error(r(345));return n.finishedWork=n.current.alternate,n.finishedLanes=i,pr(n,Xt,ai),Kt(n,at()),null}function ud(n,i){var a=He;He|=1;try{return n(i)}finally{He=a,He===0&&(lo=at()+500,ja&&Pi())}}function hr(n){ki!==null&&ki.tag===0&&(He&6)===0&&uo();var i=He;He|=1;var a=gn.transition,c=We;try{if(gn.transition=null,We=1,n)return n()}finally{We=c,gn.transition=a,He=i,(He&6)===0&&Pi()}}function cd(){nn=ao.current,Xe(ao)}function gr(n,i){n.finishedWork=null,n.finishedLanes=0;var a=n.timeoutHandle;if(a!==-1&&(n.timeoutHandle=-1,by(a)),dt!==null)for(a=dt.return;a!==null;){var c=a;switch(yc(c),c.tag){case 1:c=c.type.childContextTypes,c!=null&&Wa();break;case 3:ro(),Xe(Yt),Xe(Nt),Mc();break;case 5:Dc(c);break;case 4:ro();break;case 13:Xe(it);break;case 19:Xe(it);break;case 10:_c(c.type._context);break;case 22:case 23:cd()}a=a.return}if(mt=n,dt=n=Li(n.current,null),_t=nn=i,gt=0,Rs=null,id=hl=fr=0,Xt=Ps=null,ur!==null){for(i=0;i<ur.length;i++)if(a=ur[i],c=a.interleaved,c!==null){a.interleaved=null;var h=c.next,p=a.pending;if(p!==null){var v=p.next;p.next=h,c.next=v}a.pending=c}ur=null}return n}function zp(n,i){do{var a=dt;try{if(wc(),nl.current=sl,il){for(var c=rt.memoizedState;c!==null;){var h=c.queue;h!==null&&(h.pending=null),c=c.next}il=!1}if(dr=0,pt=ht=rt=null,As=!1,Is=0,nd.current=null,a===null||a.return===null){gt=1,Rs=i,dt=null;break}e:{var p=n,v=a.return,w=a,R=i;if(i=_t,w.flags|=32768,R!==null&&typeof R=="object"&&typeof R.then=="function"){var k=R,G=w,z=G.tag;if((G.mode&1)===0&&(z===0||z===11||z===15)){var b=G.alternate;b?(G.updateQueue=b.updateQueue,G.memoizedState=b.memoizedState,G.lanes=b.lanes):(G.updateQueue=null,G.memoizedState=null)}var q=gp(v);if(q!==null){q.flags&=-257,pp(q,v,w,p,i),q.mode&1&&hp(p,k,i),i=q,R=k;var te=i.updateQueue;if(te===null){var oe=new Set;oe.add(R),i.updateQueue=oe}else te.add(R);break e}else{if((i&1)===0){hp(p,k,i),dd();break e}R=Error(r(426))}}else if(Qe&&w.mode&1){var lt=gp(v);if(lt!==null){(lt.flags&65536)===0&&(lt.flags|=256),pp(lt,v,w,p,i),Ic(oo(R,w));break e}}p=R=oo(R,w),gt!==4&&(gt=2),Ps===null?Ps=[p]:Ps.push(p),p=v;do{switch(p.tag){case 3:p.flags|=65536,i&=-i,p.lanes|=i;var O=dp(p,R,i);Hg(p,O);break e;case 1:w=R;var N=p.type,M=p.stateNode;if((p.flags&128)===0&&(typeof N.getDerivedStateFromError=="function"||M!==null&&typeof M.componentDidCatch=="function"&&(Mi===null||!Mi.has(M)))){p.flags|=65536,i&=-i,p.lanes|=i;var j=fp(p,w,i);Hg(p,j);break e}}p=p.return}while(p!==null)}jp(a)}catch(le){i=le,dt===a&&a!==null&&(dt=a=a.return);continue}break}while(!0)}function Wp(){var n=fl.current;return fl.current=sl,n===null?sl:n}function dd(){(gt===0||gt===3||gt===2)&&(gt=4),mt===null||(fr&268435455)===0&&(hl&268435455)===0||Ui(mt,_t)}function yl(n,i){var a=He;He|=2;var c=Wp();(mt!==n||_t!==i)&&(ai=null,gr(n,i));do try{cT();break}catch(h){zp(n,h)}while(!0);if(wc(),He=a,fl.current=c,dt!==null)throw Error(r(261));return mt=null,_t=0,gt}function cT(){for(;dt!==null;)Yp(dt)}function dT(){for(;dt!==null&&!LS();)Yp(dt)}function Yp(n){var i=Kp(n.alternate,n,nn);n.memoizedProps=n.pendingProps,i===null?jp(n):dt=i,nd.current=null}function jp(n){var i=n;do{var a=i.alternate;if(n=i.return,(i.flags&32768)===0){if(a=iT(a,i,nn),a!==null){dt=a;return}}else{if(a=rT(a,i),a!==null){a.flags&=32767,dt=a;return}if(n!==null)n.flags|=32768,n.subtreeFlags=0,n.deletions=null;else{gt=6,dt=null;return}}if(i=i.sibling,i!==null){dt=i;return}dt=i=n}while(i!==null);gt===0&&(gt=5)}function pr(n,i,a){var c=We,h=gn.transition;try{gn.transition=null,We=1,fT(n,i,a,c)}finally{gn.transition=h,We=c}return null}function fT(n,i,a,c){do uo();while(ki!==null);if((He&6)!==0)throw Error(r(327));a=n.finishedWork;var h=n.finishedLanes;if(a===null)return null;if(n.finishedWork=null,n.finishedLanes=0,a===n.current)throw Error(r(177));n.callbackNode=null,n.callbackPriority=0;var p=a.lanes|a.childLanes;if(jS(n,p),n===mt&&(dt=mt=null,_t=0),(a.subtreeFlags&2064)===0&&(a.flags&2064)===0||pl||(pl=!0,Zp(Ea,function(){return uo(),null})),p=(a.flags&15990)!==0,(a.subtreeFlags&15990)!==0||p){p=gn.transition,gn.transition=null;var v=We;We=1;var w=He;He|=4,nd.current=null,sT(n,a),Lp(a,n),My(dc),Da=!!cc,dc=cc=null,n.current=a,aT(a),BS(),He=w,We=v,gn.transition=p}else n.current=a;if(pl&&(pl=!1,ki=n,ml=h),p=n.pendingLanes,p===0&&(Mi=null),GS(a.stateNode),Kt(n,at()),i!==null)for(c=n.onRecoverableError,a=0;a<i.length;a++)h=i[a],c(h.value,{componentStack:h.stack,digest:h.digest});if(gl)throw gl=!1,n=od,od=null,n;return(ml&1)!==0&&n.tag!==0&&uo(),p=n.pendingLanes,(p&1)!==0?n===sd?Ns++:(Ns=0,sd=n):Ns=0,Pi(),null}function uo(){if(ki!==null){var n=Fh(ml),i=gn.transition,a=We;try{if(gn.transition=null,We=16>n?16:n,ki===null)var c=!1;else{if(n=ki,ki=null,ml=0,(He&6)!==0)throw Error(r(331));var h=He;for(He|=4,Q=n.current;Q!==null;){var p=Q,v=p.child;if((Q.flags&16)!==0){var w=p.deletions;if(w!==null){for(var R=0;R<w.length;R++){var k=w[R];for(Q=k;Q!==null;){var G=Q;switch(G.tag){case 0:case 11:case 15:Cs(8,G,p)}var z=G.child;if(z!==null)z.return=G,Q=z;else for(;Q!==null;){G=Q;var b=G.sibling,q=G.return;if(Op(G),G===k){Q=null;break}if(b!==null){b.return=q,Q=b;break}Q=q}}}var te=p.alternate;if(te!==null){var oe=te.child;if(oe!==null){te.child=null;do{var lt=oe.sibling;oe.sibling=null,oe=lt}while(oe!==null)}}Q=p}}if((p.subtreeFlags&2064)!==0&&v!==null)v.return=p,Q=v;else e:for(;Q!==null;){if(p=Q,(p.flags&2048)!==0)switch(p.tag){case 0:case 11:case 15:Cs(9,p,p.return)}var O=p.sibling;if(O!==null){O.return=p.return,Q=O;break e}Q=p.return}}var N=n.current;for(Q=N;Q!==null;){v=Q;var M=v.child;if((v.subtreeFlags&2064)!==0&&M!==null)M.return=v,Q=M;else e:for(v=N;Q!==null;){if(w=Q,(w.flags&2048)!==0)try{switch(w.tag){case 0:case 11:case 15:dl(9,w)}}catch(le){ot(w,w.return,le)}if(w===v){Q=null;break e}var j=w.sibling;if(j!==null){j.return=w.return,Q=j;break e}Q=w.return}}if(He=h,Pi(),zn&&typeof zn.onPostCommitFiberRoot=="function")try{zn.onPostCommitFiberRoot(wa,n)}catch{}c=!0}return c}finally{We=a,gn.transition=i}}return!1}function Vp(n,i,a){i=oo(a,i),i=dp(n,i,1),n=Di(n,i,1),i=Ht(),n!==null&&(Jo(n,1,i),Kt(n,i))}function ot(n,i,a){if(n.tag===3)Vp(n,n,a);else for(;i!==null;){if(i.tag===3){Vp(i,n,a);break}else if(i.tag===1){var c=i.stateNode;if(typeof i.type.getDerivedStateFromError=="function"||typeof c.componentDidCatch=="function"&&(Mi===null||!Mi.has(c))){n=oo(a,n),n=fp(i,n,1),i=Di(i,n,1),n=Ht(),i!==null&&(Jo(i,1,n),Kt(i,n));break}}i=i.return}}function hT(n,i,a){var c=n.pingCache;c!==null&&c.delete(i),i=Ht(),n.pingedLanes|=n.suspendedLanes&a,mt===n&&(_t&a)===a&&(gt===4||gt===3&&(_t&130023424)===_t&&500>at()-rd?gr(n,0):id|=a),Kt(n,i)}function Xp(n,i){i===0&&((n.mode&1)===0?i=1:(i=Ca,Ca<<=1,(Ca&130023424)===0&&(Ca=4194304)));var a=Ht();n=ri(n,i),n!==null&&(Jo(n,i,a),Kt(n,a))}function gT(n){var i=n.memoizedState,a=0;i!==null&&(a=i.retryLane),Xp(n,a)}function pT(n,i){var a=0;switch(n.tag){case 13:var c=n.stateNode,h=n.memoizedState;h!==null&&(a=h.retryLane);break;case 19:c=n.stateNode;break;default:throw Error(r(314))}c!==null&&c.delete(i),Xp(n,a)}var Kp;Kp=function(n,i,a){if(n!==null)if(n.memoizedProps!==i.pendingProps||Yt.current)Vt=!0;else{if((n.lanes&a)===0&&(i.flags&128)===0)return Vt=!1,nT(n,i,a);Vt=(n.flags&131072)!==0}else Vt=!1,Qe&&(i.flags&1048576)!==0&&Pg(i,Xa,i.index);switch(i.lanes=0,i.tag){case 2:var c=i.type;ul(n,i),n=i.pendingProps;var h=qr(i,Nt.current);io(i,a),h=Uc(null,i,c,n,h,a);var p=Lc();return i.flags|=1,typeof h=="object"&&h!==null&&typeof h.render=="function"&&h.$$typeof===void 0?(i.tag=1,i.memoizedState=null,i.updateQueue=null,jt(c)?(p=!0,Ya(i)):p=!1,i.memoizedState=h.state!==null&&h.state!==void 0?h.state:null,Pc(i),h.updater=al,i.stateNode=h,h._reactInternals=i,$c(i,c,n,a),i=jc(null,i,c,!0,p,a)):(i.tag=0,Qe&&p&&Sc(i),Bt(null,i,h,a),i=i.child),i;case 16:c=i.elementType;e:{switch(ul(n,i),n=i.pendingProps,h=c._init,c=h(c._payload),i.type=c,h=i.tag=vT(c),n=Rn(c,n),h){case 0:i=Yc(null,i,c,n,a);break e;case 1:i=Ap(null,i,c,n,a);break e;case 11:i=mp(null,i,c,n,a);break e;case 14:i=vp(null,i,c,Rn(c.type,n),a);break e}throw Error(r(306,c,""))}return i;case 0:return c=i.type,h=i.pendingProps,h=i.elementType===c?h:Rn(c,h),Yc(n,i,c,h,a);case 1:return c=i.type,h=i.pendingProps,h=i.elementType===c?h:Rn(c,h),Ap(n,i,c,h,a);case 3:e:{if(Ip(i),n===null)throw Error(r(387));c=i.pendingProps,p=i.memoizedState,h=p.element,Bg(n,i),el(i,c,null,a);var v=i.memoizedState;if(c=v.element,p.isDehydrated)if(p={element:c,isDehydrated:!1,cache:v.cache,pendingSuspenseBoundaries:v.pendingSuspenseBoundaries,transitions:v.transitions},i.updateQueue.baseState=p,i.memoizedState=p,i.flags&256){h=oo(Error(r(423)),i),i=Ep(n,i,c,a,h);break e}else if(c!==h){h=oo(Error(r(424)),i),i=Ep(n,i,c,a,h);break e}else for(tn=_i(i.stateNode.containerInfo.firstChild),en=i,Qe=!0,Cn=null,a=Ug(i,null,c,a),i.child=a;a;)a.flags=a.flags&-3|4096,a=a.sibling;else{if(eo(),c===h){i=si(n,i,a);break e}Bt(n,i,c,a)}i=i.child}return i;case 5:return Gg(i),n===null&&Ac(i),c=i.type,h=i.pendingProps,p=n!==null?n.memoizedProps:null,v=h.children,fc(c,h)?v=null:p!==null&&fc(c,p)&&(i.flags|=32),Tp(n,i),Bt(n,i,v,a),i.child;case 6:return n===null&&Ac(i),null;case 13:return wp(n,i,a);case 4:return Nc(i,i.stateNode.containerInfo),c=i.pendingProps,n===null?i.child=to(i,null,c,a):Bt(n,i,c,a),i.child;case 11:return c=i.type,h=i.pendingProps,h=i.elementType===c?h:Rn(c,h),mp(n,i,c,h,a);case 7:return Bt(n,i,i.pendingProps,a),i.child;case 8:return Bt(n,i,i.pendingProps.children,a),i.child;case 12:return Bt(n,i,i.pendingProps.children,a),i.child;case 10:e:{if(c=i.type._context,h=i.pendingProps,p=i.memoizedProps,v=h.value,Ye(qa,c._currentValue),c._currentValue=v,p!==null)if(_n(p.value,v)){if(p.children===h.children&&!Yt.current){i=si(n,i,a);break e}}else for(p=i.child,p!==null&&(p.return=i);p!==null;){var w=p.dependencies;if(w!==null){v=p.child;for(var R=w.firstContext;R!==null;){if(R.context===c){if(p.tag===1){R=oi(-1,a&-a),R.tag=2;var k=p.updateQueue;if(k!==null){k=k.shared;var G=k.pending;G===null?R.next=R:(R.next=G.next,G.next=R),k.pending=R}}p.lanes|=a,R=p.alternate,R!==null&&(R.lanes|=a),Cc(p.return,a,i),w.lanes|=a;break}R=R.next}}else if(p.tag===10)v=p.type===i.type?null:p.child;else if(p.tag===18){if(v=p.return,v===null)throw Error(r(341));v.lanes|=a,w=v.alternate,w!==null&&(w.lanes|=a),Cc(v,a,i),v=p.sibling}else v=p.child;if(v!==null)v.return=p;else for(v=p;v!==null;){if(v===i){v=null;break}if(p=v.sibling,p!==null){p.return=v.return,v=p;break}v=v.return}p=v}Bt(n,i,h.children,a),i=i.child}return i;case 9:return h=i.type,c=i.pendingProps.children,io(i,a),h=fn(h),c=c(h),i.flags|=1,Bt(n,i,c,a),i.child;case 14:return c=i.type,h=Rn(c,i.pendingProps),h=Rn(c.type,h),vp(n,i,c,h,a);case 15:return Sp(n,i,i.type,i.pendingProps,a);case 17:return c=i.type,h=i.pendingProps,h=i.elementType===c?h:Rn(c,h),ul(n,i),i.tag=1,jt(c)?(n=!0,Ya(i)):n=!1,io(i,a),up(i,c,h),$c(i,c,h,a),jc(null,i,c,!0,n,a);case 19:return Cp(n,i,a);case 22:return yp(n,i,a)}throw Error(r(156,i.tag))};function Zp(n,i){return Nh(n,i)}function mT(n,i,a,c){this.tag=n,this.key=a,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=i,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=c,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function pn(n,i,a,c){return new mT(n,i,a,c)}function fd(n){return n=n.prototype,!(!n||!n.isReactComponent)}function vT(n){if(typeof n=="function")return fd(n)?1:0;if(n!=null){if(n=n.$$typeof,n===Ne)return 11;if(n===Ue)return 14}return 2}function Li(n,i){var a=n.alternate;return a===null?(a=pn(n.tag,i,n.key,n.mode),a.elementType=n.elementType,a.type=n.type,a.stateNode=n.stateNode,a.alternate=n,n.alternate=a):(a.pendingProps=i,a.type=n.type,a.flags=0,a.subtreeFlags=0,a.deletions=null),a.flags=n.flags&14680064,a.childLanes=n.childLanes,a.lanes=n.lanes,a.child=n.child,a.memoizedProps=n.memoizedProps,a.memoizedState=n.memoizedState,a.updateQueue=n.updateQueue,i=n.dependencies,a.dependencies=i===null?null:{lanes:i.lanes,firstContext:i.firstContext},a.sibling=n.sibling,a.index=n.index,a.ref=n.ref,a}function Tl(n,i,a,c,h,p){var v=2;if(c=n,typeof n=="function")fd(n)&&(v=1);else if(typeof n=="string")v=5;else e:switch(n){case $:return mr(a.children,h,p,i);case ee:v=8,h|=8;break;case _e:return n=pn(12,a,i,h|2),n.elementType=_e,n.lanes=p,n;case Pe:return n=pn(13,a,i,h),n.elementType=Pe,n.lanes=p,n;case de:return n=pn(19,a,i,h),n.elementType=de,n.lanes=p,n;case ne:return Al(a,h,p,i);default:if(typeof n=="object"&&n!==null)switch(n.$$typeof){case Ce:v=10;break e;case be:v=9;break e;case Ne:v=11;break e;case Ue:v=14;break e;case Te:v=16,c=null;break e}throw Error(r(130,n==null?n:typeof n,""))}return i=pn(v,a,i,h),i.elementType=n,i.type=c,i.lanes=p,i}function mr(n,i,a,c){return n=pn(7,n,c,i),n.lanes=a,n}function Al(n,i,a,c){return n=pn(22,n,c,i),n.elementType=ne,n.lanes=a,n.stateNode={isHidden:!1},n}function hd(n,i,a){return n=pn(6,n,null,i),n.lanes=a,n}function gd(n,i,a){return i=pn(4,n.children!==null?n.children:[],n.key,i),i.lanes=a,i.stateNode={containerInfo:n.containerInfo,pendingChildren:null,implementation:n.implementation},i}function ST(n,i,a,c,h){this.tag=i,this.containerInfo=n,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=xu(0),this.expirationTimes=xu(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=xu(0),this.identifierPrefix=c,this.onRecoverableError=h,this.mutableSourceEagerHydrationData=null}function pd(n,i,a,c,h,p,v,w,R){return n=new ST(n,i,a,w,R),i===1?(i=1,p===!0&&(i|=8)):i=0,p=pn(3,null,null,i),n.current=p,p.stateNode=n,p.memoizedState={element:c,isDehydrated:a,cache:null,transitions:null,pendingSuspenseBoundaries:null},Pc(p),n}function yT(n,i,a){var c=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:U,key:c==null?null:""+c,children:n,containerInfo:i,implementation:a}}function qp(n){if(!n)return Ri;n=n._reactInternals;e:{if(rr(n)!==n||n.tag!==1)throw Error(r(170));var i=n;do{switch(i.tag){case 3:i=i.stateNode.context;break e;case 1:if(jt(i.type)){i=i.stateNode.__reactInternalMemoizedMergedChildContext;break e}}i=i.return}while(i!==null);throw Error(r(171))}if(n.tag===1){var a=n.type;if(jt(a))return _g(n,a,i)}return i}function Qp(n,i,a,c,h,p,v,w,R){return n=pd(a,c,!0,n,h,p,v,w,R),n.context=qp(null),a=n.current,c=Ht(),h=Fi(a),p=oi(c,h),p.callback=i??null,Di(a,p,h),n.current.lanes=h,Jo(n,h,c),Kt(n,c),n}function Il(n,i,a,c){var h=i.current,p=Ht(),v=Fi(h);return a=qp(a),i.context===null?i.context=a:i.pendingContext=a,i=oi(p,v),i.payload={element:n},c=c===void 0?null:c,c!==null&&(i.callback=c),n=Di(h,i,v),n!==null&&(Dn(n,h,v,p),Ja(n,h,v)),v}function El(n){if(n=n.current,!n.child)return null;switch(n.child.tag){case 5:return n.child.stateNode;default:return n.child.stateNode}}function Jp(n,i){if(n=n.memoizedState,n!==null&&n.dehydrated!==null){var a=n.retryLane;n.retryLane=a!==0&&a<i?a:i}}function md(n,i){Jp(n,i),(n=n.alternate)&&Jp(n,i)}function TT(){return null}var em=typeof reportError=="function"?reportError:function(n){console.error(n)};function vd(n){this._internalRoot=n}wl.prototype.render=vd.prototype.render=function(n){var i=this._internalRoot;if(i===null)throw Error(r(409));Il(n,i,null,null)},wl.prototype.unmount=vd.prototype.unmount=function(){var n=this._internalRoot;if(n!==null){this._internalRoot=null;var i=n.containerInfo;hr(function(){Il(null,n,null,null)}),i[ei]=null}};function wl(n){this._internalRoot=n}wl.prototype.unstable_scheduleHydration=function(n){if(n){var i=Bh();n={blockedOn:null,target:n,priority:i};for(var a=0;a<Ii.length&&i!==0&&i<Ii[a].priority;a++);Ii.splice(a,0,n),a===0&&Gh(n)}};function Sd(n){return!(!n||n.nodeType!==1&&n.nodeType!==9&&n.nodeType!==11)}function _l(n){return!(!n||n.nodeType!==1&&n.nodeType!==9&&n.nodeType!==11&&(n.nodeType!==8||n.nodeValue!==" react-mount-point-unstable "))}function tm(){}function AT(n,i,a,c,h){if(h){if(typeof c=="function"){var p=c;c=function(){var k=El(v);p.call(k)}}var v=Qp(i,c,n,0,null,!1,!1,"",tm);return n._reactRootContainer=v,n[ei]=v.current,hs(n.nodeType===8?n.parentNode:n),hr(),v}for(;h=n.lastChild;)n.removeChild(h);if(typeof c=="function"){var w=c;c=function(){var k=El(R);w.call(k)}}var R=pd(n,0,!1,null,null,!1,!1,"",tm);return n._reactRootContainer=R,n[ei]=R.current,hs(n.nodeType===8?n.parentNode:n),hr(function(){Il(i,R,a,c)}),R}function Cl(n,i,a,c,h){var p=a._reactRootContainer;if(p){var v=p;if(typeof h=="function"){var w=h;h=function(){var R=El(v);w.call(R)}}Il(i,v,n,h)}else v=AT(a,i,n,h,c);return El(v)}Uh=function(n){switch(n.tag){case 3:var i=n.stateNode;if(i.current.memoizedState.isDehydrated){var a=Qo(i.pendingLanes);a!==0&&($u(i,a|1),Kt(i,at()),(He&6)===0&&(lo=at()+500,Pi()))}break;case 13:hr(function(){var c=ri(n,1);if(c!==null){var h=Ht();Dn(c,n,1,h)}}),md(n,1)}},zu=function(n){if(n.tag===13){var i=ri(n,134217728);if(i!==null){var a=Ht();Dn(i,n,134217728,a)}md(n,134217728)}},Lh=function(n){if(n.tag===13){var i=Fi(n),a=ri(n,i);if(a!==null){var c=Ht();Dn(a,n,i,c)}md(n,i)}},Bh=function(){return We},Hh=function(n,i){var a=We;try{return We=n,i()}finally{We=a}},Uu=function(n,i,a){switch(i){case"input":if(Wt(n,a),i=a.name,a.type==="radio"&&i!=null){for(a=n;a.parentNode;)a=a.parentNode;for(a=a.querySelectorAll("input[name="+JSON.stringify(""+i)+'][type="radio"]'),i=0;i<a.length;i++){var c=a[i];if(c!==n&&c.form===n.form){var h=za(c);if(!h)throw Error(r(90));he(c),Wt(c,h)}}}break;case"textarea":hh(n,a);break;case"select":i=a.value,i!=null&&Si(n,!!a.multiple,i,!1)}},Ih=ud,Eh=hr;var IT={usingClientEntryPoint:!1,Events:[ms,Kr,za,Th,Ah,ud]},Ds={findFiberByHostInstance:or,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},ET={bundleType:Ds.bundleType,version:Ds.version,rendererPackageName:Ds.rendererPackageName,rendererConfig:Ds.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:H.ReactCurrentDispatcher,findHostInstanceByFiber:function(n){return n=Rh(n),n===null?null:n.stateNode},findFiberByHostInstance:Ds.findFiberByHostInstance||TT,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Rl=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Rl.isDisabled&&Rl.supportsFiber)try{wa=Rl.inject(ET),zn=Rl}catch{}}return Zt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=IT,Zt.createPortal=function(n,i){var a=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Sd(i))throw Error(r(200));return yT(n,i,null,a)},Zt.createRoot=function(n,i){if(!Sd(n))throw Error(r(299));var a=!1,c="",h=em;return i!=null&&(i.unstable_strictMode===!0&&(a=!0),i.identifierPrefix!==void 0&&(c=i.identifierPrefix),i.onRecoverableError!==void 0&&(h=i.onRecoverableError)),i=pd(n,1,!1,null,null,a,!1,c,h),n[ei]=i.current,hs(n.nodeType===8?n.parentNode:n),new vd(i)},Zt.findDOMNode=function(n){if(n==null)return null;if(n.nodeType===1)return n;var i=n._reactInternals;if(i===void 0)throw typeof n.render=="function"?Error(r(188)):(n=Object.keys(n).join(","),Error(r(268,n)));return n=Rh(i),n=n===null?null:n.stateNode,n},Zt.flushSync=function(n){return hr(n)},Zt.hydrate=function(n,i,a){if(!_l(i))throw Error(r(200));return Cl(null,n,i,!0,a)},Zt.hydrateRoot=function(n,i,a){if(!Sd(n))throw Error(r(405));var c=a!=null&&a.hydratedSources||null,h=!1,p="",v=em;if(a!=null&&(a.unstable_strictMode===!0&&(h=!0),a.identifierPrefix!==void 0&&(p=a.identifierPrefix),a.onRecoverableError!==void 0&&(v=a.onRecoverableError)),i=Qp(i,null,n,1,a??null,h,!1,p,v),n[ei]=i.current,hs(n),c)for(n=0;n<c.length;n++)a=c[n],h=a._getVersion,h=h(a._source),i.mutableSourceEagerHydrationData==null?i.mutableSourceEagerHydrationData=[a,h]:i.mutableSourceEagerHydrationData.push(a,h);return new wl(i)},Zt.render=function(n,i,a){if(!_l(i))throw Error(r(200));return Cl(null,n,i,!1,a)},Zt.unmountComponentAtNode=function(n){if(!_l(n))throw Error(r(40));return n._reactRootContainer?(hr(function(){Cl(null,null,n,!1,function(){n._reactRootContainer=null,n[ei]=null})}),!0):!1},Zt.unstable_batchedUpdates=ud,Zt.unstable_renderSubtreeIntoContainer=function(n,i,a,c){if(!_l(a))throw Error(r(200));if(n==null||n._reactInternals===void 0)throw Error(r(38));return Cl(n,i,a,!1,c)},Zt.version="18.3.1-next-f1338f8080-20240426",Zt}var um;function kT(){if(um)return Ad.exports;um=1;function e(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}return e(),Ad.exports=MT(),Ad.exports}var cm;function FT(){if(cm)return Pl;cm=1;var e=kT();return Pl.createRoot=e.createRoot,Pl.hydrateRoot=e.hydrateRoot,Pl}var UT=FT();const LT=L0(UT);class BT{constructor(){this.ids=[],this.values=[],this.length=0}clear(){this.length=0}push(t,r){let o=this.length++;for(;o>0;){const l=o-1>>1,s=this.values[l];if(r>=s)break;this.ids[o]=this.ids[l],this.values[o]=s,o=l}this.ids[o]=t,this.values[o]=r}pop(){if(this.length===0)return;const t=this.ids[0];if(this.length--,this.length>0){const r=this.ids[0]=this.ids[this.length],o=this.values[0]=this.values[this.length],l=this.length>>1;let s=0;for(;s<l;){let u=(s<<1)+1;const d=u+1;let f=this.ids[u],g=this.values[u];const m=this.values[d];if(d<this.length&&m<g&&(u=d,f=this.ids[d],g=m),g>=o)break;this.ids[s]=f,this.values[s]=g,s=u}this.ids[s]=r,this.values[s]=o}return t}peek(){if(this.length!==0)return this.ids[0]}peekValue(){if(this.length!==0)return this.values[0]}shrink(){this.ids.length=this.values.length=this.length}}const dm=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array],wd=3;class Pf{static from(t,r=0){if(r%8!==0)throw new Error("byteOffset must be 8-byte aligned.");if(!t||t.byteLength===void 0||t.buffer)throw new Error("Data must be an instance of ArrayBuffer or SharedArrayBuffer.");const[o,l]=new Uint8Array(t,r+0,2);if(o!==251)throw new Error("Data does not appear to be in a Flatbush format.");const s=l>>4;if(s!==wd)throw new Error(`Got v${s} data when expected v${wd}.`);const u=dm[l&15];if(!u)throw new Error("Unrecognized array type.");const[d]=new Uint16Array(t,r+2,1),[f]=new Uint32Array(t,r+4,1);return new Pf(f,d,u,void 0,t,r)}constructor(t,r=16,o=Float64Array,l=ArrayBuffer,s,u=0){if(t===void 0)throw new Error("Missing required argument: numItems.");if(isNaN(t)||t<=0)throw new Error(`Unexpected numItems value: ${t}.`);this.numItems=+t,this.nodeSize=Math.min(Math.max(+r,2),65535),this.byteOffset=u;let d=t,f=d;this._levelBounds=[d*4];do d=Math.ceil(d/this.nodeSize),f+=d,this._levelBounds.push(f*4);while(d!==1);this.ArrayType=o,this.IndexArrayType=f<16384?Uint16Array:Uint32Array;const g=dm.indexOf(this.ArrayType),m=f*4*this.ArrayType.BYTES_PER_ELEMENT;if(g<0)throw new Error(`Unexpected typed array class: ${o}.`);s&&s.byteLength!==void 0&&!s.buffer?(this.data=s,this._boxes=new this.ArrayType(this.data,u+8,f*4),this._indices=new this.IndexArrayType(this.data,u+8+m,f),this._pos=f*4,this.minX=this._boxes[this._pos-4],this.minY=this._boxes[this._pos-3],this.maxX=this._boxes[this._pos-2],this.maxY=this._boxes[this._pos-1]):(this.data=new l(8+m+f*this.IndexArrayType.BYTES_PER_ELEMENT),this._boxes=new this.ArrayType(this.data,8,f*4),this._indices=new this.IndexArrayType(this.data,8+m,f),this._pos=0,this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0,new Uint8Array(this.data,0,2).set([251,(wd<<4)+g]),new Uint16Array(this.data,2,1)[0]=r,new Uint32Array(this.data,4,1)[0]=t),this._queue=new BT}add(t,r,o=t,l=r){const s=this._pos>>2,u=this._boxes;return this._indices[s]=s,u[this._pos++]=t,u[this._pos++]=r,u[this._pos++]=o,u[this._pos++]=l,t<this.minX&&(this.minX=t),r<this.minY&&(this.minY=r),o>this.maxX&&(this.maxX=o),l>this.maxY&&(this.maxY=l),s}finish(){if(this._pos>>2!==this.numItems)throw new Error(`Added ${this._pos>>2} items when expected ${this.numItems}.`);const t=this._boxes;if(this.numItems<=this.nodeSize){t[this._pos++]=this.minX,t[this._pos++]=this.minY,t[this._pos++]=this.maxX,t[this._pos++]=this.maxY;return}const r=this.maxX-this.minX||1,o=this.maxY-this.minY||1,l=new Uint32Array(this.numItems),s=65535;for(let u=0,d=0;u<this.numItems;u++){const f=t[d++],g=t[d++],m=t[d++],S=t[d++],y=Math.floor(s*((f+m)/2-this.minX)/r),E=Math.floor(s*((g+S)/2-this.minY)/o);l[u]=bT(y,E)}rf(l,t,this._indices,0,this.numItems-1,this.nodeSize);for(let u=0,d=0;u<this._levelBounds.length-1;u++){const f=this._levelBounds[u];for(;d<f;){const g=d;let m=t[d++],S=t[d++],y=t[d++],E=t[d++];for(let T=1;T<this.nodeSize&&d<f;T++)m=Math.min(m,t[d++]),S=Math.min(S,t[d++]),y=Math.max(y,t[d++]),E=Math.max(E,t[d++]);this._indices[this._pos>>2]=g,t[this._pos++]=m,t[this._pos++]=S,t[this._pos++]=y,t[this._pos++]=E}}}search(t,r,o,l,s){if(this._pos!==this._boxes.length)throw new Error("Data not yet indexed - call index.finish().");let u=this._boxes.length-4;const d=[],f=[];for(;u!==void 0;){const g=Math.min(u+this.nodeSize*4,hm(u,this._levelBounds));for(let m=u;m<g;m+=4){if(o<this._boxes[m]||l<this._boxes[m+1]||t>this._boxes[m+2]||r>this._boxes[m+3])continue;const S=this._indices[m>>2]|0;u>=this.numItems*4?d.push(S):(s===void 0||s(S))&&f.push(S)}u=d.pop()}return f}neighbors(t,r,o=1/0,l=1/0,s){if(this._pos!==this._boxes.length)throw new Error("Data not yet indexed - call index.finish().");let u=this._boxes.length-4;const d=this._queue,f=[],g=l*l;e:for(;u!==void 0;){const m=Math.min(u+this.nodeSize*4,hm(u,this._levelBounds));for(let S=u;S<m;S+=4){const y=this._indices[S>>2]|0,E=fm(t,this._boxes[S],this._boxes[S+2]),T=fm(r,this._boxes[S+1],this._boxes[S+3]),A=E*E+T*T;A>g||(u>=this.numItems*4?d.push(y<<1,A):(s===void 0||s(y))&&d.push((y<<1)+1,A))}for(;d.length&&d.peek()&1;)if(d.peekValue()>g||(f.push(d.pop()>>1),f.length===o))break e;u=d.length?d.pop()>>1:void 0}return d.clear(),f}}function fm(e,t,r){return e<t?t-e:e<=r?0:e-r}function hm(e,t){let r=0,o=t.length-1;for(;r<o;){const l=r+o>>1;t[l]>e?o=l:r=l+1}return t[r]}function rf(e,t,r,o,l,s){if(Math.floor(o/s)>=Math.floor(l/s))return;const u=e[o+l>>1];let d=o-1,f=l+1;for(;;){do d++;while(e[d]<u);do f--;while(e[f]>u);if(d>=f)break;HT(e,t,r,d,f)}rf(e,t,r,o,f,s),rf(e,t,r,f+1,l,s)}function HT(e,t,r,o,l){const s=e[o];e[o]=e[l],e[l]=s;const u=4*o,d=4*l,f=t[u],g=t[u+1],m=t[u+2],S=t[u+3];t[u]=t[d],t[u+1]=t[d+1],t[u+2]=t[d+2],t[u+3]=t[d+3],t[d]=f,t[d+1]=g,t[d+2]=m,t[d+3]=S;const y=r[o];r[o]=r[l],r[l]=y}function bT(e,t){let r=e^t,o=65535^r,l=65535^(e|t),s=e&(t^65535),u=r|o>>1,d=r>>1^r,f=l>>1^o&s>>1^l,g=r&l>>1^s>>1^s;r=u,o=d,l=f,s=g,u=r&r>>2^o&o>>2,d=r&o>>2^o&(r^o)>>2,f^=r&l>>2^o&s>>2,g^=o&l>>2^(r^o)&s>>2,r=u,o=d,l=f,s=g,u=r&r>>4^o&o>>4,d=r&o>>4^o&(r^o)>>4,f^=r&l>>4^o&s>>4,g^=o&l>>4^(r^o)&s>>4,r=u,o=d,l=f,s=g,f^=r&l>>8^o&s>>8,g^=o&l>>8^(r^o)&s>>8,r=f^f>>1,o=g^g>>1;let m=e^t,S=o|65535^(m|r);return m=(m|m<<8)&16711935,m=(m|m<<4)&252645135,m=(m|m<<2)&858993459,m=(m|m<<1)&1431655765,S=(S|S<<8)&16711935,S=(S|S<<4)&252645135,S=(S|S<<2)&858993459,S=(S|S<<1)&1431655765,(S<<1|m)>>>0}function co(e,t){if(e.length===0)return{all:()=>[],byRect:()=>[],byRadius:()=>[],byProperty:()=>[],resetPropertyCache:()=>{},count:()=>0};const r=new Pf(e.length),o=new Map;for(const s of e)r.add(s.position.x,s.position.y,s.position.x,s.position.y);return r.finish(),{all(){return e},byRect(s){return r.search(s.left,s.top,s.right,s.bottom).map(d=>e[d])},byRadius(s,u){return r.neighbors(s.x,s.y,void 0,u).map(f=>e[f])},byProperty(s,u){var d;if(!o.has(s)){const f=new Map;for(const g of e){const m=g[s];f.has(m)||f.set(m,[]),f.get(m).push(g)}o.set(s,f)}return((d=o.get(s))==null?void 0:d.get(u))||[]},resetPropertyCache(){o.clear()},count(){return e.length}}}function mu(e){const t=Object.values(e.entities.entities),r=t.filter(g=>g.type==="human"),o=t.filter(g=>g.type==="berryBush"),l=t.filter(g=>g.type==="corpse"),s=t.filter(g=>g.type==="prey"),u=t.filter(g=>g.type==="predator"),d=t.filter(g=>g.type==="building");return{...e,search:{human:co(r),berryBush:co(o),corpse:co(l),prey:co(s),predator:co(u),building:co(d)}}}const GT="tribe-game-db",Qi="save-files",Nf="tribe-game-save",of=1;async function Df(e){try{const t={version:of,savedAt:Date.now(),gameState:e},r=JSON.stringify(t),o=await $T(r);await WT(Nf,o),console.log(`Game saved successfully. Size: ${(o.size/1024).toFixed(2)} KB`)}catch(t){throw console.error("Failed to save game:",t),t}}async function xT(){try{const e=await YT(Nf);if(!e)return null;const t=await zT(e),r=JSON.parse(t);return r.version!==of?(console.warn(`Save game version mismatch. Expected ${of}, found ${r.version}. Discarding save.`),await sf(),null):(console.log("Game loaded successfully."),mu(r.gameState))}catch(e){return console.error("Failed to load game:",e),await sf(),null}}async function sf(){try{await jT(Nf),console.log("Saved game cleared.")}catch(e){console.error("Failed to clear saved game:",e)}}async function $T(e){const r=new Blob([e]).stream().pipeThrough(new CompressionStream("gzip"));return await new Response(r).blob()}async function zT(e){const t=e.stream().pipeThrough(new DecompressionStream("gzip"));return await new Response(t).text()}function Of(){return new Promise((e,t)=>{const r=indexedDB.open(GT,1);r.onupgradeneeded=o=>{const l=o.target.result;l.objectStoreNames.contains(Qi)||l.createObjectStore(Qi)},r.onsuccess=()=>e(r.result),r.onerror=()=>t(r.error)})}async function WT(e,t){const r=await Of();return new Promise((o,l)=>{const d=r.transaction(Qi,"readwrite").objectStore(Qi).put(t,e);d.onsuccess=()=>o(),d.onerror=()=>l(d.error)})}async function YT(e){const t=await Of();return new Promise((r,o)=>{const u=t.transaction(Qi,"readonly").objectStore(Qi).get(e);u.onsuccess=()=>r(u.result),u.onerror=()=>o(u.error)})}async function jT(e){const t=await Of();return new Promise((r,o)=>{const u=t.transaction(Qi,"readwrite").objectStore(Qi).delete(e);u.onsuccess=()=>r(),u.onerror=()=>o(u.error)})}const B0=Re.createContext(void 0),VT=({initialAppState:e,children:t})=>{const[r,o]=Re.useState(e),[l,s]=Re.useState(void 0),[u,d]=Re.useState(null),[f,g]=Re.useState(!1);Re.useEffect(()=>{xT().then(T=>{T&&d(T),g(!0)})},[]);const m=(T,A)=>{o(T),T==="gameOver"&&A?s(A):T!=="gameOver"&&s(void 0)},S=()=>{o("intro"),s(void 0),E()},y=T=>{Df(T),d(T)},E=()=>{sf(),d(null)};return Fe.jsx(B0.Provider,{value:{appState:r,setAppState:m,returnToIntro:S,gameOverDetails:l,contextReady:f,savedGameState:u,setSavedGameState:d,saveCurrentGame:y,clearCurrentSave:E},children:t})},Go=()=>{const e=Re.useContext(B0);if(e===void 0)throw new Error("useGameContext must be used within a GameProvider");return e};var Ut=function(){return Ut=Object.assign||function(t){for(var r,o=1,l=arguments.length;o<l;o++){r=arguments[o];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(t[s]=r[s])}return t},Ut.apply(this,arguments)};function ea(e,t,r){if(r||arguments.length===2)for(var o=0,l=t.length,s;o<l;o++)(s||!(o in t))&&(s||(s=Array.prototype.slice.call(t,0,o)),s[o]=t[o]);return e.concat(s||Array.prototype.slice.call(t))}var Ke="-ms-",Ys="-moz-",$e="-webkit-",H0="comm",vu="rule",Mf="decl",XT="@import",b0="@keyframes",KT="@layer",G0=Math.abs,kf=String.fromCharCode,af=Object.assign;function ZT(e,t){return St(e,0)^45?(((t<<2^St(e,0))<<2^St(e,1))<<2^St(e,2))<<2^St(e,3):0}function x0(e){return e.trim()}function ci(e,t){return(e=t.exec(e))?e[0]:e}function ke(e,t,r){return e.replace(t,r)}function Zl(e,t,r){return e.indexOf(t,r)}function St(e,t){return e.charCodeAt(t)|0}function No(e,t,r){return e.slice(t,r)}function qn(e){return e.length}function $0(e){return e.length}function Gs(e,t){return t.push(e),e}function qT(e,t){return e.map(t).join("")}function gm(e,t){return e.filter(function(r){return!ci(r,t)})}var Su=1,Do=1,z0=0,Tn=0,ft=0,xo="";function yu(e,t,r,o,l,s,u,d){return{value:e,root:t,parent:r,type:o,props:l,children:s,line:Su,column:Do,length:u,return:"",siblings:d}}function xi(e,t){return af(yu("",null,null,"",null,null,0,e.siblings),e,{length:-e.length},t)}function fo(e){for(;e.root;)e=xi(e.root,{children:[e]});Gs(e,e.siblings)}function QT(){return ft}function JT(){return ft=Tn>0?St(xo,--Tn):0,Do--,ft===10&&(Do=1,Su--),ft}function Fn(){return ft=Tn<z0?St(xo,Tn++):0,Do++,ft===10&&(Do=1,Su++),ft}function Cr(){return St(xo,Tn)}function ql(){return Tn}function Tu(e,t){return No(xo,e,t)}function lf(e){switch(e){case 0:case 9:case 10:case 13:case 32:return 5;case 33:case 43:case 44:case 47:case 62:case 64:case 126:case 59:case 123:case 125:return 4;case 58:return 3;case 34:case 39:case 40:case 91:return 2;case 41:case 93:return 1}return 0}function eA(e){return Su=Do=1,z0=qn(xo=e),Tn=0,[]}function tA(e){return xo="",e}function _d(e){return x0(Tu(Tn-1,uf(e===91?e+2:e===40?e+1:e)))}function nA(e){for(;(ft=Cr())&&ft<33;)Fn();return lf(e)>2||lf(ft)>3?"":" "}function iA(e,t){for(;--t&&Fn()&&!(ft<48||ft>102||ft>57&&ft<65||ft>70&&ft<97););return Tu(e,ql()+(t<6&&Cr()==32&&Fn()==32))}function uf(e){for(;Fn();)switch(ft){case e:return Tn;case 34:case 39:e!==34&&e!==39&&uf(ft);break;case 40:e===41&&uf(e);break;case 92:Fn();break}return Tn}function rA(e,t){for(;Fn()&&e+ft!==57;)if(e+ft===84&&Cr()===47)break;return"/*"+Tu(t,Tn-1)+"*"+kf(e===47?e:Fn())}function oA(e){for(;!lf(Cr());)Fn();return Tu(e,Tn)}function sA(e){return tA(Ql("",null,null,null,[""],e=eA(e),0,[0],e))}function Ql(e,t,r,o,l,s,u,d,f){for(var g=0,m=0,S=u,y=0,E=0,T=0,A=1,C=1,F=1,B=0,D="",H=l,x=s,U=o,$=D;C;)switch(T=B,B=Fn()){case 40:if(T!=108&&St($,S-1)==58){Zl($+=ke(_d(B),"&","&\f"),"&\f",G0(g?d[g-1]:0))!=-1&&(F=-1);break}case 34:case 39:case 91:$+=_d(B);break;case 9:case 10:case 13:case 32:$+=nA(T);break;case 92:$+=iA(ql()-1,7);continue;case 47:switch(Cr()){case 42:case 47:Gs(aA(rA(Fn(),ql()),t,r,f),f);break;default:$+="/"}break;case 123*A:d[g++]=qn($)*F;case 125*A:case 59:case 0:switch(B){case 0:case 125:C=0;case 59+m:F==-1&&($=ke($,/\f/g,"")),E>0&&qn($)-S&&Gs(E>32?mm($+";",o,r,S-1,f):mm(ke($," ","")+";",o,r,S-2,f),f);break;case 59:$+=";";default:if(Gs(U=pm($,t,r,g,m,l,d,D,H=[],x=[],S,s),s),B===123)if(m===0)Ql($,t,U,U,H,s,S,d,x);else switch(y===99&&St($,3)===110?100:y){case 100:case 108:case 109:case 115:Ql(e,U,U,o&&Gs(pm(e,U,U,0,0,l,d,D,l,H=[],S,x),x),l,x,S,d,o?H:x);break;default:Ql($,U,U,U,[""],x,0,d,x)}}g=m=E=0,A=F=1,D=$="",S=u;break;case 58:S=1+qn($),E=T;default:if(A<1){if(B==123)--A;else if(B==125&&A++==0&&JT()==125)continue}switch($+=kf(B),B*A){case 38:F=m>0?1:($+="\f",-1);break;case 44:d[g++]=(qn($)-1)*F,F=1;break;case 64:Cr()===45&&($+=_d(Fn())),y=Cr(),m=S=qn(D=$+=oA(ql())),B++;break;case 45:T===45&&qn($)==2&&(A=0)}}return s}function pm(e,t,r,o,l,s,u,d,f,g,m,S){for(var y=l-1,E=l===0?s:[""],T=$0(E),A=0,C=0,F=0;A<o;++A)for(var B=0,D=No(e,y+1,y=G0(C=u[A])),H=e;B<T;++B)(H=x0(C>0?E[B]+" "+D:ke(D,/&\f/g,E[B])))&&(f[F++]=H);return yu(e,t,r,l===0?vu:d,f,g,m,S)}function aA(e,t,r,o){return yu(e,t,r,H0,kf(QT()),No(e,2,-2),0,o)}function mm(e,t,r,o,l){return yu(e,t,r,Mf,No(e,0,o),No(e,o+1,-1),o,l)}function W0(e,t,r){switch(ZT(e,t)){case 5103:return $e+"print-"+e+e;case 5737:case 4201:case 3177:case 3433:case 1641:case 4457:case 2921:case 5572:case 6356:case 5844:case 3191:case 6645:case 3005:case 6391:case 5879:case 5623:case 6135:case 4599:case 4855:case 4215:case 6389:case 5109:case 5365:case 5621:case 3829:return $e+e+e;case 4789:return Ys+e+e;case 5349:case 4246:case 4810:case 6968:case 2756:return $e+e+Ys+e+Ke+e+e;case 5936:switch(St(e,t+11)){case 114:return $e+e+Ke+ke(e,/[svh]\w+-[tblr]{2}/,"tb")+e;case 108:return $e+e+Ke+ke(e,/[svh]\w+-[tblr]{2}/,"tb-rl")+e;case 45:return $e+e+Ke+ke(e,/[svh]\w+-[tblr]{2}/,"lr")+e}case 6828:case 4268:case 2903:return $e+e+Ke+e+e;case 6165:return $e+e+Ke+"flex-"+e+e;case 5187:return $e+e+ke(e,/(\w+).+(:[^]+)/,$e+"box-$1$2"+Ke+"flex-$1$2")+e;case 5443:return $e+e+Ke+"flex-item-"+ke(e,/flex-|-self/g,"")+(ci(e,/flex-|baseline/)?"":Ke+"grid-row-"+ke(e,/flex-|-self/g,""))+e;case 4675:return $e+e+Ke+"flex-line-pack"+ke(e,/align-content|flex-|-self/g,"")+e;case 5548:return $e+e+Ke+ke(e,"shrink","negative")+e;case 5292:return $e+e+Ke+ke(e,"basis","preferred-size")+e;case 6060:return $e+"box-"+ke(e,"-grow","")+$e+e+Ke+ke(e,"grow","positive")+e;case 4554:return $e+ke(e,/([^-])(transform)/g,"$1"+$e+"$2")+e;case 6187:return ke(ke(ke(e,/(zoom-|grab)/,$e+"$1"),/(image-set)/,$e+"$1"),e,"")+e;case 5495:case 3959:return ke(e,/(image-set\([^]*)/,$e+"$1$`$1");case 4968:return ke(ke(e,/(.+:)(flex-)?(.*)/,$e+"box-pack:$3"+Ke+"flex-pack:$3"),/s.+-b[^;]+/,"justify")+$e+e+e;case 4200:if(!ci(e,/flex-|baseline/))return Ke+"grid-column-align"+No(e,t)+e;break;case 2592:case 3360:return Ke+ke(e,"template-","")+e;case 4384:case 3616:return r&&r.some(function(o,l){return t=l,ci(o.props,/grid-\w+-end/)})?~Zl(e+(r=r[t].value),"span",0)?e:Ke+ke(e,"-start","")+e+Ke+"grid-row-span:"+(~Zl(r,"span",0)?ci(r,/\d+/):+ci(r,/\d+/)-+ci(e,/\d+/))+";":Ke+ke(e,"-start","")+e;case 4896:case 4128:return r&&r.some(function(o){return ci(o.props,/grid-\w+-start/)})?e:Ke+ke(ke(e,"-end","-span"),"span ","")+e;case 4095:case 3583:case 4068:case 2532:return ke(e,/(.+)-inline(.+)/,$e+"$1$2")+e;case 8116:case 7059:case 5753:case 5535:case 5445:case 5701:case 4933:case 4677:case 5533:case 5789:case 5021:case 4765:if(qn(e)-1-t>6)switch(St(e,t+1)){case 109:if(St(e,t+4)!==45)break;case 102:return ke(e,/(.+:)(.+)-([^]+)/,"$1"+$e+"$2-$3$1"+Ys+(St(e,t+3)==108?"$3":"$2-$3"))+e;case 115:return~Zl(e,"stretch",0)?W0(ke(e,"stretch","fill-available"),t,r)+e:e}break;case 5152:case 5920:return ke(e,/(.+?):(\d+)(\s*\/\s*(span)?\s*(\d+))?(.*)/,function(o,l,s,u,d,f,g){return Ke+l+":"+s+g+(u?Ke+l+"-span:"+(d?f:+f-+s)+g:"")+e});case 4949:if(St(e,t+6)===121)return ke(e,":",":"+$e)+e;break;case 6444:switch(St(e,St(e,14)===45?18:11)){case 120:return ke(e,/(.+:)([^;\s!]+)(;|(\s+)?!.+)?/,"$1"+$e+(St(e,14)===45?"inline-":"")+"box$3$1"+$e+"$2$3$1"+Ke+"$2box$3")+e;case 100:return ke(e,":",":"+Ke)+e}break;case 5719:case 2647:case 2135:case 3927:case 2391:return ke(e,"scroll-","scroll-snap-")+e}return e}function ru(e,t){for(var r="",o=0;o<e.length;o++)r+=t(e[o],o,e,t)||"";return r}function lA(e,t,r,o){switch(e.type){case KT:if(e.children.length)break;case XT:case Mf:return e.return=e.return||e.value;case H0:return"";case b0:return e.return=e.value+"{"+ru(e.children,o)+"}";case vu:if(!qn(e.value=e.props.join(",")))return""}return qn(r=ru(e.children,o))?e.return=e.value+"{"+r+"}":""}function uA(e){var t=$0(e);return function(r,o,l,s){for(var u="",d=0;d<t;d++)u+=e[d](r,o,l,s)||"";return u}}function cA(e){return function(t){t.root||(t=t.return)&&e(t)}}function dA(e,t,r,o){if(e.length>-1&&!e.return)switch(e.type){case Mf:e.return=W0(e.value,e.length,r);return;case b0:return ru([xi(e,{value:ke(e.value,"@","@"+$e)})],o);case vu:if(e.length)return qT(r=e.props,function(l){switch(ci(l,o=/(::plac\w+|:read-\w+)/)){case":read-only":case":read-write":fo(xi(e,{props:[ke(l,/:(read-\w+)/,":"+Ys+"$1")]})),fo(xi(e,{props:[l]})),af(e,{props:gm(r,o)});break;case"::placeholder":fo(xi(e,{props:[ke(l,/:(plac\w+)/,":"+$e+"input-$1")]})),fo(xi(e,{props:[ke(l,/:(plac\w+)/,":"+Ys+"$1")]})),fo(xi(e,{props:[ke(l,/:(plac\w+)/,Ke+"input-$1")]})),fo(xi(e,{props:[l]})),af(e,{props:gm(r,o)});break}return""})}}var fA={animationIterationCount:1,aspectRatio:1,borderImageOutset:1,borderImageSlice:1,borderImageWidth:1,boxFlex:1,boxFlexGroup:1,boxOrdinalGroup:1,columnCount:1,columns:1,flex:1,flexGrow:1,flexPositive:1,flexShrink:1,flexNegative:1,flexOrder:1,gridRow:1,gridRowEnd:1,gridRowSpan:1,gridRowStart:1,gridColumn:1,gridColumnEnd:1,gridColumnSpan:1,gridColumnStart:1,msGridRow:1,msGridRowSpan:1,msGridColumn:1,msGridColumnSpan:1,fontWeight:1,lineHeight:1,opacity:1,order:1,orphans:1,tabSize:1,widows:1,zIndex:1,zoom:1,WebkitLineClamp:1,fillOpacity:1,floodOpacity:1,stopOpacity:1,strokeDasharray:1,strokeDashoffset:1,strokeMiterlimit:1,strokeOpacity:1,strokeWidth:1},an={},Oo=typeof process<"u"&&an!==void 0&&(an.REACT_APP_SC_ATTR||an.SC_ATTR)||"data-styled",Y0="active",j0="data-styled-version",Au="6.1.13",Ff=`/*!sc*/
`,ou=typeof window<"u"&&"HTMLElement"in window,hA=!!(typeof SC_DISABLE_SPEEDY=="boolean"?SC_DISABLE_SPEEDY:typeof process<"u"&&an!==void 0&&an.REACT_APP_SC_DISABLE_SPEEDY!==void 0&&an.REACT_APP_SC_DISABLE_SPEEDY!==""?an.REACT_APP_SC_DISABLE_SPEEDY!=="false"&&an.REACT_APP_SC_DISABLE_SPEEDY:typeof process<"u"&&an!==void 0&&an.SC_DISABLE_SPEEDY!==void 0&&an.SC_DISABLE_SPEEDY!==""&&an.SC_DISABLE_SPEEDY!=="false"&&an.SC_DISABLE_SPEEDY),gA={},Iu=Object.freeze([]),Mo=Object.freeze({});function V0(e,t,r){return r===void 0&&(r=Mo),e.theme!==r.theme&&e.theme||t||r.theme}var X0=new Set(["a","abbr","address","area","article","aside","audio","b","base","bdi","bdo","big","blockquote","body","br","button","canvas","caption","cite","code","col","colgroup","data","datalist","dd","del","details","dfn","dialog","div","dl","dt","em","embed","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","header","hgroup","hr","html","i","iframe","img","input","ins","kbd","keygen","label","legend","li","link","main","map","mark","menu","menuitem","meta","meter","nav","noscript","object","ol","optgroup","option","output","p","param","picture","pre","progress","q","rp","rt","ruby","s","samp","script","section","select","small","source","span","strong","style","sub","summary","sup","table","tbody","td","textarea","tfoot","th","thead","time","tr","track","u","ul","use","var","video","wbr","circle","clipPath","defs","ellipse","foreignObject","g","image","line","linearGradient","marker","mask","path","pattern","polygon","polyline","radialGradient","rect","stop","svg","text","tspan"]),pA=/[!"#$%&'()*+,./:;<=>?@[\\\]^`{|}~-]+/g,mA=/(^-|-$)/g;function vm(e){return e.replace(pA,"-").replace(mA,"")}var vA=/(a)(d)/gi,Nl=52,Sm=function(e){return String.fromCharCode(e+(e>25?39:97))};function cf(e){var t,r="";for(t=Math.abs(e);t>Nl;t=t/Nl|0)r=Sm(t%Nl)+r;return(Sm(t%Nl)+r).replace(vA,"$1-$2")}var Cd,K0=5381,Ao=function(e,t){for(var r=t.length;r;)e=33*e^t.charCodeAt(--r);return e},Z0=function(e){return Ao(K0,e)};function q0(e){return cf(Z0(e)>>>0)}function SA(e){return e.displayName||e.name||"Component"}function Rd(e){return typeof e=="string"&&!0}var Q0=typeof Symbol=="function"&&Symbol.for,J0=Q0?Symbol.for("react.memo"):60115,yA=Q0?Symbol.for("react.forward_ref"):60112,TA={childContextTypes:!0,contextType:!0,contextTypes:!0,defaultProps:!0,displayName:!0,getDefaultProps:!0,getDerivedStateFromError:!0,getDerivedStateFromProps:!0,mixins:!0,propTypes:!0,type:!0},AA={name:!0,length:!0,prototype:!0,caller:!0,callee:!0,arguments:!0,arity:!0},ev={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},IA=((Cd={})[yA]={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},Cd[J0]=ev,Cd);function ym(e){return("type"in(t=e)&&t.type.$$typeof)===J0?ev:"$$typeof"in e?IA[e.$$typeof]:TA;var t}var EA=Object.defineProperty,wA=Object.getOwnPropertyNames,Tm=Object.getOwnPropertySymbols,_A=Object.getOwnPropertyDescriptor,CA=Object.getPrototypeOf,Am=Object.prototype;function tv(e,t,r){if(typeof t!="string"){if(Am){var o=CA(t);o&&o!==Am&&tv(e,o,r)}var l=wA(t);Tm&&(l=l.concat(Tm(t)));for(var s=ym(e),u=ym(t),d=0;d<l.length;++d){var f=l[d];if(!(f in AA||r&&r[f]||u&&f in u||s&&f in s)){var g=_A(t,f);try{EA(e,f,g)}catch{}}}}return e}function ko(e){return typeof e=="function"}function Uf(e){return typeof e=="object"&&"styledComponentId"in e}function wr(e,t){return e&&t?"".concat(e," ").concat(t):e||t||""}function df(e,t){if(e.length===0)return"";for(var r=e[0],o=1;o<e.length;o++)r+=e[o];return r}function ta(e){return e!==null&&typeof e=="object"&&e.constructor.name===Object.name&&!("props"in e&&e.$$typeof)}function ff(e,t,r){if(r===void 0&&(r=!1),!r&&!ta(e)&&!Array.isArray(e))return t;if(Array.isArray(t))for(var o=0;o<t.length;o++)e[o]=ff(e[o],t[o]);else if(ta(t))for(var o in t)e[o]=ff(e[o],t[o]);return e}function Lf(e,t){Object.defineProperty(e,"toString",{value:t})}function ga(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];return new Error("An error occurred. See https://github.com/styled-components/styled-components/blob/main/packages/styled-components/src/utils/errors.md#".concat(e," for more information.").concat(t.length>0?" Args: ".concat(t.join(", ")):""))}var RA=function(){function e(t){this.groupSizes=new Uint32Array(512),this.length=512,this.tag=t}return e.prototype.indexOfGroup=function(t){for(var r=0,o=0;o<t;o++)r+=this.groupSizes[o];return r},e.prototype.insertRules=function(t,r){if(t>=this.groupSizes.length){for(var o=this.groupSizes,l=o.length,s=l;t>=s;)if((s<<=1)<0)throw ga(16,"".concat(t));this.groupSizes=new Uint32Array(s),this.groupSizes.set(o),this.length=s;for(var u=l;u<s;u++)this.groupSizes[u]=0}for(var d=this.indexOfGroup(t+1),f=(u=0,r.length);u<f;u++)this.tag.insertRule(d,r[u])&&(this.groupSizes[t]++,d++)},e.prototype.clearGroup=function(t){if(t<this.length){var r=this.groupSizes[t],o=this.indexOfGroup(t),l=o+r;this.groupSizes[t]=0;for(var s=o;s<l;s++)this.tag.deleteRule(o)}},e.prototype.getGroup=function(t){var r="";if(t>=this.length||this.groupSizes[t]===0)return r;for(var o=this.groupSizes[t],l=this.indexOfGroup(t),s=l+o,u=l;u<s;u++)r+="".concat(this.tag.getRule(u)).concat(Ff);return r},e}(),Jl=new Map,su=new Map,eu=1,Dl=function(e){if(Jl.has(e))return Jl.get(e);for(;su.has(eu);)eu++;var t=eu++;return Jl.set(e,t),su.set(t,e),t},PA=function(e,t){eu=t+1,Jl.set(e,t),su.set(t,e)},NA="style[".concat(Oo,"][").concat(j0,'="').concat(Au,'"]'),DA=new RegExp("^".concat(Oo,'\\.g(\\d+)\\[id="([\\w\\d-]+)"\\].*?"([^"]*)')),OA=function(e,t,r){for(var o,l=r.split(","),s=0,u=l.length;s<u;s++)(o=l[s])&&e.registerName(t,o)},MA=function(e,t){for(var r,o=((r=t.textContent)!==null&&r!==void 0?r:"").split(Ff),l=[],s=0,u=o.length;s<u;s++){var d=o[s].trim();if(d){var f=d.match(DA);if(f){var g=0|parseInt(f[1],10),m=f[2];g!==0&&(PA(m,g),OA(e,m,f[3]),e.getTag().insertRules(g,l)),l.length=0}else l.push(d)}}},Im=function(e){for(var t=document.querySelectorAll(NA),r=0,o=t.length;r<o;r++){var l=t[r];l&&l.getAttribute(Oo)!==Y0&&(MA(e,l),l.parentNode&&l.parentNode.removeChild(l))}};function kA(){return typeof __webpack_nonce__<"u"?__webpack_nonce__:null}var nv=function(e){var t=document.head,r=e||t,o=document.createElement("style"),l=function(d){var f=Array.from(d.querySelectorAll("style[".concat(Oo,"]")));return f[f.length-1]}(r),s=l!==void 0?l.nextSibling:null;o.setAttribute(Oo,Y0),o.setAttribute(j0,Au);var u=kA();return u&&o.setAttribute("nonce",u),r.insertBefore(o,s),o},FA=function(){function e(t){this.element=nv(t),this.element.appendChild(document.createTextNode("")),this.sheet=function(r){if(r.sheet)return r.sheet;for(var o=document.styleSheets,l=0,s=o.length;l<s;l++){var u=o[l];if(u.ownerNode===r)return u}throw ga(17)}(this.element),this.length=0}return e.prototype.insertRule=function(t,r){try{return this.sheet.insertRule(r,t),this.length++,!0}catch{return!1}},e.prototype.deleteRule=function(t){this.sheet.deleteRule(t),this.length--},e.prototype.getRule=function(t){var r=this.sheet.cssRules[t];return r&&r.cssText?r.cssText:""},e}(),UA=function(){function e(t){this.element=nv(t),this.nodes=this.element.childNodes,this.length=0}return e.prototype.insertRule=function(t,r){if(t<=this.length&&t>=0){var o=document.createTextNode(r);return this.element.insertBefore(o,this.nodes[t]||null),this.length++,!0}return!1},e.prototype.deleteRule=function(t){this.element.removeChild(this.nodes[t]),this.length--},e.prototype.getRule=function(t){return t<this.length?this.nodes[t].textContent:""},e}(),LA=function(){function e(t){this.rules=[],this.length=0}return e.prototype.insertRule=function(t,r){return t<=this.length&&(this.rules.splice(t,0,r),this.length++,!0)},e.prototype.deleteRule=function(t){this.rules.splice(t,1),this.length--},e.prototype.getRule=function(t){return t<this.length?this.rules[t]:""},e}(),Em=ou,BA={isServer:!ou,useCSSOMInjection:!hA},au=function(){function e(t,r,o){t===void 0&&(t=Mo),r===void 0&&(r={});var l=this;this.options=Ut(Ut({},BA),t),this.gs=r,this.names=new Map(o),this.server=!!t.isServer,!this.server&&ou&&Em&&(Em=!1,Im(this)),Lf(this,function(){return function(s){for(var u=s.getTag(),d=u.length,f="",g=function(S){var y=function(F){return su.get(F)}(S);if(y===void 0)return"continue";var E=s.names.get(y),T=u.getGroup(S);if(E===void 0||!E.size||T.length===0)return"continue";var A="".concat(Oo,".g").concat(S,'[id="').concat(y,'"]'),C="";E!==void 0&&E.forEach(function(F){F.length>0&&(C+="".concat(F,","))}),f+="".concat(T).concat(A,'{content:"').concat(C,'"}').concat(Ff)},m=0;m<d;m++)g(m);return f}(l)})}return e.registerId=function(t){return Dl(t)},e.prototype.rehydrate=function(){!this.server&&ou&&Im(this)},e.prototype.reconstructWithOptions=function(t,r){return r===void 0&&(r=!0),new e(Ut(Ut({},this.options),t),this.gs,r&&this.names||void 0)},e.prototype.allocateGSInstance=function(t){return this.gs[t]=(this.gs[t]||0)+1},e.prototype.getTag=function(){return this.tag||(this.tag=(t=function(r){var o=r.useCSSOMInjection,l=r.target;return r.isServer?new LA(l):o?new FA(l):new UA(l)}(this.options),new RA(t)));var t},e.prototype.hasNameForId=function(t,r){return this.names.has(t)&&this.names.get(t).has(r)},e.prototype.registerName=function(t,r){if(Dl(t),this.names.has(t))this.names.get(t).add(r);else{var o=new Set;o.add(r),this.names.set(t,o)}},e.prototype.insertRules=function(t,r,o){this.registerName(t,r),this.getTag().insertRules(Dl(t),o)},e.prototype.clearNames=function(t){this.names.has(t)&&this.names.get(t).clear()},e.prototype.clearRules=function(t){this.getTag().clearGroup(Dl(t)),this.clearNames(t)},e.prototype.clearTag=function(){this.tag=void 0},e}(),HA=/&/g,bA=/^\s*\/\/.*$/gm;function iv(e,t){return e.map(function(r){return r.type==="rule"&&(r.value="".concat(t," ").concat(r.value),r.value=r.value.replaceAll(",",",".concat(t," ")),r.props=r.props.map(function(o){return"".concat(t," ").concat(o)})),Array.isArray(r.children)&&r.type!=="@keyframes"&&(r.children=iv(r.children,t)),r})}function GA(e){var t,r,o,l=Mo,s=l.options,u=s===void 0?Mo:s,d=l.plugins,f=d===void 0?Iu:d,g=function(y,E,T){return T.startsWith(r)&&T.endsWith(r)&&T.replaceAll(r,"").length>0?".".concat(t):y},m=f.slice();m.push(function(y){y.type===vu&&y.value.includes("&")&&(y.props[0]=y.props[0].replace(HA,r).replace(o,g))}),u.prefix&&m.push(dA),m.push(lA);var S=function(y,E,T,A){E===void 0&&(E=""),T===void 0&&(T=""),A===void 0&&(A="&"),t=A,r=E,o=new RegExp("\\".concat(r,"\\b"),"g");var C=y.replace(bA,""),F=sA(T||E?"".concat(T," ").concat(E," { ").concat(C," }"):C);u.namespace&&(F=iv(F,u.namespace));var B=[];return ru(F,uA(m.concat(cA(function(D){return B.push(D)})))),B};return S.hash=f.length?f.reduce(function(y,E){return E.name||ga(15),Ao(y,E.name)},K0).toString():"",S}var xA=new au,hf=GA(),rv=Qn.createContext({shouldForwardProp:void 0,styleSheet:xA,stylis:hf});rv.Consumer;Qn.createContext(void 0);function gf(){return Re.useContext(rv)}var $A=function(){function e(t,r){var o=this;this.inject=function(l,s){s===void 0&&(s=hf);var u=o.name+s.hash;l.hasNameForId(o.id,u)||l.insertRules(o.id,u,s(o.rules,u,"@keyframes"))},this.name=t,this.id="sc-keyframes-".concat(t),this.rules=r,Lf(this,function(){throw ga(12,String(o.name))})}return e.prototype.getName=function(t){return t===void 0&&(t=hf),this.name+t.hash},e}(),zA=function(e){return e>="A"&&e<="Z"};function wm(e){for(var t="",r=0;r<e.length;r++){var o=e[r];if(r===1&&o==="-"&&e[0]==="-")return e;zA(o)?t+="-"+o.toLowerCase():t+=o}return t.startsWith("ms-")?"-"+t:t}var ov=function(e){return e==null||e===!1||e===""},sv=function(e){var t,r,o=[];for(var l in e){var s=e[l];e.hasOwnProperty(l)&&!ov(s)&&(Array.isArray(s)&&s.isCss||ko(s)?o.push("".concat(wm(l),":"),s,";"):ta(s)?o.push.apply(o,ea(ea(["".concat(l," {")],sv(s),!1),["}"],!1)):o.push("".concat(wm(l),": ").concat((t=l,(r=s)==null||typeof r=="boolean"||r===""?"":typeof r!="number"||r===0||t in fA||t.startsWith("--")?String(r).trim():"".concat(r,"px")),";")))}return o};function Zi(e,t,r,o){if(ov(e))return[];if(Uf(e))return[".".concat(e.styledComponentId)];if(ko(e)){if(!ko(s=e)||s.prototype&&s.prototype.isReactComponent||!t)return[e];var l=e(t);return Zi(l,t,r,o)}var s;return e instanceof $A?r?(e.inject(r,o),[e.getName(o)]):[e]:ta(e)?sv(e):Array.isArray(e)?Array.prototype.concat.apply(Iu,e.map(function(u){return Zi(u,t,r,o)})):[e.toString()]}function av(e){for(var t=0;t<e.length;t+=1){var r=e[t];if(ko(r)&&!Uf(r))return!1}return!0}var WA=Z0(Au),YA=function(){function e(t,r,o){this.rules=t,this.staticRulesId="",this.isStatic=(o===void 0||o.isStatic)&&av(t),this.componentId=r,this.baseHash=Ao(WA,r),this.baseStyle=o,au.registerId(r)}return e.prototype.generateAndInjectStyles=function(t,r,o){var l=this.baseStyle?this.baseStyle.generateAndInjectStyles(t,r,o):"";if(this.isStatic&&!o.hash)if(this.staticRulesId&&r.hasNameForId(this.componentId,this.staticRulesId))l=wr(l,this.staticRulesId);else{var s=df(Zi(this.rules,t,r,o)),u=cf(Ao(this.baseHash,s)>>>0);if(!r.hasNameForId(this.componentId,u)){var d=o(s,".".concat(u),void 0,this.componentId);r.insertRules(this.componentId,u,d)}l=wr(l,u),this.staticRulesId=u}else{for(var f=Ao(this.baseHash,o.hash),g="",m=0;m<this.rules.length;m++){var S=this.rules[m];if(typeof S=="string")g+=S;else if(S){var y=df(Zi(S,t,r,o));f=Ao(f,y+m),g+=y}}if(g){var E=cf(f>>>0);r.hasNameForId(this.componentId,E)||r.insertRules(this.componentId,E,o(g,".".concat(E),void 0,this.componentId)),l=wr(l,E)}}return l},e}(),Bf=Qn.createContext(void 0);Bf.Consumer;var Pd={};function jA(e,t,r){var o=Uf(e),l=e,s=!Rd(e),u=t.attrs,d=u===void 0?Iu:u,f=t.componentId,g=f===void 0?function(H,x){var U=typeof H!="string"?"sc":vm(H);Pd[U]=(Pd[U]||0)+1;var $="".concat(U,"-").concat(q0(Au+U+Pd[U]));return x?"".concat(x,"-").concat($):$}(t.displayName,t.parentComponentId):f,m=t.displayName,S=m===void 0?function(H){return Rd(H)?"styled.".concat(H):"Styled(".concat(SA(H),")")}(e):m,y=t.displayName&&t.componentId?"".concat(vm(t.displayName),"-").concat(t.componentId):t.componentId||g,E=o&&l.attrs?l.attrs.concat(d).filter(Boolean):d,T=t.shouldForwardProp;if(o&&l.shouldForwardProp){var A=l.shouldForwardProp;if(t.shouldForwardProp){var C=t.shouldForwardProp;T=function(H,x){return A(H,x)&&C(H,x)}}else T=A}var F=new YA(r,y,o?l.componentStyle:void 0);function B(H,x){return function(U,$,ee){var _e=U.attrs,Ce=U.componentStyle,be=U.defaultProps,Ne=U.foldedComponentIds,Pe=U.styledComponentId,de=U.target,Ue=Qn.useContext(Bf),Te=gf(),ne=U.shouldForwardProp||Te.shouldForwardProp,W=V0($,Ue,be)||Mo,X=function(Se,ae,Ee){for(var Ae,Z=Ut(Ut({},ae),{className:void 0,theme:Ee}),re=0;re<Se.length;re+=1){var Le=ko(Ae=Se[re])?Ae(Z):Ae;for(var he in Le)Z[he]=he==="className"?wr(Z[he],Le[he]):he==="style"?Ut(Ut({},Z[he]),Le[he]):Le[he]}return ae.className&&(Z.className=wr(Z.className,ae.className)),Z}(_e,$,W),Y=X.as||de,P={};for(var L in X)X[L]===void 0||L[0]==="$"||L==="as"||L==="theme"&&X.theme===W||(L==="forwardedAs"?P.as=X.forwardedAs:ne&&!ne(L,Y)||(P[L]=X[L]));var K=function(Se,ae){var Ee=gf(),Ae=Se.generateAndInjectStyles(ae,Ee.styleSheet,Ee.stylis);return Ae}(Ce,X),ie=wr(Ne,Pe);return K&&(ie+=" "+K),X.className&&(ie+=" "+X.className),P[Rd(Y)&&!X0.has(Y)?"class":"className"]=ie,P.ref=ee,Re.createElement(Y,P)}(D,H,x)}B.displayName=S;var D=Qn.forwardRef(B);return D.attrs=E,D.componentStyle=F,D.displayName=S,D.shouldForwardProp=T,D.foldedComponentIds=o?wr(l.foldedComponentIds,l.styledComponentId):"",D.styledComponentId=y,D.target=o?l.target:e,Object.defineProperty(D,"defaultProps",{get:function(){return this._foldedDefaultProps},set:function(H){this._foldedDefaultProps=o?function(x){for(var U=[],$=1;$<arguments.length;$++)U[$-1]=arguments[$];for(var ee=0,_e=U;ee<_e.length;ee++)ff(x,_e[ee],!0);return x}({},l.defaultProps,H):H}}),Lf(D,function(){return".".concat(D.styledComponentId)}),s&&tv(D,e,{attrs:!0,componentStyle:!0,displayName:!0,foldedComponentIds:!0,shouldForwardProp:!0,styledComponentId:!0,target:!0}),D}function _m(e,t){for(var r=[e[0]],o=0,l=t.length;o<l;o+=1)r.push(t[o],e[o+1]);return r}var Cm=function(e){return Object.assign(e,{isCss:!0})};function lv(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];if(ko(e)||ta(e))return Cm(Zi(_m(Iu,ea([e],t,!0))));var o=e;return t.length===0&&o.length===1&&typeof o[0]=="string"?Zi(o):Cm(Zi(_m(o,t)))}function pf(e,t,r){if(r===void 0&&(r=Mo),!t)throw ga(1,t);var o=function(l){for(var s=[],u=1;u<arguments.length;u++)s[u-1]=arguments[u];return e(t,r,lv.apply(void 0,ea([l],s,!1)))};return o.attrs=function(l){return pf(e,t,Ut(Ut({},r),{attrs:Array.prototype.concat(r.attrs,l).filter(Boolean)}))},o.withConfig=function(l){return pf(e,t,Ut(Ut({},r),l))},o}var uv=function(e){return pf(jA,e)},In=uv;X0.forEach(function(e){In[e]=uv(e)});var VA=function(){function e(t,r){this.rules=t,this.componentId=r,this.isStatic=av(t),au.registerId(this.componentId+1)}return e.prototype.createStyles=function(t,r,o,l){var s=l(df(Zi(this.rules,r,o,l)),""),u=this.componentId+t;o.insertRules(u,u,s)},e.prototype.removeStyles=function(t,r){r.clearRules(this.componentId+t)},e.prototype.renderStyles=function(t,r,o,l){t>2&&au.registerId(this.componentId+t),this.removeStyles(t,o),this.createStyles(t,r,o,l)},e}();function XA(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];var o=lv.apply(void 0,ea([e],t,!1)),l="sc-global-".concat(q0(JSON.stringify(o))),s=new VA(o,l),u=function(f){var g=gf(),m=Qn.useContext(Bf),S=Qn.useRef(g.styleSheet.allocateGSInstance(l)).current;return g.styleSheet.server&&d(S,f,g.styleSheet,m,g.stylis),Qn.useLayoutEffect(function(){if(!g.styleSheet.server)return d(S,f,g.styleSheet,m,g.stylis),function(){return s.removeStyles(S,g.styleSheet)}},[S,f,g.styleSheet,m,g.stylis]),null};function d(f,g,m,S,y){if(s.isStatic)s.renderStyles(f,gA,m,y);else{var E=Ut(Ut({},g),{theme:V0(g,S,u.defaultProps)});s.renderStyles(f,E,m,y)}}return Qn.memo(u)}function cv(e,t){var r=Re.useRef(null),o=Re.useRef(!1),l=Re.useRef(e);l.current=e;var s=Re.useCallback(function(d){o.current&&(l.current(d),r.current=requestAnimationFrame(s))},[]),u=Re.useMemo(function(){return[function(){o.current&&(o.current=!1,r.current&&cancelAnimationFrame(r.current))},function(){o.current||(o.current=!0,r.current=requestAnimationFrame(s))},function(){return o.current}]},[]);return Re.useEffect(function(){return u[0]},[]),u}function KA(e,t,r,o,l){var u;(u=e.onExit)==null||u.call(e,o,t);const s=l.find(({id:d})=>d===t);return s!=null&&s.onEnter?s.onEnter(o,r):{...r,enteredAt:o.updateContext.gameState.time}}function ZA(e,t){return t.find(({id:r})=>r===e)}function qA(e,t){return e!==t}function QA(e){console.warn(`No handler found for state: ${e}`)}const js="bushGrowing",Er="bushFull",tu="bushSpreading",na="bushDying",Tt=24,At=10,et=3e3,tt=3e3,Hf=2,JA=15,eI=5e3,hi=100,gi=20,pi=60,tI=1e3,nI=5,iI=3,rI=12,oI=940,mf=20,Rm=90,dv=45,kr=5,sI=.5,Fr=30,mi=.1,xs=.9;var Ln=(e=>(e.Berry="berry",e.Meat="meat",e))(Ln||{});const bf={berry:"",meat:""},aI={id:js,update:(e,t)=>{const{entity:r,updateContext:o}=t,l=o.deltaTime*(Tt/At);return r.age+=l,r.age>=r.lifespan?{nextState:na,data:{...e,enteredAt:o.gameState.time}}:(r.timeSinceLastBerryRegen+=l,r.timeSinceLastBerryRegen>=rI&&r.food.length<r.maxFood&&(r.food.push({type:Ln.Berry}),r.timeSinceLastBerryRegen=0),r.food.length>=r.maxFood?{nextState:Er,data:{...e,enteredAt:o.gameState.time,previousState:js}}:{nextState:js,data:e})},onEnter:(e,t)=>({...t,enteredAt:e.updateContext.gameState.time})},lI={id:Er,update:(e,t)=>{const{entity:r,updateContext:o}=t,l=o.deltaTime*(Tt/At);return r.age+=l,r.age>=r.lifespan?{nextState:na,data:{...e,enteredAt:o.gameState.time,previousState:Er}}:r.food.length<r.maxFood?{nextState:js,data:{...e,enteredAt:o.gameState.time,previousState:Er}}:(r.timeSinceLastSpreadAttempt+=l,r.timeSinceLastSpreadAttempt>=Rm&&(r.timeSinceLastSpreadAttempt=0,o.gameState.time-r.timeSinceLastHarvest>=Rm&&Math.random()<o.gameState.ecosystem.berryBushSpreadChance)?{nextState:tu,data:{...e,enteredAt:o.gameState.time,previousState:Er}}:{nextState:Er,data:e})},onEnter:(e,t)=>({...t,enteredAt:e.updateContext.gameState.time})},ia=1,vf=150*.6,uI=150*.25,cI=150*.7,dI=150*.8,fI=400,hI=800,fv=100,gI=250,pI=120,mI=2,Pm=400,vI=1e3,SI=150*.85,yI=100,TI=3,AI=96,II=24,EI=600,hv=600,wI=1,_I=24,CI=1,RI=.5,PI=2,Sf=24,yf=12,NI=24,Nm=24,DI=1500,Nd=500,OI=400,MI=10,kI=-5,FI=1.5,UI=1.5,LI=1.2,BI=10,HI=150,bI=200,GI=100,xI=.7,$I=300,zI=100,WI=120,Dm=400,gv=.15,pv=200,nu=30*.75*1.2,YI=20,jI=.3,VI=.6,XI=.8,KI=1,ZI=3,qI=5,QI=6,Om=.5,JI=.4,eE=.6,tE=.8,nE=2,Mm=800,iE=60,km=5,Fm=.7,Um=2.5,Lm=3,Bm=2,rE=.1,oE=400,sE=800,Eu=10,ra=80,aE=3,Ms=5,Ur=150,mv=Ur*.8,lE=Ur*.2,Lr=Ur*.95,Ji=30,vv=10,uE=10,cE=.5,Rt=30,Br=Rt*.75,Sv=50,dE=20,fE=ra*.8,hE=.7,gE=16,yv=40,pE=24,Gf=16,mE=72/3,Hm=24,vE=1.25,SE=1.5,xf=Ur*.6,$f=50,yE=1,TE=350,Tv=ra*.65,AE=80,IE=50,EE=1,wE=128,Av=10,bm=100,zf=35,Jn=Rt,Iv=.5,wu=2.5,_E=5,Wf=.5,Yf=1.5,CE=.1,RE=.5,PE=1.5,NE=.25,DE=2.5,OE=45,ME=.05;function Un(e,t){return{x:e.x+t.x,y:e.y+t.y}}function Ev(e,t){return{x:e.x-t.x,y:e.y-t.y}}function Pt(e,t){return{x:e.x*t,y:e.y*t}}function Fo(e){return Math.sqrt(e.x*e.x+e.y*e.y)}function nt(e){const t=Fo(e);return t===0?{x:0,y:0}:Pt(e,1/t)}function kE(e,t){return Fo(Ev(e,t))}function jf(e,t,r){return{x:e.x+(t.x-e.x)*r,y:e.y+(t.y-e.y)*r}}function lu(e){if(e.length===0)return{x:0,y:0};const t=e.reduce((r,o)=>({x:r.x+o.x,y:r.y+o.y}),{x:0,y:0});return{x:t.x/e.length,y:t.y/e.length}}function ze(e,t,r,o){let l=t.x-e.x,s=t.y-e.y;return Math.abs(l)>r/2&&(l=l-Math.sign(l)*r),Math.abs(s)>o/2&&(s=s-Math.sign(s)*o),{x:l,y:s}}function Ft(e,t,r){const o=ze(e,t,r.width,r.height);return nt(o)}function V(e,t,r,o){const l=ze(e,t,r,o);return Fo(l)}function FE(e,t){return e.x*t.x+e.y*t.y}function UE(e,t){const r=FE(e,t),o=Fo(e),l=Fo(t);if(o===0||l===0)return 0;const s=Math.max(-1,Math.min(1,r/(o*l)));return Math.acos(s)}function LE(e,t,r){const o=Math.max(0,Math.min(1,r)),l={r:parseInt(e.substring(1,3),16),g:parseInt(e.substring(3,5),16),b:parseInt(e.substring(5,7),16)},s={r:parseInt(t.substring(1,3),16),g:parseInt(t.substring(3,5),16),b:parseInt(t.substring(5,7),16)},u=Math.round(l.r+(s.r-l.r)*o),d=Math.round(l.g+(s.g-l.g)*o),f=Math.round(l.b+(s.b-l.b)*o),g=m=>("00"+m.toString(16)).slice(-2);return`#${g(u)}${g(d)}${g(f)}`}var yt=(e=>(e.Friendly="Friendly",e.Hostile="Hostile",e))(yt||{}),Ct=(e=>(e[e.None=0]="None",e[e.General=1]="General",e[e.Performance=2]="Performance",e[e.Ecosystem=3]="Ecosystem",e))(Ct||{});function Gm(e,t,r){return t.search.human.byRadius(e.position,r).filter(s=>{if(s.id===e.id||s.gender===e.gender||!s.isAdult||s.hunger>=Lr||(s.procreationCooldown||0)>0||s.gender==="female"&&s.isPregnant)return!1;const u=s.id===e.motherId||s.id===e.fatherId,d=e.id===s.motherId||e.id===s.fatherId;return!u&&!d})}function vi(e){if(e.length===0)return;const t=e.filter(l=>l.gender==="male"),r=e.filter(l=>l.gender==="female"),o=(l,s)=>l.age!==s.age?s.age-l.age:l.id-s.id;if(t.sort(o),t.length>0)return t[0];if(r.sort(o),r.length>0)return r[0]}function Lt(e,t){const r=e,o=r.search.human.byProperty("motherId",t.id),l=r.search.human.byProperty("fatherId",t.id);return[...o,...l]}function BE(e,t,r){var l;if(e.id===t.id||e.motherId===t.id||e.fatherId===t.id||t.motherId===e.id||t.fatherId===e.id||e.motherId&&e.motherId===t.motherId||e.fatherId&&e.fatherId===t.fatherId||(l=e.partnerIds)!=null&&l.includes(t.id))return!0;if(e.motherId){const s=r.entities.entities[e.motherId];if(s&&(s.motherId===t.id||s.fatherId===t.id))return!0}if(e.fatherId){const s=r.entities.entities[e.fatherId];if(s&&(s.motherId===t.id||s.fatherId===t.id))return!0}if(t.motherId){const s=r.entities.entities[t.motherId];if(s&&(s.motherId===e.id||s.fatherId===e.id))return!0}if(t.fatherId){const s=r.entities.entities[t.fatherId];if(s&&(s.motherId===e.id||s.fatherId===e.id))return!0}return!1}function xm(e,t){var s,u,d,f;if(e.id===t.id||e.motherId===t.id||e.fatherId===t.id||t.motherId===e.id||t.fatherId===e.id||(s=e.partnerIds)!=null&&s.includes(t.id)||(u=t.partnerIds)!=null&&u.includes(e.id))return!0;if(e.fatherId===void 0&&e.motherId===void 0||t.fatherId===void 0&&t.motherId===void 0)return!1;const r=e.motherId===t.motherId||e.fatherId===t.fatherId,o=t.motherId===e.motherId||t.fatherId===e.fatherId,l=((d=e.ancestorIds)==null?void 0:d.some(g=>t.ancestorIds.includes(g)))||((f=t.ancestorIds)==null?void 0:f.some(g=>e.ancestorIds.includes(g)));return r||o||l}function HE(e,t){const r=[];if(e.motherId){const o=t.entities.entities[e.motherId];o&&r.push(o)}if(e.fatherId){const o=t.entities.entities[e.fatherId];o&&r.push(o)}return r}function bE(e,t){if(e.gender!=="female"||!e.partnerIds||e.partnerIds.length===0)return null;for(const r of e.partnerIds){const o=t.entities.entities[r];if(o&&o.gender==="male")return o}return null}function GE(e,t){var r;if(!e.isAdult&&e.fatherId){const o=t.entities.entities[e.fatherId];if(o&&o.type==="human")return o}if(e.isAdult&&e.fatherId){const o=t.entities.entities[e.fatherId];if(o&&o.type==="human"&&((r=vi(Lt(t,o)))==null?void 0:r.id)===e.id)return o}return e.isAdult&&e.gender==="female"&&e.partnerIds&&e.partnerIds.length>0?bE(e,t):null}function uu(e,t){var o;const r=new Set;if(e.motherId){const l=t.entities.entities[e.motherId];l&&r.add(l)}if(e.fatherId){const l=t.entities.entities[e.fatherId];l&&r.add(l)}return(o=e.partnerIds)==null||o.forEach(l=>{const s=t.entities.entities[l];s&&r.add(s)}),Lt(t,e).forEach(l=>r.add(l)),Array.from(r)}function wv(e,t){const r=new Map;function o(l){const s=Lt(t,l);for(const u of s)r.has(u.id)||(r.set(u.id,u),o(u))}return o(e),Array.from(r.values())}function oa(e,t){return t.search.human.byProperty("leaderId",e)}function _v(e,t){var u,d;const r=new Map,o=Object.values(e.entities.entities).filter(f=>f.type==="human");for(const f of o)f.leaderId&&(r.has(f.leaderId)||r.set(f.leaderId,{leaderId:f.leaderId,tribeBadge:f.tribeBadge||"?",members:[]}),(u=r.get(f.leaderId))==null||u.members.push(f));const l=t?(d=e.entities.entities[t])==null?void 0:d.diplomacy:void 0,s=Array.from(r.values()).map(f=>{const g=e.entities.entities[f.leaderId],m=f.members.filter(y=>y.isAdult).length,S=f.members.length-m;return{leaderId:f.leaderId,tribeBadge:f.tribeBadge,adultCount:m,childCount:S,isPlayerTribe:f.leaderId===t,leaderAge:(g==null?void 0:g.age)??0,leaderGender:(g==null?void 0:g.gender)??"male",diplomacyStatus:(l==null?void 0:l[f.leaderId??-1])??yt.Friendly}});return s.sort((f,g)=>f.isPlayerTribe?-1:g.isPlayerTribe?1:g.adultCount+g.childCount-(f.adultCount+f.childCount)),s}function Bn(e,t){return e.leaderId?t.search.human.byProperty("leaderId",e.leaderId):[]}function Vf(e,t,r,o){const l=Math.random()*Math.PI*2,s=Math.sqrt(Math.random())*t,u={x:Math.cos(l)*s,y:Math.sin(l)*s},d=Un(e,u);return{x:(d.x%r+r)%r,y:(d.y%o+o)%o}}function Hn(e,t,r,o){const l=t,s={left:e.x-r,top:e.y-r,right:e.x+r,bottom:e.y+r},u=[...l.search.human.byRect(s),...l.search.berryBush.byRect(s),...l.search.corpse.byRect(s)];for(const d of u){if(o!==void 0&&d.id===o)continue;if(V(e,d.position,t.mapDimensions.width,t.mapDimensions.height)<r+d.radius)return!0}return!1}function xE(e,t,r,o,l){const s=t.mapDimensions.width,u=t.mapDimensions.height;if(!Hn(e,t,o,l))return e;const d=o;for(let f=d;f<=r;f+=d){const g=Math.ceil(2*Math.PI*f/d);for(let m=0;m<g;m++){const S=m/g*2*Math.PI,y={x:Math.cos(S)*f,y:Math.sin(S)*f},E=Un(e,y),T={x:(E.x%s+s)%s,y:(E.y%u+u)%u};if(!Hn(T,t,o,l))return T}}return null}function er(e,t){const r=t.search.building.byProperty("ownerId",e);if(r.length>0){const s=r.map(u=>u.position);return lu(s)}const o=oa(e,t);if(o.length===0){const s=t.entities.entities[e];return s?s.position:{x:0,y:0}}const l=o.map(s=>s.position);return lu(l)}function $m(e,t){const o=[...uu(e,t),e].map(l=>l.position);return lu(o)}function $E(e,t,r){const o=r.mapDimensions.width,l=r.mapDimensions.height;let s=e.x-t.position.x,u=e.y-t.position.y;return Math.abs(s)>o/2&&(s-=Math.sign(s)*o),Math.abs(u)>l/2&&(u-=Math.sign(u)*l),Math.abs(s)<=t.width/2&&Math.abs(u)<=t.height/2}function zE(e,t,r){return t.search.human.byRadius(e.position,r).filter(l=>{var s;return l.activeAction==="procreating"&&l.gender===e.gender&&typeof l.target=="number"&&((s=e.partnerIds)==null?void 0:s.includes(l.target))})[0]}function WE(e,t,r){const o=uu(e,t),l=t;for(const s of o){if(V(e.position,s.position,t.mapDimensions.width,t.mapDimensions.height)>r)continue;const d=l.search.human.byProperty("attackTargetId",s.id);for(const f of d)if(f.leaderId!==e.leaderId)return{familyMember:s,aggressor:f}}}function YE(e,t){const o=t.search.human.byRadius(e.position,$I);let l,s=1/0;for(const u of o){if(u.id===e.id||u.hitpoints<=0||u.hitpoints/u.maxHitpoints>xI||BE(e,u,t))continue;const d=V(e.position,u.position,t.mapDimensions.width,t.mapDimensions.height);d<s&&(s=d,l=u)}return l}function Xf(e,t,r){return t.search.human.byRadius(e.position,r).filter(l=>zo(e,l,t))}function jE(e,t,r){const o=r.search.human.byProperty("leaderId",e);let l=0;for(const s of o)s.attackTargetId===t&&l++;return l}function zm(e,t,r,o){const l=r.search.berryBush.byRadius(e,t),s=r.search.human.byRadius(e,t).filter(f=>f.leaderId!==o);let u=l.length*MI;u+=s.length*kI;let d;if(s.length>0){const f={};for(const m of s)m.leaderId&&(f[m.leaderId]=(f[m.leaderId]||0)+1);let g=0;for(const m in f)f[m]>g&&(g=f[m],d=parseInt(m,10))}return{score:u,occupyingTribeId:d}}function cu(e){return e.filter(t=>t.isAdult).reduce((t,r)=>{let o=r.hitpoints;return o+=(r.maxAge-r.age)*.5,o+=r.food.length*2,t+o},0)}function VE(e,t){if(e.id!==e.leaderId)return null;const r=t,o=er(e.id,t),{score:l}=zm(o,Nd/2,r,e.id);let s=null,u=l;const d=OI,f=DI;for(let g=e.position.x-f;g<e.position.x+f;g+=d)for(let m=e.position.y-f;m<e.position.y+f;m+=d){const S={x:(g%t.mapDimensions.width+t.mapDimensions.width)%t.mapDimensions.width,y:(m%t.mapDimensions.height+t.mapDimensions.height)%t.mapDimensions.height};if(V(o,S,t.mapDimensions.width,t.mapDimensions.height)<Nd*2)continue;const{score:E}=zm(S,Nd/2,r,e.id);E>u*FI&&(u=E,s=S)}return s}function Oe(e,t,r,o,l){const s=t,u=o,d="position"in e&&e.id?e:null,f=d?d.position:e,g=s.search[r].byRadius(f,u);let m=null,S=u;for(const y of g){if(y.id===(d==null?void 0:d.id)||l&&!l(y))continue;const E=V(f,y.position,t.mapDimensions.width,t.mapDimensions.height);E<S&&(S=E,m=y)}return m}function XE(e,t,r,o){return t.search[r].byRadius(e,o)}function Wm(e,t,r,o){return XE(e,t,r,o).length}function It(e){const r=e.search.human.byProperty("isPlayer",!0);return r.length>0?r[0]:void 0}function KE(e,t){var u;const o=t.search.human.byProperty("activeAction","attacking");let l=null,s=1/0;for(const d of o){if(d.attackTargetId!==e)continue;const f=V(d.position,((u=t.entities.entities[e])==null?void 0:u.position)||{x:0,y:0},t.mapDimensions.width,t.mapDimensions.height);f<s&&(l=d,s=f)}return l}function Cv(e){return Object.values(e.entities.entities).filter(t=>t.type==="human")}function ZE(e,t,r){const o=Object.values(t.entities.entities).reverse();for(const l of o)if(kE(e,l.position)<l.radius)return l}function qE(e,t,r,o){const l=Cv(o),s={};for(const u of l)!u.leaderId||u.leaderId===t||(s[u.leaderId]||(s[u.leaderId]={sumX:0,sumY:0,count:0}),s[u.leaderId].sumX+=u.position.x,s[u.leaderId].sumY+=u.position.y,s[u.leaderId].count++);for(const u in s){const d=s[u],f={x:d.sumX/d.count,y:d.sumY/d.count};if(V(e,f,o.mapDimensions.width,o.mapDimensions.height)<r)return!0}return!1}const Et=30,$o=Et*.6,Rv="#4CAF50",Pv="#FF5722",Nv="#9C27B0",QE="#2196F3",Dv="#FFC107",JE="#DC143C",Kf="#FFFFFF",Zf=[5,5],_u=5,Uo=15,ew=20,tw=16,nw=10,iw=16,rw=16,Ym=["","","","","","","","","",""],Tf=8,ow="#FFFFFF",Sn=18,Ze=15,sw="rgba(0, 0, 0, 0.7)",aw=4,Hi=150,rn=15,li=10,ji="#555",lw="#f44336",uw="#4CAF50",cw="#2196F3",dw="#FFC107",Ol=16,vr=32,Ml=28,fw=10,hw=8,gw=8,pw=8,mn=28,kl=40,mw="rgba(255, 215, 0, 0.7)",vw="rgba(0, 0, 0, 0.3)",Xn=10,jm=8,Dd=11,bi=20,Od=40,Vm=5,Sw=10,yw="#FFA500",Tw="#808080",fi=120,Ov=30,Aw=20,Wi="#2d3748",yn="#ffffff",Fl="#4a5568",Mv=5,qf="#bdc9f792",kv="#272c36ff",Fv="#a0aec0",du=300,Uv="rgba(255, 255, 255, 0.5)",Iw="rgba(0, 0, 0, 0.8)",Ew="#FFFFFF",Xm=14,Km=8,Zm=-15,Lv="#FFD700",Bv=5,ww=60,_w=-50,Cw=10,Md=12,qm=10,Rw="rgba(0, 0, 0, 0.5)",Pw="#4CAF50",Nw="#F44336",Dw="#FFC107",Ow="rgba(255, 255, 255, 0.2)",Qm="#FFFFFF",Mw="#FF6B6B",kw=5,Hv=30,ks=50,Ul=8,Jm=10,Fw="rgba(0, 0, 0, 0.5)",Uw="#FFFFFF",Lw=33,Bw=400,Hw=20,bw=10,Gw="rgba(0, 0, 0, 0.7)",xw="#FFFFFF",kd=20,e0=16,$w=.5,t0=5,bv="#FFD700",zw=40,Qf=4,Gv=3,Ww=5,xv=20,$v=5,Yw="#FFFFFF",jw="#FF6B6B",on=80,Sr=10,Ll=300,yr=15,Vw=8,Xw="rgba(0, 0, 0, 0.8)",Kw="#FFFFFF",Fd=14,n0=10,Kn=20,Zw="#FF6B6B",qw="#4CAF50",i0="#FFD700",Qw="rgba(255, 255, 0, 0.3)",Jw=2,e_=500,t_=120,n_=45,i_="#FFD700",r_=3,o_=4;let Ud=0;function Af(){const e=Ym[Ud];return Ud=(Ud+1)%Ym.length,e}const r0=40,s_=.3,a_=24,o0=500,Lo=10,zv=250,sa=12,Wv=10;var se=(e=>(e.Gather="Gather",e.Eat="Eat",e.Procreate="Procreate",e.Attack="Attack",e.Plant="Plant",e.CallToAttack="CallToAttack",e.TribeSplit="TribeSplit",e.FollowMe="FollowMe",e.FeedChild="FeedChild",e.HuntPrey="HuntPrey",e.DefendAgainstPredator="DefendAgainstPredator",e.Build="Build",e.Removal="Removal",e.Deposit="Deposit",e.Retrieve="Retrieve",e.AutopilotMove="AutopilotMove",e.AutopilotGather="AutopilotGather",e.AutopilotAttack="AutopilotAttack",e.AutopilotProcreate="AutopilotProcreate",e.AutopilotPlant="AutopilotPlant",e.AutopilotFeedChild="AutopilotFeedChild",e.AutopilotFollowMe="AutopilotFollowMe",e.AutopilotDeposit="AutopilotDeposit",e.AutopilotRetrieve="AutopilotRetrieve",e))(se||{});const Cu={Gather:"",Eat:"",Procreate:"",Attack:"",Plant:"",CallToAttack:"",TribeSplit:"",FollowMe:"",FeedChild:"",HuntPrey:"",DefendAgainstPredator:"",Build:"",Removal:"",Deposit:"",Retrieve:"",AutopilotMove:"",AutopilotGather:"",AutopilotAttack:"",AutopilotProcreate:"",AutopilotPlant:"",AutopilotFeedChild:"",AutopilotFollowMe:"",AutopilotDeposit:"",AutopilotRetrieve:""},Yv={Gather:"Gather",Eat:"Eat",Procreate:"Procreate",Attack:"Attack",Plant:"Plant",CallToAttack:"Call to Attack",TribeSplit:"Split Tribe",FollowMe:"Follow Me",FeedChild:"Feed Child",HuntPrey:"Hunt Prey",DefendAgainstPredator:"Defend",Build:"Build",Removal:"Remove",Deposit:"Deposit",Retrieve:"Retrieve",AutopilotMove:"Walk",AutopilotGather:"Gather",AutopilotAttack:"Attack",AutopilotProcreate:"Procreate",AutopilotPlant:"Plant",AutopilotFeedChild:"Feed",AutopilotFollowMe:"Follow",AutopilotDeposit:"Deposit",AutopilotRetrieve:"Retrieve"};var So=(e=>(e.Time="Time",e.Hunger="Hunger",e.Hitpoints="Hitpoints",e.Food="Food",e.Autopilot="Autopilot",e.Muted="Muted",e.Family="Family",e.Tribes="Tribes",e))(So||{});const Fs={Time:"",Hunger:"",Hitpoints:"",Food:"",Autopilot:"",Muted:"",Family:"",Tribes:""};var ge=(e=>(e.ToggleMute="ToggleMute",e.TogglePause="TogglePause",e.FastForward="FastForward",e.DismissTutorial="DismissTutorial",e.ReturnToIntro="ReturnToIntro",e.ConfirmExitYes="ConfirmExitYes",e.ConfirmExitNo="ConfirmExitNo",e.CommandEat="CommandEat",e.CommandPlant="CommandPlant",e.CommandCallToAttack="CommandCallToAttack",e.CommandFollowMe="CommandFollowMe",e.CommandGather="CommandGather",e.CommandTribeSplit="CommandTribeSplit",e.CommandBuild="CommandBuild",e.SelectStorageSpot="SelectStorageSpot",e.SelectPlantingZone="SelectPlantingZone",e.SelectRemovalTool="SelectRemovalTool",e.ToggleProcreationBehavior="ToggleProcreationBehavior",e.ToggleAttackBehavior="ToggleAttackBehavior",e.ToggleFeedChildBehavior="ToggleFeedChildBehavior",e.TogglePlantingBehavior="TogglePlantingBehavior",e.ToggleGatheringBehavior="ToggleGatheringBehavior",e.ToggleAutopilotFollowLeaderBehavior="ToggleAutopilotFollowLeaderBehavior",e.ToggleDiplomacy="ToggleDiplomacy",e))(ge||{});const l_=12,u_=24,c_=150*.9,d_=24;var aa=(e=>(e.Hello="HELLO",e.NewTribeFormed="NEW_TRIBE_FORMED",e.NoHeir="NO_HEIR",e.ChildrenStarving="CHILDREN_STARVING",e))(aa||{});let f_=0;function h_(){return`notification-${Date.now()}-${f_++}`}function If(e,t){if(t.identifier){const o=e.notifications.find(l=>l.identifier===t.identifier);if(o){if(o.dismissedUntil&&e.time<o.dismissedUntil)return;o.message=t.message,o.timestamp=e.time,o.creationTime=Date.now(),o.duration=t.duration,o.targetEntityIds=t.targetEntityIds,o.highlightedEntityIds=t.highlightedEntityIds,o.targetPosition=t.targetPosition,o.targetArea=t.targetArea,o.targetRadius=t.targetRadius,o.isDismissed=!1,o.dismissedUntil=void 0;return}}const r={...t,id:h_(),timestamp:e.time,creationTime:Date.now(),isDismissed:!1};e.notifications.push(r)}function g_(e,t){const r=e.notifications.find(o=>o.id===t);r&&(r.isDismissed=!0,r.identifier&&(r.dismissedUntil=e.time+d_))}function p_(e){const t=e.time;e.notifications=e.notifications.filter(r=>r.duration===0?!0:!(t-r.timestamp>r.duration))}function m_(e){for(const r of Object.values(e.entities.entities))r.isHighlighted=!1;const t=e.notifications.filter(r=>!r.isDismissed);for(const r of t)if(r.highlightedEntityIds)for(const o of r.highlightedEntityIds){const l=e.entities.entities[o];l&&(l.isHighlighted=!0)}}const s0=600,v_=1.5,jv=.1,Bl=""+new URL("attack-D4MA8VWK.mp3",import.meta.url).href,Ld=""+new URL("gather-CU75596W.mp3",import.meta.url).href,S_=""+new URL("eat-DCjHq2QD.mp3",import.meta.url).href,Bd=""+new URL("procreate-CfE4r5Cp.mp3",import.meta.url).href,y_=""+new URL("birth-Cbd67GHT.mp3",import.meta.url).href,T_=""+new URL("child-fed-DzEPuMid.mp3",import.meta.url).href,A_=""+new URL("human-death-B6HFLXES.mp3",import.meta.url).href,I_=""+new URL("game-over-C5dqkyER.mp3",import.meta.url).href,E_=""+new URL("button-click-DomLUeaU.mp3",import.meta.url).href,w_=""+new URL("soundtrack-1-BdlYUGye.mp3",import.meta.url).href;var fe=(e=>(e[e.Attack=0]="Attack",e[e.Gather=1]="Gather",e[e.Eat=2]="Eat",e[e.Procreate=3]="Procreate",e[e.Birth=4]="Birth",e[e.ChildFed=5]="ChildFed",e[e.HumanDeath=6]="HumanDeath",e[e.Seize=7]="Seize",e[e.CallToAttack=8]="CallToAttack",e[e.TribeSplit=9]="TribeSplit",e[e.CallToFollow=10]="CallToFollow",e[e.StorageDeposit=11]="StorageDeposit",e[e.StorageRetrieve=12]="StorageRetrieve",e[e.StorageSteal=13]="StorageSteal",e[e.GameOver=14]="GameOver",e[e.ButtonClick=15]="ButtonClick",e[e.SoundTrack1=16]="SoundTrack1",e))(fe||{});const __=new Map([[0,Bl],[1,Ld],[2,S_],[3,Bd],[4,y_],[5,T_],[6,A_],[14,I_],[15,E_],[7,Bl],[8,Bl],[9,Bd],[10,Bd],[11,Ld],[12,Ld],[13,Bl],[16,w_]]);let Us,la;function C_(){if(!(typeof window>"u"))return la}function Jf(){if(!(typeof window>"u"))return!Us&&typeof window.AudioContext=="function"&&(Us=new window.AudioContext,la=Us.createGain(),la.connect(Us.destination),Vs(.1,!1)),Us}function Vs(e,t){la&&(la.gain.value=t?0:e/10)}const Vv=new Map;let Hl=!1,a0=!1;async function R_(){if(a0||Hl)return;const e=Jf();if(!e){console.error("AudioContext not supported. Cannot load sounds.");return}e.state==="suspended"&&e.resume(),Hl=!0,console.log("Starting sound loading...");const t=[];__.forEach((r,o)=>{const l=fetch(r).then(s=>{if(!s.ok)throw new Error(`Failed to fetch sound: ${r}`);return s.arrayBuffer()}).then(s=>e.decodeAudioData(s)).then(s=>{Vv.set(o,s)}).catch(s=>{console.error(`Error loading sound ${fe[o]} from ${r}:`,s)});t.push(l)});try{await Promise.all(t),a0=!0,Hl=!1,console.log("All sounds loaded successfully.")}catch(r){Hl=!1,console.error("An error occurred while loading sounds:",r)}}const Xs=new Map;function eh(e,t){const r=Jf(),o=C_();if(!r||!o||o.gain.value===0&&(t==null?void 0:t.trackId)===void 0)return;r.state==="suspended"&&r.resume();const l=Vv.get(e);if(!l){console.warn(`Sound buffer not found for type: ${fe[e]}`);return}if(t!=null&&t.trackId&&Xs.has(t.trackId))return;const s=r.createBufferSource();s.buffer=l,s.loop=(t==null?void 0:t.loop)??!1;const u=r.createGain(),d=r.createStereoPanner();let f=u;if(t!=null&&t.position&&(t!=null&&t.listenerPosition)&&(t!=null&&t.worldDimensions)){const g=ze(t.listenerPosition,t.position,t.worldDimensions.width,t.worldDimensions.height),m=V(t.listenerPosition,t.position,t.worldDimensions.width,t.worldDimensions.height);if(m>s0)return;const S=1-Math.pow(m/s0,v_);u.gain.value=Math.max(0,S);const y=Math.sin(g.x/m*(Math.PI/2));d.pan.value=isNaN(y)?0:y,u.connect(d),f=d}else{const g=e===fe.GameOver?.4:e===fe.SoundTrack1?1:.2;u.gain.value=g}s.connect(f),f.connect(o),s.start(0),t!=null&&t.trackId&&(Xs.set(t.trackId,{sourceNode:s,gainNode:u}),s.onended=()=>{Xs.delete(t.trackId)})}function Hd(e,t=1){const r=Xs.get(e),o=Jf();if(r&&o){const{sourceNode:l,gainNode:s}=r,u=o.currentTime;s.gain.setValueAtTime(s.gain.value,u),s.gain.linearRampToValueAtTime(0,u+t),l.stop(u+t),l.onended=null,Xs.delete(e)}}function Ie(e,t,r){const o=It(e.gameState);o&&eh(t,{position:r,listenerPosition:o.position,worldDimensions:e.gameState.mapDimensions,masterVolume:e.gameState.masterVolume,isMuted:e.gameState.isMuted})}function P_(e,t,r){const o=r.mapDimensions.width,l=r.mapDimensions.height,s=t.radius*2;for(let u=o0;u<o/2;u+=50)for(let d=0;d<10;d++){const f=Vf(e,u,o,l);if(!(V(e,f,o,l)<o0)&&!Hn(f,r,s,t.id))return f}return null}function th(e,t){if(!e.isAdult||e.gender!=="male"||e.leaderId===e.id||!e.leaderId)return{canSplit:!1};if(!e.leaderId)return{canSplit:!1};const r=t.entities.entities[e.leaderId];if(!r||r.type!=="human")return{canSplit:!1};const o=vi(Lt(t,r));if(o&&o.id===e.id)return{canSplit:!1};const l=oa(e.leaderId,t);if(l.length<r0)return{canSplit:!1};const u=wv(e,t).length+1,d=Math.min(l.length*s_,r0);return{canSplit:u>=d,progress:u/d}}function nh(e,t){if(!th(e,t).canSplit)return;const r=e.leaderId?t.entities.entities[e.leaderId]:void 0,o=Af(),l=wv(e,t);e.leaderId=e.id,e.tribeBadge=o,e.diplomacy={},r&&r.diplomacy&&(r.diplomacy[e.id]=yt.Hostile);for(const u of l)u.leaderId=e.id,u.tribeBadge=o;If(t,{type:aa.NewTribeFormed,message:`A new tribe has formed! ${o}`,duration:u_,targetEntityIds:[e.id],highlightedEntityIds:[e.id,...l.map(u=>u.id)]}),Ie({gameState:t},fe.TribeSplit,e.position)}const N_=20,An=30,D_=.5,O_=.3,M_=2,Ef=50;function ih(e,t){const r=[];if(t.food.length>0&&t.hunger>Ji&&r.push({type:se.Eat,action:"eating",key:"f"}),t.food.length<t.maxFood){const s=Oe(t,e,"berryBush",Rt,f=>f.food.length>0),u=Oe(t,e,"corpse",Rt,f=>f.food.length>0);let d=null;s&&u?d=V(t.position,s.position,e.mapDimensions.width,e.mapDimensions.height)<=V(t.position,u.position,e.mapDimensions.width,e.mapDimensions.height)?s:u:d=s||u,d&&r.push({type:se.Gather,action:"gathering",key:"e",targetEntity:d})}const o=Oe(t,e,"human",Rt,s=>Hr(t,s,e));if(o&&r.push({type:se.Procreate,action:"procreating",key:"r",targetEntity:o}),t.food.length>0&&t.isAdult){const s=Oe(t,e,"human",Rt,u=>{const d=u;return!d.isAdult&&(d.motherId===t.id||d.fatherId===t.id)&&d.hunger>=Ji});s&&r.push({type:se.FeedChild,action:"feeding",key:"h",targetEntity:s})}const l=Oe(t,e,"human",Jn,s=>zo(t,s,e))??Oe(t,e,"predator",Jn)??Oe(t,e,"prey",Jn);if(l&&r.push({type:se.Attack,action:"attacking",key:"q",targetEntity:l}),t.food.filter(s=>s.type===Ln.Berry).length>=kr&&r.push({type:se.Plant,action:"planting",key:"b"}),t.food.length>0&&t.isAdult){const s=Oe(t,e,"building",An,u=>{const d=u;return d.buildingType==="storageSpot"&&d.ownerId===t.leaderId&&d.isConstructed&&d.storedFood!==void 0&&d.storageCapacity!==void 0&&d.storedFood.length<d.storageCapacity});s&&r.push({type:se.Deposit,action:"idle",key:"x",targetEntity:s})}if(t.food.length<t.maxFood&&t.isAdult){const s=Oe(t,e,"building",An,u=>{const d=u;return d.buildingType==="storageSpot"&&d.ownerId===t.leaderId&&d.isConstructed&&d.storedFood!==void 0&&d.storedFood.length>0});s&&r.push({type:se.Retrieve,action:"idle",key:"z",targetEntity:s})}return t.leaderId===t.id&&!t.isCallingToAttack&&Xf(t,e,zv).length>0&&r.push({type:se.CallToAttack,action:"idle",key:"v"}),th(t,e).canSplit&&r.push({type:se.TribeSplit,action:"idle",key:"k"}),t.leaderId===t.id&&!t.isCallingToFollow&&r.push({type:se.FollowMe,action:"idle",key:"c"}),r}const zo=(e,t,r)=>{var o,l;return e.id===t.id?!1:e.leaderId&&!t.leaderId?!0:e.leaderId===t.leaderId?!1:e.leaderId&&t.leaderId?((l=(o=r.entities.entities[e.leaderId])==null?void 0:o.diplomacy)==null?void 0:l[t.leaderId])===yt.Hostile:!1},Hr=(e,t,r)=>{if(e.id===t.id||e.gender===t.gender||!e.isAdult||!t.isAdult||e.hunger>=Lr||t.hunger>=Lr||(e.procreationCooldown||0)>0||(t.procreationCooldown||0)>0||zo(e,t,r))return!1;const o=e.gender==="female"?e:t;return!(o.isPregnant||o.age>yv)},On={StorageSpot:"storageSpot",PlantingZone:"plantingZone"},pa={[On.StorageSpot]:{name:"Storage Spot",description:"A designated area for storing excess food.",icon:"",dimensions:{width:40,height:40},constructionTimeHours:.1,destructionTimeHours:.1,cost:{}},[On.PlantingZone]:{name:"Planting Zone",description:"An area marked for agricultural use.",icon:"",dimensions:{width:60,height:60},constructionTimeHours:.1,destructionTimeHours:.1,cost:{}}},k_=.5,F_="#FFA500",U_="#FF4500",l0=4,L_=10;function Xv(e){return pa[e].dimensions}function B_(e){return pa[e].constructionTimeHours}function H_(e){return pa[e].destructionTimeHours}function rh(e,t,r,o){if(r===void 0)return!1;const l=Xv(t),s=Math.sqrt(l.width*l.width+l.height*l.height)/2;if(Hn(e,o,s*.8))return!1;const d=o.search.building.byRadius(e,s*2);for(const f of d){const g=V(e,f.position,o.mapDimensions.width,o.mapDimensions.height),m=(Math.max(l.width,l.height)+Math.max(f.width,f.height))/2;if(g<m*.9)return!1}return!0}function Kv(e,t,r,o){return yR(o.entities,e,t,r)}function b_(e,t){const r=t.entities.entities[e];r&&r.type==="building"&&!r.isBeingDestroyed&&(r.isBeingDestroyed=!0,r.destructionProgress=0)}function G_(e,t){const l=t.search.building.byRadius(e,100);for(const s of l){let u=e.x-s.position.x,d=e.y-s.position.y;const f=t.mapDimensions.width,g=t.mapDimensions.height;if(Math.abs(u)>f/2&&(u-=Math.sign(u)*f),Math.abs(d)>g/2&&(d-=Math.sign(d)*g),Math.abs(u)<=s.width/2&&Math.abs(d)<=s.height/2)return s}}const x_=500,$_=500;function z_(e,t){if(!e.leaderId)return 0;const r=W_(e.leaderId,t),o=Y_(e.leaderId,t);return o===0?0:Math.min(1,r/o)}function W_(e,t){const r=Bn({leaderId:e},t),o=ma(e,t),l=r.reduce((u,d)=>u+d.food.length,0),s=o.reduce((u,d)=>{var f;return u+(((f=d.storedFood)==null?void 0:f.length)||0)},0);return l+s}function Y_(e,t){const r=Bn({leaderId:e},t),o=ma(e,t),l=r.reduce((u,d)=>u+d.maxFood,0),s=o.reduce((u,d)=>u+(d.storageCapacity||0),0);return l+s}function Zv(e,t){const r=ma(e,t);if(r.length===0)return 0;const o=r.reduce((s,u)=>{var d;return s+(((d=u.storedFood)==null?void 0:d.length)||0)},0),l=r.reduce((s,u)=>s+(u.storageCapacity||0),0);return l===0?0:Math.min(1,o/l)}function qv(e,t){const r=Bn({leaderId:e},t);return r.length===0?0:j_(e,t)/r.length}function j_(e,t){const r=t,o=er(e,t);return r.search.berryBush.byRadius(o,x_).filter(u=>{const d=u.stateMachine&&u.stateMachine[0]==="bushDying",f=u.food.length>0;return!d&&f}).length}function oh(e,t){return e.leaderId?t.search.building.all().filter(l=>{if(l.buildingType!==On.PlantingZone||!l.isConstructed)return!1;if(l.ownerId){const s=t.entities.entities[l.ownerId];return s&&s.leaderId===e.leaderId}return!1}):[]}function V_(e){const t=Fr*2,r=Math.floor(e.width/t),o=Math.floor(e.height/t);return r*o}function X_(e,t){const r=t,o=Math.max(e.width,e.height);return r.search.berryBush.byRadius(e.position,o).filter(u=>{const d=Math.abs(u.position.x-e.position.x),f=Math.abs(u.position.y-e.position.y);return d<=e.width/2&&f<=e.height/2}).length}function K_(e,t){if(!e.leaderId)return[];const r=ma(e.leaderId,t),o=Bn(e,t);return r.map(l=>{var g;const s=l.storageCapacity||0,u=((g=l.storedFood)==null?void 0:g.length)||0,d=o.filter(m=>{if(m.activeAction!=="depositing")return!1;if(typeof m.target=="object"&&"x"in m.target){const S=m.target;return V(S,l.position,t.mapDimensions.width,t.mapDimensions.height)<=50}return!1}).length,f=V(e.position,l.position,t.mapDimensions.width,t.mapDimensions.height);return{storage:l,capacity:s,currentFood:u,assignedDepositors:d,distance:f}})}function Z_(e,t){const r=K_(e,t);if(r.length===0)return null;const o=r.filter(l=>{const s=l.currentFood<l.capacity,u=l.distance<=$_;return s&&u});return o.length===0?null:(o.sort((l,s)=>{const u=l.currentFood/l.capacity,d=s.currentFood/s.capacity;return Math.abs(u-d)>.1?u-d:l.assignedDepositors!==s.assignedDepositors?l.assignedDepositors-s.assignedDepositors:l.distance-s.distance}),o[0].storage)}function Qv(e,t,r){return Bn({leaderId:e},t).filter(l=>l.activeAction===r).length}function ma(e,t){return t.search.building.all().filter(l=>{if(l.buildingType!==On.StorageSpot||!l.isConstructed)return!1;if(l.ownerId){const s=t.entities.entities[l.ownerId];return s&&s.leaderId===e}return!1})}function q_(e,t){const r=oh(e,t);if(r.length===0)return null;const o=t.mapDimensions.width,l=t.mapDimensions.height;for(const s of r){const u=V_(s);if(X_(s,t)>=u)continue;const f=20;for(let g=0;g<f;g++){const m=s.position.x+(Math.random()-.5)*s.width,S=s.position.y+(Math.random()-.5)*s.height,y={x:(m%o+o)%o,y:(S%l+l)%l};if(!Hn(y,t,Fr))return y}}return null}function Q_(e,t,r){return oh(t,r).some(s=>$E(e,s,r))?!Hn(e,r,Fr):!1}const J_={id:tu,update:(e,t)=>{const{entity:r,updateContext:o}=t,{gameState:l}=o,s=o.deltaTime*(Tt/At);if(r.age+=s,r.age>=r.lifespan)return{nextState:na,data:{...e,enteredAt:l.time,previousState:tu}};const u=Vf(r.position,r.spreadRadius,l.mapDimensions.width,l.mapDimensions.height);return Hn(u,l,15)||ya(l.entities,u,l.time),{nextState:Er,data:{...e,enteredAt:l.time,previousState:tu}}},onEnter:(e,t)=>({...t,enteredAt:e.updateContext.gameState.time})},eC={id:na,update:e=>({nextState:na,data:e}),onEnter:(e,t)=>(jo(e.updateContext.gameState.entities,e.entity.id),{...t,enteredAt:e.updateContext.gameState.time})},tC=[aI,lI,J_,eC],ct="humanIdle",Ir="humanMoving",$s="humanEating",va="humanGathering",Ks="humanDepositing",Zs="humanRetrieving",ua="humanProcreating",tr="humanAttacking",iu="humanPlanting",nC={id:ct,update:(e,t)=>{const{entity:r,updateContext:o}=t;return r.activeAction==="attacking"&&r.attackTargetId?{nextState:tr,data:{...e,enteredAt:o.gameState.time,previousState:ct,attackTargetId:r.attackTargetId,attackStartTime:o.gameState.time}}:(r.hunger>=mv?(r.debuffs=r.debuffs.filter(l=>l.type!=="slow"),r.debuffs.push({type:"slow",startTime:o.gameState.time,duration:.1})):r.debuffs=r.debuffs.filter(l=>l.type!=="slow"),r.activeAction==="moving"?{nextState:Ir,data:{...e,enteredAt:o.gameState.time,previousState:ct,target:r.target}}:r.activeAction==="gathering"?{nextState:va,data:{...e,enteredAt:o.gameState.time,previousState:ct,target:r.target}}:r.activeAction==="eating"?{nextState:$s,data:{...e,enteredAt:o.gameState.time,previousState:ct}}:r.activeAction==="planting"&&r.target?{nextState:iu,data:{...e,enteredAt:o.gameState.time,previousState:ct,plantingSpot:r.target}}:r.activeAction==="depositing"?{nextState:Ks,data:{...e,enteredAt:o.gameState.time,previousState:ct}}:r.activeAction==="retrieving"?{nextState:Zs,data:{...e,enteredAt:o.gameState.time,previousState:ct}}:{nextState:ct,data:e})},onEnter:(e,t)=>(e.entity.acceleration=0,e.entity.velocity={x:0,y:0},{...t,enteredAt:e.updateContext.gameState.time})};function Jv(e){let t=uE;return e.hunger>=mv&&(t*=cE),e.age>=fE&&(t*=hE),e.movementSlowdown&&(t*=e.movementSlowdown.modifier),t}const bd=7.5;class iC{constructor(){De(this,"id",Ir)}update(t,r){var f;const{entity:o,updateContext:l}=r;if(o.activeAction==="attacking"&&o.attackTargetId)return{nextState:tr,data:{...t,enteredAt:l.gameState.time,previousState:Ir,attackTargetId:o.attackTargetId,attackStartTime:l.gameState.time}};if(o.activeAction!=="moving")return{nextState:ct,data:{...t,enteredAt:l.gameState.time,previousState:Ir}};let s;if(typeof o.target=="object"?s=o.target:typeof o.target=="number"&&(s=(f=r.updateContext.gameState.entities.entities[o.target])==null?void 0:f.position),!s&&(o.direction.x!==0||o.direction.y!==0)&&(s={x:o.position.x+o.direction.x*bd*2,y:o.position.y+o.direction.y*bd*2}),!s)return{nextState:ct,data:{...t,enteredAt:l.gameState.time,previousState:Ir}};const u=ze(o.position,s,r.updateContext.gameState.mapDimensions.width,r.updateContext.gameState.mapDimensions.height);return o.direction=nt(u),o.acceleration=Jv(o),V(o.position,s,l.gameState.mapDimensions.width,l.gameState.mapDimensions.height)<bd?{nextState:ct,data:{...t,enteredAt:l.gameState.time,previousState:Ir}}:{nextState:Ir,data:t}}onExit(t){const{entity:r}=t;r.acceleration=0}}const rC=new iC,xe=1,_r=3,oC=70;function Me(e,t,r,o,l){const s={id:e.nextVisualEffectId,type:t,position:r,startTime:e.time,duration:o,entityId:l};return e.visualEffects.push(s),e.nextVisualEffectId++,s.id}var ce=(e=>(e[e.Hunger=0]="Hunger",e[e.Procreation=1]="Procreation",e[e.Pregnant=2]="Pregnant",e[e.TargetAcquired=3]="TargetAcquired",e[e.Attack=4]="Attack",e[e.Partnered=5]="Partnered",e[e.BushClaimed=6]="BushClaimed",e[e.BushClaimLost=7]="BushClaimLost",e[e.Eating=8]="Eating",e[e.ChildFed=9]="ChildFed",e[e.AttackDeflected=10]="AttackDeflected",e[e.AttackResisted=11]="AttackResisted",e[e.Hit=12]="Hit",e[e.SeizeBuildup=13]="SeizeBuildup",e[e.Seize=14]="Seize",e[e.CallToAttack=15]="CallToAttack",e[e.CallToFollow=16]="CallToFollow",e[e.AutopilotMoveTarget=17]="AutopilotMoveTarget",e))(ce||{});const sC={id:$s,update:(e,t)=>{const{entity:r,updateContext:o}=t;return r.activeAction!=="eating"?{nextState:ct,data:{...e,enteredAt:o.gameState.time,previousState:$s}}:(r.food.length>0&&(!r.eatingCooldownTime||o.gameState.time>=r.eatingCooldownTime)&&r.hunger>Ji&&(r.hunger=Math.max(0,r.hunger-Ji),r.food.pop(),r.eatingCooldownTime=o.gameState.time+1,Ie(o,fe.Eat,r.position),(!r.lastEatingEffectTime||o.gameState.time-r.lastEatingEffectTime>2)&&(Me(o.gameState,ce.Eating,r.position,xe,r.id),r.lastEatingEffectTime=o.gameState.time)),r.hunger<=0||r.food.length<=0?{nextState:ct,data:{...e,enteredAt:o.gameState.time,previousState:$s}}:{nextState:$s,data:e})},onEnter:(e,t)=>(e.entity.acceleration=0,e.entity.velocity={x:0,y:0},{...t,enteredAt:e.updateContext.gameState.time})};class aC{constructor(){De(this,"id",va)}update(t,r){return r.entity.activeAction!=="gathering"?{nextState:"humanIdle",data:{...t,enteredAt:r.updateContext.gameState.time,previousState:this.id}}:{nextState:this.id,data:t}}}const lC=new aC,uC={id:Ks,update:(e,t)=>{const{entity:r}=t;return r.activeAction!=="depositing"?{nextState:ct,data:{...e,enteredAt:t.updateContext.gameState.time,previousState:Ks}}:{nextState:Ks,data:e}},onEnter:(e,t)=>{const{entity:r}=e;return r.activeAction="depositing",t},onExit:e=>{const{entity:t}=e;t.activeAction==="depositing"&&(t.activeAction="idle")}},cC={id:Zs,update:(e,t)=>{const{entity:r}=t;return r.activeAction!=="retrieving"?{nextState:ct,data:{...e,enteredAt:t.updateContext.gameState.time,previousState:Zs}}:{nextState:Zs,data:e}},onEnter:(e,t)=>{const{entity:r}=e;return r.activeAction="retrieving",t},onExit:e=>{const{entity:t}=e;t.activeAction==="retrieving"&&(t.activeAction="idle")}},dC=(e,t)=>(t.procreationEndTime=e.updateContext.gameState.time+(t.duration||2),t),fC=(e,t)=>{const{entity:r,updateContext:o}=t,{gameState:l}=o;if(l.time<(e.procreationEndTime||0))return{nextState:ua,data:e};const s=l.entities.entities[e.partnerId];if(s&&s.type==="human"&&!s.isPregnant&&r.hunger<Lr&&s.hunger<Lr&&!r.procreationCooldown&&!s.procreationCooldown){const u=r.gender==="female"?r:s.gender==="female"?s:void 0,d=r.gender==="male"?r:s.gender==="male"?s:void 0;u&&d&&(u.isPregnant=!0,u.gestationTime=mE,u.pregnancyFatherId=d.id,r.procreationCooldown=Hm,s.procreationCooldown=Hm,Ie(o,fe.Procreate,u.position))}return r.activeAction="idle",s&&(s.activeAction="idle"),{nextState:ct,data:{...e,enteredAt:l.time,previousState:ua}}},hC={id:ua,onEnter:dC,update:fC},gC={id:tr,onEnter:(e,t)=>({...t,enteredAt:e.updateContext.gameState.time,attackStartTime:e.updateContext.gameState.time}),update:(e,t)=>{if(t.entity.activeAction!=="attacking"||!t.entity.attackTargetId)return t.entity.activeAction="idle",{nextState:ct,data:{...e}};const r=t.updateContext.gameState.entities.entities[t.entity.attackTargetId];if(!r)return t.entity.activeAction="idle",{nextState:ct,data:{...e}};const o=V(t.entity.position,r.position,t.updateContext.gameState.mapDimensions.width,t.updateContext.gameState.mapDimensions.height),l=ze(t.entity.position,r.position,t.updateContext.gameState.mapDimensions.width,t.updateContext.gameState.mapDimensions.height);return t.entity.direction=nt(l),o>Jn?t.entity.acceleration=Jv(t.entity):t.entity.acceleration=0,{nextState:tr,data:e}}},pC={id:iu,update:(e,t)=>{const{entity:r,updateContext:o}=t,{gameState:l}=o;if(l.time-e.enteredAt>=sI){if(r.food.filter(d=>d.type===Ln.Berry).length>=kr){for(let d=0;d<kr;d++){const f=r.food.findIndex(g=>g.type===Ln.Berry);f>-1&&r.food.splice(f,1)}ya(l.entities,e.plantingSpot,l.time)}return{nextState:ct,data:{...e,enteredAt:l.time,previousState:iu}}}return{nextState:iu,data:e}},onEnter:(e,t)=>(e.entity.acceleration=0,e.entity.velocity={x:0,y:0},{...t,enteredAt:e.updateContext.gameState.time})},mC=[nC,rC,sC,lC,uC,cC,hC,gC,pC],Mn="preyIdle",Yi="preyMoving",zs="preyGrazing",Ws="preyProcreating",vC={id:Mn,update:(e,t)=>{const{entity:r,updateContext:o}=t;return r.activeAction==="moving"?{nextState:Yi,data:{...e,enteredAt:o.gameState.time,previousState:Mn,target:r.target}}:r.activeAction==="grazing"?{nextState:zs,data:{...e,enteredAt:o.gameState.time,previousState:Mn}}:r.activeAction==="procreating"?{nextState:Ws,data:{...e,enteredAt:o.gameState.time,previousState:Mn}}:{nextState:Mn,data:e}},onEnter:(e,t)=>(e.entity.acceleration=0,e.entity.velocity={x:0,y:0},{...t,enteredAt:e.updateContext.gameState.time})},eS=12,SC=120,u0=50,yC=12,tS=30,TC=2,zt=50,AC=100,qs=2,Gd=3,IC=.9,EC=1,wC=50,_C=.5,nS=20,CC=140,c0=40,RC=12,iS=40,PC=3,qi=60,kn=40,yo=50,d0=320,rS=25,NC=60,oS=2,DC=90,OC=.7,MC=1,Qs=3,xd=15,sh=80,sS=10,Ru=80,Wo=40,aS=2,fu=30,Io=20,Rr=40,Eo=24,Pr=48,wo=12,Nr=40,_o=20,Dr=60,Co=.75,Vi=2.5,Ro=.25,Xi=2;function kC(e){let t=yC;return e.isAdult||(t*=.7),e.hunger>=wC&&(t*=_C),e.movementSlowdown&&(t*=e.movementSlowdown.modifier),t}function FC(e,t){const r=e>>16&255,o=e>>8&255,l=e&255,s=t>>16&255,u=t>>8&255,d=t&255;let f=Math.floor((r+s)/2),g=Math.floor((o+u)/2),m=Math.floor((l+d)/2);return Math.random()<.05&&(f=Math.max(0,Math.min(255,f+(Math.random()-.5)*60))),Math.random()<.05&&(g=Math.max(0,Math.min(255,g+(Math.random()-.5)*60))),Math.random()<.05&&(m=Math.max(0,Math.min(255,m+(Math.random()-.5)*60))),f<<16|g<<8|m}function ca(){const e=Math.floor(Math.random()*100)+100,t=Math.floor(Math.random()*80)+60,r=Math.floor(Math.random()*60)+20;return e<<16|t<<8|r}const $d=10;class UC{constructor(){De(this,"id",Yi)}update(t,r){var f;const{entity:o,updateContext:l}=r;if(o.activeAction!=="moving")return{nextState:Mn,data:{...t,enteredAt:l.gameState.time,previousState:Yi}};let s;if(typeof o.target=="object"?s=o.target:typeof o.target=="number"&&(s=(f=r.updateContext.gameState.entities.entities[o.target])==null?void 0:f.position),!s&&(o.direction.x!==0||o.direction.y!==0)&&(s={x:o.position.x+o.direction.x*$d*2,y:o.position.y+o.direction.y*$d*2}),!s)return{nextState:Mn,data:{...t,enteredAt:l.gameState.time,previousState:Yi}};const u=ze(o.position,s,r.updateContext.gameState.mapDimensions.width,r.updateContext.gameState.mapDimensions.height);return o.direction=nt(u),o.acceleration=kC(o),V(o.position,s,l.gameState.mapDimensions.width,l.gameState.mapDimensions.height)<$d?{nextState:Mn,data:{...t,enteredAt:l.gameState.time,previousState:Yi}}:{nextState:Yi,data:t}}onExit(t){const{entity:r}=t;r.acceleration=0}onEnter(t,r){return{...r,enteredAt:t.updateContext.gameState.time}}}const LC=new UC,BC={id:zs,update:(e,t)=>{const{entity:r,updateContext:o}=t;return r.activeAction==="moving"?{nextState:Yi,data:{...e,enteredAt:o.gameState.time,previousState:zs,target:r.target}}:r.activeAction!=="grazing"?{nextState:Mn,data:{...e,enteredAt:o.gameState.time,previousState:zs}}:{nextState:zs,data:e}},onEnter:(e,t)=>(e.entity.acceleration=0,e.entity.velocity={x:0,y:0},{...t,enteredAt:e.updateContext.gameState.time})},HC={id:Ws,update:(e,t)=>{const{entity:r,updateContext:o}=t;return r.activeAction==="moving"?{nextState:Yi,data:{...e,enteredAt:o.gameState.time,previousState:Ws,target:r.target}}:r.activeAction!=="procreating"?{nextState:Mn,data:{...e,enteredAt:o.gameState.time,previousState:Ws}}:{nextState:Ws,data:e}},onEnter:(e,t)=>(e.entity.acceleration=0,e.entity.velocity={x:0,y:0},{...t,enteredAt:e.updateContext.gameState.time})},bC=[vC,LC,BC,HC],$t="predatorIdle",$i="predatorMoving",di="predatorAttacking",To="predatorProcreating",Or="predatorEating",GC={id:$t,update:(e,t)=>{const{entity:r,updateContext:o}=t;return r.activeAction==="eating"?{nextState:Or,data:{...e,enteredAt:o.gameState.time,previousState:$t,preyId:r.attackTargetId,eatingStartTime:o.gameState.time}}:r.activeAction==="attacking"&&r.attackTargetId?{nextState:di,data:{...e,enteredAt:o.gameState.time,previousState:$t,attackTargetId:r.attackTargetId,attackStartTime:o.gameState.time}}:r.activeAction==="moving"?{nextState:$i,data:{...e,enteredAt:o.gameState.time,previousState:$t,target:r.target}}:r.activeAction==="procreating"?{nextState:To,data:{...e,enteredAt:o.gameState.time,previousState:$t}}:{nextState:$t,data:e}},onEnter:(e,t)=>(e.entity.acceleration=0,e.entity.velocity={x:0,y:0},{...t,enteredAt:e.updateContext.gameState.time})};function lS(e){let t=RC;return e.hunger>=DC&&(t*=OC),e.isAdult||(t*=.7),e.movementSlowdown&&(t*=e.movementSlowdown.modifier),t}function xC(e,t){const r=e>>16&255,o=e>>8&255,l=e&255,s=t>>16&255,u=t>>8&255,d=t&255;let f=Math.floor((r+s)/2),g=Math.floor((o+u)/2),m=Math.floor((l+d)/2);return Math.random()<.05&&(f=Math.max(0,Math.min(255,f+(Math.random()-.5)*60))),Math.random()<.05&&(g=Math.max(0,Math.min(255,g+(Math.random()-.5)*60))),Math.random()<.05&&(m=Math.max(0,Math.min(255,m+(Math.random()-.5)*60))),f<<16|g<<8|m}function da(){const e=Math.floor(Math.random()*60)+60,t=Math.floor(Math.random()*50)+40,r=Math.floor(Math.random()*40)+20;return e<<16|t<<8|r}const zd=12;class $C{constructor(){De(this,"id",$i)}update(t,r){var f;const{entity:o,updateContext:l}=r;if(o.activeAction==="eating")return{nextState:Or,data:{...t,enteredAt:l.gameState.time,previousState:$i,preyId:o.attackTargetId,eatingStartTime:l.gameState.time}};if(o.activeAction==="attacking"&&o.attackTargetId)return{nextState:di,data:{...t,enteredAt:l.gameState.time,previousState:$i,attackTargetId:o.attackTargetId,attackStartTime:l.gameState.time}};if(o.activeAction!=="moving")return{nextState:$t,data:{...t,enteredAt:l.gameState.time,previousState:$i}};let s;if(typeof o.target=="object"?s=o.target:typeof o.target=="number"&&(s=(f=r.updateContext.gameState.entities.entities[o.target])==null?void 0:f.position),!s&&(o.direction.x!==0||o.direction.y!==0)&&(s={x:o.position.x+o.direction.x*zd*2,y:o.position.y+o.direction.y*zd*2}),!s)return{nextState:$t,data:{...t,enteredAt:l.gameState.time,previousState:$i}};const u=ze(o.position,s,r.updateContext.gameState.mapDimensions.width,r.updateContext.gameState.mapDimensions.height);return o.direction=nt(u),o.acceleration=lS(o),V(o.position,s,l.gameState.mapDimensions.width,l.gameState.mapDimensions.height)<zd?{nextState:$t,data:{...t,enteredAt:l.gameState.time,previousState:$i}}:{nextState:$i,data:t}}onExit(t){const{entity:r}=t;r.acceleration=0}onEnter(t,r){return{...r,enteredAt:t.updateContext.gameState.time}}}const zC=new $C,WC={id:di,update:(e,t)=>{const{entity:r,updateContext:o}=t;if(r.activeAction==="eating")return{nextState:Or,data:{...e,enteredAt:o.gameState.time,previousState:di,preyId:r.attackTargetId,eatingStartTime:o.gameState.time}};if(r.activeAction!=="attacking"||!r.attackTargetId)return r.activeAction="idle",{nextState:$t,data:{...e,enteredAt:o.gameState.time,previousState:di}};const l=o.gameState.entities.entities[r.attackTargetId];if(!l)return r.activeAction="idle",{nextState:$t,data:{...e,enteredAt:o.gameState.time,previousState:di}};if(l.type==="prey"&&l.hitpoints<=0||l.type==="predator"&&l.hitpoints<=0||l.type==="human"&&l.hitpoints<=0)return r.activeAction="idle",{nextState:$t,data:{...e,enteredAt:o.gameState.time,previousState:di}};const u=V(r.position,l.position,o.gameState.mapDimensions.width,o.gameState.mapDimensions.height),d=ze(r.position,l.position,o.gameState.mapDimensions.width,o.gameState.mapDimensions.height);return r.direction=nt(d),u>kn?r.acceleration=lS(r):r.acceleration=0,{nextState:di,data:e}},onEnter:(e,t)=>({...t,enteredAt:e.updateContext.gameState.time})},YC={id:To,update:(e,t)=>{const{entity:r,updateContext:o}=t;return r.activeAction==="eating"?{nextState:Or,data:{...e,enteredAt:o.gameState.time,previousState:To,preyId:r.attackTargetId,eatingStartTime:o.gameState.time}}:r.activeAction==="attacking"&&r.attackTargetId?{nextState:di,data:{...e,enteredAt:o.gameState.time,previousState:To,attackTargetId:r.attackTargetId,attackStartTime:o.gameState.time}}:r.activeAction!=="procreating"?{nextState:$t,data:{...e,enteredAt:o.gameState.time,previousState:To}}:{nextState:To,data:e}},onEnter:(e,t)=>(e.entity.acceleration=0,e.entity.velocity={x:0,y:0},{...t,enteredAt:e.updateContext.gameState.time})},jC={id:Or,update:(e,t)=>{const{entity:r,updateContext:o}=t;return r.activeAction!=="eating"?{nextState:$t,data:{...e,enteredAt:o.gameState.time,previousState:Or}}:{nextState:Or,data:e}},onEnter:(e,t)=>(e.entity.acceleration=0,e.entity.velocity={x:0,y:0},{...t,enteredAt:e.updateContext.gameState.time})},VC=[GC,zC,WC,YC,jC],f0=[...tC,...mC,...bC,...VC];function XC(e,t,r){const o=ZA(e,f0);if(!o)return QA(e),[e,t];const{nextState:l,data:s}=o.update(t,r);return qA(e,l)?[l,KA(o,l,s,r,f0)]:[l,s]}function KC(e,t,r){const{gameState:o}=t,l=r*(Tt/At);if(e.isAdult=e.age>=Gf,e.isCallingToAttack&&e.callToAttackEndTime&&o.time>e.callToAttackEndTime&&(e.isCallingToAttack=!1,e.callToAttackEndTime=void 0),e.isCallingToFollow&&e.callToFollowEndTime&&o.time>e.callToFollowEndTime&&(e.isCallingToFollow=!1,e.callToFollowEndTime=void 0),e.movementSlowdown&&o.time>e.movementSlowdown.endTime&&(e.movementSlowdown=void 0),e.hitpoints<e.maxHitpoints){const u=1-e.hunger/100*RE,d=CE*u*l;e.hitpoints=Math.min(e.maxHitpoints,e.hitpoints+d)}if(e.hunger+=r*(Ms/(Tt/At)),e.hunger>oC&&(!e.lastHungerEffectTime||o.time-e.lastHungerEffectTime>_r*2)&&(Me(o,ce.Hunger,e.position,_r,e.id),e.lastHungerEffectTime=o.time),e.age+=r/Eu,e.isPlayer){const u=Lt(o,e).filter(d=>d.hunger>=c_);if(u.length>0){const d=u.map(f=>f.id);If(o,{identifier:"children_starving",type:aa.ChildrenStarving,message:"Your children are starving!",duration:l_,targetEntityIds:d,highlightedEntityIds:d})}}if(e.gender==="female"&&e.isPregnant&&e.gestationTime&&(e.gestationTime-=l,e.hunger+=r*((Ms*vE-Ms)/(Tt/At)),(!e.lastPregnantEffectTime||o.time-e.lastPregnantEffectTime>_r*3)&&(Me(o,ce.Pregnant,e.position,_r,e.id),e.lastPregnantEffectTime=o.time),e.gestationTime<=0&&(SR(e,e.pregnancyFatherId,t),e.isPregnant=!1,e.gestationTime=0,e.pregnancyFatherId=void 0)),e.procreationCooldown&&(e.procreationCooldown-=l,e.procreationCooldown<0&&(e.procreationCooldown=0)),e.attackCooldown&&(e.attackCooldown-=l,e.attackCooldown<0&&(e.attackCooldown=0)),e.feedParentCooldownTime&&(e.feedParentCooldownTime-=l,e.feedParentCooldownTime<0&&(e.feedParentCooldownTime=0)),e.feedChildCooldownTime&&(e.feedChildCooldownTime-=l,e.feedChildCooldownTime<0&&(e.feedChildCooldownTime=0)),e.leaderMetaStrategyCooldown&&(e.leaderMetaStrategyCooldown-=l,e.leaderMetaStrategyCooldown<0&&(e.leaderMetaStrategyCooldown=0)),e.isAdult?e.radius===$o&&(e.radius=Et):e.hunger+=r*((Ms*SE-Ms)/(Tt/At)),e.isAdult&&e.food.length>0&&(!e.feedParentCooldownTime||e.feedParentCooldownTime<=0)){const u=[];if(e.motherId){const d=o.entities.entities[e.motherId];d&&u.push(d)}if(e.fatherId){const d=o.entities.entities[e.fatherId];d&&u.push(d)}for(const d of u)if(d.age>=Tv&&d.hunger>=AE&&V(e.position,d.position,o.mapDimensions.width,o.mapDimensions.height)<=IE){e.food.pop(),d.hunger=Math.max(0,d.hunger-Ji),e.feedParentCooldownTime=EE;break}}let s;if(e.hitpoints<=0?s="killed":e.hunger>=Ur?e.food.length>0&&e.isAdult?(e.food.pop(),e.hunger=Math.max(0,e.hunger-Ji)):s="hunger":e.age>=e.maxAge&&(s="oldAge"),s){if(e.leaderId===e.id){const u=vi(Lt(o,e));u?(u.leaderId=u.id,u.tribeBadge=e.tribeBadge,u.diplomacy={...e.diplomacy},Object.values(o.entities.entities).forEach(d=>{if(d.type==="human"&&d.leaderId===e.id){const f=d;f.leaderId=u.id}if(d.type==="building"&&d.ownerId===e.id){const f=d;f.ownerId=u.id}})):Object.values(o.entities.entities).forEach(d=>{if(d.type==="human"&&d.leaderId===e.id){const f=d;f.leaderId=void 0,f.tribeBadge=void 0}if(d.type==="building"&&d.ownerId===e.id){const f=d;f.ownerId=void 0}})}if(e.isPlayer){const u=vi(Lt(o,e));u?(u.isPlayer=!0,o.generationCount++):(o.gameOver=!0,o.causeOfGameOver=s,If(o,{identifier:"no_heir",type:aa.NoHeir,message:"Your lineage has ended. You have no heir.",duration:0}))}pR(o.entities,e.position,e.gender,e.age,e.radius,e.id,o.time,e.food,e.hunger),jo(o.entities,e.id);return}e.animationProgress===void 0&&(e.animationProgress=0),e.animationSpeed===void 0&&(e.animationSpeed=1),e.animationProgress+=r*e.animationSpeed,e.animationProgress>=1&&(e.animationProgress=0)}function ZC(e,t){const r=t.gameState.time-e.timeOfDeath;e.decayProgress=Math.min(1,r/wE);const o=Math.floor(Av*(1-e.decayProgress));e.food.length>o&&e.food.splice(o),e.decayProgress>=1&&e.food.length<=0&&jo(t.gameState.entities,e.id)}function qC(e,t,r){const o=r*(Tt/At);e.age+=r/Eu,e.isAdult=e.age>=qs;let l=t.gameState.ecosystem.preyHungerIncreasePerHour*o;if(e.isPregnant&&(l*=1.2),e.hunger+=l,e.isPregnant&&e.gestationTime!==void 0&&(e.gestationTime-=o,e.gestationTime<=0)){const u={x:e.position.x+(Math.random()-.5)*40,y:e.position.y+(Math.random()-.5)*40};u.x=Math.max(20,Math.min(t.gameState.mapDimensions.width-20,u.x)),u.y=Math.max(20,Math.min(t.gameState.mapDimensions.height-20,u.y));const d=Math.random()<.5?"male":"female",f=e,g=e.fatherId?t.gameState.entities.entities[e.fatherId]:void 0;let m;if(g)m=FC(f.geneCode,g.geneCode);else{m=f.geneCode;const S=Math.floor((Math.random()-.5)*4096);m=Math.max(0,Math.min(16777215,m+S))}Ho(t.gameState.entities,u,d,0,tS*.5,m,e.id,e.fatherId),Me(t.gameState,ce.Procreation,e.position,_r,e.id),Ie(t,fe.Birth,e.position),e.isPregnant=!1,e.gestationTime=0,e.procreationCooldown=t.gameState.ecosystem.preyProcreationCooldown,e.fatherId=void 0}e.procreationCooldown&&e.procreationCooldown>0&&(e.procreationCooldown-=o,e.procreationCooldown<0&&(e.procreationCooldown=0)),e.eatingCooldownTime&&e.eatingCooldownTime>t.gameState.time||(e.eatingCooldownTime=void 0),e.fleeCooldown&&e.fleeCooldown>0&&(e.fleeCooldown-=o,e.fleeCooldown<0&&(e.fleeCooldown=0)),e.feedChildCooldownTime&&e.feedChildCooldownTime>0&&(e.feedChildCooldownTime-=o,e.feedChildCooldownTime<0&&(e.feedChildCooldownTime=0));let s=!1;e.hunger>=SC&&(s=!0),e.hitpoints<=0&&(s=!0),e.age>=eS&&(s=!0),s&&(mR(t.gameState.entities,e.position,e.gender,e.age,e.radius,e.id,t.gameState.time,e.geneCode),jo(t.gameState.entities,e.id))}function QC(e,t,r){const o=r*(Tt/At);e.age+=r/Eu,e.isAdult=e.age>=Qs;let l=t.gameState.ecosystem.predatorHungerIncreasePerHour*o;if(e.isPregnant&&(l*=1.3),e.hunger+=l,e.isPregnant&&e.gestationTime!==void 0&&(e.gestationTime-=o,e.gestationTime<=0)){const u={x:e.position.x+(Math.random()-.5)*50,y:e.position.y+(Math.random()-.5)*50};u.x=Math.max(25,Math.min(t.gameState.mapDimensions.width-25,u.x)),u.y=Math.max(25,Math.min(t.gameState.mapDimensions.height-25,u.y));const d=Math.random()<.5?"male":"female",f=e,g=e.pregnancyFatherId?t.gameState.entities.entities[e.pregnancyFatherId]:void 0;let m;if(g)m=xC(f.geneCode,g.geneCode);else{m=f.geneCode;const S=Math.floor((Math.random()-.5)*4096);m=Math.max(0,Math.min(16777215,m+S))}bo(t.gameState.entities,u,d,0,iS*.6,m,e.id,e.pregnancyFatherId),Me(t.gameState,ce.Procreation,e.position,_r,e.id),Ie(t,fe.Birth,e.position),e.isPregnant=!1,e.gestationTime=0,e.procreationCooldown=t.gameState.ecosystem.predatorProcreationCooldown,e.pregnancyFatherId=void 0}e.procreationCooldown&&e.procreationCooldown>0&&(e.procreationCooldown-=o,e.procreationCooldown<0&&(e.procreationCooldown=0)),e.attackCooldown&&e.attackCooldown>0&&(e.attackCooldown-=o,e.attackCooldown<0&&(e.attackCooldown=0)),e.huntCooldown&&e.huntCooldown>0&&(e.huntCooldown-=o,e.huntCooldown<0&&(e.huntCooldown=0)),e.feedChildCooldownTime&&e.feedChildCooldownTime>0&&(e.feedChildCooldownTime-=o,e.feedChildCooldownTime<0&&(e.feedChildCooldownTime=0));let s=!1;e.hunger>=CC&&(s=!0),e.hitpoints<=0&&(s=!0),e.age>=nS&&(s=!0),s&&(vR(t.gameState.entities,e.position,e.gender,e.age,e.radius,e.id,t.gameState.time,e.geneCode),jo(t.gameState.entities,e.id))}var Sa=(e=>(e[e.BehaviorTreeBased=0]="BehaviorTreeBased",e))(Sa||{}),I=(e=>(e[e.SUCCESS=0]="SUCCESS",e[e.FAILURE=1]="FAILURE",e[e.RUNNING=2]="RUNNING",e[e.NOT_EVALUATED=3]="NOT_EVALUATED",e))(I||{});class En{constructor(){De(this,"name");De(this,"depth");De(this,"children");De(this,"child")}getLastStatus(t){return _.get(t.aiBlackboard,`${this.name}_lastStatus`)??3}setLastStatus(t,r){_.set(t.aiBlackboard,`${this.name}_lastStatus`,r)}getRunningChildIndex(t){return _.get(t.aiBlackboard,`${this.name}_runningChildIndex`)}setRunningChildIndex(t,r){_.set(t.aiBlackboard,`${this.name}_runningChildIndex`,r)}}const _={create(){return{data:{},nodeExecutionData:{}}},set({data:e},t,r){e[t]=r},get(e,t){return e==null?void 0:e.data[t]},delete({data:e},t){delete e[t]},has({data:e},t){return t in e},recordNodeExecution({nodeExecutionData:e},t,r,o,l,s){const u=e[t]||{lastExecuted:0,status:I.FAILURE,depth:0,debugInfo:"",executionHistory:[]},d=u.executionHistory[u.executionHistory.length-1];d&&o-(d==null?void 0:d.time)>ia&&u.executionHistory.push({time:d.time+ia,status:I.NOT_EVALUATED}),u.executionHistory.push({time:o,status:r});const f=Hv/At*Tt,g=o-f;u.executionHistory=u.executionHistory.filter(S=>S.time>=g);const m={...u,lastExecuted:o,status:r,depth:l,debugInfo:s};e[t]=m},getNodeExecutionData({nodeExecutionData:e}){return e},cleanupOldEntries({nodeExecutionData:e},t){const r=II,o=[];for(const[l,s]of Object.entries(e))t-s.lastExecuted>r&&o.push(l);for(const l of o)delete e[l]}};function ah(e,t,r){if(e.aiBlackboard){const o=_.get(e.aiBlackboard,"lastAiUpdateTime")??0;t.gameState.time-o>=ia&&(r.execute(e,t,e.aiBlackboard),_.set(e.aiBlackboard,"lastAiUpdateTime",t.gameState.time))}else console.warn(`Behavior Tree AI ticked for human ${e.id}, but the tree or blackboard was missing.`),e.activeAction="idle"}const h0="Human Behavior",JC=1;class e1{constructor(){De(this,"nodeData",new Map);De(this,"pathStack",[]);De(this,"startTimeStack",[])}nodeStart(t){this.pathStack.push(t),this.startTimeStack.push(performance.now())}nodeEnd(){if(this.startTimeStack.length===0||this.pathStack.length===0){console.error("BTProfiler: nodeEnd() called without a matching nodeStart().");return}const t=performance.now(),r=this.startTimeStack.pop(),o=t-r,l=this.pathStack.join(" > "),s=this.nodeData.get(l)??{path:l,totalTime:0,callCount:0,minTime:1/0,maxTime:-1/0};s.totalTime+=o,s.callCount++,s.minTime=Math.min(s.minTime,o),s.maxTime=Math.max(s.maxTime,o),this.nodeData.set(l,s),this.pathStack.pop()}report(t={}){const{showAll:r=!1}=t,o=Array.from(this.nodeData.values());if(o.length===0){console.log("--- Behavior Tree Profiler: No data collected. ---");return}let l=o,s="--- Behavior Tree Full Report ---";if(!r){const d=this.nodeData.get(h0);if(d){const f=d.totalTime*JC/100;l=o.filter(g=>g.totalTime>f&&g.path!==h0),s="--- Behavior Tree Problem Report ---"}else console.log('BTProfiler: Root node "Human Behavior" not found. Showing full report.'),s="--- Behavior Tree Full Report (Root Not Found) ---"}const u=l.sort((d,f)=>f.totalTime-d.totalTime);console.log(s),u.length>0?console.table(u.map(d=>({Path:d.path,"Total Time (ms)":d.totalTime.toFixed(3),Calls:d.callCount,"Avg Time (ms)":(d.totalTime/d.callCount).toFixed(3),"Min Time (ms)":d.minTime.toFixed(3),"Max Time (ms)":d.maxTime.toFixed(3)}))):console.log("No significant performance problems detected."),console.log("------------------------------------")}reset(){this.nodeData.clear(),this.pathStack=[],this.startTimeStack=[]}}const st=new e1;function qt(e){return Array.isArray(e)?e:[e,""]}class ve extends En{constructor(r,o,l=0){super();De(this,"name");De(this,"depth");this.children=r,this.name=o,this.depth=l,this.children.forEach(s=>{s.depth=(this.depth??0)+1})}execute(r,o,l){this.name&&st.nodeStart(this.name);try{for(const s of this.children){const[u,d]=qt(s.execute(r,o,l));if(u!==I.SUCCESS)return this.setLastStatus(r,u),this.name&&_.recordNodeExecution(l,this.name,u,o.gameState.time,this.depth,d),u}return this.setLastStatus(r,I.SUCCESS),this.name&&_.recordNodeExecution(l,this.name,I.SUCCESS,o.gameState.time,this.depth,""),I.SUCCESS}finally{this.name&&st.nodeEnd()}}}class Qt extends En{constructor(r,o,l=0){super();De(this,"name");De(this,"depth");this.children=r,this.name=o,this.depth=l,this.children.forEach(s=>{s.depth=(this.depth??0)+1})}execute(r,o,l){this.name&&st.nodeStart(this.name);try{const s=this.getRunningChildIndex(r)??0;for(let u=s;u<this.children.length;u++){const d=this.children[u],[f,g]=qt(d.execute(r,o,l));if(f!==I.FAILURE){if(f===I.SUCCESS)return this.setRunningChildIndex(r,void 0),this.setLastStatus(r,I.SUCCESS),this.name&&_.recordNodeExecution(l,this.name,I.SUCCESS,o.gameState.time,this.depth,g),I.SUCCESS;if(f===I.RUNNING)return this.setRunningChildIndex(r,u),this.setLastStatus(r,I.RUNNING),this.name&&_.recordNodeExecution(l,this.name,I.RUNNING,o.gameState.time,this.depth,g),I.RUNNING}}return this.setRunningChildIndex(r,void 0),this.setLastStatus(r,I.FAILURE),this.name&&_.recordNodeExecution(l,this.name,I.FAILURE,o.gameState.time,this.depth,""),I.FAILURE}finally{this.name&&st.nodeEnd()}}}class ue extends En{constructor(r,o,l=0){super();De(this,"name");De(this,"depth");this.action=r,this.name=o,this.depth=l}execute(r,o,l){this.name&&st.nodeStart(this.name);try{const[s,u]=qt(this.action(r,o,l));return this.setLastStatus(r,s),this.name&&_.recordNodeExecution(l,this.name,s,o.gameState.time,this.depth,u),s}finally{this.name&&st.nodeEnd()}}}class J extends En{constructor(r,o,l=0){super();De(this,"name");De(this,"depth");this.condition=r,this.name=o,this.depth=l}execute(r,o,l){this.name&&st.nodeStart(this.name);try{const[s,u]=qt(this.condition(r,o,l)),d=s?I.SUCCESS:I.FAILURE;return this.setLastStatus(r,d),this.name&&_.recordNodeExecution(l,this.name,d,o.gameState.time,this.depth,u),d}finally{this.name&&st.nodeEnd()}}}class hu extends En{constructor(r,o,l,s=0){super();De(this,"name");De(this,"depth");De(this,"startTimeKey");this.child=r,this.timeoutDurationHours=o,this.name=l,this.depth=s,this.child.depth=(this.depth??0)+1,this.startTimeKey=`timeout_${this.name}_startTime`}execute(r,o,l){st.nodeStart(this.name);try{const s=o.gameState.time;let u=_.get(l,this.startTimeKey);const[d,f]=qt(this.child.execute(r,o,l));if(d===I.RUNNING){u===void 0&&(_.set(l,this.startTimeKey,s),u=s);const g=s-u;if(g>this.timeoutDurationHours){_.delete(l,this.startTimeKey),this.setLastStatus(r,I.FAILURE);const S=`Timed out after ${g.toFixed(2)}h.`;return _.recordNodeExecution(l,this.name,this.getLastStatus(r),s,this.depth,S),this.getLastStatus(r)}this.setLastStatus(r,I.RUNNING);const m=`Running for ${g.toFixed(2)}h. ${f}`;return _.recordNodeExecution(l,this.name,this.getLastStatus(r),s,this.depth,m),this.getLastStatus(r)}return u!==void 0&&_.delete(l,this.startTimeKey),this.setLastStatus(r,d),_.recordNodeExecution(l,this.name,this.getLastStatus(r),s,this.depth,f),this.getLastStatus(r)}finally{st.nodeEnd()}}}class Po extends En{constructor(r,o,l,s=0,u){super();De(this,"name");De(this,"depth");De(this,"statusKey");De(this,"timestampKey");this.child=r,this.cacheDurationHours=o,this.validityCheck=u,this.name=l,this.depth=s,this.child.depth=(this.depth??0)+1,this.statusKey=`caching_${this.name}_status`,this.timestampKey=`caching_${this.name}_timestamp`}execute(r,o,l){st.nodeStart(this.name);try{const s=o.gameState.time,u=_.get(l,this.statusKey),d=_.get(l,this.timestampKey);if(u!==void 0&&d!==void 0){const S=s-d>this.cacheDurationHours,y=this.validityCheck?this.validityCheck(r,o,l):!0;if(!S&&y){const E=(d+this.cacheDurationHours-s).toFixed(2),T=`Cache hit. Status: ${I[u]}. ${E}h left.`;return this.setLastStatus(r,u),_.recordNodeExecution(l,this.name,this.getLastStatus(r),s,this.depth,T),this.getLastStatus(r)}}const[f,g]=qt(this.child.execute(r,o,l));(f===I.SUCCESS||f===I.FAILURE)&&(_.set(l,this.statusKey,f),_.set(l,this.timestampKey,s)),this.setLastStatus(r,f);const m=`Cache miss. Child returned ${I[f]}. ${g}`;return _.recordNodeExecution(l,this.name,this.getLastStatus(r),s,this.depth,m),this.getLastStatus(r)}finally{st.nodeEnd()}}}class br extends En{constructor(r,o,l,s=0){super();De(this,"name");De(this,"depth");De(this,"cooldownKey");this.cooldownDurationHours=r,this.child=o,this.name=l,this.depth=s,this.child.depth=(this.depth??0)+1,this.cooldownKey=`cooldown_${this.name}`}execute(r,o,l){st.nodeStart(this.name);try{const s=o.gameState.time,u=_.get(l,this.cooldownKey);if(this.child.getLastStatus(r)===I.RUNNING){const[g,m]=qt(this.child.execute(r,o,l));if(this.setLastStatus(r,g),this.name){const S=`Continuing running child. ${m}`;_.recordNodeExecution(l,this.name,this.getLastStatus(r),s,this.depth,S)}return this.getLastStatus(r)}if(u!==void 0&&s<u){const m=`Cooldown active, ${(u-s).toFixed(2)}h left`;return this.setLastStatus(r,I.FAILURE),this.name&&_.recordNodeExecution(l,this.name,this.getLastStatus(r),s,this.depth,m),this.getLastStatus(r)}const[d,f]=qt(this.child.execute(r,o,l));return d===I.SUCCESS&&_.set(l,this.cooldownKey,s+this.cooldownDurationHours),this.setLastStatus(r,d),this.name&&_.recordNodeExecution(l,this.name,this.getLastStatus(r),s,this.depth,f),this.getLastStatus(r)}finally{st.nodeEnd()}}}class sn extends En{constructor(r,o,l,s=0){super();De(this,"name");De(this,"depth");this.child=r,this.behaviorKey=o,this.name=l,this.depth=s;const u=(d,f)=>{d.depth=f,d.children?d.children.forEach(g=>u(g,f+1)):d.child&&u(d.child,f+1)};u(this.child,(this.depth??0)+1)}execute(r,o,l){this.name&&st.nodeStart(this.name);try{if(r.isPlayer&&!o.gameState.autopilotControls.behaviors[this.behaviorKey]){const f=`Player autopilot for '${this.behaviorKey}' is disabled.`;return this.setLastStatus(r,I.FAILURE),this.name&&_.recordNodeExecution(l,this.name,this.getLastStatus(r),o.gameState.time,this.depth,f),this.getLastStatus(r)}const[u,d]=qt(this.child.execute(r,o,l));return this.setLastStatus(r,u),this.name&&_.recordNodeExecution(l,this.name,this.getLastStatus(r),o.gameState.time,this.depth,d),this.getLastStatus(r)}finally{this.name&&st.nodeEnd()}}}class t1 extends En{constructor(r,o,l=0){super();De(this,"name");De(this,"depth");this.child=r,this.name=o,this.depth=l;const s=(u,d)=>{u.depth=d,u.children?u.children.forEach(f=>s(f,d+1)):u.child&&s(u.child,d+1)};s(this.child,(this.depth??0)+1)}execute(r,o,l){this.name&&st.nodeStart(this.name);try{if(r.isPlayer&&o.gameState.autopilotControls.isManuallyMoving)return this.setLastStatus(r,I.FAILURE),this.name&&_.recordNodeExecution(l,this.name,this.getLastStatus(r),o.gameState.time,this.depth,"Manual movement active, AI blocked."),this.getLastStatus(r);const[s,u]=qt(this.child.execute(r,o,l));return this.setLastStatus(r,s),this.name&&_.recordNodeExecution(l,this.name,this.getLastStatus(r),o.gameState.time,this.depth,u),this.getLastStatus(r)}finally{this.name&&st.nodeEnd()}}}class ho extends En{constructor(r,o,l=0){super();De(this,"name");De(this,"depth");this.child=r,this.name=o,this.depth=l;const s=(u,d)=>{u.depth=d,u.children?u.children.forEach(f=>s(f,d+1)):u.child&&s(u.child,d+1)};s(this.child,(this.depth??0)+1)}execute(r,o,l){this.name&&st.nodeStart(this.name);try{if(r.isPlayer)return this.setLastStatus(r,I.FAILURE),this.name&&_.recordNodeExecution(l,this.name,this.getLastStatus(r),o.gameState.time,this.depth,"Player controlled, AI blocked."),this.getLastStatus(r);const[s,u]=qt(this.child.execute(r,o,l));return this.setLastStatus(r,s),this.name&&_.recordNodeExecution(l,this.name,this.getLastStatus(r),o.gameState.time,this.depth,u),this.getLastStatus(r)}finally{this.name&&st.nodeEnd()}}}const Bo=24,lh=2,uS=2;function fa(e,t){if(e.leaderId){const r=t.entities.entities[e.leaderId];if(r&&r.aiBlackboard)return r}if(e.isAdult&&e.aiBlackboard)return e;if(!e.isAdult&&e.fatherId){const r=t.entities.entities[e.fatherId];if(r&&r.aiBlackboard)return r}return null}function n1(e,t){if(!e.aiBlackboard)return;const r=e.aiBlackboard.data,o=[];for(const l in r)if(l.startsWith("tribal_")){const s=r[l];s&&typeof s=="object"&&"startTime"in s&&t-s.startTime>Bo&&o.push(l)}for(const l of o)_.delete(e.aiBlackboard,l)}class nr extends En{constructor(r,o,l,s=0){super();De(this,"name");De(this,"depth");De(this,"registeredKey");this.child=r,this.config=o,this.name=l,this.depth=s,this.child.depth=(this.depth??0)+1,this.registeredKey=`${this.name}_registered`}execute(r,o,l){st.nodeStart(this.name);try{const s=fa(r,o.gameState);if(!s||!s.aiBlackboard){const[T,A]=qt(this.child.execute(r,o,l));return this.setLastStatus(r,T),_.recordNodeExecution(l,this.name,T,o.gameState.time,this.depth,`No coordination: ${A}`),T}const u=o.gameState.time,d=_.get(l,this.registeredKey)??!1,f=this.getTaskTarget(r,o,l);if(!f)return this.setLastStatus(r,I.FAILURE),_.recordNodeExecution(l,this.name,I.FAILURE,u,this.depth,"No task target found"),I.FAILURE;const g=this.getTaskKey(f);if(d){const[T,A]=qt(this.child.execute(r,o,l));return T===I.RUNNING?(this.refreshTaskTimestamp(s.aiBlackboard,g,r.id,u),this.setLastStatus(r,T),_.recordNodeExecution(l,this.name,T,u,this.depth,`Continuing: ${A}`),T):(this.removeFromTask(s.aiBlackboard,g,r.id),_.delete(l,this.registeredKey),this.setLastStatus(r,T),_.recordNodeExecution(l,this.name,T,u,this.depth,`Completed: ${A}`),T)}if(!this.canJoinTask(s.aiBlackboard,g,r.id,u)){this.setLastStatus(r,I.FAILURE);const T=_.get(s.aiBlackboard,g),A=(T==null?void 0:T.memberIds.length)??0,C=this.config.maxCapacity??1;return _.recordNodeExecution(l,this.name,I.FAILURE,u,this.depth,`Task full: ${A}/${C}`),I.FAILURE}if(!this.registerTask(s.aiBlackboard,g,r.id,u,f))return this.setLastStatus(r,I.FAILURE),_.recordNodeExecution(l,this.name,I.FAILURE,u,this.depth,"Failed to register task"),I.FAILURE;_.set(l,this.registeredKey,!0);const[y,E]=qt(this.child.execute(r,o,l));if(y===I.RUNNING){this.setLastStatus(r,y);const T=_.get(s.aiBlackboard,g),A=(T==null?void 0:T.memberIds.length)??0,C=this.config.maxCapacity??1;return _.recordNodeExecution(l,this.name,y,u,this.depth,`Started (${A}/${C}): ${E}`),y}else return this.removeFromTask(s.aiBlackboard,g,r.id),_.delete(l,this.registeredKey),this.setLastStatus(r,y),_.recordNodeExecution(l,this.name,y,u,this.depth,`Immediate result: ${E}`),y}finally{st.nodeEnd()}}getTaskTarget(r,o,l){var s,u,d,f,g,m,S,y;if(this.config.taskType==="procreation"){const E=(u=(s=this.config).getTargetId)==null?void 0:u.call(s,r,o,l),T=(f=(d=this.config).getSecondaryTargetId)==null?void 0:f.call(d,r,o,l);return E&&T?{primary:E,secondary:T}:null}return this.config.taskType==="plant"?((m=(g=this.config).getTargetPosition)==null?void 0:m.call(g,r,o,l))??null:((y=(S=this.config).getTargetId)==null?void 0:y.call(S,r,o,l))??null}getTaskKey(r){return this.config.generateTaskKey?this.config.generateTaskKey(this.config.taskType,r):typeof r=="number"?`tribal_${this.config.taskType}_${r}`:"primary"in r?`tribal_${this.config.taskType}_${r.primary}_${r.secondary}`:`tribal_${this.config.taskType}_${Math.round(r.x)}_${Math.round(r.y)}`}canJoinTask(r,o,l,s){const u=_.get(r,o);if(!u||s-u.startTime>Bo||u.memberIds.includes(l))return!0;const d=this.config.maxCapacity??1;return u.memberIds.length<d}registerTask(r,o,l,s,u){let d=_.get(r,o);return d?s-d.startTime>Bo?(d={memberIds:[l],startTime:s,maxCapacity:this.config.maxCapacity??1},this.config.taskType==="plant"&&typeof u!="number"&&!("primary"in u)&&(d.position=u),this.config.taskType==="storage"&&(d.action=this.config.storageAction),_.set(r,o,d),!0):d.memberIds.length>=(this.config.maxCapacity??1)?!!d.memberIds.includes(l):(d.memberIds.includes(l)||(d.memberIds.push(l),_.set(r,o,d)),!0):(d={memberIds:[l],startTime:s,maxCapacity:this.config.maxCapacity??1},this.config.taskType==="plant"&&typeof u!="number"&&!("primary"in u)&&(d.position=u),this.config.taskType==="storage"&&(d.action=this.config.storageAction),_.set(r,o,d),!0)}refreshTaskTimestamp(r,o,l,s){const u=_.get(r,o);u&&u.memberIds.includes(l)&&(u.startTime=s,_.set(r,o,u))}removeFromTask(r,o,l){const s=_.get(r,o);s&&(s.memberIds=s.memberIds.filter(u=>u!==l),s.memberIds.length===0?_.delete(r,o):_.set(r,o,s))}}function i1(e){return new ve([new J((t,r)=>{const o=t.hunger>=vf,l=t.food.length>0,s=!t.eatingCooldownTime||r.gameState.time>=t.eatingCooldownTime;return[!!(o&&l&&s),`${Math.floor(t.hunger-vf)}, ${t.food.length}, ${t.eatingCooldownTime?Math.floor(t.eatingCooldownTime-r.gameState.time):""}`]},"Can Eat",e+1),new ue(t=>(t.direction={x:0,y:0},t.target=void 0,t.activeAction="eating",I.RUNNING),"Eat",e+1)],"Eating",e)}function r1(e){return new ve([new J((t,r,o)=>{if(t.isAdult&&t.hitpoints>t.maxHitpoints*gv||!(t.hitpoints<t.maxHitpoints*.1)&&t.isAdult&&t.hunger>SI)return!1;const s=KE(t.id,r.gameState);return s?(_.set(o,"fleeThreat",s.id),!0):!1},"Should Flee",e+1),new ue((t,r,o)=>{const l=_.get(o,"fleeThreat"),s=l&&r.gameState.entities.entities[l];if(!s)return I.FAILURE;t.activeAction="moving";const u=ze(s.position,t.position,r.gameState.mapDimensions.width,r.gameState.mapDimensions.height),d=nt(u),f=Un(t.position,Pt(d,pv));return t.target={x:(f.x%r.gameState.mapDimensions.width+r.gameState.mapDimensions.width)%r.gameState.mapDimensions.width,y:(f.y%r.gameState.mapDimensions.height+r.gameState.mapDimensions.height)%r.gameState.mapDimensions.height},t.direction=d,I.RUNNING},"Execute Flee",e+1)],"Flee",e)}const cS=100,o1=25;function g0(e){const t=Math.sin(e)*1e4;return t-Math.floor(t)}function s1(e,t,r=cS){return t.search.building.byRadius(e.position,r).some(s=>{const u=s;return u.buildingType==="storageSpot"&&u.ownerId===e.leaderId&&u.isConstructed&&u.storedFood&&u.storageCapacity&&u.storedFood.length<u.storageCapacity})}function a1(e,t,r=cS){return t.search.building.byRadius(e.position,r).filter(s=>{const u=s;return u.buildingType==="storageSpot"&&u.ownerId===e.leaderId&&u.isConstructed&&u.storedFood&&u.storedFood.length>0})}function l1(e,t,r){if(t.length===0)return null;let o=null,l=1/0;for(const s of t){const u=V(e.position,s.position,r.mapDimensions.width,r.mapDimensions.height);u<l&&(l=u,o=s)}return o?{storage:o,distance:l}:null}function dS(e){const t=e.storedFood?e.storedFood.length:0,r=g0(t+e.id)*2*Math.PI,o=g0(t+e.id+1)*o1;return{x:Math.cos(r)*o,y:Math.sin(r)*o}}const go="foodSource";function u1(e){const t=new ue((o,l,s)=>{const u=fa(o,l.gameState),d=new Map,f=Oe(o,l.gameState,"berryBush",Dm,S=>{var A;if(S.food.length===0)return!1;if(u&&u.aiBlackboard){const C=`tribal_gather_${S.id}`,F=_.get(u.aiBlackboard,C);if(F&&l.gameState.time-F.startTime<=Bo&&!F.memberIds.includes(o.id))return!1}const y=(A=l.gameState.search.building.byRadius(S.position,S.radius)[0])==null?void 0:A.ownerId,E=l.gameState.entities.entities[y];if(!E||E.leaderId===o.leaderId)return!0;const T=d.get(E.id)??V(o.position,E.position,l.gameState.mapDimensions.width,l.gameState.mapDimensions.height);return d.set(E.id,T),T>WI}),g=Oe(o,l.gameState,"corpse",Dm,S=>{if(S.food.length===0)return!1;if(u&&u.aiBlackboard){const y=`tribal_gather_${S.id}`,E=_.get(u.aiBlackboard,y);if(E&&l.gameState.time-E.startTime<=Bo&&!E.memberIds.includes(o.id))return!1}return!0});let m=null;if(f&&g){const S=V(o.position,f.position,l.gameState.mapDimensions.width,l.gameState.mapDimensions.height),y=V(o.position,g.position,l.gameState.mapDimensions.width,l.gameState.mapDimensions.height);m=S<=y?f:g}else m=f||g;return m?(_.set(s,go,m.id),[I.SUCCESS,`Found food: ${m.type} at ${m.position.x.toFixed(0)},${m.position.y.toFixed(0)}`]):[I.FAILURE,"No food source found"]},"Find Closest Food Source",e+4),r=new nr(new ue((o,l,s)=>{const u=_.get(s,go);if(!u)return[I.FAILURE,"No target in blackboard"];const d=l.gameState.entities.entities[u];return!d||d.food.length===0?(_.delete(s,go),[I.FAILURE,"Food source is invalid or depleted"]):V(o.position,d.position,l.gameState.mapDimensions.width,l.gameState.mapDimensions.height)<Br?(o.activeAction="gathering",o.direction={x:0,y:0},o.target=d.id,_.delete(s,go),[I.SUCCESS,`Gathering from ${d.type}`]):(o.activeAction="moving",o.target=d.id,o.direction=Ft(o.position,d.position,l.gameState.mapDimensions),[I.RUNNING,`Moving to ${d.type}`])},"Move To Food and Gather",e+3),{taskType:"gather",maxCapacity:1,getTargetId:(o,l,s)=>_.get(s,go)??null},"Tribal Gather Task",e+3);return new ve([new J((o,l)=>{const s=o.food.length<o.maxFood,u=o.hunger>uI,d=Lt(l.gameState,o).filter(g=>g.hunger>xf),f=s1(o,l.gameState);return[(o.isAdult&&s&&(u||d.length>0||f))??!1,`${u?"H":""}${d.length>0?" HC("+d.length+")":""}${f?" S":""}`]},"Should Gather Food",e+1),new Qt([new ve([new J((o,l,s)=>_.has(s,go),"Has Food Source?",e+2),r],"Continue Gathering Action",e+2),new ve([new Po(t,RI,"Cache Food Source Search",e+3),r],"Find New Food Source and Gather",e+2)],"Perform or Start Gathering",e+1)],"Gather Food",e)}function c1(e){return new ue((t,r,o)=>(t.activeAction="idle",t.direction={x:0,y:0},t.target=void 0,_.set(o,"wanderTarget",void 0),I.SUCCESS),"Idle",e)}const bl="procreationWanderStartTime",p0=(e,t,r)=>t.find(o=>Hr(e,o,r)),m0={taskType:"procreation",getTargetId:(e,t,r)=>_.get(r,"procreationPartner")??null,getSecondaryTargetId:e=>e.id,generateTaskKey:(e,t)=>{if(typeof t=="object"&&"primary"in t){const r=Math.min(t.primary,t.secondary),o=Math.max(t.primary,t.secondary);return`tribal_procreation_${r}_${o}`}return""}};function d1(e){const t=new J((s,u,d)=>{const f=Gm(s,u.gameState,Br),g=p0(s,f,u.gameState);return g?(_.set(d,"procreationPartner",g.id),!0):!1},"Find Immediate Partner"),r=new nr(new ue((s,u,d)=>{var m;const f=_.get(d,"procreationPartner"),g=f&&u.gameState.entities.entities[f];return g?(s.activeAction="procreating",s.target=void 0,_.delete(d,"procreationPartner"),_.delete(d,bl),(m=s.partnerIds)!=null&&m.includes(g.id)||(s.partnerIds=s.partnerIds?[...s.partnerIds,g.id]:[g.id]),I.SUCCESS):I.FAILURE},"Start Procreating"),m0,"Tribal Start Procreating",e+2),o=new J((s,u,d)=>{const f=Gm(s,u.gameState,vI),g=p0(s,f,u.gameState);return g?(_.set(d,"procreationPartner",g.id),!0):!1},"Locate Distant Partner"),l=new nr(new ue((s,u,d)=>{const f=_.get(d,"procreationPartner"),g=f&&u.gameState.entities.entities[f];if(!g)return I.FAILURE;if(V(s.position,g.position,u.gameState.mapDimensions.width,u.gameState.mapDimensions.height)<Br)return I.SUCCESS;s.activeAction="moving",s.target=g.id;const S=ze(s.position,g.position,u.gameState.mapDimensions.width,u.gameState.mapDimensions.height);return s.direction=nt(S),I.RUNNING},"Move Towards Partner"),m0,"Tribal Move To Partner",e+3);return new ve([new J(s=>!(!s.isAdult||s.gender==="female"&&s.isPregnant||s.age<gE||s.gender==="female"&&s.age>yv),"Is Fertile (age, not pregnant)",e+1),new J(s=>s.hunger<Lr,"Is Healthy (hunger)",e+1),new J(s=>(s.procreationCooldown||0)<=0,"Is Ready (cooldown)",e+1),new Qt([new ve([new J((s,u)=>Wm(s.position,u.gameState,"berryBush",Pm)>=mI,"Is Environment Viable (food)",e+3),new ue((s,u,d)=>(_.delete(d,bl),I.SUCCESS),"Clear Wander Timer",e+3)],"Sufficient Food Path",e+2),new ve([new J((s,u)=>{if(s.gender==="male"){const d=Lt(u.gameState,s);return!vi(d)}return!1},"Is Male Without Heir",e+3),new ue((s,u,d)=>{const f=_.get(d,bl);if(f===void 0)return _.set(d,bl,u.gameState.time),[I.FAILURE,"Starting heirless wander timer"];const g=u.gameState.time-f;return g>=pE?Wm(s.position,u.gameState,"berryBush",Pm)>=1?[I.SUCCESS,`Wandered for ${g.toFixed(1)}h, minimum food found`]:[I.FAILURE,"Desperate but no food sources nearby"]:[I.FAILURE,`Wandering for heir, ${g.toFixed(1)}h elapsed`]},"Check Wander Timer",e+3)],"Heirless Desperation Path",e+2)],"Check Environment Or Desperation",e+1),new J((s,u,d)=>{var g;const f=_.get(d,"procreationPartner");return f&&((g=f.partnerIds)!=null&&g.length)&&!f.partnerIds.includes(s.id)&&f.partnerIds.map(m=>u.gameState.entities.entities[m]).filter(m=>!!m).some(m=>V(s.position,m.position,u.gameState.mapDimensions.width,u.gameState.mapDimensions.height)<zI)?[!1,"Partner's primary partner is too close"]:!0},"Is Partner's Primary Partner Nearby",e+1),new Qt([new ve([t,r],"Procreate With Immediate Partner",e+2),new br(wI,new ve([o,l],"Seek Distant Partner Action",e+3),"Seek Distant Partner Cooldown",e+2)],"Find Partner And Procreate",e+1)],"Procreate",e)}const po="attackTarget",Tr="homeCenter",Wd=150;function f1(e){return new ve([new J((t,r,o)=>{if(!t.isAdult)return[!1,"Not an adult"];const{gameState:l}=r;if(t.activeAction==="attacking"&&t.attackTargetId){const u=l.entities.entities[t.attackTargetId];if(u&&u.hitpoints>0&&V(t.position,u.position,l.mapDimensions.width,l.mapDimensions.height)<=Wd){if(_.set(o,po,u.id),!_.get(o,Tr)){const d=t.leaderId?er(t.leaderId,l):uu(t,l).length>0?$m(t,l):t.position;_.set(o,Tr,d)}return!0}}const s=Oe(t,l,"human",Wd,u=>u.hitpoints>0&&zo(t,u,l));if(s){_.set(o,po,s.id);const u=t.leaderId?er(t.leaderId,l):uu(t,l).length>0?$m(t,l):t.position;return _.set(o,Tr,u),!0}return _.set(o,po,void 0),_.set(o,Tr,void 0),!1},"Find Attack Target",e+1),new ue((t,r,o)=>{const l=_.get(o,po),s=l&&r.gameState.entities.entities[l],u=_.get(o,Tr);if(!s||!u)return I.FAILURE;const{gameState:d}=r;return V(t.position,u,d.mapDimensions.width,d.mapDimensions.height)>hv?(t.activeAction="idle",t.attackTargetId=void 0,_.set(o,po,void 0),_.set(o,Tr,void 0),I.FAILURE):s.hitpoints<=0||V(t.position,s.position,d.mapDimensions.width,d.mapDimensions.height)>Wd?(t.activeAction==="attacking"&&(t.activeAction="idle",t.attackTargetId=void 0),_.set(o,po,void 0),_.set(o,Tr,void 0),I.SUCCESS):(t.activeAction==="attacking"&&t.attackTargetId===s.id||(t.activeAction="attacking",t.attackTargetId=s.id),I.RUNNING)},"Execute Attack",e+1)],"Attack",e)}const h1=(e,t,r)=>{const o=Lt(t.gameState,e).filter(u=>!u.isAdult);if(o.length===0)return I.FAILURE;let l=null,s=xf;for(const u of o)u.hunger>=s&&(s=u.hunger,l=u);return l?(_.set(r,"targetChild",l.id),I.SUCCESS):I.FAILURE},g1=(e,t,r)=>{const o=_.get(r,"targetChild"),l=o&&t.gameState.entities.entities[o];return l?V(e.position,l.position,t.gameState.mapDimensions.width,t.gameState.mapDimensions.height)>$f?(e.activeAction="moving",e.target=l.id,e.direction=Ft(e.position,l.position,t.gameState.mapDimensions),I.RUNNING):(e.activeAction="feeding",e.target=void 0,_.set(r,"targetChild",void 0),I.SUCCESS):I.FAILURE};function p1(e){return new ve([new J(t=>(t.isAdult&&t.food.length>0&&(!t.feedChildCooldownTime||t.feedChildCooldownTime<=0))??!1,"Can Feed Child",e+1),new ue(h1,"Find Hungriest Child",e+1),new ue(g1,"Move To Child and Feed",e+1)],"Feed Child",e)}function m1(e){return new ve([new J(t=>!t.isAdult&&t.hunger>=xf,"Is Hungry Child",e+1),new ue((t,r,o)=>{const l=HE(t,r.gameState);if(l.length===0)return I.FAILURE;const s=Oe(t,r.gameState,"human",TE,u=>l.some(d=>d.id===u.id)&&u.food.length>0);return s?(_.set(o,"targetParent",s.id),I.SUCCESS):I.FAILURE},"Find Parent With Food",e+1),new ue((t,r,o)=>{const l=_.get(o,"targetParent"),s=l&&r.gameState.entities.entities[l];if(!s)return I.FAILURE;const u=V(t.position,s.position,r.gameState.mapDimensions.width,r.gameState.mapDimensions.height);return t.activeAction="idle",u<=$f?(t.target=void 0,I.SUCCESS):(t.target=s.id,t.activeAction="moving",I.RUNNING)},"Move To Parent",e+1)],"Seek Food From Parent",e)}const Ar="plantingSpot",v1=50;function S1(e,t,r,o){const l=ze(e,t,r,o);return Un(e,l)}function y1(e){const t=new ue((l,s,u)=>{const d=_.get(u,Ar);if(!d)return _.delete(u,Ar),[I.FAILURE,"Planting spot is missing"];if(Hn(d,s.gameState,Fr,l.id))return _.delete(u,Ar),[I.FAILURE,"Planting spot is occupied"];const f=S1(l.position,d,s.gameState.mapDimensions.width,s.gameState.mapDimensions.height),g=V(l.position,f,s.gameState.mapDimensions.width,s.gameState.mapDimensions.height);return g>Br?(l.activeAction="moving",l.target=f,l.direction=Ft(l.position,f,s.gameState.mapDimensions),[I.RUNNING,"Moving to planting spot: "+g.toFixed(2)+" units away"]):Hn(d,s.gameState,Fr,l.id)?(_.delete(u,Ar),[I.FAILURE,"Planting spot is now occupied"]):(l.activeAction="planting",l.target=d,[I.RUNNING,"Planting state initiated"])},"Move To Spot and Plant",e+4),r=new nr(t,{taskType:"plant",proximityRadius:v1,getTargetPosition:(l,s,u)=>_.get(u,Ar)??null},"Coordinated Planting",e+3),o=new ue((l,s,u)=>{let d=q_(l,s.gameState);return d?(_.set(u,Ar,d),[I.SUCCESS,`Found new spot at ${d.x.toFixed(0)}, ${d.y.toFixed(0)}`]):[I.FAILURE,"No suitable planting spot found"]},"Find Optimal Planting Spot",e+3);return new ve([new J(l=>{const s=l.food.filter(f=>f.type===Ln.Berry).length>=kr,u=l.hunger<cI,d=(l.isAdult&&s&&u)??!1;return[d,d?"Can plant":`Cannot plant: adult=${l.isAdult}, berries=${l.food.filter(f=>f.type===Ln.Berry).length}/${kr}, hunger=${l.hunger.toFixed(0)}`]},"Can Plant",e+1),new J((l,s)=>{if(!l.leaderId)return[!1,"No tribe"];const u=z_(l,s.gameState),d=qv(l.leaderId,s.gameState);let f;return u<jI?f=KI:u<VI?f=ZI:u<XI?f=qI:f=QI,[d<f,`Food security: ${(u*100).toFixed(0)}%, Bush density: ${d.toFixed(1)}/${f}`]},"Needs More Bushes (Adaptive)",e+1),new J((l,s)=>{if(!l.leaderId)return[!0,"No tribe coordination needed"];const u=Bn(l,s.gameState),d=Qv(l.leaderId,s.gameState,"planting"),f=Math.max(1,Math.ceil(u.length*.3));return[d<f,`Active planters: ${d}/${f}`]},"Not Too Many Planters",e+1),new Qt([new ve([new J((l,s,u)=>_.has(u,Ar),"Has Planting Spot?",e+2),r],"Continue Planting Action",e+2),new br(CI,o,"Find Planting Spot Cooldown",e+2)],"Perform or Start Planting",e+1)],"Plant Bush",e)}const v0="lastDepositTime",Ls="assignedStorageSpot";function T1(e){return new Qt([new ve([new J((t,r,o)=>{const l=_.get(o,v0)||0,s=r.gameState.time-l;if(s<Om)return[!1,`Cooldown: ${(Om-s).toFixed(1)}h remaining`];if(!t.isAdult)return[!1,"Not an adult"];if(!t.leaderId)return[!1,"No tribe"];const u=Zv(t.leaderId,r.gameState);let d;u<.3?d=JI:u<.7?d=eE:d=tE;const f=t.food.length/t.maxFood;if(f<=d)return[!1,`Food ${(f*100).toFixed(0)}% < threshold ${(d*100).toFixed(0)}%`];const g=Z_(t,r.gameState);return g?(_.set(o,Ls,g.id),[!0,`Storage util: ${(u*100).toFixed(0)}%, Personal: ${(f*100).toFixed(0)}%`]):[!1,"No available tribe storage nearby"]},"Check for Excess Food and Storage",e+1),new J((t,r)=>{if(!t.leaderId)return[!0,"No tribe coordination needed"];const o=Qv(t.leaderId,r.gameState,"depositing"),l=Bn(t,r.gameState),s=Math.max(1,Math.ceil(l.length*.4));return[o<s,`Active depositors: ${o}/${s}`]},"Not Too Many Depositors",e+1),new nr(new ue((t,r,o)=>{const l=_.get(o,Ls);if(!l)return[I.FAILURE,"No storage assigned"];const s=r.gameState.entities.entities[l];if(!s)return _.delete(o,Ls),[I.FAILURE,"Storage entity missing"];const u=V(t.position,s.position,r.gameState.mapDimensions.width,r.gameState.mapDimensions.height);return u<=An?(t.activeAction="depositing",t.target=void 0,_.set(o,v0,r.gameState.time),_.delete(o,Ls),[I.SUCCESS,"Depositing food"]):(t.activeAction="moving",t.target=s.position,[I.RUNNING,`Moving to storage (${u.toFixed(1)}px away)`])},"Navigate to Storage and Deposit",e+2),{taskType:"storage",maxCapacity:uS,storageAction:"deposit",getTargetId:(t,r,o)=>_.get(o,Ls)??null},"Tribal Storage Deposit Task",e+1)],"Deposit Sequence",e)],"Storage Deposit Behavior",e)}const Gl="retrievalStorageId";function A1(e){return new Qt([new ve([new J((t,r,o)=>{if(t.hunger<=vf)return[!1,"Not hungry enough"];if(t.food.length>=t.maxFood)return[!1,"Inventory full"];const l=a1(t,r.gameState),s=l1(t,l,r.gameState),u=s==null?void 0:s.storage;return u?(_.set(o,Gl,u.id),[!0,`Storage with food found at distance ${s.distance.toFixed(1)}`]):[!1,"No tribe storage with food nearby"]},"Check for Hunger and Storage Food",e+1),new nr(new ue((t,r,o)=>{const l=_.get(o,Gl);if(!l)return[I.FAILURE,"No storage target"];const s=r.gameState.entities.entities[l];if(!s)return _.delete(o,Gl),[I.FAILURE,"Storage not found"];const u=V(t.position,s.position,r.gameState.mapDimensions.width,r.gameState.mapDimensions.height);return u<=An?(t.activeAction="retrieving",t.target=void 0,[I.SUCCESS,"Retrieving food"]):(t.activeAction="moving",t.target=s.position,[I.RUNNING,`Moving to storage (${u.toFixed(1)}px away)`])},"Navigate to Storage and Retrieve",e+2),{taskType:"storage",maxCapacity:uS,storageAction:"retrieve",getTargetId:(t,r,o)=>_.get(o,Gl)??null},"Coordinated Storage Retrieve",e+1)],"Retrieve Sequence",e)],"Storage Retrieve Behavior",e)}function I1(e){return new Qt([new ve([new J((t,r,o)=>{if(!t.isAdult)return[!1,"Not an adult"];if(t.food.length>=t.maxFood)return[!1,"Inventory full"];if(!t.leaderId)return[!1,"No tribe leader"];const l=r.gameState.entities.entities[t.leaderId];if(!l||!l.diplomacy)return[!1,"No diplomacy info"];const d=r.gameState.search.building.byRadius(t.position,150).find(f=>{const g=f;if(g.buildingType!=="storageSpot"||!g.isConstructed||!g.storedFood||g.storedFood.length===0||g.ownerId===t.leaderId||l.diplomacy[g.ownerId]!==yt.Hostile)return!1;const S=Bn({leaderId:g.ownerId},r.gameState);for(const y of S)if(V(t.position,y.position,r.gameState.mapDimensions.width,r.gameState.mapDimensions.height)<=Ef)return!1;return!0});return d?[!0,`Undefended enemy storage found at distance ${V(t.position,d.position,r.gameState.mapDimensions.width,r.gameState.mapDimensions.height).toFixed(1)}`]:[!1,"No undefended enemy storage nearby"]},"Check for Undefended Enemy Storage",e+1),new ue((t,r,o)=>{if(!t.leaderId)return[I.FAILURE,"No tribe leader"];const l=r.gameState.entities.entities[t.leaderId];if(!l||!l.diplomacy)return[I.FAILURE,"No diplomacy info"];const d=r.gameState.search.building.byRadius(t.position,150).filter(m=>{const S=m;if(S.buildingType!=="storageSpot"||!S.isConstructed||!S.storedFood||S.storedFood.length===0||S.ownerId===t.leaderId||l.diplomacy[S.ownerId]!==yt.Hostile)return!1;const E=Bn({leaderId:S.ownerId},r.gameState);for(const T of E)if(V(t.position,T.position,r.gameState.mapDimensions.width,r.gameState.mapDimensions.height)<=Ef)return!1;return!0});if(d.length===0)return[I.FAILURE,"No undefended storage available"];let f=null,g=1/0;for(const m of d){const S=V(t.position,m.position,r.gameState.mapDimensions.width,r.gameState.mapDimensions.height);S<g&&(g=S,f=m)}return f?g<=An?(t.activeAction="idle",t.target=void 0,[I.SUCCESS,"Stealing food"]):(t.activeAction="moving",t.target=f.position,[I.RUNNING,`Moving to enemy storage (${g.toFixed(1)}px away)`]):[I.FAILURE,"No storage found"]},"Navigate to Enemy Storage and Steal",e+1)],"Steal Sequence",e)],"Storage Steal Behavior",e)}const Yd="enemiesNearby";function E1(e){const t=new J(s=>s.id===s.leaderId,"Is Leader?",e+1),r=new J(s=>!s.isCallingToAttack,"Is Not Already Calling?",e+1),o=new ue((s,u,d)=>{const f=Xf(s,u.gameState,zv);return f.length>0?(_.set(d,Yd,f.map(g=>g.id)),I.SUCCESS):I.FAILURE},"Find Nearby Enemies",e+1),l=new Qt([new ve([new J((s,u,d)=>{const f=_.get(d,Yd),g=f==null?void 0:f.map(E=>u.gameState.entities.entities[E]).filter(E=>!!E);if(!g||g.length===0)return!1;const m=oa(s.id,u.gameState),S=cu(m),y=cu(g);return S>y*LI},"Is Strong Enough?",e+3),new ue((s,u)=>(s.isCallingToAttack=!0,s.callToAttackEndTime=u.gameState.time+Lo,Me(u.gameState,ce.CallToAttack,s.position,Lo),Ie(u,fe.CallToAttack,s.position),s.activeAction="idle",s.target=void 0,I.SUCCESS),"Issue Call to Attack",e+3)],"Attack",e+2),new ue((s,u,d)=>{const f=_.get(d,Yd),g=f==null?void 0:f.map(A=>u.gameState.entities.entities[A]).filter(A=>!!A);if(!g||g.length===0)return I.FAILURE;const m=g.map(A=>A.position),S=lu(m),y=ze(S,s.position,u.gameState.mapDimensions.width,u.gameState.mapDimensions.height),E=nt(y),T=Un(s.position,Pt(E,pv*2));return s.activeAction="moving",s.target={x:(T.x%u.gameState.mapDimensions.width+u.gameState.mapDimensions.width)%u.gameState.mapDimensions.width,y:(T.y%u.gameState.mapDimensions.height+u.gameState.mapDimensions.height)%u.gameState.mapDimensions.height},s.direction=E,I.SUCCESS},"Retreat",e+2)],"Attack or Retreat",e+2);return new ve([t,r,o,new br(BI,l,"Leader Combat Cooldown",e+1)],"Leader Combat Strategy",e)}const jd="combatTarget",Vd="homeCenter";function w1(e){const t=new J(u=>u.isAdult&&u.leaderId?u.id!==u.leaderId:!1,"Is Tribe Follower?",e+1),r=new J(u=>u.hunger<dI&&u.hitpoints>=u.maxHitpoints*gv,"Is Fit for Combat?",e+1),o=new J((u,d)=>{const f=d.gameState.entities.entities[u.leaderId];return!!(f!=null&&f.isCallingToAttack)},"Is Leader Calling to Attack?",e+1),l=new ue((u,d,f)=>{const{gameState:g}=d,m=g.entities.entities[u.leaderId];if(!m)return I.FAILURE;const S=Xf(m,g,yI);if(S.length===0)return I.FAILURE;S.sort((y,E)=>{const T=V(u.position,y.position,g.mapDimensions.width,g.mapDimensions.height),A=V(u.position,E.position,g.mapDimensions.width,g.mapDimensions.height);return T-A});for(const y of S)if(jE(m.id,y.id,g)<TI){_.set(f,jd,y.id);const T=er(m.id,g);return _.set(f,Vd,T),I.SUCCESS}return I.FAILURE},"Find Best Target",e+1),s=new ue((u,d,f)=>{const g=_.get(f,jd),m=g&&d.gameState.entities.entities[g],S=_.get(f,Vd);if(!m||!S)return I.FAILURE;const{gameState:y}=d;return V(u.position,S,y.mapDimensions.width,y.mapDimensions.height)>hv?(u.activeAction==="attacking"&&u.attackTargetId===m.id&&(u.activeAction="idle",u.attackTargetId=void 0),_.set(f,jd,void 0),_.set(f,Vd,void 0),I.FAILURE):((!u.lastTargetAcquiredEffectTime||d.gameState.time-u.lastTargetAcquiredEffectTime>xe*5)&&(Me(d.gameState,ce.TargetAcquired,u.position,xe,u.id),u.lastTargetAcquiredEffectTime=d.gameState.time),u.activeAction="attacking",u.attackTargetId=m.id,u.target=void 0,I.RUNNING)},"Attack Target",e+1);return new ve([t,r,o,l,s],"Tribe Member Combat",e)}function _1(e,t,r,o,l,s,u){const d=u.mapDimensions.width,f=u.mapDimensions.height,g=Math.PI/8,S=r*2/(2*Math.PI);let y=0,E=0;for(;E<=t;){const T=e.x+E*Math.cos(y),A=e.y+E*Math.sin(y),C={x:(T%d+d)%d,y:(A%f+f)%f};if(rh(C,l,s,u)&&!qE(C,void 0,o,u))return C;y+=g,E=S*y}}class C1 extends En{constructor(t){super(),this.name="Leader Building Placement",this.depth=t}execute(t,r,o){if(!t.leaderId||t.leaderId!==t.id)return[I.FAILURE,"Not a tribe leader"];const s=Bn(t,r.gameState).filter(H=>H.isAdult);if(s.length<km)return[I.FAILURE,`Tribe too small: ${s.length}/${km} adults`];const u=ma(t.leaderId,r.gameState),d=oh(t,r.gameState),f=Zv(t.leaderId,r.gameState),g=qv(t.leaderId,r.gameState),m=Math.ceil(s.length*(1+rE)),S=u.length===0,y=u.length<Lm&&(S||f>Fm||f*(m/s.length)>Fm),E=g*(s.length/m),T=d.length<Bm&&(g<Um||E<Um);let A=null,C="";if(y&&T?S?(A=On.StorageSpot,C="Bootstrap: First storage spot for tribe"):f>.85?(A=On.StorageSpot,C=`High storage utilization: ${(f*100).toFixed(0)}% (projected: ${m} adults)`):(A=On.PlantingZone,C=`Low bush density: ${g.toFixed(1)} bushes/member (projected: ${E.toFixed(1)})`):y?S?(A=On.StorageSpot,C="Bootstrap: First storage spot for tribe"):(A=On.StorageSpot,C=`Storage utilization: ${(f*100).toFixed(0)}% (projected: ${m} adults)`):T&&(A=On.PlantingZone,C=`Bush density: ${g.toFixed(1)} bushes/member (projected: ${E.toFixed(1)} for ${m} adults)`),!A)return[I.FAILURE,`No building needed. Storage: ${u.length}/${Lm} (${(f*100).toFixed(0)}%), Planting: ${d.length}/${Bm} (${g.toFixed(1)} bushes/member)`];const F=S?sE:oE,B=er(t.leaderId,r.gameState),D=_1(B,Mm,iE,F,A,t.id,r.gameState);return D?(Kv(D,A,t.id,r.gameState),[I.SUCCESS,`Placed ${A} at (${D.x.toFixed(0)}, ${D.y.toFixed(0)}). Reason: ${C}`]):[I.FAILURE,`No valid location found for ${A} within ${Mm}px of tribe center`]}}function R1(e){return new C1(e)}function P1(e){const t=new J((m,S)=>{if(!m.isAdult||m.gender!=="male")return!1;const y=m.partnerIds&&m.partnerIds.length>0,E=Lt(S.gameState,m).length>0;return y||E},"Is Adult Male With Family?",e+1),r=new J((m,S)=>{var A;const y=It(S.gameState);if(y){const C=vi(Lt(S.gameState,y));if((C==null?void 0:C.id)===m.id)return!1}if(!m.fatherId)return!1;const E=S.gameState.entities.entities[m.fatherId];return!E||((A=vi(Lt(S.gameState,E)))==null?void 0:A.id)===m.id?!1:V(m.position,E.position,S.gameState.mapDimensions.width,S.gameState.mapDimensions.height)<EI},"Is Too Close To Father?",e+1),o=new J((m,S,y)=>_.get(y,"territoryMoveTarget")!==void 0,"Is Moving To Territory?",e+3),l=new ue((m,S,y)=>{const E=_.get(y,"territoryMoveTarget"),T=_.get(y,"territoryMoveStartTime");if(!E||!T)return[I.FAILURE,"Missing move data"];if(S.gameState.time-T>AI)return _.delete(y,"territoryMoveTarget"),_.delete(y,"territoryMoveStartTime"),[I.FAILURE,"Territory move timed out"];if(V(m.position,E,S.gameState.mapDimensions.width,S.gameState.mapDimensions.height)<Br)return _.delete(y,"territoryMoveTarget"),_.delete(y,"territoryMoveStartTime"),[I.SUCCESS,"Arrived at new territory"];m.activeAction="moving",m.target=E;const F=ze(m.position,m.target,S.gameState.mapDimensions.width,S.gameState.mapDimensions.height);return m.direction=nt(F),[I.RUNNING,"Continuing move to territory"]},"Check Timeout & Arrival",e+3),s=new ve([o,l],"Handle In-Progress Move",e+2),u=new J((m,S,y)=>_.get(y,"territoryMoveTarget")===void 0,"Should Start New Move?",e+4),d=new ue((m,S,y)=>{const E=Vf(m.position,S.gameState.mapDimensions.width/4,S.gameState.mapDimensions.width,S.gameState.mapDimensions.height);_.set(y,"territoryMoveTarget",E),_.set(y,"territoryMoveStartTime",S.gameState.time),m.activeAction="moving",m.target=E;const T=ze(m.position,m.target,S.gameState.mapDimensions.width,S.gameState.mapDimensions.height);return m.direction=nt(T),[I.RUNNING,"Started moving to new territory"]},"Start New Territory Move",e+4),f=new ve([u,d],"Start New Territory Move Action",e+3),g=new Qt([s,new br(_I,f,"Establish Territory Cooldown",e+2)],"Establish or Continue Move",e+1);return new ve([t,r,g],"Establish Family Territory",e)}function N1(e){return new ve([new ue((t,r,o)=>{const l=GE(t,r.gameState);return l?(_.set(o,"patriarchTarget",l.id),[I.SUCCESS,`Found patriarch: ${l.id}`]):(_.delete(o,"patriarchTarget"),[I.FAILURE,"No patriarch found"])},"Find Patriarch",e+1),new ue((t,r,o)=>{const l=_.get(o,"patriarchTarget"),s=l&&r.gameState.entities.entities[l];if(!s)return[I.FAILURE,"Patriarch target missing from blackboard"];const u=V(t.position,s.position,r.gameState.mapDimensions.width,r.gameState.mapDimensions.height);if(u>fv){t.activeAction="moving",t.target=s.id;const d=ze(t.position,s.position,r.gameState.mapDimensions.width,r.gameState.mapDimensions.height);return t.direction=nt(d),[I.RUNNING,`Moving to patriarch at ${u.toFixed(0)}`]}return t.activeAction="idle",t.target=void 0,t.direction={x:0,y:0},[I.SUCCESS,`Arrived at patriarch at ${u.toFixed(0)}`]},"Move Towards Patriarch",e+1)],"Follow Patriarch",e)}const Xd="tribeSplitMigrationTarget";function D1(e){const t=new ve([new J((r,o)=>{const{canSplit:l,progress:s}=th(r,o.gameState);return l?[!0,`Progress: ${(s??0)*100}%`]:[!1,"Cannot split"]},"Can Split Tribe?",e+2),new ue((r,o,l)=>{const{gameState:s}=o;let u=_.get(l,Xd);if(!u){if(!r.leaderId)return I.FAILURE;const f=er(r.leaderId,s),g=P_(f,r,s);if(g)_.set(l,Xd,g),u=g;else return I.FAILURE}return V(r.position,u,s.mapDimensions.width,s.mapDimensions.height)<Br?(_.delete(l,Xd),r.activeAction="idle",r.target=void 0,I.SUCCESS):(r.activeAction="moving",r.target=u,I.RUNNING)},"Move to New Territory",e+2),new ue((r,o)=>(nh(r,o.gameState),I.SUCCESS),"Perform Tribe Split",e+2)],"Tribe Split Action",e+1);return new br(a_,t,"Tribe Split Cooldown",e)}const xl="jealousyAttackTarget";function O1(e){return new ve([new J((t,r,o)=>{if(!t.isAdult)return[!1,"Not an adult"];const l=zE(t,r.gameState,HI);return l?t.leaderId&&l.id===t.leaderId?[!1,"Stranger is in same tribe - no attack"]:(_.set(o,xl,l.id),[!0,`Partner cheating with ${l.id}`]):(_.delete(o,xl),!1)},"Check for Infidelity",e+1),new ue((t,r,o)=>{const l=_.get(o,xl),s=l&&r.gameState.entities.entities[l];return!s||s.hitpoints<=0?(_.delete(o,xl),[I.FAILURE,"Target is invalid or dead"]):t.activeAction==="attacking"&&t.attackTargetId===s.id?I.RUNNING:(t.activeAction="attacking",t.attackTargetId=s.id,[I.RUNNING,`Attacking ${s.id}`])},"Execute Jealousy Attack",e+1)],"Jealousy Attack",e)}const $l="defendAggressor";function M1(e){return new ve([new J((t,r,o)=>{if(!t.isAdult)return[!1,"Not an adult"];const l=WE(t,r.gameState,bI);return l?(_.set(o,$l,l.aggressor.id),[!0,`Family member ${l.familyMember.id} attacked by ${l.aggressor.id}`]):(_.delete(o,$l),!1)},"Check Family Under Attack",e+1),new ue((t,r,o)=>{const l=_.get(o,$l),s=l&&r.gameState.entities.entities[l];return!s||s.hitpoints<=0?(_.delete(o,$l),[I.FAILURE,"Target invalid/dead"]):t.activeAction==="attacking"&&t.attackTargetId===s.id?I.RUNNING:(t.activeAction="attacking",t.attackTargetId=s.id,[I.RUNNING,`Attacking aggressor ${s.id}`])},"Execute Family Defense Attack",e+1)],"Defend Family",e)}const zl="desperateAttackTarget";function k1(e){return new ve([new J(t=>t.hunger>GI,"Is Starving",e+1),new J((t,r)=>{if(!t.isAdult)return[!1,"Not an adult"];const o=Oe(t,r.gameState,"berryBush",Rt,s=>s.food.length>0),l=Oe(t,r.gameState,"corpse",Rt,s=>s.food.length>0);return!o&&!l},"No Other Food Available",e+1),new J((t,r,o)=>{const l=YE(t,r.gameState);return l?(_.set(o,zl,l.id),[!0,`Found weak target ${l.id}`]):(_.delete(o,zl),!1)},"Find Weak Target",e+1),new ue((t,r,o)=>{const l=_.get(o,zl),s=l&&r.gameState.entities.entities[l];return!s||s.hitpoints<=0?(_.delete(o,zl),[I.FAILURE,"Target is invalid or dead"]):t.activeAction==="attacking"&&t.attackTargetId===s.id?I.RUNNING:(t.activeAction="attacking",t.attackTargetId=s.id,[I.RUNNING,`Desperately attacking ${s.id}`])},"Execute Desperate Attack",e+1)],"Desperate Attack",e)}function F1(e,t,r,o){const l=e.entities.entities[r.targetEntityId];return!l||!("hitpoints"in l)||l.hitpoints<=0?(e.autopilotControls.activeAutopilotAction=void 0,I.FAILURE):V(t.position,l.position,e.mapDimensions.width,e.mapDimensions.height)<=nu?(t.activeAction="attacking",t.attackTargetId=l.id,e.autopilotControls.activeAutopilotAction=void 0,I.SUCCESS):(t.activeAction="moving",t.target=l.id,t.direction=Ft(t.position,l.position,e.mapDimensions),I.RUNNING)}function U1(e){return new ve([new J((t,r)=>t.isPlayer===!0&&!!r.gameState.autopilotControls.activeAutopilotAction,"Has Player Command",e+1),new ue((t,r)=>{var s;const{gameState:o}=r,l=o.autopilotControls.activeAutopilotAction;if(!l)return I.FAILURE;switch(l.action){case se.AutopilotMove:{const u=l.position;return V(t.position,u,o.mapDimensions.width,o.mapDimensions.height)<YI?(o.autopilotControls.activeAutopilotAction=void 0,t.activeAction==="moving"&&(t.activeAction="idle",t.target=void 0),I.SUCCESS):(t.activeAction="moving",t.target=u,t.direction=Ft(t.position,u,o.mapDimensions),I.RUNNING)}case se.AutopilotGather:{const u=o.entities.entities[l.targetEntityId];return!u||u.food.length===0?(o.autopilotControls.activeAutopilotAction=void 0,I.FAILURE):V(t.position,u.position,o.mapDimensions.width,o.mapDimensions.height)>Br?(t.activeAction="moving",t.target=u.id,t.direction=Ft(t.position,u.position,o.mapDimensions),I.RUNNING):(t.activeAction="gathering",t.target=u.id,o.autopilotControls.activeAutopilotAction=void 0,I.SUCCESS)}case se.AutopilotAttack:return F1(o,t,l);case se.AutopilotProcreate:{const u=o.entities.entities[l.targetEntityId];return!u||u.type!=="human"||!Hr(t,u,r.gameState)?(o.autopilotControls.activeAutopilotAction=void 0,I.FAILURE):V(t.position,u.position,o.mapDimensions.width,o.mapDimensions.height)<=nu?(t.activeAction="procreating",o.autopilotControls.activeAutopilotAction=void 0,I.SUCCESS):(t.activeAction="moving",t.target=u.id,t.direction=Ft(t.position,u.position,o.mapDimensions),I.RUNNING)}case se.AutopilotPlant:{if(t.activeAction==="planting")return I.RUNNING;const u=l.position;return Hn(u,o,Fr,t.id)?(o.autopilotControls.activeAutopilotAction=void 0,I.FAILURE):V(t.position,u,o.mapDimensions.width,o.mapDimensions.height)<=nu?(t.activeAction="planting",t.target=u,o.autopilotControls.activeAutopilotAction=void 0,o.hasPlayerPlantedBush=!0,I.RUNNING):(t.activeAction="moving",t.target=u,t.direction=Ft(t.position,u,o.mapDimensions),I.RUNNING)}case se.AutopilotFeedChild:{const u=o.entities.entities[l.targetEntityId];return!u||u.type!=="human"||u.isAdult||t.food.length===0?(o.autopilotControls.activeAutopilotAction=void 0,I.FAILURE):V(t.position,u.position,o.mapDimensions.width,o.mapDimensions.height)<=nu?(o.autopilotControls.activeAutopilotAction=void 0,t.activeAction="feeding",I.SUCCESS):(t.activeAction="moving",t.target=u.id,t.direction=Ft(t.position,u.position,o.mapDimensions),I.RUNNING)}case se.AutopilotDeposit:{const u=o.entities.entities[l.targetEntityId];if(!u||u.buildingType!=="storageSpot"||!u.isConstructed)return o.autopilotControls.activeAutopilotAction=void 0,I.FAILURE;const d=u.storageCapacity??0;return(((s=u.storedFood)==null?void 0:s.length)??0)>=d||t.leaderId!==u.ownerId||t.food.length===0?(o.autopilotControls.activeAutopilotAction=void 0,I.FAILURE):V(t.position,u.position,o.mapDimensions.width,o.mapDimensions.height)<=An?(t.activeAction="depositing",t.target=void 0,o.autopilotControls.activeAutopilotAction=void 0,I.SUCCESS):(t.activeAction="moving",t.target=u.id,t.direction=Ft(t.position,u.position,o.mapDimensions),I.RUNNING)}case se.AutopilotRetrieve:{const u=o.entities.entities[l.targetEntityId];return!u||u.buildingType!=="storageSpot"||!u.isConstructed||!u.storedFood||u.storedFood.length===0||t.leaderId!==u.ownerId||t.food.length>=t.maxFood?(o.autopilotControls.activeAutopilotAction=void 0,I.FAILURE):V(t.position,u.position,o.mapDimensions.width,o.mapDimensions.height)<=An?(t.activeAction="retrieving",t.target=void 0,o.autopilotControls.activeAutopilotAction=void 0,I.SUCCESS):(t.activeAction="moving",t.target=u.id,t.direction=Ft(t.position,u.position,o.mapDimensions),I.RUNNING)}case se.AutopilotFollowMe:{const u=o.entities.entities[l.targetEntityId];return!u||u.type!=="human"||u.id!==u.leaderId?(o.autopilotControls.activeAutopilotAction=void 0,I.FAILURE):V(t.position,u.position,o.mapDimensions.width,o.mapDimensions.height)<=fv?(o.autopilotControls.activeAutopilotAction=void 0,t.activeAction==="moving"&&(t.activeAction="idle"),I.SUCCESS):(t.activeAction="moving",t.target=u.id,t.direction=Ft(t.position,u.position,o.mapDimensions),I.RUNNING)}default:return o.autopilotControls.activeAutopilotAction=void 0,I.FAILURE}},"Execute Player Command",e+1)],"Player Command Handler",e)}function L1(e){return new ve([new J(t=>!!t.leaderId&&t.leaderId!==t.id,"Is Follower",e+1),new J((t,r)=>{if(!t.leaderId)return!1;const o=r.gameState.entities.entities[t.leaderId];return!!o&&o.isCallingToFollow===!0},"Is Leader Calling To Follow",e+1),new J(t=>t.hunger<pI,"Is Not Critically Hungry",e+1),new ue((t,r)=>{if(!t.leaderId)return I.FAILURE;const o=r.gameState.entities.entities[t.leaderId];return o?V(t.position,o.position,r.gameState.mapDimensions.width,r.gameState.mapDimensions.height)>gI?(t.activeAction="moving",t.target=o.id,t.direction=Ft(t.position,o.position,r.gameState.mapDimensions),I.RUNNING):(t.activeAction==="moving"&&t.target===o.id&&(t.activeAction="idle",t.target=void 0),I.SUCCESS):I.FAILURE},"Execute Follow Leader",e+1)],"Follow Leader Command",e)}const S0="tribeMigrationCheckCooldown";function B1(e){const t=new ve([new J(o=>!!o.leaderId&&o.leaderId===o.id,"Is Tribe Leader",e+2),new J((o,l)=>{const s=_.get(o.aiBlackboard,S0);return s?l.gameState.time-s>=Nm:!0},"Is Migration Check Cooldown Over",e+2),new ue((o,l)=>{o.aiBlackboard&&_.set(o.aiBlackboard,S0,l.gameState.time);const s=VE(o,l.gameState);return s?(o.isCallingToFollow=!0,o.callToFollowEndTime=l.gameState.time+sa,o.target=s,o.activeAction="moving",I.SUCCESS):I.FAILURE},"Execute Tribe Migration",e+2)],"Tribe Migration Strategy",e+1),r=new Po(t,yf,"Cache Tribe Migration",e+1);return new br(Nm,r,"Tribe Migration Cooldown",e)}function H1(e){const t=new J(o=>o.id===o.leaderId,"Is Leader?",e+1),r=new ue((o,l)=>{var g;const{gameState:s}=l,u=oa(o.id,s),d=cu(u),f=_v(s).filter(m=>m.leaderId!==o.id);for(const m of f){const S=oa(m.leaderId,s),y=cu(S),E=((g=o.diplomacy)==null?void 0:g[m.leaderId])||yt.Friendly;d>y*UI?E!==yt.Hostile&&o.diplomacy&&(o.diplomacy[m.leaderId]=yt.Hostile):E!==yt.Friendly&&o.diplomacy&&(o.diplomacy[m.leaderId]=yt.Friendly)}return I.SUCCESS},"Evaluate Diplomacy",e+2);return new ve([t,new br(NI,r,"Diplomacy Cooldown",e+1)],"Manage Diplomacy",e)}const Bs="huntTarget";function b1(e){return new ve([new Po(new J((r,o,l)=>{if(!r.isAdult)return[!1,"Not an adult"];if(!r.leaderId)return[!1,"Not in a tribe"];const s=Oe(r.position,o.gameState,"prey",fI,()=>!0);return s?(_.set(l,Bs,s.id),[!0,"Found prey"]):[!1,"No suitable prey found"]},"Find Prey Target",e+2),PI,"Cache Find Prey",e+1),new nr(new hu(new ue((r,o,l)=>{if(!r.leaderId)return I.FAILURE;const s=_.get(l,Bs);if(!s)return I.FAILURE;const u=o.gameState.entities.entities[s];if(!u||u.hitpoints<=0)return _.delete(l,Bs),r.activeAction="idle",r.attackTargetId=void 0,I.SUCCESS;const{gameState:d}=o,f=er(r.leaderId,d);return V(r.position,f,d.mapDimensions.width,d.mapDimensions.height)>hI?(_.delete(l,Bs),r.activeAction="idle",r.attackTargetId=void 0,I.FAILURE):(r.activeAction="attacking",r.attackTargetId=u.id,I.RUNNING)},"Hunt Prey Action",e+3),Sf,"Hunt Prey Timeout",e+2),{taskType:"hunt",maxCapacity:lh,getTargetId:(r,o,l)=>_.get(l,Bs)??null},"Tribal Hunt Task",e+1)],"Human Hunt Prey Sequence",e)}const Wl="defendTarget",Kd=150;function G1(e){return new ve([new J((t,r,o)=>{if(!t.isAdult)return[!1,"Not an adult - children flee instead"];if(t.hitpoints<=t.maxHitpoints*.3)return[!1,"Too injured to defend"];const{gameState:l}=r;if(t.activeAction==="attacking"&&t.attackTargetId){const u=l.entities.entities[t.attackTargetId];if(u&&u.type==="predator"&&u.hitpoints>0&&V(t.position,u.position,l.mapDimensions.width,l.mapDimensions.height)<=Kd)return _.set(o,Wl,u.id),[!0,"Continuing defense"]}const s=Oe(t,l,"predator",Kd,u=>u.hitpoints>0&&(u.isAdult||!1));if(s){const u=V(t.position,s.position,l.mapDimensions.width,l.mapDimensions.height),d=s.attackTargetId===t.id,f=u<80;if(d||f)return _.set(o,Wl,s.id),[!0,"Predator threat detected"]}return _.set(o,Wl,void 0),[!1,"No predator threat"]},"Detect Predator Threat",e+1),new ue((t,r,o)=>{const l=_.get(o,Wl),s=l&&r.gameState.entities.entities[l];if(!s)return I.FAILURE;const{gameState:u}=r,d=V(t.position,s.position,u.mapDimensions.width,u.mapDimensions.height);return t.hitpoints<t.maxHitpoints*.3?I.FAILURE:s.hitpoints<=0||d>Kd*1.5?(t.activeAction="idle",t.attackTargetId=void 0,I.SUCCESS):(t.activeAction="attacking",t.attackTargetId=s.id,I.RUNNING)},"Defend Against Predator",e+1)],"Human Defend Against Predator",e)}function x1(e){return new ve([new J((t,r,o)=>{const l=Oe(t,r.gameState,"predator",zt*2,()=>!0),s=Oe(t,r.gameState,"human",zt*2,()=>!0);let u=null,d=1/0;if(l){const f=V(t.position,l.position,r.gameState.mapDimensions.width,r.gameState.mapDimensions.height);f<d&&(d=f,u=l)}if(s){const f=V(t.position,s.position,r.gameState.mapDimensions.width,r.gameState.mapDimensions.height);f<d&&(d=f,u=s)}return u&&d<zt*1.5?(_.set(o,"fleeThreat",u.id),_.set(o,"fleeDistance",d),!0):!1},"Detect Threat",e+1),new ue((t,r,o)=>{const l=_.get(o,"fleeThreat"),s=l&&r.gameState.entities.entities[l];if(!s)return I.FAILURE;t.activeAction="moving";const u=ze(s.position,t.position,r.gameState.mapDimensions.width,r.gameState.mapDimensions.height),d=nt(u),f=Un(t.position,Pt(d,AC));return t.target={x:(f.x%r.gameState.mapDimensions.width+r.gameState.mapDimensions.width)%r.gameState.mapDimensions.width,y:(f.y%r.gameState.mapDimensions.height+r.gameState.mapDimensions.height)%r.gameState.mapDimensions.height},t.direction=d,t.fleeCooldown=r.gameState.time+2,I.RUNNING},"Execute Flee",e+1)],"Prey Flee",e)}function $1(e){return new ve([new J((t,r,o)=>{if(!t.isAdult)return[!1,"Not an adult"];if(t.hunger<=30||t.eatingCooldownTime&&t.eatingCooldownTime>r.gameState.time)return!1;const l=Oe(t,r.gameState,"berryBush",zt*10,s=>s.food.length>0);return l?V(t.position,l.position,r.gameState.mapDimensions.width,r.gameState.mapDimensions.height)<=zt?(_.set(o,"grazingTarget",l.id),!0):(_.set(o,"grazingTarget",l.id),_.set(o,"needToMoveToTarget",!0),!0):!1},"Find Berry Bush",e+1),new ue((t,r,o)=>{const l=_.get(o,"grazingTarget"),s=l&&r.gameState.entities.entities[l],u=_.get(o,"needToMoveToTarget");if(!s)return I.FAILURE;const d=V(t.position,s.position,r.gameState.mapDimensions.width,r.gameState.mapDimensions.height);if(d<=zt)return t.activeAction="grazing",t.target=s.id,t.direction={x:0,y:0},_.delete(o,"needToMoveToTarget"),I.RUNNING;if(u||d>zt){t.activeAction="moving",t.target=s.id;const f=Ft(t.position,s.position,r.gameState.mapDimensions);return t.direction=f,I.RUNNING}return I.FAILURE},"Move to Bush or Graze",e+1)],"Prey Graze",e)}function z1(e){const t=new J((s,u,d)=>{const f=Oe(s,u.gameState,"prey",zt,g=>g.id!==s.id&&g.gender!==s.gender&&!!g.isAdult&&g.age>=qs&&g.age<=Gd&&!g.isPregnant&&(!g.procreationCooldown||g.procreationCooldown<=0)&&g.hunger<200);return f?(_.set(d,"procreationPartner",f.id),!0):!1},"Find Immediate Partner",e+2),r=new ue((s,u,d)=>{const f=_.get(d,"procreationPartner"),g=f&&u.gameState.entities.entities[f];return g?(s.activeAction="procreating",s.target=g.id,s.direction={x:0,y:0},_.delete(d,"procreationPartner"),I.SUCCESS):I.FAILURE},"Start Procreating",e+2),o=new J((s,u,d)=>{const f=Oe(s,u.gameState,"prey",zt*10,g=>g.id!==s.id&&g.gender!==s.gender&&!!g.isAdult&&g.age>=qs&&g.age<=Gd&&!g.isPregnant&&(!g.procreationCooldown||g.procreationCooldown<=0)&&g.hunger<200);return f?(_.set(d,"procreationPartner",f.id),!0):!1},"Locate Distant Partner",e+2),l=new ue((s,u,d)=>{const f=_.get(d,"procreationPartner"),g=f&&u.gameState.entities.entities[f];if(!g)return I.FAILURE;if(V(s.position,g.position,u.gameState.mapDimensions.width,u.gameState.mapDimensions.height)<=zt)return I.SUCCESS;s.activeAction="moving",s.target=g.id;const S=ze(s.position,g.position,u.gameState.mapDimensions.width,u.gameState.mapDimensions.height);return s.direction=nt(S),I.RUNNING},"Move Towards Partner",e+2);return new ve([new J(s=>!!(s.isAdult&&!s.isPregnant&&s.age>=qs&&s.age<=Gd&&s.hunger<200&&(!s.procreationCooldown||s.procreationCooldown<=0)),"Is Fertile and Ready",e+1),new Qt([new ve([t,r],"Procreate With Immediate Partner",e+2),new ve([o,l],"Seek Distant Partner",e+2)],"Find Partner And Procreate",e+1)],"Prey Procreate",e)}const W1=(e,t,r)=>{const o=t.gameState.search.prey.byProperty("motherId",e.id).filter(u=>!u.isAdult&&u.type==="prey");if(o.length===0)return I.FAILURE;let l=null,s=Ru;for(const u of o)u.hunger>=s&&(s=u.hunger,l=u);return l?(_.set(r,"targetChild",l.id),I.SUCCESS):I.FAILURE},Y1=(e,t,r)=>{const o=_.get(r,"targetChild"),l=o&&t.gameState.entities.entities[o];return l?V(e.position,l.position,t.gameState.mapDimensions.width,t.gameState.mapDimensions.height)>Wo?(e.activeAction="moving",e.target=l.id,e.direction=Ft(e.position,l.position,t.gameState.mapDimensions),I.RUNNING):(e.activeAction="feeding",e.target=void 0,_.set(r,"targetChild",void 0),I.SUCCESS):I.FAILURE};function j1(e){return new ve([new J(t=>(t.isAdult&&t.gender==="female"&&t.hunger<80&&(!t.feedChildCooldownTime||t.feedChildCooldownTime<=0))??!1,"Can Feed Child (Female Only)",e+1),new ue(W1,"Find Hungriest Prey Child",e+1),new ue(Y1,"Move To Child and Feed",e+1)],"Feed Prey Child",e)}function V1(e){return new ve([new J(t=>!t.isAdult&&t.hunger>=Ru,"Is Hungry Prey Child",e+1),new ue((t,r,o)=>{if(!t.motherId)return I.FAILURE;const l=r.gameState.entities.entities[t.motherId];return l?(_.set(o,"targetParent",l.id),I.SUCCESS):I.FAILURE},"Find Female Parent",e+1),new ue((t,r,o)=>{const l=_.get(o,"targetParent"),s=l&&r.gameState.entities.entities[l];if(!s)return I.FAILURE;const u=V(t.position,s.position,r.gameState.mapDimensions.width,r.gameState.mapDimensions.height);return t.activeAction="idle",u<=Wo?(t.target=void 0,I.SUCCESS):(t.target=s.id,t.activeAction="moving",I.RUNNING)},"Move To Female Parent",e+1)],"Seek Food From Female Parent",e)}const Hs="huntTarget";function X1(e,t,r){if(!(e!=null&&e.aiBlackboard))return!0;const o=`tribal_hunt_${t}`,l=_.get(e.aiBlackboard,o);return!l||r-l.startTime>Bo?!0:l.memberIds.length<(l.maxCapacity||lh)}function K1(e,t){if(!(e!=null&&e.aiBlackboard))return 0;const r=`tribal_hunt_${t}`,o=_.get(e.aiBlackboard,r);return(o==null?void 0:o.memberIds.length)??0}function Z1(e){return new ve([new J((t,r,o)=>{if(!t.isAdult)return[!1,"Not an adult"];if(t.hunger<=50||t.huntCooldown&&t.huntCooldown>0)return!1;const l=Oe(t,r.gameState,"prey",yo*10,s=>{if(s.hitpoints<=0)return!1;const u=fa(t,r.gameState);return!(u&&!X1(u,s.id,r.gameState.time))});if(l){const s=V(t.position,l.position,r.gameState.mapDimensions.width,r.gameState.mapDimensions.height),u=fa(t,r.gameState),d=u?K1(u,l.id):0;if(s<=yo)return _.set(o,Hs,l.id),[!0,`Prey in range (${d} hunters)`];if(s<=yo*10)return _.set(o,Hs,l.id),_.set(o,"needToApproach",!0),[!0,`Approaching prey (${d} hunters)`]}return!1},"Find Prey Target",e+1),new nr(new hu(new ue((t,r,o)=>{const l=_.get(o,Hs),s=l&&r.gameState.entities.entities[l],u=_.get(o,"needToApproach");if(!s||s.hitpoints<=0)return _.delete(o,Hs),_.delete(o,"needToApproach"),I.SUCCESS;const d=V(t.position,s.position,r.gameState.mapDimensions.width,r.gameState.mapDimensions.height);if(d<=yo)return t.activeAction="attacking",t.attackTargetId=s.id,t.target=s.id,t.direction={x:0,y:0},_.delete(o,"needToApproach"),I.RUNNING;if(u||d>yo){t.activeAction="moving",t.target=s.id;const f=ze(t.position,s.position,r.gameState.mapDimensions.width,r.gameState.mapDimensions.height);return t.direction=nt(f),I.RUNNING}return I.FAILURE},"Hunt or Approach Prey",e+3),10,"Hunt Timeout (10 hour)",e+2),{taskType:"hunt",maxCapacity:lh,getTargetId:(t,r,o)=>_.get(o,Hs)},"Tribal Hunt Decorator",e+1)],"Predator Hunt",e)}function q1(e){return new ve([new J((t,r,o)=>{const l=t.hunger>100,s=t.hitpoints<t.maxHitpoints*.5;if(!l&&!s||t.attackCooldown&&t.attackCooldown>0)return!1;const u=Oe(t,r.gameState,"human",kn*2,d=>d.hitpoints>0);if(u){const d=V(t.position,u.position,r.gameState.mapDimensions.width,r.gameState.mapDimensions.height);if(d<=kn)return _.set(o,"attackTarget",u.id),!0;if(l&&d<=kn*2)return _.set(o,"attackTarget",u.id),_.set(o,"needToApproach",!0),!0}return!1},"Find Human Target",e+1),new ue((t,r,o)=>{const l=_.get(o,"attackTarget"),s=l&&r.gameState.entities.entities[l],u=_.get(o,"needToApproach");if(!s||s.hitpoints<=0)return I.FAILURE;const d=V(t.position,s.position,r.gameState.mapDimensions.width,r.gameState.mapDimensions.height);if(d<=kn)return t.activeAction="attacking",t.attackTargetId=s.id,t.target=s.id,t.direction={x:0,y:0},_.delete(o,"needToApproach"),I.RUNNING;if(u||d>kn){t.activeAction="moving",t.target=s.id;const f=ze(t.position,s.position,r.gameState.mapDimensions.width,r.gameState.mapDimensions.height);return t.direction=nt(f),I.RUNNING}return I.FAILURE},"Attack or Approach Human",e+1)],"Predator Attack Human",e)}function Q1(e){const t=new J((s,u,d)=>{const f=Oe(s,u.gameState,"predator",qi,g=>g.id!==s.id&&g.gender!==s.gender&&!!g.isAdult&&g.age>=Qs&&g.age<=xd&&!g.isPregnant&&(!g.procreationCooldown||g.procreationCooldown<=0)&&g.hunger<200);return f?(_.set(d,"procreationPartner",f.id),!0):!1},"Find Immediate Partner",e+2),r=new ue((s,u,d)=>{const f=_.get(d,"procreationPartner"),g=f&&u.gameState.entities.entities[f];return g?(s.activeAction="procreating",s.target=g.id,s.direction={x:0,y:0},_.delete(d,"procreationPartner"),I.SUCCESS):I.FAILURE},"Start Procreating",e+2),o=new J((s,u,d)=>{const f=Oe(s,u.gameState,"predator",qi*10,g=>g.id!==s.id&&g.gender!==s.gender&&!!g.isAdult&&g.age>=Qs&&g.age<=xd&&!g.isPregnant&&(!g.procreationCooldown||g.procreationCooldown<=0)&&g.hunger<200);return f?(_.set(d,"procreationPartner",f.id),!0):!1},"Locate Distant Partner",e+2),l=new ue((s,u,d)=>{const f=_.get(d,"procreationPartner"),g=f&&u.gameState.entities.entities[f];if(!g)return I.FAILURE;if(V(s.position,g.position,u.gameState.mapDimensions.width,u.gameState.mapDimensions.height)<=qi)return I.SUCCESS;s.activeAction="moving",s.target=g.id;const S=ze(s.position,g.position,u.gameState.mapDimensions.width,u.gameState.mapDimensions.height);return s.direction=nt(S),I.RUNNING},"Move Towards Partner",e+2);return new ve([new J(s=>!!(s.isAdult&&!s.isPregnant&&s.age>=Qs&&s.age<=xd&&s.hunger<200&&(!s.procreationCooldown||s.procreationCooldown<=0)),"Is Fertile and Ready",e+1),new Qt([new ve([t,r],"Procreate With Immediate Partner",e+2),new ve([o,l],"Seek Distant Partner",e+2)],"Find Partner And Procreate",e+1)],"Predator Procreate",e)}const J1=(e,t,r)=>{const o=t.gameState.search.predator.byProperty("motherId",e.id).filter(u=>!u.isAdult&&u.type==="predator");if(o.length===0)return I.FAILURE;let l=null,s=Ru;for(const u of o)u.hunger>=s&&(s=u.hunger,l=u);return l?(_.set(r,"targetChild",l.id),I.SUCCESS):I.FAILURE},eR=(e,t,r)=>{const o=_.get(r,"targetChild"),l=o&&t.gameState.entities.entities[o];return l?V(e.position,l.position,t.gameState.mapDimensions.width,t.gameState.mapDimensions.height)>Wo?(e.activeAction="moving",e.target=l.id,e.direction=Ft(e.position,l.position,t.gameState.mapDimensions),I.RUNNING):(e.activeAction="feeding",e.target=void 0,_.set(r,"targetChild",void 0),I.SUCCESS):I.FAILURE};function tR(e){return new ve([new J(t=>(t.isAdult&&t.gender==="female"&&t.hunger<90&&(!t.feedChildCooldownTime||t.feedChildCooldownTime<=0))??!1,"Can Feed Child (Female Only)",e+1),new ue(J1,"Find Hungriest Predator Child",e+1),new ue(eR,"Move To Child and Feed",e+1)],"Feed Predator Child",e)}function nR(e){return new ve([new J(t=>!t.isAdult&&t.hunger>=Ru,"Is Hungry Predator Child",e+1),new ue((t,r,o)=>{if(!t.motherId)return I.FAILURE;const l=r.gameState.entities.entities[t.motherId];return l?(_.set(o,"targetParent",l.id),I.SUCCESS):I.FAILURE},"Find Female Parent",e+1),new ue((t,r,o)=>{const l=_.get(o,"targetParent"),s=l&&r.gameState.entities.entities[l];if(!s)return I.FAILURE;const u=V(t.position,s.position,r.gameState.mapDimensions.width,r.gameState.mapDimensions.height);return t.activeAction="idle",u<=Wo?(t.target=void 0,I.SUCCESS):(t.target=s.id,t.activeAction="moving",I.RUNNING)},"Move To Female Parent",e+1)],"Seek Food From Female Parent",e)}function fS(e){return new ue((t,r,o)=>{t.activeAction="idle";let l=_.get(o,"wanderTarget"),s=_.get(o,"wanderStartTime");const u=r.gameState.time;if(!l||!s||u-s>2){const d=Math.random()*2*Math.PI,f=50+Math.random()*100,g={x:Math.cos(d),y:Math.sin(d)},m=Un(t.position,Pt(g,f));l={x:(m.x%r.gameState.mapDimensions.width+r.gameState.mapDimensions.width)%r.gameState.mapDimensions.width,y:(m.y%r.gameState.mapDimensions.height+r.gameState.mapDimensions.height)%r.gameState.mapDimensions.height},_.set(o,"wanderTarget",l),_.set(o,"wanderStartTime",u)}if(l){t.target=l;let d=l.x-t.position.x,f=l.y-t.position.y;const g=r.gameState.mapDimensions.width,m=r.gameState.mapDimensions.height;Math.abs(d)>g/2&&(d=d>0?d-g:d+g),Math.abs(f)>m/2&&(f=f>0?f-m:f+m);const S=nt({x:d,y:f});t.direction=S}return I.SUCCESS},"Animal Wander",e)}function iR(e){return new ve([new J((t,r,o)=>{if(t.hunger>90||t.hitpoints<t.maxHitpoints*.3||t.activeAction==="grazing"||t.activeAction==="procreating")return!1;const l=Object.values(r.gameState.entities.entities),s=[];for(const u of l)if(u.type==="prey"&&u.id!==t.id){const d=u;d.hitpoints>0&&d.isAdult&&V(t.position,d.position,r.gameState.mapDimensions.width,r.gameState.mapDimensions.height)<=zt*5&&s.push(d)}if(s.length>=2){let u=0,d=0;for(const m of s)u+=m.position.x,d+=m.position.y;u/=s.length,d/=s.length;const f={x:u,y:d};if(V(t.position,f,r.gameState.mapDimensions.width,r.gameState.mapDimensions.height)>zt*2)return _.set(o,"herdCenter",f),_.set(o,"herdSize",s.length),!0}return!1},"Find Herd",e+1),new ue((t,r,o)=>{const l=_.get(o,"herdCenter");if(!l)return I.FAILURE;if(V(t.position,l,r.gameState.mapDimensions.width,r.gameState.mapDimensions.height)>zt*2){t.activeAction="moving",t.target=l;const u=ze(t.position,l,r.gameState.mapDimensions.width,r.gameState.mapDimensions.height);return t.direction=nt(u),I.RUNNING}else return t.activeAction="idle",t.direction={x:0,y:0},I.SUCCESS},"Join Herd",e+1)],"Prey Herd Behavior",e)}function rR(e){return new ve([new J((t,r,o)=>{if(t.hunger>100||t.hitpoints<t.maxHitpoints*.4||t.activeAction==="attacking"||t.activeAction==="procreating")return!1;const l=Oe(t,r.gameState,"predator",qi*4,s=>s.id!==t.id&&s.hitpoints>0&&s.isAdult&&t.fatherId!==void 0&&s.fatherId===t.fatherId&&s.age>=t.age||s.hitpoints>t.hitpoints);return l&&V(t.position,l.position,r.gameState.mapDimensions.width,r.gameState.mapDimensions.height)>qi*2?(_.set(o,"packLeader",l.id),!0):!1},"Find Pack Leader",e+1),new ue((t,r,o)=>{const l=_.get(o,"packLeader"),s=l&&r.gameState.entities.entities[l];if(!s||s.hitpoints<=0)return I.FAILURE;if(V(t.position,s.position,r.gameState.mapDimensions.width,r.gameState.mapDimensions.height)>qi*2){t.activeAction="moving",t.target=s.id;const d=ze(t.position,s.position,r.gameState.mapDimensions.width,r.gameState.mapDimensions.height);return t.direction=nt(d),I.RUNNING}else return t.activeAction="idle",t.direction={x:0,y:0},I.SUCCESS},"Follow Pack Leader",e+1)],"Predator Pack Behavior",e)}function oR(e){return new ve([new J((t,r,o)=>{if(!t.isAdult||t.hitpoints<t.maxHitpoints*.6||t.hunger>120||t.attackCooldown&&t.attackCooldown>0)return!1;const l=Oe(t,r.gameState,"predator",d0,s=>!!(s.id!==t.id&&s.hitpoints>0&&s.isAdult&&t.fatherId!==s.fatherId&&t.gender===s.gender&&t.fatherId!==void 0&&s.fatherId!==void 0));if(l){const s=V(t.position,l.position,r.gameState.mapDimensions.width,r.gameState.mapDimensions.height);if(s<=kn)return _.set(o,"territorialTarget",l.id),!0;if(s<=d0)return _.set(o,"territorialTarget",l.id),_.set(o,"needToApproach",!0),!0}return!1},"Find Territorial Rival",e+1),new ue((t,r,o)=>{const l=_.get(o,"territorialTarget"),s=l&&r.gameState.entities.entities[l],u=_.get(o,"needToApproach");if(!s||s.hitpoints<=0)return I.FAILURE;const d=V(t.position,s.position,r.gameState.mapDimensions.width,r.gameState.mapDimensions.height);if(d<=kn)return t.activeAction="attacking",t.attackTargetId=s.id,t.target=s.id,t.direction={x:0,y:0},_.delete(o,"needToApproach"),I.RUNNING;if(u||d>kn){t.activeAction="moving",t.target=s.id;const f=ze(t.position,s.position,r.gameState.mapDimensions.width,r.gameState.mapDimensions.height);return t.direction=nt(f),I.RUNNING}return I.FAILURE},"Territorial Fight or Approach",e+1)],"Predator Territorial Defense",e)}function sR(){const e=new Qt([r1(2),M1(2),new sn(G1(2),"attack","Gated Defend Against Predator",2),new sn(O1(2),"attack","Gated Jealousy Attack",2),new sn(k1(2),"attack","Gated Desperate Attack",2),U1(2),new ho(E1(3),"Gated Leader Combat Strategy",2),new ho(H1(3),"Gated Diplomacy",2),new ho(new Po(R1(4),nE,"Cache Building Placement",3),"Gated Leader Building Placement",2),w1(2),new sn(I1(3),"attack","Gated Storage Steal",2),new sn(f1(3),"attack","Gated Attacking",2),i1(2),new sn(A1(3),"gathering","Gated Storage Retrieve",2),new hu(new sn(u1(4),"gathering","Gated Gathering",3),Sf,"Timeout Gathering",2),new sn(T1(3),"gathering","Gated Storage Deposit",2),new sn(p1(3),"feedChildren","Gated Feed Child",2),m1(2),new hu(new sn(y1(4),"planting","Gated Planting",3),Sf,"Timeout Planting",2),new sn(b1(3),"attack","Gated Hunt Prey",2),new sn(d1(3),"procreation","Gated Procreation",2),new Po(D1(3),yf,"Cache Tribe Split",2),new ho(B1(3),"Gated Tribe Migration",2),new Po(P1(3),yf,"Cache Establish Territory",2),new sn(L1(3),"followLeader","Gated Follow Leader",2),new ho(N1(2),"Gated Follow Patriarch",2),new ho(c1(2),"Gated Idle Wander",2)],"AI Root Selector",1);return new t1(e,"Manual Control Gate",0)}const hS=sR();function aR(e,t){e.aiBlackboard&&_.cleanupOldEntries(e.aiBlackboard,t.gameState.time);const r=fa(e,t.gameState);r&&r.id===e.id&&r.aiBlackboard&&n1(r,t.gameState.time);const o=performance.now();switch(e.aiType){case Sa.BehaviorTreeBased:default:ah(e,t,hS);break}t.gameState.performanceMetrics.currentBucket.aiUpdateTime+=performance.now()-o}function lR(){return new Qt([x1(1),j1(1),V1(1),$1(1),z1(1),iR(1),fS(1)],"Prey Behavior Root",0)}function uR(){return new Qt([Z1(1),q1(1),tR(1),nR(1),oR(1),Q1(1),rR(1),fS(1)],"Predator Behavior Root",0)}const gS=lR();function cR(e,t){e.aiBlackboard?ah(e,t,gS):(console.warn(`Behavior Tree AI ticked for prey ${e.id}, but the tree or blackboard was missing.`),e.activeAction="idle")}const pS=uR();function dR(e,t){e.aiBlackboard?ah(e,t,pS):(console.warn(`Behavior Tree AI ticked for predator ${e.id}, but the tree or blackboard was missing.`),e.activeAction="idle")}function fR(e,t){const{gameState:r,deltaTime:o}=t,l=o*(Tt/At);if(e.isBeingDestroyed){const s=H_(e.buildingType);if(s>0?e.destructionProgress+=l/s:e.destructionProgress=1,e.destructionProgress>=1){jo(r.entities,e.id);return}}if(!e.isConstructed&&!e.isBeingDestroyed){const s=B_(e.buildingType);s>0?e.constructionProgress+=l/s:e.constructionProgress=1,e.constructionProgress>=1&&(e.constructionProgress=1,e.isConstructed=!0)}}function hR(e,t){e.forces.push(Pt(e.velocity,-.1));const r=Pt(nt(e.direction),e.acceleration);e.forces.push(r),e.debuffs.forEach(o=>{t.gameState.time-o.startTime<o.duration&&o.type==="slow"&&(e.velocity=Pt(e.velocity,.5))}),e.debuffs=e.debuffs.filter(o=>t.gameState.time-o.startTime<o.duration),e.velocity=Un(e.velocity,e.forces.reduce(Un,{x:0,y:0})),Fo(e.velocity)<.001&&(e.velocity={x:0,y:0}),e.position=Un(e.position,Pt(e.velocity,t.deltaTime)),e.position.x=(e.position.x%t.gameState.mapDimensions.width+t.gameState.mapDimensions.width)%t.gameState.mapDimensions.width,e.position.y=(e.position.y%t.gameState.mapDimensions.height+t.gameState.mapDimensions.height)%t.gameState.mapDimensions.height,e.forces=[],e.type==="human"?KC(e,t,t.deltaTime):e.type==="corpse"?ZC(e,t):e.type==="prey"?qC(e,t,t.deltaTime):e.type==="predator"?QC(e,t,t.deltaTime):e.type==="building"&&fR(e,t),e.type==="human"&&aR(e,t),e.type==="prey"?cR(e,t):e.type==="predator"&&dR(e,t),e.stateMachine&&(e.stateMachine=XC(...e.stateMachine,{entity:e,updateContext:t}))}function gR(e){const t=e.gameState.entities;Object.values(t.entities).forEach(r=>{hR(r,e)})}function mS(){return{entities:{},nextEntityId:1}}function Yo(e,t,r){const o={id:e.nextEntityId++,type:t,velocity:{x:0,y:0},direction:{x:0,y:0},acceleration:0,forces:[],debuffs:[],...r};return e.entities[o.id]=o,o}function ya(e,t,r){return Yo(e,"berryBush",{position:t,radius:mf,food:Array.from({length:iI},()=>({type:Ln.Berry})).map(l=>({...l,id:e.nextEntityId++})),maxFood:nI,lifespan:oI,age:0,spreadRadius:mf,timeSinceLastBerryRegen:0,timeSinceLastSpreadAttempt:0,timeSinceLastHarvest:0,stateMachine:[js,{enteredAt:r,previousState:void 0}]})}function gu(e,t,r,o,l=!1,s=dE,u=Sv,d,f,g=[],m,S){const y=s>=Gf;return Yo(e,"human",{position:t,radius:y?Et:$o,hunger:u,hitpoints:bm,maxHitpoints:bm,age:s,gender:o,isPlayer:l,food:[],maxFood:vv,maxAge:ra,isAdult:y,isPregnant:!1,gestationTime:0,procreationCooldown:0,attackCooldown:0,motherId:d,fatherId:f,ancestorIds:g,stateMachine:[ct,{enteredAt:r,previousState:void 0}],leaderId:m,tribeBadge:S,aiType:Sa.BehaviorTreeBased,aiBlackboard:_.create()})}function uh(e,t,r,o,l,s,u,d,f,g,m){let S,y;switch(u){case"human":S=Av,y=Lr;break;case"prey":S=2,y=120;break;case"predator":S=4,y=140;break}return Yo(e,"corpse",{position:t,radius:l,gender:r,age:o,originalEntityId:s,originalEntityType:u,timeOfDeath:d,decayProgress:0,geneCode:m,food:[...Array.from({length:Math.max(S*Math.max(y-g,0)/y,0)},()=>({type:Ln.Meat})),...f].map(T=>({...T,id:e.nextEntityId++})),stateMachine:void 0})}function pR(e,t,r,o,l,s,u,d,f){return uh(e,t,r,o,l,s,"human",u,d,f)}function mR(e,t,r,o,l,s,u,d){return uh(e,t,r,o,l,s,"prey",u,[],0,d)}function vR(e,t,r,o,l,s,u,d){return uh(e,t,r,o,l,s,"predator",u,[],0,d)}function SR(e,t,r){const o=t?r.gameState.entities.entities[t]:void 0,l=[...e.ancestorIds||[],e.id],s=o?[...o.ancestorIds||[],o.id]:[],u=[...l,...s],d=[...new Set(u)],f=d.slice(Math.max(d.length-aE,0)),g=Math.random()<.5?"male":"female",m=Un(e.position,{x:5,y:5}),S=gu(r.gameState.entities,m,r.gameState.time,g,!1,0,Sv/2,e.id,t,f,(o==null?void 0:o.leaderId)??e.leaderId,(o==null?void 0:o.tribeBadge)??e.tribeBadge);return Ie(r,fe.Birth,e.position),S}function jo(e,t){return e.entities[t]?(delete e.entities[t],!0):!1}function Ho(e,t,r,o=TC,l=tS,s,u,d){const f=o>=qs,g=Date.now();return Yo(e,"prey",{position:t,radius:f?Et*.7:$o*.7,hunger:l,hitpoints:u0,maxHitpoints:u0,age:o,maxAge:eS,gender:r,isAdult:f,isPregnant:!1,gestationTime:0,procreationCooldown:0,geneCode:s,motherId:u,fatherId:d,stateMachine:[Mn,{enteredAt:g,previousState:void 0}],aiType:Sa.BehaviorTreeBased,aiBlackboard:_.create()})}function bo(e,t,r,o=PC,l=iS,s,u,d){const f=o>=Qs,g=Date.now();return Yo(e,"predator",{position:t,radius:f?Et*.9:$o*.9,hunger:l,hitpoints:c0,maxHitpoints:c0,age:o,maxAge:nS,gender:r,isAdult:f,isPregnant:!1,gestationTime:0,procreationCooldown:0,geneCode:s,motherId:u,fatherId:d,stateMachine:[$t,{enteredAt:g,previousState:void 0}],aiType:Sa.BehaviorTreeBased,aiBlackboard:_.create()})}function yR(e,t,r,o){const l=Xv(r),s={position:t,radius:Math.max(l.width,l.height)/2,buildingType:r,ownerId:o,width:l.width,height:l.height,constructionProgress:0,destructionProgress:0,isConstructed:!1,isBeingDestroyed:!1};return Yo(e,"building",{...s,...r===On.StorageSpot&&{storedFood:[],storageCapacity:N_,lastDepositTime:0,lastRetrieveTime:0,lastStealTime:0}})}var Gt=(e=>(e.MOVE="MOVE",e.HUNGER="HUNGER",e.EAT="EAT",e.FIND_BUSH="FIND_BUSH",e.GATHER="GATHER",e.PROCREATE="PROCREATE",e.PLANT_BUSH="PLANT_BUSH",e.AUTOPILOT="AUTOPILOT",e.ANIMALS_INTRODUCTION="ANIMALS_INTRODUCTION",e.HUNT_PREY="HUNT_PREY",e.DEFEND_FROM_PREDATORS="DEFEND_FROM_PREDATORS",e))(Gt||{}),Mr=(e=>(e.HUNGER_BAR="HUNGER_BAR",e.FOOD_BAR="FOOD_BAR",e.COMMAND_BUTTONS="COMMAND_BUTTONS",e))(Mr||{}),xt=(e=>(e[e.FADING_IN=0]="FADING_IN",e[e.ACTIVE=1]="ACTIVE",e[e.FADING_OUT=2]="FADING_OUT",e[e.INACTIVE=3]="INACTIVE",e))(xt||{});const wf={},_f={},TR=[{key:Gt.MOVE,title:"Movement",text:"Use WASD or Arrow Keys to move your character around the world.",condition:e=>e.hasPlayerMovedEver||e.hasPlayerEnabledAutopilot>2,isCompleted:!1},{key:Gt.HUNGER,title:"Hunger",text:"Your character gets hungry over time. Watch the hunger bar!",condition:(e,t)=>t.hunger>lE,isCompleted:!1,minDisplayTime:t0,highlightedUIElements:[Mr.HUNGER_BAR]},{key:Gt.FIND_BUSH,title:"Find Food",text:"Look for berry bushes. They are your primary source of food.",condition:(e,t)=>!!Oe(t,e,"berryBush",Rt*5,o=>o.food.length>0),getTargets:(e,t)=>{const r=[];for(const o of Object.values(e.entities.entities))o.type==="berryBush"&&o.food.length>0&&V(t.position,o.position,e.mapDimensions.width,e.mapDimensions.height)<500&&r.push(o);return r.map(o=>o.id)},isCompleted:!1,minDisplayTime:t0},{key:Gt.GATHER,title:"Gather Berries",text:"Get close to a bush and press 'E' to gather berries.",condition:(e,t)=>t.food.length>0,getTargets:(e,t)=>{const r=Oe(t,e,"berryBush",Rt,o=>o.food.length>0);return r?[r.id]:[]},isCompleted:!1},{key:Gt.EAT,title:"Eat",text:"When you are hungry and have food, press 'F' to eat.",condition:(e,t)=>t.activeAction==="eating",isCompleted:!1,highlightedUIElements:[Mr.FOOD_BAR]},{key:Gt.PROCREATE,title:"Procreate",text:"Find a mate and press 'R' to start a family. This is how you continue your lineage.",condition:(e,t)=>Lt(e,t).length>0,getTargets:(e,t)=>{const r=Oe(t,e,"human",Rt,o=>Hr(t,o,e));return r?[r.id]:[]},isCompleted:!1},{key:Gt.PLANT_BUSH,title:"Farming",text:"You can plant new berry bushes. Carry some berries and press 'B' to plant.",condition:(e,t)=>ih(e,t).some(o=>o.type===se.Plant)||e.hasPlayerPlantedBush===!0,isCompleted:!1},{key:Gt.AUTOPILOT,title:"Autopilot!",text:"You can turn autopilot for specific actions, press Shift and click on the action button to enable it.",condition:e=>e.hasPlayerEnabledAutopilot>2,highlightedUIElements:[Mr.COMMAND_BUTTONS],isCompleted:!1},{key:Gt.ANIMALS_INTRODUCTION,title:"Wild Animals!",text:"Your world now has wild animals! Prey provide meat when hunted, but beware of predators that may attack.",condition:e=>Object.values(e.entities.entities).some(r=>r.type==="prey"||r.type==="predator"),isCompleted:!1,dependsOn:Gt.AUTOPILOT},{key:Gt.HUNT_PREY,title:"Hunt for Meat",text:"Click on prey animals to hunt them for meat. Hunting provides more food than gathering berries!",condition:(e,t)=>{const r=Oe(t,e,"prey",150);return t.hunger>40&&!!r},getTargets:(e,t)=>{const r=Oe(t,e,"prey",150);return r?[r.id]:[]},isCompleted:!1,dependsOn:Gt.ANIMALS_INTRODUCTION},{key:Gt.DEFEND_FROM_PREDATORS,title:"Predators",text:"Predators may attack when hungry! Click on them to fight back. Fighting together with family is more effective.",condition:(e,t)=>!!Oe(t,e,"predator",120),getTargets:(e,t)=>{const r=Oe(t,e,"predator",120);return r?[r.id]:[]},isCompleted:!1,dependsOn:Gt.HUNT_PREY}].map(e=>({...e,condition:e.condition?ER(e.condition):void 0,getTargets:e.getTargets?wR(e.getTargets):void 0}));function vS(){return{steps:TR.map(e=>({...e,isCompleted:!1}))}}function SS(){return{currentStepIndex:0,completedSteps:[],isActive:!0,transitionState:xt.FADING_IN,transitionAlpha:0,highlightedEntityIds:[],stepStartTime:null,activeUIHighlights:[]}}function AR(e){for(let t=0;t<e.tutorial.steps.length;t++){const r=e.tutorial.steps[t];if(!r.isCompleted)if(r.dependsOn){if(e.tutorialState.completedSteps.includes(r.dependsOn))return t}else return t}return null}function IR(e,t){const r=e.tutorialState;if(!r.isActive){r.transitionState=xt.INACTIVE,r.highlightedEntityIds=[],r.activeUIHighlights=[];return}const o=It(e);if(!o){r.isActive=!1,r.transitionState=xt.INACTIVE,r.highlightedEntityIds=[],r.activeUIHighlights=[];return}const l=e.tutorial.steps[r.currentStepIndex];if(!l){r.isActive=!1,r.transitionState=xt.INACTIVE,r.highlightedEntityIds=[],r.activeUIHighlights=[];return}const s=1/$w;switch(r.transitionState){case xt.FADING_IN:r.stepStartTime===null&&(r.stepStartTime=e.time),r.transitionAlpha+=s*t,r.transitionAlpha>=1&&(r.transitionAlpha=1,r.transitionState=xt.ACTIVE);break;case xt.ACTIVE:{const f=e.time-(r.stepStartTime||e.time)>=(l.minDisplayTime||0),g=wf[l.condition];g&&f&&g(e,o)&&(l.isCompleted=!0,r.completedSteps.includes(l.key)||r.completedSteps.push(l.key),r.transitionState=xt.FADING_OUT);break}case xt.FADING_OUT:if(r.transitionAlpha-=s*t,r.transitionAlpha<=0){r.transitionAlpha=0,r.stepStartTime=null;const d=AR(e);d!==null?(r.currentStepIndex=d,r.transitionState=xt.FADING_IN):(r.isActive=!1,r.transitionState=xt.INACTIVE)}break}if(r.transitionState!==xt.FADING_OUT&&r.transitionState!==xt.INACTIVE){const d=_f[l.getTargets||""];d?r.highlightedEntityIds=[...d(e,o)]:r.highlightedEntityIds=[],l.highlightedUIElements?r.activeUIHighlights=[...l.highlightedUIElements]:r.activeUIHighlights=[]}else r.highlightedEntityIds=[],r.activeUIHighlights=[]}function ER(e){const t=`condition_${Object.keys(wf).length+1}`;return wf[t]=e,t}function wR(e){const t=`getTargets_${Object.keys(_f).length+1}`;return _f[t]=e,t}function _R(){const e=mS(),t=0;for(let S=0;S<dv;S++){const y={x:Math.random()*et,y:Math.random()*tt};ya(e,y,t)}const r=et/2,o=tt/2,l=gu(e,{x:r,y:o},t,"male",!0);gu(e,{x:r+50,y:o},t,"female",!1);for(let S=0;S<sS;S++){const y={x:r+et*(Math.random()-Math.random()),y:o+tt*(Math.random()-Math.random())};Ho(e,y,"male",void 0,void 0,ca()),Ho(e,{x:y.x+20,y:y.y},"female",void 0,void 0,ca())}const s={x:r+et*(Math.random()-Math.random()),y:o+tt*(Math.random()-Math.random())};bo(e,s,"male",void 0,void 0,da()),bo(e,{x:s.x+20,y:s.y},"female",void 0,void 0,da());const u=[{id:"muteButton",action:ge.ToggleMute,currentWidth:fi,rect:{x:0,y:0,width:0,height:0},text:"",backgroundColor:"",textColor:yn},{id:"pauseButton",action:ge.TogglePause,currentWidth:fi,rect:{x:0,y:0,width:0,height:0},text:"",backgroundColor:"",textColor:yn},{id:"returnToIntroButton",action:ge.ReturnToIntro,currentWidth:fi,rect:{x:0,y:0,width:0,height:0},text:"EXIT",backgroundColor:"",textColor:yn}],d=vS(),f=SS(),g={time:t,entities:e,mapDimensions:{width:et,height:tt},generationCount:1,gameOver:!1,visualEffects:[],nextVisualEffectId:0,viewportCenter:{...l.position},isPaused:!1,exitConfirmation:"inactive",autopilotControls:{behaviors:{procreation:!1,planting:!1,gathering:!1,attack:!1,feedChildren:!0,followLeader:!1},hoveredAutopilotAction:void 0,activeAutopilotAction:void 0,isManuallyMoving:!1},buildMenuOpen:!1,selectedBuildingType:null,selectedBuildingForRemoval:null,hasPlayerMovedEver:!1,hasPlayerPlantedBush:!1,hasPlayerEnabledAutopilot:0,masterVolume:jv,isMuted:!1,uiButtons:u,tutorial:d,tutorialState:f,debugPanel:Ct.None,performanceMetrics:{currentBucket:{renderTime:0,worldUpdateTime:0,aiUpdateTime:0},history:[]},hoveredButtonId:void 0,mousePosition:{x:0,y:0},notifications:[{id:"welcome",type:aa.Hello,message:"Welcome to the game!",duration:50,targetEntityIds:[l.id],highlightedEntityIds:[l.id],timestamp:0,isDismissed:!1,creationTime:Date.now()}],ecosystem:{preyGestationPeriod:Rr,preyProcreationCooldown:Pr,predatorGestationPeriod:Nr,predatorProcreationCooldown:Dr,preyHungerIncreasePerHour:Vi,predatorHungerIncreasePerHour:Xi,berryBushSpreadChance:mi},autosaveIntervalSeconds:5,lastAutosaveTime:Date.now()},m=mu(g);return console.log("Game world initialized:",m),m}function CR(){const e=mS(),t=0;for(let u=0;u<dv;u++){const d={x:Math.random()*et,y:Math.random()*tt};ya(e,d,t)}for(let u=0;u<JA;u++){const d={x:Math.random()*et,y:Math.random()*tt},f=Math.random()<.5?"male":"female";gu(e,d,t,f,!1)}for(let u=0;u<sS;u++){const d={x:Math.random()*et,y:Math.random()*tt};Ho(e,d,"male",void 0,void 0,ca()),Ho(e,{x:d.x+20,y:d.y},"female",void 0,void 0,ca())}const r={x:Math.random()*et,y:Math.random()*tt};bo(e,r,"male",void 0,void 0,da()),bo(e,{x:r.x+20,y:r.y},"female",void 0,void 0,da());const o=vS(),l=SS(),s={time:t,entities:e,mapDimensions:{width:et,height:tt},generationCount:0,gameOver:!1,visualEffects:[],nextVisualEffectId:0,viewportCenter:{x:et/2,y:tt/2},isPaused:!1,exitConfirmation:"inactive",autopilotControls:{behaviors:{procreation:!1,planting:!1,gathering:!1,attack:!1,feedChildren:!0,followLeader:!1},hoveredAutopilotAction:void 0,activeAutopilotAction:void 0,isManuallyMoving:!1},buildMenuOpen:!1,selectedBuildingType:null,selectedBuildingForRemoval:null,hasPlayerMovedEver:!1,hasPlayerPlantedBush:!1,hasPlayerEnabledAutopilot:0,masterVolume:jv,isMuted:!0,uiButtons:[],tutorial:o,tutorialState:l,debugPanel:Ct.None,performanceMetrics:{currentBucket:{renderTime:0,worldUpdateTime:0,aiUpdateTime:0},history:[]},hoveredButtonId:void 0,mousePosition:{x:0,y:0},notifications:[],ecosystem:{preyGestationPeriod:Rr,preyProcreationCooldown:Pr,predatorGestationPeriod:Nr,predatorProcreationCooldown:Dr,preyHungerIncreasePerHour:Vi,predatorHungerIncreasePerHour:Xi,berryBushSpreadChance:mi},lastAutosaveTime:0};return mu(s)}const RR="humanProcreation",PR="human",NR="human",DR=Rt,OR=(e,t,r)=>Hr(e,t,r.gameState)?e.gender==="male"?e.activeAction==="procreating":e.activeAction==="procreating"&&t.activeAction==="procreating":!1,MR=(e,t,r)=>{var f,g;const{gameState:o}=r,l={x:(e.position.x+t.position.x)/2,y:(e.position.y+t.position.y)/2},s=e.gender==="male"?e:t,u=e.gender==="female"?e:t,d=(s.partnerIds||[]).length===0;if(e.stateMachine=[ua,{partnerId:t.id,previousState:(f=e.stateMachine)==null?void 0:f[0]}],t.stateMachine=[ua,{partnerId:e.id,previousState:(g=t.stateMachine)==null?void 0:g[0]}],e.partnerIds||(e.partnerIds=[]),e.partnerIds.includes(t.id)||e.partnerIds.push(t.id),t.partnerIds||(t.partnerIds=[]),t.partnerIds.includes(e.id)||t.partnerIds.push(e.id),d&&s.leaderId&&s.leaderId!==s.id){const m=o.entities.entities[s.leaderId];if(m){const S=xm(s,m),y=xm(u,m);if(!S&&!y){const E=Af();s.leaderId=s.id,s.tribeBadge=E,s.diplomacy={},u.leaderId=s.id,u.tribeBadge=E}}}else if(!e.leaderId&&!t.leaderId&&s&&u){const m=Af();s.leaderId=s.id,s.tribeBadge=m,s.diplomacy={},u.leaderId=s.id,u.tribeBadge=m}e.activeAction=void 0,Me(o,ce.Procreation,l,_r),Me(o,ce.Partnered,e.position,xe,e.id),Me(o,ce.Partnered,t.position,xe,t.id),e.lastPartneredEffectTime=o.time,t.lastPartneredEffectTime=o.time,t.activeAction=void 0,Ie(r,fe.Procreate,l)},kR={id:RR,sourceType:PR,targetType:NR,maxDistance:DR,checker:OR,perform:MR},FR={id:"humanChildFeeding",sourceType:"human",targetType:"human",maxDistance:$f,checker:(e,t)=>e.isAdult===!0&&e.food.length>0&&(!e.feedChildCooldownTime||e.feedChildCooldownTime<=0)&&t.isAdult===!1&&(t.motherId===e.id||t.fatherId===e.id)&&t.hunger>=Ji&&e.activeAction==="feeding",perform:(e,t,r)=>{e.food.pop(),t.hunger=Math.max(0,t.hunger-Ji),e.feedChildCooldownTime=yE,(!t.lastChildFedEffectTime||r.gameState.time-t.lastChildFedEffectTime>2)&&(Me(r.gameState,ce.ChildFed,t.position,xe,t.id),t.lastChildFedEffectTime=r.gameState.time),Ie(r,fe.ChildFed,t.position)}},UR={id:"human-attack",sourceType:"human",targetType:"human",maxDistance:Jn,checker:(e,t,r)=>{var s;if(((s=e.stateMachine)==null?void 0:s[0])!==tr||e.attackTargetId!==t.id||(e.attackCooldown||0)>0)return!1;const o=e.stateMachine[1];return r.gameState.time-o.attackStartTime>=Iv},perform:(e,t,r)=>{const o=ze(e.position,t.position,r.gameState.mapDimensions.width,r.gameState.mapDimensions.height),l=UE(nt(o),t.direction);if(Math.abs(l)<OE*Math.PI/180&&Math.random()<ME)Me(r.gameState,ce.AttackDeflected,t.position,xe,t.id);else{let d=zf;e.gender==="male"&&(d*=PE),e.isAdult||(d*=NE),(!t.isAdult||t.age>=Tv)&&e.isAdult&&(d*=DE),t.hitpoints-=d,t.movementSlowdown={modifier:Wf,endTime:r.gameState.time+Yf},Me(r.gameState,ce.Hit,t.position,xe,t.id);const g=ze(e.position,t.position,r.gameState.mapDimensions.width,r.gameState.mapDimensions.height),m=Pt(g,_E);t.forces.push(m),t.hitpoints<=0?Ie(r,fe.HumanDeath,t.position):Ie(r,fe.Attack,e.position)}e.attackCooldown=wu;const u=e.stateMachine[1];u.attackStartTime=r.gameState.time,Me(r.gameState,ce.Attack,e.position,xe,e.id)}},LR={id:"human-collision",sourceType:"human",targetType:"human",maxDistance:Et*2,checker:(e,t,{gameState:r})=>V(e.position,t.position,r.mapDimensions.width,r.mapDimensions.height)<(e.radius+t.radius)/3,perform:(e,t,{gameState:r})=>{const o=V(e.position,t.position,r.mapDimensions.width,r.mapDimensions.height);if(o===0){e.forces.push({x:.1,y:0}),t.forces.push({x:-.1,y:0});return}const s=(e.radius+t.radius-o)*.05,u=nt(Ev(e.position,t.position)),d=Pt(u,s);e.forces.push(d),t.forces.push(Pt(d,-1))}},BR={id:"humanBerryBushGather",sourceType:"human",targetType:"berryBush",maxDistance:Rt,checker:(e,t,r)=>{var o;return e.isAdult&&t.food.length>0&&((o=e.stateMachine)==null?void 0:o[0])===va&&e.food.length<e.maxFood&&(!e.gatheringCooldownTime||e.gatheringCooldownTime<r.gameState.time)||!1},perform:(e,t,r)=>{const o=t.food.pop();o&&e.food.push(o),e.gatheringCooldownTime=r.gameState.time+1,t.timeSinceLastHarvest=r.gameState.time,Me(r.gameState,ce.BushClaimed,t.position,xe),Ie(r,fe.Gather,e.position)}},HR={id:"corpseGather",sourceType:"human",targetType:"corpse",maxDistance:Rt,checker:(e,t,r)=>{var o;return e.isAdult&&t.food.length>0&&((o=e.stateMachine)==null?void 0:o[0])===va&&e.food.length<e.maxFood&&(!e.gatheringCooldownTime||e.gatheringCooldownTime<r.gameState.time)||!1},perform:(e,t,r)=>{const o=t.food.pop();o&&e.food.push(o),e.gatheringCooldownTime=r.gameState.time+1,Ie(r,fe.Gather,e.position)}},bR=[BR,HR],GR={id:"prey-eat-berry-bush",sourceType:"prey",targetType:"berryBush",maxDistance:zt,checker:(e,t,r)=>!!(e.isAdult&&t.food.length>0&&e.hunger>30&&(!e.eatingCooldownTime||e.eatingCooldownTime<r.gameState.time)),perform:(e,t,r)=>{t.food.pop()&&(e.hunger=Math.max(0,e.hunger-25),t.lifespan-=EC,t.timeSinceLastHarvest=r.gameState.time,e.eatingCooldownTime=r.gameState.time+IC,Me(r.gameState,ce.BushClaimed,t.position,xe,e.id),Ie(r,fe.Gather,e.position))}},xR={id:"predator-hunt-prey",sourceType:"predator",targetType:"prey",maxDistance:yo,checker:(e,t,r)=>!!(e.isAdult&&e.hunger>50&&(!e.huntCooldown||e.huntCooldown<=0)&&t.hitpoints>0),perform:(e,t,r)=>{t.hitpoints-=NC;const o=ze(e.position,t.position,r.gameState.mapDimensions.width,r.gameState.mapDimensions.height),l=Pt(o,8);t.forces.push(l),e.huntCooldown=MC,t.hitpoints<=0?(Ie(r,fe.HumanDeath,t.position),Me(r.gameState,ce.Hit,t.position,xe,t.id)):(Me(r.gameState,ce.Hit,t.position,xe,t.id),t.fleeCooldown=5,Ie(r,fe.Attack,e.position)),Me(r.gameState,ce.Attack,e.position,xe,e.id)}},$R={id:"human-hunt-prey",sourceType:"human",targetType:"prey",maxDistance:Jn,checker:(e,t,r)=>{var o;return!!(((o=e.stateMachine)==null?void 0:o[0])===tr&&e.attackTargetId===t.id&&(!e.attackCooldown||e.attackCooldown<=0)&&t.hitpoints>0&&e.isAdult)},perform:(e,t,r)=>{let o=zf*1.2;e.gender==="male"&&(o*=1.3),t.hitpoints-=o;const l=ze(e.position,t.position,r.gameState.mapDimensions.width,r.gameState.mapDimensions.height),s=Pt(l,6);t.forces.push(s),e.attackCooldown=wu,t.hitpoints<=0?(Ie(r,fe.HumanDeath,t.position),Me(r.gameState,ce.Hit,t.position,xe,t.id)):(Me(r.gameState,ce.Hit,t.position,xe,t.id),t.fleeCooldown=8,Ie(r,fe.Attack,e.position)),Me(r.gameState,ce.Attack,e.position,xe,e.id)}},zR={id:"predator-attack-human",sourceType:"predator",targetType:"human",maxDistance:kn,checker:(e,t,r)=>{var o;return!!(e.isAdult&&(!e.attackCooldown||e.attackCooldown<=0)&&t.hitpoints>0&&(e.hunger>100||t.attackTargetId===e.id||t.attackTargetId&&((o=r.gameState.entities.entities[t.attackTargetId])==null?void 0:o.type)==="predator"))},perform:(e,t,r)=>{let o=rS;e.hunger>120&&(o*=1.3),t.hitpoints-=o,t.movementSlowdown={modifier:Wf,endTime:r.gameState.time+Yf};const l=ze(e.position,t.position,r.gameState.mapDimensions.width,r.gameState.mapDimensions.height),s=Pt(l,7);t.forces.push(s),e.attackCooldown=oS,t.hitpoints<=0?(e.hunger=Math.max(0,e.hunger-sh),Ie(r,fe.HumanDeath,t.position),Me(r.gameState,ce.Hit,t.position,xe,t.id)):(Me(r.gameState,ce.Hit,t.position,xe,t.id),Ie(r,fe.Attack,e.position)),Me(r.gameState,ce.Attack,e.position,xe,e.id)}},WR={id:"human-attack-predator",sourceType:"human",targetType:"predator",maxDistance:Jn,checker:(e,t,r)=>{var o;return!!(((o=e.stateMachine)==null?void 0:o[0])===tr&&e.attackTargetId===t.id&&(!e.attackCooldown||e.attackCooldown<=0)&&t.hitpoints>0&&e.isAdult)},perform:(e,t,r)=>{let o=zf*.8;e.gender==="male"&&(o*=1.2);const l=Object.values(r.gameState.entities.entities).filter(d=>d.type==="human"&&d.id!==e.id).filter(d=>{const f=d;return Math.sqrt(Math.pow(f.position.x-e.position.x,2)+Math.pow(f.position.y-e.position.y,2))<100&&f.activeAction==="attacking"&&f.attackTargetId===t.id}).length;l>0&&(o*=1+l*.2),t.hitpoints-=o;const s=ze(e.position,t.position,r.gameState.mapDimensions.width,r.gameState.mapDimensions.height),u=Pt(s,8);t.forces.push(u),e.attackCooldown=wu,t.hitpoints<=0?(Ie(r,fe.HumanDeath,t.position),Me(r.gameState,ce.Hit,t.position,xe,t.id)):(Me(r.gameState,ce.Hit,t.position,xe,t.id),t.hitpoints<t.maxHitpoints*.3&&(t.hunger+=20),Ie(r,fe.Attack,e.position)),Me(r.gameState,ce.Attack,e.position,xe,e.id)}},YR={id:"prey-procreation",sourceType:"prey",targetType:"prey",maxDistance:zt,checker:(e,t,r)=>!!(e.isAdult&&t.isAdult&&e.gender!==t.gender&&e.id!==t.id&&!e.isPregnant&&!t.isPregnant&&e.hunger<200&&t.hunger<200&&(!e.procreationCooldown||e.procreationCooldown<=0)&&(!t.procreationCooldown||t.procreationCooldown<=0)),perform:(e,t,r)=>{const o=e.gender==="female"?e:t;o.isPregnant=!0,o.gestationTime=r.gameState.ecosystem.preyGestationPeriod,e.procreationCooldown=r.gameState.ecosystem.preyProcreationCooldown,t.procreationCooldown=r.gameState.ecosystem.preyProcreationCooldown,Me(r.gameState,ce.Procreation,o.position,xe,o.id),Ie(r,fe.Procreate,o.position)}},jR={id:"predator-procreation",sourceType:"predator",targetType:"predator",maxDistance:qi,checker:(e,t,r)=>!!(e.isAdult&&t.isAdult&&e.gender!==t.gender&&e.id!==t.id&&!e.isPregnant&&!t.isPregnant&&e.hunger<200&&t.hunger<200&&(!e.procreationCooldown||e.procreationCooldown<=0)&&(!t.procreationCooldown||t.procreationCooldown<=0)),perform:(e,t,r)=>{const o=e.gender==="female"?e:t;o.isPregnant=!0,o.pregnancyFatherId=e.gender==="male"?e.id:t.id,o.gestationTime=r.gameState.ecosystem.predatorGestationPeriod,e.procreationCooldown=r.gameState.ecosystem.predatorProcreationCooldown,t.procreationCooldown=r.gameState.ecosystem.predatorProcreationCooldown,Me(r.gameState,ce.Procreation,o.position,xe,o.id),Ie(r,fe.Procreate,o.position)}},VR={id:"preyChildFeeding",sourceType:"prey",targetType:"prey",maxDistance:Wo,checker:(e,t)=>e.isAdult===!0&&e.gender==="female"&&e.hunger<80&&(!e.feedChildCooldownTime||e.feedChildCooldownTime<=0)&&t.isAdult===!1&&(t.motherId===e.id||t.fatherId===e.id)&&t.hunger>=fu&&e.activeAction==="feeding",perform:(e,t,r)=>{e.hunger=Math.min(120,e.hunger+10),t.hunger=Math.max(0,t.hunger-fu),e.feedChildCooldownTime=aS,(!t.lastChildFedEffectTime||r.gameState.time-t.lastChildFedEffectTime>2)&&(Me(r.gameState,ce.ChildFed,t.position,xe,t.id),t.lastChildFedEffectTime=r.gameState.time),Ie(r,fe.ChildFed,t.position)}},XR={id:"predatorChildFeeding",sourceType:"predator",targetType:"predator",maxDistance:Wo,checker:(e,t)=>e.isAdult===!0&&e.gender==="female"&&e.hunger<90&&(!e.feedChildCooldownTime||e.feedChildCooldownTime<=0)&&t.isAdult===!1&&(t.motherId===e.id||t.fatherId===e.id)&&t.hunger>=fu&&e.activeAction==="feeding",perform:(e,t,r)=>{e.hunger=Math.min(140,e.hunger+15),t.hunger=Math.max(0,t.hunger-fu),e.feedChildCooldownTime=aS,(!t.lastChildFedEffectTime||r.gameState.time-t.lastChildFedEffectTime>2)&&(Me(r.gameState,ce.ChildFed,t.position,xe,t.id),t.lastChildFedEffectTime=r.gameState.time),Ie(r,fe.ChildFed,t.position)}},KR={id:"predator-eat-corpse",sourceType:"predator",targetType:"corpse",maxDistance:qi,checker:(e,t,r)=>!!(e.isAdult&&e.hunger>30&&t.food.length>0&&(!e.eatingCooldownTime||e.eatingCooldownTime<=r.gameState.time)),perform:(e,t,r)=>{t.food.pop()&&(e.hunger=Math.max(0,e.hunger-sh),e.eatingCooldownTime=r.gameState.time+2,Me(r.gameState,ce.Eating,e.position,xe,e.id),Ie(r,fe.Gather,e.position))}},ZR={id:"predator-attack-rival",sourceType:"predator",targetType:"predator",maxDistance:kn,checker:(e,t,r)=>{var o;return!!(e.isAdult&&(!e.attackCooldown||e.attackCooldown<=0)&&t.hitpoints>0&&(e.hunger>100||t.attackTargetId===e.id||t.attackTargetId&&((o=r.gameState.entities.entities[t.attackTargetId])==null?void 0:o.type)==="predator"))},perform:(e,t,r)=>{let o=rS;e.hunger>120&&(o*=1.3),t.hitpoints-=o,t.movementSlowdown={modifier:Wf,endTime:r.gameState.time+Yf};const l=ze(e.position,t.position,r.gameState.mapDimensions.width,r.gameState.mapDimensions.height),s=Pt(l,7);t.forces.push(s),e.attackCooldown=oS,t.hitpoints<=0?(e.hunger=Math.max(0,e.hunger-sh),Ie(r,fe.HumanDeath,t.position),Me(r.gameState,ce.Hit,t.position,xe,t.id)):(Me(r.gameState,ce.Hit,t.position,xe,t.id),Ie(r,fe.Attack,e.position)),Me(r.gameState,ce.Attack,e.position,xe,e.id)}},qR={id:"storageDeposit",sourceType:"human",targetType:"building",maxDistance:An,checker:(e,t,r)=>{var s;if(t.buildingType!=="storageSpot"||((s=e.stateMachine)==null?void 0:s[0])!==Ks||!t.isConstructed||e.food.length===0)return!1;t.storedFood||(t.storedFood=[]);const o=t.storageCapacity??0;return!(t.storedFood.length>=o||e.leaderId!==t.ownerId||r.gameState.time-(t.lastDepositTime??0)<D_)},perform:(e,t,r)=>{t.storedFood||(t.storedFood=[]);const o=e.food.pop();o&&t.storedFood.push({item:o,positionOffset:dS(t)}),t.lastDepositTime=r.gameState.time,Ie(r,fe.StorageDeposit,t.position)}},QR={id:"storageRetrieve",sourceType:"human",targetType:"building",maxDistance:An,checker:(e,t,r)=>{var l;return!(t.buildingType!=="storageSpot"||((l=e.stateMachine)==null?void 0:l[0])!==Zs||!t.isConstructed||!t.storedFood||t.storedFood.length===0||e.food.length>=e.maxFood||e.leaderId!==t.ownerId||r.gameState.time-(t.lastRetrieveTime??0)<O_)},perform:(e,t,r)=>{if(!t.storedFood||t.storedFood.length===0)return;const o=t.storedFood.pop();o&&(e.food.push(o.item),dS(t)),t.lastRetrieveTime=r.gameState.time,Ie(r,fe.StorageRetrieve,t.position)}},JR={id:"storageSteal",sourceType:"human",targetType:"building",maxDistance:An,checker:(e,t,r)=>{var d;if(t.buildingType!=="storageSpot"||((d=e.stateMachine)==null?void 0:d[0])!==va||!t.isConstructed||!t.storedFood||t.storedFood.length===0||e.food.length>=e.maxFood||e.leaderId===t.ownerId)return!1;const o=e.leaderId?r.gameState.entities.entities[e.leaderId]:void 0;if(!o||!o.diplomacy||o.diplomacy[t.ownerId]!==yt.Hostile||r.gameState.time-(t.lastStealTime??0)<M_)return!1;const u=Bn({leaderId:t.ownerId},r.gameState);for(const f of u)if(V(e.position,f.position,r.gameState.mapDimensions.width,r.gameState.mapDimensions.height)<=Ef)return!1;return!0},perform:(e,t,r)=>{if(!t.storedFood||t.storedFood.length===0)return;const o=t.storedFood.pop();o&&e.food.push(o.item),t.lastStealTime=r.gameState.time,Ie(r,fe.StorageSteal,t.position),Me(r.gameState,ce.Attack,t.position,.5)}},eP=[LR,...bR,kR,FR,UR,qR,QR,JR,GR,VR,XR,KR,xR,$R,WR,zR,ZR,YR,jR];function tP(e){const{gameState:t}=e,r=t,o=Object.values(t.entities.entities);for(const l of eP)for(const s of o){if(l.sourceType&&s.type!==l.sourceType)continue;const u=r.search[l.targetType].byRadius(s.position,l.maxDistance);for(const d of u){if(s.id===d.id)continue;V(s.position,d.position,t.mapDimensions.width,t.mapDimensions.height)<=l.maxDistance&&l.checker(s,d,e)&&l.perform(s,d,e)}}}function nP(e){e.visualEffects=e.visualEffects.filter(t=>e.time-t.startTime<=t.duration)}function iP(e){const t=e.search.berryBush.byProperty("type","berryBush"),r=e.search.predator.byProperty("type","predator"),o=e.search.human.byProperty("type","human");for(let l=0;l<20;l++){let s;if(t.length>0&&l<15){const f=t[Math.floor(Math.random()*t.length)],g=Math.random()*2*Math.PI,m=50+Math.random()*100;s={x:Math.max(50,Math.min(et-50,f.position.x+Math.cos(g)*m)),y:Math.max(50,Math.min(tt-50,f.position.y+Math.sin(g)*m))}}else s={x:50+Math.random()*(et-100),y:50+Math.random()*(tt-100)};let u=!0;const d=100;for(const f of r)if(Math.sqrt((s.x-f.position.x)**2+(s.y-f.position.y)**2)<d){u=!1;break}if(u){for(const f of o)if(Math.sqrt((s.x-f.position.x)**2+(s.y-f.position.y)**2)<d){u=!1;break}}if(u)return s}return{x:et*.3+Math.random()*et*.4,y:tt*.3+Math.random()*tt*.4}}function rP(e){const t=e.search.prey.byProperty("type","prey"),r=e.search.human.byProperty("type","human");for(let l=0;l<15;l++){let s;if(t.length>0&&l<10){const f=t[Math.floor(Math.random()*t.length)],g=Math.random()*2*Math.PI,m=100+Math.random()*150;s={x:Math.max(50,Math.min(et-50,f.position.x+Math.cos(g)*m)),y:Math.max(50,Math.min(tt-50,f.position.y+Math.sin(g)*m))}}else s={x:50+Math.random()*(et-100),y:50+Math.random()*(tt-100)};let u=!0;const d=150;for(const f of r)if(Math.sqrt((s.x-f.position.x)**2+(s.y-f.position.y)**2)<d){u=!1;break}if(u)return s}switch(Math.floor(Math.random()*4)){case 0:return{x:Math.random()*et,y:50+Math.random()*100};case 1:return{x:et-150+Math.random()*100,y:Math.random()*tt};case 2:return{x:Math.random()*et,y:tt-150+Math.random()*100};default:return{x:50+Math.random()*100,y:Math.random()*tt}}}function oP(e){const t=e.search.human.byProperty("type","human"),r=e.search.berryBush.byProperty("type","berryBush");for(let o=0;o<20;o++){const l={x:50+Math.random()*(et-100),y:50+Math.random()*(tt-100)};let s=!0;const u=80,d=60;for(const f of t)if(Math.sqrt((l.x-f.position.x)**2+(l.y-f.position.y)**2)<u){s=!1;break}if(s){for(const f of r)if(Math.sqrt((l.x-f.position.x)**2+(l.y-f.position.y)**2)<d){s=!1;break}}if(s)return l}return{x:Math.random()*et,y:Math.random()*tt}}function yS(e,t=4){console.log(` Respawning ${t} prey to prevent extinction`);const r=e;for(let o=0;o<t;o++){const l=iP(r),s=o%2===0?"male":"female";Ho(e.entities,l,s,void 0,void 0,ca())}}function TS(e,t=2){console.log(` Respawning ${t} predators to prevent extinction`);const r=e;for(let o=0;o<t;o++){const l=rP(r),s=o%2===0?"male":"female";bo(e.entities,l,s,void 0,void 0,da())}}function sP(e){const t=e,r=t.search.prey.count(),o=t.search.predator.count();let l=!1;return r===0&&(yS(e,6),l=!0),o===0&&(TS(e,3),l=!0),l}function aP(e){const t=e,r=t.search.prey.count(),o=t.search.predator.count(),l=t.search.berryBush.count();let s=!1;if(r>0&&r<5){const u=Math.max(2,Math.floor(8-r));yS(e,u),s=!0}if(o>0&&o<2){const u=Math.max(1,Math.floor(3-o));TS(e,u),s=!0}if(l<5){console.log(` Boosting bush count from ${l} to help ecosystem`);for(let u=0;u<5;u++){const d=oP(t);ya(e.entities,d,e.time)}s=!0}return s}const lP=1,uP=.3,cP=.8,y0=.8,dP=.99,fP=.05;var AS=(e=>(e[e.INCREASE_PREY_GESTATION=0]="INCREASE_PREY_GESTATION",e[e.DECREASE_PREY_GESTATION=1]="DECREASE_PREY_GESTATION",e[e.INCREASE_PREY_PROCREATION_COOLDOWN=2]="INCREASE_PREY_PROCREATION_COOLDOWN",e[e.DECREASE_PREY_PROCREATION_COOLDOWN=3]="DECREASE_PREY_PROCREATION_COOLDOWN",e[e.INCREASE_PREY_HUNGER=4]="INCREASE_PREY_HUNGER",e[e.DECREASE_PREY_HUNGER=5]="DECREASE_PREY_HUNGER",e[e.INCREASE_PREDATOR_GESTATION=6]="INCREASE_PREDATOR_GESTATION",e[e.DECREASE_PREDATOR_GESTATION=7]="DECREASE_PREDATOR_GESTATION",e[e.INCREASE_PREDATOR_PROCREATION_COOLDOWN=8]="INCREASE_PREDATOR_PROCREATION_COOLDOWN",e[e.DECREASE_PREDATOR_PROCREATION_COOLDOWN=9]="DECREASE_PREDATOR_PROCREATION_COOLDOWN",e[e.INCREASE_PREDATOR_HUNGER=10]="INCREASE_PREDATOR_HUNGER",e[e.DECREASE_PREDATOR_HUNGER=11]="DECREASE_PREDATOR_HUNGER",e[e.INCREASE_BUSH_SPREAD=12]="INCREASE_BUSH_SPREAD",e[e.DECREASE_BUSH_SPREAD=13]="DECREASE_BUSH_SPREAD",e[e.NO_ACTION=14]="NO_ACTION",e))(AS||{});const Zd=Object.keys(AS).length/2;class hP{constructor(){De(this,"qTable",new Map);De(this,"epsilon",y0);De(this,"lastState",null);De(this,"lastAction",null)}discretizeState(t,r,o){const l=Math.min(4,Math.floor(t/25)),s=Math.min(4,Math.floor(r/5)),u=Math.min(4,Math.floor(o/15));return`${l}-${s}-${u}`}getQValue(t,r){return this.qTable.has(t)||this.qTable.set(t,new Map),this.qTable.get(t).get(r)||0}setQValue(t,r,o){this.qTable.has(t)||this.qTable.set(t,new Map),this.qTable.get(t).set(r,o)}getBestAction(t){let r=0,o=this.getQValue(t,0);for(let l=1;l<Zd;l++){const s=this.getQValue(t,l);s>o&&(o=s,r=l)}return r}chooseAction(t){return Math.random()<this.epsilon?Math.floor(Math.random()*Zd):this.getBestAction(t)}applyEmergencyCorrections(t,r,o,l){t<hi*.5&&(l.ecosystem.preyGestationPeriod=Math.max(Io,l.ecosystem.preyGestationPeriod*.8),l.ecosystem.preyProcreationCooldown=Math.max(Eo,l.ecosystem.preyProcreationCooldown*.8),l.ecosystem.preyHungerIncreasePerHour=Math.max(Co,l.ecosystem.preyHungerIncreasePerHour*.9)),r<gi*.6&&(l.ecosystem.predatorGestationPeriod=Math.max(wo,l.ecosystem.predatorGestationPeriod*.75),l.ecosystem.predatorProcreationCooldown=Math.max(_o,l.ecosystem.predatorProcreationCooldown*.75),l.ecosystem.predatorHungerIncreasePerHour=Math.max(Ro,l.ecosystem.predatorHungerIncreasePerHour*.85)),o<pi*.5&&(l.ecosystem.berryBushSpreadChance=Math.min(xs,l.ecosystem.berryBushSpreadChance*1.2)),t>hi*1.4&&(l.ecosystem.preyHungerIncreasePerHour=Math.min(Vi,l.ecosystem.preyHungerIncreasePerHour*1.05)),r>gi*1.4&&(l.ecosystem.predatorHungerIncreasePerHour=Math.min(Xi,l.ecosystem.predatorHungerIncreasePerHour*1.05)),o>pi*1.4&&(l.ecosystem.berryBushSpreadChance=Math.max(mi,l.ecosystem.berryBushSpreadChance*.95))}calculateReward(t,r,o){const l=Math.abs(t-hi),s=Math.abs(r-gi),u=Math.abs(o-pi),d=l/hi,f=s/gi,g=u/pi,m=d+f+g;return 100*Math.exp(-m*2)-50}applyAction(t,r){switch(t){case 0:r.ecosystem.preyGestationPeriod=Math.min(Rr,r.ecosystem.preyGestationPeriod+.2*(Rr-Io));break;case 1:r.ecosystem.preyGestationPeriod=Math.max(Io,r.ecosystem.preyGestationPeriod-.2*(Rr-Io));break;case 2:r.ecosystem.preyProcreationCooldown=Math.min(Pr,r.ecosystem.preyProcreationCooldown+.2*(Pr-Eo));break;case 3:r.ecosystem.preyProcreationCooldown=Math.max(Eo,r.ecosystem.preyProcreationCooldown-.2*(Pr-Eo));break;case 4:r.ecosystem.preyHungerIncreasePerHour=Math.min(Vi,r.ecosystem.preyHungerIncreasePerHour+.2*(Vi-Co));break;case 5:r.ecosystem.preyHungerIncreasePerHour=Math.max(Co,r.ecosystem.preyHungerIncreasePerHour-.2*(Vi-Co));break;case 6:r.ecosystem.predatorGestationPeriod=Math.min(Nr,r.ecosystem.predatorGestationPeriod+.2*(Nr-wo));break;case 7:r.ecosystem.predatorGestationPeriod=Math.max(wo,r.ecosystem.predatorGestationPeriod-.2*(Nr-wo));break;case 8:r.ecosystem.predatorProcreationCooldown=Math.min(Dr,r.ecosystem.predatorProcreationCooldown+.2*(Dr-_o));break;case 9:r.ecosystem.predatorProcreationCooldown=Math.max(_o,r.ecosystem.predatorProcreationCooldown-.2*(Dr-_o));break;case 10:r.ecosystem.predatorHungerIncreasePerHour=Math.min(Xi,r.ecosystem.predatorHungerIncreasePerHour+.2*(Xi-Ro));break;case 11:r.ecosystem.predatorHungerIncreasePerHour=Math.max(Ro,r.ecosystem.predatorHungerIncreasePerHour-.2*(Xi-Ro));break;case 12:r.ecosystem.berryBushSpreadChance=Math.min(xs,r.ecosystem.berryBushSpreadChance+.2*(xs-mi));break;case 13:r.ecosystem.berryBushSpreadChance=Math.max(mi,r.ecosystem.berryBushSpreadChance-.2*(xs-mi));break}}updateQTable(t,r,o,l){const s=this.getQValue(t,r),u=Math.max(...Array.from({length:Zd},(f,g)=>this.getQValue(l,g))),d=s+uP*(o+cP*u-s);this.setQValue(t,r,d)}step(t){const r=t,o=r.search.prey.count(),l=r.search.predator.count(),s=r.search.berryBush.count();this.applyEmergencyCorrections(o,l,s,t);const u=this.discretizeState(o,l,s);if(this.lastState!==null&&this.lastAction!==null){const f=this.calculateReward(o,l,s);this.updateQTable(this.lastState,this.lastAction,f,u)}const d=this.chooseAction(u);this.applyAction(d,t),this.epsilon=Math.max(fP,this.epsilon*dP),this.lastState=u,this.lastAction=d}reset(){this.qTable.clear(),this.epsilon=y0,this.lastState=null,this.lastAction=null}getStats(){return{qTableSize:this.qTable.size,explorationRate:this.epsilon}}}let IS=new hP;function gP(e){sP(e),aP(e),e.ecosystem.lastUpdateTime||(e.ecosystem.preyGestationPeriod=Io+(Rr-Io)*.3,e.ecosystem.preyProcreationCooldown=Eo+(Pr-Eo)*.3,e.ecosystem.preyHungerIncreasePerHour=Co+(Vi-Co)*.3,e.ecosystem.predatorGestationPeriod=wo+(Nr-wo)*.3,e.ecosystem.predatorProcreationCooldown=_o+(Dr-_o)*.3,e.ecosystem.predatorHungerIncreasePerHour=Ro+(Xi-Ro)*.3,e.ecosystem.berryBushSpreadChance=mi+(xs-mi)*.7),IS.step(e)}function pP(e){e.ecosystem.lastUpdateTime||(e.ecosystem.lastUpdateTime=0),!(e.time-e.ecosystem.lastUpdateTime<lP)&&(e.ecosystem.lastUpdateTime=e.time,gP(e))}function mP(){return IS.getStats()}function vP(e,t){e.selectedBuildingType&&e.selectedBuildingType!=="removal"&&(e.autopilotControls.activeAutopilotAction=void 0,e.autopilotControls.hoveredAutopilotAction=void 0)}const SP=1/60;function yP(e,t){const r=It(e);r&&(e.viewportCenter=jf(e.viewportCenter,r.position,Hf*t))}function Pu(e,t){if(e.isPaused)return e;if(e.autosaveIntervalSeconds){const r=Date.now();r-e.lastAutosaveTime>e.autosaveIntervalSeconds*1e3&&(Df(e),e.lastAutosaveTime=r)}for(;t>0;){const r=mu(e),o=Math.min(t,SP),l=o*(Tt/At);r.time+=l,yP(r,o),p_(r),pP(r),m_(r),gR({gameState:r,deltaTime:o}),tP({gameState:r,deltaTime:o}),nP(r),IR(r,o),vP(r),e=r,t-=o}return e}function qd(e,t,r){e.save();const{x:o,y:l,width:s,height:u}=t.rect,d=Mv;if(e.beginPath(),e.moveTo(o+d,l),e.lineTo(o+s-d,l),e.quadraticCurveTo(o+s,l,o+s,l+d),e.lineTo(o+s,l+u-d),e.quadraticCurveTo(o+s,l+u,o+s-d,l+u),e.lineTo(o+d,l+u),e.quadraticCurveTo(o,l+u,o,l+u-d),e.lineTo(o,l+d),e.quadraticCurveTo(o,l,o+d,l),e.closePath(),e.fillStyle=t.isDisabled?kv:t.backgroundColor,e.fill(),t.activated){e.save();const f=(Math.sin(Date.now()/1e3*Bv)+1)/2;e.strokeStyle=Lv,e.lineWidth=2+f*2,e.globalAlpha=.7+f*.3,e.stroke(),e.restore()}if(t.lastActivated){const f=Date.now()-t.lastActivated;if(f<du){const g=1-f/du;e.fillStyle=Uv,e.globalAlpha=g,e.fill(),e.globalAlpha=1}}r&&!t.isDisabled&&(e.fillStyle=qf,e.globalAlpha=.5,e.fill(),e.globalAlpha=1),e.fillStyle=t.isDisabled?Fv:t.textColor,t.icon?(e.font=`${u*.55}px "Press Start 2P", Arial`,e.textAlign="center",e.textBaseline="middle",e.fillText(t.icon,o+s/2,l+u/2),t.text&&(e.font=`${u*.18}px "Press Start 2P", Arial`,e.textAlign="right",e.textBaseline="bottom",e.fillText(t.text,o+s-4,l+u-2))):(e.textAlign="center",e.textBaseline="middle",e.fillText(t.text,o+s/2,l+u/2)),e.restore()}function TP(e,t,r,o){e.save(),e.font=`${Xm}px "Press Start 2P", Arial`,e.textAlign="center",e.textBaseline="bottom";const s=e.measureText(r).width,u=Xm,d=s+Km*2,f=u+Km*2,g=o.x-d/2,m=e.canvas.height,S=t.y<m/2?t.y+t.height-Zm:t.y-f+Zm;e.fillStyle=Iw,e.fillRect(g,S,d,f),e.fillStyle=Ew,e.fillText(r,o.x,S+f/2+u/2),e.restore()}function AP(e,t,r){e.save();const o=It(t),l=[{id:"fastForwardButton",action:ge.FastForward,text:"FFWD [T]",currentWidth:fi*1.3,backgroundColor:Wi,textColor:yn,tooltip:"Fast-forward time",rect:{x:0,y:0,width:0,height:0}},{id:"pauseButton",action:ge.TogglePause,text:t.isPaused?"UN[P]AUSE":"[P]AUSE",backgroundColor:t.isPaused?Fl:Wi,currentWidth:t.isPaused?fi*1.4:fi*1.1,tooltip:t.isPaused?"Resume Game":"Pause Game",rect:{x:0,y:0,width:0,height:0},textColor:yn},{id:"muteButton",action:ge.ToggleMute,text:t.isMuted?"UN[M]UTE":"[M]UTE",backgroundColor:t.isMuted?Fl:Wi,tooltip:`Toggle Sound (${t.isMuted?"Muted":"Enabled"})`,currentWidth:fi,rect:{x:0,y:0,width:0,height:0},textColor:yn},{id:"returnToIntroButton",action:ge.ReturnToIntro,text:"EXIT",backgroundColor:Wi,tooltip:"Return to Main Menu [ESC]",currentWidth:fi*.9,rect:{x:0,y:0,width:0,height:0},textColor:yn}];if(t.uiButtons.push(...l),o){const g=ih(t,o),m=new Set(g.map(B=>B.type));let S=[{playerAction:se.Gather,buttonAction:ge.CommandGather,shortcut:"E",name:"Gather",toggleKey:"gathering",condition:()=>o.isAdult===!0},{playerAction:se.Eat,buttonAction:ge.CommandEat,shortcut:"F",name:"Eat"},{playerAction:se.Plant,buttonAction:ge.CommandPlant,shortcut:"B",name:"Plant",toggleKey:"planting",condition:()=>o.isAdult===!0},{playerAction:se.Procreate,buttonAction:ge.ToggleProcreationBehavior,shortcut:"R",name:"Procreation",toggleKey:"procreation",condition:()=>o.isAdult===!0},{playerAction:se.FeedChild,buttonAction:ge.ToggleFeedChildBehavior,shortcut:"H",name:"Feed Child",toggleKey:"feedChildren",condition:()=>o.isAdult===!0},{playerAction:se.Attack,buttonAction:ge.ToggleAttackBehavior,shortcut:"Q",name:"Attack",toggleKey:"attack",condition:()=>o.isAdult===!0&&o.leaderId===o.id},{playerAction:se.FollowMe,buttonAction:ge.CommandFollowMe,shortcut:"C",name:"Follow Me",toggleKey:"followLeader",condition:()=>o.isAdult===!0&&o.leaderId===o.id},{playerAction:se.CallToAttack,buttonAction:ge.CommandCallToAttack,shortcut:"V",name:"Call to Attack",condition:()=>o.isAdult===!0&&o.leaderId===o.id},{playerAction:se.TribeSplit,buttonAction:ge.CommandTribeSplit,shortcut:"K",name:"Split Tribe",condition:()=>o.leaderId!==void 0&&o.leaderId!==o.id&&o.isAdult===!0},{playerAction:se.Build,buttonAction:ge.CommandBuild,shortcut:"L",name:"Build",condition:()=>o.isAdult===!0&&o.leaderId===o.id}];S=S.filter(B=>B.condition?B.condition():!0);const y=1,E=S.length,T=E*on+(E-1)*Sr,A=y*on+(y-1)*Sr,C=(r-T)/2,F=e.canvas.height-A-20;if(S.forEach((B,D)=>{const H=D%E,x=Math.floor(D/E),U=C+H*(on+Sr),$=F+x*(on+Sr),ee=!!B.toggleKey,_e=ee&&t.autopilotControls.behaviors[B.toggleKey],Ce=!m.has(B.playerAction),Ne=B.playerAction===se.Build&&t.buildMenuOpen,Pe=!t.hasPlayerEnabledAutopilot||t.hasPlayerEnabledAutopilot<3?" (Press Shift to toggle Auto)":"",de=ee?`${B.name}${Pe}`:B.name,Ue=_e||Ne?Fl:Wi,Te={id:`commandButton_${B.name}`,action:B.buttonAction,rect:{x:U,y:$,width:on,height:on},icon:Cu[B.playerAction],text:B.shortcut,backgroundColor:Ue,textColor:yn,currentWidth:on,tooltip:de,isDisabled:Ce,activated:_e||Ne};t.uiButtons.push(Te)}),t.buildMenuOpen){const B=[{id:"buildMenu_storageSpot",action:ge.SelectStorageSpot,icon:"",shortcut:"1",name:"Storage Spot"},{id:"buildMenu_plantingZone",action:ge.SelectPlantingZone,icon:"",shortcut:"2",name:"Planting Zone"},{id:"buildMenu_removal",action:ge.SelectRemovalTool,icon:"",shortcut:"3",name:"Remove Building"}],D=B.length,H=D*on+(D-1)*Sr,x=(r-H)/2,U=F-on-Sr;B.forEach(($,ee)=>{const _e=x+ee*(on+Sr),Ce=U,be=$.action===ge.SelectStorageSpot&&t.selectedBuildingType==="storageSpot"||$.action===ge.SelectPlantingZone&&t.selectedBuildingType==="plantingZone"||$.action===ge.SelectRemovalTool&&t.selectedBuildingType==="removal",Ne={id:$.id,action:$.action,rect:{x:_e,y:Ce,width:on,height:on},icon:$.icon,text:$.shortcut,backgroundColor:be?Fl:Wi,textColor:yn,currentWidth:on,tooltip:$.name,activated:be};t.uiButtons.push(Ne),qd(e,Ne,t.hoveredButtonId===Ne.id)})}}let s=r-Ze;l.forEach(g=>{const m=Ze,S=s-g.currentWidth;g.rect={x:S,y:m,width:g.currentWidth,height:Ov},qd(e,g,t.hoveredButtonId===g.id),s-=g.currentWidth+Aw});let u=null;t.uiButtons.filter(g=>g.id.startsWith("commandButton_")||g.id.startsWith("buildMenu_")).forEach(g=>{u||(u={x:g.rect.x,y:g.rect.y,width:g.rect.width,height:g.rect.height}),u.x=Math.min(u.x,g.rect.x),u.y=Math.min(u.y,g.rect.y),u.width=Math.max(u.width,g.rect.x+g.rect.width-u.x),u.height=Math.max(u.height,g.rect.y+g.rect.height-u.y),g.id.startsWith("commandButton_")&&qd(e,g,t.hoveredButtonId===g.id)});const f=t.hoveredButtonId?t.uiButtons.find(g=>g.id===t.hoveredButtonId):void 0;return f&&f.tooltip&&t.mousePosition&&TP(e,f.rect,f.tooltip,t.mousePosition),e.restore(),{commandButtonsRect:u}}function IP(e){e.save(),e.fillStyle=Fw,e.fillRect(0,0,e.canvas.width,e.canvas.height),e.fillStyle=Uw,e.font=`${Lw}px "Press Start 2P", Arial`,e.textAlign="center",e.textBaseline="middle",e.fillText("PAUSED",e.canvas.width/2,e.canvas.height/2),e.restore()}function Cf(e,t,r,o){const l=t.x-r.width/2,s=t.y-r.height/2,u=l+e.x,d=s+e.y,f=(u%o.width+o.width)%o.width,g=(d%o.height+o.height)%o.height;return{x:f,y:g}}function Nu(e,t,r,o){let l=e.x-t.x,s=e.y-t.y;return Math.abs(l)>o.width/2&&(l=l-Math.sign(l)*o.width),Math.abs(s)>o.height/2&&(s=s-Math.sign(s)*o.height),{x:l+r.width/2,y:s+r.height/2}}function Yl(e,t,r,o){const l=Nu(e.position,t,r,o),u=("radius"in e?e.radius:20)+20;return l.x>=-u&&l.x<=r.width+u&&l.y>=-u&&l.y<=r.height+u}function ln(e,t,r,o,l,...s){const u={...l.position};for(let d=-r;d<=r;d+=r)for(let f=-t;f<=t;f+=t)l.position.x=u.x+f,l.position.y=u.y+d,o(e,l,...s);l.position=u}const EP=25,wP=0,T0=28;function ES(e,t,r,o,l,s,u,d,f,g){e.save();const{x:m,y:S}=Nu(t,u,{width:d,height:f},g);e.strokeStyle=o,e.lineWidth=s,e.setLineDash(l),e.beginPath(),e.arc(m,S,r+_u,0,2*Math.PI),e.stroke(),e.restore()}function _P(e,t,r,o,l,s,u){if(t=t.filter(S=>S.type!==se.FollowMe),t.length===0)return;e.save(),t.forEach(S=>{S.targetEntity&&ES(e,S.targetEntity.position,S.targetEntity.radius,Kf,Zf,2,o,l,s,u)}),e.font=`${Uo}px "Press Start 2P", Arial`,e.fillStyle="white",e.textAlign="center",e.textBaseline="bottom",e.shadowColor="black",e.shadowBlur=5;const{x:d,y:f}=Nu(r.position,o,{width:l,height:s},u);let g=0,m={};t.forEach(S=>{const y=Cu[S.type];if(S.targetEntity){m[S.targetEntity.id]=(m[S.targetEntity.id]||0)+1;const E=S.targetEntity.position.x-o.x+l/2,T=S.targetEntity.position.y-o.y+s/2,A=`${y}${S.key.toUpperCase()}`,C=T-S.targetEntity.radius-_u-Uo/2-(m[S.targetEntity.id]-1)*T0;e.fillText(A,E,C)}else{e.textAlign="left";const E=`${y}${S.key.toUpperCase()}`,T=d+EP,C=f+wP+g*T0;e.fillText(E,T,C),g++,e.textAlign="center"}}),e.restore()}const ye=(e,t,r,o,l,s,u)=>{s==="transparent"||o<=0||l<=0||(e.fillStyle=s,e.fillRect(Math.floor(t*u),Math.floor(r*u),Math.ceil(o*u),Math.ceil(l*u)))},A0=10,I0=10,Zn=6,ui=4,jl=2,CP=5,vn=4,RP=2,kt=4,PP=2,Je=3,mo=2,zi=0,Js=zi+ui-1,bt=Js,ut=Js+vn-1,NP="rgba(0, 0, 0, 0.4)",DP=4,OP=1,ch={name:"tribe-human-2d",referenceImage:"swos.png",description:`A 2D human character asset for the Tribe game. This includes ensuring that the unique animations for stances like 'eat' and 'procreate' do not erroneously appear in other stances, such as 'walk', which was observed in the provided rendered media. The 'idle' animation was updated to a leg sway to better match the provided video for that stance, replacing a simpler body bob.

# Visual style

Human characters in the Tribe game are inspired by classic 2D pixel art, they look like Sensible Soccer players(Sensible Soccer game visual style is IMPORTANT), with a simple and recognizable design. The characters are designed to be easily distinguishable and animated in a way that conveys their actions clearly.

Character in Tribe game look like people from stone age, they have simple clothing, no shoes, and no modern accessories. The characters are designed to be easily distinguishable and animated in a way that conveys their actions clearly.

# Technical details

The asset is rendered on a canvas using the CanvasRenderingContext2D API. The rendering function takes parameters for position, size, progress, stance, direction, gender, and age. The character can face left or right, and the rendering adapts based on the stance (e.g., idle, walk, eat, procreate).
The rendering function must be simple and efficient, it should not use complex patterns or gradients, and should focus on solid colors and basic shapes to maintain the pixel art aesthetic.

15% padding from all edges of the rendering box is required to ensure the character is not cut off during rendering.

Subtle shadow should be drawn under the character to give it a sense of depth.

# Rendering parameters

- age: The age of the character, which affects the size and proportions of the body parts. Age is a number between 1 and 60, with 20 being the average age.
- gender: 
  - The male characters should have only pants, while female cover their breasts with a top. The clothing should be simple and muted, reflecting a stone-age style.
  - Female characters should have long hair, while male should have short hair and beard.
  - Male characters should have a more robust, muscular build
  - Female characters should have thinner arms and legs, with a more pronounced waist and hips.
- isPregnant: (applicable only for females) Indicates if the character is pregnant, like very large belly. Pregnant characters should have a larger torso.
- direction: A vector indicating the character's facing direction. There should be at least 8 directions (like in Sensible Soccer): top left, top, top right, left, right, bottom left, bottom, bottom right. The character should be flipped horizontally if the direction vector's X component is negative.
             When moving up(top, top left, top right), the character back of the head should be visible, when moving down(Y > 0), the character face should be visible.
- hungryLevel: A number between 0 and 100 indicating how hungry the character is, hunger level 100 means the character is starving, 0 means the character is not hungry at all. So hungry characters should be thinner, with less body fat, and more pronounced muscles. The character's hunger level affects the size and proportions of the body parts, with hungrier characters being smaller and more gaunt.

# Rendering details

- All parts of the body must be connected
- Rendering must take into account direction vector (X and Y) to flip the character horizontally if needed
- The character's age affects the size and proportions of the body parts, with older characters being larger and more robust. Hair color should become gray for older characters.

# Stances

- 'idle': The character stands still, with a slight leg sway to indicate life.
- 'walk': The character moves forward, with legs and arms in motion.
- 'gathering': The character is gathering food from berry bushes, with arms reaching out and a slight bend at the knees.
- 'eat': The character holds food and brings it to their mouth, with a slight bend at the knees.
- 'procreate': The character performs a mating animation, with a specific pose and movement. There should be some additional visual effects to indicate this action, such as a slight glow or aura around the characters, or dust particles to indicate movement.
- 'attacking': The character performs an attack animation, with arms raised and a forward motion.
- 'defending': The character takes a defensive stance, with arms raised and a slight bend at the knees.
- 'stunned': The character is stunned and laying on the ground, with limbs relaxed and a neutral expression.
- 'dead': The character lies on the ground, with limbs relaxed and a neutral expression, slowly turns into a skeleton over time.

`,stances:["idle","walk","gathering","eat","procreate","dead","attacking","defending","stunned"],render(e,t,r,o,l,s,u,d="male",f=20,g=[1,0],m=!1,S=0){const y=["dead","stunned"].includes(u),E=y?I0+4:A0,T=y?A0+4:I0+Je,A=.15,C=Math.min(o*(1-2*A)/E,l*(1-2*A)/T),F=E*C,B=T*C,D=t+(o-F)/2,H=r+(l-B)/2;e.save(),g[0]<0&&!y?(e.translate(D+F,H),e.scale(-1,1)):e.translate(D,H);const U="#D09A5A",$=f>50?"#BDBDBD":"#281808",ee="#7F5C4A",_e="#6B4F3A",Ce="#E0D8C0",be="#A0522D",Ne=1-Math.max(0,Math.min(100,S))/100*.2,Pe=d==="male"?1.1:.9,de=.8+(Math.max(1,Math.min(f,60))-1)/59*.2;let Ue=CP*Ne*Pe*de,Te=RP*Ne*Pe*de,ne=PP*Ne*de;m&&d==="female"&&(Ue*=1.5);const W=Math.round((E-Ue)/2),X=Math.round((E-Zn)/2),Y=W-Te,P=W+Ue,L=1,K=W+(Ue/2-L/2)-ne,ie=W+(Ue/2+L/2),Se=g[1]<-.2&&Math.abs(g[0])<.7,ae=Z=>{e.fillStyle=NP,e.beginPath();const re=E/2,Le=Z;e.ellipse(Math.floor(re*C),Math.floor(Le*C),Math.max(1,Math.floor(DP*C)),Math.max(1,Math.floor(OP*C)),0,0,2*Math.PI),e.fill()},Ee=(Z,re)=>{d==="male"?(ye(e,W,Js+Z,Ue,vn-mo,re,C),ye(e,W,Js+vn-mo+Z,Ue,mo,ee,C)):ye(e,W,Js+Z,Ue,vn,_e,C)},Ae=(Z,re)=>{Se?ye(e,X,zi+Z,Zn,ui,$,C):(ye(e,X,zi+Z,Zn,ui,re,C),ye(e,X,zi+Z,Zn,jl,$,C),d==="female"?(ye(e,X-1,zi+jl+Z,1,ui,$,C),ye(e,X+Zn,zi+jl+Z,1,ui,$,C)):ye(e,X+1,zi+2+Z,Zn-2,ui-2,$,C))};switch(u){case"idle":{const Z=s*Math.PI*2,re=Math.sin(Z)*.5,he=(Math.cos(Z*2)+1)*.25;ae(ut+Je+1),ye(e,K+re,ut+he,ne,Je,U,C),ye(e,ie-re,ut+he,ne,Je,U,C),Ee(he,U),ye(e,Y,bt+he,Te,kt,U,C),ye(e,P,bt+he,Te,kt,U,C),Ae(he,U);break}case"walk":{const Z=s*Math.PI*2,re=Math.sin(Z)*2,he=Math.abs(Math.cos(Z))*1;ae(ut+Je+1),ye(e,K+re,ut+he,ne,Je,U,C),ye(e,ie-re,ut+he,ne,Je,U,C),Ee(he,U),ye(e,Y-re,bt+he,Te,kt,U,C),ye(e,P+re,bt+he,Te,kt,U,C),Ae(he,U);break}case"gathering":{const Z=s*Math.PI*2,re=1,Le=(Math.sin(Z)+1)/2*2,he=re+Math.abs(Math.cos(Z))*.5;ae(ut+Je+1),ye(e,K,ut+he,ne,Je-re,U,C),ye(e,ie,ut+he,ne,Je-re,U,C),Ee(he,U),ye(e,Y+1,bt+he-Le,Te,kt,U,C),ye(e,P-1,bt+he-Le,Te,kt,U,C),Ae(he,U);break}case"eat":{ae(ut+Je+1),ye(e,K,ut+1,ne,Je-1,U,C),ye(e,ie,ut+1,ne,Je-1,U,C),Ee(1,U);const Le=(Math.sin(s*Math.PI*4)+1)/2,he=X+Zn/2,bn=zi+ui/2,qe=P+(he-P)*Le,je=bt+1+(bn-(bt+1))*Le;ye(e,Y,bt+1,Te,kt,U,C),ye(e,qe,je,Te,kt,U,C),ye(e,qe,je-1,1,1,be,C),Ae(1,U);break}case"procreate":{const Z=(Math.sin(s*Math.PI*8)+1)/4,re=(Math.sin(s*Math.PI*6)+1)*.5,Le=1.5,he=Le-re;ae(ut+Je+1),ye(e,K,ut+he,ne,Je-Le,U,C),ye(e,ie,ut+he,ne,Je-Le,U,C),Ee(he,U),ye(e,Y,bt+he,Te,kt,U,C),ye(e,P,bt+he,Te,kt,U,C),Ae(he,U),e.globalAlpha=Z,Ee(he,"white"),e.globalAlpha=1;break}case"attacking":{const Z=Math.sin(s*Math.PI)*1.5,re=Math.abs(Math.sin(s*Math.PI));ae(ut+Je+1),ye(e,K-Z,ut+re,ne,Je,U,C),ye(e,ie+Z*.5,ut+re,ne,Je,U,C),Ee(re,U),ye(e,Y,bt+re-2,Te,kt,U,C),ye(e,P,bt+re-2.5,Te,kt,U,C),Ae(re,U);break}case"defending":{ae(ut+Je+1),ye(e,K,ut+1,ne,Je-1,U,C),ye(e,ie,ut+1,ne,Je-1,U,C),Ee(1,U),ye(e,Y-1,bt+1-1,Te,kt,U,C),ye(e,P+1,bt+1-1,Te,kt,U,C),Ae(1,U);break}case"stunned":case"dead":{const Z=u==="dead",re=Z?Math.min(1,s):0,Le=re>.5?Ce:U,he=d==="male"?ee:_e,bn=re>.8?"transparent":$,qe=E/2,je=T/2,Gn=2;ae(T-1),ye(e,qe-ne-Gn,je,ne,Je,Le,C),ye(e,qe+Gn,je,ne,Je,Le,C),ye(e,qe-Te-Gn,je-vn+1,Te,kt,Le,C),ye(e,qe+Gn,je-vn+1,Te,kt,Le,C);const Wt=qe-Ue/2,un=je-vn/2;d==="male"?(re<.7&&ye(e,Wt,un+vn-mo,Ue,mo,he,C),ye(e,Wt,un,Ue,vn-mo,Le,C)):re<.7?ye(e,Wt,un,Ue,vn,he,C):ye(e,Wt,un,Ue,vn,Le,C);const xn=qe-Zn/2,$n=je-vn/2-ui+1;if(ye(e,xn,$n,Zn,ui,Le,C),bn!=="transparent"&&ye(e,xn,$n,Zn,jl,bn,C),Z&&re>.6){const Si="#B0A890";for(let ir=0;ir<3;ir++)ye(e,Wt+1,un+ir*1+1,Ue-2,.5,Si,C)}break}default:ye(e,0,0,E,T,"magenta",C);break}e.restore()}};function MP(e,t,r,o,l){const s=t.x,u=t.y-r-o/2;e.save(),e.fillStyle=l,e.strokeStyle=l,e.lineWidth=1.5,e.beginPath(),e.rect(s-o/2,u,o,o/2),e.fill(),e.beginPath(),e.moveTo(s-o/2,u),e.lineTo(s-o/4,u-o/3),e.lineTo(s-o/6,u),e.moveTo(s-o/6,u),e.lineTo(s,u-o/2),e.lineTo(s+o/6,u),e.moveTo(s+o/6,u),e.lineTo(s+o/4,u-o/3),e.lineTo(s+o/2,u),e.stroke(),e.restore()}function ha(e,t,r,o,l,s=!1,u=!1,d=!1,f=!1){o<Gf&&(r=r*.75),ch.render(e,t.x-r/2,t.y-r/2,r,r,0,"idle",l,o,[0,0],!1,0);let g,m;s?(g=fw,m=Rv):u?(g=hw,m=Dv):d?(g=gw,m=Nv):f&&(g=pw,m=Pv),g&&m&&MP(e,t,r/2,g,m)}function kP(e,t,r,o,l,s){if(e.save(),o.length===0){e.restore();return}const u=o.length*l,d=4;let f;const g=u+(o.length-1)*d;o.length>1&&g>s?f=(s-u)/(o.length-1):f=d,o.length<=1&&(f=0);for(let m=0;m<o.length;m++){const{member:S,isPlayer:y,isHeir:E,isPartner:T,isParent:A}=o[m],C=t+m*(l+f)+l/2,F=r+l/4;ha(e,{x:C,y:F},l,S.age,S.gender,y,E,T,A)}e.restore()}function FP(e,t,r,o,l){if(r.length===0)return;e.save();const s=Xn,u=" 00",d=" 00";e.font=`${Dd}px "Press Start 2P", Arial`;const f=e.measureText(u).width,g=e.measureText(d).width,m=Xn+mn+Xn+mn+Xn+bi+f+Xn/2+bi+g,S=r.length*kl+(r.length-1)*jm,y=l-S-Xn;e.fillStyle=vw,e.fillRect(s,y,m,S);for(let E=0;E<r.length;E++){const T=r[E],A=y+E*(kl+jm),C=A+kl/2;T.isPlayerTribe&&(e.fillStyle=mw,e.fillRect(s,A,m,kl));let F=s+Xn;if(e.font=`${mn}px "Press Start 2P", Arial`,e.textBaseline="middle",e.textAlign="left",e.fillText(T.tribeBadge,F,C-mn/4),F+=mn+Xn,!T.isPlayerTribe){const B=T.diplomacyStatus===yt.Friendly?"":"",D=`diplomacyButton_${T.leaderId}`,H={x:F-2,y:C-mn/2-2,width:mn+4,height:mn+4},x={id:D,action:ge.ToggleDiplomacy,rect:H,text:"",icon:B,backgroundColor:"transparent",textColor:"white",currentWidth:mn,tooltip:`Toggle diplomacy with this tribe (Currently: ${T.diplomacyStatus})`,targetTribeId:T.leaderId};t.uiButtons.push(x),t.hoveredButtonId===D&&(e.fillStyle=qf,e.globalAlpha=.5,e.fillRect(H.x,H.y,H.width,H.height),e.globalAlpha=1),e.font=`${mn*.8}px "Press Start 2P", Arial`,e.textBaseline="middle",e.textAlign="center",e.fillText(B,F+mn/2,C)}F+=mn+Xn,T.adultCount>0&&(ha(e,{x:F+bi/2,y:C},bi,25,"male"),F+=bi/2,e.font=`${Dd}px "Press Start 2P", Arial`,e.fillStyle="white",e.textBaseline="middle",e.textAlign="left",e.fillText(` ${T.adultCount}`,F,C),F+=e.measureText(` ${T.adultCount}`).width+Xn/2),T.childCount>0&&(ha(e,{x:F+bi/2,y:C},bi,1,"female"),F+=bi/2,e.font=`${Dd}px "Press Start 2P", Arial`,e.fillStyle="white",e.textBaseline="middle",e.textAlign="left",e.fillText(` ${T.childCount}`,F,C))}e.restore()}function UP(e,t,r,o,l){const s=xv,u=$v,d=t+o-s-u,f=r+u;e.save(),e.lineWidth=2,e.strokeStyle=l?jw:Yw,e.beginPath();const g=5;e.moveTo(d+g,f+g),e.lineTo(d+s-g,f+s-g),e.moveTo(d+s-g,f+g),e.lineTo(d+g,f+s-g),e.stroke(),e.restore()}function LP(e,t,r,o){const{tutorialState:l,tutorial:s}=t;if(l.transitionState===xt.INACTIVE)return;const u=s.steps[l.currentStepIndex];if(!u)return;e.save(),e.globalAlpha=l.transitionAlpha;const d=Bw,f=Hw,g=bw,m=`${kd}px "Press Start 2P", Arial`,S=`${e0}px "Press Start 2P", Arial`,y=xw,E=e0*1.5;e.font=S;const T=u.text.split(" ");let A="";const C=[];for(let Ce=0;Ce<T.length;Ce++){const be=A+T[Ce]+" ";e.measureText(be).width>d-f*2&&Ce>0?(C.push(A),A=T[Ce]+" "):A=be}C.push(A);const F=f*2+kd+f/2+C.length*E,B=(r-d)/2,D=o-F-160;e.fillStyle=Gw,e.beginPath(),e.moveTo(B+g,D),e.lineTo(B+d-g,D),e.quadraticCurveTo(B+d,D,B+d,D+g),e.lineTo(B+d,D+F-g),e.quadraticCurveTo(B+d,D+F,B+d-g,D+F),e.lineTo(B+g,D+F),e.quadraticCurveTo(B,D+F,B,D+F-g),e.lineTo(B,D+g),e.quadraticCurveTo(B,D,B+g,D),e.closePath(),e.fill(),e.fillStyle=y,e.textAlign="center",e.textBaseline="top",e.font=m,e.fillText(u.title,B+d/2,D+f),e.font=S;let H=D+f+kd+f/2;for(const Ce of C)e.fillText(Ce,B+d/2,H),H+=E;const x=t.hoveredButtonId==="tutorial-dismiss";UP(e,B,D,d,x),e.restore();const U=xv,$=$v,ee=B+d-U-$,_e=D+$;return{x:ee,y:_e,width:U,height:U}}function Qd(e,t,r){e.save();const o=Ww,l={x:t.x-o,y:t.y-o,width:t.width+o*2,height:t.height+o*2};e.strokeStyle=bv,e.lineWidth=Gv+Math.sin(r*Qf)*1.5,e.setLineDash([8,8]),e.strokeRect(l.x,l.y,l.width,l.height),e.restore()}function BP(e,t){e.fillStyle="white",e.font='30px "Press Start 2P", Arial',e.textAlign="center",e.fillText("Game Over!",e.canvas.width/2,e.canvas.height/2-60),e.font='20px "Press Start 2P", Arial',e.fillText("Lineage Extinct.",e.canvas.width/2,e.canvas.height/2-20),e.fillText(`Cause: ${t.causeOfGameOver||"Unknown"}`,e.canvas.width/2,e.canvas.height/2+20)}const wS=10,HP=3,E0=wS*.7;function bP(e,t){const{position:r,food:o,maxFood:l}=t;if(e.beginPath(),e.arc(r.x,r.y,wS,0,Math.PI*2),e.fillStyle="#228B22",e.fill(),e.strokeStyle="#006400",e.lineWidth=1,e.stroke(),o.length>0){const s=Math.PI*2/Math.min(o.length,l);for(let u=0;u<o.length;u++){const d=u*s,f=r.x+E0*Math.cos(d),g=r.y+E0*Math.sin(d);e.beginPath(),e.arc(f,g,HP,0,Math.PI*2),e.fillStyle="#FF0000",e.fill()}}}const w0=(e,t,r=70,o=50)=>{const l=e>>t&255;return`hsl(${Math.floor(l/255*360)}, ${r}%, ${o}%)`},GP=(e,t)=>{const r=e.match(/hsl\((\d+),\s*(\d+)%,\s*(\d+)%\)/);if(!r)return e;const[o,l,s]=[parseInt(r[1]),parseInt(r[2]),parseInt(r[3])];return`hsl(${o}, ${l}%, ${Math.max(0,s-t)}%)`},Vl=(e,t,r,o,l,s,u,d=!1)=>{e.save(),e.translate(t,r),e.rotate(s),e.fillStyle=d?GP(u,15):u,e.beginPath(),e.roundRect(-o/2,0,o,l,o/2),e.fill(),e.restore()},Jd=(e,t)=>{const r=e.match(/hsl\((\d+),\s*(\d+)%,\s*(\d+)%\)/),o=75;if(!r)return`hsl(0, 0%, ${o}%)`;const[,l,s,u]=r.map(Number),d=s*(1-t),f=u+(o-u)*t;return`hsl(${l}, ${d}%, ${f}%)`},_S={name:"tribe-prey-2d",referenceImage:"swos.png",description:`A 2D prey asset for the Tribe game, featuring various stances and animations.

Prey is an animal which can be hunted by predators or humans in the Tribe game.

Preys look like small 4 leg mammals, with a simple and recognizable design. The characters are designed to be easily distinguishable and animated in a way that conveys their actions clearly.

# Visual style

Prey characters in the Tribe game are inspired by classic 2D pixel art, they look like Sensible Soccer players(Sensible Soccer game visual style is IMPORTANT), with a simple and recognizable design. The characters are designed to be easily distinguishable and animated in a way that conveys their actions clearly.

Character in Tribe game look like creatures from stone age, they have simple clothing, no shoes, and no modern accessories. The characters are designed to be easily distinguishable and animated in away that conveys their actions clearly.

Prey walks on all fours, unlike human (two legs).

Each prey is described by a unique gene code, which is a number that defines its appearance, size, and other characteristics. The gene code is used to generate the character's appearance, including body proportions, color, and other visual features. The gene code is a 32-bit integer, with each bit representing a specific characteristic of the character.

Prey should have should have visible body parts, such as head, torso, arms, and legs. The body parts should be connected and should not overlap. The character's body parts should be simple shapes, such as circles and rectangles, with solid colors and no gradients or patterns.

Preys are supposed to be sympathetic and friendly, so the character's face should have a friendly expression, with a smile and bright eyes. The character's eyes should be large and expressive, with a simple design.

# Technical details

The asset is rendered on a canvas using the CanvasRenderingContext2D API. The rendering function takes parameters for position, size, progress, stance, direction, gender, and age. The character can face left or right, and the rendering adapts based on the stance (e.g., idle, walk, eat, procreate).
The rendering function must be simple and efficient, it should not use complex patterns or gradients, and should focus on solid colors and basic shapes to maintain the pixel art aesthetic.

15% padding from all edges of the rendering box is required to ensure the character is not cut off during rendering.

Subtle shadow should be drawn under the a character to give it a sense of depth.

IMPORTANT: The character is visible from the side, just like in Sensible Soccer.

# Rendering parameters

- age: The age of the character, which affects the size and proportions of the body parts. Age is a number between 0 and 12, with 2 being the average age.
- gender:
  - 'male': Male prey are larger and more robust, with a more pronounced musculature.
  - 'female': Female prey are smaller and more agile, with a leaner build.
- isPregnant: (applicable only for females) Indicates if the character is pregnant, like very large belly. Pregnant characters should have a larger torso.
- direction: A vector indicating the character's facing direction. There should be at least 8 directions (like in Sensible Soccer): top left, top, top right, left, right, bottom left, bottom, bottom right. The character should be flipped horizontally if the direction vector's X component is negative.
             When moving up(top, top left, top right), the character back of the head should be visible, when moving down(Y > 0), the character face should be visible.
- hungryLevel: A number between 0 and 100 indicating how hungry the character is, hunger level 100 means the character is starving, 0 means the character is not hungry at all. So hungry characters should be thinner, with less body fat, and more pronounced muscles. The character's hunger level affects the size and proportions of the body parts, with hungrier characters being smaller and more gaunt.

# Rendering details

- All parts of the body must be connected
- Rendering must take into account direction vector (X and Y) to flip the character horizontally if needed
- The character's age affects the size and proportions of the body parts, with older characters being larger and more robust. Hair color should become gray for older characters.

# Stances

- 'idle': The character stands still, with a slight leg sway to indicate life.
- 'walk': The character moves forward, with legs and arms in motion.
- 'eat': The character holds food and brings it to their mouth, with a slight bend at the knees.
- 'procreate': The character performs a mating animation, with a specific pose and movement. There should be some additional visual effects to indicate this action, such as a slight glow or aura around the characters, or a dust particles to indicate movement.
- 'dead': The character lies on the ground, with limbs relaxed and a neutral expression, slowly turns into a grey skeleton over time. The character pose and body parts should not be animated in this stance, as the character is dead so it should not move.`,stances:["idle","walk","eat","dead","procreate"],render(e,t,r,o,l,s,u,d={gender:"male",age:2,direction:[1,0],isPregnant:!1,hungryLevel:0,geneCode:8405024}){e.save(),e.imageSmoothingEnabled=!1;const f=o*.15,g=t+o/2,m=r+l/2,S=o-f*2,y=l-f*2,{gender:E,age:T,direction:A,isPregnant:C,hungryLevel:F,geneCode:B}=d,D=.8+Math.min(T,10)/10*.4,H=E==="male"?1.05:.95,x=1-F/100*.3,U=S*.5*x*D*H;let $=y*.3*D*H;const ee=S*.15*D*H,_e=U*.2,Ce=y*.3,be=w0(B,0,30,50);let Ne=w0(B,8,50,40);if(T>45){const ae=Math.min(1,(T-45)/15);Ne=Jd(Ne,ae)}e.translate(g,m),A[0]<0&&e.scale(-1,1);const Pe=Math.sin(s*Math.PI*2),de=Math.cos(s*Math.PI*2),Ue=Ce+$*.2;if(u==="dead"){const ae=Math.min(s,1);e.translate(0,y*.2),e.rotate(Math.PI/2);const Ee=Jd(Ne,ae),Ae=Jd(be,ae);e.globalAlpha=.5+ae*.5,e.strokeStyle=Ee,e.lineWidth=_e*.5,e.beginPath(),e.moveTo(-U*.4,0),e.lineTo(U*.4,0),e.stroke();for(let Z=-1;Z<=1;Z+=1)e.beginPath(),e.arc(0,0,$*.4,Math.PI*.4*Z-Math.PI*.2,Math.PI*.4*Z+Math.PI*.2),e.stroke();e.fillStyle=Ae,e.beginPath(),e.arc(U*.5,0,ee,0,Math.PI*2),e.fill(),e.fillStyle="black",e.beginPath(),e.arc(U*.55,0,ee*.3,0,Math.PI*2),e.fill(),e.restore();return}e.fillStyle="rgba(0, 0, 0, 0.1)",e.beginPath(),e.ellipse(0,Ue,U*.7,U*.25,0,0,2*Math.PI),e.fill();let Te=0,ne=0,W=0,X=0,Y=0,P=0;switch(u){case"idle":ne=Pe*(y*.02),W=Pe*.05,X=-Pe*.05,Y=-Pe*.05,P=Pe*.05;break;case"walk":ne=Math.abs(de)*(y*-.04),W=Pe*.7,X=-Pe*.7,Y=-Pe*.7,P=Pe*.7;break;case"eat":Te=y*.1,ne=y*.05,Te+=Pe*(y*.02);break;case"procreate":ne=y*.05;const ae=(1-de)*-S*.05;e.translate(ae,0),e.shadowColor="rgba(255, 182, 193, 0.9)",e.shadowBlur=10;break}C&&E==="female"&&($*=1.6);const L=ne,K=L-$*.2;Vl(e,U*-.35,K,_e,Ce,Y,Ne,!0),Vl(e,U*.35,K,_e,Ce,P,Ne,!0),e.fillStyle=Ne,e.beginPath(),e.ellipse(0,L,U/2,$/2,0,0,2*Math.PI),e.fill();const ie=U*.45,Se=K+Te;e.fillStyle=be,e.beginPath(),e.arc(ie,Se,ee,0,Math.PI*2),e.fill(),A[1]>=0&&(e.fillStyle="black",e.beginPath(),e.arc(ie+ee*.3,Se-ee*.2,ee*.15,0,Math.PI*2),e.fill()),Vl(e,U*-.35,K,_e,Ce,W,Ne),Vl(e,U*.35,K,_e,Ce,X,Ne),e.restore()}};function xP(e,t){let[r,o,l]=e.match(/\d+/g).map(Number);return r=Math.max(0,r-t),o=Math.max(0,o-t),l=Math.max(0,l-t),`rgb(${r}, ${o}, ${l})`}function $P(e){const t=(e&16711680)>>16,r=(e&65280)>>8,o=e&255,l=`rgb(${t}, ${r}, ${o})`,s=xP(l,40),u=(e&255)%100+50,d=(e>>8&255)%100,f=(e>>16&255)%100,g=`rgb(${u}, ${d}, ${f})`,m=(e&8388608)!==0?"#00aaff":"#ffaa00";return{furColor:l,darkerFurColor:s,skinColor:g,eyeColor:m}}const CS={name:"tribe-predator-2d",referenceImage:"swos.png",description:`A 2D predator asset for the Tribe game, featuring various stances and animations.

Predator is an animal which can hunt and attack humans in the Tribe game. It is designed to be a threat to the player, adding an element of danger and challenge to the game world.

Predator look like bears or wolves, with a simple and recognizable design. The characters are designed to be easily distinguishable and animated in a way that conveys their actions clearly.

# Visual style

Predator characters in the Tribe game are inspired by classic 2D pixel art, they look like Sensible Soccer players(Sensible Soccer game visual style is IMPORTANT), with a simple and recognizable design. The characters are designed to be easily distinguishable and animated in a way that conveys their actions clearly.

Character in Tribe game look like creatures from stone age, they have simple clothing, no shoes, and no modern accessories. The characters are designed to be easily distinguishable and animated in away that conveys their actions clearly.

Predator walks on arms and legs, unlike human (two legs).

Each predator is described by a unique gene code, which is a number that defines its appearance, size, and other characteristics. The gene code is used to generate the character's appearance, including body proportions, color, and other visual features. The gene code is a 32-bit integer, with each bit representing a specific characteristic of the character.

Predator should have visible ears, eyes, and mouth with teeth. It must have a tail. Front legs should be shorter than back legs, and they should be positioned closer to the body. The character's body should be wider at the top and narrower at the bottom, with a slight curve to the back. The character's head should be larger than the body, with a pronounced jaw and sharp teeth.

# Technical details

The asset is rendered on a canvas using the CanvasRenderingContext2D API. The rendering function takes parameters for position, size, progress, stance, direction, gender, and age. The character can face left or right, and the rendering adapts based on the stance (e.g., idle, walk, eat, procreate).
The rendering function must be simple and efficient, it should not use complex patterns or gradients, and should focus on solid colors and basic shapes to maintain the pixel art aesthetic.

15% padding from all edges of the rendering box is required to ensure the character is not cut off during rendering.

Subtle shadow should be drawn under the a character to give it a sense of depth.

IMPORTANT: The character is visible from the side, just like in Sensible Soccer.

# Rendering parameters

- age: The age of the character, which affects the size and proportions of the body parts. Age is a number between 1 and 20, with 3 being the average age.
- gender:
  - 'male': Male predators are larger and more robust, with a more pronounced musculature.
  - 'female': Female predators are smaller and more agile, with a leaner build.
- isPregnant: (applicable only for females) Indicates if the character is pregnant, like very large belly. Pregnant characters should have a larger torso.
- direction: A vector indicating the character's facing direction. There should be at least 8 directions (like in Sensible Soccer): top left, top, top right, left, right, bottom left, bottom, bottom right. The character should be flipped horizontally if the direction vector's X component is negative.
             When moving up(top, top left, top right), the character back of the head should be visible, when moving down(Y > 0), the character face should be visible.
- hungryLevel: A number between 0 and 100 indicating how hungry the character is, hunger level 100 means the character is starving, 0 means the character is not hungry at all. So hungry characters should be thinner, with less body fat, and more pronounced muscles. The character's hunger level affects the size and proportions of the body parts, with hungrier characters being smaller and more gaunt.

# Rendering details

- All parts of the body must be connected
- Rendering must take into account direction vector (X and Y) to flip the character horizontally if needed
- The character's age affects the size and proportions of the body parts, with older characters being larger and more robust. Hair color should become gray for older characters.

# Stances

- 'idle': The character stands still, with a slight leg sway to indicate life.
- 'walk': The character moves forward, with legs and arms in motion.
- 'eat': The character holds food and brings it to their mouth, with a slight bend at the knees.
- 'procreate': The character performs a mating animation, with a specific pose and movement. There should be some additional visual effects to indicate this action, such as a slight glow or aura around the characters, or a dust particles to indicate movement.
- 'attacking': The character performs an attack animation, with arms raised and a forward motion.
- 'dead': The character lies on the ground, with limbs relaxed and a neutral expression, slowly turns into a grey skeleton over time. The character pose and body parts should not be animated in this stance, as the character is dead so it should not move.`,stances:["idle","walk","eat","dead","attacking","procreate"],render(e,t,r,o,l,s,u,d={gender:"male",age:20,direction:[1,0],isPregnant:!1,hungryLevel:0,geneCode:8405024}){const{gender:f,age:g,direction:m,isPregnant:S,hungryLevel:y,geneCode:E}=d;e.save();const T=o*.15,A=Math.max(1,Math.floor((o-T*2)/10)),C=m[0]<0;e.translate(t+o/2,r+l/2),C&&e.scale(-1,1);const F=$P(E),B=.8+Math.min(g,20)/20*.4,D=f==="male"?1.05:.95,H=1-y/100*.25,x=B*D*H,U=Math.max(0,Math.min(1,(g-15)/5));e.filter=`grayscale(${U})`;const $=F.furColor,ee=F.darkerFurColor,_e=F.eyeColor,Ce="#FFFFFF",be="#c75c5c",Ne="#E0E0E0",Pe="#A0A0A0",de=l/2-2*A,Ue=Math.sin(s*Math.PI*2),Te=Math.abs(Ue);if(e.fillStyle="rgba(0,0,0,0.15)",e.beginPath(),e.ellipse(0,de,A*4,A,0,0,2*Math.PI),e.fill(),e.filter="none",u==="dead"){const qe=Math.min(1,s*2);e.save(),e.translate(0,de-A*3),e.rotate(-Math.PI/2);const je=(Gn,Wt,un,xn,$n=!1)=>{e.fillStyle=$n?Pe:Ne,e.fillRect(Gn*A,Wt*A,un*A,xn*A)};qe<1&&(e.globalAlpha=1-qe,e.fillStyle=$,e.beginPath(),e.ellipse(0,0,A*3,A*5,0,0,Math.PI*2),e.fill(),e.globalAlpha=1),qe>0&&(e.globalAlpha=qe,je(-1,-4,2,2),je(1,-3.5,1,1,!0),je(-.5,-2,1,5,!0),je(-2.5,-1,5,.5),je(-2.5,0,5,.5),je(-2.5,1,5,.5),je(-3,-2,-1,2,!0),je(3,-2,1,2),je(-3,2,-1,2,!0),je(3,2,1,2),e.globalAlpha=1),e.restore(),e.restore();return}e.fillStyle=$;let ne=0,W=0,X=0,Y=[0,0,0,0];switch(u){case"idle":ne=Ue*A*.1;break;case"walk":const qe=Math.sin(s*Math.PI*4);ne=Math.abs(qe)*-A*.5,Y=[qe*A,-qe*A,-qe*A,qe*A];break;case"attacking":const je=Math.sin(s*Math.PI*4);W=A*2+je*A,X=A*2,ne=A;break;case"eat":X=A*3+Te*A,ne=A*1.5,e.fillStyle=be,e.fillRect(-A,de-A,A*2,A);break;case"procreate":ne=Math.sin(s*Math.PI*8)*A*.3,e.fillStyle="rgba(139, 69, 19, 0.5)";for(let Wt=0;Wt<5;Wt++){const un=(Math.random()-.5)*A*8,xn=de+(Math.random()-.5)*A*2;Te>.5&&e.fillRect(un,xn,A*.5,A*.5)}break}const P=A*3*x*(S?1.3:1),L=A*5*x,K=-L/1.5,ie=de-P-A*2.5+ne;e.fillStyle=$,e.beginPath(),e.moveTo(K-A*.5,ie+P*.5),e.quadraticCurveTo(K-A*3,ie-A,K-A*2+Ue*A,ie+P+A),e.fill();const Se=A*1.2*x,ae=A*3*x,Ee=A*2.5*x,Ae=K+L*.8,Z=K+L*.2;e.fillStyle=ee,e.fillRect(Z,de-Ee,Se,Ee+Y[2]),e.fillRect(Ae,de-ae,Se,ae+Y[0]),e.fillStyle=$,e.beginPath(),e.moveTo(K,ie+P),e.lineTo(K,ie+A),e.quadraticCurveTo(K+L/2,ie,K+L,ie+A),e.lineTo(K+L,ie+P),e.fill(),e.fillStyle=$,e.fillRect(Z+A/2,de-Ee,Se,Ee+Y[3]),e.fillRect(Ae+A/2,de-ae,Se,ae+Y[1]);const re=A*3.5*x,Le=K+L-re*.3+W,he=ie-re*.3+X;e.fillStyle=$,e.beginPath(),e.arc(Le,he,re/2,0,Math.PI*2),e.fill(),e.beginPath(),e.ellipse(Le+re*.4,he+re*.2,A*1.5,A,0,0,Math.PI*2),e.fill(),m[1]>=0&&(e.fillStyle=_e,e.fillRect(Le+A*.5,he-A*.5,A*.5,A*.5),u==="attacking"&&(e.fillStyle=Ce,e.fillRect(Le+re*.5,he+re*.4,A,A*.4))),e.fillStyle=ee,e.beginPath(),e.moveTo(Le-re*.4,he-re*.3),e.lineTo(Le,he-re*.7),e.lineTo(Le,he-re*.2),e.fill(),e.restore()}},zP=9;function WP(e,t){const{position:r,gender:o,age:l,decayProgress:s,food:u,radius:d,originalEntityType:f,geneCode:g}=t;if(e.save(),e.globalAlpha=1-s,f==="human"?ch.render(e,r.x-d,r.y-d,d*2,d*2,s,"dead",o,l,[0,0],!1,0):f==="prey"?_S.render(e,r.x-d,r.y-d,d*2,d*2,s,"dead",{gender:o,age:l,direction:[0,0],isPregnant:!1,hungryLevel:0,geneCode:g||8405024}):f==="predator"&&CS.render(e,r.x-d,r.y-d,d*2,d*2,s,"dead",{gender:o,age:l,direction:[0,0],isPregnant:!1,hungryLevel:0,geneCode:g||8405024}),e.restore(),u.length>0){e.save(),e.font=`${zP}px Arial`,e.textAlign="center",e.textBaseline="middle";const m=Et*.9,S=Math.PI/vv*3;u.forEach((y,E)=>{const T=E*S,A=r.x+m*Math.cos(T)*Math.atan2(E,E),C=r.y+m*Math.sin(T)*Math.atan2(E,E),F=bf[y.type];e.fillText(F,A,C)}),e.restore()}}function Ki(e,t,r,o,l,s,u,d){e.save(),e.fillStyle=u,e.fillRect(t,r,o,l),e.fillStyle=d,e.fillRect(t,r,o*Math.max(0,s),l),e.restore()}function YP(e,t,r,o,l,s){if(e.save(),o.length===0){e.restore();return}const u=o.length*l;let d;u>s||u+(o.length-1)*4>s?d=(s-u)/(o.length-1):d=4,o.length===1&&(d=0);for(let f=0;f<o.length;f++){const g=bf[o[f].type];e.fillText(g,t+f*(l+d),r)}e.restore()}function jP(e,t,r,o,l){const s=t.autopilotControls.hoveredAutopilotAction;if(!s)return;let u,d=Et/2;const f=Cu[s.action],g=Yv[s.action],m=`${f} ${g}`;if("targetEntityId"in s){const S=t.entities.entities[s.targetEntityId];S&&(u=S.position,d=S.radius)}else"position"in s&&(u=s.position);if(u){ES(e,u,d,Kf,Zf,2,r,o,l,t.mapDimensions),e.save(),e.font=`${Uo}px "Press Start 2P", Arial`,e.fillStyle="white",e.textAlign="center",e.textBaseline="bottom",e.shadowColor="black",e.shadowBlur=5;const{x:S,y}=Nu(u,r,{width:o,height:l},t.mapDimensions),E=y-d-_u-Uo/2;e.fillText(m,S,E),e.restore()}}function VP(e,t,r,o,l){e.save();const s=(Math.sin(l*Qf)+1)/2,u=r+_u+s*5;e.strokeStyle=Kf,e.lineWidth=2,e.setLineDash(Zf),e.beginPath(),e.arc(t.x,t.y,u,0,Math.PI*2),e.stroke(),e.setLineDash([]);const d=Cu[o],f=Yv[o];if(d){e.font=`${Uo*1.5}px "Press Start 2P", Arial`,e.textAlign="center",e.textBaseline="middle";const g=t.y-u-25;e.fillText(d,t.x,g),e.font=`${Uo*.8}px "Press Start 2P", Arial`,e.fillText(f,t.x,g+25)}e.restore()}function XP(e,t,r){e.save();const o=30,l=70,s=3,u=l/s;for(let d=0;d<s;d++){const f=d*u,g=(r*o+f)%l,m=1-g/l;e.strokeStyle=`rgba(255, 215, 0, ${m*.7})`,e.lineWidth=1+(1-m)*2,e.beginPath(),e.arc(t.x,t.y,g,0,Math.PI*2),e.stroke()}e.restore()}function KP(e,t){const{activeAutopilotAction:r,behaviors:o}=t.autopilotControls,l=It(t);if(!l)return;const s=(u,d)=>{XP(u,d.position,t.time)};if(l.isCallingToFollow&&ln(e,t.mapDimensions.width,t.mapDimensions.height,s,{position:l.position}),o.followLeader&&!r&&ln(e,t.mapDimensions.width,t.mapDimensions.height,s,{position:l.position},70),r){let u,d=15;if("position"in r)u=r.position;else if("targetEntityId"in r){const f=t.entities.entities[r.targetEntityId];f&&(u=f.position,d=f.radius||30)}if(u&&r.action!==se.AutopilotFollowMe&&!l.isCallingToFollow){const f=(g,m)=>{VP(g,m.position,d,r.action,t.time)};ln(e,t.mapDimensions.width,t.mapDimensions.height,f,{position:{...u}},u,d+30)}}}function _0(e,t,r,o,l,s,u=!0){const d=t.split(" ");let f="";const g=[];for(let m=0;m<d.length;m++){const S=f+d[m]+" ";e.measureText(S).width>l&&m>0?(g.push(f),f=d[m]+" "):f=S}if(g.push(f),u)for(let m=0;m<g.length;m++)e.fillText(g[m],r,o+m*s);return g.length*s}function ZP(e){return 1-Math.pow(1-e,3)}function qP(e,t,r,o){t.notificationButtonRects={dismiss:{},view:{}};const l=t.notifications.filter(u=>!u.isDismissed);if(l.length===0)return;e.save();let s=o-t_;for(const u of l){const d=r-Ll-yr;e.font=`${Fd}px "Press Start 2P", Arial`;const f=d+yr,g=Ll-yr*2,m=_0(e,u.message,-9999,-9999,g,Fd*1.2,!1),S=yr*2+m+Kn,y=s-S,E=Date.now()-u.creationTime,T=Math.min(E/e_,1),A=ZP(T),C=o,F=C+(y-C)*A;e.fillStyle=Xw,e.beginPath(),e.roundRect(d,F,Ll,S,Vw),e.fill(),e.fillStyle=Kw,e.textBaseline="top",_0(e,u.message,f,F+yr,g,Fd*1.2,!0);const B=F+S-Kn-yr/2,D=d+Ll-Kn-yr/2,H={x:D,y:B,width:Kn,height:Kn};t.notificationButtonRects&&(t.notificationButtonRects.dismiss[u.id]=H);const x=t.hoveredButtonId===`notification-dismiss-${u.id}`;if(e.fillStyle=x?i0:Zw,e.font=`${Kn}px Arial`,e.textAlign="center",e.textBaseline="middle",e.fillText("",H.x+H.width/2,H.y+H.height/2),u.targetEntityIds||u.targetPosition||u.targetArea||u.targetRadius){const ee={x:D-Kn-n0,y:B,width:Kn,height:Kn};t.notificationButtonRects&&(t.notificationButtonRects.view[u.id]=ee);const _e=t.hoveredButtonId===`notification-view-${u.id}`;e.fillStyle=_e?i0:qw,e.font=`${Kn*(_e?1.5:1.2)}px Arial`,e.fillText("",ee.x+ee.width/2,ee.y+ee.height/2)}s-=S+n0}e.restore()}function QP(e){return e.length===0?0:e.reduce((r,o)=>r+o,0)/e.length}function ef(e,t,r,o,l,s,u,d){e.save(),e.fillStyle="rgba(255, 255, 255, 0.1)",e.fillRect(o,l,s,u),e.strokeStyle="#555",e.lineWidth=1,e.strokeRect(o,l,s,u);const f=QP(r);e.fillStyle="white",e.font="11px monospace",e.textAlign="left",e.fillText(`${t}: ${f.toFixed(2)}ms`,o+Ze,l+Ze+8);const g=Math.max(...r,1),m=r.map(S=>S/g*u);if(e.beginPath(),e.strokeStyle=d,e.lineWidth=2,m.length>1){e.moveTo(o,l+u-m[0]);for(let S=1;S<m.length;S++){const y=o+S/(m.length-1)*s,E=l+u-m[S];e.lineTo(y,E)}}else if(m.length===1){const S=l+u-m[0];e.moveTo(o,S),e.lineTo(o+s,S)}e.stroke(),e.fillStyle="rgba(255, 255, 255, 0.7)",e.font="10px monospace",e.textAlign="right",e.fillText(`${g.toFixed(2)}ms`,o+s-Ze,l+Ze+8),e.restore()}function JP(e,t,r){const{performanceMetrics:o}=t;if(!o)return;const l=280,s=240,u=r-l-Ze,d=Ze+Sn*2;e.save(),e.fillStyle="rgba(0, 0, 0, 0.8)",e.fillRect(u,d,l,s),e.strokeStyle="#444",e.lineWidth=2,e.strokeRect(u,d,l,s),e.fillStyle="white",e.font="12px monospace",e.textAlign="left";let f=d+Ze+5;const g=u+Ze;e.fillStyle="#66ccff",e.font="bold 14px monospace",e.fillText(" Performance Debugger",g,f),f+=25,e.fillStyle="white",e.font="12px monospace";const m=eN(t);e.fillText(`FPS: ${m.toFixed(1)}`,g,f),f+=20;const S=l-Ze*2,y=45,E=10;ef(e,"Render",tf(t,"renderTime"),g,f,S,y,"#4CAF50"),f+=y+E,ef(e,"World Update",tf(t,"worldUpdateTime"),g,f,S,y,"#2196F3"),f+=y+E,ef(e,"AI Update",tf(t,"aiUpdateTime"),g,f,S,y,"#FFC107"),e.fillStyle="#888",e.font="10px monospace",e.textAlign="center",e.fillText("Press '2' to toggle this panel",u+l/2,d+s-10),e.restore()}function eN(e){const{performanceMetrics:t}=e;if(!t||t.history.length===0)return 0;const r=t.history[t.history.length-1].bucketTime/(Tt/At);return t.history.filter(s=>r-s.bucketTime/(Tt/At)<1).length}function tN(e,t){if(e.length===0)return[];const r=new Map;for(const s of e){const u=Math.floor(s.bucketTime/(Tt/At));r.set(u,(r.get(u)||0)+s[t])}return Array.from(r.keys()).sort().map(s=>r.get(s)).slice(0,-1).slice(1).reverse()}function tf(e,t){return tN(e.performanceMetrics.history,t)}function dh(e,t,r){if(!t.aiBlackboard)return;const o=t.aiBlackboard.nodeExecutionData,l=t.type==="human"?hS:t.type==="predator"?pS:t.type==="prey"?gS:null;if(!l)return;e.save(),e.font=`${Cw}px Arial`,e.textAlign="left",e.textBaseline="top";const s=y=>{switch(y){case I.SUCCESS:return Pw;case I.FAILURE:return Nw;case I.RUNNING:return Dw;case I.NOT_EVALUATED:case null:default:return Ow}},u=y=>{if(!y.name||!o[y.name])return{width:0,height:0};let E=0,T=0;const A=o[y.name],C=` ${y.name}`+(A!=null&&A.debugInfo?`: ${A.debugInfo}`:""),F=e.measureText(C).width,B=(y.depth??0)*qm+8+F+Jm+ks+20;if(E=Math.max(E,B),T+=Md,y.children)for(const D of y.children){const H=u(D);E=Math.max(E,H.width),T+=H.height}else if(y.child){const D=u(y.child);E=Math.max(E,D.width),T+=D.height}return{width:E,height:T}},d=(y,E,T,A)=>{if(!y.name||!o[y.name])return E;let C=E;const F=o[y.name],B=T+2+(y.depth??0)*qm;let D=I.NOT_EVALUATED,H=Qm,x="";if(F){D=F.status,x=F.debugInfo;const ee=kw/At*Tt,_e=r-F.lastExecuted,Ce=Math.max(0,1-_e/ee);H=LE(Qm,Mw,Ce),_e>ia&&(D=I.NOT_EVALUATED)}const U=s(D);e.fillStyle=U,e.fillText("",B,C),e.fillStyle=H;const $=` ${y.name}`+(x?`: ${x}`:"");if(e.fillText($,B+8,C),F&&F.executionHistory.length>0){const{executionHistory:ee}=F,_e=Hv/At*Tt,Ce=r,be=Ce-_e,Ne=T+A-ks-Jm;let Pe=Ne;const de=C+(Md-Ul)/2,Ue=ee.filter(K=>K.time<be);let Te=Ue.length>0?Ue[Ue.length-1].status:null,ne=be;const W=ee.filter(K=>K.time>=be&&K.time<=Ce),X=ks/_e;e.fillStyle="rgba(255, 255, 255, 0.1)",e.fillRect(Ne,de,ks,Ul);for(const K of W){const Se=(K.time-ne)*X;Se>0&&(e.fillStyle=s(Te),e.fillRect(Pe,de,Se,Ul),Pe+=Se),Te=K.status,ne=K.time}r-ne>ia&&(Te=I.NOT_EVALUATED);const P=(Ce-ne)*X;e.fillStyle=s(Te);const L=Ne+ks-Pe;e.fillRect(Pe,de,Math.min(P,L),Ul)}if(C+=Md,y.children)for(const ee of y.children)C=d(ee,C,T,A);else y.child&&(C=d(y.child,C,T,A));return C},{width:f,height:g}=u(l);if(g===0){e.restore();return}const m=t.position.x+ww,S=t.position.y+_w-g/2;e.fillStyle=Rw,e.fillRect(m,S,f,g+4),d(l,S+2,m,f),e.restore()}const nN={moving:"walk",gathering:"gathering",eating:"eat",feeding:"eat",procreating:"procreate",idle:"idle",attacking:"attacking",planting:"gathering",depositing:"gathering",retrieving:"gathering"};function iN(e,t){var d;const{radius:r,position:o,activeAction:l="idle"}=t,s=((d=t.stateMachine)==null?void 0:d[0])||"N/A",u=t.isAdult?Et+20:Et*.6+20;e.save(),e.fillStyle="white",e.font="10px Arial",e.textAlign="center",e.fillText(`Action: ${l}`,o.x,o.y-u),e.fillText(`State: ${s}`,o.x,o.y-u+10),e.fillText(`HP: ${t.hitpoints}`,o.x,o.y-u+20),e.fillText(`Cooldown: ${t.attackCooldown||"N/A"}`,o.x,o.y-u+30),e.fillText(`Tribe: ${t.leaderId||"N/A"}`,o.x,o.y-u+40),e.restore(),e.beginPath(),e.arc(o.x,o.y,r,0,Math.PI*2),e.strokeStyle="rgba(255, 0, 0, 0.5)",e.lineWidth=1,e.stroke(),e.closePath()}function rN(e,t,r,o,l){e.save(),e.font=`${Tf}px Arial`,e.textAlign="center",e.textBaseline="middle",e.fillText(r,t.x,t.y-(o?Et:$o)-Tf-l),e.restore()}function oN(e,t,r,o,l){const s=t.x,u=t.y-r-o/2;e.save(),e.fillStyle=l,e.strokeStyle=l,e.lineWidth=1.5,e.beginPath(),e.rect(s-o/2,u,o,o/2),e.fill(),e.beginPath(),e.moveTo(s-o/2,u),e.lineTo(s-o/4,u-o/3),e.lineTo(s-o/6,u),e.moveTo(s-o/6,u),e.lineTo(s,u-o/2),e.lineTo(s+o/6,u),e.moveTo(s+o/6,u),e.lineTo(s+o/4,u-o/3),e.lineTo(s+o/2,u),e.stroke(),e.restore()}function sN(e,t,r){var d;const{position:o,radius:l}=t,s=o.x-Od/2,u=o.y-l-Sw;if(((d=t.stateMachine)==null?void 0:d[0])===tr){const f=t.stateMachine[1],g=r-f.attackStartTime,m=Math.min(g/Iv,1);Ki(e,s,u,Od,Vm,m,ji,yw)}else if(t.attackCooldown&&t.attackCooldown>0){const f=1-t.attackCooldown/wu;Ki(e,s,u,Od,Vm,f,ji,Tw)}}function aN(e,t,r){const l="";e.save(),e.font="15px Arial",e.textAlign="center",e.textBaseline="bottom",e.shadowColor="black",e.shadowBlur=3,e.fillText(l,t.x,t.y-r),e.restore()}function lN(e,t,r=!1,o=!1,l=!1,s=!1,u=!1,d=!1,f=!1,g=!1,m,S){const{position:y,activeAction:E="idle"}=t,T=t.isAdult?Et:Et*.6,A=nN[E]||"idle";ch.render(e,y.x-T,y.y-T,T*2,T*2,t.animationProgress||0,A,t.gender,t.age,[t.direction.x,t.direction.y],t.isPregnant??!1,t.hunger),d&&(e.save(),e.strokeStyle=JE,e.lineWidth=2,e.beginPath(),e.arc(y.x,y.y,T+3,0,2*Math.PI),e.stroke(),e.restore());let C,F;if(u?(C=tw,F=Dv):r?(C=ew,F=Rv):l?(C=nw,F=QE):o?(C=iw,F=Pv):s&&(C=rw,F=Nv),C&&F&&oN(e,y,T,C,F),t.tribeBadge&&rN(e,y,t.tribeBadge,t.isAdult??!1,C??0),f){let D=(t.isAdult?Et:$o)+5;C&&(D+=C),t.tribeBadge&&(D+=Tf),aN(e,y,D)}const B=g&&(S===void 0||t.id===S);B&&t.aiBlackboard&&dh(e,t,m),sN(e,t,m),B&&iN(e,t)}const uN={grazing:"eat",moving:"walk",procreating:"procreate",feeding:"eat",idle:"idle"};function cN(e,t){var d;const{radius:r,position:o,activeAction:l="idle"}=t,s=((d=t.stateMachine)==null?void 0:d[0])||"N/A",u=t.isAdult?Et+20:Et*.6+20;e.save(),e.fillStyle="white",e.font="10px Arial",e.textAlign="center",e.fillText(`Action: ${l}`,o.x,o.y-u),e.fillText(`State: ${s}`,o.x,o.y-u+10),e.fillText(`HP: ${t.hitpoints}`,o.x,o.y-u+20),e.fillText(`Hunger: ${Math.round(t.hunger)}`,o.x,o.y-u+30),e.fillText(`Age: ${Math.round(t.age)}`,o.x,o.y-u+40),e.restore(),e.beginPath(),e.arc(o.x,o.y,r,0,Math.PI*2),e.strokeStyle="rgba(0, 255, 0, 0.5)",e.lineWidth=1,e.stroke(),e.closePath()}function dN(e,t,r=!1,o=0,l){var m,S;const{position:s,activeAction:u="idle"}=t,d=t.isAdult?t.radius:t.radius*.6,f=uN[u]||"idle";if(_S.render(e,s.x-d,s.y-d,d*2,d*2,t.animationProgress||0,f,{gender:t.gender,age:t.age,direction:[((m=t.direction)==null?void 0:m.x)||1,((S=t.direction)==null?void 0:S.y)||0],isPregnant:t.isPregnant??!1,hungryLevel:t.hunger,geneCode:t.geneCode}),t.hitpoints<t.maxHitpoints){const y=d*1.5,E=3,T=s.x-y/2,A=s.y-d-8;e.fillStyle="#555",e.fillRect(T,A,y,E);const C=t.hitpoints/t.maxHitpoints;e.fillStyle=C>.5?"#4CAF50":C>.25?"#FFC107":"#F44336",e.fillRect(T,A,y*C,E)}const g=r&&(l===void 0||t.id===l);g&&t.aiBlackboard&&dh(e,t,o),g&&cN(e,t)}const fN={attacking:"attacking",eating:"eat",moving:"walk",procreating:"procreate",feeding:"eat",idle:"idle"};function hN(e,t){var d;const{radius:r,position:o,activeAction:l="idle"}=t,s=((d=t.stateMachine)==null?void 0:d[0])||"N/A",u=t.isAdult?Et+20:Et*.6+20;e.save(),e.fillStyle="white",e.font="10px Arial",e.textAlign="center",e.fillText(`Action: ${l}`,o.x,o.y-u),e.fillText(`State: ${s}`,o.x,o.y-u+10),e.fillText(`HP: ${t.hitpoints}`,o.x,o.y-u+20),e.fillText(`Hunger: ${Math.round(t.hunger)}`,o.x,o.y-u+30),e.fillText(`Age: ${Math.round(t.age)}`,o.x,o.y-u+40),e.restore(),e.beginPath(),e.arc(o.x,o.y,r,0,Math.PI*2),e.strokeStyle="rgba(255, 0, 0, 0.5)",e.lineWidth=1,e.stroke(),e.closePath()}function gN(e,t,r=!1,o=0,l){var m,S;const{position:s,activeAction:u="idle"}=t,d=t.isAdult?t.radius:t.radius*.6,f=fN[u]||"idle";if(CS.render(e,s.x-d,s.y-d,d*2,d*2,t.animationProgress||0,f,{gender:t.gender,age:t.age,direction:[((m=t.direction)==null?void 0:m.x)||1,((S=t.direction)==null?void 0:S.y)||0],isPregnant:t.isPregnant??!1,hungryLevel:t.hunger,geneCode:t.geneCode}),t.hitpoints<t.maxHitpoints){const y=d*1.5,E=3,T=s.x-y/2,A=s.y-d-8;e.fillStyle="#555",e.fillRect(T,A,y,E);const C=t.hitpoints/t.maxHitpoints;e.fillStyle=C>.5?"#4CAF50":C>.25?"#FFC107":"#F44336",e.fillRect(T,A,y*C,E)}(t.attackCooldown&&t.attackCooldown>0||t.huntCooldown&&t.huntCooldown>0)&&(e.strokeStyle="#FF8C00",e.lineWidth=3,e.beginPath(),e.arc(s.x,s.y,d+3,0,2*Math.PI),e.stroke());const g=r&&(l===void 0||t.id===l);g&&t.aiBlackboard&&dh(e,t,o),g&&hN(e,t)}const RS=15;function C0(e,t,r,o,l=1.5){const s=r-t.startTime,u=Math.min(s/t.duration,1),d=1-u,g=1+Math.sin(u*Math.PI*2)*(l-1),m=RS*g;e.save(),e.globalAlpha=d,e.beginPath(),e.arc(t.position.x,t.position.y,Math.max(0,m),0,Math.PI*2),e.fillStyle=o,e.fill(),e.restore()}function vo(e,t,r,o,l=2){const s=r-t.startTime,u=Math.min(s/t.duration,1),d=1-u,f=RS*2*u;e.save(),e.globalAlpha=d,e.beginPath(),e.arc(t.position.x,t.position.y,f,0,Math.PI*2),e.strokeStyle=o,e.lineWidth=l,e.stroke(),e.restore()}function Gi(e,t,r,o){const l=r-t.startTime,s=Math.min(l/t.duration,1),u=1-s,d=-20*s;e.save(),e.globalAlpha=u,e.font="20px Arial",e.textAlign="center",e.fillText(o,t.position.x,t.position.y+d),e.restore()}function pN(e,t,r){switch(t.type){case ce.Hunger:C0(e,t,r,"rgba(255, 165, 0, 0.7)",1);break;case ce.Procreation:Gi(e,t,r,"");break;case ce.Pregnant:C0(e,t,r,"rgba(255, 105, 180, 0.7)",1.2);break;case ce.TargetAcquired:vo(e,t,r,"rgba(255, 0, 0, 0.8)",3);break;case ce.Attack:Gi(e,t,r,"");break;case ce.Partnered:Gi(e,t,r,"");break;case ce.BushClaimed:vo(e,t,r,"rgba(0, 255, 0, 0.7)",2);break;case ce.BushClaimLost:vo(e,t,r,"rgba(128, 128, 128, 0.7)",2);break;case ce.Eating:Gi(e,t,r,"");break;case ce.ChildFed:Gi(e,t,r,"");break;case ce.AttackDeflected:Gi(e,t,r,"");break;case ce.AttackResisted:Gi(e,t,r,"");break;case ce.Hit:Gi(e,t,r,"");break;case ce.SeizeBuildup:vo(e,t,r,"rgba(255, 215, 0, 0.8)",4);break;case ce.Seize:vo(e,t,r,"rgba(148, 0, 211, 0.8)",4);break;case ce.CallToAttack:vo(e,t,r,"rgba(255, 255, 0, 0.8)",4);break}}function R0(e,t,r,o,l,s,u){e.save();const{position:d}=t;e.strokeStyle=o,e.lineWidth=l+Math.sin(u*s)*(l/2),e.setLineDash([8,8]),e.beginPath(),e.arc(d.x,d.y,r,0,2*Math.PI),e.stroke(),e.restore()}const P0=8,mN=1.5,vN=.5,N0=2,SN="#5a5a5a",yN="#7e7e7e",TN=6;function nf(e){const t=Math.sin(e)*1e4;return t-Math.floor(t)}function PS(e,t,r,o,l){const s=(t+r)*2,u=Math.floor(s/P0),d=-t/2,f=t/2,g=-r/2,m=r/2;for(let S=0;S<u;S++){const y=o+S*13,E=nf(y),T=nf(y+1);let A=S*P0,C=0,F=0;A<t?(C=d+A,F=g):A<t+r?(C=f,F=g+(A-t)):A<t*2+r?(C=f-(A-(t+r)),F=m):(C=d,F=m-(A-(t*2+r)));const B=(T-.5)*N0,D=(nf(y+2)-.5)*N0;e.beginPath();const H=mN+E*vN;e.fillStyle=l||(E>.5?yN:SN),e.ellipse(C+B,F+D,H,H*.85,T*Math.PI,0,Math.PI*2),e.fill(),l||(e.strokeStyle="#2b2b2b",e.lineWidth=1,e.stroke())}}function AN(e,t){if(!t.storedFood||t.storedFood.length===0)return;const{position:r,storedFood:o}=t;e.save(),e.font=`${TN}px Arial`,e.textAlign="center",e.textBaseline="middle",e.shadowColor="rgba(0,0,0,0.5)",e.shadowBlur=2,o.forEach(l=>{const s=bf[l.item.type],u={x:r.x+l.positionOffset.x,y:r.y+l.positionOffset.y};e.fillText(s,u.x,u.y)}),e.shadowBlur=0,e.shadowColor="transparent",e.restore()}function IN(e,t,r){const{position:o,width:l,height:s,constructionProgress:u,destructionProgress:d,isConstructed:f,isBeingDestroyed:g,id:m}=t,S=pa[t.buildingType];e.save(),e.translate(o.x,o.y),f||(e.globalAlpha=.3+u*.7),PS(e,l,s,m),e.globalAlpha=.5,e.font=`${Math.min(l,s,30)*.5}px Arial`,e.textAlign="center",e.textBaseline="middle",e.shadowColor="rgba(0,0,0,0.5)",e.shadowBlur=4,e.fillStyle="#FFFFFF",e.fillText(S.icon,0,0),e.shadowBlur=0,e.restore();const y=l,E=o.x-y/2,T=o.y+s/2+L_;f?g&&Ki(e,E,T,y,l0,1-d,ji,U_):Ki(e,E,T,y,l0,u,ji,F_),t.buildingType==="storageSpot"&&f&&AN(e,t)}function EN(e,t,r,o,l){const s=pa[r],{width:u,height:d}=s.dimensions,f=(m,S)=>{m.save(),m.translate(S.x,S.y),m.globalAlpha=k_;const y=o?"#4CAF50":"#F44336";PS(m,u,d,9999,y),m.font=`${Math.min(u,d)*.5}px Arial`,m.textAlign="center",m.textBaseline="middle",m.fillStyle=y,m.fillText(s.icon,0,0),m.restore()},g={position:{...t},radius:Math.max(u,d)/2,id:0,type:"building",direction:{x:0,y:0},acceleration:0,forces:[],velocity:{x:0,y:0},debuffs:[]};ln(e,l.width,l.height,(m,S)=>f(m,S.position),g)}function wN(e,t,r,o,l){const s=It(t),u=s?Lt(t,s):[],d=vi(u),{width:f,height:g}=t.mapDimensions;Object.values(t.entities.entities).sort((T,A)=>r&&T.id===t.debugCharacterId&&T.id!==A.id||T.type==="building"&&A.type!=="building"?-1:T.position.y-A.position.y||T.id-A.id).filter(T=>Yl(T,o,l,t.mapDimensions)).forEach(T=>{var A,C;if(T.type==="building")ln(e,f,g,IN,T,t,s,t.time);else if(T.type==="berryBush")ln(e,f,g,bP,T,t,s,t.time);else if(T.type==="human"){const F=T,B=F.id===(s==null?void 0:s.id),D=u.some(Ce=>Ce.id===F.id),H=F.id===(d==null?void 0:d.id),x=s&&(F.id===s.motherId||F.id===s.fatherId),U=s&&(((A=F.partnerIds)==null?void 0:A.includes(s.id))||((C=s.partnerIds)==null?void 0:C.includes(F.id))),$=(s==null?void 0:s.attackTargetId)===F.id,ee=F.leaderId?t.entities.entities[F.leaderId]:void 0,_e=s?F.leaderId===s.id&&F.activeAction==="moving"&&F.target===F.leaderId&&(ee==null?void 0:ee.isCallingToFollow):!1;ln(e,f,g,lN,F,B,x,D,U,H,$,_e,r,t.time,t.debugCharacterId)}else T.type==="corpse"?ln(e,f,g,WP,T):T.type==="prey"?ln(e,f,g,dN,T,r,t.time,t.debugCharacterId):T.type==="predator"&&ln(e,f,g,gN,T,r,t.time,t.debugCharacterId)}),t.visualEffects.filter(T=>Yl(T,o,l,t.mapDimensions)).forEach(T=>{ln(e,f,g,pN,T,t.time)});const E=t.notifications.filter(T=>!T.isDismissed);for(const T of E)if(T.highlightedEntityIds&&T.renderHighlights)for(const A of T.highlightedEntityIds){const C=t.entities.entities[A];C&&Yl(C,o,l,t.mapDimensions)&&ln(e,f,g,R0,C,n_,i_,o_,r_,t.time)}if(t.tutorialState.isActive&&t.tutorialState.highlightedEntityIds.length>0)for(const T of t.tutorialState.highlightedEntityIds){const A=t.entities.entities[T];A&&Yl(A,o,l,t.mapDimensions)&&ln(e,f,g,R0,A,zw,bv,Gv,Qf,t.time)}}function _N(e,t,r,o,l,s){let u=null,d=null;e.textAlign="left";let f=Ze+Sn;const m=t.time/(Tt/At)/Eu%1,S=Fs[So.Time],y=25,E=Ze+y;e.fillText(S,Ze,f+rn/2+Sn/3),Ki(e,E,f,Hi,rn,m,ji,dw),f+=rn+li;const T=f+vr/2,A=f+(vr-rn)/2,C=5;ha(e,{x:Ze*2,y:T},vr,5,r.gender,!1,!1,!1);const F=Ze+vr+C,B=Hi+y-(vr+C)*2;Ki(e,F,A,B,rn,Math.floor(r.age)/ra,ji,cw),ha(e,{x:F+B+C+vr/2,y:T},vr,ra,r.gender,!1,!1,!1),f+=rn+li*2;const D=[],H=new Set;if(D.push({member:r,isPlayer:!0,isHeir:!1,isPartner:!1,isParent:!1}),H.add(r.id),o&&!H.has(o.id)&&(D.push({member:o,isPlayer:!1,isHeir:!0,isPartner:!1,isParent:!1}),H.add(o.id)),l.forEach(de=>{H.has(de.id)||(D.push({member:de,isPlayer:!1,isHeir:!1,isPartner:!0,isParent:!1}),H.add(de.id))}),s.forEach(de=>{H.has(de.id)||(D.push({member:de,isPlayer:!1,isHeir:!1,isPartner:!1,isParent:!1}),H.add(de.id))}),r.motherId&&!H.has(r.motherId)){const de=t.entities.entities[r.motherId];de&&(D.push({member:de,isPlayer:!1,isHeir:!1,isPartner:!1,isParent:!0}),H.add(de.id))}if(r.fatherId&&!H.has(r.fatherId)){const de=t.entities.entities[r.fatherId];de&&(D.push({member:de,isPlayer:!1,isHeir:!1,isPartner:!1,isParent:!0}),H.add(de.id))}const x=Fs[So.Family],U=10,$=Ze+Sn+U,ee=Hi+y-(Sn+U),_e=f+Ml/2;e.font=`${Sn}px "Press Start 2P", Arial`,e.textBaseline="middle",e.fillText(x,Ze,_e);const Ce=f+Ml/2;kP(e,$,Ce,D,Ml,ee),f+=Ml+li,e.textBaseline="alphabetic";const be=Fs[So.Hitpoints];e.fillText(be,Ze,f+rn/2+Sn/3),Ki(e,E,f,Hi,rn,r.hitpoints/r.maxHitpoints,ji,uw),f+=rn+li;const Ne=Fs[So.Hunger];e.fillText(Ne,Ze,f+rn/2+Sn/3),Ki(e,E,f,Hi,rn,(Ur-r.hunger)/Ur,ji,lw),u={x:Ze,y:f-li/2,width:Hi+y,height:rn+li},f+=rn+li,e.textBaseline="middle";const Pe=Fs[So.Food];return e.fillText(Pe,Ze,f+Ol/2),YP(e,E,f+Ol/2,r.food,Ol,Hi),d={x:Ze,y:f-li/5,width:Hi+y,height:Ol+li},e.textBaseline="alphabetic",{hungerBarRect:u,foodBarRect:d}}let bs=[],D0=0;const CN=36,RN=200;function PN(e,t,r,o){const l=t.search.prey.count(),s=t.search.predator.count(),u=t.search.berryBush.count();t.time-D0>=CN&&(bs.push({time:t.time,prey:l,predators:s,bushes:u}),bs.length>RN&&(bs=bs.slice(-200)),D0=t.time);const d=et*tt,f=l/d*1e6,g=s/d*1e6,m=u/d*1e6,S=mP(),y=Math.floor(t.time/(24*365)),E=Math.floor(t.time%(24*365)/24),T=Math.floor(t.time%24),A=400,C=Math.min(o*.8,600),F=r-A-10,B=Ze+Sn*2;e.save(),e.fillStyle="rgba(0, 0, 0, 0.9)",e.fillRect(F,B,A,C),e.strokeStyle="#444",e.lineWidth=2,e.strokeRect(F,B,A,C),e.fillStyle="white",e.font="12px monospace",e.textAlign="left";let D=B+20;const H=14,x=F+15;e.fillStyle="#66ccff",e.font="bold 14px monospace",e.fillText(" Ecosystem Debugger",x,D),D+=25,e.fillStyle="white",e.font="12px monospace",e.fillText(`Game Time: Year ${y}, Day ${E}, Hour ${T}`,x,D),D+=H,e.fillText(`Map Size: ${et}  ${tt} pixels`,x,D),D+=20,e.fillStyle="#66ccff",e.font="bold 13px monospace",e.fillText(" Q-Learning Status",x,D),D+=18,S&&(e.fillText(`Q-Table Size: ${S.qTableSize} entries`,x,D),D+=H,e.fillText(`Exploration Rate: ${(S.explorationRate*100).toFixed(1)}%`,x,D),D+=H);const U=bs.slice(-20);U.length>1&&(e.fillStyle="#66ccff",e.font="bold 13px monospace",e.fillText(" Population Trends (Last 20 Points)",x,D),D+=30,NN(e,x,D,U),D+=50),e.fillStyle="#66ccff",e.font="bold 13px monospace",e.fillText(" Density (per 1000 px)",x,D),D+=18,e.fillStyle="white",e.font="12px monospace";const $=(hi/d*1e6).toFixed(2),ee=(gi/d*1e6).toFixed(2),_e=(pi/d*1e6).toFixed(2);e.fillText(`Prey: ${f.toFixed(2)} (target: ${$})`,x,D),D+=H,e.fillText(`Predators: ${g.toFixed(2)} (target: ${ee})`,x,D),D+=H,e.fillText(`Bushes: ${m.toFixed(2)} (target: ${_e})`,x,D),D+=20,e.fillStyle="#66ccff",e.font="bold 13px monospace",e.fillText(" Current Population Status",x,D),D+=18,e.fillStyle="white",e.font="12px monospace";const Ce=Math.round(l/hi*100),be=Math.round(s/gi*100),Ne=Math.round(u/pi*100),Pe=de=>de<50?"#ff4444":de<80?"#ffaa44":de>120?"#44aaff":"#44ff44";e.fillStyle=Pe(Ce),e.fillText(`Prey: ${l}/${hi} (${Ce}%)`,x,D),D+=H,e.fillStyle=Pe(be),e.fillText(`Predators: ${s}/${gi} (${be}%)`,x,D),D+=H,e.fillStyle=Pe(Ne),e.fillText(`Bushes: ${u}/${pi} (${Ne}%)`,x,D),D+=20,e.fillStyle="#66ccff",e.font="bold 13px monospace",e.fillText(" Current Parameters",x,D),D+=18,e.fillStyle="white",e.font="10px monospace",e.fillText("Prey:",x,D),D+=13,e.fillText(` Gestation: ${t.ecosystem.preyGestationPeriod.toFixed(1)}h`,x,D),D+=11,e.fillText(` Procreation: ${t.ecosystem.preyProcreationCooldown.toFixed(1)}h`,x,D),D+=11,e.fillText(` Hunger: ${t.ecosystem.preyHungerIncreasePerHour.toFixed(1)}/h`,x,D),D+=13,e.fillText("Predators:",x,D),D+=13,e.fillText(` Gestation: ${t.ecosystem.predatorGestationPeriod.toFixed(1)}h`,x,D),D+=11,e.fillText(` Procreation: ${t.ecosystem.predatorProcreationCooldown.toFixed(1)}h`,x,D),D+=11,e.fillText(` Hunger: ${t.ecosystem.predatorHungerIncreasePerHour.toFixed(1)}/h`,x,D),D+=13,e.fillText("Bushes:",x,D),D+=13,e.fillText(` Spread Chance: ${(t.ecosystem.berryBushSpreadChance*100).toFixed(1)}%`,x,D),D+=15,e.fillStyle="#888",e.font="10px monospace",e.textAlign="center",e.fillText("Press '1' to toggle this debugger",F+A/2,B+C-10),e.restore()}function NN(e,t,r,o){if(o.length<2)return;const d={prey:Math.max(...o.map(g=>g.prey),hi),predators:Math.max(...o.map(g=>g.predators),gi),bushes:Math.max(...o.map(g=>g.bushes),pi)};[{data:o.map(g=>g.prey),color:"#44ff44",label:"Prey",target:hi,max:d.prey},{data:o.map(g=>g.predators),color:"#ff4444",label:"Predators",target:gi,max:d.predators},{data:o.map(g=>g.bushes),color:"#ffaa44",label:"Bushes",target:pi,max:d.bushes}].forEach((g,m)=>{const S=t+m*115,y=r;e.fillStyle=g.color,e.font="10px monospace",e.fillText(g.label,S,y-5),e.strokeStyle="#333",e.lineWidth=1,e.strokeRect(S,y,100,30),e.beginPath(),e.strokeStyle=g.color;for(let T=0;T<g.data.length;T++){const A=S+T/(g.data.length-1)*100,C=y+30-g.data[T]/g.max*30;T===0?e.moveTo(A,C):e.lineTo(A,C)}e.stroke(),e.beginPath(),e.strokeStyle="#888",e.setLineDash([2,2]);const E=y+30-g.target/g.max*30;e.moveTo(S,E),e.lineTo(S+100,E),e.stroke(),e.setLineDash([])})}function O0(e,t,r){e.save();const{x:o,y:l,width:s,height:u}=t.rect,d=Mv;if(e.beginPath(),e.moveTo(o+d,l),e.lineTo(o+s-d,l),e.quadraticCurveTo(o+s,l,o+s,l+d),e.lineTo(o+s,l+u-d),e.quadraticCurveTo(o+s,l+u,o+s-d,l+u),e.lineTo(o+d,l+u),e.quadraticCurveTo(o,l+u,o,l+u-d),e.lineTo(o,l+d),e.quadraticCurveTo(o,l,o+d,l),e.closePath(),e.fillStyle=t.isDisabled?kv:t.backgroundColor,e.fill(),t.activated){e.save();const f=(Math.sin(Date.now()/1e3*Bv)+1)/2;e.strokeStyle=Lv,e.lineWidth=2+f*2,e.globalAlpha=.7+f*.3,e.stroke(),e.restore()}if(t.lastActivated){const f=Date.now()-t.lastActivated;if(f<du){const g=1-f/du;e.fillStyle=Uv,e.globalAlpha=g,e.fill(),e.globalAlpha=1}}r&&!t.isDisabled&&(e.fillStyle=qf,e.globalAlpha=.5,e.fill(),e.globalAlpha=1),e.fillStyle=t.isDisabled?Fv:t.textColor,t.icon?(e.font=`${u*.55}px "Press Start 2P", Arial`,e.textAlign="center",e.textBaseline="middle",e.fillText(t.icon,o+s/2,l+u/2),t.text&&(e.font=`${u*.18}px "Press Start 2P", Arial`,e.textAlign="right",e.textBaseline="bottom",e.fillText(t.text,o+s-4,l+u-2))):(e.font=`${Sn*1.5}px "Press Start 2P", Arial`,e.textAlign="center",e.textBaseline="middle",e.fillText(t.text,o+s/2,l+u/2)),e.restore()}function DN(e,t,r,o){e.save(),e.fillStyle="rgba(0, 0, 0, 0.6)",e.fillRect(0,0,r,o);const l=500,s=150,u=(r-l)/2,d=(o-s)/2;e.fillStyle=yn,e.font=`${Sn*1.1}px "Press Start 2P", Arial`,e.textAlign="center",e.textBaseline="middle",e.fillText("Are you sure you want to exit",r/2,d+s/3-10),e.fillText("to the main menu?",r/2,d+s/3+10);const f=fi*1.5,g=Ov,m=d+s-g-Ze*2,S=20,y=f*2+S,E=u+(l-y)/2,T={id:"confirmExitYes",action:ge.ConfirmExitYes,rect:{x:E,y:m,width:f,height:g},text:"Yes",backgroundColor:Wi,textColor:yn,currentWidth:f},A=E+f+S,C={id:"confirmExitNo",action:ge.ConfirmExitNo,rect:{x:A,y:m,width:f,height:g},text:"No",backgroundColor:Wi,textColor:yn,currentWidth:f};t.uiButtons.push(T,C),O0(e,T,t.hoveredButtonId===T.id),O0(e,C,t.hoveredButtonId===C.id),e.restore()}function pu(e,t,r,o,l,s=!1){var f;if(e.save(),e.clearRect(0,0,e.canvas.width,e.canvas.height),e.fillStyle="#2c5234",e.fillRect(0,0,e.canvas.width,e.canvas.height),e.translate(e.canvas.width/2-r.x,e.canvas.height/2-r.y),!s&&t.gameOver){e.restore(),BP(e,t);return}wN(e,t,t.debugPanel===Ct.General,r,l);const u=It(t);if(u&&t.selectedBuildingType&&t.selectedBuildingType!=="removal"&&t.mousePosition){const g=Cf(t.mousePosition,r,l,t.mapDimensions),m=rh(g,t.selectedBuildingType,u.leaderId,t);EN(e,g,t.selectedBuildingType,m,t.mapDimensions)}const d=t.notifications.filter(g=>!g.isDismissed);for(const g of d){const m=(Math.sin(t.time*Jw)+1)/2;e.globalAlpha=m*.5+.25,e.fillStyle=Qw,g.targetArea&&e.fillRect(g.targetArea.x,g.targetArea.y,g.targetArea.width,g.targetArea.height),g.targetRadius&&(e.beginPath(),e.arc(g.targetRadius.x,g.targetRadius.y,g.targetRadius.radius,0,Math.PI*2),e.fill())}if(e.globalAlpha=1,KP(e,t),e.restore(),!s){e.fillStyle=ow,e.font=`${Sn}px "Press Start 2P", Arial`,e.shadowColor=sw,e.shadowBlur=aw,t.uiButtons=[];let g=null,m=null;if(u){const E=Lt(t,u),T=vi(E),A=((f=u.partnerIds)==null?void 0:f.map(F=>t.entities.entities[F]).filter(F=>F!==void 0))||[],C=_N(e,t,u,T,A,E);g=C.hungerBarRect,m=C.foodBarRect}const S=_v(t,u==null?void 0:u.leaderId);FP(e,t,S,e.canvas.width,e.canvas.height);const{commandButtonsRect:y}=AP(e,t,e.canvas.width);if(e.shadowColor="transparent",e.shadowBlur=0,u&&(jP(e,t,r,e.canvas.width,e.canvas.height),o.length>0&&_P(e,o,u,r,e.canvas.width,e.canvas.height,t.mapDimensions)),t.tutorialState.activeUIHighlights.length>0){const{activeUIHighlights:E}=t.tutorialState;E.includes(Mr.HUNGER_BAR)&&g&&Qd(e,g,t.time),E.includes(Mr.FOOD_BAR)&&m&&Qd(e,m,t.time),E.includes(Mr.COMMAND_BUTTONS)&&y&&Qd(e,y,t.time)}if(t.tutorialState.isActive){const E=LP(e,t,e.canvas.width,e.canvas.height);E&&t.uiButtons.push({id:"tutorial-dismiss",action:ge.DismissTutorial,rect:E,text:"",currentWidth:E.width,backgroundColor:"transparent",textColor:"transparent"})}switch(qP(e,t,e.canvas.width,e.canvas.height),t.debugPanel){case Ct.Ecosystem:PN(e,t,e.canvas.width,e.canvas.height);break;case Ct.Performance:JP(e,t,l.width);break}t.isPaused&&t.exitConfirmation!=="pending"&&IP(e),t.exitConfirmation==="pending"&&DN(e,t,e.canvas.width,e.canvas.height)}}const ON=In.div`
  position: relative;
  width: 100vw;
  height: 100vh;
  overflow: hidden;
`,MN=In.canvas`
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background-color: #2c5234;
`,kN=In.div`
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  text-align: center;
  z-index: 1;
  background: linear-gradient(to bottom, rgba(0, 0, 0, 0.7) 0%, rgba(0, 0, 0, 0) 50%, rgba(0, 0, 0, 0.7) 100%);
`,FN=In.h1`
  font-family: 'Press Start 2P', cursive;
  font-size: 4rem;
  color: #fff;
  text-shadow: 4px 4px 0px #ff0000;
  margin-bottom: 2rem;
`,M0=In.button`
  font-family: 'Press Start 2P', cursive;
  font-size: 1.5rem;
  padding: 1rem 2rem;
  color: #fff;
  background-color: #ff0000;
  border: 2px solid #fff;
  box-shadow: 4px 4px 0px #fff;
  cursor: pointer;
  transition: all 0.2s ease-in-out;

  &:hover {
    background-color: #fff;
    color: #ff0000;
    box-shadow: 4px 4px 0px #ff0000;
  }
`,UN=In.div`
  display: flex;
  flex-direction: column;
  gap: 1.5rem;
  align-items: center;
`,LN=In.div`
  position: absolute;
  bottom: 1rem;
  font-family: 'Press Start 2P', cursive;
  font-size: 0.8rem;
  color: #fff;
  text-shadow: 2px 2px 0px #000;
  a {
    color: #fff;
    text-decoration: none;
    &:hover {
      text-decoration: underline;
    }
  }
`,Xl="intro-soundtrack",k0=()=>{const{setAppState:e,savedGameState:t,clearCurrentSave:r}=Go(),o=Re.useRef(null),l=Re.useRef(null),s=Re.useRef(CR()),u=Re.useRef(),d=Re.useRef(s.current.viewportCenter),f=Re.useRef(),g=Re.useCallback(()=>{Hd(Xl,2),r(),e("game")},[e,r]),m=Re.useCallback(()=>{t&&(Hd(Xl,2),e("game"))},[e,t]);Re.useEffect(()=>{const E=T=>{(T.key==="Enter"||T.key===" ")&&(t?m():g())};return window.addEventListener("keydown",E),()=>{window.removeEventListener("keydown",E)}},[g,m,t]),Re.useEffect(()=>(eh(fe.SoundTrack1,{loop:!0,trackId:Xl}),()=>{Hd(Xl,2)}),[]),Re.useEffect(()=>{const E=o.current;if(!E)return;l.current=E.getContext("2d");const T=()=>{E&&l.current&&(E.width=window.innerWidth,E.height=window.innerHeight,pu(l.current,s.current,d.current,[],{width:E.width,height:E.height},!0))};return T(),window.addEventListener("resize",T),()=>window.removeEventListener("resize",T)},[]),Re.useEffect(()=>{const E=()=>{const A=Cv(s.current);if(A.length>0){const C=Math.floor(Math.random()*A.length);f.current=A[C].id}};E();const T=setInterval(E,eI);return()=>clearInterval(T)},[]);const[S,y]=cv(E=>{var C,F;if(!l.current)return;if(u.current===void 0){u.current=E;return}const T=Math.min((E-u.current)/1e3,1);s.current=Pu(s.current,T);const A=f.current?s.current.entities.entities[f.current]:void 0;if(A){const{mapDimensions:B}=s.current,{width:D,height:H}=B;let x={...A.position};const U=x.x-d.current.x;Math.abs(U)>D/2&&(U>0?x.x-=D:x.x+=D);const $=x.y-d.current.y;Math.abs($)>H/2&&($>0?x.y-=H:x.y+=H);let ee=jf(d.current,x,Hf*T);ee={x:(ee.x%D+D)%D,y:(ee.y%H+H)%H},d.current=ee}pu(l.current,s.current,d.current,[],{width:((C=o.current)==null?void 0:C.width)||800,height:((F=o.current)==null?void 0:F.height)||600},!0),u.current=E});return Re.useEffect(()=>(y(),S),[y,S]),Fe.jsxs(ON,{children:[Fe.jsx(MN,{ref:o}),Fe.jsxs(kN,{children:[Fe.jsx(FN,{children:"Tribe2"}),Fe.jsxs(UN,{children:[Fe.jsx(M0,{onClick:g,children:"New Game"}),t&&Fe.jsx(M0,{onClick:m,children:"Load Game"})]}),Fe.jsxs(LN,{children:["by"," ",Fe.jsx("a",{href:"https://github.com/gtanczyk",target:"_blank",rel:"noopener noreferrer",children:"gtanczyk"})]})]})]})};function BN(){console.log("Tribe game initialized with detailed 2D world state.");const e=_R();return e.ecosystem={preyGestationPeriod:Rr,preyProcreationCooldown:Pr,predatorGestationPeriod:Nr,predatorProcreationCooldown:Dr,preyHungerIncreasePerHour:Vi,predatorHungerIncreasePerHour:Xi,berryBushSpreadChance:mi},e.debugPanel=Ct.None,e.performanceMetrics={currentBucket:{renderTime:0,worldUpdateTime:0,aiUpdateTime:0},history:[]},e}const HN=({canvasRef:e,ctxRef:t,gameStateRef:r,viewportCenterRef:o,playerActionHintsRef:l})=>(Re.useEffect(()=>{const s=e.current;if(!s)return;t.current=s.getContext("2d");const u=()=>{s&&t.current&&r.current&&(s.width=window.innerWidth,s.height=window.innerHeight,pu(t.current,r.current,o.current,l.current,{width:s.width,height:s.height},!1))};return u(),window.addEventListener("resize",u),()=>window.removeEventListener("resize",u)},[]),Fe.jsx("canvas",{ref:e,style:{display:"block",background:"#2c5234"}})),bN=(e,t,r,o=!1)=>{let l;const s=ZE(e,r);if(s){if(t.isAdult&&s.type==="berryBush"&&s.food.length>0)l={action:se.AutopilotGather,targetEntityId:s.id};else if(t.isAdult&&s.type==="corpse"&&s.food.length>0)l={action:se.AutopilotGather,targetEntityId:s.id};else if(s.type==="human"){const u=s;t.isAdult&&zo(t,u,r)?l={action:se.AutopilotAttack,targetEntityId:u.id}:Hr(t,u,r)?l={action:se.AutopilotProcreate,targetEntityId:u.id}:t.food.length>0&&!u.isAdult&&(u.motherId===t.id||u.fatherId===t.id)&&(l={action:se.AutopilotFeedChild,targetEntityId:u.id})}else if(s.type==="prey")l={action:se.AutopilotAttack,targetEntityId:s.id};else if(s.type==="predator")l={action:se.AutopilotAttack,targetEntityId:s.id};else if(s.type==="building"){const u=s;if(r.selectedBuildingType==="removal")l={action:se.Removal,position:s.position};else if(u.buildingType==="storageSpot"){const d=u.ownerId===t.leaderId,f=u.storedFood!==void 0&&u.storedFood.length>0,g=u.storedFood!==void 0&&u.storageCapacity!==void 0&&u.storedFood.length<u.storageCapacity;if(o&&u.isConstructed&&f&&t.food.length<t.maxFood)if(d)l={action:se.AutopilotRetrieve,targetEntityId:s.id};else{const m=t.leaderId?r.entities.entities[t.leaderId]:void 0;m&&m.diplomacy?m.diplomacy[u.ownerId]===yt.Hostile?l={action:se.AutopilotGather,targetEntityId:s.id}:l={action:se.AutopilotMove,position:e}:l={action:se.AutopilotMove,position:e}}else d&&u.isConstructed?t.food.length>0&&g?l={action:se.AutopilotDeposit,targetEntityId:s.id}:t.food.length<t.maxFood&&f?l={action:se.AutopilotRetrieve,targetEntityId:s.id}:l={action:se.AutopilotMove,position:e}:l={action:se.AutopilotMove,position:e}}else u.buildingType==="plantingZone"&&t.food.filter(d=>d.type===Ln.Berry).length>=kr&&!Hn(e,r,Fr)?l={action:se.AutopilotPlant,position:e}:l={action:se.AutopilotMove,position:e}}}else t.food.filter(u=>u.type===Ln.Berry).length>=kr&&(r.autopilotControls.isManuallyPlanting||Q_(e,t,r))?l={action:se.AutopilotPlant,position:e}:l={action:se.AutopilotMove,position:e};return l},GN=(e,t)=>{if(e.isPaused)return;const r=It(e);if(!r)return;if(e.selectedBuildingType&&e.selectedBuildingType!=="removal"){rh(t,e.selectedBuildingType,r.leaderId,e)&&(Kv(t,e.selectedBuildingType,r.leaderId,e),e.selectedBuildingType=null);return}if(e.selectedBuildingType==="removal"){const l=G_(t,e);l&&b_(l.id,e);return}const o=e.autopilotControls.hoveredAutopilotAction;e.autopilotControls.activeAutopilotAction=void 0,o?(e.autopilotControls.activeAutopilotAction=o,(o.action===se.AutopilotMove||o.action===se.AutopilotGather)&&(e.hasPlayerMovedEver=!0),o.action===se.AutopilotPlant&&(e.hasPlayerPlantedBush=!0)):e.autopilotControls.activeAutopilotAction={action:se.AutopilotMove,position:t},e.autopilotControls.isManuallyMoving=!1,e.autopilotControls.isManuallyPlanting=!1},xN=(e,t)=>{var u,d,f,g;const r=e.key.toLowerCase(),o=e.ctrlKey||e.metaKey;let l=!0,s=t;if(o){switch(r){case"s":Df(t);break;default:l=!1;break}return{newState:s,handled:l}}switch(r){case"escape":const{autopilotControls:m}=t;m.activeAutopilotAction||m.isManuallyMoving||m.isManuallyPlanting||t.buildMenuOpen||t.selectedBuildingType?(m.activeAutopilotAction=void 0,m.isManuallyMoving=!1,m.isManuallyPlanting=!1,t.buildMenuOpen=!1,t.selectedBuildingType=null):s.exitConfirmation==="pending"?(s.exitConfirmation="inactive",s.isPaused=!1):(s.exitConfirmation="pending",s.isPaused=!0);break;case"m":t.isMuted=!t.isMuted,Vs(t.masterVolume,t.isMuted);break;case"=":case"+":const S=Math.min(1,t.masterVolume+.1);t.masterVolume=parseFloat(S.toFixed(1)),Vs(t.masterVolume,t.isMuted);break;case"-":const y=Math.max(0,t.masterVolume-.1);t.masterVolume=parseFloat(y.toFixed(1)),Vs(t.masterVolume,t.isMuted);break;case"t":s=Pu(t,Wv);break;case" ":case"p":t.isPaused=!t.isPaused;break;case"":case"`":s.debugPanel===Ct.General?(s.debugPanel=Ct.None,s.debugCharacterId=void 0):(s.debugPanel=Ct.General,s.debugCharacterId||(s.debugCharacterId=((u=It(s))==null?void 0:u.id)??((d=Object.values(s.entities.entities).find(T=>T.type==="human"||T.type==="prey"||T.type==="predator"))==null?void 0:d.id)));break;case"!":if(e.shiftKey){if(s.debugPanel===Ct.Ecosystem){s.debugPanel=Ct.None;break}s.debugPanel=Ct.Ecosystem,s.debugCharacterId||(s.debugCharacterId=((f=It(s))==null?void 0:f.id)??((g=Object.values(s.entities.entities).find(T=>T.type==="human"||T.type==="prey"||T.type==="predator"))==null?void 0:g.id))}else l=!1;break;case"@":if(e.shiftKey){if(s.debugPanel===Ct.Performance){s.debugPanel=Ct.None;break}s.debugPanel=Ct.Performance}else l=!1;break;case"tab":s.debugPanel=Ct.General;const E=Object.values(s.entities.entities).filter(T=>T.type==="human"||T.type==="prey"||T.type==="predator");if(E.length>0){const T=E.sort((B,D)=>{if(B.type==="human"&&B.isPlayer)return-1;if(D.type==="human"&&D.isPlayer)return 1;if(B.type!==D.type){const H={human:0,prey:1,predator:2},x=H[B.type]??999,U=H[D.type]??999;return x-U}return B.id-D.id}),A=s.debugCharacterId,F=((A?T.findIndex(B=>B.id===A):-1)+1)%T.length;s.debugCharacterId=T[F].id}else s.debugCharacterId=void 0;break;default:l=!1;break}return{newState:s,handled:l}},$N=(e,t,r,o,l)=>{const s={gameState:r};if(t&&["e","b","r","h"].includes(e)&&r.hasPlayerEnabledAutopilot++,r.buildMenuOpen){if(e==="1"){r.selectedBuildingType="storageSpot",Ie(s,fe.ButtonClick,o.position);return}else if(e==="2"){r.selectedBuildingType="plantingZone",Ie(s,fe.ButtonClick,o.position);return}else if(e==="3"){r.selectedBuildingType="removal",Ie(s,fe.ButtonClick,o.position);return}}if(e==="escape"&&r.selectedBuildingType){r.selectedBuildingType=null;return}if(e==="e"){if(t){r.autopilotControls.behaviors.gathering=!r.autopilotControls.behaviors.gathering;return}const u=Oe(o,r,"berryBush",Rt,g=>g.food.length>0&&o.food.length<o.maxFood),d=Oe(o,r,"corpse",Rt,g=>g.food.length>0&&o.food.length<o.maxFood);let f=null;u&&d?f=V(o.position,u.position,r.mapDimensions.width,r.mapDimensions.height)<=V(o.position,d.position,r.mapDimensions.width,r.mapDimensions.height)?u:d:f=u||d,f&&(o.activeAction="gathering",Ie(s,fe.Gather,o.position))}else if(e==="r"){if(t){r.autopilotControls.behaviors.procreation=!r.autopilotControls.behaviors.procreation;return}Oe(o,r,"human",Rt,d=>Hr(o,d,r))&&(o.activeAction="procreating",Ie(s,fe.Procreate,o.position))}else if(e==="f")o.food.length>0&&(o.activeAction="eating",Ie(s,fe.Eat,o.position));else if(e==="h"){if(t){r.autopilotControls.behaviors.feedChildren=!r.autopilotControls.behaviors.feedChildren;return}const u=l.find(d=>d.type===se.FeedChild);u&&u.targetEntity&&(o.activeAction="feeding",o.target=u.targetEntity.id)}else if(e==="arrowup"||e==="w")o.direction.y=-1,o.activeAction="moving",o.target=void 0,r.hasPlayerMovedEver=!0,r.autopilotControls.isManuallyMoving=!0,r.autopilotControls.activeAutopilotAction=void 0;else if(e==="arrowdown"||e==="s")o.direction.y=1,o.activeAction="moving",o.target=void 0,r.hasPlayerMovedEver=!0,r.autopilotControls.isManuallyMoving=!0,r.autopilotControls.activeAutopilotAction=void 0;else if(e==="arrowleft"||e==="a")o.direction.x=-1,o.activeAction="moving",o.target=void 0,r.hasPlayerMovedEver=!0,r.autopilotControls.isManuallyMoving=!0,r.autopilotControls.activeAutopilotAction=void 0;else if(e==="arrowright"||e==="d")o.direction.x=1,o.activeAction="moving",o.target=void 0,r.hasPlayerMovedEver=!0,r.autopilotControls.isManuallyMoving=!0,r.autopilotControls.activeAutopilotAction=void 0;else if(e==="q"){if(t){r.autopilotControls.behaviors.attack=!r.autopilotControls.behaviors.attack;return}const u=Oe(o,r,"human",Jn,d=>zo(o,d,r))??Oe(o,r,"predator",Jn)??Oe(o,r,"prey",Jn);u&&(o.activeAction="attacking",o.attackTargetId=u.id)}else if(e==="b"){if(t){r.autopilotControls.behaviors.planting=!r.autopilotControls.behaviors.planting;return}if(l.find(d=>d.type===se.Plant)){const d=xE(o.position,r,50,mf);d&&(o.activeAction="planting",o.target=d,r.hasPlayerPlantedBush=!0)}}else if(e==="x"){if(t){r.autopilotControls.behaviors.gathering=!r.autopilotControls.behaviors.gathering;return}const u=Oe(o,r,"building",An,d=>{const f=d;return f.buildingType==="storageSpot"&&f.ownerId===o.leaderId&&f.isConstructed&&f.storedFood!==void 0&&f.storageCapacity!==void 0&&f.storedFood.length<f.storageCapacity});u&&(o.activeAction="idle",o.target=u.id,Ie(s,fe.StorageDeposit,o.position))}else if(e==="z"){if(t){r.autopilotControls.behaviors.feedChildren=!r.autopilotControls.behaviors.feedChildren;return}const u=Oe(o,r,"building",An,d=>{const f=d;return f.buildingType==="storageSpot"&&f.ownerId===o.leaderId&&f.isConstructed&&f.storedFood!==void 0&&f.storedFood.length>0});u&&(o.activeAction="idle",o.target=u.id,Ie(s,fe.StorageRetrieve,o.position))}else e==="v"?(o.isCallingToAttack=!0,o.callToAttackEndTime=r.time+Lo,Me(r,ce.CallToAttack,o.position,Lo),Ie(s,fe.CallToAttack,o.position)):e==="c"?(o.isCallingToFollow=!0,o.callToFollowEndTime=r.time+sa,Me(r,ce.CallToFollow,o.position,sa),Ie(s,fe.CallToFollow,o.position)):e==="k"?nh(o,r):e==="l"&&(r.buildMenuOpen=!r.buildMenuOpen,Ie(s,fe.ButtonClick,o.position))},zN=(e,t,r,o)=>{e==="arrowup"||e==="w"||e==="arrowdown"||e==="s"?t.direction.y=0:(e==="arrowleft"||e==="a"||e==="arrowright"||e==="d")&&(t.direction.x=0),!o.current.has("arrowup")&&!o.current.has("arrowdown")&&!o.current.has("arrowleft")&&!o.current.has("arrowright")&&!o.current.has("w")&&!o.current.has("a")&&!o.current.has("s")&&!o.current.has("d")&&(t.activeAction==="moving"&&(t.activeAction="idle"),r.autopilotControls.isManuallyMoving=!1),!o.current.has("e")&&t.activeAction==="gathering"&&(t.activeAction="idle"),!o.current.has("f")&&t.activeAction==="eating"&&(t.activeAction="idle"),!o.current.has("r")&&t.activeAction==="procreating"&&(t.activeAction="idle"),!o.current.has("h")&&t.activeAction==="feeding"&&(t.activeAction="idle")},WN=(e,t,r)=>{let l=It(e);if(e.debugCharacterId){const s=e.entities.entities[e.debugCharacterId];s&&"position"in s&&(l=s)}if(l){const{mapDimensions:s}=e,{width:u,height:d}=s;let f={...l.position};const g=f.x-t.x;Math.abs(g)>u/2&&(g>0?f.x-=u:f.x+=u);const m=f.y-t.y;Math.abs(m)>d/2&&(m>0?f.y-=d:f.y+=d);let S=jf(t,f,Hf*r);return S={x:(S.x%u+u)%u,y:(S.y%d+d)%d},S}return e.viewportCenter};function YN(e,t){const{width:r,height:o}=e.mapDimensions;e.viewportCenter={x:(t.x%r+r)%r,y:(t.y%o+o)%o}}const jN=(e,t,r,o)=>{const l={gameState:r},s=It(r);s&&Ie(l,fe.ButtonClick,s.position);const u=r.uiButtons.find(f=>f.id===e.id);u&&(u.lastActivated=Date.now()),t&&[ge.CommandGather,ge.CommandPlant,ge.ToggleProcreationBehavior].includes(e.action)&&r.hasPlayerEnabledAutopilot++;const{behaviors:d}=r.autopilotControls;switch(e.action){case ge.ReturnToIntro:r.exitConfirmation="pending",r.isPaused=!0;break;case ge.ConfirmExitYes:o(),r.exitConfirmation="inactive";break;case ge.ConfirmExitNo:r.exitConfirmation="inactive",r.isPaused=!1;break;case ge.ToggleMute:r.isMuted=!r.isMuted,Vs(r.masterVolume,r.isMuted);break;case ge.TogglePause:r.isPaused=!r.isPaused;break;case ge.FastForward:return Pu(r,Wv);case ge.DismissTutorial:r.tutorialState.isActive=!1;break;case ge.CommandEat:s&&s.food.length>0&&(s.activeAction="eating");break;case ge.CommandGather:t?d.gathering=!d.gathering:s&&(s.activeAction="gathering");break;case ge.CommandPlant:t?d.planting=!d.planting:s&&(r.autopilotControls.isManuallyPlanting=!0);break;case ge.ToggleProcreationBehavior:d.procreation=!d.procreation;break;case ge.ToggleAttackBehavior:d.attack=!d.attack;break;case ge.ToggleFeedChildBehavior:d.feedChildren=!d.feedChildren;break;case ge.ToggleAutopilotFollowLeaderBehavior:d.followLeader=!d.followLeader;break;case ge.CommandCallToAttack:s&&s.leaderId===s.id&&(s.isCallingToAttack=!0,s.callToAttackEndTime=r.time+Lo,Me(r,ce.CallToAttack,s.position,Lo),Ie(l,fe.CallToAttack,s.position));break;case ge.CommandFollowMe:t?d.followLeader=!d.followLeader:s&&s.leaderId===s.id&&(s.isCallingToFollow=!0,s.callToFollowEndTime=r.time+sa,Me(r,ce.CallToFollow,s.position,sa),Ie(l,fe.CallToFollow,s.position));break;case ge.CommandTribeSplit:s&&nh(s,r);break;case ge.CommandBuild:r.buildMenuOpen=!r.buildMenuOpen;break;case ge.SelectStorageSpot:r.selectedBuildingType="storageSpot";break;case ge.SelectPlantingZone:r.selectedBuildingType="plantingZone";break;case ge.SelectRemovalTool:r.selectedBuildingType="removal";break;case ge.ToggleDiplomacy:if(s&&s.leaderId&&e.targetTribeId){const f=s.leaderId,g=e.targetTribeId,m=r.entities.entities[g],S=s.diplomacy,y=m==null?void 0:m.diplomacy;if(S&&y){const T=(S[g]||yt.Friendly)===yt.Friendly?yt.Hostile:yt.Friendly;S[g]=T,y[f]=T}}break}return r};function VN(e,t,r){if(!e.notificationButtonRects)return!1;const o=It(e);for(const[l,s]of Object.entries(e.notificationButtonRects.dismiss))if(t>=s.x&&t<=s.x+s.width&&r>=s.y&&r<=s.y+s.height)return g_(e,l),o&&Ie({gameState:e},fe.ButtonClick,o.position),!0;for(const[l,s]of Object.entries(e.notificationButtonRects.view))if(t>=s.x&&t<=s.x+s.width&&r>=s.y&&r<=s.y+s.height){const u=e.notifications.find(d=>d.id===l);if(u){let d=u.targetPosition;if(!d&&u.targetEntityIds&&u.targetEntityIds.length>0){const f=e.entities.entities[u.targetEntityIds[0]];f&&(d=f.position)}return d&&YN(e,d),o&&Ie({gameState:e},fe.ButtonClick,o.position),u.highlightedEntityIds&&(u.renderHighlights=!u.renderHighlights),!0}}return!1}const XN=({isActive:e,gameStateRef:t,canvasRef:r,viewportCenterRef:o,playerActionHintsRef:l,keysPressed:s,returnToIntro:u})=>(Re.useEffect(()=>{const d=f=>{if(!e()||t.current.gameOver||!r.current||!f.target||f.target!==r.current)return;const g=r.current.getBoundingClientRect(),m=f.clientX-g.left,S=f.clientY-g.top;if(VN(t.current,m,S))return;const E=t.current.uiButtons.find(A=>m>=A.rect.x&&m<=A.rect.x+A.rect.width&&S>=A.rect.y&&S<=A.rect.y+A.rect.height);if(E){t.current=jN(E,f.shiftKey,t.current,u);return}const T=Cf({x:m,y:S},o.current,{width:r.current.width,height:r.current.height},t.current.mapDimensions);GN(t.current,T)};return window.addEventListener("mousedown",d),()=>{window.removeEventListener("mousedown",d)}},[e,r,t,o,u]),Re.useEffect(()=>{const d=f=>{if(!e()||!r.current)return;const g=r.current.getBoundingClientRect(),m=f.clientX-g.left,S=f.clientY-g.top;t.current.mousePosition={x:m,y:S};let y;if(t.current.notificationButtonRects){for(const[T,A]of Object.entries(t.current.notificationButtonRects.dismiss))if(m>=A.x&&m<=A.x+A.width&&S>=A.y&&S<=A.y+A.height){y=`notification-dismiss-${T}`;break}if(!y){for(const[T,A]of Object.entries(t.current.notificationButtonRects.view))if(m>=A.x&&m<=A.x+A.width&&S>=A.y&&S<=A.y+A.height){y=`notification-view-${T}`;break}}}if(!y)for(let T=t.current.uiButtons.length-1;T>=0;T--){const A=t.current.uiButtons[T];if(m>=A.rect.x&&m<=A.rect.x+A.rect.width&&S>=A.rect.y&&S<=A.rect.y+A.rect.height){y=A.id;break}}if(t.current.hoveredButtonId=y,y){t.current.autopilotControls.hoveredAutopilotAction=void 0;return}const E=It(t.current);if(E){const T=Cf({x:m,y:S},o.current,{width:r.current.width,height:r.current.height},t.current.mapDimensions);t.current.autopilotControls.hoveredAutopilotAction=bN(T,E,t.current,f.shiftKey)}else t.current.autopilotControls.hoveredAutopilotAction=void 0};return window.addEventListener("mousemove",d),()=>{window.removeEventListener("mousemove",d)}},[e,r,t,o]),Re.useEffect(()=>{const d=g=>{if(!e()||t.current.gameOver)return;const m=g.key.toLowerCase();(m===" "||m==="p"||m==="tab"||(g.ctrlKey||g.metaKey)&&(m==="s"||m==="a"))&&g.preventDefault();const S=xN(g,t.current);if(t.current=S.newState,S.handled)return;const y=It(t.current);y&&(s.current.add(m),$N(m,g.shiftKey,t.current,y,l.current))},f=g=>{if(!e()||t.current.gameOver)return;const m=g.key.toLowerCase();s.current.delete(m);const S=It(t.current);S&&zN(m,S,t.current,s)};return window.addEventListener("keydown",d),window.addEventListener("keyup",f),()=>{window.removeEventListener("keydown",d),window.removeEventListener("keyup",f)}},[e,t,l,s,u]),null),KN=({gameStateRef:e,ctxRef:t,debugPanelTypeRef:r,viewportCenterRef:o,playerActionHintsRef:l,keysPressed:s,canvasRef:u,setAppState:d,appState:f})=>{const g=Re.useRef(),{returnToIntro:m}=Go(),[S,y,E]=cv(T=>{var H,x;if(!t.current||!g.current){g.current=T;return}const A=Math.min(T-g.current,1e3)/1e3,{performanceMetrics:C}=e.current;C.currentBucket={renderTime:0,worldUpdateTime:0,aiUpdateTime:0};const F=performance.now();e.current=Pu(e.current,A),C.currentBucket.worldUpdateTime=performance.now()-F;const B=It(e.current);B?l.current=ih(e.current,B):l.current=[],o.current=WN(e.current,o.current,A);const D=performance.now();pu(t.current,e.current,o.current,l.current,{width:((H=u.current)==null?void 0:H.width)||800,height:((x=u.current)==null?void 0:x.height)||600},!1),C.currentBucket.renderTime=performance.now()-D,C.history.push({bucketTime:e.current.time,...C.currentBucket}),C.history.length>tI&&C.history.shift(),g.current=T,e.current.gameOver&&f!=="gameOver"&&(eh(fe.GameOver,{masterVolume:e.current.masterVolume,isMuted:e.current.isMuted}),d("gameOver",{generations:e.current.generationCount,cause:e.current.causeOfGameOver||"Unknown"}))});return Re.useEffect(()=>(y(),S),[y,S]),Fe.jsx(XN,{isActive:E,gameStateRef:e,canvasRef:u,viewportCenterRef:o,playerActionHintsRef:l,debugPanelTypeRef:r,keysPressed:s,returnToIntro:m})},F0=()=>{const{savedGameState:e,contextReady:t}=Go(),[r,o]=Re.useState(null);return Re.useEffect(()=>{t&&(e?(console.log("Loading saved game state..."),o(e)):(console.log("Initializing new game state..."),o(BN())))},[t,e]),!t||!r?Fe.jsx("div",{children:"Loading..."}):Fe.jsx(ZN,{initialState:r})},ZN=({initialState:e})=>{const t=Re.useRef(null),r=Re.useRef(null),o=Re.useRef(e),l=Re.useRef(new Set),s=Re.useRef(e.debugPanel),u=Re.useRef(e.viewportCenter),d=Re.useRef([]),{appState:f,setAppState:g}=Go();return Fe.jsxs(Fe.Fragment,{children:[Fe.jsx(HN,{canvasRef:t,ctxRef:r,gameStateRef:o,debugPanelTypeRef:s,viewportCenterRef:u,playerActionHintsRef:d}),Fe.jsx(KN,{gameStateRef:o,ctxRef:r,debugPanelTypeRef:s,viewportCenterRef:u,playerActionHintsRef:d,keysPressed:l,canvasRef:t,setAppState:g,appState:f})]})},qN=In.div`
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  text-align: center;
  background-color: rgba(0, 0, 0, 0.75); // Semi-transparent overlay
  color: #fff;
  padding: 20px;
  z-index: 10; // Ensure it's on top
`,QN=In.h1`
  font-family: 'Press Start 2P', cursive;
  font-size: 4rem;
  color: #ff4136; // Red for emphasis
  text-shadow: 4px 4px 0px #000;
  margin-bottom: 1.5rem;
`,Kl=In.p`
  font-family: 'Press Start 2P', cursive;
  font-size: 1.2rem;
  margin: 0.5em 0;
  color: #fff;
  text-shadow: 2px 2px 0px #000;
`,JN=In.button`
  font-family: 'Press Start 2P', cursive;
  font-size: 1rem;
  padding: 1rem 2rem;
  margin-top: 2em;
  color: #fff;
  background-color: #ff4136; // Red button
  border: 2px solid #fff;
  box-shadow: 4px 4px 0px #fff;
  cursor: pointer;
  transition: all 0.2s ease-in-out;
  text-transform: uppercase;

  &:hover {
    background-color: #fff;
    color: #ff4136;
    box-shadow: 4px 4px 0px #ff4136;
  }
`,eD=()=>{const{setAppState:e,gameOverDetails:t}=Go(),r=()=>{e("intro")};return Fe.jsxs(qN,{children:[Fe.jsx(QN,{children:"Game Over"}),Fe.jsx(Kl,{children:"Your tribe's lineage has ended."}),t&&Fe.jsxs(Fe.Fragment,{children:[Fe.jsxs(Kl,{children:["Generations Survived: ",t.generations]}),Fe.jsxs(Kl,{children:["Cause of Extinction: ",t.cause]})]}),!t&&Fe.jsx(Kl,{children:"Game details are unavailable."}),Fe.jsx(JN,{onClick:r,children:"Return to Menu"})]})},tD=XA`
  /* CSS Reset */
  *, *::before, *::after {
    box-sizing: border-box;
  }

  body {
    margin: 0;
    padding: 0;
    font-family: 'Press Start 2P', 'Arial', sans-serif;
    background-color: #121212;
    color: #f0f0f0;
    line-height: 1.6;
  }

  /* Additional global styles */
  h1, h2, h3, h4, h5, h6 {
    margin-top: 0;
  }

  button {
    cursor: pointer;
    font-family: inherit;
  }

  /* Prevent overflow issues */
  html, body {
    height: 100%;
    overflow-x: hidden;
  }

  /* Root element for React app */
  #root {
    height: 100%;
  }
`;function nD(e,t){Re.useEffect(()=>{const r=()=>{const o=document.location.hash==="#game"?"game":"intro";t(o)};return window.addEventListener("hashchange",r),r(),()=>{window.removeEventListener("hashchange",r)}},[]),Re.useEffect(()=>{e==="game"?document.location.hash="#game":e==="intro"&&(document.location.hash="")},[e])}const iD=()=>{const{appState:e,setAppState:t}=Go();nD(e,t);const r=()=>{switch(e){case"intro":return Fe.jsx(k0,{});case"game":return Fe.jsx(F0,{});case"gameOver":return Fe.jsxs(Fe.Fragment,{children:[Fe.jsx(F0,{}),Fe.jsx(eD,{})]});default:return Fe.jsx(k0,{})}};return Fe.jsxs(Fe.Fragment,{children:[Fe.jsx(tD,{}),r()]})},U0=document.getElementById("root");U0?R_().then(()=>{LT.createRoot(U0).render(Fe.jsx(Qn.StrictMode,{children:Fe.jsx(VT,{initialAppState:document.location.hash==="#game"?"game":"intro",children:Fe.jsx(iD,{})})}))}):console.error("Failed to find the root element");
