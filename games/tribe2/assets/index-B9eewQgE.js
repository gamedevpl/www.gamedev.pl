var LT=Object.defineProperty;var UT=(e,t,i)=>t in e?LT(e,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[t]=i;var Oe=(e,t,i)=>UT(e,typeof t!="symbol"?t+"":t,i);(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const l of document.querySelectorAll('link[rel="modulepreload"]'))o(l);new MutationObserver(l=>{for(const s of l)if(s.type==="childList")for(const u of s.addedNodes)u.tagName==="LINK"&&u.rel==="modulepreload"&&o(u)}).observe(document,{childList:!0,subtree:!0});function i(l){const s={};return l.integrity&&(s.integrity=l.integrity),l.referrerPolicy&&(s.referrerPolicy=l.referrerPolicy),l.crossOrigin==="use-credentials"?s.credentials="include":l.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function o(l){if(l.ep)return;l.ep=!0;const s=i(l);fetch(l.href,s)}})();function Y0(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var Pd={exports:{}},Us={},Nd={exports:{}},Be={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var um;function BT(){if(um)return Be;um=1;var e=Symbol.for("react.element"),t=Symbol.for("react.portal"),i=Symbol.for("react.fragment"),o=Symbol.for("react.strict_mode"),l=Symbol.for("react.profiler"),s=Symbol.for("react.provider"),u=Symbol.for("react.context"),d=Symbol.for("react.forward_ref"),f=Symbol.for("react.suspense"),g=Symbol.for("react.memo"),m=Symbol.for("react.lazy"),v=Symbol.iterator;function y(P){return P===null||typeof P!="object"?null:(P=v&&P[v]||P["@@iterator"],typeof P=="function"?P:null)}var I={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},E=Object.assign,A={};function w(P,U,K){this.props=P,this.context=U,this.refs=A,this.updater=K||I}w.prototype.isReactComponent={},w.prototype.setState=function(P,U){if(typeof P!="object"&&typeof P!="function"&&P!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,P,U,"setState")},w.prototype.forceUpdate=function(P){this.updater.enqueueForceUpdate(this,P,"forceUpdate")};function F(){}F.prototype=w.prototype;function B(P,U,K){this.props=P,this.context=U,this.refs=A,this.updater=K||I}var D=B.prototype=new F;D.constructor=B,E(D,w.prototype),D.isPureReactComponent=!0;var H=Array.isArray,b=Object.prototype.hasOwnProperty,L={current:null},$={key:!0,ref:!0,__self:!0,__source:!0};function Q(P,U,K){var ne,ve={},le=null,Ee=null;if(U!=null)for(ne in U.ref!==void 0&&(Ee=U.ref),U.key!==void 0&&(le=""+U.key),U)b.call(U,ne)&&!$.hasOwnProperty(ne)&&(ve[ne]=U[ne]);var Ae=arguments.length-2;if(Ae===1)ve.children=K;else if(1<Ae){for(var Z=Array(Ae),ie=0;ie<Ae;ie++)Z[ie]=arguments[ie+2];ve.children=Z}if(P&&P.defaultProps)for(ne in Ae=P.defaultProps,Ae)ve[ne]===void 0&&(ve[ne]=Ae[ne]);return{$$typeof:e,type:P,key:le,ref:Ee,props:ve,_owner:L.current}}function _e(P,U){return{$$typeof:e,type:P.type,key:U,ref:P.ref,props:P.props,_owner:P._owner}}function Ce(P){return typeof P=="object"&&P!==null&&P.$$typeof===e}function be(P){var U={"=":"=0",":":"=2"};return"$"+P.replace(/[=:]/g,function(K){return U[K]})}var De=/\/+/g;function Pe(P,U){return typeof P=="object"&&P!==null&&P.key!=null?be(""+P.key):U.toString(36)}function de(P,U,K,ne,ve){var le=typeof P;(le==="undefined"||le==="boolean")&&(P=null);var Ee=!1;if(P===null)Ee=!0;else switch(le){case"string":case"number":Ee=!0;break;case"object":switch(P.$$typeof){case e:case t:Ee=!0}}if(Ee)return Ee=P,ve=ve(Ee),P=ne===""?"."+Pe(Ee,0):ne,H(ve)?(K="",P!=null&&(K=P.replace(De,"$&/")+"/"),de(ve,U,K,"",function(ie){return ie})):ve!=null&&(Ce(ve)&&(ve=_e(ve,K+(!ve.key||Ee&&Ee.key===ve.key?"":(""+ve.key).replace(De,"$&/")+"/")+P)),U.push(ve)),1;if(Ee=0,ne=ne===""?".":ne+":",H(P))for(var Ae=0;Ae<P.length;Ae++){le=P[Ae];var Z=ne+Pe(le,Ae);Ee+=de(le,U,K,Z,ve)}else if(Z=y(P),typeof Z=="function")for(P=Z.call(P),Ae=0;!(le=P.next()).done;)le=le.value,Z=ne+Pe(le,Ae++),Ee+=de(le,U,K,Z,ve);else if(le==="object")throw U=String(P),Error("Objects are not valid as a React child (found: "+(U==="[object Object]"?"object with keys {"+Object.keys(P).join(", ")+"}":U)+"). If you meant to render a collection of children, use an array instead.");return Ee}function Le(P,U,K){if(P==null)return P;var ne=[],ve=0;return de(P,ne,"","",function(le){return U.call(K,le,ve++)}),ne}function Te(P){if(P._status===-1){var U=P._result;U=U(),U.then(function(K){(P._status===0||P._status===-1)&&(P._status=1,P._result=K)},function(K){(P._status===0||P._status===-1)&&(P._status=2,P._result=K)}),P._status===-1&&(P._status=0,P._result=U)}if(P._status===1)return P._result.default;throw P._result}var te={current:null},W={transition:null},X={ReactCurrentDispatcher:te,ReactCurrentBatchConfig:W,ReactCurrentOwner:L};function j(){throw Error("act(...) is not supported in production builds of React.")}return Be.Children={map:Le,forEach:function(P,U,K){Le(P,function(){U.apply(this,arguments)},K)},count:function(P){var U=0;return Le(P,function(){U++}),U},toArray:function(P){return Le(P,function(U){return U})||[]},only:function(P){if(!Ce(P))throw Error("React.Children.only expected to receive a single React element child.");return P}},Be.Component=w,Be.Fragment=i,Be.Profiler=l,Be.PureComponent=B,Be.StrictMode=o,Be.Suspense=f,Be.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=X,Be.act=j,Be.cloneElement=function(P,U,K){if(P==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+P+".");var ne=E({},P.props),ve=P.key,le=P.ref,Ee=P._owner;if(U!=null){if(U.ref!==void 0&&(le=U.ref,Ee=L.current),U.key!==void 0&&(ve=""+U.key),P.type&&P.type.defaultProps)var Ae=P.type.defaultProps;for(Z in U)b.call(U,Z)&&!$.hasOwnProperty(Z)&&(ne[Z]=U[Z]===void 0&&Ae!==void 0?Ae[Z]:U[Z])}var Z=arguments.length-2;if(Z===1)ne.children=K;else if(1<Z){Ae=Array(Z);for(var ie=0;ie<Z;ie++)Ae[ie]=arguments[ie+2];ne.children=Ae}return{$$typeof:e,type:P.type,key:ve,ref:le,props:ne,_owner:Ee}},Be.createContext=function(P){return P={$$typeof:u,_currentValue:P,_currentValue2:P,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},P.Provider={$$typeof:s,_context:P},P.Consumer=P},Be.createElement=Q,Be.createFactory=function(P){var U=Q.bind(null,P);return U.type=P,U},Be.createRef=function(){return{current:null}},Be.forwardRef=function(P){return{$$typeof:d,render:P}},Be.isValidElement=Ce,Be.lazy=function(P){return{$$typeof:m,_payload:{_status:-1,_result:P},_init:Te}},Be.memo=function(P,U){return{$$typeof:g,type:P,compare:U===void 0?null:U}},Be.startTransition=function(P){var U=W.transition;W.transition={};try{P()}finally{W.transition=U}},Be.unstable_act=j,Be.useCallback=function(P,U){return te.current.useCallback(P,U)},Be.useContext=function(P){return te.current.useContext(P)},Be.useDebugValue=function(){},Be.useDeferredValue=function(P){return te.current.useDeferredValue(P)},Be.useEffect=function(P,U){return te.current.useEffect(P,U)},Be.useId=function(){return te.current.useId()},Be.useImperativeHandle=function(P,U,K){return te.current.useImperativeHandle(P,U,K)},Be.useInsertionEffect=function(P,U){return te.current.useInsertionEffect(P,U)},Be.useLayoutEffect=function(P,U){return te.current.useLayoutEffect(P,U)},Be.useMemo=function(P,U){return te.current.useMemo(P,U)},Be.useReducer=function(P,U,K){return te.current.useReducer(P,U,K)},Be.useRef=function(P){return te.current.useRef(P)},Be.useState=function(P){return te.current.useState(P)},Be.useSyncExternalStore=function(P,U,K){return te.current.useSyncExternalStore(P,U,K)},Be.useTransition=function(){return te.current.useTransition()},Be.version="18.3.1",Be}var cm;function Lf(){return cm||(cm=1,Nd.exports=BT()),Nd.exports}/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var dm;function HT(){if(dm)return Us;dm=1;var e=Lf(),t=Symbol.for("react.element"),i=Symbol.for("react.fragment"),o=Object.prototype.hasOwnProperty,l=e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,s={key:!0,ref:!0,__self:!0,__source:!0};function u(d,f,g){var m,v={},y=null,I=null;g!==void 0&&(y=""+g),f.key!==void 0&&(y=""+f.key),f.ref!==void 0&&(I=f.ref);for(m in f)o.call(f,m)&&!s.hasOwnProperty(m)&&(v[m]=f[m]);if(d&&d.defaultProps)for(m in f=d.defaultProps,f)v[m]===void 0&&(v[m]=f[m]);return{$$typeof:t,type:d,key:y,ref:I,props:v,_owner:l.current}}return Us.Fragment=i,Us.jsx=u,Us.jsxs=u,Us}var fm;function bT(){return fm||(fm=1,Pd.exports=HT()),Pd.exports}var Fe=bT(),Re=Lf();const ei=Y0(Re);var Fl={},Dd={exports:{}},Kt={},Od={exports:{}},kd={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var hm;function GT(){return hm||(hm=1,function(e){function t(W,X){var j=W.length;W.push(X);e:for(;0<j;){var P=j-1>>>1,U=W[P];if(0<l(U,X))W[P]=X,W[j]=U,j=P;else break e}}function i(W){return W.length===0?null:W[0]}function o(W){if(W.length===0)return null;var X=W[0],j=W.pop();if(j!==X){W[0]=j;e:for(var P=0,U=W.length,K=U>>>1;P<K;){var ne=2*(P+1)-1,ve=W[ne],le=ne+1,Ee=W[le];if(0>l(ve,j))le<U&&0>l(Ee,ve)?(W[P]=Ee,W[le]=j,P=le):(W[P]=ve,W[ne]=j,P=ne);else if(le<U&&0>l(Ee,j))W[P]=Ee,W[le]=j,P=le;else break e}}return X}function l(W,X){var j=W.sortIndex-X.sortIndex;return j!==0?j:W.id-X.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;e.unstable_now=function(){return s.now()}}else{var u=Date,d=u.now();e.unstable_now=function(){return u.now()-d}}var f=[],g=[],m=1,v=null,y=3,I=!1,E=!1,A=!1,w=typeof setTimeout=="function"?setTimeout:null,F=typeof clearTimeout=="function"?clearTimeout:null,B=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function D(W){for(var X=i(g);X!==null;){if(X.callback===null)o(g);else if(X.startTime<=W)o(g),X.sortIndex=X.expirationTime,t(f,X);else break;X=i(g)}}function H(W){if(A=!1,D(W),!E)if(i(f)!==null)E=!0,Te(b);else{var X=i(g);X!==null&&te(H,X.startTime-W)}}function b(W,X){E=!1,A&&(A=!1,F(Q),Q=-1),I=!0;var j=y;try{for(D(X),v=i(f);v!==null&&(!(v.expirationTime>X)||W&&!be());){var P=v.callback;if(typeof P=="function"){v.callback=null,y=v.priorityLevel;var U=P(v.expirationTime<=X);X=e.unstable_now(),typeof U=="function"?v.callback=U:v===i(f)&&o(f),D(X)}else o(f);v=i(f)}if(v!==null)var K=!0;else{var ne=i(g);ne!==null&&te(H,ne.startTime-X),K=!1}return K}finally{v=null,y=j,I=!1}}var L=!1,$=null,Q=-1,_e=5,Ce=-1;function be(){return!(e.unstable_now()-Ce<_e)}function De(){if($!==null){var W=e.unstable_now();Ce=W;var X=!0;try{X=$(!0,W)}finally{X?Pe():(L=!1,$=null)}}else L=!1}var Pe;if(typeof B=="function")Pe=function(){B(De)};else if(typeof MessageChannel<"u"){var de=new MessageChannel,Le=de.port2;de.port1.onmessage=De,Pe=function(){Le.postMessage(null)}}else Pe=function(){w(De,0)};function Te(W){$=W,L||(L=!0,Pe())}function te(W,X){Q=w(function(){W(e.unstable_now())},X)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(W){W.callback=null},e.unstable_continueExecution=function(){E||I||(E=!0,Te(b))},e.unstable_forceFrameRate=function(W){0>W||125<W?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):_e=0<W?Math.floor(1e3/W):5},e.unstable_getCurrentPriorityLevel=function(){return y},e.unstable_getFirstCallbackNode=function(){return i(f)},e.unstable_next=function(W){switch(y){case 1:case 2:case 3:var X=3;break;default:X=y}var j=y;y=X;try{return W()}finally{y=j}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(W,X){switch(W){case 1:case 2:case 3:case 4:case 5:break;default:W=3}var j=y;y=W;try{return X()}finally{y=j}},e.unstable_scheduleCallback=function(W,X,j){var P=e.unstable_now();switch(typeof j=="object"&&j!==null?(j=j.delay,j=typeof j=="number"&&0<j?P+j:P):j=P,W){case 1:var U=-1;break;case 2:U=250;break;case 5:U=1073741823;break;case 4:U=1e4;break;default:U=5e3}return U=j+U,W={id:m++,callback:X,priorityLevel:W,startTime:j,expirationTime:U,sortIndex:-1},j>P?(W.sortIndex=j,t(g,W),i(f)===null&&W===i(g)&&(A?(F(Q),Q=-1):A=!0,te(H,j-P))):(W.sortIndex=U,t(f,W),E||I||(E=!0,Te(b))),W},e.unstable_shouldYield=be,e.unstable_wrapCallback=function(W){var X=y;return function(){var j=y;y=X;try{return W.apply(this,arguments)}finally{y=j}}}}(kd)),kd}var gm;function xT(){return gm||(gm=1,Od.exports=GT()),Od.exports}/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var pm;function $T(){if(pm)return Kt;pm=1;var e=Lf(),t=xT();function i(n){for(var r="https://reactjs.org/docs/error-decoder.html?invariant="+n,a=1;a<arguments.length;a++)r+="&args[]="+encodeURIComponent(arguments[a]);return"Minified React error #"+n+"; visit "+r+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var o=new Set,l={};function s(n,r){u(n,r),u(n+"Capture",r)}function u(n,r){for(l[n]=r,n=0;n<r.length;n++)o.add(r[n])}var d=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),f=Object.prototype.hasOwnProperty,g=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,m={},v={};function y(n){return f.call(v,n)?!0:f.call(m,n)?!1:g.test(n)?v[n]=!0:(m[n]=!0,!1)}function I(n,r,a,c){if(a!==null&&a.type===0)return!1;switch(typeof r){case"function":case"symbol":return!0;case"boolean":return c?!1:a!==null?!a.acceptsBooleans:(n=n.toLowerCase().slice(0,5),n!=="data-"&&n!=="aria-");default:return!1}}function E(n,r,a,c){if(r===null||typeof r>"u"||I(n,r,a,c))return!0;if(c)return!1;if(a!==null)switch(a.type){case 3:return!r;case 4:return r===!1;case 5:return isNaN(r);case 6:return isNaN(r)||1>r}return!1}function A(n,r,a,c,h,p,S){this.acceptsBooleans=r===2||r===3||r===4,this.attributeName=c,this.attributeNamespace=h,this.mustUseProperty=a,this.propertyName=n,this.type=r,this.sanitizeURL=p,this.removeEmptyString=S}var w={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(n){w[n]=new A(n,0,!1,n,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(n){var r=n[0];w[r]=new A(r,1,!1,n[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(n){w[n]=new A(n,2,!1,n.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(n){w[n]=new A(n,2,!1,n,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(n){w[n]=new A(n,3,!1,n.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(n){w[n]=new A(n,3,!0,n,null,!1,!1)}),["capture","download"].forEach(function(n){w[n]=new A(n,4,!1,n,null,!1,!1)}),["cols","rows","size","span"].forEach(function(n){w[n]=new A(n,6,!1,n,null,!1,!1)}),["rowSpan","start"].forEach(function(n){w[n]=new A(n,5,!1,n.toLowerCase(),null,!1,!1)});var F=/[\-:]([a-z])/g;function B(n){return n[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(n){var r=n.replace(F,B);w[r]=new A(r,1,!1,n,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(n){var r=n.replace(F,B);w[r]=new A(r,1,!1,n,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(n){var r=n.replace(F,B);w[r]=new A(r,1,!1,n,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(n){w[n]=new A(n,1,!1,n.toLowerCase(),null,!1,!1)}),w.xlinkHref=new A("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(n){w[n]=new A(n,1,!1,n.toLowerCase(),null,!0,!0)});function D(n,r,a,c){var h=w.hasOwnProperty(r)?w[r]:null;(h!==null?h.type!==0:c||!(2<r.length)||r[0]!=="o"&&r[0]!=="O"||r[1]!=="n"&&r[1]!=="N")&&(E(r,a,h,c)&&(a=null),c||h===null?y(r)&&(a===null?n.removeAttribute(r):n.setAttribute(r,""+a)):h.mustUseProperty?n[h.propertyName]=a===null?h.type===3?!1:"":a:(r=h.attributeName,c=h.attributeNamespace,a===null?n.removeAttribute(r):(h=h.type,a=h===3||h===4&&a===!0?"":""+a,c?n.setAttributeNS(c,r,a):n.setAttribute(r,a))))}var H=e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,b=Symbol.for("react.element"),L=Symbol.for("react.portal"),$=Symbol.for("react.fragment"),Q=Symbol.for("react.strict_mode"),_e=Symbol.for("react.profiler"),Ce=Symbol.for("react.provider"),be=Symbol.for("react.context"),De=Symbol.for("react.forward_ref"),Pe=Symbol.for("react.suspense"),de=Symbol.for("react.suspense_list"),Le=Symbol.for("react.memo"),Te=Symbol.for("react.lazy"),te=Symbol.for("react.offscreen"),W=Symbol.iterator;function X(n){return n===null||typeof n!="object"?null:(n=W&&n[W]||n["@@iterator"],typeof n=="function"?n:null)}var j=Object.assign,P;function U(n){if(P===void 0)try{throw Error()}catch(a){var r=a.stack.trim().match(/\n( *(at )?)/);P=r&&r[1]||""}return`
`+P+n}var K=!1;function ne(n,r){if(!n||K)return"";K=!0;var a=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(r)if(r=function(){throw Error()},Object.defineProperty(r.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(r,[])}catch(M){var c=M}Reflect.construct(n,[],r)}else{try{r.call()}catch(M){c=M}n.call(r.prototype)}else{try{throw Error()}catch(M){c=M}n()}}catch(M){if(M&&c&&typeof M.stack=="string"){for(var h=M.stack.split(`
`),p=c.stack.split(`
`),S=h.length-1,_=p.length-1;1<=S&&0<=_&&h[S]!==p[_];)_--;for(;1<=S&&0<=_;S--,_--)if(h[S]!==p[_]){if(S!==1||_!==1)do if(S--,_--,0>_||h[S]!==p[_]){var R=`
`+h[S].replace(" at new "," at ");return n.displayName&&R.includes("<anonymous>")&&(R=R.replace("<anonymous>",n.displayName)),R}while(1<=S&&0<=_);break}}}finally{K=!1,Error.prepareStackTrace=a}return(n=n?n.displayName||n.name:"")?U(n):""}function ve(n){switch(n.tag){case 5:return U(n.type);case 16:return U("Lazy");case 13:return U("Suspense");case 19:return U("SuspenseList");case 0:case 2:case 15:return n=ne(n.type,!1),n;case 11:return n=ne(n.type.render,!1),n;case 1:return n=ne(n.type,!0),n;default:return""}}function le(n){if(n==null)return null;if(typeof n=="function")return n.displayName||n.name||null;if(typeof n=="string")return n;switch(n){case $:return"Fragment";case L:return"Portal";case _e:return"Profiler";case Q:return"StrictMode";case Pe:return"Suspense";case de:return"SuspenseList"}if(typeof n=="object")switch(n.$$typeof){case be:return(n.displayName||"Context")+".Consumer";case Ce:return(n._context.displayName||"Context")+".Provider";case De:var r=n.render;return n=n.displayName,n||(n=r.displayName||r.name||"",n=n!==""?"ForwardRef("+n+")":"ForwardRef"),n;case Le:return r=n.displayName||null,r!==null?r:le(n.type)||"Memo";case Te:r=n._payload,n=n._init;try{return le(n(r))}catch{}}return null}function Ee(n){var r=n.type;switch(n.tag){case 24:return"Cache";case 9:return(r.displayName||"Context")+".Consumer";case 10:return(r._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return n=r.render,n=n.displayName||n.name||"",r.displayName||(n!==""?"ForwardRef("+n+")":"ForwardRef");case 7:return"Fragment";case 5:return r;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return le(r);case 8:return r===Q?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof r=="function")return r.displayName||r.name||null;if(typeof r=="string")return r}return null}function Ae(n){switch(typeof n){case"boolean":case"number":case"string":case"undefined":return n;case"object":return n;default:return""}}function Z(n){var r=n.type;return(n=n.nodeName)&&n.toLowerCase()==="input"&&(r==="checkbox"||r==="radio")}function ie(n){var r=Z(n)?"checked":"value",a=Object.getOwnPropertyDescriptor(n.constructor.prototype,r),c=""+n[r];if(!n.hasOwnProperty(r)&&typeof a<"u"&&typeof a.get=="function"&&typeof a.set=="function"){var h=a.get,p=a.set;return Object.defineProperty(n,r,{configurable:!0,get:function(){return h.call(this)},set:function(S){c=""+S,p.call(this,S)}}),Object.defineProperty(n,r,{enumerable:a.enumerable}),{getValue:function(){return c},setValue:function(S){c=""+S},stopTracking:function(){n._valueTracker=null,delete n[r]}}}}function Ue(n){n._valueTracker||(n._valueTracker=ie(n))}function he(n){if(!n)return!1;var r=n._valueTracker;if(!r)return!0;var a=r.getValue(),c="";return n&&(c=Z(n)?n.checked?"true":"false":n.value),n=c,n!==a?(r.setValue(n),!0):!1}function Gn(n){if(n=n||(typeof document<"u"?document:void 0),typeof n>"u")return null;try{return n.activeElement||n.body}catch{return n.body}}function qe(n,r){var a=r.checked;return j({},r,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:a??n._wrapperState.initialChecked})}function Ve(n,r){var a=r.defaultValue==null?"":r.defaultValue,c=r.checked!=null?r.checked:r.defaultChecked;a=Ae(r.value!=null?r.value:a),n._wrapperState={initialChecked:c,initialValue:a,controlled:r.type==="checkbox"||r.type==="radio"?r.checked!=null:r.value!=null}}function xn(n,r){r=r.checked,r!=null&&D(n,"checked",r,!1)}function zt(n,r){xn(n,r);var a=Ae(r.value),c=r.type;if(a!=null)c==="number"?(a===0&&n.value===""||n.value!=a)&&(n.value=""+a):n.value!==""+a&&(n.value=""+a);else if(c==="submit"||c==="reset"){n.removeAttribute("value");return}r.hasOwnProperty("value")?$n(n,r.type,a):r.hasOwnProperty("defaultValue")&&$n(n,r.type,Ae(r.defaultValue)),r.checked==null&&r.defaultChecked!=null&&(n.defaultChecked=!!r.defaultChecked)}function cn(n,r,a){if(r.hasOwnProperty("value")||r.hasOwnProperty("defaultValue")){var c=r.type;if(!(c!=="submit"&&c!=="reset"||r.value!==void 0&&r.value!==null))return;r=""+n._wrapperState.initialValue,a||r===n.value||(n.value=r),n.defaultValue=r}a=n.name,a!==""&&(n.name=""),n.defaultChecked=!!n._wrapperState.initialChecked,a!==""&&(n.name=a)}function $n(n,r,a){(r!=="number"||Gn(n.ownerDocument)!==n)&&(a==null?n.defaultValue=""+n._wrapperState.initialValue:n.defaultValue!==""+a&&(n.defaultValue=""+a))}var zn=Array.isArray;function yi(n,r,a,c){if(n=n.options,r){r={};for(var h=0;h<a.length;h++)r["$"+a[h]]=!0;for(a=0;a<n.length;a++)h=r.hasOwnProperty("$"+n[a].value),n[a].selected!==h&&(n[a].selected=h),h&&c&&(n[a].defaultSelected=!0)}else{for(a=""+Ae(a),r=null,h=0;h<n.length;h++){if(n[h].value===a){n[h].selected=!0,c&&(n[h].defaultSelected=!0);return}r!==null||n[h].disabled||(r=n[h])}r!==null&&(r.selected=!0)}}function sr(n,r){if(r.dangerouslySetInnerHTML!=null)throw Error(i(91));return j({},r,{value:void 0,defaultValue:void 0,children:""+n._wrapperState.initialValue})}function yh(n,r){var a=r.value;if(a==null){if(a=r.children,r=r.defaultValue,a!=null){if(r!=null)throw Error(i(92));if(zn(a)){if(1<a.length)throw Error(i(93));a=a[0]}r=a}r==null&&(r=""),a=r}n._wrapperState={initialValue:Ae(a)}}function Th(n,r){var a=Ae(r.value),c=Ae(r.defaultValue);a!=null&&(a=""+a,a!==n.value&&(n.value=a),r.defaultValue==null&&n.defaultValue!==a&&(n.defaultValue=a)),c!=null&&(n.defaultValue=""+c)}function Ah(n){var r=n.textContent;r===n._wrapperState.initialValue&&r!==""&&r!==null&&(n.value=r)}function Ih(n){switch(n){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function bu(n,r){return n==null||n==="http://www.w3.org/1999/xhtml"?Ih(r):n==="http://www.w3.org/2000/svg"&&r==="foreignObject"?"http://www.w3.org/1999/xhtml":n}var Ca,Eh=function(n){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(r,a,c,h){MSApp.execUnsafeLocalFunction(function(){return n(r,a,c,h)})}:n}(function(n,r){if(n.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in n)n.innerHTML=r;else{for(Ca=Ca||document.createElement("div"),Ca.innerHTML="<svg>"+r.valueOf().toString()+"</svg>",r=Ca.firstChild;n.firstChild;)n.removeChild(n.firstChild);for(;r.firstChild;)n.appendChild(r.firstChild)}});function Qo(n,r){if(r){var a=n.firstChild;if(a&&a===n.lastChild&&a.nodeType===3){a.nodeValue=r;return}}n.textContent=r}var Jo={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},bS=["Webkit","ms","Moz","O"];Object.keys(Jo).forEach(function(n){bS.forEach(function(r){r=r+n.charAt(0).toUpperCase()+n.substring(1),Jo[r]=Jo[n]})});function wh(n,r,a){return r==null||typeof r=="boolean"||r===""?"":a||typeof r!="number"||r===0||Jo.hasOwnProperty(n)&&Jo[n]?(""+r).trim():r+"px"}function _h(n,r){n=n.style;for(var a in r)if(r.hasOwnProperty(a)){var c=a.indexOf("--")===0,h=wh(a,r[a],c);a==="float"&&(a="cssFloat"),c?n.setProperty(a,h):n[a]=h}}var GS=j({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Gu(n,r){if(r){if(GS[n]&&(r.children!=null||r.dangerouslySetInnerHTML!=null))throw Error(i(137,n));if(r.dangerouslySetInnerHTML!=null){if(r.children!=null)throw Error(i(60));if(typeof r.dangerouslySetInnerHTML!="object"||!("__html"in r.dangerouslySetInnerHTML))throw Error(i(61))}if(r.style!=null&&typeof r.style!="object")throw Error(i(62))}}function xu(n,r){if(n.indexOf("-")===-1)return typeof r.is=="string";switch(n){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var $u=null;function zu(n){return n=n.target||n.srcElement||window,n.correspondingUseElement&&(n=n.correspondingUseElement),n.nodeType===3?n.parentNode:n}var Wu=null,Wr=null,Yr=null;function Ch(n){if(n=As(n)){if(typeof Wu!="function")throw Error(i(280));var r=n.stateNode;r&&(r=Ka(r),Wu(n.stateNode,n.type,r))}}function Rh(n){Wr?Yr?Yr.push(n):Yr=[n]:Wr=n}function Ph(){if(Wr){var n=Wr,r=Yr;if(Yr=Wr=null,Ch(n),r)for(n=0;n<r.length;n++)Ch(r[n])}}function Nh(n,r){return n(r)}function Dh(){}var Yu=!1;function Oh(n,r,a){if(Yu)return n(r,a);Yu=!0;try{return Nh(n,r,a)}finally{Yu=!1,(Wr!==null||Yr!==null)&&(Dh(),Ph())}}function es(n,r){var a=n.stateNode;if(a===null)return null;var c=Ka(a);if(c===null)return null;a=c[r];e:switch(r){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(c=!c.disabled)||(n=n.type,c=!(n==="button"||n==="input"||n==="select"||n==="textarea")),n=!c;break e;default:n=!1}if(n)return null;if(a&&typeof a!="function")throw Error(i(231,r,typeof a));return a}var ju=!1;if(d)try{var ts={};Object.defineProperty(ts,"passive",{get:function(){ju=!0}}),window.addEventListener("test",ts,ts),window.removeEventListener("test",ts,ts)}catch{ju=!1}function xS(n,r,a,c,h,p,S,_,R){var M=Array.prototype.slice.call(arguments,3);try{r.apply(a,M)}catch(x){this.onError(x)}}var ns=!1,Ra=null,Pa=!1,Vu=null,$S={onError:function(n){ns=!0,Ra=n}};function zS(n,r,a,c,h,p,S,_,R){ns=!1,Ra=null,xS.apply($S,arguments)}function WS(n,r,a,c,h,p,S,_,R){if(zS.apply(this,arguments),ns){if(ns){var M=Ra;ns=!1,Ra=null}else throw Error(i(198));Pa||(Pa=!0,Vu=M)}}function ar(n){var r=n,a=n;if(n.alternate)for(;r.return;)r=r.return;else{n=r;do r=n,(r.flags&4098)!==0&&(a=r.return),n=r.return;while(n)}return r.tag===3?a:null}function kh(n){if(n.tag===13){var r=n.memoizedState;if(r===null&&(n=n.alternate,n!==null&&(r=n.memoizedState)),r!==null)return r.dehydrated}return null}function Mh(n){if(ar(n)!==n)throw Error(i(188))}function YS(n){var r=n.alternate;if(!r){if(r=ar(n),r===null)throw Error(i(188));return r!==n?null:n}for(var a=n,c=r;;){var h=a.return;if(h===null)break;var p=h.alternate;if(p===null){if(c=h.return,c!==null){a=c;continue}break}if(h.child===p.child){for(p=h.child;p;){if(p===a)return Mh(h),n;if(p===c)return Mh(h),r;p=p.sibling}throw Error(i(188))}if(a.return!==c.return)a=h,c=p;else{for(var S=!1,_=h.child;_;){if(_===a){S=!0,a=h,c=p;break}if(_===c){S=!0,c=h,a=p;break}_=_.sibling}if(!S){for(_=p.child;_;){if(_===a){S=!0,a=p,c=h;break}if(_===c){S=!0,c=p,a=h;break}_=_.sibling}if(!S)throw Error(i(189))}}if(a.alternate!==c)throw Error(i(190))}if(a.tag!==3)throw Error(i(188));return a.stateNode.current===a?n:r}function Fh(n){return n=YS(n),n!==null?Lh(n):null}function Lh(n){if(n.tag===5||n.tag===6)return n;for(n=n.child;n!==null;){var r=Lh(n);if(r!==null)return r;n=n.sibling}return null}var Uh=t.unstable_scheduleCallback,Bh=t.unstable_cancelCallback,jS=t.unstable_shouldYield,VS=t.unstable_requestPaint,at=t.unstable_now,XS=t.unstable_getCurrentPriorityLevel,Xu=t.unstable_ImmediatePriority,Hh=t.unstable_UserBlockingPriority,Na=t.unstable_NormalPriority,KS=t.unstable_LowPriority,bh=t.unstable_IdlePriority,Da=null,Wn=null;function ZS(n){if(Wn&&typeof Wn.onCommitFiberRoot=="function")try{Wn.onCommitFiberRoot(Da,n,void 0,(n.current.flags&128)===128)}catch{}}var _n=Math.clz32?Math.clz32:JS,qS=Math.log,QS=Math.LN2;function JS(n){return n>>>=0,n===0?32:31-(qS(n)/QS|0)|0}var Oa=64,ka=4194304;function is(n){switch(n&-n){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return n&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return n&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return n}}function Ma(n,r){var a=n.pendingLanes;if(a===0)return 0;var c=0,h=n.suspendedLanes,p=n.pingedLanes,S=a&268435455;if(S!==0){var _=S&~h;_!==0?c=is(_):(p&=S,p!==0&&(c=is(p)))}else S=a&~h,S!==0?c=is(S):p!==0&&(c=is(p));if(c===0)return 0;if(r!==0&&r!==c&&(r&h)===0&&(h=c&-c,p=r&-r,h>=p||h===16&&(p&4194240)!==0))return r;if((c&4)!==0&&(c|=a&16),r=n.entangledLanes,r!==0)for(n=n.entanglements,r&=c;0<r;)a=31-_n(r),h=1<<a,c|=n[a],r&=~h;return c}function ey(n,r){switch(n){case 1:case 2:case 4:return r+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return r+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function ty(n,r){for(var a=n.suspendedLanes,c=n.pingedLanes,h=n.expirationTimes,p=n.pendingLanes;0<p;){var S=31-_n(p),_=1<<S,R=h[S];R===-1?((_&a)===0||(_&c)!==0)&&(h[S]=ey(_,r)):R<=r&&(n.expiredLanes|=_),p&=~_}}function Ku(n){return n=n.pendingLanes&-1073741825,n!==0?n:n&1073741824?1073741824:0}function Gh(){var n=Oa;return Oa<<=1,(Oa&4194240)===0&&(Oa=64),n}function Zu(n){for(var r=[],a=0;31>a;a++)r.push(n);return r}function rs(n,r,a){n.pendingLanes|=r,r!==536870912&&(n.suspendedLanes=0,n.pingedLanes=0),n=n.eventTimes,r=31-_n(r),n[r]=a}function ny(n,r){var a=n.pendingLanes&~r;n.pendingLanes=r,n.suspendedLanes=0,n.pingedLanes=0,n.expiredLanes&=r,n.mutableReadLanes&=r,n.entangledLanes&=r,r=n.entanglements;var c=n.eventTimes;for(n=n.expirationTimes;0<a;){var h=31-_n(a),p=1<<h;r[h]=0,c[h]=-1,n[h]=-1,a&=~p}}function qu(n,r){var a=n.entangledLanes|=r;for(n=n.entanglements;a;){var c=31-_n(a),h=1<<c;h&r|n[c]&r&&(n[c]|=r),a&=~h}}var ze=0;function xh(n){return n&=-n,1<n?4<n?(n&268435455)!==0?16:536870912:4:1}var $h,Qu,zh,Wh,Yh,Ju=!1,Fa=[],Ti=null,Ai=null,Ii=null,os=new Map,ss=new Map,Ei=[],iy="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function jh(n,r){switch(n){case"focusin":case"focusout":Ti=null;break;case"dragenter":case"dragleave":Ai=null;break;case"mouseover":case"mouseout":Ii=null;break;case"pointerover":case"pointerout":os.delete(r.pointerId);break;case"gotpointercapture":case"lostpointercapture":ss.delete(r.pointerId)}}function as(n,r,a,c,h,p){return n===null||n.nativeEvent!==p?(n={blockedOn:r,domEventName:a,eventSystemFlags:c,nativeEvent:p,targetContainers:[h]},r!==null&&(r=As(r),r!==null&&Qu(r)),n):(n.eventSystemFlags|=c,r=n.targetContainers,h!==null&&r.indexOf(h)===-1&&r.push(h),n)}function ry(n,r,a,c,h){switch(r){case"focusin":return Ti=as(Ti,n,r,a,c,h),!0;case"dragenter":return Ai=as(Ai,n,r,a,c,h),!0;case"mouseover":return Ii=as(Ii,n,r,a,c,h),!0;case"pointerover":var p=h.pointerId;return os.set(p,as(os.get(p)||null,n,r,a,c,h)),!0;case"gotpointercapture":return p=h.pointerId,ss.set(p,as(ss.get(p)||null,n,r,a,c,h)),!0}return!1}function Vh(n){var r=lr(n.target);if(r!==null){var a=ar(r);if(a!==null){if(r=a.tag,r===13){if(r=kh(a),r!==null){n.blockedOn=r,Yh(n.priority,function(){zh(a)});return}}else if(r===3&&a.stateNode.current.memoizedState.isDehydrated){n.blockedOn=a.tag===3?a.stateNode.containerInfo:null;return}}}n.blockedOn=null}function La(n){if(n.blockedOn!==null)return!1;for(var r=n.targetContainers;0<r.length;){var a=tc(n.domEventName,n.eventSystemFlags,r[0],n.nativeEvent);if(a===null){a=n.nativeEvent;var c=new a.constructor(a.type,a);$u=c,a.target.dispatchEvent(c),$u=null}else return r=As(a),r!==null&&Qu(r),n.blockedOn=a,!1;r.shift()}return!0}function Xh(n,r,a){La(n)&&a.delete(r)}function oy(){Ju=!1,Ti!==null&&La(Ti)&&(Ti=null),Ai!==null&&La(Ai)&&(Ai=null),Ii!==null&&La(Ii)&&(Ii=null),os.forEach(Xh),ss.forEach(Xh)}function ls(n,r){n.blockedOn===r&&(n.blockedOn=null,Ju||(Ju=!0,t.unstable_scheduleCallback(t.unstable_NormalPriority,oy)))}function us(n){function r(h){return ls(h,n)}if(0<Fa.length){ls(Fa[0],n);for(var a=1;a<Fa.length;a++){var c=Fa[a];c.blockedOn===n&&(c.blockedOn=null)}}for(Ti!==null&&ls(Ti,n),Ai!==null&&ls(Ai,n),Ii!==null&&ls(Ii,n),os.forEach(r),ss.forEach(r),a=0;a<Ei.length;a++)c=Ei[a],c.blockedOn===n&&(c.blockedOn=null);for(;0<Ei.length&&(a=Ei[0],a.blockedOn===null);)Vh(a),a.blockedOn===null&&Ei.shift()}var jr=H.ReactCurrentBatchConfig,Ua=!0;function sy(n,r,a,c){var h=ze,p=jr.transition;jr.transition=null;try{ze=1,ec(n,r,a,c)}finally{ze=h,jr.transition=p}}function ay(n,r,a,c){var h=ze,p=jr.transition;jr.transition=null;try{ze=4,ec(n,r,a,c)}finally{ze=h,jr.transition=p}}function ec(n,r,a,c){if(Ua){var h=tc(n,r,a,c);if(h===null)Sc(n,r,c,Ba,a),jh(n,c);else if(ry(h,n,r,a,c))c.stopPropagation();else if(jh(n,c),r&4&&-1<iy.indexOf(n)){for(;h!==null;){var p=As(h);if(p!==null&&$h(p),p=tc(n,r,a,c),p===null&&Sc(n,r,c,Ba,a),p===h)break;h=p}h!==null&&c.stopPropagation()}else Sc(n,r,c,null,a)}}var Ba=null;function tc(n,r,a,c){if(Ba=null,n=zu(c),n=lr(n),n!==null)if(r=ar(n),r===null)n=null;else if(a=r.tag,a===13){if(n=kh(r),n!==null)return n;n=null}else if(a===3){if(r.stateNode.current.memoizedState.isDehydrated)return r.tag===3?r.stateNode.containerInfo:null;n=null}else r!==n&&(n=null);return Ba=n,null}function Kh(n){switch(n){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(XS()){case Xu:return 1;case Hh:return 4;case Na:case KS:return 16;case bh:return 536870912;default:return 16}default:return 16}}var wi=null,nc=null,Ha=null;function Zh(){if(Ha)return Ha;var n,r=nc,a=r.length,c,h="value"in wi?wi.value:wi.textContent,p=h.length;for(n=0;n<a&&r[n]===h[n];n++);var S=a-n;for(c=1;c<=S&&r[a-c]===h[p-c];c++);return Ha=h.slice(n,1<c?1-c:void 0)}function ba(n){var r=n.keyCode;return"charCode"in n?(n=n.charCode,n===0&&r===13&&(n=13)):n=r,n===10&&(n=13),32<=n||n===13?n:0}function Ga(){return!0}function qh(){return!1}function Qt(n){function r(a,c,h,p,S){this._reactName=a,this._targetInst=h,this.type=c,this.nativeEvent=p,this.target=S,this.currentTarget=null;for(var _ in n)n.hasOwnProperty(_)&&(a=n[_],this[_]=a?a(p):p[_]);return this.isDefaultPrevented=(p.defaultPrevented!=null?p.defaultPrevented:p.returnValue===!1)?Ga:qh,this.isPropagationStopped=qh,this}return j(r.prototype,{preventDefault:function(){this.defaultPrevented=!0;var a=this.nativeEvent;a&&(a.preventDefault?a.preventDefault():typeof a.returnValue!="unknown"&&(a.returnValue=!1),this.isDefaultPrevented=Ga)},stopPropagation:function(){var a=this.nativeEvent;a&&(a.stopPropagation?a.stopPropagation():typeof a.cancelBubble!="unknown"&&(a.cancelBubble=!0),this.isPropagationStopped=Ga)},persist:function(){},isPersistent:Ga}),r}var Vr={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(n){return n.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},ic=Qt(Vr),cs=j({},Vr,{view:0,detail:0}),ly=Qt(cs),rc,oc,ds,xa=j({},cs,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:ac,button:0,buttons:0,relatedTarget:function(n){return n.relatedTarget===void 0?n.fromElement===n.srcElement?n.toElement:n.fromElement:n.relatedTarget},movementX:function(n){return"movementX"in n?n.movementX:(n!==ds&&(ds&&n.type==="mousemove"?(rc=n.screenX-ds.screenX,oc=n.screenY-ds.screenY):oc=rc=0,ds=n),rc)},movementY:function(n){return"movementY"in n?n.movementY:oc}}),Qh=Qt(xa),uy=j({},xa,{dataTransfer:0}),cy=Qt(uy),dy=j({},cs,{relatedTarget:0}),sc=Qt(dy),fy=j({},Vr,{animationName:0,elapsedTime:0,pseudoElement:0}),hy=Qt(fy),gy=j({},Vr,{clipboardData:function(n){return"clipboardData"in n?n.clipboardData:window.clipboardData}}),py=Qt(gy),my=j({},Vr,{data:0}),Jh=Qt(my),vy={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Sy={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},yy={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Ty(n){var r=this.nativeEvent;return r.getModifierState?r.getModifierState(n):(n=yy[n])?!!r[n]:!1}function ac(){return Ty}var Ay=j({},cs,{key:function(n){if(n.key){var r=vy[n.key]||n.key;if(r!=="Unidentified")return r}return n.type==="keypress"?(n=ba(n),n===13?"Enter":String.fromCharCode(n)):n.type==="keydown"||n.type==="keyup"?Sy[n.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:ac,charCode:function(n){return n.type==="keypress"?ba(n):0},keyCode:function(n){return n.type==="keydown"||n.type==="keyup"?n.keyCode:0},which:function(n){return n.type==="keypress"?ba(n):n.type==="keydown"||n.type==="keyup"?n.keyCode:0}}),Iy=Qt(Ay),Ey=j({},xa,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),eg=Qt(Ey),wy=j({},cs,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:ac}),_y=Qt(wy),Cy=j({},Vr,{propertyName:0,elapsedTime:0,pseudoElement:0}),Ry=Qt(Cy),Py=j({},xa,{deltaX:function(n){return"deltaX"in n?n.deltaX:"wheelDeltaX"in n?-n.wheelDeltaX:0},deltaY:function(n){return"deltaY"in n?n.deltaY:"wheelDeltaY"in n?-n.wheelDeltaY:"wheelDelta"in n?-n.wheelDelta:0},deltaZ:0,deltaMode:0}),Ny=Qt(Py),Dy=[9,13,27,32],lc=d&&"CompositionEvent"in window,fs=null;d&&"documentMode"in document&&(fs=document.documentMode);var Oy=d&&"TextEvent"in window&&!fs,tg=d&&(!lc||fs&&8<fs&&11>=fs),ng=" ",ig=!1;function rg(n,r){switch(n){case"keyup":return Dy.indexOf(r.keyCode)!==-1;case"keydown":return r.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function og(n){return n=n.detail,typeof n=="object"&&"data"in n?n.data:null}var Xr=!1;function ky(n,r){switch(n){case"compositionend":return og(r);case"keypress":return r.which!==32?null:(ig=!0,ng);case"textInput":return n=r.data,n===ng&&ig?null:n;default:return null}}function My(n,r){if(Xr)return n==="compositionend"||!lc&&rg(n,r)?(n=Zh(),Ha=nc=wi=null,Xr=!1,n):null;switch(n){case"paste":return null;case"keypress":if(!(r.ctrlKey||r.altKey||r.metaKey)||r.ctrlKey&&r.altKey){if(r.char&&1<r.char.length)return r.char;if(r.which)return String.fromCharCode(r.which)}return null;case"compositionend":return tg&&r.locale!=="ko"?null:r.data;default:return null}}var Fy={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function sg(n){var r=n&&n.nodeName&&n.nodeName.toLowerCase();return r==="input"?!!Fy[n.type]:r==="textarea"}function ag(n,r,a,c){Rh(c),r=ja(r,"onChange"),0<r.length&&(a=new ic("onChange","change",null,a,c),n.push({event:a,listeners:r}))}var hs=null,gs=null;function Ly(n){_g(n,0)}function $a(n){var r=Jr(n);if(he(r))return n}function Uy(n,r){if(n==="change")return r}var lg=!1;if(d){var uc;if(d){var cc="oninput"in document;if(!cc){var ug=document.createElement("div");ug.setAttribute("oninput","return;"),cc=typeof ug.oninput=="function"}uc=cc}else uc=!1;lg=uc&&(!document.documentMode||9<document.documentMode)}function cg(){hs&&(hs.detachEvent("onpropertychange",dg),gs=hs=null)}function dg(n){if(n.propertyName==="value"&&$a(gs)){var r=[];ag(r,gs,n,zu(n)),Oh(Ly,r)}}function By(n,r,a){n==="focusin"?(cg(),hs=r,gs=a,hs.attachEvent("onpropertychange",dg)):n==="focusout"&&cg()}function Hy(n){if(n==="selectionchange"||n==="keyup"||n==="keydown")return $a(gs)}function by(n,r){if(n==="click")return $a(r)}function Gy(n,r){if(n==="input"||n==="change")return $a(r)}function xy(n,r){return n===r&&(n!==0||1/n===1/r)||n!==n&&r!==r}var Cn=typeof Object.is=="function"?Object.is:xy;function ps(n,r){if(Cn(n,r))return!0;if(typeof n!="object"||n===null||typeof r!="object"||r===null)return!1;var a=Object.keys(n),c=Object.keys(r);if(a.length!==c.length)return!1;for(c=0;c<a.length;c++){var h=a[c];if(!f.call(r,h)||!Cn(n[h],r[h]))return!1}return!0}function fg(n){for(;n&&n.firstChild;)n=n.firstChild;return n}function hg(n,r){var a=fg(n);n=0;for(var c;a;){if(a.nodeType===3){if(c=n+a.textContent.length,n<=r&&c>=r)return{node:a,offset:r-n};n=c}e:{for(;a;){if(a.nextSibling){a=a.nextSibling;break e}a=a.parentNode}a=void 0}a=fg(a)}}function gg(n,r){return n&&r?n===r?!0:n&&n.nodeType===3?!1:r&&r.nodeType===3?gg(n,r.parentNode):"contains"in n?n.contains(r):n.compareDocumentPosition?!!(n.compareDocumentPosition(r)&16):!1:!1}function pg(){for(var n=window,r=Gn();r instanceof n.HTMLIFrameElement;){try{var a=typeof r.contentWindow.location.href=="string"}catch{a=!1}if(a)n=r.contentWindow;else break;r=Gn(n.document)}return r}function dc(n){var r=n&&n.nodeName&&n.nodeName.toLowerCase();return r&&(r==="input"&&(n.type==="text"||n.type==="search"||n.type==="tel"||n.type==="url"||n.type==="password")||r==="textarea"||n.contentEditable==="true")}function $y(n){var r=pg(),a=n.focusedElem,c=n.selectionRange;if(r!==a&&a&&a.ownerDocument&&gg(a.ownerDocument.documentElement,a)){if(c!==null&&dc(a)){if(r=c.start,n=c.end,n===void 0&&(n=r),"selectionStart"in a)a.selectionStart=r,a.selectionEnd=Math.min(n,a.value.length);else if(n=(r=a.ownerDocument||document)&&r.defaultView||window,n.getSelection){n=n.getSelection();var h=a.textContent.length,p=Math.min(c.start,h);c=c.end===void 0?p:Math.min(c.end,h),!n.extend&&p>c&&(h=c,c=p,p=h),h=hg(a,p);var S=hg(a,c);h&&S&&(n.rangeCount!==1||n.anchorNode!==h.node||n.anchorOffset!==h.offset||n.focusNode!==S.node||n.focusOffset!==S.offset)&&(r=r.createRange(),r.setStart(h.node,h.offset),n.removeAllRanges(),p>c?(n.addRange(r),n.extend(S.node,S.offset)):(r.setEnd(S.node,S.offset),n.addRange(r)))}}for(r=[],n=a;n=n.parentNode;)n.nodeType===1&&r.push({element:n,left:n.scrollLeft,top:n.scrollTop});for(typeof a.focus=="function"&&a.focus(),a=0;a<r.length;a++)n=r[a],n.element.scrollLeft=n.left,n.element.scrollTop=n.top}}var zy=d&&"documentMode"in document&&11>=document.documentMode,Kr=null,fc=null,ms=null,hc=!1;function mg(n,r,a){var c=a.window===a?a.document:a.nodeType===9?a:a.ownerDocument;hc||Kr==null||Kr!==Gn(c)||(c=Kr,"selectionStart"in c&&dc(c)?c={start:c.selectionStart,end:c.selectionEnd}:(c=(c.ownerDocument&&c.ownerDocument.defaultView||window).getSelection(),c={anchorNode:c.anchorNode,anchorOffset:c.anchorOffset,focusNode:c.focusNode,focusOffset:c.focusOffset}),ms&&ps(ms,c)||(ms=c,c=ja(fc,"onSelect"),0<c.length&&(r=new ic("onSelect","select",null,r,a),n.push({event:r,listeners:c}),r.target=Kr)))}function za(n,r){var a={};return a[n.toLowerCase()]=r.toLowerCase(),a["Webkit"+n]="webkit"+r,a["Moz"+n]="moz"+r,a}var Zr={animationend:za("Animation","AnimationEnd"),animationiteration:za("Animation","AnimationIteration"),animationstart:za("Animation","AnimationStart"),transitionend:za("Transition","TransitionEnd")},gc={},vg={};d&&(vg=document.createElement("div").style,"AnimationEvent"in window||(delete Zr.animationend.animation,delete Zr.animationiteration.animation,delete Zr.animationstart.animation),"TransitionEvent"in window||delete Zr.transitionend.transition);function Wa(n){if(gc[n])return gc[n];if(!Zr[n])return n;var r=Zr[n],a;for(a in r)if(r.hasOwnProperty(a)&&a in vg)return gc[n]=r[a];return n}var Sg=Wa("animationend"),yg=Wa("animationiteration"),Tg=Wa("animationstart"),Ag=Wa("transitionend"),Ig=new Map,Eg="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function _i(n,r){Ig.set(n,r),s(r,[n])}for(var pc=0;pc<Eg.length;pc++){var mc=Eg[pc],Wy=mc.toLowerCase(),Yy=mc[0].toUpperCase()+mc.slice(1);_i(Wy,"on"+Yy)}_i(Sg,"onAnimationEnd"),_i(yg,"onAnimationIteration"),_i(Tg,"onAnimationStart"),_i("dblclick","onDoubleClick"),_i("focusin","onFocus"),_i("focusout","onBlur"),_i(Ag,"onTransitionEnd"),u("onMouseEnter",["mouseout","mouseover"]),u("onMouseLeave",["mouseout","mouseover"]),u("onPointerEnter",["pointerout","pointerover"]),u("onPointerLeave",["pointerout","pointerover"]),s("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),s("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),s("onBeforeInput",["compositionend","keypress","textInput","paste"]),s("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),s("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),s("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var vs="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),jy=new Set("cancel close invalid load scroll toggle".split(" ").concat(vs));function wg(n,r,a){var c=n.type||"unknown-event";n.currentTarget=a,WS(c,r,void 0,n),n.currentTarget=null}function _g(n,r){r=(r&4)!==0;for(var a=0;a<n.length;a++){var c=n[a],h=c.event;c=c.listeners;e:{var p=void 0;if(r)for(var S=c.length-1;0<=S;S--){var _=c[S],R=_.instance,M=_.currentTarget;if(_=_.listener,R!==p&&h.isPropagationStopped())break e;wg(h,_,M),p=R}else for(S=0;S<c.length;S++){if(_=c[S],R=_.instance,M=_.currentTarget,_=_.listener,R!==p&&h.isPropagationStopped())break e;wg(h,_,M),p=R}}}if(Pa)throw n=Vu,Pa=!1,Vu=null,n}function Xe(n,r){var a=r[wc];a===void 0&&(a=r[wc]=new Set);var c=n+"__bubble";a.has(c)||(Cg(r,n,2,!1),a.add(c))}function vc(n,r,a){var c=0;r&&(c|=4),Cg(a,n,c,r)}var Ya="_reactListening"+Math.random().toString(36).slice(2);function Ss(n){if(!n[Ya]){n[Ya]=!0,o.forEach(function(a){a!=="selectionchange"&&(jy.has(a)||vc(a,!1,n),vc(a,!0,n))});var r=n.nodeType===9?n:n.ownerDocument;r===null||r[Ya]||(r[Ya]=!0,vc("selectionchange",!1,r))}}function Cg(n,r,a,c){switch(Kh(r)){case 1:var h=sy;break;case 4:h=ay;break;default:h=ec}a=h.bind(null,r,a,n),h=void 0,!ju||r!=="touchstart"&&r!=="touchmove"&&r!=="wheel"||(h=!0),c?h!==void 0?n.addEventListener(r,a,{capture:!0,passive:h}):n.addEventListener(r,a,!0):h!==void 0?n.addEventListener(r,a,{passive:h}):n.addEventListener(r,a,!1)}function Sc(n,r,a,c,h){var p=c;if((r&1)===0&&(r&2)===0&&c!==null)e:for(;;){if(c===null)return;var S=c.tag;if(S===3||S===4){var _=c.stateNode.containerInfo;if(_===h||_.nodeType===8&&_.parentNode===h)break;if(S===4)for(S=c.return;S!==null;){var R=S.tag;if((R===3||R===4)&&(R=S.stateNode.containerInfo,R===h||R.nodeType===8&&R.parentNode===h))return;S=S.return}for(;_!==null;){if(S=lr(_),S===null)return;if(R=S.tag,R===5||R===6){c=p=S;continue e}_=_.parentNode}}c=c.return}Oh(function(){var M=p,x=zu(a),z=[];e:{var G=Ig.get(n);if(G!==void 0){var q=ic,ee=n;switch(n){case"keypress":if(ba(a)===0)break e;case"keydown":case"keyup":q=Iy;break;case"focusin":ee="focus",q=sc;break;case"focusout":ee="blur",q=sc;break;case"beforeblur":case"afterblur":q=sc;break;case"click":if(a.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":q=Qh;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":q=cy;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":q=_y;break;case Sg:case yg:case Tg:q=hy;break;case Ag:q=Ry;break;case"scroll":q=ly;break;case"wheel":q=Ny;break;case"copy":case"cut":case"paste":q=py;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":q=eg}var oe=(r&4)!==0,lt=!oe&&n==="scroll",O=oe?G!==null?G+"Capture":null:G;oe=[];for(var N=M,k;N!==null;){k=N;var V=k.stateNode;if(k.tag===5&&V!==null&&(k=V,O!==null&&(V=es(N,O),V!=null&&oe.push(ys(N,V,k)))),lt)break;N=N.return}0<oe.length&&(G=new q(G,ee,null,a,x),z.push({event:G,listeners:oe}))}}if((r&7)===0){e:{if(G=n==="mouseover"||n==="pointerover",q=n==="mouseout"||n==="pointerout",G&&a!==$u&&(ee=a.relatedTarget||a.fromElement)&&(lr(ee)||ee[ni]))break e;if((q||G)&&(G=x.window===x?x:(G=x.ownerDocument)?G.defaultView||G.parentWindow:window,q?(ee=a.relatedTarget||a.toElement,q=M,ee=ee?lr(ee):null,ee!==null&&(lt=ar(ee),ee!==lt||ee.tag!==5&&ee.tag!==6)&&(ee=null)):(q=null,ee=M),q!==ee)){if(oe=Qh,V="onMouseLeave",O="onMouseEnter",N="mouse",(n==="pointerout"||n==="pointerover")&&(oe=eg,V="onPointerLeave",O="onPointerEnter",N="pointer"),lt=q==null?G:Jr(q),k=ee==null?G:Jr(ee),G=new oe(V,N+"leave",q,a,x),G.target=lt,G.relatedTarget=k,V=null,lr(x)===M&&(oe=new oe(O,N+"enter",ee,a,x),oe.target=k,oe.relatedTarget=lt,V=oe),lt=V,q&&ee)t:{for(oe=q,O=ee,N=0,k=oe;k;k=qr(k))N++;for(k=0,V=O;V;V=qr(V))k++;for(;0<N-k;)oe=qr(oe),N--;for(;0<k-N;)O=qr(O),k--;for(;N--;){if(oe===O||O!==null&&oe===O.alternate)break t;oe=qr(oe),O=qr(O)}oe=null}else oe=null;q!==null&&Rg(z,G,q,oe,!1),ee!==null&&lt!==null&&Rg(z,lt,ee,oe,!0)}}e:{if(G=M?Jr(M):window,q=G.nodeName&&G.nodeName.toLowerCase(),q==="select"||q==="input"&&G.type==="file")var ue=Uy;else if(sg(G))if(lg)ue=Gy;else{ue=Hy;var pe=By}else(q=G.nodeName)&&q.toLowerCase()==="input"&&(G.type==="checkbox"||G.type==="radio")&&(ue=by);if(ue&&(ue=ue(n,M))){ag(z,ue,a,x);break e}pe&&pe(n,G,M),n==="focusout"&&(pe=G._wrapperState)&&pe.controlled&&G.type==="number"&&$n(G,"number",G.value)}switch(pe=M?Jr(M):window,n){case"focusin":(sg(pe)||pe.contentEditable==="true")&&(Kr=pe,fc=M,ms=null);break;case"focusout":ms=fc=Kr=null;break;case"mousedown":hc=!0;break;case"contextmenu":case"mouseup":case"dragend":hc=!1,mg(z,a,x);break;case"selectionchange":if(zy)break;case"keydown":case"keyup":mg(z,a,x)}var me;if(lc)e:{switch(n){case"compositionstart":var we="onCompositionStart";break e;case"compositionend":we="onCompositionEnd";break e;case"compositionupdate":we="onCompositionUpdate";break e}we=void 0}else Xr?rg(n,a)&&(we="onCompositionEnd"):n==="keydown"&&a.keyCode===229&&(we="onCompositionStart");we&&(tg&&a.locale!=="ko"&&(Xr||we!=="onCompositionStart"?we==="onCompositionEnd"&&Xr&&(me=Zh()):(wi=x,nc="value"in wi?wi.value:wi.textContent,Xr=!0)),pe=ja(M,we),0<pe.length&&(we=new Jh(we,n,null,a,x),z.push({event:we,listeners:pe}),me?we.data=me:(me=og(a),me!==null&&(we.data=me)))),(me=Oy?ky(n,a):My(n,a))&&(M=ja(M,"onBeforeInput"),0<M.length&&(x=new Jh("onBeforeInput","beforeinput",null,a,x),z.push({event:x,listeners:M}),x.data=me))}_g(z,r)})}function ys(n,r,a){return{instance:n,listener:r,currentTarget:a}}function ja(n,r){for(var a=r+"Capture",c=[];n!==null;){var h=n,p=h.stateNode;h.tag===5&&p!==null&&(h=p,p=es(n,a),p!=null&&c.unshift(ys(n,p,h)),p=es(n,r),p!=null&&c.push(ys(n,p,h))),n=n.return}return c}function qr(n){if(n===null)return null;do n=n.return;while(n&&n.tag!==5);return n||null}function Rg(n,r,a,c,h){for(var p=r._reactName,S=[];a!==null&&a!==c;){var _=a,R=_.alternate,M=_.stateNode;if(R!==null&&R===c)break;_.tag===5&&M!==null&&(_=M,h?(R=es(a,p),R!=null&&S.unshift(ys(a,R,_))):h||(R=es(a,p),R!=null&&S.push(ys(a,R,_)))),a=a.return}S.length!==0&&n.push({event:r,listeners:S})}var Vy=/\r\n?/g,Xy=/\u0000|\uFFFD/g;function Pg(n){return(typeof n=="string"?n:""+n).replace(Vy,`
`).replace(Xy,"")}function Va(n,r,a){if(r=Pg(r),Pg(n)!==r&&a)throw Error(i(425))}function Xa(){}var yc=null,Tc=null;function Ac(n,r){return n==="textarea"||n==="noscript"||typeof r.children=="string"||typeof r.children=="number"||typeof r.dangerouslySetInnerHTML=="object"&&r.dangerouslySetInnerHTML!==null&&r.dangerouslySetInnerHTML.__html!=null}var Ic=typeof setTimeout=="function"?setTimeout:void 0,Ky=typeof clearTimeout=="function"?clearTimeout:void 0,Ng=typeof Promise=="function"?Promise:void 0,Zy=typeof queueMicrotask=="function"?queueMicrotask:typeof Ng<"u"?function(n){return Ng.resolve(null).then(n).catch(qy)}:Ic;function qy(n){setTimeout(function(){throw n})}function Ec(n,r){var a=r,c=0;do{var h=a.nextSibling;if(n.removeChild(a),h&&h.nodeType===8)if(a=h.data,a==="/$"){if(c===0){n.removeChild(h),us(r);return}c--}else a!=="$"&&a!=="$?"&&a!=="$!"||c++;a=h}while(a);us(r)}function Ci(n){for(;n!=null;n=n.nextSibling){var r=n.nodeType;if(r===1||r===3)break;if(r===8){if(r=n.data,r==="$"||r==="$!"||r==="$?")break;if(r==="/$")return null}}return n}function Dg(n){n=n.previousSibling;for(var r=0;n;){if(n.nodeType===8){var a=n.data;if(a==="$"||a==="$!"||a==="$?"){if(r===0)return n;r--}else a==="/$"&&r++}n=n.previousSibling}return null}var Qr=Math.random().toString(36).slice(2),Yn="__reactFiber$"+Qr,Ts="__reactProps$"+Qr,ni="__reactContainer$"+Qr,wc="__reactEvents$"+Qr,Qy="__reactListeners$"+Qr,Jy="__reactHandles$"+Qr;function lr(n){var r=n[Yn];if(r)return r;for(var a=n.parentNode;a;){if(r=a[ni]||a[Yn]){if(a=r.alternate,r.child!==null||a!==null&&a.child!==null)for(n=Dg(n);n!==null;){if(a=n[Yn])return a;n=Dg(n)}return r}n=a,a=n.parentNode}return null}function As(n){return n=n[Yn]||n[ni],!n||n.tag!==5&&n.tag!==6&&n.tag!==13&&n.tag!==3?null:n}function Jr(n){if(n.tag===5||n.tag===6)return n.stateNode;throw Error(i(33))}function Ka(n){return n[Ts]||null}var _c=[],eo=-1;function Ri(n){return{current:n}}function Ke(n){0>eo||(n.current=_c[eo],_c[eo]=null,eo--)}function Ye(n,r){eo++,_c[eo]=n.current,n.current=r}var Pi={},Nt=Ri(Pi),Wt=Ri(!1),ur=Pi;function to(n,r){var a=n.type.contextTypes;if(!a)return Pi;var c=n.stateNode;if(c&&c.__reactInternalMemoizedUnmaskedChildContext===r)return c.__reactInternalMemoizedMaskedChildContext;var h={},p;for(p in a)h[p]=r[p];return c&&(n=n.stateNode,n.__reactInternalMemoizedUnmaskedChildContext=r,n.__reactInternalMemoizedMaskedChildContext=h),h}function Yt(n){return n=n.childContextTypes,n!=null}function Za(){Ke(Wt),Ke(Nt)}function Og(n,r,a){if(Nt.current!==Pi)throw Error(i(168));Ye(Nt,r),Ye(Wt,a)}function kg(n,r,a){var c=n.stateNode;if(r=r.childContextTypes,typeof c.getChildContext!="function")return a;c=c.getChildContext();for(var h in c)if(!(h in r))throw Error(i(108,Ee(n)||"Unknown",h));return j({},a,c)}function qa(n){return n=(n=n.stateNode)&&n.__reactInternalMemoizedMergedChildContext||Pi,ur=Nt.current,Ye(Nt,n),Ye(Wt,Wt.current),!0}function Mg(n,r,a){var c=n.stateNode;if(!c)throw Error(i(169));a?(n=kg(n,r,ur),c.__reactInternalMemoizedMergedChildContext=n,Ke(Wt),Ke(Nt),Ye(Nt,n)):Ke(Wt),Ye(Wt,a)}var ii=null,Qa=!1,Cc=!1;function Fg(n){ii===null?ii=[n]:ii.push(n)}function eT(n){Qa=!0,Fg(n)}function Ni(){if(!Cc&&ii!==null){Cc=!0;var n=0,r=ze;try{var a=ii;for(ze=1;n<a.length;n++){var c=a[n];do c=c(!0);while(c!==null)}ii=null,Qa=!1}catch(h){throw ii!==null&&(ii=ii.slice(n+1)),Uh(Xu,Ni),h}finally{ze=r,Cc=!1}}return null}var no=[],io=0,Ja=null,el=0,dn=[],fn=0,cr=null,ri=1,oi="";function dr(n,r){no[io++]=el,no[io++]=Ja,Ja=n,el=r}function Lg(n,r,a){dn[fn++]=ri,dn[fn++]=oi,dn[fn++]=cr,cr=n;var c=ri;n=oi;var h=32-_n(c)-1;c&=~(1<<h),a+=1;var p=32-_n(r)+h;if(30<p){var S=h-h%5;p=(c&(1<<S)-1).toString(32),c>>=S,h-=S,ri=1<<32-_n(r)+h|a<<h|c,oi=p+n}else ri=1<<p|a<<h|c,oi=n}function Rc(n){n.return!==null&&(dr(n,1),Lg(n,1,0))}function Pc(n){for(;n===Ja;)Ja=no[--io],no[io]=null,el=no[--io],no[io]=null;for(;n===cr;)cr=dn[--fn],dn[fn]=null,oi=dn[--fn],dn[fn]=null,ri=dn[--fn],dn[fn]=null}var Jt=null,en=null,Qe=!1,Rn=null;function Ug(n,r){var a=mn(5,null,null,0);a.elementType="DELETED",a.stateNode=r,a.return=n,r=n.deletions,r===null?(n.deletions=[a],n.flags|=16):r.push(a)}function Bg(n,r){switch(n.tag){case 5:var a=n.type;return r=r.nodeType!==1||a.toLowerCase()!==r.nodeName.toLowerCase()?null:r,r!==null?(n.stateNode=r,Jt=n,en=Ci(r.firstChild),!0):!1;case 6:return r=n.pendingProps===""||r.nodeType!==3?null:r,r!==null?(n.stateNode=r,Jt=n,en=null,!0):!1;case 13:return r=r.nodeType!==8?null:r,r!==null?(a=cr!==null?{id:ri,overflow:oi}:null,n.memoizedState={dehydrated:r,treeContext:a,retryLane:1073741824},a=mn(18,null,null,0),a.stateNode=r,a.return=n,n.child=a,Jt=n,en=null,!0):!1;default:return!1}}function Nc(n){return(n.mode&1)!==0&&(n.flags&128)===0}function Dc(n){if(Qe){var r=en;if(r){var a=r;if(!Bg(n,r)){if(Nc(n))throw Error(i(418));r=Ci(a.nextSibling);var c=Jt;r&&Bg(n,r)?Ug(c,a):(n.flags=n.flags&-4097|2,Qe=!1,Jt=n)}}else{if(Nc(n))throw Error(i(418));n.flags=n.flags&-4097|2,Qe=!1,Jt=n}}}function Hg(n){for(n=n.return;n!==null&&n.tag!==5&&n.tag!==3&&n.tag!==13;)n=n.return;Jt=n}function tl(n){if(n!==Jt)return!1;if(!Qe)return Hg(n),Qe=!0,!1;var r;if((r=n.tag!==3)&&!(r=n.tag!==5)&&(r=n.type,r=r!=="head"&&r!=="body"&&!Ac(n.type,n.memoizedProps)),r&&(r=en)){if(Nc(n))throw bg(),Error(i(418));for(;r;)Ug(n,r),r=Ci(r.nextSibling)}if(Hg(n),n.tag===13){if(n=n.memoizedState,n=n!==null?n.dehydrated:null,!n)throw Error(i(317));e:{for(n=n.nextSibling,r=0;n;){if(n.nodeType===8){var a=n.data;if(a==="/$"){if(r===0){en=Ci(n.nextSibling);break e}r--}else a!=="$"&&a!=="$!"&&a!=="$?"||r++}n=n.nextSibling}en=null}}else en=Jt?Ci(n.stateNode.nextSibling):null;return!0}function bg(){for(var n=en;n;)n=Ci(n.nextSibling)}function ro(){en=Jt=null,Qe=!1}function Oc(n){Rn===null?Rn=[n]:Rn.push(n)}var tT=H.ReactCurrentBatchConfig;function Is(n,r,a){if(n=a.ref,n!==null&&typeof n!="function"&&typeof n!="object"){if(a._owner){if(a=a._owner,a){if(a.tag!==1)throw Error(i(309));var c=a.stateNode}if(!c)throw Error(i(147,n));var h=c,p=""+n;return r!==null&&r.ref!==null&&typeof r.ref=="function"&&r.ref._stringRef===p?r.ref:(r=function(S){var _=h.refs;S===null?delete _[p]:_[p]=S},r._stringRef=p,r)}if(typeof n!="string")throw Error(i(284));if(!a._owner)throw Error(i(290,n))}return n}function nl(n,r){throw n=Object.prototype.toString.call(r),Error(i(31,n==="[object Object]"?"object with keys {"+Object.keys(r).join(", ")+"}":n))}function Gg(n){var r=n._init;return r(n._payload)}function xg(n){function r(O,N){if(n){var k=O.deletions;k===null?(O.deletions=[N],O.flags|=16):k.push(N)}}function a(O,N){if(!n)return null;for(;N!==null;)r(O,N),N=N.sibling;return null}function c(O,N){for(O=new Map;N!==null;)N.key!==null?O.set(N.key,N):O.set(N.index,N),N=N.sibling;return O}function h(O,N){return O=Bi(O,N),O.index=0,O.sibling=null,O}function p(O,N,k){return O.index=k,n?(k=O.alternate,k!==null?(k=k.index,k<N?(O.flags|=2,N):k):(O.flags|=2,N)):(O.flags|=1048576,N)}function S(O){return n&&O.alternate===null&&(O.flags|=2),O}function _(O,N,k,V){return N===null||N.tag!==6?(N=Id(k,O.mode,V),N.return=O,N):(N=h(N,k),N.return=O,N)}function R(O,N,k,V){var ue=k.type;return ue===$?x(O,N,k.props.children,V,k.key):N!==null&&(N.elementType===ue||typeof ue=="object"&&ue!==null&&ue.$$typeof===Te&&Gg(ue)===N.type)?(V=h(N,k.props),V.ref=Is(O,N,k),V.return=O,V):(V=Cl(k.type,k.key,k.props,null,O.mode,V),V.ref=Is(O,N,k),V.return=O,V)}function M(O,N,k,V){return N===null||N.tag!==4||N.stateNode.containerInfo!==k.containerInfo||N.stateNode.implementation!==k.implementation?(N=Ed(k,O.mode,V),N.return=O,N):(N=h(N,k.children||[]),N.return=O,N)}function x(O,N,k,V,ue){return N===null||N.tag!==7?(N=yr(k,O.mode,V,ue),N.return=O,N):(N=h(N,k),N.return=O,N)}function z(O,N,k){if(typeof N=="string"&&N!==""||typeof N=="number")return N=Id(""+N,O.mode,k),N.return=O,N;if(typeof N=="object"&&N!==null){switch(N.$$typeof){case b:return k=Cl(N.type,N.key,N.props,null,O.mode,k),k.ref=Is(O,null,N),k.return=O,k;case L:return N=Ed(N,O.mode,k),N.return=O,N;case Te:var V=N._init;return z(O,V(N._payload),k)}if(zn(N)||X(N))return N=yr(N,O.mode,k,null),N.return=O,N;nl(O,N)}return null}function G(O,N,k,V){var ue=N!==null?N.key:null;if(typeof k=="string"&&k!==""||typeof k=="number")return ue!==null?null:_(O,N,""+k,V);if(typeof k=="object"&&k!==null){switch(k.$$typeof){case b:return k.key===ue?R(O,N,k,V):null;case L:return k.key===ue?M(O,N,k,V):null;case Te:return ue=k._init,G(O,N,ue(k._payload),V)}if(zn(k)||X(k))return ue!==null?null:x(O,N,k,V,null);nl(O,k)}return null}function q(O,N,k,V,ue){if(typeof V=="string"&&V!==""||typeof V=="number")return O=O.get(k)||null,_(N,O,""+V,ue);if(typeof V=="object"&&V!==null){switch(V.$$typeof){case b:return O=O.get(V.key===null?k:V.key)||null,R(N,O,V,ue);case L:return O=O.get(V.key===null?k:V.key)||null,M(N,O,V,ue);case Te:var pe=V._init;return q(O,N,k,pe(V._payload),ue)}if(zn(V)||X(V))return O=O.get(k)||null,x(N,O,V,ue,null);nl(N,V)}return null}function ee(O,N,k,V){for(var ue=null,pe=null,me=N,we=N=0,At=null;me!==null&&we<k.length;we++){me.index>we?(At=me,me=null):At=me.sibling;var Ge=G(O,me,k[we],V);if(Ge===null){me===null&&(me=At);break}n&&me&&Ge.alternate===null&&r(O,me),N=p(Ge,N,we),pe===null?ue=Ge:pe.sibling=Ge,pe=Ge,me=At}if(we===k.length)return a(O,me),Qe&&dr(O,we),ue;if(me===null){for(;we<k.length;we++)me=z(O,k[we],V),me!==null&&(N=p(me,N,we),pe===null?ue=me:pe.sibling=me,pe=me);return Qe&&dr(O,we),ue}for(me=c(O,me);we<k.length;we++)At=q(me,O,we,k[we],V),At!==null&&(n&&At.alternate!==null&&me.delete(At.key===null?we:At.key),N=p(At,N,we),pe===null?ue=At:pe.sibling=At,pe=At);return n&&me.forEach(function(Hi){return r(O,Hi)}),Qe&&dr(O,we),ue}function oe(O,N,k,V){var ue=X(k);if(typeof ue!="function")throw Error(i(150));if(k=ue.call(k),k==null)throw Error(i(151));for(var pe=ue=null,me=N,we=N=0,At=null,Ge=k.next();me!==null&&!Ge.done;we++,Ge=k.next()){me.index>we?(At=me,me=null):At=me.sibling;var Hi=G(O,me,Ge.value,V);if(Hi===null){me===null&&(me=At);break}n&&me&&Hi.alternate===null&&r(O,me),N=p(Hi,N,we),pe===null?ue=Hi:pe.sibling=Hi,pe=Hi,me=At}if(Ge.done)return a(O,me),Qe&&dr(O,we),ue;if(me===null){for(;!Ge.done;we++,Ge=k.next())Ge=z(O,Ge.value,V),Ge!==null&&(N=p(Ge,N,we),pe===null?ue=Ge:pe.sibling=Ge,pe=Ge);return Qe&&dr(O,we),ue}for(me=c(O,me);!Ge.done;we++,Ge=k.next())Ge=q(me,O,we,Ge.value,V),Ge!==null&&(n&&Ge.alternate!==null&&me.delete(Ge.key===null?we:Ge.key),N=p(Ge,N,we),pe===null?ue=Ge:pe.sibling=Ge,pe=Ge);return n&&me.forEach(function(FT){return r(O,FT)}),Qe&&dr(O,we),ue}function lt(O,N,k,V){if(typeof k=="object"&&k!==null&&k.type===$&&k.key===null&&(k=k.props.children),typeof k=="object"&&k!==null){switch(k.$$typeof){case b:e:{for(var ue=k.key,pe=N;pe!==null;){if(pe.key===ue){if(ue=k.type,ue===$){if(pe.tag===7){a(O,pe.sibling),N=h(pe,k.props.children),N.return=O,O=N;break e}}else if(pe.elementType===ue||typeof ue=="object"&&ue!==null&&ue.$$typeof===Te&&Gg(ue)===pe.type){a(O,pe.sibling),N=h(pe,k.props),N.ref=Is(O,pe,k),N.return=O,O=N;break e}a(O,pe);break}else r(O,pe);pe=pe.sibling}k.type===$?(N=yr(k.props.children,O.mode,V,k.key),N.return=O,O=N):(V=Cl(k.type,k.key,k.props,null,O.mode,V),V.ref=Is(O,N,k),V.return=O,O=V)}return S(O);case L:e:{for(pe=k.key;N!==null;){if(N.key===pe)if(N.tag===4&&N.stateNode.containerInfo===k.containerInfo&&N.stateNode.implementation===k.implementation){a(O,N.sibling),N=h(N,k.children||[]),N.return=O,O=N;break e}else{a(O,N);break}else r(O,N);N=N.sibling}N=Ed(k,O.mode,V),N.return=O,O=N}return S(O);case Te:return pe=k._init,lt(O,N,pe(k._payload),V)}if(zn(k))return ee(O,N,k,V);if(X(k))return oe(O,N,k,V);nl(O,k)}return typeof k=="string"&&k!==""||typeof k=="number"?(k=""+k,N!==null&&N.tag===6?(a(O,N.sibling),N=h(N,k),N.return=O,O=N):(a(O,N),N=Id(k,O.mode,V),N.return=O,O=N),S(O)):a(O,N)}return lt}var oo=xg(!0),$g=xg(!1),il=Ri(null),rl=null,so=null,kc=null;function Mc(){kc=so=rl=null}function Fc(n){var r=il.current;Ke(il),n._currentValue=r}function Lc(n,r,a){for(;n!==null;){var c=n.alternate;if((n.childLanes&r)!==r?(n.childLanes|=r,c!==null&&(c.childLanes|=r)):c!==null&&(c.childLanes&r)!==r&&(c.childLanes|=r),n===a)break;n=n.return}}function ao(n,r){rl=n,kc=so=null,n=n.dependencies,n!==null&&n.firstContext!==null&&((n.lanes&r)!==0&&(jt=!0),n.firstContext=null)}function hn(n){var r=n._currentValue;if(kc!==n)if(n={context:n,memoizedValue:r,next:null},so===null){if(rl===null)throw Error(i(308));so=n,rl.dependencies={lanes:0,firstContext:n}}else so=so.next=n;return r}var fr=null;function Uc(n){fr===null?fr=[n]:fr.push(n)}function zg(n,r,a,c){var h=r.interleaved;return h===null?(a.next=a,Uc(r)):(a.next=h.next,h.next=a),r.interleaved=a,si(n,c)}function si(n,r){n.lanes|=r;var a=n.alternate;for(a!==null&&(a.lanes|=r),a=n,n=n.return;n!==null;)n.childLanes|=r,a=n.alternate,a!==null&&(a.childLanes|=r),a=n,n=n.return;return a.tag===3?a.stateNode:null}var Di=!1;function Bc(n){n.updateQueue={baseState:n.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Wg(n,r){n=n.updateQueue,r.updateQueue===n&&(r.updateQueue={baseState:n.baseState,firstBaseUpdate:n.firstBaseUpdate,lastBaseUpdate:n.lastBaseUpdate,shared:n.shared,effects:n.effects})}function ai(n,r){return{eventTime:n,lane:r,tag:0,payload:null,callback:null,next:null}}function Oi(n,r,a){var c=n.updateQueue;if(c===null)return null;if(c=c.shared,(He&2)!==0){var h=c.pending;return h===null?r.next=r:(r.next=h.next,h.next=r),c.pending=r,si(n,a)}return h=c.interleaved,h===null?(r.next=r,Uc(c)):(r.next=h.next,h.next=r),c.interleaved=r,si(n,a)}function ol(n,r,a){if(r=r.updateQueue,r!==null&&(r=r.shared,(a&4194240)!==0)){var c=r.lanes;c&=n.pendingLanes,a|=c,r.lanes=a,qu(n,a)}}function Yg(n,r){var a=n.updateQueue,c=n.alternate;if(c!==null&&(c=c.updateQueue,a===c)){var h=null,p=null;if(a=a.firstBaseUpdate,a!==null){do{var S={eventTime:a.eventTime,lane:a.lane,tag:a.tag,payload:a.payload,callback:a.callback,next:null};p===null?h=p=S:p=p.next=S,a=a.next}while(a!==null);p===null?h=p=r:p=p.next=r}else h=p=r;a={baseState:c.baseState,firstBaseUpdate:h,lastBaseUpdate:p,shared:c.shared,effects:c.effects},n.updateQueue=a;return}n=a.lastBaseUpdate,n===null?a.firstBaseUpdate=r:n.next=r,a.lastBaseUpdate=r}function sl(n,r,a,c){var h=n.updateQueue;Di=!1;var p=h.firstBaseUpdate,S=h.lastBaseUpdate,_=h.shared.pending;if(_!==null){h.shared.pending=null;var R=_,M=R.next;R.next=null,S===null?p=M:S.next=M,S=R;var x=n.alternate;x!==null&&(x=x.updateQueue,_=x.lastBaseUpdate,_!==S&&(_===null?x.firstBaseUpdate=M:_.next=M,x.lastBaseUpdate=R))}if(p!==null){var z=h.baseState;S=0,x=M=R=null,_=p;do{var G=_.lane,q=_.eventTime;if((c&G)===G){x!==null&&(x=x.next={eventTime:q,lane:0,tag:_.tag,payload:_.payload,callback:_.callback,next:null});e:{var ee=n,oe=_;switch(G=r,q=a,oe.tag){case 1:if(ee=oe.payload,typeof ee=="function"){z=ee.call(q,z,G);break e}z=ee;break e;case 3:ee.flags=ee.flags&-65537|128;case 0:if(ee=oe.payload,G=typeof ee=="function"?ee.call(q,z,G):ee,G==null)break e;z=j({},z,G);break e;case 2:Di=!0}}_.callback!==null&&_.lane!==0&&(n.flags|=64,G=h.effects,G===null?h.effects=[_]:G.push(_))}else q={eventTime:q,lane:G,tag:_.tag,payload:_.payload,callback:_.callback,next:null},x===null?(M=x=q,R=z):x=x.next=q,S|=G;if(_=_.next,_===null){if(_=h.shared.pending,_===null)break;G=_,_=G.next,G.next=null,h.lastBaseUpdate=G,h.shared.pending=null}}while(!0);if(x===null&&(R=z),h.baseState=R,h.firstBaseUpdate=M,h.lastBaseUpdate=x,r=h.shared.interleaved,r!==null){h=r;do S|=h.lane,h=h.next;while(h!==r)}else p===null&&(h.shared.lanes=0);pr|=S,n.lanes=S,n.memoizedState=z}}function jg(n,r,a){if(n=r.effects,r.effects=null,n!==null)for(r=0;r<n.length;r++){var c=n[r],h=c.callback;if(h!==null){if(c.callback=null,c=a,typeof h!="function")throw Error(i(191,h));h.call(c)}}}var Es={},jn=Ri(Es),ws=Ri(Es),_s=Ri(Es);function hr(n){if(n===Es)throw Error(i(174));return n}function Hc(n,r){switch(Ye(_s,r),Ye(ws,n),Ye(jn,Es),n=r.nodeType,n){case 9:case 11:r=(r=r.documentElement)?r.namespaceURI:bu(null,"");break;default:n=n===8?r.parentNode:r,r=n.namespaceURI||null,n=n.tagName,r=bu(r,n)}Ke(jn),Ye(jn,r)}function lo(){Ke(jn),Ke(ws),Ke(_s)}function Vg(n){hr(_s.current);var r=hr(jn.current),a=bu(r,n.type);r!==a&&(Ye(ws,n),Ye(jn,a))}function bc(n){ws.current===n&&(Ke(jn),Ke(ws))}var nt=Ri(0);function al(n){for(var r=n;r!==null;){if(r.tag===13){var a=r.memoizedState;if(a!==null&&(a=a.dehydrated,a===null||a.data==="$?"||a.data==="$!"))return r}else if(r.tag===19&&r.memoizedProps.revealOrder!==void 0){if((r.flags&128)!==0)return r}else if(r.child!==null){r.child.return=r,r=r.child;continue}if(r===n)break;for(;r.sibling===null;){if(r.return===null||r.return===n)return null;r=r.return}r.sibling.return=r.return,r=r.sibling}return null}var Gc=[];function xc(){for(var n=0;n<Gc.length;n++)Gc[n]._workInProgressVersionPrimary=null;Gc.length=0}var ll=H.ReactCurrentDispatcher,$c=H.ReactCurrentBatchConfig,gr=0,it=null,gt=null,yt=null,ul=!1,Cs=!1,Rs=0,nT=0;function Dt(){throw Error(i(321))}function zc(n,r){if(r===null)return!1;for(var a=0;a<r.length&&a<n.length;a++)if(!Cn(n[a],r[a]))return!1;return!0}function Wc(n,r,a,c,h,p){if(gr=p,it=r,r.memoizedState=null,r.updateQueue=null,r.lanes=0,ll.current=n===null||n.memoizedState===null?sT:aT,n=a(c,h),Cs){p=0;do{if(Cs=!1,Rs=0,25<=p)throw Error(i(301));p+=1,yt=gt=null,r.updateQueue=null,ll.current=lT,n=a(c,h)}while(Cs)}if(ll.current=fl,r=gt!==null&&gt.next!==null,gr=0,yt=gt=it=null,ul=!1,r)throw Error(i(300));return n}function Yc(){var n=Rs!==0;return Rs=0,n}function Vn(){var n={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return yt===null?it.memoizedState=yt=n:yt=yt.next=n,yt}function gn(){if(gt===null){var n=it.alternate;n=n!==null?n.memoizedState:null}else n=gt.next;var r=yt===null?it.memoizedState:yt.next;if(r!==null)yt=r,gt=n;else{if(n===null)throw Error(i(310));gt=n,n={memoizedState:gt.memoizedState,baseState:gt.baseState,baseQueue:gt.baseQueue,queue:gt.queue,next:null},yt===null?it.memoizedState=yt=n:yt=yt.next=n}return yt}function Ps(n,r){return typeof r=="function"?r(n):r}function jc(n){var r=gn(),a=r.queue;if(a===null)throw Error(i(311));a.lastRenderedReducer=n;var c=gt,h=c.baseQueue,p=a.pending;if(p!==null){if(h!==null){var S=h.next;h.next=p.next,p.next=S}c.baseQueue=h=p,a.pending=null}if(h!==null){p=h.next,c=c.baseState;var _=S=null,R=null,M=p;do{var x=M.lane;if((gr&x)===x)R!==null&&(R=R.next={lane:0,action:M.action,hasEagerState:M.hasEagerState,eagerState:M.eagerState,next:null}),c=M.hasEagerState?M.eagerState:n(c,M.action);else{var z={lane:x,action:M.action,hasEagerState:M.hasEagerState,eagerState:M.eagerState,next:null};R===null?(_=R=z,S=c):R=R.next=z,it.lanes|=x,pr|=x}M=M.next}while(M!==null&&M!==p);R===null?S=c:R.next=_,Cn(c,r.memoizedState)||(jt=!0),r.memoizedState=c,r.baseState=S,r.baseQueue=R,a.lastRenderedState=c}if(n=a.interleaved,n!==null){h=n;do p=h.lane,it.lanes|=p,pr|=p,h=h.next;while(h!==n)}else h===null&&(a.lanes=0);return[r.memoizedState,a.dispatch]}function Vc(n){var r=gn(),a=r.queue;if(a===null)throw Error(i(311));a.lastRenderedReducer=n;var c=a.dispatch,h=a.pending,p=r.memoizedState;if(h!==null){a.pending=null;var S=h=h.next;do p=n(p,S.action),S=S.next;while(S!==h);Cn(p,r.memoizedState)||(jt=!0),r.memoizedState=p,r.baseQueue===null&&(r.baseState=p),a.lastRenderedState=p}return[p,c]}function Xg(){}function Kg(n,r){var a=it,c=gn(),h=r(),p=!Cn(c.memoizedState,h);if(p&&(c.memoizedState=h,jt=!0),c=c.queue,Xc(Qg.bind(null,a,c,n),[n]),c.getSnapshot!==r||p||yt!==null&&yt.memoizedState.tag&1){if(a.flags|=2048,Ns(9,qg.bind(null,a,c,h,r),void 0,null),Tt===null)throw Error(i(349));(gr&30)!==0||Zg(a,r,h)}return h}function Zg(n,r,a){n.flags|=16384,n={getSnapshot:r,value:a},r=it.updateQueue,r===null?(r={lastEffect:null,stores:null},it.updateQueue=r,r.stores=[n]):(a=r.stores,a===null?r.stores=[n]:a.push(n))}function qg(n,r,a,c){r.value=a,r.getSnapshot=c,Jg(r)&&ep(n)}function Qg(n,r,a){return a(function(){Jg(r)&&ep(n)})}function Jg(n){var r=n.getSnapshot;n=n.value;try{var a=r();return!Cn(n,a)}catch{return!0}}function ep(n){var r=si(n,1);r!==null&&On(r,n,1,-1)}function tp(n){var r=Vn();return typeof n=="function"&&(n=n()),r.memoizedState=r.baseState=n,n={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Ps,lastRenderedState:n},r.queue=n,n=n.dispatch=oT.bind(null,it,n),[r.memoizedState,n]}function Ns(n,r,a,c){return n={tag:n,create:r,destroy:a,deps:c,next:null},r=it.updateQueue,r===null?(r={lastEffect:null,stores:null},it.updateQueue=r,r.lastEffect=n.next=n):(a=r.lastEffect,a===null?r.lastEffect=n.next=n:(c=a.next,a.next=n,n.next=c,r.lastEffect=n)),n}function np(){return gn().memoizedState}function cl(n,r,a,c){var h=Vn();it.flags|=n,h.memoizedState=Ns(1|r,a,void 0,c===void 0?null:c)}function dl(n,r,a,c){var h=gn();c=c===void 0?null:c;var p=void 0;if(gt!==null){var S=gt.memoizedState;if(p=S.destroy,c!==null&&zc(c,S.deps)){h.memoizedState=Ns(r,a,p,c);return}}it.flags|=n,h.memoizedState=Ns(1|r,a,p,c)}function ip(n,r){return cl(8390656,8,n,r)}function Xc(n,r){return dl(2048,8,n,r)}function rp(n,r){return dl(4,2,n,r)}function op(n,r){return dl(4,4,n,r)}function sp(n,r){if(typeof r=="function")return n=n(),r(n),function(){r(null)};if(r!=null)return n=n(),r.current=n,function(){r.current=null}}function ap(n,r,a){return a=a!=null?a.concat([n]):null,dl(4,4,sp.bind(null,r,n),a)}function Kc(){}function lp(n,r){var a=gn();r=r===void 0?null:r;var c=a.memoizedState;return c!==null&&r!==null&&zc(r,c[1])?c[0]:(a.memoizedState=[n,r],n)}function up(n,r){var a=gn();r=r===void 0?null:r;var c=a.memoizedState;return c!==null&&r!==null&&zc(r,c[1])?c[0]:(n=n(),a.memoizedState=[n,r],n)}function cp(n,r,a){return(gr&21)===0?(n.baseState&&(n.baseState=!1,jt=!0),n.memoizedState=a):(Cn(a,r)||(a=Gh(),it.lanes|=a,pr|=a,n.baseState=!0),r)}function iT(n,r){var a=ze;ze=a!==0&&4>a?a:4,n(!0);var c=$c.transition;$c.transition={};try{n(!1),r()}finally{ze=a,$c.transition=c}}function dp(){return gn().memoizedState}function rT(n,r,a){var c=Li(n);if(a={lane:c,action:a,hasEagerState:!1,eagerState:null,next:null},fp(n))hp(r,a);else if(a=zg(n,r,a,c),a!==null){var h=Bt();On(a,n,c,h),gp(a,r,c)}}function oT(n,r,a){var c=Li(n),h={lane:c,action:a,hasEagerState:!1,eagerState:null,next:null};if(fp(n))hp(r,h);else{var p=n.alternate;if(n.lanes===0&&(p===null||p.lanes===0)&&(p=r.lastRenderedReducer,p!==null))try{var S=r.lastRenderedState,_=p(S,a);if(h.hasEagerState=!0,h.eagerState=_,Cn(_,S)){var R=r.interleaved;R===null?(h.next=h,Uc(r)):(h.next=R.next,R.next=h),r.interleaved=h;return}}catch{}finally{}a=zg(n,r,h,c),a!==null&&(h=Bt(),On(a,n,c,h),gp(a,r,c))}}function fp(n){var r=n.alternate;return n===it||r!==null&&r===it}function hp(n,r){Cs=ul=!0;var a=n.pending;a===null?r.next=r:(r.next=a.next,a.next=r),n.pending=r}function gp(n,r,a){if((a&4194240)!==0){var c=r.lanes;c&=n.pendingLanes,a|=c,r.lanes=a,qu(n,a)}}var fl={readContext:hn,useCallback:Dt,useContext:Dt,useEffect:Dt,useImperativeHandle:Dt,useInsertionEffect:Dt,useLayoutEffect:Dt,useMemo:Dt,useReducer:Dt,useRef:Dt,useState:Dt,useDebugValue:Dt,useDeferredValue:Dt,useTransition:Dt,useMutableSource:Dt,useSyncExternalStore:Dt,useId:Dt,unstable_isNewReconciler:!1},sT={readContext:hn,useCallback:function(n,r){return Vn().memoizedState=[n,r===void 0?null:r],n},useContext:hn,useEffect:ip,useImperativeHandle:function(n,r,a){return a=a!=null?a.concat([n]):null,cl(4194308,4,sp.bind(null,r,n),a)},useLayoutEffect:function(n,r){return cl(4194308,4,n,r)},useInsertionEffect:function(n,r){return cl(4,2,n,r)},useMemo:function(n,r){var a=Vn();return r=r===void 0?null:r,n=n(),a.memoizedState=[n,r],n},useReducer:function(n,r,a){var c=Vn();return r=a!==void 0?a(r):r,c.memoizedState=c.baseState=r,n={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:n,lastRenderedState:r},c.queue=n,n=n.dispatch=rT.bind(null,it,n),[c.memoizedState,n]},useRef:function(n){var r=Vn();return n={current:n},r.memoizedState=n},useState:tp,useDebugValue:Kc,useDeferredValue:function(n){return Vn().memoizedState=n},useTransition:function(){var n=tp(!1),r=n[0];return n=iT.bind(null,n[1]),Vn().memoizedState=n,[r,n]},useMutableSource:function(){},useSyncExternalStore:function(n,r,a){var c=it,h=Vn();if(Qe){if(a===void 0)throw Error(i(407));a=a()}else{if(a=r(),Tt===null)throw Error(i(349));(gr&30)!==0||Zg(c,r,a)}h.memoizedState=a;var p={value:a,getSnapshot:r};return h.queue=p,ip(Qg.bind(null,c,p,n),[n]),c.flags|=2048,Ns(9,qg.bind(null,c,p,a,r),void 0,null),a},useId:function(){var n=Vn(),r=Tt.identifierPrefix;if(Qe){var a=oi,c=ri;a=(c&~(1<<32-_n(c)-1)).toString(32)+a,r=":"+r+"R"+a,a=Rs++,0<a&&(r+="H"+a.toString(32)),r+=":"}else a=nT++,r=":"+r+"r"+a.toString(32)+":";return n.memoizedState=r},unstable_isNewReconciler:!1},aT={readContext:hn,useCallback:lp,useContext:hn,useEffect:Xc,useImperativeHandle:ap,useInsertionEffect:rp,useLayoutEffect:op,useMemo:up,useReducer:jc,useRef:np,useState:function(){return jc(Ps)},useDebugValue:Kc,useDeferredValue:function(n){var r=gn();return cp(r,gt.memoizedState,n)},useTransition:function(){var n=jc(Ps)[0],r=gn().memoizedState;return[n,r]},useMutableSource:Xg,useSyncExternalStore:Kg,useId:dp,unstable_isNewReconciler:!1},lT={readContext:hn,useCallback:lp,useContext:hn,useEffect:Xc,useImperativeHandle:ap,useInsertionEffect:rp,useLayoutEffect:op,useMemo:up,useReducer:Vc,useRef:np,useState:function(){return Vc(Ps)},useDebugValue:Kc,useDeferredValue:function(n){var r=gn();return gt===null?r.memoizedState=n:cp(r,gt.memoizedState,n)},useTransition:function(){var n=Vc(Ps)[0],r=gn().memoizedState;return[n,r]},useMutableSource:Xg,useSyncExternalStore:Kg,useId:dp,unstable_isNewReconciler:!1};function Pn(n,r){if(n&&n.defaultProps){r=j({},r),n=n.defaultProps;for(var a in n)r[a]===void 0&&(r[a]=n[a]);return r}return r}function Zc(n,r,a,c){r=n.memoizedState,a=a(c,r),a=a==null?r:j({},r,a),n.memoizedState=a,n.lanes===0&&(n.updateQueue.baseState=a)}var hl={isMounted:function(n){return(n=n._reactInternals)?ar(n)===n:!1},enqueueSetState:function(n,r,a){n=n._reactInternals;var c=Bt(),h=Li(n),p=ai(c,h);p.payload=r,a!=null&&(p.callback=a),r=Oi(n,p,h),r!==null&&(On(r,n,h,c),ol(r,n,h))},enqueueReplaceState:function(n,r,a){n=n._reactInternals;var c=Bt(),h=Li(n),p=ai(c,h);p.tag=1,p.payload=r,a!=null&&(p.callback=a),r=Oi(n,p,h),r!==null&&(On(r,n,h,c),ol(r,n,h))},enqueueForceUpdate:function(n,r){n=n._reactInternals;var a=Bt(),c=Li(n),h=ai(a,c);h.tag=2,r!=null&&(h.callback=r),r=Oi(n,h,c),r!==null&&(On(r,n,c,a),ol(r,n,c))}};function pp(n,r,a,c,h,p,S){return n=n.stateNode,typeof n.shouldComponentUpdate=="function"?n.shouldComponentUpdate(c,p,S):r.prototype&&r.prototype.isPureReactComponent?!ps(a,c)||!ps(h,p):!0}function mp(n,r,a){var c=!1,h=Pi,p=r.contextType;return typeof p=="object"&&p!==null?p=hn(p):(h=Yt(r)?ur:Nt.current,c=r.contextTypes,p=(c=c!=null)?to(n,h):Pi),r=new r(a,p),n.memoizedState=r.state!==null&&r.state!==void 0?r.state:null,r.updater=hl,n.stateNode=r,r._reactInternals=n,c&&(n=n.stateNode,n.__reactInternalMemoizedUnmaskedChildContext=h,n.__reactInternalMemoizedMaskedChildContext=p),r}function vp(n,r,a,c){n=r.state,typeof r.componentWillReceiveProps=="function"&&r.componentWillReceiveProps(a,c),typeof r.UNSAFE_componentWillReceiveProps=="function"&&r.UNSAFE_componentWillReceiveProps(a,c),r.state!==n&&hl.enqueueReplaceState(r,r.state,null)}function qc(n,r,a,c){var h=n.stateNode;h.props=a,h.state=n.memoizedState,h.refs={},Bc(n);var p=r.contextType;typeof p=="object"&&p!==null?h.context=hn(p):(p=Yt(r)?ur:Nt.current,h.context=to(n,p)),h.state=n.memoizedState,p=r.getDerivedStateFromProps,typeof p=="function"&&(Zc(n,r,p,a),h.state=n.memoizedState),typeof r.getDerivedStateFromProps=="function"||typeof h.getSnapshotBeforeUpdate=="function"||typeof h.UNSAFE_componentWillMount!="function"&&typeof h.componentWillMount!="function"||(r=h.state,typeof h.componentWillMount=="function"&&h.componentWillMount(),typeof h.UNSAFE_componentWillMount=="function"&&h.UNSAFE_componentWillMount(),r!==h.state&&hl.enqueueReplaceState(h,h.state,null),sl(n,a,h,c),h.state=n.memoizedState),typeof h.componentDidMount=="function"&&(n.flags|=4194308)}function uo(n,r){try{var a="",c=r;do a+=ve(c),c=c.return;while(c);var h=a}catch(p){h=`
Error generating stack: `+p.message+`
`+p.stack}return{value:n,source:r,stack:h,digest:null}}function Qc(n,r,a){return{value:n,source:null,stack:a??null,digest:r??null}}function Jc(n,r){try{console.error(r.value)}catch(a){setTimeout(function(){throw a})}}var uT=typeof WeakMap=="function"?WeakMap:Map;function Sp(n,r,a){a=ai(-1,a),a.tag=3,a.payload={element:null};var c=r.value;return a.callback=function(){Tl||(Tl=!0,gd=c),Jc(n,r)},a}function yp(n,r,a){a=ai(-1,a),a.tag=3;var c=n.type.getDerivedStateFromError;if(typeof c=="function"){var h=r.value;a.payload=function(){return c(h)},a.callback=function(){Jc(n,r)}}var p=n.stateNode;return p!==null&&typeof p.componentDidCatch=="function"&&(a.callback=function(){Jc(n,r),typeof c!="function"&&(Mi===null?Mi=new Set([this]):Mi.add(this));var S=r.stack;this.componentDidCatch(r.value,{componentStack:S!==null?S:""})}),a}function Tp(n,r,a){var c=n.pingCache;if(c===null){c=n.pingCache=new uT;var h=new Set;c.set(r,h)}else h=c.get(r),h===void 0&&(h=new Set,c.set(r,h));h.has(a)||(h.add(a),n=ET.bind(null,n,r,a),r.then(n,n))}function Ap(n){do{var r;if((r=n.tag===13)&&(r=n.memoizedState,r=r!==null?r.dehydrated!==null:!0),r)return n;n=n.return}while(n!==null);return null}function Ip(n,r,a,c,h){return(n.mode&1)===0?(n===r?n.flags|=65536:(n.flags|=128,a.flags|=131072,a.flags&=-52805,a.tag===1&&(a.alternate===null?a.tag=17:(r=ai(-1,1),r.tag=2,Oi(a,r,1))),a.lanes|=1),n):(n.flags|=65536,n.lanes=h,n)}var cT=H.ReactCurrentOwner,jt=!1;function Ut(n,r,a,c){r.child=n===null?$g(r,null,a,c):oo(r,n.child,a,c)}function Ep(n,r,a,c,h){a=a.render;var p=r.ref;return ao(r,h),c=Wc(n,r,a,c,p,h),a=Yc(),n!==null&&!jt?(r.updateQueue=n.updateQueue,r.flags&=-2053,n.lanes&=~h,li(n,r,h)):(Qe&&a&&Rc(r),r.flags|=1,Ut(n,r,c,h),r.child)}function wp(n,r,a,c,h){if(n===null){var p=a.type;return typeof p=="function"&&!Ad(p)&&p.defaultProps===void 0&&a.compare===null&&a.defaultProps===void 0?(r.tag=15,r.type=p,_p(n,r,p,c,h)):(n=Cl(a.type,null,c,r,r.mode,h),n.ref=r.ref,n.return=r,r.child=n)}if(p=n.child,(n.lanes&h)===0){var S=p.memoizedProps;if(a=a.compare,a=a!==null?a:ps,a(S,c)&&n.ref===r.ref)return li(n,r,h)}return r.flags|=1,n=Bi(p,c),n.ref=r.ref,n.return=r,r.child=n}function _p(n,r,a,c,h){if(n!==null){var p=n.memoizedProps;if(ps(p,c)&&n.ref===r.ref)if(jt=!1,r.pendingProps=c=p,(n.lanes&h)!==0)(n.flags&131072)!==0&&(jt=!0);else return r.lanes=n.lanes,li(n,r,h)}return ed(n,r,a,c,h)}function Cp(n,r,a){var c=r.pendingProps,h=c.children,p=n!==null?n.memoizedState:null;if(c.mode==="hidden")if((r.mode&1)===0)r.memoizedState={baseLanes:0,cachePool:null,transitions:null},Ye(fo,tn),tn|=a;else{if((a&1073741824)===0)return n=p!==null?p.baseLanes|a:a,r.lanes=r.childLanes=1073741824,r.memoizedState={baseLanes:n,cachePool:null,transitions:null},r.updateQueue=null,Ye(fo,tn),tn|=n,null;r.memoizedState={baseLanes:0,cachePool:null,transitions:null},c=p!==null?p.baseLanes:a,Ye(fo,tn),tn|=c}else p!==null?(c=p.baseLanes|a,r.memoizedState=null):c=a,Ye(fo,tn),tn|=c;return Ut(n,r,h,a),r.child}function Rp(n,r){var a=r.ref;(n===null&&a!==null||n!==null&&n.ref!==a)&&(r.flags|=512,r.flags|=2097152)}function ed(n,r,a,c,h){var p=Yt(a)?ur:Nt.current;return p=to(r,p),ao(r,h),a=Wc(n,r,a,c,p,h),c=Yc(),n!==null&&!jt?(r.updateQueue=n.updateQueue,r.flags&=-2053,n.lanes&=~h,li(n,r,h)):(Qe&&c&&Rc(r),r.flags|=1,Ut(n,r,a,h),r.child)}function Pp(n,r,a,c,h){if(Yt(a)){var p=!0;qa(r)}else p=!1;if(ao(r,h),r.stateNode===null)pl(n,r),mp(r,a,c),qc(r,a,c,h),c=!0;else if(n===null){var S=r.stateNode,_=r.memoizedProps;S.props=_;var R=S.context,M=a.contextType;typeof M=="object"&&M!==null?M=hn(M):(M=Yt(a)?ur:Nt.current,M=to(r,M));var x=a.getDerivedStateFromProps,z=typeof x=="function"||typeof S.getSnapshotBeforeUpdate=="function";z||typeof S.UNSAFE_componentWillReceiveProps!="function"&&typeof S.componentWillReceiveProps!="function"||(_!==c||R!==M)&&vp(r,S,c,M),Di=!1;var G=r.memoizedState;S.state=G,sl(r,c,S,h),R=r.memoizedState,_!==c||G!==R||Wt.current||Di?(typeof x=="function"&&(Zc(r,a,x,c),R=r.memoizedState),(_=Di||pp(r,a,_,c,G,R,M))?(z||typeof S.UNSAFE_componentWillMount!="function"&&typeof S.componentWillMount!="function"||(typeof S.componentWillMount=="function"&&S.componentWillMount(),typeof S.UNSAFE_componentWillMount=="function"&&S.UNSAFE_componentWillMount()),typeof S.componentDidMount=="function"&&(r.flags|=4194308)):(typeof S.componentDidMount=="function"&&(r.flags|=4194308),r.memoizedProps=c,r.memoizedState=R),S.props=c,S.state=R,S.context=M,c=_):(typeof S.componentDidMount=="function"&&(r.flags|=4194308),c=!1)}else{S=r.stateNode,Wg(n,r),_=r.memoizedProps,M=r.type===r.elementType?_:Pn(r.type,_),S.props=M,z=r.pendingProps,G=S.context,R=a.contextType,typeof R=="object"&&R!==null?R=hn(R):(R=Yt(a)?ur:Nt.current,R=to(r,R));var q=a.getDerivedStateFromProps;(x=typeof q=="function"||typeof S.getSnapshotBeforeUpdate=="function")||typeof S.UNSAFE_componentWillReceiveProps!="function"&&typeof S.componentWillReceiveProps!="function"||(_!==z||G!==R)&&vp(r,S,c,R),Di=!1,G=r.memoizedState,S.state=G,sl(r,c,S,h);var ee=r.memoizedState;_!==z||G!==ee||Wt.current||Di?(typeof q=="function"&&(Zc(r,a,q,c),ee=r.memoizedState),(M=Di||pp(r,a,M,c,G,ee,R)||!1)?(x||typeof S.UNSAFE_componentWillUpdate!="function"&&typeof S.componentWillUpdate!="function"||(typeof S.componentWillUpdate=="function"&&S.componentWillUpdate(c,ee,R),typeof S.UNSAFE_componentWillUpdate=="function"&&S.UNSAFE_componentWillUpdate(c,ee,R)),typeof S.componentDidUpdate=="function"&&(r.flags|=4),typeof S.getSnapshotBeforeUpdate=="function"&&(r.flags|=1024)):(typeof S.componentDidUpdate!="function"||_===n.memoizedProps&&G===n.memoizedState||(r.flags|=4),typeof S.getSnapshotBeforeUpdate!="function"||_===n.memoizedProps&&G===n.memoizedState||(r.flags|=1024),r.memoizedProps=c,r.memoizedState=ee),S.props=c,S.state=ee,S.context=R,c=M):(typeof S.componentDidUpdate!="function"||_===n.memoizedProps&&G===n.memoizedState||(r.flags|=4),typeof S.getSnapshotBeforeUpdate!="function"||_===n.memoizedProps&&G===n.memoizedState||(r.flags|=1024),c=!1)}return td(n,r,a,c,p,h)}function td(n,r,a,c,h,p){Rp(n,r);var S=(r.flags&128)!==0;if(!c&&!S)return h&&Mg(r,a,!1),li(n,r,p);c=r.stateNode,cT.current=r;var _=S&&typeof a.getDerivedStateFromError!="function"?null:c.render();return r.flags|=1,n!==null&&S?(r.child=oo(r,n.child,null,p),r.child=oo(r,null,_,p)):Ut(n,r,_,p),r.memoizedState=c.state,h&&Mg(r,a,!0),r.child}function Np(n){var r=n.stateNode;r.pendingContext?Og(n,r.pendingContext,r.pendingContext!==r.context):r.context&&Og(n,r.context,!1),Hc(n,r.containerInfo)}function Dp(n,r,a,c,h){return ro(),Oc(h),r.flags|=256,Ut(n,r,a,c),r.child}var nd={dehydrated:null,treeContext:null,retryLane:0};function id(n){return{baseLanes:n,cachePool:null,transitions:null}}function Op(n,r,a){var c=r.pendingProps,h=nt.current,p=!1,S=(r.flags&128)!==0,_;if((_=S)||(_=n!==null&&n.memoizedState===null?!1:(h&2)!==0),_?(p=!0,r.flags&=-129):(n===null||n.memoizedState!==null)&&(h|=1),Ye(nt,h&1),n===null)return Dc(r),n=r.memoizedState,n!==null&&(n=n.dehydrated,n!==null)?((r.mode&1)===0?r.lanes=1:n.data==="$!"?r.lanes=8:r.lanes=1073741824,null):(S=c.children,n=c.fallback,p?(c=r.mode,p=r.child,S={mode:"hidden",children:S},(c&1)===0&&p!==null?(p.childLanes=0,p.pendingProps=S):p=Rl(S,c,0,null),n=yr(n,c,a,null),p.return=r,n.return=r,p.sibling=n,r.child=p,r.child.memoizedState=id(a),r.memoizedState=nd,n):rd(r,S));if(h=n.memoizedState,h!==null&&(_=h.dehydrated,_!==null))return dT(n,r,S,c,_,h,a);if(p){p=c.fallback,S=r.mode,h=n.child,_=h.sibling;var R={mode:"hidden",children:c.children};return(S&1)===0&&r.child!==h?(c=r.child,c.childLanes=0,c.pendingProps=R,r.deletions=null):(c=Bi(h,R),c.subtreeFlags=h.subtreeFlags&14680064),_!==null?p=Bi(_,p):(p=yr(p,S,a,null),p.flags|=2),p.return=r,c.return=r,c.sibling=p,r.child=c,c=p,p=r.child,S=n.child.memoizedState,S=S===null?id(a):{baseLanes:S.baseLanes|a,cachePool:null,transitions:S.transitions},p.memoizedState=S,p.childLanes=n.childLanes&~a,r.memoizedState=nd,c}return p=n.child,n=p.sibling,c=Bi(p,{mode:"visible",children:c.children}),(r.mode&1)===0&&(c.lanes=a),c.return=r,c.sibling=null,n!==null&&(a=r.deletions,a===null?(r.deletions=[n],r.flags|=16):a.push(n)),r.child=c,r.memoizedState=null,c}function rd(n,r){return r=Rl({mode:"visible",children:r},n.mode,0,null),r.return=n,n.child=r}function gl(n,r,a,c){return c!==null&&Oc(c),oo(r,n.child,null,a),n=rd(r,r.pendingProps.children),n.flags|=2,r.memoizedState=null,n}function dT(n,r,a,c,h,p,S){if(a)return r.flags&256?(r.flags&=-257,c=Qc(Error(i(422))),gl(n,r,S,c)):r.memoizedState!==null?(r.child=n.child,r.flags|=128,null):(p=c.fallback,h=r.mode,c=Rl({mode:"visible",children:c.children},h,0,null),p=yr(p,h,S,null),p.flags|=2,c.return=r,p.return=r,c.sibling=p,r.child=c,(r.mode&1)!==0&&oo(r,n.child,null,S),r.child.memoizedState=id(S),r.memoizedState=nd,p);if((r.mode&1)===0)return gl(n,r,S,null);if(h.data==="$!"){if(c=h.nextSibling&&h.nextSibling.dataset,c)var _=c.dgst;return c=_,p=Error(i(419)),c=Qc(p,c,void 0),gl(n,r,S,c)}if(_=(S&n.childLanes)!==0,jt||_){if(c=Tt,c!==null){switch(S&-S){case 4:h=2;break;case 16:h=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:h=32;break;case 536870912:h=268435456;break;default:h=0}h=(h&(c.suspendedLanes|S))!==0?0:h,h!==0&&h!==p.retryLane&&(p.retryLane=h,si(n,h),On(c,n,h,-1))}return Td(),c=Qc(Error(i(421))),gl(n,r,S,c)}return h.data==="$?"?(r.flags|=128,r.child=n.child,r=wT.bind(null,n),h._reactRetry=r,null):(n=p.treeContext,en=Ci(h.nextSibling),Jt=r,Qe=!0,Rn=null,n!==null&&(dn[fn++]=ri,dn[fn++]=oi,dn[fn++]=cr,ri=n.id,oi=n.overflow,cr=r),r=rd(r,c.children),r.flags|=4096,r)}function kp(n,r,a){n.lanes|=r;var c=n.alternate;c!==null&&(c.lanes|=r),Lc(n.return,r,a)}function od(n,r,a,c,h){var p=n.memoizedState;p===null?n.memoizedState={isBackwards:r,rendering:null,renderingStartTime:0,last:c,tail:a,tailMode:h}:(p.isBackwards=r,p.rendering=null,p.renderingStartTime=0,p.last=c,p.tail=a,p.tailMode=h)}function Mp(n,r,a){var c=r.pendingProps,h=c.revealOrder,p=c.tail;if(Ut(n,r,c.children,a),c=nt.current,(c&2)!==0)c=c&1|2,r.flags|=128;else{if(n!==null&&(n.flags&128)!==0)e:for(n=r.child;n!==null;){if(n.tag===13)n.memoizedState!==null&&kp(n,a,r);else if(n.tag===19)kp(n,a,r);else if(n.child!==null){n.child.return=n,n=n.child;continue}if(n===r)break e;for(;n.sibling===null;){if(n.return===null||n.return===r)break e;n=n.return}n.sibling.return=n.return,n=n.sibling}c&=1}if(Ye(nt,c),(r.mode&1)===0)r.memoizedState=null;else switch(h){case"forwards":for(a=r.child,h=null;a!==null;)n=a.alternate,n!==null&&al(n)===null&&(h=a),a=a.sibling;a=h,a===null?(h=r.child,r.child=null):(h=a.sibling,a.sibling=null),od(r,!1,h,a,p);break;case"backwards":for(a=null,h=r.child,r.child=null;h!==null;){if(n=h.alternate,n!==null&&al(n)===null){r.child=h;break}n=h.sibling,h.sibling=a,a=h,h=n}od(r,!0,a,null,p);break;case"together":od(r,!1,null,null,void 0);break;default:r.memoizedState=null}return r.child}function pl(n,r){(r.mode&1)===0&&n!==null&&(n.alternate=null,r.alternate=null,r.flags|=2)}function li(n,r,a){if(n!==null&&(r.dependencies=n.dependencies),pr|=r.lanes,(a&r.childLanes)===0)return null;if(n!==null&&r.child!==n.child)throw Error(i(153));if(r.child!==null){for(n=r.child,a=Bi(n,n.pendingProps),r.child=a,a.return=r;n.sibling!==null;)n=n.sibling,a=a.sibling=Bi(n,n.pendingProps),a.return=r;a.sibling=null}return r.child}function fT(n,r,a){switch(r.tag){case 3:Np(r),ro();break;case 5:Vg(r);break;case 1:Yt(r.type)&&qa(r);break;case 4:Hc(r,r.stateNode.containerInfo);break;case 10:var c=r.type._context,h=r.memoizedProps.value;Ye(il,c._currentValue),c._currentValue=h;break;case 13:if(c=r.memoizedState,c!==null)return c.dehydrated!==null?(Ye(nt,nt.current&1),r.flags|=128,null):(a&r.child.childLanes)!==0?Op(n,r,a):(Ye(nt,nt.current&1),n=li(n,r,a),n!==null?n.sibling:null);Ye(nt,nt.current&1);break;case 19:if(c=(a&r.childLanes)!==0,(n.flags&128)!==0){if(c)return Mp(n,r,a);r.flags|=128}if(h=r.memoizedState,h!==null&&(h.rendering=null,h.tail=null,h.lastEffect=null),Ye(nt,nt.current),c)break;return null;case 22:case 23:return r.lanes=0,Cp(n,r,a)}return li(n,r,a)}var Fp,sd,Lp,Up;Fp=function(n,r){for(var a=r.child;a!==null;){if(a.tag===5||a.tag===6)n.appendChild(a.stateNode);else if(a.tag!==4&&a.child!==null){a.child.return=a,a=a.child;continue}if(a===r)break;for(;a.sibling===null;){if(a.return===null||a.return===r)return;a=a.return}a.sibling.return=a.return,a=a.sibling}},sd=function(){},Lp=function(n,r,a,c){var h=n.memoizedProps;if(h!==c){n=r.stateNode,hr(jn.current);var p=null;switch(a){case"input":h=qe(n,h),c=qe(n,c),p=[];break;case"select":h=j({},h,{value:void 0}),c=j({},c,{value:void 0}),p=[];break;case"textarea":h=sr(n,h),c=sr(n,c),p=[];break;default:typeof h.onClick!="function"&&typeof c.onClick=="function"&&(n.onclick=Xa)}Gu(a,c);var S;a=null;for(M in h)if(!c.hasOwnProperty(M)&&h.hasOwnProperty(M)&&h[M]!=null)if(M==="style"){var _=h[M];for(S in _)_.hasOwnProperty(S)&&(a||(a={}),a[S]="")}else M!=="dangerouslySetInnerHTML"&&M!=="children"&&M!=="suppressContentEditableWarning"&&M!=="suppressHydrationWarning"&&M!=="autoFocus"&&(l.hasOwnProperty(M)?p||(p=[]):(p=p||[]).push(M,null));for(M in c){var R=c[M];if(_=h!=null?h[M]:void 0,c.hasOwnProperty(M)&&R!==_&&(R!=null||_!=null))if(M==="style")if(_){for(S in _)!_.hasOwnProperty(S)||R&&R.hasOwnProperty(S)||(a||(a={}),a[S]="");for(S in R)R.hasOwnProperty(S)&&_[S]!==R[S]&&(a||(a={}),a[S]=R[S])}else a||(p||(p=[]),p.push(M,a)),a=R;else M==="dangerouslySetInnerHTML"?(R=R?R.__html:void 0,_=_?_.__html:void 0,R!=null&&_!==R&&(p=p||[]).push(M,R)):M==="children"?typeof R!="string"&&typeof R!="number"||(p=p||[]).push(M,""+R):M!=="suppressContentEditableWarning"&&M!=="suppressHydrationWarning"&&(l.hasOwnProperty(M)?(R!=null&&M==="onScroll"&&Xe("scroll",n),p||_===R||(p=[])):(p=p||[]).push(M,R))}a&&(p=p||[]).push("style",a);var M=p;(r.updateQueue=M)&&(r.flags|=4)}},Up=function(n,r,a,c){a!==c&&(r.flags|=4)};function Ds(n,r){if(!Qe)switch(n.tailMode){case"hidden":r=n.tail;for(var a=null;r!==null;)r.alternate!==null&&(a=r),r=r.sibling;a===null?n.tail=null:a.sibling=null;break;case"collapsed":a=n.tail;for(var c=null;a!==null;)a.alternate!==null&&(c=a),a=a.sibling;c===null?r||n.tail===null?n.tail=null:n.tail.sibling=null:c.sibling=null}}function Ot(n){var r=n.alternate!==null&&n.alternate.child===n.child,a=0,c=0;if(r)for(var h=n.child;h!==null;)a|=h.lanes|h.childLanes,c|=h.subtreeFlags&14680064,c|=h.flags&14680064,h.return=n,h=h.sibling;else for(h=n.child;h!==null;)a|=h.lanes|h.childLanes,c|=h.subtreeFlags,c|=h.flags,h.return=n,h=h.sibling;return n.subtreeFlags|=c,n.childLanes=a,r}function hT(n,r,a){var c=r.pendingProps;switch(Pc(r),r.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Ot(r),null;case 1:return Yt(r.type)&&Za(),Ot(r),null;case 3:return c=r.stateNode,lo(),Ke(Wt),Ke(Nt),xc(),c.pendingContext&&(c.context=c.pendingContext,c.pendingContext=null),(n===null||n.child===null)&&(tl(r)?r.flags|=4:n===null||n.memoizedState.isDehydrated&&(r.flags&256)===0||(r.flags|=1024,Rn!==null&&(vd(Rn),Rn=null))),sd(n,r),Ot(r),null;case 5:bc(r);var h=hr(_s.current);if(a=r.type,n!==null&&r.stateNode!=null)Lp(n,r,a,c,h),n.ref!==r.ref&&(r.flags|=512,r.flags|=2097152);else{if(!c){if(r.stateNode===null)throw Error(i(166));return Ot(r),null}if(n=hr(jn.current),tl(r)){c=r.stateNode,a=r.type;var p=r.memoizedProps;switch(c[Yn]=r,c[Ts]=p,n=(r.mode&1)!==0,a){case"dialog":Xe("cancel",c),Xe("close",c);break;case"iframe":case"object":case"embed":Xe("load",c);break;case"video":case"audio":for(h=0;h<vs.length;h++)Xe(vs[h],c);break;case"source":Xe("error",c);break;case"img":case"image":case"link":Xe("error",c),Xe("load",c);break;case"details":Xe("toggle",c);break;case"input":Ve(c,p),Xe("invalid",c);break;case"select":c._wrapperState={wasMultiple:!!p.multiple},Xe("invalid",c);break;case"textarea":yh(c,p),Xe("invalid",c)}Gu(a,p),h=null;for(var S in p)if(p.hasOwnProperty(S)){var _=p[S];S==="children"?typeof _=="string"?c.textContent!==_&&(p.suppressHydrationWarning!==!0&&Va(c.textContent,_,n),h=["children",_]):typeof _=="number"&&c.textContent!==""+_&&(p.suppressHydrationWarning!==!0&&Va(c.textContent,_,n),h=["children",""+_]):l.hasOwnProperty(S)&&_!=null&&S==="onScroll"&&Xe("scroll",c)}switch(a){case"input":Ue(c),cn(c,p,!0);break;case"textarea":Ue(c),Ah(c);break;case"select":case"option":break;default:typeof p.onClick=="function"&&(c.onclick=Xa)}c=h,r.updateQueue=c,c!==null&&(r.flags|=4)}else{S=h.nodeType===9?h:h.ownerDocument,n==="http://www.w3.org/1999/xhtml"&&(n=Ih(a)),n==="http://www.w3.org/1999/xhtml"?a==="script"?(n=S.createElement("div"),n.innerHTML="<script><\/script>",n=n.removeChild(n.firstChild)):typeof c.is=="string"?n=S.createElement(a,{is:c.is}):(n=S.createElement(a),a==="select"&&(S=n,c.multiple?S.multiple=!0:c.size&&(S.size=c.size))):n=S.createElementNS(n,a),n[Yn]=r,n[Ts]=c,Fp(n,r,!1,!1),r.stateNode=n;e:{switch(S=xu(a,c),a){case"dialog":Xe("cancel",n),Xe("close",n),h=c;break;case"iframe":case"object":case"embed":Xe("load",n),h=c;break;case"video":case"audio":for(h=0;h<vs.length;h++)Xe(vs[h],n);h=c;break;case"source":Xe("error",n),h=c;break;case"img":case"image":case"link":Xe("error",n),Xe("load",n),h=c;break;case"details":Xe("toggle",n),h=c;break;case"input":Ve(n,c),h=qe(n,c),Xe("invalid",n);break;case"option":h=c;break;case"select":n._wrapperState={wasMultiple:!!c.multiple},h=j({},c,{value:void 0}),Xe("invalid",n);break;case"textarea":yh(n,c),h=sr(n,c),Xe("invalid",n);break;default:h=c}Gu(a,h),_=h;for(p in _)if(_.hasOwnProperty(p)){var R=_[p];p==="style"?_h(n,R):p==="dangerouslySetInnerHTML"?(R=R?R.__html:void 0,R!=null&&Eh(n,R)):p==="children"?typeof R=="string"?(a!=="textarea"||R!=="")&&Qo(n,R):typeof R=="number"&&Qo(n,""+R):p!=="suppressContentEditableWarning"&&p!=="suppressHydrationWarning"&&p!=="autoFocus"&&(l.hasOwnProperty(p)?R!=null&&p==="onScroll"&&Xe("scroll",n):R!=null&&D(n,p,R,S))}switch(a){case"input":Ue(n),cn(n,c,!1);break;case"textarea":Ue(n),Ah(n);break;case"option":c.value!=null&&n.setAttribute("value",""+Ae(c.value));break;case"select":n.multiple=!!c.multiple,p=c.value,p!=null?yi(n,!!c.multiple,p,!1):c.defaultValue!=null&&yi(n,!!c.multiple,c.defaultValue,!0);break;default:typeof h.onClick=="function"&&(n.onclick=Xa)}switch(a){case"button":case"input":case"select":case"textarea":c=!!c.autoFocus;break e;case"img":c=!0;break e;default:c=!1}}c&&(r.flags|=4)}r.ref!==null&&(r.flags|=512,r.flags|=2097152)}return Ot(r),null;case 6:if(n&&r.stateNode!=null)Up(n,r,n.memoizedProps,c);else{if(typeof c!="string"&&r.stateNode===null)throw Error(i(166));if(a=hr(_s.current),hr(jn.current),tl(r)){if(c=r.stateNode,a=r.memoizedProps,c[Yn]=r,(p=c.nodeValue!==a)&&(n=Jt,n!==null))switch(n.tag){case 3:Va(c.nodeValue,a,(n.mode&1)!==0);break;case 5:n.memoizedProps.suppressHydrationWarning!==!0&&Va(c.nodeValue,a,(n.mode&1)!==0)}p&&(r.flags|=4)}else c=(a.nodeType===9?a:a.ownerDocument).createTextNode(c),c[Yn]=r,r.stateNode=c}return Ot(r),null;case 13:if(Ke(nt),c=r.memoizedState,n===null||n.memoizedState!==null&&n.memoizedState.dehydrated!==null){if(Qe&&en!==null&&(r.mode&1)!==0&&(r.flags&128)===0)bg(),ro(),r.flags|=98560,p=!1;else if(p=tl(r),c!==null&&c.dehydrated!==null){if(n===null){if(!p)throw Error(i(318));if(p=r.memoizedState,p=p!==null?p.dehydrated:null,!p)throw Error(i(317));p[Yn]=r}else ro(),(r.flags&128)===0&&(r.memoizedState=null),r.flags|=4;Ot(r),p=!1}else Rn!==null&&(vd(Rn),Rn=null),p=!0;if(!p)return r.flags&65536?r:null}return(r.flags&128)!==0?(r.lanes=a,r):(c=c!==null,c!==(n!==null&&n.memoizedState!==null)&&c&&(r.child.flags|=8192,(r.mode&1)!==0&&(n===null||(nt.current&1)!==0?pt===0&&(pt=3):Td())),r.updateQueue!==null&&(r.flags|=4),Ot(r),null);case 4:return lo(),sd(n,r),n===null&&Ss(r.stateNode.containerInfo),Ot(r),null;case 10:return Fc(r.type._context),Ot(r),null;case 17:return Yt(r.type)&&Za(),Ot(r),null;case 19:if(Ke(nt),p=r.memoizedState,p===null)return Ot(r),null;if(c=(r.flags&128)!==0,S=p.rendering,S===null)if(c)Ds(p,!1);else{if(pt!==0||n!==null&&(n.flags&128)!==0)for(n=r.child;n!==null;){if(S=al(n),S!==null){for(r.flags|=128,Ds(p,!1),c=S.updateQueue,c!==null&&(r.updateQueue=c,r.flags|=4),r.subtreeFlags=0,c=a,a=r.child;a!==null;)p=a,n=c,p.flags&=14680066,S=p.alternate,S===null?(p.childLanes=0,p.lanes=n,p.child=null,p.subtreeFlags=0,p.memoizedProps=null,p.memoizedState=null,p.updateQueue=null,p.dependencies=null,p.stateNode=null):(p.childLanes=S.childLanes,p.lanes=S.lanes,p.child=S.child,p.subtreeFlags=0,p.deletions=null,p.memoizedProps=S.memoizedProps,p.memoizedState=S.memoizedState,p.updateQueue=S.updateQueue,p.type=S.type,n=S.dependencies,p.dependencies=n===null?null:{lanes:n.lanes,firstContext:n.firstContext}),a=a.sibling;return Ye(nt,nt.current&1|2),r.child}n=n.sibling}p.tail!==null&&at()>ho&&(r.flags|=128,c=!0,Ds(p,!1),r.lanes=4194304)}else{if(!c)if(n=al(S),n!==null){if(r.flags|=128,c=!0,a=n.updateQueue,a!==null&&(r.updateQueue=a,r.flags|=4),Ds(p,!0),p.tail===null&&p.tailMode==="hidden"&&!S.alternate&&!Qe)return Ot(r),null}else 2*at()-p.renderingStartTime>ho&&a!==1073741824&&(r.flags|=128,c=!0,Ds(p,!1),r.lanes=4194304);p.isBackwards?(S.sibling=r.child,r.child=S):(a=p.last,a!==null?a.sibling=S:r.child=S,p.last=S)}return p.tail!==null?(r=p.tail,p.rendering=r,p.tail=r.sibling,p.renderingStartTime=at(),r.sibling=null,a=nt.current,Ye(nt,c?a&1|2:a&1),r):(Ot(r),null);case 22:case 23:return yd(),c=r.memoizedState!==null,n!==null&&n.memoizedState!==null!==c&&(r.flags|=8192),c&&(r.mode&1)!==0?(tn&1073741824)!==0&&(Ot(r),r.subtreeFlags&6&&(r.flags|=8192)):Ot(r),null;case 24:return null;case 25:return null}throw Error(i(156,r.tag))}function gT(n,r){switch(Pc(r),r.tag){case 1:return Yt(r.type)&&Za(),n=r.flags,n&65536?(r.flags=n&-65537|128,r):null;case 3:return lo(),Ke(Wt),Ke(Nt),xc(),n=r.flags,(n&65536)!==0&&(n&128)===0?(r.flags=n&-65537|128,r):null;case 5:return bc(r),null;case 13:if(Ke(nt),n=r.memoizedState,n!==null&&n.dehydrated!==null){if(r.alternate===null)throw Error(i(340));ro()}return n=r.flags,n&65536?(r.flags=n&-65537|128,r):null;case 19:return Ke(nt),null;case 4:return lo(),null;case 10:return Fc(r.type._context),null;case 22:case 23:return yd(),null;case 24:return null;default:return null}}var ml=!1,kt=!1,pT=typeof WeakSet=="function"?WeakSet:Set,J=null;function co(n,r){var a=n.ref;if(a!==null)if(typeof a=="function")try{a(null)}catch(c){rt(n,r,c)}else a.current=null}function ad(n,r,a){try{a()}catch(c){rt(n,r,c)}}var Bp=!1;function mT(n,r){if(yc=Ua,n=pg(),dc(n)){if("selectionStart"in n)var a={start:n.selectionStart,end:n.selectionEnd};else e:{a=(a=n.ownerDocument)&&a.defaultView||window;var c=a.getSelection&&a.getSelection();if(c&&c.rangeCount!==0){a=c.anchorNode;var h=c.anchorOffset,p=c.focusNode;c=c.focusOffset;try{a.nodeType,p.nodeType}catch{a=null;break e}var S=0,_=-1,R=-1,M=0,x=0,z=n,G=null;t:for(;;){for(var q;z!==a||h!==0&&z.nodeType!==3||(_=S+h),z!==p||c!==0&&z.nodeType!==3||(R=S+c),z.nodeType===3&&(S+=z.nodeValue.length),(q=z.firstChild)!==null;)G=z,z=q;for(;;){if(z===n)break t;if(G===a&&++M===h&&(_=S),G===p&&++x===c&&(R=S),(q=z.nextSibling)!==null)break;z=G,G=z.parentNode}z=q}a=_===-1||R===-1?null:{start:_,end:R}}else a=null}a=a||{start:0,end:0}}else a=null;for(Tc={focusedElem:n,selectionRange:a},Ua=!1,J=r;J!==null;)if(r=J,n=r.child,(r.subtreeFlags&1028)!==0&&n!==null)n.return=r,J=n;else for(;J!==null;){r=J;try{var ee=r.alternate;if((r.flags&1024)!==0)switch(r.tag){case 0:case 11:case 15:break;case 1:if(ee!==null){var oe=ee.memoizedProps,lt=ee.memoizedState,O=r.stateNode,N=O.getSnapshotBeforeUpdate(r.elementType===r.type?oe:Pn(r.type,oe),lt);O.__reactInternalSnapshotBeforeUpdate=N}break;case 3:var k=r.stateNode.containerInfo;k.nodeType===1?k.textContent="":k.nodeType===9&&k.documentElement&&k.removeChild(k.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(i(163))}}catch(V){rt(r,r.return,V)}if(n=r.sibling,n!==null){n.return=r.return,J=n;break}J=r.return}return ee=Bp,Bp=!1,ee}function Os(n,r,a){var c=r.updateQueue;if(c=c!==null?c.lastEffect:null,c!==null){var h=c=c.next;do{if((h.tag&n)===n){var p=h.destroy;h.destroy=void 0,p!==void 0&&ad(r,a,p)}h=h.next}while(h!==c)}}function vl(n,r){if(r=r.updateQueue,r=r!==null?r.lastEffect:null,r!==null){var a=r=r.next;do{if((a.tag&n)===n){var c=a.create;a.destroy=c()}a=a.next}while(a!==r)}}function ld(n){var r=n.ref;if(r!==null){var a=n.stateNode;switch(n.tag){case 5:n=a;break;default:n=a}typeof r=="function"?r(n):r.current=n}}function Hp(n){var r=n.alternate;r!==null&&(n.alternate=null,Hp(r)),n.child=null,n.deletions=null,n.sibling=null,n.tag===5&&(r=n.stateNode,r!==null&&(delete r[Yn],delete r[Ts],delete r[wc],delete r[Qy],delete r[Jy])),n.stateNode=null,n.return=null,n.dependencies=null,n.memoizedProps=null,n.memoizedState=null,n.pendingProps=null,n.stateNode=null,n.updateQueue=null}function bp(n){return n.tag===5||n.tag===3||n.tag===4}function Gp(n){e:for(;;){for(;n.sibling===null;){if(n.return===null||bp(n.return))return null;n=n.return}for(n.sibling.return=n.return,n=n.sibling;n.tag!==5&&n.tag!==6&&n.tag!==18;){if(n.flags&2||n.child===null||n.tag===4)continue e;n.child.return=n,n=n.child}if(!(n.flags&2))return n.stateNode}}function ud(n,r,a){var c=n.tag;if(c===5||c===6)n=n.stateNode,r?a.nodeType===8?a.parentNode.insertBefore(n,r):a.insertBefore(n,r):(a.nodeType===8?(r=a.parentNode,r.insertBefore(n,a)):(r=a,r.appendChild(n)),a=a._reactRootContainer,a!=null||r.onclick!==null||(r.onclick=Xa));else if(c!==4&&(n=n.child,n!==null))for(ud(n,r,a),n=n.sibling;n!==null;)ud(n,r,a),n=n.sibling}function cd(n,r,a){var c=n.tag;if(c===5||c===6)n=n.stateNode,r?a.insertBefore(n,r):a.appendChild(n);else if(c!==4&&(n=n.child,n!==null))for(cd(n,r,a),n=n.sibling;n!==null;)cd(n,r,a),n=n.sibling}var Ct=null,Nn=!1;function ki(n,r,a){for(a=a.child;a!==null;)xp(n,r,a),a=a.sibling}function xp(n,r,a){if(Wn&&typeof Wn.onCommitFiberUnmount=="function")try{Wn.onCommitFiberUnmount(Da,a)}catch{}switch(a.tag){case 5:kt||co(a,r);case 6:var c=Ct,h=Nn;Ct=null,ki(n,r,a),Ct=c,Nn=h,Ct!==null&&(Nn?(n=Ct,a=a.stateNode,n.nodeType===8?n.parentNode.removeChild(a):n.removeChild(a)):Ct.removeChild(a.stateNode));break;case 18:Ct!==null&&(Nn?(n=Ct,a=a.stateNode,n.nodeType===8?Ec(n.parentNode,a):n.nodeType===1&&Ec(n,a),us(n)):Ec(Ct,a.stateNode));break;case 4:c=Ct,h=Nn,Ct=a.stateNode.containerInfo,Nn=!0,ki(n,r,a),Ct=c,Nn=h;break;case 0:case 11:case 14:case 15:if(!kt&&(c=a.updateQueue,c!==null&&(c=c.lastEffect,c!==null))){h=c=c.next;do{var p=h,S=p.destroy;p=p.tag,S!==void 0&&((p&2)!==0||(p&4)!==0)&&ad(a,r,S),h=h.next}while(h!==c)}ki(n,r,a);break;case 1:if(!kt&&(co(a,r),c=a.stateNode,typeof c.componentWillUnmount=="function"))try{c.props=a.memoizedProps,c.state=a.memoizedState,c.componentWillUnmount()}catch(_){rt(a,r,_)}ki(n,r,a);break;case 21:ki(n,r,a);break;case 22:a.mode&1?(kt=(c=kt)||a.memoizedState!==null,ki(n,r,a),kt=c):ki(n,r,a);break;default:ki(n,r,a)}}function $p(n){var r=n.updateQueue;if(r!==null){n.updateQueue=null;var a=n.stateNode;a===null&&(a=n.stateNode=new pT),r.forEach(function(c){var h=_T.bind(null,n,c);a.has(c)||(a.add(c),c.then(h,h))})}}function Dn(n,r){var a=r.deletions;if(a!==null)for(var c=0;c<a.length;c++){var h=a[c];try{var p=n,S=r,_=S;e:for(;_!==null;){switch(_.tag){case 5:Ct=_.stateNode,Nn=!1;break e;case 3:Ct=_.stateNode.containerInfo,Nn=!0;break e;case 4:Ct=_.stateNode.containerInfo,Nn=!0;break e}_=_.return}if(Ct===null)throw Error(i(160));xp(p,S,h),Ct=null,Nn=!1;var R=h.alternate;R!==null&&(R.return=null),h.return=null}catch(M){rt(h,r,M)}}if(r.subtreeFlags&12854)for(r=r.child;r!==null;)zp(r,n),r=r.sibling}function zp(n,r){var a=n.alternate,c=n.flags;switch(n.tag){case 0:case 11:case 14:case 15:if(Dn(r,n),Xn(n),c&4){try{Os(3,n,n.return),vl(3,n)}catch(oe){rt(n,n.return,oe)}try{Os(5,n,n.return)}catch(oe){rt(n,n.return,oe)}}break;case 1:Dn(r,n),Xn(n),c&512&&a!==null&&co(a,a.return);break;case 5:if(Dn(r,n),Xn(n),c&512&&a!==null&&co(a,a.return),n.flags&32){var h=n.stateNode;try{Qo(h,"")}catch(oe){rt(n,n.return,oe)}}if(c&4&&(h=n.stateNode,h!=null)){var p=n.memoizedProps,S=a!==null?a.memoizedProps:p,_=n.type,R=n.updateQueue;if(n.updateQueue=null,R!==null)try{_==="input"&&p.type==="radio"&&p.name!=null&&xn(h,p),xu(_,S);var M=xu(_,p);for(S=0;S<R.length;S+=2){var x=R[S],z=R[S+1];x==="style"?_h(h,z):x==="dangerouslySetInnerHTML"?Eh(h,z):x==="children"?Qo(h,z):D(h,x,z,M)}switch(_){case"input":zt(h,p);break;case"textarea":Th(h,p);break;case"select":var G=h._wrapperState.wasMultiple;h._wrapperState.wasMultiple=!!p.multiple;var q=p.value;q!=null?yi(h,!!p.multiple,q,!1):G!==!!p.multiple&&(p.defaultValue!=null?yi(h,!!p.multiple,p.defaultValue,!0):yi(h,!!p.multiple,p.multiple?[]:"",!1))}h[Ts]=p}catch(oe){rt(n,n.return,oe)}}break;case 6:if(Dn(r,n),Xn(n),c&4){if(n.stateNode===null)throw Error(i(162));h=n.stateNode,p=n.memoizedProps;try{h.nodeValue=p}catch(oe){rt(n,n.return,oe)}}break;case 3:if(Dn(r,n),Xn(n),c&4&&a!==null&&a.memoizedState.isDehydrated)try{us(r.containerInfo)}catch(oe){rt(n,n.return,oe)}break;case 4:Dn(r,n),Xn(n);break;case 13:Dn(r,n),Xn(n),h=n.child,h.flags&8192&&(p=h.memoizedState!==null,h.stateNode.isHidden=p,!p||h.alternate!==null&&h.alternate.memoizedState!==null||(hd=at())),c&4&&$p(n);break;case 22:if(x=a!==null&&a.memoizedState!==null,n.mode&1?(kt=(M=kt)||x,Dn(r,n),kt=M):Dn(r,n),Xn(n),c&8192){if(M=n.memoizedState!==null,(n.stateNode.isHidden=M)&&!x&&(n.mode&1)!==0)for(J=n,x=n.child;x!==null;){for(z=J=x;J!==null;){switch(G=J,q=G.child,G.tag){case 0:case 11:case 14:case 15:Os(4,G,G.return);break;case 1:co(G,G.return);var ee=G.stateNode;if(typeof ee.componentWillUnmount=="function"){c=G,a=G.return;try{r=c,ee.props=r.memoizedProps,ee.state=r.memoizedState,ee.componentWillUnmount()}catch(oe){rt(c,a,oe)}}break;case 5:co(G,G.return);break;case 22:if(G.memoizedState!==null){jp(z);continue}}q!==null?(q.return=G,J=q):jp(z)}x=x.sibling}e:for(x=null,z=n;;){if(z.tag===5){if(x===null){x=z;try{h=z.stateNode,M?(p=h.style,typeof p.setProperty=="function"?p.setProperty("display","none","important"):p.display="none"):(_=z.stateNode,R=z.memoizedProps.style,S=R!=null&&R.hasOwnProperty("display")?R.display:null,_.style.display=wh("display",S))}catch(oe){rt(n,n.return,oe)}}}else if(z.tag===6){if(x===null)try{z.stateNode.nodeValue=M?"":z.memoizedProps}catch(oe){rt(n,n.return,oe)}}else if((z.tag!==22&&z.tag!==23||z.memoizedState===null||z===n)&&z.child!==null){z.child.return=z,z=z.child;continue}if(z===n)break e;for(;z.sibling===null;){if(z.return===null||z.return===n)break e;x===z&&(x=null),z=z.return}x===z&&(x=null),z.sibling.return=z.return,z=z.sibling}}break;case 19:Dn(r,n),Xn(n),c&4&&$p(n);break;case 21:break;default:Dn(r,n),Xn(n)}}function Xn(n){var r=n.flags;if(r&2){try{e:{for(var a=n.return;a!==null;){if(bp(a)){var c=a;break e}a=a.return}throw Error(i(160))}switch(c.tag){case 5:var h=c.stateNode;c.flags&32&&(Qo(h,""),c.flags&=-33);var p=Gp(n);cd(n,p,h);break;case 3:case 4:var S=c.stateNode.containerInfo,_=Gp(n);ud(n,_,S);break;default:throw Error(i(161))}}catch(R){rt(n,n.return,R)}n.flags&=-3}r&4096&&(n.flags&=-4097)}function vT(n,r,a){J=n,Wp(n)}function Wp(n,r,a){for(var c=(n.mode&1)!==0;J!==null;){var h=J,p=h.child;if(h.tag===22&&c){var S=h.memoizedState!==null||ml;if(!S){var _=h.alternate,R=_!==null&&_.memoizedState!==null||kt;_=ml;var M=kt;if(ml=S,(kt=R)&&!M)for(J=h;J!==null;)S=J,R=S.child,S.tag===22&&S.memoizedState!==null?Vp(h):R!==null?(R.return=S,J=R):Vp(h);for(;p!==null;)J=p,Wp(p),p=p.sibling;J=h,ml=_,kt=M}Yp(n)}else(h.subtreeFlags&8772)!==0&&p!==null?(p.return=h,J=p):Yp(n)}}function Yp(n){for(;J!==null;){var r=J;if((r.flags&8772)!==0){var a=r.alternate;try{if((r.flags&8772)!==0)switch(r.tag){case 0:case 11:case 15:kt||vl(5,r);break;case 1:var c=r.stateNode;if(r.flags&4&&!kt)if(a===null)c.componentDidMount();else{var h=r.elementType===r.type?a.memoizedProps:Pn(r.type,a.memoizedProps);c.componentDidUpdate(h,a.memoizedState,c.__reactInternalSnapshotBeforeUpdate)}var p=r.updateQueue;p!==null&&jg(r,p,c);break;case 3:var S=r.updateQueue;if(S!==null){if(a=null,r.child!==null)switch(r.child.tag){case 5:a=r.child.stateNode;break;case 1:a=r.child.stateNode}jg(r,S,a)}break;case 5:var _=r.stateNode;if(a===null&&r.flags&4){a=_;var R=r.memoizedProps;switch(r.type){case"button":case"input":case"select":case"textarea":R.autoFocus&&a.focus();break;case"img":R.src&&(a.src=R.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(r.memoizedState===null){var M=r.alternate;if(M!==null){var x=M.memoizedState;if(x!==null){var z=x.dehydrated;z!==null&&us(z)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(i(163))}kt||r.flags&512&&ld(r)}catch(G){rt(r,r.return,G)}}if(r===n){J=null;break}if(a=r.sibling,a!==null){a.return=r.return,J=a;break}J=r.return}}function jp(n){for(;J!==null;){var r=J;if(r===n){J=null;break}var a=r.sibling;if(a!==null){a.return=r.return,J=a;break}J=r.return}}function Vp(n){for(;J!==null;){var r=J;try{switch(r.tag){case 0:case 11:case 15:var a=r.return;try{vl(4,r)}catch(R){rt(r,a,R)}break;case 1:var c=r.stateNode;if(typeof c.componentDidMount=="function"){var h=r.return;try{c.componentDidMount()}catch(R){rt(r,h,R)}}var p=r.return;try{ld(r)}catch(R){rt(r,p,R)}break;case 5:var S=r.return;try{ld(r)}catch(R){rt(r,S,R)}}}catch(R){rt(r,r.return,R)}if(r===n){J=null;break}var _=r.sibling;if(_!==null){_.return=r.return,J=_;break}J=r.return}}var ST=Math.ceil,Sl=H.ReactCurrentDispatcher,dd=H.ReactCurrentOwner,pn=H.ReactCurrentBatchConfig,He=0,Tt=null,ft=null,Rt=0,tn=0,fo=Ri(0),pt=0,ks=null,pr=0,yl=0,fd=0,Ms=null,Vt=null,hd=0,ho=1/0,ui=null,Tl=!1,gd=null,Mi=null,Al=!1,Fi=null,Il=0,Fs=0,pd=null,El=-1,wl=0;function Bt(){return(He&6)!==0?at():El!==-1?El:El=at()}function Li(n){return(n.mode&1)===0?1:(He&2)!==0&&Rt!==0?Rt&-Rt:tT.transition!==null?(wl===0&&(wl=Gh()),wl):(n=ze,n!==0||(n=window.event,n=n===void 0?16:Kh(n.type)),n)}function On(n,r,a,c){if(50<Fs)throw Fs=0,pd=null,Error(i(185));rs(n,a,c),((He&2)===0||n!==Tt)&&(n===Tt&&((He&2)===0&&(yl|=a),pt===4&&Ui(n,Rt)),Xt(n,c),a===1&&He===0&&(r.mode&1)===0&&(ho=at()+500,Qa&&Ni()))}function Xt(n,r){var a=n.callbackNode;ty(n,r);var c=Ma(n,n===Tt?Rt:0);if(c===0)a!==null&&Bh(a),n.callbackNode=null,n.callbackPriority=0;else if(r=c&-c,n.callbackPriority!==r){if(a!=null&&Bh(a),r===1)n.tag===0?eT(Kp.bind(null,n)):Fg(Kp.bind(null,n)),Zy(function(){(He&6)===0&&Ni()}),a=null;else{switch(xh(c)){case 1:a=Xu;break;case 4:a=Hh;break;case 16:a=Na;break;case 536870912:a=bh;break;default:a=Na}a=im(a,Xp.bind(null,n))}n.callbackPriority=r,n.callbackNode=a}}function Xp(n,r){if(El=-1,wl=0,(He&6)!==0)throw Error(i(327));var a=n.callbackNode;if(go()&&n.callbackNode!==a)return null;var c=Ma(n,n===Tt?Rt:0);if(c===0)return null;if((c&30)!==0||(c&n.expiredLanes)!==0||r)r=_l(n,c);else{r=c;var h=He;He|=2;var p=qp();(Tt!==n||Rt!==r)&&(ui=null,ho=at()+500,vr(n,r));do try{AT();break}catch(_){Zp(n,_)}while(!0);Mc(),Sl.current=p,He=h,ft!==null?r=0:(Tt=null,Rt=0,r=pt)}if(r!==0){if(r===2&&(h=Ku(n),h!==0&&(c=h,r=md(n,h))),r===1)throw a=ks,vr(n,0),Ui(n,c),Xt(n,at()),a;if(r===6)Ui(n,c);else{if(h=n.current.alternate,(c&30)===0&&!yT(h)&&(r=_l(n,c),r===2&&(p=Ku(n),p!==0&&(c=p,r=md(n,p))),r===1))throw a=ks,vr(n,0),Ui(n,c),Xt(n,at()),a;switch(n.finishedWork=h,n.finishedLanes=c,r){case 0:case 1:throw Error(i(345));case 2:Sr(n,Vt,ui);break;case 3:if(Ui(n,c),(c&130023424)===c&&(r=hd+500-at(),10<r)){if(Ma(n,0)!==0)break;if(h=n.suspendedLanes,(h&c)!==c){Bt(),n.pingedLanes|=n.suspendedLanes&h;break}n.timeoutHandle=Ic(Sr.bind(null,n,Vt,ui),r);break}Sr(n,Vt,ui);break;case 4:if(Ui(n,c),(c&4194240)===c)break;for(r=n.eventTimes,h=-1;0<c;){var S=31-_n(c);p=1<<S,S=r[S],S>h&&(h=S),c&=~p}if(c=h,c=at()-c,c=(120>c?120:480>c?480:1080>c?1080:1920>c?1920:3e3>c?3e3:4320>c?4320:1960*ST(c/1960))-c,10<c){n.timeoutHandle=Ic(Sr.bind(null,n,Vt,ui),c);break}Sr(n,Vt,ui);break;case 5:Sr(n,Vt,ui);break;default:throw Error(i(329))}}}return Xt(n,at()),n.callbackNode===a?Xp.bind(null,n):null}function md(n,r){var a=Ms;return n.current.memoizedState.isDehydrated&&(vr(n,r).flags|=256),n=_l(n,r),n!==2&&(r=Vt,Vt=a,r!==null&&vd(r)),n}function vd(n){Vt===null?Vt=n:Vt.push.apply(Vt,n)}function yT(n){for(var r=n;;){if(r.flags&16384){var a=r.updateQueue;if(a!==null&&(a=a.stores,a!==null))for(var c=0;c<a.length;c++){var h=a[c],p=h.getSnapshot;h=h.value;try{if(!Cn(p(),h))return!1}catch{return!1}}}if(a=r.child,r.subtreeFlags&16384&&a!==null)a.return=r,r=a;else{if(r===n)break;for(;r.sibling===null;){if(r.return===null||r.return===n)return!0;r=r.return}r.sibling.return=r.return,r=r.sibling}}return!0}function Ui(n,r){for(r&=~fd,r&=~yl,n.suspendedLanes|=r,n.pingedLanes&=~r,n=n.expirationTimes;0<r;){var a=31-_n(r),c=1<<a;n[a]=-1,r&=~c}}function Kp(n){if((He&6)!==0)throw Error(i(327));go();var r=Ma(n,0);if((r&1)===0)return Xt(n,at()),null;var a=_l(n,r);if(n.tag!==0&&a===2){var c=Ku(n);c!==0&&(r=c,a=md(n,c))}if(a===1)throw a=ks,vr(n,0),Ui(n,r),Xt(n,at()),a;if(a===6)throw Error(i(345));return n.finishedWork=n.current.alternate,n.finishedLanes=r,Sr(n,Vt,ui),Xt(n,at()),null}function Sd(n,r){var a=He;He|=1;try{return n(r)}finally{He=a,He===0&&(ho=at()+500,Qa&&Ni())}}function mr(n){Fi!==null&&Fi.tag===0&&(He&6)===0&&go();var r=He;He|=1;var a=pn.transition,c=ze;try{if(pn.transition=null,ze=1,n)return n()}finally{ze=c,pn.transition=a,He=r,(He&6)===0&&Ni()}}function yd(){tn=fo.current,Ke(fo)}function vr(n,r){n.finishedWork=null,n.finishedLanes=0;var a=n.timeoutHandle;if(a!==-1&&(n.timeoutHandle=-1,Ky(a)),ft!==null)for(a=ft.return;a!==null;){var c=a;switch(Pc(c),c.tag){case 1:c=c.type.childContextTypes,c!=null&&Za();break;case 3:lo(),Ke(Wt),Ke(Nt),xc();break;case 5:bc(c);break;case 4:lo();break;case 13:Ke(nt);break;case 19:Ke(nt);break;case 10:Fc(c.type._context);break;case 22:case 23:yd()}a=a.return}if(Tt=n,ft=n=Bi(n.current,null),Rt=tn=r,pt=0,ks=null,fd=yl=pr=0,Vt=Ms=null,fr!==null){for(r=0;r<fr.length;r++)if(a=fr[r],c=a.interleaved,c!==null){a.interleaved=null;var h=c.next,p=a.pending;if(p!==null){var S=p.next;p.next=h,c.next=S}a.pending=c}fr=null}return n}function Zp(n,r){do{var a=ft;try{if(Mc(),ll.current=fl,ul){for(var c=it.memoizedState;c!==null;){var h=c.queue;h!==null&&(h.pending=null),c=c.next}ul=!1}if(gr=0,yt=gt=it=null,Cs=!1,Rs=0,dd.current=null,a===null||a.return===null){pt=1,ks=r,ft=null;break}e:{var p=n,S=a.return,_=a,R=r;if(r=Rt,_.flags|=32768,R!==null&&typeof R=="object"&&typeof R.then=="function"){var M=R,x=_,z=x.tag;if((x.mode&1)===0&&(z===0||z===11||z===15)){var G=x.alternate;G?(x.updateQueue=G.updateQueue,x.memoizedState=G.memoizedState,x.lanes=G.lanes):(x.updateQueue=null,x.memoizedState=null)}var q=Ap(S);if(q!==null){q.flags&=-257,Ip(q,S,_,p,r),q.mode&1&&Tp(p,M,r),r=q,R=M;var ee=r.updateQueue;if(ee===null){var oe=new Set;oe.add(R),r.updateQueue=oe}else ee.add(R);break e}else{if((r&1)===0){Tp(p,M,r),Td();break e}R=Error(i(426))}}else if(Qe&&_.mode&1){var lt=Ap(S);if(lt!==null){(lt.flags&65536)===0&&(lt.flags|=256),Ip(lt,S,_,p,r),Oc(uo(R,_));break e}}p=R=uo(R,_),pt!==4&&(pt=2),Ms===null?Ms=[p]:Ms.push(p),p=S;do{switch(p.tag){case 3:p.flags|=65536,r&=-r,p.lanes|=r;var O=Sp(p,R,r);Yg(p,O);break e;case 1:_=R;var N=p.type,k=p.stateNode;if((p.flags&128)===0&&(typeof N.getDerivedStateFromError=="function"||k!==null&&typeof k.componentDidCatch=="function"&&(Mi===null||!Mi.has(k)))){p.flags|=65536,r&=-r,p.lanes|=r;var V=yp(p,_,r);Yg(p,V);break e}}p=p.return}while(p!==null)}Jp(a)}catch(ue){r=ue,ft===a&&a!==null&&(ft=a=a.return);continue}break}while(!0)}function qp(){var n=Sl.current;return Sl.current=fl,n===null?fl:n}function Td(){(pt===0||pt===3||pt===2)&&(pt=4),Tt===null||(pr&268435455)===0&&(yl&268435455)===0||Ui(Tt,Rt)}function _l(n,r){var a=He;He|=2;var c=qp();(Tt!==n||Rt!==r)&&(ui=null,vr(n,r));do try{TT();break}catch(h){Zp(n,h)}while(!0);if(Mc(),He=a,Sl.current=c,ft!==null)throw Error(i(261));return Tt=null,Rt=0,pt}function TT(){for(;ft!==null;)Qp(ft)}function AT(){for(;ft!==null&&!jS();)Qp(ft)}function Qp(n){var r=nm(n.alternate,n,tn);n.memoizedProps=n.pendingProps,r===null?Jp(n):ft=r,dd.current=null}function Jp(n){var r=n;do{var a=r.alternate;if(n=r.return,(r.flags&32768)===0){if(a=hT(a,r,tn),a!==null){ft=a;return}}else{if(a=gT(a,r),a!==null){a.flags&=32767,ft=a;return}if(n!==null)n.flags|=32768,n.subtreeFlags=0,n.deletions=null;else{pt=6,ft=null;return}}if(r=r.sibling,r!==null){ft=r;return}ft=r=n}while(r!==null);pt===0&&(pt=5)}function Sr(n,r,a){var c=ze,h=pn.transition;try{pn.transition=null,ze=1,IT(n,r,a,c)}finally{pn.transition=h,ze=c}return null}function IT(n,r,a,c){do go();while(Fi!==null);if((He&6)!==0)throw Error(i(327));a=n.finishedWork;var h=n.finishedLanes;if(a===null)return null;if(n.finishedWork=null,n.finishedLanes=0,a===n.current)throw Error(i(177));n.callbackNode=null,n.callbackPriority=0;var p=a.lanes|a.childLanes;if(ny(n,p),n===Tt&&(ft=Tt=null,Rt=0),(a.subtreeFlags&2064)===0&&(a.flags&2064)===0||Al||(Al=!0,im(Na,function(){return go(),null})),p=(a.flags&15990)!==0,(a.subtreeFlags&15990)!==0||p){p=pn.transition,pn.transition=null;var S=ze;ze=1;var _=He;He|=4,dd.current=null,mT(n,a),zp(a,n),$y(Tc),Ua=!!yc,Tc=yc=null,n.current=a,vT(a),VS(),He=_,ze=S,pn.transition=p}else n.current=a;if(Al&&(Al=!1,Fi=n,Il=h),p=n.pendingLanes,p===0&&(Mi=null),ZS(a.stateNode),Xt(n,at()),r!==null)for(c=n.onRecoverableError,a=0;a<r.length;a++)h=r[a],c(h.value,{componentStack:h.stack,digest:h.digest});if(Tl)throw Tl=!1,n=gd,gd=null,n;return(Il&1)!==0&&n.tag!==0&&go(),p=n.pendingLanes,(p&1)!==0?n===pd?Fs++:(Fs=0,pd=n):Fs=0,Ni(),null}function go(){if(Fi!==null){var n=xh(Il),r=pn.transition,a=ze;try{if(pn.transition=null,ze=16>n?16:n,Fi===null)var c=!1;else{if(n=Fi,Fi=null,Il=0,(He&6)!==0)throw Error(i(331));var h=He;for(He|=4,J=n.current;J!==null;){var p=J,S=p.child;if((J.flags&16)!==0){var _=p.deletions;if(_!==null){for(var R=0;R<_.length;R++){var M=_[R];for(J=M;J!==null;){var x=J;switch(x.tag){case 0:case 11:case 15:Os(8,x,p)}var z=x.child;if(z!==null)z.return=x,J=z;else for(;J!==null;){x=J;var G=x.sibling,q=x.return;if(Hp(x),x===M){J=null;break}if(G!==null){G.return=q,J=G;break}J=q}}}var ee=p.alternate;if(ee!==null){var oe=ee.child;if(oe!==null){ee.child=null;do{var lt=oe.sibling;oe.sibling=null,oe=lt}while(oe!==null)}}J=p}}if((p.subtreeFlags&2064)!==0&&S!==null)S.return=p,J=S;else e:for(;J!==null;){if(p=J,(p.flags&2048)!==0)switch(p.tag){case 0:case 11:case 15:Os(9,p,p.return)}var O=p.sibling;if(O!==null){O.return=p.return,J=O;break e}J=p.return}}var N=n.current;for(J=N;J!==null;){S=J;var k=S.child;if((S.subtreeFlags&2064)!==0&&k!==null)k.return=S,J=k;else e:for(S=N;J!==null;){if(_=J,(_.flags&2048)!==0)try{switch(_.tag){case 0:case 11:case 15:vl(9,_)}}catch(ue){rt(_,_.return,ue)}if(_===S){J=null;break e}var V=_.sibling;if(V!==null){V.return=_.return,J=V;break e}J=_.return}}if(He=h,Ni(),Wn&&typeof Wn.onPostCommitFiberRoot=="function")try{Wn.onPostCommitFiberRoot(Da,n)}catch{}c=!0}return c}finally{ze=a,pn.transition=r}}return!1}function em(n,r,a){r=uo(a,r),r=Sp(n,r,1),n=Oi(n,r,1),r=Bt(),n!==null&&(rs(n,1,r),Xt(n,r))}function rt(n,r,a){if(n.tag===3)em(n,n,a);else for(;r!==null;){if(r.tag===3){em(r,n,a);break}else if(r.tag===1){var c=r.stateNode;if(typeof r.type.getDerivedStateFromError=="function"||typeof c.componentDidCatch=="function"&&(Mi===null||!Mi.has(c))){n=uo(a,n),n=yp(r,n,1),r=Oi(r,n,1),n=Bt(),r!==null&&(rs(r,1,n),Xt(r,n));break}}r=r.return}}function ET(n,r,a){var c=n.pingCache;c!==null&&c.delete(r),r=Bt(),n.pingedLanes|=n.suspendedLanes&a,Tt===n&&(Rt&a)===a&&(pt===4||pt===3&&(Rt&130023424)===Rt&&500>at()-hd?vr(n,0):fd|=a),Xt(n,r)}function tm(n,r){r===0&&((n.mode&1)===0?r=1:(r=ka,ka<<=1,(ka&130023424)===0&&(ka=4194304)));var a=Bt();n=si(n,r),n!==null&&(rs(n,r,a),Xt(n,a))}function wT(n){var r=n.memoizedState,a=0;r!==null&&(a=r.retryLane),tm(n,a)}function _T(n,r){var a=0;switch(n.tag){case 13:var c=n.stateNode,h=n.memoizedState;h!==null&&(a=h.retryLane);break;case 19:c=n.stateNode;break;default:throw Error(i(314))}c!==null&&c.delete(r),tm(n,a)}var nm;nm=function(n,r,a){if(n!==null)if(n.memoizedProps!==r.pendingProps||Wt.current)jt=!0;else{if((n.lanes&a)===0&&(r.flags&128)===0)return jt=!1,fT(n,r,a);jt=(n.flags&131072)!==0}else jt=!1,Qe&&(r.flags&1048576)!==0&&Lg(r,el,r.index);switch(r.lanes=0,r.tag){case 2:var c=r.type;pl(n,r),n=r.pendingProps;var h=to(r,Nt.current);ao(r,a),h=Wc(null,r,c,n,h,a);var p=Yc();return r.flags|=1,typeof h=="object"&&h!==null&&typeof h.render=="function"&&h.$$typeof===void 0?(r.tag=1,r.memoizedState=null,r.updateQueue=null,Yt(c)?(p=!0,qa(r)):p=!1,r.memoizedState=h.state!==null&&h.state!==void 0?h.state:null,Bc(r),h.updater=hl,r.stateNode=h,h._reactInternals=r,qc(r,c,n,a),r=td(null,r,c,!0,p,a)):(r.tag=0,Qe&&p&&Rc(r),Ut(null,r,h,a),r=r.child),r;case 16:c=r.elementType;e:{switch(pl(n,r),n=r.pendingProps,h=c._init,c=h(c._payload),r.type=c,h=r.tag=RT(c),n=Pn(c,n),h){case 0:r=ed(null,r,c,n,a);break e;case 1:r=Pp(null,r,c,n,a);break e;case 11:r=Ep(null,r,c,n,a);break e;case 14:r=wp(null,r,c,Pn(c.type,n),a);break e}throw Error(i(306,c,""))}return r;case 0:return c=r.type,h=r.pendingProps,h=r.elementType===c?h:Pn(c,h),ed(n,r,c,h,a);case 1:return c=r.type,h=r.pendingProps,h=r.elementType===c?h:Pn(c,h),Pp(n,r,c,h,a);case 3:e:{if(Np(r),n===null)throw Error(i(387));c=r.pendingProps,p=r.memoizedState,h=p.element,Wg(n,r),sl(r,c,null,a);var S=r.memoizedState;if(c=S.element,p.isDehydrated)if(p={element:c,isDehydrated:!1,cache:S.cache,pendingSuspenseBoundaries:S.pendingSuspenseBoundaries,transitions:S.transitions},r.updateQueue.baseState=p,r.memoizedState=p,r.flags&256){h=uo(Error(i(423)),r),r=Dp(n,r,c,a,h);break e}else if(c!==h){h=uo(Error(i(424)),r),r=Dp(n,r,c,a,h);break e}else for(en=Ci(r.stateNode.containerInfo.firstChild),Jt=r,Qe=!0,Rn=null,a=$g(r,null,c,a),r.child=a;a;)a.flags=a.flags&-3|4096,a=a.sibling;else{if(ro(),c===h){r=li(n,r,a);break e}Ut(n,r,c,a)}r=r.child}return r;case 5:return Vg(r),n===null&&Dc(r),c=r.type,h=r.pendingProps,p=n!==null?n.memoizedProps:null,S=h.children,Ac(c,h)?S=null:p!==null&&Ac(c,p)&&(r.flags|=32),Rp(n,r),Ut(n,r,S,a),r.child;case 6:return n===null&&Dc(r),null;case 13:return Op(n,r,a);case 4:return Hc(r,r.stateNode.containerInfo),c=r.pendingProps,n===null?r.child=oo(r,null,c,a):Ut(n,r,c,a),r.child;case 11:return c=r.type,h=r.pendingProps,h=r.elementType===c?h:Pn(c,h),Ep(n,r,c,h,a);case 7:return Ut(n,r,r.pendingProps,a),r.child;case 8:return Ut(n,r,r.pendingProps.children,a),r.child;case 12:return Ut(n,r,r.pendingProps.children,a),r.child;case 10:e:{if(c=r.type._context,h=r.pendingProps,p=r.memoizedProps,S=h.value,Ye(il,c._currentValue),c._currentValue=S,p!==null)if(Cn(p.value,S)){if(p.children===h.children&&!Wt.current){r=li(n,r,a);break e}}else for(p=r.child,p!==null&&(p.return=r);p!==null;){var _=p.dependencies;if(_!==null){S=p.child;for(var R=_.firstContext;R!==null;){if(R.context===c){if(p.tag===1){R=ai(-1,a&-a),R.tag=2;var M=p.updateQueue;if(M!==null){M=M.shared;var x=M.pending;x===null?R.next=R:(R.next=x.next,x.next=R),M.pending=R}}p.lanes|=a,R=p.alternate,R!==null&&(R.lanes|=a),Lc(p.return,a,r),_.lanes|=a;break}R=R.next}}else if(p.tag===10)S=p.type===r.type?null:p.child;else if(p.tag===18){if(S=p.return,S===null)throw Error(i(341));S.lanes|=a,_=S.alternate,_!==null&&(_.lanes|=a),Lc(S,a,r),S=p.sibling}else S=p.child;if(S!==null)S.return=p;else for(S=p;S!==null;){if(S===r){S=null;break}if(p=S.sibling,p!==null){p.return=S.return,S=p;break}S=S.return}p=S}Ut(n,r,h.children,a),r=r.child}return r;case 9:return h=r.type,c=r.pendingProps.children,ao(r,a),h=hn(h),c=c(h),r.flags|=1,Ut(n,r,c,a),r.child;case 14:return c=r.type,h=Pn(c,r.pendingProps),h=Pn(c.type,h),wp(n,r,c,h,a);case 15:return _p(n,r,r.type,r.pendingProps,a);case 17:return c=r.type,h=r.pendingProps,h=r.elementType===c?h:Pn(c,h),pl(n,r),r.tag=1,Yt(c)?(n=!0,qa(r)):n=!1,ao(r,a),mp(r,c,h),qc(r,c,h,a),td(null,r,c,!0,n,a);case 19:return Mp(n,r,a);case 22:return Cp(n,r,a)}throw Error(i(156,r.tag))};function im(n,r){return Uh(n,r)}function CT(n,r,a,c){this.tag=n,this.key=a,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=r,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=c,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function mn(n,r,a,c){return new CT(n,r,a,c)}function Ad(n){return n=n.prototype,!(!n||!n.isReactComponent)}function RT(n){if(typeof n=="function")return Ad(n)?1:0;if(n!=null){if(n=n.$$typeof,n===De)return 11;if(n===Le)return 14}return 2}function Bi(n,r){var a=n.alternate;return a===null?(a=mn(n.tag,r,n.key,n.mode),a.elementType=n.elementType,a.type=n.type,a.stateNode=n.stateNode,a.alternate=n,n.alternate=a):(a.pendingProps=r,a.type=n.type,a.flags=0,a.subtreeFlags=0,a.deletions=null),a.flags=n.flags&14680064,a.childLanes=n.childLanes,a.lanes=n.lanes,a.child=n.child,a.memoizedProps=n.memoizedProps,a.memoizedState=n.memoizedState,a.updateQueue=n.updateQueue,r=n.dependencies,a.dependencies=r===null?null:{lanes:r.lanes,firstContext:r.firstContext},a.sibling=n.sibling,a.index=n.index,a.ref=n.ref,a}function Cl(n,r,a,c,h,p){var S=2;if(c=n,typeof n=="function")Ad(n)&&(S=1);else if(typeof n=="string")S=5;else e:switch(n){case $:return yr(a.children,h,p,r);case Q:S=8,h|=8;break;case _e:return n=mn(12,a,r,h|2),n.elementType=_e,n.lanes=p,n;case Pe:return n=mn(13,a,r,h),n.elementType=Pe,n.lanes=p,n;case de:return n=mn(19,a,r,h),n.elementType=de,n.lanes=p,n;case te:return Rl(a,h,p,r);default:if(typeof n=="object"&&n!==null)switch(n.$$typeof){case Ce:S=10;break e;case be:S=9;break e;case De:S=11;break e;case Le:S=14;break e;case Te:S=16,c=null;break e}throw Error(i(130,n==null?n:typeof n,""))}return r=mn(S,a,r,h),r.elementType=n,r.type=c,r.lanes=p,r}function yr(n,r,a,c){return n=mn(7,n,c,r),n.lanes=a,n}function Rl(n,r,a,c){return n=mn(22,n,c,r),n.elementType=te,n.lanes=a,n.stateNode={isHidden:!1},n}function Id(n,r,a){return n=mn(6,n,null,r),n.lanes=a,n}function Ed(n,r,a){return r=mn(4,n.children!==null?n.children:[],n.key,r),r.lanes=a,r.stateNode={containerInfo:n.containerInfo,pendingChildren:null,implementation:n.implementation},r}function PT(n,r,a,c,h){this.tag=r,this.containerInfo=n,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Zu(0),this.expirationTimes=Zu(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Zu(0),this.identifierPrefix=c,this.onRecoverableError=h,this.mutableSourceEagerHydrationData=null}function wd(n,r,a,c,h,p,S,_,R){return n=new PT(n,r,a,_,R),r===1?(r=1,p===!0&&(r|=8)):r=0,p=mn(3,null,null,r),n.current=p,p.stateNode=n,p.memoizedState={element:c,isDehydrated:a,cache:null,transitions:null,pendingSuspenseBoundaries:null},Bc(p),n}function NT(n,r,a){var c=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:L,key:c==null?null:""+c,children:n,containerInfo:r,implementation:a}}function rm(n){if(!n)return Pi;n=n._reactInternals;e:{if(ar(n)!==n||n.tag!==1)throw Error(i(170));var r=n;do{switch(r.tag){case 3:r=r.stateNode.context;break e;case 1:if(Yt(r.type)){r=r.stateNode.__reactInternalMemoizedMergedChildContext;break e}}r=r.return}while(r!==null);throw Error(i(171))}if(n.tag===1){var a=n.type;if(Yt(a))return kg(n,a,r)}return r}function om(n,r,a,c,h,p,S,_,R){return n=wd(a,c,!0,n,h,p,S,_,R),n.context=rm(null),a=n.current,c=Bt(),h=Li(a),p=ai(c,h),p.callback=r??null,Oi(a,p,h),n.current.lanes=h,rs(n,h,c),Xt(n,c),n}function Pl(n,r,a,c){var h=r.current,p=Bt(),S=Li(h);return a=rm(a),r.context===null?r.context=a:r.pendingContext=a,r=ai(p,S),r.payload={element:n},c=c===void 0?null:c,c!==null&&(r.callback=c),n=Oi(h,r,S),n!==null&&(On(n,h,S,p),ol(n,h,S)),S}function Nl(n){if(n=n.current,!n.child)return null;switch(n.child.tag){case 5:return n.child.stateNode;default:return n.child.stateNode}}function sm(n,r){if(n=n.memoizedState,n!==null&&n.dehydrated!==null){var a=n.retryLane;n.retryLane=a!==0&&a<r?a:r}}function _d(n,r){sm(n,r),(n=n.alternate)&&sm(n,r)}function DT(){return null}var am=typeof reportError=="function"?reportError:function(n){console.error(n)};function Cd(n){this._internalRoot=n}Dl.prototype.render=Cd.prototype.render=function(n){var r=this._internalRoot;if(r===null)throw Error(i(409));Pl(n,r,null,null)},Dl.prototype.unmount=Cd.prototype.unmount=function(){var n=this._internalRoot;if(n!==null){this._internalRoot=null;var r=n.containerInfo;mr(function(){Pl(null,n,null,null)}),r[ni]=null}};function Dl(n){this._internalRoot=n}Dl.prototype.unstable_scheduleHydration=function(n){if(n){var r=Wh();n={blockedOn:null,target:n,priority:r};for(var a=0;a<Ei.length&&r!==0&&r<Ei[a].priority;a++);Ei.splice(a,0,n),a===0&&Vh(n)}};function Rd(n){return!(!n||n.nodeType!==1&&n.nodeType!==9&&n.nodeType!==11)}function Ol(n){return!(!n||n.nodeType!==1&&n.nodeType!==9&&n.nodeType!==11&&(n.nodeType!==8||n.nodeValue!==" react-mount-point-unstable "))}function lm(){}function OT(n,r,a,c,h){if(h){if(typeof c=="function"){var p=c;c=function(){var M=Nl(S);p.call(M)}}var S=om(r,c,n,0,null,!1,!1,"",lm);return n._reactRootContainer=S,n[ni]=S.current,Ss(n.nodeType===8?n.parentNode:n),mr(),S}for(;h=n.lastChild;)n.removeChild(h);if(typeof c=="function"){var _=c;c=function(){var M=Nl(R);_.call(M)}}var R=wd(n,0,!1,null,null,!1,!1,"",lm);return n._reactRootContainer=R,n[ni]=R.current,Ss(n.nodeType===8?n.parentNode:n),mr(function(){Pl(r,R,a,c)}),R}function kl(n,r,a,c,h){var p=a._reactRootContainer;if(p){var S=p;if(typeof h=="function"){var _=h;h=function(){var R=Nl(S);_.call(R)}}Pl(r,S,n,h)}else S=OT(a,r,n,h,c);return Nl(S)}$h=function(n){switch(n.tag){case 3:var r=n.stateNode;if(r.current.memoizedState.isDehydrated){var a=is(r.pendingLanes);a!==0&&(qu(r,a|1),Xt(r,at()),(He&6)===0&&(ho=at()+500,Ni()))}break;case 13:mr(function(){var c=si(n,1);if(c!==null){var h=Bt();On(c,n,1,h)}}),_d(n,1)}},Qu=function(n){if(n.tag===13){var r=si(n,134217728);if(r!==null){var a=Bt();On(r,n,134217728,a)}_d(n,134217728)}},zh=function(n){if(n.tag===13){var r=Li(n),a=si(n,r);if(a!==null){var c=Bt();On(a,n,r,c)}_d(n,r)}},Wh=function(){return ze},Yh=function(n,r){var a=ze;try{return ze=n,r()}finally{ze=a}},Wu=function(n,r,a){switch(r){case"input":if(zt(n,a),r=a.name,a.type==="radio"&&r!=null){for(a=n;a.parentNode;)a=a.parentNode;for(a=a.querySelectorAll("input[name="+JSON.stringify(""+r)+'][type="radio"]'),r=0;r<a.length;r++){var c=a[r];if(c!==n&&c.form===n.form){var h=Ka(c);if(!h)throw Error(i(90));he(c),zt(c,h)}}}break;case"textarea":Th(n,a);break;case"select":r=a.value,r!=null&&yi(n,!!a.multiple,r,!1)}},Nh=Sd,Dh=mr;var kT={usingClientEntryPoint:!1,Events:[As,Jr,Ka,Rh,Ph,Sd]},Ls={findFiberByHostInstance:lr,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},MT={bundleType:Ls.bundleType,version:Ls.version,rendererPackageName:Ls.rendererPackageName,rendererConfig:Ls.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:H.ReactCurrentDispatcher,findHostInstanceByFiber:function(n){return n=Fh(n),n===null?null:n.stateNode},findFiberByHostInstance:Ls.findFiberByHostInstance||DT,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Ml=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Ml.isDisabled&&Ml.supportsFiber)try{Da=Ml.inject(MT),Wn=Ml}catch{}}return Kt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=kT,Kt.createPortal=function(n,r){var a=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Rd(r))throw Error(i(200));return NT(n,r,null,a)},Kt.createRoot=function(n,r){if(!Rd(n))throw Error(i(299));var a=!1,c="",h=am;return r!=null&&(r.unstable_strictMode===!0&&(a=!0),r.identifierPrefix!==void 0&&(c=r.identifierPrefix),r.onRecoverableError!==void 0&&(h=r.onRecoverableError)),r=wd(n,1,!1,null,null,a,!1,c,h),n[ni]=r.current,Ss(n.nodeType===8?n.parentNode:n),new Cd(r)},Kt.findDOMNode=function(n){if(n==null)return null;if(n.nodeType===1)return n;var r=n._reactInternals;if(r===void 0)throw typeof n.render=="function"?Error(i(188)):(n=Object.keys(n).join(","),Error(i(268,n)));return n=Fh(r),n=n===null?null:n.stateNode,n},Kt.flushSync=function(n){return mr(n)},Kt.hydrate=function(n,r,a){if(!Ol(r))throw Error(i(200));return kl(null,n,r,!0,a)},Kt.hydrateRoot=function(n,r,a){if(!Rd(n))throw Error(i(405));var c=a!=null&&a.hydratedSources||null,h=!1,p="",S=am;if(a!=null&&(a.unstable_strictMode===!0&&(h=!0),a.identifierPrefix!==void 0&&(p=a.identifierPrefix),a.onRecoverableError!==void 0&&(S=a.onRecoverableError)),r=om(r,null,n,1,a??null,h,!1,p,S),n[ni]=r.current,Ss(n),c)for(n=0;n<c.length;n++)a=c[n],h=a._getVersion,h=h(a._source),r.mutableSourceEagerHydrationData==null?r.mutableSourceEagerHydrationData=[a,h]:r.mutableSourceEagerHydrationData.push(a,h);return new Dl(r)},Kt.render=function(n,r,a){if(!Ol(r))throw Error(i(200));return kl(null,n,r,!1,a)},Kt.unmountComponentAtNode=function(n){if(!Ol(n))throw Error(i(40));return n._reactRootContainer?(mr(function(){kl(null,null,n,!1,function(){n._reactRootContainer=null,n[ni]=null})}),!0):!1},Kt.unstable_batchedUpdates=Sd,Kt.unstable_renderSubtreeIntoContainer=function(n,r,a,c){if(!Ol(a))throw Error(i(200));if(n==null||n._reactInternals===void 0)throw Error(i(38));return kl(n,r,a,!1,c)},Kt.version="18.3.1-next-f1338f8080-20240426",Kt}var mm;function zT(){if(mm)return Dd.exports;mm=1;function e(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}return e(),Dd.exports=$T(),Dd.exports}var vm;function WT(){if(vm)return Fl;vm=1;var e=zT();return Fl.createRoot=e.createRoot,Fl.hydrateRoot=e.hydrateRoot,Fl}var YT=WT();const jT=Y0(YT);class VT{constructor(){this.ids=[],this.values=[],this.length=0}clear(){this.length=0}push(t,i){let o=this.length++;for(;o>0;){const l=o-1>>1,s=this.values[l];if(i>=s)break;this.ids[o]=this.ids[l],this.values[o]=s,o=l}this.ids[o]=t,this.values[o]=i}pop(){if(this.length===0)return;const t=this.ids[0];if(this.length--,this.length>0){const i=this.ids[0]=this.ids[this.length],o=this.values[0]=this.values[this.length],l=this.length>>1;let s=0;for(;s<l;){let u=(s<<1)+1;const d=u+1;let f=this.ids[u],g=this.values[u];const m=this.values[d];if(d<this.length&&m<g&&(u=d,f=this.ids[d],g=m),g>=o)break;this.ids[s]=f,this.values[s]=g,s=u}this.ids[s]=i,this.values[s]=o}return t}peek(){if(this.length!==0)return this.ids[0]}peekValue(){if(this.length!==0)return this.values[0]}shrink(){this.ids.length=this.values.length=this.length}}const Sm=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array],Md=3;class Uf{static from(t,i=0){if(i%8!==0)throw new Error("byteOffset must be 8-byte aligned.");if(!t||t.byteLength===void 0||t.buffer)throw new Error("Data must be an instance of ArrayBuffer or SharedArrayBuffer.");const[o,l]=new Uint8Array(t,i+0,2);if(o!==251)throw new Error("Data does not appear to be in a Flatbush format.");const s=l>>4;if(s!==Md)throw new Error(`Got v${s} data when expected v${Md}.`);const u=Sm[l&15];if(!u)throw new Error("Unrecognized array type.");const[d]=new Uint16Array(t,i+2,1),[f]=new Uint32Array(t,i+4,1);return new Uf(f,d,u,void 0,t,i)}constructor(t,i=16,o=Float64Array,l=ArrayBuffer,s,u=0){if(t===void 0)throw new Error("Missing required argument: numItems.");if(isNaN(t)||t<=0)throw new Error(`Unexpected numItems value: ${t}.`);this.numItems=+t,this.nodeSize=Math.min(Math.max(+i,2),65535),this.byteOffset=u;let d=t,f=d;this._levelBounds=[d*4];do d=Math.ceil(d/this.nodeSize),f+=d,this._levelBounds.push(f*4);while(d!==1);this.ArrayType=o,this.IndexArrayType=f<16384?Uint16Array:Uint32Array;const g=Sm.indexOf(this.ArrayType),m=f*4*this.ArrayType.BYTES_PER_ELEMENT;if(g<0)throw new Error(`Unexpected typed array class: ${o}.`);s&&s.byteLength!==void 0&&!s.buffer?(this.data=s,this._boxes=new this.ArrayType(this.data,u+8,f*4),this._indices=new this.IndexArrayType(this.data,u+8+m,f),this._pos=f*4,this.minX=this._boxes[this._pos-4],this.minY=this._boxes[this._pos-3],this.maxX=this._boxes[this._pos-2],this.maxY=this._boxes[this._pos-1]):(this.data=new l(8+m+f*this.IndexArrayType.BYTES_PER_ELEMENT),this._boxes=new this.ArrayType(this.data,8,f*4),this._indices=new this.IndexArrayType(this.data,8+m,f),this._pos=0,this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0,new Uint8Array(this.data,0,2).set([251,(Md<<4)+g]),new Uint16Array(this.data,2,1)[0]=i,new Uint32Array(this.data,4,1)[0]=t),this._queue=new VT}add(t,i,o=t,l=i){const s=this._pos>>2,u=this._boxes;return this._indices[s]=s,u[this._pos++]=t,u[this._pos++]=i,u[this._pos++]=o,u[this._pos++]=l,t<this.minX&&(this.minX=t),i<this.minY&&(this.minY=i),o>this.maxX&&(this.maxX=o),l>this.maxY&&(this.maxY=l),s}finish(){if(this._pos>>2!==this.numItems)throw new Error(`Added ${this._pos>>2} items when expected ${this.numItems}.`);const t=this._boxes;if(this.numItems<=this.nodeSize){t[this._pos++]=this.minX,t[this._pos++]=this.minY,t[this._pos++]=this.maxX,t[this._pos++]=this.maxY;return}const i=this.maxX-this.minX||1,o=this.maxY-this.minY||1,l=new Uint32Array(this.numItems),s=65535;for(let u=0,d=0;u<this.numItems;u++){const f=t[d++],g=t[d++],m=t[d++],v=t[d++],y=Math.floor(s*((f+m)/2-this.minX)/i),I=Math.floor(s*((g+v)/2-this.minY)/o);l[u]=KT(y,I)}ff(l,t,this._indices,0,this.numItems-1,this.nodeSize);for(let u=0,d=0;u<this._levelBounds.length-1;u++){const f=this._levelBounds[u];for(;d<f;){const g=d;let m=t[d++],v=t[d++],y=t[d++],I=t[d++];for(let E=1;E<this.nodeSize&&d<f;E++)m=Math.min(m,t[d++]),v=Math.min(v,t[d++]),y=Math.max(y,t[d++]),I=Math.max(I,t[d++]);this._indices[this._pos>>2]=g,t[this._pos++]=m,t[this._pos++]=v,t[this._pos++]=y,t[this._pos++]=I}}}search(t,i,o,l,s){if(this._pos!==this._boxes.length)throw new Error("Data not yet indexed - call index.finish().");let u=this._boxes.length-4;const d=[],f=[];for(;u!==void 0;){const g=Math.min(u+this.nodeSize*4,Tm(u,this._levelBounds));for(let m=u;m<g;m+=4){if(o<this._boxes[m]||l<this._boxes[m+1]||t>this._boxes[m+2]||i>this._boxes[m+3])continue;const v=this._indices[m>>2]|0;u>=this.numItems*4?d.push(v):(s===void 0||s(v))&&f.push(v)}u=d.pop()}return f}neighbors(t,i,o=1/0,l=1/0,s){if(this._pos!==this._boxes.length)throw new Error("Data not yet indexed - call index.finish().");let u=this._boxes.length-4;const d=this._queue,f=[],g=l*l;e:for(;u!==void 0;){const m=Math.min(u+this.nodeSize*4,Tm(u,this._levelBounds));for(let v=u;v<m;v+=4){const y=this._indices[v>>2]|0,I=ym(t,this._boxes[v],this._boxes[v+2]),E=ym(i,this._boxes[v+1],this._boxes[v+3]),A=I*I+E*E;A>g||(u>=this.numItems*4?d.push(y<<1,A):(s===void 0||s(y))&&d.push((y<<1)+1,A))}for(;d.length&&d.peek()&1;)if(d.peekValue()>g||(f.push(d.pop()>>1),f.length===o))break e;u=d.length?d.pop()>>1:void 0}return d.clear(),f}}function ym(e,t,i){return e<t?t-e:e<=i?0:e-i}function Tm(e,t){let i=0,o=t.length-1;for(;i<o;){const l=i+o>>1;t[l]>e?o=l:i=l+1}return t[i]}function ff(e,t,i,o,l,s){if(Math.floor(o/s)>=Math.floor(l/s))return;const u=e[o+l>>1];let d=o-1,f=l+1;for(;;){do d++;while(e[d]<u);do f--;while(e[f]>u);if(d>=f)break;XT(e,t,i,d,f)}ff(e,t,i,o,f,s),ff(e,t,i,f+1,l,s)}function XT(e,t,i,o,l){const s=e[o];e[o]=e[l],e[l]=s;const u=4*o,d=4*l,f=t[u],g=t[u+1],m=t[u+2],v=t[u+3];t[u]=t[d],t[u+1]=t[d+1],t[u+2]=t[d+2],t[u+3]=t[d+3],t[d]=f,t[d+1]=g,t[d+2]=m,t[d+3]=v;const y=i[o];i[o]=i[l],i[l]=y}function KT(e,t){let i=e^t,o=65535^i,l=65535^(e|t),s=e&(t^65535),u=i|o>>1,d=i>>1^i,f=l>>1^o&s>>1^l,g=i&l>>1^s>>1^s;i=u,o=d,l=f,s=g,u=i&i>>2^o&o>>2,d=i&o>>2^o&(i^o)>>2,f^=i&l>>2^o&s>>2,g^=o&l>>2^(i^o)&s>>2,i=u,o=d,l=f,s=g,u=i&i>>4^o&o>>4,d=i&o>>4^o&(i^o)>>4,f^=i&l>>4^o&s>>4,g^=o&l>>4^(i^o)&s>>4,i=u,o=d,l=f,s=g,f^=i&l>>8^o&s>>8,g^=o&l>>8^(i^o)&s>>8,i=f^f>>1,o=g^g>>1;let m=e^t,v=o|65535^(m|i);return m=(m|m<<8)&16711935,m=(m|m<<4)&252645135,m=(m|m<<2)&858993459,m=(m|m<<1)&1431655765,v=(v|v<<8)&16711935,v=(v|v<<4)&252645135,v=(v|v<<2)&858993459,v=(v|v<<1)&1431655765,(v<<1|m)>>>0}function po(e,t){if(e.length===0)return{all:()=>[],byRect:()=>[],byRadius:()=>[],byProperty:()=>[],resetPropertyCache:()=>{},count:()=>0};const i=new Uf(e.length),o=new Map;for(const s of e)i.add(s.position.x,s.position.y,s.position.x,s.position.y);return i.finish(),{all(){return e},byRect(s){return i.search(s.left,s.top,s.right,s.bottom).map(d=>e[d])},byRadius(s,u){return i.neighbors(s.x,s.y,void 0,u).map(f=>e[f])},byProperty(s,u){var d;if(!o.has(s)){const f=new Map;for(const g of e){const m=g[s];f.has(m)||f.set(m,[]),f.get(m).push(g)}o.set(s,f)}return((d=o.get(s))==null?void 0:d.get(u))||[]},resetPropertyCache(){o.clear()},count(){return e.length}}}function wu(e){const t=Object.values(e.entities.entities),i=t.filter(g=>g.type==="human"),o=t.filter(g=>g.type==="berryBush"),l=t.filter(g=>g.type==="corpse"),s=t.filter(g=>g.type==="prey"),u=t.filter(g=>g.type==="predator"),d=t.filter(g=>g.type==="building");return{...e,search:{human:po(i),berryBush:po(o),corpse:po(l),prey:po(s),predator:po(u),building:po(d)}}}const ZT="tribe-game-db",tr="save-files",Bf="tribe-game-save",hf=1;async function Hf(e){try{const t={version:hf,savedAt:Date.now(),gameState:e},i=JSON.stringify(t),o=await QT(i);await eA(Bf,o),console.log(`Game saved successfully. Size: ${(o.size/1024).toFixed(2)} KB`)}catch(t){throw console.error("Failed to save game:",t),t}}async function qT(){try{const e=await tA(Bf);if(!e)return null;const t=await JT(e),i=JSON.parse(t);return i.version!==hf?(console.warn(`Save game version mismatch. Expected ${hf}, found ${i.version}. Discarding save.`),await gf(),null):(console.log("Game loaded successfully."),wu(i.gameState))}catch(e){return console.error("Failed to load game:",e),await gf(),null}}async function gf(){try{await nA(Bf),console.log("Saved game cleared.")}catch(e){console.error("Failed to clear saved game:",e)}}async function QT(e){const i=new Blob([e]).stream().pipeThrough(new CompressionStream("gzip"));return await new Response(i).blob()}async function JT(e){const t=e.stream().pipeThrough(new DecompressionStream("gzip"));return await new Response(t).text()}function bf(){return new Promise((e,t)=>{const i=indexedDB.open(ZT,1);i.onupgradeneeded=o=>{const l=o.target.result;l.objectStoreNames.contains(tr)||l.createObjectStore(tr)},i.onsuccess=()=>e(i.result),i.onerror=()=>t(i.error)})}async function eA(e,t){const i=await bf();return new Promise((o,l)=>{const d=i.transaction(tr,"readwrite").objectStore(tr).put(t,e);d.onsuccess=()=>o(),d.onerror=()=>l(d.error)})}async function tA(e){const t=await bf();return new Promise((i,o)=>{const u=t.transaction(tr,"readonly").objectStore(tr).get(e);u.onsuccess=()=>i(u.result),u.onerror=()=>o(u.error)})}async function nA(e){const t=await bf();return new Promise((i,o)=>{const u=t.transaction(tr,"readwrite").objectStore(tr).delete(e);u.onsuccess=()=>i(),u.onerror=()=>o(u.error)})}const j0=Re.createContext(void 0),iA=({initialAppState:e,children:t})=>{const[i,o]=Re.useState(e),[l,s]=Re.useState(void 0),[u,d]=Re.useState(null),[f,g]=Re.useState(!1);Re.useEffect(()=>{qT().then(E=>{E&&d(E),g(!0)})},[]);const m=(E,A)=>{o(E),E==="gameOver"&&A?s(A):E!=="gameOver"&&s(void 0)},v=()=>{o("intro"),s(void 0),I()},y=E=>{Hf(E),d(E)},I=()=>{gf(),d(null)};return Fe.jsx(j0.Provider,{value:{appState:i,setAppState:m,returnToIntro:v,gameOverDetails:l,contextReady:f,savedGameState:u,setSavedGameState:d,saveCurrentGame:y,clearCurrentSave:I},children:t})},Yo=()=>{const e=Re.useContext(j0);if(e===void 0)throw new Error("useGameContext must be used within a GameProvider");return e};var Lt=function(){return Lt=Object.assign||function(t){for(var i,o=1,l=arguments.length;o<l;o++){i=arguments[o];for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&(t[s]=i[s])}return t},Lt.apply(this,arguments)};function sa(e,t,i){if(i||arguments.length===2)for(var o=0,l=t.length,s;o<l;o++)(s||!(o in t))&&(s||(s=Array.prototype.slice.call(t,0,o)),s[o]=t[o]);return e.concat(s||Array.prototype.slice.call(t))}var Ze="-ms-",qs="-moz-",$e="-webkit-",V0="comm",_u="rule",Gf="decl",rA="@import",X0="@keyframes",oA="@layer",K0=Math.abs,xf=String.fromCharCode,pf=Object.assign;function sA(e,t){return It(e,0)^45?(((t<<2^It(e,0))<<2^It(e,1))<<2^It(e,2))<<2^It(e,3):0}function Z0(e){return e.trim()}function fi(e,t){return(e=t.exec(e))?e[0]:e}function Me(e,t,i){return e.replace(t,i)}function iu(e,t,i){return e.indexOf(t,i)}function It(e,t){return e.charCodeAt(t)|0}function Mo(e,t,i){return e.slice(t,i)}function Jn(e){return e.length}function q0(e){return e.length}function js(e,t){return t.push(e),e}function aA(e,t){return e.map(t).join("")}function Am(e,t){return e.filter(function(i){return!fi(i,t)})}var Cu=1,Fo=1,Q0=0,An=0,ht=0,jo="";function Ru(e,t,i,o,l,s,u,d){return{value:e,root:t,parent:i,type:o,props:l,children:s,line:Cu,column:Fo,length:u,return:"",siblings:d}}function Wi(e,t){return pf(Ru("",null,null,"",null,null,0,e.siblings),e,{length:-e.length},t)}function mo(e){for(;e.root;)e=Wi(e.root,{children:[e]});js(e,e.siblings)}function lA(){return ht}function uA(){return ht=An>0?It(jo,--An):0,Fo--,ht===10&&(Fo=1,Cu--),ht}function Ln(){return ht=An<Q0?It(jo,An++):0,Fo++,ht===10&&(Fo=1,Cu++),ht}function Dr(){return It(jo,An)}function ru(){return An}function Pu(e,t){return Mo(jo,e,t)}function mf(e){switch(e){case 0:case 9:case 10:case 13:case 32:return 5;case 33:case 43:case 44:case 47:case 62:case 64:case 126:case 59:case 123:case 125:return 4;case 58:return 3;case 34:case 39:case 40:case 91:return 2;case 41:case 93:return 1}return 0}function cA(e){return Cu=Fo=1,Q0=Jn(jo=e),An=0,[]}function dA(e){return jo="",e}function Fd(e){return Z0(Pu(An-1,vf(e===91?e+2:e===40?e+1:e)))}function fA(e){for(;(ht=Dr())&&ht<33;)Ln();return mf(e)>2||mf(ht)>3?"":" "}function hA(e,t){for(;--t&&Ln()&&!(ht<48||ht>102||ht>57&&ht<65||ht>70&&ht<97););return Pu(e,ru()+(t<6&&Dr()==32&&Ln()==32))}function vf(e){for(;Ln();)switch(ht){case e:return An;case 34:case 39:e!==34&&e!==39&&vf(ht);break;case 40:e===41&&vf(e);break;case 92:Ln();break}return An}function gA(e,t){for(;Ln()&&e+ht!==57;)if(e+ht===84&&Dr()===47)break;return"/*"+Pu(t,An-1)+"*"+xf(e===47?e:Ln())}function pA(e){for(;!mf(Dr());)Ln();return Pu(e,An)}function mA(e){return dA(ou("",null,null,null,[""],e=cA(e),0,[0],e))}function ou(e,t,i,o,l,s,u,d,f){for(var g=0,m=0,v=u,y=0,I=0,E=0,A=1,w=1,F=1,B=0,D="",H=l,b=s,L=o,$=D;w;)switch(E=B,B=Ln()){case 40:if(E!=108&&It($,v-1)==58){iu($+=Me(Fd(B),"&","&\f"),"&\f",K0(g?d[g-1]:0))!=-1&&(F=-1);break}case 34:case 39:case 91:$+=Fd(B);break;case 9:case 10:case 13:case 32:$+=fA(E);break;case 92:$+=hA(ru()-1,7);continue;case 47:switch(Dr()){case 42:case 47:js(vA(gA(Ln(),ru()),t,i,f),f);break;default:$+="/"}break;case 123*A:d[g++]=Jn($)*F;case 125*A:case 59:case 0:switch(B){case 0:case 125:w=0;case 59+m:F==-1&&($=Me($,/\f/g,"")),I>0&&Jn($)-v&&js(I>32?Em($+";",o,i,v-1,f):Em(Me($," ","")+";",o,i,v-2,f),f);break;case 59:$+=";";default:if(js(L=Im($,t,i,g,m,l,d,D,H=[],b=[],v,s),s),B===123)if(m===0)ou($,t,L,L,H,s,v,d,b);else switch(y===99&&It($,3)===110?100:y){case 100:case 108:case 109:case 115:ou(e,L,L,o&&js(Im(e,L,L,0,0,l,d,D,l,H=[],v,b),b),l,b,v,d,o?H:b);break;default:ou($,L,L,L,[""],b,0,d,b)}}g=m=I=0,A=F=1,D=$="",v=u;break;case 58:v=1+Jn($),I=E;default:if(A<1){if(B==123)--A;else if(B==125&&A++==0&&uA()==125)continue}switch($+=xf(B),B*A){case 38:F=m>0?1:($+="\f",-1);break;case 44:d[g++]=(Jn($)-1)*F,F=1;break;case 64:Dr()===45&&($+=Fd(Ln())),y=Dr(),m=v=Jn(D=$+=pA(ru())),B++;break;case 45:E===45&&Jn($)==2&&(A=0)}}return s}function Im(e,t,i,o,l,s,u,d,f,g,m,v){for(var y=l-1,I=l===0?s:[""],E=q0(I),A=0,w=0,F=0;A<o;++A)for(var B=0,D=Mo(e,y+1,y=K0(w=u[A])),H=e;B<E;++B)(H=Z0(w>0?I[B]+" "+D:Me(D,/&\f/g,I[B])))&&(f[F++]=H);return Ru(e,t,i,l===0?_u:d,f,g,m,v)}function vA(e,t,i,o){return Ru(e,t,i,V0,xf(lA()),Mo(e,2,-2),0,o)}function Em(e,t,i,o,l){return Ru(e,t,i,Gf,Mo(e,0,o),Mo(e,o+1,-1),o,l)}function J0(e,t,i){switch(sA(e,t)){case 5103:return $e+"print-"+e+e;case 5737:case 4201:case 3177:case 3433:case 1641:case 4457:case 2921:case 5572:case 6356:case 5844:case 3191:case 6645:case 3005:case 6391:case 5879:case 5623:case 6135:case 4599:case 4855:case 4215:case 6389:case 5109:case 5365:case 5621:case 3829:return $e+e+e;case 4789:return qs+e+e;case 5349:case 4246:case 4810:case 6968:case 2756:return $e+e+qs+e+Ze+e+e;case 5936:switch(It(e,t+11)){case 114:return $e+e+Ze+Me(e,/[svh]\w+-[tblr]{2}/,"tb")+e;case 108:return $e+e+Ze+Me(e,/[svh]\w+-[tblr]{2}/,"tb-rl")+e;case 45:return $e+e+Ze+Me(e,/[svh]\w+-[tblr]{2}/,"lr")+e}case 6828:case 4268:case 2903:return $e+e+Ze+e+e;case 6165:return $e+e+Ze+"flex-"+e+e;case 5187:return $e+e+Me(e,/(\w+).+(:[^]+)/,$e+"box-$1$2"+Ze+"flex-$1$2")+e;case 5443:return $e+e+Ze+"flex-item-"+Me(e,/flex-|-self/g,"")+(fi(e,/flex-|baseline/)?"":Ze+"grid-row-"+Me(e,/flex-|-self/g,""))+e;case 4675:return $e+e+Ze+"flex-line-pack"+Me(e,/align-content|flex-|-self/g,"")+e;case 5548:return $e+e+Ze+Me(e,"shrink","negative")+e;case 5292:return $e+e+Ze+Me(e,"basis","preferred-size")+e;case 6060:return $e+"box-"+Me(e,"-grow","")+$e+e+Ze+Me(e,"grow","positive")+e;case 4554:return $e+Me(e,/([^-])(transform)/g,"$1"+$e+"$2")+e;case 6187:return Me(Me(Me(e,/(zoom-|grab)/,$e+"$1"),/(image-set)/,$e+"$1"),e,"")+e;case 5495:case 3959:return Me(e,/(image-set\([^]*)/,$e+"$1$`$1");case 4968:return Me(Me(e,/(.+:)(flex-)?(.*)/,$e+"box-pack:$3"+Ze+"flex-pack:$3"),/s.+-b[^;]+/,"justify")+$e+e+e;case 4200:if(!fi(e,/flex-|baseline/))return Ze+"grid-column-align"+Mo(e,t)+e;break;case 2592:case 3360:return Ze+Me(e,"template-","")+e;case 4384:case 3616:return i&&i.some(function(o,l){return t=l,fi(o.props,/grid-\w+-end/)})?~iu(e+(i=i[t].value),"span",0)?e:Ze+Me(e,"-start","")+e+Ze+"grid-row-span:"+(~iu(i,"span",0)?fi(i,/\d+/):+fi(i,/\d+/)-+fi(e,/\d+/))+";":Ze+Me(e,"-start","")+e;case 4896:case 4128:return i&&i.some(function(o){return fi(o.props,/grid-\w+-start/)})?e:Ze+Me(Me(e,"-end","-span"),"span ","")+e;case 4095:case 3583:case 4068:case 2532:return Me(e,/(.+)-inline(.+)/,$e+"$1$2")+e;case 8116:case 7059:case 5753:case 5535:case 5445:case 5701:case 4933:case 4677:case 5533:case 5789:case 5021:case 4765:if(Jn(e)-1-t>6)switch(It(e,t+1)){case 109:if(It(e,t+4)!==45)break;case 102:return Me(e,/(.+:)(.+)-([^]+)/,"$1"+$e+"$2-$3$1"+qs+(It(e,t+3)==108?"$3":"$2-$3"))+e;case 115:return~iu(e,"stretch",0)?J0(Me(e,"stretch","fill-available"),t,i)+e:e}break;case 5152:case 5920:return Me(e,/(.+?):(\d+)(\s*\/\s*(span)?\s*(\d+))?(.*)/,function(o,l,s,u,d,f,g){return Ze+l+":"+s+g+(u?Ze+l+"-span:"+(d?f:+f-+s)+g:"")+e});case 4949:if(It(e,t+6)===121)return Me(e,":",":"+$e)+e;break;case 6444:switch(It(e,It(e,14)===45?18:11)){case 120:return Me(e,/(.+:)([^;\s!]+)(;|(\s+)?!.+)?/,"$1"+$e+(It(e,14)===45?"inline-":"")+"box$3$1"+$e+"$2$3$1"+Ze+"$2box$3")+e;case 100:return Me(e,":",":"+Ze)+e}break;case 5719:case 2647:case 2135:case 3927:case 2391:return Me(e,"scroll-","scroll-snap-")+e}return e}function fu(e,t){for(var i="",o=0;o<e.length;o++)i+=t(e[o],o,e,t)||"";return i}function SA(e,t,i,o){switch(e.type){case oA:if(e.children.length)break;case rA:case Gf:return e.return=e.return||e.value;case V0:return"";case X0:return e.return=e.value+"{"+fu(e.children,o)+"}";case _u:if(!Jn(e.value=e.props.join(",")))return""}return Jn(i=fu(e.children,o))?e.return=e.value+"{"+i+"}":""}function yA(e){var t=q0(e);return function(i,o,l,s){for(var u="",d=0;d<t;d++)u+=e[d](i,o,l,s)||"";return u}}function TA(e){return function(t){t.root||(t=t.return)&&e(t)}}function AA(e,t,i,o){if(e.length>-1&&!e.return)switch(e.type){case Gf:e.return=J0(e.value,e.length,i);return;case X0:return fu([Wi(e,{value:Me(e.value,"@","@"+$e)})],o);case _u:if(e.length)return aA(i=e.props,function(l){switch(fi(l,o=/(::plac\w+|:read-\w+)/)){case":read-only":case":read-write":mo(Wi(e,{props:[Me(l,/:(read-\w+)/,":"+qs+"$1")]})),mo(Wi(e,{props:[l]})),pf(e,{props:Am(i,o)});break;case"::placeholder":mo(Wi(e,{props:[Me(l,/:(plac\w+)/,":"+$e+"input-$1")]})),mo(Wi(e,{props:[Me(l,/:(plac\w+)/,":"+qs+"$1")]})),mo(Wi(e,{props:[Me(l,/:(plac\w+)/,Ze+"input-$1")]})),mo(Wi(e,{props:[l]})),pf(e,{props:Am(i,o)});break}return""})}}var IA={animationIterationCount:1,aspectRatio:1,borderImageOutset:1,borderImageSlice:1,borderImageWidth:1,boxFlex:1,boxFlexGroup:1,boxOrdinalGroup:1,columnCount:1,columns:1,flex:1,flexGrow:1,flexPositive:1,flexShrink:1,flexNegative:1,flexOrder:1,gridRow:1,gridRowEnd:1,gridRowSpan:1,gridRowStart:1,gridColumn:1,gridColumnEnd:1,gridColumnSpan:1,gridColumnStart:1,msGridRow:1,msGridRowSpan:1,msGridColumn:1,msGridColumnSpan:1,fontWeight:1,lineHeight:1,opacity:1,order:1,orphans:1,tabSize:1,widows:1,zIndex:1,zoom:1,WebkitLineClamp:1,fillOpacity:1,floodOpacity:1,stopOpacity:1,strokeDasharray:1,strokeDashoffset:1,strokeMiterlimit:1,strokeOpacity:1,strokeWidth:1},sn={},Lo=typeof process<"u"&&sn!==void 0&&(sn.REACT_APP_SC_ATTR||sn.SC_ATTR)||"data-styled",ev="active",tv="data-styled-version",Nu="6.1.13",$f=`/*!sc*/
`,hu=typeof window<"u"&&"HTMLElement"in window,EA=!!(typeof SC_DISABLE_SPEEDY=="boolean"?SC_DISABLE_SPEEDY:typeof process<"u"&&sn!==void 0&&sn.REACT_APP_SC_DISABLE_SPEEDY!==void 0&&sn.REACT_APP_SC_DISABLE_SPEEDY!==""?sn.REACT_APP_SC_DISABLE_SPEEDY!=="false"&&sn.REACT_APP_SC_DISABLE_SPEEDY:typeof process<"u"&&sn!==void 0&&sn.SC_DISABLE_SPEEDY!==void 0&&sn.SC_DISABLE_SPEEDY!==""&&sn.SC_DISABLE_SPEEDY!=="false"&&sn.SC_DISABLE_SPEEDY),wA={},Du=Object.freeze([]),Uo=Object.freeze({});function nv(e,t,i){return i===void 0&&(i=Uo),e.theme!==i.theme&&e.theme||t||i.theme}var iv=new Set(["a","abbr","address","area","article","aside","audio","b","base","bdi","bdo","big","blockquote","body","br","button","canvas","caption","cite","code","col","colgroup","data","datalist","dd","del","details","dfn","dialog","div","dl","dt","em","embed","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","header","hgroup","hr","html","i","iframe","img","input","ins","kbd","keygen","label","legend","li","link","main","map","mark","menu","menuitem","meta","meter","nav","noscript","object","ol","optgroup","option","output","p","param","picture","pre","progress","q","rp","rt","ruby","s","samp","script","section","select","small","source","span","strong","style","sub","summary","sup","table","tbody","td","textarea","tfoot","th","thead","time","tr","track","u","ul","use","var","video","wbr","circle","clipPath","defs","ellipse","foreignObject","g","image","line","linearGradient","marker","mask","path","pattern","polygon","polyline","radialGradient","rect","stop","svg","text","tspan"]),_A=/[!"#$%&'()*+,./:;<=>?@[\\\]^`{|}~-]+/g,CA=/(^-|-$)/g;function wm(e){return e.replace(_A,"-").replace(CA,"")}var RA=/(a)(d)/gi,Ll=52,_m=function(e){return String.fromCharCode(e+(e>25?39:97))};function Sf(e){var t,i="";for(t=Math.abs(e);t>Ll;t=t/Ll|0)i=_m(t%Ll)+i;return(_m(t%Ll)+i).replace(RA,"$1-$2")}var Ld,rv=5381,Co=function(e,t){for(var i=t.length;i;)e=33*e^t.charCodeAt(--i);return e},ov=function(e){return Co(rv,e)};function sv(e){return Sf(ov(e)>>>0)}function PA(e){return e.displayName||e.name||"Component"}function Ud(e){return typeof e=="string"&&!0}var av=typeof Symbol=="function"&&Symbol.for,lv=av?Symbol.for("react.memo"):60115,NA=av?Symbol.for("react.forward_ref"):60112,DA={childContextTypes:!0,contextType:!0,contextTypes:!0,defaultProps:!0,displayName:!0,getDefaultProps:!0,getDerivedStateFromError:!0,getDerivedStateFromProps:!0,mixins:!0,propTypes:!0,type:!0},OA={name:!0,length:!0,prototype:!0,caller:!0,callee:!0,arguments:!0,arity:!0},uv={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},kA=((Ld={})[NA]={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},Ld[lv]=uv,Ld);function Cm(e){return("type"in(t=e)&&t.type.$$typeof)===lv?uv:"$$typeof"in e?kA[e.$$typeof]:DA;var t}var MA=Object.defineProperty,FA=Object.getOwnPropertyNames,Rm=Object.getOwnPropertySymbols,LA=Object.getOwnPropertyDescriptor,UA=Object.getPrototypeOf,Pm=Object.prototype;function cv(e,t,i){if(typeof t!="string"){if(Pm){var o=UA(t);o&&o!==Pm&&cv(e,o,i)}var l=FA(t);Rm&&(l=l.concat(Rm(t)));for(var s=Cm(e),u=Cm(t),d=0;d<l.length;++d){var f=l[d];if(!(f in OA||i&&i[f]||u&&f in u||s&&f in s)){var g=LA(t,f);try{MA(e,f,g)}catch{}}}}return e}function Bo(e){return typeof e=="function"}function zf(e){return typeof e=="object"&&"styledComponentId"in e}function Rr(e,t){return e&&t?"".concat(e," ").concat(t):e||t||""}function yf(e,t){if(e.length===0)return"";for(var i=e[0],o=1;o<e.length;o++)i+=e[o];return i}function aa(e){return e!==null&&typeof e=="object"&&e.constructor.name===Object.name&&!("props"in e&&e.$$typeof)}function Tf(e,t,i){if(i===void 0&&(i=!1),!i&&!aa(e)&&!Array.isArray(e))return t;if(Array.isArray(t))for(var o=0;o<t.length;o++)e[o]=Tf(e[o],t[o]);else if(aa(t))for(var o in t)e[o]=Tf(e[o],t[o]);return e}function Wf(e,t){Object.defineProperty(e,"toString",{value:t})}function Ta(e){for(var t=[],i=1;i<arguments.length;i++)t[i-1]=arguments[i];return new Error("An error occurred. See https://github.com/styled-components/styled-components/blob/main/packages/styled-components/src/utils/errors.md#".concat(e," for more information.").concat(t.length>0?" Args: ".concat(t.join(", ")):""))}var BA=function(){function e(t){this.groupSizes=new Uint32Array(512),this.length=512,this.tag=t}return e.prototype.indexOfGroup=function(t){for(var i=0,o=0;o<t;o++)i+=this.groupSizes[o];return i},e.prototype.insertRules=function(t,i){if(t>=this.groupSizes.length){for(var o=this.groupSizes,l=o.length,s=l;t>=s;)if((s<<=1)<0)throw Ta(16,"".concat(t));this.groupSizes=new Uint32Array(s),this.groupSizes.set(o),this.length=s;for(var u=l;u<s;u++)this.groupSizes[u]=0}for(var d=this.indexOfGroup(t+1),f=(u=0,i.length);u<f;u++)this.tag.insertRule(d,i[u])&&(this.groupSizes[t]++,d++)},e.prototype.clearGroup=function(t){if(t<this.length){var i=this.groupSizes[t],o=this.indexOfGroup(t),l=o+i;this.groupSizes[t]=0;for(var s=o;s<l;s++)this.tag.deleteRule(o)}},e.prototype.getGroup=function(t){var i="";if(t>=this.length||this.groupSizes[t]===0)return i;for(var o=this.groupSizes[t],l=this.indexOfGroup(t),s=l+o,u=l;u<s;u++)i+="".concat(this.tag.getRule(u)).concat($f);return i},e}(),su=new Map,gu=new Map,au=1,Ul=function(e){if(su.has(e))return su.get(e);for(;gu.has(au);)au++;var t=au++;return su.set(e,t),gu.set(t,e),t},HA=function(e,t){au=t+1,su.set(e,t),gu.set(t,e)},bA="style[".concat(Lo,"][").concat(tv,'="').concat(Nu,'"]'),GA=new RegExp("^".concat(Lo,'\\.g(\\d+)\\[id="([\\w\\d-]+)"\\].*?"([^"]*)')),xA=function(e,t,i){for(var o,l=i.split(","),s=0,u=l.length;s<u;s++)(o=l[s])&&e.registerName(t,o)},$A=function(e,t){for(var i,o=((i=t.textContent)!==null&&i!==void 0?i:"").split($f),l=[],s=0,u=o.length;s<u;s++){var d=o[s].trim();if(d){var f=d.match(GA);if(f){var g=0|parseInt(f[1],10),m=f[2];g!==0&&(HA(m,g),xA(e,m,f[3]),e.getTag().insertRules(g,l)),l.length=0}else l.push(d)}}},Nm=function(e){for(var t=document.querySelectorAll(bA),i=0,o=t.length;i<o;i++){var l=t[i];l&&l.getAttribute(Lo)!==ev&&($A(e,l),l.parentNode&&l.parentNode.removeChild(l))}};function zA(){return typeof __webpack_nonce__<"u"?__webpack_nonce__:null}var dv=function(e){var t=document.head,i=e||t,o=document.createElement("style"),l=function(d){var f=Array.from(d.querySelectorAll("style[".concat(Lo,"]")));return f[f.length-1]}(i),s=l!==void 0?l.nextSibling:null;o.setAttribute(Lo,ev),o.setAttribute(tv,Nu);var u=zA();return u&&o.setAttribute("nonce",u),i.insertBefore(o,s),o},WA=function(){function e(t){this.element=dv(t),this.element.appendChild(document.createTextNode("")),this.sheet=function(i){if(i.sheet)return i.sheet;for(var o=document.styleSheets,l=0,s=o.length;l<s;l++){var u=o[l];if(u.ownerNode===i)return u}throw Ta(17)}(this.element),this.length=0}return e.prototype.insertRule=function(t,i){try{return this.sheet.insertRule(i,t),this.length++,!0}catch{return!1}},e.prototype.deleteRule=function(t){this.sheet.deleteRule(t),this.length--},e.prototype.getRule=function(t){var i=this.sheet.cssRules[t];return i&&i.cssText?i.cssText:""},e}(),YA=function(){function e(t){this.element=dv(t),this.nodes=this.element.childNodes,this.length=0}return e.prototype.insertRule=function(t,i){if(t<=this.length&&t>=0){var o=document.createTextNode(i);return this.element.insertBefore(o,this.nodes[t]||null),this.length++,!0}return!1},e.prototype.deleteRule=function(t){this.element.removeChild(this.nodes[t]),this.length--},e.prototype.getRule=function(t){return t<this.length?this.nodes[t].textContent:""},e}(),jA=function(){function e(t){this.rules=[],this.length=0}return e.prototype.insertRule=function(t,i){return t<=this.length&&(this.rules.splice(t,0,i),this.length++,!0)},e.prototype.deleteRule=function(t){this.rules.splice(t,1),this.length--},e.prototype.getRule=function(t){return t<this.length?this.rules[t]:""},e}(),Dm=hu,VA={isServer:!hu,useCSSOMInjection:!EA},pu=function(){function e(t,i,o){t===void 0&&(t=Uo),i===void 0&&(i={});var l=this;this.options=Lt(Lt({},VA),t),this.gs=i,this.names=new Map(o),this.server=!!t.isServer,!this.server&&hu&&Dm&&(Dm=!1,Nm(this)),Wf(this,function(){return function(s){for(var u=s.getTag(),d=u.length,f="",g=function(v){var y=function(F){return gu.get(F)}(v);if(y===void 0)return"continue";var I=s.names.get(y),E=u.getGroup(v);if(I===void 0||!I.size||E.length===0)return"continue";var A="".concat(Lo,".g").concat(v,'[id="').concat(y,'"]'),w="";I!==void 0&&I.forEach(function(F){F.length>0&&(w+="".concat(F,","))}),f+="".concat(E).concat(A,'{content:"').concat(w,'"}').concat($f)},m=0;m<d;m++)g(m);return f}(l)})}return e.registerId=function(t){return Ul(t)},e.prototype.rehydrate=function(){!this.server&&hu&&Nm(this)},e.prototype.reconstructWithOptions=function(t,i){return i===void 0&&(i=!0),new e(Lt(Lt({},this.options),t),this.gs,i&&this.names||void 0)},e.prototype.allocateGSInstance=function(t){return this.gs[t]=(this.gs[t]||0)+1},e.prototype.getTag=function(){return this.tag||(this.tag=(t=function(i){var o=i.useCSSOMInjection,l=i.target;return i.isServer?new jA(l):o?new WA(l):new YA(l)}(this.options),new BA(t)));var t},e.prototype.hasNameForId=function(t,i){return this.names.has(t)&&this.names.get(t).has(i)},e.prototype.registerName=function(t,i){if(Ul(t),this.names.has(t))this.names.get(t).add(i);else{var o=new Set;o.add(i),this.names.set(t,o)}},e.prototype.insertRules=function(t,i,o){this.registerName(t,i),this.getTag().insertRules(Ul(t),o)},e.prototype.clearNames=function(t){this.names.has(t)&&this.names.get(t).clear()},e.prototype.clearRules=function(t){this.getTag().clearGroup(Ul(t)),this.clearNames(t)},e.prototype.clearTag=function(){this.tag=void 0},e}(),XA=/&/g,KA=/^\s*\/\/.*$/gm;function fv(e,t){return e.map(function(i){return i.type==="rule"&&(i.value="".concat(t," ").concat(i.value),i.value=i.value.replaceAll(",",",".concat(t," ")),i.props=i.props.map(function(o){return"".concat(t," ").concat(o)})),Array.isArray(i.children)&&i.type!=="@keyframes"&&(i.children=fv(i.children,t)),i})}function ZA(e){var t,i,o,l=Uo,s=l.options,u=s===void 0?Uo:s,d=l.plugins,f=d===void 0?Du:d,g=function(y,I,E){return E.startsWith(i)&&E.endsWith(i)&&E.replaceAll(i,"").length>0?".".concat(t):y},m=f.slice();m.push(function(y){y.type===_u&&y.value.includes("&")&&(y.props[0]=y.props[0].replace(XA,i).replace(o,g))}),u.prefix&&m.push(AA),m.push(SA);var v=function(y,I,E,A){I===void 0&&(I=""),E===void 0&&(E=""),A===void 0&&(A="&"),t=A,i=I,o=new RegExp("\\".concat(i,"\\b"),"g");var w=y.replace(KA,""),F=mA(E||I?"".concat(E," ").concat(I," { ").concat(w," }"):w);u.namespace&&(F=fv(F,u.namespace));var B=[];return fu(F,yA(m.concat(TA(function(D){return B.push(D)})))),B};return v.hash=f.length?f.reduce(function(y,I){return I.name||Ta(15),Co(y,I.name)},rv).toString():"",v}var qA=new pu,Af=ZA(),hv=ei.createContext({shouldForwardProp:void 0,styleSheet:qA,stylis:Af});hv.Consumer;ei.createContext(void 0);function If(){return Re.useContext(hv)}var QA=function(){function e(t,i){var o=this;this.inject=function(l,s){s===void 0&&(s=Af);var u=o.name+s.hash;l.hasNameForId(o.id,u)||l.insertRules(o.id,u,s(o.rules,u,"@keyframes"))},this.name=t,this.id="sc-keyframes-".concat(t),this.rules=i,Wf(this,function(){throw Ta(12,String(o.name))})}return e.prototype.getName=function(t){return t===void 0&&(t=Af),this.name+t.hash},e}(),JA=function(e){return e>="A"&&e<="Z"};function Om(e){for(var t="",i=0;i<e.length;i++){var o=e[i];if(i===1&&o==="-"&&e[0]==="-")return e;JA(o)?t+="-"+o.toLowerCase():t+=o}return t.startsWith("ms-")?"-"+t:t}var gv=function(e){return e==null||e===!1||e===""},pv=function(e){var t,i,o=[];for(var l in e){var s=e[l];e.hasOwnProperty(l)&&!gv(s)&&(Array.isArray(s)&&s.isCss||Bo(s)?o.push("".concat(Om(l),":"),s,";"):aa(s)?o.push.apply(o,sa(sa(["".concat(l," {")],pv(s),!1),["}"],!1)):o.push("".concat(Om(l),": ").concat((t=l,(i=s)==null||typeof i=="boolean"||i===""?"":typeof i!="number"||i===0||t in IA||t.startsWith("--")?String(i).trim():"".concat(i,"px")),";")))}return o};function Ji(e,t,i,o){if(gv(e))return[];if(zf(e))return[".".concat(e.styledComponentId)];if(Bo(e)){if(!Bo(s=e)||s.prototype&&s.prototype.isReactComponent||!t)return[e];var l=e(t);return Ji(l,t,i,o)}var s;return e instanceof QA?i?(e.inject(i,o),[e.getName(o)]):[e]:aa(e)?pv(e):Array.isArray(e)?Array.prototype.concat.apply(Du,e.map(function(u){return Ji(u,t,i,o)})):[e.toString()]}function mv(e){for(var t=0;t<e.length;t+=1){var i=e[t];if(Bo(i)&&!zf(i))return!1}return!0}var eI=ov(Nu),tI=function(){function e(t,i,o){this.rules=t,this.staticRulesId="",this.isStatic=(o===void 0||o.isStatic)&&mv(t),this.componentId=i,this.baseHash=Co(eI,i),this.baseStyle=o,pu.registerId(i)}return e.prototype.generateAndInjectStyles=function(t,i,o){var l=this.baseStyle?this.baseStyle.generateAndInjectStyles(t,i,o):"";if(this.isStatic&&!o.hash)if(this.staticRulesId&&i.hasNameForId(this.componentId,this.staticRulesId))l=Rr(l,this.staticRulesId);else{var s=yf(Ji(this.rules,t,i,o)),u=Sf(Co(this.baseHash,s)>>>0);if(!i.hasNameForId(this.componentId,u)){var d=o(s,".".concat(u),void 0,this.componentId);i.insertRules(this.componentId,u,d)}l=Rr(l,u),this.staticRulesId=u}else{for(var f=Co(this.baseHash,o.hash),g="",m=0;m<this.rules.length;m++){var v=this.rules[m];if(typeof v=="string")g+=v;else if(v){var y=yf(Ji(v,t,i,o));f=Co(f,y+m),g+=y}}if(g){var I=Sf(f>>>0);i.hasNameForId(this.componentId,I)||i.insertRules(this.componentId,I,o(g,".".concat(I),void 0,this.componentId)),l=Rr(l,I)}}return l},e}(),Yf=ei.createContext(void 0);Yf.Consumer;var Bd={};function nI(e,t,i){var o=zf(e),l=e,s=!Ud(e),u=t.attrs,d=u===void 0?Du:u,f=t.componentId,g=f===void 0?function(H,b){var L=typeof H!="string"?"sc":wm(H);Bd[L]=(Bd[L]||0)+1;var $="".concat(L,"-").concat(sv(Nu+L+Bd[L]));return b?"".concat(b,"-").concat($):$}(t.displayName,t.parentComponentId):f,m=t.displayName,v=m===void 0?function(H){return Ud(H)?"styled.".concat(H):"Styled(".concat(PA(H),")")}(e):m,y=t.displayName&&t.componentId?"".concat(wm(t.displayName),"-").concat(t.componentId):t.componentId||g,I=o&&l.attrs?l.attrs.concat(d).filter(Boolean):d,E=t.shouldForwardProp;if(o&&l.shouldForwardProp){var A=l.shouldForwardProp;if(t.shouldForwardProp){var w=t.shouldForwardProp;E=function(H,b){return A(H,b)&&w(H,b)}}else E=A}var F=new tI(i,y,o?l.componentStyle:void 0);function B(H,b){return function(L,$,Q){var _e=L.attrs,Ce=L.componentStyle,be=L.defaultProps,De=L.foldedComponentIds,Pe=L.styledComponentId,de=L.target,Le=ei.useContext(Yf),Te=If(),te=L.shouldForwardProp||Te.shouldForwardProp,W=nv($,Le,be)||Uo,X=function(ve,le,Ee){for(var Ae,Z=Lt(Lt({},le),{className:void 0,theme:Ee}),ie=0;ie<ve.length;ie+=1){var Ue=Bo(Ae=ve[ie])?Ae(Z):Ae;for(var he in Ue)Z[he]=he==="className"?Rr(Z[he],Ue[he]):he==="style"?Lt(Lt({},Z[he]),Ue[he]):Ue[he]}return le.className&&(Z.className=Rr(Z.className,le.className)),Z}(_e,$,W),j=X.as||de,P={};for(var U in X)X[U]===void 0||U[0]==="$"||U==="as"||U==="theme"&&X.theme===W||(U==="forwardedAs"?P.as=X.forwardedAs:te&&!te(U,j)||(P[U]=X[U]));var K=function(ve,le){var Ee=If(),Ae=ve.generateAndInjectStyles(le,Ee.styleSheet,Ee.stylis);return Ae}(Ce,X),ne=Rr(De,Pe);return K&&(ne+=" "+K),X.className&&(ne+=" "+X.className),P[Ud(j)&&!iv.has(j)?"class":"className"]=ne,P.ref=Q,Re.createElement(j,P)}(D,H,b)}B.displayName=v;var D=ei.forwardRef(B);return D.attrs=I,D.componentStyle=F,D.displayName=v,D.shouldForwardProp=E,D.foldedComponentIds=o?Rr(l.foldedComponentIds,l.styledComponentId):"",D.styledComponentId=y,D.target=o?l.target:e,Object.defineProperty(D,"defaultProps",{get:function(){return this._foldedDefaultProps},set:function(H){this._foldedDefaultProps=o?function(b){for(var L=[],$=1;$<arguments.length;$++)L[$-1]=arguments[$];for(var Q=0,_e=L;Q<_e.length;Q++)Tf(b,_e[Q],!0);return b}({},l.defaultProps,H):H}}),Wf(D,function(){return".".concat(D.styledComponentId)}),s&&cv(D,e,{attrs:!0,componentStyle:!0,displayName:!0,foldedComponentIds:!0,shouldForwardProp:!0,styledComponentId:!0,target:!0}),D}function km(e,t){for(var i=[e[0]],o=0,l=t.length;o<l;o+=1)i.push(t[o],e[o+1]);return i}var Mm=function(e){return Object.assign(e,{isCss:!0})};function vv(e){for(var t=[],i=1;i<arguments.length;i++)t[i-1]=arguments[i];if(Bo(e)||aa(e))return Mm(Ji(km(Du,sa([e],t,!0))));var o=e;return t.length===0&&o.length===1&&typeof o[0]=="string"?Ji(o):Mm(Ji(km(o,t)))}function Ef(e,t,i){if(i===void 0&&(i=Uo),!t)throw Ta(1,t);var o=function(l){for(var s=[],u=1;u<arguments.length;u++)s[u-1]=arguments[u];return e(t,i,vv.apply(void 0,sa([l],s,!1)))};return o.attrs=function(l){return Ef(e,t,Lt(Lt({},i),{attrs:Array.prototype.concat(i.attrs,l).filter(Boolean)}))},o.withConfig=function(l){return Ef(e,t,Lt(Lt({},i),l))},o}var Sv=function(e){return Ef(nI,e)},En=Sv;iv.forEach(function(e){En[e]=Sv(e)});var iI=function(){function e(t,i){this.rules=t,this.componentId=i,this.isStatic=mv(t),pu.registerId(this.componentId+1)}return e.prototype.createStyles=function(t,i,o,l){var s=l(yf(Ji(this.rules,i,o,l)),""),u=this.componentId+t;o.insertRules(u,u,s)},e.prototype.removeStyles=function(t,i){i.clearRules(this.componentId+t)},e.prototype.renderStyles=function(t,i,o,l){t>2&&pu.registerId(this.componentId+t),this.removeStyles(t,o),this.createStyles(t,i,o,l)},e}();function rI(e){for(var t=[],i=1;i<arguments.length;i++)t[i-1]=arguments[i];var o=vv.apply(void 0,sa([e],t,!1)),l="sc-global-".concat(sv(JSON.stringify(o))),s=new iI(o,l),u=function(f){var g=If(),m=ei.useContext(Yf),v=ei.useRef(g.styleSheet.allocateGSInstance(l)).current;return g.styleSheet.server&&d(v,f,g.styleSheet,m,g.stylis),ei.useLayoutEffect(function(){if(!g.styleSheet.server)return d(v,f,g.styleSheet,m,g.stylis),function(){return s.removeStyles(v,g.styleSheet)}},[v,f,g.styleSheet,m,g.stylis]),null};function d(f,g,m,v,y){if(s.isStatic)s.renderStyles(f,wA,m,y);else{var I=Lt(Lt({},g),{theme:nv(g,v,u.defaultProps)});s.renderStyles(f,I,m,y)}}return ei.memo(u)}function yv(e,t){var i=Re.useRef(null),o=Re.useRef(!1),l=Re.useRef(e);l.current=e;var s=Re.useCallback(function(d){o.current&&(l.current(d),i.current=requestAnimationFrame(s))},[]),u=Re.useMemo(function(){return[function(){o.current&&(o.current=!1,i.current&&cancelAnimationFrame(i.current))},function(){o.current||(o.current=!0,i.current=requestAnimationFrame(s))},function(){return o.current}]},[]);return Re.useEffect(function(){return u[0]},[]),u}function oI(e,t,i,o,l){var u;(u=e.onExit)==null||u.call(e,o,t);const s=l.find(({id:d})=>d===t);return s!=null&&s.onEnter?s.onEnter(o,i):{...i,enteredAt:o.updateContext.gameState.time}}function sI(e,t){return t.find(({id:i})=>i===e)}function aI(e,t){return e!==t}function lI(e){console.warn(`No handler found for state: ${e}`)}const Qs="bushGrowing",Cr="bushFull",lu="bushSpreading",la="bushDying",Et=24,wt=10,et=3e3,tt=3e3,jf=2,uI=15,cI=5e3,pi=100,mi=20,vi=60,dI=1e3,fI=5,hI=3,gI=12,pI=940,wf=20,Fm=90,Tv=45,Br=5,mI=.5,Hr=30,Si=.1,Vs=.9;var Bn=(e=>(e.Berry="berry",e.Meat="meat",e))(Bn||{});const Vf={berry:"",meat:""},vI={id:Qs,update:(e,t)=>{const{entity:i,updateContext:o}=t,l=o.deltaTime*(Et/wt);return i.age+=l,i.age>=i.lifespan?{nextState:la,data:{...e,enteredAt:o.gameState.time}}:(i.timeSinceLastBerryRegen+=l,i.timeSinceLastBerryRegen>=gI&&i.food.length<i.maxFood&&(i.food.push({type:Bn.Berry}),i.timeSinceLastBerryRegen=0),i.food.length>=i.maxFood?{nextState:Cr,data:{...e,enteredAt:o.gameState.time,previousState:Qs}}:{nextState:Qs,data:e})},onEnter:(e,t)=>({...t,enteredAt:e.updateContext.gameState.time})},SI={id:Cr,update:(e,t)=>{const{entity:i,updateContext:o}=t,l=o.deltaTime*(Et/wt);return i.age+=l,i.age>=i.lifespan?{nextState:la,data:{...e,enteredAt:o.gameState.time,previousState:Cr}}:i.food.length<i.maxFood?{nextState:Qs,data:{...e,enteredAt:o.gameState.time,previousState:Cr}}:(i.timeSinceLastSpreadAttempt+=l,i.timeSinceLastSpreadAttempt>=Fm&&(i.timeSinceLastSpreadAttempt=0,o.gameState.time-i.timeSinceLastHarvest>=Fm&&Math.random()<o.gameState.ecosystem.berryBushSpreadChance)?{nextState:lu,data:{...e,enteredAt:o.gameState.time,previousState:Cr}}:{nextState:Cr,data:e})},onEnter:(e,t)=>({...t,enteredAt:e.updateContext.gameState.time})},ua=1,_f=150*.6,yI=150*.25,TI=150*.7,AI=150*.8,II=400,EI=800,Av=300,wI=350,_I=120,CI=2,Lm=400,RI=1e3,PI=150*.85,NI=100,DI=3,OI=24,Iv=600,kI=1,MI=1,FI=.5,LI=2,Cf=24,uu=12,UI=24,Um=24,BI=1500,Hd=500,HI=400,bI=10,GI=-5,xI=1.5,$I=1.5,zI=1.2,WI=10,YI=150,jI=200,VI=100,XI=.7,KI=300,ZI=100,qI=120,Bm=600,Ev=.15,wv=200,cu=30*.75*1.2,QI=20,JI=.3,eE=.6,tE=.8,nE=1,iE=3,rE=5,oE=6,Hm=.5,sE=.4,aE=.6,lE=.8,uE=2,bm=800,cE=60,Gm=5,xm=.7,$m=2.5,zm=3,Wm=2,dE=.1,fE=400,hE=800,_v=5,Cv=600,Ou=10,ca=80,gE=3,Bs=5,br=150,Rv=br*.8,pE=br*.2,Gr=br*.95,nr=30,Pv=10,mE=10,vE=.5,vt=30,Ho=vt*.75,Nv=50,SE=20,yE=ca*.8,TE=.7,AE=16,Dv=40,IE=24,Xf=16,EE=72/3,Ym=24,wE=1.25,_E=1.5,Kf=br*.6,Zf=50,CE=1,RE=350,qf=ca*.65,PE=80,NE=50,DE=1,OE=128,Ov=10,jm=100,Qf=35,ti=vt,kv=.5,ku=2.5,kE=5,Jf=.5,eh=1.5,ME=.1,FE=.5,LE=1.5,UE=.25,BE=2.5,HE=45,bE=.05;function Un(e,t){return{x:e.x+t.x,y:e.y+t.y}}function Mv(e,t){return{x:e.x-t.x,y:e.y-t.y}}function Pt(e,t){return{x:e.x*t,y:e.y*t}}function bo(e){return Math.sqrt(e.x*e.x+e.y*e.y)}function st(e){const t=bo(e);return t===0?{x:0,y:0}:Pt(e,1/t)}function GE(e,t){return bo(Mv(e,t))}function th(e,t,i){return{x:e.x+(t.x-e.x)*i,y:e.y+(t.y-e.y)*i}}function mu(e){if(e.length===0)return{x:0,y:0};const t=e.reduce((i,o)=>({x:i.x+o.x,y:i.y+o.y}),{x:0,y:0});return{x:t.x/e.length,y:t.y/e.length}}function We(e,t,i,o){let l=t.x-e.x,s=t.y-e.y;return Math.abs(l)>i/2&&(l=l-Math.sign(l)*i),Math.abs(s)>o/2&&(s=s-Math.sign(s)*o),{x:l,y:s}}function Ft(e,t,i){const o=We(e,t,i.width,i.height);return st(o)}function Y(e,t,i,o){const l=We(e,t,i,o);return bo(l)}function xE(e,t){return e.x*t.x+e.y*t.y}function $E(e,t){const i=xE(e,t),o=bo(e),l=bo(t);if(o===0||l===0)return 0;const s=Math.max(-1,Math.min(1,i/(o*l)));return Math.acos(s)}function zE(e,t,i){const o=Math.max(0,Math.min(1,i)),l={r:parseInt(e.substring(1,3),16),g:parseInt(e.substring(3,5),16),b:parseInt(e.substring(5,7),16)},s={r:parseInt(t.substring(1,3),16),g:parseInt(t.substring(3,5),16),b:parseInt(t.substring(5,7),16)},u=Math.round(l.r+(s.r-l.r)*o),d=Math.round(l.g+(s.g-l.g)*o),f=Math.round(l.b+(s.b-l.b)*o),g=m=>("00"+m.toString(16)).slice(-2);return`#${g(u)}${g(d)}${g(f)}`}var mt=(e=>(e.Friendly="Friendly",e.Hostile="Hostile",e))(mt||{}),ct=(e=>(e[e.None=0]="None",e[e.General=1]="General",e[e.Performance=2]="Performance",e[e.Ecosystem=3]="Ecosystem",e[e.Tribe=4]="Tribe",e))(ct||{});function Vm(e,t,i){return t.search.human.byRadius(e.position,i).filter(s=>{if(s.id===e.id||s.gender===e.gender||!s.isAdult||s.hunger>=Gr||(s.procreationCooldown||0)>0||s.gender==="female"&&s.isPregnant)return!1;const u=s.id===e.motherId||s.id===e.fatherId,d=e.id===s.motherId||e.id===s.fatherId;return!u&&!d})}function xr(e){if(e.length===0)return;const t=e.filter(l=>l.gender==="male"),i=e.filter(l=>l.gender==="female"),o=(l,s)=>l.age!==s.age?s.age-l.age:l.id-s.id;if(t.sort(o),t.length>0)return t[0];if(i.sort(o),i.length>0)return i[0]}function un(e,t){const i=e,o=i.search.human.byProperty("motherId",t.id),l=i.search.human.byProperty("fatherId",t.id);return[...o,...l]}function WE(e,t,i){var l;if(e.id===t.id||e.motherId===t.id||e.fatherId===t.id||t.motherId===e.id||t.fatherId===e.id||e.motherId&&e.motherId===t.motherId||e.fatherId&&e.fatherId===t.fatherId||(l=e.partnerIds)!=null&&l.includes(t.id))return!0;if(e.motherId){const s=i.entities.entities[e.motherId];if(s&&(s.motherId===t.id||s.fatherId===t.id))return!0}if(e.fatherId){const s=i.entities.entities[e.fatherId];if(s&&(s.motherId===t.id||s.fatherId===t.id))return!0}if(t.motherId){const s=i.entities.entities[t.motherId];if(s&&(s.motherId===e.id||s.fatherId===e.id))return!0}if(t.fatherId){const s=i.entities.entities[t.fatherId];if(s&&(s.motherId===e.id||s.fatherId===e.id))return!0}return!1}function Xm(e,t){var s,u,d,f;if(e.id===t.id||e.motherId===t.id||e.fatherId===t.id||t.motherId===e.id||t.fatherId===e.id||(s=e.partnerIds)!=null&&s.includes(t.id)||(u=t.partnerIds)!=null&&u.includes(e.id))return!0;if(e.fatherId===void 0&&e.motherId===void 0||t.fatherId===void 0&&t.motherId===void 0)return!1;const i=e.motherId===t.motherId||e.fatherId===t.fatherId,o=t.motherId===e.motherId||t.fatherId===e.fatherId,l=((d=e.ancestorIds)==null?void 0:d.some(g=>t.ancestorIds.includes(g)))||((f=t.ancestorIds)==null?void 0:f.some(g=>e.ancestorIds.includes(g)));return i||o||l}function YE(e,t){const i=[];if(e.motherId){const o=t.entities.entities[e.motherId];o&&i.push(o)}if(e.fatherId){const o=t.entities.entities[e.fatherId];o&&i.push(o)}return i}function jE(e,t){if(e.gender!=="female"||!e.partnerIds||e.partnerIds.length===0)return null;for(const i of e.partnerIds){const o=t.entities.entities[i];if(o&&o.gender==="male")return o}return null}function VE(e,t){var i;if(!e.isAdult&&e.fatherId){const o=t.entities.entities[e.fatherId];if(o&&o.type==="human")return o}if(e.isAdult&&e.fatherId){const o=t.entities.entities[e.fatherId];if(o&&o.type==="human"&&((i=xr(un(t,o)))==null?void 0:i.id)===e.id)return o}return e.isAdult&&e.gender==="female"&&e.partnerIds&&e.partnerIds.length>0?jE(e,t):null}function vu(e,t){var o;const i=new Set;if(e.motherId){const l=t.entities.entities[e.motherId];l&&i.add(l)}if(e.fatherId){const l=t.entities.entities[e.fatherId];l&&i.add(l)}return(o=e.partnerIds)==null||o.forEach(l=>{const s=t.entities.entities[l];s&&i.add(s)}),un(t,e).forEach(l=>i.add(l)),Array.from(i)}function Fv(e,t){const i=new Map;function o(l){const s=un(t,l);for(const u of s)i.has(u.id)||(i.set(u.id,u),o(u))}return o(e),Array.from(i.values())}function da(e,t){return t.search.human.byProperty("leaderId",e)}function Lv(e,t){var u,d;const i=new Map,o=Object.values(e.entities.entities).filter(f=>f.type==="human");for(const f of o)f.leaderId&&(i.has(f.leaderId)||i.set(f.leaderId,{leaderId:f.leaderId,tribeBadge:f.tribeBadge||"?",members:[]}),(u=i.get(f.leaderId))==null||u.members.push(f));const l=t?(d=e.entities.entities[t])==null?void 0:d.diplomacy:void 0,s=Array.from(i.values()).map(f=>{const g=e.entities.entities[f.leaderId],m=f.members.filter(y=>y.isAdult).length,v=f.members.length-m;return{leaderId:f.leaderId,tribeBadge:f.tribeBadge,adultCount:m,childCount:v,isPlayerTribe:f.leaderId===t,leaderAge:(g==null?void 0:g.age)??0,leaderGender:(g==null?void 0:g.gender)??"male",diplomacyStatus:(l==null?void 0:l[f.leaderId??-1])??mt.Friendly}});return s.sort((f,g)=>f.isPlayerTribe?-1:g.isPlayerTribe?1:g.adultCount+g.childCount-(f.adultCount+f.childCount)),s}function Hn(e,t){return e.leaderId?t.search.human.byProperty("leaderId",e.leaderId):[]}function Uv(e,t,i,o){const l=Math.random()*Math.PI*2,s=Math.sqrt(Math.random())*t,u={x:Math.cos(l)*s,y:Math.sin(l)*s},d=Un(e,u);return{x:(d.x%i+i)%i,y:(d.y%o+o)%o}}function bn(e,t,i,o){const l=t,s={left:e.x-i,top:e.y-i,right:e.x+i,bottom:e.y+i},u=[...l.search.human.byRect(s),...l.search.berryBush.byRect(s),...l.search.corpse.byRect(s)];for(const d of u){if(o!==void 0&&d.id===o)continue;if(Y(e,d.position,t.mapDimensions.width,t.mapDimensions.height)<i+d.radius)return!0}return!1}function XE(e,t,i,o,l){const s=t.mapDimensions.width,u=t.mapDimensions.height;if(!bn(e,t,o,l))return e;const d=o;for(let f=d;f<=i;f+=d){const g=Math.ceil(2*Math.PI*f/d);for(let m=0;m<g;m++){const v=m/g*2*Math.PI,y={x:Math.cos(v)*f,y:Math.sin(v)*f},I=Un(e,y),E={x:(I.x%s+s)%s,y:(I.y%u+u)%u};if(!bn(E,t,o,l))return E}}return null}function $r(e,t){const i=t.search.building.byProperty("ownerId",e);if(i.length>0){const s=i.map(u=>u.position);return mu(s)}const o=da(e,t);if(o.length===0){const s=t.entities.entities[e];return s?s.position:{x:0,y:0}}const l=o.map(s=>s.position);return mu(l)}function Km(e,t){const o=[...vu(e,t),e].map(l=>l.position);return mu(o)}function KE(e,t,i){const o=i.mapDimensions.width,l=i.mapDimensions.height;let s=e.x-t.position.x,u=e.y-t.position.y;return Math.abs(s)>o/2&&(s-=Math.sign(s)*o),Math.abs(u)>l/2&&(u-=Math.sign(u)*l),Math.abs(s)<=t.width/2&&Math.abs(u)<=t.height/2}function ZE(e,t,i){return t.search.human.byRadius(e.position,i).filter(l=>{var s;return l.activeAction==="procreating"&&l.gender===e.gender&&typeof l.target=="number"&&((s=e.partnerIds)==null?void 0:s.includes(l.target))})[0]}function qE(e,t,i){const o=vu(e,t),l=t;for(const s of o){if(Y(e.position,s.position,t.mapDimensions.width,t.mapDimensions.height)>i)continue;const d=l.search.human.byProperty("attackTargetId",s.id);for(const f of d)if(f.leaderId!==e.leaderId)return{familyMember:s,aggressor:f}}}function QE(e,t){const o=t.search.human.byRadius(e.position,KI);let l,s=1/0;for(const u of o){if(u.id===e.id||u.hitpoints<=0||u.hitpoints/u.maxHitpoints>XI||WE(e,u,t))continue;const d=Y(e.position,u.position,t.mapDimensions.width,t.mapDimensions.height);d<s&&(s=d,l=u)}return l}function nh(e,t,i){return t.search.human.byRadius(e.position,i).filter(l=>Xo(e,l,t))}function JE(e,t,i){const o=i.search.human.byProperty("leaderId",e);let l=0;for(const s of o)s.attackTargetId===t&&l++;return l}function Zm(e,t,i,o){const l=i.search.berryBush.byRadius(e,t),s=i.search.human.byRadius(e,t).filter(f=>f.leaderId!==o);let u=l.length*bI;u+=s.length*GI;let d;if(s.length>0){const f={};for(const m of s)m.leaderId&&(f[m.leaderId]=(f[m.leaderId]||0)+1);let g=0;for(const m in f)f[m]>g&&(g=f[m],d=parseInt(m,10))}return{score:u,occupyingTribeId:d}}function Su(e){return e.filter(t=>t.isAdult).reduce((t,i)=>{let o=i.hitpoints;return o+=(i.maxAge-i.age)*.5,o+=i.food.length*2,t+o},0)}function ew(e,t){if(e.id!==e.leaderId)return null;const i=t,o=$r(e.id,t),{score:l}=Zm(o,Hd/2,i,e.id);let s=null,u=l;const d=HI,f=BI;for(let g=e.position.x-f;g<e.position.x+f;g+=d)for(let m=e.position.y-f;m<e.position.y+f;m+=d){const v={x:(g%t.mapDimensions.width+t.mapDimensions.width)%t.mapDimensions.width,y:(m%t.mapDimensions.height+t.mapDimensions.height)%t.mapDimensions.height};if(Y(o,v,t.mapDimensions.width,t.mapDimensions.height)<Hd*2)continue;const{score:I}=Zm(v,Hd/2,i,e.id);I>u*xI&&(u=I,s=v)}return s}function Ne(e,t,i,o,l){const s=t,u=o,d="position"in e&&e.id?e:null,f=d?d.position:e,g=s.search[i].byRadius(f,u);let m=null,v=u;for(const y of g){if(y.id===(d==null?void 0:d.id)||l&&!l(y))continue;const I=Y(f,y.position,t.mapDimensions.width,t.mapDimensions.height);I<v&&(v=I,m=y)}return m}function tw(e,t,i,o){return t.search[i].byRadius(e,o)}function qm(e,t,i,o){return tw(e,t,i,o).length}function St(e){const i=e.search.human.byProperty("isPlayer",!0);return i.length>0?i[0]:void 0}function nw(e,t){var u;const o=t.search.human.byProperty("activeAction","attacking");let l=null,s=1/0;for(const d of o){if(d.attackTargetId!==e)continue;const f=Y(d.position,((u=t.entities.entities[e])==null?void 0:u.position)||{x:0,y:0},t.mapDimensions.width,t.mapDimensions.height);f<s&&(l=d,s=f)}return l}function Bv(e){return Object.values(e.entities.entities).filter(t=>t.type==="human")}function iw(e,t,i){const o=Object.values(t.entities.entities).reverse();for(const l of o)if(GE(e,l.position)<l.radius)return l}function rw(e,t,i,o){const l=Bv(o),s={};for(const u of l)!u.leaderId||u.leaderId===t||(s[u.leaderId]||(s[u.leaderId]={sumX:0,sumY:0,count:0}),s[u.leaderId].sumX+=u.position.x,s[u.leaderId].sumY+=u.position.y,s[u.leaderId].count++);for(const u in s){const d=s[u],f={x:d.sumX/d.count,y:d.sumY/d.count};if(Y(e,f,o.mapDimensions.width,o.mapDimensions.height)<i)return!0}return!1}const _t=30,Vo=_t*.6,Hv="#4CAF50",bv="#FF5722",Gv="#9C27B0",ow="#2196F3",xv="#FFC107",sw="#DC143C",ih="#FFFFFF",rh=[5,5],Mu=5,Go=15,aw=20,lw=16,uw=10,cw=16,dw=16,Qm=["","","","","","","","","",""],Rf=8,fw="#FFFFFF",ln=18,je=15,hw="rgba(0, 0, 0, 0.7)",gw=4,bi=150,nn=15,ci=10,Ki="#555",pw="#f44336",mw="#4CAF50",vw="#2196F3",Sw="#FFC107",Bl=16,Tr=32,Hl=28,yw=10,Tw=8,Aw=8,Iw=8,vn=28,bl=40,Ew="rgba(255, 215, 0, 0.7)",ww="rgba(0, 0, 0, 0.3)",Kn=10,Jm=8,bd=11,Gi=20,Gd=40,e0=5,_w=10,Cw="#FFA500",Rw="#808080",gi=120,$v=30,Pw=20,Vi="#2d3748",yn="#ffffff",Gl="#4a5568",zv=5,oh="#bdc9f792",Wv="#272c36ff",Yv="#a0aec0",yu=300,jv="rgba(255, 255, 255, 0.5)",Nw="rgba(0, 0, 0, 0.8)",Dw="#FFFFFF",t0=14,n0=8,i0=-15,Vv="#FFD700",Xv=5,Ow=60,kw=-50,Mw=10,xd=12,r0=10,Fw="rgba(0, 0, 0, 0.5)",Lw="#4CAF50",Uw="#F44336",Bw="#FFC107",Hw="rgba(255, 255, 255, 0.2)",o0="#FFFFFF",bw="#FF6B6B",Gw=5,Kv=30,Hs=50,xl=8,s0=10,xw="rgba(0, 0, 0, 0.5)",$w="#FFFFFF",zw=33,Ww=400,Yw=20,jw=10,Vw="rgba(0, 0, 0, 0.7)",Xw="#FFFFFF",$d=20,a0=16,Kw=.5,l0=5,Zv="#FFD700",Zw=40,sh=4,qv=3,qw=5,Qv=20,Jv=5,Qw="#FFFFFF",Jw="#FF6B6B",rn=80,Ar=10,$l=300,Ir=15,e_=8,t_="rgba(0, 0, 0, 0.8)",n_="#FFFFFF",zd=14,u0=10,Zn=20,i_="#FF6B6B",r_="#4CAF50",c0="#FFD700",o_="rgba(255, 255, 0, 0.3)",s_=2,a_=500,l_=120,u_=45,c_="#FFD700",d_=3,f_=4;let Wd=0;function Pf(){const e=Qm[Wd];return Wd=(Wd+1)%Qm.length,e}const d0=20,h_=.3,g_=24,f0=250,xo=10,eS=250,fa=12,tS=10;var se=(e=>(e.Gather="Gather",e.Eat="Eat",e.Procreate="Procreate",e.Attack="Attack",e.Plant="Plant",e.CallToAttack="CallToAttack",e.TribeSplit="TribeSplit",e.FollowMe="FollowMe",e.FeedChild="FeedChild",e.HuntPrey="HuntPrey",e.DefendAgainstPredator="DefendAgainstPredator",e.Build="Build",e.Removal="Removal",e.Deposit="Deposit",e.Retrieve="Retrieve",e.TakeOverBuilding="TakeOverBuilding",e.RemoveEnemyBuilding="RemoveEnemyBuilding",e.AutopilotMove="AutopilotMove",e.AutopilotGather="AutopilotGather",e.AutopilotAttack="AutopilotAttack",e.AutopilotProcreate="AutopilotProcreate",e.AutopilotPlant="AutopilotPlant",e.AutopilotFeedChild="AutopilotFeedChild",e.AutopilotFollowMe="AutopilotFollowMe",e.AutopilotDeposit="AutopilotDeposit",e.AutopilotRetrieve="AutopilotRetrieve",e))(se||{});const Fu={Gather:"",Eat:"",Procreate:"",Attack:"",Plant:"",CallToAttack:"",TribeSplit:"",FollowMe:"",FeedChild:"",HuntPrey:"",DefendAgainstPredator:"",Build:"",Removal:"",Deposit:"",Retrieve:"",TakeOverBuilding:"",RemoveEnemyBuilding:"",AutopilotMove:"",AutopilotGather:"",AutopilotAttack:"",AutopilotProcreate:"",AutopilotPlant:"",AutopilotFeedChild:"",AutopilotFollowMe:"",AutopilotDeposit:"",AutopilotRetrieve:""},nS={Gather:"Gather",Eat:"Eat",Procreate:"Procreate",Attack:"Attack",Plant:"Plant",CallToAttack:"Call to Attack",TribeSplit:"Split Tribe",FollowMe:"Follow Me",FeedChild:"Feed Child",HuntPrey:"Hunt Prey",DefendAgainstPredator:"Defend",Build:"Build",Removal:"Remove",Deposit:"Deposit",Retrieve:"Retrieve",TakeOverBuilding:"Take Over",RemoveEnemyBuilding:"Destroy Enemy Building",AutopilotMove:"Walk",AutopilotGather:"Gather",AutopilotAttack:"Attack",AutopilotProcreate:"Procreate",AutopilotPlant:"Plant",AutopilotFeedChild:"Feed",AutopilotFollowMe:"Follow",AutopilotDeposit:"Deposit",AutopilotRetrieve:"Retrieve"};var Eo=(e=>(e.Time="Time",e.Hunger="Hunger",e.Hitpoints="Hitpoints",e.Food="Food",e.Autopilot="Autopilot",e.Muted="Muted",e.Family="Family",e.Tribes="Tribes",e))(Eo||{});const bs={Time:"",Hunger:"",Hitpoints:"",Food:"",Autopilot:"",Muted:"",Family:"",Tribes:""};var ge=(e=>(e.ToggleMute="ToggleMute",e.TogglePause="TogglePause",e.FastForward="FastForward",e.DismissTutorial="DismissTutorial",e.ReturnToIntro="ReturnToIntro",e.ConfirmExitYes="ConfirmExitYes",e.ConfirmExitNo="ConfirmExitNo",e.CommandEat="CommandEat",e.CommandPlant="CommandPlant",e.CommandCallToAttack="CommandCallToAttack",e.CommandFollowMe="CommandFollowMe",e.CommandGather="CommandGather",e.CommandTribeSplit="CommandTribeSplit",e.CommandBuild="CommandBuild",e.SelectStorageSpot="SelectStorageSpot",e.SelectPlantingZone="SelectPlantingZone",e.SelectRemovalTool="SelectRemovalTool",e.ToggleProcreationBehavior="ToggleProcreationBehavior",e.ToggleAttackBehavior="ToggleAttackBehavior",e.ToggleFeedChildBehavior="ToggleFeedChildBehavior",e.TogglePlantingBehavior="TogglePlantingBehavior",e.ToggleGatheringBehavior="ToggleGatheringBehavior",e.ToggleAutopilotFollowLeaderBehavior="ToggleAutopilotFollowLeaderBehavior",e.ToggleDiplomacy="ToggleDiplomacy",e))(ge||{});const p_=12,m_=24,v_=150*.9,S_=24;var ha=(e=>(e.Hello="HELLO",e.NewTribeFormed="NEW_TRIBE_FORMED",e.NoHeir="NO_HEIR",e.ChildrenStarving="CHILDREN_STARVING",e))(ha||{});let y_=0;function T_(){return`notification-${Date.now()}-${y_++}`}function Nf(e,t){if(t.identifier){const o=e.notifications.find(l=>l.identifier===t.identifier);if(o){if(o.dismissedUntil&&e.time<o.dismissedUntil)return;o.message=t.message,o.timestamp=e.time,o.creationTime=Date.now(),o.duration=t.duration,o.targetEntityIds=t.targetEntityIds,o.highlightedEntityIds=t.highlightedEntityIds,o.targetPosition=t.targetPosition,o.targetArea=t.targetArea,o.targetRadius=t.targetRadius,o.isDismissed=!1,o.dismissedUntil=void 0;return}}const i={...t,id:T_(),timestamp:e.time,creationTime:Date.now(),isDismissed:!1};e.notifications.push(i)}function A_(e,t){const i=e.notifications.find(o=>o.id===t);i&&(i.isDismissed=!0,i.identifier&&(i.dismissedUntil=e.time+S_))}function I_(e){const t=e.time;e.notifications=e.notifications.filter(i=>i.duration===0?!0:!(t-i.timestamp>i.duration))}function E_(e){for(const i of Object.values(e.entities.entities))i.isHighlighted=!1;const t=e.notifications.filter(i=>!i.isDismissed);for(const i of t)if(i.highlightedEntityIds)for(const o of i.highlightedEntityIds){const l=e.entities.entities[o];l&&(l.isHighlighted=!0)}}const h0=600,w_=1.5,iS=.1,zl=""+new URL("attack-D4MA8VWK.mp3",import.meta.url).href,Yd=""+new URL("gather-CU75596W.mp3",import.meta.url).href,__=""+new URL("eat-DCjHq2QD.mp3",import.meta.url).href,jd=""+new URL("procreate-CfE4r5Cp.mp3",import.meta.url).href,C_=""+new URL("birth-Cbd67GHT.mp3",import.meta.url).href,R_=""+new URL("child-fed-DzEPuMid.mp3",import.meta.url).href,P_=""+new URL("human-death-B6HFLXES.mp3",import.meta.url).href,N_=""+new URL("game-over-C5dqkyER.mp3",import.meta.url).href,D_=""+new URL("button-click-DomLUeaU.mp3",import.meta.url).href,O_=""+new URL("soundtrack-1-BdlYUGye.mp3",import.meta.url).href;var fe=(e=>(e[e.Attack=0]="Attack",e[e.Gather=1]="Gather",e[e.Eat=2]="Eat",e[e.Procreate=3]="Procreate",e[e.Birth=4]="Birth",e[e.ChildFed=5]="ChildFed",e[e.HumanDeath=6]="HumanDeath",e[e.Seize=7]="Seize",e[e.CallToAttack=8]="CallToAttack",e[e.TribeSplit=9]="TribeSplit",e[e.CallToFollow=10]="CallToFollow",e[e.StorageDeposit=11]="StorageDeposit",e[e.StorageRetrieve=12]="StorageRetrieve",e[e.StorageSteal=13]="StorageSteal",e[e.GameOver=14]="GameOver",e[e.ButtonClick=15]="ButtonClick",e[e.SoundTrack1=16]="SoundTrack1",e))(fe||{});const k_=new Map([[0,zl],[1,Yd],[2,__],[3,jd],[4,C_],[5,R_],[6,P_],[14,N_],[15,D_],[7,zl],[8,zl],[9,jd],[10,jd],[11,Yd],[12,Yd],[13,zl],[16,O_]]);let Gs,ga;function M_(){if(!(typeof window>"u"))return ga}function ah(){if(!(typeof window>"u"))return!Gs&&typeof window.AudioContext=="function"&&(Gs=new window.AudioContext,ga=Gs.createGain(),ga.connect(Gs.destination),Js(.1,!1)),Gs}function Js(e,t){ga&&(ga.gain.value=t?0:e/10)}const rS=new Map;let Wl=!1,g0=!1;async function F_(){if(g0||Wl)return;const e=ah();if(!e){console.error("AudioContext not supported. Cannot load sounds.");return}e.state==="suspended"&&e.resume(),Wl=!0,console.log("Starting sound loading...");const t=[];k_.forEach((i,o)=>{const l=fetch(i).then(s=>{if(!s.ok)throw new Error(`Failed to fetch sound: ${i}`);return s.arrayBuffer()}).then(s=>e.decodeAudioData(s)).then(s=>{rS.set(o,s)}).catch(s=>{console.error(`Error loading sound ${fe[o]} from ${i}:`,s)});t.push(l)});try{await Promise.all(t),g0=!0,Wl=!1,console.log("All sounds loaded successfully.")}catch(i){Wl=!1,console.error("An error occurred while loading sounds:",i)}}const ea=new Map;function lh(e,t){const i=ah(),o=M_();if(!i||!o||o.gain.value===0&&(t==null?void 0:t.trackId)===void 0)return;i.state==="suspended"&&i.resume();const l=rS.get(e);if(!l){console.warn(`Sound buffer not found for type: ${fe[e]}`);return}if(t!=null&&t.trackId&&ea.has(t.trackId))return;const s=i.createBufferSource();s.buffer=l,s.loop=(t==null?void 0:t.loop)??!1;const u=i.createGain(),d=i.createStereoPanner();let f=u;if(t!=null&&t.position&&(t!=null&&t.listenerPosition)&&(t!=null&&t.worldDimensions)){const g=We(t.listenerPosition,t.position,t.worldDimensions.width,t.worldDimensions.height),m=Y(t.listenerPosition,t.position,t.worldDimensions.width,t.worldDimensions.height);if(m>h0)return;const v=1-Math.pow(m/h0,w_);u.gain.value=Math.max(0,v);const y=Math.sin(g.x/m*(Math.PI/2));d.pan.value=isNaN(y)?0:y,u.connect(d),f=d}else{const g=e===fe.GameOver?.4:e===fe.SoundTrack1?1:.2;u.gain.value=g}s.connect(f),f.connect(o),s.start(0),t!=null&&t.trackId&&(ea.set(t.trackId,{sourceNode:s,gainNode:u}),s.onended=()=>{ea.delete(t.trackId)})}function Vd(e,t=1){const i=ea.get(e),o=ah();if(i&&o){const{sourceNode:l,gainNode:s}=i,u=o.currentTime;s.gain.setValueAtTime(s.gain.value,u),s.gain.linearRampToValueAtTime(0,u+t),l.stop(u+t),l.onended=null,ea.delete(e)}}function Ie(e,t,i){const o=St(e.gameState);o&&lh(t,{position:i,listenerPosition:o.position,worldDimensions:e.gameState.mapDimensions,masterVolume:e.gameState.masterVolume,isMuted:e.gameState.isMuted})}function L_(e,t,i){const o=i.mapDimensions.width,l=i.mapDimensions.height,s=t.radius*2;for(let u=f0;u<o/2;u+=50)for(let d=0;d<10;d++){const f=Uv(e,u,o,l);if(!(Y(e,f,o,l)<f0)&&!bn(f,i,s,t.id))return f}return null}function Lu(e,t){if(!e.isAdult||e.gender!=="male"||e.leaderId===e.id||!e.leaderId)return{canSplit:!1};if(!e.leaderId)return{canSplit:!1};const i=t.entities.entities[e.leaderId];if(!i||i.type!=="human")return{canSplit:!1};const o=xr(un(t,i));if(o&&o.id===e.id)return{canSplit:!1};const l=da(e.leaderId,t).filter(f=>f.isAdult);if(l.length<d0)return{canSplit:!1};const u=Fv(e,t).filter(f=>f.isAdult).length+1,d=Math.min(l.length*h_,d0);return{canSplit:u>=d,progress:u/d}}function uh(e,t){if(!Lu(e,t).canSplit)return;const i=e.leaderId?t.entities.entities[e.leaderId]:void 0,o=Pf(),l=Fv(e,t);e.leaderId=e.id,e.tribeBadge=o,e.diplomacy={},i&&i.diplomacy&&(i.diplomacy[e.id]=mt.Hostile);for(const u of l)u.leaderId=e.id,u.tribeBadge=o;Nf(t,{type:ha.NewTribeFormed,message:`A new tribe has formed! ${o}`,duration:m_,targetEntityIds:[e.id],highlightedEntityIds:[e.id,...l.map(u=>u.id)]}),Ie({gameState:t},fe.TribeSplit,e.position)}const Xo=(e,t,i)=>{var o,l;return e.id===t.id?!1:e.leaderId&&!t.leaderId?!0:e.leaderId===t.leaderId?!1:e.leaderId&&t.leaderId?((l=(o=i.entities.entities[e.leaderId])==null?void 0:o.diplomacy)==null?void 0:l[t.leaderId])===mt.Hostile:!1},Fn=(e,t,i)=>{var l,s;return!e.leaderId||!t.ownerId||t.ownerId===e.leaderId?!1:((s=(l=i.entities.entities[e.leaderId])==null?void 0:l.diplomacy)==null?void 0:s[t.ownerId])===mt.Hostile},zr=(e,t,i)=>{if(e.id===t.id||e.gender===t.gender||!e.isAdult||!t.isAdult||e.hunger>=Gr||t.hunger>=Gr||(e.procreationCooldown||0)>0||(t.procreationCooldown||0)>0||Xo(e,t,i))return!1;const o=e.gender==="female"?e:t;return!(o.isPregnant||o.age>Dv)},U_=20,In=30,B_=.5,H_=.3,b_=2,Df=50;function ch(e,t){const i=[];if(t.food.length>0&&t.hunger>nr&&i.push({type:se.Eat,action:"eating",key:"f"}),t.food.length<t.maxFood){const s=Ne(t,e,"berryBush",vt,f=>f.food.length>0),u=Ne(t,e,"corpse",vt,f=>f.food.length>0);let d=null;s&&u?d=Y(t.position,s.position,e.mapDimensions.width,e.mapDimensions.height)<=Y(t.position,u.position,e.mapDimensions.width,e.mapDimensions.height)?s:u:d=s||u,d&&i.push({type:se.Gather,action:"gathering",key:"e",targetEntity:d})}const o=Ne(t,e,"human",vt,s=>zr(t,s,e));if(o&&i.push({type:se.Procreate,action:"procreating",key:"r",targetEntity:o}),t.food.length>0&&t.isAdult){const s=Ne(t,e,"human",vt,u=>{const d=u;return!d.isAdult&&(d.motherId===t.id||d.fatherId===t.id)&&d.hunger>=nr});s&&i.push({type:se.FeedChild,action:"feeding",key:"h",targetEntity:s})}const l=Ne(t,e,"human",ti,s=>Xo(t,s,e))??Ne(t,e,"predator",ti)??Ne(t,e,"prey",ti);if(l&&i.push({type:se.Attack,action:"attacking",key:"q",targetEntity:l}),t.food.filter(s=>s.type===Bn.Berry).length>=Br&&i.push({type:se.Plant,action:"planting",key:"b"}),t.food.length>0&&t.isAdult){const s=Ne(t,e,"building",In,u=>{const d=u;return d.buildingType==="storageSpot"&&d.ownerId===t.leaderId&&d.isConstructed&&d.storedFood!==void 0&&d.storageCapacity!==void 0&&d.storedFood.length<d.storageCapacity});s&&i.push({type:se.Deposit,action:"idle",key:"x",targetEntity:s})}if(t.food.length<t.maxFood&&t.isAdult){const s=Ne(t,e,"building",In,u=>{const d=u;return d.buildingType==="storageSpot"&&d.ownerId===t.leaderId&&d.isConstructed&&d.storedFood!==void 0&&d.storedFood.length>0});s&&i.push({type:se.Retrieve,action:"idle",key:"z",targetEntity:s})}return t.leaderId===t.id&&!t.isCallingToAttack&&nh(t,e,eS).length>0&&i.push({type:se.CallToAttack,action:"idle",key:"v"}),Lu(t,e).canSplit&&i.push({type:se.TribeSplit,action:"idle",key:"k"}),t.leaderId===t.id&&!t.isCallingToFollow&&i.push({type:se.FollowMe,action:"idle",key:"c"}),i}const Tn={StorageSpot:"storageSpot",PlantingZone:"plantingZone"},Aa={[Tn.StorageSpot]:{name:"Storage Spot",description:"A designated area for storing excess food.",icon:"",dimensions:{width:40,height:40},constructionTimeHours:.1,destructionTimeHours:.1,cost:{}},[Tn.PlantingZone]:{name:"Planting Zone",description:"An area marked for agricultural use.",icon:"",dimensions:{width:60,height:60},constructionTimeHours:.1,destructionTimeHours:.1,cost:{}}},G_=.5,x_="#FFA500",$_="#FF4500",p0=4,z_=10;function oS(e){return Aa[e].dimensions}function W_(e){return Aa[e].constructionTimeHours}function Y_(e){return Aa[e].destructionTimeHours}function dh(e,t,i,o){if(i===void 0)return!1;const l=oS(t),s=Math.sqrt(l.width*l.width+l.height*l.height)/2;if(bn(e,o,s*.8))return!1;const d=o.search.building.byRadius(e,s*2);for(const f of d){const g=Y(e,f.position,o.mapDimensions.width,o.mapDimensions.height),m=(Math.max(l.width,l.height)+Math.max(f.width,f.height))/2;if(g<m*.9)return!1}return!0}function sS(e,t,i,o){return RR(o.entities,e,t,i)}function j_(e,t){const i=t.entities.entities[e];i&&i.type==="building"&&!i.isBeingDestroyed&&(i.isBeingDestroyed=!0,i.destructionProgress=0)}function V_(e,t){const l=t.search.building.byRadius(e,100);for(const s of l){let u=e.x-s.position.x,d=e.y-s.position.y;const f=t.mapDimensions.width,g=t.mapDimensions.height;if(Math.abs(u)>f/2&&(u-=Math.sign(u)*f),Math.abs(d)>g/2&&(d-=Math.sign(d)*g),Math.abs(u)<=s.width/2&&Math.abs(d)<=s.height/2)return s}}const X_=500,K_=500;function Z_(e,t){if(!e.leaderId)return 0;const i=q_(e.leaderId,t),o=Q_(e.leaderId,t);return o===0?0:Math.min(1,i/o)}function q_(e,t){const i=Hn({leaderId:e},t),o=Ia(e,t),l=i.reduce((u,d)=>u+d.food.length,0),s=o.reduce((u,d)=>{var f;return u+(((f=d.storedFood)==null?void 0:f.length)||0)},0);return l+s}function Q_(e,t){const i=Hn({leaderId:e},t),o=Ia(e,t),l=i.reduce((u,d)=>u+d.maxFood,0),s=o.reduce((u,d)=>u+(d.storageCapacity||0),0);return l+s}function aS(e,t){const i=Ia(e,t);if(i.length===0)return 0;const o=i.reduce((s,u)=>{var d;return s+(((d=u.storedFood)==null?void 0:d.length)||0)},0),l=i.reduce((s,u)=>s+(u.storageCapacity||0),0);return l===0?0:Math.min(1,o/l)}function lS(e,t){const i=Hn({leaderId:e},t);return i.length===0?0:J_(e,t)/i.length}function J_(e,t){const i=t,o=$r(e,t);return i.search.berryBush.byRadius(o,X_).filter(u=>{const d=u.stateMachine&&u.stateMachine[0]==="bushDying",f=u.food.length>0;return!d&&f}).length}function fh(e,t){return e.leaderId?t.search.building.all().filter(l=>{if(l.buildingType!==Tn.PlantingZone||!l.isConstructed)return!1;if(l.ownerId){const s=t.entities.entities[l.ownerId];return s&&s.leaderId===e.leaderId}return!1}):[]}function eC(e){const t=Hr*2,i=Math.floor(e.width/t),o=Math.floor(e.height/t);return i*o}function tC(e,t){const i=t,o=Math.max(e.width,e.height);return i.search.berryBush.byRadius(e.position,o).filter(u=>{const d=Math.abs(u.position.x-e.position.x),f=Math.abs(u.position.y-e.position.y);return d<=e.width/2&&f<=e.height/2}).length}function nC(e,t){if(!e.leaderId)return[];const i=Ia(e.leaderId,t),o=Hn(e,t);return i.map(l=>{var g;const s=l.storageCapacity||0,u=((g=l.storedFood)==null?void 0:g.length)||0,d=o.filter(m=>{if(m.activeAction!=="depositing")return!1;if(typeof m.target=="object"&&"x"in m.target){const v=m.target;return Y(v,l.position,t.mapDimensions.width,t.mapDimensions.height)<=50}return!1}).length,f=Y(e.position,l.position,t.mapDimensions.width,t.mapDimensions.height);return{storage:l,capacity:s,currentFood:u,assignedDepositors:d,distance:f}})}function iC(e,t){const i=nC(e,t);if(i.length===0)return null;const o=i.filter(l=>{const s=l.currentFood<l.capacity,u=l.distance<=K_;return s&&u});return o.length===0?null:(o.sort((l,s)=>{const u=l.currentFood/l.capacity,d=s.currentFood/s.capacity;return Math.abs(u-d)>.1?u-d:l.assignedDepositors!==s.assignedDepositors?l.assignedDepositors-s.assignedDepositors:l.distance-s.distance}),o[0].storage)}function uS(e,t,i){return Hn({leaderId:e},t).filter(l=>l.activeAction===i).length}function Ia(e,t){return t.search.building.all().filter(l=>{if(l.buildingType!==Tn.StorageSpot||!l.isConstructed)return!1;if(l.ownerId){const s=t.entities.entities[l.ownerId];return s&&s.leaderId===e}return!1})}function rC(e,t){const i=fh(e,t);if(i.length===0)return null;const o=t.mapDimensions.width,l=t.mapDimensions.height;for(const s of i){const u=eC(s);if(tC(s,t)>=u)continue;const f=20;for(let g=0;g<f;g++){const m=s.position.x+(Math.random()-.5)*s.width,v=s.position.y+(Math.random()-.5)*s.height,y={x:(m%o+o)%o,y:(v%l+l)%l};if(!bn(y,t,Hr))return{position:y,zoneId:s.id}}}return null}function oC(e,t,i){return fh(t,i).some(s=>KE(e,s,i))?!bn(e,i,Hr):!1}const sC={id:lu,update:(e,t)=>{const{entity:i,updateContext:o}=t,{gameState:l}=o,s=o.deltaTime*(Et/wt);if(i.age+=s,i.age>=i.lifespan)return{nextState:la,data:{...e,enteredAt:l.time,previousState:lu}};const u=Uv(i.position,i.spreadRadius,l.mapDimensions.width,l.mapDimensions.height);return bn(u,l,15)||_a(l.entities,u,l.time),{nextState:Cr,data:{...e,enteredAt:l.time,previousState:lu}}},onEnter:(e,t)=>({...t,enteredAt:e.updateContext.gameState.time})},aC={id:la,update:e=>({nextState:la,data:e}),onEnter:(e,t)=>(qo(e.updateContext.gameState.entities,e.entity.id),{...t,enteredAt:e.updateContext.gameState.time})},lC=[vI,SI,sC,aC],dt="humanIdle",_r="humanMoving",Xs="humanEating",Ea="humanGathering",ta="humanDepositing",na="humanRetrieving",pa="humanProcreating",ir="humanAttacking",du="humanPlanting",uC={id:dt,update:(e,t)=>{const{entity:i,updateContext:o}=t;return i.activeAction==="attacking"&&i.attackTargetId?{nextState:ir,data:{...e,enteredAt:o.gameState.time,previousState:dt,attackTargetId:i.attackTargetId,attackStartTime:o.gameState.time}}:(i.hunger>=Rv?(i.debuffs=i.debuffs.filter(l=>l.type!=="slow"),i.debuffs.push({type:"slow",startTime:o.gameState.time,duration:.1})):i.debuffs=i.debuffs.filter(l=>l.type!=="slow"),i.activeAction==="moving"?{nextState:_r,data:{...e,enteredAt:o.gameState.time,previousState:dt,target:i.target}}:i.activeAction==="gathering"?{nextState:Ea,data:{...e,enteredAt:o.gameState.time,previousState:dt,target:i.target}}:i.activeAction==="eating"?{nextState:Xs,data:{...e,enteredAt:o.gameState.time,previousState:dt}}:i.activeAction==="planting"&&i.target?{nextState:du,data:{...e,enteredAt:o.gameState.time,previousState:dt,plantingSpot:i.target}}:i.activeAction==="depositing"?{nextState:ta,data:{...e,enteredAt:o.gameState.time,previousState:dt}}:i.activeAction==="retrieving"?{nextState:na,data:{...e,enteredAt:o.gameState.time,previousState:dt}}:{nextState:dt,data:e})},onEnter:(e,t)=>(e.entity.acceleration=0,e.entity.velocity={x:0,y:0},{...t,enteredAt:e.updateContext.gameState.time})};function cS(e){let t=mE;return e.hunger>=Rv&&(t*=vE),e.age>=yE&&(t*=TE),e.movementSlowdown&&(t*=e.movementSlowdown.modifier),t}const Xd=7.5;class cC{constructor(){Oe(this,"id",_r)}update(t,i){var f;const{entity:o,updateContext:l}=i;if(o.activeAction==="attacking"&&o.attackTargetId)return{nextState:ir,data:{...t,enteredAt:l.gameState.time,previousState:_r,attackTargetId:o.attackTargetId,attackStartTime:l.gameState.time}};if(o.activeAction!=="moving")return{nextState:dt,data:{...t,enteredAt:l.gameState.time,previousState:_r}};let s;if(typeof o.target=="object"?s=o.target:typeof o.target=="number"&&(s=(f=i.updateContext.gameState.entities.entities[o.target])==null?void 0:f.position),!s&&(o.direction.x!==0||o.direction.y!==0)&&(s={x:o.position.x+o.direction.x*Xd*2,y:o.position.y+o.direction.y*Xd*2}),!s)return{nextState:dt,data:{...t,enteredAt:l.gameState.time,previousState:_r}};const u=We(o.position,s,i.updateContext.gameState.mapDimensions.width,i.updateContext.gameState.mapDimensions.height);return o.direction=st(u),o.acceleration=cS(o),Y(o.position,s,l.gameState.mapDimensions.width,l.gameState.mapDimensions.height)<Xd?{nextState:dt,data:{...t,enteredAt:l.gameState.time,previousState:_r}}:{nextState:_r,data:t}}onExit(t){const{entity:i}=t;i.acceleration=0}}const dC=new cC,xe=1,Pr=3,fC=70;function ke(e,t,i,o,l){const s={id:e.nextVisualEffectId,type:t,position:i,startTime:e.time,duration:o,entityId:l};return e.visualEffects.push(s),e.nextVisualEffectId++,s.id}var ce=(e=>(e[e.Hunger=0]="Hunger",e[e.Procreation=1]="Procreation",e[e.Pregnant=2]="Pregnant",e[e.TargetAcquired=3]="TargetAcquired",e[e.Attack=4]="Attack",e[e.Partnered=5]="Partnered",e[e.BushClaimed=6]="BushClaimed",e[e.BushClaimLost=7]="BushClaimLost",e[e.Eating=8]="Eating",e[e.ChildFed=9]="ChildFed",e[e.AttackDeflected=10]="AttackDeflected",e[e.AttackResisted=11]="AttackResisted",e[e.Hit=12]="Hit",e[e.SeizeBuildup=13]="SeizeBuildup",e[e.Seize=14]="Seize",e[e.CallToAttack=15]="CallToAttack",e[e.CallToFollow=16]="CallToFollow",e[e.AutopilotMoveTarget=17]="AutopilotMoveTarget",e))(ce||{});const hC={id:Xs,update:(e,t)=>{const{entity:i,updateContext:o}=t;return i.activeAction!=="eating"?{nextState:dt,data:{...e,enteredAt:o.gameState.time,previousState:Xs}}:(i.food.length>0&&(!i.eatingCooldownTime||o.gameState.time>=i.eatingCooldownTime)&&i.hunger>nr&&(i.hunger=Math.max(0,i.hunger-nr),i.food.pop(),i.eatingCooldownTime=o.gameState.time+1,Ie(o,fe.Eat,i.position),(!i.lastEatingEffectTime||o.gameState.time-i.lastEatingEffectTime>2)&&(ke(o.gameState,ce.Eating,i.position,xe,i.id),i.lastEatingEffectTime=o.gameState.time)),i.hunger<=0||i.food.length<=0?{nextState:dt,data:{...e,enteredAt:o.gameState.time,previousState:Xs}}:{nextState:Xs,data:e})},onEnter:(e,t)=>(e.entity.acceleration=0,e.entity.velocity={x:0,y:0},{...t,enteredAt:e.updateContext.gameState.time})};class gC{constructor(){Oe(this,"id",Ea)}update(t,i){return i.entity.activeAction!=="gathering"?{nextState:"humanIdle",data:{...t,enteredAt:i.updateContext.gameState.time,previousState:this.id}}:{nextState:this.id,data:t}}}const pC=new gC,mC={id:ta,update:(e,t)=>{const{entity:i}=t;return i.activeAction!=="depositing"?{nextState:dt,data:{...e,enteredAt:t.updateContext.gameState.time,previousState:ta}}:{nextState:ta,data:e}},onEnter:(e,t)=>{const{entity:i}=e;return i.activeAction="depositing",t},onExit:e=>{const{entity:t}=e;t.activeAction==="depositing"&&(t.activeAction="idle")}},vC={id:na,update:(e,t)=>{const{entity:i}=t;return i.activeAction!=="retrieving"?{nextState:dt,data:{...e,enteredAt:t.updateContext.gameState.time,previousState:na}}:{nextState:na,data:e}},onEnter:(e,t)=>{const{entity:i}=e;return i.activeAction="retrieving",t},onExit:e=>{const{entity:t}=e;t.activeAction==="retrieving"&&(t.activeAction="idle")}},SC=(e,t)=>(t.procreationEndTime=e.updateContext.gameState.time+(t.duration||2),t),yC=(e,t)=>{const{entity:i,updateContext:o}=t,{gameState:l}=o;if(l.time<(e.procreationEndTime||0))return{nextState:pa,data:e};const s=l.entities.entities[e.partnerId];if(s&&s.type==="human"&&!s.isPregnant&&i.hunger<Gr&&s.hunger<Gr&&!i.procreationCooldown&&!s.procreationCooldown){const u=i.gender==="female"?i:s.gender==="female"?s:void 0,d=i.gender==="male"?i:s.gender==="male"?s:void 0;u&&d&&(u.isPregnant=!0,u.gestationTime=EE,u.pregnancyFatherId=d.id,i.procreationCooldown=Ym,s.procreationCooldown=Ym,Ie(o,fe.Procreate,u.position))}return i.activeAction="idle",s&&(s.activeAction="idle"),{nextState:dt,data:{...e,enteredAt:l.time,previousState:pa}}},TC={id:pa,onEnter:SC,update:yC},AC={id:ir,onEnter:(e,t)=>({...t,enteredAt:e.updateContext.gameState.time,attackStartTime:e.updateContext.gameState.time}),update:(e,t)=>{if(t.entity.activeAction!=="attacking"||!t.entity.attackTargetId)return t.entity.activeAction="idle",{nextState:dt,data:{...e}};const i=t.updateContext.gameState.entities.entities[t.entity.attackTargetId];if(!i)return t.entity.activeAction="idle",{nextState:dt,data:{...e}};const o=Y(t.entity.position,i.position,t.updateContext.gameState.mapDimensions.width,t.updateContext.gameState.mapDimensions.height),l=We(t.entity.position,i.position,t.updateContext.gameState.mapDimensions.width,t.updateContext.gameState.mapDimensions.height);return t.entity.direction=st(l),o>ti?t.entity.acceleration=cS(t.entity):t.entity.acceleration=0,{nextState:ir,data:e}}},IC={id:du,update:(e,t)=>{const{entity:i,updateContext:o}=t,{gameState:l}=o;if(l.time-e.enteredAt>=mI){if(i.food.filter(d=>d.type===Bn.Berry).length>=Br){for(let d=0;d<Br;d++){const f=i.food.findIndex(g=>g.type===Bn.Berry);f>-1&&i.food.splice(f,1)}_a(l.entities,e.plantingSpot,l.time)}return{nextState:dt,data:{...e,enteredAt:l.time,previousState:du}}}return{nextState:du,data:e}},onEnter:(e,t)=>(e.entity.acceleration=0,e.entity.velocity={x:0,y:0},{...t,enteredAt:e.updateContext.gameState.time})},EC=[uC,dC,hC,pC,mC,vC,TC,AC,IC],kn="preyIdle",Xi="preyMoving",Ks="preyGrazing",Zs="preyProcreating",wC={id:kn,update:(e,t)=>{const{entity:i,updateContext:o}=t;return i.activeAction==="moving"?{nextState:Xi,data:{...e,enteredAt:o.gameState.time,previousState:kn,target:i.target}}:i.activeAction==="grazing"?{nextState:Ks,data:{...e,enteredAt:o.gameState.time,previousState:kn}}:i.activeAction==="procreating"?{nextState:Zs,data:{...e,enteredAt:o.gameState.time,previousState:kn}}:{nextState:kn,data:e}},onEnter:(e,t)=>(e.entity.acceleration=0,e.entity.velocity={x:0,y:0},{...t,enteredAt:e.updateContext.gameState.time})},dS=12,_C=120,m0=50,CC=12,fS=30,RC=2,$t=50,PC=100,ia=2,Kd=3,NC=.9,DC=1,OC=50,kC=.5,hS=20,MC=140,v0=40,FC=12,gS=40,LC=3,er=60,Mn=40,wo=50,S0=320,pS=25,UC=60,mS=2,BC=90,HC=.7,bC=1,ra=3,Zd=15,hh=80,vS=10,Uu=80,Ko=40,SS=2,Tu=30,Ro=20,Or=40,Po=24,kr=48,No=12,Mr=40,Do=20,Fr=60,Oo=.75,Zi=2.5,ko=.25,qi=2;function GC(e){let t=CC;return e.isAdult||(t*=.7),e.hunger>=OC&&(t*=kC),e.movementSlowdown&&(t*=e.movementSlowdown.modifier),t}function xC(e,t){const i=e>>16&255,o=e>>8&255,l=e&255,s=t>>16&255,u=t>>8&255,d=t&255;let f=Math.floor((i+s)/2),g=Math.floor((o+u)/2),m=Math.floor((l+d)/2);return Math.random()<.05&&(f=Math.max(0,Math.min(255,f+(Math.random()-.5)*60))),Math.random()<.05&&(g=Math.max(0,Math.min(255,g+(Math.random()-.5)*60))),Math.random()<.05&&(m=Math.max(0,Math.min(255,m+(Math.random()-.5)*60))),f<<16|g<<8|m}function ma(){const e=Math.floor(Math.random()*100)+100,t=Math.floor(Math.random()*80)+60,i=Math.floor(Math.random()*60)+20;return e<<16|t<<8|i}const qd=10;class $C{constructor(){Oe(this,"id",Xi)}update(t,i){var f;const{entity:o,updateContext:l}=i;if(o.activeAction!=="moving")return{nextState:kn,data:{...t,enteredAt:l.gameState.time,previousState:Xi}};let s;if(typeof o.target=="object"?s=o.target:typeof o.target=="number"&&(s=(f=i.updateContext.gameState.entities.entities[o.target])==null?void 0:f.position),!s&&(o.direction.x!==0||o.direction.y!==0)&&(s={x:o.position.x+o.direction.x*qd*2,y:o.position.y+o.direction.y*qd*2}),!s)return{nextState:kn,data:{...t,enteredAt:l.gameState.time,previousState:Xi}};const u=We(o.position,s,i.updateContext.gameState.mapDimensions.width,i.updateContext.gameState.mapDimensions.height);return o.direction=st(u),o.acceleration=GC(o),Y(o.position,s,l.gameState.mapDimensions.width,l.gameState.mapDimensions.height)<qd?{nextState:kn,data:{...t,enteredAt:l.gameState.time,previousState:Xi}}:{nextState:Xi,data:t}}onExit(t){const{entity:i}=t;i.acceleration=0}onEnter(t,i){return{...i,enteredAt:t.updateContext.gameState.time}}}const zC=new $C,WC={id:Ks,update:(e,t)=>{const{entity:i,updateContext:o}=t;return i.activeAction==="moving"?{nextState:Xi,data:{...e,enteredAt:o.gameState.time,previousState:Ks,target:i.target}}:i.activeAction!=="grazing"?{nextState:kn,data:{...e,enteredAt:o.gameState.time,previousState:Ks}}:{nextState:Ks,data:e}},onEnter:(e,t)=>(e.entity.acceleration=0,e.entity.velocity={x:0,y:0},{...t,enteredAt:e.updateContext.gameState.time})},YC={id:Zs,update:(e,t)=>{const{entity:i,updateContext:o}=t;return i.activeAction==="moving"?{nextState:Xi,data:{...e,enteredAt:o.gameState.time,previousState:Zs,target:i.target}}:i.activeAction!=="procreating"?{nextState:kn,data:{...e,enteredAt:o.gameState.time,previousState:Zs}}:{nextState:Zs,data:e}},onEnter:(e,t)=>(e.entity.acceleration=0,e.entity.velocity={x:0,y:0},{...t,enteredAt:e.updateContext.gameState.time})},jC=[wC,zC,WC,YC],xt="predatorIdle",Yi="predatorMoving",hi="predatorAttacking",_o="predatorProcreating",Lr="predatorEating",VC={id:xt,update:(e,t)=>{const{entity:i,updateContext:o}=t;return i.activeAction==="eating"?{nextState:Lr,data:{...e,enteredAt:o.gameState.time,previousState:xt,preyId:i.attackTargetId,eatingStartTime:o.gameState.time}}:i.activeAction==="attacking"&&i.attackTargetId?{nextState:hi,data:{...e,enteredAt:o.gameState.time,previousState:xt,attackTargetId:i.attackTargetId,attackStartTime:o.gameState.time}}:i.activeAction==="moving"?{nextState:Yi,data:{...e,enteredAt:o.gameState.time,previousState:xt,target:i.target}}:i.activeAction==="procreating"?{nextState:_o,data:{...e,enteredAt:o.gameState.time,previousState:xt}}:{nextState:xt,data:e}},onEnter:(e,t)=>(e.entity.acceleration=0,e.entity.velocity={x:0,y:0},{...t,enteredAt:e.updateContext.gameState.time})};function yS(e){let t=FC;return e.hunger>=BC&&(t*=HC),e.isAdult||(t*=.7),e.movementSlowdown&&(t*=e.movementSlowdown.modifier),t}function XC(e,t){const i=e>>16&255,o=e>>8&255,l=e&255,s=t>>16&255,u=t>>8&255,d=t&255;let f=Math.floor((i+s)/2),g=Math.floor((o+u)/2),m=Math.floor((l+d)/2);return Math.random()<.05&&(f=Math.max(0,Math.min(255,f+(Math.random()-.5)*60))),Math.random()<.05&&(g=Math.max(0,Math.min(255,g+(Math.random()-.5)*60))),Math.random()<.05&&(m=Math.max(0,Math.min(255,m+(Math.random()-.5)*60))),f<<16|g<<8|m}function va(){const e=Math.floor(Math.random()*60)+60,t=Math.floor(Math.random()*50)+40,i=Math.floor(Math.random()*40)+20;return e<<16|t<<8|i}const Qd=12;class KC{constructor(){Oe(this,"id",Yi)}update(t,i){var f;const{entity:o,updateContext:l}=i;if(o.activeAction==="eating")return{nextState:Lr,data:{...t,enteredAt:l.gameState.time,previousState:Yi,preyId:o.attackTargetId,eatingStartTime:l.gameState.time}};if(o.activeAction==="attacking"&&o.attackTargetId)return{nextState:hi,data:{...t,enteredAt:l.gameState.time,previousState:Yi,attackTargetId:o.attackTargetId,attackStartTime:l.gameState.time}};if(o.activeAction!=="moving")return{nextState:xt,data:{...t,enteredAt:l.gameState.time,previousState:Yi}};let s;if(typeof o.target=="object"?s=o.target:typeof o.target=="number"&&(s=(f=i.updateContext.gameState.entities.entities[o.target])==null?void 0:f.position),!s&&(o.direction.x!==0||o.direction.y!==0)&&(s={x:o.position.x+o.direction.x*Qd*2,y:o.position.y+o.direction.y*Qd*2}),!s)return{nextState:xt,data:{...t,enteredAt:l.gameState.time,previousState:Yi}};const u=We(o.position,s,i.updateContext.gameState.mapDimensions.width,i.updateContext.gameState.mapDimensions.height);return o.direction=st(u),o.acceleration=yS(o),Y(o.position,s,l.gameState.mapDimensions.width,l.gameState.mapDimensions.height)<Qd?{nextState:xt,data:{...t,enteredAt:l.gameState.time,previousState:Yi}}:{nextState:Yi,data:t}}onExit(t){const{entity:i}=t;i.acceleration=0}onEnter(t,i){return{...i,enteredAt:t.updateContext.gameState.time}}}const ZC=new KC,qC={id:hi,update:(e,t)=>{const{entity:i,updateContext:o}=t;if(i.activeAction==="eating")return{nextState:Lr,data:{...e,enteredAt:o.gameState.time,previousState:hi,preyId:i.attackTargetId,eatingStartTime:o.gameState.time}};if(i.activeAction!=="attacking"||!i.attackTargetId)return i.activeAction="idle",{nextState:xt,data:{...e,enteredAt:o.gameState.time,previousState:hi}};const l=o.gameState.entities.entities[i.attackTargetId];if(!l)return i.activeAction="idle",{nextState:xt,data:{...e,enteredAt:o.gameState.time,previousState:hi}};if(l.type==="prey"&&l.hitpoints<=0||l.type==="predator"&&l.hitpoints<=0||l.type==="human"&&l.hitpoints<=0)return i.activeAction="idle",{nextState:xt,data:{...e,enteredAt:o.gameState.time,previousState:hi}};const u=Y(i.position,l.position,o.gameState.mapDimensions.width,o.gameState.mapDimensions.height),d=We(i.position,l.position,o.gameState.mapDimensions.width,o.gameState.mapDimensions.height);return i.direction=st(d),u>Mn?i.acceleration=yS(i):i.acceleration=0,{nextState:hi,data:e}},onEnter:(e,t)=>({...t,enteredAt:e.updateContext.gameState.time})},QC={id:_o,update:(e,t)=>{const{entity:i,updateContext:o}=t;return i.activeAction==="eating"?{nextState:Lr,data:{...e,enteredAt:o.gameState.time,previousState:_o,preyId:i.attackTargetId,eatingStartTime:o.gameState.time}}:i.activeAction==="attacking"&&i.attackTargetId?{nextState:hi,data:{...e,enteredAt:o.gameState.time,previousState:_o,attackTargetId:i.attackTargetId,attackStartTime:o.gameState.time}}:i.activeAction!=="procreating"?{nextState:xt,data:{...e,enteredAt:o.gameState.time,previousState:_o}}:{nextState:_o,data:e}},onEnter:(e,t)=>(e.entity.acceleration=0,e.entity.velocity={x:0,y:0},{...t,enteredAt:e.updateContext.gameState.time})},JC={id:Lr,update:(e,t)=>{const{entity:i,updateContext:o}=t;return i.activeAction!=="eating"?{nextState:xt,data:{...e,enteredAt:o.gameState.time,previousState:Lr}}:{nextState:Lr,data:e}},onEnter:(e,t)=>(e.entity.acceleration=0,e.entity.velocity={x:0,y:0},{...t,enteredAt:e.updateContext.gameState.time})},e1=[VC,ZC,qC,QC,JC],y0=[...lC,...EC,...jC,...e1];function t1(e,t,i){const o=sI(e,y0);if(!o)return lI(e),[e,t];const{nextState:l,data:s}=o.update(t,i);return aI(e,l)?[l,oI(o,l,s,i,y0)]:[l,s]}function n1(e,t,i){const{gameState:o}=t,l=i*(Et/wt);if(e.isAdult=e.age>=Xf,e.isCallingToAttack&&e.callToAttackEndTime&&o.time>e.callToAttackEndTime&&(e.isCallingToAttack=!1,e.callToAttackEndTime=void 0),e.isCallingToFollow&&e.callToFollowEndTime&&o.time>e.callToFollowEndTime&&(e.isCallingToFollow=!1,e.callToFollowEndTime=void 0),e.movementSlowdown&&o.time>e.movementSlowdown.endTime&&(e.movementSlowdown=void 0),e.hitpoints<e.maxHitpoints){const u=1-e.hunger/100*FE,d=ME*u*l;e.hitpoints=Math.min(e.maxHitpoints,e.hitpoints+d)}if(e.hunger+=i*(Bs/(Et/wt)),e.hunger>fC&&(!e.lastHungerEffectTime||o.time-e.lastHungerEffectTime>Pr*2)&&(ke(o,ce.Hunger,e.position,Pr,e.id),e.lastHungerEffectTime=o.time),e.age+=i/Ou,e.isPlayer){const u=un(o,e).filter(d=>d.hunger>=v_);if(u.length>0){const d=u.map(f=>f.id);Nf(o,{identifier:"children_starving",type:ha.ChildrenStarving,message:"Your children are starving!",duration:p_,targetEntityIds:d,highlightedEntityIds:d})}}if(e.gender==="female"&&e.isPregnant&&e.gestationTime&&(e.gestationTime-=l,e.hunger+=i*((Bs*wE-Bs)/(Et/wt)),(!e.lastPregnantEffectTime||o.time-e.lastPregnantEffectTime>Pr*3)&&(ke(o,ce.Pregnant,e.position,Pr,e.id),e.lastPregnantEffectTime=o.time),e.gestationTime<=0&&(CR(e,e.pregnancyFatherId,t),e.isPregnant=!1,e.gestationTime=0,e.pregnancyFatherId=void 0)),e.procreationCooldown&&(e.procreationCooldown-=l,e.procreationCooldown<0&&(e.procreationCooldown=0)),e.attackCooldown&&(e.attackCooldown-=l,e.attackCooldown<0&&(e.attackCooldown=0)),e.feedParentCooldownTime&&(e.feedParentCooldownTime-=l,e.feedParentCooldownTime<0&&(e.feedParentCooldownTime=0)),e.feedChildCooldownTime&&(e.feedChildCooldownTime-=l,e.feedChildCooldownTime<0&&(e.feedChildCooldownTime=0)),e.leaderMetaStrategyCooldown&&(e.leaderMetaStrategyCooldown-=l,e.leaderMetaStrategyCooldown<0&&(e.leaderMetaStrategyCooldown=0)),e.isAdult?e.radius===Vo&&(e.radius=_t):e.hunger+=i*((Bs*_E-Bs)/(Et/wt)),e.isAdult&&e.food.length>0&&(!e.feedParentCooldownTime||e.feedParentCooldownTime<=0)){const u=[];if(e.motherId){const d=o.entities.entities[e.motherId];d&&u.push(d)}if(e.fatherId){const d=o.entities.entities[e.fatherId];d&&u.push(d)}for(const d of u)if(d.age>=qf&&d.hunger>=PE&&Y(e.position,d.position,o.mapDimensions.width,o.mapDimensions.height)<=NE){e.food.pop(),d.hunger=Math.max(0,d.hunger-nr),e.feedParentCooldownTime=DE;break}}let s;if(e.hitpoints<=0?s="killed":e.hunger>=br?e.food.length>0&&e.isAdult?(e.food.pop(),e.hunger=Math.max(0,e.hunger-nr)):s="hunger":e.age>=e.maxAge&&(s="oldAge"),s){if(e.leaderId===e.id){const u=xr(un(o,e));u?(u.leaderId=u.id,u.tribeBadge=e.tribeBadge,u.diplomacy={...e.diplomacy},Object.values(o.entities.entities).forEach(d=>{if(d.type==="human"&&d.leaderId===e.id){const f=d;f.leaderId=u.id}if(d.type==="building"&&d.ownerId===e.id){const f=d;f.ownerId=u.id}})):Object.values(o.entities.entities).forEach(d=>{if(d.type==="human"&&d.leaderId===e.id){const f=d;f.leaderId=void 0,f.tribeBadge=void 0}if(d.type==="building"&&d.ownerId===e.id){const f=d;f.ownerId=void 0}})}if(e.isPlayer){const u=xr(un(o,e));u?(u.isPlayer=!0,o.generationCount++):(o.gameOver=!0,o.causeOfGameOver=s,Nf(o,{identifier:"no_heir",type:ha.NoHeir,message:"Your lineage has ended. You have no heir.",duration:0}))}ER(o.entities,e.position,e.gender,e.age,e.radius,e.id,o.time,e.food,e.hunger),qo(o.entities,e.id);return}e.animationProgress===void 0&&(e.animationProgress=0),e.animationSpeed===void 0&&(e.animationSpeed=1),e.animationProgress+=i*e.animationSpeed,e.animationProgress>=1&&(e.animationProgress=0)}function i1(e,t){const i=t.gameState.time-e.timeOfDeath;e.decayProgress=Math.min(1,i/OE);const o=Math.floor(Ov*(1-e.decayProgress));e.food.length>o&&e.food.splice(o),e.decayProgress>=1&&e.food.length<=0&&qo(t.gameState.entities,e.id)}function r1(e,t,i){const o=i*(Et/wt);e.age+=i/Ou,e.isAdult=e.age>=ia;let l=t.gameState.ecosystem.preyHungerIncreasePerHour*o;if(e.isPregnant&&(l*=1.2),e.hunger+=l,e.isPregnant&&e.gestationTime!==void 0&&(e.gestationTime-=o,e.gestationTime<=0)){const u={x:e.position.x+(Math.random()-.5)*40,y:e.position.y+(Math.random()-.5)*40};u.x=Math.max(20,Math.min(t.gameState.mapDimensions.width-20,u.x)),u.y=Math.max(20,Math.min(t.gameState.mapDimensions.height-20,u.y));const d=Math.random()<.5?"male":"female",f=e,g=e.fatherId?t.gameState.entities.entities[e.fatherId]:void 0;let m;if(g)m=xC(f.geneCode,g.geneCode);else{m=f.geneCode;const v=Math.floor((Math.random()-.5)*4096);m=Math.max(0,Math.min(16777215,m+v))}zo(t.gameState.entities,u,d,0,fS*.5,m,e.id,e.fatherId),ke(t.gameState,ce.Procreation,e.position,Pr,e.id),Ie(t,fe.Birth,e.position),e.isPregnant=!1,e.gestationTime=0,e.procreationCooldown=t.gameState.ecosystem.preyProcreationCooldown,e.fatherId=void 0}e.procreationCooldown&&e.procreationCooldown>0&&(e.procreationCooldown-=o,e.procreationCooldown<0&&(e.procreationCooldown=0)),e.eatingCooldownTime&&e.eatingCooldownTime>t.gameState.time||(e.eatingCooldownTime=void 0),e.fleeCooldown&&e.fleeCooldown>0&&(e.fleeCooldown-=o,e.fleeCooldown<0&&(e.fleeCooldown=0)),e.feedChildCooldownTime&&e.feedChildCooldownTime>0&&(e.feedChildCooldownTime-=o,e.feedChildCooldownTime<0&&(e.feedChildCooldownTime=0));let s=!1;e.hunger>=_C&&(s=!0),e.hitpoints<=0&&(s=!0),e.age>=dS&&(s=!0),s&&(wR(t.gameState.entities,e.position,e.gender,e.age,e.radius,e.id,t.gameState.time,e.geneCode),qo(t.gameState.entities,e.id))}function o1(e,t,i){const o=i*(Et/wt);e.age+=i/Ou,e.isAdult=e.age>=ra;let l=t.gameState.ecosystem.predatorHungerIncreasePerHour*o;if(e.isPregnant&&(l*=1.3),e.hunger+=l,e.isPregnant&&e.gestationTime!==void 0&&(e.gestationTime-=o,e.gestationTime<=0)){const u={x:e.position.x+(Math.random()-.5)*50,y:e.position.y+(Math.random()-.5)*50};u.x=Math.max(25,Math.min(t.gameState.mapDimensions.width-25,u.x)),u.y=Math.max(25,Math.min(t.gameState.mapDimensions.height-25,u.y));const d=Math.random()<.5?"male":"female",f=e,g=e.pregnancyFatherId?t.gameState.entities.entities[e.pregnancyFatherId]:void 0;let m;if(g)m=XC(f.geneCode,g.geneCode);else{m=f.geneCode;const v=Math.floor((Math.random()-.5)*4096);m=Math.max(0,Math.min(16777215,m+v))}Wo(t.gameState.entities,u,d,0,gS*.6,m,e.id,e.pregnancyFatherId),ke(t.gameState,ce.Procreation,e.position,Pr,e.id),Ie(t,fe.Birth,e.position),e.isPregnant=!1,e.gestationTime=0,e.procreationCooldown=t.gameState.ecosystem.predatorProcreationCooldown,e.pregnancyFatherId=void 0}e.procreationCooldown&&e.procreationCooldown>0&&(e.procreationCooldown-=o,e.procreationCooldown<0&&(e.procreationCooldown=0)),e.attackCooldown&&e.attackCooldown>0&&(e.attackCooldown-=o,e.attackCooldown<0&&(e.attackCooldown=0)),e.huntCooldown&&e.huntCooldown>0&&(e.huntCooldown-=o,e.huntCooldown<0&&(e.huntCooldown=0)),e.feedChildCooldownTime&&e.feedChildCooldownTime>0&&(e.feedChildCooldownTime-=o,e.feedChildCooldownTime<0&&(e.feedChildCooldownTime=0));let s=!1;e.hunger>=MC&&(s=!0),e.hitpoints<=0&&(s=!0),e.age>=hS&&(s=!0),s&&(_R(t.gameState.entities,e.position,e.gender,e.age,e.radius,e.id,t.gameState.time,e.geneCode),qo(t.gameState.entities,e.id))}var wa=(e=>(e[e.BehaviorTreeBased=0]="BehaviorTreeBased",e))(wa||{}),T=(e=>(e[e.SUCCESS=0]="SUCCESS",e[e.FAILURE=1]="FAILURE",e[e.RUNNING=2]="RUNNING",e[e.NOT_EVALUATED=3]="NOT_EVALUATED",e))(T||{});class wn{constructor(){Oe(this,"name");Oe(this,"depth");Oe(this,"children");Oe(this,"child")}getLastStatus(t){return C.get(t.aiBlackboard,`${this.name}_lastStatus`)??3}setLastStatus(t,i){C.set(t.aiBlackboard,`${this.name}_lastStatus`,i)}getRunningChildIndex(t){return C.get(t.aiBlackboard,`${this.name}_runningChildIndex`)}setRunningChildIndex(t,i){C.set(t.aiBlackboard,`${this.name}_runningChildIndex`,i)}}const C={create(){return{data:{},nodeExecutionData:{}}},set({data:e},t,i){e[t]=i},get(e,t){return e==null?void 0:e.data[t]},delete({data:e},t){delete e[t]},has({data:e},t){return t in e},recordNodeExecution({nodeExecutionData:e},t,i,o,l,s){const u=e[t]||{lastExecuted:0,status:T.FAILURE,depth:0,debugInfo:"",executionHistory:[]},d=u.executionHistory[u.executionHistory.length-1];d&&o-(d==null?void 0:d.time)>ua&&u.executionHistory.push({time:d.time+ua,status:T.NOT_EVALUATED}),u.executionHistory.push({time:o,status:i});const f=Kv/wt*Et,g=o-f;u.executionHistory=u.executionHistory.filter(v=>v.time>=g);const m={...u,lastExecuted:o,status:i,depth:l,debugInfo:s};e[t]=m},getNodeExecutionData({nodeExecutionData:e}){return e},cleanupOldEntries({nodeExecutionData:e},t){const i=OI,o=[];for(const[l,s]of Object.entries(e))t-s.lastExecuted>i&&o.push(l);for(const l of o)delete e[l]}};function gh(e,t,i){if(e.aiBlackboard){const o=C.get(e.aiBlackboard,"lastAiUpdateTime")??0;t.gameState.time-o>=ua&&(i.execute(e,t,e.aiBlackboard),C.set(e.aiBlackboard,"lastAiUpdateTime",t.gameState.time))}else console.warn(`Behavior Tree AI ticked for human ${e.id}, but the tree or blackboard was missing.`),e.activeAction="idle"}const T0="Human Behavior",s1=1;class a1{constructor(){Oe(this,"nodeData",new Map);Oe(this,"pathStack",[]);Oe(this,"startTimeStack",[])}nodeStart(t){this.pathStack.push(t),this.startTimeStack.push(performance.now())}nodeEnd(){if(this.startTimeStack.length===0||this.pathStack.length===0){console.error("BTProfiler: nodeEnd() called without a matching nodeStart().");return}const t=performance.now(),i=this.startTimeStack.pop(),o=t-i,l=this.pathStack.join(" > "),s=this.nodeData.get(l)??{path:l,totalTime:0,callCount:0,minTime:1/0,maxTime:-1/0};s.totalTime+=o,s.callCount++,s.minTime=Math.min(s.minTime,o),s.maxTime=Math.max(s.maxTime,o),this.nodeData.set(l,s),this.pathStack.pop()}report(t={}){const{showAll:i=!1}=t,o=Array.from(this.nodeData.values());if(o.length===0){console.log("--- Behavior Tree Profiler: No data collected. ---");return}let l=o,s="--- Behavior Tree Full Report ---";if(!i){const d=this.nodeData.get(T0);if(d){const f=d.totalTime*s1/100;l=o.filter(g=>g.totalTime>f&&g.path!==T0),s="--- Behavior Tree Problem Report ---"}else console.log('BTProfiler: Root node "Human Behavior" not found. Showing full report.'),s="--- Behavior Tree Full Report (Root Not Found) ---"}const u=l.sort((d,f)=>f.totalTime-d.totalTime);console.log(s),u.length>0?console.table(u.map(d=>({Path:d.path,"Total Time (ms)":d.totalTime.toFixed(3),Calls:d.callCount,"Avg Time (ms)":(d.totalTime/d.callCount).toFixed(3),"Min Time (ms)":d.minTime.toFixed(3),"Max Time (ms)":d.maxTime.toFixed(3)}))):console.log("No significant performance problems detected."),console.log("------------------------------------")}reset(){this.nodeData.clear(),this.pathStack=[],this.startTimeStack=[]}}const ot=new a1;function Zt(e){return Array.isArray(e)?e:[e,""]}class Se extends wn{constructor(i,o,l=0){super();Oe(this,"name");Oe(this,"depth");this.children=i,this.name=o,this.depth=l,this.children.forEach(s=>{s.depth=(this.depth??0)+1})}execute(i,o,l){this.name&&ot.nodeStart(this.name);try{for(const s of this.children){const[u,d]=Zt(s.execute(i,o,l));if(u!==T.SUCCESS)return this.setLastStatus(i,u),this.name&&C.recordNodeExecution(l,this.name,u,o.gameState.time,this.depth,d),u}return this.setLastStatus(i,T.SUCCESS),this.name&&C.recordNodeExecution(l,this.name,T.SUCCESS,o.gameState.time,this.depth,""),T.SUCCESS}finally{this.name&&ot.nodeEnd()}}}class qt extends wn{constructor(i,o,l=0){super();Oe(this,"name");Oe(this,"depth");this.children=i,this.name=o,this.depth=l,this.children.forEach(s=>{s.depth=(this.depth??0)+1})}execute(i,o,l){this.name&&ot.nodeStart(this.name);try{const s=this.getRunningChildIndex(i)??0;for(let u=s;u<this.children.length;u++){const d=this.children[u],[f,g]=Zt(d.execute(i,o,l));if(f!==T.FAILURE){if(f===T.SUCCESS)return this.setRunningChildIndex(i,void 0),this.setLastStatus(i,T.SUCCESS),this.name&&C.recordNodeExecution(l,this.name,T.SUCCESS,o.gameState.time,this.depth,g),T.SUCCESS;if(f===T.RUNNING)return this.setRunningChildIndex(i,u),this.setLastStatus(i,T.RUNNING),this.name&&C.recordNodeExecution(l,this.name,T.RUNNING,o.gameState.time,this.depth,g),T.RUNNING}}return this.setRunningChildIndex(i,void 0),this.setLastStatus(i,T.FAILURE),this.name&&C.recordNodeExecution(l,this.name,T.FAILURE,o.gameState.time,this.depth,""),T.FAILURE}finally{this.name&&ot.nodeEnd()}}}class ae extends wn{constructor(i,o,l=0){super();Oe(this,"name");Oe(this,"depth");this.action=i,this.name=o,this.depth=l}execute(i,o,l){this.name&&ot.nodeStart(this.name);try{const[s,u]=Zt(this.action(i,o,l));return this.setLastStatus(i,s),this.name&&C.recordNodeExecution(l,this.name,s,o.gameState.time,this.depth,u),s}finally{this.name&&ot.nodeEnd()}}}class re extends wn{constructor(i,o,l=0){super();Oe(this,"name");Oe(this,"depth");this.condition=i,this.name=o,this.depth=l}execute(i,o,l){this.name&&ot.nodeStart(this.name);try{const[s,u]=Zt(this.condition(i,o,l)),d=s?T.SUCCESS:T.FAILURE;return this.setLastStatus(i,d),this.name&&C.recordNodeExecution(l,this.name,d,o.gameState.time,this.depth,u),d}finally{this.name&&ot.nodeEnd()}}}class Au extends wn{constructor(i,o,l,s=0){super();Oe(this,"name");Oe(this,"depth");Oe(this,"startTimeKey");this.child=i,this.timeoutDurationHours=o,this.name=l,this.depth=s,this.child.depth=(this.depth??0)+1,this.startTimeKey=`timeout_${this.name}_startTime`}execute(i,o,l){ot.nodeStart(this.name);try{const s=o.gameState.time;let u=C.get(l,this.startTimeKey);const[d,f]=Zt(this.child.execute(i,o,l));if(d===T.RUNNING){u===void 0&&(C.set(l,this.startTimeKey,s),u=s);const g=s-u;if(g>this.timeoutDurationHours){C.delete(l,this.startTimeKey),this.setLastStatus(i,T.FAILURE);const v=`Timed out after ${g.toFixed(2)}h.`;return C.recordNodeExecution(l,this.name,this.getLastStatus(i),s,this.depth,v),this.getLastStatus(i)}this.setLastStatus(i,T.RUNNING);const m=`Running for ${g.toFixed(2)}h. ${f}`;return C.recordNodeExecution(l,this.name,this.getLastStatus(i),s,this.depth,m),this.getLastStatus(i)}return u!==void 0&&C.delete(l,this.startTimeKey),this.setLastStatus(i,d),C.recordNodeExecution(l,this.name,this.getLastStatus(i),s,this.depth,f),this.getLastStatus(i)}finally{ot.nodeEnd()}}}class Nr extends wn{constructor(i,o,l,s=0,u){super();Oe(this,"name");Oe(this,"depth");Oe(this,"statusKey");Oe(this,"timestampKey");this.child=i,this.cacheDurationHours=o,this.validityCheck=u,this.name=l,this.depth=s,this.child.depth=(this.depth??0)+1,this.statusKey=`caching_${this.name}_status`,this.timestampKey=`caching_${this.name}_timestamp`}execute(i,o,l){ot.nodeStart(this.name);try{const s=o.gameState.time,u=C.get(l,this.statusKey),d=C.get(l,this.timestampKey);if(u!==void 0&&d!==void 0){const v=s-d>this.cacheDurationHours,y=this.validityCheck?this.validityCheck(i,o,l):!0;if(!v&&y){const I=(d+this.cacheDurationHours-s).toFixed(2),E=`Cache hit. Status: ${T[u]}. ${I}h left.`;return this.setLastStatus(i,u),C.recordNodeExecution(l,this.name,this.getLastStatus(i),s,this.depth,E),this.getLastStatus(i)}}const[f,g]=Zt(this.child.execute(i,o,l));(f===T.SUCCESS||f===T.FAILURE)&&(C.set(l,this.statusKey,f),C.set(l,this.timestampKey,s)),this.setLastStatus(i,f);const m=`Cache miss. Child returned ${T[f]}. ${g}`;return C.recordNodeExecution(l,this.name,this.getLastStatus(i),s,this.depth,m),this.getLastStatus(i)}finally{ot.nodeEnd()}}}class or extends wn{constructor(i,o,l,s=0){super();Oe(this,"name");Oe(this,"depth");Oe(this,"cooldownKey");this.cooldownDurationHours=i,this.child=o,this.name=l,this.depth=s,this.child.depth=(this.depth??0)+1,this.cooldownKey=`cooldown_${this.name}`}execute(i,o,l){ot.nodeStart(this.name);try{const s=o.gameState.time,u=C.get(l,this.cooldownKey);if(this.child.getLastStatus(i)===T.RUNNING){const[g,m]=Zt(this.child.execute(i,o,l));if(this.setLastStatus(i,g),this.name){const v=`Continuing running child. ${m}`;C.recordNodeExecution(l,this.name,this.getLastStatus(i),s,this.depth,v)}return this.getLastStatus(i)}if(u!==void 0&&s<u){const m=`Cooldown active, ${(u-s).toFixed(2)}h left`;return this.setLastStatus(i,T.FAILURE),this.name&&C.recordNodeExecution(l,this.name,this.getLastStatus(i),s,this.depth,m),this.getLastStatus(i)}const[d,f]=Zt(this.child.execute(i,o,l));return d===T.SUCCESS&&C.set(l,this.cooldownKey,s+this.cooldownDurationHours),this.setLastStatus(i,d),this.name&&C.recordNodeExecution(l,this.name,this.getLastStatus(i),s,this.depth,f),this.getLastStatus(i)}finally{ot.nodeEnd()}}}class on extends wn{constructor(i,o,l,s=0){super();Oe(this,"name");Oe(this,"depth");this.child=i,this.behaviorKey=o,this.name=l,this.depth=s;const u=(d,f)=>{d.depth=f,d.children?d.children.forEach(g=>u(g,f+1)):d.child&&u(d.child,f+1)};u(this.child,(this.depth??0)+1)}execute(i,o,l){this.name&&ot.nodeStart(this.name);try{if(i.isPlayer&&!o.gameState.autopilotControls.behaviors[this.behaviorKey]){const f=`Player autopilot for '${this.behaviorKey}' is disabled.`;return this.setLastStatus(i,T.FAILURE),this.name&&C.recordNodeExecution(l,this.name,this.getLastStatus(i),o.gameState.time,this.depth,f),this.getLastStatus(i)}const[u,d]=Zt(this.child.execute(i,o,l));return this.setLastStatus(i,u),this.name&&C.recordNodeExecution(l,this.name,this.getLastStatus(i),o.gameState.time,this.depth,d),this.getLastStatus(i)}finally{this.name&&ot.nodeEnd()}}}class l1 extends wn{constructor(i,o,l=0){super();Oe(this,"name");Oe(this,"depth");this.child=i,this.name=o,this.depth=l;const s=(u,d)=>{u.depth=d,u.children?u.children.forEach(f=>s(f,d+1)):u.child&&s(u.child,d+1)};s(this.child,(this.depth??0)+1)}execute(i,o,l){this.name&&ot.nodeStart(this.name);try{if(i.isPlayer&&o.gameState.autopilotControls.isManuallyMoving)return this.setLastStatus(i,T.FAILURE),this.name&&C.recordNodeExecution(l,this.name,this.getLastStatus(i),o.gameState.time,this.depth,"Manual movement active, AI blocked."),this.getLastStatus(i);const[s,u]=Zt(this.child.execute(i,o,l));return this.setLastStatus(i,s),this.name&&C.recordNodeExecution(l,this.name,this.getLastStatus(i),o.gameState.time,this.depth,u),this.getLastStatus(i)}finally{this.name&&ot.nodeEnd()}}}class Er extends wn{constructor(i,o,l=0){super();Oe(this,"name");Oe(this,"depth");this.child=i,this.name=o,this.depth=l;const s=(u,d)=>{u.depth=d,u.children?u.children.forEach(f=>s(f,d+1)):u.child&&s(u.child,d+1)};s(this.child,(this.depth??0)+1)}execute(i,o,l){this.name&&ot.nodeStart(this.name);try{if(i.isPlayer)return this.setLastStatus(i,T.FAILURE),this.name&&C.recordNodeExecution(l,this.name,this.getLastStatus(i),o.gameState.time,this.depth,"Player controlled, AI blocked."),this.getLastStatus(i);const[s,u]=Zt(this.child.execute(i,o,l));return this.setLastStatus(i,s),this.name&&C.recordNodeExecution(l,this.name,this.getLastStatus(i),o.gameState.time,this.depth,u),this.getLastStatus(i)}finally{this.name&&ot.nodeEnd()}}}const $o=24,ph=2,TS=2;function Sa(e,t){if(e.leaderId){const i=t.entities.entities[e.leaderId];if(i&&i.aiBlackboard)return i}if(e.isAdult&&e.aiBlackboard)return e;if(!e.isAdult&&e.fatherId){const i=t.entities.entities[e.fatherId];if(i&&i.aiBlackboard)return i}return null}function u1(e,t){if(!e.aiBlackboard)return;const i=e.aiBlackboard.data,o=[];for(const l in i)if(l.startsWith("tribal_")){const s=i[l];s&&typeof s=="object"&&"startTime"in s&&t-s.startTime>$o&&o.push(l)}for(const l of o)C.delete(e.aiBlackboard,l)}class rr extends wn{constructor(i,o,l,s=0){super();Oe(this,"name");Oe(this,"depth");Oe(this,"registeredKey");this.child=i,this.config=o,this.name=l,this.depth=s,this.child.depth=(this.depth??0)+1,this.registeredKey=`${this.name}_registered`}execute(i,o,l){ot.nodeStart(this.name);try{const s=Sa(i,o.gameState);if(!s||!s.aiBlackboard){const[E,A]=Zt(this.child.execute(i,o,l));return this.setLastStatus(i,E),C.recordNodeExecution(l,this.name,E,o.gameState.time,this.depth,`No coordination: ${A}`),E}const u=o.gameState.time,d=C.get(l,this.registeredKey)??!1,f=this.getTaskTarget(i,o,l);if(!f)return this.setLastStatus(i,T.FAILURE),C.recordNodeExecution(l,this.name,T.FAILURE,u,this.depth,"No task target found"),T.FAILURE;const g=this.getTaskKey(f);if(d){const[E,A]=Zt(this.child.execute(i,o,l));return E===T.RUNNING?(this.refreshTaskTimestamp(s.aiBlackboard,g,i.id,u),this.setLastStatus(i,E),C.recordNodeExecution(l,this.name,E,u,this.depth,`Continuing: ${A}`),E):(this.removeFromTask(s.aiBlackboard,g,i.id),C.delete(l,this.registeredKey),this.setLastStatus(i,E),C.recordNodeExecution(l,this.name,E,u,this.depth,`Completed: ${A}`),E)}if(!this.canJoinTask(s.aiBlackboard,g,i.id,u)){this.setLastStatus(i,T.FAILURE);const E=C.get(s.aiBlackboard,g),A=(E==null?void 0:E.memberIds.length)??0,w=this.config.maxCapacity??1;return C.recordNodeExecution(l,this.name,T.FAILURE,u,this.depth,`Task full: ${A}/${w}`),T.FAILURE}if(!this.registerTask(s.aiBlackboard,g,i.id,u))return this.setLastStatus(i,T.FAILURE),C.recordNodeExecution(l,this.name,T.FAILURE,u,this.depth,"Failed to register task"),T.FAILURE;C.set(l,this.registeredKey,!0);const[y,I]=Zt(this.child.execute(i,o,l));if(y===T.RUNNING){this.setLastStatus(i,y);const E=C.get(s.aiBlackboard,g),A=(E==null?void 0:E.memberIds.length)??0,w=this.config.maxCapacity??1;return C.recordNodeExecution(l,this.name,y,u,this.depth,`Started (${A}/${w}): ${I}`),y}else return this.removeFromTask(s.aiBlackboard,g,i.id),C.delete(l,this.registeredKey),this.setLastStatus(i,y),C.recordNodeExecution(l,this.name,y,u,this.depth,`Immediate result: ${I}`),y}finally{ot.nodeEnd()}}getTaskTarget(i,o,l){var u,d,f,g;if(this.config.taskType==="procreation")return((d=(u=this.config).getTargetId)==null?void 0:d.call(u,i,o,l))??null;const s=(g=(f=this.config).getTargetId)==null?void 0:g.call(f,i,o,l);return s??null}getTaskKey(i){return this.config.generateTaskKey?this.config.generateTaskKey(this.config.taskType,i):`tribal_${this.config.taskType}_${i}`}canJoinTask(i,o,l,s){const u=C.get(i,o);if(!u||s-u.startTime>$o||u.memberIds.includes(l))return!0;const d=this.config.maxCapacity??1;return u.memberIds.length<d}registerTask(i,o,l,s){let u=C.get(i,o);return u?s-u.startTime>$o?(u={memberIds:[l],startTime:s,maxCapacity:this.config.maxCapacity??1},C.set(i,o,u),!0):u.memberIds.length>=(this.config.maxCapacity??1)?!!u.memberIds.includes(l):(u.memberIds.includes(l)||(u.memberIds.push(l),C.set(i,o,u)),!0):(u={memberIds:[l],startTime:s,maxCapacity:this.config.maxCapacity??1},C.set(i,o,u),!0)}refreshTaskTimestamp(i,o,l,s){const u=C.get(i,o);u&&u.memberIds.includes(l)&&(u.startTime=s,C.set(i,o,u))}removeFromTask(i,o,l){const s=C.get(i,o);s&&(s.memberIds=s.memberIds.filter(u=>u!==l),s.memberIds.length===0?C.delete(i,o):C.set(i,o,s))}}function c1(e){return new Se([new re((t,i)=>{const o=t.hunger>=_f,l=t.food.length>0,s=!t.eatingCooldownTime||i.gameState.time>=t.eatingCooldownTime;return[!!(o&&l&&s),`${Math.floor(t.hunger-_f)}, ${t.food.length}, ${t.eatingCooldownTime?Math.floor(t.eatingCooldownTime-i.gameState.time):""}`]},"Can Eat",e+1),new ae(t=>(t.direction={x:0,y:0},t.target=void 0,t.activeAction="eating",T.RUNNING),"Eat",e+1)],"Eating",e)}function d1(e){return new Se([new re((t,i,o)=>{if(t.isAdult&&t.hitpoints>t.maxHitpoints*Ev||!(t.hitpoints<t.maxHitpoints*.1)&&t.isAdult&&t.hunger>PI)return!1;const s=nw(t.id,i.gameState);return s?(C.set(o,"fleeThreat",s.id),!0):!1},"Should Flee",e+1),new ae((t,i,o)=>{const l=C.get(o,"fleeThreat"),s=l&&i.gameState.entities.entities[l];if(!s)return T.FAILURE;t.activeAction="moving";const u=We(s.position,t.position,i.gameState.mapDimensions.width,i.gameState.mapDimensions.height),d=st(u),f=Un(t.position,Pt(d,wv));return t.target={x:(f.x%i.gameState.mapDimensions.width+i.gameState.mapDimensions.width)%i.gameState.mapDimensions.width,y:(f.y%i.gameState.mapDimensions.height+i.gameState.mapDimensions.height)%i.gameState.mapDimensions.height},t.direction=d,T.RUNNING},"Execute Flee",e+1)],"Flee",e)}const AS=100,f1=25;function A0(e){const t=Math.sin(e)*1e4;return t-Math.floor(t)}function h1(e,t,i=AS){return t.search.building.byRadius(e.position,i).some(s=>{const u=s;return u.buildingType==="storageSpot"&&u.ownerId===e.leaderId&&u.isConstructed&&u.storedFood&&u.storageCapacity&&u.storedFood.length<u.storageCapacity})}function g1(e,t,i=AS){return t.search.building.byRadius(e.position,i).filter(s=>{const u=s;return u.buildingType==="storageSpot"&&u.ownerId===e.leaderId&&u.isConstructed&&u.storedFood&&u.storedFood.length>0})}function p1(e,t,i){if(t.length===0)return null;let o=null,l=1/0;for(const s of t){const u=Y(e.position,s.position,i.mapDimensions.width,i.mapDimensions.height);u<l&&(l=u,o=s)}return o?{storage:o,distance:l}:null}function IS(e){const t=e.storedFood?e.storedFood.length:0,i=A0(t+e.id)*2*Math.PI,o=A0(t+e.id+1)*f1;return{x:Math.cos(i)*o,y:Math.sin(i)*o}}const vo="foodSource";function m1(e){const t=new ae((o,l,s)=>{const u=Sa(o,l.gameState),d=new Map,f=Ne(o,l.gameState,"berryBush",Bm,v=>{var A;if(v.food.length===0)return!1;if(u&&u.aiBlackboard){const w=`tribal_gather_${v.id}`,F=C.get(u.aiBlackboard,w);if(F&&l.gameState.time-F.startTime<=$o&&!F.memberIds.includes(o.id))return!1}const y=(A=l.gameState.search.building.byRadius(v.position,v.radius)[0])==null?void 0:A.ownerId,I=l.gameState.entities.entities[y];if(!I||I.leaderId===o.leaderId)return!0;const E=d.get(I.id)??Y(o.position,I.position,l.gameState.mapDimensions.width,l.gameState.mapDimensions.height);return d.set(I.id,E),E>qI}),g=Ne(o,l.gameState,"corpse",Bm,v=>{if(v.food.length===0)return!1;if(u&&u.aiBlackboard){const y=`tribal_gather_${v.id}`,I=C.get(u.aiBlackboard,y);if(I&&l.gameState.time-I.startTime<=$o&&!I.memberIds.includes(o.id))return!1}return!0});let m=null;if(f&&g){const v=Y(o.position,f.position,l.gameState.mapDimensions.width,l.gameState.mapDimensions.height),y=Y(o.position,g.position,l.gameState.mapDimensions.width,l.gameState.mapDimensions.height);m=v<=y?f:g}else m=f||g;return m?(C.set(s,vo,m.id),[T.SUCCESS,`Found food: ${m.type} at ${m.position.x.toFixed(0)},${m.position.y.toFixed(0)}`]):[T.FAILURE,"No food source found"]},"Find Closest Food Source",e+4),i=new rr(new ae((o,l,s)=>{const u=C.get(s,vo);if(!u)return[T.FAILURE,"No target in blackboard"];const d=l.gameState.entities.entities[u];return!d||d.food.length===0?(C.delete(s,vo),[T.FAILURE,"Food source is invalid or depleted"]):Y(o.position,d.position,l.gameState.mapDimensions.width,l.gameState.mapDimensions.height)<Ho?(o.activeAction="gathering",o.direction={x:0,y:0},o.target=d.id,C.delete(s,vo),[T.SUCCESS,`Gathering from ${d.type}`]):(o.activeAction="moving",o.target=d.id,o.direction=Ft(o.position,d.position,l.gameState.mapDimensions),[T.RUNNING,`Moving to ${d.type}`])},"Move To Food and Gather",e+3),{taskType:"gather",maxCapacity:2,getTargetId:(o,l,s)=>C.get(s,vo)??null},"Tribal Gather Task",e+3);return new Se([new re((o,l)=>{const s=o.food.length<o.maxFood,u=o.hunger>yI,d=un(l.gameState,o).filter(g=>g.hunger>Kf),f=h1(o,l.gameState);return[(o.isAdult&&s&&(u||d.length>0||f))??!1,`${u?"H":""}${d.length>0?" HC("+d.length+")":""}${f?" S":""}`]},"Should Gather Food",e+1),new qt([new Se([new re((o,l,s)=>C.has(s,vo),"Has Food Source?",e+2),i],"Continue Gathering Action",e+2),new Se([new Nr(t,FI,"Cache Food Source Search",e+3),i],"Find New Food Source and Gather",e+2)],"Perform or Start Gathering",e+1)],"Gather Food",e)}function v1(e){return new ae((t,i,o)=>(t.activeAction="idle",t.direction={x:0,y:0},t.target=void 0,C.set(o,"wanderTarget",void 0),T.SUCCESS),"Idle",e)}const Yl="procreationWanderStartTime",I0=(e,t,i)=>t.find(o=>zr(e,o,i)),E0={taskType:"procreation",maxCapacity:2,getTargetId:(e,t,i)=>C.get(i,"procreationPartner")??null};function S1(e){const t=new re((s,u,d)=>{const f=Vm(s,u.gameState,Ho),g=I0(s,f,u.gameState);return g?(C.set(d,"procreationPartner",g.id),!0):!1},"Find Immediate Partner"),i=new rr(new ae((s,u,d)=>{var m;const f=C.get(d,"procreationPartner"),g=f&&u.gameState.entities.entities[f];return g?(s.activeAction="procreating",s.target=void 0,C.delete(d,"procreationPartner"),C.delete(d,Yl),(m=s.partnerIds)!=null&&m.includes(g.id)||(s.partnerIds=s.partnerIds?[...s.partnerIds,g.id]:[g.id]),T.SUCCESS):T.FAILURE},"Start Procreating"),E0,"Tribal Start Procreating",e+2),o=new re((s,u,d)=>{const f=Vm(s,u.gameState,RI),g=I0(s,f,u.gameState);return g?(C.set(d,"procreationPartner",g.id),!0):!1},"Locate Distant Partner"),l=new rr(new ae((s,u,d)=>{const f=C.get(d,"procreationPartner"),g=f&&u.gameState.entities.entities[f];if(!g||g.isPregnant)return T.FAILURE;if(Y(s.position,g.position,u.gameState.mapDimensions.width,u.gameState.mapDimensions.height)<Ho)return T.SUCCESS;s.activeAction="moving",s.target=g.id;const v=We(s.position,g.position,u.gameState.mapDimensions.width,u.gameState.mapDimensions.height);return s.direction=st(v),T.RUNNING},"Move Towards Partner"),E0,"Tribal Move To Partner",e+3);return new Se([new re(s=>!(!s.isAdult||s.gender==="female"&&s.isPregnant||s.age<AE||s.gender==="female"&&s.age>Dv),"Is Fertile (age, not pregnant)",e+1),new re(s=>s.hunger<Gr,"Is Healthy (hunger)",e+1),new re(s=>(s.procreationCooldown||0)<=0,"Is Ready (cooldown)",e+1),new qt([new Se([new re((s,u)=>qm(s.position,u.gameState,"berryBush",Lm)>=CI,"Is Environment Viable (food)",e+3),new ae((s,u,d)=>(C.delete(d,Yl),T.SUCCESS),"Clear Wander Timer",e+3)],"Sufficient Food Path",e+2),new Se([new re((s,u)=>{if(s.gender==="male"){const d=un(u.gameState,s);return!xr(d)}return!1},"Is Male Without Heir",e+3),new ae((s,u,d)=>{const f=C.get(d,Yl);if(f===void 0)return C.set(d,Yl,u.gameState.time),[T.FAILURE,"Starting heirless wander timer"];const g=u.gameState.time-f;return g>=IE?qm(s.position,u.gameState,"berryBush",Lm)>=1?[T.SUCCESS,`Wandered for ${g.toFixed(1)}h, minimum food found`]:[T.FAILURE,"Desperate but no food sources nearby"]:[T.FAILURE,`Wandering for heir, ${g.toFixed(1)}h elapsed`]},"Check Wander Timer",e+3)],"Heirless Desperation Path",e+2)],"Check Environment Or Desperation",e+1),new re((s,u,d)=>{var g;const f=C.get(d,"procreationPartner");return f&&((g=f.partnerIds)!=null&&g.length)&&!f.partnerIds.includes(s.id)&&f.partnerIds.map(m=>u.gameState.entities.entities[m]).filter(m=>!!m).some(m=>Y(s.position,m.position,u.gameState.mapDimensions.width,u.gameState.mapDimensions.height)<ZI)?[!1,"Partner's primary partner is too close"]:!0},"Is Partner's Primary Partner Nearby",e+1),new qt([new Se([t,i],"Procreate With Immediate Partner",e+2),new or(kI,new Se([o,l],"Seek Distant Partner Action",e+3),"Seek Distant Partner Cooldown",e+2)],"Find Partner And Procreate",e+1)],"Procreate",e)}const So="attackTarget",wr="homeCenter",Jd=150;function y1(e){return new Se([new re((t,i,o)=>{if(!t.isAdult)return[!1,"Not an adult"];const{gameState:l}=i;if(t.activeAction==="attacking"&&t.attackTargetId){const u=l.entities.entities[t.attackTargetId];if(u&&u.hitpoints>0&&Y(t.position,u.position,l.mapDimensions.width,l.mapDimensions.height)<=Jd){if(C.set(o,So,u.id),!C.get(o,wr)){const d=t.leaderId?$r(t.leaderId,l):vu(t,l).length>0?Km(t,l):t.position;C.set(o,wr,d)}return!0}}const s=Ne(t,l,"human",Jd,u=>u.hitpoints>0&&Xo(t,u,l));if(s){C.set(o,So,s.id);const u=t.leaderId?$r(t.leaderId,l):vu(t,l).length>0?Km(t,l):t.position;return C.set(o,wr,u),!0}return C.set(o,So,void 0),C.set(o,wr,void 0),!1},"Find Attack Target",e+1),new ae((t,i,o)=>{const l=C.get(o,So),s=l&&i.gameState.entities.entities[l],u=C.get(o,wr);if(!s||!u)return T.FAILURE;const{gameState:d}=i;return Y(t.position,u,d.mapDimensions.width,d.mapDimensions.height)>Iv?(t.activeAction="idle",t.attackTargetId=void 0,C.set(o,So,void 0),C.set(o,wr,void 0),T.FAILURE):s.hitpoints<=0||Y(t.position,s.position,d.mapDimensions.width,d.mapDimensions.height)>Jd?(t.activeAction==="attacking"&&(t.activeAction="idle",t.attackTargetId=void 0),C.set(o,So,void 0),C.set(o,wr,void 0),T.SUCCESS):(t.activeAction==="attacking"&&t.attackTargetId===s.id||(t.activeAction="attacking",t.attackTargetId=s.id),T.RUNNING)},"Execute Attack",e+1)],"Attack",e)}const T1=(e,t,i)=>{const o=un(t.gameState,e).filter(u=>!u.isAdult);if(o.length===0)return T.FAILURE;let l=null,s=Kf;for(const u of o)u.hunger>=s&&(s=u.hunger,l=u);return l?(C.set(i,"targetChild",l.id),T.SUCCESS):T.FAILURE},A1=(e,t,i)=>{const o=C.get(i,"targetChild"),l=o&&t.gameState.entities.entities[o];return l?Y(e.position,l.position,t.gameState.mapDimensions.width,t.gameState.mapDimensions.height)>Zf?(e.activeAction="moving",e.target=l.id,e.direction=Ft(e.position,l.position,t.gameState.mapDimensions),T.RUNNING):(e.activeAction="feeding",e.target=void 0,C.set(i,"targetChild",void 0),T.SUCCESS):T.FAILURE};function I1(e){return new Se([new re(t=>(t.isAdult&&t.food.length>0&&(!t.feedChildCooldownTime||t.feedChildCooldownTime<=0))??!1,"Can Feed Child",e+1),new ae(T1,"Find Hungriest Child",e+1),new ae(A1,"Move To Child and Feed",e+1)],"Feed Child",e)}function E1(e){return new Se([new re(t=>!t.isAdult&&t.hunger>=Kf,"Is Hungry Child",e+1),new ae((t,i,o)=>{const l=YE(t,i.gameState);if(l.length===0)return T.FAILURE;const s=Ne(t,i.gameState,"human",RE,u=>l.some(d=>d.id===u.id)&&u.food.length>0);return s?(C.set(o,"targetParent",s.id),T.SUCCESS):T.FAILURE},"Find Parent With Food",e+1),new ae((t,i,o)=>{const l=C.get(o,"targetParent"),s=l&&i.gameState.entities.entities[l];if(!s)return T.FAILURE;const u=Y(t.position,s.position,i.gameState.mapDimensions.width,i.gameState.mapDimensions.height);return t.activeAction="idle",u<=Zf?(t.target=void 0,T.SUCCESS):(t.target=s.id,t.activeAction="moving",T.RUNNING)},"Move To Parent",e+1)],"Seek Food From Parent",e)}const yo="plantingSpot",xs="plantingZoneId",w1=50;function _1(e,t,i,o){const l=We(e,t,i,o);return Un(e,l)}function C1(e){const t=new ae((l,s,u)=>{const d=C.get(u,yo);if(!d)return C.delete(u,yo),C.delete(u,xs),[T.FAILURE,"Planting spot is missing"];if(bn(d,s.gameState,Hr,l.id))return C.delete(u,yo),C.delete(u,xs),[T.FAILURE,"Planting spot is occupied"];const f=_1(l.position,d,s.gameState.mapDimensions.width,s.gameState.mapDimensions.height),g=Y(l.position,f,s.gameState.mapDimensions.width,s.gameState.mapDimensions.height);return g>Ho?(l.activeAction="moving",l.target=f,l.direction=Ft(l.position,f,s.gameState.mapDimensions),[T.RUNNING,"Moving to planting spot: "+g.toFixed(2)+" units away"]):bn(d,s.gameState,Hr,l.id)?(C.delete(u,yo),C.delete(u,xs),[T.FAILURE,"Planting spot is now occupied"]):(l.activeAction="planting",l.target=d,[T.RUNNING,"Planting state initiated"])},"Move To Spot and Plant",e+4),i=new rr(t,{taskType:"plant",maxCapacity:2,proximityRadius:w1,getTargetId:(l,s,u)=>C.get(u,xs)??null},"Coordinated Planting",e+3),o=new ae((l,s,u)=>{const d=rC(l,s.gameState);return d?(C.set(u,yo,d.position),C.set(u,xs,d.zoneId),[T.SUCCESS,`Found new spot at ${d.position.x.toFixed(0)}, ${d.position.y.toFixed(0)} (Zone ${d.zoneId})`]):[T.FAILURE,"No suitable planting spot found"]},"Find Optimal Planting Spot",e+3);return new Se([new re(l=>{const s=l.food.filter(f=>f.type===Bn.Berry).length>=Br,u=l.hunger<TI,d=(l.isAdult&&s&&u)??!1;return[d,d?"Can plant":`Cannot plant: adult=${l.isAdult}, berries=${l.food.filter(f=>f.type===Bn.Berry).length}/${Br}, hunger=${l.hunger.toFixed(0)}`]},"Can Plant",e+1),new re((l,s)=>{if(!l.leaderId)return[!1,"No tribe"];const u=Z_(l,s.gameState),d=lS(l.leaderId,s.gameState);let f;return u<JI?f=nE:u<eE?f=iE:u<tE?f=rE:f=oE,[d<f,`Food security: ${(u*100).toFixed(0)}%, Bush density: ${d.toFixed(1)}/${f}`]},"Needs More Bushes (Adaptive)",e+1),new re((l,s)=>{if(!l.leaderId)return[!0,"No tribe coordination needed"];const u=Hn(l,s.gameState),d=uS(l.leaderId,s.gameState,"planting"),f=Math.max(1,Math.ceil(u.length*.3));return[d<f,`Active planters: ${d}/${f}`]},"Not Too Many Planters",e+1),new qt([new Se([new re((l,s,u)=>C.has(u,yo),"Has Planting Spot?",e+2),i],"Continue Planting Action",e+2),new or(MI,o,"Find Planting Spot Cooldown",e+2)],"Perform or Start Planting",e+1)],"Plant Bush",e)}const w0="lastDepositTime",To="assignedStorageSpot";function R1(e){return new qt([new Se([new re((t,i,o)=>{const l=C.get(o,w0)||0,s=i.gameState.time-l;if(s<Hm)return[!1,`Cooldown: ${(Hm-s).toFixed(1)}h remaining`];if(!t.isAdult)return[!1,"Not an adult"];if(!t.leaderId)return[!1,"No tribe"];const u=aS(t.leaderId,i.gameState);let d;u<.3?d=sE:u<.7?d=aE:d=lE;const f=t.food.length/t.maxFood;if(f<=d)return[!1,`Food ${(f*100).toFixed(0)}% < threshold ${(d*100).toFixed(0)}%`];const g=iC(t,i.gameState);return g?(C.set(o,To,g.id),[!0,`Storage util: ${(u*100).toFixed(0)}%, Personal: ${(f*100).toFixed(0)}%`]):[!1,"No available tribe storage nearby"]},"Check for Excess Food and Storage",e+1),new re((t,i)=>{if(!t.leaderId)return[!0,"No tribe coordination needed"];const o=uS(t.leaderId,i.gameState,"depositing"),l=Hn(t,i.gameState),s=Math.max(1,Math.ceil(l.length*.4));return[o<s,`Active depositors: ${o}/${s}`]},"Not Too Many Depositors",e+1),new rr(new ae((t,i,o)=>{var d;const l=C.get(o,To);if(!l)return[T.FAILURE,"No storage assigned"];const s=i.gameState.entities.entities[l];if(!s)return C.delete(o,To),[T.FAILURE,"Storage entity missing"];if((((d=s.storedFood)==null?void 0:d.length)??0)>=(s.storageCapacity??0))return C.delete(o,To),[T.FAILURE,"Storage full"];const u=Y(t.position,s.position,i.gameState.mapDimensions.width,i.gameState.mapDimensions.height);return u<=In?(t.activeAction="depositing",t.target=void 0,C.set(o,w0,i.gameState.time),C.delete(o,To),[T.SUCCESS,"Depositing food"]):(t.activeAction="moving",t.target=s.position,[T.RUNNING,`Moving to storage (${u.toFixed(1)}px away)`])},"Navigate to Storage and Deposit",e+2),{taskType:"storage",maxCapacity:TS,storageAction:"deposit",getTargetId:(t,i,o)=>C.get(o,To)??null},"Tribal Storage Deposit Task",e+1)],"Deposit Sequence",e)],"Storage Deposit Behavior",e)}const jl="retrievalStorageId";function P1(e){return new qt([new Se([new re((t,i,o)=>{if(t.hunger<=_f)return[!1,"Not hungry enough"];if(t.food.length>=t.maxFood)return[!1,"Inventory full"];const l=g1(t,i.gameState),s=p1(t,l,i.gameState),u=s==null?void 0:s.storage;return u?(C.set(o,jl,u.id),[!0,`Storage with food found at distance ${s.distance.toFixed(1)}`]):[!1,"No tribe storage with food nearby"]},"Check for Hunger and Storage Food",e+1),new rr(new ae((t,i,o)=>{const l=C.get(o,jl);if(!l)return[T.FAILURE,"No storage target"];const s=i.gameState.entities.entities[l];if(!s)return C.delete(o,jl),[T.FAILURE,"Storage not found"];const u=Y(t.position,s.position,i.gameState.mapDimensions.width,i.gameState.mapDimensions.height);return u<=In?(t.activeAction="retrieving",t.target=void 0,[T.SUCCESS,"Retrieving food"]):(t.activeAction="moving",t.target=s.position,[T.RUNNING,`Moving to storage (${u.toFixed(1)}px away)`])},"Navigate to Storage and Retrieve",e+2),{taskType:"storage",maxCapacity:TS,storageAction:"retrieve",getTargetId:(t,i,o)=>C.get(o,jl)??null},"Coordinated Storage Retrieve",e+1)],"Retrieve Sequence",e)],"Storage Retrieve Behavior",e)}function N1(e){return new qt([new Se([new re((t,i,o)=>{if(!t.isAdult)return[!1,"Not an adult"];if(t.food.length>=t.maxFood)return[!1,"Inventory full"];if(!t.leaderId)return[!1,"No tribe leader"];const l=i.gameState.entities.entities[t.leaderId];if(!l||!l.diplomacy)return[!1,"No diplomacy info"];const d=i.gameState.search.building.byRadius(t.position,150).find(f=>{const g=f;if(g.buildingType!=="storageSpot"||!g.isConstructed||!g.storedFood||g.storedFood.length===0||g.ownerId===t.leaderId||l.diplomacy[g.ownerId]!==mt.Hostile)return!1;const v=Hn({leaderId:g.ownerId},i.gameState);for(const y of v)if(Y(t.position,y.position,i.gameState.mapDimensions.width,i.gameState.mapDimensions.height)<=Df)return!1;return!0});return d?[!0,`Undefended enemy storage found at distance ${Y(t.position,d.position,i.gameState.mapDimensions.width,i.gameState.mapDimensions.height).toFixed(1)}`]:[!1,"No undefended enemy storage nearby"]},"Check for Undefended Enemy Storage",e+1),new ae((t,i,o)=>{if(!t.leaderId)return[T.FAILURE,"No tribe leader"];const l=i.gameState.entities.entities[t.leaderId];if(!l||!l.diplomacy)return[T.FAILURE,"No diplomacy info"];const d=i.gameState.search.building.byRadius(t.position,150).filter(m=>{const v=m;if(v.buildingType!=="storageSpot"||!v.isConstructed||!v.storedFood||v.storedFood.length===0||v.ownerId===t.leaderId||l.diplomacy[v.ownerId]!==mt.Hostile)return!1;const I=Hn({leaderId:v.ownerId},i.gameState);for(const E of I)if(Y(t.position,E.position,i.gameState.mapDimensions.width,i.gameState.mapDimensions.height)<=Df)return!1;return!0});if(d.length===0)return[T.FAILURE,"No undefended storage available"];let f=null,g=1/0;for(const m of d){const v=Y(t.position,m.position,i.gameState.mapDimensions.width,i.gameState.mapDimensions.height);v<g&&(g=v,f=m)}return f?g<=In?(t.activeAction="idle",t.target=void 0,[T.SUCCESS,"Stealing food"]):(t.activeAction="moving",t.target=f.position,[T.RUNNING,`Moving to enemy storage (${g.toFixed(1)}px away)`]):[T.FAILURE,"No storage found"]},"Navigate to Enemy Storage and Steal",e+1)],"Steal Sequence",e)],"Storage Steal Behavior",e)}const ef="enemiesNearby";function D1(e){const t=new re(s=>s.id===s.leaderId,"Is Leader?",e+1),i=new re(s=>!s.isCallingToAttack,"Is Not Already Calling?",e+1),o=new ae((s,u,d)=>{const f=nh(s,u.gameState,eS);return f.length>0?(C.set(d,ef,f.map(g=>g.id)),T.SUCCESS):T.FAILURE},"Find Nearby Enemies",e+1),l=new qt([new Se([new re((s,u,d)=>{const f=C.get(d,ef),g=f==null?void 0:f.map(I=>u.gameState.entities.entities[I]).filter(I=>!!I);if(!g||g.length===0)return!1;const m=da(s.id,u.gameState),v=Su(m),y=Su(g);return v>y*zI},"Is Strong Enough?",e+3),new ae((s,u)=>(s.isCallingToAttack=!0,s.callToAttackEndTime=u.gameState.time+xo,ke(u.gameState,ce.CallToAttack,s.position,xo),Ie(u,fe.CallToAttack,s.position),s.activeAction="idle",s.target=void 0,T.SUCCESS),"Issue Call to Attack",e+3)],"Attack",e+2),new ae((s,u,d)=>{const f=C.get(d,ef),g=f==null?void 0:f.map(A=>u.gameState.entities.entities[A]).filter(A=>!!A);if(!g||g.length===0)return T.FAILURE;const m=g.map(A=>A.position),v=mu(m),y=We(v,s.position,u.gameState.mapDimensions.width,u.gameState.mapDimensions.height),I=st(y),E=Un(s.position,Pt(I,wv*2));return s.activeAction="moving",s.target={x:(E.x%u.gameState.mapDimensions.width+u.gameState.mapDimensions.width)%u.gameState.mapDimensions.width,y:(E.y%u.gameState.mapDimensions.height+u.gameState.mapDimensions.height)%u.gameState.mapDimensions.height},s.direction=I,T.SUCCESS},"Retreat",e+2)],"Attack or Retreat",e+2);return new Se([t,i,o,new or(WI,l,"Leader Combat Cooldown",e+1)],"Leader Combat Strategy",e)}const tf="combatTarget",nf="homeCenter";function O1(e){const t=new re(u=>u.isAdult&&u.leaderId?u.id!==u.leaderId:!1,"Is Tribe Follower?",e+1),i=new re(u=>u.hunger<AI&&u.hitpoints>=u.maxHitpoints*Ev,"Is Fit for Combat?",e+1),o=new re((u,d)=>{const f=d.gameState.entities.entities[u.leaderId];return!!(f!=null&&f.isCallingToAttack)},"Is Leader Calling to Attack?",e+1),l=new ae((u,d,f)=>{const{gameState:g}=d,m=g.entities.entities[u.leaderId];if(!m)return T.FAILURE;const v=nh(m,g,NI);if(v.length===0)return T.FAILURE;v.sort((y,I)=>{const E=Y(u.position,y.position,g.mapDimensions.width,g.mapDimensions.height),A=Y(u.position,I.position,g.mapDimensions.width,g.mapDimensions.height);return E-A});for(const y of v)if(JE(m.id,y.id,g)<DI){C.set(f,tf,y.id);const E=$r(m.id,g);return C.set(f,nf,E),T.SUCCESS}return T.FAILURE},"Find Best Target",e+1),s=new ae((u,d,f)=>{const g=C.get(f,tf),m=g&&d.gameState.entities.entities[g],v=C.get(f,nf);if(!m||!v)return T.FAILURE;const{gameState:y}=d;return Y(u.position,v,y.mapDimensions.width,y.mapDimensions.height)>Iv?(u.activeAction==="attacking"&&u.attackTargetId===m.id&&(u.activeAction="idle",u.attackTargetId=void 0),C.set(f,tf,void 0),C.set(f,nf,void 0),T.FAILURE):((!u.lastTargetAcquiredEffectTime||d.gameState.time-u.lastTargetAcquiredEffectTime>xe*5)&&(ke(d.gameState,ce.TargetAcquired,u.position,xe,u.id),u.lastTargetAcquiredEffectTime=d.gameState.time),u.activeAction="attacking",u.attackTargetId=m.id,u.target=void 0,T.RUNNING)},"Attack Target",e+1);return new Se([t,i,o,l,s],"Tribe Member Combat",e)}function k1(e,t,i,o,l,s,u){const d=u.mapDimensions.width,f=u.mapDimensions.height,g=Math.PI/8,v=i*2/(2*Math.PI);let y=0,I=0;for(;I<=t;){const E=e.x+I*Math.cos(y),A=e.y+I*Math.sin(y),w={x:(E%d+d)%d,y:(A%f+f)%f};if(dh(w,l,s,u)&&!rw(w,void 0,o,u))return w;y+=g,I=v*y}}class M1 extends wn{constructor(t){super(),this.name="Leader Building Placement",this.depth=t}execute(t,i,o){if(!t.leaderId||t.leaderId!==t.id)return[T.FAILURE,"Not a tribe leader"];const s=Hn(t,i.gameState).filter(H=>H.isAdult);if(s.length<Gm)return[T.FAILURE,`Tribe too small: ${s.length}/${Gm} adults`];const u=Ia(t.leaderId,i.gameState),d=fh(t,i.gameState),f=aS(t.leaderId,i.gameState),g=lS(t.leaderId,i.gameState),m=Math.ceil(s.length*(1+dE)),v=u.length===0,y=u.length<zm&&(v||f>xm||f*(m/s.length)>xm),I=g*(s.length/m),E=d.length<Wm&&(g<$m||I<$m);let A=null,w="";if(y&&E?v?(A=Tn.StorageSpot,w="Bootstrap: First storage spot for tribe"):f>.85?(A=Tn.StorageSpot,w=`High storage utilization: ${(f*100).toFixed(0)}% (projected: ${m} adults)`):(A=Tn.PlantingZone,w=`Low bush density: ${g.toFixed(1)} bushes/member (projected: ${I.toFixed(1)})`):y?v?(A=Tn.StorageSpot,w="Bootstrap: First storage spot for tribe"):(A=Tn.StorageSpot,w=`Storage utilization: ${(f*100).toFixed(0)}% (projected: ${m} adults)`):E&&(A=Tn.PlantingZone,w=`Bush density: ${g.toFixed(1)} bushes/member (projected: ${I.toFixed(1)} for ${m} adults)`),!A)return[T.FAILURE,`No building needed. Storage: ${u.length}/${zm} (${(f*100).toFixed(0)}%), Planting: ${d.length}/${Wm} (${g.toFixed(1)} bushes/member)`];const F=v?hE:fE,B=$r(t.leaderId,i.gameState),D=k1(B,bm,cE,F,A,t.id,i.gameState);return D?(sS(D,A,t.id,i.gameState),[T.SUCCESS,`Placed ${A} at (${D.x.toFixed(0)}, ${D.y.toFixed(0)}). Reason: ${w}`]):[T.FAILURE,`No valid location found for ${A} within ${bm}px of tribe center`]}}function F1(e){return new M1(e)}const xi="takeOverBuildingTarget";function L1(e){const t=new Se([new re((i,o,l)=>{if(!i.leaderId||i.leaderId!==i.id)return[!1,"Not a tribe leader"];const s=C.get(l,xi);if(s){const d=o.gameState.entities.entities[s];if(d&&d.type==="building"&&Fn(i,d,o.gameState))return[!0,`Continuing to target building ${s}`];C.delete(l,xi)}const u=Ne(i,o.gameState,"building",Cv,d=>Fn(i,d,o.gameState)&&d.isConstructed);return u?(C.set(l,xi,u.id),[!0,`Found enemy building at distance ${Y(i.position,u.position,o.gameState.mapDimensions.width,o.gameState.mapDimensions.height).toFixed(0)}px`]):[!1,"No enemy buildings found within range"]},"Find Enemy Building to Take Over",e+2),new ae((i,o,l)=>{const s=C.get(l,xi);if(!s)return T.FAILURE;const u=o.gameState.entities.entities[s];return!u||u.type!=="building"||!Fn(i,u,o.gameState)?(C.delete(l,xi),i.activeAction="idle",i.target=void 0,T.FAILURE):Y(i.position,u.position,o.gameState.mapDimensions.width,o.gameState.mapDimensions.height)<vt?(i.activeAction="idle",i.target=void 0,T.SUCCESS):(i.activeAction="moving",i.target=u.id,T.RUNNING)},"Move to Enemy Building",e+2),new ae((i,o,l)=>{const s=C.get(l,xi);if(!s)return T.FAILURE;const u=o.gameState.entities.entities[s];return!u||u.type!=="building"||!Fn(i,u,o.gameState)?(C.delete(l,xi),T.FAILURE):(i.activeAction="takingOverBuilding",i.target=u.id,C.delete(l,xi),T.SUCCESS)},"Initiate Building Takeover",e+2)],"Take Over Building Action",e+1);return new or(_v,t,"Take Over Building Cooldown",e)}const $i="removeEnemyBuildingTarget";function U1(e){const t=new Se([new re((i,o,l)=>{if(!i.leaderId||i.leaderId!==i.id)return[!1,"Not a tribe leader"];const s=C.get(l,$i);if(s){const d=o.gameState.entities.entities[s];if(d&&d.type==="building"&&Fn(i,d,o.gameState))return[!0,`Continuing to target building ${s}`];C.delete(l,$i)}const u=Ne(i,o.gameState,"building",Cv,d=>Fn(i,d,o.gameState)&&d.isConstructed);return u?(C.set(l,$i,u.id),[!0,`Found enemy building at distance ${Y(i.position,u.position,o.gameState.mapDimensions.width,o.gameState.mapDimensions.height).toFixed(0)}px`]):[!1,"No enemy buildings found within range"]},"Find Enemy Building to Destroy",e+2),new ae((i,o,l)=>{const s=C.get(l,$i);if(!s)return T.FAILURE;const u=o.gameState.entities.entities[s];return!u||u.type!=="building"||!Fn(i,u,o.gameState)?(C.delete(l,$i),i.activeAction="idle",i.target=void 0,T.FAILURE):Y(i.position,u.position,o.gameState.mapDimensions.width,o.gameState.mapDimensions.height)<vt?(i.activeAction="idle",i.target=void 0,T.SUCCESS):(i.activeAction="moving",i.target=u.id,T.RUNNING)},"Move to Enemy Building",e+2),new ae((i,o,l)=>{const s=C.get(l,$i);if(!s)return T.FAILURE;const u=o.gameState.entities.entities[s];return!u||u.type!=="building"||!Fn(i,u,o.gameState)?(C.delete(l,$i),T.FAILURE):(i.activeAction="destroyingBuilding",i.target=u.id,C.delete(l,$i),T.SUCCESS)},"Initiate Building Destruction",e+2)],"Remove Enemy Building Action",e+1);return new or(_v,t,"Remove Enemy Building Cooldown",e)}function B1(e){return new Se([new ae((t,i,o)=>{const l=VE(t,i.gameState);return l?(C.set(o,"patriarchTarget",l.id),[T.SUCCESS,`Found patriarch: ${l.id}`]):(C.delete(o,"patriarchTarget"),[T.FAILURE,"No patriarch found"])},"Find Patriarch",e+1),new ae((t,i,o)=>{const l=C.get(o,"patriarchTarget"),s=l&&i.gameState.entities.entities[l];if(!s)return[T.FAILURE,"Patriarch target missing from blackboard"];const u=Y(t.position,s.position,i.gameState.mapDimensions.width,i.gameState.mapDimensions.height);if(u>Av){t.activeAction="moving",t.target=s.id;const d=We(t.position,s.position,i.gameState.mapDimensions.width,i.gameState.mapDimensions.height);return t.direction=st(d),[T.RUNNING,`Moving to patriarch at ${u.toFixed(0)}`]}return t.activeAction="idle",t.target=void 0,t.direction={x:0,y:0},[T.SUCCESS,`Arrived at patriarch at ${u.toFixed(0)}`]},"Move Towards Patriarch",e+1)],"Follow Patriarch",e)}const Vl="tribeSplitMigrationTarget";function H1(e){const t=new Se([new re((i,o,l)=>{if(C.get(l,Vl))return[!0,"Already migrating"];const{canSplit:u,progress:d}=Lu(i,o.gameState);return u?[!0,`Progress: ${(d??0)*100}%`]:[!1,"Cannot split"]},"Can Split Tribe?",e+2),new ae((i,o,l)=>{const{gameState:s}=o;let u=C.get(l,Vl);if(!u){if(!i.leaderId)return T.FAILURE;const f=s.entities.entities[i.leaderId];if(!f)return T.FAILURE;const g=L_(f.position,i,s);if(g)C.set(l,Vl,g),u=g;else return T.FAILURE}return Y(i.position,u,s.mapDimensions.width,s.mapDimensions.height)<Ho?(C.delete(l,Vl),i.activeAction="idle",i.target=void 0,T.SUCCESS):(i.activeAction="moving",i.target=u,T.RUNNING)},"Move to New Territory",e+2),new ae((i,o)=>(uh(i,o.gameState),T.SUCCESS),"Perform Tribe Split",e+2)],"Tribe Split Action",e+1);return new or(g_,t,"Tribe Split Cooldown",e)}const Xl="jealousyAttackTarget";function b1(e){return new Se([new re((t,i,o)=>{if(!t.isAdult)return[!1,"Not an adult"];const l=ZE(t,i.gameState,YI);return l?t.leaderId&&l.id===t.leaderId?[!1,"Stranger is in same tribe - no attack"]:(C.set(o,Xl,l.id),[!0,`Partner cheating with ${l.id}`]):(C.delete(o,Xl),!1)},"Check for Infidelity",e+1),new ae((t,i,o)=>{const l=C.get(o,Xl),s=l&&i.gameState.entities.entities[l];return!s||s.hitpoints<=0?(C.delete(o,Xl),[T.FAILURE,"Target is invalid or dead"]):t.activeAction==="attacking"&&t.attackTargetId===s.id?T.RUNNING:(t.activeAction="attacking",t.attackTargetId=s.id,[T.RUNNING,`Attacking ${s.id}`])},"Execute Jealousy Attack",e+1)],"Jealousy Attack",e)}const Kl="defendAggressor";function G1(e){return new Se([new re((t,i,o)=>{if(!t.isAdult)return[!1,"Not an adult"];const l=qE(t,i.gameState,jI);return l?(C.set(o,Kl,l.aggressor.id),[!0,`Family member ${l.familyMember.id} attacked by ${l.aggressor.id}`]):(C.delete(o,Kl),!1)},"Check Family Under Attack",e+1),new ae((t,i,o)=>{const l=C.get(o,Kl),s=l&&i.gameState.entities.entities[l];return!s||s.hitpoints<=0?(C.delete(o,Kl),[T.FAILURE,"Target invalid/dead"]):t.activeAction==="attacking"&&t.attackTargetId===s.id?T.RUNNING:(t.activeAction="attacking",t.attackTargetId=s.id,[T.RUNNING,`Attacking aggressor ${s.id}`])},"Execute Family Defense Attack",e+1)],"Defend Family",e)}const Zl="desperateAttackTarget";function x1(e){return new Se([new re(t=>t.hunger>VI,"Is Starving",e+1),new re((t,i)=>{if(!t.isAdult)return[!1,"Not an adult"];const o=Ne(t,i.gameState,"berryBush",vt,s=>s.food.length>0),l=Ne(t,i.gameState,"corpse",vt,s=>s.food.length>0);return!o&&!l},"No Other Food Available",e+1),new re((t,i,o)=>{const l=QE(t,i.gameState);return l?(C.set(o,Zl,l.id),[!0,`Found weak target ${l.id}`]):(C.delete(o,Zl),!1)},"Find Weak Target",e+1),new ae((t,i,o)=>{const l=C.get(o,Zl),s=l&&i.gameState.entities.entities[l];return!s||s.hitpoints<=0?(C.delete(o,Zl),[T.FAILURE,"Target is invalid or dead"]):t.activeAction==="attacking"&&t.attackTargetId===s.id?T.RUNNING:(t.activeAction="attacking",t.attackTargetId=s.id,[T.RUNNING,`Desperately attacking ${s.id}`])},"Execute Desperate Attack",e+1)],"Desperate Attack",e)}function $1(e,t,i,o){const l=e.entities.entities[i.targetEntityId];return!l||!("hitpoints"in l)||l.hitpoints<=0?(e.autopilotControls.activeAutopilotAction=void 0,T.FAILURE):Y(t.position,l.position,e.mapDimensions.width,e.mapDimensions.height)<=cu?(t.activeAction="attacking",t.attackTargetId=l.id,e.autopilotControls.activeAutopilotAction=void 0,T.SUCCESS):(t.activeAction="moving",t.target=l.id,t.direction=Ft(t.position,l.position,e.mapDimensions),T.RUNNING)}function z1(e){return new Se([new re((t,i)=>t.isPlayer===!0&&!!i.gameState.autopilotControls.activeAutopilotAction,"Has Player Command",e+1),new ae((t,i)=>{var s;const{gameState:o}=i,l=o.autopilotControls.activeAutopilotAction;if(!l)return T.FAILURE;switch(l.action){case se.AutopilotMove:{const u=l.position;return Y(t.position,u,o.mapDimensions.width,o.mapDimensions.height)<QI?(o.autopilotControls.activeAutopilotAction=void 0,t.activeAction==="moving"&&(t.activeAction="idle",t.target=void 0),T.SUCCESS):(t.activeAction="moving",t.target=u,t.direction=Ft(t.position,u,o.mapDimensions),T.RUNNING)}case se.AutopilotGather:{const u=o.entities.entities[l.targetEntityId];return!u||u.food.length===0?(o.autopilotControls.activeAutopilotAction=void 0,T.FAILURE):Y(t.position,u.position,o.mapDimensions.width,o.mapDimensions.height)>Ho?(t.activeAction="moving",t.target=u.id,t.direction=Ft(t.position,u.position,o.mapDimensions),T.RUNNING):(t.activeAction="gathering",t.target=u.id,o.autopilotControls.activeAutopilotAction=void 0,T.SUCCESS)}case se.AutopilotAttack:return $1(o,t,l);case se.AutopilotProcreate:{const u=o.entities.entities[l.targetEntityId];return!u||u.type!=="human"||!zr(t,u,i.gameState)?(o.autopilotControls.activeAutopilotAction=void 0,T.FAILURE):Y(t.position,u.position,o.mapDimensions.width,o.mapDimensions.height)<=cu?(t.activeAction="procreating",o.autopilotControls.activeAutopilotAction=void 0,T.SUCCESS):(t.activeAction="moving",t.target=u.id,t.direction=Ft(t.position,u.position,o.mapDimensions),T.RUNNING)}case se.AutopilotPlant:{if(t.activeAction==="planting")return T.RUNNING;const u=l.position;return bn(u,o,Hr,t.id)?(o.autopilotControls.activeAutopilotAction=void 0,T.FAILURE):Y(t.position,u,o.mapDimensions.width,o.mapDimensions.height)<=cu?(t.activeAction="planting",t.target=u,o.autopilotControls.activeAutopilotAction=void 0,o.hasPlayerPlantedBush=!0,T.RUNNING):(t.activeAction="moving",t.target=u,t.direction=Ft(t.position,u,o.mapDimensions),T.RUNNING)}case se.AutopilotFeedChild:{const u=o.entities.entities[l.targetEntityId];return!u||u.type!=="human"||u.isAdult||t.food.length===0?(o.autopilotControls.activeAutopilotAction=void 0,T.FAILURE):Y(t.position,u.position,o.mapDimensions.width,o.mapDimensions.height)<=cu?(o.autopilotControls.activeAutopilotAction=void 0,t.activeAction="feeding",T.SUCCESS):(t.activeAction="moving",t.target=u.id,t.direction=Ft(t.position,u.position,o.mapDimensions),T.RUNNING)}case se.AutopilotDeposit:{const u=o.entities.entities[l.targetEntityId];if(!u||u.buildingType!=="storageSpot"||!u.isConstructed)return o.autopilotControls.activeAutopilotAction=void 0,T.FAILURE;const d=u.storageCapacity??0;return(((s=u.storedFood)==null?void 0:s.length)??0)>=d||t.leaderId!==u.ownerId||t.food.length===0?(o.autopilotControls.activeAutopilotAction=void 0,T.FAILURE):Y(t.position,u.position,o.mapDimensions.width,o.mapDimensions.height)<=In?(t.activeAction="depositing",t.target=void 0,o.autopilotControls.activeAutopilotAction=void 0,T.SUCCESS):(t.activeAction="moving",t.target=u.id,t.direction=Ft(t.position,u.position,o.mapDimensions),T.RUNNING)}case se.AutopilotRetrieve:{const u=o.entities.entities[l.targetEntityId];return!u||u.buildingType!=="storageSpot"||!u.isConstructed||!u.storedFood||u.storedFood.length===0||t.leaderId!==u.ownerId||t.food.length>=t.maxFood?(o.autopilotControls.activeAutopilotAction=void 0,T.FAILURE):Y(t.position,u.position,o.mapDimensions.width,o.mapDimensions.height)<=In?(t.activeAction="retrieving",t.target=void 0,o.autopilotControls.activeAutopilotAction=void 0,T.SUCCESS):(t.activeAction="moving",t.target=u.id,t.direction=Ft(t.position,u.position,o.mapDimensions),T.RUNNING)}case se.AutopilotFollowMe:{const u=o.entities.entities[l.targetEntityId];return!u||u.type!=="human"||u.id!==u.leaderId?(o.autopilotControls.activeAutopilotAction=void 0,T.FAILURE):Y(t.position,u.position,o.mapDimensions.width,o.mapDimensions.height)<=Av?(o.autopilotControls.activeAutopilotAction=void 0,t.activeAction==="moving"&&(t.activeAction="idle"),T.SUCCESS):(t.activeAction="moving",t.target=u.id,t.direction=Ft(t.position,u.position,o.mapDimensions),T.RUNNING)}default:return o.autopilotControls.activeAutopilotAction=void 0,T.FAILURE}},"Execute Player Command",e+1)],"Player Command Handler",e)}function W1(e){return new Se([new re(t=>!!t.leaderId&&t.leaderId!==t.id,"Is Follower",e+1),new re((t,i)=>{if(!t.leaderId)return!1;const o=i.gameState.entities.entities[t.leaderId];return!!o&&o.isCallingToFollow===!0},"Is Leader Calling To Follow",e+1),new re(t=>t.hunger<_I,"Is Not Critically Hungry",e+1),new ae((t,i)=>{if(!t.leaderId)return T.FAILURE;const o=i.gameState.entities.entities[t.leaderId];return o?Y(t.position,o.position,i.gameState.mapDimensions.width,i.gameState.mapDimensions.height)>wI?(t.activeAction="moving",t.target=o.id,t.direction=Ft(t.position,o.position,i.gameState.mapDimensions),T.RUNNING):(t.activeAction==="moving"&&t.target===o.id&&(t.activeAction="idle",t.target=void 0),T.SUCCESS):T.FAILURE},"Execute Follow Leader",e+1)],"Follow Leader Command",e)}const _0="tribeMigrationCheckCooldown";function Y1(e){const t=new Se([new re(o=>!!o.leaderId&&o.leaderId===o.id,"Is Tribe Leader",e+2),new re((o,l)=>{const s=C.get(o.aiBlackboard,_0);return s?l.gameState.time-s>=Um:!0},"Is Migration Check Cooldown Over",e+2),new ae((o,l)=>{o.aiBlackboard&&C.set(o.aiBlackboard,_0,l.gameState.time);const s=ew(o,l.gameState);return s?(o.isCallingToFollow=!0,o.callToFollowEndTime=l.gameState.time+fa,o.target=s,o.activeAction="moving",T.SUCCESS):T.FAILURE},"Execute Tribe Migration",e+2)],"Tribe Migration Strategy",e+1),i=new Nr(t,uu,"Cache Tribe Migration",e+1);return new or(Um,i,"Tribe Migration Cooldown",e)}function j1(e){const t=new re(o=>o.id===o.leaderId,"Is Leader?",e+1),i=new ae((o,l)=>{var g;const{gameState:s}=l,u=da(o.id,s),d=Su(u),f=Lv(s).filter(m=>m.leaderId!==o.id);for(const m of f){const v=da(m.leaderId,s),y=Su(v),I=((g=o.diplomacy)==null?void 0:g[m.leaderId])||mt.Friendly;d>y*$I?I!==mt.Hostile&&o.diplomacy&&(o.diplomacy[m.leaderId]=mt.Hostile):I!==mt.Friendly&&o.diplomacy&&(o.diplomacy[m.leaderId]=mt.Friendly)}return T.SUCCESS},"Evaluate Diplomacy",e+2);return new Se([t,new or(UI,i,"Diplomacy Cooldown",e+1)],"Manage Diplomacy",e)}const $s="huntTarget";function V1(e){return new Se([new Nr(new re((i,o,l)=>{if(!i.isAdult)return[!1,"Not an adult"];if(!i.leaderId)return[!1,"Not in a tribe"];const s=Ne(i.position,o.gameState,"prey",II,()=>!0);return s?(C.set(l,$s,s.id),[!0,"Found prey"]):[!1,"No suitable prey found"]},"Find Prey Target",e+2),LI,"Cache Find Prey",e+1),new rr(new Au(new ae((i,o,l)=>{if(!i.leaderId)return T.FAILURE;const s=C.get(l,$s);if(!s)return T.FAILURE;const u=o.gameState.entities.entities[s];if(!u||u.hitpoints<=0)return C.delete(l,$s),i.activeAction="idle",i.attackTargetId=void 0,T.SUCCESS;const{gameState:d}=o,f=$r(i.leaderId,d);return Y(i.position,f,d.mapDimensions.width,d.mapDimensions.height)>EI?(C.delete(l,$s),i.activeAction="idle",i.attackTargetId=void 0,T.FAILURE):(i.activeAction="attacking",i.attackTargetId=u.id,T.RUNNING)},"Hunt Prey Action",e+3),Cf,"Hunt Prey Timeout",e+2),{taskType:"hunt",maxCapacity:ph,getTargetId:(i,o,l)=>C.get(l,$s)??null},"Tribal Hunt Task",e+1)],"Human Hunt Prey Sequence",e)}const ql="defendTarget",rf=150;function X1(e){return new Se([new re((t,i,o)=>{if(!t.isAdult)return[!1,"Not an adult - children flee instead"];if(t.hitpoints<=t.maxHitpoints*.3)return[!1,"Too injured to defend"];const{gameState:l}=i;if(t.activeAction==="attacking"&&t.attackTargetId){const u=l.entities.entities[t.attackTargetId];if(u&&u.type==="predator"&&u.hitpoints>0&&Y(t.position,u.position,l.mapDimensions.width,l.mapDimensions.height)<=rf)return C.set(o,ql,u.id),[!0,"Continuing defense"]}const s=Ne(t,l,"predator",rf,u=>u.hitpoints>0&&(u.isAdult||!1));if(s){const u=Y(t.position,s.position,l.mapDimensions.width,l.mapDimensions.height),d=s.attackTargetId===t.id,f=u<80;if(d||f)return C.set(o,ql,s.id),[!0,"Predator threat detected"]}return C.set(o,ql,void 0),[!1,"No predator threat"]},"Detect Predator Threat",e+1),new ae((t,i,o)=>{const l=C.get(o,ql),s=l&&i.gameState.entities.entities[l];if(!s)return T.FAILURE;const{gameState:u}=i,d=Y(t.position,s.position,u.mapDimensions.width,u.mapDimensions.height);return t.hitpoints<t.maxHitpoints*.3?T.FAILURE:s.hitpoints<=0||d>rf*1.5?(t.activeAction="idle",t.attackTargetId=void 0,T.SUCCESS):(t.activeAction="attacking",t.attackTargetId=s.id,T.RUNNING)},"Defend Against Predator",e+1)],"Human Defend Against Predator",e)}function K1(e){return new Se([new re((t,i,o)=>{const l=Ne(t,i.gameState,"predator",$t*2,()=>!0),s=Ne(t,i.gameState,"human",$t*2,()=>!0);let u=null,d=1/0;if(l){const f=Y(t.position,l.position,i.gameState.mapDimensions.width,i.gameState.mapDimensions.height);f<d&&(d=f,u=l)}if(s){const f=Y(t.position,s.position,i.gameState.mapDimensions.width,i.gameState.mapDimensions.height);f<d&&(d=f,u=s)}return u&&d<$t*1.5?(C.set(o,"fleeThreat",u.id),C.set(o,"fleeDistance",d),!0):!1},"Detect Threat",e+1),new ae((t,i,o)=>{const l=C.get(o,"fleeThreat"),s=l&&i.gameState.entities.entities[l];if(!s)return T.FAILURE;t.activeAction="moving";const u=We(s.position,t.position,i.gameState.mapDimensions.width,i.gameState.mapDimensions.height),d=st(u),f=Un(t.position,Pt(d,PC));return t.target={x:(f.x%i.gameState.mapDimensions.width+i.gameState.mapDimensions.width)%i.gameState.mapDimensions.width,y:(f.y%i.gameState.mapDimensions.height+i.gameState.mapDimensions.height)%i.gameState.mapDimensions.height},t.direction=d,t.fleeCooldown=i.gameState.time+2,T.RUNNING},"Execute Flee",e+1)],"Prey Flee",e)}function Z1(e){return new Se([new re((t,i,o)=>{if(!t.isAdult)return[!1,"Not an adult"];if(t.hunger<=30||t.eatingCooldownTime&&t.eatingCooldownTime>i.gameState.time)return!1;const l=Ne(t,i.gameState,"berryBush",$t*10,s=>s.food.length>0);return l?Y(t.position,l.position,i.gameState.mapDimensions.width,i.gameState.mapDimensions.height)<=$t?(C.set(o,"grazingTarget",l.id),!0):(C.set(o,"grazingTarget",l.id),C.set(o,"needToMoveToTarget",!0),!0):!1},"Find Berry Bush",e+1),new ae((t,i,o)=>{const l=C.get(o,"grazingTarget"),s=l&&i.gameState.entities.entities[l],u=C.get(o,"needToMoveToTarget");if(!s)return T.FAILURE;const d=Y(t.position,s.position,i.gameState.mapDimensions.width,i.gameState.mapDimensions.height);if(d<=$t)return t.activeAction="grazing",t.target=s.id,t.direction={x:0,y:0},C.delete(o,"needToMoveToTarget"),T.RUNNING;if(u||d>$t){t.activeAction="moving",t.target=s.id;const f=Ft(t.position,s.position,i.gameState.mapDimensions);return t.direction=f,T.RUNNING}return T.FAILURE},"Move to Bush or Graze",e+1)],"Prey Graze",e)}function q1(e){const t=new re((s,u,d)=>{const f=Ne(s,u.gameState,"prey",$t,g=>g.id!==s.id&&g.gender!==s.gender&&!!g.isAdult&&g.age>=ia&&g.age<=Kd&&!g.isPregnant&&(!g.procreationCooldown||g.procreationCooldown<=0)&&g.hunger<200);return f?(C.set(d,"procreationPartner",f.id),!0):!1},"Find Immediate Partner",e+2),i=new ae((s,u,d)=>{const f=C.get(d,"procreationPartner"),g=f&&u.gameState.entities.entities[f];return g?(s.activeAction="procreating",s.target=g.id,s.direction={x:0,y:0},C.delete(d,"procreationPartner"),T.SUCCESS):T.FAILURE},"Start Procreating",e+2),o=new re((s,u,d)=>{const f=Ne(s,u.gameState,"prey",$t*10,g=>g.id!==s.id&&g.gender!==s.gender&&!!g.isAdult&&g.age>=ia&&g.age<=Kd&&!g.isPregnant&&(!g.procreationCooldown||g.procreationCooldown<=0)&&g.hunger<200);return f?(C.set(d,"procreationPartner",f.id),!0):!1},"Locate Distant Partner",e+2),l=new ae((s,u,d)=>{const f=C.get(d,"procreationPartner"),g=f&&u.gameState.entities.entities[f];if(!g)return T.FAILURE;if(Y(s.position,g.position,u.gameState.mapDimensions.width,u.gameState.mapDimensions.height)<=$t)return T.SUCCESS;s.activeAction="moving",s.target=g.id;const v=We(s.position,g.position,u.gameState.mapDimensions.width,u.gameState.mapDimensions.height);return s.direction=st(v),T.RUNNING},"Move Towards Partner",e+2);return new Se([new re(s=>!!(s.isAdult&&!s.isPregnant&&s.age>=ia&&s.age<=Kd&&s.hunger<200&&(!s.procreationCooldown||s.procreationCooldown<=0)),"Is Fertile and Ready",e+1),new qt([new Se([t,i],"Procreate With Immediate Partner",e+2),new Se([o,l],"Seek Distant Partner",e+2)],"Find Partner And Procreate",e+1)],"Prey Procreate",e)}const Q1=(e,t,i)=>{const o=t.gameState.search.prey.byProperty("motherId",e.id).filter(u=>!u.isAdult&&u.type==="prey");if(o.length===0)return T.FAILURE;let l=null,s=Uu;for(const u of o)u.hunger>=s&&(s=u.hunger,l=u);return l?(C.set(i,"targetChild",l.id),T.SUCCESS):T.FAILURE},J1=(e,t,i)=>{const o=C.get(i,"targetChild"),l=o&&t.gameState.entities.entities[o];return l?Y(e.position,l.position,t.gameState.mapDimensions.width,t.gameState.mapDimensions.height)>Ko?(e.activeAction="moving",e.target=l.id,e.direction=Ft(e.position,l.position,t.gameState.mapDimensions),T.RUNNING):(e.activeAction="feeding",e.target=void 0,C.set(i,"targetChild",void 0),T.SUCCESS):T.FAILURE};function eR(e){return new Se([new re(t=>(t.isAdult&&t.gender==="female"&&t.hunger<80&&(!t.feedChildCooldownTime||t.feedChildCooldownTime<=0))??!1,"Can Feed Child (Female Only)",e+1),new ae(Q1,"Find Hungriest Prey Child",e+1),new ae(J1,"Move To Child and Feed",e+1)],"Feed Prey Child",e)}function tR(e){return new Se([new re(t=>!t.isAdult&&t.hunger>=Uu,"Is Hungry Prey Child",e+1),new ae((t,i,o)=>{if(!t.motherId)return T.FAILURE;const l=i.gameState.entities.entities[t.motherId];return l?(C.set(o,"targetParent",l.id),T.SUCCESS):T.FAILURE},"Find Female Parent",e+1),new ae((t,i,o)=>{const l=C.get(o,"targetParent"),s=l&&i.gameState.entities.entities[l];if(!s)return T.FAILURE;const u=Y(t.position,s.position,i.gameState.mapDimensions.width,i.gameState.mapDimensions.height);return t.activeAction="idle",u<=Ko?(t.target=void 0,T.SUCCESS):(t.target=s.id,t.activeAction="moving",T.RUNNING)},"Move To Female Parent",e+1)],"Seek Food From Female Parent",e)}const zs="huntTarget";function nR(e,t,i){if(!(e!=null&&e.aiBlackboard))return!0;const o=`tribal_hunt_${t}`,l=C.get(e.aiBlackboard,o);return!l||i-l.startTime>$o?!0:l.memberIds.length<(l.maxCapacity||ph)}function iR(e,t){if(!(e!=null&&e.aiBlackboard))return 0;const i=`tribal_hunt_${t}`,o=C.get(e.aiBlackboard,i);return(o==null?void 0:o.memberIds.length)??0}function rR(e){return new Se([new re((t,i,o)=>{if(!t.isAdult)return[!1,"Not an adult"];if(t.hunger<=50||t.huntCooldown&&t.huntCooldown>0)return!1;const l=Ne(t,i.gameState,"prey",wo*10,s=>{if(s.hitpoints<=0)return!1;const u=Sa(t,i.gameState);return!(u&&!nR(u,s.id,i.gameState.time))});if(l){const s=Y(t.position,l.position,i.gameState.mapDimensions.width,i.gameState.mapDimensions.height),u=Sa(t,i.gameState),d=u?iR(u,l.id):0;if(s<=wo)return C.set(o,zs,l.id),[!0,`Prey in range (${d} hunters)`];if(s<=wo*10)return C.set(o,zs,l.id),C.set(o,"needToApproach",!0),[!0,`Approaching prey (${d} hunters)`]}return!1},"Find Prey Target",e+1),new rr(new Au(new ae((t,i,o)=>{const l=C.get(o,zs),s=l&&i.gameState.entities.entities[l],u=C.get(o,"needToApproach");if(!s||s.hitpoints<=0)return C.delete(o,zs),C.delete(o,"needToApproach"),T.SUCCESS;const d=Y(t.position,s.position,i.gameState.mapDimensions.width,i.gameState.mapDimensions.height);if(d<=wo)return t.activeAction="attacking",t.attackTargetId=s.id,t.target=s.id,t.direction={x:0,y:0},C.delete(o,"needToApproach"),T.RUNNING;if(u||d>wo){t.activeAction="moving",t.target=s.id;const f=We(t.position,s.position,i.gameState.mapDimensions.width,i.gameState.mapDimensions.height);return t.direction=st(f),T.RUNNING}return T.FAILURE},"Hunt or Approach Prey",e+3),10,"Hunt Timeout (10 hour)",e+2),{taskType:"hunt",maxCapacity:ph,getTargetId:(t,i,o)=>C.get(o,zs)},"Tribal Hunt Decorator",e+1)],"Predator Hunt",e)}function oR(e){return new Se([new re((t,i,o)=>{const l=t.hunger>100,s=t.hitpoints<t.maxHitpoints*.5;if(!l&&!s||t.attackCooldown&&t.attackCooldown>0)return!1;const u=Ne(t,i.gameState,"human",Mn*2,d=>d.hitpoints>0);if(u){const d=Y(t.position,u.position,i.gameState.mapDimensions.width,i.gameState.mapDimensions.height);if(d<=Mn)return C.set(o,"attackTarget",u.id),!0;if(l&&d<=Mn*2)return C.set(o,"attackTarget",u.id),C.set(o,"needToApproach",!0),!0}return!1},"Find Human Target",e+1),new ae((t,i,o)=>{const l=C.get(o,"attackTarget"),s=l&&i.gameState.entities.entities[l],u=C.get(o,"needToApproach");if(!s||s.hitpoints<=0)return T.FAILURE;const d=Y(t.position,s.position,i.gameState.mapDimensions.width,i.gameState.mapDimensions.height);if(d<=Mn)return t.activeAction="attacking",t.attackTargetId=s.id,t.target=s.id,t.direction={x:0,y:0},C.delete(o,"needToApproach"),T.RUNNING;if(u||d>Mn){t.activeAction="moving",t.target=s.id;const f=We(t.position,s.position,i.gameState.mapDimensions.width,i.gameState.mapDimensions.height);return t.direction=st(f),T.RUNNING}return T.FAILURE},"Attack or Approach Human",e+1)],"Predator Attack Human",e)}function sR(e){const t=new re((s,u,d)=>{const f=Ne(s,u.gameState,"predator",er,g=>g.id!==s.id&&g.gender!==s.gender&&!!g.isAdult&&g.age>=ra&&g.age<=Zd&&!g.isPregnant&&(!g.procreationCooldown||g.procreationCooldown<=0)&&g.hunger<200);return f?(C.set(d,"procreationPartner",f.id),!0):!1},"Find Immediate Partner",e+2),i=new ae((s,u,d)=>{const f=C.get(d,"procreationPartner"),g=f&&u.gameState.entities.entities[f];return g?(s.activeAction="procreating",s.target=g.id,s.direction={x:0,y:0},C.delete(d,"procreationPartner"),T.SUCCESS):T.FAILURE},"Start Procreating",e+2),o=new re((s,u,d)=>{const f=Ne(s,u.gameState,"predator",er*10,g=>g.id!==s.id&&g.gender!==s.gender&&!!g.isAdult&&g.age>=ra&&g.age<=Zd&&!g.isPregnant&&(!g.procreationCooldown||g.procreationCooldown<=0)&&g.hunger<200);return f?(C.set(d,"procreationPartner",f.id),!0):!1},"Locate Distant Partner",e+2),l=new ae((s,u,d)=>{const f=C.get(d,"procreationPartner"),g=f&&u.gameState.entities.entities[f];if(!g)return T.FAILURE;if(Y(s.position,g.position,u.gameState.mapDimensions.width,u.gameState.mapDimensions.height)<=er)return T.SUCCESS;s.activeAction="moving",s.target=g.id;const v=We(s.position,g.position,u.gameState.mapDimensions.width,u.gameState.mapDimensions.height);return s.direction=st(v),T.RUNNING},"Move Towards Partner",e+2);return new Se([new re(s=>!!(s.isAdult&&!s.isPregnant&&s.age>=ra&&s.age<=Zd&&s.hunger<200&&(!s.procreationCooldown||s.procreationCooldown<=0)),"Is Fertile and Ready",e+1),new qt([new Se([t,i],"Procreate With Immediate Partner",e+2),new Se([o,l],"Seek Distant Partner",e+2)],"Find Partner And Procreate",e+1)],"Predator Procreate",e)}const aR=(e,t,i)=>{const o=t.gameState.search.predator.byProperty("motherId",e.id).filter(u=>!u.isAdult&&u.type==="predator");if(o.length===0)return T.FAILURE;let l=null,s=Uu;for(const u of o)u.hunger>=s&&(s=u.hunger,l=u);return l?(C.set(i,"targetChild",l.id),T.SUCCESS):T.FAILURE},lR=(e,t,i)=>{const o=C.get(i,"targetChild"),l=o&&t.gameState.entities.entities[o];return l?Y(e.position,l.position,t.gameState.mapDimensions.width,t.gameState.mapDimensions.height)>Ko?(e.activeAction="moving",e.target=l.id,e.direction=Ft(e.position,l.position,t.gameState.mapDimensions),T.RUNNING):(e.activeAction="feeding",e.target=void 0,C.set(i,"targetChild",void 0),T.SUCCESS):T.FAILURE};function uR(e){return new Se([new re(t=>(t.isAdult&&t.gender==="female"&&t.hunger<90&&(!t.feedChildCooldownTime||t.feedChildCooldownTime<=0))??!1,"Can Feed Child (Female Only)",e+1),new ae(aR,"Find Hungriest Predator Child",e+1),new ae(lR,"Move To Child and Feed",e+1)],"Feed Predator Child",e)}function cR(e){return new Se([new re(t=>!t.isAdult&&t.hunger>=Uu,"Is Hungry Predator Child",e+1),new ae((t,i,o)=>{if(!t.motherId)return T.FAILURE;const l=i.gameState.entities.entities[t.motherId];return l?(C.set(o,"targetParent",l.id),T.SUCCESS):T.FAILURE},"Find Female Parent",e+1),new ae((t,i,o)=>{const l=C.get(o,"targetParent"),s=l&&i.gameState.entities.entities[l];if(!s)return T.FAILURE;const u=Y(t.position,s.position,i.gameState.mapDimensions.width,i.gameState.mapDimensions.height);return t.activeAction="idle",u<=Ko?(t.target=void 0,T.SUCCESS):(t.target=s.id,t.activeAction="moving",T.RUNNING)},"Move To Female Parent",e+1)],"Seek Food From Female Parent",e)}function ES(e){return new ae((t,i,o)=>{t.activeAction="idle";let l=C.get(o,"wanderTarget"),s=C.get(o,"wanderStartTime");const u=i.gameState.time;if(!l||!s||u-s>2){const d=Math.random()*2*Math.PI,f=50+Math.random()*100,g={x:Math.cos(d),y:Math.sin(d)},m=Un(t.position,Pt(g,f));l={x:(m.x%i.gameState.mapDimensions.width+i.gameState.mapDimensions.width)%i.gameState.mapDimensions.width,y:(m.y%i.gameState.mapDimensions.height+i.gameState.mapDimensions.height)%i.gameState.mapDimensions.height},C.set(o,"wanderTarget",l),C.set(o,"wanderStartTime",u)}if(l){t.target=l;let d=l.x-t.position.x,f=l.y-t.position.y;const g=i.gameState.mapDimensions.width,m=i.gameState.mapDimensions.height;Math.abs(d)>g/2&&(d=d>0?d-g:d+g),Math.abs(f)>m/2&&(f=f>0?f-m:f+m);const v=st({x:d,y:f});t.direction=v}return T.SUCCESS},"Animal Wander",e)}function dR(e){return new Se([new re((t,i,o)=>{if(t.hunger>90||t.hitpoints<t.maxHitpoints*.3||t.activeAction==="grazing"||t.activeAction==="procreating")return!1;const l=Object.values(i.gameState.entities.entities),s=[];for(const u of l)if(u.type==="prey"&&u.id!==t.id){const d=u;d.hitpoints>0&&d.isAdult&&Y(t.position,d.position,i.gameState.mapDimensions.width,i.gameState.mapDimensions.height)<=$t*5&&s.push(d)}if(s.length>=2){let u=0,d=0;for(const m of s)u+=m.position.x,d+=m.position.y;u/=s.length,d/=s.length;const f={x:u,y:d};if(Y(t.position,f,i.gameState.mapDimensions.width,i.gameState.mapDimensions.height)>$t*2)return C.set(o,"herdCenter",f),C.set(o,"herdSize",s.length),!0}return!1},"Find Herd",e+1),new ae((t,i,o)=>{const l=C.get(o,"herdCenter");if(!l)return T.FAILURE;if(Y(t.position,l,i.gameState.mapDimensions.width,i.gameState.mapDimensions.height)>$t*2){t.activeAction="moving",t.target=l;const u=We(t.position,l,i.gameState.mapDimensions.width,i.gameState.mapDimensions.height);return t.direction=st(u),T.RUNNING}else return t.activeAction="idle",t.direction={x:0,y:0},T.SUCCESS},"Join Herd",e+1)],"Prey Herd Behavior",e)}function fR(e){return new Se([new re((t,i,o)=>{if(t.hunger>100||t.hitpoints<t.maxHitpoints*.4||t.activeAction==="attacking"||t.activeAction==="procreating")return!1;const l=Ne(t,i.gameState,"predator",er*4,s=>s.id!==t.id&&s.hitpoints>0&&s.isAdult&&t.fatherId!==void 0&&s.fatherId===t.fatherId&&s.age>=t.age||s.hitpoints>t.hitpoints);return l&&Y(t.position,l.position,i.gameState.mapDimensions.width,i.gameState.mapDimensions.height)>er*2?(C.set(o,"packLeader",l.id),!0):!1},"Find Pack Leader",e+1),new ae((t,i,o)=>{const l=C.get(o,"packLeader"),s=l&&i.gameState.entities.entities[l];if(!s||s.hitpoints<=0)return T.FAILURE;if(Y(t.position,s.position,i.gameState.mapDimensions.width,i.gameState.mapDimensions.height)>er*2){t.activeAction="moving",t.target=s.id;const d=We(t.position,s.position,i.gameState.mapDimensions.width,i.gameState.mapDimensions.height);return t.direction=st(d),T.RUNNING}else return t.activeAction="idle",t.direction={x:0,y:0},T.SUCCESS},"Follow Pack Leader",e+1)],"Predator Pack Behavior",e)}function hR(e){return new Se([new re((t,i,o)=>{if(!t.isAdult||t.hitpoints<t.maxHitpoints*.6||t.hunger>120||t.attackCooldown&&t.attackCooldown>0)return!1;const l=Ne(t,i.gameState,"predator",S0,s=>!!(s.id!==t.id&&s.hitpoints>0&&s.isAdult&&t.fatherId!==s.fatherId&&t.gender===s.gender&&t.fatherId!==void 0&&s.fatherId!==void 0));if(l){const s=Y(t.position,l.position,i.gameState.mapDimensions.width,i.gameState.mapDimensions.height);if(s<=Mn)return C.set(o,"territorialTarget",l.id),!0;if(s<=S0)return C.set(o,"territorialTarget",l.id),C.set(o,"needToApproach",!0),!0}return!1},"Find Territorial Rival",e+1),new ae((t,i,o)=>{const l=C.get(o,"territorialTarget"),s=l&&i.gameState.entities.entities[l],u=C.get(o,"needToApproach");if(!s||s.hitpoints<=0)return T.FAILURE;const d=Y(t.position,s.position,i.gameState.mapDimensions.width,i.gameState.mapDimensions.height);if(d<=Mn)return t.activeAction="attacking",t.attackTargetId=s.id,t.target=s.id,t.direction={x:0,y:0},C.delete(o,"needToApproach"),T.RUNNING;if(u||d>Mn){t.activeAction="moving",t.target=s.id;const f=We(t.position,s.position,i.gameState.mapDimensions.width,i.gameState.mapDimensions.height);return t.direction=st(f),T.RUNNING}return T.FAILURE},"Territorial Fight or Approach",e+1)],"Predator Territorial Defense",e)}function gR(){const e=new qt([d1(2),G1(2),new on(X1(2),"attack","Gated Defend Against Predator",2),new on(b1(2),"attack","Gated Jealousy Attack",2),new on(x1(2),"attack","Gated Desperate Attack",2),z1(2),new Er(D1(3),"Gated Leader Combat Strategy",2),new Er(j1(3),"Gated Diplomacy",2),new Er(new qt([new Nr(L1(5),uu,"Cache Take Over Building",4),new Nr(U1(5),uu,"Cache Remove Enemy Building",4)],"Building Interaction Selector",3),"Gated Leader Building Interactions",2),new Er(new Nr(F1(4),uE,"Cache Building Placement",3),"Gated Leader Building Placement",2),O1(2),new on(N1(3),"attack","Gated Storage Steal",2),new on(y1(3),"attack","Gated Attacking",2),c1(2),new on(P1(3),"gathering","Gated Storage Retrieve",2),new Au(new on(m1(4),"gathering","Gated Gathering",3),Cf,"Timeout Gathering",2),new on(R1(3),"gathering","Gated Storage Deposit",2),new on(I1(3),"feedChildren","Gated Feed Child",2),E1(2),new on(S1(3),"procreation","Gated Procreation",2),new Au(new on(C1(4),"planting","Gated Planting",3),Cf,"Timeout Planting",2),new on(V1(3),"attack","Gated Hunt Prey",2),new Nr(H1(3),uu,"Cache Tribe Split",2),new Er(Y1(3),"Gated Tribe Migration",2),new on(W1(3),"followLeader","Gated Follow Leader",2),new Er(B1(2),"Gated Follow Patriarch",2),new Er(v1(2),"Gated Idle Wander",2)],"AI Root Selector",1);return new l1(e,"Manual Control Gate",0)}const wS=gR();function pR(e,t){e.aiBlackboard&&C.cleanupOldEntries(e.aiBlackboard,t.gameState.time);const i=Sa(e,t.gameState);i&&i.id===e.id&&i.aiBlackboard&&u1(i,t.gameState.time);const o=performance.now();switch(e.aiType){case wa.BehaviorTreeBased:default:gh(e,t,wS);break}t.gameState.performanceMetrics.currentBucket.aiUpdateTime+=performance.now()-o}function mR(){return new qt([K1(1),eR(1),tR(1),Z1(1),q1(1),dR(1),ES(1)],"Prey Behavior Root",0)}function vR(){return new qt([rR(1),oR(1),uR(1),cR(1),hR(1),sR(1),fR(1),ES(1)],"Predator Behavior Root",0)}const _S=mR();function SR(e,t){e.aiBlackboard?gh(e,t,_S):(console.warn(`Behavior Tree AI ticked for prey ${e.id}, but the tree or blackboard was missing.`),e.activeAction="idle")}const CS=vR();function yR(e,t){e.aiBlackboard?gh(e,t,CS):(console.warn(`Behavior Tree AI ticked for predator ${e.id}, but the tree or blackboard was missing.`),e.activeAction="idle")}function TR(e,t){const{gameState:i,deltaTime:o}=t,l=o*(Et/wt);if(e.isBeingDestroyed){const s=Y_(e.buildingType);if(s>0?e.destructionProgress+=l/s:e.destructionProgress=1,e.destructionProgress>=1){qo(i.entities,e.id);return}}if(!e.isConstructed&&!e.isBeingDestroyed){const s=W_(e.buildingType);s>0?e.constructionProgress+=l/s:e.constructionProgress=1,e.constructionProgress>=1&&(e.constructionProgress=1,e.isConstructed=!0)}}function AR(e,t){e.forces.push(Pt(e.velocity,-.1));const i=Pt(st(e.direction),e.acceleration);e.forces.push(i),e.debuffs.forEach(o=>{t.gameState.time-o.startTime<o.duration&&o.type==="slow"&&(e.velocity=Pt(e.velocity,.5))}),e.debuffs=e.debuffs.filter(o=>t.gameState.time-o.startTime<o.duration),e.velocity=Un(e.velocity,e.forces.reduce(Un,{x:0,y:0})),bo(e.velocity)<.001&&(e.velocity={x:0,y:0}),e.position=Un(e.position,Pt(e.velocity,t.deltaTime)),e.position.x=(e.position.x%t.gameState.mapDimensions.width+t.gameState.mapDimensions.width)%t.gameState.mapDimensions.width,e.position.y=(e.position.y%t.gameState.mapDimensions.height+t.gameState.mapDimensions.height)%t.gameState.mapDimensions.height,e.forces=[],e.type==="human"?n1(e,t,t.deltaTime):e.type==="corpse"?i1(e,t):e.type==="prey"?r1(e,t,t.deltaTime):e.type==="predator"?o1(e,t,t.deltaTime):e.type==="building"&&TR(e,t),e.type==="human"&&pR(e,t),e.type==="prey"?SR(e,t):e.type==="predator"&&yR(e,t),e.stateMachine&&(e.stateMachine=t1(...e.stateMachine,{entity:e,updateContext:t}))}function IR(e){const t=e.gameState.entities;Object.values(t.entities).forEach(i=>{AR(i,e)})}function RS(){return{entities:{},nextEntityId:1}}function Zo(e,t,i){const o={id:e.nextEntityId++,type:t,velocity:{x:0,y:0},direction:{x:0,y:0},acceleration:0,forces:[],debuffs:[],...i};return e.entities[o.id]=o,o}function _a(e,t,i){return Zo(e,"berryBush",{position:t,radius:wf,food:Array.from({length:hI},()=>({type:Bn.Berry})).map(l=>({...l,id:e.nextEntityId++})),maxFood:fI,lifespan:pI,age:0,spreadRadius:wf,timeSinceLastBerryRegen:0,timeSinceLastSpreadAttempt:0,timeSinceLastHarvest:0,stateMachine:[Qs,{enteredAt:i,previousState:void 0}]})}function Iu(e,t,i,o,l=!1,s=SE,u=Nv,d,f,g=[],m,v){const y=s>=Xf;return Zo(e,"human",{position:t,radius:y?_t:Vo,hunger:u,hitpoints:jm,maxHitpoints:jm,age:s,gender:o,isPlayer:l,food:[],maxFood:Pv,maxAge:ca,isAdult:y,isPregnant:!1,gestationTime:0,procreationCooldown:0,attackCooldown:0,motherId:d,fatherId:f,ancestorIds:g,stateMachine:[dt,{enteredAt:i,previousState:void 0}],leaderId:m,tribeBadge:v,aiType:wa.BehaviorTreeBased,aiBlackboard:C.create()})}function mh(e,t,i,o,l,s,u,d,f,g,m){let v,y;switch(u){case"human":v=Ov,y=Gr;break;case"prey":v=2,y=120;break;case"predator":v=4,y=140;break}return Zo(e,"corpse",{position:t,radius:l,gender:i,age:o,originalEntityId:s,originalEntityType:u,timeOfDeath:d,decayProgress:0,geneCode:m,food:[...Array.from({length:Math.max(v*Math.max(y-g,0)/y,0)},()=>({type:Bn.Meat})),...f].map(E=>({...E,id:e.nextEntityId++})),stateMachine:void 0})}function ER(e,t,i,o,l,s,u,d,f){return mh(e,t,i,o,l,s,"human",u,d,f)}function wR(e,t,i,o,l,s,u,d){return mh(e,t,i,o,l,s,"prey",u,[],0,d)}function _R(e,t,i,o,l,s,u,d){return mh(e,t,i,o,l,s,"predator",u,[],0,d)}function CR(e,t,i){const o=t?i.gameState.entities.entities[t]:void 0,l=[...e.ancestorIds||[],e.id],s=o?[...o.ancestorIds||[],o.id]:[],u=[...l,...s],d=[...new Set(u)],f=d.slice(Math.max(d.length-gE,0)),g=Math.random()<.5?"male":"female",m=Un(e.position,{x:5,y:5}),v=Iu(i.gameState.entities,m,i.gameState.time,g,!1,0,Nv/2,e.id,t,f,(o==null?void 0:o.leaderId)??e.leaderId,(o==null?void 0:o.tribeBadge)??e.tribeBadge);return Ie(i,fe.Birth,e.position),v}function qo(e,t){return e.entities[t]?(delete e.entities[t],!0):!1}function zo(e,t,i,o=RC,l=fS,s,u,d){const f=o>=ia,g=Date.now();return Zo(e,"prey",{position:t,radius:f?_t*.7:Vo*.7,hunger:l,hitpoints:m0,maxHitpoints:m0,age:o,maxAge:dS,gender:i,isAdult:f,isPregnant:!1,gestationTime:0,procreationCooldown:0,geneCode:s,motherId:u,fatherId:d,stateMachine:[kn,{enteredAt:g,previousState:void 0}],aiType:wa.BehaviorTreeBased,aiBlackboard:C.create()})}function Wo(e,t,i,o=LC,l=gS,s,u,d){const f=o>=ra,g=Date.now();return Zo(e,"predator",{position:t,radius:f?_t*.9:Vo*.9,hunger:l,hitpoints:v0,maxHitpoints:v0,age:o,maxAge:hS,gender:i,isAdult:f,isPregnant:!1,gestationTime:0,procreationCooldown:0,geneCode:s,motherId:u,fatherId:d,stateMachine:[xt,{enteredAt:g,previousState:void 0}],aiType:wa.BehaviorTreeBased,aiBlackboard:C.create()})}function RR(e,t,i,o){const l=oS(i),s={position:t,radius:Math.max(l.width,l.height)/2,buildingType:i,ownerId:o,width:l.width,height:l.height,constructionProgress:0,destructionProgress:0,isConstructed:!1,isBeingDestroyed:!1};return Zo(e,"building",{...s,...i===Tn.StorageSpot&&{storedFood:[],storageCapacity:U_,lastDepositTime:0,lastRetrieveTime:0,lastStealTime:0}})}var bt=(e=>(e.MOVE="MOVE",e.HUNGER="HUNGER",e.EAT="EAT",e.FIND_BUSH="FIND_BUSH",e.GATHER="GATHER",e.PROCREATE="PROCREATE",e.PLANT_BUSH="PLANT_BUSH",e.AUTOPILOT="AUTOPILOT",e.ANIMALS_INTRODUCTION="ANIMALS_INTRODUCTION",e.HUNT_PREY="HUNT_PREY",e.DEFEND_FROM_PREDATORS="DEFEND_FROM_PREDATORS",e))(bt||{}),Ur=(e=>(e.HUNGER_BAR="HUNGER_BAR",e.FOOD_BAR="FOOD_BAR",e.COMMAND_BUTTONS="COMMAND_BUTTONS",e))(Ur||{}),Gt=(e=>(e[e.FADING_IN=0]="FADING_IN",e[e.ACTIVE=1]="ACTIVE",e[e.FADING_OUT=2]="FADING_OUT",e[e.INACTIVE=3]="INACTIVE",e))(Gt||{});const Of={},kf={},PR=[{key:bt.MOVE,title:"Movement",text:"Use WASD or Arrow Keys to move your character around the world.",condition:e=>e.hasPlayerMovedEver||e.hasPlayerEnabledAutopilot>2,isCompleted:!1},{key:bt.HUNGER,title:"Hunger",text:"Your character gets hungry over time. Watch the hunger bar!",condition:(e,t)=>t.hunger>pE,isCompleted:!1,minDisplayTime:l0,highlightedUIElements:[Ur.HUNGER_BAR]},{key:bt.FIND_BUSH,title:"Find Food",text:"Look for berry bushes. They are your primary source of food.",condition:(e,t)=>!!Ne(t,e,"berryBush",vt*5,o=>o.food.length>0),getTargets:(e,t)=>{const i=[];for(const o of Object.values(e.entities.entities))o.type==="berryBush"&&o.food.length>0&&Y(t.position,o.position,e.mapDimensions.width,e.mapDimensions.height)<500&&i.push(o);return i.map(o=>o.id)},isCompleted:!1,minDisplayTime:l0},{key:bt.GATHER,title:"Gather Berries",text:"Get close to a bush and press 'E' to gather berries.",condition:(e,t)=>t.food.length>0,getTargets:(e,t)=>{const i=Ne(t,e,"berryBush",vt,o=>o.food.length>0);return i?[i.id]:[]},isCompleted:!1},{key:bt.EAT,title:"Eat",text:"When you are hungry and have food, press 'F' to eat.",condition:(e,t)=>t.activeAction==="eating",isCompleted:!1,highlightedUIElements:[Ur.FOOD_BAR]},{key:bt.PROCREATE,title:"Procreate",text:"Find a mate and press 'R' to start a family. This is how you continue your lineage.",condition:(e,t)=>un(e,t).length>0,getTargets:(e,t)=>{const i=Ne(t,e,"human",vt,o=>zr(t,o,e));return i?[i.id]:[]},isCompleted:!1},{key:bt.PLANT_BUSH,title:"Farming",text:"You can plant new berry bushes. Carry some berries and press 'B' to plant.",condition:(e,t)=>ch(e,t).some(o=>o.type===se.Plant)||e.hasPlayerPlantedBush===!0,isCompleted:!1},{key:bt.AUTOPILOT,title:"Autopilot!",text:"You can turn autopilot for specific actions, press Shift and click on the action button to enable it.",condition:e=>e.hasPlayerEnabledAutopilot>2,highlightedUIElements:[Ur.COMMAND_BUTTONS],isCompleted:!1},{key:bt.ANIMALS_INTRODUCTION,title:"Wild Animals!",text:"Your world now has wild animals! Prey provide meat when hunted, but beware of predators that may attack.",condition:e=>Object.values(e.entities.entities).some(i=>i.type==="prey"||i.type==="predator"),isCompleted:!1,dependsOn:bt.AUTOPILOT},{key:bt.HUNT_PREY,title:"Hunt for Meat",text:"Click on prey animals to hunt them for meat. Hunting provides more food than gathering berries!",condition:(e,t)=>{const i=Ne(t,e,"prey",150);return t.hunger>40&&!!i},getTargets:(e,t)=>{const i=Ne(t,e,"prey",150);return i?[i.id]:[]},isCompleted:!1,dependsOn:bt.ANIMALS_INTRODUCTION},{key:bt.DEFEND_FROM_PREDATORS,title:"Predators",text:"Predators may attack when hungry! Click on them to fight back. Fighting together with family is more effective.",condition:(e,t)=>!!Ne(t,e,"predator",120),getTargets:(e,t)=>{const i=Ne(t,e,"predator",120);return i?[i.id]:[]},isCompleted:!1,dependsOn:bt.HUNT_PREY}].map(e=>({...e,condition:e.condition?OR(e.condition):void 0,getTargets:e.getTargets?kR(e.getTargets):void 0}));function PS(){return{steps:PR.map(e=>({...e,isCompleted:!1}))}}function NS(){return{currentStepIndex:0,completedSteps:[],isActive:!0,transitionState:Gt.FADING_IN,transitionAlpha:0,highlightedEntityIds:[],stepStartTime:null,activeUIHighlights:[]}}function NR(e){for(let t=0;t<e.tutorial.steps.length;t++){const i=e.tutorial.steps[t];if(!i.isCompleted)if(i.dependsOn){if(e.tutorialState.completedSteps.includes(i.dependsOn))return t}else return t}return null}function DR(e,t){const i=e.tutorialState;if(!i.isActive){i.transitionState=Gt.INACTIVE,i.highlightedEntityIds=[],i.activeUIHighlights=[];return}const o=St(e);if(!o){i.isActive=!1,i.transitionState=Gt.INACTIVE,i.highlightedEntityIds=[],i.activeUIHighlights=[];return}const l=e.tutorial.steps[i.currentStepIndex];if(!l){i.isActive=!1,i.transitionState=Gt.INACTIVE,i.highlightedEntityIds=[],i.activeUIHighlights=[];return}const s=1/Kw;switch(i.transitionState){case Gt.FADING_IN:i.stepStartTime===null&&(i.stepStartTime=e.time),i.transitionAlpha+=s*t,i.transitionAlpha>=1&&(i.transitionAlpha=1,i.transitionState=Gt.ACTIVE);break;case Gt.ACTIVE:{const f=e.time-(i.stepStartTime||e.time)>=(l.minDisplayTime||0),g=Of[l.condition];g&&f&&g(e,o)&&(l.isCompleted=!0,i.completedSteps.includes(l.key)||i.completedSteps.push(l.key),i.transitionState=Gt.FADING_OUT);break}case Gt.FADING_OUT:if(i.transitionAlpha-=s*t,i.transitionAlpha<=0){i.transitionAlpha=0,i.stepStartTime=null;const d=NR(e);d!==null?(i.currentStepIndex=d,i.transitionState=Gt.FADING_IN):(i.isActive=!1,i.transitionState=Gt.INACTIVE)}break}if(i.transitionState!==Gt.FADING_OUT&&i.transitionState!==Gt.INACTIVE){const d=kf[l.getTargets||""];d?i.highlightedEntityIds=[...d(e,o)]:i.highlightedEntityIds=[],l.highlightedUIElements?i.activeUIHighlights=[...l.highlightedUIElements]:i.activeUIHighlights=[]}else i.highlightedEntityIds=[],i.activeUIHighlights=[]}function OR(e){const t=`condition_${Object.keys(Of).length+1}`;return Of[t]=e,t}function kR(e){const t=`getTargets_${Object.keys(kf).length+1}`;return kf[t]=e,t}function MR(){const e=RS(),t=0;for(let v=0;v<Tv;v++){const y={x:Math.random()*et,y:Math.random()*tt};_a(e,y,t)}const i=et/2,o=tt/2,l=Iu(e,{x:i,y:o},t,"male",!0);Iu(e,{x:i+50,y:o},t,"female",!1);for(let v=0;v<vS;v++){const y={x:i+et*(Math.random()-Math.random()),y:o+tt*(Math.random()-Math.random())};zo(e,y,"male",void 0,void 0,ma()),zo(e,{x:y.x+20,y:y.y},"female",void 0,void 0,ma())}const s={x:i+et*(Math.random()-Math.random()),y:o+tt*(Math.random()-Math.random())};Wo(e,s,"male",void 0,void 0,va()),Wo(e,{x:s.x+20,y:s.y},"female",void 0,void 0,va());const u=[{id:"muteButton",action:ge.ToggleMute,currentWidth:gi,rect:{x:0,y:0,width:0,height:0},text:"",backgroundColor:"",textColor:yn},{id:"pauseButton",action:ge.TogglePause,currentWidth:gi,rect:{x:0,y:0,width:0,height:0},text:"",backgroundColor:"",textColor:yn},{id:"returnToIntroButton",action:ge.ReturnToIntro,currentWidth:gi,rect:{x:0,y:0,width:0,height:0},text:"EXIT",backgroundColor:"",textColor:yn}],d=PS(),f=NS(),g={time:t,entities:e,mapDimensions:{width:et,height:tt},generationCount:1,gameOver:!1,visualEffects:[],nextVisualEffectId:0,viewportCenter:{...l.position},isPaused:!1,exitConfirmation:"inactive",autopilotControls:{behaviors:{procreation:!1,planting:!1,gathering:!1,attack:!1,feedChildren:!0,followLeader:!1},hoveredAutopilotAction:void 0,activeAutopilotAction:void 0,isManuallyMoving:!1},buildMenuOpen:!1,selectedBuildingType:null,selectedBuildingForRemoval:null,hasPlayerMovedEver:!1,hasPlayerPlantedBush:!1,hasPlayerEnabledAutopilot:0,masterVolume:iS,isMuted:!1,uiButtons:u,tutorial:d,tutorialState:f,debugPanel:ct.None,performanceMetrics:{currentBucket:{renderTime:0,worldUpdateTime:0,aiUpdateTime:0},history:[]},hoveredButtonId:void 0,mousePosition:{x:0,y:0},notifications:[{id:"welcome",type:ha.Hello,message:"Welcome to the game!",duration:50,targetEntityIds:[l.id],highlightedEntityIds:[l.id],timestamp:0,isDismissed:!1,creationTime:Date.now()}],ecosystem:{preyGestationPeriod:Or,preyProcreationCooldown:kr,predatorGestationPeriod:Mr,predatorProcreationCooldown:Fr,preyHungerIncreasePerHour:Zi,predatorHungerIncreasePerHour:qi,berryBushSpreadChance:Si},autosaveIntervalSeconds:5,lastAutosaveTime:Date.now()},m=wu(g);return console.log("Game world initialized:",m),m}function FR(){const e=RS(),t=0;for(let u=0;u<Tv;u++){const d={x:Math.random()*et,y:Math.random()*tt};_a(e,d,t)}for(let u=0;u<uI;u++){const d={x:Math.random()*et,y:Math.random()*tt},f=Math.random()<.5?"male":"female";Iu(e,d,t,f,!1)}for(let u=0;u<vS;u++){const d={x:Math.random()*et,y:Math.random()*tt};zo(e,d,"male",void 0,void 0,ma()),zo(e,{x:d.x+20,y:d.y},"female",void 0,void 0,ma())}const i={x:Math.random()*et,y:Math.random()*tt};Wo(e,i,"male",void 0,void 0,va()),Wo(e,{x:i.x+20,y:i.y},"female",void 0,void 0,va());const o=PS(),l=NS(),s={time:t,entities:e,mapDimensions:{width:et,height:tt},generationCount:0,gameOver:!1,visualEffects:[],nextVisualEffectId:0,viewportCenter:{x:et/2,y:tt/2},isPaused:!1,exitConfirmation:"inactive",autopilotControls:{behaviors:{procreation:!1,planting:!1,gathering:!1,attack:!1,feedChildren:!0,followLeader:!1},hoveredAutopilotAction:void 0,activeAutopilotAction:void 0,isManuallyMoving:!1},buildMenuOpen:!1,selectedBuildingType:null,selectedBuildingForRemoval:null,hasPlayerMovedEver:!1,hasPlayerPlantedBush:!1,hasPlayerEnabledAutopilot:0,masterVolume:iS,isMuted:!0,uiButtons:[],tutorial:o,tutorialState:l,debugPanel:ct.None,performanceMetrics:{currentBucket:{renderTime:0,worldUpdateTime:0,aiUpdateTime:0},history:[]},hoveredButtonId:void 0,mousePosition:{x:0,y:0},notifications:[],ecosystem:{preyGestationPeriod:Or,preyProcreationCooldown:kr,predatorGestationPeriod:Mr,predatorProcreationCooldown:Fr,preyHungerIncreasePerHour:Zi,predatorHungerIncreasePerHour:qi,berryBushSpreadChance:Si},lastAutosaveTime:0};return wu(s)}const LR="humanProcreation",UR="human",BR="human",HR=vt,bR=(e,t,i)=>zr(e,t,i.gameState)?e.gender==="male"?e.activeAction==="procreating":e.activeAction==="procreating"&&t.activeAction==="procreating":!1,GR=(e,t,i)=>{var f,g;const{gameState:o}=i,l={x:(e.position.x+t.position.x)/2,y:(e.position.y+t.position.y)/2},s=e.gender==="male"?e:t,u=e.gender==="female"?e:t,d=(s.partnerIds||[]).length===0;if(e.stateMachine=[pa,{partnerId:t.id,previousState:(f=e.stateMachine)==null?void 0:f[0]}],t.stateMachine=[pa,{partnerId:e.id,previousState:(g=t.stateMachine)==null?void 0:g[0]}],e.partnerIds||(e.partnerIds=[]),e.partnerIds.includes(t.id)||e.partnerIds.push(t.id),t.partnerIds||(t.partnerIds=[]),t.partnerIds.includes(e.id)||t.partnerIds.push(e.id),d&&s.leaderId&&s.leaderId!==s.id){const m=o.entities.entities[s.leaderId];if(m){const v=Xm(s,m),y=Xm(u,m);if(!v&&!y){const I=Pf();s.leaderId=s.id,s.tribeBadge=I,s.diplomacy={},u.leaderId=s.id,u.tribeBadge=I}}}else if(!e.leaderId&&!t.leaderId&&s&&u){const m=Pf();s.leaderId=s.id,s.tribeBadge=m,s.diplomacy={},u.leaderId=s.id,u.tribeBadge=m}e.activeAction=void 0,ke(o,ce.Procreation,l,Pr),ke(o,ce.Partnered,e.position,xe,e.id),ke(o,ce.Partnered,t.position,xe,t.id),e.lastPartneredEffectTime=o.time,t.lastPartneredEffectTime=o.time,t.activeAction=void 0,Ie(i,fe.Procreate,l)},xR={id:LR,sourceType:UR,targetType:BR,maxDistance:HR,checker:bR,perform:GR},$R={id:"humanChildFeeding",sourceType:"human",targetType:"human",maxDistance:Zf,checker:(e,t)=>e.isAdult===!0&&e.food.length>0&&(!e.feedChildCooldownTime||e.feedChildCooldownTime<=0)&&t.isAdult===!1&&(t.motherId===e.id||t.fatherId===e.id)&&t.hunger>=nr&&e.activeAction==="feeding",perform:(e,t,i)=>{e.food.pop(),t.hunger=Math.max(0,t.hunger-nr),e.feedChildCooldownTime=CE,(!t.lastChildFedEffectTime||i.gameState.time-t.lastChildFedEffectTime>2)&&(ke(i.gameState,ce.ChildFed,t.position,xe,t.id),t.lastChildFedEffectTime=i.gameState.time),Ie(i,fe.ChildFed,t.position)}},zR={id:"human-attack",sourceType:"human",targetType:"human",maxDistance:ti,checker:(e,t,i)=>{var s;if(((s=e.stateMachine)==null?void 0:s[0])!==ir||e.attackTargetId!==t.id||(e.attackCooldown||0)>0)return!1;const o=e.stateMachine[1];return i.gameState.time-o.attackStartTime>=kv},perform:(e,t,i)=>{const o=We(e.position,t.position,i.gameState.mapDimensions.width,i.gameState.mapDimensions.height),l=$E(st(o),t.direction);if(Math.abs(l)<HE*Math.PI/180&&Math.random()<bE)ke(i.gameState,ce.AttackDeflected,t.position,xe,t.id);else{let d=Qf;e.gender==="male"&&(d*=LE),e.isAdult||(d*=UE),(!t.isAdult||t.age>=qf)&&e.isAdult&&(d*=BE),t.hitpoints-=d,t.movementSlowdown={modifier:Jf,endTime:i.gameState.time+eh},ke(i.gameState,ce.Hit,t.position,xe,t.id);const g=We(e.position,t.position,i.gameState.mapDimensions.width,i.gameState.mapDimensions.height),m=Pt(g,kE);t.forces.push(m),t.hitpoints<=0?Ie(i,fe.HumanDeath,t.position):Ie(i,fe.Attack,e.position)}e.attackCooldown=ku;const u=e.stateMachine[1];u.attackStartTime=i.gameState.time,ke(i.gameState,ce.Attack,e.position,xe,e.id)}},WR={id:"human-collision",sourceType:"human",targetType:"human",maxDistance:_t*2,checker:(e,t,{gameState:i})=>Y(e.position,t.position,i.mapDimensions.width,i.mapDimensions.height)<(e.radius+t.radius)/3,perform:(e,t,{gameState:i})=>{const o=Y(e.position,t.position,i.mapDimensions.width,i.mapDimensions.height);if(o===0){e.forces.push({x:.1,y:0}),t.forces.push({x:-.1,y:0});return}const s=(e.radius+t.radius-o)*.05,u=st(Mv(e.position,t.position)),d=Pt(u,s);e.forces.push(d),t.forces.push(Pt(d,-1))}},YR={id:"humanBerryBushGather",sourceType:"human",targetType:"berryBush",maxDistance:vt,checker:(e,t,i)=>{var o;return e.isAdult&&t.food.length>0&&((o=e.stateMachine)==null?void 0:o[0])===Ea&&e.food.length<e.maxFood&&(!e.gatheringCooldownTime||e.gatheringCooldownTime<i.gameState.time)||!1},perform:(e,t,i)=>{const o=t.food.pop();o&&e.food.push(o),e.gatheringCooldownTime=i.gameState.time+1,t.timeSinceLastHarvest=i.gameState.time,ke(i.gameState,ce.BushClaimed,t.position,xe),Ie(i,fe.Gather,e.position)}},jR={id:"corpseGather",sourceType:"human",targetType:"corpse",maxDistance:vt,checker:(e,t,i)=>{var o;return e.isAdult&&t.food.length>0&&((o=e.stateMachine)==null?void 0:o[0])===Ea&&e.food.length<e.maxFood&&(!e.gatheringCooldownTime||e.gatheringCooldownTime<i.gameState.time)||!1},perform:(e,t,i)=>{const o=t.food.pop();o&&e.food.push(o),e.gatheringCooldownTime=i.gameState.time+1,Ie(i,fe.Gather,e.position)}},VR=[YR,jR],XR={id:"prey-eat-berry-bush",sourceType:"prey",targetType:"berryBush",maxDistance:$t,checker:(e,t,i)=>!!(e.isAdult&&t.food.length>0&&e.hunger>30&&(!e.eatingCooldownTime||e.eatingCooldownTime<i.gameState.time)),perform:(e,t,i)=>{t.food.pop()&&(e.hunger=Math.max(0,e.hunger-25),t.lifespan-=DC,t.timeSinceLastHarvest=i.gameState.time,e.eatingCooldownTime=i.gameState.time+NC,ke(i.gameState,ce.BushClaimed,t.position,xe,e.id),Ie(i,fe.Gather,e.position))}},KR={id:"predator-hunt-prey",sourceType:"predator",targetType:"prey",maxDistance:wo,checker:(e,t,i)=>!!(e.isAdult&&e.hunger>50&&(!e.huntCooldown||e.huntCooldown<=0)&&t.hitpoints>0),perform:(e,t,i)=>{t.hitpoints-=UC;const o=We(e.position,t.position,i.gameState.mapDimensions.width,i.gameState.mapDimensions.height),l=Pt(o,8);t.forces.push(l),e.huntCooldown=bC,t.hitpoints<=0?(Ie(i,fe.HumanDeath,t.position),ke(i.gameState,ce.Hit,t.position,xe,t.id)):(ke(i.gameState,ce.Hit,t.position,xe,t.id),t.fleeCooldown=5,Ie(i,fe.Attack,e.position)),ke(i.gameState,ce.Attack,e.position,xe,e.id)}},ZR={id:"human-hunt-prey",sourceType:"human",targetType:"prey",maxDistance:ti,checker:(e,t,i)=>{var o;return!!(((o=e.stateMachine)==null?void 0:o[0])===ir&&e.attackTargetId===t.id&&(!e.attackCooldown||e.attackCooldown<=0)&&t.hitpoints>0&&e.isAdult)},perform:(e,t,i)=>{let o=Qf*1.2;e.gender==="male"&&(o*=1.3),t.hitpoints-=o;const l=We(e.position,t.position,i.gameState.mapDimensions.width,i.gameState.mapDimensions.height),s=Pt(l,6);t.forces.push(s),e.attackCooldown=ku,t.hitpoints<=0?(Ie(i,fe.HumanDeath,t.position),ke(i.gameState,ce.Hit,t.position,xe,t.id)):(ke(i.gameState,ce.Hit,t.position,xe,t.id),t.fleeCooldown=8,Ie(i,fe.Attack,e.position)),ke(i.gameState,ce.Attack,e.position,xe,e.id)}},qR={id:"predator-attack-human",sourceType:"predator",targetType:"human",maxDistance:Mn,checker:(e,t,i)=>{var o;return!!(e.isAdult&&(!e.attackCooldown||e.attackCooldown<=0)&&t.hitpoints>0&&(e.hunger>100||t.attackTargetId===e.id||t.attackTargetId&&((o=i.gameState.entities.entities[t.attackTargetId])==null?void 0:o.type)==="predator"))},perform:(e,t,i)=>{let o=pS;e.hunger>120&&(o*=1.3),t.hitpoints-=o,t.movementSlowdown={modifier:Jf,endTime:i.gameState.time+eh};const l=We(e.position,t.position,i.gameState.mapDimensions.width,i.gameState.mapDimensions.height),s=Pt(l,7);t.forces.push(s),e.attackCooldown=mS,t.hitpoints<=0?(e.hunger=Math.max(0,e.hunger-hh),Ie(i,fe.HumanDeath,t.position),ke(i.gameState,ce.Hit,t.position,xe,t.id)):(ke(i.gameState,ce.Hit,t.position,xe,t.id),Ie(i,fe.Attack,e.position)),ke(i.gameState,ce.Attack,e.position,xe,e.id)}},QR={id:"human-attack-predator",sourceType:"human",targetType:"predator",maxDistance:ti,checker:(e,t,i)=>{var o;return!!(((o=e.stateMachine)==null?void 0:o[0])===ir&&e.attackTargetId===t.id&&(!e.attackCooldown||e.attackCooldown<=0)&&t.hitpoints>0&&e.isAdult)},perform:(e,t,i)=>{let o=Qf*.8;e.gender==="male"&&(o*=1.2);const l=Object.values(i.gameState.entities.entities).filter(d=>d.type==="human"&&d.id!==e.id).filter(d=>{const f=d;return Math.sqrt(Math.pow(f.position.x-e.position.x,2)+Math.pow(f.position.y-e.position.y,2))<100&&f.activeAction==="attacking"&&f.attackTargetId===t.id}).length;l>0&&(o*=1+l*.2),t.hitpoints-=o;const s=We(e.position,t.position,i.gameState.mapDimensions.width,i.gameState.mapDimensions.height),u=Pt(s,8);t.forces.push(u),e.attackCooldown=ku,t.hitpoints<=0?(Ie(i,fe.HumanDeath,t.position),ke(i.gameState,ce.Hit,t.position,xe,t.id)):(ke(i.gameState,ce.Hit,t.position,xe,t.id),t.hitpoints<t.maxHitpoints*.3&&(t.hunger+=20),Ie(i,fe.Attack,e.position)),ke(i.gameState,ce.Attack,e.position,xe,e.id)}},JR={id:"prey-procreation",sourceType:"prey",targetType:"prey",maxDistance:$t,checker:(e,t,i)=>!!(e.isAdult&&t.isAdult&&e.gender!==t.gender&&e.id!==t.id&&!e.isPregnant&&!t.isPregnant&&e.hunger<200&&t.hunger<200&&(!e.procreationCooldown||e.procreationCooldown<=0)&&(!t.procreationCooldown||t.procreationCooldown<=0)),perform:(e,t,i)=>{const o=e.gender==="female"?e:t;o.isPregnant=!0,o.gestationTime=i.gameState.ecosystem.preyGestationPeriod,e.procreationCooldown=i.gameState.ecosystem.preyProcreationCooldown,t.procreationCooldown=i.gameState.ecosystem.preyProcreationCooldown,ke(i.gameState,ce.Procreation,o.position,xe,o.id),Ie(i,fe.Procreate,o.position)}},eP={id:"predator-procreation",sourceType:"predator",targetType:"predator",maxDistance:er,checker:(e,t,i)=>!!(e.isAdult&&t.isAdult&&e.gender!==t.gender&&e.id!==t.id&&!e.isPregnant&&!t.isPregnant&&e.hunger<200&&t.hunger<200&&(!e.procreationCooldown||e.procreationCooldown<=0)&&(!t.procreationCooldown||t.procreationCooldown<=0)),perform:(e,t,i)=>{const o=e.gender==="female"?e:t;o.isPregnant=!0,o.pregnancyFatherId=e.gender==="male"?e.id:t.id,o.gestationTime=i.gameState.ecosystem.predatorGestationPeriod,e.procreationCooldown=i.gameState.ecosystem.predatorProcreationCooldown,t.procreationCooldown=i.gameState.ecosystem.predatorProcreationCooldown,ke(i.gameState,ce.Procreation,o.position,xe,o.id),Ie(i,fe.Procreate,o.position)}},tP={id:"preyChildFeeding",sourceType:"prey",targetType:"prey",maxDistance:Ko,checker:(e,t)=>e.isAdult===!0&&e.gender==="female"&&e.hunger<80&&(!e.feedChildCooldownTime||e.feedChildCooldownTime<=0)&&t.isAdult===!1&&(t.motherId===e.id||t.fatherId===e.id)&&t.hunger>=Tu&&e.activeAction==="feeding",perform:(e,t,i)=>{e.hunger=Math.min(120,e.hunger+10),t.hunger=Math.max(0,t.hunger-Tu),e.feedChildCooldownTime=SS,(!t.lastChildFedEffectTime||i.gameState.time-t.lastChildFedEffectTime>2)&&(ke(i.gameState,ce.ChildFed,t.position,xe,t.id),t.lastChildFedEffectTime=i.gameState.time),Ie(i,fe.ChildFed,t.position)}},nP={id:"predatorChildFeeding",sourceType:"predator",targetType:"predator",maxDistance:Ko,checker:(e,t)=>e.isAdult===!0&&e.gender==="female"&&e.hunger<90&&(!e.feedChildCooldownTime||e.feedChildCooldownTime<=0)&&t.isAdult===!1&&(t.motherId===e.id||t.fatherId===e.id)&&t.hunger>=Tu&&e.activeAction==="feeding",perform:(e,t,i)=>{e.hunger=Math.min(140,e.hunger+15),t.hunger=Math.max(0,t.hunger-Tu),e.feedChildCooldownTime=SS,(!t.lastChildFedEffectTime||i.gameState.time-t.lastChildFedEffectTime>2)&&(ke(i.gameState,ce.ChildFed,t.position,xe,t.id),t.lastChildFedEffectTime=i.gameState.time),Ie(i,fe.ChildFed,t.position)}},iP={id:"predator-eat-corpse",sourceType:"predator",targetType:"corpse",maxDistance:er,checker:(e,t,i)=>!!(e.isAdult&&e.hunger>30&&t.food.length>0&&(!e.eatingCooldownTime||e.eatingCooldownTime<=i.gameState.time)),perform:(e,t,i)=>{t.food.pop()&&(e.hunger=Math.max(0,e.hunger-hh),e.eatingCooldownTime=i.gameState.time+2,ke(i.gameState,ce.Eating,e.position,xe,e.id),Ie(i,fe.Gather,e.position))}},rP={id:"predator-attack-rival",sourceType:"predator",targetType:"predator",maxDistance:Mn,checker:(e,t,i)=>{var o;return!!(e.isAdult&&(!e.attackCooldown||e.attackCooldown<=0)&&t.hitpoints>0&&(e.hunger>100||t.attackTargetId===e.id||t.attackTargetId&&((o=i.gameState.entities.entities[t.attackTargetId])==null?void 0:o.type)==="predator"))},perform:(e,t,i)=>{let o=pS;e.hunger>120&&(o*=1.3),t.hitpoints-=o,t.movementSlowdown={modifier:Jf,endTime:i.gameState.time+eh};const l=We(e.position,t.position,i.gameState.mapDimensions.width,i.gameState.mapDimensions.height),s=Pt(l,7);t.forces.push(s),e.attackCooldown=mS,t.hitpoints<=0?(e.hunger=Math.max(0,e.hunger-hh),Ie(i,fe.HumanDeath,t.position),ke(i.gameState,ce.Hit,t.position,xe,t.id)):(ke(i.gameState,ce.Hit,t.position,xe,t.id),Ie(i,fe.Attack,e.position)),ke(i.gameState,ce.Attack,e.position,xe,e.id)}},oP={id:"storageDeposit",sourceType:"human",targetType:"building",maxDistance:In,checker:(e,t,i)=>{var s;if(t.buildingType!=="storageSpot"||((s=e.stateMachine)==null?void 0:s[0])!==ta||!t.isConstructed||e.food.length===0)return!1;t.storedFood||(t.storedFood=[]);const o=t.storageCapacity??0;return!(t.storedFood.length>=o||e.leaderId!==t.ownerId||i.gameState.time-(t.lastDepositTime??0)<B_)},perform:(e,t,i)=>{t.storedFood||(t.storedFood=[]);const o=e.food.pop();o&&t.storedFood.push({item:o,positionOffset:IS(t)}),t.lastDepositTime=i.gameState.time,Ie(i,fe.StorageDeposit,t.position)}},sP={id:"storageRetrieve",sourceType:"human",targetType:"building",maxDistance:In,checker:(e,t,i)=>{var l;return!(t.buildingType!=="storageSpot"||((l=e.stateMachine)==null?void 0:l[0])!==na||!t.isConstructed||!t.storedFood||t.storedFood.length===0||e.food.length>=e.maxFood||e.leaderId!==t.ownerId||i.gameState.time-(t.lastRetrieveTime??0)<H_)},perform:(e,t,i)=>{if(!t.storedFood||t.storedFood.length===0)return;const o=t.storedFood.pop();o&&(e.food.push(o.item),IS(t)),t.lastRetrieveTime=i.gameState.time,Ie(i,fe.StorageRetrieve,t.position)}},aP={id:"storageSteal",sourceType:"human",targetType:"building",maxDistance:In,checker:(e,t,i)=>{var d;if(t.buildingType!=="storageSpot"||((d=e.stateMachine)==null?void 0:d[0])!==Ea||!t.isConstructed||!t.storedFood||t.storedFood.length===0||e.food.length>=e.maxFood||e.leaderId===t.ownerId)return!1;const o=e.leaderId?i.gameState.entities.entities[e.leaderId]:void 0;if(!o||!o.diplomacy||o.diplomacy[t.ownerId]!==mt.Hostile||i.gameState.time-(t.lastStealTime??0)<b_)return!1;const u=Hn({leaderId:t.ownerId},i.gameState);for(const f of u)if(Y(e.position,f.position,i.gameState.mapDimensions.width,i.gameState.mapDimensions.height)<=Df)return!1;return!0},perform:(e,t,i)=>{if(!t.storedFood||t.storedFood.length===0)return;const o=t.storedFood.pop();o&&e.food.push(o.item),t.lastStealTime=i.gameState.time,Ie(i,fe.StorageSteal,t.position),ke(i.gameState,ce.Attack,t.position,.5)}},lP={id:"human-takeover-building",sourceType:"human",targetType:"building",maxDistance:20,checker:(e,t,i)=>e.leaderId!==e.id||e.activeAction!=="takingOverBuilding"?!1:Fn(e,t,i.gameState),perform:(e,t,i)=>{t.ownerId=e.id,t.constructionProgress=1,t.isConstructed=!0,t.isBeingDestroyed=!1,t.destructionProgress=0,e.activeAction="idle",ke(i.gameState,ce.BushClaimed,t.position,2,t.id)}},uP={id:"human-remove-enemy-building",sourceType:"human",targetType:"building",maxDistance:20,checker:(e,t,i)=>!(e.leaderId!==e.id||e.activeAction!=="destroyingBuilding"||!Fn(e,t,i.gameState)||t.isBeingDestroyed),perform:(e,t,i)=>{t.isBeingDestroyed=!0,e.activeAction="idle",ke(i.gameState,ce.Hit,t.position,1,t.id)}},cP=[WR,...VR,xR,$R,zR,oP,sP,aP,lP,uP,XR,tP,nP,iP,KR,ZR,QR,qR,rP,JR,eP];function dP(e){const{gameState:t}=e,i=t,o=Object.values(t.entities.entities);for(const l of cP)for(const s of o){if(l.sourceType&&s.type!==l.sourceType)continue;const u=i.search[l.targetType].byRadius(s.position,l.maxDistance);for(const d of u){if(s.id===d.id)continue;Y(s.position,d.position,t.mapDimensions.width,t.mapDimensions.height)<=l.maxDistance&&l.checker(s,d,e)&&l.perform(s,d,e)}}}function fP(e){e.visualEffects=e.visualEffects.filter(t=>e.time-t.startTime<=t.duration)}function hP(e){const t=e.search.berryBush.byProperty("type","berryBush"),i=e.search.predator.byProperty("type","predator"),o=e.search.human.byProperty("type","human");for(let l=0;l<20;l++){let s;if(t.length>0&&l<15){const f=t[Math.floor(Math.random()*t.length)],g=Math.random()*2*Math.PI,m=50+Math.random()*100;s={x:Math.max(50,Math.min(et-50,f.position.x+Math.cos(g)*m)),y:Math.max(50,Math.min(tt-50,f.position.y+Math.sin(g)*m))}}else s={x:50+Math.random()*(et-100),y:50+Math.random()*(tt-100)};let u=!0;const d=100;for(const f of i)if(Math.sqrt((s.x-f.position.x)**2+(s.y-f.position.y)**2)<d){u=!1;break}if(u){for(const f of o)if(Math.sqrt((s.x-f.position.x)**2+(s.y-f.position.y)**2)<d){u=!1;break}}if(u)return s}return{x:et*.3+Math.random()*et*.4,y:tt*.3+Math.random()*tt*.4}}function gP(e){const t=e.search.prey.byProperty("type","prey"),i=e.search.human.byProperty("type","human");for(let l=0;l<15;l++){let s;if(t.length>0&&l<10){const f=t[Math.floor(Math.random()*t.length)],g=Math.random()*2*Math.PI,m=100+Math.random()*150;s={x:Math.max(50,Math.min(et-50,f.position.x+Math.cos(g)*m)),y:Math.max(50,Math.min(tt-50,f.position.y+Math.sin(g)*m))}}else s={x:50+Math.random()*(et-100),y:50+Math.random()*(tt-100)};let u=!0;const d=150;for(const f of i)if(Math.sqrt((s.x-f.position.x)**2+(s.y-f.position.y)**2)<d){u=!1;break}if(u)return s}switch(Math.floor(Math.random()*4)){case 0:return{x:Math.random()*et,y:50+Math.random()*100};case 1:return{x:et-150+Math.random()*100,y:Math.random()*tt};case 2:return{x:Math.random()*et,y:tt-150+Math.random()*100};default:return{x:50+Math.random()*100,y:Math.random()*tt}}}function pP(e){const t=e.search.human.byProperty("type","human"),i=e.search.berryBush.byProperty("type","berryBush");for(let o=0;o<20;o++){const l={x:50+Math.random()*(et-100),y:50+Math.random()*(tt-100)};let s=!0;const u=80,d=60;for(const f of t)if(Math.sqrt((l.x-f.position.x)**2+(l.y-f.position.y)**2)<u){s=!1;break}if(s){for(const f of i)if(Math.sqrt((l.x-f.position.x)**2+(l.y-f.position.y)**2)<d){s=!1;break}}if(s)return l}return{x:Math.random()*et,y:Math.random()*tt}}function DS(e,t=4){console.log(` Respawning ${t} prey to prevent extinction`);const i=e;for(let o=0;o<t;o++){const l=hP(i),s=o%2===0?"male":"female";zo(e.entities,l,s,void 0,void 0,ma())}}function OS(e,t=2){console.log(` Respawning ${t} predators to prevent extinction`);const i=e;for(let o=0;o<t;o++){const l=gP(i),s=o%2===0?"male":"female";Wo(e.entities,l,s,void 0,void 0,va())}}function mP(e){const t=e,i=t.search.prey.count(),o=t.search.predator.count();let l=!1;return i===0&&(DS(e,6),l=!0),o===0&&(OS(e,3),l=!0),l}function vP(e){const t=e,i=t.search.prey.count(),o=t.search.predator.count(),l=t.search.berryBush.count();let s=!1;if(i>0&&i<5){const u=Math.max(2,Math.floor(8-i));DS(e,u),s=!0}if(o>0&&o<2){const u=Math.max(1,Math.floor(3-o));OS(e,u),s=!0}if(l<5){console.log(` Boosting bush count from ${l} to help ecosystem`);for(let u=0;u<5;u++){const d=pP(t);_a(e.entities,d,e.time)}s=!0}return s}const SP=1,yP=.3,TP=.8,C0=.8,AP=.99,IP=.05;var kS=(e=>(e[e.INCREASE_PREY_GESTATION=0]="INCREASE_PREY_GESTATION",e[e.DECREASE_PREY_GESTATION=1]="DECREASE_PREY_GESTATION",e[e.INCREASE_PREY_PROCREATION_COOLDOWN=2]="INCREASE_PREY_PROCREATION_COOLDOWN",e[e.DECREASE_PREY_PROCREATION_COOLDOWN=3]="DECREASE_PREY_PROCREATION_COOLDOWN",e[e.INCREASE_PREY_HUNGER=4]="INCREASE_PREY_HUNGER",e[e.DECREASE_PREY_HUNGER=5]="DECREASE_PREY_HUNGER",e[e.INCREASE_PREDATOR_GESTATION=6]="INCREASE_PREDATOR_GESTATION",e[e.DECREASE_PREDATOR_GESTATION=7]="DECREASE_PREDATOR_GESTATION",e[e.INCREASE_PREDATOR_PROCREATION_COOLDOWN=8]="INCREASE_PREDATOR_PROCREATION_COOLDOWN",e[e.DECREASE_PREDATOR_PROCREATION_COOLDOWN=9]="DECREASE_PREDATOR_PROCREATION_COOLDOWN",e[e.INCREASE_PREDATOR_HUNGER=10]="INCREASE_PREDATOR_HUNGER",e[e.DECREASE_PREDATOR_HUNGER=11]="DECREASE_PREDATOR_HUNGER",e[e.INCREASE_BUSH_SPREAD=12]="INCREASE_BUSH_SPREAD",e[e.DECREASE_BUSH_SPREAD=13]="DECREASE_BUSH_SPREAD",e[e.NO_ACTION=14]="NO_ACTION",e))(kS||{});const of=Object.keys(kS).length/2;class EP{constructor(){Oe(this,"qTable",new Map);Oe(this,"epsilon",C0);Oe(this,"lastState",null);Oe(this,"lastAction",null)}discretizeState(t,i,o){const l=Math.min(4,Math.floor(t/25)),s=Math.min(4,Math.floor(i/5)),u=Math.min(4,Math.floor(o/15));return`${l}-${s}-${u}`}getQValue(t,i){return this.qTable.has(t)||this.qTable.set(t,new Map),this.qTable.get(t).get(i)||0}setQValue(t,i,o){this.qTable.has(t)||this.qTable.set(t,new Map),this.qTable.get(t).set(i,o)}getBestAction(t){let i=0,o=this.getQValue(t,0);for(let l=1;l<of;l++){const s=this.getQValue(t,l);s>o&&(o=s,i=l)}return i}chooseAction(t){return Math.random()<this.epsilon?Math.floor(Math.random()*of):this.getBestAction(t)}applyEmergencyCorrections(t,i,o,l){t<pi*.5&&(l.ecosystem.preyGestationPeriod=Math.max(Ro,l.ecosystem.preyGestationPeriod*.8),l.ecosystem.preyProcreationCooldown=Math.max(Po,l.ecosystem.preyProcreationCooldown*.8),l.ecosystem.preyHungerIncreasePerHour=Math.max(Oo,l.ecosystem.preyHungerIncreasePerHour*.9)),i<mi*.6&&(l.ecosystem.predatorGestationPeriod=Math.max(No,l.ecosystem.predatorGestationPeriod*.75),l.ecosystem.predatorProcreationCooldown=Math.max(Do,l.ecosystem.predatorProcreationCooldown*.75),l.ecosystem.predatorHungerIncreasePerHour=Math.max(ko,l.ecosystem.predatorHungerIncreasePerHour*.85)),o<vi*.5&&(l.ecosystem.berryBushSpreadChance=Math.min(Vs,l.ecosystem.berryBushSpreadChance*1.2)),t>pi*1.4&&(l.ecosystem.preyHungerIncreasePerHour=Math.min(Zi,l.ecosystem.preyHungerIncreasePerHour*1.05)),i>mi*1.4&&(l.ecosystem.predatorHungerIncreasePerHour=Math.min(qi,l.ecosystem.predatorHungerIncreasePerHour*1.05)),o>vi*1.4&&(l.ecosystem.berryBushSpreadChance=Math.max(Si,l.ecosystem.berryBushSpreadChance*.95))}calculateReward(t,i,o){const l=Math.abs(t-pi),s=Math.abs(i-mi),u=Math.abs(o-vi),d=l/pi,f=s/mi,g=u/vi,m=d+f+g;return 100*Math.exp(-m*2)-50}applyAction(t,i){switch(t){case 0:i.ecosystem.preyGestationPeriod=Math.min(Or,i.ecosystem.preyGestationPeriod+.2*(Or-Ro));break;case 1:i.ecosystem.preyGestationPeriod=Math.max(Ro,i.ecosystem.preyGestationPeriod-.2*(Or-Ro));break;case 2:i.ecosystem.preyProcreationCooldown=Math.min(kr,i.ecosystem.preyProcreationCooldown+.2*(kr-Po));break;case 3:i.ecosystem.preyProcreationCooldown=Math.max(Po,i.ecosystem.preyProcreationCooldown-.2*(kr-Po));break;case 4:i.ecosystem.preyHungerIncreasePerHour=Math.min(Zi,i.ecosystem.preyHungerIncreasePerHour+.2*(Zi-Oo));break;case 5:i.ecosystem.preyHungerIncreasePerHour=Math.max(Oo,i.ecosystem.preyHungerIncreasePerHour-.2*(Zi-Oo));break;case 6:i.ecosystem.predatorGestationPeriod=Math.min(Mr,i.ecosystem.predatorGestationPeriod+.2*(Mr-No));break;case 7:i.ecosystem.predatorGestationPeriod=Math.max(No,i.ecosystem.predatorGestationPeriod-.2*(Mr-No));break;case 8:i.ecosystem.predatorProcreationCooldown=Math.min(Fr,i.ecosystem.predatorProcreationCooldown+.2*(Fr-Do));break;case 9:i.ecosystem.predatorProcreationCooldown=Math.max(Do,i.ecosystem.predatorProcreationCooldown-.2*(Fr-Do));break;case 10:i.ecosystem.predatorHungerIncreasePerHour=Math.min(qi,i.ecosystem.predatorHungerIncreasePerHour+.2*(qi-ko));break;case 11:i.ecosystem.predatorHungerIncreasePerHour=Math.max(ko,i.ecosystem.predatorHungerIncreasePerHour-.2*(qi-ko));break;case 12:i.ecosystem.berryBushSpreadChance=Math.min(Vs,i.ecosystem.berryBushSpreadChance+.2*(Vs-Si));break;case 13:i.ecosystem.berryBushSpreadChance=Math.max(Si,i.ecosystem.berryBushSpreadChance-.2*(Vs-Si));break}}updateQTable(t,i,o,l){const s=this.getQValue(t,i),u=Math.max(...Array.from({length:of},(f,g)=>this.getQValue(l,g))),d=s+yP*(o+TP*u-s);this.setQValue(t,i,d)}step(t){const i=t,o=i.search.prey.count(),l=i.search.predator.count(),s=i.search.berryBush.count();this.applyEmergencyCorrections(o,l,s,t);const u=this.discretizeState(o,l,s);if(this.lastState!==null&&this.lastAction!==null){const f=this.calculateReward(o,l,s);this.updateQTable(this.lastState,this.lastAction,f,u)}const d=this.chooseAction(u);this.applyAction(d,t),this.epsilon=Math.max(IP,this.epsilon*AP),this.lastState=u,this.lastAction=d}reset(){this.qTable.clear(),this.epsilon=C0,this.lastState=null,this.lastAction=null}getStats(){return{qTableSize:this.qTable.size,explorationRate:this.epsilon}}}let MS=new EP;function wP(e){mP(e),vP(e),e.ecosystem.lastUpdateTime||(e.ecosystem.preyGestationPeriod=Ro+(Or-Ro)*.3,e.ecosystem.preyProcreationCooldown=Po+(kr-Po)*.3,e.ecosystem.preyHungerIncreasePerHour=Oo+(Zi-Oo)*.3,e.ecosystem.predatorGestationPeriod=No+(Mr-No)*.3,e.ecosystem.predatorProcreationCooldown=Do+(Fr-Do)*.3,e.ecosystem.predatorHungerIncreasePerHour=ko+(qi-ko)*.3,e.ecosystem.berryBushSpreadChance=Si+(Vs-Si)*.7),MS.step(e)}function _P(e){e.ecosystem.lastUpdateTime||(e.ecosystem.lastUpdateTime=0),!(e.time-e.ecosystem.lastUpdateTime<SP)&&(e.ecosystem.lastUpdateTime=e.time,wP(e))}function CP(){return MS.getStats()}function RP(e,t){e.selectedBuildingType&&e.selectedBuildingType!=="removal"&&(e.autopilotControls.activeAutopilotAction=void 0,e.autopilotControls.hoveredAutopilotAction=void 0)}const PP=1/60;function NP(e,t){const i=St(e);i&&(e.viewportCenter=th(e.viewportCenter,i.position,jf*t))}function Bu(e,t){if(e.isPaused)return e;if(e.autosaveIntervalSeconds){const i=Date.now();i-e.lastAutosaveTime>e.autosaveIntervalSeconds*1e3&&(Hf(e),e.lastAutosaveTime=i)}for(;t>0;){const i=wu(e),o=Math.min(t,PP),l=o*(Et/wt);i.time+=l,NP(i,o),I_(i),_P(i),E_(i),IR({gameState:i,deltaTime:o}),dP({gameState:i,deltaTime:o}),fP(i),DR(i,o),RP(i),e=i,t-=o}return e}function sf(e,t,i){e.save();const{x:o,y:l,width:s,height:u}=t.rect,d=zv;if(e.beginPath(),e.moveTo(o+d,l),e.lineTo(o+s-d,l),e.quadraticCurveTo(o+s,l,o+s,l+d),e.lineTo(o+s,l+u-d),e.quadraticCurveTo(o+s,l+u,o+s-d,l+u),e.lineTo(o+d,l+u),e.quadraticCurveTo(o,l+u,o,l+u-d),e.lineTo(o,l+d),e.quadraticCurveTo(o,l,o+d,l),e.closePath(),e.fillStyle=t.isDisabled?Wv:t.backgroundColor,e.fill(),t.activated){e.save();const f=(Math.sin(Date.now()/1e3*Xv)+1)/2;e.strokeStyle=Vv,e.lineWidth=2+f*2,e.globalAlpha=.7+f*.3,e.stroke(),e.restore()}if(t.lastActivated){const f=Date.now()-t.lastActivated;if(f<yu){const g=1-f/yu;e.fillStyle=jv,e.globalAlpha=g,e.fill(),e.globalAlpha=1}}i&&!t.isDisabled&&(e.fillStyle=oh,e.globalAlpha=.5,e.fill(),e.globalAlpha=1),e.fillStyle=t.isDisabled?Yv:t.textColor,t.icon?(e.font=`${u*.55}px "Press Start 2P", Arial`,e.textAlign="center",e.textBaseline="middle",e.fillText(t.icon,o+s/2,l+u/2),t.text&&(e.font=`${u*.18}px "Press Start 2P", Arial`,e.textAlign="right",e.textBaseline="bottom",e.fillText(t.text,o+s-4,l+u-2))):(e.textAlign="center",e.textBaseline="middle",e.fillText(t.text,o+s/2,l+u/2)),e.restore()}function DP(e,t,i,o){e.save(),e.font=`${t0}px "Press Start 2P", Arial`,e.textAlign="center",e.textBaseline="bottom";const s=e.measureText(i).width,u=t0,d=s+n0*2,f=u+n0*2,g=o.x-d/2,m=e.canvas.height,v=t.y<m/2?t.y+t.height-i0:t.y-f+i0;e.fillStyle=Nw,e.fillRect(g,v,d,f),e.fillStyle=Dw,e.fillText(i,o.x,v+f/2+u/2),e.restore()}function OP(e,t,i){e.save();const o=St(t),l=[{id:"fastForwardButton",action:ge.FastForward,text:"FFWD [T]",currentWidth:gi*1.3,backgroundColor:Vi,textColor:yn,tooltip:"Fast-forward time",rect:{x:0,y:0,width:0,height:0}},{id:"pauseButton",action:ge.TogglePause,text:t.isPaused?"UN[P]AUSE":"[P]AUSE",backgroundColor:t.isPaused?Gl:Vi,currentWidth:t.isPaused?gi*1.4:gi*1.1,tooltip:t.isPaused?"Resume Game":"Pause Game",rect:{x:0,y:0,width:0,height:0},textColor:yn},{id:"muteButton",action:ge.ToggleMute,text:t.isMuted?"UN[M]UTE":"[M]UTE",backgroundColor:t.isMuted?Gl:Vi,tooltip:`Toggle Sound (${t.isMuted?"Muted":"Enabled"})`,currentWidth:gi,rect:{x:0,y:0,width:0,height:0},textColor:yn},{id:"returnToIntroButton",action:ge.ReturnToIntro,text:"EXIT",backgroundColor:Vi,tooltip:"Return to Main Menu [ESC]",currentWidth:gi*.9,rect:{x:0,y:0,width:0,height:0},textColor:yn}];if(t.uiButtons.push(...l),o){const g=ch(t,o),m=new Set(g.map(B=>B.type));let v=[{playerAction:se.Gather,buttonAction:ge.CommandGather,shortcut:"E",name:"Gather",toggleKey:"gathering",condition:()=>o.isAdult===!0},{playerAction:se.Eat,buttonAction:ge.CommandEat,shortcut:"F",name:"Eat"},{playerAction:se.Plant,buttonAction:ge.CommandPlant,shortcut:"B",name:"Plant",toggleKey:"planting",condition:()=>o.isAdult===!0},{playerAction:se.Procreate,buttonAction:ge.ToggleProcreationBehavior,shortcut:"R",name:"Procreation",toggleKey:"procreation",condition:()=>o.isAdult===!0},{playerAction:se.FeedChild,buttonAction:ge.ToggleFeedChildBehavior,shortcut:"H",name:"Feed Child",toggleKey:"feedChildren",condition:()=>o.isAdult===!0},{playerAction:se.Attack,buttonAction:ge.ToggleAttackBehavior,shortcut:"Q",name:"Attack",toggleKey:"attack",condition:()=>o.isAdult===!0&&o.leaderId===o.id},{playerAction:se.FollowMe,buttonAction:ge.CommandFollowMe,shortcut:"C",name:"Follow Me",toggleKey:"followLeader",condition:()=>o.isAdult===!0&&o.leaderId===o.id},{playerAction:se.CallToAttack,buttonAction:ge.CommandCallToAttack,shortcut:"V",name:"Call to Attack",condition:()=>o.isAdult===!0&&o.leaderId===o.id},{playerAction:se.TribeSplit,buttonAction:ge.CommandTribeSplit,shortcut:"K",name:"Split Tribe",condition:()=>o.leaderId!==void 0&&o.leaderId!==o.id&&o.isAdult===!0},{playerAction:se.Build,buttonAction:ge.CommandBuild,shortcut:"L",name:"Build",condition:()=>o.isAdult===!0&&o.leaderId===o.id}];v=v.filter(B=>B.condition?B.condition():!0);const y=1,I=v.length,E=I*rn+(I-1)*Ar,A=y*rn+(y-1)*Ar,w=(i-E)/2,F=e.canvas.height-A-20;if(v.forEach((B,D)=>{const H=D%I,b=Math.floor(D/I),L=w+H*(rn+Ar),$=F+b*(rn+Ar),Q=!!B.toggleKey,_e=Q&&t.autopilotControls.behaviors[B.toggleKey],Ce=!m.has(B.playerAction),De=B.playerAction===se.Build&&t.buildMenuOpen,Pe=!t.hasPlayerEnabledAutopilot||t.hasPlayerEnabledAutopilot<3?" (Press Shift to toggle Auto)":"",de=Q?`${B.name}${Pe}`:B.name,Le=_e||De?Gl:Vi,Te={id:`commandButton_${B.name}`,action:B.buttonAction,rect:{x:L,y:$,width:rn,height:rn},icon:Fu[B.playerAction],text:B.shortcut,backgroundColor:Le,textColor:yn,currentWidth:rn,tooltip:de,isDisabled:Ce,activated:_e||De};t.uiButtons.push(Te)}),t.buildMenuOpen){const B=[{id:"buildMenu_storageSpot",action:ge.SelectStorageSpot,icon:"",shortcut:"1",name:"Storage Spot"},{id:"buildMenu_plantingZone",action:ge.SelectPlantingZone,icon:"",shortcut:"2",name:"Planting Zone"},{id:"buildMenu_removal",action:ge.SelectRemovalTool,icon:"",shortcut:"3",name:"Remove Building"}],D=B.length,H=D*rn+(D-1)*Ar,b=(i-H)/2,L=F-rn-Ar;B.forEach(($,Q)=>{const _e=b+Q*(rn+Ar),Ce=L,be=$.action===ge.SelectStorageSpot&&t.selectedBuildingType==="storageSpot"||$.action===ge.SelectPlantingZone&&t.selectedBuildingType==="plantingZone"||$.action===ge.SelectRemovalTool&&t.selectedBuildingType==="removal",De={id:$.id,action:$.action,rect:{x:_e,y:Ce,width:rn,height:rn},icon:$.icon,text:$.shortcut,backgroundColor:be?Gl:Vi,textColor:yn,currentWidth:rn,tooltip:$.name,activated:be};t.uiButtons.push(De),sf(e,De,t.hoveredButtonId===De.id)})}}let s=i-je;l.forEach(g=>{const m=je,v=s-g.currentWidth;g.rect={x:v,y:m,width:g.currentWidth,height:$v},sf(e,g,t.hoveredButtonId===g.id),s-=g.currentWidth+Pw});let u=null;t.uiButtons.filter(g=>g.id.startsWith("commandButton_")||g.id.startsWith("buildMenu_")).forEach(g=>{u||(u={x:g.rect.x,y:g.rect.y,width:g.rect.width,height:g.rect.height}),u.x=Math.min(u.x,g.rect.x),u.y=Math.min(u.y,g.rect.y),u.width=Math.max(u.width,g.rect.x+g.rect.width-u.x),u.height=Math.max(u.height,g.rect.y+g.rect.height-u.y),g.id.startsWith("commandButton_")&&sf(e,g,t.hoveredButtonId===g.id)});const f=t.hoveredButtonId?t.uiButtons.find(g=>g.id===t.hoveredButtonId):void 0;return f&&f.tooltip&&t.mousePosition&&DP(e,f.rect,f.tooltip,t.mousePosition),e.restore(),{commandButtonsRect:u}}function kP(e){e.save(),e.fillStyle=xw,e.fillRect(0,0,e.canvas.width,e.canvas.height),e.fillStyle=$w,e.font=`${zw}px "Press Start 2P", Arial`,e.textAlign="center",e.textBaseline="middle",e.fillText("PAUSED",e.canvas.width/2,e.canvas.height/2),e.restore()}function Mf(e,t,i,o){const l=t.x-i.width/2,s=t.y-i.height/2,u=l+e.x,d=s+e.y,f=(u%o.width+o.width)%o.width,g=(d%o.height+o.height)%o.height;return{x:f,y:g}}function Hu(e,t,i,o){let l=e.x-t.x,s=e.y-t.y;return Math.abs(l)>o.width/2&&(l=l-Math.sign(l)*o.width),Math.abs(s)>o.height/2&&(s=s-Math.sign(s)*o.height),{x:l+i.width/2,y:s+i.height/2}}function Ql(e,t,i,o){const l=Hu(e.position,t,i,o),u=("radius"in e?e.radius:20)+20;return l.x>=-u&&l.x<=i.width+u&&l.y>=-u&&l.y<=i.height+u}function an(e,t,i,o,l,...s){const u={...l.position};for(let d=-i;d<=i;d+=i)for(let f=-t;f<=t;f+=t)l.position.x=u.x+f,l.position.y=u.y+d,o(e,l,...s);l.position=u}const MP=25,FP=0,R0=28;function FS(e,t,i,o,l,s,u,d,f,g){e.save();const{x:m,y:v}=Hu(t,u,{width:d,height:f},g);e.strokeStyle=o,e.lineWidth=s,e.setLineDash(l),e.beginPath(),e.arc(m,v,i+Mu,0,2*Math.PI),e.stroke(),e.restore()}function LP(e,t,i,o,l,s,u){if(t=t.filter(v=>v.type!==se.FollowMe),t.length===0)return;e.save(),t.forEach(v=>{v.targetEntity&&FS(e,v.targetEntity.position,v.targetEntity.radius,ih,rh,2,o,l,s,u)}),e.font=`${Go}px "Press Start 2P", Arial`,e.fillStyle="white",e.textAlign="center",e.textBaseline="bottom",e.shadowColor="black",e.shadowBlur=5;const{x:d,y:f}=Hu(i.position,o,{width:l,height:s},u);let g=0,m={};t.forEach(v=>{const y=Fu[v.type];if(v.targetEntity){m[v.targetEntity.id]=(m[v.targetEntity.id]||0)+1;const I=v.targetEntity.position.x-o.x+l/2,E=v.targetEntity.position.y-o.y+s/2,A=`${y}${v.key.toUpperCase()}`,w=E-v.targetEntity.radius-Mu-Go/2-(m[v.targetEntity.id]-1)*R0;e.fillText(A,I,w)}else{e.textAlign="left";const I=`${y}${v.key.toUpperCase()}`,E=d+MP,w=f+FP+g*R0;e.fillText(I,E,w),g++,e.textAlign="center"}}),e.restore()}const ye=(e,t,i,o,l,s,u)=>{s==="transparent"||o<=0||l<=0||(e.fillStyle=s,e.fillRect(Math.floor(t*u),Math.floor(i*u),Math.ceil(o*u),Math.ceil(l*u)))},P0=10,N0=10,qn=6,di=4,Jl=2,UP=5,Sn=4,BP=2,Mt=4,HP=2,Je=3,Ao=2,ji=0,oa=ji+di-1,Ht=oa,ut=oa+Sn-1,bP="rgba(0, 0, 0, 0.4)",GP=4,xP=1,vh={name:"tribe-human-2d",referenceImage:"swos.png",description:`A 2D human character asset for the Tribe game. This includes ensuring that the unique animations for stances like 'eat' and 'procreate' do not erroneously appear in other stances, such as 'walk', which was observed in the provided rendered media. The 'idle' animation was updated to a leg sway to better match the provided video for that stance, replacing a simpler body bob.

# Visual style

Human characters in the Tribe game are inspired by classic 2D pixel art, they look like Sensible Soccer players(Sensible Soccer game visual style is IMPORTANT), with a simple and recognizable design. The characters are designed to be easily distinguishable and animated in a way that conveys their actions clearly.

Character in Tribe game look like people from stone age, they have simple clothing, no shoes, and no modern accessories. The characters are designed to be easily distinguishable and animated in a way that conveys their actions clearly.

# Technical details

The asset is rendered on a canvas using the CanvasRenderingContext2D API. The rendering function takes parameters for position, size, progress, stance, direction, gender, and age. The character can face left or right, and the rendering adapts based on the stance (e.g., idle, walk, eat, procreate).
The rendering function must be simple and efficient, it should not use complex patterns or gradients, and should focus on solid colors and basic shapes to maintain the pixel art aesthetic.

15% padding from all edges of the rendering box is required to ensure the character is not cut off during rendering.

Subtle shadow should be drawn under the character to give it a sense of depth.

# Rendering parameters

- age: The age of the character, which affects the size and proportions of the body parts. Age is a number between 1 and 60, with 20 being the average age.
- gender: 
  - The male characters should have only pants, while female cover their breasts with a top. The clothing should be simple and muted, reflecting a stone-age style.
  - Female characters should have long hair, while male should have short hair and beard.
  - Male characters should have a more robust, muscular build
  - Female characters should have thinner arms and legs, with a more pronounced waist and hips.
- isPregnant: (applicable only for females) Indicates if the character is pregnant, like very large belly. Pregnant characters should have a larger torso.
- direction: A vector indicating the character's facing direction. There should be at least 8 directions (like in Sensible Soccer): top left, top, top right, left, right, bottom left, bottom, bottom right. The character should be flipped horizontally if the direction vector's X component is negative.
             When moving up(top, top left, top right), the character back of the head should be visible, when moving down(Y > 0), the character face should be visible.
- hungryLevel: A number between 0 and 100 indicating how hungry the character is, hunger level 100 means the character is starving, 0 means the character is not hungry at all. So hungry characters should be thinner, with less body fat, and more pronounced muscles. The character's hunger level affects the size and proportions of the body parts, with hungrier characters being smaller and more gaunt.

# Rendering details

- All parts of the body must be connected
- Rendering must take into account direction vector (X and Y) to flip the character horizontally if needed
- The character's age affects the size and proportions of the body parts, with older characters being larger and more robust. Hair color should become gray for older characters.

# Stances

- 'idle': The character stands still, with a slight leg sway to indicate life.
- 'walk': The character moves forward, with legs and arms in motion.
- 'gathering': The character is gathering food from berry bushes, with arms reaching out and a slight bend at the knees.
- 'eat': The character holds food and brings it to their mouth, with a slight bend at the knees.
- 'procreate': The character performs a mating animation, with a specific pose and movement. There should be some additional visual effects to indicate this action, such as a slight glow or aura around the characters, or dust particles to indicate movement.
- 'attacking': The character performs an attack animation, with arms raised and a forward motion.
- 'defending': The character takes a defensive stance, with arms raised and a slight bend at the knees.
- 'stunned': The character is stunned and laying on the ground, with limbs relaxed and a neutral expression.
- 'dead': The character lies on the ground, with limbs relaxed and a neutral expression, slowly turns into a skeleton over time.

`,stances:["idle","walk","gathering","eat","procreate","dead","attacking","defending","stunned"],render(e,t,i,o,l,s,u,d="male",f=20,g=[1,0],m=!1,v=0){const y=["dead","stunned"].includes(u),I=y?N0+4:P0,E=y?P0+4:N0+Je,A=.15,w=Math.min(o*(1-2*A)/I,l*(1-2*A)/E),F=I*w,B=E*w,D=t+(o-F)/2,H=i+(l-B)/2;e.save(),g[0]<0&&!y?(e.translate(D+F,H),e.scale(-1,1)):e.translate(D,H);const L="#D09A5A",$=f>50?"#BDBDBD":"#281808",Q="#7F5C4A",_e="#6B4F3A",Ce="#E0D8C0",be="#A0522D",De=1-Math.max(0,Math.min(100,v))/100*.2,Pe=d==="male"?1.1:.9,de=.8+(Math.max(1,Math.min(f,60))-1)/59*.2;let Le=UP*De*Pe*de,Te=BP*De*Pe*de,te=HP*De*de;m&&d==="female"&&(Le*=1.5);const W=Math.round((I-Le)/2),X=Math.round((I-qn)/2),j=W-Te,P=W+Le,U=1,K=W+(Le/2-U/2)-te,ne=W+(Le/2+U/2),ve=g[1]<-.2&&Math.abs(g[0])<.7,le=Z=>{e.fillStyle=bP,e.beginPath();const ie=I/2,Ue=Z;e.ellipse(Math.floor(ie*w),Math.floor(Ue*w),Math.max(1,Math.floor(GP*w)),Math.max(1,Math.floor(xP*w)),0,0,2*Math.PI),e.fill()},Ee=(Z,ie)=>{d==="male"?(ye(e,W,oa+Z,Le,Sn-Ao,ie,w),ye(e,W,oa+Sn-Ao+Z,Le,Ao,Q,w)):ye(e,W,oa+Z,Le,Sn,_e,w)},Ae=(Z,ie)=>{ve?ye(e,X,ji+Z,qn,di,$,w):(ye(e,X,ji+Z,qn,di,ie,w),ye(e,X,ji+Z,qn,Jl,$,w),d==="female"?(ye(e,X-1,ji+Jl+Z,1,di,$,w),ye(e,X+qn,ji+Jl+Z,1,di,$,w)):ye(e,X+1,ji+2+Z,qn-2,di-2,$,w))};switch(u){case"idle":{const Z=s*Math.PI*2,ie=Math.sin(Z)*.5,he=(Math.cos(Z*2)+1)*.25;le(ut+Je+1),ye(e,K+ie,ut+he,te,Je,L,w),ye(e,ne-ie,ut+he,te,Je,L,w),Ee(he,L),ye(e,j,Ht+he,Te,Mt,L,w),ye(e,P,Ht+he,Te,Mt,L,w),Ae(he,L);break}case"walk":{const Z=s*Math.PI*2,ie=Math.sin(Z)*2,he=Math.abs(Math.cos(Z))*1;le(ut+Je+1),ye(e,K+ie,ut+he,te,Je,L,w),ye(e,ne-ie,ut+he,te,Je,L,w),Ee(he,L),ye(e,j-ie,Ht+he,Te,Mt,L,w),ye(e,P+ie,Ht+he,Te,Mt,L,w),Ae(he,L);break}case"gathering":{const Z=s*Math.PI*2,ie=1,Ue=(Math.sin(Z)+1)/2*2,he=ie+Math.abs(Math.cos(Z))*.5;le(ut+Je+1),ye(e,K,ut+he,te,Je-ie,L,w),ye(e,ne,ut+he,te,Je-ie,L,w),Ee(he,L),ye(e,j+1,Ht+he-Ue,Te,Mt,L,w),ye(e,P-1,Ht+he-Ue,Te,Mt,L,w),Ae(he,L);break}case"eat":{le(ut+Je+1),ye(e,K,ut+1,te,Je-1,L,w),ye(e,ne,ut+1,te,Je-1,L,w),Ee(1,L);const Ue=(Math.sin(s*Math.PI*4)+1)/2,he=X+qn/2,Gn=ji+di/2,qe=P+(he-P)*Ue,Ve=Ht+1+(Gn-(Ht+1))*Ue;ye(e,j,Ht+1,Te,Mt,L,w),ye(e,qe,Ve,Te,Mt,L,w),ye(e,qe,Ve-1,1,1,be,w),Ae(1,L);break}case"procreate":{const Z=(Math.sin(s*Math.PI*8)+1)/4,ie=(Math.sin(s*Math.PI*6)+1)*.5,Ue=1.5,he=Ue-ie;le(ut+Je+1),ye(e,K,ut+he,te,Je-Ue,L,w),ye(e,ne,ut+he,te,Je-Ue,L,w),Ee(he,L),ye(e,j,Ht+he,Te,Mt,L,w),ye(e,P,Ht+he,Te,Mt,L,w),Ae(he,L),e.globalAlpha=Z,Ee(he,"white"),e.globalAlpha=1;break}case"attacking":{const Z=Math.sin(s*Math.PI)*1.5,ie=Math.abs(Math.sin(s*Math.PI));le(ut+Je+1),ye(e,K-Z,ut+ie,te,Je,L,w),ye(e,ne+Z*.5,ut+ie,te,Je,L,w),Ee(ie,L),ye(e,j,Ht+ie-2,Te,Mt,L,w),ye(e,P,Ht+ie-2.5,Te,Mt,L,w),Ae(ie,L);break}case"defending":{le(ut+Je+1),ye(e,K,ut+1,te,Je-1,L,w),ye(e,ne,ut+1,te,Je-1,L,w),Ee(1,L),ye(e,j-1,Ht+1-1,Te,Mt,L,w),ye(e,P+1,Ht+1-1,Te,Mt,L,w),Ae(1,L);break}case"stunned":case"dead":{const Z=u==="dead",ie=Z?Math.min(1,s):0,Ue=ie>.5?Ce:L,he=d==="male"?Q:_e,Gn=ie>.8?"transparent":$,qe=I/2,Ve=E/2,xn=2;le(E-1),ye(e,qe-te-xn,Ve,te,Je,Ue,w),ye(e,qe+xn,Ve,te,Je,Ue,w),ye(e,qe-Te-xn,Ve-Sn+1,Te,Mt,Ue,w),ye(e,qe+xn,Ve-Sn+1,Te,Mt,Ue,w);const zt=qe-Le/2,cn=Ve-Sn/2;d==="male"?(ie<.7&&ye(e,zt,cn+Sn-Ao,Le,Ao,he,w),ye(e,zt,cn,Le,Sn-Ao,Ue,w)):ie<.7?ye(e,zt,cn,Le,Sn,he,w):ye(e,zt,cn,Le,Sn,Ue,w);const $n=qe-qn/2,zn=Ve-Sn/2-di+1;if(ye(e,$n,zn,qn,di,Ue,w),Gn!=="transparent"&&ye(e,$n,zn,qn,Jl,Gn,w),Z&&ie>.6){const yi="#B0A890";for(let sr=0;sr<3;sr++)ye(e,zt+1,cn+sr*1+1,Le-2,.5,yi,w)}break}default:ye(e,0,0,I,E,"magenta",w);break}e.restore()}};function $P(e,t,i,o,l){const s=t.x,u=t.y-i-o/2;e.save(),e.fillStyle=l,e.strokeStyle=l,e.lineWidth=1.5,e.beginPath(),e.rect(s-o/2,u,o,o/2),e.fill(),e.beginPath(),e.moveTo(s-o/2,u),e.lineTo(s-o/4,u-o/3),e.lineTo(s-o/6,u),e.moveTo(s-o/6,u),e.lineTo(s,u-o/2),e.lineTo(s+o/6,u),e.moveTo(s+o/6,u),e.lineTo(s+o/4,u-o/3),e.lineTo(s+o/2,u),e.stroke(),e.restore()}function ya(e,t,i,o,l,s=!1,u=!1,d=!1,f=!1){o<Xf&&(i=i*.75),vh.render(e,t.x-i/2,t.y-i/2,i,i,0,"idle",l,o,[0,0],!1,0);let g,m;s?(g=yw,m=Hv):u?(g=Tw,m=xv):d?(g=Aw,m=Gv):f&&(g=Iw,m=bv),g&&m&&$P(e,t,i/2,g,m)}function zP(e,t,i,o,l,s){if(e.save(),o.length===0){e.restore();return}const u=o.length*l,d=4;let f;const g=u+(o.length-1)*d;o.length>1&&g>s?f=(s-u)/(o.length-1):f=d,o.length<=1&&(f=0);for(let m=0;m<o.length;m++){const{member:v,isPlayer:y,isHeir:I,isPartner:E,isParent:A}=o[m],w=t+m*(l+f)+l/2,F=i+l/4;ya(e,{x:w,y:F},l,v.age,v.gender,y,I,E,A)}e.restore()}function WP(e,t,i,o,l){if(i.length===0)return;e.save();const s=Kn,u=" 00",d=" 00";e.font=`${bd}px "Press Start 2P", Arial`;const f=e.measureText(u).width,g=e.measureText(d).width,m=Kn+vn+Kn+vn+Kn+Gi+f+Kn/2+Gi+g,v=i.length*bl+(i.length-1)*Jm,y=l-v-Kn;e.fillStyle=ww,e.fillRect(s,y,m,v);for(let I=0;I<i.length;I++){const E=i[I],A=y+I*(bl+Jm),w=A+bl/2;E.isPlayerTribe&&(e.fillStyle=Ew,e.fillRect(s,A,m,bl));let F=s+Kn;if(e.font=`${vn}px "Press Start 2P", Arial`,e.textBaseline="middle",e.textAlign="left",e.fillText(E.tribeBadge,F,w-vn/4),F+=vn+Kn,!E.isPlayerTribe){const B=E.diplomacyStatus===mt.Friendly?"":"",D=`diplomacyButton_${E.leaderId}`,H={x:F-2,y:w-vn/2-2,width:vn+4,height:vn+4},b={id:D,action:ge.ToggleDiplomacy,rect:H,text:"",icon:B,backgroundColor:"transparent",textColor:"white",currentWidth:vn,tooltip:`Toggle diplomacy with this tribe (Currently: ${E.diplomacyStatus})`,targetTribeId:E.leaderId};t.uiButtons.push(b),t.hoveredButtonId===D&&(e.fillStyle=oh,e.globalAlpha=.5,e.fillRect(H.x,H.y,H.width,H.height),e.globalAlpha=1),e.font=`${vn*.8}px "Press Start 2P", Arial`,e.textBaseline="middle",e.textAlign="center",e.fillText(B,F+vn/2,w)}F+=vn+Kn,E.adultCount>0&&(ya(e,{x:F+Gi/2,y:w},Gi,25,"male"),F+=Gi/2,e.font=`${bd}px "Press Start 2P", Arial`,e.fillStyle="white",e.textBaseline="middle",e.textAlign="left",e.fillText(` ${E.adultCount}`,F,w),F+=e.measureText(` ${E.adultCount}`).width+Kn/2),E.childCount>0&&(ya(e,{x:F+Gi/2,y:w},Gi,1,"female"),F+=Gi/2,e.font=`${bd}px "Press Start 2P", Arial`,e.fillStyle="white",e.textBaseline="middle",e.textAlign="left",e.fillText(` ${E.childCount}`,F,w))}e.restore()}function YP(e,t,i,o,l){const s=Qv,u=Jv,d=t+o-s-u,f=i+u;e.save(),e.lineWidth=2,e.strokeStyle=l?Jw:Qw,e.beginPath();const g=5;e.moveTo(d+g,f+g),e.lineTo(d+s-g,f+s-g),e.moveTo(d+s-g,f+g),e.lineTo(d+g,f+s-g),e.stroke(),e.restore()}function jP(e,t,i,o){const{tutorialState:l,tutorial:s}=t;if(l.transitionState===Gt.INACTIVE)return;const u=s.steps[l.currentStepIndex];if(!u)return;e.save(),e.globalAlpha=l.transitionAlpha;const d=Ww,f=Yw,g=jw,m=`${$d}px "Press Start 2P", Arial`,v=`${a0}px "Press Start 2P", Arial`,y=Xw,I=a0*1.5;e.font=v;const E=u.text.split(" ");let A="";const w=[];for(let Ce=0;Ce<E.length;Ce++){const be=A+E[Ce]+" ";e.measureText(be).width>d-f*2&&Ce>0?(w.push(A),A=E[Ce]+" "):A=be}w.push(A);const F=f*2+$d+f/2+w.length*I,B=(i-d)/2,D=o-F-160;e.fillStyle=Vw,e.beginPath(),e.moveTo(B+g,D),e.lineTo(B+d-g,D),e.quadraticCurveTo(B+d,D,B+d,D+g),e.lineTo(B+d,D+F-g),e.quadraticCurveTo(B+d,D+F,B+d-g,D+F),e.lineTo(B+g,D+F),e.quadraticCurveTo(B,D+F,B,D+F-g),e.lineTo(B,D+g),e.quadraticCurveTo(B,D,B+g,D),e.closePath(),e.fill(),e.fillStyle=y,e.textAlign="center",e.textBaseline="top",e.font=m,e.fillText(u.title,B+d/2,D+f),e.font=v;let H=D+f+$d+f/2;for(const Ce of w)e.fillText(Ce,B+d/2,H),H+=I;const b=t.hoveredButtonId==="tutorial-dismiss";YP(e,B,D,d,b),e.restore();const L=Qv,$=Jv,Q=B+d-L-$,_e=D+$;return{x:Q,y:_e,width:L,height:L}}function af(e,t,i){e.save();const o=qw,l={x:t.x-o,y:t.y-o,width:t.width+o*2,height:t.height+o*2};e.strokeStyle=Zv,e.lineWidth=qv+Math.sin(i*sh)*1.5,e.setLineDash([8,8]),e.strokeRect(l.x,l.y,l.width,l.height),e.restore()}function VP(e,t){e.fillStyle="white",e.font='30px "Press Start 2P", Arial',e.textAlign="center",e.fillText("Game Over!",e.canvas.width/2,e.canvas.height/2-60),e.font='20px "Press Start 2P", Arial',e.fillText("Lineage Extinct.",e.canvas.width/2,e.canvas.height/2-20),e.fillText(`Cause: ${t.causeOfGameOver||"Unknown"}`,e.canvas.width/2,e.canvas.height/2+20)}const LS=10,XP=3,D0=LS*.7;function KP(e,t){const{position:i,food:o,maxFood:l}=t;if(e.beginPath(),e.arc(i.x,i.y,LS,0,Math.PI*2),e.fillStyle="#228B22",e.fill(),e.strokeStyle="#006400",e.lineWidth=1,e.stroke(),o.length>0){const s=Math.PI*2/Math.min(o.length,l);for(let u=0;u<o.length;u++){const d=u*s,f=i.x+D0*Math.cos(d),g=i.y+D0*Math.sin(d);e.beginPath(),e.arc(f,g,XP,0,Math.PI*2),e.fillStyle="#FF0000",e.fill()}}}const O0=(e,t,i=70,o=50)=>{const l=e>>t&255;return`hsl(${Math.floor(l/255*360)}, ${i}%, ${o}%)`},ZP=(e,t)=>{const i=e.match(/hsl\((\d+),\s*(\d+)%,\s*(\d+)%\)/);if(!i)return e;const[o,l,s]=[parseInt(i[1]),parseInt(i[2]),parseInt(i[3])];return`hsl(${o}, ${l}%, ${Math.max(0,s-t)}%)`},eu=(e,t,i,o,l,s,u,d=!1)=>{e.save(),e.translate(t,i),e.rotate(s),e.fillStyle=d?ZP(u,15):u,e.beginPath(),e.roundRect(-o/2,0,o,l,o/2),e.fill(),e.restore()},lf=(e,t)=>{const i=e.match(/hsl\((\d+),\s*(\d+)%,\s*(\d+)%\)/),o=75;if(!i)return`hsl(0, 0%, ${o}%)`;const[,l,s,u]=i.map(Number),d=s*(1-t),f=u+(o-u)*t;return`hsl(${l}, ${d}%, ${f}%)`},US={name:"tribe-prey-2d",referenceImage:"swos.png",description:`A 2D prey asset for the Tribe game, featuring various stances and animations.

Prey is an animal which can be hunted by predators or humans in the Tribe game.

Preys look like small 4 leg mammals, with a simple and recognizable design. The characters are designed to be easily distinguishable and animated in a way that conveys their actions clearly.

# Visual style

Prey characters in the Tribe game are inspired by classic 2D pixel art, they look like Sensible Soccer players(Sensible Soccer game visual style is IMPORTANT), with a simple and recognizable design. The characters are designed to be easily distinguishable and animated in a way that conveys their actions clearly.

Character in Tribe game look like creatures from stone age, they have simple clothing, no shoes, and no modern accessories. The characters are designed to be easily distinguishable and animated in away that conveys their actions clearly.

Prey walks on all fours, unlike human (two legs).

Each prey is described by a unique gene code, which is a number that defines its appearance, size, and other characteristics. The gene code is used to generate the character's appearance, including body proportions, color, and other visual features. The gene code is a 32-bit integer, with each bit representing a specific characteristic of the character.

Prey should have should have visible body parts, such as head, torso, arms, and legs. The body parts should be connected and should not overlap. The character's body parts should be simple shapes, such as circles and rectangles, with solid colors and no gradients or patterns.

Preys are supposed to be sympathetic and friendly, so the character's face should have a friendly expression, with a smile and bright eyes. The character's eyes should be large and expressive, with a simple design.

# Technical details

The asset is rendered on a canvas using the CanvasRenderingContext2D API. The rendering function takes parameters for position, size, progress, stance, direction, gender, and age. The character can face left or right, and the rendering adapts based on the stance (e.g., idle, walk, eat, procreate).
The rendering function must be simple and efficient, it should not use complex patterns or gradients, and should focus on solid colors and basic shapes to maintain the pixel art aesthetic.

15% padding from all edges of the rendering box is required to ensure the character is not cut off during rendering.

Subtle shadow should be drawn under the a character to give it a sense of depth.

IMPORTANT: The character is visible from the side, just like in Sensible Soccer.

# Rendering parameters

- age: The age of the character, which affects the size and proportions of the body parts. Age is a number between 0 and 12, with 2 being the average age.
- gender:
  - 'male': Male prey are larger and more robust, with a more pronounced musculature.
  - 'female': Female prey are smaller and more agile, with a leaner build.
- isPregnant: (applicable only for females) Indicates if the character is pregnant, like very large belly. Pregnant characters should have a larger torso.
- direction: A vector indicating the character's facing direction. There should be at least 8 directions (like in Sensible Soccer): top left, top, top right, left, right, bottom left, bottom, bottom right. The character should be flipped horizontally if the direction vector's X component is negative.
             When moving up(top, top left, top right), the character back of the head should be visible, when moving down(Y > 0), the character face should be visible.
- hungryLevel: A number between 0 and 100 indicating how hungry the character is, hunger level 100 means the character is starving, 0 means the character is not hungry at all. So hungry characters should be thinner, with less body fat, and more pronounced muscles. The character's hunger level affects the size and proportions of the body parts, with hungrier characters being smaller and more gaunt.

# Rendering details

- All parts of the body must be connected
- Rendering must take into account direction vector (X and Y) to flip the character horizontally if needed
- The character's age affects the size and proportions of the body parts, with older characters being larger and more robust. Hair color should become gray for older characters.

# Stances

- 'idle': The character stands still, with a slight leg sway to indicate life.
- 'walk': The character moves forward, with legs and arms in motion.
- 'eat': The character holds food and brings it to their mouth, with a slight bend at the knees.
- 'procreate': The character performs a mating animation, with a specific pose and movement. There should be some additional visual effects to indicate this action, such as a slight glow or aura around the characters, or a dust particles to indicate movement.
- 'dead': The character lies on the ground, with limbs relaxed and a neutral expression, slowly turns into a grey skeleton over time. The character pose and body parts should not be animated in this stance, as the character is dead so it should not move.`,stances:["idle","walk","eat","dead","procreate"],render(e,t,i,o,l,s,u,d={gender:"male",age:2,direction:[1,0],isPregnant:!1,hungryLevel:0,geneCode:8405024}){e.save(),e.imageSmoothingEnabled=!1;const f=o*.15,g=t+o/2,m=i+l/2,v=o-f*2,y=l-f*2,{gender:I,age:E,direction:A,isPregnant:w,hungryLevel:F,geneCode:B}=d,D=.8+Math.min(E,10)/10*.4,H=I==="male"?1.05:.95,b=1-F/100*.3,L=v*.5*b*D*H;let $=y*.3*D*H;const Q=v*.15*D*H,_e=L*.2,Ce=y*.3,be=O0(B,0,30,50);let De=O0(B,8,50,40);if(E>45){const le=Math.min(1,(E-45)/15);De=lf(De,le)}e.translate(g,m),A[0]<0&&e.scale(-1,1);const Pe=Math.sin(s*Math.PI*2),de=Math.cos(s*Math.PI*2),Le=Ce+$*.2;if(u==="dead"){const le=Math.min(s,1);e.translate(0,y*.2),e.rotate(Math.PI/2);const Ee=lf(De,le),Ae=lf(be,le);e.globalAlpha=.5+le*.5,e.strokeStyle=Ee,e.lineWidth=_e*.5,e.beginPath(),e.moveTo(-L*.4,0),e.lineTo(L*.4,0),e.stroke();for(let Z=-1;Z<=1;Z+=1)e.beginPath(),e.arc(0,0,$*.4,Math.PI*.4*Z-Math.PI*.2,Math.PI*.4*Z+Math.PI*.2),e.stroke();e.fillStyle=Ae,e.beginPath(),e.arc(L*.5,0,Q,0,Math.PI*2),e.fill(),e.fillStyle="black",e.beginPath(),e.arc(L*.55,0,Q*.3,0,Math.PI*2),e.fill(),e.restore();return}e.fillStyle="rgba(0, 0, 0, 0.1)",e.beginPath(),e.ellipse(0,Le,L*.7,L*.25,0,0,2*Math.PI),e.fill();let Te=0,te=0,W=0,X=0,j=0,P=0;switch(u){case"idle":te=Pe*(y*.02),W=Pe*.05,X=-Pe*.05,j=-Pe*.05,P=Pe*.05;break;case"walk":te=Math.abs(de)*(y*-.04),W=Pe*.7,X=-Pe*.7,j=-Pe*.7,P=Pe*.7;break;case"eat":Te=y*.1,te=y*.05,Te+=Pe*(y*.02);break;case"procreate":te=y*.05;const le=(1-de)*-v*.05;e.translate(le,0),e.shadowColor="rgba(255, 182, 193, 0.9)",e.shadowBlur=10;break}w&&I==="female"&&($*=1.6);const U=te,K=U-$*.2;eu(e,L*-.35,K,_e,Ce,j,De,!0),eu(e,L*.35,K,_e,Ce,P,De,!0),e.fillStyle=De,e.beginPath(),e.ellipse(0,U,L/2,$/2,0,0,2*Math.PI),e.fill();const ne=L*.45,ve=K+Te;e.fillStyle=be,e.beginPath(),e.arc(ne,ve,Q,0,Math.PI*2),e.fill(),A[1]>=0&&(e.fillStyle="black",e.beginPath(),e.arc(ne+Q*.3,ve-Q*.2,Q*.15,0,Math.PI*2),e.fill()),eu(e,L*-.35,K,_e,Ce,W,De),eu(e,L*.35,K,_e,Ce,X,De),e.restore()}};function qP(e,t){let[i,o,l]=e.match(/\d+/g).map(Number);return i=Math.max(0,i-t),o=Math.max(0,o-t),l=Math.max(0,l-t),`rgb(${i}, ${o}, ${l})`}function QP(e){const t=(e&16711680)>>16,i=(e&65280)>>8,o=e&255,l=`rgb(${t}, ${i}, ${o})`,s=qP(l,40),u=(e&255)%100+50,d=(e>>8&255)%100,f=(e>>16&255)%100,g=`rgb(${u}, ${d}, ${f})`,m=(e&8388608)!==0?"#00aaff":"#ffaa00";return{furColor:l,darkerFurColor:s,skinColor:g,eyeColor:m}}const BS={name:"tribe-predator-2d",referenceImage:"swos.png",description:`A 2D predator asset for the Tribe game, featuring various stances and animations.

Predator is an animal which can hunt and attack humans in the Tribe game. It is designed to be a threat to the player, adding an element of danger and challenge to the game world.

Predator look like bears or wolves, with a simple and recognizable design. The characters are designed to be easily distinguishable and animated in a way that conveys their actions clearly.

# Visual style

Predator characters in the Tribe game are inspired by classic 2D pixel art, they look like Sensible Soccer players(Sensible Soccer game visual style is IMPORTANT), with a simple and recognizable design. The characters are designed to be easily distinguishable and animated in a way that conveys their actions clearly.

Character in Tribe game look like creatures from stone age, they have simple clothing, no shoes, and no modern accessories. The characters are designed to be easily distinguishable and animated in away that conveys their actions clearly.

Predator walks on arms and legs, unlike human (two legs).

Each predator is described by a unique gene code, which is a number that defines its appearance, size, and other characteristics. The gene code is used to generate the character's appearance, including body proportions, color, and other visual features. The gene code is a 32-bit integer, with each bit representing a specific characteristic of the character.

Predator should have visible ears, eyes, and mouth with teeth. It must have a tail. Front legs should be shorter than back legs, and they should be positioned closer to the body. The character's body should be wider at the top and narrower at the bottom, with a slight curve to the back. The character's head should be larger than the body, with a pronounced jaw and sharp teeth.

# Technical details

The asset is rendered on a canvas using the CanvasRenderingContext2D API. The rendering function takes parameters for position, size, progress, stance, direction, gender, and age. The character can face left or right, and the rendering adapts based on the stance (e.g., idle, walk, eat, procreate).
The rendering function must be simple and efficient, it should not use complex patterns or gradients, and should focus on solid colors and basic shapes to maintain the pixel art aesthetic.

15% padding from all edges of the rendering box is required to ensure the character is not cut off during rendering.

Subtle shadow should be drawn under the a character to give it a sense of depth.

IMPORTANT: The character is visible from the side, just like in Sensible Soccer.

# Rendering parameters

- age: The age of the character, which affects the size and proportions of the body parts. Age is a number between 1 and 20, with 3 being the average age.
- gender:
  - 'male': Male predators are larger and more robust, with a more pronounced musculature.
  - 'female': Female predators are smaller and more agile, with a leaner build.
- isPregnant: (applicable only for females) Indicates if the character is pregnant, like very large belly. Pregnant characters should have a larger torso.
- direction: A vector indicating the character's facing direction. There should be at least 8 directions (like in Sensible Soccer): top left, top, top right, left, right, bottom left, bottom, bottom right. The character should be flipped horizontally if the direction vector's X component is negative.
             When moving up(top, top left, top right), the character back of the head should be visible, when moving down(Y > 0), the character face should be visible.
- hungryLevel: A number between 0 and 100 indicating how hungry the character is, hunger level 100 means the character is starving, 0 means the character is not hungry at all. So hungry characters should be thinner, with less body fat, and more pronounced muscles. The character's hunger level affects the size and proportions of the body parts, with hungrier characters being smaller and more gaunt.

# Rendering details

- All parts of the body must be connected
- Rendering must take into account direction vector (X and Y) to flip the character horizontally if needed
- The character's age affects the size and proportions of the body parts, with older characters being larger and more robust. Hair color should become gray for older characters.

# Stances

- 'idle': The character stands still, with a slight leg sway to indicate life.
- 'walk': The character moves forward, with legs and arms in motion.
- 'eat': The character holds food and brings it to their mouth, with a slight bend at the knees.
- 'procreate': The character performs a mating animation, with a specific pose and movement. There should be some additional visual effects to indicate this action, such as a slight glow or aura around the characters, or a dust particles to indicate movement.
- 'attacking': The character performs an attack animation, with arms raised and a forward motion.
- 'dead': The character lies on the ground, with limbs relaxed and a neutral expression, slowly turns into a grey skeleton over time. The character pose and body parts should not be animated in this stance, as the character is dead so it should not move.`,stances:["idle","walk","eat","dead","attacking","procreate"],render(e,t,i,o,l,s,u,d={gender:"male",age:20,direction:[1,0],isPregnant:!1,hungryLevel:0,geneCode:8405024}){const{gender:f,age:g,direction:m,isPregnant:v,hungryLevel:y,geneCode:I}=d;e.save();const E=o*.15,A=Math.max(1,Math.floor((o-E*2)/10)),w=m[0]<0;e.translate(t+o/2,i+l/2),w&&e.scale(-1,1);const F=QP(I),B=.8+Math.min(g,20)/20*.4,D=f==="male"?1.05:.95,H=1-y/100*.25,b=B*D*H,L=Math.max(0,Math.min(1,(g-15)/5));e.filter=`grayscale(${L})`;const $=F.furColor,Q=F.darkerFurColor,_e=F.eyeColor,Ce="#FFFFFF",be="#c75c5c",De="#E0E0E0",Pe="#A0A0A0",de=l/2-2*A,Le=Math.sin(s*Math.PI*2),Te=Math.abs(Le);if(e.fillStyle="rgba(0,0,0,0.15)",e.beginPath(),e.ellipse(0,de,A*4,A,0,0,2*Math.PI),e.fill(),e.filter="none",u==="dead"){const qe=Math.min(1,s*2);e.save(),e.translate(0,de-A*3),e.rotate(-Math.PI/2);const Ve=(xn,zt,cn,$n,zn=!1)=>{e.fillStyle=zn?Pe:De,e.fillRect(xn*A,zt*A,cn*A,$n*A)};qe<1&&(e.globalAlpha=1-qe,e.fillStyle=$,e.beginPath(),e.ellipse(0,0,A*3,A*5,0,0,Math.PI*2),e.fill(),e.globalAlpha=1),qe>0&&(e.globalAlpha=qe,Ve(-1,-4,2,2),Ve(1,-3.5,1,1,!0),Ve(-.5,-2,1,5,!0),Ve(-2.5,-1,5,.5),Ve(-2.5,0,5,.5),Ve(-2.5,1,5,.5),Ve(-3,-2,-1,2,!0),Ve(3,-2,1,2),Ve(-3,2,-1,2,!0),Ve(3,2,1,2),e.globalAlpha=1),e.restore(),e.restore();return}e.fillStyle=$;let te=0,W=0,X=0,j=[0,0,0,0];switch(u){case"idle":te=Le*A*.1;break;case"walk":const qe=Math.sin(s*Math.PI*4);te=Math.abs(qe)*-A*.5,j=[qe*A,-qe*A,-qe*A,qe*A];break;case"attacking":const Ve=Math.sin(s*Math.PI*4);W=A*2+Ve*A,X=A*2,te=A;break;case"eat":X=A*3+Te*A,te=A*1.5,e.fillStyle=be,e.fillRect(-A,de-A,A*2,A);break;case"procreate":te=Math.sin(s*Math.PI*8)*A*.3,e.fillStyle="rgba(139, 69, 19, 0.5)";for(let zt=0;zt<5;zt++){const cn=(Math.random()-.5)*A*8,$n=de+(Math.random()-.5)*A*2;Te>.5&&e.fillRect(cn,$n,A*.5,A*.5)}break}const P=A*3*b*(v?1.3:1),U=A*5*b,K=-U/1.5,ne=de-P-A*2.5+te;e.fillStyle=$,e.beginPath(),e.moveTo(K-A*.5,ne+P*.5),e.quadraticCurveTo(K-A*3,ne-A,K-A*2+Le*A,ne+P+A),e.fill();const ve=A*1.2*b,le=A*3*b,Ee=A*2.5*b,Ae=K+U*.8,Z=K+U*.2;e.fillStyle=Q,e.fillRect(Z,de-Ee,ve,Ee+j[2]),e.fillRect(Ae,de-le,ve,le+j[0]),e.fillStyle=$,e.beginPath(),e.moveTo(K,ne+P),e.lineTo(K,ne+A),e.quadraticCurveTo(K+U/2,ne,K+U,ne+A),e.lineTo(K+U,ne+P),e.fill(),e.fillStyle=$,e.fillRect(Z+A/2,de-Ee,ve,Ee+j[3]),e.fillRect(Ae+A/2,de-le,ve,le+j[1]);const ie=A*3.5*b,Ue=K+U-ie*.3+W,he=ne-ie*.3+X;e.fillStyle=$,e.beginPath(),e.arc(Ue,he,ie/2,0,Math.PI*2),e.fill(),e.beginPath(),e.ellipse(Ue+ie*.4,he+ie*.2,A*1.5,A,0,0,Math.PI*2),e.fill(),m[1]>=0&&(e.fillStyle=_e,e.fillRect(Ue+A*.5,he-A*.5,A*.5,A*.5),u==="attacking"&&(e.fillStyle=Ce,e.fillRect(Ue+ie*.5,he+ie*.4,A,A*.4))),e.fillStyle=Q,e.beginPath(),e.moveTo(Ue-ie*.4,he-ie*.3),e.lineTo(Ue,he-ie*.7),e.lineTo(Ue,he-ie*.2),e.fill(),e.restore()}},JP=9;function eN(e,t){const{position:i,gender:o,age:l,decayProgress:s,food:u,radius:d,originalEntityType:f,geneCode:g}=t;if(e.save(),e.globalAlpha=1-s,f==="human"?vh.render(e,i.x-d,i.y-d,d*2,d*2,s,"dead",o,l,[0,0],!1,0):f==="prey"?US.render(e,i.x-d,i.y-d,d*2,d*2,s,"dead",{gender:o,age:l,direction:[0,0],isPregnant:!1,hungryLevel:0,geneCode:g||8405024}):f==="predator"&&BS.render(e,i.x-d,i.y-d,d*2,d*2,s,"dead",{gender:o,age:l,direction:[0,0],isPregnant:!1,hungryLevel:0,geneCode:g||8405024}),e.restore(),u.length>0){e.save(),e.font=`${JP}px Arial`,e.textAlign="center",e.textBaseline="middle";const m=_t*.9,v=Math.PI/Pv*3;u.forEach((y,I)=>{const E=I*v,A=i.x+m*Math.cos(E)*Math.atan2(I,I),w=i.y+m*Math.sin(E)*Math.atan2(I,I),F=Vf[y.type];e.fillText(F,A,w)}),e.restore()}}function Qi(e,t,i,o,l,s,u,d){e.save(),e.fillStyle=u,e.fillRect(t,i,o,l),e.fillStyle=d,e.fillRect(t,i,o*Math.max(0,s),l),e.restore()}function tN(e,t,i,o,l,s){if(e.save(),o.length===0){e.restore();return}const u=o.length*l;let d;u>s||u+(o.length-1)*4>s?d=(s-u)/(o.length-1):d=4,o.length===1&&(d=0);for(let f=0;f<o.length;f++){const g=Vf[o[f].type];e.fillText(g,t+f*(l+d),i)}e.restore()}function nN(e,t,i,o,l){const s=t.autopilotControls.hoveredAutopilotAction;if(!s)return;let u,d=_t/2;const f=Fu[s.action],g=nS[s.action],m=`${f} ${g}`;if("targetEntityId"in s){const v=t.entities.entities[s.targetEntityId];v&&(u=v.position,d=v.radius)}else"position"in s&&(u=s.position);if(u){FS(e,u,d,ih,rh,2,i,o,l,t.mapDimensions),e.save(),e.font=`${Go}px "Press Start 2P", Arial`,e.fillStyle="white",e.textAlign="center",e.textBaseline="bottom",e.shadowColor="black",e.shadowBlur=5;const{x:v,y}=Hu(u,i,{width:o,height:l},t.mapDimensions),I=y-d-Mu-Go/2;e.fillText(m,v,I),e.restore()}}function iN(e,t,i,o,l){e.save();const s=(Math.sin(l*sh)+1)/2,u=i+Mu+s*5;e.strokeStyle=ih,e.lineWidth=2,e.setLineDash(rh),e.beginPath(),e.arc(t.x,t.y,u,0,Math.PI*2),e.stroke(),e.setLineDash([]);const d=Fu[o],f=nS[o];if(d){e.font=`${Go*1.5}px "Press Start 2P", Arial`,e.textAlign="center",e.textBaseline="middle";const g=t.y-u-25;e.fillText(d,t.x,g),e.font=`${Go*.8}px "Press Start 2P", Arial`,e.fillText(f,t.x,g+25)}e.restore()}function rN(e,t,i){e.save();const o=30,l=70,s=3,u=l/s;for(let d=0;d<s;d++){const f=d*u,g=(i*o+f)%l,m=1-g/l;e.strokeStyle=`rgba(255, 215, 0, ${m*.7})`,e.lineWidth=1+(1-m)*2,e.beginPath(),e.arc(t.x,t.y,g,0,Math.PI*2),e.stroke()}e.restore()}function oN(e,t){const{activeAutopilotAction:i,behaviors:o}=t.autopilotControls,l=St(t);if(!l)return;const s=(u,d)=>{rN(u,d.position,t.time)};if(l.isCallingToFollow&&an(e,t.mapDimensions.width,t.mapDimensions.height,s,{position:l.position}),o.followLeader&&!i&&an(e,t.mapDimensions.width,t.mapDimensions.height,s,{position:l.position},70),i){let u,d=15;if("position"in i)u=i.position;else if("targetEntityId"in i){const f=t.entities.entities[i.targetEntityId];f&&(u=f.position,d=f.radius||30)}if(u&&i.action!==se.AutopilotFollowMe&&!l.isCallingToFollow){const f=(g,m)=>{iN(g,m.position,d,i.action,t.time)};an(e,t.mapDimensions.width,t.mapDimensions.height,f,{position:{...u}},u,d+30)}}}function k0(e,t,i,o,l,s,u=!0){const d=t.split(" ");let f="";const g=[];for(let m=0;m<d.length;m++){const v=f+d[m]+" ";e.measureText(v).width>l&&m>0?(g.push(f),f=d[m]+" "):f=v}if(g.push(f),u)for(let m=0;m<g.length;m++)e.fillText(g[m],i,o+m*s);return g.length*s}function sN(e){return 1-Math.pow(1-e,3)}function aN(e,t,i,o){t.notificationButtonRects={dismiss:{},view:{}};const l=t.notifications.filter(u=>!u.isDismissed);if(l.length===0)return;e.save();let s=o-l_;for(const u of l){const d=i-$l-Ir;e.font=`${zd}px "Press Start 2P", Arial`;const f=d+Ir,g=$l-Ir*2,m=k0(e,u.message,-9999,-9999,g,zd*1.2,!1),v=Ir*2+m+Zn,y=s-v,I=Date.now()-u.creationTime,E=Math.min(I/a_,1),A=sN(E),w=o,F=w+(y-w)*A;e.fillStyle=t_,e.beginPath(),e.roundRect(d,F,$l,v,e_),e.fill(),e.fillStyle=n_,e.textBaseline="top",k0(e,u.message,f,F+Ir,g,zd*1.2,!0);const B=F+v-Zn-Ir/2,D=d+$l-Zn-Ir/2,H={x:D,y:B,width:Zn,height:Zn};t.notificationButtonRects&&(t.notificationButtonRects.dismiss[u.id]=H);const b=t.hoveredButtonId===`notification-dismiss-${u.id}`;if(e.fillStyle=b?c0:i_,e.font=`${Zn}px Arial`,e.textAlign="center",e.textBaseline="middle",e.fillText("",H.x+H.width/2,H.y+H.height/2),u.targetEntityIds||u.targetPosition||u.targetArea||u.targetRadius){const Q={x:D-Zn-u0,y:B,width:Zn,height:Zn};t.notificationButtonRects&&(t.notificationButtonRects.view[u.id]=Q);const _e=t.hoveredButtonId===`notification-view-${u.id}`;e.fillStyle=_e?c0:r_,e.font=`${Zn*(_e?1.5:1.2)}px Arial`,e.fillText("",Q.x+Q.width/2,Q.y+Q.height/2)}s-=v+u0}e.restore()}function lN(e){return e.length===0?0:e.reduce((i,o)=>i+o,0)/e.length}function uf(e,t,i,o,l,s,u,d){e.save(),e.fillStyle="rgba(255, 255, 255, 0.1)",e.fillRect(o,l,s,u),e.strokeStyle="#555",e.lineWidth=1,e.strokeRect(o,l,s,u);const f=lN(i);e.fillStyle="white",e.font="11px monospace",e.textAlign="left",e.fillText(`${t}: ${f.toFixed(2)}ms`,o+je,l+je+8);const g=Math.max(...i,1),m=i.map(v=>v/g*u);if(e.beginPath(),e.strokeStyle=d,e.lineWidth=2,m.length>1){e.moveTo(o,l+u-m[0]);for(let v=1;v<m.length;v++){const y=o+v/(m.length-1)*s,I=l+u-m[v];e.lineTo(y,I)}}else if(m.length===1){const v=l+u-m[0];e.moveTo(o,v),e.lineTo(o+s,v)}e.stroke(),e.fillStyle="rgba(255, 255, 255, 0.7)",e.font="10px monospace",e.textAlign="right",e.fillText(`${g.toFixed(2)}ms`,o+s-je,l+je+8),e.restore()}function uN(e,t,i){const{performanceMetrics:o}=t;if(!o)return;const l=280,s=240,u=i-l-je,d=je+ln*2;e.save(),e.fillStyle="rgba(0, 0, 0, 0.8)",e.fillRect(u,d,l,s),e.strokeStyle="#444",e.lineWidth=2,e.strokeRect(u,d,l,s),e.fillStyle="white",e.font="12px monospace",e.textAlign="left";let f=d+je+5;const g=u+je;e.fillStyle="#66ccff",e.font="bold 14px monospace",e.fillText(" Performance Debugger",g,f),f+=25,e.fillStyle="white",e.font="12px monospace";const m=cN(t);e.fillText(`FPS: ${m.toFixed(1)}`,g,f),f+=20;const v=l-je*2,y=45,I=10;uf(e,"Render",cf(t,"renderTime"),g,f,v,y,"#4CAF50"),f+=y+I,uf(e,"World Update",cf(t,"worldUpdateTime"),g,f,v,y,"#2196F3"),f+=y+I,uf(e,"AI Update",cf(t,"aiUpdateTime"),g,f,v,y,"#FFC107"),e.fillStyle="#888",e.font="10px monospace",e.textAlign="center",e.fillText("Press '2' to toggle this panel",u+l/2,d+s-10),e.restore()}function cN(e){const{performanceMetrics:t}=e;if(!t||t.history.length===0)return 0;const i=t.history[t.history.length-1].bucketTime/(Et/wt);return t.history.filter(s=>i-s.bucketTime/(Et/wt)<1).length}function dN(e,t){if(e.length===0)return[];const i=new Map;for(const s of e){const u=Math.floor(s.bucketTime/(Et/wt));i.set(u,(i.get(u)||0)+s[t])}return Array.from(i.keys()).sort().map(s=>i.get(s)).slice(0,-1).slice(1).reverse()}function cf(e,t){return dN(e.performanceMetrics.history,t)}function Sh(e,t,i){if(!t.aiBlackboard)return;const o=t.aiBlackboard.nodeExecutionData,l=t.type==="human"?wS:t.type==="predator"?CS:t.type==="prey"?_S:null;if(!l)return;e.save(),e.font=`${Mw}px Arial`,e.textAlign="left",e.textBaseline="top";const s=y=>{switch(y){case T.SUCCESS:return Lw;case T.FAILURE:return Uw;case T.RUNNING:return Bw;case T.NOT_EVALUATED:case null:default:return Hw}},u=y=>{if(!y.name||!o[y.name])return{width:0,height:0};let I=0,E=0;const A=o[y.name],w=` ${y.name}`+(A!=null&&A.debugInfo?`: ${A.debugInfo}`:""),F=e.measureText(w).width,B=(y.depth??0)*r0+8+F+s0+Hs+20;if(I=Math.max(I,B),E+=xd,y.children)for(const D of y.children){const H=u(D);I=Math.max(I,H.width),E+=H.height}else if(y.child){const D=u(y.child);I=Math.max(I,D.width),E+=D.height}return{width:I,height:E}},d=(y,I,E,A)=>{if(!y.name||!o[y.name])return I;let w=I;const F=o[y.name],B=E+2+(y.depth??0)*r0;let D=T.NOT_EVALUATED,H=o0,b="";if(F){D=F.status,b=F.debugInfo;const Q=Gw/wt*Et,_e=i-F.lastExecuted,Ce=Math.max(0,1-_e/Q);H=zE(o0,bw,Ce),_e>ua&&(D=T.NOT_EVALUATED)}const L=s(D);e.fillStyle=L,e.fillText("",B,w),e.fillStyle=H;const $=` ${y.name}`+(b?`: ${b}`:"");if(e.fillText($,B+8,w),F&&F.executionHistory.length>0){const{executionHistory:Q}=F,_e=Kv/wt*Et,Ce=i,be=Ce-_e,De=E+A-Hs-s0;let Pe=De;const de=w+(xd-xl)/2,Le=Q.filter(K=>K.time<be);let Te=Le.length>0?Le[Le.length-1].status:null,te=be;const W=Q.filter(K=>K.time>=be&&K.time<=Ce),X=Hs/_e;e.fillStyle="rgba(255, 255, 255, 0.1)",e.fillRect(De,de,Hs,xl);for(const K of W){const ve=(K.time-te)*X;ve>0&&(e.fillStyle=s(Te),e.fillRect(Pe,de,ve,xl),Pe+=ve),Te=K.status,te=K.time}i-te>ua&&(Te=T.NOT_EVALUATED);const P=(Ce-te)*X;e.fillStyle=s(Te);const U=De+Hs-Pe;e.fillRect(Pe,de,Math.min(P,U),xl)}if(w+=xd,y.children)for(const Q of y.children)w=d(Q,w,E,A);else y.child&&(w=d(y.child,w,E,A));return w},{width:f,height:g}=u(l);if(g===0){e.restore();return}const m=t.position.x+Ow,v=t.position.y+kw-g/2;e.fillStyle=Fw,e.fillRect(m,v,f,g+4),d(l,v+2,m,f),e.restore()}const fN={moving:"walk",gathering:"gathering",eating:"eat",feeding:"eat",procreating:"procreate",idle:"idle",attacking:"attacking",planting:"gathering",depositing:"gathering",retrieving:"gathering",takingOverBuilding:"attacking",destroyingBuilding:"attacking"};function hN(e,t){var d;const{radius:i,position:o,activeAction:l="idle"}=t,s=((d=t.stateMachine)==null?void 0:d[0])||"N/A",u=t.isAdult?_t+20:_t*.6+20;e.save(),e.fillStyle="white",e.font="10px Arial",e.textAlign="center",e.fillText(`Action: ${l}`,o.x,o.y-u),e.fillText(`State: ${s}`,o.x,o.y-u+10),e.fillText(`HP: ${t.hitpoints}`,o.x,o.y-u+20),e.fillText(`Cooldown: ${t.attackCooldown||"N/A"}`,o.x,o.y-u+30),e.fillText(`Tribe: ${t.leaderId||"N/A"}`,o.x,o.y-u+40),e.restore(),e.beginPath(),e.arc(o.x,o.y,i,0,Math.PI*2),e.strokeStyle="rgba(255, 0, 0, 0.5)",e.lineWidth=1,e.stroke(),e.closePath()}function gN(e,t,i,o,l){e.save(),e.font=`${Rf}px Arial`,e.textAlign="center",e.textBaseline="middle",e.fillText(i,t.x,t.y-(o?_t:Vo)-Rf-l),e.restore()}function pN(e,t,i,o,l){const s=t.x,u=t.y-i-o/2;e.save(),e.fillStyle=l,e.strokeStyle=l,e.lineWidth=1.5,e.beginPath(),e.rect(s-o/2,u,o,o/2),e.fill(),e.beginPath(),e.moveTo(s-o/2,u),e.lineTo(s-o/4,u-o/3),e.lineTo(s-o/6,u),e.moveTo(s-o/6,u),e.lineTo(s,u-o/2),e.lineTo(s+o/6,u),e.moveTo(s+o/6,u),e.lineTo(s+o/4,u-o/3),e.lineTo(s+o/2,u),e.stroke(),e.restore()}function mN(e,t,i){var d;const{position:o,radius:l}=t,s=o.x-Gd/2,u=o.y-l-_w;if(((d=t.stateMachine)==null?void 0:d[0])===ir){const f=t.stateMachine[1],g=i-f.attackStartTime,m=Math.min(g/kv,1);Qi(e,s,u,Gd,e0,m,Ki,Cw)}else if(t.attackCooldown&&t.attackCooldown>0){const f=1-t.attackCooldown/ku;Qi(e,s,u,Gd,e0,f,Ki,Rw)}}function vN(e,t,i){const l="";e.save(),e.font="15px Arial",e.textAlign="center",e.textBaseline="bottom",e.shadowColor="black",e.shadowBlur=3,e.fillText(l,t.x,t.y-i),e.restore()}function SN(e,t,i=!1,o=!1,l=!1,s=!1,u=!1,d=!1,f=!1,g=!1,m,v){const{position:y,activeAction:I="idle"}=t,E=t.isAdult?_t:_t*.6,A=fN[I]||"idle";vh.render(e,y.x-E,y.y-E,E*2,E*2,t.animationProgress||0,A,t.gender,t.age,[t.direction.x,t.direction.y],t.isPregnant??!1,t.hunger),d&&(e.save(),e.strokeStyle=sw,e.lineWidth=2,e.beginPath(),e.arc(y.x,y.y,E+3,0,2*Math.PI),e.stroke(),e.restore());let w,F;if(u?(w=lw,F=xv):i?(w=aw,F=Hv):l?(w=uw,F=ow):o?(w=cw,F=bv):s&&(w=dw,F=Gv),w&&F&&pN(e,y,E,w,F),t.tribeBadge&&gN(e,y,t.tribeBadge,t.isAdult??!1,w??0),f){let D=(t.isAdult?_t:Vo)+5;w&&(D+=w),t.tribeBadge&&(D+=Rf),vN(e,y,D)}const B=g&&(v===void 0||t.id===v);B&&t.aiBlackboard&&Sh(e,t,m),mN(e,t,m),B&&hN(e,t)}const yN={grazing:"eat",moving:"walk",procreating:"procreate",feeding:"eat",idle:"idle"};function TN(e,t){var d;const{radius:i,position:o,activeAction:l="idle"}=t,s=((d=t.stateMachine)==null?void 0:d[0])||"N/A",u=t.isAdult?_t+20:_t*.6+20;e.save(),e.fillStyle="white",e.font="10px Arial",e.textAlign="center",e.fillText(`Action: ${l}`,o.x,o.y-u),e.fillText(`State: ${s}`,o.x,o.y-u+10),e.fillText(`HP: ${t.hitpoints}`,o.x,o.y-u+20),e.fillText(`Hunger: ${Math.round(t.hunger)}`,o.x,o.y-u+30),e.fillText(`Age: ${Math.round(t.age)}`,o.x,o.y-u+40),e.restore(),e.beginPath(),e.arc(o.x,o.y,i,0,Math.PI*2),e.strokeStyle="rgba(0, 255, 0, 0.5)",e.lineWidth=1,e.stroke(),e.closePath()}function AN(e,t,i=!1,o=0,l){var m,v;const{position:s,activeAction:u="idle"}=t,d=t.isAdult?t.radius:t.radius*.6,f=yN[u]||"idle";if(US.render(e,s.x-d,s.y-d,d*2,d*2,t.animationProgress||0,f,{gender:t.gender,age:t.age,direction:[((m=t.direction)==null?void 0:m.x)||1,((v=t.direction)==null?void 0:v.y)||0],isPregnant:t.isPregnant??!1,hungryLevel:t.hunger,geneCode:t.geneCode}),t.hitpoints<t.maxHitpoints){const y=d*1.5,I=3,E=s.x-y/2,A=s.y-d-8;e.fillStyle="#555",e.fillRect(E,A,y,I);const w=t.hitpoints/t.maxHitpoints;e.fillStyle=w>.5?"#4CAF50":w>.25?"#FFC107":"#F44336",e.fillRect(E,A,y*w,I)}const g=i&&(l===void 0||t.id===l);g&&t.aiBlackboard&&Sh(e,t,o),g&&TN(e,t)}const IN={attacking:"attacking",eating:"eat",moving:"walk",procreating:"procreate",feeding:"eat",idle:"idle"};function EN(e,t){var d;const{radius:i,position:o,activeAction:l="idle"}=t,s=((d=t.stateMachine)==null?void 0:d[0])||"N/A",u=t.isAdult?_t+20:_t*.6+20;e.save(),e.fillStyle="white",e.font="10px Arial",e.textAlign="center",e.fillText(`Action: ${l}`,o.x,o.y-u),e.fillText(`State: ${s}`,o.x,o.y-u+10),e.fillText(`HP: ${t.hitpoints}`,o.x,o.y-u+20),e.fillText(`Hunger: ${Math.round(t.hunger)}`,o.x,o.y-u+30),e.fillText(`Age: ${Math.round(t.age)}`,o.x,o.y-u+40),e.restore(),e.beginPath(),e.arc(o.x,o.y,i,0,Math.PI*2),e.strokeStyle="rgba(255, 0, 0, 0.5)",e.lineWidth=1,e.stroke(),e.closePath()}function wN(e,t,i=!1,o=0,l){var m,v;const{position:s,activeAction:u="idle"}=t,d=t.isAdult?t.radius:t.radius*.6,f=IN[u]||"idle";if(BS.render(e,s.x-d,s.y-d,d*2,d*2,t.animationProgress||0,f,{gender:t.gender,age:t.age,direction:[((m=t.direction)==null?void 0:m.x)||1,((v=t.direction)==null?void 0:v.y)||0],isPregnant:t.isPregnant??!1,hungryLevel:t.hunger,geneCode:t.geneCode}),t.hitpoints<t.maxHitpoints){const y=d*1.5,I=3,E=s.x-y/2,A=s.y-d-8;e.fillStyle="#555",e.fillRect(E,A,y,I);const w=t.hitpoints/t.maxHitpoints;e.fillStyle=w>.5?"#4CAF50":w>.25?"#FFC107":"#F44336",e.fillRect(E,A,y*w,I)}(t.attackCooldown&&t.attackCooldown>0||t.huntCooldown&&t.huntCooldown>0)&&(e.strokeStyle="#FF8C00",e.lineWidth=3,e.beginPath(),e.arc(s.x,s.y,d+3,0,2*Math.PI),e.stroke());const g=i&&(l===void 0||t.id===l);g&&t.aiBlackboard&&Sh(e,t,o),g&&EN(e,t)}const HS=15;function M0(e,t,i,o,l=1.5){const s=i-t.startTime,u=Math.min(s/t.duration,1),d=1-u,g=1+Math.sin(u*Math.PI*2)*(l-1),m=HS*g;e.save(),e.globalAlpha=d,e.beginPath(),e.arc(t.position.x,t.position.y,Math.max(0,m),0,Math.PI*2),e.fillStyle=o,e.fill(),e.restore()}function Io(e,t,i,o,l=2){const s=i-t.startTime,u=Math.min(s/t.duration,1),d=1-u,f=HS*2*u;e.save(),e.globalAlpha=d,e.beginPath(),e.arc(t.position.x,t.position.y,f,0,Math.PI*2),e.strokeStyle=o,e.lineWidth=l,e.stroke(),e.restore()}function zi(e,t,i,o){const l=i-t.startTime,s=Math.min(l/t.duration,1),u=1-s,d=-20*s;e.save(),e.globalAlpha=u,e.font="20px Arial",e.textAlign="center",e.fillText(o,t.position.x,t.position.y+d),e.restore()}function _N(e,t,i){switch(t.type){case ce.Hunger:M0(e,t,i,"rgba(255, 165, 0, 0.7)",1);break;case ce.Procreation:zi(e,t,i,"");break;case ce.Pregnant:M0(e,t,i,"rgba(255, 105, 180, 0.7)",1.2);break;case ce.TargetAcquired:Io(e,t,i,"rgba(255, 0, 0, 0.8)",3);break;case ce.Attack:zi(e,t,i,"");break;case ce.Partnered:zi(e,t,i,"");break;case ce.BushClaimed:Io(e,t,i,"rgba(0, 255, 0, 0.7)",2);break;case ce.BushClaimLost:Io(e,t,i,"rgba(128, 128, 128, 0.7)",2);break;case ce.Eating:zi(e,t,i,"");break;case ce.ChildFed:zi(e,t,i,"");break;case ce.AttackDeflected:zi(e,t,i,"");break;case ce.AttackResisted:zi(e,t,i,"");break;case ce.Hit:zi(e,t,i,"");break;case ce.SeizeBuildup:Io(e,t,i,"rgba(255, 215, 0, 0.8)",4);break;case ce.Seize:Io(e,t,i,"rgba(148, 0, 211, 0.8)",4);break;case ce.CallToAttack:Io(e,t,i,"rgba(255, 255, 0, 0.8)",4);break}}function F0(e,t,i,o,l,s,u){e.save();const{position:d}=t;e.strokeStyle=o,e.lineWidth=l+Math.sin(u*s)*(l/2),e.setLineDash([8,8]),e.beginPath(),e.arc(d.x,d.y,i,0,2*Math.PI),e.stroke(),e.restore()}const L0=8,CN=1.5,RN=.5,U0=2,PN="#5a5a5a",NN="#7e7e7e",DN="#8B0000",ON="#FF4444",kN=6;function df(e){const t=Math.sin(e)*1e4;return t-Math.floor(t)}function Ff(e,t,i,o,l,s){const u=(t+i)*2,d=Math.floor(u/L0),f=-t/2,g=t/2,m=-i/2,v=i/2;for(let y=0;y<d;y++){const I=o+y*13,E=df(I),A=df(I+1);let w=y*L0,F=0,B=0;w<t?(F=f+w,B=m):w<t+i?(F=g,B=m+(w-t)):w<t*2+i?(F=g-(w-(t+i)),B=v):(F=f,B=v-(w-(t*2+i)));const D=(A-.5)*U0,H=(df(I+2)-.5)*U0;e.beginPath();const b=CN+E*RN;l?e.fillStyle=l:e.fillStyle=E>.5?s||NN:l||PN,e.ellipse(F+D,B+H,b,b*.85,A*Math.PI,0,Math.PI*2),e.fill(),l||(e.strokeStyle="#2b2b2b",e.lineWidth=1,e.stroke())}}function MN(e,t){if(!t.storedFood||t.storedFood.length===0)return;const{position:i,storedFood:o}=t;e.save(),e.font=`${kN}px Arial`,e.textAlign="center",e.textBaseline="middle",e.shadowColor="rgba(0,0,0,0.5)",e.shadowBlur=2,o.forEach(l=>{const s=Vf[l.item.type],u={x:i.x+l.positionOffset.x,y:i.y+l.positionOffset.y};e.fillText(s,u.x,u.y)}),e.shadowBlur=0,e.shadowColor="transparent",e.restore()}function FN(e,t,i){const{position:o,width:l,height:s,constructionProgress:u,destructionProgress:d,isConstructed:f,isBeingDestroyed:g,id:m}=t,v=Aa[t.buildingType],y=St(i),I=y&&Fn(y,t,i);e.save(),e.translate(o.x,o.y),f||(e.globalAlpha=.3+u*.7),I?Ff(e,l,s,m,DN,ON):Ff(e,l,s,m),e.globalAlpha=.5,e.font=`${Math.min(l,s,30)*.5}px Arial`,e.textAlign="center",e.textBaseline="middle",e.shadowColor="rgba(0,0,0,0.5)",e.shadowBlur=4,e.fillStyle="#FFFFFF",e.fillText(v.icon,0,0),e.shadowBlur=0,e.restore();const E=l,A=o.x-E/2,w=o.y+s/2+z_;f?g&&Qi(e,A,w,E,p0,1-d,Ki,$_):Qi(e,A,w,E,p0,u,Ki,x_),t.buildingType==="storageSpot"&&f&&MN(e,t)}function LN(e,t,i,o,l){const s=Aa[i],{width:u,height:d}=s.dimensions,f=(m,v)=>{m.save(),m.translate(v.x,v.y),m.globalAlpha=G_;const y=o?"#4CAF50":"#F44336";Ff(m,u,d,9999,y),m.font=`${Math.min(u,d)*.5}px Arial`,m.textAlign="center",m.textBaseline="middle",m.fillStyle=y,m.fillText(s.icon,0,0),m.restore()},g={position:{...t},radius:Math.max(u,d)/2,id:0,type:"building",direction:{x:0,y:0},acceleration:0,forces:[],velocity:{x:0,y:0},debuffs:[]};an(e,l.width,l.height,(m,v)=>f(m,v.position),g)}function UN(e,t,i,o,l){const s=St(t),u=s?un(t,s):[],d=xr(u),{width:f,height:g}=t.mapDimensions;Object.values(t.entities.entities).sort((E,A)=>i&&E.id===t.debugCharacterId&&E.id!==A.id||E.type==="building"&&A.type!=="building"?-1:E.position.y-A.position.y||E.id-A.id).filter(E=>Ql(E,o,l,t.mapDimensions)).forEach(E=>{var A,w;if(E.type==="building")an(e,f,g,FN,E,t,s,t.time);else if(E.type==="berryBush")an(e,f,g,KP,E,t,s,t.time);else if(E.type==="human"){const F=E,B=F.id===(s==null?void 0:s.id),D=u.some(Ce=>Ce.id===F.id),H=F.id===(d==null?void 0:d.id),b=s&&(F.id===s.motherId||F.id===s.fatherId),L=s&&(((A=F.partnerIds)==null?void 0:A.includes(s.id))||((w=s.partnerIds)==null?void 0:w.includes(F.id))),$=(s==null?void 0:s.attackTargetId)===F.id,Q=F.leaderId?t.entities.entities[F.leaderId]:void 0,_e=s?F.leaderId===s.id&&F.activeAction==="moving"&&F.target===F.leaderId&&(Q==null?void 0:Q.isCallingToFollow):!1;an(e,f,g,SN,F,B,b,D,L,H,$,_e,i,t.time,t.debugCharacterId)}else E.type==="corpse"?an(e,f,g,eN,E):E.type==="prey"?an(e,f,g,AN,E,i,t.time,t.debugCharacterId):E.type==="predator"&&an(e,f,g,wN,E,i,t.time,t.debugCharacterId)}),t.visualEffects.filter(E=>Ql(E,o,l,t.mapDimensions)).forEach(E=>{an(e,f,g,_N,E,t.time)});const I=t.notifications.filter(E=>!E.isDismissed);for(const E of I)if(E.highlightedEntityIds&&E.renderHighlights)for(const A of E.highlightedEntityIds){const w=t.entities.entities[A];w&&Ql(w,o,l,t.mapDimensions)&&an(e,f,g,F0,w,u_,c_,f_,d_,t.time)}if(t.tutorialState.isActive&&t.tutorialState.highlightedEntityIds.length>0)for(const E of t.tutorialState.highlightedEntityIds){const A=t.entities.entities[E];A&&Ql(A,o,l,t.mapDimensions)&&an(e,f,g,F0,A,Zw,Zv,qv,sh,t.time)}}function BN(e,t,i,o,l,s){let u=null,d=null;e.textAlign="left";let f=je+ln;const m=t.time/(Et/wt)/Ou%1,v=bs[Eo.Time],y=25,I=je+y;e.fillText(v,je,f+nn/2+ln/3),Qi(e,I,f,bi,nn,m,Ki,Sw),f+=nn+ci;const E=f+Tr/2,A=f+(Tr-nn)/2,w=5;ya(e,{x:je*2,y:E},Tr,5,i.gender,!1,!1,!1);const F=je+Tr+w,B=bi+y-(Tr+w)*2;Qi(e,F,A,B,nn,Math.floor(i.age)/ca,Ki,vw),ya(e,{x:F+B+w+Tr/2,y:E},Tr,ca,i.gender,!1,!1,!1),f+=nn+ci*2;const D=[],H=new Set;if(D.push({member:i,isPlayer:!0,isHeir:!1,isPartner:!1,isParent:!1}),H.add(i.id),o&&!H.has(o.id)&&(D.push({member:o,isPlayer:!1,isHeir:!0,isPartner:!1,isParent:!1}),H.add(o.id)),l.forEach(de=>{H.has(de.id)||(D.push({member:de,isPlayer:!1,isHeir:!1,isPartner:!0,isParent:!1}),H.add(de.id))}),s.forEach(de=>{H.has(de.id)||(D.push({member:de,isPlayer:!1,isHeir:!1,isPartner:!1,isParent:!1}),H.add(de.id))}),i.motherId&&!H.has(i.motherId)){const de=t.entities.entities[i.motherId];de&&(D.push({member:de,isPlayer:!1,isHeir:!1,isPartner:!1,isParent:!0}),H.add(de.id))}if(i.fatherId&&!H.has(i.fatherId)){const de=t.entities.entities[i.fatherId];de&&(D.push({member:de,isPlayer:!1,isHeir:!1,isPartner:!1,isParent:!0}),H.add(de.id))}const b=bs[Eo.Family],L=10,$=je+ln+L,Q=bi+y-(ln+L),_e=f+Hl/2;e.font=`${ln}px "Press Start 2P", Arial`,e.textBaseline="middle",e.fillText(b,je,_e);const Ce=f+Hl/2;zP(e,$,Ce,D,Hl,Q),f+=Hl+ci,e.textBaseline="alphabetic";const be=bs[Eo.Hitpoints];e.fillText(be,je,f+nn/2+ln/3),Qi(e,I,f,bi,nn,i.hitpoints/i.maxHitpoints,Ki,mw),f+=nn+ci;const De=bs[Eo.Hunger];e.fillText(De,je,f+nn/2+ln/3),Qi(e,I,f,bi,nn,(br-i.hunger)/br,Ki,pw),u={x:je,y:f-ci/2,width:bi+y,height:nn+ci},f+=nn+ci,e.textBaseline="middle";const Pe=bs[Eo.Food];return e.fillText(Pe,je,f+Bl/2),tN(e,I,f+Bl/2,i.food,Bl,bi),d={x:je,y:f-ci/5,width:bi+y,height:Bl+ci},e.textBaseline="alphabetic",{hungerBarRect:u,foodBarRect:d}}let Ws=[],B0=0;const HN=36,bN=200;function GN(e,t,i,o){const l=t.search.prey.count(),s=t.search.predator.count(),u=t.search.berryBush.count();t.time-B0>=HN&&(Ws.push({time:t.time,prey:l,predators:s,bushes:u}),Ws.length>bN&&(Ws=Ws.slice(-200)),B0=t.time);const d=et*tt,f=l/d*1e6,g=s/d*1e6,m=u/d*1e6,v=CP(),y=Math.floor(t.time/(24*365)),I=Math.floor(t.time%(24*365)/24),E=Math.floor(t.time%24),A=400,w=Math.min(o*.8,600),F=i-A-10,B=je+ln*2;e.save(),e.fillStyle="rgba(0, 0, 0, 0.9)",e.fillRect(F,B,A,w),e.strokeStyle="#444",e.lineWidth=2,e.strokeRect(F,B,A,w),e.fillStyle="white",e.font="12px monospace",e.textAlign="left";let D=B+20;const H=14,b=F+15;e.fillStyle="#66ccff",e.font="bold 14px monospace",e.fillText(" Ecosystem Debugger",b,D),D+=25,e.fillStyle="white",e.font="12px monospace",e.fillText(`Game Time: Year ${y}, Day ${I}, Hour ${E}`,b,D),D+=H,e.fillText(`Map Size: ${et}  ${tt} pixels`,b,D),D+=20,e.fillStyle="#66ccff",e.font="bold 13px monospace",e.fillText(" Q-Learning Status",b,D),D+=18,v&&(e.fillText(`Q-Table Size: ${v.qTableSize} entries`,b,D),D+=H,e.fillText(`Exploration Rate: ${(v.explorationRate*100).toFixed(1)}%`,b,D),D+=H);const L=Ws.slice(-20);L.length>1&&(e.fillStyle="#66ccff",e.font="bold 13px monospace",e.fillText(" Population Trends (Last 20 Points)",b,D),D+=30,xN(e,b,D,L),D+=50),e.fillStyle="#66ccff",e.font="bold 13px monospace",e.fillText(" Density (per 1000 px)",b,D),D+=18,e.fillStyle="white",e.font="12px monospace";const $=(pi/d*1e6).toFixed(2),Q=(mi/d*1e6).toFixed(2),_e=(vi/d*1e6).toFixed(2);e.fillText(`Prey: ${f.toFixed(2)} (target: ${$})`,b,D),D+=H,e.fillText(`Predators: ${g.toFixed(2)} (target: ${Q})`,b,D),D+=H,e.fillText(`Bushes: ${m.toFixed(2)} (target: ${_e})`,b,D),D+=20,e.fillStyle="#66ccff",e.font="bold 13px monospace",e.fillText(" Current Population Status",b,D),D+=18,e.fillStyle="white",e.font="12px monospace";const Ce=Math.round(l/pi*100),be=Math.round(s/mi*100),De=Math.round(u/vi*100),Pe=de=>de<50?"#ff4444":de<80?"#ffaa44":de>120?"#44aaff":"#44ff44";e.fillStyle=Pe(Ce),e.fillText(`Prey: ${l}/${pi} (${Ce}%)`,b,D),D+=H,e.fillStyle=Pe(be),e.fillText(`Predators: ${s}/${mi} (${be}%)`,b,D),D+=H,e.fillStyle=Pe(De),e.fillText(`Bushes: ${u}/${vi} (${De}%)`,b,D),D+=20,e.fillStyle="#66ccff",e.font="bold 13px monospace",e.fillText(" Current Parameters",b,D),D+=18,e.fillStyle="white",e.font="10px monospace",e.fillText("Prey:",b,D),D+=13,e.fillText(` Gestation: ${t.ecosystem.preyGestationPeriod.toFixed(1)}h`,b,D),D+=11,e.fillText(` Procreation: ${t.ecosystem.preyProcreationCooldown.toFixed(1)}h`,b,D),D+=11,e.fillText(` Hunger: ${t.ecosystem.preyHungerIncreasePerHour.toFixed(1)}/h`,b,D),D+=13,e.fillText("Predators:",b,D),D+=13,e.fillText(` Gestation: ${t.ecosystem.predatorGestationPeriod.toFixed(1)}h`,b,D),D+=11,e.fillText(` Procreation: ${t.ecosystem.predatorProcreationCooldown.toFixed(1)}h`,b,D),D+=11,e.fillText(` Hunger: ${t.ecosystem.predatorHungerIncreasePerHour.toFixed(1)}/h`,b,D),D+=13,e.fillText("Bushes:",b,D),D+=13,e.fillText(` Spread Chance: ${(t.ecosystem.berryBushSpreadChance*100).toFixed(1)}%`,b,D),D+=15,e.fillStyle="#888",e.font="10px monospace",e.textAlign="center",e.fillText("Press '1' to toggle this debugger",F+A/2,B+w-10),e.restore()}function xN(e,t,i,o){if(o.length<2)return;const d={prey:Math.max(...o.map(g=>g.prey),pi),predators:Math.max(...o.map(g=>g.predators),mi),bushes:Math.max(...o.map(g=>g.bushes),vi)};[{data:o.map(g=>g.prey),color:"#44ff44",label:"Prey",target:pi,max:d.prey},{data:o.map(g=>g.predators),color:"#ff4444",label:"Predators",target:mi,max:d.predators},{data:o.map(g=>g.bushes),color:"#ffaa44",label:"Bushes",target:vi,max:d.bushes}].forEach((g,m)=>{const v=t+m*115,y=i;e.fillStyle=g.color,e.font="10px monospace",e.fillText(g.label,v,y-5),e.strokeStyle="#333",e.lineWidth=1,e.strokeRect(v,y,100,30),e.beginPath(),e.strokeStyle=g.color;for(let E=0;E<g.data.length;E++){const A=v+E/(g.data.length-1)*100,w=y+30-g.data[E]/g.max*30;E===0?e.moveTo(A,w):e.lineTo(A,w)}e.stroke(),e.beginPath(),e.strokeStyle="#888",e.setLineDash([2,2]);const I=y+30-g.target/g.max*30;e.moveTo(v,I),e.lineTo(v+100,I),e.stroke(),e.setLineDash([])})}function $N(e){const t=Object.values(e.entities.entities).filter(o=>o.type==="human"),i={total:t.length,children:0,males:0,females:0,old:0};for(const o of t)o.isAdult||i.children++,o.gender==="male"?i.males++:o.gender==="female"&&i.females++,o.age>=qf&&i.old++;return i}function zN(e){const t=Object.values(e.entities.entities),o=t.filter(d=>d.type==="berryBush").reduce((d,f)=>d+f.food.length,0),u=t.filter(d=>d.type==="building").filter(d=>d.buildingType===Tn.StorageSpot).reduce((d,f)=>{var g;return d+(((g=f.storedFood)==null?void 0:g.length)||0)},0);return{totalBushFood:o,totalStorageFood:u,consumptionRate:0}}function WN(e,t){const o=e.search.human.all(),l=e.entities.entities,s=new Map,u=(g,m=new Set)=>{if(s.has(g))return s.get(g);if(m.has(g))return g;m.add(g);const v=l[g];if(!v)return g;if(v.fatherId&&l[v.fatherId]){const y=u(v.fatherId,m);return s.set(g,y),y}return s.set(g,g),g},d=new Map;for(const g of o){const m=u(g.id);d.has(m)||d.set(m,[]),d.get(m).push(g)}const f=[];for(const[g,m]of d.entries()){const v=l[g];v&&f.push({patriarch:v,memberCount:m.length,members:m.map(y=>y.id)})}return f.sort((g,m)=>m.memberCount-g.memberCount),f.slice(0,t)}let Ys=[],Qn=[],H0=0;const YN=36,b0=200;function jN(e,t,i,o){const l=$N(t),s=zN(t);if(t.time-H0>=YN){Ys.push({time:t.time,total:l.total,children:l.children,males:l.males,females:l.females,old:l.old});const B=s.totalBushFood+s.totalStorageFood;Qn.push({time:t.time,bushFood:s.totalBushFood,storageFood:s.totalStorageFood,totalFood:B}),Ys.length>b0&&(Ys=Ys.slice(-200)),Qn.length>b0&&(Qn=Qn.slice(-200)),H0=t.time}let u=0;if(Qn.length>=2){const B=Qn[Qn.length-1],D=Qn[Qn.length-2],H=B.time-D.time;H>0&&(u=(D.totalFood-B.totalFood)/H)}const d=400,f=Math.min(o*.9,700),g=i-d-10,m=je+ln*2;e.save(),e.fillStyle="rgba(0, 0, 0, 0.9)",e.fillRect(g,m,d,f),e.strokeStyle="#444",e.lineWidth=2,e.strokeRect(g,m,d,f),e.fillStyle="white",e.font="12px monospace",e.textAlign="left";let v=m+20;const y=13,I=g+15;e.fillStyle="#66ccff",e.font="bold 14px monospace",e.fillText(" Tribe Debugger",I,v),v+=25,e.fillStyle="#66ccff",e.font="bold 13px monospace",e.fillText(" Population Over Time",I,v),v+=18,e.fillStyle="white",e.font="11px monospace",e.fillText(`Total: ${l.total}`,I,v),v+=y,e.fillStyle="#00ffff",e.fillText(`Children: ${l.children}`,I,v),v+=y,e.fillStyle="#4488ff",e.fillText(`Males: ${l.males}`,I,v),v+=y,e.fillStyle="#ff88ff",e.fillText(`Females: ${l.females}`,I,v),v+=y,e.fillStyle="#888888",e.fillText(`Old (${l.old})`,I,v),v+=20;const E=Ys.slice(-50);E.length>1&&(VN(e,I,v,E),v+=100),e.fillStyle="#66ccff",e.font="bold 13px monospace",e.fillText(" Food Metrics",I,v),v+=18;const A=s.totalBushFood+s.totalStorageFood;e.fillStyle="#ffff00",e.font="11px monospace",e.fillText(`Total Food: ${A}`,I,v),v+=y,e.fillStyle="#44ff44",e.fillText(`Bush Food: ${s.totalBushFood}`,I,v),v+=y,e.fillStyle="#ffaa44",e.fillText(`Storage Food: ${s.totalStorageFood}`,I,v),v+=y,e.fillStyle="#ff4444",e.fillText(`Consumption: ${u.toFixed(2)}/hour`,I,v),v+=20;const w=Qn.slice(-50);w.length>1&&(XN(e,I,v,w),v+=100),e.fillStyle="#66ccff",e.font="bold 13px monospace",e.fillText(" Top 5 Families",I,v),v+=18;const F=WN(t,5);e.fillStyle="white",e.font="11px monospace",F.length===0?(e.fillText("No families found",I,v),v+=y):F.forEach((B,D)=>{const b=`${D+1}. ${B.patriarch.isPlayer?"Player":"#"+B.patriarch.id} (${B.memberCount} members, can split: ${Lu(B.patriarch,t).canSplit})`;e.fillText(b,I,v),v+=y}),v+=10,e.fillStyle="#888",e.font="10px monospace",e.textAlign="center",e.fillText("Press 'Shift+3' to toggle this debugger",g+d/2,m+f-10),e.restore()}function VN(e,t,i,o){if(o.length<2)return;const u=Math.max(...o.map(f=>Math.max(f.total,f.children,f.males,f.females,f.old)),10);e.strokeStyle="#333",e.lineWidth=1,e.strokeRect(t,i,350,80),[{data:o.map(f=>f.total),color:"#ffffff",label:"Total"},{data:o.map(f=>f.children),color:"#00ffff",label:"Children"},{data:o.map(f=>f.males),color:"#4488ff",label:"Males"},{data:o.map(f=>f.females),color:"#ff88ff",label:"Females"},{data:o.map(f=>f.old),color:"#888888",label:"Old"}].forEach(f=>{e.beginPath(),e.strokeStyle=f.color,e.lineWidth=2;for(let g=0;g<f.data.length;g++){const m=t+g/(f.data.length-1)*350,v=i+80-f.data[g]/u*80;g===0?e.moveTo(m,v):e.lineTo(m,v)}e.stroke()})}function XN(e,t,i,o){if(o.length<2)return;const u=Math.max(...o.map(f=>Math.max(f.totalFood,f.bushFood,f.storageFood)),10);e.strokeStyle="#333",e.lineWidth=1,e.strokeRect(t,i,350,80),[{data:o.map(f=>f.totalFood),color:"#ffff00",label:"Total"},{data:o.map(f=>f.bushFood),color:"#44ff44",label:"Bush"},{data:o.map(f=>f.storageFood),color:"#ffaa44",label:"Storage"}].forEach(f=>{e.beginPath(),e.strokeStyle=f.color,e.lineWidth=2;for(let g=0;g<f.data.length;g++){const m=t+g/(f.data.length-1)*350,v=i+80-f.data[g]/u*80;g===0?e.moveTo(m,v):e.lineTo(m,v)}e.stroke()})}function G0(e,t,i){e.save();const{x:o,y:l,width:s,height:u}=t.rect,d=zv;if(e.beginPath(),e.moveTo(o+d,l),e.lineTo(o+s-d,l),e.quadraticCurveTo(o+s,l,o+s,l+d),e.lineTo(o+s,l+u-d),e.quadraticCurveTo(o+s,l+u,o+s-d,l+u),e.lineTo(o+d,l+u),e.quadraticCurveTo(o,l+u,o,l+u-d),e.lineTo(o,l+d),e.quadraticCurveTo(o,l,o+d,l),e.closePath(),e.fillStyle=t.isDisabled?Wv:t.backgroundColor,e.fill(),t.activated){e.save();const f=(Math.sin(Date.now()/1e3*Xv)+1)/2;e.strokeStyle=Vv,e.lineWidth=2+f*2,e.globalAlpha=.7+f*.3,e.stroke(),e.restore()}if(t.lastActivated){const f=Date.now()-t.lastActivated;if(f<yu){const g=1-f/yu;e.fillStyle=jv,e.globalAlpha=g,e.fill(),e.globalAlpha=1}}i&&!t.isDisabled&&(e.fillStyle=oh,e.globalAlpha=.5,e.fill(),e.globalAlpha=1),e.fillStyle=t.isDisabled?Yv:t.textColor,t.icon?(e.font=`${u*.55}px "Press Start 2P", Arial`,e.textAlign="center",e.textBaseline="middle",e.fillText(t.icon,o+s/2,l+u/2),t.text&&(e.font=`${u*.18}px "Press Start 2P", Arial`,e.textAlign="right",e.textBaseline="bottom",e.fillText(t.text,o+s-4,l+u-2))):(e.font=`${ln*1.5}px "Press Start 2P", Arial`,e.textAlign="center",e.textBaseline="middle",e.fillText(t.text,o+s/2,l+u/2)),e.restore()}function KN(e,t,i,o){e.save(),e.fillStyle="rgba(0, 0, 0, 0.6)",e.fillRect(0,0,i,o);const l=500,s=150,u=(i-l)/2,d=(o-s)/2;e.fillStyle=yn,e.font=`${ln*1.1}px "Press Start 2P", Arial`,e.textAlign="center",e.textBaseline="middle",e.fillText("Are you sure you want to exit",i/2,d+s/3-10),e.fillText("to the main menu?",i/2,d+s/3+10);const f=gi*1.5,g=$v,m=d+s-g-je*2,v=20,y=f*2+v,I=u+(l-y)/2,E={id:"confirmExitYes",action:ge.ConfirmExitYes,rect:{x:I,y:m,width:f,height:g},text:"Yes",backgroundColor:Vi,textColor:yn,currentWidth:f},A=I+f+v,w={id:"confirmExitNo",action:ge.ConfirmExitNo,rect:{x:A,y:m,width:f,height:g},text:"No",backgroundColor:Vi,textColor:yn,currentWidth:f};t.uiButtons.push(E,w),G0(e,E,t.hoveredButtonId===E.id),G0(e,w,t.hoveredButtonId===w.id),e.restore()}function Eu(e,t,i,o,l,s=!1){var f;if(e.save(),e.clearRect(0,0,e.canvas.width,e.canvas.height),e.fillStyle="#2c5234",e.fillRect(0,0,e.canvas.width,e.canvas.height),e.translate(e.canvas.width/2-i.x,e.canvas.height/2-i.y),!s&&t.gameOver){e.restore(),VP(e,t);return}UN(e,t,t.debugPanel===ct.General,i,l);const u=St(t);if(u&&t.selectedBuildingType&&t.selectedBuildingType!=="removal"&&t.mousePosition){const g=Mf(t.mousePosition,i,l,t.mapDimensions),m=dh(g,t.selectedBuildingType,u.leaderId,t);LN(e,g,t.selectedBuildingType,m,t.mapDimensions)}const d=t.notifications.filter(g=>!g.isDismissed);for(const g of d){const m=(Math.sin(t.time*s_)+1)/2;e.globalAlpha=m*.5+.25,e.fillStyle=o_,g.targetArea&&e.fillRect(g.targetArea.x,g.targetArea.y,g.targetArea.width,g.targetArea.height),g.targetRadius&&(e.beginPath(),e.arc(g.targetRadius.x,g.targetRadius.y,g.targetRadius.radius,0,Math.PI*2),e.fill())}if(e.globalAlpha=1,oN(e,t),e.restore(),!s){e.fillStyle=fw,e.font=`${ln}px "Press Start 2P", Arial`,e.shadowColor=hw,e.shadowBlur=gw,t.uiButtons=[];let g=null,m=null;if(u){const I=un(t,u),E=xr(I),A=((f=u.partnerIds)==null?void 0:f.map(F=>t.entities.entities[F]).filter(F=>F!==void 0))||[],w=BN(e,t,u,E,A,I);g=w.hungerBarRect,m=w.foodBarRect}const v=Lv(t,u==null?void 0:u.leaderId);WP(e,t,v,e.canvas.width,e.canvas.height);const{commandButtonsRect:y}=OP(e,t,e.canvas.width);if(e.shadowColor="transparent",e.shadowBlur=0,u&&(nN(e,t,i,e.canvas.width,e.canvas.height),o.length>0&&LP(e,o,u,i,e.canvas.width,e.canvas.height,t.mapDimensions)),t.tutorialState.activeUIHighlights.length>0){const{activeUIHighlights:I}=t.tutorialState;I.includes(Ur.HUNGER_BAR)&&g&&af(e,g,t.time),I.includes(Ur.FOOD_BAR)&&m&&af(e,m,t.time),I.includes(Ur.COMMAND_BUTTONS)&&y&&af(e,y,t.time)}if(t.tutorialState.isActive){const I=jP(e,t,e.canvas.width,e.canvas.height);I&&t.uiButtons.push({id:"tutorial-dismiss",action:ge.DismissTutorial,rect:I,text:"",currentWidth:I.width,backgroundColor:"transparent",textColor:"transparent"})}switch(aN(e,t,e.canvas.width,e.canvas.height),t.debugPanel){case ct.Ecosystem:GN(e,t,e.canvas.width,e.canvas.height);break;case ct.Tribe:jN(e,t,e.canvas.width,e.canvas.height);break;case ct.Performance:uN(e,t,l.width);break}t.isPaused&&t.exitConfirmation!=="pending"&&kP(e),t.exitConfirmation==="pending"&&KN(e,t,e.canvas.width,e.canvas.height)}}const ZN=En.div`
  position: relative;
  width: 100vw;
  height: 100vh;
  overflow: hidden;
`,qN=En.canvas`
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background-color: #2c5234;
`,QN=En.div`
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  text-align: center;
  z-index: 1;
  background: linear-gradient(to bottom, rgba(0, 0, 0, 0.7) 0%, rgba(0, 0, 0, 0) 50%, rgba(0, 0, 0, 0.7) 100%);
`,JN=En.h1`
  font-family: 'Press Start 2P', cursive;
  font-size: 4rem;
  color: #fff;
  text-shadow: 4px 4px 0px #ff0000;
  margin-bottom: 2rem;
`,x0=En.button`
  font-family: 'Press Start 2P', cursive;
  font-size: 1.5rem;
  padding: 1rem 2rem;
  color: #fff;
  background-color: #ff0000;
  border: 2px solid #fff;
  box-shadow: 4px 4px 0px #fff;
  cursor: pointer;
  transition: all 0.2s ease-in-out;

  &:hover {
    background-color: #fff;
    color: #ff0000;
    box-shadow: 4px 4px 0px #ff0000;
  }
`,eD=En.div`
  display: flex;
  flex-direction: column;
  gap: 1.5rem;
  align-items: center;
`,tD=En.div`
  position: absolute;
  bottom: 1rem;
  font-family: 'Press Start 2P', cursive;
  font-size: 0.8rem;
  color: #fff;
  text-shadow: 2px 2px 0px #000;
  a {
    color: #fff;
    text-decoration: none;
    &:hover {
      text-decoration: underline;
    }
  }
`,tu="intro-soundtrack",$0=()=>{const{setAppState:e,savedGameState:t,clearCurrentSave:i}=Yo(),o=Re.useRef(null),l=Re.useRef(null),s=Re.useRef(FR()),u=Re.useRef(),d=Re.useRef(s.current.viewportCenter),f=Re.useRef(),g=Re.useCallback(()=>{Vd(tu,2),i(),e("game")},[e,i]),m=Re.useCallback(()=>{t&&(Vd(tu,2),e("game"))},[e,t]);Re.useEffect(()=>{const I=E=>{(E.key==="Enter"||E.key===" ")&&(t?m():g())};return window.addEventListener("keydown",I),()=>{window.removeEventListener("keydown",I)}},[g,m,t]),Re.useEffect(()=>(lh(fe.SoundTrack1,{loop:!0,trackId:tu}),()=>{Vd(tu,2)}),[]),Re.useEffect(()=>{const I=o.current;if(!I)return;l.current=I.getContext("2d");const E=()=>{I&&l.current&&(I.width=window.innerWidth,I.height=window.innerHeight,Eu(l.current,s.current,d.current,[],{width:I.width,height:I.height},!0))};return E(),window.addEventListener("resize",E),()=>window.removeEventListener("resize",E)},[]),Re.useEffect(()=>{const I=()=>{const A=Bv(s.current);if(A.length>0){const w=Math.floor(Math.random()*A.length);f.current=A[w].id}};I();const E=setInterval(I,cI);return()=>clearInterval(E)},[]);const[v,y]=yv(I=>{var w,F;if(!l.current)return;if(u.current===void 0){u.current=I;return}const E=Math.min((I-u.current)/1e3,1);s.current=Bu(s.current,E);const A=f.current?s.current.entities.entities[f.current]:void 0;if(A){const{mapDimensions:B}=s.current,{width:D,height:H}=B;let b={...A.position};const L=b.x-d.current.x;Math.abs(L)>D/2&&(L>0?b.x-=D:b.x+=D);const $=b.y-d.current.y;Math.abs($)>H/2&&($>0?b.y-=H:b.y+=H);let Q=th(d.current,b,jf*E);Q={x:(Q.x%D+D)%D,y:(Q.y%H+H)%H},d.current=Q}Eu(l.current,s.current,d.current,[],{width:((w=o.current)==null?void 0:w.width)||800,height:((F=o.current)==null?void 0:F.height)||600},!0),u.current=I});return Re.useEffect(()=>(y(),v),[y,v]),Fe.jsxs(ZN,{children:[Fe.jsx(qN,{ref:o}),Fe.jsxs(QN,{children:[Fe.jsx(JN,{children:"Tribe2"}),Fe.jsxs(eD,{children:[Fe.jsx(x0,{onClick:g,children:"New Game"}),t&&Fe.jsx(x0,{onClick:m,children:"Load Game"})]}),Fe.jsxs(tD,{children:["by"," ",Fe.jsx("a",{href:"https://github.com/gtanczyk",target:"_blank",rel:"noopener noreferrer",children:"gtanczyk"})]})]})]})};function nD(){console.log("Tribe game initialized with detailed 2D world state.");const e=MR();return e.ecosystem={preyGestationPeriod:Or,preyProcreationCooldown:kr,predatorGestationPeriod:Mr,predatorProcreationCooldown:Fr,preyHungerIncreasePerHour:Zi,predatorHungerIncreasePerHour:qi,berryBushSpreadChance:Si},e.debugPanel=ct.None,e.performanceMetrics={currentBucket:{renderTime:0,worldUpdateTime:0,aiUpdateTime:0},history:[]},e}const iD=({canvasRef:e,ctxRef:t,gameStateRef:i,viewportCenterRef:o,playerActionHintsRef:l})=>(Re.useEffect(()=>{const s=e.current;if(!s)return;t.current=s.getContext("2d");const u=()=>{s&&t.current&&i.current&&(s.width=window.innerWidth,s.height=window.innerHeight,Eu(t.current,i.current,o.current,l.current,{width:s.width,height:s.height},!1))};return u(),window.addEventListener("resize",u),()=>window.removeEventListener("resize",u)},[]),Fe.jsx("canvas",{ref:e,style:{display:"block",background:"#2c5234"}})),rD=(e,t,i,o=!1)=>{let l;const s=iw(e,i);if(s){if(t.isAdult&&s.type==="berryBush"&&s.food.length>0)l={action:se.AutopilotGather,targetEntityId:s.id};else if(t.isAdult&&s.type==="corpse"&&s.food.length>0)l={action:se.AutopilotGather,targetEntityId:s.id};else if(s.type==="human"){const u=s;t.isAdult&&Xo(t,u,i)?l={action:se.AutopilotAttack,targetEntityId:u.id}:zr(t,u,i)?l={action:se.AutopilotProcreate,targetEntityId:u.id}:t.food.length>0&&!u.isAdult&&(u.motherId===t.id||u.fatherId===t.id)&&(l={action:se.AutopilotFeedChild,targetEntityId:u.id})}else if(s.type==="prey")l={action:se.AutopilotAttack,targetEntityId:s.id};else if(s.type==="predator")l={action:se.AutopilotAttack,targetEntityId:s.id};else if(s.type==="building"){const u=s;if(i.selectedBuildingType==="removal")l={action:se.Removal,position:s.position};else if(u.buildingType==="storageSpot"){const d=u.ownerId===t.leaderId,f=u.storedFood!==void 0&&u.storedFood.length>0,g=u.storedFood!==void 0&&u.storageCapacity!==void 0&&u.storedFood.length<u.storageCapacity;if(o&&u.isConstructed&&f&&t.food.length<t.maxFood)if(d)l={action:se.AutopilotRetrieve,targetEntityId:s.id};else{const m=t.leaderId?i.entities.entities[t.leaderId]:void 0;m&&m.diplomacy?m.diplomacy[u.ownerId]===mt.Hostile?l={action:se.AutopilotGather,targetEntityId:s.id}:l={action:se.AutopilotMove,position:e}:l={action:se.AutopilotMove,position:e}}else d&&u.isConstructed?t.food.length>0&&g?l={action:se.AutopilotDeposit,targetEntityId:s.id}:t.food.length<t.maxFood&&f?l={action:se.AutopilotRetrieve,targetEntityId:s.id}:l={action:se.AutopilotMove,position:e}:l={action:se.AutopilotMove,position:e}}else u.buildingType==="plantingZone"&&t.food.filter(d=>d.type===Bn.Berry).length>=Br&&!bn(e,i,Hr)?l={action:se.AutopilotPlant,position:e}:l={action:se.AutopilotMove,position:e}}}else t.food.filter(u=>u.type===Bn.Berry).length>=Br&&(i.autopilotControls.isManuallyPlanting||oC(e,t,i))?l={action:se.AutopilotPlant,position:e}:l={action:se.AutopilotMove,position:e};return l},oD=(e,t)=>{if(e.isPaused)return;const i=St(e);if(!i)return;if(e.selectedBuildingType&&e.selectedBuildingType!=="removal"){dh(t,e.selectedBuildingType,i.leaderId,e)&&(sS(t,e.selectedBuildingType,i.leaderId,e),e.selectedBuildingType=null);return}if(e.selectedBuildingType==="removal"){const l=V_(t,e);l&&j_(l.id,e);return}const o=e.autopilotControls.hoveredAutopilotAction;e.autopilotControls.activeAutopilotAction=void 0,o?(e.autopilotControls.activeAutopilotAction=o,(o.action===se.AutopilotMove||o.action===se.AutopilotGather)&&(e.hasPlayerMovedEver=!0),o.action===se.AutopilotPlant&&(e.hasPlayerPlantedBush=!0)):e.autopilotControls.activeAutopilotAction={action:se.AutopilotMove,position:t},e.autopilotControls.isManuallyMoving=!1,e.autopilotControls.isManuallyPlanting=!1},sD=(e,t)=>{var u,d,f,g,m,v;const i=e.key.toLowerCase(),o=e.ctrlKey||e.metaKey;let l=!0,s=t;if(o){switch(i){case"s":Hf(t);break;default:l=!1;break}return{newState:s,handled:l}}switch(i){case"escape":const{autopilotControls:y}=t;y.activeAutopilotAction||y.isManuallyMoving||y.isManuallyPlanting||t.buildMenuOpen||t.selectedBuildingType?(y.activeAutopilotAction=void 0,y.isManuallyMoving=!1,y.isManuallyPlanting=!1,t.buildMenuOpen=!1,t.selectedBuildingType=null):s.exitConfirmation==="pending"?(s.exitConfirmation="inactive",s.isPaused=!1):(s.exitConfirmation="pending",s.isPaused=!0);break;case"m":t.isMuted=!t.isMuted,Js(t.masterVolume,t.isMuted);break;case"=":case"+":const I=Math.min(1,t.masterVolume+.1);t.masterVolume=parseFloat(I.toFixed(1)),Js(t.masterVolume,t.isMuted);break;case"-":const E=Math.max(0,t.masterVolume-.1);t.masterVolume=parseFloat(E.toFixed(1)),Js(t.masterVolume,t.isMuted);break;case"t":s=Bu(t,tS);break;case" ":case"p":t.isPaused=!t.isPaused;break;case"":case"`":s.debugPanel===ct.General?(s.debugPanel=ct.None,s.debugCharacterId=void 0):(s.debugPanel=ct.General,s.debugCharacterId||(s.debugCharacterId=((u=St(s))==null?void 0:u.id)??((d=Object.values(s.entities.entities).find(w=>w.type==="human"||w.type==="prey"||w.type==="predator"))==null?void 0:d.id)));break;case"!":if(e.shiftKey){if(s.debugPanel===ct.Ecosystem){s.debugPanel=ct.None;break}s.debugPanel=ct.Ecosystem,s.debugCharacterId||(s.debugCharacterId=((f=St(s))==null?void 0:f.id)??((g=Object.values(s.entities.entities).find(w=>w.type==="human"||w.type==="prey"||w.type==="predator"))==null?void 0:g.id))}else l=!1;break;case"#":if(e.shiftKey&&s.debugPanel===ct.Tribe){s.debugPanel=ct.None;break}s.debugPanel=ct.Tribe,s.debugCharacterId?l=!1:s.debugCharacterId=((m=St(s))==null?void 0:m.id)??((v=Object.values(s.entities.entities).find(w=>w.type==="human"||w.type==="prey"||w.type==="predator"))==null?void 0:v.id);break;case"@":if(e.shiftKey){if(s.debugPanel===ct.Performance){s.debugPanel=ct.None;break}s.debugPanel=ct.Performance}else l=!1;break;case"tab":s.debugPanel=ct.General;const A=Object.values(s.entities.entities).filter(w=>w.type==="human"||w.type==="prey"||w.type==="predator");if(A.length>0){const w=A.sort((H,b)=>{if(H.type==="human"&&H.isPlayer)return-1;if(b.type==="human"&&b.isPlayer)return 1;if(H.type!==b.type){const L={human:0,prey:1,predator:2},$=L[H.type]??999,Q=L[b.type]??999;return $-Q}return H.id-b.id}),F=s.debugCharacterId,D=((F?w.findIndex(H=>H.id===F):-1)+1)%w.length;s.debugCharacterId=w[D].id}else s.debugCharacterId=void 0;break;default:l=!1;break}return{newState:s,handled:l}},aD=(e,t,i,o,l)=>{const s={gameState:i};if(t&&["e","b","r","h"].includes(e)&&i.hasPlayerEnabledAutopilot++,i.buildMenuOpen){if(e==="1"){i.selectedBuildingType="storageSpot",Ie(s,fe.ButtonClick,o.position);return}else if(e==="2"){i.selectedBuildingType="plantingZone",Ie(s,fe.ButtonClick,o.position);return}else if(e==="3"){i.selectedBuildingType="removal",Ie(s,fe.ButtonClick,o.position);return}}if(e==="escape"&&i.selectedBuildingType){i.selectedBuildingType=null;return}if(e==="e"){if(t){i.autopilotControls.behaviors.gathering=!i.autopilotControls.behaviors.gathering;return}const u=Ne(o,i,"berryBush",vt,g=>g.food.length>0&&o.food.length<o.maxFood),d=Ne(o,i,"corpse",vt,g=>g.food.length>0&&o.food.length<o.maxFood);let f=null;u&&d?f=Y(o.position,u.position,i.mapDimensions.width,i.mapDimensions.height)<=Y(o.position,d.position,i.mapDimensions.width,i.mapDimensions.height)?u:d:f=u||d,f&&(o.activeAction="gathering",Ie(s,fe.Gather,o.position))}else if(e==="r"){if(t){i.autopilotControls.behaviors.procreation=!i.autopilotControls.behaviors.procreation;return}Ne(o,i,"human",vt,d=>zr(o,d,i))&&(o.activeAction="procreating",Ie(s,fe.Procreate,o.position))}else if(e==="f")o.food.length>0&&(o.activeAction="eating",Ie(s,fe.Eat,o.position));else if(e==="h"){if(t){i.autopilotControls.behaviors.feedChildren=!i.autopilotControls.behaviors.feedChildren;return}const u=l.find(d=>d.type===se.FeedChild);u&&u.targetEntity&&(o.activeAction="feeding",o.target=u.targetEntity.id)}else if(e==="arrowup"||e==="w")o.direction.y=-1,o.activeAction="moving",o.target=void 0,i.hasPlayerMovedEver=!0,i.autopilotControls.isManuallyMoving=!0,i.autopilotControls.activeAutopilotAction=void 0;else if(e==="arrowdown"||e==="s")o.direction.y=1,o.activeAction="moving",o.target=void 0,i.hasPlayerMovedEver=!0,i.autopilotControls.isManuallyMoving=!0,i.autopilotControls.activeAutopilotAction=void 0;else if(e==="arrowleft"||e==="a")o.direction.x=-1,o.activeAction="moving",o.target=void 0,i.hasPlayerMovedEver=!0,i.autopilotControls.isManuallyMoving=!0,i.autopilotControls.activeAutopilotAction=void 0;else if(e==="arrowright"||e==="d")o.direction.x=1,o.activeAction="moving",o.target=void 0,i.hasPlayerMovedEver=!0,i.autopilotControls.isManuallyMoving=!0,i.autopilotControls.activeAutopilotAction=void 0;else if(e==="q"){if(t){i.autopilotControls.behaviors.attack=!i.autopilotControls.behaviors.attack;return}const u=Ne(o,i,"human",ti,d=>Xo(o,d,i))??Ne(o,i,"predator",ti)??Ne(o,i,"prey",ti);u&&(o.activeAction="attacking",o.attackTargetId=u.id)}else if(e==="b"){if(t){i.autopilotControls.behaviors.planting=!i.autopilotControls.behaviors.planting;return}if(l.find(d=>d.type===se.Plant)){const d=XE(o.position,i,50,wf);d&&(o.activeAction="planting",o.target=d,i.hasPlayerPlantedBush=!0)}}else if(e==="x"){if(t){i.autopilotControls.behaviors.gathering=!i.autopilotControls.behaviors.gathering;return}const u=Ne(o,i,"building",In,d=>{const f=d;return f.buildingType==="storageSpot"&&f.ownerId===o.leaderId&&f.isConstructed&&f.storedFood!==void 0&&f.storageCapacity!==void 0&&f.storedFood.length<f.storageCapacity});u&&(o.activeAction="idle",o.target=u.id,Ie(s,fe.StorageDeposit,o.position))}else if(e==="z"){if(t){i.autopilotControls.behaviors.feedChildren=!i.autopilotControls.behaviors.feedChildren;return}const u=Ne(o,i,"building",In,d=>{const f=d;return f.buildingType==="storageSpot"&&f.ownerId===o.leaderId&&f.isConstructed&&f.storedFood!==void 0&&f.storedFood.length>0});u&&(o.activeAction="idle",o.target=u.id,Ie(s,fe.StorageRetrieve,o.position))}else e==="v"?(o.isCallingToAttack=!0,o.callToAttackEndTime=i.time+xo,ke(i,ce.CallToAttack,o.position,xo),Ie(s,fe.CallToAttack,o.position)):e==="c"?(o.isCallingToFollow=!0,o.callToFollowEndTime=i.time+fa,ke(i,ce.CallToFollow,o.position,fa),Ie(s,fe.CallToFollow,o.position)):e==="k"?uh(o,i):e==="l"&&(i.buildMenuOpen=!i.buildMenuOpen,Ie(s,fe.ButtonClick,o.position))},lD=(e,t,i,o)=>{e==="arrowup"||e==="w"||e==="arrowdown"||e==="s"?t.direction.y=0:(e==="arrowleft"||e==="a"||e==="arrowright"||e==="d")&&(t.direction.x=0),!o.current.has("arrowup")&&!o.current.has("arrowdown")&&!o.current.has("arrowleft")&&!o.current.has("arrowright")&&!o.current.has("w")&&!o.current.has("a")&&!o.current.has("s")&&!o.current.has("d")&&(t.activeAction==="moving"&&(t.activeAction="idle"),i.autopilotControls.isManuallyMoving=!1),!o.current.has("e")&&t.activeAction==="gathering"&&(t.activeAction="idle"),!o.current.has("f")&&t.activeAction==="eating"&&(t.activeAction="idle"),!o.current.has("r")&&t.activeAction==="procreating"&&(t.activeAction="idle"),!o.current.has("h")&&t.activeAction==="feeding"&&(t.activeAction="idle")},uD=(e,t,i)=>{let l=St(e);if(e.debugCharacterId){const s=e.entities.entities[e.debugCharacterId];s&&"position"in s&&(l=s)}if(l){const{mapDimensions:s}=e,{width:u,height:d}=s;let f={...l.position};const g=f.x-t.x;Math.abs(g)>u/2&&(g>0?f.x-=u:f.x+=u);const m=f.y-t.y;Math.abs(m)>d/2&&(m>0?f.y-=d:f.y+=d);let v=th(t,f,jf*i);return v={x:(v.x%u+u)%u,y:(v.y%d+d)%d},v}return e.viewportCenter};function cD(e,t){const{width:i,height:o}=e.mapDimensions;e.viewportCenter={x:(t.x%i+i)%i,y:(t.y%o+o)%o}}const dD=(e,t,i,o)=>{const l={gameState:i},s=St(i);s&&Ie(l,fe.ButtonClick,s.position);const u=i.uiButtons.find(f=>f.id===e.id);u&&(u.lastActivated=Date.now()),t&&[ge.CommandGather,ge.CommandPlant,ge.ToggleProcreationBehavior].includes(e.action)&&i.hasPlayerEnabledAutopilot++;const{behaviors:d}=i.autopilotControls;switch(e.action){case ge.ReturnToIntro:i.exitConfirmation="pending",i.isPaused=!0;break;case ge.ConfirmExitYes:o(),i.exitConfirmation="inactive";break;case ge.ConfirmExitNo:i.exitConfirmation="inactive",i.isPaused=!1;break;case ge.ToggleMute:i.isMuted=!i.isMuted,Js(i.masterVolume,i.isMuted);break;case ge.TogglePause:i.isPaused=!i.isPaused;break;case ge.FastForward:return Bu(i,tS);case ge.DismissTutorial:i.tutorialState.isActive=!1;break;case ge.CommandEat:s&&s.food.length>0&&(s.activeAction="eating");break;case ge.CommandGather:t?d.gathering=!d.gathering:s&&(s.activeAction="gathering");break;case ge.CommandPlant:t?d.planting=!d.planting:s&&(i.autopilotControls.isManuallyPlanting=!0);break;case ge.ToggleProcreationBehavior:d.procreation=!d.procreation;break;case ge.ToggleAttackBehavior:d.attack=!d.attack;break;case ge.ToggleFeedChildBehavior:d.feedChildren=!d.feedChildren;break;case ge.ToggleAutopilotFollowLeaderBehavior:d.followLeader=!d.followLeader;break;case ge.CommandCallToAttack:s&&s.leaderId===s.id&&(s.isCallingToAttack=!0,s.callToAttackEndTime=i.time+xo,ke(i,ce.CallToAttack,s.position,xo),Ie(l,fe.CallToAttack,s.position));break;case ge.CommandFollowMe:t?d.followLeader=!d.followLeader:s&&s.leaderId===s.id&&(s.isCallingToFollow=!0,s.callToFollowEndTime=i.time+fa,ke(i,ce.CallToFollow,s.position,fa),Ie(l,fe.CallToFollow,s.position));break;case ge.CommandTribeSplit:s&&uh(s,i);break;case ge.CommandBuild:i.buildMenuOpen=!i.buildMenuOpen;break;case ge.SelectStorageSpot:i.selectedBuildingType="storageSpot";break;case ge.SelectPlantingZone:i.selectedBuildingType="plantingZone";break;case ge.SelectRemovalTool:i.selectedBuildingType="removal";break;case ge.ToggleDiplomacy:if(s&&s.leaderId&&e.targetTribeId){const f=s.leaderId,g=e.targetTribeId,m=i.entities.entities[g],v=s.diplomacy,y=m==null?void 0:m.diplomacy;if(v&&y){const E=(v[g]||mt.Friendly)===mt.Friendly?mt.Hostile:mt.Friendly;v[g]=E,y[f]=E}}break}return i};function fD(e,t,i){if(!e.notificationButtonRects)return!1;const o=St(e);for(const[l,s]of Object.entries(e.notificationButtonRects.dismiss))if(t>=s.x&&t<=s.x+s.width&&i>=s.y&&i<=s.y+s.height)return A_(e,l),o&&Ie({gameState:e},fe.ButtonClick,o.position),!0;for(const[l,s]of Object.entries(e.notificationButtonRects.view))if(t>=s.x&&t<=s.x+s.width&&i>=s.y&&i<=s.y+s.height){const u=e.notifications.find(d=>d.id===l);if(u){let d=u.targetPosition;if(!d&&u.targetEntityIds&&u.targetEntityIds.length>0){const f=e.entities.entities[u.targetEntityIds[0]];f&&(d=f.position)}return d&&cD(e,d),o&&Ie({gameState:e},fe.ButtonClick,o.position),u.highlightedEntityIds&&(u.renderHighlights=!u.renderHighlights),!0}}return!1}const hD=({isActive:e,gameStateRef:t,canvasRef:i,viewportCenterRef:o,playerActionHintsRef:l,keysPressed:s,returnToIntro:u})=>(Re.useEffect(()=>{const d=f=>{if(!e()||t.current.gameOver||!i.current||!f.target||f.target!==i.current)return;const g=i.current.getBoundingClientRect(),m=f.clientX-g.left,v=f.clientY-g.top;if(fD(t.current,m,v))return;const I=t.current.uiButtons.find(A=>m>=A.rect.x&&m<=A.rect.x+A.rect.width&&v>=A.rect.y&&v<=A.rect.y+A.rect.height);if(I){t.current=dD(I,f.shiftKey,t.current,u);return}const E=Mf({x:m,y:v},o.current,{width:i.current.width,height:i.current.height},t.current.mapDimensions);oD(t.current,E)};return window.addEventListener("mousedown",d),()=>{window.removeEventListener("mousedown",d)}},[e,i,t,o,u]),Re.useEffect(()=>{const d=f=>{if(!e()||!i.current)return;const g=i.current.getBoundingClientRect(),m=f.clientX-g.left,v=f.clientY-g.top;t.current.mousePosition={x:m,y:v};let y;if(t.current.notificationButtonRects){for(const[E,A]of Object.entries(t.current.notificationButtonRects.dismiss))if(m>=A.x&&m<=A.x+A.width&&v>=A.y&&v<=A.y+A.height){y=`notification-dismiss-${E}`;break}if(!y){for(const[E,A]of Object.entries(t.current.notificationButtonRects.view))if(m>=A.x&&m<=A.x+A.width&&v>=A.y&&v<=A.y+A.height){y=`notification-view-${E}`;break}}}if(!y)for(let E=t.current.uiButtons.length-1;E>=0;E--){const A=t.current.uiButtons[E];if(m>=A.rect.x&&m<=A.rect.x+A.rect.width&&v>=A.rect.y&&v<=A.rect.y+A.rect.height){y=A.id;break}}if(t.current.hoveredButtonId=y,y){t.current.autopilotControls.hoveredAutopilotAction=void 0;return}const I=St(t.current);if(I){const E=Mf({x:m,y:v},o.current,{width:i.current.width,height:i.current.height},t.current.mapDimensions);t.current.autopilotControls.hoveredAutopilotAction=rD(E,I,t.current,f.shiftKey)}else t.current.autopilotControls.hoveredAutopilotAction=void 0};return window.addEventListener("mousemove",d),()=>{window.removeEventListener("mousemove",d)}},[e,i,t,o]),Re.useEffect(()=>{const d=g=>{if(!e()||t.current.gameOver)return;const m=g.key.toLowerCase();(m===" "||m==="p"||m==="tab"||(g.ctrlKey||g.metaKey)&&(m==="s"||m==="a"))&&g.preventDefault();const v=sD(g,t.current);if(t.current=v.newState,v.handled)return;const y=St(t.current);y&&(s.current.add(m),aD(m,g.shiftKey,t.current,y,l.current))},f=g=>{if(!e()||t.current.gameOver)return;const m=g.key.toLowerCase();s.current.delete(m);const v=St(t.current);v&&lD(m,v,t.current,s)};return window.addEventListener("keydown",d),window.addEventListener("keyup",f),()=>{window.removeEventListener("keydown",d),window.removeEventListener("keyup",f)}},[e,t,l,s,u]),null),gD=({gameStateRef:e,ctxRef:t,debugPanelTypeRef:i,viewportCenterRef:o,playerActionHintsRef:l,keysPressed:s,canvasRef:u,setAppState:d,appState:f})=>{const g=Re.useRef(),{returnToIntro:m}=Yo(),[v,y,I]=yv(E=>{var H,b;if(!t.current||!g.current){g.current=E;return}const A=Math.min(E-g.current,1e3)/1e3,{performanceMetrics:w}=e.current;w.currentBucket={renderTime:0,worldUpdateTime:0,aiUpdateTime:0};const F=performance.now();e.current=Bu(e.current,A),w.currentBucket.worldUpdateTime=performance.now()-F;const B=St(e.current);B?l.current=ch(e.current,B):l.current=[],o.current=uD(e.current,o.current,A);const D=performance.now();Eu(t.current,e.current,o.current,l.current,{width:((H=u.current)==null?void 0:H.width)||800,height:((b=u.current)==null?void 0:b.height)||600},!1),w.currentBucket.renderTime=performance.now()-D,w.history.push({bucketTime:e.current.time,...w.currentBucket}),w.history.length>dI&&w.history.shift(),g.current=E,e.current.gameOver&&f!=="gameOver"&&(lh(fe.GameOver,{masterVolume:e.current.masterVolume,isMuted:e.current.isMuted}),d("gameOver",{generations:e.current.generationCount,cause:e.current.causeOfGameOver||"Unknown"}))});return Re.useEffect(()=>(y(),v),[y,v]),Fe.jsx(hD,{isActive:I,gameStateRef:e,canvasRef:u,viewportCenterRef:o,playerActionHintsRef:l,debugPanelTypeRef:i,keysPressed:s,returnToIntro:m})},z0=()=>{const{savedGameState:e,contextReady:t}=Yo(),[i,o]=Re.useState(null);return Re.useEffect(()=>{t&&(e?(console.log("Loading saved game state..."),o(e)):(console.log("Initializing new game state..."),o(nD())))},[t,e]),!t||!i?Fe.jsx("div",{children:"Loading..."}):Fe.jsx(pD,{initialState:i})},pD=({initialState:e})=>{const t=Re.useRef(null),i=Re.useRef(null),o=Re.useRef(e),l=Re.useRef(new Set),s=Re.useRef(e.debugPanel),u=Re.useRef(e.viewportCenter),d=Re.useRef([]),{appState:f,setAppState:g}=Yo();return Fe.jsxs(Fe.Fragment,{children:[Fe.jsx(iD,{canvasRef:t,ctxRef:i,gameStateRef:o,debugPanelTypeRef:s,viewportCenterRef:u,playerActionHintsRef:d}),Fe.jsx(gD,{gameStateRef:o,ctxRef:i,debugPanelTypeRef:s,viewportCenterRef:u,playerActionHintsRef:d,keysPressed:l,canvasRef:t,setAppState:g,appState:f})]})},mD=En.div`
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  text-align: center;
  background-color: rgba(0, 0, 0, 0.75); // Semi-transparent overlay
  color: #fff;
  padding: 20px;
  z-index: 10; // Ensure it's on top
`,vD=En.h1`
  font-family: 'Press Start 2P', cursive;
  font-size: 4rem;
  color: #ff4136; // Red for emphasis
  text-shadow: 4px 4px 0px #000;
  margin-bottom: 1.5rem;
`,nu=En.p`
  font-family: 'Press Start 2P', cursive;
  font-size: 1.2rem;
  margin: 0.5em 0;
  color: #fff;
  text-shadow: 2px 2px 0px #000;
`,SD=En.button`
  font-family: 'Press Start 2P', cursive;
  font-size: 1rem;
  padding: 1rem 2rem;
  margin-top: 2em;
  color: #fff;
  background-color: #ff4136; // Red button
  border: 2px solid #fff;
  box-shadow: 4px 4px 0px #fff;
  cursor: pointer;
  transition: all 0.2s ease-in-out;
  text-transform: uppercase;

  &:hover {
    background-color: #fff;
    color: #ff4136;
    box-shadow: 4px 4px 0px #ff4136;
  }
`,yD=()=>{const{setAppState:e,gameOverDetails:t}=Yo(),i=()=>{e("intro")};return Fe.jsxs(mD,{children:[Fe.jsx(vD,{children:"Game Over"}),Fe.jsx(nu,{children:"Your tribe's lineage has ended."}),t&&Fe.jsxs(Fe.Fragment,{children:[Fe.jsxs(nu,{children:["Generations Survived: ",t.generations]}),Fe.jsxs(nu,{children:["Cause of Extinction: ",t.cause]})]}),!t&&Fe.jsx(nu,{children:"Game details are unavailable."}),Fe.jsx(SD,{onClick:i,children:"Return to Menu"})]})},TD=rI`
  /* CSS Reset */
  *, *::before, *::after {
    box-sizing: border-box;
  }

  body {
    margin: 0;
    padding: 0;
    font-family: 'Press Start 2P', 'Arial', sans-serif;
    background-color: #121212;
    color: #f0f0f0;
    line-height: 1.6;
  }

  /* Additional global styles */
  h1, h2, h3, h4, h5, h6 {
    margin-top: 0;
  }

  button {
    cursor: pointer;
    font-family: inherit;
  }

  /* Prevent overflow issues */
  html, body {
    height: 100%;
    overflow-x: hidden;
  }

  /* Root element for React app */
  #root {
    height: 100%;
  }
`;function AD(e,t){Re.useEffect(()=>{const i=()=>{const o=document.location.hash==="#game"?"game":"intro";t(o)};return window.addEventListener("hashchange",i),i(),()=>{window.removeEventListener("hashchange",i)}},[]),Re.useEffect(()=>{e==="game"?document.location.hash="#game":e==="intro"&&(document.location.hash="")},[e])}const ID=()=>{const{appState:e,setAppState:t}=Yo();AD(e,t);const i=()=>{switch(e){case"intro":return Fe.jsx($0,{});case"game":return Fe.jsx(z0,{});case"gameOver":return Fe.jsxs(Fe.Fragment,{children:[Fe.jsx(z0,{}),Fe.jsx(yD,{})]});default:return Fe.jsx($0,{})}};return Fe.jsxs(Fe.Fragment,{children:[Fe.jsx(TD,{}),i()]})},W0=document.getElementById("root");W0?F_().then(()=>{jT.createRoot(W0).render(Fe.jsx(ei.StrictMode,{children:Fe.jsx(iA,{initialAppState:document.location.hash==="#game"?"game":"intro",children:Fe.jsx(ID,{})})}))}):console.error("Failed to find the root element");
