var fA=Object.defineProperty;var hA=(e,n,r)=>n in e?fA(e,n,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[n]=r;var ke=(e,n,r)=>hA(e,typeof n!="symbol"?n+"":n,r);(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const l of document.querySelectorAll('link[rel="modulepreload"]'))o(l);new MutationObserver(l=>{for(const a of l)if(a.type==="childList")for(const u of a.addedNodes)u.tagName==="LINK"&&u.rel==="modulepreload"&&o(u)}).observe(document,{childList:!0,subtree:!0});function r(l){const a={};return l.integrity&&(a.integrity=l.integrity),l.referrerPolicy&&(a.referrerPolicy=l.referrerPolicy),l.crossOrigin==="use-credentials"?a.credentials="include":l.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function o(l){if(l.ep)return;l.ep=!0;const a=r(l);fetch(l.href,a)}})();function E0(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var fd={exports:{}},ws={},hd={exports:{}},Be={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Qp;function gA(){if(Qp)return Be;Qp=1;var e=Symbol.for("react.element"),n=Symbol.for("react.portal"),r=Symbol.for("react.fragment"),o=Symbol.for("react.strict_mode"),l=Symbol.for("react.profiler"),a=Symbol.for("react.provider"),u=Symbol.for("react.context"),d=Symbol.for("react.forward_ref"),h=Symbol.for("react.suspense"),g=Symbol.for("react.memo"),m=Symbol.for("react.lazy"),y=Symbol.iterator;function S(R){return R===null||typeof R!="object"?null:(R=y&&R[y]||R["@@iterator"],typeof R=="function"?R:null)}var E={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},w=Object.assign,T={};function C(R,L,K){this.props=R,this.context=L,this.refs=T,this.updater=K||E}C.prototype.isReactComponent={},C.prototype.setState=function(R,L){if(typeof R!="object"&&typeof R!="function"&&R!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,R,L,"setState")},C.prototype.forceUpdate=function(R){this.updater.enqueueForceUpdate(this,R,"forceUpdate")};function F(){}F.prototype=C.prototype;function B(R,L,K){this.props=R,this.context=L,this.refs=T,this.updater=K||E}var D=B.prototype=new F;D.constructor=B,w(D,C.prototype),D.isPureReactComponent=!0;var H=Array.isArray,x=Object.prototype.hasOwnProperty,U={current:null},$={key:!0,ref:!0,__self:!0,__source:!0};function J(R,L,K){var ie,ye={},se=null,we=null;if(L!=null)for(ie in L.ref!==void 0&&(we=L.ref),L.key!==void 0&&(se=""+L.key),L)x.call(L,ie)&&!$.hasOwnProperty(ie)&&(ye[ie]=L[ie]);var Te=arguments.length-2;if(Te===1)ye.children=K;else if(1<Te){for(var q=Array(Te),re=0;re<Te;re++)q[re]=arguments[re+2];ye.children=q}if(R&&R.defaultProps)for(ie in Te=R.defaultProps,Te)ye[ie]===void 0&&(ye[ie]=Te[ie]);return{$$typeof:e,type:R,key:se,ref:we,props:ye,_owner:U.current}}function Ce(R,L){return{$$typeof:e,type:R.type,key:L,ref:R.ref,props:R.props,_owner:R._owner}}function _e(R){return typeof R=="object"&&R!==null&&R.$$typeof===e}function Ge(R){var L={"=":"=0",":":"=2"};return"$"+R.replace(/[=:]/g,function(K){return L[K]})}var Ne=/\/+/g;function Pe(R,L){return typeof R=="object"&&R!==null&&R.key!=null?Ge(""+R.key):L.toString(36)}function de(R,L,K,ie,ye){var se=typeof R;(se==="undefined"||se==="boolean")&&(R=null);var we=!1;if(R===null)we=!0;else switch(se){case"string":case"number":we=!0;break;case"object":switch(R.$$typeof){case e:case n:we=!0}}if(we)return we=R,ye=ye(we),R=ie===""?"."+Pe(we,0):ie,H(ye)?(K="",R!=null&&(K=R.replace(Ne,"$&/")+"/"),de(ye,L,K,"",function(re){return re})):ye!=null&&(_e(ye)&&(ye=Ce(ye,K+(!ye.key||we&&we.key===ye.key?"":(""+ye.key).replace(Ne,"$&/")+"/")+R)),L.push(ye)),1;if(we=0,ie=ie===""?".":ie+":",H(R))for(var Te=0;Te<R.length;Te++){se=R[Te];var q=ie+Pe(se,Te);we+=de(se,L,K,q,ye)}else if(q=S(R),typeof q=="function")for(R=q.call(R),Te=0;!(se=R.next()).done;)se=se.value,q=ie+Pe(se,Te++),we+=de(se,L,K,q,ye);else if(se==="object")throw L=String(R),Error("Objects are not valid as a React child (found: "+(L==="[object Object]"?"object with keys {"+Object.keys(R).join(", ")+"}":L)+"). If you meant to render a collection of children, use an array instead.");return we}function Ue(R,L,K){if(R==null)return R;var ie=[],ye=0;return de(R,ie,"","",function(se){return L.call(K,se,ye++)}),ie}function Ae(R){if(R._status===-1){var L=R._result;L=L(),L.then(function(K){(R._status===0||R._status===-1)&&(R._status=1,R._result=K)},function(K){(R._status===0||R._status===-1)&&(R._status=2,R._result=K)}),R._status===-1&&(R._status=0,R._result=L)}if(R._status===1)return R._result.default;throw R._result}var ne={current:null},W={transition:null},X={ReactCurrentDispatcher:ne,ReactCurrentBatchConfig:W,ReactCurrentOwner:U};function Y(){throw Error("act(...) is not supported in production builds of React.")}return Be.Children={map:Ue,forEach:function(R,L,K){Ue(R,function(){L.apply(this,arguments)},K)},count:function(R){var L=0;return Ue(R,function(){L++}),L},toArray:function(R){return Ue(R,function(L){return L})||[]},only:function(R){if(!_e(R))throw Error("React.Children.only expected to receive a single React element child.");return R}},Be.Component=C,Be.Fragment=r,Be.Profiler=l,Be.PureComponent=B,Be.StrictMode=o,Be.Suspense=h,Be.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=X,Be.act=Y,Be.cloneElement=function(R,L,K){if(R==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+R+".");var ie=w({},R.props),ye=R.key,se=R.ref,we=R._owner;if(L!=null){if(L.ref!==void 0&&(se=L.ref,we=U.current),L.key!==void 0&&(ye=""+L.key),R.type&&R.type.defaultProps)var Te=R.type.defaultProps;for(q in L)x.call(L,q)&&!$.hasOwnProperty(q)&&(ie[q]=L[q]===void 0&&Te!==void 0?Te[q]:L[q])}var q=arguments.length-2;if(q===1)ie.children=K;else if(1<q){Te=Array(q);for(var re=0;re<q;re++)Te[re]=arguments[re+2];ie.children=Te}return{$$typeof:e,type:R.type,key:ye,ref:se,props:ie,_owner:we}},Be.createContext=function(R){return R={$$typeof:u,_currentValue:R,_currentValue2:R,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},R.Provider={$$typeof:a,_context:R},R.Consumer=R},Be.createElement=J,Be.createFactory=function(R){var L=J.bind(null,R);return L.type=R,L},Be.createRef=function(){return{current:null}},Be.forwardRef=function(R){return{$$typeof:d,render:R}},Be.isValidElement=_e,Be.lazy=function(R){return{$$typeof:m,_payload:{_status:-1,_result:R},_init:Ae}},Be.memo=function(R,L){return{$$typeof:g,type:R,compare:L===void 0?null:L}},Be.startTransition=function(R){var L=W.transition;W.transition={};try{R()}finally{W.transition=L}},Be.unstable_act=Y,Be.useCallback=function(R,L){return ne.current.useCallback(R,L)},Be.useContext=function(R){return ne.current.useContext(R)},Be.useDebugValue=function(){},Be.useDeferredValue=function(R){return ne.current.useDeferredValue(R)},Be.useEffect=function(R,L){return ne.current.useEffect(R,L)},Be.useId=function(){return ne.current.useId()},Be.useImperativeHandle=function(R,L,K){return ne.current.useImperativeHandle(R,L,K)},Be.useInsertionEffect=function(R,L){return ne.current.useInsertionEffect(R,L)},Be.useLayoutEffect=function(R,L){return ne.current.useLayoutEffect(R,L)},Be.useMemo=function(R,L){return ne.current.useMemo(R,L)},Be.useReducer=function(R,L,K){return ne.current.useReducer(R,L,K)},Be.useRef=function(R){return ne.current.useRef(R)},Be.useState=function(R){return ne.current.useState(R)},Be.useSyncExternalStore=function(R,L,K){return ne.current.useSyncExternalStore(R,L,K)},Be.useTransition=function(){return ne.current.useTransition()},Be.version="18.3.1",Be}var Jp;function Ef(){return Jp||(Jp=1,hd.exports=gA()),hd.exports}/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var em;function pA(){if(em)return ws;em=1;var e=Ef(),n=Symbol.for("react.element"),r=Symbol.for("react.fragment"),o=Object.prototype.hasOwnProperty,l=e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,a={key:!0,ref:!0,__self:!0,__source:!0};function u(d,h,g){var m,y={},S=null,E=null;g!==void 0&&(S=""+g),h.key!==void 0&&(S=""+h.key),h.ref!==void 0&&(E=h.ref);for(m in h)o.call(h,m)&&!a.hasOwnProperty(m)&&(y[m]=h[m]);if(d&&d.defaultProps)for(m in h=d.defaultProps,h)y[m]===void 0&&(y[m]=h[m]);return{$$typeof:n,type:d,key:S,ref:E,props:y,_owner:l.current}}return ws.Fragment=r,ws.jsx=u,ws.jsxs=u,ws}var tm;function mA(){return tm||(tm=1,fd.exports=pA()),fd.exports}var Fe=mA(),Re=Ef();const Xn=E0(Re);var Sl={},gd={exports:{}},qt={},pd={exports:{}},md={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var nm;function vA(){return nm||(nm=1,function(e){function n(W,X){var Y=W.length;W.push(X);e:for(;0<Y;){var R=Y-1>>>1,L=W[R];if(0<l(L,X))W[R]=X,W[Y]=L,Y=R;else break e}}function r(W){return W.length===0?null:W[0]}function o(W){if(W.length===0)return null;var X=W[0],Y=W.pop();if(Y!==X){W[0]=Y;e:for(var R=0,L=W.length,K=L>>>1;R<K;){var ie=2*(R+1)-1,ye=W[ie],se=ie+1,we=W[se];if(0>l(ye,Y))se<L&&0>l(we,ye)?(W[R]=we,W[se]=Y,R=se):(W[R]=ye,W[ie]=Y,R=ie);else if(se<L&&0>l(we,Y))W[R]=we,W[se]=Y,R=se;else break e}}return X}function l(W,X){var Y=W.sortIndex-X.sortIndex;return Y!==0?Y:W.id-X.id}if(typeof performance=="object"&&typeof performance.now=="function"){var a=performance;e.unstable_now=function(){return a.now()}}else{var u=Date,d=u.now();e.unstable_now=function(){return u.now()-d}}var h=[],g=[],m=1,y=null,S=3,E=!1,w=!1,T=!1,C=typeof setTimeout=="function"?setTimeout:null,F=typeof clearTimeout=="function"?clearTimeout:null,B=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function D(W){for(var X=r(g);X!==null;){if(X.callback===null)o(g);else if(X.startTime<=W)o(g),X.sortIndex=X.expirationTime,n(h,X);else break;X=r(g)}}function H(W){if(T=!1,D(W),!w)if(r(h)!==null)w=!0,Ae(x);else{var X=r(g);X!==null&&ne(H,X.startTime-W)}}function x(W,X){w=!1,T&&(T=!1,F(J),J=-1),E=!0;var Y=S;try{for(D(X),y=r(h);y!==null&&(!(y.expirationTime>X)||W&&!Ge());){var R=y.callback;if(typeof R=="function"){y.callback=null,S=y.priorityLevel;var L=R(y.expirationTime<=X);X=e.unstable_now(),typeof L=="function"?y.callback=L:y===r(h)&&o(h),D(X)}else o(h);y=r(h)}if(y!==null)var K=!0;else{var ie=r(g);ie!==null&&ne(H,ie.startTime-X),K=!1}return K}finally{y=null,S=Y,E=!1}}var U=!1,$=null,J=-1,Ce=5,_e=-1;function Ge(){return!(e.unstable_now()-_e<Ce)}function Ne(){if($!==null){var W=e.unstable_now();_e=W;var X=!0;try{X=$(!0,W)}finally{X?Pe():(U=!1,$=null)}}else U=!1}var Pe;if(typeof B=="function")Pe=function(){B(Ne)};else if(typeof MessageChannel<"u"){var de=new MessageChannel,Ue=de.port2;de.port1.onmessage=Ne,Pe=function(){Ue.postMessage(null)}}else Pe=function(){C(Ne,0)};function Ae(W){$=W,U||(U=!0,Pe())}function ne(W,X){J=C(function(){W(e.unstable_now())},X)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(W){W.callback=null},e.unstable_continueExecution=function(){w||E||(w=!0,Ae(x))},e.unstable_forceFrameRate=function(W){0>W||125<W?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):Ce=0<W?Math.floor(1e3/W):5},e.unstable_getCurrentPriorityLevel=function(){return S},e.unstable_getFirstCallbackNode=function(){return r(h)},e.unstable_next=function(W){switch(S){case 1:case 2:case 3:var X=3;break;default:X=S}var Y=S;S=X;try{return W()}finally{S=Y}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(W,X){switch(W){case 1:case 2:case 3:case 4:case 5:break;default:W=3}var Y=S;S=W;try{return X()}finally{S=Y}},e.unstable_scheduleCallback=function(W,X,Y){var R=e.unstable_now();switch(typeof Y=="object"&&Y!==null?(Y=Y.delay,Y=typeof Y=="number"&&0<Y?R+Y:R):Y=R,W){case 1:var L=-1;break;case 2:L=250;break;case 5:L=1073741823;break;case 4:L=1e4;break;default:L=5e3}return L=Y+L,W={id:m++,callback:X,priorityLevel:W,startTime:Y,expirationTime:L,sortIndex:-1},Y>R?(W.sortIndex=Y,n(g,W),r(h)===null&&W===r(g)&&(T?(F(J),J=-1):T=!0,ne(H,Y-R))):(W.sortIndex=L,n(h,W),w||E||(w=!0,Ae(x))),W},e.unstable_shouldYield=Ge,e.unstable_wrapCallback=function(W){var X=S;return function(){var Y=S;S=X;try{return W.apply(this,arguments)}finally{S=Y}}}}(md)),md}var im;function yA(){return im||(im=1,pd.exports=vA()),pd.exports}/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var rm;function SA(){if(rm)return qt;rm=1;var e=Ef(),n=yA();function r(t){for(var i="https://reactjs.org/docs/error-decoder.html?invariant="+t,s=1;s<arguments.length;s++)i+="&args[]="+encodeURIComponent(arguments[s]);return"Minified React error #"+t+"; visit "+i+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var o=new Set,l={};function a(t,i){u(t,i),u(t+"Capture",i)}function u(t,i){for(l[t]=i,t=0;t<i.length;t++)o.add(i[t])}var d=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),h=Object.prototype.hasOwnProperty,g=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,m={},y={};function S(t){return h.call(y,t)?!0:h.call(m,t)?!1:g.test(t)?y[t]=!0:(m[t]=!0,!1)}function E(t,i,s,c){if(s!==null&&s.type===0)return!1;switch(typeof i){case"function":case"symbol":return!0;case"boolean":return c?!1:s!==null?!s.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function w(t,i,s,c){if(i===null||typeof i>"u"||E(t,i,s,c))return!0;if(c)return!1;if(s!==null)switch(s.type){case 3:return!i;case 4:return i===!1;case 5:return isNaN(i);case 6:return isNaN(i)||1>i}return!1}function T(t,i,s,c,f,p,v){this.acceptsBooleans=i===2||i===3||i===4,this.attributeName=c,this.attributeNamespace=f,this.mustUseProperty=s,this.propertyName=t,this.type=i,this.sanitizeURL=p,this.removeEmptyString=v}var C={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){C[t]=new T(t,0,!1,t,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var i=t[0];C[i]=new T(i,1,!1,t[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(t){C[t]=new T(t,2,!1,t.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){C[t]=new T(t,2,!1,t,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){C[t]=new T(t,3,!1,t.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(t){C[t]=new T(t,3,!0,t,null,!1,!1)}),["capture","download"].forEach(function(t){C[t]=new T(t,4,!1,t,null,!1,!1)}),["cols","rows","size","span"].forEach(function(t){C[t]=new T(t,6,!1,t,null,!1,!1)}),["rowSpan","start"].forEach(function(t){C[t]=new T(t,5,!1,t.toLowerCase(),null,!1,!1)});var F=/[\-:]([a-z])/g;function B(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var i=t.replace(F,B);C[i]=new T(i,1,!1,t,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var i=t.replace(F,B);C[i]=new T(i,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(t){var i=t.replace(F,B);C[i]=new T(i,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(t){C[t]=new T(t,1,!1,t.toLowerCase(),null,!1,!1)}),C.xlinkHref=new T("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(t){C[t]=new T(t,1,!1,t.toLowerCase(),null,!0,!0)});function D(t,i,s,c){var f=C.hasOwnProperty(i)?C[i]:null;(f!==null?f.type!==0:c||!(2<i.length)||i[0]!=="o"&&i[0]!=="O"||i[1]!=="n"&&i[1]!=="N")&&(w(i,s,f,c)&&(s=null),c||f===null?S(i)&&(s===null?t.removeAttribute(i):t.setAttribute(i,""+s)):f.mustUseProperty?t[f.propertyName]=s===null?f.type===3?!1:"":s:(i=f.attributeName,c=f.attributeNamespace,s===null?t.removeAttribute(i):(f=f.type,s=f===3||f===4&&s===!0?"":""+s,c?t.setAttributeNS(c,i,s):t.setAttribute(i,s))))}var H=e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,x=Symbol.for("react.element"),U=Symbol.for("react.portal"),$=Symbol.for("react.fragment"),J=Symbol.for("react.strict_mode"),Ce=Symbol.for("react.profiler"),_e=Symbol.for("react.provider"),Ge=Symbol.for("react.context"),Ne=Symbol.for("react.forward_ref"),Pe=Symbol.for("react.suspense"),de=Symbol.for("react.suspense_list"),Ue=Symbol.for("react.memo"),Ae=Symbol.for("react.lazy"),ne=Symbol.for("react.offscreen"),W=Symbol.iterator;function X(t){return t===null||typeof t!="object"?null:(t=W&&t[W]||t["@@iterator"],typeof t=="function"?t:null)}var Y=Object.assign,R;function L(t){if(R===void 0)try{throw Error()}catch(s){var i=s.stack.trim().match(/\n( *(at )?)/);R=i&&i[1]||""}return`
`+R+t}var K=!1;function ie(t,i){if(!t||K)return"";K=!0;var s=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(i)if(i=function(){throw Error()},Object.defineProperty(i.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(i,[])}catch(M){var c=M}Reflect.construct(t,[],i)}else{try{i.call()}catch(M){c=M}t.call(i.prototype)}else{try{throw Error()}catch(M){c=M}t()}}catch(M){if(M&&c&&typeof M.stack=="string"){for(var f=M.stack.split(`
`),p=c.stack.split(`
`),v=f.length-1,A=p.length-1;1<=v&&0<=A&&f[v]!==p[A];)A--;for(;1<=v&&0<=A;v--,A--)if(f[v]!==p[A]){if(v!==1||A!==1)do if(v--,A--,0>A||f[v]!==p[A]){var _=`
`+f[v].replace(" at new "," at ");return t.displayName&&_.includes("<anonymous>")&&(_=_.replace("<anonymous>",t.displayName)),_}while(1<=v&&0<=A);break}}}finally{K=!1,Error.prepareStackTrace=s}return(t=t?t.displayName||t.name:"")?L(t):""}function ye(t){switch(t.tag){case 5:return L(t.type);case 16:return L("Lazy");case 13:return L("Suspense");case 19:return L("SuspenseList");case 0:case 2:case 15:return t=ie(t.type,!1),t;case 11:return t=ie(t.type.render,!1),t;case 1:return t=ie(t.type,!0),t;default:return""}}function se(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case $:return"Fragment";case U:return"Portal";case Ce:return"Profiler";case J:return"StrictMode";case Pe:return"Suspense";case de:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case Ge:return(t.displayName||"Context")+".Consumer";case _e:return(t._context.displayName||"Context")+".Provider";case Ne:var i=t.render;return t=t.displayName,t||(t=i.displayName||i.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case Ue:return i=t.displayName||null,i!==null?i:se(t.type)||"Memo";case Ae:i=t._payload,t=t._init;try{return se(t(i))}catch{}}return null}function we(t){var i=t.type;switch(t.tag){case 24:return"Cache";case 9:return(i.displayName||"Context")+".Consumer";case 10:return(i._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=i.render,t=t.displayName||t.name||"",i.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return i;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return se(i);case 8:return i===J?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof i=="function")return i.displayName||i.name||null;if(typeof i=="string")return i}return null}function Te(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function q(t){var i=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(i==="checkbox"||i==="radio")}function re(t){var i=q(t)?"checked":"value",s=Object.getOwnPropertyDescriptor(t.constructor.prototype,i),c=""+t[i];if(!t.hasOwnProperty(i)&&typeof s<"u"&&typeof s.get=="function"&&typeof s.set=="function"){var f=s.get,p=s.set;return Object.defineProperty(t,i,{configurable:!0,get:function(){return f.call(this)},set:function(v){c=""+v,p.call(this,v)}}),Object.defineProperty(t,i,{enumerable:s.enumerable}),{getValue:function(){return c},setValue:function(v){c=""+v},stopTracking:function(){t._valueTracker=null,delete t[i]}}}}function Le(t){t._valueTracker||(t._valueTracker=re(t))}function he(t){if(!t)return!1;var i=t._valueTracker;if(!i)return!0;var s=i.getValue(),c="";return t&&(c=q(t)?t.checked?"true":"false":t.value),t=c,t!==s?(i.setValue(t),!0):!1}function Fn(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function Ze(t,i){var s=i.checked;return Y({},i,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:s??t._wrapperState.initialChecked})}function je(t,i){var s=i.defaultValue==null?"":i.defaultValue,c=i.checked!=null?i.checked:i.defaultChecked;s=Te(i.value!=null?i.value:s),t._wrapperState={initialChecked:c,initialValue:s,controlled:i.type==="checkbox"||i.type==="radio"?i.checked!=null:i.value!=null}}function Un(t,i){i=i.checked,i!=null&&D(t,"checked",i,!1)}function Wt(t,i){Un(t,i);var s=Te(i.value),c=i.type;if(s!=null)c==="number"?(s===0&&t.value===""||t.value!=s)&&(t.value=""+s):t.value!==""+s&&(t.value=""+s);else if(c==="submit"||c==="reset"){t.removeAttribute("value");return}i.hasOwnProperty("value")?Ln(t,i.type,s):i.hasOwnProperty("defaultValue")&&Ln(t,i.type,Te(i.defaultValue)),i.checked==null&&i.defaultChecked!=null&&(t.defaultChecked=!!i.defaultChecked)}function an(t,i,s){if(i.hasOwnProperty("value")||i.hasOwnProperty("defaultValue")){var c=i.type;if(!(c!=="submit"&&c!=="reset"||i.value!==void 0&&i.value!==null))return;i=""+t._wrapperState.initialValue,s||i===t.value||(t.value=i),t.defaultValue=i}s=t.name,s!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,s!==""&&(t.name=s)}function Ln(t,i,s){(i!=="number"||Fn(t.ownerDocument)!==t)&&(s==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+s&&(t.defaultValue=""+s))}var Bn=Array.isArray;function mi(t,i,s,c){if(t=t.options,i){i={};for(var f=0;f<s.length;f++)i["$"+s[f]]=!0;for(s=0;s<t.length;s++)f=i.hasOwnProperty("$"+t[s].value),t[s].selected!==f&&(t[s].selected=f),f&&c&&(t[s].defaultSelected=!0)}else{for(s=""+Te(s),i=null,f=0;f<t.length;f++){if(t[f].value===s){t[f].selected=!0,c&&(t[f].defaultSelected=!0);return}i!==null||t[f].disabled||(i=t[f])}i!==null&&(i.selected=!0)}}function er(t,i){if(i.dangerouslySetInnerHTML!=null)throw Error(r(91));return Y({},i,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function lh(t,i){var s=i.value;if(s==null){if(s=i.children,i=i.defaultValue,s!=null){if(i!=null)throw Error(r(92));if(Bn(s)){if(1<s.length)throw Error(r(93));s=s[0]}i=s}i==null&&(i=""),s=i}t._wrapperState={initialValue:Te(s)}}function uh(t,i){var s=Te(i.value),c=Te(i.defaultValue);s!=null&&(s=""+s,s!==t.value&&(t.value=s),i.defaultValue==null&&t.defaultValue!==s&&(t.defaultValue=s)),c!=null&&(t.defaultValue=""+c)}function ch(t){var i=t.textContent;i===t._wrapperState.initialValue&&i!==""&&i!==null&&(t.value=i)}function dh(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function wu(t,i){return t==null||t==="http://www.w3.org/1999/xhtml"?dh(i):t==="http://www.w3.org/2000/svg"&&i==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var da,fh=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(i,s,c,f){MSApp.execUnsafeLocalFunction(function(){return t(i,s,c,f)})}:t}(function(t,i){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=i;else{for(da=da||document.createElement("div"),da.innerHTML="<svg>"+i.valueOf().toString()+"</svg>",i=da.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;i.firstChild;)t.appendChild(i.firstChild)}});function bo(t,i){if(i){var s=t.firstChild;if(s&&s===t.lastChild&&s.nodeType===3){s.nodeValue=i;return}}t.textContent=i}var Go={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},my=["Webkit","ms","Moz","O"];Object.keys(Go).forEach(function(t){my.forEach(function(i){i=i+t.charAt(0).toUpperCase()+t.substring(1),Go[i]=Go[t]})});function hh(t,i,s){return i==null||typeof i=="boolean"||i===""?"":s||typeof i!="number"||i===0||Go.hasOwnProperty(t)&&Go[t]?(""+i).trim():i+"px"}function gh(t,i){t=t.style;for(var s in i)if(i.hasOwnProperty(s)){var c=s.indexOf("--")===0,f=hh(s,i[s],c);s==="float"&&(s="cssFloat"),c?t.setProperty(s,f):t[s]=f}}var vy=Y({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Eu(t,i){if(i){if(vy[t]&&(i.children!=null||i.dangerouslySetInnerHTML!=null))throw Error(r(137,t));if(i.dangerouslySetInnerHTML!=null){if(i.children!=null)throw Error(r(60));if(typeof i.dangerouslySetInnerHTML!="object"||!("__html"in i.dangerouslySetInnerHTML))throw Error(r(61))}if(i.style!=null&&typeof i.style!="object")throw Error(r(62))}}function Cu(t,i){if(t.indexOf("-")===-1)return typeof i.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var _u=null;function Ru(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var Pu=null,Ur=null,Lr=null;function ph(t){if(t=ls(t)){if(typeof Pu!="function")throw Error(r(280));var i=t.stateNode;i&&(i=Fa(i),Pu(t.stateNode,t.type,i))}}function mh(t){Ur?Lr?Lr.push(t):Lr=[t]:Ur=t}function vh(){if(Ur){var t=Ur,i=Lr;if(Lr=Ur=null,ph(t),i)for(t=0;t<i.length;t++)ph(i[t])}}function yh(t,i){return t(i)}function Sh(){}var Nu=!1;function Ah(t,i,s){if(Nu)return t(i,s);Nu=!0;try{return yh(t,i,s)}finally{Nu=!1,(Ur!==null||Lr!==null)&&(Sh(),vh())}}function xo(t,i){var s=t.stateNode;if(s===null)return null;var c=Fa(s);if(c===null)return null;s=c[i];e:switch(i){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(c=!c.disabled)||(t=t.type,c=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!c;break e;default:t=!1}if(t)return null;if(s&&typeof s!="function")throw Error(r(231,i,typeof s));return s}var Du=!1;if(d)try{var $o={};Object.defineProperty($o,"passive",{get:function(){Du=!0}}),window.addEventListener("test",$o,$o),window.removeEventListener("test",$o,$o)}catch{Du=!1}function yy(t,i,s,c,f,p,v,A,_){var M=Array.prototype.slice.call(arguments,3);try{i.apply(s,M)}catch(G){this.onError(G)}}var zo=!1,fa=null,ha=!1,Ou=null,Sy={onError:function(t){zo=!0,fa=t}};function Ay(t,i,s,c,f,p,v,A,_){zo=!1,fa=null,yy.apply(Sy,arguments)}function Ty(t,i,s,c,f,p,v,A,_){if(Ay.apply(this,arguments),zo){if(zo){var M=fa;zo=!1,fa=null}else throw Error(r(198));ha||(ha=!0,Ou=M)}}function tr(t){var i=t,s=t;if(t.alternate)for(;i.return;)i=i.return;else{t=i;do i=t,(i.flags&4098)!==0&&(s=i.return),t=i.return;while(t)}return i.tag===3?s:null}function Th(t){if(t.tag===13){var i=t.memoizedState;if(i===null&&(t=t.alternate,t!==null&&(i=t.memoizedState)),i!==null)return i.dehydrated}return null}function Ih(t){if(tr(t)!==t)throw Error(r(188))}function Iy(t){var i=t.alternate;if(!i){if(i=tr(t),i===null)throw Error(r(188));return i!==t?null:t}for(var s=t,c=i;;){var f=s.return;if(f===null)break;var p=f.alternate;if(p===null){if(c=f.return,c!==null){s=c;continue}break}if(f.child===p.child){for(p=f.child;p;){if(p===s)return Ih(f),t;if(p===c)return Ih(f),i;p=p.sibling}throw Error(r(188))}if(s.return!==c.return)s=f,c=p;else{for(var v=!1,A=f.child;A;){if(A===s){v=!0,s=f,c=p;break}if(A===c){v=!0,c=f,s=p;break}A=A.sibling}if(!v){for(A=p.child;A;){if(A===s){v=!0,s=p,c=f;break}if(A===c){v=!0,c=p,s=f;break}A=A.sibling}if(!v)throw Error(r(189))}}if(s.alternate!==c)throw Error(r(190))}if(s.tag!==3)throw Error(r(188));return s.stateNode.current===s?t:i}function wh(t){return t=Iy(t),t!==null?Eh(t):null}function Eh(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var i=Eh(t);if(i!==null)return i;t=t.sibling}return null}var Ch=n.unstable_scheduleCallback,_h=n.unstable_cancelCallback,wy=n.unstable_shouldYield,Ey=n.unstable_requestPaint,st=n.unstable_now,Cy=n.unstable_getCurrentPriorityLevel,ku=n.unstable_ImmediatePriority,Rh=n.unstable_UserBlockingPriority,ga=n.unstable_NormalPriority,_y=n.unstable_LowPriority,Ph=n.unstable_IdlePriority,pa=null,Hn=null;function Ry(t){if(Hn&&typeof Hn.onCommitFiberRoot=="function")try{Hn.onCommitFiberRoot(pa,t,void 0,(t.current.flags&128)===128)}catch{}}var Tn=Math.clz32?Math.clz32:Dy,Py=Math.log,Ny=Math.LN2;function Dy(t){return t>>>=0,t===0?32:31-(Py(t)/Ny|0)|0}var ma=64,va=4194304;function Wo(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function ya(t,i){var s=t.pendingLanes;if(s===0)return 0;var c=0,f=t.suspendedLanes,p=t.pingedLanes,v=s&268435455;if(v!==0){var A=v&~f;A!==0?c=Wo(A):(p&=v,p!==0&&(c=Wo(p)))}else v=s&~f,v!==0?c=Wo(v):p!==0&&(c=Wo(p));if(c===0)return 0;if(i!==0&&i!==c&&(i&f)===0&&(f=c&-c,p=i&-i,f>=p||f===16&&(p&4194240)!==0))return i;if((c&4)!==0&&(c|=s&16),i=t.entangledLanes,i!==0)for(t=t.entanglements,i&=c;0<i;)s=31-Tn(i),f=1<<s,c|=t[s],i&=~f;return c}function Oy(t,i){switch(t){case 1:case 2:case 4:return i+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return i+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function ky(t,i){for(var s=t.suspendedLanes,c=t.pingedLanes,f=t.expirationTimes,p=t.pendingLanes;0<p;){var v=31-Tn(p),A=1<<v,_=f[v];_===-1?((A&s)===0||(A&c)!==0)&&(f[v]=Oy(A,i)):_<=i&&(t.expiredLanes|=A),p&=~A}}function Mu(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function Nh(){var t=ma;return ma<<=1,(ma&4194240)===0&&(ma=64),t}function Fu(t){for(var i=[],s=0;31>s;s++)i.push(t);return i}function Yo(t,i,s){t.pendingLanes|=i,i!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,i=31-Tn(i),t[i]=s}function My(t,i){var s=t.pendingLanes&~i;t.pendingLanes=i,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=i,t.mutableReadLanes&=i,t.entangledLanes&=i,i=t.entanglements;var c=t.eventTimes;for(t=t.expirationTimes;0<s;){var f=31-Tn(s),p=1<<f;i[f]=0,c[f]=-1,t[f]=-1,s&=~p}}function Uu(t,i){var s=t.entangledLanes|=i;for(t=t.entanglements;s;){var c=31-Tn(s),f=1<<c;f&i|t[c]&i&&(t[c]|=i),s&=~f}}var We=0;function Dh(t){return t&=-t,1<t?4<t?(t&268435455)!==0?16:536870912:4:1}var Oh,Lu,kh,Mh,Fh,Bu=!1,Sa=[],vi=null,yi=null,Si=null,jo=new Map,Vo=new Map,Ai=[],Fy="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Uh(t,i){switch(t){case"focusin":case"focusout":vi=null;break;case"dragenter":case"dragleave":yi=null;break;case"mouseover":case"mouseout":Si=null;break;case"pointerover":case"pointerout":jo.delete(i.pointerId);break;case"gotpointercapture":case"lostpointercapture":Vo.delete(i.pointerId)}}function Xo(t,i,s,c,f,p){return t===null||t.nativeEvent!==p?(t={blockedOn:i,domEventName:s,eventSystemFlags:c,nativeEvent:p,targetContainers:[f]},i!==null&&(i=ls(i),i!==null&&Lu(i)),t):(t.eventSystemFlags|=c,i=t.targetContainers,f!==null&&i.indexOf(f)===-1&&i.push(f),t)}function Uy(t,i,s,c,f){switch(i){case"focusin":return vi=Xo(vi,t,i,s,c,f),!0;case"dragenter":return yi=Xo(yi,t,i,s,c,f),!0;case"mouseover":return Si=Xo(Si,t,i,s,c,f),!0;case"pointerover":var p=f.pointerId;return jo.set(p,Xo(jo.get(p)||null,t,i,s,c,f)),!0;case"gotpointercapture":return p=f.pointerId,Vo.set(p,Xo(Vo.get(p)||null,t,i,s,c,f)),!0}return!1}function Lh(t){var i=nr(t.target);if(i!==null){var s=tr(i);if(s!==null){if(i=s.tag,i===13){if(i=Th(s),i!==null){t.blockedOn=i,Fh(t.priority,function(){kh(s)});return}}else if(i===3&&s.stateNode.current.memoizedState.isDehydrated){t.blockedOn=s.tag===3?s.stateNode.containerInfo:null;return}}}t.blockedOn=null}function Aa(t){if(t.blockedOn!==null)return!1;for(var i=t.targetContainers;0<i.length;){var s=bu(t.domEventName,t.eventSystemFlags,i[0],t.nativeEvent);if(s===null){s=t.nativeEvent;var c=new s.constructor(s.type,s);_u=c,s.target.dispatchEvent(c),_u=null}else return i=ls(s),i!==null&&Lu(i),t.blockedOn=s,!1;i.shift()}return!0}function Bh(t,i,s){Aa(t)&&s.delete(i)}function Ly(){Bu=!1,vi!==null&&Aa(vi)&&(vi=null),yi!==null&&Aa(yi)&&(yi=null),Si!==null&&Aa(Si)&&(Si=null),jo.forEach(Bh),Vo.forEach(Bh)}function Ko(t,i){t.blockedOn===i&&(t.blockedOn=null,Bu||(Bu=!0,n.unstable_scheduleCallback(n.unstable_NormalPriority,Ly)))}function qo(t){function i(f){return Ko(f,t)}if(0<Sa.length){Ko(Sa[0],t);for(var s=1;s<Sa.length;s++){var c=Sa[s];c.blockedOn===t&&(c.blockedOn=null)}}for(vi!==null&&Ko(vi,t),yi!==null&&Ko(yi,t),Si!==null&&Ko(Si,t),jo.forEach(i),Vo.forEach(i),s=0;s<Ai.length;s++)c=Ai[s],c.blockedOn===t&&(c.blockedOn=null);for(;0<Ai.length&&(s=Ai[0],s.blockedOn===null);)Lh(s),s.blockedOn===null&&Ai.shift()}var Br=H.ReactCurrentBatchConfig,Ta=!0;function By(t,i,s,c){var f=We,p=Br.transition;Br.transition=null;try{We=1,Hu(t,i,s,c)}finally{We=f,Br.transition=p}}function Hy(t,i,s,c){var f=We,p=Br.transition;Br.transition=null;try{We=4,Hu(t,i,s,c)}finally{We=f,Br.transition=p}}function Hu(t,i,s,c){if(Ta){var f=bu(t,i,s,c);if(f===null)nc(t,i,c,Ia,s),Uh(t,c);else if(Uy(f,t,i,s,c))c.stopPropagation();else if(Uh(t,c),i&4&&-1<Fy.indexOf(t)){for(;f!==null;){var p=ls(f);if(p!==null&&Oh(p),p=bu(t,i,s,c),p===null&&nc(t,i,c,Ia,s),p===f)break;f=p}f!==null&&c.stopPropagation()}else nc(t,i,c,null,s)}}var Ia=null;function bu(t,i,s,c){if(Ia=null,t=Ru(c),t=nr(t),t!==null)if(i=tr(t),i===null)t=null;else if(s=i.tag,s===13){if(t=Th(i),t!==null)return t;t=null}else if(s===3){if(i.stateNode.current.memoizedState.isDehydrated)return i.tag===3?i.stateNode.containerInfo:null;t=null}else i!==t&&(t=null);return Ia=t,null}function Hh(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Cy()){case ku:return 1;case Rh:return 4;case ga:case _y:return 16;case Ph:return 536870912;default:return 16}default:return 16}}var Ti=null,Gu=null,wa=null;function bh(){if(wa)return wa;var t,i=Gu,s=i.length,c,f="value"in Ti?Ti.value:Ti.textContent,p=f.length;for(t=0;t<s&&i[t]===f[t];t++);var v=s-t;for(c=1;c<=v&&i[s-c]===f[p-c];c++);return wa=f.slice(t,1<c?1-c:void 0)}function Ea(t){var i=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&i===13&&(t=13)):t=i,t===10&&(t=13),32<=t||t===13?t:0}function Ca(){return!0}function Gh(){return!1}function Qt(t){function i(s,c,f,p,v){this._reactName=s,this._targetInst=f,this.type=c,this.nativeEvent=p,this.target=v,this.currentTarget=null;for(var A in t)t.hasOwnProperty(A)&&(s=t[A],this[A]=s?s(p):p[A]);return this.isDefaultPrevented=(p.defaultPrevented!=null?p.defaultPrevented:p.returnValue===!1)?Ca:Gh,this.isPropagationStopped=Gh,this}return Y(i.prototype,{preventDefault:function(){this.defaultPrevented=!0;var s=this.nativeEvent;s&&(s.preventDefault?s.preventDefault():typeof s.returnValue!="unknown"&&(s.returnValue=!1),this.isDefaultPrevented=Ca)},stopPropagation:function(){var s=this.nativeEvent;s&&(s.stopPropagation?s.stopPropagation():typeof s.cancelBubble!="unknown"&&(s.cancelBubble=!0),this.isPropagationStopped=Ca)},persist:function(){},isPersistent:Ca}),i}var Hr={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},xu=Qt(Hr),Zo=Y({},Hr,{view:0,detail:0}),by=Qt(Zo),$u,zu,Qo,_a=Y({},Zo,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Yu,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==Qo&&(Qo&&t.type==="mousemove"?($u=t.screenX-Qo.screenX,zu=t.screenY-Qo.screenY):zu=$u=0,Qo=t),$u)},movementY:function(t){return"movementY"in t?t.movementY:zu}}),xh=Qt(_a),Gy=Y({},_a,{dataTransfer:0}),xy=Qt(Gy),$y=Y({},Zo,{relatedTarget:0}),Wu=Qt($y),zy=Y({},Hr,{animationName:0,elapsedTime:0,pseudoElement:0}),Wy=Qt(zy),Yy=Y({},Hr,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),jy=Qt(Yy),Vy=Y({},Hr,{data:0}),$h=Qt(Vy),Xy={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Ky={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},qy={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Zy(t){var i=this.nativeEvent;return i.getModifierState?i.getModifierState(t):(t=qy[t])?!!i[t]:!1}function Yu(){return Zy}var Qy=Y({},Zo,{key:function(t){if(t.key){var i=Xy[t.key]||t.key;if(i!=="Unidentified")return i}return t.type==="keypress"?(t=Ea(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?Ky[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Yu,charCode:function(t){return t.type==="keypress"?Ea(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?Ea(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),Jy=Qt(Qy),eS=Y({},_a,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),zh=Qt(eS),tS=Y({},Zo,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Yu}),nS=Qt(tS),iS=Y({},Hr,{propertyName:0,elapsedTime:0,pseudoElement:0}),rS=Qt(iS),oS=Y({},_a,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),sS=Qt(oS),aS=[9,13,27,32],ju=d&&"CompositionEvent"in window,Jo=null;d&&"documentMode"in document&&(Jo=document.documentMode);var lS=d&&"TextEvent"in window&&!Jo,Wh=d&&(!ju||Jo&&8<Jo&&11>=Jo),Yh=" ",jh=!1;function Vh(t,i){switch(t){case"keyup":return aS.indexOf(i.keyCode)!==-1;case"keydown":return i.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Xh(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var br=!1;function uS(t,i){switch(t){case"compositionend":return Xh(i);case"keypress":return i.which!==32?null:(jh=!0,Yh);case"textInput":return t=i.data,t===Yh&&jh?null:t;default:return null}}function cS(t,i){if(br)return t==="compositionend"||!ju&&Vh(t,i)?(t=bh(),wa=Gu=Ti=null,br=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(i.ctrlKey||i.altKey||i.metaKey)||i.ctrlKey&&i.altKey){if(i.char&&1<i.char.length)return i.char;if(i.which)return String.fromCharCode(i.which)}return null;case"compositionend":return Wh&&i.locale!=="ko"?null:i.data;default:return null}}var dS={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Kh(t){var i=t&&t.nodeName&&t.nodeName.toLowerCase();return i==="input"?!!dS[t.type]:i==="textarea"}function qh(t,i,s,c){mh(c),i=Oa(i,"onChange"),0<i.length&&(s=new xu("onChange","change",null,s,c),t.push({event:s,listeners:i}))}var es=null,ts=null;function fS(t){gg(t,0)}function Ra(t){var i=Wr(t);if(he(i))return t}function hS(t,i){if(t==="change")return i}var Zh=!1;if(d){var Vu;if(d){var Xu="oninput"in document;if(!Xu){var Qh=document.createElement("div");Qh.setAttribute("oninput","return;"),Xu=typeof Qh.oninput=="function"}Vu=Xu}else Vu=!1;Zh=Vu&&(!document.documentMode||9<document.documentMode)}function Jh(){es&&(es.detachEvent("onpropertychange",eg),ts=es=null)}function eg(t){if(t.propertyName==="value"&&Ra(ts)){var i=[];qh(i,ts,t,Ru(t)),Ah(fS,i)}}function gS(t,i,s){t==="focusin"?(Jh(),es=i,ts=s,es.attachEvent("onpropertychange",eg)):t==="focusout"&&Jh()}function pS(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return Ra(ts)}function mS(t,i){if(t==="click")return Ra(i)}function vS(t,i){if(t==="input"||t==="change")return Ra(i)}function yS(t,i){return t===i&&(t!==0||1/t===1/i)||t!==t&&i!==i}var In=typeof Object.is=="function"?Object.is:yS;function ns(t,i){if(In(t,i))return!0;if(typeof t!="object"||t===null||typeof i!="object"||i===null)return!1;var s=Object.keys(t),c=Object.keys(i);if(s.length!==c.length)return!1;for(c=0;c<s.length;c++){var f=s[c];if(!h.call(i,f)||!In(t[f],i[f]))return!1}return!0}function tg(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function ng(t,i){var s=tg(t);t=0;for(var c;s;){if(s.nodeType===3){if(c=t+s.textContent.length,t<=i&&c>=i)return{node:s,offset:i-t};t=c}e:{for(;s;){if(s.nextSibling){s=s.nextSibling;break e}s=s.parentNode}s=void 0}s=tg(s)}}function ig(t,i){return t&&i?t===i?!0:t&&t.nodeType===3?!1:i&&i.nodeType===3?ig(t,i.parentNode):"contains"in t?t.contains(i):t.compareDocumentPosition?!!(t.compareDocumentPosition(i)&16):!1:!1}function rg(){for(var t=window,i=Fn();i instanceof t.HTMLIFrameElement;){try{var s=typeof i.contentWindow.location.href=="string"}catch{s=!1}if(s)t=i.contentWindow;else break;i=Fn(t.document)}return i}function Ku(t){var i=t&&t.nodeName&&t.nodeName.toLowerCase();return i&&(i==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||i==="textarea"||t.contentEditable==="true")}function SS(t){var i=rg(),s=t.focusedElem,c=t.selectionRange;if(i!==s&&s&&s.ownerDocument&&ig(s.ownerDocument.documentElement,s)){if(c!==null&&Ku(s)){if(i=c.start,t=c.end,t===void 0&&(t=i),"selectionStart"in s)s.selectionStart=i,s.selectionEnd=Math.min(t,s.value.length);else if(t=(i=s.ownerDocument||document)&&i.defaultView||window,t.getSelection){t=t.getSelection();var f=s.textContent.length,p=Math.min(c.start,f);c=c.end===void 0?p:Math.min(c.end,f),!t.extend&&p>c&&(f=c,c=p,p=f),f=ng(s,p);var v=ng(s,c);f&&v&&(t.rangeCount!==1||t.anchorNode!==f.node||t.anchorOffset!==f.offset||t.focusNode!==v.node||t.focusOffset!==v.offset)&&(i=i.createRange(),i.setStart(f.node,f.offset),t.removeAllRanges(),p>c?(t.addRange(i),t.extend(v.node,v.offset)):(i.setEnd(v.node,v.offset),t.addRange(i)))}}for(i=[],t=s;t=t.parentNode;)t.nodeType===1&&i.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof s.focus=="function"&&s.focus(),s=0;s<i.length;s++)t=i[s],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var AS=d&&"documentMode"in document&&11>=document.documentMode,Gr=null,qu=null,is=null,Zu=!1;function og(t,i,s){var c=s.window===s?s.document:s.nodeType===9?s:s.ownerDocument;Zu||Gr==null||Gr!==Fn(c)||(c=Gr,"selectionStart"in c&&Ku(c)?c={start:c.selectionStart,end:c.selectionEnd}:(c=(c.ownerDocument&&c.ownerDocument.defaultView||window).getSelection(),c={anchorNode:c.anchorNode,anchorOffset:c.anchorOffset,focusNode:c.focusNode,focusOffset:c.focusOffset}),is&&ns(is,c)||(is=c,c=Oa(qu,"onSelect"),0<c.length&&(i=new xu("onSelect","select",null,i,s),t.push({event:i,listeners:c}),i.target=Gr)))}function Pa(t,i){var s={};return s[t.toLowerCase()]=i.toLowerCase(),s["Webkit"+t]="webkit"+i,s["Moz"+t]="moz"+i,s}var xr={animationend:Pa("Animation","AnimationEnd"),animationiteration:Pa("Animation","AnimationIteration"),animationstart:Pa("Animation","AnimationStart"),transitionend:Pa("Transition","TransitionEnd")},Qu={},sg={};d&&(sg=document.createElement("div").style,"AnimationEvent"in window||(delete xr.animationend.animation,delete xr.animationiteration.animation,delete xr.animationstart.animation),"TransitionEvent"in window||delete xr.transitionend.transition);function Na(t){if(Qu[t])return Qu[t];if(!xr[t])return t;var i=xr[t],s;for(s in i)if(i.hasOwnProperty(s)&&s in sg)return Qu[t]=i[s];return t}var ag=Na("animationend"),lg=Na("animationiteration"),ug=Na("animationstart"),cg=Na("transitionend"),dg=new Map,fg="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Ii(t,i){dg.set(t,i),a(i,[t])}for(var Ju=0;Ju<fg.length;Ju++){var ec=fg[Ju],TS=ec.toLowerCase(),IS=ec[0].toUpperCase()+ec.slice(1);Ii(TS,"on"+IS)}Ii(ag,"onAnimationEnd"),Ii(lg,"onAnimationIteration"),Ii(ug,"onAnimationStart"),Ii("dblclick","onDoubleClick"),Ii("focusin","onFocus"),Ii("focusout","onBlur"),Ii(cg,"onTransitionEnd"),u("onMouseEnter",["mouseout","mouseover"]),u("onMouseLeave",["mouseout","mouseover"]),u("onPointerEnter",["pointerout","pointerover"]),u("onPointerLeave",["pointerout","pointerover"]),a("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),a("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),a("onBeforeInput",["compositionend","keypress","textInput","paste"]),a("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),a("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),a("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var rs="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),wS=new Set("cancel close invalid load scroll toggle".split(" ").concat(rs));function hg(t,i,s){var c=t.type||"unknown-event";t.currentTarget=s,Ty(c,i,void 0,t),t.currentTarget=null}function gg(t,i){i=(i&4)!==0;for(var s=0;s<t.length;s++){var c=t[s],f=c.event;c=c.listeners;e:{var p=void 0;if(i)for(var v=c.length-1;0<=v;v--){var A=c[v],_=A.instance,M=A.currentTarget;if(A=A.listener,_!==p&&f.isPropagationStopped())break e;hg(f,A,M),p=_}else for(v=0;v<c.length;v++){if(A=c[v],_=A.instance,M=A.currentTarget,A=A.listener,_!==p&&f.isPropagationStopped())break e;hg(f,A,M),p=_}}}if(ha)throw t=Ou,ha=!1,Ou=null,t}function Ve(t,i){var s=i[lc];s===void 0&&(s=i[lc]=new Set);var c=t+"__bubble";s.has(c)||(pg(i,t,2,!1),s.add(c))}function tc(t,i,s){var c=0;i&&(c|=4),pg(s,t,c,i)}var Da="_reactListening"+Math.random().toString(36).slice(2);function os(t){if(!t[Da]){t[Da]=!0,o.forEach(function(s){s!=="selectionchange"&&(wS.has(s)||tc(s,!1,t),tc(s,!0,t))});var i=t.nodeType===9?t:t.ownerDocument;i===null||i[Da]||(i[Da]=!0,tc("selectionchange",!1,i))}}function pg(t,i,s,c){switch(Hh(i)){case 1:var f=By;break;case 4:f=Hy;break;default:f=Hu}s=f.bind(null,i,s,t),f=void 0,!Du||i!=="touchstart"&&i!=="touchmove"&&i!=="wheel"||(f=!0),c?f!==void 0?t.addEventListener(i,s,{capture:!0,passive:f}):t.addEventListener(i,s,!0):f!==void 0?t.addEventListener(i,s,{passive:f}):t.addEventListener(i,s,!1)}function nc(t,i,s,c,f){var p=c;if((i&1)===0&&(i&2)===0&&c!==null)e:for(;;){if(c===null)return;var v=c.tag;if(v===3||v===4){var A=c.stateNode.containerInfo;if(A===f||A.nodeType===8&&A.parentNode===f)break;if(v===4)for(v=c.return;v!==null;){var _=v.tag;if((_===3||_===4)&&(_=v.stateNode.containerInfo,_===f||_.nodeType===8&&_.parentNode===f))return;v=v.return}for(;A!==null;){if(v=nr(A),v===null)return;if(_=v.tag,_===5||_===6){c=p=v;continue e}A=A.parentNode}}c=c.return}Ah(function(){var M=p,G=Ru(s),z=[];e:{var b=dg.get(t);if(b!==void 0){var Z=xu,ee=t;switch(t){case"keypress":if(Ea(s)===0)break e;case"keydown":case"keyup":Z=Jy;break;case"focusin":ee="focus",Z=Wu;break;case"focusout":ee="blur",Z=Wu;break;case"beforeblur":case"afterblur":Z=Wu;break;case"click":if(s.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":Z=xh;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":Z=xy;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":Z=nS;break;case ag:case lg:case ug:Z=Wy;break;case cg:Z=rS;break;case"scroll":Z=by;break;case"wheel":Z=sS;break;case"copy":case"cut":case"paste":Z=jy;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":Z=zh}var oe=(i&4)!==0,at=!oe&&t==="scroll",O=oe?b!==null?b+"Capture":null:b;oe=[];for(var P=M,k;P!==null;){k=P;var j=k.stateNode;if(k.tag===5&&j!==null&&(k=j,O!==null&&(j=xo(P,O),j!=null&&oe.push(ss(P,j,k)))),at)break;P=P.return}0<oe.length&&(b=new Z(b,ee,null,s,G),z.push({event:b,listeners:oe}))}}if((i&7)===0){e:{if(b=t==="mouseover"||t==="pointerover",Z=t==="mouseout"||t==="pointerout",b&&s!==_u&&(ee=s.relatedTarget||s.fromElement)&&(nr(ee)||ee[Qn]))break e;if((Z||b)&&(b=G.window===G?G:(b=G.ownerDocument)?b.defaultView||b.parentWindow:window,Z?(ee=s.relatedTarget||s.toElement,Z=M,ee=ee?nr(ee):null,ee!==null&&(at=tr(ee),ee!==at||ee.tag!==5&&ee.tag!==6)&&(ee=null)):(Z=null,ee=M),Z!==ee)){if(oe=xh,j="onMouseLeave",O="onMouseEnter",P="mouse",(t==="pointerout"||t==="pointerover")&&(oe=zh,j="onPointerLeave",O="onPointerEnter",P="pointer"),at=Z==null?b:Wr(Z),k=ee==null?b:Wr(ee),b=new oe(j,P+"leave",Z,s,G),b.target=at,b.relatedTarget=k,j=null,nr(G)===M&&(oe=new oe(O,P+"enter",ee,s,G),oe.target=k,oe.relatedTarget=at,j=oe),at=j,Z&&ee)t:{for(oe=Z,O=ee,P=0,k=oe;k;k=$r(k))P++;for(k=0,j=O;j;j=$r(j))k++;for(;0<P-k;)oe=$r(oe),P--;for(;0<k-P;)O=$r(O),k--;for(;P--;){if(oe===O||O!==null&&oe===O.alternate)break t;oe=$r(oe),O=$r(O)}oe=null}else oe=null;Z!==null&&mg(z,b,Z,oe,!1),ee!==null&&at!==null&&mg(z,at,ee,oe,!0)}}e:{if(b=M?Wr(M):window,Z=b.nodeName&&b.nodeName.toLowerCase(),Z==="select"||Z==="input"&&b.type==="file")var ae=hS;else if(Kh(b))if(Zh)ae=vS;else{ae=pS;var me=gS}else(Z=b.nodeName)&&Z.toLowerCase()==="input"&&(b.type==="checkbox"||b.type==="radio")&&(ae=mS);if(ae&&(ae=ae(t,M))){qh(z,ae,s,G);break e}me&&me(t,b,M),t==="focusout"&&(me=b._wrapperState)&&me.controlled&&b.type==="number"&&Ln(b,"number",b.value)}switch(me=M?Wr(M):window,t){case"focusin":(Kh(me)||me.contentEditable==="true")&&(Gr=me,qu=M,is=null);break;case"focusout":is=qu=Gr=null;break;case"mousedown":Zu=!0;break;case"contextmenu":case"mouseup":case"dragend":Zu=!1,og(z,s,G);break;case"selectionchange":if(AS)break;case"keydown":case"keyup":og(z,s,G)}var ve;if(ju)e:{switch(t){case"compositionstart":var Ee="onCompositionStart";break e;case"compositionend":Ee="onCompositionEnd";break e;case"compositionupdate":Ee="onCompositionUpdate";break e}Ee=void 0}else br?Vh(t,s)&&(Ee="onCompositionEnd"):t==="keydown"&&s.keyCode===229&&(Ee="onCompositionStart");Ee&&(Wh&&s.locale!=="ko"&&(br||Ee!=="onCompositionStart"?Ee==="onCompositionEnd"&&br&&(ve=bh()):(Ti=G,Gu="value"in Ti?Ti.value:Ti.textContent,br=!0)),me=Oa(M,Ee),0<me.length&&(Ee=new $h(Ee,t,null,s,G),z.push({event:Ee,listeners:me}),ve?Ee.data=ve:(ve=Xh(s),ve!==null&&(Ee.data=ve)))),(ve=lS?uS(t,s):cS(t,s))&&(M=Oa(M,"onBeforeInput"),0<M.length&&(G=new $h("onBeforeInput","beforeinput",null,s,G),z.push({event:G,listeners:M}),G.data=ve))}gg(z,i)})}function ss(t,i,s){return{instance:t,listener:i,currentTarget:s}}function Oa(t,i){for(var s=i+"Capture",c=[];t!==null;){var f=t,p=f.stateNode;f.tag===5&&p!==null&&(f=p,p=xo(t,s),p!=null&&c.unshift(ss(t,p,f)),p=xo(t,i),p!=null&&c.push(ss(t,p,f))),t=t.return}return c}function $r(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function mg(t,i,s,c,f){for(var p=i._reactName,v=[];s!==null&&s!==c;){var A=s,_=A.alternate,M=A.stateNode;if(_!==null&&_===c)break;A.tag===5&&M!==null&&(A=M,f?(_=xo(s,p),_!=null&&v.unshift(ss(s,_,A))):f||(_=xo(s,p),_!=null&&v.push(ss(s,_,A)))),s=s.return}v.length!==0&&t.push({event:i,listeners:v})}var ES=/\r\n?/g,CS=/\u0000|\uFFFD/g;function vg(t){return(typeof t=="string"?t:""+t).replace(ES,`
`).replace(CS,"")}function ka(t,i,s){if(i=vg(i),vg(t)!==i&&s)throw Error(r(425))}function Ma(){}var ic=null,rc=null;function oc(t,i){return t==="textarea"||t==="noscript"||typeof i.children=="string"||typeof i.children=="number"||typeof i.dangerouslySetInnerHTML=="object"&&i.dangerouslySetInnerHTML!==null&&i.dangerouslySetInnerHTML.__html!=null}var sc=typeof setTimeout=="function"?setTimeout:void 0,_S=typeof clearTimeout=="function"?clearTimeout:void 0,yg=typeof Promise=="function"?Promise:void 0,RS=typeof queueMicrotask=="function"?queueMicrotask:typeof yg<"u"?function(t){return yg.resolve(null).then(t).catch(PS)}:sc;function PS(t){setTimeout(function(){throw t})}function ac(t,i){var s=i,c=0;do{var f=s.nextSibling;if(t.removeChild(s),f&&f.nodeType===8)if(s=f.data,s==="/$"){if(c===0){t.removeChild(f),qo(i);return}c--}else s!=="$"&&s!=="$?"&&s!=="$!"||c++;s=f}while(s);qo(i)}function wi(t){for(;t!=null;t=t.nextSibling){var i=t.nodeType;if(i===1||i===3)break;if(i===8){if(i=t.data,i==="$"||i==="$!"||i==="$?")break;if(i==="/$")return null}}return t}function Sg(t){t=t.previousSibling;for(var i=0;t;){if(t.nodeType===8){var s=t.data;if(s==="$"||s==="$!"||s==="$?"){if(i===0)return t;i--}else s==="/$"&&i++}t=t.previousSibling}return null}var zr=Math.random().toString(36).slice(2),bn="__reactFiber$"+zr,as="__reactProps$"+zr,Qn="__reactContainer$"+zr,lc="__reactEvents$"+zr,NS="__reactListeners$"+zr,DS="__reactHandles$"+zr;function nr(t){var i=t[bn];if(i)return i;for(var s=t.parentNode;s;){if(i=s[Qn]||s[bn]){if(s=i.alternate,i.child!==null||s!==null&&s.child!==null)for(t=Sg(t);t!==null;){if(s=t[bn])return s;t=Sg(t)}return i}t=s,s=t.parentNode}return null}function ls(t){return t=t[bn]||t[Qn],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function Wr(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(r(33))}function Fa(t){return t[as]||null}var uc=[],Yr=-1;function Ei(t){return{current:t}}function Xe(t){0>Yr||(t.current=uc[Yr],uc[Yr]=null,Yr--)}function Ye(t,i){Yr++,uc[Yr]=t.current,t.current=i}var Ci={},Dt=Ei(Ci),Yt=Ei(!1),ir=Ci;function jr(t,i){var s=t.type.contextTypes;if(!s)return Ci;var c=t.stateNode;if(c&&c.__reactInternalMemoizedUnmaskedChildContext===i)return c.__reactInternalMemoizedMaskedChildContext;var f={},p;for(p in s)f[p]=i[p];return c&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=i,t.__reactInternalMemoizedMaskedChildContext=f),f}function jt(t){return t=t.childContextTypes,t!=null}function Ua(){Xe(Yt),Xe(Dt)}function Ag(t,i,s){if(Dt.current!==Ci)throw Error(r(168));Ye(Dt,i),Ye(Yt,s)}function Tg(t,i,s){var c=t.stateNode;if(i=i.childContextTypes,typeof c.getChildContext!="function")return s;c=c.getChildContext();for(var f in c)if(!(f in i))throw Error(r(108,we(t)||"Unknown",f));return Y({},s,c)}function La(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||Ci,ir=Dt.current,Ye(Dt,t),Ye(Yt,Yt.current),!0}function Ig(t,i,s){var c=t.stateNode;if(!c)throw Error(r(169));s?(t=Tg(t,i,ir),c.__reactInternalMemoizedMergedChildContext=t,Xe(Yt),Xe(Dt),Ye(Dt,t)):Xe(Yt),Ye(Yt,s)}var Jn=null,Ba=!1,cc=!1;function wg(t){Jn===null?Jn=[t]:Jn.push(t)}function OS(t){Ba=!0,wg(t)}function _i(){if(!cc&&Jn!==null){cc=!0;var t=0,i=We;try{var s=Jn;for(We=1;t<s.length;t++){var c=s[t];do c=c(!0);while(c!==null)}Jn=null,Ba=!1}catch(f){throw Jn!==null&&(Jn=Jn.slice(t+1)),Ch(ku,_i),f}finally{We=i,cc=!1}}return null}var Vr=[],Xr=0,Ha=null,ba=0,ln=[],un=0,rr=null,ei=1,ti="";function or(t,i){Vr[Xr++]=ba,Vr[Xr++]=Ha,Ha=t,ba=i}function Eg(t,i,s){ln[un++]=ei,ln[un++]=ti,ln[un++]=rr,rr=t;var c=ei;t=ti;var f=32-Tn(c)-1;c&=~(1<<f),s+=1;var p=32-Tn(i)+f;if(30<p){var v=f-f%5;p=(c&(1<<v)-1).toString(32),c>>=v,f-=v,ei=1<<32-Tn(i)+f|s<<f|c,ti=p+t}else ei=1<<p|s<<f|c,ti=t}function dc(t){t.return!==null&&(or(t,1),Eg(t,1,0))}function fc(t){for(;t===Ha;)Ha=Vr[--Xr],Vr[Xr]=null,ba=Vr[--Xr],Vr[Xr]=null;for(;t===rr;)rr=ln[--un],ln[un]=null,ti=ln[--un],ln[un]=null,ei=ln[--un],ln[un]=null}var Jt=null,en=null,Qe=!1,wn=null;function Cg(t,i){var s=hn(5,null,null,0);s.elementType="DELETED",s.stateNode=i,s.return=t,i=t.deletions,i===null?(t.deletions=[s],t.flags|=16):i.push(s)}function _g(t,i){switch(t.tag){case 5:var s=t.type;return i=i.nodeType!==1||s.toLowerCase()!==i.nodeName.toLowerCase()?null:i,i!==null?(t.stateNode=i,Jt=t,en=wi(i.firstChild),!0):!1;case 6:return i=t.pendingProps===""||i.nodeType!==3?null:i,i!==null?(t.stateNode=i,Jt=t,en=null,!0):!1;case 13:return i=i.nodeType!==8?null:i,i!==null?(s=rr!==null?{id:ei,overflow:ti}:null,t.memoizedState={dehydrated:i,treeContext:s,retryLane:1073741824},s=hn(18,null,null,0),s.stateNode=i,s.return=t,t.child=s,Jt=t,en=null,!0):!1;default:return!1}}function hc(t){return(t.mode&1)!==0&&(t.flags&128)===0}function gc(t){if(Qe){var i=en;if(i){var s=i;if(!_g(t,i)){if(hc(t))throw Error(r(418));i=wi(s.nextSibling);var c=Jt;i&&_g(t,i)?Cg(c,s):(t.flags=t.flags&-4097|2,Qe=!1,Jt=t)}}else{if(hc(t))throw Error(r(418));t.flags=t.flags&-4097|2,Qe=!1,Jt=t}}}function Rg(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;Jt=t}function Ga(t){if(t!==Jt)return!1;if(!Qe)return Rg(t),Qe=!0,!1;var i;if((i=t.tag!==3)&&!(i=t.tag!==5)&&(i=t.type,i=i!=="head"&&i!=="body"&&!oc(t.type,t.memoizedProps)),i&&(i=en)){if(hc(t))throw Pg(),Error(r(418));for(;i;)Cg(t,i),i=wi(i.nextSibling)}if(Rg(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(r(317));e:{for(t=t.nextSibling,i=0;t;){if(t.nodeType===8){var s=t.data;if(s==="/$"){if(i===0){en=wi(t.nextSibling);break e}i--}else s!=="$"&&s!=="$!"&&s!=="$?"||i++}t=t.nextSibling}en=null}}else en=Jt?wi(t.stateNode.nextSibling):null;return!0}function Pg(){for(var t=en;t;)t=wi(t.nextSibling)}function Kr(){en=Jt=null,Qe=!1}function pc(t){wn===null?wn=[t]:wn.push(t)}var kS=H.ReactCurrentBatchConfig;function us(t,i,s){if(t=s.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(s._owner){if(s=s._owner,s){if(s.tag!==1)throw Error(r(309));var c=s.stateNode}if(!c)throw Error(r(147,t));var f=c,p=""+t;return i!==null&&i.ref!==null&&typeof i.ref=="function"&&i.ref._stringRef===p?i.ref:(i=function(v){var A=f.refs;v===null?delete A[p]:A[p]=v},i._stringRef=p,i)}if(typeof t!="string")throw Error(r(284));if(!s._owner)throw Error(r(290,t))}return t}function xa(t,i){throw t=Object.prototype.toString.call(i),Error(r(31,t==="[object Object]"?"object with keys {"+Object.keys(i).join(", ")+"}":t))}function Ng(t){var i=t._init;return i(t._payload)}function Dg(t){function i(O,P){if(t){var k=O.deletions;k===null?(O.deletions=[P],O.flags|=16):k.push(P)}}function s(O,P){if(!t)return null;for(;P!==null;)i(O,P),P=P.sibling;return null}function c(O,P){for(O=new Map;P!==null;)P.key!==null?O.set(P.key,P):O.set(P.index,P),P=P.sibling;return O}function f(O,P){return O=Fi(O,P),O.index=0,O.sibling=null,O}function p(O,P,k){return O.index=k,t?(k=O.alternate,k!==null?(k=k.index,k<P?(O.flags|=2,P):k):(O.flags|=2,P)):(O.flags|=1048576,P)}function v(O){return t&&O.alternate===null&&(O.flags|=2),O}function A(O,P,k,j){return P===null||P.tag!==6?(P=sd(k,O.mode,j),P.return=O,P):(P=f(P,k),P.return=O,P)}function _(O,P,k,j){var ae=k.type;return ae===$?G(O,P,k.props.children,j,k.key):P!==null&&(P.elementType===ae||typeof ae=="object"&&ae!==null&&ae.$$typeof===Ae&&Ng(ae)===P.type)?(j=f(P,k.props),j.ref=us(O,P,k),j.return=O,j):(j=dl(k.type,k.key,k.props,null,O.mode,j),j.ref=us(O,P,k),j.return=O,j)}function M(O,P,k,j){return P===null||P.tag!==4||P.stateNode.containerInfo!==k.containerInfo||P.stateNode.implementation!==k.implementation?(P=ad(k,O.mode,j),P.return=O,P):(P=f(P,k.children||[]),P.return=O,P)}function G(O,P,k,j,ae){return P===null||P.tag!==7?(P=hr(k,O.mode,j,ae),P.return=O,P):(P=f(P,k),P.return=O,P)}function z(O,P,k){if(typeof P=="string"&&P!==""||typeof P=="number")return P=sd(""+P,O.mode,k),P.return=O,P;if(typeof P=="object"&&P!==null){switch(P.$$typeof){case x:return k=dl(P.type,P.key,P.props,null,O.mode,k),k.ref=us(O,null,P),k.return=O,k;case U:return P=ad(P,O.mode,k),P.return=O,P;case Ae:var j=P._init;return z(O,j(P._payload),k)}if(Bn(P)||X(P))return P=hr(P,O.mode,k,null),P.return=O,P;xa(O,P)}return null}function b(O,P,k,j){var ae=P!==null?P.key:null;if(typeof k=="string"&&k!==""||typeof k=="number")return ae!==null?null:A(O,P,""+k,j);if(typeof k=="object"&&k!==null){switch(k.$$typeof){case x:return k.key===ae?_(O,P,k,j):null;case U:return k.key===ae?M(O,P,k,j):null;case Ae:return ae=k._init,b(O,P,ae(k._payload),j)}if(Bn(k)||X(k))return ae!==null?null:G(O,P,k,j,null);xa(O,k)}return null}function Z(O,P,k,j,ae){if(typeof j=="string"&&j!==""||typeof j=="number")return O=O.get(k)||null,A(P,O,""+j,ae);if(typeof j=="object"&&j!==null){switch(j.$$typeof){case x:return O=O.get(j.key===null?k:j.key)||null,_(P,O,j,ae);case U:return O=O.get(j.key===null?k:j.key)||null,M(P,O,j,ae);case Ae:var me=j._init;return Z(O,P,k,me(j._payload),ae)}if(Bn(j)||X(j))return O=O.get(k)||null,G(P,O,j,ae,null);xa(P,j)}return null}function ee(O,P,k,j){for(var ae=null,me=null,ve=P,Ee=P=0,vt=null;ve!==null&&Ee<k.length;Ee++){ve.index>Ee?(vt=ve,ve=null):vt=ve.sibling;var xe=b(O,ve,k[Ee],j);if(xe===null){ve===null&&(ve=vt);break}t&&ve&&xe.alternate===null&&i(O,ve),P=p(xe,P,Ee),me===null?ae=xe:me.sibling=xe,me=xe,ve=vt}if(Ee===k.length)return s(O,ve),Qe&&or(O,Ee),ae;if(ve===null){for(;Ee<k.length;Ee++)ve=z(O,k[Ee],j),ve!==null&&(P=p(ve,P,Ee),me===null?ae=ve:me.sibling=ve,me=ve);return Qe&&or(O,Ee),ae}for(ve=c(O,ve);Ee<k.length;Ee++)vt=Z(ve,O,Ee,k[Ee],j),vt!==null&&(t&&vt.alternate!==null&&ve.delete(vt.key===null?Ee:vt.key),P=p(vt,P,Ee),me===null?ae=vt:me.sibling=vt,me=vt);return t&&ve.forEach(function(Ui){return i(O,Ui)}),Qe&&or(O,Ee),ae}function oe(O,P,k,j){var ae=X(k);if(typeof ae!="function")throw Error(r(150));if(k=ae.call(k),k==null)throw Error(r(151));for(var me=ae=null,ve=P,Ee=P=0,vt=null,xe=k.next();ve!==null&&!xe.done;Ee++,xe=k.next()){ve.index>Ee?(vt=ve,ve=null):vt=ve.sibling;var Ui=b(O,ve,xe.value,j);if(Ui===null){ve===null&&(ve=vt);break}t&&ve&&Ui.alternate===null&&i(O,ve),P=p(Ui,P,Ee),me===null?ae=Ui:me.sibling=Ui,me=Ui,ve=vt}if(xe.done)return s(O,ve),Qe&&or(O,Ee),ae;if(ve===null){for(;!xe.done;Ee++,xe=k.next())xe=z(O,xe.value,j),xe!==null&&(P=p(xe,P,Ee),me===null?ae=xe:me.sibling=xe,me=xe);return Qe&&or(O,Ee),ae}for(ve=c(O,ve);!xe.done;Ee++,xe=k.next())xe=Z(ve,O,Ee,xe.value,j),xe!==null&&(t&&xe.alternate!==null&&ve.delete(xe.key===null?Ee:xe.key),P=p(xe,P,Ee),me===null?ae=xe:me.sibling=xe,me=xe);return t&&ve.forEach(function(dA){return i(O,dA)}),Qe&&or(O,Ee),ae}function at(O,P,k,j){if(typeof k=="object"&&k!==null&&k.type===$&&k.key===null&&(k=k.props.children),typeof k=="object"&&k!==null){switch(k.$$typeof){case x:e:{for(var ae=k.key,me=P;me!==null;){if(me.key===ae){if(ae=k.type,ae===$){if(me.tag===7){s(O,me.sibling),P=f(me,k.props.children),P.return=O,O=P;break e}}else if(me.elementType===ae||typeof ae=="object"&&ae!==null&&ae.$$typeof===Ae&&Ng(ae)===me.type){s(O,me.sibling),P=f(me,k.props),P.ref=us(O,me,k),P.return=O,O=P;break e}s(O,me);break}else i(O,me);me=me.sibling}k.type===$?(P=hr(k.props.children,O.mode,j,k.key),P.return=O,O=P):(j=dl(k.type,k.key,k.props,null,O.mode,j),j.ref=us(O,P,k),j.return=O,O=j)}return v(O);case U:e:{for(me=k.key;P!==null;){if(P.key===me)if(P.tag===4&&P.stateNode.containerInfo===k.containerInfo&&P.stateNode.implementation===k.implementation){s(O,P.sibling),P=f(P,k.children||[]),P.return=O,O=P;break e}else{s(O,P);break}else i(O,P);P=P.sibling}P=ad(k,O.mode,j),P.return=O,O=P}return v(O);case Ae:return me=k._init,at(O,P,me(k._payload),j)}if(Bn(k))return ee(O,P,k,j);if(X(k))return oe(O,P,k,j);xa(O,k)}return typeof k=="string"&&k!==""||typeof k=="number"?(k=""+k,P!==null&&P.tag===6?(s(O,P.sibling),P=f(P,k),P.return=O,O=P):(s(O,P),P=sd(k,O.mode,j),P.return=O,O=P),v(O)):s(O,P)}return at}var qr=Dg(!0),Og=Dg(!1),$a=Ei(null),za=null,Zr=null,mc=null;function vc(){mc=Zr=za=null}function yc(t){var i=$a.current;Xe($a),t._currentValue=i}function Sc(t,i,s){for(;t!==null;){var c=t.alternate;if((t.childLanes&i)!==i?(t.childLanes|=i,c!==null&&(c.childLanes|=i)):c!==null&&(c.childLanes&i)!==i&&(c.childLanes|=i),t===s)break;t=t.return}}function Qr(t,i){za=t,mc=Zr=null,t=t.dependencies,t!==null&&t.firstContext!==null&&((t.lanes&i)!==0&&(Vt=!0),t.firstContext=null)}function cn(t){var i=t._currentValue;if(mc!==t)if(t={context:t,memoizedValue:i,next:null},Zr===null){if(za===null)throw Error(r(308));Zr=t,za.dependencies={lanes:0,firstContext:t}}else Zr=Zr.next=t;return i}var sr=null;function Ac(t){sr===null?sr=[t]:sr.push(t)}function kg(t,i,s,c){var f=i.interleaved;return f===null?(s.next=s,Ac(i)):(s.next=f.next,f.next=s),i.interleaved=s,ni(t,c)}function ni(t,i){t.lanes|=i;var s=t.alternate;for(s!==null&&(s.lanes|=i),s=t,t=t.return;t!==null;)t.childLanes|=i,s=t.alternate,s!==null&&(s.childLanes|=i),s=t,t=t.return;return s.tag===3?s.stateNode:null}var Ri=!1;function Tc(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Mg(t,i){t=t.updateQueue,i.updateQueue===t&&(i.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function ii(t,i){return{eventTime:t,lane:i,tag:0,payload:null,callback:null,next:null}}function Pi(t,i,s){var c=t.updateQueue;if(c===null)return null;if(c=c.shared,(He&2)!==0){var f=c.pending;return f===null?i.next=i:(i.next=f.next,f.next=i),c.pending=i,ni(t,s)}return f=c.interleaved,f===null?(i.next=i,Ac(c)):(i.next=f.next,f.next=i),c.interleaved=i,ni(t,s)}function Wa(t,i,s){if(i=i.updateQueue,i!==null&&(i=i.shared,(s&4194240)!==0)){var c=i.lanes;c&=t.pendingLanes,s|=c,i.lanes=s,Uu(t,s)}}function Fg(t,i){var s=t.updateQueue,c=t.alternate;if(c!==null&&(c=c.updateQueue,s===c)){var f=null,p=null;if(s=s.firstBaseUpdate,s!==null){do{var v={eventTime:s.eventTime,lane:s.lane,tag:s.tag,payload:s.payload,callback:s.callback,next:null};p===null?f=p=v:p=p.next=v,s=s.next}while(s!==null);p===null?f=p=i:p=p.next=i}else f=p=i;s={baseState:c.baseState,firstBaseUpdate:f,lastBaseUpdate:p,shared:c.shared,effects:c.effects},t.updateQueue=s;return}t=s.lastBaseUpdate,t===null?s.firstBaseUpdate=i:t.next=i,s.lastBaseUpdate=i}function Ya(t,i,s,c){var f=t.updateQueue;Ri=!1;var p=f.firstBaseUpdate,v=f.lastBaseUpdate,A=f.shared.pending;if(A!==null){f.shared.pending=null;var _=A,M=_.next;_.next=null,v===null?p=M:v.next=M,v=_;var G=t.alternate;G!==null&&(G=G.updateQueue,A=G.lastBaseUpdate,A!==v&&(A===null?G.firstBaseUpdate=M:A.next=M,G.lastBaseUpdate=_))}if(p!==null){var z=f.baseState;v=0,G=M=_=null,A=p;do{var b=A.lane,Z=A.eventTime;if((c&b)===b){G!==null&&(G=G.next={eventTime:Z,lane:0,tag:A.tag,payload:A.payload,callback:A.callback,next:null});e:{var ee=t,oe=A;switch(b=i,Z=s,oe.tag){case 1:if(ee=oe.payload,typeof ee=="function"){z=ee.call(Z,z,b);break e}z=ee;break e;case 3:ee.flags=ee.flags&-65537|128;case 0:if(ee=oe.payload,b=typeof ee=="function"?ee.call(Z,z,b):ee,b==null)break e;z=Y({},z,b);break e;case 2:Ri=!0}}A.callback!==null&&A.lane!==0&&(t.flags|=64,b=f.effects,b===null?f.effects=[A]:b.push(A))}else Z={eventTime:Z,lane:b,tag:A.tag,payload:A.payload,callback:A.callback,next:null},G===null?(M=G=Z,_=z):G=G.next=Z,v|=b;if(A=A.next,A===null){if(A=f.shared.pending,A===null)break;b=A,A=b.next,b.next=null,f.lastBaseUpdate=b,f.shared.pending=null}}while(!0);if(G===null&&(_=z),f.baseState=_,f.firstBaseUpdate=M,f.lastBaseUpdate=G,i=f.shared.interleaved,i!==null){f=i;do v|=f.lane,f=f.next;while(f!==i)}else p===null&&(f.shared.lanes=0);ur|=v,t.lanes=v,t.memoizedState=z}}function Ug(t,i,s){if(t=i.effects,i.effects=null,t!==null)for(i=0;i<t.length;i++){var c=t[i],f=c.callback;if(f!==null){if(c.callback=null,c=s,typeof f!="function")throw Error(r(191,f));f.call(c)}}}var cs={},Gn=Ei(cs),ds=Ei(cs),fs=Ei(cs);function ar(t){if(t===cs)throw Error(r(174));return t}function Ic(t,i){switch(Ye(fs,i),Ye(ds,t),Ye(Gn,cs),t=i.nodeType,t){case 9:case 11:i=(i=i.documentElement)?i.namespaceURI:wu(null,"");break;default:t=t===8?i.parentNode:i,i=t.namespaceURI||null,t=t.tagName,i=wu(i,t)}Xe(Gn),Ye(Gn,i)}function Jr(){Xe(Gn),Xe(ds),Xe(fs)}function Lg(t){ar(fs.current);var i=ar(Gn.current),s=wu(i,t.type);i!==s&&(Ye(ds,t),Ye(Gn,s))}function wc(t){ds.current===t&&(Xe(Gn),Xe(ds))}var it=Ei(0);function ja(t){for(var i=t;i!==null;){if(i.tag===13){var s=i.memoizedState;if(s!==null&&(s=s.dehydrated,s===null||s.data==="$?"||s.data==="$!"))return i}else if(i.tag===19&&i.memoizedProps.revealOrder!==void 0){if((i.flags&128)!==0)return i}else if(i.child!==null){i.child.return=i,i=i.child;continue}if(i===t)break;for(;i.sibling===null;){if(i.return===null||i.return===t)return null;i=i.return}i.sibling.return=i.return,i=i.sibling}return null}var Ec=[];function Cc(){for(var t=0;t<Ec.length;t++)Ec[t]._workInProgressVersionPrimary=null;Ec.length=0}var Va=H.ReactCurrentDispatcher,_c=H.ReactCurrentBatchConfig,lr=0,rt=null,ht=null,pt=null,Xa=!1,hs=!1,gs=0,MS=0;function Ot(){throw Error(r(321))}function Rc(t,i){if(i===null)return!1;for(var s=0;s<i.length&&s<t.length;s++)if(!In(t[s],i[s]))return!1;return!0}function Pc(t,i,s,c,f,p){if(lr=p,rt=i,i.memoizedState=null,i.updateQueue=null,i.lanes=0,Va.current=t===null||t.memoizedState===null?BS:HS,t=s(c,f),hs){p=0;do{if(hs=!1,gs=0,25<=p)throw Error(r(301));p+=1,pt=ht=null,i.updateQueue=null,Va.current=bS,t=s(c,f)}while(hs)}if(Va.current=Za,i=ht!==null&&ht.next!==null,lr=0,pt=ht=rt=null,Xa=!1,i)throw Error(r(300));return t}function Nc(){var t=gs!==0;return gs=0,t}function xn(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return pt===null?rt.memoizedState=pt=t:pt=pt.next=t,pt}function dn(){if(ht===null){var t=rt.alternate;t=t!==null?t.memoizedState:null}else t=ht.next;var i=pt===null?rt.memoizedState:pt.next;if(i!==null)pt=i,ht=t;else{if(t===null)throw Error(r(310));ht=t,t={memoizedState:ht.memoizedState,baseState:ht.baseState,baseQueue:ht.baseQueue,queue:ht.queue,next:null},pt===null?rt.memoizedState=pt=t:pt=pt.next=t}return pt}function ps(t,i){return typeof i=="function"?i(t):i}function Dc(t){var i=dn(),s=i.queue;if(s===null)throw Error(r(311));s.lastRenderedReducer=t;var c=ht,f=c.baseQueue,p=s.pending;if(p!==null){if(f!==null){var v=f.next;f.next=p.next,p.next=v}c.baseQueue=f=p,s.pending=null}if(f!==null){p=f.next,c=c.baseState;var A=v=null,_=null,M=p;do{var G=M.lane;if((lr&G)===G)_!==null&&(_=_.next={lane:0,action:M.action,hasEagerState:M.hasEagerState,eagerState:M.eagerState,next:null}),c=M.hasEagerState?M.eagerState:t(c,M.action);else{var z={lane:G,action:M.action,hasEagerState:M.hasEagerState,eagerState:M.eagerState,next:null};_===null?(A=_=z,v=c):_=_.next=z,rt.lanes|=G,ur|=G}M=M.next}while(M!==null&&M!==p);_===null?v=c:_.next=A,In(c,i.memoizedState)||(Vt=!0),i.memoizedState=c,i.baseState=v,i.baseQueue=_,s.lastRenderedState=c}if(t=s.interleaved,t!==null){f=t;do p=f.lane,rt.lanes|=p,ur|=p,f=f.next;while(f!==t)}else f===null&&(s.lanes=0);return[i.memoizedState,s.dispatch]}function Oc(t){var i=dn(),s=i.queue;if(s===null)throw Error(r(311));s.lastRenderedReducer=t;var c=s.dispatch,f=s.pending,p=i.memoizedState;if(f!==null){s.pending=null;var v=f=f.next;do p=t(p,v.action),v=v.next;while(v!==f);In(p,i.memoizedState)||(Vt=!0),i.memoizedState=p,i.baseQueue===null&&(i.baseState=p),s.lastRenderedState=p}return[p,c]}function Bg(){}function Hg(t,i){var s=rt,c=dn(),f=i(),p=!In(c.memoizedState,f);if(p&&(c.memoizedState=f,Vt=!0),c=c.queue,kc(xg.bind(null,s,c,t),[t]),c.getSnapshot!==i||p||pt!==null&&pt.memoizedState.tag&1){if(s.flags|=2048,ms(9,Gg.bind(null,s,c,f,i),void 0,null),mt===null)throw Error(r(349));(lr&30)!==0||bg(s,i,f)}return f}function bg(t,i,s){t.flags|=16384,t={getSnapshot:i,value:s},i=rt.updateQueue,i===null?(i={lastEffect:null,stores:null},rt.updateQueue=i,i.stores=[t]):(s=i.stores,s===null?i.stores=[t]:s.push(t))}function Gg(t,i,s,c){i.value=s,i.getSnapshot=c,$g(i)&&zg(t)}function xg(t,i,s){return s(function(){$g(i)&&zg(t)})}function $g(t){var i=t.getSnapshot;t=t.value;try{var s=i();return!In(t,s)}catch{return!0}}function zg(t){var i=ni(t,1);i!==null&&Rn(i,t,1,-1)}function Wg(t){var i=xn();return typeof t=="function"&&(t=t()),i.memoizedState=i.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:ps,lastRenderedState:t},i.queue=t,t=t.dispatch=LS.bind(null,rt,t),[i.memoizedState,t]}function ms(t,i,s,c){return t={tag:t,create:i,destroy:s,deps:c,next:null},i=rt.updateQueue,i===null?(i={lastEffect:null,stores:null},rt.updateQueue=i,i.lastEffect=t.next=t):(s=i.lastEffect,s===null?i.lastEffect=t.next=t:(c=s.next,s.next=t,t.next=c,i.lastEffect=t)),t}function Yg(){return dn().memoizedState}function Ka(t,i,s,c){var f=xn();rt.flags|=t,f.memoizedState=ms(1|i,s,void 0,c===void 0?null:c)}function qa(t,i,s,c){var f=dn();c=c===void 0?null:c;var p=void 0;if(ht!==null){var v=ht.memoizedState;if(p=v.destroy,c!==null&&Rc(c,v.deps)){f.memoizedState=ms(i,s,p,c);return}}rt.flags|=t,f.memoizedState=ms(1|i,s,p,c)}function jg(t,i){return Ka(8390656,8,t,i)}function kc(t,i){return qa(2048,8,t,i)}function Vg(t,i){return qa(4,2,t,i)}function Xg(t,i){return qa(4,4,t,i)}function Kg(t,i){if(typeof i=="function")return t=t(),i(t),function(){i(null)};if(i!=null)return t=t(),i.current=t,function(){i.current=null}}function qg(t,i,s){return s=s!=null?s.concat([t]):null,qa(4,4,Kg.bind(null,i,t),s)}function Mc(){}function Zg(t,i){var s=dn();i=i===void 0?null:i;var c=s.memoizedState;return c!==null&&i!==null&&Rc(i,c[1])?c[0]:(s.memoizedState=[t,i],t)}function Qg(t,i){var s=dn();i=i===void 0?null:i;var c=s.memoizedState;return c!==null&&i!==null&&Rc(i,c[1])?c[0]:(t=t(),s.memoizedState=[t,i],t)}function Jg(t,i,s){return(lr&21)===0?(t.baseState&&(t.baseState=!1,Vt=!0),t.memoizedState=s):(In(s,i)||(s=Nh(),rt.lanes|=s,ur|=s,t.baseState=!0),i)}function FS(t,i){var s=We;We=s!==0&&4>s?s:4,t(!0);var c=_c.transition;_c.transition={};try{t(!1),i()}finally{We=s,_c.transition=c}}function ep(){return dn().memoizedState}function US(t,i,s){var c=ki(t);if(s={lane:c,action:s,hasEagerState:!1,eagerState:null,next:null},tp(t))np(i,s);else if(s=kg(t,i,s,c),s!==null){var f=Ht();Rn(s,t,c,f),ip(s,i,c)}}function LS(t,i,s){var c=ki(t),f={lane:c,action:s,hasEagerState:!1,eagerState:null,next:null};if(tp(t))np(i,f);else{var p=t.alternate;if(t.lanes===0&&(p===null||p.lanes===0)&&(p=i.lastRenderedReducer,p!==null))try{var v=i.lastRenderedState,A=p(v,s);if(f.hasEagerState=!0,f.eagerState=A,In(A,v)){var _=i.interleaved;_===null?(f.next=f,Ac(i)):(f.next=_.next,_.next=f),i.interleaved=f;return}}catch{}finally{}s=kg(t,i,f,c),s!==null&&(f=Ht(),Rn(s,t,c,f),ip(s,i,c))}}function tp(t){var i=t.alternate;return t===rt||i!==null&&i===rt}function np(t,i){hs=Xa=!0;var s=t.pending;s===null?i.next=i:(i.next=s.next,s.next=i),t.pending=i}function ip(t,i,s){if((s&4194240)!==0){var c=i.lanes;c&=t.pendingLanes,s|=c,i.lanes=s,Uu(t,s)}}var Za={readContext:cn,useCallback:Ot,useContext:Ot,useEffect:Ot,useImperativeHandle:Ot,useInsertionEffect:Ot,useLayoutEffect:Ot,useMemo:Ot,useReducer:Ot,useRef:Ot,useState:Ot,useDebugValue:Ot,useDeferredValue:Ot,useTransition:Ot,useMutableSource:Ot,useSyncExternalStore:Ot,useId:Ot,unstable_isNewReconciler:!1},BS={readContext:cn,useCallback:function(t,i){return xn().memoizedState=[t,i===void 0?null:i],t},useContext:cn,useEffect:jg,useImperativeHandle:function(t,i,s){return s=s!=null?s.concat([t]):null,Ka(4194308,4,Kg.bind(null,i,t),s)},useLayoutEffect:function(t,i){return Ka(4194308,4,t,i)},useInsertionEffect:function(t,i){return Ka(4,2,t,i)},useMemo:function(t,i){var s=xn();return i=i===void 0?null:i,t=t(),s.memoizedState=[t,i],t},useReducer:function(t,i,s){var c=xn();return i=s!==void 0?s(i):i,c.memoizedState=c.baseState=i,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:i},c.queue=t,t=t.dispatch=US.bind(null,rt,t),[c.memoizedState,t]},useRef:function(t){var i=xn();return t={current:t},i.memoizedState=t},useState:Wg,useDebugValue:Mc,useDeferredValue:function(t){return xn().memoizedState=t},useTransition:function(){var t=Wg(!1),i=t[0];return t=FS.bind(null,t[1]),xn().memoizedState=t,[i,t]},useMutableSource:function(){},useSyncExternalStore:function(t,i,s){var c=rt,f=xn();if(Qe){if(s===void 0)throw Error(r(407));s=s()}else{if(s=i(),mt===null)throw Error(r(349));(lr&30)!==0||bg(c,i,s)}f.memoizedState=s;var p={value:s,getSnapshot:i};return f.queue=p,jg(xg.bind(null,c,p,t),[t]),c.flags|=2048,ms(9,Gg.bind(null,c,p,s,i),void 0,null),s},useId:function(){var t=xn(),i=mt.identifierPrefix;if(Qe){var s=ti,c=ei;s=(c&~(1<<32-Tn(c)-1)).toString(32)+s,i=":"+i+"R"+s,s=gs++,0<s&&(i+="H"+s.toString(32)),i+=":"}else s=MS++,i=":"+i+"r"+s.toString(32)+":";return t.memoizedState=i},unstable_isNewReconciler:!1},HS={readContext:cn,useCallback:Zg,useContext:cn,useEffect:kc,useImperativeHandle:qg,useInsertionEffect:Vg,useLayoutEffect:Xg,useMemo:Qg,useReducer:Dc,useRef:Yg,useState:function(){return Dc(ps)},useDebugValue:Mc,useDeferredValue:function(t){var i=dn();return Jg(i,ht.memoizedState,t)},useTransition:function(){var t=Dc(ps)[0],i=dn().memoizedState;return[t,i]},useMutableSource:Bg,useSyncExternalStore:Hg,useId:ep,unstable_isNewReconciler:!1},bS={readContext:cn,useCallback:Zg,useContext:cn,useEffect:kc,useImperativeHandle:qg,useInsertionEffect:Vg,useLayoutEffect:Xg,useMemo:Qg,useReducer:Oc,useRef:Yg,useState:function(){return Oc(ps)},useDebugValue:Mc,useDeferredValue:function(t){var i=dn();return ht===null?i.memoizedState=t:Jg(i,ht.memoizedState,t)},useTransition:function(){var t=Oc(ps)[0],i=dn().memoizedState;return[t,i]},useMutableSource:Bg,useSyncExternalStore:Hg,useId:ep,unstable_isNewReconciler:!1};function En(t,i){if(t&&t.defaultProps){i=Y({},i),t=t.defaultProps;for(var s in t)i[s]===void 0&&(i[s]=t[s]);return i}return i}function Fc(t,i,s,c){i=t.memoizedState,s=s(c,i),s=s==null?i:Y({},i,s),t.memoizedState=s,t.lanes===0&&(t.updateQueue.baseState=s)}var Qa={isMounted:function(t){return(t=t._reactInternals)?tr(t)===t:!1},enqueueSetState:function(t,i,s){t=t._reactInternals;var c=Ht(),f=ki(t),p=ii(c,f);p.payload=i,s!=null&&(p.callback=s),i=Pi(t,p,f),i!==null&&(Rn(i,t,f,c),Wa(i,t,f))},enqueueReplaceState:function(t,i,s){t=t._reactInternals;var c=Ht(),f=ki(t),p=ii(c,f);p.tag=1,p.payload=i,s!=null&&(p.callback=s),i=Pi(t,p,f),i!==null&&(Rn(i,t,f,c),Wa(i,t,f))},enqueueForceUpdate:function(t,i){t=t._reactInternals;var s=Ht(),c=ki(t),f=ii(s,c);f.tag=2,i!=null&&(f.callback=i),i=Pi(t,f,c),i!==null&&(Rn(i,t,c,s),Wa(i,t,c))}};function rp(t,i,s,c,f,p,v){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(c,p,v):i.prototype&&i.prototype.isPureReactComponent?!ns(s,c)||!ns(f,p):!0}function op(t,i,s){var c=!1,f=Ci,p=i.contextType;return typeof p=="object"&&p!==null?p=cn(p):(f=jt(i)?ir:Dt.current,c=i.contextTypes,p=(c=c!=null)?jr(t,f):Ci),i=new i(s,p),t.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,i.updater=Qa,t.stateNode=i,i._reactInternals=t,c&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=f,t.__reactInternalMemoizedMaskedChildContext=p),i}function sp(t,i,s,c){t=i.state,typeof i.componentWillReceiveProps=="function"&&i.componentWillReceiveProps(s,c),typeof i.UNSAFE_componentWillReceiveProps=="function"&&i.UNSAFE_componentWillReceiveProps(s,c),i.state!==t&&Qa.enqueueReplaceState(i,i.state,null)}function Uc(t,i,s,c){var f=t.stateNode;f.props=s,f.state=t.memoizedState,f.refs={},Tc(t);var p=i.contextType;typeof p=="object"&&p!==null?f.context=cn(p):(p=jt(i)?ir:Dt.current,f.context=jr(t,p)),f.state=t.memoizedState,p=i.getDerivedStateFromProps,typeof p=="function"&&(Fc(t,i,p,s),f.state=t.memoizedState),typeof i.getDerivedStateFromProps=="function"||typeof f.getSnapshotBeforeUpdate=="function"||typeof f.UNSAFE_componentWillMount!="function"&&typeof f.componentWillMount!="function"||(i=f.state,typeof f.componentWillMount=="function"&&f.componentWillMount(),typeof f.UNSAFE_componentWillMount=="function"&&f.UNSAFE_componentWillMount(),i!==f.state&&Qa.enqueueReplaceState(f,f.state,null),Ya(t,s,f,c),f.state=t.memoizedState),typeof f.componentDidMount=="function"&&(t.flags|=4194308)}function eo(t,i){try{var s="",c=i;do s+=ye(c),c=c.return;while(c);var f=s}catch(p){f=`
Error generating stack: `+p.message+`
`+p.stack}return{value:t,source:i,stack:f,digest:null}}function Lc(t,i,s){return{value:t,source:null,stack:s??null,digest:i??null}}function Bc(t,i){try{console.error(i.value)}catch(s){setTimeout(function(){throw s})}}var GS=typeof WeakMap=="function"?WeakMap:Map;function ap(t,i,s){s=ii(-1,s),s.tag=3,s.payload={element:null};var c=i.value;return s.callback=function(){ol||(ol=!0,Qc=c),Bc(t,i)},s}function lp(t,i,s){s=ii(-1,s),s.tag=3;var c=t.type.getDerivedStateFromError;if(typeof c=="function"){var f=i.value;s.payload=function(){return c(f)},s.callback=function(){Bc(t,i)}}var p=t.stateNode;return p!==null&&typeof p.componentDidCatch=="function"&&(s.callback=function(){Bc(t,i),typeof c!="function"&&(Di===null?Di=new Set([this]):Di.add(this));var v=i.stack;this.componentDidCatch(i.value,{componentStack:v!==null?v:""})}),s}function up(t,i,s){var c=t.pingCache;if(c===null){c=t.pingCache=new GS;var f=new Set;c.set(i,f)}else f=c.get(i),f===void 0&&(f=new Set,c.set(i,f));f.has(s)||(f.add(s),t=eA.bind(null,t,i,s),i.then(t,t))}function cp(t){do{var i;if((i=t.tag===13)&&(i=t.memoizedState,i=i!==null?i.dehydrated!==null:!0),i)return t;t=t.return}while(t!==null);return null}function dp(t,i,s,c,f){return(t.mode&1)===0?(t===i?t.flags|=65536:(t.flags|=128,s.flags|=131072,s.flags&=-52805,s.tag===1&&(s.alternate===null?s.tag=17:(i=ii(-1,1),i.tag=2,Pi(s,i,1))),s.lanes|=1),t):(t.flags|=65536,t.lanes=f,t)}var xS=H.ReactCurrentOwner,Vt=!1;function Bt(t,i,s,c){i.child=t===null?Og(i,null,s,c):qr(i,t.child,s,c)}function fp(t,i,s,c,f){s=s.render;var p=i.ref;return Qr(i,f),c=Pc(t,i,s,c,p,f),s=Nc(),t!==null&&!Vt?(i.updateQueue=t.updateQueue,i.flags&=-2053,t.lanes&=~f,ri(t,i,f)):(Qe&&s&&dc(i),i.flags|=1,Bt(t,i,c,f),i.child)}function hp(t,i,s,c,f){if(t===null){var p=s.type;return typeof p=="function"&&!od(p)&&p.defaultProps===void 0&&s.compare===null&&s.defaultProps===void 0?(i.tag=15,i.type=p,gp(t,i,p,c,f)):(t=dl(s.type,null,c,i,i.mode,f),t.ref=i.ref,t.return=i,i.child=t)}if(p=t.child,(t.lanes&f)===0){var v=p.memoizedProps;if(s=s.compare,s=s!==null?s:ns,s(v,c)&&t.ref===i.ref)return ri(t,i,f)}return i.flags|=1,t=Fi(p,c),t.ref=i.ref,t.return=i,i.child=t}function gp(t,i,s,c,f){if(t!==null){var p=t.memoizedProps;if(ns(p,c)&&t.ref===i.ref)if(Vt=!1,i.pendingProps=c=p,(t.lanes&f)!==0)(t.flags&131072)!==0&&(Vt=!0);else return i.lanes=t.lanes,ri(t,i,f)}return Hc(t,i,s,c,f)}function pp(t,i,s){var c=i.pendingProps,f=c.children,p=t!==null?t.memoizedState:null;if(c.mode==="hidden")if((i.mode&1)===0)i.memoizedState={baseLanes:0,cachePool:null,transitions:null},Ye(no,tn),tn|=s;else{if((s&1073741824)===0)return t=p!==null?p.baseLanes|s:s,i.lanes=i.childLanes=1073741824,i.memoizedState={baseLanes:t,cachePool:null,transitions:null},i.updateQueue=null,Ye(no,tn),tn|=t,null;i.memoizedState={baseLanes:0,cachePool:null,transitions:null},c=p!==null?p.baseLanes:s,Ye(no,tn),tn|=c}else p!==null?(c=p.baseLanes|s,i.memoizedState=null):c=s,Ye(no,tn),tn|=c;return Bt(t,i,f,s),i.child}function mp(t,i){var s=i.ref;(t===null&&s!==null||t!==null&&t.ref!==s)&&(i.flags|=512,i.flags|=2097152)}function Hc(t,i,s,c,f){var p=jt(s)?ir:Dt.current;return p=jr(i,p),Qr(i,f),s=Pc(t,i,s,c,p,f),c=Nc(),t!==null&&!Vt?(i.updateQueue=t.updateQueue,i.flags&=-2053,t.lanes&=~f,ri(t,i,f)):(Qe&&c&&dc(i),i.flags|=1,Bt(t,i,s,f),i.child)}function vp(t,i,s,c,f){if(jt(s)){var p=!0;La(i)}else p=!1;if(Qr(i,f),i.stateNode===null)el(t,i),op(i,s,c),Uc(i,s,c,f),c=!0;else if(t===null){var v=i.stateNode,A=i.memoizedProps;v.props=A;var _=v.context,M=s.contextType;typeof M=="object"&&M!==null?M=cn(M):(M=jt(s)?ir:Dt.current,M=jr(i,M));var G=s.getDerivedStateFromProps,z=typeof G=="function"||typeof v.getSnapshotBeforeUpdate=="function";z||typeof v.UNSAFE_componentWillReceiveProps!="function"&&typeof v.componentWillReceiveProps!="function"||(A!==c||_!==M)&&sp(i,v,c,M),Ri=!1;var b=i.memoizedState;v.state=b,Ya(i,c,v,f),_=i.memoizedState,A!==c||b!==_||Yt.current||Ri?(typeof G=="function"&&(Fc(i,s,G,c),_=i.memoizedState),(A=Ri||rp(i,s,A,c,b,_,M))?(z||typeof v.UNSAFE_componentWillMount!="function"&&typeof v.componentWillMount!="function"||(typeof v.componentWillMount=="function"&&v.componentWillMount(),typeof v.UNSAFE_componentWillMount=="function"&&v.UNSAFE_componentWillMount()),typeof v.componentDidMount=="function"&&(i.flags|=4194308)):(typeof v.componentDidMount=="function"&&(i.flags|=4194308),i.memoizedProps=c,i.memoizedState=_),v.props=c,v.state=_,v.context=M,c=A):(typeof v.componentDidMount=="function"&&(i.flags|=4194308),c=!1)}else{v=i.stateNode,Mg(t,i),A=i.memoizedProps,M=i.type===i.elementType?A:En(i.type,A),v.props=M,z=i.pendingProps,b=v.context,_=s.contextType,typeof _=="object"&&_!==null?_=cn(_):(_=jt(s)?ir:Dt.current,_=jr(i,_));var Z=s.getDerivedStateFromProps;(G=typeof Z=="function"||typeof v.getSnapshotBeforeUpdate=="function")||typeof v.UNSAFE_componentWillReceiveProps!="function"&&typeof v.componentWillReceiveProps!="function"||(A!==z||b!==_)&&sp(i,v,c,_),Ri=!1,b=i.memoizedState,v.state=b,Ya(i,c,v,f);var ee=i.memoizedState;A!==z||b!==ee||Yt.current||Ri?(typeof Z=="function"&&(Fc(i,s,Z,c),ee=i.memoizedState),(M=Ri||rp(i,s,M,c,b,ee,_)||!1)?(G||typeof v.UNSAFE_componentWillUpdate!="function"&&typeof v.componentWillUpdate!="function"||(typeof v.componentWillUpdate=="function"&&v.componentWillUpdate(c,ee,_),typeof v.UNSAFE_componentWillUpdate=="function"&&v.UNSAFE_componentWillUpdate(c,ee,_)),typeof v.componentDidUpdate=="function"&&(i.flags|=4),typeof v.getSnapshotBeforeUpdate=="function"&&(i.flags|=1024)):(typeof v.componentDidUpdate!="function"||A===t.memoizedProps&&b===t.memoizedState||(i.flags|=4),typeof v.getSnapshotBeforeUpdate!="function"||A===t.memoizedProps&&b===t.memoizedState||(i.flags|=1024),i.memoizedProps=c,i.memoizedState=ee),v.props=c,v.state=ee,v.context=_,c=M):(typeof v.componentDidUpdate!="function"||A===t.memoizedProps&&b===t.memoizedState||(i.flags|=4),typeof v.getSnapshotBeforeUpdate!="function"||A===t.memoizedProps&&b===t.memoizedState||(i.flags|=1024),c=!1)}return bc(t,i,s,c,p,f)}function bc(t,i,s,c,f,p){mp(t,i);var v=(i.flags&128)!==0;if(!c&&!v)return f&&Ig(i,s,!1),ri(t,i,p);c=i.stateNode,xS.current=i;var A=v&&typeof s.getDerivedStateFromError!="function"?null:c.render();return i.flags|=1,t!==null&&v?(i.child=qr(i,t.child,null,p),i.child=qr(i,null,A,p)):Bt(t,i,A,p),i.memoizedState=c.state,f&&Ig(i,s,!0),i.child}function yp(t){var i=t.stateNode;i.pendingContext?Ag(t,i.pendingContext,i.pendingContext!==i.context):i.context&&Ag(t,i.context,!1),Ic(t,i.containerInfo)}function Sp(t,i,s,c,f){return Kr(),pc(f),i.flags|=256,Bt(t,i,s,c),i.child}var Gc={dehydrated:null,treeContext:null,retryLane:0};function xc(t){return{baseLanes:t,cachePool:null,transitions:null}}function Ap(t,i,s){var c=i.pendingProps,f=it.current,p=!1,v=(i.flags&128)!==0,A;if((A=v)||(A=t!==null&&t.memoizedState===null?!1:(f&2)!==0),A?(p=!0,i.flags&=-129):(t===null||t.memoizedState!==null)&&(f|=1),Ye(it,f&1),t===null)return gc(i),t=i.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?((i.mode&1)===0?i.lanes=1:t.data==="$!"?i.lanes=8:i.lanes=1073741824,null):(v=c.children,t=c.fallback,p?(c=i.mode,p=i.child,v={mode:"hidden",children:v},(c&1)===0&&p!==null?(p.childLanes=0,p.pendingProps=v):p=fl(v,c,0,null),t=hr(t,c,s,null),p.return=i,t.return=i,p.sibling=t,i.child=p,i.child.memoizedState=xc(s),i.memoizedState=Gc,t):$c(i,v));if(f=t.memoizedState,f!==null&&(A=f.dehydrated,A!==null))return $S(t,i,v,c,A,f,s);if(p){p=c.fallback,v=i.mode,f=t.child,A=f.sibling;var _={mode:"hidden",children:c.children};return(v&1)===0&&i.child!==f?(c=i.child,c.childLanes=0,c.pendingProps=_,i.deletions=null):(c=Fi(f,_),c.subtreeFlags=f.subtreeFlags&14680064),A!==null?p=Fi(A,p):(p=hr(p,v,s,null),p.flags|=2),p.return=i,c.return=i,c.sibling=p,i.child=c,c=p,p=i.child,v=t.child.memoizedState,v=v===null?xc(s):{baseLanes:v.baseLanes|s,cachePool:null,transitions:v.transitions},p.memoizedState=v,p.childLanes=t.childLanes&~s,i.memoizedState=Gc,c}return p=t.child,t=p.sibling,c=Fi(p,{mode:"visible",children:c.children}),(i.mode&1)===0&&(c.lanes=s),c.return=i,c.sibling=null,t!==null&&(s=i.deletions,s===null?(i.deletions=[t],i.flags|=16):s.push(t)),i.child=c,i.memoizedState=null,c}function $c(t,i){return i=fl({mode:"visible",children:i},t.mode,0,null),i.return=t,t.child=i}function Ja(t,i,s,c){return c!==null&&pc(c),qr(i,t.child,null,s),t=$c(i,i.pendingProps.children),t.flags|=2,i.memoizedState=null,t}function $S(t,i,s,c,f,p,v){if(s)return i.flags&256?(i.flags&=-257,c=Lc(Error(r(422))),Ja(t,i,v,c)):i.memoizedState!==null?(i.child=t.child,i.flags|=128,null):(p=c.fallback,f=i.mode,c=fl({mode:"visible",children:c.children},f,0,null),p=hr(p,f,v,null),p.flags|=2,c.return=i,p.return=i,c.sibling=p,i.child=c,(i.mode&1)!==0&&qr(i,t.child,null,v),i.child.memoizedState=xc(v),i.memoizedState=Gc,p);if((i.mode&1)===0)return Ja(t,i,v,null);if(f.data==="$!"){if(c=f.nextSibling&&f.nextSibling.dataset,c)var A=c.dgst;return c=A,p=Error(r(419)),c=Lc(p,c,void 0),Ja(t,i,v,c)}if(A=(v&t.childLanes)!==0,Vt||A){if(c=mt,c!==null){switch(v&-v){case 4:f=2;break;case 16:f=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:f=32;break;case 536870912:f=268435456;break;default:f=0}f=(f&(c.suspendedLanes|v))!==0?0:f,f!==0&&f!==p.retryLane&&(p.retryLane=f,ni(t,f),Rn(c,t,f,-1))}return rd(),c=Lc(Error(r(421))),Ja(t,i,v,c)}return f.data==="$?"?(i.flags|=128,i.child=t.child,i=tA.bind(null,t),f._reactRetry=i,null):(t=p.treeContext,en=wi(f.nextSibling),Jt=i,Qe=!0,wn=null,t!==null&&(ln[un++]=ei,ln[un++]=ti,ln[un++]=rr,ei=t.id,ti=t.overflow,rr=i),i=$c(i,c.children),i.flags|=4096,i)}function Tp(t,i,s){t.lanes|=i;var c=t.alternate;c!==null&&(c.lanes|=i),Sc(t.return,i,s)}function zc(t,i,s,c,f){var p=t.memoizedState;p===null?t.memoizedState={isBackwards:i,rendering:null,renderingStartTime:0,last:c,tail:s,tailMode:f}:(p.isBackwards=i,p.rendering=null,p.renderingStartTime=0,p.last=c,p.tail=s,p.tailMode=f)}function Ip(t,i,s){var c=i.pendingProps,f=c.revealOrder,p=c.tail;if(Bt(t,i,c.children,s),c=it.current,(c&2)!==0)c=c&1|2,i.flags|=128;else{if(t!==null&&(t.flags&128)!==0)e:for(t=i.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&Tp(t,s,i);else if(t.tag===19)Tp(t,s,i);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===i)break e;for(;t.sibling===null;){if(t.return===null||t.return===i)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}c&=1}if(Ye(it,c),(i.mode&1)===0)i.memoizedState=null;else switch(f){case"forwards":for(s=i.child,f=null;s!==null;)t=s.alternate,t!==null&&ja(t)===null&&(f=s),s=s.sibling;s=f,s===null?(f=i.child,i.child=null):(f=s.sibling,s.sibling=null),zc(i,!1,f,s,p);break;case"backwards":for(s=null,f=i.child,i.child=null;f!==null;){if(t=f.alternate,t!==null&&ja(t)===null){i.child=f;break}t=f.sibling,f.sibling=s,s=f,f=t}zc(i,!0,s,null,p);break;case"together":zc(i,!1,null,null,void 0);break;default:i.memoizedState=null}return i.child}function el(t,i){(i.mode&1)===0&&t!==null&&(t.alternate=null,i.alternate=null,i.flags|=2)}function ri(t,i,s){if(t!==null&&(i.dependencies=t.dependencies),ur|=i.lanes,(s&i.childLanes)===0)return null;if(t!==null&&i.child!==t.child)throw Error(r(153));if(i.child!==null){for(t=i.child,s=Fi(t,t.pendingProps),i.child=s,s.return=i;t.sibling!==null;)t=t.sibling,s=s.sibling=Fi(t,t.pendingProps),s.return=i;s.sibling=null}return i.child}function zS(t,i,s){switch(i.tag){case 3:yp(i),Kr();break;case 5:Lg(i);break;case 1:jt(i.type)&&La(i);break;case 4:Ic(i,i.stateNode.containerInfo);break;case 10:var c=i.type._context,f=i.memoizedProps.value;Ye($a,c._currentValue),c._currentValue=f;break;case 13:if(c=i.memoizedState,c!==null)return c.dehydrated!==null?(Ye(it,it.current&1),i.flags|=128,null):(s&i.child.childLanes)!==0?Ap(t,i,s):(Ye(it,it.current&1),t=ri(t,i,s),t!==null?t.sibling:null);Ye(it,it.current&1);break;case 19:if(c=(s&i.childLanes)!==0,(t.flags&128)!==0){if(c)return Ip(t,i,s);i.flags|=128}if(f=i.memoizedState,f!==null&&(f.rendering=null,f.tail=null,f.lastEffect=null),Ye(it,it.current),c)break;return null;case 22:case 23:return i.lanes=0,pp(t,i,s)}return ri(t,i,s)}var wp,Wc,Ep,Cp;wp=function(t,i){for(var s=i.child;s!==null;){if(s.tag===5||s.tag===6)t.appendChild(s.stateNode);else if(s.tag!==4&&s.child!==null){s.child.return=s,s=s.child;continue}if(s===i)break;for(;s.sibling===null;){if(s.return===null||s.return===i)return;s=s.return}s.sibling.return=s.return,s=s.sibling}},Wc=function(){},Ep=function(t,i,s,c){var f=t.memoizedProps;if(f!==c){t=i.stateNode,ar(Gn.current);var p=null;switch(s){case"input":f=Ze(t,f),c=Ze(t,c),p=[];break;case"select":f=Y({},f,{value:void 0}),c=Y({},c,{value:void 0}),p=[];break;case"textarea":f=er(t,f),c=er(t,c),p=[];break;default:typeof f.onClick!="function"&&typeof c.onClick=="function"&&(t.onclick=Ma)}Eu(s,c);var v;s=null;for(M in f)if(!c.hasOwnProperty(M)&&f.hasOwnProperty(M)&&f[M]!=null)if(M==="style"){var A=f[M];for(v in A)A.hasOwnProperty(v)&&(s||(s={}),s[v]="")}else M!=="dangerouslySetInnerHTML"&&M!=="children"&&M!=="suppressContentEditableWarning"&&M!=="suppressHydrationWarning"&&M!=="autoFocus"&&(l.hasOwnProperty(M)?p||(p=[]):(p=p||[]).push(M,null));for(M in c){var _=c[M];if(A=f!=null?f[M]:void 0,c.hasOwnProperty(M)&&_!==A&&(_!=null||A!=null))if(M==="style")if(A){for(v in A)!A.hasOwnProperty(v)||_&&_.hasOwnProperty(v)||(s||(s={}),s[v]="");for(v in _)_.hasOwnProperty(v)&&A[v]!==_[v]&&(s||(s={}),s[v]=_[v])}else s||(p||(p=[]),p.push(M,s)),s=_;else M==="dangerouslySetInnerHTML"?(_=_?_.__html:void 0,A=A?A.__html:void 0,_!=null&&A!==_&&(p=p||[]).push(M,_)):M==="children"?typeof _!="string"&&typeof _!="number"||(p=p||[]).push(M,""+_):M!=="suppressContentEditableWarning"&&M!=="suppressHydrationWarning"&&(l.hasOwnProperty(M)?(_!=null&&M==="onScroll"&&Ve("scroll",t),p||A===_||(p=[])):(p=p||[]).push(M,_))}s&&(p=p||[]).push("style",s);var M=p;(i.updateQueue=M)&&(i.flags|=4)}},Cp=function(t,i,s,c){s!==c&&(i.flags|=4)};function vs(t,i){if(!Qe)switch(t.tailMode){case"hidden":i=t.tail;for(var s=null;i!==null;)i.alternate!==null&&(s=i),i=i.sibling;s===null?t.tail=null:s.sibling=null;break;case"collapsed":s=t.tail;for(var c=null;s!==null;)s.alternate!==null&&(c=s),s=s.sibling;c===null?i||t.tail===null?t.tail=null:t.tail.sibling=null:c.sibling=null}}function kt(t){var i=t.alternate!==null&&t.alternate.child===t.child,s=0,c=0;if(i)for(var f=t.child;f!==null;)s|=f.lanes|f.childLanes,c|=f.subtreeFlags&14680064,c|=f.flags&14680064,f.return=t,f=f.sibling;else for(f=t.child;f!==null;)s|=f.lanes|f.childLanes,c|=f.subtreeFlags,c|=f.flags,f.return=t,f=f.sibling;return t.subtreeFlags|=c,t.childLanes=s,i}function WS(t,i,s){var c=i.pendingProps;switch(fc(i),i.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return kt(i),null;case 1:return jt(i.type)&&Ua(),kt(i),null;case 3:return c=i.stateNode,Jr(),Xe(Yt),Xe(Dt),Cc(),c.pendingContext&&(c.context=c.pendingContext,c.pendingContext=null),(t===null||t.child===null)&&(Ga(i)?i.flags|=4:t===null||t.memoizedState.isDehydrated&&(i.flags&256)===0||(i.flags|=1024,wn!==null&&(td(wn),wn=null))),Wc(t,i),kt(i),null;case 5:wc(i);var f=ar(fs.current);if(s=i.type,t!==null&&i.stateNode!=null)Ep(t,i,s,c,f),t.ref!==i.ref&&(i.flags|=512,i.flags|=2097152);else{if(!c){if(i.stateNode===null)throw Error(r(166));return kt(i),null}if(t=ar(Gn.current),Ga(i)){c=i.stateNode,s=i.type;var p=i.memoizedProps;switch(c[bn]=i,c[as]=p,t=(i.mode&1)!==0,s){case"dialog":Ve("cancel",c),Ve("close",c);break;case"iframe":case"object":case"embed":Ve("load",c);break;case"video":case"audio":for(f=0;f<rs.length;f++)Ve(rs[f],c);break;case"source":Ve("error",c);break;case"img":case"image":case"link":Ve("error",c),Ve("load",c);break;case"details":Ve("toggle",c);break;case"input":je(c,p),Ve("invalid",c);break;case"select":c._wrapperState={wasMultiple:!!p.multiple},Ve("invalid",c);break;case"textarea":lh(c,p),Ve("invalid",c)}Eu(s,p),f=null;for(var v in p)if(p.hasOwnProperty(v)){var A=p[v];v==="children"?typeof A=="string"?c.textContent!==A&&(p.suppressHydrationWarning!==!0&&ka(c.textContent,A,t),f=["children",A]):typeof A=="number"&&c.textContent!==""+A&&(p.suppressHydrationWarning!==!0&&ka(c.textContent,A,t),f=["children",""+A]):l.hasOwnProperty(v)&&A!=null&&v==="onScroll"&&Ve("scroll",c)}switch(s){case"input":Le(c),an(c,p,!0);break;case"textarea":Le(c),ch(c);break;case"select":case"option":break;default:typeof p.onClick=="function"&&(c.onclick=Ma)}c=f,i.updateQueue=c,c!==null&&(i.flags|=4)}else{v=f.nodeType===9?f:f.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=dh(s)),t==="http://www.w3.org/1999/xhtml"?s==="script"?(t=v.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof c.is=="string"?t=v.createElement(s,{is:c.is}):(t=v.createElement(s),s==="select"&&(v=t,c.multiple?v.multiple=!0:c.size&&(v.size=c.size))):t=v.createElementNS(t,s),t[bn]=i,t[as]=c,wp(t,i,!1,!1),i.stateNode=t;e:{switch(v=Cu(s,c),s){case"dialog":Ve("cancel",t),Ve("close",t),f=c;break;case"iframe":case"object":case"embed":Ve("load",t),f=c;break;case"video":case"audio":for(f=0;f<rs.length;f++)Ve(rs[f],t);f=c;break;case"source":Ve("error",t),f=c;break;case"img":case"image":case"link":Ve("error",t),Ve("load",t),f=c;break;case"details":Ve("toggle",t),f=c;break;case"input":je(t,c),f=Ze(t,c),Ve("invalid",t);break;case"option":f=c;break;case"select":t._wrapperState={wasMultiple:!!c.multiple},f=Y({},c,{value:void 0}),Ve("invalid",t);break;case"textarea":lh(t,c),f=er(t,c),Ve("invalid",t);break;default:f=c}Eu(s,f),A=f;for(p in A)if(A.hasOwnProperty(p)){var _=A[p];p==="style"?gh(t,_):p==="dangerouslySetInnerHTML"?(_=_?_.__html:void 0,_!=null&&fh(t,_)):p==="children"?typeof _=="string"?(s!=="textarea"||_!=="")&&bo(t,_):typeof _=="number"&&bo(t,""+_):p!=="suppressContentEditableWarning"&&p!=="suppressHydrationWarning"&&p!=="autoFocus"&&(l.hasOwnProperty(p)?_!=null&&p==="onScroll"&&Ve("scroll",t):_!=null&&D(t,p,_,v))}switch(s){case"input":Le(t),an(t,c,!1);break;case"textarea":Le(t),ch(t);break;case"option":c.value!=null&&t.setAttribute("value",""+Te(c.value));break;case"select":t.multiple=!!c.multiple,p=c.value,p!=null?mi(t,!!c.multiple,p,!1):c.defaultValue!=null&&mi(t,!!c.multiple,c.defaultValue,!0);break;default:typeof f.onClick=="function"&&(t.onclick=Ma)}switch(s){case"button":case"input":case"select":case"textarea":c=!!c.autoFocus;break e;case"img":c=!0;break e;default:c=!1}}c&&(i.flags|=4)}i.ref!==null&&(i.flags|=512,i.flags|=2097152)}return kt(i),null;case 6:if(t&&i.stateNode!=null)Cp(t,i,t.memoizedProps,c);else{if(typeof c!="string"&&i.stateNode===null)throw Error(r(166));if(s=ar(fs.current),ar(Gn.current),Ga(i)){if(c=i.stateNode,s=i.memoizedProps,c[bn]=i,(p=c.nodeValue!==s)&&(t=Jt,t!==null))switch(t.tag){case 3:ka(c.nodeValue,s,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&ka(c.nodeValue,s,(t.mode&1)!==0)}p&&(i.flags|=4)}else c=(s.nodeType===9?s:s.ownerDocument).createTextNode(c),c[bn]=i,i.stateNode=c}return kt(i),null;case 13:if(Xe(it),c=i.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(Qe&&en!==null&&(i.mode&1)!==0&&(i.flags&128)===0)Pg(),Kr(),i.flags|=98560,p=!1;else if(p=Ga(i),c!==null&&c.dehydrated!==null){if(t===null){if(!p)throw Error(r(318));if(p=i.memoizedState,p=p!==null?p.dehydrated:null,!p)throw Error(r(317));p[bn]=i}else Kr(),(i.flags&128)===0&&(i.memoizedState=null),i.flags|=4;kt(i),p=!1}else wn!==null&&(td(wn),wn=null),p=!0;if(!p)return i.flags&65536?i:null}return(i.flags&128)!==0?(i.lanes=s,i):(c=c!==null,c!==(t!==null&&t.memoizedState!==null)&&c&&(i.child.flags|=8192,(i.mode&1)!==0&&(t===null||(it.current&1)!==0?gt===0&&(gt=3):rd())),i.updateQueue!==null&&(i.flags|=4),kt(i),null);case 4:return Jr(),Wc(t,i),t===null&&os(i.stateNode.containerInfo),kt(i),null;case 10:return yc(i.type._context),kt(i),null;case 17:return jt(i.type)&&Ua(),kt(i),null;case 19:if(Xe(it),p=i.memoizedState,p===null)return kt(i),null;if(c=(i.flags&128)!==0,v=p.rendering,v===null)if(c)vs(p,!1);else{if(gt!==0||t!==null&&(t.flags&128)!==0)for(t=i.child;t!==null;){if(v=ja(t),v!==null){for(i.flags|=128,vs(p,!1),c=v.updateQueue,c!==null&&(i.updateQueue=c,i.flags|=4),i.subtreeFlags=0,c=s,s=i.child;s!==null;)p=s,t=c,p.flags&=14680066,v=p.alternate,v===null?(p.childLanes=0,p.lanes=t,p.child=null,p.subtreeFlags=0,p.memoizedProps=null,p.memoizedState=null,p.updateQueue=null,p.dependencies=null,p.stateNode=null):(p.childLanes=v.childLanes,p.lanes=v.lanes,p.child=v.child,p.subtreeFlags=0,p.deletions=null,p.memoizedProps=v.memoizedProps,p.memoizedState=v.memoizedState,p.updateQueue=v.updateQueue,p.type=v.type,t=v.dependencies,p.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),s=s.sibling;return Ye(it,it.current&1|2),i.child}t=t.sibling}p.tail!==null&&st()>io&&(i.flags|=128,c=!0,vs(p,!1),i.lanes=4194304)}else{if(!c)if(t=ja(v),t!==null){if(i.flags|=128,c=!0,s=t.updateQueue,s!==null&&(i.updateQueue=s,i.flags|=4),vs(p,!0),p.tail===null&&p.tailMode==="hidden"&&!v.alternate&&!Qe)return kt(i),null}else 2*st()-p.renderingStartTime>io&&s!==1073741824&&(i.flags|=128,c=!0,vs(p,!1),i.lanes=4194304);p.isBackwards?(v.sibling=i.child,i.child=v):(s=p.last,s!==null?s.sibling=v:i.child=v,p.last=v)}return p.tail!==null?(i=p.tail,p.rendering=i,p.tail=i.sibling,p.renderingStartTime=st(),i.sibling=null,s=it.current,Ye(it,c?s&1|2:s&1),i):(kt(i),null);case 22:case 23:return id(),c=i.memoizedState!==null,t!==null&&t.memoizedState!==null!==c&&(i.flags|=8192),c&&(i.mode&1)!==0?(tn&1073741824)!==0&&(kt(i),i.subtreeFlags&6&&(i.flags|=8192)):kt(i),null;case 24:return null;case 25:return null}throw Error(r(156,i.tag))}function YS(t,i){switch(fc(i),i.tag){case 1:return jt(i.type)&&Ua(),t=i.flags,t&65536?(i.flags=t&-65537|128,i):null;case 3:return Jr(),Xe(Yt),Xe(Dt),Cc(),t=i.flags,(t&65536)!==0&&(t&128)===0?(i.flags=t&-65537|128,i):null;case 5:return wc(i),null;case 13:if(Xe(it),t=i.memoizedState,t!==null&&t.dehydrated!==null){if(i.alternate===null)throw Error(r(340));Kr()}return t=i.flags,t&65536?(i.flags=t&-65537|128,i):null;case 19:return Xe(it),null;case 4:return Jr(),null;case 10:return yc(i.type._context),null;case 22:case 23:return id(),null;case 24:return null;default:return null}}var tl=!1,Mt=!1,jS=typeof WeakSet=="function"?WeakSet:Set,Q=null;function to(t,i){var s=t.ref;if(s!==null)if(typeof s=="function")try{s(null)}catch(c){ot(t,i,c)}else s.current=null}function Yc(t,i,s){try{s()}catch(c){ot(t,i,c)}}var _p=!1;function VS(t,i){if(ic=Ta,t=rg(),Ku(t)){if("selectionStart"in t)var s={start:t.selectionStart,end:t.selectionEnd};else e:{s=(s=t.ownerDocument)&&s.defaultView||window;var c=s.getSelection&&s.getSelection();if(c&&c.rangeCount!==0){s=c.anchorNode;var f=c.anchorOffset,p=c.focusNode;c=c.focusOffset;try{s.nodeType,p.nodeType}catch{s=null;break e}var v=0,A=-1,_=-1,M=0,G=0,z=t,b=null;t:for(;;){for(var Z;z!==s||f!==0&&z.nodeType!==3||(A=v+f),z!==p||c!==0&&z.nodeType!==3||(_=v+c),z.nodeType===3&&(v+=z.nodeValue.length),(Z=z.firstChild)!==null;)b=z,z=Z;for(;;){if(z===t)break t;if(b===s&&++M===f&&(A=v),b===p&&++G===c&&(_=v),(Z=z.nextSibling)!==null)break;z=b,b=z.parentNode}z=Z}s=A===-1||_===-1?null:{start:A,end:_}}else s=null}s=s||{start:0,end:0}}else s=null;for(rc={focusedElem:t,selectionRange:s},Ta=!1,Q=i;Q!==null;)if(i=Q,t=i.child,(i.subtreeFlags&1028)!==0&&t!==null)t.return=i,Q=t;else for(;Q!==null;){i=Q;try{var ee=i.alternate;if((i.flags&1024)!==0)switch(i.tag){case 0:case 11:case 15:break;case 1:if(ee!==null){var oe=ee.memoizedProps,at=ee.memoizedState,O=i.stateNode,P=O.getSnapshotBeforeUpdate(i.elementType===i.type?oe:En(i.type,oe),at);O.__reactInternalSnapshotBeforeUpdate=P}break;case 3:var k=i.stateNode.containerInfo;k.nodeType===1?k.textContent="":k.nodeType===9&&k.documentElement&&k.removeChild(k.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(r(163))}}catch(j){ot(i,i.return,j)}if(t=i.sibling,t!==null){t.return=i.return,Q=t;break}Q=i.return}return ee=_p,_p=!1,ee}function ys(t,i,s){var c=i.updateQueue;if(c=c!==null?c.lastEffect:null,c!==null){var f=c=c.next;do{if((f.tag&t)===t){var p=f.destroy;f.destroy=void 0,p!==void 0&&Yc(i,s,p)}f=f.next}while(f!==c)}}function nl(t,i){if(i=i.updateQueue,i=i!==null?i.lastEffect:null,i!==null){var s=i=i.next;do{if((s.tag&t)===t){var c=s.create;s.destroy=c()}s=s.next}while(s!==i)}}function jc(t){var i=t.ref;if(i!==null){var s=t.stateNode;switch(t.tag){case 5:t=s;break;default:t=s}typeof i=="function"?i(t):i.current=t}}function Rp(t){var i=t.alternate;i!==null&&(t.alternate=null,Rp(i)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(i=t.stateNode,i!==null&&(delete i[bn],delete i[as],delete i[lc],delete i[NS],delete i[DS])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function Pp(t){return t.tag===5||t.tag===3||t.tag===4}function Np(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||Pp(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function Vc(t,i,s){var c=t.tag;if(c===5||c===6)t=t.stateNode,i?s.nodeType===8?s.parentNode.insertBefore(t,i):s.insertBefore(t,i):(s.nodeType===8?(i=s.parentNode,i.insertBefore(t,s)):(i=s,i.appendChild(t)),s=s._reactRootContainer,s!=null||i.onclick!==null||(i.onclick=Ma));else if(c!==4&&(t=t.child,t!==null))for(Vc(t,i,s),t=t.sibling;t!==null;)Vc(t,i,s),t=t.sibling}function Xc(t,i,s){var c=t.tag;if(c===5||c===6)t=t.stateNode,i?s.insertBefore(t,i):s.appendChild(t);else if(c!==4&&(t=t.child,t!==null))for(Xc(t,i,s),t=t.sibling;t!==null;)Xc(t,i,s),t=t.sibling}var Ct=null,Cn=!1;function Ni(t,i,s){for(s=s.child;s!==null;)Dp(t,i,s),s=s.sibling}function Dp(t,i,s){if(Hn&&typeof Hn.onCommitFiberUnmount=="function")try{Hn.onCommitFiberUnmount(pa,s)}catch{}switch(s.tag){case 5:Mt||to(s,i);case 6:var c=Ct,f=Cn;Ct=null,Ni(t,i,s),Ct=c,Cn=f,Ct!==null&&(Cn?(t=Ct,s=s.stateNode,t.nodeType===8?t.parentNode.removeChild(s):t.removeChild(s)):Ct.removeChild(s.stateNode));break;case 18:Ct!==null&&(Cn?(t=Ct,s=s.stateNode,t.nodeType===8?ac(t.parentNode,s):t.nodeType===1&&ac(t,s),qo(t)):ac(Ct,s.stateNode));break;case 4:c=Ct,f=Cn,Ct=s.stateNode.containerInfo,Cn=!0,Ni(t,i,s),Ct=c,Cn=f;break;case 0:case 11:case 14:case 15:if(!Mt&&(c=s.updateQueue,c!==null&&(c=c.lastEffect,c!==null))){f=c=c.next;do{var p=f,v=p.destroy;p=p.tag,v!==void 0&&((p&2)!==0||(p&4)!==0)&&Yc(s,i,v),f=f.next}while(f!==c)}Ni(t,i,s);break;case 1:if(!Mt&&(to(s,i),c=s.stateNode,typeof c.componentWillUnmount=="function"))try{c.props=s.memoizedProps,c.state=s.memoizedState,c.componentWillUnmount()}catch(A){ot(s,i,A)}Ni(t,i,s);break;case 21:Ni(t,i,s);break;case 22:s.mode&1?(Mt=(c=Mt)||s.memoizedState!==null,Ni(t,i,s),Mt=c):Ni(t,i,s);break;default:Ni(t,i,s)}}function Op(t){var i=t.updateQueue;if(i!==null){t.updateQueue=null;var s=t.stateNode;s===null&&(s=t.stateNode=new jS),i.forEach(function(c){var f=nA.bind(null,t,c);s.has(c)||(s.add(c),c.then(f,f))})}}function _n(t,i){var s=i.deletions;if(s!==null)for(var c=0;c<s.length;c++){var f=s[c];try{var p=t,v=i,A=v;e:for(;A!==null;){switch(A.tag){case 5:Ct=A.stateNode,Cn=!1;break e;case 3:Ct=A.stateNode.containerInfo,Cn=!0;break e;case 4:Ct=A.stateNode.containerInfo,Cn=!0;break e}A=A.return}if(Ct===null)throw Error(r(160));Dp(p,v,f),Ct=null,Cn=!1;var _=f.alternate;_!==null&&(_.return=null),f.return=null}catch(M){ot(f,i,M)}}if(i.subtreeFlags&12854)for(i=i.child;i!==null;)kp(i,t),i=i.sibling}function kp(t,i){var s=t.alternate,c=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(_n(i,t),$n(t),c&4){try{ys(3,t,t.return),nl(3,t)}catch(oe){ot(t,t.return,oe)}try{ys(5,t,t.return)}catch(oe){ot(t,t.return,oe)}}break;case 1:_n(i,t),$n(t),c&512&&s!==null&&to(s,s.return);break;case 5:if(_n(i,t),$n(t),c&512&&s!==null&&to(s,s.return),t.flags&32){var f=t.stateNode;try{bo(f,"")}catch(oe){ot(t,t.return,oe)}}if(c&4&&(f=t.stateNode,f!=null)){var p=t.memoizedProps,v=s!==null?s.memoizedProps:p,A=t.type,_=t.updateQueue;if(t.updateQueue=null,_!==null)try{A==="input"&&p.type==="radio"&&p.name!=null&&Un(f,p),Cu(A,v);var M=Cu(A,p);for(v=0;v<_.length;v+=2){var G=_[v],z=_[v+1];G==="style"?gh(f,z):G==="dangerouslySetInnerHTML"?fh(f,z):G==="children"?bo(f,z):D(f,G,z,M)}switch(A){case"input":Wt(f,p);break;case"textarea":uh(f,p);break;case"select":var b=f._wrapperState.wasMultiple;f._wrapperState.wasMultiple=!!p.multiple;var Z=p.value;Z!=null?mi(f,!!p.multiple,Z,!1):b!==!!p.multiple&&(p.defaultValue!=null?mi(f,!!p.multiple,p.defaultValue,!0):mi(f,!!p.multiple,p.multiple?[]:"",!1))}f[as]=p}catch(oe){ot(t,t.return,oe)}}break;case 6:if(_n(i,t),$n(t),c&4){if(t.stateNode===null)throw Error(r(162));f=t.stateNode,p=t.memoizedProps;try{f.nodeValue=p}catch(oe){ot(t,t.return,oe)}}break;case 3:if(_n(i,t),$n(t),c&4&&s!==null&&s.memoizedState.isDehydrated)try{qo(i.containerInfo)}catch(oe){ot(t,t.return,oe)}break;case 4:_n(i,t),$n(t);break;case 13:_n(i,t),$n(t),f=t.child,f.flags&8192&&(p=f.memoizedState!==null,f.stateNode.isHidden=p,!p||f.alternate!==null&&f.alternate.memoizedState!==null||(Zc=st())),c&4&&Op(t);break;case 22:if(G=s!==null&&s.memoizedState!==null,t.mode&1?(Mt=(M=Mt)||G,_n(i,t),Mt=M):_n(i,t),$n(t),c&8192){if(M=t.memoizedState!==null,(t.stateNode.isHidden=M)&&!G&&(t.mode&1)!==0)for(Q=t,G=t.child;G!==null;){for(z=Q=G;Q!==null;){switch(b=Q,Z=b.child,b.tag){case 0:case 11:case 14:case 15:ys(4,b,b.return);break;case 1:to(b,b.return);var ee=b.stateNode;if(typeof ee.componentWillUnmount=="function"){c=b,s=b.return;try{i=c,ee.props=i.memoizedProps,ee.state=i.memoizedState,ee.componentWillUnmount()}catch(oe){ot(c,s,oe)}}break;case 5:to(b,b.return);break;case 22:if(b.memoizedState!==null){Up(z);continue}}Z!==null?(Z.return=b,Q=Z):Up(z)}G=G.sibling}e:for(G=null,z=t;;){if(z.tag===5){if(G===null){G=z;try{f=z.stateNode,M?(p=f.style,typeof p.setProperty=="function"?p.setProperty("display","none","important"):p.display="none"):(A=z.stateNode,_=z.memoizedProps.style,v=_!=null&&_.hasOwnProperty("display")?_.display:null,A.style.display=hh("display",v))}catch(oe){ot(t,t.return,oe)}}}else if(z.tag===6){if(G===null)try{z.stateNode.nodeValue=M?"":z.memoizedProps}catch(oe){ot(t,t.return,oe)}}else if((z.tag!==22&&z.tag!==23||z.memoizedState===null||z===t)&&z.child!==null){z.child.return=z,z=z.child;continue}if(z===t)break e;for(;z.sibling===null;){if(z.return===null||z.return===t)break e;G===z&&(G=null),z=z.return}G===z&&(G=null),z.sibling.return=z.return,z=z.sibling}}break;case 19:_n(i,t),$n(t),c&4&&Op(t);break;case 21:break;default:_n(i,t),$n(t)}}function $n(t){var i=t.flags;if(i&2){try{e:{for(var s=t.return;s!==null;){if(Pp(s)){var c=s;break e}s=s.return}throw Error(r(160))}switch(c.tag){case 5:var f=c.stateNode;c.flags&32&&(bo(f,""),c.flags&=-33);var p=Np(t);Xc(t,p,f);break;case 3:case 4:var v=c.stateNode.containerInfo,A=Np(t);Vc(t,A,v);break;default:throw Error(r(161))}}catch(_){ot(t,t.return,_)}t.flags&=-3}i&4096&&(t.flags&=-4097)}function XS(t,i,s){Q=t,Mp(t)}function Mp(t,i,s){for(var c=(t.mode&1)!==0;Q!==null;){var f=Q,p=f.child;if(f.tag===22&&c){var v=f.memoizedState!==null||tl;if(!v){var A=f.alternate,_=A!==null&&A.memoizedState!==null||Mt;A=tl;var M=Mt;if(tl=v,(Mt=_)&&!M)for(Q=f;Q!==null;)v=Q,_=v.child,v.tag===22&&v.memoizedState!==null?Lp(f):_!==null?(_.return=v,Q=_):Lp(f);for(;p!==null;)Q=p,Mp(p),p=p.sibling;Q=f,tl=A,Mt=M}Fp(t)}else(f.subtreeFlags&8772)!==0&&p!==null?(p.return=f,Q=p):Fp(t)}}function Fp(t){for(;Q!==null;){var i=Q;if((i.flags&8772)!==0){var s=i.alternate;try{if((i.flags&8772)!==0)switch(i.tag){case 0:case 11:case 15:Mt||nl(5,i);break;case 1:var c=i.stateNode;if(i.flags&4&&!Mt)if(s===null)c.componentDidMount();else{var f=i.elementType===i.type?s.memoizedProps:En(i.type,s.memoizedProps);c.componentDidUpdate(f,s.memoizedState,c.__reactInternalSnapshotBeforeUpdate)}var p=i.updateQueue;p!==null&&Ug(i,p,c);break;case 3:var v=i.updateQueue;if(v!==null){if(s=null,i.child!==null)switch(i.child.tag){case 5:s=i.child.stateNode;break;case 1:s=i.child.stateNode}Ug(i,v,s)}break;case 5:var A=i.stateNode;if(s===null&&i.flags&4){s=A;var _=i.memoizedProps;switch(i.type){case"button":case"input":case"select":case"textarea":_.autoFocus&&s.focus();break;case"img":_.src&&(s.src=_.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(i.memoizedState===null){var M=i.alternate;if(M!==null){var G=M.memoizedState;if(G!==null){var z=G.dehydrated;z!==null&&qo(z)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(r(163))}Mt||i.flags&512&&jc(i)}catch(b){ot(i,i.return,b)}}if(i===t){Q=null;break}if(s=i.sibling,s!==null){s.return=i.return,Q=s;break}Q=i.return}}function Up(t){for(;Q!==null;){var i=Q;if(i===t){Q=null;break}var s=i.sibling;if(s!==null){s.return=i.return,Q=s;break}Q=i.return}}function Lp(t){for(;Q!==null;){var i=Q;try{switch(i.tag){case 0:case 11:case 15:var s=i.return;try{nl(4,i)}catch(_){ot(i,s,_)}break;case 1:var c=i.stateNode;if(typeof c.componentDidMount=="function"){var f=i.return;try{c.componentDidMount()}catch(_){ot(i,f,_)}}var p=i.return;try{jc(i)}catch(_){ot(i,p,_)}break;case 5:var v=i.return;try{jc(i)}catch(_){ot(i,v,_)}}}catch(_){ot(i,i.return,_)}if(i===t){Q=null;break}var A=i.sibling;if(A!==null){A.return=i.return,Q=A;break}Q=i.return}}var KS=Math.ceil,il=H.ReactCurrentDispatcher,Kc=H.ReactCurrentOwner,fn=H.ReactCurrentBatchConfig,He=0,mt=null,ct=null,_t=0,tn=0,no=Ei(0),gt=0,Ss=null,ur=0,rl=0,qc=0,As=null,Xt=null,Zc=0,io=1/0,oi=null,ol=!1,Qc=null,Di=null,sl=!1,Oi=null,al=0,Ts=0,Jc=null,ll=-1,ul=0;function Ht(){return(He&6)!==0?st():ll!==-1?ll:ll=st()}function ki(t){return(t.mode&1)===0?1:(He&2)!==0&&_t!==0?_t&-_t:kS.transition!==null?(ul===0&&(ul=Nh()),ul):(t=We,t!==0||(t=window.event,t=t===void 0?16:Hh(t.type)),t)}function Rn(t,i,s,c){if(50<Ts)throw Ts=0,Jc=null,Error(r(185));Yo(t,s,c),((He&2)===0||t!==mt)&&(t===mt&&((He&2)===0&&(rl|=s),gt===4&&Mi(t,_t)),Kt(t,c),s===1&&He===0&&(i.mode&1)===0&&(io=st()+500,Ba&&_i()))}function Kt(t,i){var s=t.callbackNode;ky(t,i);var c=ya(t,t===mt?_t:0);if(c===0)s!==null&&_h(s),t.callbackNode=null,t.callbackPriority=0;else if(i=c&-c,t.callbackPriority!==i){if(s!=null&&_h(s),i===1)t.tag===0?OS(Hp.bind(null,t)):wg(Hp.bind(null,t)),RS(function(){(He&6)===0&&_i()}),s=null;else{switch(Dh(c)){case 1:s=ku;break;case 4:s=Rh;break;case 16:s=ga;break;case 536870912:s=Ph;break;default:s=ga}s=jp(s,Bp.bind(null,t))}t.callbackPriority=i,t.callbackNode=s}}function Bp(t,i){if(ll=-1,ul=0,(He&6)!==0)throw Error(r(327));var s=t.callbackNode;if(ro()&&t.callbackNode!==s)return null;var c=ya(t,t===mt?_t:0);if(c===0)return null;if((c&30)!==0||(c&t.expiredLanes)!==0||i)i=cl(t,c);else{i=c;var f=He;He|=2;var p=Gp();(mt!==t||_t!==i)&&(oi=null,io=st()+500,dr(t,i));do try{QS();break}catch(A){bp(t,A)}while(!0);vc(),il.current=p,He=f,ct!==null?i=0:(mt=null,_t=0,i=gt)}if(i!==0){if(i===2&&(f=Mu(t),f!==0&&(c=f,i=ed(t,f))),i===1)throw s=Ss,dr(t,0),Mi(t,c),Kt(t,st()),s;if(i===6)Mi(t,c);else{if(f=t.current.alternate,(c&30)===0&&!qS(f)&&(i=cl(t,c),i===2&&(p=Mu(t),p!==0&&(c=p,i=ed(t,p))),i===1))throw s=Ss,dr(t,0),Mi(t,c),Kt(t,st()),s;switch(t.finishedWork=f,t.finishedLanes=c,i){case 0:case 1:throw Error(r(345));case 2:fr(t,Xt,oi);break;case 3:if(Mi(t,c),(c&130023424)===c&&(i=Zc+500-st(),10<i)){if(ya(t,0)!==0)break;if(f=t.suspendedLanes,(f&c)!==c){Ht(),t.pingedLanes|=t.suspendedLanes&f;break}t.timeoutHandle=sc(fr.bind(null,t,Xt,oi),i);break}fr(t,Xt,oi);break;case 4:if(Mi(t,c),(c&4194240)===c)break;for(i=t.eventTimes,f=-1;0<c;){var v=31-Tn(c);p=1<<v,v=i[v],v>f&&(f=v),c&=~p}if(c=f,c=st()-c,c=(120>c?120:480>c?480:1080>c?1080:1920>c?1920:3e3>c?3e3:4320>c?4320:1960*KS(c/1960))-c,10<c){t.timeoutHandle=sc(fr.bind(null,t,Xt,oi),c);break}fr(t,Xt,oi);break;case 5:fr(t,Xt,oi);break;default:throw Error(r(329))}}}return Kt(t,st()),t.callbackNode===s?Bp.bind(null,t):null}function ed(t,i){var s=As;return t.current.memoizedState.isDehydrated&&(dr(t,i).flags|=256),t=cl(t,i),t!==2&&(i=Xt,Xt=s,i!==null&&td(i)),t}function td(t){Xt===null?Xt=t:Xt.push.apply(Xt,t)}function qS(t){for(var i=t;;){if(i.flags&16384){var s=i.updateQueue;if(s!==null&&(s=s.stores,s!==null))for(var c=0;c<s.length;c++){var f=s[c],p=f.getSnapshot;f=f.value;try{if(!In(p(),f))return!1}catch{return!1}}}if(s=i.child,i.subtreeFlags&16384&&s!==null)s.return=i,i=s;else{if(i===t)break;for(;i.sibling===null;){if(i.return===null||i.return===t)return!0;i=i.return}i.sibling.return=i.return,i=i.sibling}}return!0}function Mi(t,i){for(i&=~qc,i&=~rl,t.suspendedLanes|=i,t.pingedLanes&=~i,t=t.expirationTimes;0<i;){var s=31-Tn(i),c=1<<s;t[s]=-1,i&=~c}}function Hp(t){if((He&6)!==0)throw Error(r(327));ro();var i=ya(t,0);if((i&1)===0)return Kt(t,st()),null;var s=cl(t,i);if(t.tag!==0&&s===2){var c=Mu(t);c!==0&&(i=c,s=ed(t,c))}if(s===1)throw s=Ss,dr(t,0),Mi(t,i),Kt(t,st()),s;if(s===6)throw Error(r(345));return t.finishedWork=t.current.alternate,t.finishedLanes=i,fr(t,Xt,oi),Kt(t,st()),null}function nd(t,i){var s=He;He|=1;try{return t(i)}finally{He=s,He===0&&(io=st()+500,Ba&&_i())}}function cr(t){Oi!==null&&Oi.tag===0&&(He&6)===0&&ro();var i=He;He|=1;var s=fn.transition,c=We;try{if(fn.transition=null,We=1,t)return t()}finally{We=c,fn.transition=s,He=i,(He&6)===0&&_i()}}function id(){tn=no.current,Xe(no)}function dr(t,i){t.finishedWork=null,t.finishedLanes=0;var s=t.timeoutHandle;if(s!==-1&&(t.timeoutHandle=-1,_S(s)),ct!==null)for(s=ct.return;s!==null;){var c=s;switch(fc(c),c.tag){case 1:c=c.type.childContextTypes,c!=null&&Ua();break;case 3:Jr(),Xe(Yt),Xe(Dt),Cc();break;case 5:wc(c);break;case 4:Jr();break;case 13:Xe(it);break;case 19:Xe(it);break;case 10:yc(c.type._context);break;case 22:case 23:id()}s=s.return}if(mt=t,ct=t=Fi(t.current,null),_t=tn=i,gt=0,Ss=null,qc=rl=ur=0,Xt=As=null,sr!==null){for(i=0;i<sr.length;i++)if(s=sr[i],c=s.interleaved,c!==null){s.interleaved=null;var f=c.next,p=s.pending;if(p!==null){var v=p.next;p.next=f,c.next=v}s.pending=c}sr=null}return t}function bp(t,i){do{var s=ct;try{if(vc(),Va.current=Za,Xa){for(var c=rt.memoizedState;c!==null;){var f=c.queue;f!==null&&(f.pending=null),c=c.next}Xa=!1}if(lr=0,pt=ht=rt=null,hs=!1,gs=0,Kc.current=null,s===null||s.return===null){gt=1,Ss=i,ct=null;break}e:{var p=t,v=s.return,A=s,_=i;if(i=_t,A.flags|=32768,_!==null&&typeof _=="object"&&typeof _.then=="function"){var M=_,G=A,z=G.tag;if((G.mode&1)===0&&(z===0||z===11||z===15)){var b=G.alternate;b?(G.updateQueue=b.updateQueue,G.memoizedState=b.memoizedState,G.lanes=b.lanes):(G.updateQueue=null,G.memoizedState=null)}var Z=cp(v);if(Z!==null){Z.flags&=-257,dp(Z,v,A,p,i),Z.mode&1&&up(p,M,i),i=Z,_=M;var ee=i.updateQueue;if(ee===null){var oe=new Set;oe.add(_),i.updateQueue=oe}else ee.add(_);break e}else{if((i&1)===0){up(p,M,i),rd();break e}_=Error(r(426))}}else if(Qe&&A.mode&1){var at=cp(v);if(at!==null){(at.flags&65536)===0&&(at.flags|=256),dp(at,v,A,p,i),pc(eo(_,A));break e}}p=_=eo(_,A),gt!==4&&(gt=2),As===null?As=[p]:As.push(p),p=v;do{switch(p.tag){case 3:p.flags|=65536,i&=-i,p.lanes|=i;var O=ap(p,_,i);Fg(p,O);break e;case 1:A=_;var P=p.type,k=p.stateNode;if((p.flags&128)===0&&(typeof P.getDerivedStateFromError=="function"||k!==null&&typeof k.componentDidCatch=="function"&&(Di===null||!Di.has(k)))){p.flags|=65536,i&=-i,p.lanes|=i;var j=lp(p,A,i);Fg(p,j);break e}}p=p.return}while(p!==null)}$p(s)}catch(ae){i=ae,ct===s&&s!==null&&(ct=s=s.return);continue}break}while(!0)}function Gp(){var t=il.current;return il.current=Za,t===null?Za:t}function rd(){(gt===0||gt===3||gt===2)&&(gt=4),mt===null||(ur&268435455)===0&&(rl&268435455)===0||Mi(mt,_t)}function cl(t,i){var s=He;He|=2;var c=Gp();(mt!==t||_t!==i)&&(oi=null,dr(t,i));do try{ZS();break}catch(f){bp(t,f)}while(!0);if(vc(),He=s,il.current=c,ct!==null)throw Error(r(261));return mt=null,_t=0,gt}function ZS(){for(;ct!==null;)xp(ct)}function QS(){for(;ct!==null&&!wy();)xp(ct)}function xp(t){var i=Yp(t.alternate,t,tn);t.memoizedProps=t.pendingProps,i===null?$p(t):ct=i,Kc.current=null}function $p(t){var i=t;do{var s=i.alternate;if(t=i.return,(i.flags&32768)===0){if(s=WS(s,i,tn),s!==null){ct=s;return}}else{if(s=YS(s,i),s!==null){s.flags&=32767,ct=s;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{gt=6,ct=null;return}}if(i=i.sibling,i!==null){ct=i;return}ct=i=t}while(i!==null);gt===0&&(gt=5)}function fr(t,i,s){var c=We,f=fn.transition;try{fn.transition=null,We=1,JS(t,i,s,c)}finally{fn.transition=f,We=c}return null}function JS(t,i,s,c){do ro();while(Oi!==null);if((He&6)!==0)throw Error(r(327));s=t.finishedWork;var f=t.finishedLanes;if(s===null)return null;if(t.finishedWork=null,t.finishedLanes=0,s===t.current)throw Error(r(177));t.callbackNode=null,t.callbackPriority=0;var p=s.lanes|s.childLanes;if(My(t,p),t===mt&&(ct=mt=null,_t=0),(s.subtreeFlags&2064)===0&&(s.flags&2064)===0||sl||(sl=!0,jp(ga,function(){return ro(),null})),p=(s.flags&15990)!==0,(s.subtreeFlags&15990)!==0||p){p=fn.transition,fn.transition=null;var v=We;We=1;var A=He;He|=4,Kc.current=null,VS(t,s),kp(s,t),SS(rc),Ta=!!ic,rc=ic=null,t.current=s,XS(s),Ey(),He=A,We=v,fn.transition=p}else t.current=s;if(sl&&(sl=!1,Oi=t,al=f),p=t.pendingLanes,p===0&&(Di=null),Ry(s.stateNode),Kt(t,st()),i!==null)for(c=t.onRecoverableError,s=0;s<i.length;s++)f=i[s],c(f.value,{componentStack:f.stack,digest:f.digest});if(ol)throw ol=!1,t=Qc,Qc=null,t;return(al&1)!==0&&t.tag!==0&&ro(),p=t.pendingLanes,(p&1)!==0?t===Jc?Ts++:(Ts=0,Jc=t):Ts=0,_i(),null}function ro(){if(Oi!==null){var t=Dh(al),i=fn.transition,s=We;try{if(fn.transition=null,We=16>t?16:t,Oi===null)var c=!1;else{if(t=Oi,Oi=null,al=0,(He&6)!==0)throw Error(r(331));var f=He;for(He|=4,Q=t.current;Q!==null;){var p=Q,v=p.child;if((Q.flags&16)!==0){var A=p.deletions;if(A!==null){for(var _=0;_<A.length;_++){var M=A[_];for(Q=M;Q!==null;){var G=Q;switch(G.tag){case 0:case 11:case 15:ys(8,G,p)}var z=G.child;if(z!==null)z.return=G,Q=z;else for(;Q!==null;){G=Q;var b=G.sibling,Z=G.return;if(Rp(G),G===M){Q=null;break}if(b!==null){b.return=Z,Q=b;break}Q=Z}}}var ee=p.alternate;if(ee!==null){var oe=ee.child;if(oe!==null){ee.child=null;do{var at=oe.sibling;oe.sibling=null,oe=at}while(oe!==null)}}Q=p}}if((p.subtreeFlags&2064)!==0&&v!==null)v.return=p,Q=v;else e:for(;Q!==null;){if(p=Q,(p.flags&2048)!==0)switch(p.tag){case 0:case 11:case 15:ys(9,p,p.return)}var O=p.sibling;if(O!==null){O.return=p.return,Q=O;break e}Q=p.return}}var P=t.current;for(Q=P;Q!==null;){v=Q;var k=v.child;if((v.subtreeFlags&2064)!==0&&k!==null)k.return=v,Q=k;else e:for(v=P;Q!==null;){if(A=Q,(A.flags&2048)!==0)try{switch(A.tag){case 0:case 11:case 15:nl(9,A)}}catch(ae){ot(A,A.return,ae)}if(A===v){Q=null;break e}var j=A.sibling;if(j!==null){j.return=A.return,Q=j;break e}Q=A.return}}if(He=f,_i(),Hn&&typeof Hn.onPostCommitFiberRoot=="function")try{Hn.onPostCommitFiberRoot(pa,t)}catch{}c=!0}return c}finally{We=s,fn.transition=i}}return!1}function zp(t,i,s){i=eo(s,i),i=ap(t,i,1),t=Pi(t,i,1),i=Ht(),t!==null&&(Yo(t,1,i),Kt(t,i))}function ot(t,i,s){if(t.tag===3)zp(t,t,s);else for(;i!==null;){if(i.tag===3){zp(i,t,s);break}else if(i.tag===1){var c=i.stateNode;if(typeof i.type.getDerivedStateFromError=="function"||typeof c.componentDidCatch=="function"&&(Di===null||!Di.has(c))){t=eo(s,t),t=lp(i,t,1),i=Pi(i,t,1),t=Ht(),i!==null&&(Yo(i,1,t),Kt(i,t));break}}i=i.return}}function eA(t,i,s){var c=t.pingCache;c!==null&&c.delete(i),i=Ht(),t.pingedLanes|=t.suspendedLanes&s,mt===t&&(_t&s)===s&&(gt===4||gt===3&&(_t&130023424)===_t&&500>st()-Zc?dr(t,0):qc|=s),Kt(t,i)}function Wp(t,i){i===0&&((t.mode&1)===0?i=1:(i=va,va<<=1,(va&130023424)===0&&(va=4194304)));var s=Ht();t=ni(t,i),t!==null&&(Yo(t,i,s),Kt(t,s))}function tA(t){var i=t.memoizedState,s=0;i!==null&&(s=i.retryLane),Wp(t,s)}function nA(t,i){var s=0;switch(t.tag){case 13:var c=t.stateNode,f=t.memoizedState;f!==null&&(s=f.retryLane);break;case 19:c=t.stateNode;break;default:throw Error(r(314))}c!==null&&c.delete(i),Wp(t,s)}var Yp;Yp=function(t,i,s){if(t!==null)if(t.memoizedProps!==i.pendingProps||Yt.current)Vt=!0;else{if((t.lanes&s)===0&&(i.flags&128)===0)return Vt=!1,zS(t,i,s);Vt=(t.flags&131072)!==0}else Vt=!1,Qe&&(i.flags&1048576)!==0&&Eg(i,ba,i.index);switch(i.lanes=0,i.tag){case 2:var c=i.type;el(t,i),t=i.pendingProps;var f=jr(i,Dt.current);Qr(i,s),f=Pc(null,i,c,t,f,s);var p=Nc();return i.flags|=1,typeof f=="object"&&f!==null&&typeof f.render=="function"&&f.$$typeof===void 0?(i.tag=1,i.memoizedState=null,i.updateQueue=null,jt(c)?(p=!0,La(i)):p=!1,i.memoizedState=f.state!==null&&f.state!==void 0?f.state:null,Tc(i),f.updater=Qa,i.stateNode=f,f._reactInternals=i,Uc(i,c,t,s),i=bc(null,i,c,!0,p,s)):(i.tag=0,Qe&&p&&dc(i),Bt(null,i,f,s),i=i.child),i;case 16:c=i.elementType;e:{switch(el(t,i),t=i.pendingProps,f=c._init,c=f(c._payload),i.type=c,f=i.tag=rA(c),t=En(c,t),f){case 0:i=Hc(null,i,c,t,s);break e;case 1:i=vp(null,i,c,t,s);break e;case 11:i=fp(null,i,c,t,s);break e;case 14:i=hp(null,i,c,En(c.type,t),s);break e}throw Error(r(306,c,""))}return i;case 0:return c=i.type,f=i.pendingProps,f=i.elementType===c?f:En(c,f),Hc(t,i,c,f,s);case 1:return c=i.type,f=i.pendingProps,f=i.elementType===c?f:En(c,f),vp(t,i,c,f,s);case 3:e:{if(yp(i),t===null)throw Error(r(387));c=i.pendingProps,p=i.memoizedState,f=p.element,Mg(t,i),Ya(i,c,null,s);var v=i.memoizedState;if(c=v.element,p.isDehydrated)if(p={element:c,isDehydrated:!1,cache:v.cache,pendingSuspenseBoundaries:v.pendingSuspenseBoundaries,transitions:v.transitions},i.updateQueue.baseState=p,i.memoizedState=p,i.flags&256){f=eo(Error(r(423)),i),i=Sp(t,i,c,s,f);break e}else if(c!==f){f=eo(Error(r(424)),i),i=Sp(t,i,c,s,f);break e}else for(en=wi(i.stateNode.containerInfo.firstChild),Jt=i,Qe=!0,wn=null,s=Og(i,null,c,s),i.child=s;s;)s.flags=s.flags&-3|4096,s=s.sibling;else{if(Kr(),c===f){i=ri(t,i,s);break e}Bt(t,i,c,s)}i=i.child}return i;case 5:return Lg(i),t===null&&gc(i),c=i.type,f=i.pendingProps,p=t!==null?t.memoizedProps:null,v=f.children,oc(c,f)?v=null:p!==null&&oc(c,p)&&(i.flags|=32),mp(t,i),Bt(t,i,v,s),i.child;case 6:return t===null&&gc(i),null;case 13:return Ap(t,i,s);case 4:return Ic(i,i.stateNode.containerInfo),c=i.pendingProps,t===null?i.child=qr(i,null,c,s):Bt(t,i,c,s),i.child;case 11:return c=i.type,f=i.pendingProps,f=i.elementType===c?f:En(c,f),fp(t,i,c,f,s);case 7:return Bt(t,i,i.pendingProps,s),i.child;case 8:return Bt(t,i,i.pendingProps.children,s),i.child;case 12:return Bt(t,i,i.pendingProps.children,s),i.child;case 10:e:{if(c=i.type._context,f=i.pendingProps,p=i.memoizedProps,v=f.value,Ye($a,c._currentValue),c._currentValue=v,p!==null)if(In(p.value,v)){if(p.children===f.children&&!Yt.current){i=ri(t,i,s);break e}}else for(p=i.child,p!==null&&(p.return=i);p!==null;){var A=p.dependencies;if(A!==null){v=p.child;for(var _=A.firstContext;_!==null;){if(_.context===c){if(p.tag===1){_=ii(-1,s&-s),_.tag=2;var M=p.updateQueue;if(M!==null){M=M.shared;var G=M.pending;G===null?_.next=_:(_.next=G.next,G.next=_),M.pending=_}}p.lanes|=s,_=p.alternate,_!==null&&(_.lanes|=s),Sc(p.return,s,i),A.lanes|=s;break}_=_.next}}else if(p.tag===10)v=p.type===i.type?null:p.child;else if(p.tag===18){if(v=p.return,v===null)throw Error(r(341));v.lanes|=s,A=v.alternate,A!==null&&(A.lanes|=s),Sc(v,s,i),v=p.sibling}else v=p.child;if(v!==null)v.return=p;else for(v=p;v!==null;){if(v===i){v=null;break}if(p=v.sibling,p!==null){p.return=v.return,v=p;break}v=v.return}p=v}Bt(t,i,f.children,s),i=i.child}return i;case 9:return f=i.type,c=i.pendingProps.children,Qr(i,s),f=cn(f),c=c(f),i.flags|=1,Bt(t,i,c,s),i.child;case 14:return c=i.type,f=En(c,i.pendingProps),f=En(c.type,f),hp(t,i,c,f,s);case 15:return gp(t,i,i.type,i.pendingProps,s);case 17:return c=i.type,f=i.pendingProps,f=i.elementType===c?f:En(c,f),el(t,i),i.tag=1,jt(c)?(t=!0,La(i)):t=!1,Qr(i,s),op(i,c,f),Uc(i,c,f,s),bc(null,i,c,!0,t,s);case 19:return Ip(t,i,s);case 22:return pp(t,i,s)}throw Error(r(156,i.tag))};function jp(t,i){return Ch(t,i)}function iA(t,i,s,c){this.tag=t,this.key=s,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=i,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=c,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function hn(t,i,s,c){return new iA(t,i,s,c)}function od(t){return t=t.prototype,!(!t||!t.isReactComponent)}function rA(t){if(typeof t=="function")return od(t)?1:0;if(t!=null){if(t=t.$$typeof,t===Ne)return 11;if(t===Ue)return 14}return 2}function Fi(t,i){var s=t.alternate;return s===null?(s=hn(t.tag,i,t.key,t.mode),s.elementType=t.elementType,s.type=t.type,s.stateNode=t.stateNode,s.alternate=t,t.alternate=s):(s.pendingProps=i,s.type=t.type,s.flags=0,s.subtreeFlags=0,s.deletions=null),s.flags=t.flags&14680064,s.childLanes=t.childLanes,s.lanes=t.lanes,s.child=t.child,s.memoizedProps=t.memoizedProps,s.memoizedState=t.memoizedState,s.updateQueue=t.updateQueue,i=t.dependencies,s.dependencies=i===null?null:{lanes:i.lanes,firstContext:i.firstContext},s.sibling=t.sibling,s.index=t.index,s.ref=t.ref,s}function dl(t,i,s,c,f,p){var v=2;if(c=t,typeof t=="function")od(t)&&(v=1);else if(typeof t=="string")v=5;else e:switch(t){case $:return hr(s.children,f,p,i);case J:v=8,f|=8;break;case Ce:return t=hn(12,s,i,f|2),t.elementType=Ce,t.lanes=p,t;case Pe:return t=hn(13,s,i,f),t.elementType=Pe,t.lanes=p,t;case de:return t=hn(19,s,i,f),t.elementType=de,t.lanes=p,t;case ne:return fl(s,f,p,i);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case _e:v=10;break e;case Ge:v=9;break e;case Ne:v=11;break e;case Ue:v=14;break e;case Ae:v=16,c=null;break e}throw Error(r(130,t==null?t:typeof t,""))}return i=hn(v,s,i,f),i.elementType=t,i.type=c,i.lanes=p,i}function hr(t,i,s,c){return t=hn(7,t,c,i),t.lanes=s,t}function fl(t,i,s,c){return t=hn(22,t,c,i),t.elementType=ne,t.lanes=s,t.stateNode={isHidden:!1},t}function sd(t,i,s){return t=hn(6,t,null,i),t.lanes=s,t}function ad(t,i,s){return i=hn(4,t.children!==null?t.children:[],t.key,i),i.lanes=s,i.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},i}function oA(t,i,s,c,f){this.tag=i,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Fu(0),this.expirationTimes=Fu(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Fu(0),this.identifierPrefix=c,this.onRecoverableError=f,this.mutableSourceEagerHydrationData=null}function ld(t,i,s,c,f,p,v,A,_){return t=new oA(t,i,s,A,_),i===1?(i=1,p===!0&&(i|=8)):i=0,p=hn(3,null,null,i),t.current=p,p.stateNode=t,p.memoizedState={element:c,isDehydrated:s,cache:null,transitions:null,pendingSuspenseBoundaries:null},Tc(p),t}function sA(t,i,s){var c=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:U,key:c==null?null:""+c,children:t,containerInfo:i,implementation:s}}function Vp(t){if(!t)return Ci;t=t._reactInternals;e:{if(tr(t)!==t||t.tag!==1)throw Error(r(170));var i=t;do{switch(i.tag){case 3:i=i.stateNode.context;break e;case 1:if(jt(i.type)){i=i.stateNode.__reactInternalMemoizedMergedChildContext;break e}}i=i.return}while(i!==null);throw Error(r(171))}if(t.tag===1){var s=t.type;if(jt(s))return Tg(t,s,i)}return i}function Xp(t,i,s,c,f,p,v,A,_){return t=ld(s,c,!0,t,f,p,v,A,_),t.context=Vp(null),s=t.current,c=Ht(),f=ki(s),p=ii(c,f),p.callback=i??null,Pi(s,p,f),t.current.lanes=f,Yo(t,f,c),Kt(t,c),t}function hl(t,i,s,c){var f=i.current,p=Ht(),v=ki(f);return s=Vp(s),i.context===null?i.context=s:i.pendingContext=s,i=ii(p,v),i.payload={element:t},c=c===void 0?null:c,c!==null&&(i.callback=c),t=Pi(f,i,v),t!==null&&(Rn(t,f,v,p),Wa(t,f,v)),v}function gl(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function Kp(t,i){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var s=t.retryLane;t.retryLane=s!==0&&s<i?s:i}}function ud(t,i){Kp(t,i),(t=t.alternate)&&Kp(t,i)}function aA(){return null}var qp=typeof reportError=="function"?reportError:function(t){console.error(t)};function cd(t){this._internalRoot=t}pl.prototype.render=cd.prototype.render=function(t){var i=this._internalRoot;if(i===null)throw Error(r(409));hl(t,i,null,null)},pl.prototype.unmount=cd.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var i=t.containerInfo;cr(function(){hl(null,t,null,null)}),i[Qn]=null}};function pl(t){this._internalRoot=t}pl.prototype.unstable_scheduleHydration=function(t){if(t){var i=Mh();t={blockedOn:null,target:t,priority:i};for(var s=0;s<Ai.length&&i!==0&&i<Ai[s].priority;s++);Ai.splice(s,0,t),s===0&&Lh(t)}};function dd(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function ml(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function Zp(){}function lA(t,i,s,c,f){if(f){if(typeof c=="function"){var p=c;c=function(){var M=gl(v);p.call(M)}}var v=Xp(i,c,t,0,null,!1,!1,"",Zp);return t._reactRootContainer=v,t[Qn]=v.current,os(t.nodeType===8?t.parentNode:t),cr(),v}for(;f=t.lastChild;)t.removeChild(f);if(typeof c=="function"){var A=c;c=function(){var M=gl(_);A.call(M)}}var _=ld(t,0,!1,null,null,!1,!1,"",Zp);return t._reactRootContainer=_,t[Qn]=_.current,os(t.nodeType===8?t.parentNode:t),cr(function(){hl(i,_,s,c)}),_}function vl(t,i,s,c,f){var p=s._reactRootContainer;if(p){var v=p;if(typeof f=="function"){var A=f;f=function(){var _=gl(v);A.call(_)}}hl(i,v,t,f)}else v=lA(s,i,t,f,c);return gl(v)}Oh=function(t){switch(t.tag){case 3:var i=t.stateNode;if(i.current.memoizedState.isDehydrated){var s=Wo(i.pendingLanes);s!==0&&(Uu(i,s|1),Kt(i,st()),(He&6)===0&&(io=st()+500,_i()))}break;case 13:cr(function(){var c=ni(t,1);if(c!==null){var f=Ht();Rn(c,t,1,f)}}),ud(t,1)}},Lu=function(t){if(t.tag===13){var i=ni(t,134217728);if(i!==null){var s=Ht();Rn(i,t,134217728,s)}ud(t,134217728)}},kh=function(t){if(t.tag===13){var i=ki(t),s=ni(t,i);if(s!==null){var c=Ht();Rn(s,t,i,c)}ud(t,i)}},Mh=function(){return We},Fh=function(t,i){var s=We;try{return We=t,i()}finally{We=s}},Pu=function(t,i,s){switch(i){case"input":if(Wt(t,s),i=s.name,s.type==="radio"&&i!=null){for(s=t;s.parentNode;)s=s.parentNode;for(s=s.querySelectorAll("input[name="+JSON.stringify(""+i)+'][type="radio"]'),i=0;i<s.length;i++){var c=s[i];if(c!==t&&c.form===t.form){var f=Fa(c);if(!f)throw Error(r(90));he(c),Wt(c,f)}}}break;case"textarea":uh(t,s);break;case"select":i=s.value,i!=null&&mi(t,!!s.multiple,i,!1)}},yh=nd,Sh=cr;var uA={usingClientEntryPoint:!1,Events:[ls,Wr,Fa,mh,vh,nd]},Is={findFiberByHostInstance:nr,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},cA={bundleType:Is.bundleType,version:Is.version,rendererPackageName:Is.rendererPackageName,rendererConfig:Is.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:H.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=wh(t),t===null?null:t.stateNode},findFiberByHostInstance:Is.findFiberByHostInstance||aA,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var yl=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!yl.isDisabled&&yl.supportsFiber)try{pa=yl.inject(cA),Hn=yl}catch{}}return qt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=uA,qt.createPortal=function(t,i){var s=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!dd(i))throw Error(r(200));return sA(t,i,null,s)},qt.createRoot=function(t,i){if(!dd(t))throw Error(r(299));var s=!1,c="",f=qp;return i!=null&&(i.unstable_strictMode===!0&&(s=!0),i.identifierPrefix!==void 0&&(c=i.identifierPrefix),i.onRecoverableError!==void 0&&(f=i.onRecoverableError)),i=ld(t,1,!1,null,null,s,!1,c,f),t[Qn]=i.current,os(t.nodeType===8?t.parentNode:t),new cd(i)},qt.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var i=t._reactInternals;if(i===void 0)throw typeof t.render=="function"?Error(r(188)):(t=Object.keys(t).join(","),Error(r(268,t)));return t=wh(i),t=t===null?null:t.stateNode,t},qt.flushSync=function(t){return cr(t)},qt.hydrate=function(t,i,s){if(!ml(i))throw Error(r(200));return vl(null,t,i,!0,s)},qt.hydrateRoot=function(t,i,s){if(!dd(t))throw Error(r(405));var c=s!=null&&s.hydratedSources||null,f=!1,p="",v=qp;if(s!=null&&(s.unstable_strictMode===!0&&(f=!0),s.identifierPrefix!==void 0&&(p=s.identifierPrefix),s.onRecoverableError!==void 0&&(v=s.onRecoverableError)),i=Xp(i,null,t,1,s??null,f,!1,p,v),t[Qn]=i.current,os(t),c)for(t=0;t<c.length;t++)s=c[t],f=s._getVersion,f=f(s._source),i.mutableSourceEagerHydrationData==null?i.mutableSourceEagerHydrationData=[s,f]:i.mutableSourceEagerHydrationData.push(s,f);return new pl(i)},qt.render=function(t,i,s){if(!ml(i))throw Error(r(200));return vl(null,t,i,!1,s)},qt.unmountComponentAtNode=function(t){if(!ml(t))throw Error(r(40));return t._reactRootContainer?(cr(function(){vl(null,null,t,!1,function(){t._reactRootContainer=null,t[Qn]=null})}),!0):!1},qt.unstable_batchedUpdates=nd,qt.unstable_renderSubtreeIntoContainer=function(t,i,s,c){if(!ml(s))throw Error(r(200));if(t==null||t._reactInternals===void 0)throw Error(r(38));return vl(t,i,s,!1,c)},qt.version="18.3.1-next-f1338f8080-20240426",qt}var om;function AA(){if(om)return gd.exports;om=1;function e(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(n){console.error(n)}}return e(),gd.exports=SA(),gd.exports}var sm;function TA(){if(sm)return Sl;sm=1;var e=AA();return Sl.createRoot=e.createRoot,Sl.hydrateRoot=e.hydrateRoot,Sl}var IA=TA();const wA=E0(IA);class EA{constructor(){this.ids=[],this.values=[],this.length=0}clear(){this.length=0}push(n,r){let o=this.length++;for(;o>0;){const l=o-1>>1,a=this.values[l];if(r>=a)break;this.ids[o]=this.ids[l],this.values[o]=a,o=l}this.ids[o]=n,this.values[o]=r}pop(){if(this.length===0)return;const n=this.ids[0];if(this.length--,this.length>0){const r=this.ids[0]=this.ids[this.length],o=this.values[0]=this.values[this.length],l=this.length>>1;let a=0;for(;a<l;){let u=(a<<1)+1;const d=u+1;let h=this.ids[u],g=this.values[u];const m=this.values[d];if(d<this.length&&m<g&&(u=d,h=this.ids[d],g=m),g>=o)break;this.ids[a]=h,this.values[a]=g,a=u}this.ids[a]=r,this.values[a]=o}return n}peek(){if(this.length!==0)return this.ids[0]}peekValue(){if(this.length!==0)return this.values[0]}shrink(){this.ids.length=this.values.length=this.length}}const am=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array],vd=3;class Cf{static from(n,r=0){if(r%8!==0)throw new Error("byteOffset must be 8-byte aligned.");if(!n||n.byteLength===void 0||n.buffer)throw new Error("Data must be an instance of ArrayBuffer or SharedArrayBuffer.");const[o,l]=new Uint8Array(n,r+0,2);if(o!==251)throw new Error("Data does not appear to be in a Flatbush format.");const a=l>>4;if(a!==vd)throw new Error(`Got v${a} data when expected v${vd}.`);const u=am[l&15];if(!u)throw new Error("Unrecognized array type.");const[d]=new Uint16Array(n,r+2,1),[h]=new Uint32Array(n,r+4,1);return new Cf(h,d,u,void 0,n,r)}constructor(n,r=16,o=Float64Array,l=ArrayBuffer,a,u=0){if(n===void 0)throw new Error("Missing required argument: numItems.");if(isNaN(n)||n<=0)throw new Error(`Unexpected numItems value: ${n}.`);this.numItems=+n,this.nodeSize=Math.min(Math.max(+r,2),65535),this.byteOffset=u;let d=n,h=d;this._levelBounds=[d*4];do d=Math.ceil(d/this.nodeSize),h+=d,this._levelBounds.push(h*4);while(d!==1);this.ArrayType=o,this.IndexArrayType=h<16384?Uint16Array:Uint32Array;const g=am.indexOf(this.ArrayType),m=h*4*this.ArrayType.BYTES_PER_ELEMENT;if(g<0)throw new Error(`Unexpected typed array class: ${o}.`);a&&a.byteLength!==void 0&&!a.buffer?(this.data=a,this._boxes=new this.ArrayType(this.data,u+8,h*4),this._indices=new this.IndexArrayType(this.data,u+8+m,h),this._pos=h*4,this.minX=this._boxes[this._pos-4],this.minY=this._boxes[this._pos-3],this.maxX=this._boxes[this._pos-2],this.maxY=this._boxes[this._pos-1]):(this.data=new l(8+m+h*this.IndexArrayType.BYTES_PER_ELEMENT),this._boxes=new this.ArrayType(this.data,8,h*4),this._indices=new this.IndexArrayType(this.data,8+m,h),this._pos=0,this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0,new Uint8Array(this.data,0,2).set([251,(vd<<4)+g]),new Uint16Array(this.data,2,1)[0]=r,new Uint32Array(this.data,4,1)[0]=n),this._queue=new EA}add(n,r,o=n,l=r){const a=this._pos>>2,u=this._boxes;return this._indices[a]=a,u[this._pos++]=n,u[this._pos++]=r,u[this._pos++]=o,u[this._pos++]=l,n<this.minX&&(this.minX=n),r<this.minY&&(this.minY=r),o>this.maxX&&(this.maxX=o),l>this.maxY&&(this.maxY=l),a}finish(){if(this._pos>>2!==this.numItems)throw new Error(`Added ${this._pos>>2} items when expected ${this.numItems}.`);const n=this._boxes;if(this.numItems<=this.nodeSize){n[this._pos++]=this.minX,n[this._pos++]=this.minY,n[this._pos++]=this.maxX,n[this._pos++]=this.maxY;return}const r=this.maxX-this.minX||1,o=this.maxY-this.minY||1,l=new Uint32Array(this.numItems),a=65535;for(let u=0,d=0;u<this.numItems;u++){const h=n[d++],g=n[d++],m=n[d++],y=n[d++],S=Math.floor(a*((h+m)/2-this.minX)/r),E=Math.floor(a*((g+y)/2-this.minY)/o);l[u]=_A(S,E)}qd(l,n,this._indices,0,this.numItems-1,this.nodeSize);for(let u=0,d=0;u<this._levelBounds.length-1;u++){const h=this._levelBounds[u];for(;d<h;){const g=d;let m=n[d++],y=n[d++],S=n[d++],E=n[d++];for(let w=1;w<this.nodeSize&&d<h;w++)m=Math.min(m,n[d++]),y=Math.min(y,n[d++]),S=Math.max(S,n[d++]),E=Math.max(E,n[d++]);this._indices[this._pos>>2]=g,n[this._pos++]=m,n[this._pos++]=y,n[this._pos++]=S,n[this._pos++]=E}}}search(n,r,o,l,a){if(this._pos!==this._boxes.length)throw new Error("Data not yet indexed - call index.finish().");let u=this._boxes.length-4;const d=[],h=[];for(;u!==void 0;){const g=Math.min(u+this.nodeSize*4,um(u,this._levelBounds));for(let m=u;m<g;m+=4){if(o<this._boxes[m]||l<this._boxes[m+1]||n>this._boxes[m+2]||r>this._boxes[m+3])continue;const y=this._indices[m>>2]|0;u>=this.numItems*4?d.push(y):(a===void 0||a(y))&&h.push(y)}u=d.pop()}return h}neighbors(n,r,o=1/0,l=1/0,a){if(this._pos!==this._boxes.length)throw new Error("Data not yet indexed - call index.finish().");let u=this._boxes.length-4;const d=this._queue,h=[],g=l*l;e:for(;u!==void 0;){const m=Math.min(u+this.nodeSize*4,um(u,this._levelBounds));for(let y=u;y<m;y+=4){const S=this._indices[y>>2]|0,E=lm(n,this._boxes[y],this._boxes[y+2]),w=lm(r,this._boxes[y+1],this._boxes[y+3]),T=E*E+w*w;T>g||(u>=this.numItems*4?d.push(S<<1,T):(a===void 0||a(S))&&d.push((S<<1)+1,T))}for(;d.length&&d.peek()&1;)if(d.peekValue()>g||(h.push(d.pop()>>1),h.length===o))break e;u=d.length?d.pop()>>1:void 0}return d.clear(),h}}function lm(e,n,r){return e<n?n-e:e<=r?0:e-r}function um(e,n){let r=0,o=n.length-1;for(;r<o;){const l=r+o>>1;n[l]>e?o=l:r=l+1}return n[r]}function qd(e,n,r,o,l,a){if(Math.floor(o/a)>=Math.floor(l/a))return;const u=e[o+l>>1];let d=o-1,h=l+1;for(;;){do d++;while(e[d]<u);do h--;while(e[h]>u);if(d>=h)break;CA(e,n,r,d,h)}qd(e,n,r,o,h,a),qd(e,n,r,h+1,l,a)}function CA(e,n,r,o,l){const a=e[o];e[o]=e[l],e[l]=a;const u=4*o,d=4*l,h=n[u],g=n[u+1],m=n[u+2],y=n[u+3];n[u]=n[d],n[u+1]=n[d+1],n[u+2]=n[d+2],n[u+3]=n[d+3],n[d]=h,n[d+1]=g,n[d+2]=m,n[d+3]=y;const S=r[o];r[o]=r[l],r[l]=S}function _A(e,n){let r=e^n,o=65535^r,l=65535^(e|n),a=e&(n^65535),u=r|o>>1,d=r>>1^r,h=l>>1^o&a>>1^l,g=r&l>>1^a>>1^a;r=u,o=d,l=h,a=g,u=r&r>>2^o&o>>2,d=r&o>>2^o&(r^o)>>2,h^=r&l>>2^o&a>>2,g^=o&l>>2^(r^o)&a>>2,r=u,o=d,l=h,a=g,u=r&r>>4^o&o>>4,d=r&o>>4^o&(r^o)>>4,h^=r&l>>4^o&a>>4,g^=o&l>>4^(r^o)&a>>4,r=u,o=d,l=h,a=g,h^=r&l>>8^o&a>>8,g^=o&l>>8^(r^o)&a>>8,r=h^h>>1,o=g^g>>1;let m=e^n,y=o|65535^(m|r);return m=(m|m<<8)&16711935,m=(m|m<<4)&252645135,m=(m|m<<2)&858993459,m=(m|m<<1)&1431655765,y=(y|y<<8)&16711935,y=(y|y<<4)&252645135,y=(y|y<<2)&858993459,y=(y|y<<1)&1431655765,(y<<1|m)>>>0}function oo(e,n){if(e.length===0)return{all:()=>[],byRect:()=>[],byRadius:()=>[],byProperty:()=>[],resetPropertyCache:()=>{},count:()=>0};const r=new Cf(e.length),o=new Map;for(const a of e)r.add(a.position.x,a.position.y,a.position.x,a.position.y);return r.finish(),{all(){return e},byRect(a){return r.search(a.left,a.top,a.right,a.bottom).map(d=>e[d])},byRadius(a,u){return r.neighbors(a.x,a.y,void 0,u).map(h=>e[h])},byProperty(a,u){var d;if(!o.has(a)){const h=new Map;for(const g of e){const m=g[a];h.has(m)||h.set(m,[]),h.get(m).push(g)}o.set(a,h)}return((d=o.get(a))==null?void 0:d.get(u))||[]},resetPropertyCache(){o.clear()},count(){return e.length}}}function uu(e){const n=Object.values(e.entities.entities),r=n.filter(g=>g.type==="human"),o=n.filter(g=>g.type==="berryBush"),l=n.filter(g=>g.type==="corpse"),a=n.filter(g=>g.type==="prey"),u=n.filter(g=>g.type==="predator"),d=n.filter(g=>g.type==="building");return{...e,search:{human:oo(r),berryBush:oo(o),corpse:oo(l),prey:oo(a),predator:oo(u),building:oo(d)}}}const RA="tribe-game-db",qi="save-files",_f="tribe-game-save",Zd=1;async function Rf(e){try{const n={version:Zd,savedAt:Date.now(),gameState:e},r=JSON.stringify(n),o=await NA(r);await OA(_f,o),console.log(`Game saved successfully. Size: ${(o.size/1024).toFixed(2)} KB`)}catch(n){throw console.error("Failed to save game:",n),n}}async function PA(){try{const e=await kA(_f);if(!e)return null;const n=await DA(e),r=JSON.parse(n);return r.version!==Zd?(console.warn(`Save game version mismatch. Expected ${Zd}, found ${r.version}. Discarding save.`),await Qd(),null):(console.log("Game loaded successfully."),uu(r.gameState))}catch(e){return console.error("Failed to load game:",e),await Qd(),null}}async function Qd(){try{await MA(_f),console.log("Saved game cleared.")}catch(e){console.error("Failed to clear saved game:",e)}}async function NA(e){const r=new Blob([e]).stream().pipeThrough(new CompressionStream("gzip"));return await new Response(r).blob()}async function DA(e){const n=e.stream().pipeThrough(new DecompressionStream("gzip"));return await new Response(n).text()}function Pf(){return new Promise((e,n)=>{const r=indexedDB.open(RA,1);r.onupgradeneeded=o=>{const l=o.target.result;l.objectStoreNames.contains(qi)||l.createObjectStore(qi)},r.onsuccess=()=>e(r.result),r.onerror=()=>n(r.error)})}async function OA(e,n){const r=await Pf();return new Promise((o,l)=>{const d=r.transaction(qi,"readwrite").objectStore(qi).put(n,e);d.onsuccess=()=>o(),d.onerror=()=>l(d.error)})}async function kA(e){const n=await Pf();return new Promise((r,o)=>{const u=n.transaction(qi,"readonly").objectStore(qi).get(e);u.onsuccess=()=>r(u.result),u.onerror=()=>o(u.error)})}async function MA(e){const n=await Pf();return new Promise((r,o)=>{const u=n.transaction(qi,"readwrite").objectStore(qi).delete(e);u.onsuccess=()=>r(),u.onerror=()=>o(u.error)})}const C0=Re.createContext(void 0),FA=({initialAppState:e,children:n})=>{const[r,o]=Re.useState(e),[l,a]=Re.useState(void 0),[u,d]=Re.useState(null),[h,g]=Re.useState(!1);Re.useEffect(()=>{PA().then(w=>{w&&d(w),g(!0)})},[]);const m=(w,T)=>{o(w),w==="gameOver"&&T?a(T):w!=="gameOver"&&a(void 0)},y=()=>{o("intro"),a(void 0),E()},S=w=>{Rf(w),d(w)},E=()=>{Qd(),d(null)};return Fe.jsx(C0.Provider,{value:{appState:r,setAppState:m,returnToIntro:y,gameOverDetails:l,contextReady:h,savedGameState:u,setSavedGameState:d,saveCurrentGame:S,clearCurrentSave:E},children:n})},ko=()=>{const e=Re.useContext(C0);if(e===void 0)throw new Error("useGameContext must be used within a GameProvider");return e};var Lt=function(){return Lt=Object.assign||function(n){for(var r,o=1,l=arguments.length;o<l;o++){r=arguments[o];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(n[a]=r[a])}return n},Lt.apply(this,arguments)};function js(e,n,r){if(r||arguments.length===2)for(var o=0,l=n.length,a;o<l;o++)(a||!(o in n))&&(a||(a=Array.prototype.slice.call(n,0,o)),a[o]=n[o]);return e.concat(a||Array.prototype.slice.call(n))}var Ke="-ms-",Bs="-moz-",$e="-webkit-",_0="comm",cu="rule",Nf="decl",UA="@import",R0="@keyframes",LA="@layer",P0=Math.abs,Df=String.fromCharCode,Jd=Object.assign;function BA(e,n){return yt(e,0)^45?(((n<<2^yt(e,0))<<2^yt(e,1))<<2^yt(e,2))<<2^yt(e,3):0}function N0(e){return e.trim()}function li(e,n){return(e=n.exec(e))?e[0]:e}function Me(e,n,r){return e.replace(n,r)}function $l(e,n,r){return e.indexOf(n,r)}function yt(e,n){return e.charCodeAt(n)|0}function To(e,n,r){return e.slice(n,r)}function Vn(e){return e.length}function D0(e){return e.length}function ks(e,n){return n.push(e),e}function HA(e,n){return e.map(n).join("")}function cm(e,n){return e.filter(function(r){return!li(r,n)})}var du=1,Io=1,O0=0,yn=0,dt=0,Mo="";function fu(e,n,r,o,l,a,u,d){return{value:e,root:n,parent:r,type:o,props:l,children:a,line:du,column:Io,length:u,return:"",siblings:d}}function bi(e,n){return Jd(fu("",null,null,"",null,null,0,e.siblings),e,{length:-e.length},n)}function so(e){for(;e.root;)e=bi(e.root,{children:[e]});ks(e,e.siblings)}function bA(){return dt}function GA(){return dt=yn>0?yt(Mo,--yn):0,Io--,dt===10&&(Io=1,du--),dt}function Dn(){return dt=yn<O0?yt(Mo,yn++):0,Io++,dt===10&&(Io=1,du++),dt}function Ir(){return yt(Mo,yn)}function zl(){return yn}function hu(e,n){return To(Mo,e,n)}function ef(e){switch(e){case 0:case 9:case 10:case 13:case 32:return 5;case 33:case 43:case 44:case 47:case 62:case 64:case 126:case 59:case 123:case 125:return 4;case 58:return 3;case 34:case 39:case 40:case 91:return 2;case 41:case 93:return 1}return 0}function xA(e){return du=Io=1,O0=Vn(Mo=e),yn=0,[]}function $A(e){return Mo="",e}function yd(e){return N0(hu(yn-1,tf(e===91?e+2:e===40?e+1:e)))}function zA(e){for(;(dt=Ir())&&dt<33;)Dn();return ef(e)>2||ef(dt)>3?"":" "}function WA(e,n){for(;--n&&Dn()&&!(dt<48||dt>102||dt>57&&dt<65||dt>70&&dt<97););return hu(e,zl()+(n<6&&Ir()==32&&Dn()==32))}function tf(e){for(;Dn();)switch(dt){case e:return yn;case 34:case 39:e!==34&&e!==39&&tf(dt);break;case 40:e===41&&tf(e);break;case 92:Dn();break}return yn}function YA(e,n){for(;Dn()&&e+dt!==57;)if(e+dt===84&&Ir()===47)break;return"/*"+hu(n,yn-1)+"*"+Df(e===47?e:Dn())}function jA(e){for(;!ef(Ir());)Dn();return hu(e,yn)}function VA(e){return $A(Wl("",null,null,null,[""],e=xA(e),0,[0],e))}function Wl(e,n,r,o,l,a,u,d,h){for(var g=0,m=0,y=u,S=0,E=0,w=0,T=1,C=1,F=1,B=0,D="",H=l,x=a,U=o,$=D;C;)switch(w=B,B=Dn()){case 40:if(w!=108&&yt($,y-1)==58){$l($+=Me(yd(B),"&","&\f"),"&\f",P0(g?d[g-1]:0))!=-1&&(F=-1);break}case 34:case 39:case 91:$+=yd(B);break;case 9:case 10:case 13:case 32:$+=zA(w);break;case 92:$+=WA(zl()-1,7);continue;case 47:switch(Ir()){case 42:case 47:ks(XA(YA(Dn(),zl()),n,r,h),h);break;default:$+="/"}break;case 123*T:d[g++]=Vn($)*F;case 125*T:case 59:case 0:switch(B){case 0:case 125:C=0;case 59+m:F==-1&&($=Me($,/\f/g,"")),E>0&&Vn($)-y&&ks(E>32?fm($+";",o,r,y-1,h):fm(Me($," ","")+";",o,r,y-2,h),h);break;case 59:$+=";";default:if(ks(U=dm($,n,r,g,m,l,d,D,H=[],x=[],y,a),a),B===123)if(m===0)Wl($,n,U,U,H,a,y,d,x);else switch(S===99&&yt($,3)===110?100:S){case 100:case 108:case 109:case 115:Wl(e,U,U,o&&ks(dm(e,U,U,0,0,l,d,D,l,H=[],y,x),x),l,x,y,d,o?H:x);break;default:Wl($,U,U,U,[""],x,0,d,x)}}g=m=E=0,T=F=1,D=$="",y=u;break;case 58:y=1+Vn($),E=w;default:if(T<1){if(B==123)--T;else if(B==125&&T++==0&&GA()==125)continue}switch($+=Df(B),B*T){case 38:F=m>0?1:($+="\f",-1);break;case 44:d[g++]=(Vn($)-1)*F,F=1;break;case 64:Ir()===45&&($+=yd(Dn())),S=Ir(),m=y=Vn(D=$+=jA(zl())),B++;break;case 45:w===45&&Vn($)==2&&(T=0)}}return a}function dm(e,n,r,o,l,a,u,d,h,g,m,y){for(var S=l-1,E=l===0?a:[""],w=D0(E),T=0,C=0,F=0;T<o;++T)for(var B=0,D=To(e,S+1,S=P0(C=u[T])),H=e;B<w;++B)(H=N0(C>0?E[B]+" "+D:Me(D,/&\f/g,E[B])))&&(h[F++]=H);return fu(e,n,r,l===0?cu:d,h,g,m,y)}function XA(e,n,r,o){return fu(e,n,r,_0,Df(bA()),To(e,2,-2),0,o)}function fm(e,n,r,o,l){return fu(e,n,r,Nf,To(e,0,o),To(e,o+1,-1),o,l)}function k0(e,n,r){switch(BA(e,n)){case 5103:return $e+"print-"+e+e;case 5737:case 4201:case 3177:case 3433:case 1641:case 4457:case 2921:case 5572:case 6356:case 5844:case 3191:case 6645:case 3005:case 6391:case 5879:case 5623:case 6135:case 4599:case 4855:case 4215:case 6389:case 5109:case 5365:case 5621:case 3829:return $e+e+e;case 4789:return Bs+e+e;case 5349:case 4246:case 4810:case 6968:case 2756:return $e+e+Bs+e+Ke+e+e;case 5936:switch(yt(e,n+11)){case 114:return $e+e+Ke+Me(e,/[svh]\w+-[tblr]{2}/,"tb")+e;case 108:return $e+e+Ke+Me(e,/[svh]\w+-[tblr]{2}/,"tb-rl")+e;case 45:return $e+e+Ke+Me(e,/[svh]\w+-[tblr]{2}/,"lr")+e}case 6828:case 4268:case 2903:return $e+e+Ke+e+e;case 6165:return $e+e+Ke+"flex-"+e+e;case 5187:return $e+e+Me(e,/(\w+).+(:[^]+)/,$e+"box-$1$2"+Ke+"flex-$1$2")+e;case 5443:return $e+e+Ke+"flex-item-"+Me(e,/flex-|-self/g,"")+(li(e,/flex-|baseline/)?"":Ke+"grid-row-"+Me(e,/flex-|-self/g,""))+e;case 4675:return $e+e+Ke+"flex-line-pack"+Me(e,/align-content|flex-|-self/g,"")+e;case 5548:return $e+e+Ke+Me(e,"shrink","negative")+e;case 5292:return $e+e+Ke+Me(e,"basis","preferred-size")+e;case 6060:return $e+"box-"+Me(e,"-grow","")+$e+e+Ke+Me(e,"grow","positive")+e;case 4554:return $e+Me(e,/([^-])(transform)/g,"$1"+$e+"$2")+e;case 6187:return Me(Me(Me(e,/(zoom-|grab)/,$e+"$1"),/(image-set)/,$e+"$1"),e,"")+e;case 5495:case 3959:return Me(e,/(image-set\([^]*)/,$e+"$1$`$1");case 4968:return Me(Me(e,/(.+:)(flex-)?(.*)/,$e+"box-pack:$3"+Ke+"flex-pack:$3"),/s.+-b[^;]+/,"justify")+$e+e+e;case 4200:if(!li(e,/flex-|baseline/))return Ke+"grid-column-align"+To(e,n)+e;break;case 2592:case 3360:return Ke+Me(e,"template-","")+e;case 4384:case 3616:return r&&r.some(function(o,l){return n=l,li(o.props,/grid-\w+-end/)})?~$l(e+(r=r[n].value),"span",0)?e:Ke+Me(e,"-start","")+e+Ke+"grid-row-span:"+(~$l(r,"span",0)?li(r,/\d+/):+li(r,/\d+/)-+li(e,/\d+/))+";":Ke+Me(e,"-start","")+e;case 4896:case 4128:return r&&r.some(function(o){return li(o.props,/grid-\w+-start/)})?e:Ke+Me(Me(e,"-end","-span"),"span ","")+e;case 4095:case 3583:case 4068:case 2532:return Me(e,/(.+)-inline(.+)/,$e+"$1$2")+e;case 8116:case 7059:case 5753:case 5535:case 5445:case 5701:case 4933:case 4677:case 5533:case 5789:case 5021:case 4765:if(Vn(e)-1-n>6)switch(yt(e,n+1)){case 109:if(yt(e,n+4)!==45)break;case 102:return Me(e,/(.+:)(.+)-([^]+)/,"$1"+$e+"$2-$3$1"+Bs+(yt(e,n+3)==108?"$3":"$2-$3"))+e;case 115:return~$l(e,"stretch",0)?k0(Me(e,"stretch","fill-available"),n,r)+e:e}break;case 5152:case 5920:return Me(e,/(.+?):(\d+)(\s*\/\s*(span)?\s*(\d+))?(.*)/,function(o,l,a,u,d,h,g){return Ke+l+":"+a+g+(u?Ke+l+"-span:"+(d?h:+h-+a)+g:"")+e});case 4949:if(yt(e,n+6)===121)return Me(e,":",":"+$e)+e;break;case 6444:switch(yt(e,yt(e,14)===45?18:11)){case 120:return Me(e,/(.+:)([^;\s!]+)(;|(\s+)?!.+)?/,"$1"+$e+(yt(e,14)===45?"inline-":"")+"box$3$1"+$e+"$2$3$1"+Ke+"$2box$3")+e;case 100:return Me(e,":",":"+Ke)+e}break;case 5719:case 2647:case 2135:case 3927:case 2391:return Me(e,"scroll-","scroll-snap-")+e}return e}function ql(e,n){for(var r="",o=0;o<e.length;o++)r+=n(e[o],o,e,n)||"";return r}function KA(e,n,r,o){switch(e.type){case LA:if(e.children.length)break;case UA:case Nf:return e.return=e.return||e.value;case _0:return"";case R0:return e.return=e.value+"{"+ql(e.children,o)+"}";case cu:if(!Vn(e.value=e.props.join(",")))return""}return Vn(r=ql(e.children,o))?e.return=e.value+"{"+r+"}":""}function qA(e){var n=D0(e);return function(r,o,l,a){for(var u="",d=0;d<n;d++)u+=e[d](r,o,l,a)||"";return u}}function ZA(e){return function(n){n.root||(n=n.return)&&e(n)}}function QA(e,n,r,o){if(e.length>-1&&!e.return)switch(e.type){case Nf:e.return=k0(e.value,e.length,r);return;case R0:return ql([bi(e,{value:Me(e.value,"@","@"+$e)})],o);case cu:if(e.length)return HA(r=e.props,function(l){switch(li(l,o=/(::plac\w+|:read-\w+)/)){case":read-only":case":read-write":so(bi(e,{props:[Me(l,/:(read-\w+)/,":"+Bs+"$1")]})),so(bi(e,{props:[l]})),Jd(e,{props:cm(r,o)});break;case"::placeholder":so(bi(e,{props:[Me(l,/:(plac\w+)/,":"+$e+"input-$1")]})),so(bi(e,{props:[Me(l,/:(plac\w+)/,":"+Bs+"$1")]})),so(bi(e,{props:[Me(l,/:(plac\w+)/,Ke+"input-$1")]})),so(bi(e,{props:[l]})),Jd(e,{props:cm(r,o)});break}return""})}}var JA={animationIterationCount:1,aspectRatio:1,borderImageOutset:1,borderImageSlice:1,borderImageWidth:1,boxFlex:1,boxFlexGroup:1,boxOrdinalGroup:1,columnCount:1,columns:1,flex:1,flexGrow:1,flexPositive:1,flexShrink:1,flexNegative:1,flexOrder:1,gridRow:1,gridRowEnd:1,gridRowSpan:1,gridRowStart:1,gridColumn:1,gridColumnEnd:1,gridColumnSpan:1,gridColumnStart:1,msGridRow:1,msGridRowSpan:1,msGridColumn:1,msGridColumnSpan:1,fontWeight:1,lineHeight:1,opacity:1,order:1,orphans:1,tabSize:1,widows:1,zIndex:1,zoom:1,WebkitLineClamp:1,fillOpacity:1,floodOpacity:1,stopOpacity:1,strokeDasharray:1,strokeDashoffset:1,strokeMiterlimit:1,strokeOpacity:1,strokeWidth:1},on={},wo=typeof process<"u"&&on!==void 0&&(on.REACT_APP_SC_ATTR||on.SC_ATTR)||"data-styled",M0="active",F0="data-styled-version",gu="6.1.13",Of=`/*!sc*/
`,Zl=typeof window<"u"&&"HTMLElement"in window,eT=!!(typeof SC_DISABLE_SPEEDY=="boolean"?SC_DISABLE_SPEEDY:typeof process<"u"&&on!==void 0&&on.REACT_APP_SC_DISABLE_SPEEDY!==void 0&&on.REACT_APP_SC_DISABLE_SPEEDY!==""?on.REACT_APP_SC_DISABLE_SPEEDY!=="false"&&on.REACT_APP_SC_DISABLE_SPEEDY:typeof process<"u"&&on!==void 0&&on.SC_DISABLE_SPEEDY!==void 0&&on.SC_DISABLE_SPEEDY!==""&&on.SC_DISABLE_SPEEDY!=="false"&&on.SC_DISABLE_SPEEDY),tT={},pu=Object.freeze([]),Eo=Object.freeze({});function U0(e,n,r){return r===void 0&&(r=Eo),e.theme!==r.theme&&e.theme||n||r.theme}var L0=new Set(["a","abbr","address","area","article","aside","audio","b","base","bdi","bdo","big","blockquote","body","br","button","canvas","caption","cite","code","col","colgroup","data","datalist","dd","del","details","dfn","dialog","div","dl","dt","em","embed","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","header","hgroup","hr","html","i","iframe","img","input","ins","kbd","keygen","label","legend","li","link","main","map","mark","menu","menuitem","meta","meter","nav","noscript","object","ol","optgroup","option","output","p","param","picture","pre","progress","q","rp","rt","ruby","s","samp","script","section","select","small","source","span","strong","style","sub","summary","sup","table","tbody","td","textarea","tfoot","th","thead","time","tr","track","u","ul","use","var","video","wbr","circle","clipPath","defs","ellipse","foreignObject","g","image","line","linearGradient","marker","mask","path","pattern","polygon","polyline","radialGradient","rect","stop","svg","text","tspan"]),nT=/[!"#$%&'()*+,./:;<=>?@[\\\]^`{|}~-]+/g,iT=/(^-|-$)/g;function hm(e){return e.replace(nT,"-").replace(iT,"")}var rT=/(a)(d)/gi,Al=52,gm=function(e){return String.fromCharCode(e+(e>25?39:97))};function nf(e){var n,r="";for(n=Math.abs(e);n>Al;n=n/Al|0)r=gm(n%Al)+r;return(gm(n%Al)+r).replace(rT,"$1-$2")}var Sd,B0=5381,go=function(e,n){for(var r=n.length;r;)e=33*e^n.charCodeAt(--r);return e},H0=function(e){return go(B0,e)};function b0(e){return nf(H0(e)>>>0)}function oT(e){return e.displayName||e.name||"Component"}function Ad(e){return typeof e=="string"&&!0}var G0=typeof Symbol=="function"&&Symbol.for,x0=G0?Symbol.for("react.memo"):60115,sT=G0?Symbol.for("react.forward_ref"):60112,aT={childContextTypes:!0,contextType:!0,contextTypes:!0,defaultProps:!0,displayName:!0,getDefaultProps:!0,getDerivedStateFromError:!0,getDerivedStateFromProps:!0,mixins:!0,propTypes:!0,type:!0},lT={name:!0,length:!0,prototype:!0,caller:!0,callee:!0,arguments:!0,arity:!0},$0={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},uT=((Sd={})[sT]={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},Sd[x0]=$0,Sd);function pm(e){return("type"in(n=e)&&n.type.$$typeof)===x0?$0:"$$typeof"in e?uT[e.$$typeof]:aT;var n}var cT=Object.defineProperty,dT=Object.getOwnPropertyNames,mm=Object.getOwnPropertySymbols,fT=Object.getOwnPropertyDescriptor,hT=Object.getPrototypeOf,vm=Object.prototype;function z0(e,n,r){if(typeof n!="string"){if(vm){var o=hT(n);o&&o!==vm&&z0(e,o,r)}var l=dT(n);mm&&(l=l.concat(mm(n)));for(var a=pm(e),u=pm(n),d=0;d<l.length;++d){var h=l[d];if(!(h in lT||r&&r[h]||u&&h in u||a&&h in a)){var g=fT(n,h);try{cT(e,h,g)}catch{}}}}return e}function Co(e){return typeof e=="function"}function kf(e){return typeof e=="object"&&"styledComponentId"in e}function Ar(e,n){return e&&n?"".concat(e," ").concat(n):e||n||""}function rf(e,n){if(e.length===0)return"";for(var r=e[0],o=1;o<e.length;o++)r+=e[o];return r}function Vs(e){return e!==null&&typeof e=="object"&&e.constructor.name===Object.name&&!("props"in e&&e.$$typeof)}function of(e,n,r){if(r===void 0&&(r=!1),!r&&!Vs(e)&&!Array.isArray(e))return n;if(Array.isArray(n))for(var o=0;o<n.length;o++)e[o]=of(e[o],n[o]);else if(Vs(n))for(var o in n)e[o]=of(e[o],n[o]);return e}function Mf(e,n){Object.defineProperty(e,"toString",{value:n})}function sa(e){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];return new Error("An error occurred. See https://github.com/styled-components/styled-components/blob/main/packages/styled-components/src/utils/errors.md#".concat(e," for more information.").concat(n.length>0?" Args: ".concat(n.join(", ")):""))}var gT=function(){function e(n){this.groupSizes=new Uint32Array(512),this.length=512,this.tag=n}return e.prototype.indexOfGroup=function(n){for(var r=0,o=0;o<n;o++)r+=this.groupSizes[o];return r},e.prototype.insertRules=function(n,r){if(n>=this.groupSizes.length){for(var o=this.groupSizes,l=o.length,a=l;n>=a;)if((a<<=1)<0)throw sa(16,"".concat(n));this.groupSizes=new Uint32Array(a),this.groupSizes.set(o),this.length=a;for(var u=l;u<a;u++)this.groupSizes[u]=0}for(var d=this.indexOfGroup(n+1),h=(u=0,r.length);u<h;u++)this.tag.insertRule(d,r[u])&&(this.groupSizes[n]++,d++)},e.prototype.clearGroup=function(n){if(n<this.length){var r=this.groupSizes[n],o=this.indexOfGroup(n),l=o+r;this.groupSizes[n]=0;for(var a=o;a<l;a++)this.tag.deleteRule(o)}},e.prototype.getGroup=function(n){var r="";if(n>=this.length||this.groupSizes[n]===0)return r;for(var o=this.groupSizes[n],l=this.indexOfGroup(n),a=l+o,u=l;u<a;u++)r+="".concat(this.tag.getRule(u)).concat(Of);return r},e}(),Yl=new Map,Ql=new Map,jl=1,Tl=function(e){if(Yl.has(e))return Yl.get(e);for(;Ql.has(jl);)jl++;var n=jl++;return Yl.set(e,n),Ql.set(n,e),n},pT=function(e,n){jl=n+1,Yl.set(e,n),Ql.set(n,e)},mT="style[".concat(wo,"][").concat(F0,'="').concat(gu,'"]'),vT=new RegExp("^".concat(wo,'\\.g(\\d+)\\[id="([\\w\\d-]+)"\\].*?"([^"]*)')),yT=function(e,n,r){for(var o,l=r.split(","),a=0,u=l.length;a<u;a++)(o=l[a])&&e.registerName(n,o)},ST=function(e,n){for(var r,o=((r=n.textContent)!==null&&r!==void 0?r:"").split(Of),l=[],a=0,u=o.length;a<u;a++){var d=o[a].trim();if(d){var h=d.match(vT);if(h){var g=0|parseInt(h[1],10),m=h[2];g!==0&&(pT(m,g),yT(e,m,h[3]),e.getTag().insertRules(g,l)),l.length=0}else l.push(d)}}},ym=function(e){for(var n=document.querySelectorAll(mT),r=0,o=n.length;r<o;r++){var l=n[r];l&&l.getAttribute(wo)!==M0&&(ST(e,l),l.parentNode&&l.parentNode.removeChild(l))}};function AT(){return typeof __webpack_nonce__<"u"?__webpack_nonce__:null}var W0=function(e){var n=document.head,r=e||n,o=document.createElement("style"),l=function(d){var h=Array.from(d.querySelectorAll("style[".concat(wo,"]")));return h[h.length-1]}(r),a=l!==void 0?l.nextSibling:null;o.setAttribute(wo,M0),o.setAttribute(F0,gu);var u=AT();return u&&o.setAttribute("nonce",u),r.insertBefore(o,a),o},TT=function(){function e(n){this.element=W0(n),this.element.appendChild(document.createTextNode("")),this.sheet=function(r){if(r.sheet)return r.sheet;for(var o=document.styleSheets,l=0,a=o.length;l<a;l++){var u=o[l];if(u.ownerNode===r)return u}throw sa(17)}(this.element),this.length=0}return e.prototype.insertRule=function(n,r){try{return this.sheet.insertRule(r,n),this.length++,!0}catch{return!1}},e.prototype.deleteRule=function(n){this.sheet.deleteRule(n),this.length--},e.prototype.getRule=function(n){var r=this.sheet.cssRules[n];return r&&r.cssText?r.cssText:""},e}(),IT=function(){function e(n){this.element=W0(n),this.nodes=this.element.childNodes,this.length=0}return e.prototype.insertRule=function(n,r){if(n<=this.length&&n>=0){var o=document.createTextNode(r);return this.element.insertBefore(o,this.nodes[n]||null),this.length++,!0}return!1},e.prototype.deleteRule=function(n){this.element.removeChild(this.nodes[n]),this.length--},e.prototype.getRule=function(n){return n<this.length?this.nodes[n].textContent:""},e}(),wT=function(){function e(n){this.rules=[],this.length=0}return e.prototype.insertRule=function(n,r){return n<=this.length&&(this.rules.splice(n,0,r),this.length++,!0)},e.prototype.deleteRule=function(n){this.rules.splice(n,1),this.length--},e.prototype.getRule=function(n){return n<this.length?this.rules[n]:""},e}(),Sm=Zl,ET={isServer:!Zl,useCSSOMInjection:!eT},Jl=function(){function e(n,r,o){n===void 0&&(n=Eo),r===void 0&&(r={});var l=this;this.options=Lt(Lt({},ET),n),this.gs=r,this.names=new Map(o),this.server=!!n.isServer,!this.server&&Zl&&Sm&&(Sm=!1,ym(this)),Mf(this,function(){return function(a){for(var u=a.getTag(),d=u.length,h="",g=function(y){var S=function(F){return Ql.get(F)}(y);if(S===void 0)return"continue";var E=a.names.get(S),w=u.getGroup(y);if(E===void 0||!E.size||w.length===0)return"continue";var T="".concat(wo,".g").concat(y,'[id="').concat(S,'"]'),C="";E!==void 0&&E.forEach(function(F){F.length>0&&(C+="".concat(F,","))}),h+="".concat(w).concat(T,'{content:"').concat(C,'"}').concat(Of)},m=0;m<d;m++)g(m);return h}(l)})}return e.registerId=function(n){return Tl(n)},e.prototype.rehydrate=function(){!this.server&&Zl&&ym(this)},e.prototype.reconstructWithOptions=function(n,r){return r===void 0&&(r=!0),new e(Lt(Lt({},this.options),n),this.gs,r&&this.names||void 0)},e.prototype.allocateGSInstance=function(n){return this.gs[n]=(this.gs[n]||0)+1},e.prototype.getTag=function(){return this.tag||(this.tag=(n=function(r){var o=r.useCSSOMInjection,l=r.target;return r.isServer?new wT(l):o?new TT(l):new IT(l)}(this.options),new gT(n)));var n},e.prototype.hasNameForId=function(n,r){return this.names.has(n)&&this.names.get(n).has(r)},e.prototype.registerName=function(n,r){if(Tl(n),this.names.has(n))this.names.get(n).add(r);else{var o=new Set;o.add(r),this.names.set(n,o)}},e.prototype.insertRules=function(n,r,o){this.registerName(n,r),this.getTag().insertRules(Tl(n),o)},e.prototype.clearNames=function(n){this.names.has(n)&&this.names.get(n).clear()},e.prototype.clearRules=function(n){this.getTag().clearGroup(Tl(n)),this.clearNames(n)},e.prototype.clearTag=function(){this.tag=void 0},e}(),CT=/&/g,_T=/^\s*\/\/.*$/gm;function Y0(e,n){return e.map(function(r){return r.type==="rule"&&(r.value="".concat(n," ").concat(r.value),r.value=r.value.replaceAll(",",",".concat(n," ")),r.props=r.props.map(function(o){return"".concat(n," ").concat(o)})),Array.isArray(r.children)&&r.type!=="@keyframes"&&(r.children=Y0(r.children,n)),r})}function RT(e){var n,r,o,l=Eo,a=l.options,u=a===void 0?Eo:a,d=l.plugins,h=d===void 0?pu:d,g=function(S,E,w){return w.startsWith(r)&&w.endsWith(r)&&w.replaceAll(r,"").length>0?".".concat(n):S},m=h.slice();m.push(function(S){S.type===cu&&S.value.includes("&")&&(S.props[0]=S.props[0].replace(CT,r).replace(o,g))}),u.prefix&&m.push(QA),m.push(KA);var y=function(S,E,w,T){E===void 0&&(E=""),w===void 0&&(w=""),T===void 0&&(T="&"),n=T,r=E,o=new RegExp("\\".concat(r,"\\b"),"g");var C=S.replace(_T,""),F=VA(w||E?"".concat(w," ").concat(E," { ").concat(C," }"):C);u.namespace&&(F=Y0(F,u.namespace));var B=[];return ql(F,qA(m.concat(ZA(function(D){return B.push(D)})))),B};return y.hash=h.length?h.reduce(function(S,E){return E.name||sa(15),go(S,E.name)},B0).toString():"",y}var PT=new Jl,sf=RT(),j0=Xn.createContext({shouldForwardProp:void 0,styleSheet:PT,stylis:sf});j0.Consumer;Xn.createContext(void 0);function af(){return Re.useContext(j0)}var NT=function(){function e(n,r){var o=this;this.inject=function(l,a){a===void 0&&(a=sf);var u=o.name+a.hash;l.hasNameForId(o.id,u)||l.insertRules(o.id,u,a(o.rules,u,"@keyframes"))},this.name=n,this.id="sc-keyframes-".concat(n),this.rules=r,Mf(this,function(){throw sa(12,String(o.name))})}return e.prototype.getName=function(n){return n===void 0&&(n=sf),this.name+n.hash},e}(),DT=function(e){return e>="A"&&e<="Z"};function Am(e){for(var n="",r=0;r<e.length;r++){var o=e[r];if(r===1&&o==="-"&&e[0]==="-")return e;DT(o)?n+="-"+o.toLowerCase():n+=o}return n.startsWith("ms-")?"-"+n:n}var V0=function(e){return e==null||e===!1||e===""},X0=function(e){var n,r,o=[];for(var l in e){var a=e[l];e.hasOwnProperty(l)&&!V0(a)&&(Array.isArray(a)&&a.isCss||Co(a)?o.push("".concat(Am(l),":"),a,";"):Vs(a)?o.push.apply(o,js(js(["".concat(l," {")],X0(a),!1),["}"],!1)):o.push("".concat(Am(l),": ").concat((n=l,(r=a)==null||typeof r=="boolean"||r===""?"":typeof r!="number"||r===0||n in JA||n.startsWith("--")?String(r).trim():"".concat(r,"px")),";")))}return o};function Xi(e,n,r,o){if(V0(e))return[];if(kf(e))return[".".concat(e.styledComponentId)];if(Co(e)){if(!Co(a=e)||a.prototype&&a.prototype.isReactComponent||!n)return[e];var l=e(n);return Xi(l,n,r,o)}var a;return e instanceof NT?r?(e.inject(r,o),[e.getName(o)]):[e]:Vs(e)?X0(e):Array.isArray(e)?Array.prototype.concat.apply(pu,e.map(function(u){return Xi(u,n,r,o)})):[e.toString()]}function K0(e){for(var n=0;n<e.length;n+=1){var r=e[n];if(Co(r)&&!kf(r))return!1}return!0}var OT=H0(gu),kT=function(){function e(n,r,o){this.rules=n,this.staticRulesId="",this.isStatic=(o===void 0||o.isStatic)&&K0(n),this.componentId=r,this.baseHash=go(OT,r),this.baseStyle=o,Jl.registerId(r)}return e.prototype.generateAndInjectStyles=function(n,r,o){var l=this.baseStyle?this.baseStyle.generateAndInjectStyles(n,r,o):"";if(this.isStatic&&!o.hash)if(this.staticRulesId&&r.hasNameForId(this.componentId,this.staticRulesId))l=Ar(l,this.staticRulesId);else{var a=rf(Xi(this.rules,n,r,o)),u=nf(go(this.baseHash,a)>>>0);if(!r.hasNameForId(this.componentId,u)){var d=o(a,".".concat(u),void 0,this.componentId);r.insertRules(this.componentId,u,d)}l=Ar(l,u),this.staticRulesId=u}else{for(var h=go(this.baseHash,o.hash),g="",m=0;m<this.rules.length;m++){var y=this.rules[m];if(typeof y=="string")g+=y;else if(y){var S=rf(Xi(y,n,r,o));h=go(h,S+m),g+=S}}if(g){var E=nf(h>>>0);r.hasNameForId(this.componentId,E)||r.insertRules(this.componentId,E,o(g,".".concat(E),void 0,this.componentId)),l=Ar(l,E)}}return l},e}(),Ff=Xn.createContext(void 0);Ff.Consumer;var Td={};function MT(e,n,r){var o=kf(e),l=e,a=!Ad(e),u=n.attrs,d=u===void 0?pu:u,h=n.componentId,g=h===void 0?function(H,x){var U=typeof H!="string"?"sc":hm(H);Td[U]=(Td[U]||0)+1;var $="".concat(U,"-").concat(b0(gu+U+Td[U]));return x?"".concat(x,"-").concat($):$}(n.displayName,n.parentComponentId):h,m=n.displayName,y=m===void 0?function(H){return Ad(H)?"styled.".concat(H):"Styled(".concat(oT(H),")")}(e):m,S=n.displayName&&n.componentId?"".concat(hm(n.displayName),"-").concat(n.componentId):n.componentId||g,E=o&&l.attrs?l.attrs.concat(d).filter(Boolean):d,w=n.shouldForwardProp;if(o&&l.shouldForwardProp){var T=l.shouldForwardProp;if(n.shouldForwardProp){var C=n.shouldForwardProp;w=function(H,x){return T(H,x)&&C(H,x)}}else w=T}var F=new kT(r,S,o?l.componentStyle:void 0);function B(H,x){return function(U,$,J){var Ce=U.attrs,_e=U.componentStyle,Ge=U.defaultProps,Ne=U.foldedComponentIds,Pe=U.styledComponentId,de=U.target,Ue=Xn.useContext(Ff),Ae=af(),ne=U.shouldForwardProp||Ae.shouldForwardProp,W=U0($,Ue,Ge)||Eo,X=function(ye,se,we){for(var Te,q=Lt(Lt({},se),{className:void 0,theme:we}),re=0;re<ye.length;re+=1){var Le=Co(Te=ye[re])?Te(q):Te;for(var he in Le)q[he]=he==="className"?Ar(q[he],Le[he]):he==="style"?Lt(Lt({},q[he]),Le[he]):Le[he]}return se.className&&(q.className=Ar(q.className,se.className)),q}(Ce,$,W),Y=X.as||de,R={};for(var L in X)X[L]===void 0||L[0]==="$"||L==="as"||L==="theme"&&X.theme===W||(L==="forwardedAs"?R.as=X.forwardedAs:ne&&!ne(L,Y)||(R[L]=X[L]));var K=function(ye,se){var we=af(),Te=ye.generateAndInjectStyles(se,we.styleSheet,we.stylis);return Te}(_e,X),ie=Ar(Ne,Pe);return K&&(ie+=" "+K),X.className&&(ie+=" "+X.className),R[Ad(Y)&&!L0.has(Y)?"class":"className"]=ie,R.ref=J,Re.createElement(Y,R)}(D,H,x)}B.displayName=y;var D=Xn.forwardRef(B);return D.attrs=E,D.componentStyle=F,D.displayName=y,D.shouldForwardProp=w,D.foldedComponentIds=o?Ar(l.foldedComponentIds,l.styledComponentId):"",D.styledComponentId=S,D.target=o?l.target:e,Object.defineProperty(D,"defaultProps",{get:function(){return this._foldedDefaultProps},set:function(H){this._foldedDefaultProps=o?function(x){for(var U=[],$=1;$<arguments.length;$++)U[$-1]=arguments[$];for(var J=0,Ce=U;J<Ce.length;J++)of(x,Ce[J],!0);return x}({},l.defaultProps,H):H}}),Mf(D,function(){return".".concat(D.styledComponentId)}),a&&z0(D,e,{attrs:!0,componentStyle:!0,displayName:!0,foldedComponentIds:!0,shouldForwardProp:!0,styledComponentId:!0,target:!0}),D}function Tm(e,n){for(var r=[e[0]],o=0,l=n.length;o<l;o+=1)r.push(n[o],e[o+1]);return r}var Im=function(e){return Object.assign(e,{isCss:!0})};function q0(e){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];if(Co(e)||Vs(e))return Im(Xi(Tm(pu,js([e],n,!0))));var o=e;return n.length===0&&o.length===1&&typeof o[0]=="string"?Xi(o):Im(Xi(Tm(o,n)))}function lf(e,n,r){if(r===void 0&&(r=Eo),!n)throw sa(1,n);var o=function(l){for(var a=[],u=1;u<arguments.length;u++)a[u-1]=arguments[u];return e(n,r,q0.apply(void 0,js([l],a,!1)))};return o.attrs=function(l){return lf(e,n,Lt(Lt({},r),{attrs:Array.prototype.concat(r.attrs,l).filter(Boolean)}))},o.withConfig=function(l){return lf(e,n,Lt(Lt({},r),l))},o}var Z0=function(e){return lf(MT,e)},An=Z0;L0.forEach(function(e){An[e]=Z0(e)});var FT=function(){function e(n,r){this.rules=n,this.componentId=r,this.isStatic=K0(n),Jl.registerId(this.componentId+1)}return e.prototype.createStyles=function(n,r,o,l){var a=l(rf(Xi(this.rules,r,o,l)),""),u=this.componentId+n;o.insertRules(u,u,a)},e.prototype.removeStyles=function(n,r){r.clearRules(this.componentId+n)},e.prototype.renderStyles=function(n,r,o,l){n>2&&Jl.registerId(this.componentId+n),this.removeStyles(n,o),this.createStyles(n,r,o,l)},e}();function UT(e){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];var o=q0.apply(void 0,js([e],n,!1)),l="sc-global-".concat(b0(JSON.stringify(o))),a=new FT(o,l),u=function(h){var g=af(),m=Xn.useContext(Ff),y=Xn.useRef(g.styleSheet.allocateGSInstance(l)).current;return g.styleSheet.server&&d(y,h,g.styleSheet,m,g.stylis),Xn.useLayoutEffect(function(){if(!g.styleSheet.server)return d(y,h,g.styleSheet,m,g.stylis),function(){return a.removeStyles(y,g.styleSheet)}},[y,h,g.styleSheet,m,g.stylis]),null};function d(h,g,m,y,S){if(a.isStatic)a.renderStyles(h,tT,m,S);else{var E=Lt(Lt({},g),{theme:U0(g,y,u.defaultProps)});a.renderStyles(h,E,m,S)}}return Xn.memo(u)}function Q0(e,n){var r=Re.useRef(null),o=Re.useRef(!1),l=Re.useRef(e);l.current=e;var a=Re.useCallback(function(d){o.current&&(l.current(d),r.current=requestAnimationFrame(a))},[]),u=Re.useMemo(function(){return[function(){o.current&&(o.current=!1,r.current&&cancelAnimationFrame(r.current))},function(){o.current||(o.current=!0,r.current=requestAnimationFrame(a))},function(){return o.current}]},[]);return Re.useEffect(function(){return u[0]},[]),u}function LT(e,n,r,o,l){var u;(u=e.onExit)==null||u.call(e,o,n);const a=l.find(({id:d})=>d===n);return a!=null&&a.onEnter?a.onEnter(o,r):{...r,enteredAt:o.updateContext.gameState.time}}function BT(e,n){return n.find(({id:r})=>r===e)}function HT(e,n){return e!==n}function bT(e){console.warn(`No handler found for state: ${e}`)}const Hs="bushGrowing",Sr="bushFull",Vl="bushSpreading",Xs="bushDying",At=24,Tt=10,et=3e3,tt=3e3,Uf=2,GT=15,xT=5e3,di=100,fi=20,hi=60,$T=1e3,zT=5,WT=3,YT=12,jT=940,uf=20,wm=90,J0=45,ev=240,_o=5,VT=.5,Em=100,XT=300,Zi=30,gi=.1,Ms=.9,be=1,Tr=3,KT=70;function Oe(e,n,r,o,l){const a={id:e.nextVisualEffectId,type:n,position:r,startTime:e.time,duration:o,entityId:l};return e.visualEffects.push(a),e.nextVisualEffectId++,a.id}var le=(e=>(e[e.Hunger=0]="Hunger",e[e.Procreation=1]="Procreation",e[e.Pregnant=2]="Pregnant",e[e.TargetAcquired=3]="TargetAcquired",e[e.Attack=4]="Attack",e[e.Partnered=5]="Partnered",e[e.BushClaimed=6]="BushClaimed",e[e.BushClaimLost=7]="BushClaimLost",e[e.Eating=8]="Eating",e[e.ChildFed=9]="ChildFed",e[e.AttackDeflected=10]="AttackDeflected",e[e.AttackResisted=11]="AttackResisted",e[e.Hit=12]="Hit",e[e.SeizeBuildup=13]="SeizeBuildup",e[e.Seize=14]="Seize",e[e.CallToAttack=15]="CallToAttack",e[e.CallToFollow=16]="CallToFollow",e[e.AutopilotMoveTarget=17]="AutopilotMoveTarget",e))(le||{}),qn=(e=>(e.Berry="berry",e.Meat="meat",e))(qn||{});const tv={berry:"",meat:""},qT={id:Hs,update:(e,n)=>{const{entity:r,updateContext:o}=n,l=o.deltaTime*(At/Tt);return r.age+=l,r.age>=r.lifespan?{nextState:Xs,data:{...e,enteredAt:o.gameState.time}}:(r.ownerId&&r.claimedUntil&&o.gameState.time>r.claimedUntil&&(Oe(o.gameState,le.BushClaimLost,r.position,be),r.ownerId=void 0,r.claimedUntil=void 0),r.timeSinceLastBerryRegen+=l,r.timeSinceLastBerryRegen>=YT&&r.food.length<r.maxFood&&(r.food.push({type:qn.Berry}),r.timeSinceLastBerryRegen=0),r.food.length>=r.maxFood?{nextState:Sr,data:{...e,enteredAt:o.gameState.time,previousState:Hs}}:{nextState:Hs,data:e})},onEnter:(e,n)=>({...n,enteredAt:e.updateContext.gameState.time})},ZT={id:Sr,update:(e,n)=>{const{entity:r,updateContext:o}=n,l=o.deltaTime*(At/Tt);return r.age+=l,r.age>=r.lifespan?{nextState:Xs,data:{...e,enteredAt:o.gameState.time,previousState:Sr}}:r.food.length<r.maxFood?{nextState:Hs,data:{...e,enteredAt:o.gameState.time,previousState:Sr}}:(r.ownerId&&r.claimedUntil&&o.gameState.time>r.claimedUntil&&(Oe(o.gameState,le.BushClaimLost,r.position,be),r.ownerId=void 0,r.claimedUntil=void 0),r.timeSinceLastSpreadAttempt+=l,r.timeSinceLastSpreadAttempt>=wm&&(r.timeSinceLastSpreadAttempt=0,o.gameState.time-r.timeSinceLastHarvest>=wm&&Math.random()<o.gameState.ecosystem.berryBushSpreadChance)?{nextState:Vl,data:{...e,enteredAt:o.gameState.time,previousState:Sr}}:{nextState:Sr,data:e})},onEnter:(e,n)=>({...n,enteredAt:e.updateContext.gameState.time})},Ks=1,cf=150*.6,QT=150*.25,JT=150*.7,eI=150*.8,Cm=300,tI=600,nv=100,nI=250,iI=120,rI=2,_m=400,oI=1e3,sI=150*.85,aI=100,lI=3,uI=96,cI=24,dI=600,iv=600,fI=1,hI=24,gI=1,pI=.5,mI=2,df=24,ff=12,vI=24,Rm=24,yI=1500,Id=500,SI=400,AI=10,TI=-5,II=1.5,wI=1.5,EI=1.2,CI=10,_I=150,RI=200,PI=100,NI=100,DI=.7,OI=300,kI=100,MI=120,Pm=400,rv=.15,ov=200,Xl=30*.75*1.2,FI=20,mu=10,qs=80,UI=3,Es=5,Nr=150,sv=Nr*.8,LI=Nr*.2,Dr=Nr*.95,Qi=30,av=10,BI=10,HI=.5,It=30,Or=It*.75,lv=50,bI=20,GI=qs*.8,xI=.7,$I=16,uv=40,zI=24,Lf=16,WI=72/3,Nm=24,YI=1.25,jI=1.5,Bf=Nr*.6,Hf=50,VI=1,XI=350,cv=qs*.65,KI=80,qI=50,ZI=1,QI=128,dv=10,Dm=100,bf=35,Kn=It,fv=.5,vu=2.5,JI=5,Gf=.5,xf=1.5,ew=.1,tw=.5,nw=1.5,iw=.25,rw=2.5,ow=45,sw=.05;function On(e,n){return{x:e.x+n.x,y:e.y+n.y}}function hv(e,n){return{x:e.x-n.x,y:e.y-n.y}}function Pt(e,n){return{x:e.x*n,y:e.y*n}}function Ro(e){return Math.sqrt(e.x*e.x+e.y*e.y)}function nt(e){const n=Ro(e);return n===0?{x:0,y:0}:Pt(e,1/n)}function aw(e,n){return Ro(hv(e,n))}function $f(e,n,r){return{x:e.x+(n.x-e.x)*r,y:e.y+(n.y-e.y)*r}}function zf(e){if(e.length===0)return{x:0,y:0};const n=e.reduce((r,o)=>({x:r.x+o.x,y:r.y+o.y}),{x:0,y:0});return{x:n.x/e.length,y:n.y/e.length}}function ze(e,n,r,o){let l=n.x-e.x,a=n.y-e.y;return Math.abs(l)>r/2&&(l=l-Math.sign(l)*r),Math.abs(a)>o/2&&(a=a-Math.sign(a)*o),{x:l,y:a}}function Ut(e,n,r){const o=ze(e,n,r.width,r.height);return nt(o)}function V(e,n,r,o){const l=ze(e,n,r,o);return Ro(l)}function lw(e,n){return e.x*n.x+e.y*n.y}function uw(e,n){const r=lw(e,n),o=Ro(e),l=Ro(n);if(o===0||l===0)return 0;const a=Math.max(-1,Math.min(1,r/(o*l)));return Math.acos(a)}function cw(e,n,r){const o=Math.max(0,Math.min(1,r)),l={r:parseInt(e.substring(1,3),16),g:parseInt(e.substring(3,5),16),b:parseInt(e.substring(5,7),16)},a={r:parseInt(n.substring(1,3),16),g:parseInt(n.substring(3,5),16),b:parseInt(n.substring(5,7),16)},u=Math.round(l.r+(a.r-l.r)*o),d=Math.round(l.g+(a.g-l.g)*o),h=Math.round(l.b+(a.b-l.b)*o),g=m=>("00"+m.toString(16)).slice(-2);return`#${g(u)}${g(d)}${g(h)}`}var St=(e=>(e.Friendly="Friendly",e.Hostile="Hostile",e))(St||{}),Rt=(e=>(e[e.None=0]="None",e[e.General=1]="General",e[e.Performance=2]="Performance",e[e.Ecosystem=3]="Ecosystem",e))(Rt||{});function Om(e,n,r){return n.search.human.byRadius(e.position,r).filter(a=>{if(a.id===e.id||a.gender===e.gender||!a.isAdult||a.hunger>=Dr||(a.procreationCooldown||0)>0||a.gender==="female"&&a.isPregnant)return!1;const u=a.id===e.motherId||a.id===e.fatherId,d=e.id===a.motherId||e.id===a.fatherId;return!u&&!d})}function pi(e){if(e.length===0)return;const n=e.filter(l=>l.gender==="male"),r=e.filter(l=>l.gender==="female"),o=(l,a)=>l.age!==a.age?a.age-l.age:l.id-a.id;if(n.sort(o),n.length>0)return n[0];if(r.sort(o),r.length>0)return r[0]}function Nt(e,n){const r=e,o=r.search.human.byProperty("motherId",n.id),l=r.search.human.byProperty("fatherId",n.id);return[...o,...l]}function gv(e,n,r){var l;if(e.id===n.id||e.motherId===n.id||e.fatherId===n.id||n.motherId===e.id||n.fatherId===e.id||e.motherId&&e.motherId===n.motherId||e.fatherId&&e.fatherId===n.fatherId||(l=e.partnerIds)!=null&&l.includes(n.id))return!0;if(e.motherId){const a=r.entities.entities[e.motherId];if(a&&(a.motherId===n.id||a.fatherId===n.id))return!0}if(e.fatherId){const a=r.entities.entities[e.fatherId];if(a&&(a.motherId===n.id||a.fatherId===n.id))return!0}if(n.motherId){const a=r.entities.entities[n.motherId];if(a&&(a.motherId===e.id||a.fatherId===e.id))return!0}if(n.fatherId){const a=r.entities.entities[n.fatherId];if(a&&(a.motherId===e.id||a.fatherId===e.id))return!0}return!1}function hf(e,n){var a,u,d,h;if(e.id===n.id||e.motherId===n.id||e.fatherId===n.id||n.motherId===e.id||n.fatherId===e.id||(a=e.partnerIds)!=null&&a.includes(n.id)||(u=n.partnerIds)!=null&&u.includes(e.id))return!0;if(e.fatherId===void 0&&e.motherId===void 0||n.fatherId===void 0&&n.motherId===void 0)return!1;const r=e.motherId===n.motherId||e.fatherId===n.fatherId,o=n.motherId===e.motherId||n.fatherId===e.fatherId,l=((d=e.ancestorIds)==null?void 0:d.some(g=>n.ancestorIds.includes(g)))||((h=n.ancestorIds)==null?void 0:h.some(g=>e.ancestorIds.includes(g)));return r||o||l}function dw(e,n){const r=[];if(e.motherId){const o=n.entities.entities[e.motherId];o&&r.push(o)}if(e.fatherId){const o=n.entities.entities[e.fatherId];o&&r.push(o)}return r}function fw(e,n){if(e.gender!=="female"||!e.partnerIds||e.partnerIds.length===0)return null;for(const r of e.partnerIds){const o=n.entities.entities[r];if(o&&o.gender==="male")return o}return null}function hw(e,n){var r;if(!e.isAdult&&e.fatherId){const o=n.entities.entities[e.fatherId];if(o&&o.type==="human")return o}if(e.isAdult&&e.fatherId){const o=n.entities.entities[e.fatherId];if(o&&o.type==="human"&&((r=pi(Nt(n,o)))==null?void 0:r.id)===e.id)return o}return e.isAdult&&e.gender==="female"&&e.partnerIds&&e.partnerIds.length>0?fw(e,n):null}function eu(e,n){var o;const r=new Set;if(e.motherId){const l=n.entities.entities[e.motherId];l&&r.add(l)}if(e.fatherId){const l=n.entities.entities[e.fatherId];l&&r.add(l)}return(o=e.partnerIds)==null||o.forEach(l=>{const a=n.entities.entities[l];a&&r.add(a)}),Nt(n,e).forEach(l=>r.add(l)),Array.from(r)}function pv(e,n){const r=new Map;function o(l){const a=Nt(n,l);for(const u of a)r.has(u.id)||(r.set(u.id,u),o(u))}return o(e),Array.from(r.values())}function Zs(e,n){return n.search.human.byProperty("leaderId",e)}function mv(e,n){var u,d;const r=new Map,o=Object.values(e.entities.entities).filter(h=>h.type==="human");for(const h of o)h.leaderId&&(r.has(h.leaderId)||r.set(h.leaderId,{leaderId:h.leaderId,tribeBadge:h.tribeBadge||"?",members:[]}),(u=r.get(h.leaderId))==null||u.members.push(h));const l=n?(d=e.entities.entities[n])==null?void 0:d.diplomacy:void 0,a=Array.from(r.values()).map(h=>{const g=e.entities.entities[h.leaderId],m=h.members.filter(S=>S.isAdult).length,y=h.members.length-m;return{leaderId:h.leaderId,tribeBadge:h.tribeBadge,adultCount:m,childCount:y,isPlayerTribe:h.leaderId===n,leaderAge:(g==null?void 0:g.age)??0,leaderGender:(g==null?void 0:g.gender)??"male",diplomacyStatus:(l==null?void 0:l[h.leaderId??-1])??St.Friendly}});return a.sort((h,g)=>h.isPlayerTribe?-1:g.isPlayerTribe?1:g.adultCount+g.childCount-(h.adultCount+h.childCount)),a}function gf(e,n){return e.leaderId?n.search.human.byProperty("leaderId",e.leaderId):[]}function De(e,n,r,o,l){const a=n,u=o,d="position"in e&&e.id?e:null,h=d?d.position:e,g=a.search[r].byRadius(h,u);let m=null,y=u;for(const S of g){if(S.id===(d==null?void 0:d.id)||l&&!l(S))continue;const E=V(h,S.position,n.mapDimensions.width,n.mapDimensions.height);E<y&&(y=E,m=S)}return m}function vv(e,n,r,o){return n.search[r].byRadius(e,o)}function pf(e,n,r,o){return vv(e,n,r,o).length}function wt(e){const r=e.search.human.byProperty("isPlayer",!0);return r.length>0?r[0]:void 0}function gw(e,n){var u;const o=n.search.human.byProperty("activeAction","attacking");let l=null,a=1/0;for(const d of o){if(d.attackTargetId!==e)continue;const h=V(d.position,((u=n.entities.entities[e])==null?void 0:u.position)||{x:0,y:0},n.mapDimensions.width,n.mapDimensions.height);h<a&&(l=d,a=h)}return l}function pw(e){return Object.values(e.entities.entities).filter(n=>n.type==="human")}function mw(e,n,r){const o=Object.values(n.entities.entities).reverse();for(const l of o)if(aw(e,l.position)<l.radius)return l}function Wf(e,n,r,o){const l=Math.random()*Math.PI*2,a=Math.sqrt(Math.random())*n,u={x:Math.cos(l)*a,y:Math.sin(l)*a},d=On(e,u);return{x:(d.x%r+r)%r,y:(d.y%o+o)%o}}function kn(e,n,r,o){const l=n,a={left:e.x-r,top:e.y-r,right:e.x+r,bottom:e.y+r},u=[...l.search.human.byRect(a),...l.search.berryBush.byRect(a),...l.search.corpse.byRect(a)];for(const d of u){if(o!==void 0&&d.id===o)continue;if(V(e,d.position,n.mapDimensions.width,n.mapDimensions.height)<r+d.radius)return!0}return!1}function yv(e,n,r,o,l){const a=n.mapDimensions.width,u=n.mapDimensions.height;if(!kn(e,n,o,l))return e;const d=o;for(let h=d;h<=r;h+=d){const g=Math.ceil(2*Math.PI*h/d);for(let m=0;m<g;m++){const y=m/g*2*Math.PI,S={x:Math.cos(y)*h,y:Math.sin(y)*h},E=On(e,S),w={x:(E.x%a+a)%a,y:(E.y%u+u)%u};if(!kn(w,n,o,l))return w}}return null}function kr(e,n){const r=Zs(e,n);if(r.length===0){const l=n.entities.entities[e];return l?l.position:{x:0,y:0}}const o=r.map(l=>l.position);return zf(o)}function km(e,n){const o=[...eu(e,n),e].map(l=>l.position);return zf(o)}function vw(e,n,r){return Tv(n,r).some(a=>Av(e,a,r))?!kn(e,r,Zi):!1}const tu={StorageSpot:"storageSpot",PlantingZone:"plantingZone"},aa={[tu.StorageSpot]:{name:"Storage Spot",description:"A designated area for storing excess food.",icon:"",dimensions:{width:40,height:40},constructionTimeHours:.1,destructionTimeHours:.1,cost:{}},[tu.PlantingZone]:{name:"Planting Zone",description:"An area marked for agricultural use.",icon:"",dimensions:{width:60,height:60},constructionTimeHours:.1,destructionTimeHours:.1,cost:{}}},yw=.5,Sw="#FFA500",Aw="#FF4500",Mm=4,Tw=10;function Sv(e){return aa[e].dimensions}function Iw(e){return aa[e].constructionTimeHours}function ww(e){return aa[e].destructionTimeHours}function Ew(e,n,r){return n.search.human.byRadius(e.position,r).filter(l=>{var a;return l.activeAction==="procreating"&&l.gender===e.gender&&typeof l.target=="number"&&((a=e.partnerIds)==null?void 0:a.includes(l.target))})[0]}function Cw(e,n,r){if(!e.leaderId)return;const o=n,l=o.search.berryBush.byRadius(e.position,r).filter(a=>a.ownerId===e.id);for(const a of l)if(a.claimedUntil&&n.time<a.claimedUntil){const u=o.search.human.byRadius(a.position,It);for(const d of u)if(!hf(d,e)&&d.activeAction==="gathering"&&d.target===a.id)return d}}function _w(e,n,r){const o=eu(e,n),l=n;for(const a of o){if(V(e.position,a.position,n.mapDimensions.width,n.mapDimensions.height)>r)continue;const d=l.search.human.byProperty("attackTargetId",a.id);for(const h of d)if(h.leaderId!==e.leaderId)return{familyMember:a,aggressor:h}}}function Rw(e,n){const o=n.search.human.byRadius(e.position,OI);let l,a=1/0;for(const u of o){if(u.id===e.id||u.hitpoints<=0||u.hitpoints/u.maxHitpoints>DI||gv(e,u,n))continue;const d=V(e.position,u.position,n.mapDimensions.width,n.mapDimensions.height);d<a&&(a=d,l=u)}return l}function Pw(e,n){const r=De(e,n,"berryBush",Em,l=>l.ownerId===e.id);return r?yv(r.position,n,Em,Zi,r.id):null}function Yf(e,n,r){return n.search.human.byRadius(e.position,r).filter(l=>Uo(e,l,n))}function Nw(e,n,r){const o=r.search.human.byProperty("leaderId",e);let l=0;for(const a of o)a.attackTargetId===n&&l++;return l}function Fm(e,n,r,o){const l=r.search.berryBush.byRadius(e,n),a=r.search.human.byRadius(e,n).filter(h=>h.leaderId!==o);let u=l.length*AI;u+=a.length*TI;let d;if(a.length>0){const h={};for(const m of a)m.leaderId&&(h[m.leaderId]=(h[m.leaderId]||0)+1);let g=0;for(const m in h)h[m]>g&&(g=h[m],d=parseInt(m,10))}return{score:u,occupyingTribeId:d}}function nu(e){return e.filter(n=>n.isAdult).reduce((n,r)=>{let o=r.hitpoints;return o+=(r.maxAge-r.age)*.5,o+=r.food.length*2,n+o},0)}function Dw(e,n){if(e.id!==e.leaderId)return null;const r=n,o=kr(e.id,n),{score:l}=Fm(o,Id/2,r,e.id);let a=null,u=l;const d=SI,h=yI;for(let g=e.position.x-h;g<e.position.x+h;g+=d)for(let m=e.position.y-h;m<e.position.y+h;m+=d){const y={x:(g%n.mapDimensions.width+n.mapDimensions.width)%n.mapDimensions.width,y:(m%n.mapDimensions.height+n.mapDimensions.height)%n.mapDimensions.height};if(V(o,y,n.mapDimensions.width,n.mapDimensions.height)<Id*2)continue;const{score:E}=Fm(y,Id/2,r,e.id);E>u*II&&(u=E,a=y)}return a}function Av(e,n,r){const o=r.mapDimensions.width,l=r.mapDimensions.height;let a=e.x-n.position.x,u=e.y-n.position.y;return Math.abs(a)>o/2&&(a-=Math.sign(a)*o),Math.abs(u)>l/2&&(u-=Math.sign(u)*l),Math.abs(a)<=n.width/2&&Math.abs(u)<=n.height/2}function Ow(e){const n=Zi*2,r=Math.floor(e.width/n),o=Math.floor(e.height/n);return Math.max(1,r*o)}function kw(e,n){const r=n,o=Math.sqrt(e.width*e.width+e.height*e.height)/2;return r.search.berryBush.byRadius(e.position,o).filter(a=>Av(a.position,e,n)).length}function Tv(e,n){return e.leaderId?n.search.building.all().filter(l=>{if(l.buildingType!==tu.PlantingZone)return!1;if(l.ownerId){const a=n.entities.entities[l.ownerId];return a&&a.leaderId===e.leaderId}return!1}):[]}function Mw(e,n){const r=Tv(e,n);if(r.length===0)return null;const o=n.mapDimensions.width,l=n.mapDimensions.height;for(const a of r){const u=Ow(a);if(kw(a,n)>=u)continue;const h=20;for(let g=0;g<h;g++){const m=a.position.x+(Math.random()-.5)*a.width,y=a.position.y+(Math.random()-.5)*a.height,S={x:(m%o+o)%o,y:(y%l+l)%l};if(!kn(S,n,Zi))return S}}return null}const Et=30,Fo=Et*.6,jf="#4CAF50",Iv="#FF5722",wv="#9C27B0",Fw="#2196F3",Ev="#FFC107",Uw="#FFD700",Cv="#DC143C",Vf="#FFFFFF",Xf=[5,5],yu=5,Po=15,Lw=20,Bw=16,Hw=10,bw=16,Gw=16,Um=["","","","","","","","","",""],mf=8,xw="#FFFFFF",mn=18,qe=15,$w="rgba(0, 0, 0, 0.7)",zw=4,Li=150,nn=15,si=10,Wi="#555",Ww="#f44336",Yw="#4CAF50",jw="#2196F3",Vw="#FFC107",Il=16,gr=32,wl=28,Xw=10,Kw=8,qw=8,Zw=8,gn=28,El=40,Qw="rgba(255, 215, 0, 0.7)",Jw="rgba(0, 0, 0, 0.3)",zn=10,Lm=8,wd=11,Bi=20,Ed=40,Bm=5,eE=10,tE="#FFA500",nE="#808080",ci=120,_v=30,iE=20,$i="#2d3748",vn="#ffffff",Cl="#4a5568",Rv=5,Kf="#bdc9f792",Pv="#272c36ff",Nv="#a0aec0",iu=300,Dv="rgba(255, 255, 255, 0.5)",rE="rgba(0, 0, 0, 0.8)",oE="#FFFFFF",Hm=14,bm=8,Gm=-15,Ov="#FFD700",kv=5,sE=60,aE=-50,lE=10,Cd=12,xm=10,uE="rgba(0, 0, 0, 0.5)",cE="#4CAF50",dE="#F44336",fE="#FFC107",hE="rgba(255, 255, 255, 0.2)",$m="#FFFFFF",gE="#FF6B6B",pE=5,Mv=30,Cs=50,_l=8,zm=10,mE="rgba(0, 0, 0, 0.5)",vE="#FFFFFF",yE=33,SE=400,AE=20,TE=10,IE="rgba(0, 0, 0, 0.7)",wE="#FFFFFF",_d=20,Wm=16,EE=.5,Ym=5,Fv="#FFD700",CE=40,qf=4,Uv=3,_E=5,Lv=20,Bv=5,RE="#FFFFFF",PE="#FF6B6B",rn=80,pr=10,Rl=300,mr=15,NE=8,DE="rgba(0, 0, 0, 0.8)",OE="#FFFFFF",Rd=14,jm=10,Wn=20,kE="#FF6B6B",ME="#4CAF50",Vm="#FFD700",FE="rgba(255, 255, 0, 0.3)",UE=2,LE=500,BE=120,HE=45,bE="#FFD700",GE=3,xE=4;let Pd=0;function vf(){const e=Um[Pd];return Pd=(Pd+1)%Um.length,e}const Xm=40,$E=.3,zE=24,Km=500,No=10,Hv=250,Qs=12,bv=10;var ce=(e=>(e.Gather="Gather",e.Eat="Eat",e.Procreate="Procreate",e.Attack="Attack",e.Plant="Plant",e.CallToAttack="CallToAttack",e.TribeSplit="TribeSplit",e.FollowMe="FollowMe",e.FeedChild="FeedChild",e.HuntPrey="HuntPrey",e.DefendAgainstPredator="DefendAgainstPredator",e.Build="Build",e.Removal="Removal",e.Deposit="Deposit",e.Retrieve="Retrieve",e.AutopilotMove="AutopilotMove",e.AutopilotGather="AutopilotGather",e.AutopilotAttack="AutopilotAttack",e.AutopilotProcreate="AutopilotProcreate",e.AutopilotPlant="AutopilotPlant",e.AutopilotFeedChild="AutopilotFeedChild",e.AutopilotFollowMe="AutopilotFollowMe",e.AutopilotDeposit="AutopilotDeposit",e.AutopilotRetrieve="AutopilotRetrieve",e))(ce||{});const Su={Gather:"",Eat:"",Procreate:"",Attack:"",Plant:"",CallToAttack:"",TribeSplit:"",FollowMe:"",FeedChild:"",HuntPrey:"",DefendAgainstPredator:"",Build:"",Removal:"",Deposit:"",Retrieve:"",AutopilotMove:"",AutopilotGather:"",AutopilotAttack:"",AutopilotProcreate:"",AutopilotPlant:"",AutopilotFeedChild:"",AutopilotFollowMe:"",AutopilotDeposit:"",AutopilotRetrieve:""},Gv={Gather:"Gather",Eat:"Eat",Procreate:"Procreate",Attack:"Attack",Plant:"Plant",CallToAttack:"Call to Attack",TribeSplit:"Split Tribe",FollowMe:"Follow Me",FeedChild:"Feed Child",HuntPrey:"Hunt Prey",DefendAgainstPredator:"Defend",Build:"Build",Removal:"Remove",Deposit:"Deposit",Retrieve:"Retrieve",AutopilotMove:"Walk",AutopilotGather:"Gather",AutopilotAttack:"Attack",AutopilotProcreate:"Procreate",AutopilotPlant:"Plant",AutopilotFeedChild:"Feed",AutopilotFollowMe:"Follow",AutopilotDeposit:"Deposit",AutopilotRetrieve:"Retrieve"};var co=(e=>(e.Time="Time",e.Hunger="Hunger",e.Hitpoints="Hitpoints",e.Food="Food",e.Autopilot="Autopilot",e.Muted="Muted",e.Family="Family",e.Tribes="Tribes",e))(co||{});const _s={Time:"",Hunger:"",Hitpoints:"",Food:"",Autopilot:"",Muted:"",Family:"",Tribes:""};var ge=(e=>(e.ToggleMute="ToggleMute",e.TogglePause="TogglePause",e.FastForward="FastForward",e.DismissTutorial="DismissTutorial",e.ReturnToIntro="ReturnToIntro",e.ConfirmExitYes="ConfirmExitYes",e.ConfirmExitNo="ConfirmExitNo",e.CommandEat="CommandEat",e.CommandPlant="CommandPlant",e.CommandCallToAttack="CommandCallToAttack",e.CommandFollowMe="CommandFollowMe",e.CommandGather="CommandGather",e.CommandTribeSplit="CommandTribeSplit",e.CommandBuild="CommandBuild",e.SelectStorageSpot="SelectStorageSpot",e.SelectPlantingZone="SelectPlantingZone",e.SelectRemovalTool="SelectRemovalTool",e.ToggleProcreationBehavior="ToggleProcreationBehavior",e.ToggleAttackBehavior="ToggleAttackBehavior",e.ToggleFeedChildBehavior="ToggleFeedChildBehavior",e.TogglePlantingBehavior="TogglePlantingBehavior",e.ToggleGatheringBehavior="ToggleGatheringBehavior",e.ToggleAutopilotFollowLeaderBehavior="ToggleAutopilotFollowLeaderBehavior",e.ToggleDiplomacy="ToggleDiplomacy",e))(ge||{});const WE=12,YE=24,jE=150*.9,VE=24;var Js=(e=>(e.Hello="HELLO",e.NewTribeFormed="NEW_TRIBE_FORMED",e.NoHeir="NO_HEIR",e.ChildrenStarving="CHILDREN_STARVING",e))(Js||{});let XE=0;function KE(){return`notification-${Date.now()}-${XE++}`}function yf(e,n){if(n.identifier){const o=e.notifications.find(l=>l.identifier===n.identifier);if(o){if(o.dismissedUntil&&e.time<o.dismissedUntil)return;o.message=n.message,o.timestamp=e.time,o.creationTime=Date.now(),o.duration=n.duration,o.targetEntityIds=n.targetEntityIds,o.highlightedEntityIds=n.highlightedEntityIds,o.targetPosition=n.targetPosition,o.targetArea=n.targetArea,o.targetRadius=n.targetRadius,o.isDismissed=!1,o.dismissedUntil=void 0;return}}const r={...n,id:KE(),timestamp:e.time,creationTime:Date.now(),isDismissed:!1};e.notifications.push(r)}function qE(e,n){const r=e.notifications.find(o=>o.id===n);r&&(r.isDismissed=!0,r.identifier&&(r.dismissedUntil=e.time+VE))}function ZE(e){const n=e.time;e.notifications=e.notifications.filter(r=>r.duration===0?!0:!(n-r.timestamp>r.duration))}function QE(e){for(const r of Object.values(e.entities.entities))r.isHighlighted=!1;const n=e.notifications.filter(r=>!r.isDismissed);for(const r of n)if(r.highlightedEntityIds)for(const o of r.highlightedEntityIds){const l=e.entities.entities[o];l&&(l.isHighlighted=!0)}}const qm=600,JE=1.5,xv=.1,Pl=""+new URL("attack-D4MA8VWK.mp3",import.meta.url).href,Nd=""+new URL("gather-CU75596W.mp3",import.meta.url).href,eC=""+new URL("eat-DCjHq2QD.mp3",import.meta.url).href,Dd=""+new URL("procreate-CfE4r5Cp.mp3",import.meta.url).href,tC=""+new URL("birth-Cbd67GHT.mp3",import.meta.url).href,nC=""+new URL("child-fed-DzEPuMid.mp3",import.meta.url).href,iC=""+new URL("human-death-B6HFLXES.mp3",import.meta.url).href,rC=""+new URL("game-over-C5dqkyER.mp3",import.meta.url).href,oC=""+new URL("button-click-DomLUeaU.mp3",import.meta.url).href,sC=""+new URL("soundtrack-1-BdlYUGye.mp3",import.meta.url).href;var fe=(e=>(e[e.Attack=0]="Attack",e[e.Gather=1]="Gather",e[e.Eat=2]="Eat",e[e.Procreate=3]="Procreate",e[e.Birth=4]="Birth",e[e.ChildFed=5]="ChildFed",e[e.HumanDeath=6]="HumanDeath",e[e.Seize=7]="Seize",e[e.CallToAttack=8]="CallToAttack",e[e.TribeSplit=9]="TribeSplit",e[e.CallToFollow=10]="CallToFollow",e[e.StorageDeposit=11]="StorageDeposit",e[e.StorageRetrieve=12]="StorageRetrieve",e[e.StorageSteal=13]="StorageSteal",e[e.GameOver=14]="GameOver",e[e.ButtonClick=15]="ButtonClick",e[e.SoundTrack1=16]="SoundTrack1",e))(fe||{});const aC=new Map([[0,Pl],[1,Nd],[2,eC],[3,Dd],[4,tC],[5,nC],[6,iC],[14,rC],[15,oC],[7,Pl],[8,Pl],[9,Dd],[10,Dd],[11,Nd],[12,Nd],[13,Pl],[16,sC]]);let Rs,ea;function lC(){if(!(typeof window>"u"))return ea}function Zf(){if(!(typeof window>"u"))return!Rs&&typeof window.AudioContext=="function"&&(Rs=new window.AudioContext,ea=Rs.createGain(),ea.connect(Rs.destination),bs(.1,!1)),Rs}function bs(e,n){ea&&(ea.gain.value=n?0:e/10)}const $v=new Map;let Nl=!1,Zm=!1;async function uC(){if(Zm||Nl)return;const e=Zf();if(!e){console.error("AudioContext not supported. Cannot load sounds.");return}e.state==="suspended"&&e.resume(),Nl=!0,console.log("Starting sound loading...");const n=[];aC.forEach((r,o)=>{const l=fetch(r).then(a=>{if(!a.ok)throw new Error(`Failed to fetch sound: ${r}`);return a.arrayBuffer()}).then(a=>e.decodeAudioData(a)).then(a=>{$v.set(o,a)}).catch(a=>{console.error(`Error loading sound ${fe[o]} from ${r}:`,a)});n.push(l)});try{await Promise.all(n),Zm=!0,Nl=!1,console.log("All sounds loaded successfully.")}catch(r){Nl=!1,console.error("An error occurred while loading sounds:",r)}}const Gs=new Map;function Qf(e,n){const r=Zf(),o=lC();if(!r||!o||o.gain.value===0&&(n==null?void 0:n.trackId)===void 0)return;r.state==="suspended"&&r.resume();const l=$v.get(e);if(!l){console.warn(`Sound buffer not found for type: ${fe[e]}`);return}if(n!=null&&n.trackId&&Gs.has(n.trackId))return;const a=r.createBufferSource();a.buffer=l,a.loop=(n==null?void 0:n.loop)??!1;const u=r.createGain(),d=r.createStereoPanner();let h=u;if(n!=null&&n.position&&(n!=null&&n.listenerPosition)&&(n!=null&&n.worldDimensions)){const g=ze(n.listenerPosition,n.position,n.worldDimensions.width,n.worldDimensions.height),m=V(n.listenerPosition,n.position,n.worldDimensions.width,n.worldDimensions.height);if(m>qm)return;const y=1-Math.pow(m/qm,JE);u.gain.value=Math.max(0,y);const S=Math.sin(g.x/m*(Math.PI/2));d.pan.value=isNaN(S)?0:S,u.connect(d),h=d}else{const g=e===fe.GameOver?.4:e===fe.SoundTrack1?1:.2;u.gain.value=g}a.connect(h),h.connect(o),a.start(0),n!=null&&n.trackId&&(Gs.set(n.trackId,{sourceNode:a,gainNode:u}),a.onended=()=>{Gs.delete(n.trackId)})}function Od(e,n=1){const r=Gs.get(e),o=Zf();if(r&&o){const{sourceNode:l,gainNode:a}=r,u=o.currentTime;a.gain.setValueAtTime(a.gain.value,u),a.gain.linearRampToValueAtTime(0,u+n),l.stop(u+n),l.onended=null,Gs.delete(e)}}function Ie(e,n,r){const o=wt(e.gameState);o&&Qf(n,{position:r,listenerPosition:o.position,worldDimensions:e.gameState.mapDimensions,masterVolume:e.gameState.masterVolume,isMuted:e.gameState.isMuted})}function cC(e,n,r){const o=r.mapDimensions.width,l=r.mapDimensions.height,a=n.radius*2;for(let u=Km;u<o/2;u+=50)for(let d=0;d<10;d++){const h=Wf(e,u,o,l);if(!(V(e,h,o,l)<Km)&&!kn(h,r,a,n.id))return h}return null}function Jf(e,n){if(!e.isAdult||e.gender!=="male"||e.leaderId===e.id||!e.leaderId)return{canSplit:!1};if(!e.leaderId)return{canSplit:!1};const r=n.entities.entities[e.leaderId];if(!r||r.type!=="human")return{canSplit:!1};const o=pi(Nt(n,r));if(o&&o.id===e.id)return{canSplit:!1};const l=Zs(e.leaderId,n);if(l.length<Xm)return{canSplit:!1};const u=pv(e,n).length+1,d=Math.min(l.length*$E,Xm);return{canSplit:u>=d,progress:u/d}}function eh(e,n){if(!Jf(e,n).canSplit)return;const r=e.leaderId?n.entities.entities[e.leaderId]:void 0,o=vf(),l=pv(e,n);e.leaderId=e.id,e.tribeBadge=o,e.diplomacy={},r&&r.diplomacy&&(r.diplomacy[e.id]=St.Hostile);for(const u of l)u.leaderId=e.id,u.tribeBadge=o;yf(n,{type:Js.NewTribeFormed,message:`A new tribe has formed! ${o}`,duration:YE,targetEntityIds:[e.id],highlightedEntityIds:[e.id,...l.map(u=>u.id)]}),Ie({gameState:n},fe.TribeSplit,e.position)}const dC=20,Sn=30,fC=.5,hC=.3,gC=2,Sf=50;function th(e,n){const r=[];if(n.food.length>0&&n.hunger>Qi&&r.push({type:ce.Eat,action:"eating",key:"f"}),n.food.length<n.maxFood){const a=De(n,e,"berryBush",It,h=>h.food.length>0),u=De(n,e,"corpse",It,h=>h.food.length>0);let d=null;a&&u?d=V(n.position,a.position,e.mapDimensions.width,e.mapDimensions.height)<=V(n.position,u.position,e.mapDimensions.width,e.mapDimensions.height)?a:u:d=a||u,d&&r.push({type:ce.Gather,action:"gathering",key:"e",targetEntity:d})}const o=De(n,e,"human",It,a=>Mr(n,a,e));if(o&&r.push({type:ce.Procreate,action:"procreating",key:"r",targetEntity:o}),n.food.length>0&&n.isAdult){const a=De(n,e,"human",It,u=>{const d=u;return!d.isAdult&&(d.motherId===n.id||d.fatherId===n.id)&&d.hunger>=Qi});a&&r.push({type:ce.FeedChild,action:"feeding",key:"h",targetEntity:a})}const l=De(n,e,"human",Kn,a=>Uo(n,a,e))??De(n,e,"predator",Kn)??De(n,e,"prey",Kn);if(l&&r.push({type:ce.Attack,action:"attacking",key:"q",targetEntity:l}),n.food.filter(a=>a.type===qn.Berry).length>=_o&&r.push({type:ce.Plant,action:"planting",key:"b"}),n.food.length>0&&n.isAdult){const a=De(n,e,"building",Sn,u=>{const d=u;return d.buildingType==="storageSpot"&&d.ownerId===n.leaderId&&d.isConstructed&&d.storedFood!==void 0&&d.storageCapacity!==void 0&&d.storedFood.length<d.storageCapacity});a&&r.push({type:ce.Deposit,action:"idle",key:"x",targetEntity:a})}if(n.food.length<n.maxFood&&n.isAdult){const a=De(n,e,"building",Sn,u=>{const d=u;return d.buildingType==="storageSpot"&&d.ownerId===n.leaderId&&d.isConstructed&&d.storedFood!==void 0&&d.storedFood.length>0});a&&r.push({type:ce.Retrieve,action:"idle",key:"z",targetEntity:a})}return n.leaderId===n.id&&!n.isCallingToAttack&&Yf(n,e,Hv).length>0&&r.push({type:ce.CallToAttack,action:"idle",key:"v"}),Jf(n,e).canSplit&&r.push({type:ce.TribeSplit,action:"idle",key:"k"}),n.leaderId===n.id&&!n.isCallingToFollow&&r.push({type:ce.FollowMe,action:"idle",key:"c"}),r}const Uo=(e,n,r)=>{var o,l,a,u;if(e.id===n.id)return!1;if(e.leaderId&&!n.leaderId)return!0;if(e.leaderId===n.leaderId)return!1;if(e.leaderId&&n.leaderId){const d=(l=(o=r.entities.entities[e.leaderId])==null?void 0:o.diplomacy)==null?void 0:l[n.leaderId],h=(u=(a=r.entities.entities[n.leaderId])==null?void 0:a.diplomacy)==null?void 0:u[e.leaderId];return d===St.Hostile||h===St.Hostile}return!1},Mr=(e,n,r)=>{if(e.id===n.id||e.gender===n.gender||!e.isAdult||!n.isAdult||e.hunger>=Dr||n.hunger>=Dr||(e.procreationCooldown||0)>0||(n.procreationCooldown||0)>0||Uo(e,n,r))return!1;const o=e.gender==="female"?e:n;return!(o.isPregnant||o.age>uv)};function zv(e,n,r,o){if(r===void 0)return!1;const l=Sv(n),a=Math.sqrt(l.width*l.width+l.height*l.height)/2;if(kn(e,o,a*.8))return!1;const d=o.search.building.byRadius(e,a*2);for(const h of d){const g=V(e,h.position,o.mapDimensions.width,o.mapDimensions.height),m=(Math.max(l.width,l.height)+Math.max(h.width,h.height))/2;if(g<m*.9)return!1}return!0}function pC(e,n,r,o){return P1(o.entities,e,n,r)}function mC(e,n){const r=n.entities.entities[e];r&&r.type==="building"&&!r.isBeingDestroyed&&(r.isBeingDestroyed=!0,r.destructionProgress=0)}function vC(e,n){const l=n.search.building.byRadius(e,100);for(const a of l){let u=e.x-a.position.x,d=e.y-a.position.y;const h=n.mapDimensions.width,g=n.mapDimensions.height;if(Math.abs(u)>h/2&&(u-=Math.sign(u)*h),Math.abs(d)>g/2&&(d-=Math.sign(d)*g),Math.abs(u)<=a.width/2&&Math.abs(d)<=a.height/2)return a}}const yC={id:Vl,update:(e,n)=>{const{entity:r,updateContext:o}=n,{gameState:l}=o,a=o.deltaTime*(At/Tt);if(r.age+=a,r.age>=r.lifespan)return{nextState:Xs,data:{...e,enteredAt:l.time,previousState:Vl}};const u=Wf(r.position,r.spreadRadius,l.mapDimensions.width,l.mapDimensions.height);return kn(u,l,15)||ca(l.entities,u,l.time),{nextState:Sr,data:{...e,enteredAt:l.time,previousState:Vl}}},onEnter:(e,n)=>({...n,enteredAt:e.updateContext.gameState.time})},SC={id:Xs,update:e=>({nextState:Xs,data:e}),onEnter:(e,n)=>(Ho(e.updateContext.gameState.entities,e.entity.id),{...n,enteredAt:e.updateContext.gameState.time})},AC=[qT,ZT,yC,SC],ut="humanIdle",yr="humanMoving",Fs="humanEating",la="humanGathering",xs="humanDepositing",$s="humanRetrieving",ta="humanProcreating",Ji="humanAttacking",Kl="humanPlanting",TC={id:ut,update:(e,n)=>{const{entity:r,updateContext:o}=n;return r.activeAction==="attacking"&&r.attackTargetId?{nextState:Ji,data:{...e,enteredAt:o.gameState.time,previousState:ut,attackTargetId:r.attackTargetId,attackStartTime:o.gameState.time}}:(r.hunger>=sv?(r.debuffs=r.debuffs.filter(l=>l.type!=="slow"),r.debuffs.push({type:"slow",startTime:o.gameState.time,duration:.1})):r.debuffs=r.debuffs.filter(l=>l.type!=="slow"),r.activeAction==="moving"?{nextState:yr,data:{...e,enteredAt:o.gameState.time,previousState:ut,target:r.target}}:r.activeAction==="gathering"?{nextState:la,data:{...e,enteredAt:o.gameState.time,previousState:ut,target:r.target}}:r.activeAction==="eating"?{nextState:Fs,data:{...e,enteredAt:o.gameState.time,previousState:ut}}:r.activeAction==="planting"&&r.target?{nextState:Kl,data:{...e,enteredAt:o.gameState.time,previousState:ut,plantingSpot:r.target}}:r.activeAction==="depositing"?{nextState:xs,data:{...e,enteredAt:o.gameState.time,previousState:ut}}:r.activeAction==="retrieving"?{nextState:$s,data:{...e,enteredAt:o.gameState.time,previousState:ut}}:{nextState:ut,data:e})},onEnter:(e,n)=>(e.entity.acceleration=0,e.entity.velocity={x:0,y:0},{...n,enteredAt:e.updateContext.gameState.time})};function Wv(e){let n=BI;return e.hunger>=sv&&(n*=HI),e.age>=GI&&(n*=xI),e.movementSlowdown&&(n*=e.movementSlowdown.modifier),n}const kd=7.5;class IC{constructor(){ke(this,"id",yr)}update(n,r){var h;const{entity:o,updateContext:l}=r;if(o.activeAction==="attacking"&&o.attackTargetId)return{nextState:Ji,data:{...n,enteredAt:l.gameState.time,previousState:yr,attackTargetId:o.attackTargetId,attackStartTime:l.gameState.time}};if(o.activeAction!=="moving")return{nextState:ut,data:{...n,enteredAt:l.gameState.time,previousState:yr}};let a;if(typeof o.target=="object"?a=o.target:typeof o.target=="number"&&(a=(h=r.updateContext.gameState.entities.entities[o.target])==null?void 0:h.position),!a&&(o.direction.x!==0||o.direction.y!==0)&&(a={x:o.position.x+o.direction.x*kd*2,y:o.position.y+o.direction.y*kd*2}),!a)return{nextState:ut,data:{...n,enteredAt:l.gameState.time,previousState:yr}};const u=ze(o.position,a,r.updateContext.gameState.mapDimensions.width,r.updateContext.gameState.mapDimensions.height);return o.direction=nt(u),o.acceleration=Wv(o),V(o.position,a,l.gameState.mapDimensions.width,l.gameState.mapDimensions.height)<kd?{nextState:ut,data:{...n,enteredAt:l.gameState.time,previousState:yr}}:{nextState:yr,data:n}}onExit(n){const{entity:r}=n;r.acceleration=0}}const wC=new IC,EC={id:Fs,update:(e,n)=>{const{entity:r,updateContext:o}=n;return r.activeAction!=="eating"?{nextState:ut,data:{...e,enteredAt:o.gameState.time,previousState:Fs}}:(r.food.length>0&&(!r.eatingCooldownTime||o.gameState.time>=r.eatingCooldownTime)&&r.hunger>Qi&&(r.hunger=Math.max(0,r.hunger-Qi),r.food.pop(),r.eatingCooldownTime=o.gameState.time+1,Ie(o,fe.Eat,r.position),(!r.lastEatingEffectTime||o.gameState.time-r.lastEatingEffectTime>2)&&(Oe(o.gameState,le.Eating,r.position,be,r.id),r.lastEatingEffectTime=o.gameState.time)),r.hunger<=0||r.food.length<=0?{nextState:ut,data:{...e,enteredAt:o.gameState.time,previousState:Fs}}:{nextState:Fs,data:e})},onEnter:(e,n)=>(e.entity.acceleration=0,e.entity.velocity={x:0,y:0},{...n,enteredAt:e.updateContext.gameState.time})};class CC{constructor(){ke(this,"id",la)}update(n,r){return r.entity.activeAction!=="gathering"?{nextState:"humanIdle",data:{...n,enteredAt:r.updateContext.gameState.time,previousState:this.id}}:{nextState:this.id,data:n}}}const _C=new CC,RC={id:xs,update:(e,n)=>{const{entity:r}=n;return r.activeAction!=="depositing"?{nextState:ut,data:{...e,enteredAt:n.updateContext.gameState.time,previousState:xs}}:{nextState:xs,data:e}},onEnter:(e,n)=>{const{entity:r}=e;return r.activeAction="depositing",n},onExit:e=>{const{entity:n}=e;n.activeAction==="depositing"&&(n.activeAction="idle")}},PC={id:$s,update:(e,n)=>{const{entity:r}=n;return r.activeAction!=="retrieving"?{nextState:ut,data:{...e,enteredAt:n.updateContext.gameState.time,previousState:$s}}:{nextState:$s,data:e}},onEnter:(e,n)=>{const{entity:r}=e;return r.activeAction="retrieving",n},onExit:e=>{const{entity:n}=e;n.activeAction==="retrieving"&&(n.activeAction="idle")}},NC=(e,n)=>(n.procreationEndTime=e.updateContext.gameState.time+(n.duration||2),n),DC=(e,n)=>{const{entity:r,updateContext:o}=n,{gameState:l}=o;if(l.time<(e.procreationEndTime||0))return{nextState:ta,data:e};const a=l.entities.entities[e.partnerId];if(a&&a.type==="human"&&!a.isPregnant&&r.hunger<Dr&&a.hunger<Dr&&!r.procreationCooldown&&!a.procreationCooldown){const u=r.gender==="female"?r:a.gender==="female"?a:void 0,d=r.gender==="male"?r:a.gender==="male"?a:void 0;u&&d&&(u.isPregnant=!0,u.gestationTime=WI,u.pregnancyFatherId=d.id,r.procreationCooldown=Nm,a.procreationCooldown=Nm,Ie(o,fe.Procreate,u.position))}return r.activeAction="idle",a&&(a.activeAction="idle"),{nextState:ut,data:{...e,enteredAt:l.time,previousState:ta}}},OC={id:ta,onEnter:NC,update:DC},kC={id:Ji,onEnter:(e,n)=>({...n,enteredAt:e.updateContext.gameState.time,attackStartTime:e.updateContext.gameState.time}),update:(e,n)=>{if(n.entity.activeAction!=="attacking"||!n.entity.attackTargetId)return n.entity.activeAction="idle",{nextState:ut,data:{...e}};const r=n.updateContext.gameState.entities.entities[n.entity.attackTargetId];if(!r)return n.entity.activeAction="idle",{nextState:ut,data:{...e}};const o=V(n.entity.position,r.position,n.updateContext.gameState.mapDimensions.width,n.updateContext.gameState.mapDimensions.height),l=ze(n.entity.position,r.position,n.updateContext.gameState.mapDimensions.width,n.updateContext.gameState.mapDimensions.height);return n.entity.direction=nt(l),o>Kn?n.entity.acceleration=Wv(n.entity):n.entity.acceleration=0,{nextState:Ji,data:e}}},MC={id:Kl,update:(e,n)=>{const{entity:r,updateContext:o}=n,{gameState:l}=o;if(l.time-e.enteredAt>=VT){if(r.food.filter(d=>d.type===qn.Berry).length>=_o){for(let h=0;h<_o;h++){const g=r.food.findIndex(m=>m.type===qn.Berry);g>-1&&r.food.splice(g,1)}const d=ca(l.entities,e.plantingSpot,l.time);d.ownerId=r.id,d.claimedUntil=l.time+ev}return{nextState:ut,data:{...e,enteredAt:l.time,previousState:Kl}}}return{nextState:Kl,data:e}},onEnter:(e,n)=>(e.entity.acceleration=0,e.entity.velocity={x:0,y:0},{...n,enteredAt:e.updateContext.gameState.time})},FC=[TC,wC,EC,_C,RC,PC,OC,kC,MC],Pn="preyIdle",zi="preyMoving",Us="preyGrazing",Ls="preyProcreating",UC={id:Pn,update:(e,n)=>{const{entity:r,updateContext:o}=n;return r.activeAction==="moving"?{nextState:zi,data:{...e,enteredAt:o.gameState.time,previousState:Pn,target:r.target}}:r.activeAction==="grazing"?{nextState:Us,data:{...e,enteredAt:o.gameState.time,previousState:Pn}}:r.activeAction==="procreating"?{nextState:Ls,data:{...e,enteredAt:o.gameState.time,previousState:Pn}}:{nextState:Pn,data:e}},onEnter:(e,n)=>(e.entity.acceleration=0,e.entity.velocity={x:0,y:0},{...n,enteredAt:e.updateContext.gameState.time})},Yv=12,LC=120,Qm=50,BC=12,jv=30,HC=2,zt=50,bC=150,zs=2,Md=8,GC=.5,xC=1,$C=80,zC=.7,Vv=20,WC=140,Jm=40,YC=12,Xv=40,jC=3,Ki=60,Nn=40,fo=50,e0=320,Kv=25,VC=60,qv=2,XC=90,KC=.7,qC=1.5,Ws=3,Fd=15,nh=80,Zv=10,Au=80,Lo=40,Qv=2,ru=30,po=10,wr=40,mo=12,Er=48,vo=12,Cr=50,yo=18,_r=60,So=.5,Yi=2.5,Ao=.25,ji=2;function ZC(e){let n=BC;return e.isAdult||(n*=.7),e.hunger>=$C&&(n*=zC),e.movementSlowdown&&(n*=e.movementSlowdown.modifier),n}function QC(e,n){const r=e>>16&255,o=e>>8&255,l=e&255,a=n>>16&255,u=n>>8&255,d=n&255;let h=Math.floor((r+a)/2),g=Math.floor((o+u)/2),m=Math.floor((l+d)/2);return Math.random()<.05&&(h=Math.max(0,Math.min(255,h+(Math.random()-.5)*60))),Math.random()<.05&&(g=Math.max(0,Math.min(255,g+(Math.random()-.5)*60))),Math.random()<.05&&(m=Math.max(0,Math.min(255,m+(Math.random()-.5)*60))),h<<16|g<<8|m}function na(){const e=Math.floor(Math.random()*100)+100,n=Math.floor(Math.random()*80)+60,r=Math.floor(Math.random()*60)+20;return e<<16|n<<8|r}const Ud=10;class JC{constructor(){ke(this,"id",zi)}update(n,r){var h;const{entity:o,updateContext:l}=r;if(o.activeAction!=="moving")return{nextState:Pn,data:{...n,enteredAt:l.gameState.time,previousState:zi}};let a;if(typeof o.target=="object"?a=o.target:typeof o.target=="number"&&(a=(h=r.updateContext.gameState.entities.entities[o.target])==null?void 0:h.position),!a&&(o.direction.x!==0||o.direction.y!==0)&&(a={x:o.position.x+o.direction.x*Ud*2,y:o.position.y+o.direction.y*Ud*2}),!a)return{nextState:Pn,data:{...n,enteredAt:l.gameState.time,previousState:zi}};const u=ze(o.position,a,r.updateContext.gameState.mapDimensions.width,r.updateContext.gameState.mapDimensions.height);return o.direction=nt(u),o.acceleration=ZC(o),V(o.position,a,l.gameState.mapDimensions.width,l.gameState.mapDimensions.height)<Ud?{nextState:Pn,data:{...n,enteredAt:l.gameState.time,previousState:zi}}:{nextState:zi,data:n}}onExit(n){const{entity:r}=n;r.acceleration=0}onEnter(n,r){return{...r,enteredAt:n.updateContext.gameState.time}}}const e_=new JC,t_={id:Us,update:(e,n)=>{const{entity:r,updateContext:o}=n;return r.activeAction==="moving"?{nextState:zi,data:{...e,enteredAt:o.gameState.time,previousState:Us,target:r.target}}:r.activeAction!=="grazing"?{nextState:Pn,data:{...e,enteredAt:o.gameState.time,previousState:Us}}:{nextState:Us,data:e}},onEnter:(e,n)=>(e.entity.acceleration=0,e.entity.velocity={x:0,y:0},{...n,enteredAt:e.updateContext.gameState.time})},n_={id:Ls,update:(e,n)=>{const{entity:r,updateContext:o}=n;return r.activeAction==="moving"?{nextState:zi,data:{...e,enteredAt:o.gameState.time,previousState:Ls,target:r.target}}:r.activeAction!=="procreating"?{nextState:Pn,data:{...e,enteredAt:o.gameState.time,previousState:Ls}}:{nextState:Ls,data:e}},onEnter:(e,n)=>(e.entity.acceleration=0,e.entity.velocity={x:0,y:0},{...n,enteredAt:e.updateContext.gameState.time})},i_=[UC,e_,t_,n_],$t="predatorIdle",Gi="predatorMoving",ui="predatorAttacking",ho="predatorProcreating",Rr="predatorEating",r_={id:$t,update:(e,n)=>{const{entity:r,updateContext:o}=n;return r.activeAction==="eating"?{nextState:Rr,data:{...e,enteredAt:o.gameState.time,previousState:$t,preyId:r.attackTargetId,eatingStartTime:o.gameState.time}}:r.activeAction==="attacking"&&r.attackTargetId?{nextState:ui,data:{...e,enteredAt:o.gameState.time,previousState:$t,attackTargetId:r.attackTargetId,attackStartTime:o.gameState.time}}:r.activeAction==="moving"?{nextState:Gi,data:{...e,enteredAt:o.gameState.time,previousState:$t,target:r.target}}:r.activeAction==="procreating"?{nextState:ho,data:{...e,enteredAt:o.gameState.time,previousState:$t}}:{nextState:$t,data:e}},onEnter:(e,n)=>(e.entity.acceleration=0,e.entity.velocity={x:0,y:0},{...n,enteredAt:e.updateContext.gameState.time})};function Jv(e){let n=YC;return e.hunger>=XC&&(n*=KC),e.isAdult||(n*=.7),e.movementSlowdown&&(n*=e.movementSlowdown.modifier),n}function o_(e,n){const r=e>>16&255,o=e>>8&255,l=e&255,a=n>>16&255,u=n>>8&255,d=n&255;let h=Math.floor((r+a)/2),g=Math.floor((o+u)/2),m=Math.floor((l+d)/2);return Math.random()<.05&&(h=Math.max(0,Math.min(255,h+(Math.random()-.5)*60))),Math.random()<.05&&(g=Math.max(0,Math.min(255,g+(Math.random()-.5)*60))),Math.random()<.05&&(m=Math.max(0,Math.min(255,m+(Math.random()-.5)*60))),h<<16|g<<8|m}function ia(){const e=Math.floor(Math.random()*60)+60,n=Math.floor(Math.random()*50)+40,r=Math.floor(Math.random()*40)+20;return e<<16|n<<8|r}const Ld=12;class s_{constructor(){ke(this,"id",Gi)}update(n,r){var h;const{entity:o,updateContext:l}=r;if(o.activeAction==="eating")return{nextState:Rr,data:{...n,enteredAt:l.gameState.time,previousState:Gi,preyId:o.attackTargetId,eatingStartTime:l.gameState.time}};if(o.activeAction==="attacking"&&o.attackTargetId)return{nextState:ui,data:{...n,enteredAt:l.gameState.time,previousState:Gi,attackTargetId:o.attackTargetId,attackStartTime:l.gameState.time}};if(o.activeAction!=="moving")return{nextState:$t,data:{...n,enteredAt:l.gameState.time,previousState:Gi}};let a;if(typeof o.target=="object"?a=o.target:typeof o.target=="number"&&(a=(h=r.updateContext.gameState.entities.entities[o.target])==null?void 0:h.position),!a&&(o.direction.x!==0||o.direction.y!==0)&&(a={x:o.position.x+o.direction.x*Ld*2,y:o.position.y+o.direction.y*Ld*2}),!a)return{nextState:$t,data:{...n,enteredAt:l.gameState.time,previousState:Gi}};const u=ze(o.position,a,r.updateContext.gameState.mapDimensions.width,r.updateContext.gameState.mapDimensions.height);return o.direction=nt(u),o.acceleration=Jv(o),V(o.position,a,l.gameState.mapDimensions.width,l.gameState.mapDimensions.height)<Ld?{nextState:$t,data:{...n,enteredAt:l.gameState.time,previousState:Gi}}:{nextState:Gi,data:n}}onExit(n){const{entity:r}=n;r.acceleration=0}onEnter(n,r){return{...r,enteredAt:n.updateContext.gameState.time}}}const a_=new s_,l_={id:ui,update:(e,n)=>{const{entity:r,updateContext:o}=n;if(r.activeAction==="eating")return{nextState:Rr,data:{...e,enteredAt:o.gameState.time,previousState:ui,preyId:r.attackTargetId,eatingStartTime:o.gameState.time}};if(r.activeAction!=="attacking"||!r.attackTargetId)return r.activeAction="idle",{nextState:$t,data:{...e,enteredAt:o.gameState.time,previousState:ui}};const l=o.gameState.entities.entities[r.attackTargetId];if(!l)return r.activeAction="idle",{nextState:$t,data:{...e,enteredAt:o.gameState.time,previousState:ui}};if(l.type==="prey"&&l.hitpoints<=0||l.type==="predator"&&l.hitpoints<=0||l.type==="human"&&l.hitpoints<=0)return r.activeAction="idle",{nextState:$t,data:{...e,enteredAt:o.gameState.time,previousState:ui}};const u=V(r.position,l.position,o.gameState.mapDimensions.width,o.gameState.mapDimensions.height),d=ze(r.position,l.position,o.gameState.mapDimensions.width,o.gameState.mapDimensions.height);return r.direction=nt(d),u>Nn?r.acceleration=Jv(r):r.acceleration=0,{nextState:ui,data:e}},onEnter:(e,n)=>({...n,enteredAt:e.updateContext.gameState.time})},u_={id:ho,update:(e,n)=>{const{entity:r,updateContext:o}=n;return r.activeAction==="eating"?{nextState:Rr,data:{...e,enteredAt:o.gameState.time,previousState:ho,preyId:r.attackTargetId,eatingStartTime:o.gameState.time}}:r.activeAction==="attacking"&&r.attackTargetId?{nextState:ui,data:{...e,enteredAt:o.gameState.time,previousState:ho,attackTargetId:r.attackTargetId,attackStartTime:o.gameState.time}}:r.activeAction!=="procreating"?{nextState:$t,data:{...e,enteredAt:o.gameState.time,previousState:ho}}:{nextState:ho,data:e}},onEnter:(e,n)=>(e.entity.acceleration=0,e.entity.velocity={x:0,y:0},{...n,enteredAt:e.updateContext.gameState.time})},c_={id:Rr,update:(e,n)=>{const{entity:r,updateContext:o}=n;return r.activeAction!=="eating"?{nextState:$t,data:{...e,enteredAt:o.gameState.time,previousState:Rr}}:{nextState:Rr,data:e}},onEnter:(e,n)=>(e.entity.acceleration=0,e.entity.velocity={x:0,y:0},{...n,enteredAt:e.updateContext.gameState.time})},d_=[r_,a_,l_,u_,c_],t0=[...AC,...FC,...i_,...d_];function f_(e,n,r){const o=BT(e,t0);if(!o)return bT(e),[e,n];const{nextState:l,data:a}=o.update(n,r);return HT(e,l)?[l,LT(o,l,a,r,t0)]:[l,a]}function h_(e,n,r){const{gameState:o}=n,l=r*(At/Tt);if(e.isAdult=e.age>=Lf,e.isCallingToAttack&&e.callToAttackEndTime&&o.time>e.callToAttackEndTime&&(e.isCallingToAttack=!1,e.callToAttackEndTime=void 0),e.isCallingToFollow&&e.callToFollowEndTime&&o.time>e.callToFollowEndTime&&(e.isCallingToFollow=!1,e.callToFollowEndTime=void 0),e.movementSlowdown&&o.time>e.movementSlowdown.endTime&&(e.movementSlowdown=void 0),e.hitpoints<e.maxHitpoints){const u=1-e.hunger/100*tw,d=ew*u*l;e.hitpoints=Math.min(e.maxHitpoints,e.hitpoints+d)}if(e.hunger+=r*(Es/(At/Tt)),e.hunger>KT&&(!e.lastHungerEffectTime||o.time-e.lastHungerEffectTime>Tr*2)&&(Oe(o,le.Hunger,e.position,Tr,e.id),e.lastHungerEffectTime=o.time),e.age+=r/mu,e.isPlayer){const u=Nt(o,e).filter(d=>d.hunger>=jE);if(u.length>0){const d=u.map(h=>h.id);yf(o,{identifier:"children_starving",type:Js.ChildrenStarving,message:"Your children are starving!",duration:WE,targetEntityIds:d,highlightedEntityIds:d})}}if(e.gender==="female"&&e.isPregnant&&e.gestationTime&&(e.gestationTime-=l,e.hunger+=r*((Es*YI-Es)/(At/Tt)),(!e.lastPregnantEffectTime||o.time-e.lastPregnantEffectTime>Tr*3)&&(Oe(o,le.Pregnant,e.position,Tr,e.id),e.lastPregnantEffectTime=o.time),e.gestationTime<=0&&(R1(e,e.pregnancyFatherId,n),e.isPregnant=!1,e.gestationTime=0,e.pregnancyFatherId=void 0)),e.procreationCooldown&&(e.procreationCooldown-=l,e.procreationCooldown<0&&(e.procreationCooldown=0)),e.attackCooldown&&(e.attackCooldown-=l,e.attackCooldown<0&&(e.attackCooldown=0)),e.feedParentCooldownTime&&(e.feedParentCooldownTime-=l,e.feedParentCooldownTime<0&&(e.feedParentCooldownTime=0)),e.feedChildCooldownTime&&(e.feedChildCooldownTime-=l,e.feedChildCooldownTime<0&&(e.feedChildCooldownTime=0)),e.leaderMetaStrategyCooldown&&(e.leaderMetaStrategyCooldown-=l,e.leaderMetaStrategyCooldown<0&&(e.leaderMetaStrategyCooldown=0)),e.isAdult?e.radius===Fo&&(e.radius=Et):e.hunger+=r*((Es*jI-Es)/(At/Tt)),e.isAdult&&e.food.length>0&&(!e.feedParentCooldownTime||e.feedParentCooldownTime<=0)){const u=[];if(e.motherId){const d=o.entities.entities[e.motherId];d&&u.push(d)}if(e.fatherId){const d=o.entities.entities[e.fatherId];d&&u.push(d)}for(const d of u)if(d.age>=cv&&d.hunger>=KI&&V(e.position,d.position,o.mapDimensions.width,o.mapDimensions.height)<=qI){e.food.pop(),d.hunger=Math.max(0,d.hunger-Qi),e.feedParentCooldownTime=ZI;break}}let a;if(e.hitpoints<=0?a="killed":e.hunger>=Nr?e.food.length>0&&e.isAdult?(e.food.pop(),e.hunger=Math.max(0,e.hunger-Qi)):a="hunger":e.age>=e.maxAge&&(a="oldAge"),a){if(e.leaderId===e.id){const u=pi(Nt(o,e));u?(u.leaderId=u.id,u.tribeBadge=e.tribeBadge,u.diplomacy={...e.diplomacy},Object.values(o.entities.entities).forEach(d=>{if(d.type==="human"&&d.leaderId===e.id){const h=d;h.leaderId=u.id}if(d.type==="building"&&d.ownerId===e.id){const h=d;h.ownerId=u.id}})):Object.values(o.entities.entities).forEach(d=>{if(d.type==="human"&&d.leaderId===e.id){const h=d;h.leaderId=void 0,h.tribeBadge=void 0}if(d.type==="building"&&d.ownerId===e.id){const h=d;h.ownerId=void 0}})}if(e.isPlayer){const u=pi(Nt(o,e));u?(u.isPlayer=!0,o.generationCount++):(o.gameOver=!0,o.causeOfGameOver=a,yf(o,{identifier:"no_heir",type:Js.NoHeir,message:"Your lineage has ended. You have no heir.",duration:0}))}E1(o.entities,e.position,e.gender,e.age,e.radius,e.id,o.time,e.food,e.hunger),Ho(o.entities,e.id);return}e.animationProgress===void 0&&(e.animationProgress=0),e.animationSpeed===void 0&&(e.animationSpeed=1),e.animationProgress+=r*e.animationSpeed,e.animationProgress>=1&&(e.animationProgress=0)}function g_(e,n){const r=n.gameState.time-e.timeOfDeath;e.decayProgress=Math.min(1,r/QI);const o=Math.floor(dv*(1-e.decayProgress));e.food.length>o&&e.food.splice(o),e.decayProgress>=1&&e.food.length<=0&&Ho(n.gameState.entities,e.id)}function p_(e,n,r){const o=r*(At/Tt);e.age+=r/mu,e.isAdult=e.age>=zs;let l=n.gameState.ecosystem.preyHungerIncreasePerHour*o;if(e.isPregnant&&(l*=1.2),e.hunger+=l,e.isPregnant&&e.gestationTime!==void 0&&(e.gestationTime-=o,e.gestationTime<=0)){const u={x:e.position.x+(Math.random()-.5)*40,y:e.position.y+(Math.random()-.5)*40};u.x=Math.max(20,Math.min(n.gameState.mapDimensions.width-20,u.x)),u.y=Math.max(20,Math.min(n.gameState.mapDimensions.height-20,u.y));const d=Math.random()<.5?"male":"female",h=e,g=e.fatherId?n.gameState.entities.entities[e.fatherId]:void 0;let m;if(g)m=QC(h.geneCode,g.geneCode);else{m=h.geneCode;const y=Math.floor((Math.random()-.5)*4096);m=Math.max(0,Math.min(16777215,m+y))}Do(n.gameState.entities,u,d,0,jv*.5,m,e.id,e.fatherId),Oe(n.gameState,le.Procreation,e.position,Tr,e.id),Ie(n,fe.Birth,e.position),e.isPregnant=!1,e.gestationTime=0,e.procreationCooldown=n.gameState.ecosystem.preyProcreationCooldown,e.fatherId=void 0}e.procreationCooldown&&e.procreationCooldown>0&&(e.procreationCooldown-=o,e.procreationCooldown<0&&(e.procreationCooldown=0)),e.eatingCooldownTime&&e.eatingCooldownTime>n.gameState.time||(e.eatingCooldownTime=void 0),e.fleeCooldown&&e.fleeCooldown>0&&(e.fleeCooldown-=o,e.fleeCooldown<0&&(e.fleeCooldown=0)),e.feedChildCooldownTime&&e.feedChildCooldownTime>0&&(e.feedChildCooldownTime-=o,e.feedChildCooldownTime<0&&(e.feedChildCooldownTime=0));let a=!1;e.hunger>=LC&&(a=!0),e.hitpoints<=0&&(a=!0),e.age>=Yv&&(a=!0),a&&(C1(n.gameState.entities,e.position,e.gender,e.age,e.radius,e.id,n.gameState.time,e.geneCode),Ho(n.gameState.entities,e.id))}function m_(e,n,r){const o=r*(At/Tt);e.age+=r/mu,e.isAdult=e.age>=Ws;let l=n.gameState.ecosystem.predatorHungerIncreasePerHour*o;if(e.isPregnant&&(l*=1.3),e.hunger+=l,e.isPregnant&&e.gestationTime!==void 0&&(e.gestationTime-=o,e.gestationTime<=0)){const u={x:e.position.x+(Math.random()-.5)*50,y:e.position.y+(Math.random()-.5)*50};u.x=Math.max(25,Math.min(n.gameState.mapDimensions.width-25,u.x)),u.y=Math.max(25,Math.min(n.gameState.mapDimensions.height-25,u.y));const d=Math.random()<.5?"male":"female",h=e,g=e.pregnancyFatherId?n.gameState.entities.entities[e.pregnancyFatherId]:void 0;let m;if(g)m=o_(h.geneCode,g.geneCode);else{m=h.geneCode;const y=Math.floor((Math.random()-.5)*4096);m=Math.max(0,Math.min(16777215,m+y))}Oo(n.gameState.entities,u,d,0,Xv*.6,m,e.id,e.pregnancyFatherId),Oe(n.gameState,le.Procreation,e.position,Tr,e.id),Ie(n,fe.Birth,e.position),e.isPregnant=!1,e.gestationTime=0,e.procreationCooldown=n.gameState.ecosystem.predatorProcreationCooldown,e.pregnancyFatherId=void 0}e.procreationCooldown&&e.procreationCooldown>0&&(e.procreationCooldown-=o,e.procreationCooldown<0&&(e.procreationCooldown=0)),e.attackCooldown&&e.attackCooldown>0&&(e.attackCooldown-=o,e.attackCooldown<0&&(e.attackCooldown=0)),e.huntCooldown&&e.huntCooldown>0&&(e.huntCooldown-=o,e.huntCooldown<0&&(e.huntCooldown=0)),e.feedChildCooldownTime&&e.feedChildCooldownTime>0&&(e.feedChildCooldownTime-=o,e.feedChildCooldownTime<0&&(e.feedChildCooldownTime=0));let a=!1;e.hunger>=WC&&(a=!0),e.hitpoints<=0&&(a=!0),e.age>=Vv&&(a=!0),a&&(_1(n.gameState.entities,e.position,e.gender,e.age,e.radius,e.id,n.gameState.time,e.geneCode),Ho(n.gameState.entities,e.id))}var ua=(e=>(e[e.BehaviorTreeBased=0]="BehaviorTreeBased",e))(ua||{}),I=(e=>(e[e.SUCCESS=0]="SUCCESS",e[e.FAILURE=1]="FAILURE",e[e.RUNNING=2]="RUNNING",e[e.NOT_EVALUATED=3]="NOT_EVALUATED",e))(I||{});class Zn{constructor(){ke(this,"name");ke(this,"depth");ke(this,"children");ke(this,"child")}getLastStatus(n){return N.get(n.aiBlackboard,`${this.name}_lastStatus`)??3}setLastStatus(n,r){N.set(n.aiBlackboard,`${this.name}_lastStatus`,r)}getRunningChildIndex(n){return N.get(n.aiBlackboard,`${this.name}_runningChildIndex`)}setRunningChildIndex(n,r){N.set(n.aiBlackboard,`${this.name}_runningChildIndex`,r)}}const N={create(){return{data:{},nodeExecutionData:{}}},set({data:e},n,r){e[n]=r},get(e,n){return e==null?void 0:e.data[n]},delete({data:e},n){delete e[n]},has({data:e},n){return n in e},recordNodeExecution({nodeExecutionData:e},n,r,o,l,a){const u=e[n]||{lastExecuted:0,status:I.FAILURE,depth:0,debugInfo:"",executionHistory:[]},d=u.executionHistory[u.executionHistory.length-1];d&&o-(d==null?void 0:d.time)>Ks&&u.executionHistory.push({time:d.time+Ks,status:I.NOT_EVALUATED}),u.executionHistory.push({time:o,status:r});const h=Mv/Tt*At,g=o-h;u.executionHistory=u.executionHistory.filter(y=>y.time>=g);const m={...u,lastExecuted:o,status:r,depth:l,debugInfo:a};e[n]=m},getNodeExecutionData({nodeExecutionData:e}){return e},cleanupOldEntries({nodeExecutionData:e},n){const r=cI,o=[];for(const[l,a]of Object.entries(e))n-a.lastExecuted>r&&o.push(l);for(const l of o)delete e[l]}};function ih(e,n,r){if(e.aiBlackboard){const o=N.get(e.aiBlackboard,"lastAiUpdateTime")??0;n.gameState.time-o>=Ks&&(r.execute(e,n,e.aiBlackboard),N.set(e.aiBlackboard,"lastAiUpdateTime",n.gameState.time))}else console.warn(`Behavior Tree AI ticked for human ${e.id}, but the tree or blackboard was missing.`),e.activeAction="idle"}const n0="Human Behavior",v_=1;class y_{constructor(){ke(this,"nodeData",new Map);ke(this,"pathStack",[]);ke(this,"startTimeStack",[])}nodeStart(n){this.pathStack.push(n),this.startTimeStack.push(performance.now())}nodeEnd(){if(this.startTimeStack.length===0||this.pathStack.length===0){console.error("BTProfiler: nodeEnd() called without a matching nodeStart().");return}const n=performance.now(),r=this.startTimeStack.pop(),o=n-r,l=this.pathStack.join(" > "),a=this.nodeData.get(l)??{path:l,totalTime:0,callCount:0,minTime:1/0,maxTime:-1/0};a.totalTime+=o,a.callCount++,a.minTime=Math.min(a.minTime,o),a.maxTime=Math.max(a.maxTime,o),this.nodeData.set(l,a),this.pathStack.pop()}report(n={}){const{showAll:r=!1}=n,o=Array.from(this.nodeData.values());if(o.length===0){console.log("--- Behavior Tree Profiler: No data collected. ---");return}let l=o,a="--- Behavior Tree Full Report ---";if(!r){const d=this.nodeData.get(n0);if(d){const h=d.totalTime*v_/100;l=o.filter(g=>g.totalTime>h&&g.path!==n0),a="--- Behavior Tree Problem Report ---"}else console.log('BTProfiler: Root node "Human Behavior" not found. Showing full report.'),a="--- Behavior Tree Full Report (Root Not Found) ---"}const u=l.sort((d,h)=>h.totalTime-d.totalTime);console.log(a),u.length>0?console.table(u.map(d=>({Path:d.path,"Total Time (ms)":d.totalTime.toFixed(3),Calls:d.callCount,"Avg Time (ms)":(d.totalTime/d.callCount).toFixed(3),"Min Time (ms)":d.minTime.toFixed(3),"Max Time (ms)":d.maxTime.toFixed(3)}))):console.log("No significant performance problems detected."),console.log("------------------------------------")}reset(){this.nodeData.clear(),this.pathStack=[],this.startTimeStack=[]}}const ft=new y_;function Mn(e){return Array.isArray(e)?e:[e,""]}class pe extends Zn{constructor(r,o,l=0){super();ke(this,"name");ke(this,"depth");this.children=r,this.name=o,this.depth=l,this.children.forEach(a=>{a.depth=(this.depth??0)+1})}execute(r,o,l){this.name&&ft.nodeStart(this.name);try{for(const a of this.children){const[u,d]=Mn(a.execute(r,o,l));if(u!==I.SUCCESS)return this.setLastStatus(r,u),this.name&&N.recordNodeExecution(l,this.name,u,o.gameState.time,this.depth,d),u}return this.setLastStatus(r,I.SUCCESS),this.name&&N.recordNodeExecution(l,this.name,I.SUCCESS,o.gameState.time,this.depth,""),I.SUCCESS}finally{this.name&&ft.nodeEnd()}}}class Zt extends Zn{constructor(r,o,l=0){super();ke(this,"name");ke(this,"depth");this.children=r,this.name=o,this.depth=l,this.children.forEach(a=>{a.depth=(this.depth??0)+1})}execute(r,o,l){this.name&&ft.nodeStart(this.name);try{const a=this.getRunningChildIndex(r)??0;for(let u=a;u<this.children.length;u++){const d=this.children[u],[h,g]=Mn(d.execute(r,o,l));if(h!==I.FAILURE){if(h===I.SUCCESS)return this.setRunningChildIndex(r,void 0),this.setLastStatus(r,I.SUCCESS),this.name&&N.recordNodeExecution(l,this.name,I.SUCCESS,o.gameState.time,this.depth,g),I.SUCCESS;if(h===I.RUNNING)return this.setRunningChildIndex(r,u),this.setLastStatus(r,I.RUNNING),this.name&&N.recordNodeExecution(l,this.name,I.RUNNING,o.gameState.time,this.depth,g),I.RUNNING}}return this.setRunningChildIndex(r,void 0),this.setLastStatus(r,I.FAILURE),this.name&&N.recordNodeExecution(l,this.name,I.FAILURE,o.gameState.time,this.depth,""),I.FAILURE}finally{this.name&&ft.nodeEnd()}}}class ue extends Zn{constructor(r,o,l=0){super();ke(this,"name");ke(this,"depth");this.action=r,this.name=o,this.depth=l}execute(r,o,l){this.name&&ft.nodeStart(this.name);try{const[a,u]=Mn(this.action(r,o,l));return this.setLastStatus(r,a),this.name&&N.recordNodeExecution(l,this.name,a,o.gameState.time,this.depth,u),a}finally{this.name&&ft.nodeEnd()}}}class te extends Zn{constructor(r,o,l=0){super();ke(this,"name");ke(this,"depth");this.condition=r,this.name=o,this.depth=l}execute(r,o,l){this.name&&ft.nodeStart(this.name);try{const[a,u]=Mn(this.condition(r,o,l)),d=a?I.SUCCESS:I.FAILURE;return this.setLastStatus(r,d),this.name&&N.recordNodeExecution(l,this.name,d,o.gameState.time,this.depth,u),d}finally{this.name&&ft.nodeEnd()}}}class ou extends Zn{constructor(r,o,l,a=0){super();ke(this,"name");ke(this,"depth");ke(this,"startTimeKey");this.child=r,this.timeoutDurationHours=o,this.name=l,this.depth=a,this.child.depth=(this.depth??0)+1,this.startTimeKey=`timeout_${this.name}_startTime`}execute(r,o,l){ft.nodeStart(this.name);try{const a=o.gameState.time;let u=N.get(l,this.startTimeKey);const[d,h]=Mn(this.child.execute(r,o,l));if(d===I.RUNNING){u===void 0&&(N.set(l,this.startTimeKey,a),u=a);const g=a-u;if(g>this.timeoutDurationHours){N.delete(l,this.startTimeKey),this.setLastStatus(r,I.FAILURE);const y=`Timed out after ${g.toFixed(2)}h.`;return N.recordNodeExecution(l,this.name,this.getLastStatus(r),a,this.depth,y),this.getLastStatus(r)}this.setLastStatus(r,I.RUNNING);const m=`Running for ${g.toFixed(2)}h. ${h}`;return N.recordNodeExecution(l,this.name,this.getLastStatus(r),a,this.depth,m),this.getLastStatus(r)}return u!==void 0&&N.delete(l,this.startTimeKey),this.setLastStatus(r,d),N.recordNodeExecution(l,this.name,this.getLastStatus(r),a,this.depth,h),this.getLastStatus(r)}finally{ft.nodeEnd()}}}class ra extends Zn{constructor(r,o,l,a=0,u){super();ke(this,"name");ke(this,"depth");ke(this,"statusKey");ke(this,"timestampKey");this.child=r,this.cacheDurationHours=o,this.validityCheck=u,this.name=l,this.depth=a,this.child.depth=(this.depth??0)+1,this.statusKey=`caching_${this.name}_status`,this.timestampKey=`caching_${this.name}_timestamp`}execute(r,o,l){ft.nodeStart(this.name);try{const a=o.gameState.time,u=N.get(l,this.statusKey),d=N.get(l,this.timestampKey);if(u!==void 0&&d!==void 0){const y=a-d>this.cacheDurationHours,S=this.validityCheck?this.validityCheck(r,o,l):!0;if(!y&&S){const E=(d+this.cacheDurationHours-a).toFixed(2),w=`Cache hit. Status: ${I[u]}. ${E}h left.`;return this.setLastStatus(r,u),N.recordNodeExecution(l,this.name,this.getLastStatus(r),a,this.depth,w),this.getLastStatus(r)}}const[h,g]=Mn(this.child.execute(r,o,l));(h===I.SUCCESS||h===I.FAILURE)&&(N.set(l,this.statusKey,h),N.set(l,this.timestampKey,a)),this.setLastStatus(r,h);const m=`Cache miss. Child returned ${I[h]}. ${g}`;return N.recordNodeExecution(l,this.name,this.getLastStatus(r),a,this.depth,m),this.getLastStatus(r)}finally{ft.nodeEnd()}}}class Fr extends Zn{constructor(r,o,l,a=0){super();ke(this,"name");ke(this,"depth");ke(this,"cooldownKey");this.cooldownDurationHours=r,this.child=o,this.name=l,this.depth=a,this.child.depth=(this.depth??0)+1,this.cooldownKey=`cooldown_${this.name}`}execute(r,o,l){ft.nodeStart(this.name);try{const a=o.gameState.time,u=N.get(l,this.cooldownKey);if(this.child.getLastStatus(r)===I.RUNNING){const[g,m]=Mn(this.child.execute(r,o,l));if(this.setLastStatus(r,g),this.name){const y=`Continuing running child. ${m}`;N.recordNodeExecution(l,this.name,this.getLastStatus(r),a,this.depth,y)}return this.getLastStatus(r)}if(u!==void 0&&a<u){const m=`Cooldown active, ${(u-a).toFixed(2)}h left`;return this.setLastStatus(r,I.FAILURE),this.name&&N.recordNodeExecution(l,this.name,this.getLastStatus(r),a,this.depth,m),this.getLastStatus(r)}const[d,h]=Mn(this.child.execute(r,o,l));return d===I.SUCCESS&&N.set(l,this.cooldownKey,a+this.cooldownDurationHours),this.setLastStatus(r,d),this.name&&N.recordNodeExecution(l,this.name,this.getLastStatus(r),a,this.depth,h),this.getLastStatus(r)}finally{ft.nodeEnd()}}}class Yn extends Zn{constructor(r,o,l,a=0){super();ke(this,"name");ke(this,"depth");this.child=r,this.behaviorKey=o,this.name=l,this.depth=a;const u=(d,h)=>{d.depth=h,d.children?d.children.forEach(g=>u(g,h+1)):d.child&&u(d.child,h+1)};u(this.child,(this.depth??0)+1)}execute(r,o,l){this.name&&ft.nodeStart(this.name);try{if(r.isPlayer&&!o.gameState.autopilotControls.behaviors[this.behaviorKey]){const h=`Player autopilot for '${this.behaviorKey}' is disabled.`;return this.setLastStatus(r,I.FAILURE),this.name&&N.recordNodeExecution(l,this.name,this.getLastStatus(r),o.gameState.time,this.depth,h),this.getLastStatus(r)}const[u,d]=Mn(this.child.execute(r,o,l));return this.setLastStatus(r,u),this.name&&N.recordNodeExecution(l,this.name,this.getLastStatus(r),o.gameState.time,this.depth,d),this.getLastStatus(r)}finally{this.name&&ft.nodeEnd()}}}class S_ extends Zn{constructor(r,o,l=0){super();ke(this,"name");ke(this,"depth");this.child=r,this.name=o,this.depth=l;const a=(u,d)=>{u.depth=d,u.children?u.children.forEach(h=>a(h,d+1)):u.child&&a(u.child,d+1)};a(this.child,(this.depth??0)+1)}execute(r,o,l){this.name&&ft.nodeStart(this.name);try{if(r.isPlayer&&o.gameState.autopilotControls.isManuallyMoving)return this.setLastStatus(r,I.FAILURE),this.name&&N.recordNodeExecution(l,this.name,this.getLastStatus(r),o.gameState.time,this.depth,"Manual movement active, AI blocked."),this.getLastStatus(r);const[a,u]=Mn(this.child.execute(r,o,l));return this.setLastStatus(r,a),this.name&&N.recordNodeExecution(l,this.name,this.getLastStatus(r),o.gameState.time,this.depth,u),this.getLastStatus(r)}finally{this.name&&ft.nodeEnd()}}}class Ps extends Zn{constructor(r,o,l=0){super();ke(this,"name");ke(this,"depth");this.child=r,this.name=o,this.depth=l;const a=(u,d)=>{u.depth=d,u.children?u.children.forEach(h=>a(h,d+1)):u.child&&a(u.child,d+1)};a(this.child,(this.depth??0)+1)}execute(r,o,l){this.name&&ft.nodeStart(this.name);try{if(r.isPlayer)return this.setLastStatus(r,I.FAILURE),this.name&&N.recordNodeExecution(l,this.name,this.getLastStatus(r),o.gameState.time,this.depth,"Player controlled, AI blocked."),this.getLastStatus(r);const[a,u]=Mn(this.child.execute(r,o,l));return this.setLastStatus(r,a),this.name&&N.recordNodeExecution(l,this.name,this.getLastStatus(r),o.gameState.time,this.depth,u),this.getLastStatus(r)}finally{this.name&&ft.nodeEnd()}}}function A_(e){return new pe([new te((n,r)=>{const o=n.hunger>=cf,l=n.food.length>0,a=!n.eatingCooldownTime||r.gameState.time>=n.eatingCooldownTime;return[!!(o&&l&&a),`${Math.floor(n.hunger-cf)}, ${n.food.length}, ${n.eatingCooldownTime?Math.floor(n.eatingCooldownTime-r.gameState.time):""}`]},"Can Eat",e+1),new ue(n=>(n.direction={x:0,y:0},n.target=void 0,n.activeAction="eating",I.RUNNING),"Eat",e+1)],"Eating",e)}function T_(e){return new pe([new te((n,r,o)=>{if(n.isAdult&&n.hitpoints>n.maxHitpoints*rv||!(n.hitpoints<n.maxHitpoints*.1)&&n.isAdult&&n.hunger>sI)return!1;const a=gw(n.id,r.gameState);return a?(N.set(o,"fleeThreat",a.id),!0):!1},"Should Flee",e+1),new ue((n,r,o)=>{const l=N.get(o,"fleeThreat"),a=l&&r.gameState.entities.entities[l];if(!a)return I.FAILURE;n.activeAction="moving";const u=ze(a.position,n.position,r.gameState.mapDimensions.width,r.gameState.mapDimensions.height),d=nt(u),h=On(n.position,Pt(d,ov));return n.target={x:(h.x%r.gameState.mapDimensions.width+r.gameState.mapDimensions.width)%r.gameState.mapDimensions.width,y:(h.y%r.gameState.mapDimensions.height+r.gameState.mapDimensions.height)%r.gameState.mapDimensions.height},n.direction=d,I.RUNNING},"Execute Flee",e+1)],"Flee",e)}const rh=100;function I_(e,n,r=rh){return n.search.building.byRadius(e.position,r).some(a=>{const u=a;return u.buildingType==="storageSpot"&&u.ownerId===e.leaderId&&u.isConstructed&&u.storedFood&&u.storageCapacity&&u.storedFood.length<u.storageCapacity})}function i0(e,n,r=rh){return n.search.building.byRadius(e.position,r).filter(a=>{const u=a;return u.buildingType==="storageSpot"&&u.ownerId===e.leaderId&&u.isConstructed&&u.storedFood&&u.storedFood.length>0})}function r0(e,n,r=rh){return n.search.building.byRadius(e.position,r).filter(a=>{const u=a;return u.buildingType==="storageSpot"&&u.ownerId===e.leaderId&&u.isConstructed&&u.storedFood&&u.storageCapacity&&u.storedFood.length<u.storageCapacity})}function su(e,n,r){if(n.length===0)return null;let o=null,l=1/0;for(const a of n){const u=V(e.position,a.position,r.mapDimensions.width,r.mapDimensions.height);u<l&&(l=u,o=a)}return o?{storage:o,distance:l}:null}const Ns="foodSource";function w_(e){const n=new ue((o,l,a)=>{const u=new Map,d=De(o,l.gameState,"berryBush",Pm,m=>{if(m.food.length===0)return!1;if(!m.ownerId||!m.claimedUntil||l.gameState.time>=m.claimedUntil)return!0;const y=l.gameState.entities.entities[m.ownerId];if(!y||y.leaderId===o.leaderId)return!0;const S=u.get(y.id)??V(o.position,y.position,l.gameState.mapDimensions.width,l.gameState.mapDimensions.height);return u.set(y.id,S),S>MI}),h=De(o,l.gameState,"corpse",Pm,m=>m.food.length>0);let g=null;if(d&&h){const m=V(o.position,d.position,l.gameState.mapDimensions.width,l.gameState.mapDimensions.height),y=V(o.position,h.position,l.gameState.mapDimensions.width,l.gameState.mapDimensions.height);g=m<=y?d:h}else g=d||h;return g?(N.set(a,Ns,g.id),[I.SUCCESS,`Found food: ${g.type} at ${g.position.x.toFixed(0)},${g.position.y.toFixed(0)}`]):[I.FAILURE,"No food source found"]},"Find Closest Food Source",e+4),r=new ue((o,l,a)=>{const u=N.get(a,Ns),d=u&&l.gameState.entities.entities[u];return!d||d.food.length===0?(N.delete(a,Ns),[I.FAILURE,"Food source is invalid or depleted"]):V(o.position,d.position,l.gameState.mapDimensions.width,l.gameState.mapDimensions.height)<Or?(o.activeAction="gathering",o.direction={x:0,y:0},o.target=d.id,N.delete(a,Ns),[I.SUCCESS,`Gathering from ${d.type}`]):(o.activeAction="moving",o.target=d.id,o.direction=Ut(o.position,d.position,l.gameState.mapDimensions),[I.RUNNING,`Moving to ${d.type}`])},"Move To Food and Gather",e+3);return new pe([new te((o,l)=>{const a=o.food.length<o.maxFood,u=o.hunger>QT,d=Nt(l.gameState,o).filter(g=>g.hunger>Bf),h=I_(o,l.gameState);return[(o.isAdult&&a&&(u||d.length>0||h))??!1,`${u?"H":""}${d.length>0?" HC("+d.length+")":""}${h?" S":""}`]},"Should Gather Food",e+1),new Zt([new pe([new te((o,l,a)=>N.has(a,Ns),"Has Food Source?",e+2),r],"Continue Gathering Action",e+2),new pe([new ra(n,pI,"Cache Food Source Search",e+3),r],"Find New Food Source and Gather",e+2)],"Perform or Start Gathering",e+1)],"Gather Food",e)}function E_(e){return new ue((n,r,o)=>(n.activeAction="idle",n.direction={x:0,y:0},n.target=void 0,N.set(o,"wanderTarget",void 0),I.SUCCESS),"Idle",e)}const Dl="procreationWanderStartTime",o0=(e,n,r)=>n.find(o=>Mr(e,o,r));function C_(e){const n=new te((a,u,d)=>{const h=Om(a,u.gameState,Or),g=o0(a,h,u.gameState);return g?(N.set(d,"procreationPartner",g.id),!0):!1},"Find Immediate Partner"),r=new ue((a,u,d)=>{var m;const h=N.get(d,"procreationPartner"),g=h&&u.gameState.entities.entities[h];return g?(a.activeAction="procreating",a.target=void 0,N.delete(d,"procreationPartner"),N.delete(d,Dl),(m=a.partnerIds)!=null&&m.includes(g.id)||(a.partnerIds=a.partnerIds?[...a.partnerIds,g.id]:[g.id]),I.SUCCESS):I.FAILURE},"Start Procreating"),o=new te((a,u,d)=>{const h=Om(a,u.gameState,oI),g=o0(a,h,u.gameState);return g?(N.set(d,"procreationPartner",g.id),!0):!1},"Locate Distant Partner"),l=new ue((a,u,d)=>{const h=N.get(d,"procreationPartner"),g=h&&u.gameState.entities.entities[h];if(!g)return I.FAILURE;if(V(a.position,g.position,u.gameState.mapDimensions.width,u.gameState.mapDimensions.height)<Or)return I.SUCCESS;a.activeAction="moving",a.target=g.id;const y=ze(a.position,g.position,u.gameState.mapDimensions.width,u.gameState.mapDimensions.height);return a.direction=nt(y),I.RUNNING},"Move Towards Partner");return new pe([new te(a=>!(!a.isAdult||a.gender==="female"&&a.isPregnant||a.age<$I||a.gender==="female"&&a.age>uv),"Is Fertile (age, not pregnant)",e+1),new te(a=>a.hunger<Dr,"Is Healthy (hunger)",e+1),new te(a=>(a.procreationCooldown||0)<=0,"Is Ready (cooldown)",e+1),new Zt([new pe([new te((a,u)=>pf(a.position,u.gameState,"berryBush",_m)>=rI,"Is Environment Viable (food)",e+3),new ue((a,u,d)=>(N.delete(d,Dl),I.SUCCESS),"Clear Wander Timer",e+3)],"Sufficient Food Path",e+2),new pe([new te((a,u)=>{if(a.gender==="male"){const d=Nt(u.gameState,a);return!pi(d)}return!1},"Is Male Without Heir",e+3),new ue((a,u,d)=>{const h=N.get(d,Dl);if(h===void 0)return N.set(d,Dl,u.gameState.time),[I.FAILURE,"Starting heirless wander timer"];const g=u.gameState.time-h;return g>=zI?pf(a.position,u.gameState,"berryBush",_m)>=1?[I.SUCCESS,`Wandered for ${g.toFixed(1)}h, minimum food found`]:[I.FAILURE,"Desperate but no food sources nearby"]:[I.FAILURE,`Wandering for heir, ${g.toFixed(1)}h elapsed`]},"Check Wander Timer",e+3)],"Heirless Desperation Path",e+2)],"Check Environment Or Desperation",e+1),new te((a,u,d)=>{var g;const h=N.get(d,"procreationPartner");return h&&((g=h.partnerIds)!=null&&g.length)&&!h.partnerIds.includes(a.id)&&h.partnerIds.map(m=>u.gameState.entities.entities[m]).filter(m=>!!m).some(m=>V(a.position,m.position,u.gameState.mapDimensions.width,u.gameState.mapDimensions.height)<kI)?[!1,"Partner's primary partner is too close"]:!0},"Is Partner's Primary Partner Nearby",e+1),new Zt([new pe([n,r],"Procreate With Immediate Partner",e+2),new Fr(fI,new pe([o,l],"Seek Distant Partner Action",e+3),"Seek Distant Partner Cooldown",e+2)],"Find Partner And Procreate",e+1)],"Procreate",e)}const ao="attackTarget",vr="homeCenter",Bd=150;function __(e){return new pe([new te((n,r,o)=>{if(!n.isAdult)return[!1,"Not an adult"];const{gameState:l}=r;if(n.activeAction==="attacking"&&n.attackTargetId){const u=l.entities.entities[n.attackTargetId];if(u&&u.hitpoints>0&&V(n.position,u.position,l.mapDimensions.width,l.mapDimensions.height)<=Bd){if(N.set(o,ao,u.id),!N.get(o,vr)){const d=n.leaderId?kr(n.leaderId,l):eu(n,l).length>0?km(n,l):n.position;N.set(o,vr,d)}return!0}}const a=De(n,l,"human",Bd,u=>u.hitpoints>0&&Uo(n,u,l));if(a){N.set(o,ao,a.id);const u=n.leaderId?kr(n.leaderId,l):eu(n,l).length>0?km(n,l):n.position;return N.set(o,vr,u),!0}return N.set(o,ao,void 0),N.set(o,vr,void 0),!1},"Find Attack Target",e+1),new ue((n,r,o)=>{const l=N.get(o,ao),a=l&&r.gameState.entities.entities[l],u=N.get(o,vr);if(!a||!u)return I.FAILURE;const{gameState:d}=r;return V(n.position,u,d.mapDimensions.width,d.mapDimensions.height)>iv?(n.activeAction="idle",n.attackTargetId=void 0,N.set(o,ao,void 0),N.set(o,vr,void 0),I.FAILURE):a.hitpoints<=0||V(n.position,a.position,d.mapDimensions.width,d.mapDimensions.height)>Bd?(n.activeAction==="attacking"&&(n.activeAction="idle",n.attackTargetId=void 0),N.set(o,ao,void 0),N.set(o,vr,void 0),I.SUCCESS):(n.activeAction==="attacking"&&n.attackTargetId===a.id||(n.activeAction="attacking",n.attackTargetId=a.id),I.RUNNING)},"Execute Attack",e+1)],"Attack",e)}const R_=(e,n,r)=>{const o=Nt(n.gameState,e).filter(u=>!u.isAdult);if(o.length===0)return I.FAILURE;let l=null,a=Bf;for(const u of o)u.hunger>=a&&(a=u.hunger,l=u);return l?(N.set(r,"targetChild",l.id),I.SUCCESS):I.FAILURE},P_=(e,n,r)=>{const o=N.get(r,"targetChild"),l=o&&n.gameState.entities.entities[o];return l?V(e.position,l.position,n.gameState.mapDimensions.width,n.gameState.mapDimensions.height)>Hf?(e.activeAction="moving",e.target=l.id,e.direction=Ut(e.position,l.position,n.gameState.mapDimensions),I.RUNNING):(e.activeAction="feeding",e.target=void 0,N.set(r,"targetChild",void 0),I.SUCCESS):I.FAILURE};function N_(e){return new pe([new te(n=>(n.isAdult&&n.food.length>0&&(!n.feedChildCooldownTime||n.feedChildCooldownTime<=0))??!1,"Can Feed Child",e+1),new ue(R_,"Find Hungriest Child",e+1),new ue(P_,"Move To Child and Feed",e+1)],"Feed Child",e)}function D_(e){return new pe([new te(n=>!n.isAdult&&n.hunger>=Bf,"Is Hungry Child",e+1),new ue((n,r,o)=>{const l=dw(n,r.gameState);if(l.length===0)return I.FAILURE;const a=De(n,r.gameState,"human",XI,u=>l.some(d=>d.id===u.id)&&u.food.length>0);return a?(N.set(o,"targetParent",a.id),I.SUCCESS):I.FAILURE},"Find Parent With Food",e+1),new ue((n,r,o)=>{const l=N.get(o,"targetParent"),a=l&&r.gameState.entities.entities[l];if(!a)return I.FAILURE;const u=V(n.position,a.position,r.gameState.mapDimensions.width,r.gameState.mapDimensions.height);return n.activeAction="idle",u<=Hf?(n.target=void 0,I.SUCCESS):(n.target=a.id,n.activeAction="moving",I.RUNNING)},"Move To Parent",e+1)],"Seek Food From Parent",e)}const Ds="plantingSpot";function O_(e,n,r,o){const l=ze(e,n,r,o);return On(e,l)}function k_(e){const n=new ue((o,l,a)=>{const u=N.get(a,Ds);if(!u||kn(u,l.gameState,Zi,o.id))return N.delete(a,Ds),[I.FAILURE,"Planting spot is missing"];const d=O_(o.position,u,l.gameState.mapDimensions.width,l.gameState.mapDimensions.height),h=V(o.position,d,l.gameState.mapDimensions.width,l.gameState.mapDimensions.height);return h>Or?(o.activeAction="moving",o.target=d,o.direction=Ut(o.position,d,l.gameState.mapDimensions),[I.RUNNING,"Moving to planting spot: "+h.toFixed(2)+" units away"]):kn(u,l.gameState,Zi,o.id)?(N.delete(a,Ds),[I.FAILURE,"Planting spot is now occupied"]):(o.activeAction="planting",o.target=u,[I.RUNNING,"Planting state initiated"])},"Move To Spot and Plant",e+3),r=new ue((o,l,a)=>{let u=Mw(o,l.gameState);return u||(u=Pw(o,l.gameState)),u?(N.set(a,Ds,u),[I.SUCCESS,`Found new spot at ${u.x.toFixed(0)}, ${u.y.toFixed(0)}`]):[I.FAILURE,"No suitable planting spot found"]},"Find Optimal Planting Spot",e+3);return new pe([new te(o=>{const l=o.food.filter(u=>u.type===qn.Berry).length>=_o,a=o.hunger<JT;return(o.isAdult&&l&&a)??!1},"Can Plant",e+1),new te((o,l)=>{const a=pf(o.position,l.gameState,"berryBush",XT),u=Nt(l.gameState,o);return!(u.length===0||a>=u.length*5)},"Has Not Enough Nearby Bushes",e+1),new Zt([new pe([new te((o,l,a)=>N.has(a,Ds),"Has Planting Spot?",e+2),n],"Continue Planting Action",e+2),new Fr(gI,r,"Find Planting Spot Cooldown",e+2)],"Perform or Start Planting",e+1)],"Plant Bush",e)}function M_(e){return new Zt([new pe([new te((n,r,o)=>{if(n.food.length<=n.maxFood*.2)return[!1,"Not enough food to deposit"];if(!n.isAdult)return[!1,"Not an adult"];const l=r0(n,r.gameState),a=su(n,l,r.gameState);return(a==null?void 0:a.storage)?[!0,`Storage found at distance ${a.distance.toFixed(1)}`]:[!1,"No available tribe storage nearby"]},"Check for Excess Food and Storage",e+1),new ue((n,r,o)=>{const l=r0(n,r.gameState);if(l.length===0)return[I.FAILURE,"No storage available"];const a=su(n,l,r.gameState);if(!a)return[I.FAILURE,"No storage found"];const u=a.storage,d=a.distance;return d<=Sn?(n.activeAction="depositing",n.target=void 0,[I.SUCCESS,"Depositing food"]):(n.activeAction="moving",n.target=u.position,[I.RUNNING,`Moving to storage (${d.toFixed(1)}px away)`])},"Navigate to Storage and Deposit",e+1)],"Deposit Sequence",e)],"Storage Deposit Behavior",e)}function F_(e){return new Zt([new pe([new te((n,r,o)=>{if(n.hunger<=cf)return[!1,"Not hungry enough"];if(n.food.length>=n.maxFood)return[!1,"Inventory full"];const l=i0(n,r.gameState),a=su(n,l,r.gameState);return(a==null?void 0:a.storage)?[!0,`Storage with food found at distance ${a.distance.toFixed(1)}`]:[!1,"No tribe storage with food nearby"]},"Check for Hunger and Storage Food",e+1),new ue((n,r,o)=>{const l=i0(n,r.gameState);if(l.length===0)return[I.FAILURE,"No storage with food available"];const a=su(n,l,r.gameState);if(!a)return[I.FAILURE,"No storage found"];const u=a.storage,d=a.distance;return d<=Sn?(n.activeAction="retrieving",n.target=void 0,[I.SUCCESS,"Retrieving food"]):(n.activeAction="moving",n.target=u.position,[I.RUNNING,`Moving to storage (${d.toFixed(1)}px away)`])},"Navigate to Storage and Retrieve",e+1)],"Retrieve Sequence",e)],"Storage Retrieve Behavior",e)}function U_(e){return new Zt([new pe([new te((n,r,o)=>{if(!n.isAdult)return[!1,"Not an adult"];if(n.food.length>=n.maxFood)return[!1,"Inventory full"];if(!n.leaderId)return[!1,"No tribe leader"];const l=r.gameState.entities.entities[n.leaderId];if(!l||!l.diplomacy)return[!1,"No diplomacy info"];const d=r.gameState.search.building.byRadius(n.position,150).find(h=>{const g=h;if(g.buildingType!=="storageSpot"||!g.isConstructed||!g.storedFood||g.storedFood.length===0||g.ownerId===n.leaderId||l.diplomacy[g.ownerId]!==St.Hostile)return!1;const y=gf({leaderId:g.ownerId},r.gameState);for(const S of y)if(V(n.position,S.position,r.gameState.mapDimensions.width,r.gameState.mapDimensions.height)<=Sf)return!1;return!0});return d?[!0,`Undefended enemy storage found at distance ${V(n.position,d.position,r.gameState.mapDimensions.width,r.gameState.mapDimensions.height).toFixed(1)}`]:[!1,"No undefended enemy storage nearby"]},"Check for Undefended Enemy Storage",e+1),new ue((n,r,o)=>{if(!n.leaderId)return[I.FAILURE,"No tribe leader"];const l=r.gameState.entities.entities[n.leaderId];if(!l||!l.diplomacy)return[I.FAILURE,"No diplomacy info"];const d=r.gameState.search.building.byRadius(n.position,150).filter(m=>{const y=m;if(y.buildingType!=="storageSpot"||!y.isConstructed||!y.storedFood||y.storedFood.length===0||y.ownerId===n.leaderId||l.diplomacy[y.ownerId]!==St.Hostile)return!1;const E=gf({leaderId:y.ownerId},r.gameState);for(const w of E)if(V(n.position,w.position,r.gameState.mapDimensions.width,r.gameState.mapDimensions.height)<=Sf)return!1;return!0});if(d.length===0)return[I.FAILURE,"No undefended storage available"];let h=null,g=1/0;for(const m of d){const y=V(n.position,m.position,r.gameState.mapDimensions.width,r.gameState.mapDimensions.height);y<g&&(g=y,h=m)}return h?g<=Sn?(n.activeAction="idle",n.target=void 0,[I.SUCCESS,"Stealing food"]):(n.activeAction="moving",n.target=h.position,[I.RUNNING,`Moving to enemy storage (${g.toFixed(1)}px away)`]):[I.FAILURE,"No storage found"]},"Navigate to Enemy Storage and Steal",e+1)],"Steal Sequence",e)],"Storage Steal Behavior",e)}const Hd="enemiesNearby";function L_(e){const n=new te(a=>a.id===a.leaderId,"Is Leader?",e+1),r=new te(a=>!a.isCallingToAttack,"Is Not Already Calling?",e+1),o=new ue((a,u,d)=>{const h=Yf(a,u.gameState,Hv);return h.length>0?(N.set(d,Hd,h.map(g=>g.id)),I.SUCCESS):I.FAILURE},"Find Nearby Enemies",e+1),l=new Zt([new pe([new te((a,u,d)=>{const h=N.get(d,Hd),g=h==null?void 0:h.map(E=>u.gameState.entities.entities[E]).filter(E=>!!E);if(!g||g.length===0)return!1;const m=Zs(a.id,u.gameState),y=nu(m),S=nu(g);return y>S*EI},"Is Strong Enough?",e+3),new ue((a,u)=>(a.isCallingToAttack=!0,a.callToAttackEndTime=u.gameState.time+No,Oe(u.gameState,le.CallToAttack,a.position,No),Ie(u,fe.CallToAttack,a.position),a.activeAction="idle",a.target=void 0,I.SUCCESS),"Issue Call to Attack",e+3)],"Attack",e+2),new ue((a,u,d)=>{const h=N.get(d,Hd),g=h==null?void 0:h.map(T=>u.gameState.entities.entities[T]).filter(T=>!!T);if(!g||g.length===0)return I.FAILURE;const m=g.map(T=>T.position),y=zf(m),S=ze(y,a.position,u.gameState.mapDimensions.width,u.gameState.mapDimensions.height),E=nt(S),w=On(a.position,Pt(E,ov*2));return a.activeAction="moving",a.target={x:(w.x%u.gameState.mapDimensions.width+u.gameState.mapDimensions.width)%u.gameState.mapDimensions.width,y:(w.y%u.gameState.mapDimensions.height+u.gameState.mapDimensions.height)%u.gameState.mapDimensions.height},a.direction=E,I.SUCCESS},"Retreat",e+2)],"Attack or Retreat",e+2);return new pe([n,r,o,new Fr(CI,l,"Leader Combat Cooldown",e+1)],"Leader Combat Strategy",e)}const bd="combatTarget",Gd="homeCenter";function B_(e){const n=new te(u=>u.isAdult&&u.leaderId?u.id!==u.leaderId:!1,"Is Tribe Follower?",e+1),r=new te(u=>u.hunger<eI&&u.hitpoints>=u.maxHitpoints*rv,"Is Fit for Combat?",e+1),o=new te((u,d)=>{const h=d.gameState.entities.entities[u.leaderId];return!!(h!=null&&h.isCallingToAttack)},"Is Leader Calling to Attack?",e+1),l=new ue((u,d,h)=>{const{gameState:g}=d,m=g.entities.entities[u.leaderId];if(!m)return I.FAILURE;const y=Yf(m,g,aI);if(y.length===0)return I.FAILURE;y.sort((S,E)=>{const w=V(u.position,S.position,g.mapDimensions.width,g.mapDimensions.height),T=V(u.position,E.position,g.mapDimensions.width,g.mapDimensions.height);return w-T});for(const S of y)if(Nw(m.id,S.id,g)<lI){N.set(h,bd,S.id);const w=kr(m.id,g);return N.set(h,Gd,w),I.SUCCESS}return I.FAILURE},"Find Best Target",e+1),a=new ue((u,d,h)=>{const g=N.get(h,bd),m=g&&d.gameState.entities.entities[g],y=N.get(h,Gd);if(!m||!y)return I.FAILURE;const{gameState:S}=d;return V(u.position,y,S.mapDimensions.width,S.mapDimensions.height)>iv?(u.activeAction==="attacking"&&u.attackTargetId===m.id&&(u.activeAction="idle",u.attackTargetId=void 0),N.set(h,bd,void 0),N.set(h,Gd,void 0),I.FAILURE):((!u.lastTargetAcquiredEffectTime||d.gameState.time-u.lastTargetAcquiredEffectTime>be*5)&&(Oe(d.gameState,le.TargetAcquired,u.position,be,u.id),u.lastTargetAcquiredEffectTime=d.gameState.time),u.activeAction="attacking",u.attackTargetId=m.id,u.target=void 0,I.RUNNING)},"Attack Target",e+1);return new pe([n,r,o,l,a],"Tribe Member Combat",e)}function H_(e){const n=new te((m,y)=>{if(!m.isAdult||m.gender!=="male")return!1;const S=m.partnerIds&&m.partnerIds.length>0,E=Nt(y.gameState,m).length>0;return S||E},"Is Adult Male With Family?",e+1),r=new te((m,y)=>{var T;const S=wt(y.gameState);if(S){const C=pi(Nt(y.gameState,S));if((C==null?void 0:C.id)===m.id)return!1}if(!m.fatherId)return!1;const E=y.gameState.entities.entities[m.fatherId];return!E||((T=pi(Nt(y.gameState,E)))==null?void 0:T.id)===m.id?!1:V(m.position,E.position,y.gameState.mapDimensions.width,y.gameState.mapDimensions.height)<dI},"Is Too Close To Father?",e+1),o=new te((m,y,S)=>N.get(S,"territoryMoveTarget")!==void 0,"Is Moving To Territory?",e+3),l=new ue((m,y,S)=>{const E=N.get(S,"territoryMoveTarget"),w=N.get(S,"territoryMoveStartTime");if(!E||!w)return[I.FAILURE,"Missing move data"];if(y.gameState.time-w>uI)return N.delete(S,"territoryMoveTarget"),N.delete(S,"territoryMoveStartTime"),[I.FAILURE,"Territory move timed out"];if(V(m.position,E,y.gameState.mapDimensions.width,y.gameState.mapDimensions.height)<Or)return N.delete(S,"territoryMoveTarget"),N.delete(S,"territoryMoveStartTime"),[I.SUCCESS,"Arrived at new territory"];m.activeAction="moving",m.target=E;const F=ze(m.position,m.target,y.gameState.mapDimensions.width,y.gameState.mapDimensions.height);return m.direction=nt(F),[I.RUNNING,"Continuing move to territory"]},"Check Timeout & Arrival",e+3),a=new pe([o,l],"Handle In-Progress Move",e+2),u=new te((m,y,S)=>N.get(S,"territoryMoveTarget")===void 0,"Should Start New Move?",e+4),d=new ue((m,y,S)=>{const E=Wf(m.position,y.gameState.mapDimensions.width/4,y.gameState.mapDimensions.width,y.gameState.mapDimensions.height);N.set(S,"territoryMoveTarget",E),N.set(S,"territoryMoveStartTime",y.gameState.time),m.activeAction="moving",m.target=E;const w=ze(m.position,m.target,y.gameState.mapDimensions.width,y.gameState.mapDimensions.height);return m.direction=nt(w),[I.RUNNING,"Started moving to new territory"]},"Start New Territory Move",e+4),h=new pe([u,d],"Start New Territory Move Action",e+3),g=new Zt([a,new Fr(hI,h,"Establish Territory Cooldown",e+2)],"Establish or Continue Move",e+1);return new pe([n,r,g],"Establish Family Territory",e)}function b_(e){return new pe([new ue((n,r,o)=>{const l=hw(n,r.gameState);return l?(N.set(o,"patriarchTarget",l.id),[I.SUCCESS,`Found patriarch: ${l.id}`]):(N.delete(o,"patriarchTarget"),[I.FAILURE,"No patriarch found"])},"Find Patriarch",e+1),new ue((n,r,o)=>{const l=N.get(o,"patriarchTarget"),a=l&&r.gameState.entities.entities[l];if(!a)return[I.FAILURE,"Patriarch target missing from blackboard"];const u=V(n.position,a.position,r.gameState.mapDimensions.width,r.gameState.mapDimensions.height);if(u>nv){n.activeAction="moving",n.target=a.id;const d=ze(n.position,a.position,r.gameState.mapDimensions.width,r.gameState.mapDimensions.height);return n.direction=nt(d),[I.RUNNING,`Moving to patriarch at ${u.toFixed(0)}`]}return n.activeAction="idle",n.target=void 0,n.direction={x:0,y:0},[I.SUCCESS,`Arrived at patriarch at ${u.toFixed(0)}`]},"Move Towards Patriarch",e+1)],"Follow Patriarch",e)}const xd="tribeSplitMigrationTarget";function G_(e){const n=new pe([new te((r,o)=>{const{canSplit:l,progress:a}=Jf(r,o.gameState);return l?[!0,`Progress: ${(a??0)*100}%`]:[!1,"Cannot split"]},"Can Split Tribe?",e+2),new ue((r,o,l)=>{const{gameState:a}=o;let u=N.get(l,xd);if(!u){if(!r.leaderId)return I.FAILURE;const h=kr(r.leaderId,a),g=cC(h,r,a);if(g)N.set(l,xd,g),u=g;else return I.FAILURE}return V(r.position,u,a.mapDimensions.width,a.mapDimensions.height)<Or?(N.delete(l,xd),r.activeAction="idle",r.target=void 0,I.SUCCESS):(r.activeAction="moving",r.target=u,I.RUNNING)},"Move to New Territory",e+2),new ue((r,o)=>(eh(r,o.gameState),I.SUCCESS),"Perform Tribe Split",e+2)],"Tribe Split Action",e+1);return new Fr(zE,n,"Tribe Split Cooldown",e)}const Ol="jealousyAttackTarget";function x_(e){return new pe([new te((n,r,o)=>{if(!n.isAdult)return[!1,"Not an adult"];const l=Ew(n,r.gameState,_I);return l?n.leaderId&&l.id===n.leaderId?[!1,"Stranger is in same tribe - no attack"]:(N.set(o,Ol,l.id),[!0,`Partner cheating with ${l.id}`]):(N.delete(o,Ol),!1)},"Check for Infidelity",e+1),new ue((n,r,o)=>{const l=N.get(o,Ol),a=l&&r.gameState.entities.entities[l];return!a||a.hitpoints<=0?(N.delete(o,Ol),[I.FAILURE,"Target is invalid or dead"]):n.activeAction==="attacking"&&n.attackTargetId===a.id?I.RUNNING:(n.activeAction="attacking",n.attackTargetId=a.id,[I.RUNNING,`Attacking ${a.id}`])},"Execute Jealousy Attack",e+1)],"Jealousy Attack",e)}const kl="defendAggressor";function $_(e){return new pe([new te((n,r,o)=>{if(!n.isAdult)return[!1,"Not an adult"];const l=_w(n,r.gameState,RI);return l?(N.set(o,kl,l.aggressor.id),[!0,`Family member ${l.familyMember.id} attacked by ${l.aggressor.id}`]):(N.delete(o,kl),!1)},"Check Family Under Attack",e+1),new ue((n,r,o)=>{const l=N.get(o,kl),a=l&&r.gameState.entities.entities[l];return!a||a.hitpoints<=0?(N.delete(o,kl),[I.FAILURE,"Target invalid/dead"]):n.activeAction==="attacking"&&n.attackTargetId===a.id?I.RUNNING:(n.activeAction="attacking",n.attackTargetId=a.id,[I.RUNNING,`Attacking aggressor ${a.id}`])},"Execute Family Defense Attack",e+1)],"Defend Family",e)}const Ml="bushIntruder";function z_(e){return new pe([new te((n,r,o)=>{if(!n.isAdult)return[!1,"Not an adult"];const l=Cw(n,r.gameState,PI);return l?(N.set(o,Ml,l.id),[!0,`Intruder ${l.id} stealing berries`]):(N.delete(o,Ml),!1)},"Check For Intruders on Bushes",e+1),new ue((n,r,o)=>{const l=N.get(o,Ml),a=l&&r.gameState.entities.entities[l];return!a||a.hitpoints<=0?(N.delete(o,Ml),[I.FAILURE,"Intruder is invalid or dead"]):n.activeAction==="attacking"&&n.attackTargetId===a.id?I.RUNNING:(n.activeAction="attacking",n.attackTargetId=a.id,[I.RUNNING,`Attacking intruder ${a.id}`])},"Execute Bush Defense Attack",e+1)],"Defend Claimed Bush",e)}const Fl="desperateAttackTarget";function W_(e){return new pe([new te(n=>n.hunger>NI,"Is Starving",e+1),new te((n,r)=>{if(!n.isAdult)return[!1,"Not an adult"];const o=De(n,r.gameState,"berryBush",It,a=>a.food.length>0),l=De(n,r.gameState,"corpse",It,a=>a.food.length>0);return!o&&!l},"No Other Food Available",e+1),new te((n,r,o)=>{const l=Rw(n,r.gameState);return l?(N.set(o,Fl,l.id),[!0,`Found weak target ${l.id}`]):(N.delete(o,Fl),!1)},"Find Weak Target",e+1),new ue((n,r,o)=>{const l=N.get(o,Fl),a=l&&r.gameState.entities.entities[l];return!a||a.hitpoints<=0?(N.delete(o,Fl),[I.FAILURE,"Target is invalid or dead"]):n.activeAction==="attacking"&&n.attackTargetId===a.id?I.RUNNING:(n.activeAction="attacking",n.attackTargetId=a.id,[I.RUNNING,`Desperately attacking ${a.id}`])},"Execute Desperate Attack",e+1)],"Desperate Attack",e)}function Y_(e,n,r,o){const l=e.entities.entities[r.targetEntityId];return!l||!("hitpoints"in l)||l.hitpoints<=0?(e.autopilotControls.activeAutopilotAction=void 0,I.FAILURE):V(n.position,l.position,e.mapDimensions.width,e.mapDimensions.height)<=Xl?(n.activeAction="attacking",n.attackTargetId=l.id,e.autopilotControls.activeAutopilotAction=void 0,I.SUCCESS):(n.activeAction="moving",n.target=l.id,n.direction=Ut(n.position,l.position,e.mapDimensions),I.RUNNING)}function j_(e){return new pe([new te((n,r)=>n.isPlayer===!0&&!!r.gameState.autopilotControls.activeAutopilotAction,"Has Player Command",e+1),new ue((n,r)=>{var a;const{gameState:o}=r,l=o.autopilotControls.activeAutopilotAction;if(!l)return I.FAILURE;switch(l.action){case ce.AutopilotMove:{const u=l.position;return V(n.position,u,o.mapDimensions.width,o.mapDimensions.height)<FI?(o.autopilotControls.activeAutopilotAction=void 0,n.activeAction==="moving"&&(n.activeAction="idle",n.target=void 0),I.SUCCESS):(n.activeAction="moving",n.target=u,n.direction=Ut(n.position,u,o.mapDimensions),I.RUNNING)}case ce.AutopilotGather:{const u=o.entities.entities[l.targetEntityId];return!u||u.food.length===0?(o.autopilotControls.activeAutopilotAction=void 0,I.FAILURE):V(n.position,u.position,o.mapDimensions.width,o.mapDimensions.height)>Or?(n.activeAction="moving",n.target=u.id,n.direction=Ut(n.position,u.position,o.mapDimensions),I.RUNNING):(n.activeAction="gathering",n.target=u.id,o.autopilotControls.activeAutopilotAction=void 0,I.SUCCESS)}case ce.AutopilotAttack:return Y_(o,n,l);case ce.AutopilotProcreate:{const u=o.entities.entities[l.targetEntityId];return!u||u.type!=="human"||!Mr(n,u,r.gameState)?(o.autopilotControls.activeAutopilotAction=void 0,I.FAILURE):V(n.position,u.position,o.mapDimensions.width,o.mapDimensions.height)<=Xl?(n.activeAction="procreating",o.autopilotControls.activeAutopilotAction=void 0,I.SUCCESS):(n.activeAction="moving",n.target=u.id,n.direction=Ut(n.position,u.position,o.mapDimensions),I.RUNNING)}case ce.AutopilotPlant:{if(n.activeAction==="planting")return I.RUNNING;const u=l.position;return kn(u,o,Zi,n.id)?(o.autopilotControls.activeAutopilotAction=void 0,I.FAILURE):V(n.position,u,o.mapDimensions.width,o.mapDimensions.height)<=Xl?(n.activeAction="planting",n.target=u,o.autopilotControls.activeAutopilotAction=void 0,o.hasPlayerPlantedBush=!0,I.RUNNING):(n.activeAction="moving",n.target=u,n.direction=Ut(n.position,u,o.mapDimensions),I.RUNNING)}case ce.AutopilotFeedChild:{const u=o.entities.entities[l.targetEntityId];return!u||u.type!=="human"||u.isAdult||n.food.length===0?(o.autopilotControls.activeAutopilotAction=void 0,I.FAILURE):V(n.position,u.position,o.mapDimensions.width,o.mapDimensions.height)<=Xl?(o.autopilotControls.activeAutopilotAction=void 0,n.activeAction="feeding",I.SUCCESS):(n.activeAction="moving",n.target=u.id,n.direction=Ut(n.position,u.position,o.mapDimensions),I.RUNNING)}case ce.AutopilotDeposit:{const u=o.entities.entities[l.targetEntityId];if(!u||u.buildingType!=="storageSpot"||!u.isConstructed)return o.autopilotControls.activeAutopilotAction=void 0,I.FAILURE;const d=u.storageCapacity??0;return(((a=u.storedFood)==null?void 0:a.length)??0)>=d||n.leaderId!==u.ownerId||n.food.length===0?(o.autopilotControls.activeAutopilotAction=void 0,I.FAILURE):V(n.position,u.position,o.mapDimensions.width,o.mapDimensions.height)<=Sn?(n.activeAction="depositing",n.target=void 0,o.autopilotControls.activeAutopilotAction=void 0,I.SUCCESS):(n.activeAction="moving",n.target=u.id,n.direction=Ut(n.position,u.position,o.mapDimensions),I.RUNNING)}case ce.AutopilotRetrieve:{const u=o.entities.entities[l.targetEntityId];return!u||u.buildingType!=="storageSpot"||!u.isConstructed||!u.storedFood||u.storedFood.length===0||n.leaderId!==u.ownerId||n.food.length>=n.maxFood?(o.autopilotControls.activeAutopilotAction=void 0,I.FAILURE):V(n.position,u.position,o.mapDimensions.width,o.mapDimensions.height)<=Sn?(n.activeAction="retrieving",n.target=void 0,o.autopilotControls.activeAutopilotAction=void 0,I.SUCCESS):(n.activeAction="moving",n.target=u.id,n.direction=Ut(n.position,u.position,o.mapDimensions),I.RUNNING)}case ce.AutopilotFollowMe:{const u=o.entities.entities[l.targetEntityId];return!u||u.type!=="human"||u.id!==u.leaderId?(o.autopilotControls.activeAutopilotAction=void 0,I.FAILURE):V(n.position,u.position,o.mapDimensions.width,o.mapDimensions.height)<=nv?(o.autopilotControls.activeAutopilotAction=void 0,n.activeAction==="moving"&&(n.activeAction="idle"),I.SUCCESS):(n.activeAction="moving",n.target=u.id,n.direction=Ut(n.position,u.position,o.mapDimensions),I.RUNNING)}default:return o.autopilotControls.activeAutopilotAction=void 0,I.FAILURE}},"Execute Player Command",e+1)],"Player Command Handler",e)}function V_(e){return new pe([new te(n=>!!n.leaderId&&n.leaderId!==n.id,"Is Follower",e+1),new te((n,r)=>{if(!n.leaderId)return!1;const o=r.gameState.entities.entities[n.leaderId];return!!o&&o.isCallingToFollow===!0},"Is Leader Calling To Follow",e+1),new te(n=>n.hunger<iI,"Is Not Critically Hungry",e+1),new ue((n,r)=>{if(!n.leaderId)return I.FAILURE;const o=r.gameState.entities.entities[n.leaderId];return o?V(n.position,o.position,r.gameState.mapDimensions.width,r.gameState.mapDimensions.height)>nI?(n.activeAction="moving",n.target=o.id,n.direction=Ut(n.position,o.position,r.gameState.mapDimensions),I.RUNNING):(n.activeAction==="moving"&&n.target===o.id&&(n.activeAction="idle",n.target=void 0),I.SUCCESS):I.FAILURE},"Execute Follow Leader",e+1)],"Follow Leader Command",e)}const s0="tribeMigrationCheckCooldown";function X_(e){const n=new pe([new te(o=>!!o.leaderId&&o.leaderId===o.id,"Is Tribe Leader",e+2),new te((o,l)=>{const a=N.get(o.aiBlackboard,s0);return a?l.gameState.time-a>=Rm:!0},"Is Migration Check Cooldown Over",e+2),new ue((o,l)=>{o.aiBlackboard&&N.set(o.aiBlackboard,s0,l.gameState.time);const a=Dw(o,l.gameState);return a?(o.isCallingToFollow=!0,o.callToFollowEndTime=l.gameState.time+Qs,o.target=a,o.activeAction="moving",I.SUCCESS):I.FAILURE},"Execute Tribe Migration",e+2)],"Tribe Migration Strategy",e+1),r=new ra(n,ff,"Cache Tribe Migration",e+1);return new Fr(Rm,r,"Tribe Migration Cooldown",e)}function K_(e){const n=new te(o=>o.id===o.leaderId,"Is Leader?",e+1),r=new ue((o,l)=>{var g;const{gameState:a}=l,u=Zs(o.id,a),d=nu(u),h=mv(a).filter(m=>m.leaderId!==o.id);for(const m of h){const y=Zs(m.leaderId,a),S=nu(y),E=((g=o.diplomacy)==null?void 0:g[m.leaderId])||St.Friendly;d>S*wI?E!==St.Hostile&&o.diplomacy&&(o.diplomacy[m.leaderId]=St.Hostile):E!==St.Friendly&&o.diplomacy&&(o.diplomacy[m.leaderId]=St.Friendly)}return I.SUCCESS},"Evaluate Diplomacy",e+2);return new pe([n,new Fr(vI,r,"Diplomacy Cooldown",e+1)],"Manage Diplomacy",e)}const Ul="huntTarget";function q_(e){return new pe([new ra(new te((r,o,l)=>{var h;if(!r.isAdult)return[!1,"Not an adult"];if(!r.leaderId)return[!1,"Not in a tribe"];const a=kr(r.leaderId,o.gameState),u=((h=vv(a,o.gameState,"berryBush",Cm))==null?void 0:h.map(g=>g.id))||[],d=De(a,o.gameState,"prey",Cm,g=>typeof g.target=="number"&&u.includes(g.target));return d?(N.set(l,Ul,d.id),!0):!1},"Find Prey Target",e+2),mI,"Cache Find Prey",e+1),new ou(new ue((r,o,l)=>{if(!r.leaderId)return I.FAILURE;const a=N.get(l,Ul);if(!a)return I.FAILURE;const u=o.gameState.entities.entities[a];if(!u||u.hitpoints<=0)return N.delete(l,Ul),r.activeAction="idle",r.attackTargetId=void 0,I.SUCCESS;const{gameState:d}=o,h=kr(r.leaderId,d);return V(r.position,h,d.mapDimensions.width,d.mapDimensions.height)>tI?(N.delete(l,Ul),r.activeAction="idle",r.attackTargetId=void 0,I.FAILURE):(r.activeAction="attacking",r.attackTargetId=u.id,I.RUNNING)},"Hunt Prey Action",e+2),df,"Hunt Prey Timeout",e+1)],"Human Hunt Prey Sequence",e)}const Ll="defendTarget",$d=150;function Z_(e){return new pe([new te((n,r,o)=>{if(!n.isAdult)return[!1,"Not an adult - children flee instead"];const{gameState:l}=r;if(n.activeAction==="attacking"&&n.attackTargetId){const u=l.entities.entities[n.attackTargetId];if(u&&u.type==="predator"&&u.hitpoints>0&&V(n.position,u.position,l.mapDimensions.width,l.mapDimensions.height)<=$d)return N.set(o,Ll,u.id),[!0,"Continuing defense"]}const a=De(n,l,"predator",$d,u=>u.hitpoints>0&&(u.isAdult||!1));if(a){const u=V(n.position,a.position,l.mapDimensions.width,l.mapDimensions.height),d=a.attackTargetId===n.id,h=u<80;if(d||h)return N.set(o,Ll,a.id),[!0,"Predator threat detected"]}return N.set(o,Ll,void 0),[!1,"No predator threat"]},"Detect Predator Threat",e+1),new ue((n,r,o)=>{const l=N.get(o,Ll),a=l&&r.gameState.entities.entities[l];if(!a)return I.FAILURE;const{gameState:u}=r,d=V(n.position,a.position,u.mapDimensions.width,u.mapDimensions.height);return a.hitpoints<=0||d>$d*1.5?(n.activeAction="idle",n.attackTargetId=void 0,I.SUCCESS):(n.activeAction="attacking",n.attackTargetId=a.id,I.RUNNING)},"Defend Against Predator",e+1)],"Human Defend Against Predator",e)}function Q_(e){return new pe([new te((n,r,o)=>{const l=De(n,r.gameState,"predator",zt*2,()=>!0),a=De(n,r.gameState,"human",zt*2,()=>!0);let u=null,d=1/0;if(l){const h=V(n.position,l.position,r.gameState.mapDimensions.width,r.gameState.mapDimensions.height);h<d&&(d=h,u=l)}if(a){const h=V(n.position,a.position,r.gameState.mapDimensions.width,r.gameState.mapDimensions.height);h<d&&(d=h,u=a)}return u&&d<zt*1.5?(N.set(o,"fleeThreat",u.id),N.set(o,"fleeDistance",d),!0):!1},"Detect Threat",e+1),new ue((n,r,o)=>{const l=N.get(o,"fleeThreat"),a=l&&r.gameState.entities.entities[l];if(!a)return I.FAILURE;n.activeAction="moving";const u=ze(a.position,n.position,r.gameState.mapDimensions.width,r.gameState.mapDimensions.height),d=nt(u),h=On(n.position,Pt(d,bC));return n.target={x:(h.x%r.gameState.mapDimensions.width+r.gameState.mapDimensions.width)%r.gameState.mapDimensions.width,y:(h.y%r.gameState.mapDimensions.height+r.gameState.mapDimensions.height)%r.gameState.mapDimensions.height},n.direction=d,n.fleeCooldown=r.gameState.time+2,I.RUNNING},"Execute Flee",e+1)],"Prey Flee",e)}function J_(e){return new pe([new te((n,r,o)=>{if(!n.isAdult)return[!1,"Not an adult"];if(n.hunger<=30||n.eatingCooldownTime&&n.eatingCooldownTime>r.gameState.time)return!1;const l=De(n,r.gameState,"berryBush",zt*10,a=>a.food.length>0);return l?V(n.position,l.position,r.gameState.mapDimensions.width,r.gameState.mapDimensions.height)<=zt?(N.set(o,"grazingTarget",l.id),!0):(N.set(o,"grazingTarget",l.id),N.set(o,"needToMoveToTarget",!0),!0):!1},"Find Berry Bush",e+1),new ue((n,r,o)=>{const l=N.get(o,"grazingTarget"),a=l&&r.gameState.entities.entities[l],u=N.get(o,"needToMoveToTarget");if(!a)return I.FAILURE;const d=V(n.position,a.position,r.gameState.mapDimensions.width,r.gameState.mapDimensions.height);if(d<=zt)return n.activeAction="grazing",n.target=a.id,n.direction={x:0,y:0},N.delete(o,"needToMoveToTarget"),I.RUNNING;if(u||d>zt){n.activeAction="moving",n.target=a.id;const h=Ut(n.position,a.position,r.gameState.mapDimensions);return n.direction=h,I.RUNNING}return I.FAILURE},"Move to Bush or Graze",e+1)],"Prey Graze",e)}function e1(e){const n=new te((a,u,d)=>{const h=De(a,u.gameState,"prey",zt,g=>g.id!==a.id&&g.gender!==a.gender&&!!g.isAdult&&g.age>=zs&&g.age<=Md&&!g.isPregnant&&(!g.procreationCooldown||g.procreationCooldown<=0)&&g.hunger<200);return h?(N.set(d,"procreationPartner",h.id),!0):!1},"Find Immediate Partner",e+2),r=new ue((a,u,d)=>{const h=N.get(d,"procreationPartner"),g=h&&u.gameState.entities.entities[h];return g?(a.activeAction="procreating",a.target=g.id,a.direction={x:0,y:0},N.delete(d,"procreationPartner"),I.SUCCESS):I.FAILURE},"Start Procreating",e+2),o=new te((a,u,d)=>{const h=De(a,u.gameState,"prey",zt*10,g=>g.id!==a.id&&g.gender!==a.gender&&!!g.isAdult&&g.age>=zs&&g.age<=Md&&!g.isPregnant&&(!g.procreationCooldown||g.procreationCooldown<=0)&&g.hunger<200);return h?(N.set(d,"procreationPartner",h.id),!0):!1},"Locate Distant Partner",e+2),l=new ue((a,u,d)=>{const h=N.get(d,"procreationPartner"),g=h&&u.gameState.entities.entities[h];if(!g)return I.FAILURE;if(V(a.position,g.position,u.gameState.mapDimensions.width,u.gameState.mapDimensions.height)<=zt)return I.SUCCESS;a.activeAction="moving",a.target=g.id;const y=ze(a.position,g.position,u.gameState.mapDimensions.width,u.gameState.mapDimensions.height);return a.direction=nt(y),I.RUNNING},"Move Towards Partner",e+2);return new pe([new te(a=>!!(a.isAdult&&!a.isPregnant&&a.age>=zs&&a.age<=Md&&a.hunger<200&&(!a.procreationCooldown||a.procreationCooldown<=0)),"Is Fertile and Ready",e+1),new Zt([new pe([n,r],"Procreate With Immediate Partner",e+2),new pe([o,l],"Seek Distant Partner",e+2)],"Find Partner And Procreate",e+1)],"Prey Procreate",e)}const t1=(e,n,r)=>{const o=n.gameState.search.prey.byProperty("motherId",e.id).filter(u=>!u.isAdult&&u.type==="prey");if(o.length===0)return I.FAILURE;let l=null,a=Au;for(const u of o)u.hunger>=a&&(a=u.hunger,l=u);return l?(N.set(r,"targetChild",l.id),I.SUCCESS):I.FAILURE},n1=(e,n,r)=>{const o=N.get(r,"targetChild"),l=o&&n.gameState.entities.entities[o];return l?V(e.position,l.position,n.gameState.mapDimensions.width,n.gameState.mapDimensions.height)>Lo?(e.activeAction="moving",e.target=l.id,e.direction=Ut(e.position,l.position,n.gameState.mapDimensions),I.RUNNING):(e.activeAction="feeding",e.target=void 0,N.set(r,"targetChild",void 0),I.SUCCESS):I.FAILURE};function i1(e){return new pe([new te(n=>(n.isAdult&&n.gender==="female"&&n.hunger<80&&(!n.feedChildCooldownTime||n.feedChildCooldownTime<=0))??!1,"Can Feed Child (Female Only)",e+1),new ue(t1,"Find Hungriest Prey Child",e+1),new ue(n1,"Move To Child and Feed",e+1)],"Feed Prey Child",e)}function r1(e){return new pe([new te(n=>!n.isAdult&&n.hunger>=Au,"Is Hungry Prey Child",e+1),new ue((n,r,o)=>{if(!n.motherId)return I.FAILURE;const l=r.gameState.entities.entities[n.motherId];return l?(N.set(o,"targetParent",l.id),I.SUCCESS):I.FAILURE},"Find Female Parent",e+1),new ue((n,r,o)=>{const l=N.get(o,"targetParent"),a=l&&r.gameState.entities.entities[l];if(!a)return I.FAILURE;const u=V(n.position,a.position,r.gameState.mapDimensions.width,r.gameState.mapDimensions.height);return n.activeAction="idle",u<=Lo?(n.target=void 0,I.SUCCESS):(n.target=a.id,n.activeAction="moving",I.RUNNING)},"Move To Female Parent",e+1)],"Seek Food From Female Parent",e)}function o1(e){return new pe([new te((n,r,o)=>{if(!n.isAdult)return[!1,"Not an adult"];if(n.hunger<=50||n.huntCooldown&&n.huntCooldown>0)return!1;const l=De(n,r.gameState,"prey",fo*10,a=>a.hitpoints>0);if(l){const a=V(n.position,l.position,r.gameState.mapDimensions.width,r.gameState.mapDimensions.height);if(a<=fo)return N.set(o,"huntTarget",l.id),!0;if(a<=fo*10)return N.set(o,"huntTarget",l.id),N.set(o,"needToApproach",!0),!0}return!1},"Find Prey Target",e+1),new ou(new ue((n,r,o)=>{const l=N.get(o,"huntTarget"),a=l&&r.gameState.entities.entities[l],u=N.get(o,"needToApproach");if(!a||a.hitpoints<=0)return I.FAILURE;const d=V(n.position,a.position,r.gameState.mapDimensions.width,r.gameState.mapDimensions.height);if(d<=fo)return n.activeAction="attacking",n.attackTargetId=a.id,n.target=a.id,n.direction={x:0,y:0},N.delete(o,"needToApproach"),I.RUNNING;if(u||d>fo){n.activeAction="moving",n.target=a.id;const h=ze(n.position,a.position,r.gameState.mapDimensions.width,r.gameState.mapDimensions.height);return n.direction=nt(h),I.RUNNING}return I.FAILURE},"Hunt or Approach Prey",e+2),10,"Hunt Timeout (10 hour)",e+1)],"Predator Hunt",e)}function s1(e){return new pe([new te((n,r,o)=>{const l=n.hunger>100,a=n.hitpoints<n.maxHitpoints*.5;if(!l&&!a||n.attackCooldown&&n.attackCooldown>0)return!1;const u=De(n,r.gameState,"human",Nn*2,d=>d.hitpoints>0);if(u){const d=V(n.position,u.position,r.gameState.mapDimensions.width,r.gameState.mapDimensions.height);if(d<=Nn)return N.set(o,"attackTarget",u.id),!0;if(l&&d<=Nn*2)return N.set(o,"attackTarget",u.id),N.set(o,"needToApproach",!0),!0}return!1},"Find Human Target",e+1),new ue((n,r,o)=>{const l=N.get(o,"attackTarget"),a=l&&r.gameState.entities.entities[l],u=N.get(o,"needToApproach");if(!a||a.hitpoints<=0)return I.FAILURE;const d=V(n.position,a.position,r.gameState.mapDimensions.width,r.gameState.mapDimensions.height);if(d<=Nn)return n.activeAction="attacking",n.attackTargetId=a.id,n.target=a.id,n.direction={x:0,y:0},N.delete(o,"needToApproach"),I.RUNNING;if(u||d>Nn){n.activeAction="moving",n.target=a.id;const h=ze(n.position,a.position,r.gameState.mapDimensions.width,r.gameState.mapDimensions.height);return n.direction=nt(h),I.RUNNING}return I.FAILURE},"Attack or Approach Human",e+1)],"Predator Attack Human",e)}function a1(e){const n=new te((a,u,d)=>{const h=De(a,u.gameState,"predator",Ki,g=>g.id!==a.id&&g.gender!==a.gender&&!!g.isAdult&&g.age>=Ws&&g.age<=Fd&&!g.isPregnant&&(!g.procreationCooldown||g.procreationCooldown<=0)&&g.hunger<200);return h?(N.set(d,"procreationPartner",h.id),!0):!1},"Find Immediate Partner",e+2),r=new ue((a,u,d)=>{const h=N.get(d,"procreationPartner"),g=h&&u.gameState.entities.entities[h];return g?(a.activeAction="procreating",a.target=g.id,a.direction={x:0,y:0},N.delete(d,"procreationPartner"),I.SUCCESS):I.FAILURE},"Start Procreating",e+2),o=new te((a,u,d)=>{const h=De(a,u.gameState,"predator",Ki*10,g=>g.id!==a.id&&g.gender!==a.gender&&!!g.isAdult&&g.age>=Ws&&g.age<=Fd&&!g.isPregnant&&(!g.procreationCooldown||g.procreationCooldown<=0)&&g.hunger<200);return h?(N.set(d,"procreationPartner",h.id),!0):!1},"Locate Distant Partner",e+2),l=new ue((a,u,d)=>{const h=N.get(d,"procreationPartner"),g=h&&u.gameState.entities.entities[h];if(!g)return I.FAILURE;if(V(a.position,g.position,u.gameState.mapDimensions.width,u.gameState.mapDimensions.height)<=Ki)return I.SUCCESS;a.activeAction="moving",a.target=g.id;const y=ze(a.position,g.position,u.gameState.mapDimensions.width,u.gameState.mapDimensions.height);return a.direction=nt(y),I.RUNNING},"Move Towards Partner",e+2);return new pe([new te(a=>!!(a.isAdult&&!a.isPregnant&&a.age>=Ws&&a.age<=Fd&&a.hunger<200&&(!a.procreationCooldown||a.procreationCooldown<=0)),"Is Fertile and Ready",e+1),new Zt([new pe([n,r],"Procreate With Immediate Partner",e+2),new pe([o,l],"Seek Distant Partner",e+2)],"Find Partner And Procreate",e+1)],"Predator Procreate",e)}const l1=(e,n,r)=>{const o=n.gameState.search.predator.byProperty("motherId",e.id).filter(u=>!u.isAdult&&u.type==="predator");if(o.length===0)return I.FAILURE;let l=null,a=Au;for(const u of o)u.hunger>=a&&(a=u.hunger,l=u);return l?(N.set(r,"targetChild",l.id),I.SUCCESS):I.FAILURE},u1=(e,n,r)=>{const o=N.get(r,"targetChild"),l=o&&n.gameState.entities.entities[o];return l?V(e.position,l.position,n.gameState.mapDimensions.width,n.gameState.mapDimensions.height)>Lo?(e.activeAction="moving",e.target=l.id,e.direction=Ut(e.position,l.position,n.gameState.mapDimensions),I.RUNNING):(e.activeAction="feeding",e.target=void 0,N.set(r,"targetChild",void 0),I.SUCCESS):I.FAILURE};function c1(e){return new pe([new te(n=>(n.isAdult&&n.gender==="female"&&n.hunger<90&&(!n.feedChildCooldownTime||n.feedChildCooldownTime<=0))??!1,"Can Feed Child (Female Only)",e+1),new ue(l1,"Find Hungriest Predator Child",e+1),new ue(u1,"Move To Child and Feed",e+1)],"Feed Predator Child",e)}function d1(e){return new pe([new te(n=>!n.isAdult&&n.hunger>=Au,"Is Hungry Predator Child",e+1),new ue((n,r,o)=>{if(!n.motherId)return I.FAILURE;const l=r.gameState.entities.entities[n.motherId];return l?(N.set(o,"targetParent",l.id),I.SUCCESS):I.FAILURE},"Find Female Parent",e+1),new ue((n,r,o)=>{const l=N.get(o,"targetParent"),a=l&&r.gameState.entities.entities[l];if(!a)return I.FAILURE;const u=V(n.position,a.position,r.gameState.mapDimensions.width,r.gameState.mapDimensions.height);return n.activeAction="idle",u<=Lo?(n.target=void 0,I.SUCCESS):(n.target=a.id,n.activeAction="moving",I.RUNNING)},"Move To Female Parent",e+1)],"Seek Food From Female Parent",e)}function ey(e){return new ue((n,r,o)=>{n.activeAction="idle";let l=N.get(o,"wanderTarget"),a=N.get(o,"wanderStartTime");const u=r.gameState.time;if(!l||!a||u-a>2){const d=Math.random()*2*Math.PI,h=50+Math.random()*100,g={x:Math.cos(d),y:Math.sin(d)},m=On(n.position,Pt(g,h));l={x:(m.x%r.gameState.mapDimensions.width+r.gameState.mapDimensions.width)%r.gameState.mapDimensions.width,y:(m.y%r.gameState.mapDimensions.height+r.gameState.mapDimensions.height)%r.gameState.mapDimensions.height},N.set(o,"wanderTarget",l),N.set(o,"wanderStartTime",u)}if(l){n.target=l;let d=l.x-n.position.x,h=l.y-n.position.y;const g=r.gameState.mapDimensions.width,m=r.gameState.mapDimensions.height;Math.abs(d)>g/2&&(d=d>0?d-g:d+g),Math.abs(h)>m/2&&(h=h>0?h-m:h+m);const y=nt({x:d,y:h});n.direction=y}return I.SUCCESS},"Animal Wander",e)}function f1(e){return new pe([new te((n,r,o)=>{if(n.hunger>90||n.hitpoints<n.maxHitpoints*.3||n.activeAction==="grazing"||n.activeAction==="procreating")return!1;const l=Object.values(r.gameState.entities.entities),a=[];for(const u of l)if(u.type==="prey"&&u.id!==n.id){const d=u;d.hitpoints>0&&d.isAdult&&V(n.position,d.position,r.gameState.mapDimensions.width,r.gameState.mapDimensions.height)<=zt*5&&a.push(d)}if(a.length>=2){let u=0,d=0;for(const m of a)u+=m.position.x,d+=m.position.y;u/=a.length,d/=a.length;const h={x:u,y:d};if(V(n.position,h,r.gameState.mapDimensions.width,r.gameState.mapDimensions.height)>zt*2)return N.set(o,"herdCenter",h),N.set(o,"herdSize",a.length),!0}return!1},"Find Herd",e+1),new ue((n,r,o)=>{const l=N.get(o,"herdCenter");if(!l)return I.FAILURE;if(V(n.position,l,r.gameState.mapDimensions.width,r.gameState.mapDimensions.height)>zt*2){n.activeAction="moving",n.target=l;const u=ze(n.position,l,r.gameState.mapDimensions.width,r.gameState.mapDimensions.height);return n.direction=nt(u),I.RUNNING}else return n.activeAction="idle",n.direction={x:0,y:0},I.SUCCESS},"Join Herd",e+1)],"Prey Herd Behavior",e)}function h1(e){return new pe([new te((n,r,o)=>{if(n.hunger>100||n.hitpoints<n.maxHitpoints*.4||n.activeAction==="attacking"||n.activeAction==="procreating")return!1;const l=De(n,r.gameState,"predator",Ki*4,a=>a.id!==n.id&&a.hitpoints>0&&a.isAdult&&n.fatherId!==void 0&&a.fatherId===n.fatherId&&a.age>=n.age||a.hitpoints>n.hitpoints);return l&&V(n.position,l.position,r.gameState.mapDimensions.width,r.gameState.mapDimensions.height)>Ki*2?(N.set(o,"packLeader",l.id),!0):!1},"Find Pack Leader",e+1),new ue((n,r,o)=>{const l=N.get(o,"packLeader"),a=l&&r.gameState.entities.entities[l];if(!a||a.hitpoints<=0)return I.FAILURE;if(V(n.position,a.position,r.gameState.mapDimensions.width,r.gameState.mapDimensions.height)>Ki*2){n.activeAction="moving",n.target=a.id;const d=ze(n.position,a.position,r.gameState.mapDimensions.width,r.gameState.mapDimensions.height);return n.direction=nt(d),I.RUNNING}else return n.activeAction="idle",n.direction={x:0,y:0},I.SUCCESS},"Follow Pack Leader",e+1)],"Predator Pack Behavior",e)}function g1(e){return new pe([new te((n,r,o)=>{if(!n.isAdult||n.hitpoints<n.maxHitpoints*.6||n.hunger>120||n.attackCooldown&&n.attackCooldown>0)return!1;const l=De(n,r.gameState,"predator",e0,a=>!!(a.id!==n.id&&a.hitpoints>0&&a.isAdult&&n.fatherId!==a.fatherId&&n.gender===a.gender&&n.fatherId!==void 0&&a.fatherId!==void 0));if(l){const a=V(n.position,l.position,r.gameState.mapDimensions.width,r.gameState.mapDimensions.height);if(a<=Nn)return N.set(o,"territorialTarget",l.id),!0;if(a<=e0)return N.set(o,"territorialTarget",l.id),N.set(o,"needToApproach",!0),!0}return!1},"Find Territorial Rival",e+1),new ue((n,r,o)=>{const l=N.get(o,"territorialTarget"),a=l&&r.gameState.entities.entities[l],u=N.get(o,"needToApproach");if(!a||a.hitpoints<=0)return I.FAILURE;const d=V(n.position,a.position,r.gameState.mapDimensions.width,r.gameState.mapDimensions.height);if(d<=Nn)return n.activeAction="attacking",n.attackTargetId=a.id,n.target=a.id,n.direction={x:0,y:0},N.delete(o,"needToApproach"),I.RUNNING;if(u||d>Nn){n.activeAction="moving",n.target=a.id;const h=ze(n.position,a.position,r.gameState.mapDimensions.width,r.gameState.mapDimensions.height);return n.direction=nt(h),I.RUNNING}return I.FAILURE},"Territorial Fight or Approach",e+1)],"Predator Territorial Defense",e)}function p1(){const e=new Zt([T_(2),$_(2),Z_(2),x_(2),z_(2),W_(2),j_(2),new Ps(L_(3),"Gated Leader Combat Strategy",2),new Ps(K_(3),"Gated Diplomacy",2),B_(2),new Yn(U_(3),"attack","Gated Storage Steal",2),new Yn(__(3),"attack","Gated Attacking",2),A_(2),new Yn(F_(3),"gathering","Gated Storage Retrieve",2),new ou(new Yn(w_(4),"gathering","Gated Gathering",3),df,"Timeout Gathering",2),new Yn(M_(3),"gathering","Gated Storage Deposit",2),new Yn(N_(3),"feedChildren","Gated Feed Child",2),D_(2),new ou(new Yn(k_(4),"planting","Gated Planting",3),df,"Timeout Planting",2),new Yn(q_(3),"attack","Gated Hunt Prey",2),new Yn(C_(3),"procreation","Gated Procreation",2),new ra(G_(3),ff,"Cache Tribe Split",2),new Ps(X_(3),"Gated Tribe Migration",2),new ra(H_(3),ff,"Cache Establish Territory",2),new Yn(V_(3),"followLeader","Gated Follow Leader",2),new Ps(b_(2),"Gated Follow Patriarch",2),new Ps(E_(2),"Gated Idle Wander",2)],"AI Root Selector",1);return new S_(e,"Manual Control Gate",0)}const ty=p1();function m1(e,n){e.aiBlackboard&&N.cleanupOldEntries(e.aiBlackboard,n.gameState.time);const r=performance.now();switch(e.aiType){case ua.BehaviorTreeBased:default:ih(e,n,ty);break}n.gameState.performanceMetrics.currentBucket.aiUpdateTime+=performance.now()-r}function v1(){return new Zt([Q_(1),i1(1),r1(1),J_(1),e1(1),f1(1),ey(1)],"Prey Behavior Root",0)}function y1(){return new Zt([o1(1),s1(1),c1(1),d1(1),g1(1),a1(1),h1(1),ey(1)],"Predator Behavior Root",0)}const ny=v1();function S1(e,n){e.aiBlackboard?ih(e,n,ny):(console.warn(`Behavior Tree AI ticked for prey ${e.id}, but the tree or blackboard was missing.`),e.activeAction="idle")}const iy=y1();function A1(e,n){e.aiBlackboard?ih(e,n,iy):(console.warn(`Behavior Tree AI ticked for predator ${e.id}, but the tree or blackboard was missing.`),e.activeAction="idle")}function T1(e,n){const{gameState:r,deltaTime:o}=n,l=o*(At/Tt);if(e.isBeingDestroyed){const a=ww(e.buildingType);if(a>0?e.destructionProgress+=l/a:e.destructionProgress=1,e.destructionProgress>=1){Ho(r.entities,e.id);return}}if(!e.isConstructed&&!e.isBeingDestroyed){const a=Iw(e.buildingType);a>0?e.constructionProgress+=l/a:e.constructionProgress=1,e.constructionProgress>=1&&(e.constructionProgress=1,e.isConstructed=!0)}}function I1(e,n){e.forces.push(Pt(e.velocity,-.1));const r=Pt(nt(e.direction),e.acceleration);e.forces.push(r),e.debuffs.forEach(o=>{n.gameState.time-o.startTime<o.duration&&o.type==="slow"&&(e.velocity=Pt(e.velocity,.5))}),e.debuffs=e.debuffs.filter(o=>n.gameState.time-o.startTime<o.duration),e.velocity=On(e.velocity,e.forces.reduce(On,{x:0,y:0})),Ro(e.velocity)<.001&&(e.velocity={x:0,y:0}),e.position=On(e.position,Pt(e.velocity,n.deltaTime)),e.position.x=(e.position.x%n.gameState.mapDimensions.width+n.gameState.mapDimensions.width)%n.gameState.mapDimensions.width,e.position.y=(e.position.y%n.gameState.mapDimensions.height+n.gameState.mapDimensions.height)%n.gameState.mapDimensions.height,e.forces=[],e.type==="human"?h_(e,n,n.deltaTime):e.type==="corpse"?g_(e,n):e.type==="prey"?p_(e,n,n.deltaTime):e.type==="predator"?m_(e,n,n.deltaTime):e.type==="building"&&T1(e,n),e.type==="human"&&m1(e,n),e.type==="prey"?S1(e,n):e.type==="predator"&&A1(e,n),e.stateMachine&&(e.stateMachine=f_(...e.stateMachine,{entity:e,updateContext:n}))}function w1(e){const n=e.gameState.entities;Object.values(n.entities).forEach(r=>{I1(r,e)})}function ry(){return{entities:{},nextEntityId:1}}function Bo(e,n,r){const o={id:e.nextEntityId++,type:n,velocity:{x:0,y:0},direction:{x:0,y:0},acceleration:0,forces:[],debuffs:[],...r};return e.entities[o.id]=o,o}function ca(e,n,r){return Bo(e,"berryBush",{position:n,radius:uf,food:Array.from({length:WT},()=>({type:qn.Berry})).map(l=>({...l,id:e.nextEntityId++})),maxFood:zT,lifespan:jT,age:0,spreadRadius:uf,timeSinceLastBerryRegen:0,timeSinceLastSpreadAttempt:0,timeSinceLastHarvest:0,stateMachine:[Hs,{enteredAt:r,previousState:void 0}]})}function au(e,n,r,o,l=!1,a=bI,u=lv,d,h,g=[],m,y){const S=a>=Lf;return Bo(e,"human",{position:n,radius:S?Et:Fo,hunger:u,hitpoints:Dm,maxHitpoints:Dm,age:a,gender:o,isPlayer:l,food:[],maxFood:av,maxAge:qs,isAdult:S,isPregnant:!1,gestationTime:0,procreationCooldown:0,attackCooldown:0,motherId:d,fatherId:h,ancestorIds:g,stateMachine:[ut,{enteredAt:r,previousState:void 0}],leaderId:m,tribeBadge:y,aiType:ua.BehaviorTreeBased,aiBlackboard:N.create()})}function oh(e,n,r,o,l,a,u,d,h,g,m){let y,S;switch(u){case"human":y=dv,S=Dr;break;case"prey":y=2,S=120;break;case"predator":y=4,S=140;break}return Bo(e,"corpse",{position:n,radius:l,gender:r,age:o,originalEntityId:a,originalEntityType:u,timeOfDeath:d,decayProgress:0,geneCode:m,food:[...Array.from({length:Math.max(y*Math.max(S-g,0)/S,0)},()=>({type:qn.Meat})),...h].map(w=>({...w,id:e.nextEntityId++})),stateMachine:void 0})}function E1(e,n,r,o,l,a,u,d,h){return oh(e,n,r,o,l,a,"human",u,d,h)}function C1(e,n,r,o,l,a,u,d){return oh(e,n,r,o,l,a,"prey",u,[],0,d)}function _1(e,n,r,o,l,a,u,d){return oh(e,n,r,o,l,a,"predator",u,[],0,d)}function R1(e,n,r){const o=n?r.gameState.entities.entities[n]:void 0,l=[...e.ancestorIds||[],e.id],a=o?[...o.ancestorIds||[],o.id]:[],u=[...l,...a],d=[...new Set(u)],h=d.slice(Math.max(d.length-UI,0)),g=Math.random()<.5?"male":"female",m=On(e.position,{x:5,y:5}),y=au(r.gameState.entities,m,r.gameState.time,g,!1,0,lv/2,e.id,n,h,(o==null?void 0:o.leaderId)??e.leaderId,(o==null?void 0:o.tribeBadge)??e.tribeBadge);return Ie(r,fe.Birth,e.position),y}function Ho(e,n){return e.entities[n]?(delete e.entities[n],!0):!1}function Do(e,n,r,o=HC,l=jv,a,u,d){const h=o>=zs,g=Date.now();return Bo(e,"prey",{position:n,radius:h?Et*.7:Fo*.7,hunger:l,hitpoints:Qm,maxHitpoints:Qm,age:o,maxAge:Yv,gender:r,isAdult:h,isPregnant:!1,gestationTime:0,procreationCooldown:0,geneCode:a,motherId:u,fatherId:d,stateMachine:[Pn,{enteredAt:g,previousState:void 0}],aiType:ua.BehaviorTreeBased,aiBlackboard:N.create()})}function Oo(e,n,r,o=jC,l=Xv,a,u,d){const h=o>=Ws,g=Date.now();return Bo(e,"predator",{position:n,radius:h?Et*.9:Fo*.9,hunger:l,hitpoints:Jm,maxHitpoints:Jm,age:o,maxAge:Vv,gender:r,isAdult:h,isPregnant:!1,gestationTime:0,procreationCooldown:0,geneCode:a,motherId:u,fatherId:d,stateMachine:[$t,{enteredAt:g,previousState:void 0}],aiType:ua.BehaviorTreeBased,aiBlackboard:N.create()})}function P1(e,n,r,o){const l=Sv(r),a={position:n,radius:Math.max(l.width,l.height)/2,buildingType:r,ownerId:o,width:l.width,height:l.height,constructionProgress:0,destructionProgress:0,isConstructed:!1,isBeingDestroyed:!1};return Bo(e,"building",{...a,...r===tu.StorageSpot&&{storedFood:[],storageCapacity:dC,lastDepositTime:0,lastRetrieveTime:0,lastStealTime:0}})}var Gt=(e=>(e.MOVE="MOVE",e.HUNGER="HUNGER",e.EAT="EAT",e.FIND_BUSH="FIND_BUSH",e.GATHER="GATHER",e.PROCREATE="PROCREATE",e.PLANT_BUSH="PLANT_BUSH",e.AUTOPILOT="AUTOPILOT",e.ANIMALS_INTRODUCTION="ANIMALS_INTRODUCTION",e.HUNT_PREY="HUNT_PREY",e.DEFEND_FROM_PREDATORS="DEFEND_FROM_PREDATORS",e))(Gt||{}),Pr=(e=>(e.HUNGER_BAR="HUNGER_BAR",e.FOOD_BAR="FOOD_BAR",e.COMMAND_BUTTONS="COMMAND_BUTTONS",e))(Pr||{}),xt=(e=>(e[e.FADING_IN=0]="FADING_IN",e[e.ACTIVE=1]="ACTIVE",e[e.FADING_OUT=2]="FADING_OUT",e[e.INACTIVE=3]="INACTIVE",e))(xt||{});const Af={},Tf={},N1=[{key:Gt.MOVE,title:"Movement",text:"Use WASD or Arrow Keys to move your character around the world.",condition:e=>e.hasPlayerMovedEver||e.hasPlayerEnabledAutopilot>2,isCompleted:!1},{key:Gt.HUNGER,title:"Hunger",text:"Your character gets hungry over time. Watch the hunger bar!",condition:(e,n)=>n.hunger>LI,isCompleted:!1,minDisplayTime:Ym,highlightedUIElements:[Pr.HUNGER_BAR]},{key:Gt.FIND_BUSH,title:"Find Food",text:"Look for berry bushes. They are your primary source of food.",condition:(e,n)=>!!De(n,e,"berryBush",It*5,o=>o.food.length>0),getTargets:(e,n)=>{const r=[];for(const o of Object.values(e.entities.entities))o.type==="berryBush"&&o.food.length>0&&V(n.position,o.position,e.mapDimensions.width,e.mapDimensions.height)<500&&r.push(o);return r.map(o=>o.id)},isCompleted:!1,minDisplayTime:Ym},{key:Gt.GATHER,title:"Gather Berries",text:"Get close to a bush and press 'E' to gather berries.",condition:(e,n)=>n.food.length>0,getTargets:(e,n)=>{const r=De(n,e,"berryBush",It,o=>o.food.length>0);return r?[r.id]:[]},isCompleted:!1},{key:Gt.EAT,title:"Eat",text:"When you are hungry and have food, press 'F' to eat.",condition:(e,n)=>n.activeAction==="eating",isCompleted:!1,highlightedUIElements:[Pr.FOOD_BAR]},{key:Gt.PROCREATE,title:"Procreate",text:"Find a mate and press 'R' to start a family. This is how you continue your lineage.",condition:(e,n)=>Nt(e,n).length>0,getTargets:(e,n)=>{const r=De(n,e,"human",It,o=>Mr(n,o,e));return r?[r.id]:[]},isCompleted:!1},{key:Gt.PLANT_BUSH,title:"Farming",text:"You can plant new berry bushes. Carry some berries and press 'B' to plant.",condition:(e,n)=>th(e,n).some(o=>o.type===ce.Plant)||e.hasPlayerPlantedBush===!0,isCompleted:!1},{key:Gt.AUTOPILOT,title:"Autopilot!",text:"You can turn autopilot for specific actions, press Shift and click on the action button to enable it.",condition:e=>e.hasPlayerEnabledAutopilot>2,highlightedUIElements:[Pr.COMMAND_BUTTONS],isCompleted:!1},{key:Gt.ANIMALS_INTRODUCTION,title:"Wild Animals!",text:"Your world now has wild animals! Prey provide meat when hunted, but beware of predators that may attack.",condition:e=>Object.values(e.entities.entities).some(r=>r.type==="prey"||r.type==="predator"),isCompleted:!1,dependsOn:Gt.AUTOPILOT},{key:Gt.HUNT_PREY,title:"Hunt for Meat",text:"Click on prey animals to hunt them for meat. Hunting provides more food than gathering berries!",condition:(e,n)=>{const r=De(n,e,"prey",150);return n.hunger>40&&!!r},getTargets:(e,n)=>{const r=De(n,e,"prey",150);return r?[r.id]:[]},isCompleted:!1,dependsOn:Gt.ANIMALS_INTRODUCTION},{key:Gt.DEFEND_FROM_PREDATORS,title:"Predators",text:"Predators may attack when hungry! Click on them to fight back. Fighting together with family is more effective.",condition:(e,n)=>!!De(n,e,"predator",120),getTargets:(e,n)=>{const r=De(n,e,"predator",120);return r?[r.id]:[]},isCompleted:!1,dependsOn:Gt.HUNT_PREY}].map(e=>({...e,condition:e.condition?k1(e.condition):void 0,getTargets:e.getTargets?M1(e.getTargets):void 0}));function oy(){return{steps:N1.map(e=>({...e,isCompleted:!1}))}}function sy(){return{currentStepIndex:0,completedSteps:[],isActive:!0,transitionState:xt.FADING_IN,transitionAlpha:0,highlightedEntityIds:[],stepStartTime:null,activeUIHighlights:[]}}function D1(e){for(let n=0;n<e.tutorial.steps.length;n++){const r=e.tutorial.steps[n];if(!r.isCompleted)if(r.dependsOn){if(e.tutorialState.completedSteps.includes(r.dependsOn))return n}else return n}return null}function O1(e,n){const r=e.tutorialState;if(!r.isActive){r.transitionState=xt.INACTIVE,r.highlightedEntityIds=[],r.activeUIHighlights=[];return}const o=wt(e);if(!o){r.isActive=!1,r.transitionState=xt.INACTIVE,r.highlightedEntityIds=[],r.activeUIHighlights=[];return}const l=e.tutorial.steps[r.currentStepIndex];if(!l){r.isActive=!1,r.transitionState=xt.INACTIVE,r.highlightedEntityIds=[],r.activeUIHighlights=[];return}const a=1/EE;switch(r.transitionState){case xt.FADING_IN:r.stepStartTime===null&&(r.stepStartTime=e.time),r.transitionAlpha+=a*n,r.transitionAlpha>=1&&(r.transitionAlpha=1,r.transitionState=xt.ACTIVE);break;case xt.ACTIVE:{const h=e.time-(r.stepStartTime||e.time)>=(l.minDisplayTime||0),g=Af[l.condition];g&&h&&g(e,o)&&(l.isCompleted=!0,r.completedSteps.includes(l.key)||r.completedSteps.push(l.key),r.transitionState=xt.FADING_OUT);break}case xt.FADING_OUT:if(r.transitionAlpha-=a*n,r.transitionAlpha<=0){r.transitionAlpha=0,r.stepStartTime=null;const d=D1(e);d!==null?(r.currentStepIndex=d,r.transitionState=xt.FADING_IN):(r.isActive=!1,r.transitionState=xt.INACTIVE)}break}if(r.transitionState!==xt.FADING_OUT&&r.transitionState!==xt.INACTIVE){const d=Tf[l.getTargets||""];d?r.highlightedEntityIds=[...d(e,o)]:r.highlightedEntityIds=[],l.highlightedUIElements?r.activeUIHighlights=[...l.highlightedUIElements]:r.activeUIHighlights=[]}else r.highlightedEntityIds=[],r.activeUIHighlights=[]}function k1(e){const n=`condition_${Object.keys(Af).length+1}`;return Af[n]=e,n}function M1(e){const n=`getTargets_${Object.keys(Tf).length+1}`;return Tf[n]=e,n}function F1(){const e=ry(),n=0;for(let y=0;y<J0;y++){const S={x:Math.random()*et,y:Math.random()*tt};ca(e,S,n)}const r=et/2,o=tt/2,l=au(e,{x:r,y:o},n,"male",!0);au(e,{x:r+50,y:o},n,"female",!1);for(let y=0;y<Zv;y++){const S={x:r+et*(Math.random()-Math.random()),y:o+tt*(Math.random()-Math.random())};Do(e,S,"male",void 0,void 0,na()),Do(e,{x:S.x+20,y:S.y},"female",void 0,void 0,na())}const a={x:r+et*(Math.random()-Math.random()),y:o+tt*(Math.random()-Math.random())};Oo(e,a,"male",void 0,void 0,ia()),Oo(e,{x:a.x+20,y:a.y},"female",void 0,void 0,ia());const u=[{id:"muteButton",action:ge.ToggleMute,currentWidth:ci,rect:{x:0,y:0,width:0,height:0},text:"",backgroundColor:"",textColor:vn},{id:"pauseButton",action:ge.TogglePause,currentWidth:ci,rect:{x:0,y:0,width:0,height:0},text:"",backgroundColor:"",textColor:vn},{id:"returnToIntroButton",action:ge.ReturnToIntro,currentWidth:ci,rect:{x:0,y:0,width:0,height:0},text:"EXIT",backgroundColor:"",textColor:vn}],d=oy(),h=sy(),g={time:n,entities:e,mapDimensions:{width:et,height:tt},generationCount:1,gameOver:!1,visualEffects:[],nextVisualEffectId:0,viewportCenter:{...l.position},isPaused:!1,exitConfirmation:"inactive",autopilotControls:{behaviors:{procreation:!1,planting:!1,gathering:!1,attack:!1,feedChildren:!0,followLeader:!1},hoveredAutopilotAction:void 0,activeAutopilotAction:void 0,isManuallyMoving:!1},buildMenuOpen:!1,selectedBuildingType:null,selectedBuildingForRemoval:null,hasPlayerMovedEver:!1,hasPlayerPlantedBush:!1,hasPlayerEnabledAutopilot:0,masterVolume:xv,isMuted:!1,uiButtons:u,tutorial:d,tutorialState:h,debugPanel:Rt.None,performanceMetrics:{currentBucket:{renderTime:0,worldUpdateTime:0,aiUpdateTime:0},history:[]},hoveredButtonId:void 0,mousePosition:{x:0,y:0},notifications:[{id:"welcome",type:Js.Hello,message:"Welcome to the game!",duration:50,targetEntityIds:[l.id],highlightedEntityIds:[l.id],timestamp:0,isDismissed:!1,creationTime:Date.now()}],ecosystem:{preyGestationPeriod:wr,preyProcreationCooldown:Er,predatorGestationPeriod:Cr,predatorProcreationCooldown:_r,preyHungerIncreasePerHour:Yi,predatorHungerIncreasePerHour:ji,berryBushSpreadChance:gi},autosaveIntervalSeconds:5,lastAutosaveTime:Date.now()},m=uu(g);return console.log("Game world initialized:",m),m}function U1(){const e=ry(),n=0;for(let u=0;u<J0;u++){const d={x:Math.random()*et,y:Math.random()*tt};ca(e,d,n)}for(let u=0;u<GT;u++){const d={x:Math.random()*et,y:Math.random()*tt},h=Math.random()<.5?"male":"female";au(e,d,n,h,!1)}for(let u=0;u<Zv;u++){const d={x:Math.random()*et,y:Math.random()*tt};Do(e,d,"male",void 0,void 0,na()),Do(e,{x:d.x+20,y:d.y},"female",void 0,void 0,na())}const r={x:Math.random()*et,y:Math.random()*tt};Oo(e,r,"male",void 0,void 0,ia()),Oo(e,{x:r.x+20,y:r.y},"female",void 0,void 0,ia());const o=oy(),l=sy(),a={time:n,entities:e,mapDimensions:{width:et,height:tt},generationCount:0,gameOver:!1,visualEffects:[],nextVisualEffectId:0,viewportCenter:{x:et/2,y:tt/2},isPaused:!1,exitConfirmation:"inactive",autopilotControls:{behaviors:{procreation:!1,planting:!1,gathering:!1,attack:!1,feedChildren:!0,followLeader:!1},hoveredAutopilotAction:void 0,activeAutopilotAction:void 0,isManuallyMoving:!1},buildMenuOpen:!1,selectedBuildingType:null,selectedBuildingForRemoval:null,hasPlayerMovedEver:!1,hasPlayerPlantedBush:!1,hasPlayerEnabledAutopilot:0,masterVolume:xv,isMuted:!0,uiButtons:[],tutorial:o,tutorialState:l,debugPanel:Rt.None,performanceMetrics:{currentBucket:{renderTime:0,worldUpdateTime:0,aiUpdateTime:0},history:[]},hoveredButtonId:void 0,mousePosition:{x:0,y:0},notifications:[],ecosystem:{preyGestationPeriod:wr,preyProcreationCooldown:Er,predatorGestationPeriod:Cr,predatorProcreationCooldown:_r,preyHungerIncreasePerHour:Yi,predatorHungerIncreasePerHour:ji,berryBushSpreadChance:gi},lastAutosaveTime:0};return uu(a)}const L1="humanProcreation",B1="human",H1="human",b1=It,G1=(e,n,r)=>Mr(e,n,r.gameState)?e.gender==="male"?e.activeAction==="procreating":e.activeAction==="procreating"&&n.activeAction==="procreating":!1,x1=(e,n,r)=>{var h,g;const{gameState:o}=r,l={x:(e.position.x+n.position.x)/2,y:(e.position.y+n.position.y)/2},a=e.gender==="male"?e:n,u=e.gender==="female"?e:n,d=(a.partnerIds||[]).length===0;if(e.stateMachine=[ta,{partnerId:n.id,previousState:(h=e.stateMachine)==null?void 0:h[0]}],n.stateMachine=[ta,{partnerId:e.id,previousState:(g=n.stateMachine)==null?void 0:g[0]}],e.partnerIds||(e.partnerIds=[]),e.partnerIds.includes(n.id)||e.partnerIds.push(n.id),n.partnerIds||(n.partnerIds=[]),n.partnerIds.includes(e.id)||n.partnerIds.push(e.id),d&&a.leaderId&&a.leaderId!==a.id){const m=o.entities.entities[a.leaderId];if(m){const y=hf(a,m),S=hf(u,m);if(!y&&!S){const E=vf();a.leaderId=a.id,a.tribeBadge=E,a.diplomacy={},u.leaderId=a.id,u.tribeBadge=E}}}else if(!e.leaderId&&!n.leaderId&&a&&u){const m=vf();a.leaderId=a.id,a.tribeBadge=m,a.diplomacy={},u.leaderId=a.id,u.tribeBadge=m}e.activeAction=void 0,Oe(o,le.Procreation,l,Tr),Oe(o,le.Partnered,e.position,be,e.id),Oe(o,le.Partnered,n.position,be,n.id),e.lastPartneredEffectTime=o.time,n.lastPartneredEffectTime=o.time,n.activeAction=void 0,Ie(r,fe.Procreate,l)},$1={id:L1,sourceType:B1,targetType:H1,maxDistance:b1,checker:G1,perform:x1},z1={id:"humanChildFeeding",sourceType:"human",targetType:"human",maxDistance:Hf,checker:(e,n)=>e.isAdult===!0&&e.food.length>0&&(!e.feedChildCooldownTime||e.feedChildCooldownTime<=0)&&n.isAdult===!1&&(n.motherId===e.id||n.fatherId===e.id)&&n.hunger>=Qi&&e.activeAction==="feeding",perform:(e,n,r)=>{e.food.pop(),n.hunger=Math.max(0,n.hunger-Qi),e.feedChildCooldownTime=VI,(!n.lastChildFedEffectTime||r.gameState.time-n.lastChildFedEffectTime>2)&&(Oe(r.gameState,le.ChildFed,n.position,be,n.id),n.lastChildFedEffectTime=r.gameState.time),Ie(r,fe.ChildFed,n.position)}},W1={id:"human-attack",sourceType:"human",targetType:"human",maxDistance:Kn,checker:(e,n,r)=>{var a;if(((a=e.stateMachine)==null?void 0:a[0])!==Ji||e.attackTargetId!==n.id||(e.attackCooldown||0)>0)return!1;const o=e.stateMachine[1];return r.gameState.time-o.attackStartTime>=fv},perform:(e,n,r)=>{const o=ze(e.position,n.position,r.gameState.mapDimensions.width,r.gameState.mapDimensions.height),l=uw(nt(o),n.direction);if(Math.abs(l)<ow*Math.PI/180&&Math.random()<sw)Oe(r.gameState,le.AttackDeflected,n.position,be,n.id);else{let d=bf;e.gender==="male"&&(d*=nw),e.isAdult||(d*=iw),(!n.isAdult||n.age>=cv)&&e.isAdult&&(d*=rw),n.hitpoints-=d,n.movementSlowdown={modifier:Gf,endTime:r.gameState.time+xf},Oe(r.gameState,le.Hit,n.position,be,n.id);const g=ze(e.position,n.position,r.gameState.mapDimensions.width,r.gameState.mapDimensions.height),m=Pt(g,JI);n.forces.push(m),n.hitpoints<=0?Ie(r,fe.HumanDeath,n.position):Ie(r,fe.Attack,e.position)}e.attackCooldown=vu;const u=e.stateMachine[1];u.attackStartTime=r.gameState.time,Oe(r.gameState,le.Attack,e.position,be,e.id)}},Y1={id:"human-collision",sourceType:"human",targetType:"human",maxDistance:Et*2,checker:(e,n,{gameState:r})=>V(e.position,n.position,r.mapDimensions.width,r.mapDimensions.height)<(e.radius+n.radius)/3,perform:(e,n,{gameState:r})=>{const o=V(e.position,n.position,r.mapDimensions.width,r.mapDimensions.height);if(o===0){e.forces.push({x:.1,y:0}),n.forces.push({x:-.1,y:0});return}const a=(e.radius+n.radius-o)*.05,u=nt(hv(e.position,n.position)),d=Pt(u,a);e.forces.push(d),n.forces.push(Pt(d,-1))}},j1={id:"humanBerryBushGather",sourceType:"human",targetType:"berryBush",maxDistance:It,checker:(e,n,r)=>{var o;return e.isAdult&&n.food.length>0&&((o=e.stateMachine)==null?void 0:o[0])===la&&e.food.length<e.maxFood&&(!e.gatheringCooldownTime||e.gatheringCooldownTime<r.gameState.time)||!1},perform:(e,n,r)=>{const o=n.food.pop();o&&e.food.push(o),e.gatheringCooldownTime=r.gameState.time+1,n.timeSinceLastHarvest=r.gameState.time,n.ownerId=e.id,n.claimedUntil=r.gameState.time+ev,Oe(r.gameState,le.BushClaimed,n.position,be),Ie(r,fe.Gather,e.position)}},V1={id:"corpseGather",sourceType:"human",targetType:"corpse",maxDistance:It,checker:(e,n,r)=>{var o;return e.isAdult&&n.food.length>0&&((o=e.stateMachine)==null?void 0:o[0])===la&&e.food.length<e.maxFood&&(!e.gatheringCooldownTime||e.gatheringCooldownTime<r.gameState.time)||!1},perform:(e,n,r)=>{const o=n.food.pop();o&&e.food.push(o),e.gatheringCooldownTime=r.gameState.time+1,Ie(r,fe.Gather,e.position)}},X1=[j1,V1],K1={id:"prey-eat-berry-bush",sourceType:"prey",targetType:"berryBush",maxDistance:zt,checker:(e,n,r)=>!!(e.isAdult&&n.food.length>0&&e.hunger>30&&(!e.eatingCooldownTime||e.eatingCooldownTime<r.gameState.time)),perform:(e,n,r)=>{n.food.pop()&&(e.hunger=Math.max(0,e.hunger-25),n.lifespan-=xC,n.timeSinceLastHarvest=r.gameState.time,e.eatingCooldownTime=r.gameState.time+GC,Oe(r.gameState,le.BushClaimed,n.position,be,e.id),Ie(r,fe.Gather,e.position))}},q1={id:"predator-hunt-prey",sourceType:"predator",targetType:"prey",maxDistance:fo,checker:(e,n,r)=>!!(e.isAdult&&e.hunger>50&&(!e.huntCooldown||e.huntCooldown<=0)&&n.hitpoints>0),perform:(e,n,r)=>{n.hitpoints-=VC;const o=ze(e.position,n.position,r.gameState.mapDimensions.width,r.gameState.mapDimensions.height),l=Pt(o,8);n.forces.push(l),e.huntCooldown=qC,n.hitpoints<=0?(Ie(r,fe.HumanDeath,n.position),Oe(r.gameState,le.Hit,n.position,be,n.id)):(Oe(r.gameState,le.Hit,n.position,be,n.id),n.fleeCooldown=5,Ie(r,fe.Attack,e.position)),Oe(r.gameState,le.Attack,e.position,be,e.id)}},Z1={id:"human-hunt-prey",sourceType:"human",targetType:"prey",maxDistance:Kn,checker:(e,n,r)=>{var o;return!!(((o=e.stateMachine)==null?void 0:o[0])===Ji&&e.attackTargetId===n.id&&(!e.attackCooldown||e.attackCooldown<=0)&&n.hitpoints>0&&e.isAdult)},perform:(e,n,r)=>{let o=bf*1.2;e.gender==="male"&&(o*=1.3),n.hitpoints-=o;const l=ze(e.position,n.position,r.gameState.mapDimensions.width,r.gameState.mapDimensions.height),a=Pt(l,6);n.forces.push(a),e.attackCooldown=vu,n.hitpoints<=0?(Ie(r,fe.HumanDeath,n.position),Oe(r.gameState,le.Hit,n.position,be,n.id)):(Oe(r.gameState,le.Hit,n.position,be,n.id),n.fleeCooldown=8,Ie(r,fe.Attack,e.position)),Oe(r.gameState,le.Attack,e.position,be,e.id)}},Q1={id:"predator-attack-human",sourceType:"predator",targetType:"human",maxDistance:Nn,checker:(e,n,r)=>{var o;return!!(e.isAdult&&(!e.attackCooldown||e.attackCooldown<=0)&&n.hitpoints>0&&(e.hunger>100||n.attackTargetId===e.id||n.attackTargetId&&((o=r.gameState.entities.entities[n.attackTargetId])==null?void 0:o.type)==="predator"))},perform:(e,n,r)=>{let o=Kv;e.hunger>120&&(o*=1.3),n.hitpoints-=o,n.movementSlowdown={modifier:Gf,endTime:r.gameState.time+xf};const l=ze(e.position,n.position,r.gameState.mapDimensions.width,r.gameState.mapDimensions.height),a=Pt(l,7);n.forces.push(a),e.attackCooldown=qv,n.hitpoints<=0?(e.hunger=Math.max(0,e.hunger-nh),Ie(r,fe.HumanDeath,n.position),Oe(r.gameState,le.Hit,n.position,be,n.id)):(Oe(r.gameState,le.Hit,n.position,be,n.id),Ie(r,fe.Attack,e.position)),Oe(r.gameState,le.Attack,e.position,be,e.id)}},J1={id:"human-attack-predator",sourceType:"human",targetType:"predator",maxDistance:Kn,checker:(e,n,r)=>{var o;return!!(((o=e.stateMachine)==null?void 0:o[0])===Ji&&e.attackTargetId===n.id&&(!e.attackCooldown||e.attackCooldown<=0)&&n.hitpoints>0&&e.isAdult)},perform:(e,n,r)=>{let o=bf*.8;e.gender==="male"&&(o*=1.2);const l=Object.values(r.gameState.entities.entities).filter(d=>d.type==="human"&&d.id!==e.id).filter(d=>{const h=d;return Math.sqrt(Math.pow(h.position.x-e.position.x,2)+Math.pow(h.position.y-e.position.y,2))<100&&h.activeAction==="attacking"&&h.attackTargetId===n.id}).length;l>0&&(o*=1+l*.2),n.hitpoints-=o;const a=ze(e.position,n.position,r.gameState.mapDimensions.width,r.gameState.mapDimensions.height),u=Pt(a,8);n.forces.push(u),e.attackCooldown=vu,n.hitpoints<=0?(Ie(r,fe.HumanDeath,n.position),Oe(r.gameState,le.Hit,n.position,be,n.id)):(Oe(r.gameState,le.Hit,n.position,be,n.id),n.hitpoints<n.maxHitpoints*.3&&(n.hunger+=20),Ie(r,fe.Attack,e.position)),Oe(r.gameState,le.Attack,e.position,be,e.id)}},eR={id:"prey-procreation",sourceType:"prey",targetType:"prey",maxDistance:zt,checker:(e,n,r)=>!!(e.isAdult&&n.isAdult&&e.gender!==n.gender&&e.id!==n.id&&!e.isPregnant&&!n.isPregnant&&e.hunger<200&&n.hunger<200&&(!e.procreationCooldown||e.procreationCooldown<=0)&&(!n.procreationCooldown||n.procreationCooldown<=0)),perform:(e,n,r)=>{const o=e.gender==="female"?e:n;o.isPregnant=!0,o.gestationTime=r.gameState.ecosystem.preyGestationPeriod,e.procreationCooldown=r.gameState.ecosystem.preyProcreationCooldown,n.procreationCooldown=r.gameState.ecosystem.preyProcreationCooldown,Oe(r.gameState,le.Procreation,o.position,be,o.id),Ie(r,fe.Procreate,o.position)}},tR={id:"predator-procreation",sourceType:"predator",targetType:"predator",maxDistance:Ki,checker:(e,n,r)=>!!(e.isAdult&&n.isAdult&&e.gender!==n.gender&&e.id!==n.id&&!e.isPregnant&&!n.isPregnant&&e.hunger<200&&n.hunger<200&&(!e.procreationCooldown||e.procreationCooldown<=0)&&(!n.procreationCooldown||n.procreationCooldown<=0)),perform:(e,n,r)=>{const o=e.gender==="female"?e:n;o.isPregnant=!0,o.pregnancyFatherId=e.gender==="male"?e.id:n.id,o.gestationTime=r.gameState.ecosystem.predatorGestationPeriod,e.procreationCooldown=r.gameState.ecosystem.predatorProcreationCooldown,n.procreationCooldown=r.gameState.ecosystem.predatorProcreationCooldown,Oe(r.gameState,le.Procreation,o.position,be,o.id),Ie(r,fe.Procreate,o.position)}},nR={id:"preyChildFeeding",sourceType:"prey",targetType:"prey",maxDistance:Lo,checker:(e,n)=>e.isAdult===!0&&e.gender==="female"&&e.hunger<80&&(!e.feedChildCooldownTime||e.feedChildCooldownTime<=0)&&n.isAdult===!1&&(n.motherId===e.id||n.fatherId===e.id)&&n.hunger>=ru&&e.activeAction==="feeding",perform:(e,n,r)=>{e.hunger=Math.min(120,e.hunger+10),n.hunger=Math.max(0,n.hunger-ru),e.feedChildCooldownTime=Qv,(!n.lastChildFedEffectTime||r.gameState.time-n.lastChildFedEffectTime>2)&&(Oe(r.gameState,le.ChildFed,n.position,be,n.id),n.lastChildFedEffectTime=r.gameState.time),Ie(r,fe.ChildFed,n.position)}},iR={id:"predatorChildFeeding",sourceType:"predator",targetType:"predator",maxDistance:Lo,checker:(e,n)=>e.isAdult===!0&&e.gender==="female"&&e.hunger<90&&(!e.feedChildCooldownTime||e.feedChildCooldownTime<=0)&&n.isAdult===!1&&(n.motherId===e.id||n.fatherId===e.id)&&n.hunger>=ru&&e.activeAction==="feeding",perform:(e,n,r)=>{e.hunger=Math.min(140,e.hunger+15),n.hunger=Math.max(0,n.hunger-ru),e.feedChildCooldownTime=Qv,(!n.lastChildFedEffectTime||r.gameState.time-n.lastChildFedEffectTime>2)&&(Oe(r.gameState,le.ChildFed,n.position,be,n.id),n.lastChildFedEffectTime=r.gameState.time),Ie(r,fe.ChildFed,n.position)}},rR={id:"predator-eat-corpse",sourceType:"predator",targetType:"corpse",maxDistance:Ki,checker:(e,n,r)=>!!(e.isAdult&&e.hunger>30&&n.food.length>0&&(!e.eatingCooldownTime||e.eatingCooldownTime<=r.gameState.time)),perform:(e,n,r)=>{n.food.pop()&&(e.hunger=Math.max(0,e.hunger-nh),e.eatingCooldownTime=r.gameState.time+2,Oe(r.gameState,le.Eating,e.position,be,e.id),Ie(r,fe.Gather,e.position))}},oR={id:"predator-attack-rival",sourceType:"predator",targetType:"predator",maxDistance:Nn,checker:(e,n,r)=>{var o;return!!(e.isAdult&&(!e.attackCooldown||e.attackCooldown<=0)&&n.hitpoints>0&&(e.hunger>100||n.attackTargetId===e.id||n.attackTargetId&&((o=r.gameState.entities.entities[n.attackTargetId])==null?void 0:o.type)==="predator"))},perform:(e,n,r)=>{let o=Kv;e.hunger>120&&(o*=1.3),n.hitpoints-=o,n.movementSlowdown={modifier:Gf,endTime:r.gameState.time+xf};const l=ze(e.position,n.position,r.gameState.mapDimensions.width,r.gameState.mapDimensions.height),a=Pt(l,7);n.forces.push(a),e.attackCooldown=qv,n.hitpoints<=0?(e.hunger=Math.max(0,e.hunger-nh),Ie(r,fe.HumanDeath,n.position),Oe(r.gameState,le.Hit,n.position,be,n.id)):(Oe(r.gameState,le.Hit,n.position,be,n.id),Ie(r,fe.Attack,e.position)),Oe(r.gameState,le.Attack,e.position,be,e.id)}},sR={id:"storageDeposit",sourceType:"human",targetType:"building",maxDistance:Sn,checker:(e,n,r)=>{var a;if(n.buildingType!=="storageSpot"||((a=e.stateMachine)==null?void 0:a[0])!==xs||!n.isConstructed||e.food.length===0)return!1;n.storedFood||(n.storedFood=[]);const o=n.storageCapacity??0;return!(n.storedFood.length>=o||e.leaderId!==n.ownerId||r.gameState.time-(n.lastDepositTime??0)<fC)},perform:(e,n,r)=>{n.storedFood||(n.storedFood=[]);const o=e.food.pop();o&&n.storedFood.push(o),n.lastDepositTime=r.gameState.time,Ie(r,fe.StorageDeposit,n.position)}},aR={id:"storageRetrieve",sourceType:"human",targetType:"building",maxDistance:Sn,checker:(e,n,r)=>{var l;return!(n.buildingType!=="storageSpot"||((l=e.stateMachine)==null?void 0:l[0])!==$s||!n.isConstructed||!n.storedFood||n.storedFood.length===0||e.food.length>=e.maxFood||e.leaderId!==n.ownerId||r.gameState.time-(n.lastRetrieveTime??0)<hC)},perform:(e,n,r)=>{if(!n.storedFood||n.storedFood.length===0)return;const o=n.storedFood.pop();o&&e.food.push(o),n.lastRetrieveTime=r.gameState.time,Ie(r,fe.StorageRetrieve,n.position)}},lR={id:"storageSteal",sourceType:"human",targetType:"building",maxDistance:Sn,checker:(e,n,r)=>{var d;if(n.buildingType!=="storageSpot"||((d=e.stateMachine)==null?void 0:d[0])!==la||!n.isConstructed||!n.storedFood||n.storedFood.length===0||e.food.length>=e.maxFood||e.leaderId===n.ownerId)return!1;const o=e.leaderId?r.gameState.entities.entities[e.leaderId]:void 0;if(!o||!o.diplomacy||o.diplomacy[n.ownerId]!==St.Hostile||r.gameState.time-(n.lastStealTime??0)<gC)return!1;const u=gf({leaderId:n.ownerId},r.gameState);for(const h of u)if(V(e.position,h.position,r.gameState.mapDimensions.width,r.gameState.mapDimensions.height)<=Sf)return!1;return!0},perform:(e,n,r)=>{if(!n.storedFood||n.storedFood.length===0)return;const o=n.storedFood.pop();o&&e.food.push(o),n.lastStealTime=r.gameState.time,Ie(r,fe.StorageSteal,n.position),Oe(r.gameState,le.Attack,n.position,.5)}},uR=[Y1,...X1,$1,z1,W1,sR,aR,lR,K1,nR,iR,rR,q1,Z1,J1,Q1,oR,eR,tR];function cR(e){const{gameState:n}=e,r=n,o=Object.values(n.entities.entities);for(const l of uR)for(const a of o){if(l.sourceType&&a.type!==l.sourceType)continue;const u=r.search[l.targetType].byRadius(a.position,l.maxDistance);for(const d of u){if(a.id===d.id)continue;V(a.position,d.position,n.mapDimensions.width,n.mapDimensions.height)<=l.maxDistance&&l.checker(a,d,e)&&l.perform(a,d,e)}}}function dR(e){e.visualEffects=e.visualEffects.filter(n=>e.time-n.startTime<=n.duration)}function fR(e){const n=e.search.berryBush.byProperty("type","berryBush"),r=e.search.predator.byProperty("type","predator"),o=e.search.human.byProperty("type","human");for(let l=0;l<20;l++){let a;if(n.length>0&&l<15){const h=n[Math.floor(Math.random()*n.length)],g=Math.random()*2*Math.PI,m=50+Math.random()*100;a={x:Math.max(50,Math.min(et-50,h.position.x+Math.cos(g)*m)),y:Math.max(50,Math.min(tt-50,h.position.y+Math.sin(g)*m))}}else a={x:50+Math.random()*(et-100),y:50+Math.random()*(tt-100)};let u=!0;const d=100;for(const h of r)if(Math.sqrt((a.x-h.position.x)**2+(a.y-h.position.y)**2)<d){u=!1;break}if(u){for(const h of o)if(Math.sqrt((a.x-h.position.x)**2+(a.y-h.position.y)**2)<d){u=!1;break}}if(u)return a}return{x:et*.3+Math.random()*et*.4,y:tt*.3+Math.random()*tt*.4}}function hR(e){const n=e.search.prey.byProperty("type","prey"),r=e.search.human.byProperty("type","human");for(let l=0;l<15;l++){let a;if(n.length>0&&l<10){const h=n[Math.floor(Math.random()*n.length)],g=Math.random()*2*Math.PI,m=100+Math.random()*150;a={x:Math.max(50,Math.min(et-50,h.position.x+Math.cos(g)*m)),y:Math.max(50,Math.min(tt-50,h.position.y+Math.sin(g)*m))}}else a={x:50+Math.random()*(et-100),y:50+Math.random()*(tt-100)};let u=!0;const d=150;for(const h of r)if(Math.sqrt((a.x-h.position.x)**2+(a.y-h.position.y)**2)<d){u=!1;break}if(u)return a}switch(Math.floor(Math.random()*4)){case 0:return{x:Math.random()*et,y:50+Math.random()*100};case 1:return{x:et-150+Math.random()*100,y:Math.random()*tt};case 2:return{x:Math.random()*et,y:tt-150+Math.random()*100};default:return{x:50+Math.random()*100,y:Math.random()*tt}}}function gR(e){const n=e.search.human.byProperty("type","human"),r=e.search.berryBush.byProperty("type","berryBush");for(let o=0;o<20;o++){const l={x:50+Math.random()*(et-100),y:50+Math.random()*(tt-100)};let a=!0;const u=80,d=60;for(const h of n)if(Math.sqrt((l.x-h.position.x)**2+(l.y-h.position.y)**2)<u){a=!1;break}if(a){for(const h of r)if(Math.sqrt((l.x-h.position.x)**2+(l.y-h.position.y)**2)<d){a=!1;break}}if(a)return l}return{x:Math.random()*et,y:Math.random()*tt}}function ay(e,n=4){console.log(` Respawning ${n} prey to prevent extinction`);const r=e;for(let o=0;o<n;o++){const l=fR(r),a=o%2===0?"male":"female";Do(e.entities,l,a,void 0,void 0,na())}}function ly(e,n=2){console.log(` Respawning ${n} predators to prevent extinction`);const r=e;for(let o=0;o<n;o++){const l=hR(r),a=o%2===0?"male":"female";Oo(e.entities,l,a,void 0,void 0,ia())}}function pR(e){const n=e,r=n.search.prey.count(),o=n.search.predator.count();let l=!1;return r===0&&(ay(e,6),l=!0),o===0&&(ly(e,3),l=!0),l}function mR(e){const n=e,r=n.search.prey.count(),o=n.search.predator.count(),l=n.search.berryBush.count();let a=!1;if(r>0&&r<5){const u=Math.max(2,Math.floor(8-r));ay(e,u),a=!0}if(o>0&&o<2){const u=Math.max(1,Math.floor(3-o));ly(e,u),a=!0}if(l<5){console.log(` Boosting bush count from ${l} to help ecosystem`);for(let u=0;u<5;u++){const d=gR(n);ca(e.entities,d,e.time)}a=!0}return a}const vR=1,yR=.3,SR=.8,a0=.8,AR=.99,TR=.05;var uy=(e=>(e[e.INCREASE_PREY_GESTATION=0]="INCREASE_PREY_GESTATION",e[e.DECREASE_PREY_GESTATION=1]="DECREASE_PREY_GESTATION",e[e.INCREASE_PREY_PROCREATION_COOLDOWN=2]="INCREASE_PREY_PROCREATION_COOLDOWN",e[e.DECREASE_PREY_PROCREATION_COOLDOWN=3]="DECREASE_PREY_PROCREATION_COOLDOWN",e[e.INCREASE_PREY_HUNGER=4]="INCREASE_PREY_HUNGER",e[e.DECREASE_PREY_HUNGER=5]="DECREASE_PREY_HUNGER",e[e.INCREASE_PREDATOR_GESTATION=6]="INCREASE_PREDATOR_GESTATION",e[e.DECREASE_PREDATOR_GESTATION=7]="DECREASE_PREDATOR_GESTATION",e[e.INCREASE_PREDATOR_PROCREATION_COOLDOWN=8]="INCREASE_PREDATOR_PROCREATION_COOLDOWN",e[e.DECREASE_PREDATOR_PROCREATION_COOLDOWN=9]="DECREASE_PREDATOR_PROCREATION_COOLDOWN",e[e.INCREASE_PREDATOR_HUNGER=10]="INCREASE_PREDATOR_HUNGER",e[e.DECREASE_PREDATOR_HUNGER=11]="DECREASE_PREDATOR_HUNGER",e[e.INCREASE_BUSH_SPREAD=12]="INCREASE_BUSH_SPREAD",e[e.DECREASE_BUSH_SPREAD=13]="DECREASE_BUSH_SPREAD",e[e.NO_ACTION=14]="NO_ACTION",e))(uy||{});const zd=Object.keys(uy).length/2;class IR{constructor(){ke(this,"qTable",new Map);ke(this,"epsilon",a0);ke(this,"lastState",null);ke(this,"lastAction",null)}discretizeState(n,r,o){const l=Math.min(4,Math.floor(n/25)),a=Math.min(4,Math.floor(r/5)),u=Math.min(4,Math.floor(o/15));return`${l}-${a}-${u}`}getQValue(n,r){return this.qTable.has(n)||this.qTable.set(n,new Map),this.qTable.get(n).get(r)||0}setQValue(n,r,o){this.qTable.has(n)||this.qTable.set(n,new Map),this.qTable.get(n).set(r,o)}getBestAction(n){let r=0,o=this.getQValue(n,0);for(let l=1;l<zd;l++){const a=this.getQValue(n,l);a>o&&(o=a,r=l)}return r}chooseAction(n){return Math.random()<this.epsilon?Math.floor(Math.random()*zd):this.getBestAction(n)}applyEmergencyCorrections(n,r,o,l){n<di*.5&&(l.ecosystem.preyGestationPeriod=Math.max(po,l.ecosystem.preyGestationPeriod*.8),l.ecosystem.preyProcreationCooldown=Math.max(mo,l.ecosystem.preyProcreationCooldown*.8),l.ecosystem.preyHungerIncreasePerHour=Math.max(So,l.ecosystem.preyHungerIncreasePerHour*.9)),r<fi*.6&&(l.ecosystem.predatorGestationPeriod=Math.max(vo,l.ecosystem.predatorGestationPeriod*.75),l.ecosystem.predatorProcreationCooldown=Math.max(yo,l.ecosystem.predatorProcreationCooldown*.75),l.ecosystem.predatorHungerIncreasePerHour=Math.max(Ao,l.ecosystem.predatorHungerIncreasePerHour*.85)),o<hi*.5&&(l.ecosystem.berryBushSpreadChance=Math.min(Ms,l.ecosystem.berryBushSpreadChance*1.2)),n>di*1.4&&(l.ecosystem.preyHungerIncreasePerHour=Math.min(Yi,l.ecosystem.preyHungerIncreasePerHour*1.05)),r>fi*1.4&&(l.ecosystem.predatorHungerIncreasePerHour=Math.min(ji,l.ecosystem.predatorHungerIncreasePerHour*1.05)),o>hi*1.4&&(l.ecosystem.berryBushSpreadChance=Math.max(gi,l.ecosystem.berryBushSpreadChance*.95))}calculateReward(n,r,o){const l=Math.abs(n-di),a=Math.abs(r-fi),u=Math.abs(o-hi),d=l/di,h=a/fi,g=u/hi,m=d+h+g;return 100*Math.exp(-m*2)-50}applyAction(n,r){switch(n){case 0:r.ecosystem.preyGestationPeriod=Math.min(wr,r.ecosystem.preyGestationPeriod+.2*(wr-po));break;case 1:r.ecosystem.preyGestationPeriod=Math.max(po,r.ecosystem.preyGestationPeriod-.2*(wr-po));break;case 2:r.ecosystem.preyProcreationCooldown=Math.min(Er,r.ecosystem.preyProcreationCooldown+.2*(Er-mo));break;case 3:r.ecosystem.preyProcreationCooldown=Math.max(mo,r.ecosystem.preyProcreationCooldown-.2*(Er-mo));break;case 4:r.ecosystem.preyHungerIncreasePerHour=Math.min(Yi,r.ecosystem.preyHungerIncreasePerHour+.2*(Yi-So));break;case 5:r.ecosystem.preyHungerIncreasePerHour=Math.max(So,r.ecosystem.preyHungerIncreasePerHour-.2*(Yi-So));break;case 6:r.ecosystem.predatorGestationPeriod=Math.min(Cr,r.ecosystem.predatorGestationPeriod+.2*(Cr-vo));break;case 7:r.ecosystem.predatorGestationPeriod=Math.max(vo,r.ecosystem.predatorGestationPeriod-.2*(Cr-vo));break;case 8:r.ecosystem.predatorProcreationCooldown=Math.min(_r,r.ecosystem.predatorProcreationCooldown+.2*(_r-yo));break;case 9:r.ecosystem.predatorProcreationCooldown=Math.max(yo,r.ecosystem.predatorProcreationCooldown-.2*(_r-yo));break;case 10:r.ecosystem.predatorHungerIncreasePerHour=Math.min(ji,r.ecosystem.predatorHungerIncreasePerHour+.2*(ji-Ao));break;case 11:r.ecosystem.predatorHungerIncreasePerHour=Math.max(Ao,r.ecosystem.predatorHungerIncreasePerHour-.2*(ji-Ao));break;case 12:r.ecosystem.berryBushSpreadChance=Math.min(Ms,r.ecosystem.berryBushSpreadChance+.2*(Ms-gi));break;case 13:r.ecosystem.berryBushSpreadChance=Math.max(gi,r.ecosystem.berryBushSpreadChance-.2*(Ms-gi));break}}updateQTable(n,r,o,l){const a=this.getQValue(n,r),u=Math.max(...Array.from({length:zd},(h,g)=>this.getQValue(l,g))),d=a+yR*(o+SR*u-a);this.setQValue(n,r,d)}step(n){const r=n,o=r.search.prey.count(),l=r.search.predator.count(),a=r.search.berryBush.count();this.applyEmergencyCorrections(o,l,a,n);const u=this.discretizeState(o,l,a);if(this.lastState!==null&&this.lastAction!==null){const h=this.calculateReward(o,l,a);this.updateQTable(this.lastState,this.lastAction,h,u)}const d=this.chooseAction(u);this.applyAction(d,n),this.epsilon=Math.max(TR,this.epsilon*AR),this.lastState=u,this.lastAction=d}reset(){this.qTable.clear(),this.epsilon=a0,this.lastState=null,this.lastAction=null}getStats(){return{qTableSize:this.qTable.size,explorationRate:this.epsilon}}}let cy=new IR;function wR(e){pR(e),mR(e),e.ecosystem.lastUpdateTime||(e.ecosystem.preyGestationPeriod=po+(wr-po)*.3,e.ecosystem.preyProcreationCooldown=mo+(Er-mo)*.3,e.ecosystem.preyHungerIncreasePerHour=So+(Yi-So)*.3,e.ecosystem.predatorGestationPeriod=vo+(Cr-vo)*.3,e.ecosystem.predatorProcreationCooldown=yo+(_r-yo)*.3,e.ecosystem.predatorHungerIncreasePerHour=Ao+(ji-Ao)*.3,e.ecosystem.berryBushSpreadChance=gi+(Ms-gi)*.7),cy.step(e)}function ER(e){e.ecosystem.lastUpdateTime||(e.ecosystem.lastUpdateTime=0),!(e.time-e.ecosystem.lastUpdateTime<vR)&&(e.ecosystem.lastUpdateTime=e.time,wR(e))}function CR(){return cy.getStats()}function _R(e,n){e.selectedBuildingType&&e.selectedBuildingType!=="removal"&&(e.autopilotControls.activeAutopilotAction=void 0,e.autopilotControls.hoveredAutopilotAction=void 0)}const RR=1/60;function PR(e,n){const r=wt(e);r&&(e.viewportCenter=$f(e.viewportCenter,r.position,Uf*n))}function Tu(e,n){if(e.isPaused)return e;if(e.autosaveIntervalSeconds){const r=Date.now();r-e.lastAutosaveTime>e.autosaveIntervalSeconds*1e3&&(Rf(e),e.lastAutosaveTime=r)}for(;n>0;){const r=uu(e),o=Math.min(n,RR),l=o*(At/Tt);r.time+=l,PR(r,o),ZE(r),ER(r),QE(r),w1({gameState:r,deltaTime:o}),cR({gameState:r,deltaTime:o}),dR(r),O1(r,o),_R(r),e=r,n-=o}return e}function Wd(e,n,r){e.save();const{x:o,y:l,width:a,height:u}=n.rect,d=Rv;if(e.beginPath(),e.moveTo(o+d,l),e.lineTo(o+a-d,l),e.quadraticCurveTo(o+a,l,o+a,l+d),e.lineTo(o+a,l+u-d),e.quadraticCurveTo(o+a,l+u,o+a-d,l+u),e.lineTo(o+d,l+u),e.quadraticCurveTo(o,l+u,o,l+u-d),e.lineTo(o,l+d),e.quadraticCurveTo(o,l,o+d,l),e.closePath(),e.fillStyle=n.isDisabled?Pv:n.backgroundColor,e.fill(),n.activated){e.save();const h=(Math.sin(Date.now()/1e3*kv)+1)/2;e.strokeStyle=Ov,e.lineWidth=2+h*2,e.globalAlpha=.7+h*.3,e.stroke(),e.restore()}if(n.lastActivated){const h=Date.now()-n.lastActivated;if(h<iu){const g=1-h/iu;e.fillStyle=Dv,e.globalAlpha=g,e.fill(),e.globalAlpha=1}}r&&!n.isDisabled&&(e.fillStyle=Kf,e.globalAlpha=.5,e.fill(),e.globalAlpha=1),e.fillStyle=n.isDisabled?Nv:n.textColor,n.icon?(e.font=`${u*.55}px "Press Start 2P", Arial`,e.textAlign="center",e.textBaseline="middle",e.fillText(n.icon,o+a/2,l+u/2),n.text&&(e.font=`${u*.18}px "Press Start 2P", Arial`,e.textAlign="right",e.textBaseline="bottom",e.fillText(n.text,o+a-4,l+u-2))):(e.textAlign="center",e.textBaseline="middle",e.fillText(n.text,o+a/2,l+u/2)),e.restore()}function NR(e,n,r,o){e.save(),e.font=`${Hm}px "Press Start 2P", Arial`,e.textAlign="center",e.textBaseline="bottom";const a=e.measureText(r).width,u=Hm,d=a+bm*2,h=u+bm*2,g=o.x-d/2,m=e.canvas.height,y=n.y<m/2?n.y+n.height-Gm:n.y-h+Gm;e.fillStyle=rE,e.fillRect(g,y,d,h),e.fillStyle=oE,e.fillText(r,o.x,y+h/2+u/2),e.restore()}function DR(e,n,r){e.save();const o=wt(n),l=[{id:"fastForwardButton",action:ge.FastForward,text:"FFWD [T]",currentWidth:ci*1.3,backgroundColor:$i,textColor:vn,tooltip:"Fast-forward time",rect:{x:0,y:0,width:0,height:0}},{id:"pauseButton",action:ge.TogglePause,text:n.isPaused?"UN[P]AUSE":"[P]AUSE",backgroundColor:n.isPaused?Cl:$i,currentWidth:n.isPaused?ci*1.4:ci*1.1,tooltip:n.isPaused?"Resume Game":"Pause Game",rect:{x:0,y:0,width:0,height:0},textColor:vn},{id:"muteButton",action:ge.ToggleMute,text:n.isMuted?"UN[M]UTE":"[M]UTE",backgroundColor:n.isMuted?Cl:$i,tooltip:`Toggle Sound (${n.isMuted?"Muted":"Enabled"})`,currentWidth:ci,rect:{x:0,y:0,width:0,height:0},textColor:vn},{id:"returnToIntroButton",action:ge.ReturnToIntro,text:"EXIT",backgroundColor:$i,tooltip:"Return to Main Menu [ESC]",currentWidth:ci*.9,rect:{x:0,y:0,width:0,height:0},textColor:vn}];if(n.uiButtons.push(...l),o){const g=th(n,o),m=new Set(g.map(B=>B.type));let y=[{playerAction:ce.Gather,buttonAction:ge.CommandGather,shortcut:"E",name:"Gather",toggleKey:"gathering",condition:()=>o.isAdult===!0},{playerAction:ce.Eat,buttonAction:ge.CommandEat,shortcut:"F",name:"Eat"},{playerAction:ce.Plant,buttonAction:ge.CommandPlant,shortcut:"B",name:"Plant",toggleKey:"planting",condition:()=>o.isAdult===!0},{playerAction:ce.Procreate,buttonAction:ge.ToggleProcreationBehavior,shortcut:"R",name:"Procreation",toggleKey:"procreation",condition:()=>o.isAdult===!0},{playerAction:ce.FeedChild,buttonAction:ge.ToggleFeedChildBehavior,shortcut:"H",name:"Feed Child",toggleKey:"feedChildren",condition:()=>o.isAdult===!0},{playerAction:ce.Attack,buttonAction:ge.ToggleAttackBehavior,shortcut:"Q",name:"Attack",toggleKey:"attack",condition:()=>o.isAdult===!0&&o.leaderId===o.id},{playerAction:ce.FollowMe,buttonAction:ge.CommandFollowMe,shortcut:"C",name:"Follow Me",toggleKey:"followLeader",condition:()=>o.isAdult===!0&&o.leaderId===o.id},{playerAction:ce.CallToAttack,buttonAction:ge.CommandCallToAttack,shortcut:"V",name:"Call to Attack",condition:()=>o.isAdult===!0&&o.leaderId===o.id},{playerAction:ce.TribeSplit,buttonAction:ge.CommandTribeSplit,shortcut:"K",name:"Split Tribe",condition:()=>o.leaderId!==void 0&&o.leaderId!==o.id&&o.isAdult===!0},{playerAction:ce.Build,buttonAction:ge.CommandBuild,shortcut:"L",name:"Build",condition:()=>o.isAdult===!0&&o.leaderId===o.id}];y=y.filter(B=>B.condition?B.condition():!0);const S=1,E=y.length,w=E*rn+(E-1)*pr,T=S*rn+(S-1)*pr,C=(r-w)/2,F=e.canvas.height-T-20;if(y.forEach((B,D)=>{const H=D%E,x=Math.floor(D/E),U=C+H*(rn+pr),$=F+x*(rn+pr),J=!!B.toggleKey,Ce=J&&n.autopilotControls.behaviors[B.toggleKey],_e=!m.has(B.playerAction),Ne=B.playerAction===ce.Build&&n.buildMenuOpen,Pe=!n.hasPlayerEnabledAutopilot||n.hasPlayerEnabledAutopilot<3?" (Press Shift to toggle Auto)":"",de=J?`${B.name}${Pe}`:B.name,Ue=Ce||Ne?Cl:$i,Ae={id:`commandButton_${B.name}`,action:B.buttonAction,rect:{x:U,y:$,width:rn,height:rn},icon:Su[B.playerAction],text:B.shortcut,backgroundColor:Ue,textColor:vn,currentWidth:rn,tooltip:de,isDisabled:_e,activated:Ce||Ne};n.uiButtons.push(Ae)}),n.buildMenuOpen){const B=[{id:"buildMenu_storageSpot",action:ge.SelectStorageSpot,icon:"",shortcut:"1",name:"Storage Spot"},{id:"buildMenu_plantingZone",action:ge.SelectPlantingZone,icon:"",shortcut:"2",name:"Planting Zone"},{id:"buildMenu_removal",action:ge.SelectRemovalTool,icon:"",shortcut:"3",name:"Remove Building"}],D=B.length,H=D*rn+(D-1)*pr,x=(r-H)/2,U=F-rn-pr;B.forEach(($,J)=>{const Ce=x+J*(rn+pr),_e=U,Ge=$.action===ge.SelectStorageSpot&&n.selectedBuildingType==="storageSpot"||$.action===ge.SelectPlantingZone&&n.selectedBuildingType==="plantingZone"||$.action===ge.SelectRemovalTool&&n.selectedBuildingType==="removal",Ne={id:$.id,action:$.action,rect:{x:Ce,y:_e,width:rn,height:rn},icon:$.icon,text:$.shortcut,backgroundColor:Ge?Cl:$i,textColor:vn,currentWidth:rn,tooltip:$.name,activated:Ge};n.uiButtons.push(Ne),Wd(e,Ne,n.hoveredButtonId===Ne.id)})}}let a=r-qe;l.forEach(g=>{const m=qe,y=a-g.currentWidth;g.rect={x:y,y:m,width:g.currentWidth,height:_v},Wd(e,g,n.hoveredButtonId===g.id),a-=g.currentWidth+iE});let u=null;n.uiButtons.filter(g=>g.id.startsWith("commandButton_")||g.id.startsWith("buildMenu_")).forEach(g=>{u||(u={x:g.rect.x,y:g.rect.y,width:g.rect.width,height:g.rect.height}),u.x=Math.min(u.x,g.rect.x),u.y=Math.min(u.y,g.rect.y),u.width=Math.max(u.width,g.rect.x+g.rect.width-u.x),u.height=Math.max(u.height,g.rect.y+g.rect.height-u.y),g.id.startsWith("commandButton_")&&Wd(e,g,n.hoveredButtonId===g.id)});const h=n.hoveredButtonId?n.uiButtons.find(g=>g.id===n.hoveredButtonId):void 0;return h&&h.tooltip&&n.mousePosition&&NR(e,h.rect,h.tooltip,n.mousePosition),e.restore(),{commandButtonsRect:u}}function OR(e){e.save(),e.fillStyle=mE,e.fillRect(0,0,e.canvas.width,e.canvas.height),e.fillStyle=vE,e.font=`${yE}px "Press Start 2P", Arial`,e.textAlign="center",e.textBaseline="middle",e.fillText("PAUSED",e.canvas.width/2,e.canvas.height/2),e.restore()}function If(e,n,r,o){const l=n.x-r.width/2,a=n.y-r.height/2,u=l+e.x,d=a+e.y,h=(u%o.width+o.width)%o.width,g=(d%o.height+o.height)%o.height;return{x:h,y:g}}function Iu(e,n,r,o){let l=e.x-n.x,a=e.y-n.y;return Math.abs(l)>o.width/2&&(l=l-Math.sign(l)*o.width),Math.abs(a)>o.height/2&&(a=a-Math.sign(a)*o.height),{x:l+r.width/2,y:a+r.height/2}}function Bl(e,n,r,o){const l=Iu(e.position,n,r,o),u=("radius"in e?e.radius:20)+20;return l.x>=-u&&l.x<=r.width+u&&l.y>=-u&&l.y<=r.height+u}function sn(e,n,r,o,l,...a){const u={...l.position};for(let d=-r;d<=r;d+=r)for(let h=-n;h<=n;h+=n)l.position.x=u.x+h,l.position.y=u.y+d,o(e,l,...a);l.position=u}const kR=25,MR=0,l0=28;function dy(e,n,r,o,l,a,u,d,h,g){e.save();const{x:m,y}=Iu(n,u,{width:d,height:h},g);e.strokeStyle=o,e.lineWidth=a,e.setLineDash(l),e.beginPath(),e.arc(m,y,r+yu,0,2*Math.PI),e.stroke(),e.restore()}function FR(e,n,r,o,l,a,u){if(n=n.filter(y=>y.type!==ce.FollowMe),n.length===0)return;e.save(),n.forEach(y=>{y.targetEntity&&dy(e,y.targetEntity.position,y.targetEntity.radius,Vf,Xf,2,o,l,a,u)}),e.font=`${Po}px "Press Start 2P", Arial`,e.fillStyle="white",e.textAlign="center",e.textBaseline="bottom",e.shadowColor="black",e.shadowBlur=5;const{x:d,y:h}=Iu(r.position,o,{width:l,height:a},u);let g=0,m={};n.forEach(y=>{const S=Su[y.type];if(y.targetEntity){m[y.targetEntity.id]=(m[y.targetEntity.id]||0)+1;const E=y.targetEntity.position.x-o.x+l/2,w=y.targetEntity.position.y-o.y+a/2,T=`${S}${y.key.toUpperCase()}`,C=w-y.targetEntity.radius-yu-Po/2-(m[y.targetEntity.id]-1)*l0;e.fillText(T,E,C)}else{e.textAlign="left";const E=`${S}${y.key.toUpperCase()}`,w=d+kR,C=h+MR+g*l0;e.fillText(E,w,C),g++,e.textAlign="center"}}),e.restore()}const Se=(e,n,r,o,l,a,u)=>{a==="transparent"||o<=0||l<=0||(e.fillStyle=a,e.fillRect(Math.floor(n*u),Math.floor(r*u),Math.ceil(o*u),Math.ceil(l*u)))},u0=10,c0=10,jn=6,ai=4,Hl=2,UR=5,pn=4,LR=2,Ft=4,BR=2,Je=3,lo=2,xi=0,Ys=xi+ai-1,bt=Ys,lt=Ys+pn-1,HR="rgba(0, 0, 0, 0.4)",bR=4,GR=1,sh={name:"tribe-human-2d",referenceImage:"swos.png",description:`A 2D human character asset for the Tribe game. This includes ensuring that the unique animations for stances like 'eat' and 'procreate' do not erroneously appear in other stances, such as 'walk', which was observed in the provided rendered media. The 'idle' animation was updated to a leg sway to better match the provided video for that stance, replacing a simpler body bob.

# Visual style

Human characters in the Tribe game are inspired by classic 2D pixel art, they look like Sensible Soccer players(Sensible Soccer game visual style is IMPORTANT), with a simple and recognizable design. The characters are designed to be easily distinguishable and animated in a way that conveys their actions clearly.

Character in Tribe game look like people from stone age, they have simple clothing, no shoes, and no modern accessories. The characters are designed to be easily distinguishable and animated in a way that conveys their actions clearly.

# Technical details

The asset is rendered on a canvas using the CanvasRenderingContext2D API. The rendering function takes parameters for position, size, progress, stance, direction, gender, and age. The character can face left or right, and the rendering adapts based on the stance (e.g., idle, walk, eat, procreate).
The rendering function must be simple and efficient, it should not use complex patterns or gradients, and should focus on solid colors and basic shapes to maintain the pixel art aesthetic.

15% padding from all edges of the rendering box is required to ensure the character is not cut off during rendering.

Subtle shadow should be drawn under the character to give it a sense of depth.

# Rendering parameters

- age: The age of the character, which affects the size and proportions of the body parts. Age is a number between 1 and 60, with 20 being the average age.
- gender: 
  - The male characters should have only pants, while female cover their breasts with a top. The clothing should be simple and muted, reflecting a stone-age style.
  - Female characters should have long hair, while male should have short hair and beard.
  - Male characters should have a more robust, muscular build
  - Female characters should have thinner arms and legs, with a more pronounced waist and hips.
- isPregnant: (applicable only for females) Indicates if the character is pregnant, like very large belly. Pregnant characters should have a larger torso.
- direction: A vector indicating the character's facing direction. There should be at least 8 directions (like in Sensible Soccer): top left, top, top right, left, right, bottom left, bottom, bottom right. The character should be flipped horizontally if the direction vector's X component is negative.
             When moving up(top, top left, top right), the character back of the head should be visible, when moving down(Y > 0), the character face should be visible.
- hungryLevel: A number between 0 and 100 indicating how hungry the character is, hunger level 100 means the character is starving, 0 means the character is not hungry at all. So hungry characters should be thinner, with less body fat, and more pronounced muscles. The character's hunger level affects the size and proportions of the body parts, with hungrier characters being smaller and more gaunt.

# Rendering details

- All parts of the body must be connected
- Rendering must take into account direction vector (X and Y) to flip the character horizontally if needed
- The character's age affects the size and proportions of the body parts, with older characters being larger and more robust. Hair color should become gray for older characters.

# Stances

- 'idle': The character stands still, with a slight leg sway to indicate life.
- 'walk': The character moves forward, with legs and arms in motion.
- 'gathering': The character is gathering food from berry bushes, with arms reaching out and a slight bend at the knees.
- 'eat': The character holds food and brings it to their mouth, with a slight bend at the knees.
- 'procreate': The character performs a mating animation, with a specific pose and movement. There should be some additional visual effects to indicate this action, such as a slight glow or aura around the characters, or dust particles to indicate movement.
- 'attacking': The character performs an attack animation, with arms raised and a forward motion.
- 'defending': The character takes a defensive stance, with arms raised and a slight bend at the knees.
- 'stunned': The character is stunned and laying on the ground, with limbs relaxed and a neutral expression.
- 'dead': The character lies on the ground, with limbs relaxed and a neutral expression, slowly turns into a skeleton over time.

`,stances:["idle","walk","gathering","eat","procreate","dead","attacking","defending","stunned"],render(e,n,r,o,l,a,u,d="male",h=20,g=[1,0],m=!1,y=0){const S=["dead","stunned"].includes(u),E=S?c0+4:u0,w=S?u0+4:c0+Je,T=.15,C=Math.min(o*(1-2*T)/E,l*(1-2*T)/w),F=E*C,B=w*C,D=n+(o-F)/2,H=r+(l-B)/2;e.save(),g[0]<0&&!S?(e.translate(D+F,H),e.scale(-1,1)):e.translate(D,H);const U="#D09A5A",$=h>50?"#BDBDBD":"#281808",J="#7F5C4A",Ce="#6B4F3A",_e="#E0D8C0",Ge="#A0522D",Ne=1-Math.max(0,Math.min(100,y))/100*.2,Pe=d==="male"?1.1:.9,de=.8+(Math.max(1,Math.min(h,60))-1)/59*.2;let Ue=UR*Ne*Pe*de,Ae=LR*Ne*Pe*de,ne=BR*Ne*de;m&&d==="female"&&(Ue*=1.5);const W=Math.round((E-Ue)/2),X=Math.round((E-jn)/2),Y=W-Ae,R=W+Ue,L=1,K=W+(Ue/2-L/2)-ne,ie=W+(Ue/2+L/2),ye=g[1]<-.2&&Math.abs(g[0])<.7,se=q=>{e.fillStyle=HR,e.beginPath();const re=E/2,Le=q;e.ellipse(Math.floor(re*C),Math.floor(Le*C),Math.max(1,Math.floor(bR*C)),Math.max(1,Math.floor(GR*C)),0,0,2*Math.PI),e.fill()},we=(q,re)=>{d==="male"?(Se(e,W,Ys+q,Ue,pn-lo,re,C),Se(e,W,Ys+pn-lo+q,Ue,lo,J,C)):Se(e,W,Ys+q,Ue,pn,Ce,C)},Te=(q,re)=>{ye?Se(e,X,xi+q,jn,ai,$,C):(Se(e,X,xi+q,jn,ai,re,C),Se(e,X,xi+q,jn,Hl,$,C),d==="female"?(Se(e,X-1,xi+Hl+q,1,ai,$,C),Se(e,X+jn,xi+Hl+q,1,ai,$,C)):Se(e,X+1,xi+2+q,jn-2,ai-2,$,C))};switch(u){case"idle":{const q=a*Math.PI*2,re=Math.sin(q)*.5,he=(Math.cos(q*2)+1)*.25;se(lt+Je+1),Se(e,K+re,lt+he,ne,Je,U,C),Se(e,ie-re,lt+he,ne,Je,U,C),we(he,U),Se(e,Y,bt+he,Ae,Ft,U,C),Se(e,R,bt+he,Ae,Ft,U,C),Te(he,U);break}case"walk":{const q=a*Math.PI*2,re=Math.sin(q)*2,he=Math.abs(Math.cos(q))*1;se(lt+Je+1),Se(e,K+re,lt+he,ne,Je,U,C),Se(e,ie-re,lt+he,ne,Je,U,C),we(he,U),Se(e,Y-re,bt+he,Ae,Ft,U,C),Se(e,R+re,bt+he,Ae,Ft,U,C),Te(he,U);break}case"gathering":{const q=a*Math.PI*2,re=1,Le=(Math.sin(q)+1)/2*2,he=re+Math.abs(Math.cos(q))*.5;se(lt+Je+1),Se(e,K,lt+he,ne,Je-re,U,C),Se(e,ie,lt+he,ne,Je-re,U,C),we(he,U),Se(e,Y+1,bt+he-Le,Ae,Ft,U,C),Se(e,R-1,bt+he-Le,Ae,Ft,U,C),Te(he,U);break}case"eat":{se(lt+Je+1),Se(e,K,lt+1,ne,Je-1,U,C),Se(e,ie,lt+1,ne,Je-1,U,C),we(1,U);const Le=(Math.sin(a*Math.PI*4)+1)/2,he=X+jn/2,Fn=xi+ai/2,Ze=R+(he-R)*Le,je=bt+1+(Fn-(bt+1))*Le;Se(e,Y,bt+1,Ae,Ft,U,C),Se(e,Ze,je,Ae,Ft,U,C),Se(e,Ze,je-1,1,1,Ge,C),Te(1,U);break}case"procreate":{const q=(Math.sin(a*Math.PI*8)+1)/4,re=(Math.sin(a*Math.PI*6)+1)*.5,Le=1.5,he=Le-re;se(lt+Je+1),Se(e,K,lt+he,ne,Je-Le,U,C),Se(e,ie,lt+he,ne,Je-Le,U,C),we(he,U),Se(e,Y,bt+he,Ae,Ft,U,C),Se(e,R,bt+he,Ae,Ft,U,C),Te(he,U),e.globalAlpha=q,we(he,"white"),e.globalAlpha=1;break}case"attacking":{const q=Math.sin(a*Math.PI)*1.5,re=Math.abs(Math.sin(a*Math.PI));se(lt+Je+1),Se(e,K-q,lt+re,ne,Je,U,C),Se(e,ie+q*.5,lt+re,ne,Je,U,C),we(re,U),Se(e,Y,bt+re-2,Ae,Ft,U,C),Se(e,R,bt+re-2.5,Ae,Ft,U,C),Te(re,U);break}case"defending":{se(lt+Je+1),Se(e,K,lt+1,ne,Je-1,U,C),Se(e,ie,lt+1,ne,Je-1,U,C),we(1,U),Se(e,Y-1,bt+1-1,Ae,Ft,U,C),Se(e,R+1,bt+1-1,Ae,Ft,U,C),Te(1,U);break}case"stunned":case"dead":{const q=u==="dead",re=q?Math.min(1,a):0,Le=re>.5?_e:U,he=d==="male"?J:Ce,Fn=re>.8?"transparent":$,Ze=E/2,je=w/2,Un=2;se(w-1),Se(e,Ze-ne-Un,je,ne,Je,Le,C),Se(e,Ze+Un,je,ne,Je,Le,C),Se(e,Ze-Ae-Un,je-pn+1,Ae,Ft,Le,C),Se(e,Ze+Un,je-pn+1,Ae,Ft,Le,C);const Wt=Ze-Ue/2,an=je-pn/2;d==="male"?(re<.7&&Se(e,Wt,an+pn-lo,Ue,lo,he,C),Se(e,Wt,an,Ue,pn-lo,Le,C)):re<.7?Se(e,Wt,an,Ue,pn,he,C):Se(e,Wt,an,Ue,pn,Le,C);const Ln=Ze-jn/2,Bn=je-pn/2-ai+1;if(Se(e,Ln,Bn,jn,ai,Le,C),Fn!=="transparent"&&Se(e,Ln,Bn,jn,Hl,Fn,C),q&&re>.6){const mi="#B0A890";for(let er=0;er<3;er++)Se(e,Wt+1,an+er*1+1,Ue-2,.5,mi,C)}break}default:Se(e,0,0,E,w,"magenta",C);break}e.restore()}};function xR(e,n,r,o,l){const a=n.x,u=n.y-r-o/2;e.save(),e.fillStyle=l,e.strokeStyle=l,e.lineWidth=1.5,e.beginPath(),e.rect(a-o/2,u,o,o/2),e.fill(),e.beginPath(),e.moveTo(a-o/2,u),e.lineTo(a-o/4,u-o/3),e.lineTo(a-o/6,u),e.moveTo(a-o/6,u),e.lineTo(a,u-o/2),e.lineTo(a+o/6,u),e.moveTo(a+o/6,u),e.lineTo(a+o/4,u-o/3),e.lineTo(a+o/2,u),e.stroke(),e.restore()}function oa(e,n,r,o,l,a=!1,u=!1,d=!1,h=!1){o<Lf&&(r=r*.75),sh.render(e,n.x-r/2,n.y-r/2,r,r,0,"idle",l,o,[0,0],!1,0);let g,m;a?(g=Xw,m=jf):u?(g=Kw,m=Ev):d?(g=qw,m=wv):h&&(g=Zw,m=Iv),g&&m&&xR(e,n,r/2,g,m)}function $R(e,n,r,o,l,a){if(e.save(),o.length===0){e.restore();return}const u=o.length*l,d=4;let h;const g=u+(o.length-1)*d;o.length>1&&g>a?h=(a-u)/(o.length-1):h=d,o.length<=1&&(h=0);for(let m=0;m<o.length;m++){const{member:y,isPlayer:S,isHeir:E,isPartner:w,isParent:T}=o[m],C=n+m*(l+h)+l/2,F=r+l/4;oa(e,{x:C,y:F},l,y.age,y.gender,S,E,w,T)}e.restore()}function zR(e,n,r,o,l){if(r.length===0)return;e.save();const a=zn,u=" 00",d=" 00";e.font=`${wd}px "Press Start 2P", Arial`;const h=e.measureText(u).width,g=e.measureText(d).width,m=zn+gn+zn+gn+zn+Bi+h+zn/2+Bi+g,y=r.length*El+(r.length-1)*Lm,S=l-y-zn;e.fillStyle=Jw,e.fillRect(a,S,m,y);for(let E=0;E<r.length;E++){const w=r[E],T=S+E*(El+Lm),C=T+El/2;w.isPlayerTribe&&(e.fillStyle=Qw,e.fillRect(a,T,m,El));let F=a+zn;if(e.font=`${gn}px "Press Start 2P", Arial`,e.textBaseline="middle",e.textAlign="left",e.fillText(w.tribeBadge,F,C-gn/4),F+=gn+zn,!w.isPlayerTribe){const B=w.diplomacyStatus===St.Friendly?"":"",D=`diplomacyButton_${w.leaderId}`,H={x:F-2,y:C-gn/2-2,width:gn+4,height:gn+4},x={id:D,action:ge.ToggleDiplomacy,rect:H,text:"",icon:B,backgroundColor:"transparent",textColor:"white",currentWidth:gn,tooltip:`Toggle diplomacy with this tribe (Currently: ${w.diplomacyStatus})`,targetTribeId:w.leaderId};n.uiButtons.push(x),n.hoveredButtonId===D&&(e.fillStyle=Kf,e.globalAlpha=.5,e.fillRect(H.x,H.y,H.width,H.height),e.globalAlpha=1),e.font=`${gn*.8}px "Press Start 2P", Arial`,e.textBaseline="middle",e.textAlign="center",e.fillText(B,F+gn/2,C)}F+=gn+zn,w.adultCount>0&&(oa(e,{x:F+Bi/2,y:C},Bi,25,"male"),F+=Bi/2,e.font=`${wd}px "Press Start 2P", Arial`,e.fillStyle="white",e.textBaseline="middle",e.textAlign="left",e.fillText(` ${w.adultCount}`,F,C),F+=e.measureText(` ${w.adultCount}`).width+zn/2),w.childCount>0&&(oa(e,{x:F+Bi/2,y:C},Bi,1,"female"),F+=Bi/2,e.font=`${wd}px "Press Start 2P", Arial`,e.fillStyle="white",e.textBaseline="middle",e.textAlign="left",e.fillText(` ${w.childCount}`,F,C))}e.restore()}function WR(e,n,r,o,l){const a=Lv,u=Bv,d=n+o-a-u,h=r+u;e.save(),e.lineWidth=2,e.strokeStyle=l?PE:RE,e.beginPath();const g=5;e.moveTo(d+g,h+g),e.lineTo(d+a-g,h+a-g),e.moveTo(d+a-g,h+g),e.lineTo(d+g,h+a-g),e.stroke(),e.restore()}function YR(e,n,r,o){const{tutorialState:l,tutorial:a}=n;if(l.transitionState===xt.INACTIVE)return;const u=a.steps[l.currentStepIndex];if(!u)return;e.save(),e.globalAlpha=l.transitionAlpha;const d=SE,h=AE,g=TE,m=`${_d}px "Press Start 2P", Arial`,y=`${Wm}px "Press Start 2P", Arial`,S=wE,E=Wm*1.5;e.font=y;const w=u.text.split(" ");let T="";const C=[];for(let _e=0;_e<w.length;_e++){const Ge=T+w[_e]+" ";e.measureText(Ge).width>d-h*2&&_e>0?(C.push(T),T=w[_e]+" "):T=Ge}C.push(T);const F=h*2+_d+h/2+C.length*E,B=(r-d)/2,D=o-F-160;e.fillStyle=IE,e.beginPath(),e.moveTo(B+g,D),e.lineTo(B+d-g,D),e.quadraticCurveTo(B+d,D,B+d,D+g),e.lineTo(B+d,D+F-g),e.quadraticCurveTo(B+d,D+F,B+d-g,D+F),e.lineTo(B+g,D+F),e.quadraticCurveTo(B,D+F,B,D+F-g),e.lineTo(B,D+g),e.quadraticCurveTo(B,D,B+g,D),e.closePath(),e.fill(),e.fillStyle=S,e.textAlign="center",e.textBaseline="top",e.font=m,e.fillText(u.title,B+d/2,D+h),e.font=y;let H=D+h+_d+h/2;for(const _e of C)e.fillText(_e,B+d/2,H),H+=E;const x=n.hoveredButtonId==="tutorial-dismiss";WR(e,B,D,d,x),e.restore();const U=Lv,$=Bv,J=B+d-U-$,Ce=D+$;return{x:J,y:Ce,width:U,height:U}}function Yd(e,n,r){e.save();const o=_E,l={x:n.x-o,y:n.y-o,width:n.width+o*2,height:n.height+o*2};e.strokeStyle=Fv,e.lineWidth=Uv+Math.sin(r*qf)*1.5,e.setLineDash([8,8]),e.strokeRect(l.x,l.y,l.width,l.height),e.restore()}function jR(e,n){e.fillStyle="white",e.font='30px "Press Start 2P", Arial',e.textAlign="center",e.fillText("Game Over!",e.canvas.width/2,e.canvas.height/2-60),e.font='20px "Press Start 2P", Arial',e.fillText("Lineage Extinct.",e.canvas.width/2,e.canvas.height/2-20),e.fillText(`Cause: ${n.causeOfGameOver||"Unknown"}`,e.canvas.width/2,e.canvas.height/2+20)}const wf=10,VR=3,d0=wf*.7;function XR(e,n,r,o,l){const{position:a,food:u,maxFood:d,ownerId:h,claimedUntil:g}=n;if(e.beginPath(),e.arc(a.x,a.y,wf,0,Math.PI*2),e.fillStyle="#228B22",e.fill(),e.strokeStyle="#006400",e.lineWidth=1,e.stroke(),h&&g&&g>l&&o){const m=r.entities.entities[h];if(m){let y;m.id===o.id?y=jf:gv(o,m,r)?y=Uw:y=Cv,y&&(e.strokeStyle=y,e.lineWidth=1+Math.sin(l*2)*.5,e.beginPath(),e.arc(a.x,a.y,wf+2,0,Math.PI*2),e.stroke())}}if(u.length>0){const m=Math.PI*2/Math.min(u.length,d);for(let y=0;y<u.length;y++){const S=y*m,E=a.x+d0*Math.cos(S),w=a.y+d0*Math.sin(S);e.beginPath(),e.arc(E,w,VR,0,Math.PI*2),e.fillStyle="#FF0000",e.fill()}}}const f0=(e,n,r=70,o=50)=>{const l=e>>n&255;return`hsl(${Math.floor(l/255*360)}, ${r}%, ${o}%)`},KR=(e,n)=>{const r=e.match(/hsl\((\d+),\s*(\d+)%,\s*(\d+)%\)/);if(!r)return e;const[o,l,a]=[parseInt(r[1]),parseInt(r[2]),parseInt(r[3])];return`hsl(${o}, ${l}%, ${Math.max(0,a-n)}%)`},bl=(e,n,r,o,l,a,u,d=!1)=>{e.save(),e.translate(n,r),e.rotate(a),e.fillStyle=d?KR(u,15):u,e.beginPath(),e.roundRect(-o/2,0,o,l,o/2),e.fill(),e.restore()},jd=(e,n)=>{const r=e.match(/hsl\((\d+),\s*(\d+)%,\s*(\d+)%\)/),o=75;if(!r)return`hsl(0, 0%, ${o}%)`;const[,l,a,u]=r.map(Number),d=a*(1-n),h=u+(o-u)*n;return`hsl(${l}, ${d}%, ${h}%)`},fy={name:"tribe-prey-2d",referenceImage:"swos.png",description:`A 2D prey asset for the Tribe game, featuring various stances and animations.

Prey is an animal which can be hunted by predators or humans in the Tribe game.

Preys look like small 4 leg mammals, with a simple and recognizable design. The characters are designed to be easily distinguishable and animated in a way that conveys their actions clearly.

# Visual style

Prey characters in the Tribe game are inspired by classic 2D pixel art, they look like Sensible Soccer players(Sensible Soccer game visual style is IMPORTANT), with a simple and recognizable design. The characters are designed to be easily distinguishable and animated in a way that conveys their actions clearly.

Character in Tribe game look like creatures from stone age, they have simple clothing, no shoes, and no modern accessories. The characters are designed to be easily distinguishable and animated in away that conveys their actions clearly.

Prey walks on all fours, unlike human (two legs).

Each prey is described by a unique gene code, which is a number that defines its appearance, size, and other characteristics. The gene code is used to generate the character's appearance, including body proportions, color, and other visual features. The gene code is a 32-bit integer, with each bit representing a specific characteristic of the character.

Prey should have should have visible body parts, such as head, torso, arms, and legs. The body parts should be connected and should not overlap. The character's body parts should be simple shapes, such as circles and rectangles, with solid colors and no gradients or patterns.

Preys are supposed to be sympathetic and friendly, so the character's face should have a friendly expression, with a smile and bright eyes. The character's eyes should be large and expressive, with a simple design.

# Technical details

The asset is rendered on a canvas using the CanvasRenderingContext2D API. The rendering function takes parameters for position, size, progress, stance, direction, gender, and age. The character can face left or right, and the rendering adapts based on the stance (e.g., idle, walk, eat, procreate).
The rendering function must be simple and efficient, it should not use complex patterns or gradients, and should focus on solid colors and basic shapes to maintain the pixel art aesthetic.

15% padding from all edges of the rendering box is required to ensure the character is not cut off during rendering.

Subtle shadow should be drawn under the a character to give it a sense of depth.

IMPORTANT: The character is visible from the side, just like in Sensible Soccer.

# Rendering parameters

- age: The age of the character, which affects the size and proportions of the body parts. Age is a number between 0 and 12, with 2 being the average age.
- gender:
  - 'male': Male prey are larger and more robust, with a more pronounced musculature.
  - 'female': Female prey are smaller and more agile, with a leaner build.
- isPregnant: (applicable only for females) Indicates if the character is pregnant, like very large belly. Pregnant characters should have a larger torso.
- direction: A vector indicating the character's facing direction. There should be at least 8 directions (like in Sensible Soccer): top left, top, top right, left, right, bottom left, bottom, bottom right. The character should be flipped horizontally if the direction vector's X component is negative.
             When moving up(top, top left, top right), the character back of the head should be visible, when moving down(Y > 0), the character face should be visible.
- hungryLevel: A number between 0 and 100 indicating how hungry the character is, hunger level 100 means the character is starving, 0 means the character is not hungry at all. So hungry characters should be thinner, with less body fat, and more pronounced muscles. The character's hunger level affects the size and proportions of the body parts, with hungrier characters being smaller and more gaunt.

# Rendering details

- All parts of the body must be connected
- Rendering must take into account direction vector (X and Y) to flip the character horizontally if needed
- The character's age affects the size and proportions of the body parts, with older characters being larger and more robust. Hair color should become gray for older characters.

# Stances

- 'idle': The character stands still, with a slight leg sway to indicate life.
- 'walk': The character moves forward, with legs and arms in motion.
- 'eat': The character holds food and brings it to their mouth, with a slight bend at the knees.
- 'procreate': The character performs a mating animation, with a specific pose and movement. There should be some additional visual effects to indicate this action, such as a slight glow or aura around the characters, or a dust particles to indicate movement.
- 'dead': The character lies on the ground, with limbs relaxed and a neutral expression, slowly turns into a grey skeleton over time. The character pose and body parts should not be animated in this stance, as the character is dead so it should not move.`,stances:["idle","walk","eat","dead","procreate"],render(e,n,r,o,l,a,u,d={gender:"male",age:2,direction:[1,0],isPregnant:!1,hungryLevel:0,geneCode:8405024}){e.save(),e.imageSmoothingEnabled=!1;const h=o*.15,g=n+o/2,m=r+l/2,y=o-h*2,S=l-h*2,{gender:E,age:w,direction:T,isPregnant:C,hungryLevel:F,geneCode:B}=d,D=.8+Math.min(w,10)/10*.4,H=E==="male"?1.05:.95,x=1-F/100*.3,U=y*.5*x*D*H;let $=S*.3*D*H;const J=y*.15*D*H,Ce=U*.2,_e=S*.3,Ge=f0(B,0,30,50);let Ne=f0(B,8,50,40);if(w>45){const se=Math.min(1,(w-45)/15);Ne=jd(Ne,se)}e.translate(g,m),T[0]<0&&e.scale(-1,1);const Pe=Math.sin(a*Math.PI*2),de=Math.cos(a*Math.PI*2),Ue=_e+$*.2;if(u==="dead"){const se=Math.min(a,1);e.translate(0,S*.2),e.rotate(Math.PI/2);const we=jd(Ne,se),Te=jd(Ge,se);e.globalAlpha=.5+se*.5,e.strokeStyle=we,e.lineWidth=Ce*.5,e.beginPath(),e.moveTo(-U*.4,0),e.lineTo(U*.4,0),e.stroke();for(let q=-1;q<=1;q+=1)e.beginPath(),e.arc(0,0,$*.4,Math.PI*.4*q-Math.PI*.2,Math.PI*.4*q+Math.PI*.2),e.stroke();e.fillStyle=Te,e.beginPath(),e.arc(U*.5,0,J,0,Math.PI*2),e.fill(),e.fillStyle="black",e.beginPath(),e.arc(U*.55,0,J*.3,0,Math.PI*2),e.fill(),e.restore();return}e.fillStyle="rgba(0, 0, 0, 0.1)",e.beginPath(),e.ellipse(0,Ue,U*.7,U*.25,0,0,2*Math.PI),e.fill();let Ae=0,ne=0,W=0,X=0,Y=0,R=0;switch(u){case"idle":ne=Pe*(S*.02),W=Pe*.05,X=-Pe*.05,Y=-Pe*.05,R=Pe*.05;break;case"walk":ne=Math.abs(de)*(S*-.04),W=Pe*.7,X=-Pe*.7,Y=-Pe*.7,R=Pe*.7;break;case"eat":Ae=S*.1,ne=S*.05,Ae+=Pe*(S*.02);break;case"procreate":ne=S*.05;const se=(1-de)*-y*.05;e.translate(se,0),e.shadowColor="rgba(255, 182, 193, 0.9)",e.shadowBlur=10;break}C&&E==="female"&&($*=1.6);const L=ne,K=L-$*.2;bl(e,U*-.35,K,Ce,_e,Y,Ne,!0),bl(e,U*.35,K,Ce,_e,R,Ne,!0),e.fillStyle=Ne,e.beginPath(),e.ellipse(0,L,U/2,$/2,0,0,2*Math.PI),e.fill();const ie=U*.45,ye=K+Ae;e.fillStyle=Ge,e.beginPath(),e.arc(ie,ye,J,0,Math.PI*2),e.fill(),T[1]>=0&&(e.fillStyle="black",e.beginPath(),e.arc(ie+J*.3,ye-J*.2,J*.15,0,Math.PI*2),e.fill()),bl(e,U*-.35,K,Ce,_e,W,Ne),bl(e,U*.35,K,Ce,_e,X,Ne),e.restore()}};function qR(e,n){let[r,o,l]=e.match(/\d+/g).map(Number);return r=Math.max(0,r-n),o=Math.max(0,o-n),l=Math.max(0,l-n),`rgb(${r}, ${o}, ${l})`}function ZR(e){const n=(e&16711680)>>16,r=(e&65280)>>8,o=e&255,l=`rgb(${n}, ${r}, ${o})`,a=qR(l,40),u=(e&255)%100+50,d=(e>>8&255)%100,h=(e>>16&255)%100,g=`rgb(${u}, ${d}, ${h})`,m=(e&8388608)!==0?"#00aaff":"#ffaa00";return{furColor:l,darkerFurColor:a,skinColor:g,eyeColor:m}}const hy={name:"tribe-predator-2d",referenceImage:"swos.png",description:`A 2D predator asset for the Tribe game, featuring various stances and animations.

Predator is an animal which can hunt and attack humans in the Tribe game. It is designed to be a threat to the player, adding an element of danger and challenge to the game world.

Predator look like bears or wolves, with a simple and recognizable design. The characters are designed to be easily distinguishable and animated in a way that conveys their actions clearly.

# Visual style

Predator characters in the Tribe game are inspired by classic 2D pixel art, they look like Sensible Soccer players(Sensible Soccer game visual style is IMPORTANT), with a simple and recognizable design. The characters are designed to be easily distinguishable and animated in a way that conveys their actions clearly.

Character in Tribe game look like creatures from stone age, they have simple clothing, no shoes, and no modern accessories. The characters are designed to be easily distinguishable and animated in away that conveys their actions clearly.

Predator walks on arms and legs, unlike human (two legs).

Each predator is described by a unique gene code, which is a number that defines its appearance, size, and other characteristics. The gene code is used to generate the character's appearance, including body proportions, color, and other visual features. The gene code is a 32-bit integer, with each bit representing a specific characteristic of the character.

Predator should have visible ears, eyes, and mouth with teeth. It must have a tail. Front legs should be shorter than back legs, and they should be positioned closer to the body. The character's body should be wider at the top and narrower at the bottom, with a slight curve to the back. The character's head should be larger than the body, with a pronounced jaw and sharp teeth.

# Technical details

The asset is rendered on a canvas using the CanvasRenderingContext2D API. The rendering function takes parameters for position, size, progress, stance, direction, gender, and age. The character can face left or right, and the rendering adapts based on the stance (e.g., idle, walk, eat, procreate).
The rendering function must be simple and efficient, it should not use complex patterns or gradients, and should focus on solid colors and basic shapes to maintain the pixel art aesthetic.

15% padding from all edges of the rendering box is required to ensure the character is not cut off during rendering.

Subtle shadow should be drawn under the a character to give it a sense of depth.

IMPORTANT: The character is visible from the side, just like in Sensible Soccer.

# Rendering parameters

- age: The age of the character, which affects the size and proportions of the body parts. Age is a number between 1 and 20, with 3 being the average age.
- gender:
  - 'male': Male predators are larger and more robust, with a more pronounced musculature.
  - 'female': Female predators are smaller and more agile, with a leaner build.
- isPregnant: (applicable only for females) Indicates if the character is pregnant, like very large belly. Pregnant characters should have a larger torso.
- direction: A vector indicating the character's facing direction. There should be at least 8 directions (like in Sensible Soccer): top left, top, top right, left, right, bottom left, bottom, bottom right. The character should be flipped horizontally if the direction vector's X component is negative.
             When moving up(top, top left, top right), the character back of the head should be visible, when moving down(Y > 0), the character face should be visible.
- hungryLevel: A number between 0 and 100 indicating how hungry the character is, hunger level 100 means the character is starving, 0 means the character is not hungry at all. So hungry characters should be thinner, with less body fat, and more pronounced muscles. The character's hunger level affects the size and proportions of the body parts, with hungrier characters being smaller and more gaunt.

# Rendering details

- All parts of the body must be connected
- Rendering must take into account direction vector (X and Y) to flip the character horizontally if needed
- The character's age affects the size and proportions of the body parts, with older characters being larger and more robust. Hair color should become gray for older characters.

# Stances

- 'idle': The character stands still, with a slight leg sway to indicate life.
- 'walk': The character moves forward, with legs and arms in motion.
- 'eat': The character holds food and brings it to their mouth, with a slight bend at the knees.
- 'procreate': The character performs a mating animation, with a specific pose and movement. There should be some additional visual effects to indicate this action, such as a slight glow or aura around the characters, or a dust particles to indicate movement.
- 'attacking': The character performs an attack animation, with arms raised and a forward motion.
- 'dead': The character lies on the ground, with limbs relaxed and a neutral expression, slowly turns into a grey skeleton over time. The character pose and body parts should not be animated in this stance, as the character is dead so it should not move.`,stances:["idle","walk","eat","dead","attacking","procreate"],render(e,n,r,o,l,a,u,d={gender:"male",age:20,direction:[1,0],isPregnant:!1,hungryLevel:0,geneCode:8405024}){const{gender:h,age:g,direction:m,isPregnant:y,hungryLevel:S,geneCode:E}=d;e.save();const w=o*.15,T=Math.max(1,Math.floor((o-w*2)/10)),C=m[0]<0;e.translate(n+o/2,r+l/2),C&&e.scale(-1,1);const F=ZR(E),B=.8+Math.min(g,20)/20*.4,D=h==="male"?1.05:.95,H=1-S/100*.25,x=B*D*H,U=Math.max(0,Math.min(1,(g-15)/5));e.filter=`grayscale(${U})`;const $=F.furColor,J=F.darkerFurColor,Ce=F.eyeColor,_e="#FFFFFF",Ge="#c75c5c",Ne="#E0E0E0",Pe="#A0A0A0",de=l/2-2*T,Ue=Math.sin(a*Math.PI*2),Ae=Math.abs(Ue);if(e.fillStyle="rgba(0,0,0,0.15)",e.beginPath(),e.ellipse(0,de,T*4,T,0,0,2*Math.PI),e.fill(),e.filter="none",u==="dead"){const Ze=Math.min(1,a*2);e.save(),e.translate(0,de-T*3),e.rotate(-Math.PI/2);const je=(Un,Wt,an,Ln,Bn=!1)=>{e.fillStyle=Bn?Pe:Ne,e.fillRect(Un*T,Wt*T,an*T,Ln*T)};Ze<1&&(e.globalAlpha=1-Ze,e.fillStyle=$,e.beginPath(),e.ellipse(0,0,T*3,T*5,0,0,Math.PI*2),e.fill(),e.globalAlpha=1),Ze>0&&(e.globalAlpha=Ze,je(-1,-4,2,2),je(1,-3.5,1,1,!0),je(-.5,-2,1,5,!0),je(-2.5,-1,5,.5),je(-2.5,0,5,.5),je(-2.5,1,5,.5),je(-3,-2,-1,2,!0),je(3,-2,1,2),je(-3,2,-1,2,!0),je(3,2,1,2),e.globalAlpha=1),e.restore(),e.restore();return}e.fillStyle=$;let ne=0,W=0,X=0,Y=[0,0,0,0];switch(u){case"idle":ne=Ue*T*.1;break;case"walk":const Ze=Math.sin(a*Math.PI*4);ne=Math.abs(Ze)*-T*.5,Y=[Ze*T,-Ze*T,-Ze*T,Ze*T];break;case"attacking":const je=Math.sin(a*Math.PI*4);W=T*2+je*T,X=T*2,ne=T;break;case"eat":X=T*3+Ae*T,ne=T*1.5,e.fillStyle=Ge,e.fillRect(-T,de-T,T*2,T);break;case"procreate":ne=Math.sin(a*Math.PI*8)*T*.3,e.fillStyle="rgba(139, 69, 19, 0.5)";for(let Wt=0;Wt<5;Wt++){const an=(Math.random()-.5)*T*8,Ln=de+(Math.random()-.5)*T*2;Ae>.5&&e.fillRect(an,Ln,T*.5,T*.5)}break}const R=T*3*x*(y?1.3:1),L=T*5*x,K=-L/1.5,ie=de-R-T*2.5+ne;e.fillStyle=$,e.beginPath(),e.moveTo(K-T*.5,ie+R*.5),e.quadraticCurveTo(K-T*3,ie-T,K-T*2+Ue*T,ie+R+T),e.fill();const ye=T*1.2*x,se=T*3*x,we=T*2.5*x,Te=K+L*.8,q=K+L*.2;e.fillStyle=J,e.fillRect(q,de-we,ye,we+Y[2]),e.fillRect(Te,de-se,ye,se+Y[0]),e.fillStyle=$,e.beginPath(),e.moveTo(K,ie+R),e.lineTo(K,ie+T),e.quadraticCurveTo(K+L/2,ie,K+L,ie+T),e.lineTo(K+L,ie+R),e.fill(),e.fillStyle=$,e.fillRect(q+T/2,de-we,ye,we+Y[3]),e.fillRect(Te+T/2,de-se,ye,se+Y[1]);const re=T*3.5*x,Le=K+L-re*.3+W,he=ie-re*.3+X;e.fillStyle=$,e.beginPath(),e.arc(Le,he,re/2,0,Math.PI*2),e.fill(),e.beginPath(),e.ellipse(Le+re*.4,he+re*.2,T*1.5,T,0,0,Math.PI*2),e.fill(),m[1]>=0&&(e.fillStyle=Ce,e.fillRect(Le+T*.5,he-T*.5,T*.5,T*.5),u==="attacking"&&(e.fillStyle=_e,e.fillRect(Le+re*.5,he+re*.4,T,T*.4))),e.fillStyle=J,e.beginPath(),e.moveTo(Le-re*.4,he-re*.3),e.lineTo(Le,he-re*.7),e.lineTo(Le,he-re*.2),e.fill(),e.restore()}},QR=9;function JR(e,n){const{position:r,gender:o,age:l,decayProgress:a,food:u,radius:d,originalEntityType:h,geneCode:g}=n;if(e.save(),e.globalAlpha=1-a,h==="human"?sh.render(e,r.x-d,r.y-d,d*2,d*2,a,"dead",o,l,[0,0],!1,0):h==="prey"?fy.render(e,r.x-d,r.y-d,d*2,d*2,a,"dead",{gender:o,age:l,direction:[0,0],isPregnant:!1,hungryLevel:0,geneCode:g||8405024}):h==="predator"&&hy.render(e,r.x-d,r.y-d,d*2,d*2,a,"dead",{gender:o,age:l,direction:[0,0],isPregnant:!1,hungryLevel:0,geneCode:g||8405024}),e.restore(),u.length>0){e.save(),e.font=`${QR}px Arial`,e.textAlign="center",e.textBaseline="middle";const m=Et*.9,y=Math.PI/av*3;u.forEach((S,E)=>{const w=E*y,T=r.x+m*Math.cos(w)*Math.atan2(E,E),C=r.y+m*Math.sin(w)*Math.atan2(E,E),F=tv[S.type];e.fillText(F,T,C)}),e.restore()}}function Vi(e,n,r,o,l,a,u,d){e.save(),e.fillStyle=u,e.fillRect(n,r,o,l),e.fillStyle=d,e.fillRect(n,r,o*Math.max(0,a),l),e.restore()}function eP(e,n,r,o,l,a){if(e.save(),o.length===0){e.restore();return}const u=o.length*l;let d;u>a||u+(o.length-1)*4>a?d=(a-u)/(o.length-1):d=4,o.length===1&&(d=0);for(let h=0;h<o.length;h++){const g=tv[o[h].type];e.fillText(g,n+h*(l+d),r)}e.restore()}function tP(e,n,r,o,l){const a=n.autopilotControls.hoveredAutopilotAction;if(!a)return;let u,d=Et/2;const h=Su[a.action],g=Gv[a.action],m=`${h} ${g}`;if("targetEntityId"in a){const y=n.entities.entities[a.targetEntityId];y&&(u=y.position,d=y.radius)}else"position"in a&&(u=a.position);if(u){dy(e,u,d,Vf,Xf,2,r,o,l,n.mapDimensions),e.save(),e.font=`${Po}px "Press Start 2P", Arial`,e.fillStyle="white",e.textAlign="center",e.textBaseline="bottom",e.shadowColor="black",e.shadowBlur=5;const{x:y,y:S}=Iu(u,r,{width:o,height:l},n.mapDimensions),E=S-d-yu-Po/2;e.fillText(m,y,E),e.restore()}}function nP(e,n,r,o,l){e.save();const a=(Math.sin(l*qf)+1)/2,u=r+yu+a*5;e.strokeStyle=Vf,e.lineWidth=2,e.setLineDash(Xf),e.beginPath(),e.arc(n.x,n.y,u,0,Math.PI*2),e.stroke(),e.setLineDash([]);const d=Su[o],h=Gv[o];if(d){e.font=`${Po*1.5}px "Press Start 2P", Arial`,e.textAlign="center",e.textBaseline="middle";const g=n.y-u-25;e.fillText(d,n.x,g),e.font=`${Po*.8}px "Press Start 2P", Arial`,e.fillText(h,n.x,g+25)}e.restore()}function iP(e,n,r){e.save();const o=30,l=70,a=3,u=l/a;for(let d=0;d<a;d++){const h=d*u,g=(r*o+h)%l,m=1-g/l;e.strokeStyle=`rgba(255, 215, 0, ${m*.7})`,e.lineWidth=1+(1-m)*2,e.beginPath(),e.arc(n.x,n.y,g,0,Math.PI*2),e.stroke()}e.restore()}function rP(e,n){const{activeAutopilotAction:r,behaviors:o}=n.autopilotControls,l=wt(n);if(!l)return;const a=(u,d)=>{iP(u,d.position,n.time)};if(l.isCallingToFollow&&sn(e,n.mapDimensions.width,n.mapDimensions.height,a,{position:l.position}),o.followLeader&&!r&&sn(e,n.mapDimensions.width,n.mapDimensions.height,a,{position:l.position},70),r){let u,d=15;if("position"in r)u=r.position;else if("targetEntityId"in r){const h=n.entities.entities[r.targetEntityId];h&&(u=h.position,d=h.radius||30)}if(u&&r.action!==ce.AutopilotFollowMe&&!l.isCallingToFollow){const h=(g,m)=>{nP(g,m.position,d,r.action,n.time)};sn(e,n.mapDimensions.width,n.mapDimensions.height,h,{position:{...u}},u,d+30)}}}function h0(e,n,r,o,l,a,u=!0){const d=n.split(" ");let h="";const g=[];for(let m=0;m<d.length;m++){const y=h+d[m]+" ";e.measureText(y).width>l&&m>0?(g.push(h),h=d[m]+" "):h=y}if(g.push(h),u)for(let m=0;m<g.length;m++)e.fillText(g[m],r,o+m*a);return g.length*a}function oP(e){return 1-Math.pow(1-e,3)}function sP(e,n,r,o){n.notificationButtonRects={dismiss:{},view:{}};const l=n.notifications.filter(u=>!u.isDismissed);if(l.length===0)return;e.save();let a=o-BE;for(const u of l){const d=r-Rl-mr;e.font=`${Rd}px "Press Start 2P", Arial`;const h=d+mr,g=Rl-mr*2,m=h0(e,u.message,-9999,-9999,g,Rd*1.2,!1),y=mr*2+m+Wn,S=a-y,E=Date.now()-u.creationTime,w=Math.min(E/LE,1),T=oP(w),C=o,F=C+(S-C)*T;e.fillStyle=DE,e.beginPath(),e.roundRect(d,F,Rl,y,NE),e.fill(),e.fillStyle=OE,e.textBaseline="top",h0(e,u.message,h,F+mr,g,Rd*1.2,!0);const B=F+y-Wn-mr/2,D=d+Rl-Wn-mr/2,H={x:D,y:B,width:Wn,height:Wn};n.notificationButtonRects&&(n.notificationButtonRects.dismiss[u.id]=H);const x=n.hoveredButtonId===`notification-dismiss-${u.id}`;if(e.fillStyle=x?Vm:kE,e.font=`${Wn}px Arial`,e.textAlign="center",e.textBaseline="middle",e.fillText("",H.x+H.width/2,H.y+H.height/2),u.targetEntityIds||u.targetPosition||u.targetArea||u.targetRadius){const J={x:D-Wn-jm,y:B,width:Wn,height:Wn};n.notificationButtonRects&&(n.notificationButtonRects.view[u.id]=J);const Ce=n.hoveredButtonId===`notification-view-${u.id}`;e.fillStyle=Ce?Vm:ME,e.font=`${Wn*(Ce?1.5:1.2)}px Arial`,e.fillText("",J.x+J.width/2,J.y+J.height/2)}a-=y+jm}e.restore()}function aP(e){return e.length===0?0:e.reduce((r,o)=>r+o,0)/e.length}function Vd(e,n,r,o,l,a,u,d){e.save(),e.fillStyle="rgba(255, 255, 255, 0.1)",e.fillRect(o,l,a,u),e.strokeStyle="#555",e.lineWidth=1,e.strokeRect(o,l,a,u);const h=aP(r);e.fillStyle="white",e.font="11px monospace",e.textAlign="left",e.fillText(`${n}: ${h.toFixed(2)}ms`,o+qe,l+qe+8);const g=Math.max(...r,1),m=r.map(y=>y/g*u);if(e.beginPath(),e.strokeStyle=d,e.lineWidth=2,m.length>1){e.moveTo(o,l+u-m[0]);for(let y=1;y<m.length;y++){const S=o+y/(m.length-1)*a,E=l+u-m[y];e.lineTo(S,E)}}else if(m.length===1){const y=l+u-m[0];e.moveTo(o,y),e.lineTo(o+a,y)}e.stroke(),e.fillStyle="rgba(255, 255, 255, 0.7)",e.font="10px monospace",e.textAlign="right",e.fillText(`${g.toFixed(2)}ms`,o+a-qe,l+qe+8),e.restore()}function lP(e,n,r){const{performanceMetrics:o}=n;if(!o)return;const l=280,a=240,u=r-l-qe,d=qe+mn*2;e.save(),e.fillStyle="rgba(0, 0, 0, 0.8)",e.fillRect(u,d,l,a),e.strokeStyle="#444",e.lineWidth=2,e.strokeRect(u,d,l,a),e.fillStyle="white",e.font="12px monospace",e.textAlign="left";let h=d+qe+5;const g=u+qe;e.fillStyle="#66ccff",e.font="bold 14px monospace",e.fillText(" Performance Debugger",g,h),h+=25,e.fillStyle="white",e.font="12px monospace";const m=uP(n);e.fillText(`FPS: ${m.toFixed(1)}`,g,h),h+=20;const y=l-qe*2,S=45,E=10;Vd(e,"Render",Xd(n,"renderTime"),g,h,y,S,"#4CAF50"),h+=S+E,Vd(e,"World Update",Xd(n,"worldUpdateTime"),g,h,y,S,"#2196F3"),h+=S+E,Vd(e,"AI Update",Xd(n,"aiUpdateTime"),g,h,y,S,"#FFC107"),e.fillStyle="#888",e.font="10px monospace",e.textAlign="center",e.fillText("Press '2' to toggle this panel",u+l/2,d+a-10),e.restore()}function uP(e){const{performanceMetrics:n}=e;if(!n||n.history.length===0)return 0;const r=n.history[n.history.length-1].bucketTime/(At/Tt);return n.history.filter(a=>r-a.bucketTime/(At/Tt)<1).length}function cP(e,n){if(e.length===0)return[];const r=new Map;for(const a of e){const u=Math.floor(a.bucketTime/(At/Tt));r.set(u,(r.get(u)||0)+a[n])}return Array.from(r.keys()).sort().map(a=>r.get(a)).slice(0,-1).slice(1).reverse()}function Xd(e,n){return cP(e.performanceMetrics.history,n)}function ah(e,n,r){if(!n.aiBlackboard)return;const o=n.aiBlackboard.nodeExecutionData,l=n.type==="human"?ty:n.type==="predator"?iy:n.type==="prey"?ny:null;if(!l)return;e.save(),e.font=`${lE}px Arial`,e.textAlign="left",e.textBaseline="top";const a=S=>{switch(S){case I.SUCCESS:return cE;case I.FAILURE:return dE;case I.RUNNING:return fE;case I.NOT_EVALUATED:case null:default:return hE}},u=S=>{if(!S.name||!o[S.name])return{width:0,height:0};let E=0,w=0;const T=o[S.name],C=` ${S.name}`+(T!=null&&T.debugInfo?`: ${T.debugInfo}`:""),F=e.measureText(C).width,B=(S.depth??0)*xm+8+F+zm+Cs+20;if(E=Math.max(E,B),w+=Cd,S.children)for(const D of S.children){const H=u(D);E=Math.max(E,H.width),w+=H.height}else if(S.child){const D=u(S.child);E=Math.max(E,D.width),w+=D.height}return{width:E,height:w}},d=(S,E,w,T)=>{if(!S.name||!o[S.name])return E;let C=E;const F=o[S.name],B=w+2+(S.depth??0)*xm;let D=I.NOT_EVALUATED,H=$m,x="";if(F){D=F.status,x=F.debugInfo;const J=pE/Tt*At,Ce=r-F.lastExecuted,_e=Math.max(0,1-Ce/J);H=cw($m,gE,_e),Ce>Ks&&(D=I.NOT_EVALUATED)}const U=a(D);e.fillStyle=U,e.fillText("",B,C),e.fillStyle=H;const $=` ${S.name}`+(x?`: ${x}`:"");if(e.fillText($,B+8,C),F&&F.executionHistory.length>0){const{executionHistory:J}=F,Ce=Mv/Tt*At,_e=r,Ge=_e-Ce,Ne=w+T-Cs-zm;let Pe=Ne;const de=C+(Cd-_l)/2,Ue=J.filter(K=>K.time<Ge);let Ae=Ue.length>0?Ue[Ue.length-1].status:null,ne=Ge;const W=J.filter(K=>K.time>=Ge&&K.time<=_e),X=Cs/Ce;e.fillStyle="rgba(255, 255, 255, 0.1)",e.fillRect(Ne,de,Cs,_l);for(const K of W){const ye=(K.time-ne)*X;ye>0&&(e.fillStyle=a(Ae),e.fillRect(Pe,de,ye,_l),Pe+=ye),Ae=K.status,ne=K.time}r-ne>Ks&&(Ae=I.NOT_EVALUATED);const R=(_e-ne)*X;e.fillStyle=a(Ae);const L=Ne+Cs-Pe;e.fillRect(Pe,de,Math.min(R,L),_l)}if(C+=Cd,S.children)for(const J of S.children)C=d(J,C,w,T);else S.child&&(C=d(S.child,C,w,T));return C},{width:h,height:g}=u(l);if(g===0){e.restore();return}const m=n.position.x+sE,y=n.position.y+aE-g/2;e.fillStyle=uE,e.fillRect(m,y,h,g+4),d(l,y+2,m,h),e.restore()}const dP={moving:"walk",gathering:"gathering",eating:"eat",feeding:"eat",procreating:"procreate",idle:"idle",attacking:"attacking",planting:"gathering",depositing:"gathering",retrieving:"gathering"};function fP(e,n){var d;const{radius:r,position:o,activeAction:l="idle"}=n,a=((d=n.stateMachine)==null?void 0:d[0])||"N/A",u=n.isAdult?Et+20:Et*.6+20;e.save(),e.fillStyle="white",e.font="10px Arial",e.textAlign="center",e.fillText(`Action: ${l}`,o.x,o.y-u),e.fillText(`State: ${a}`,o.x,o.y-u+10),e.fillText(`HP: ${n.hitpoints}`,o.x,o.y-u+20),e.fillText(`Cooldown: ${n.attackCooldown||"N/A"}`,o.x,o.y-u+30),e.fillText(`Tribe: ${n.leaderId||"N/A"}`,o.x,o.y-u+40),e.restore(),e.beginPath(),e.arc(o.x,o.y,r,0,Math.PI*2),e.strokeStyle="rgba(255, 0, 0, 0.5)",e.lineWidth=1,e.stroke(),e.closePath()}function hP(e,n,r,o,l){e.save(),e.font=`${mf}px Arial`,e.textAlign="center",e.textBaseline="middle",e.fillText(r,n.x,n.y-(o?Et:Fo)-mf-l),e.restore()}function gP(e,n,r,o,l){const a=n.x,u=n.y-r-o/2;e.save(),e.fillStyle=l,e.strokeStyle=l,e.lineWidth=1.5,e.beginPath(),e.rect(a-o/2,u,o,o/2),e.fill(),e.beginPath(),e.moveTo(a-o/2,u),e.lineTo(a-o/4,u-o/3),e.lineTo(a-o/6,u),e.moveTo(a-o/6,u),e.lineTo(a,u-o/2),e.lineTo(a+o/6,u),e.moveTo(a+o/6,u),e.lineTo(a+o/4,u-o/3),e.lineTo(a+o/2,u),e.stroke(),e.restore()}function pP(e,n,r){var d;const{position:o,radius:l}=n,a=o.x-Ed/2,u=o.y-l-eE;if(((d=n.stateMachine)==null?void 0:d[0])===Ji){const h=n.stateMachine[1],g=r-h.attackStartTime,m=Math.min(g/fv,1);Vi(e,a,u,Ed,Bm,m,Wi,tE)}else if(n.attackCooldown&&n.attackCooldown>0){const h=1-n.attackCooldown/vu;Vi(e,a,u,Ed,Bm,h,Wi,nE)}}function mP(e,n,r){const l="";e.save(),e.font="15px Arial",e.textAlign="center",e.textBaseline="bottom",e.shadowColor="black",e.shadowBlur=3,e.fillText(l,n.x,n.y-r),e.restore()}function vP(e,n,r=!1,o=!1,l=!1,a=!1,u=!1,d=!1,h=!1,g=!1,m,y){const{position:S,activeAction:E="idle"}=n,w=n.isAdult?Et:Et*.6,T=dP[E]||"idle";sh.render(e,S.x-w,S.y-w,w*2,w*2,n.animationProgress||0,T,n.gender,n.age,[n.direction.x,n.direction.y],n.isPregnant??!1,n.hunger),d&&(e.save(),e.strokeStyle=Cv,e.lineWidth=2,e.beginPath(),e.arc(S.x,S.y,w+3,0,2*Math.PI),e.stroke(),e.restore());let C,F;if(u?(C=Bw,F=Ev):r?(C=Lw,F=jf):l?(C=Hw,F=Fw):o?(C=bw,F=Iv):a&&(C=Gw,F=wv),C&&F&&gP(e,S,w,C,F),n.tribeBadge&&hP(e,S,n.tribeBadge,n.isAdult??!1,C??0),h){let D=(n.isAdult?Et:Fo)+5;C&&(D+=C),n.tribeBadge&&(D+=mf),mP(e,S,D)}const B=g&&(y===void 0||n.id===y);B&&n.aiBlackboard&&ah(e,n,m),pP(e,n,m),B&&fP(e,n)}const yP={grazing:"eat",moving:"walk",procreating:"procreate",feeding:"eat",idle:"idle"};function SP(e,n){var d;const{radius:r,position:o,activeAction:l="idle"}=n,a=((d=n.stateMachine)==null?void 0:d[0])||"N/A",u=n.isAdult?Et+20:Et*.6+20;e.save(),e.fillStyle="white",e.font="10px Arial",e.textAlign="center",e.fillText(`Action: ${l}`,o.x,o.y-u),e.fillText(`State: ${a}`,o.x,o.y-u+10),e.fillText(`HP: ${n.hitpoints}`,o.x,o.y-u+20),e.fillText(`Hunger: ${Math.round(n.hunger)}`,o.x,o.y-u+30),e.fillText(`Age: ${Math.round(n.age)}`,o.x,o.y-u+40),e.restore(),e.beginPath(),e.arc(o.x,o.y,r,0,Math.PI*2),e.strokeStyle="rgba(0, 255, 0, 0.5)",e.lineWidth=1,e.stroke(),e.closePath()}function AP(e,n,r=!1,o=0,l){var m,y;const{position:a,activeAction:u="idle"}=n,d=n.isAdult?n.radius:n.radius*.6,h=yP[u]||"idle";if(fy.render(e,a.x-d,a.y-d,d*2,d*2,n.animationProgress||0,h,{gender:n.gender,age:n.age,direction:[((m=n.direction)==null?void 0:m.x)||1,((y=n.direction)==null?void 0:y.y)||0],isPregnant:n.isPregnant??!1,hungryLevel:n.hunger,geneCode:n.geneCode}),n.hitpoints<n.maxHitpoints){const S=d*1.5,E=3,w=a.x-S/2,T=a.y-d-8;e.fillStyle="#555",e.fillRect(w,T,S,E);const C=n.hitpoints/n.maxHitpoints;e.fillStyle=C>.5?"#4CAF50":C>.25?"#FFC107":"#F44336",e.fillRect(w,T,S*C,E)}const g=r&&(l===void 0||n.id===l);g&&n.aiBlackboard&&ah(e,n,o),g&&SP(e,n)}const TP={attacking:"attacking",eating:"eat",moving:"walk",procreating:"procreate",feeding:"eat",idle:"idle"};function IP(e,n){var d;const{radius:r,position:o,activeAction:l="idle"}=n,a=((d=n.stateMachine)==null?void 0:d[0])||"N/A",u=n.isAdult?Et+20:Et*.6+20;e.save(),e.fillStyle="white",e.font="10px Arial",e.textAlign="center",e.fillText(`Action: ${l}`,o.x,o.y-u),e.fillText(`State: ${a}`,o.x,o.y-u+10),e.fillText(`HP: ${n.hitpoints}`,o.x,o.y-u+20),e.fillText(`Hunger: ${Math.round(n.hunger)}`,o.x,o.y-u+30),e.fillText(`Age: ${Math.round(n.age)}`,o.x,o.y-u+40),e.restore(),e.beginPath(),e.arc(o.x,o.y,r,0,Math.PI*2),e.strokeStyle="rgba(255, 0, 0, 0.5)",e.lineWidth=1,e.stroke(),e.closePath()}function wP(e,n,r=!1,o=0,l){var m,y;const{position:a,activeAction:u="idle"}=n,d=n.isAdult?n.radius:n.radius*.6,h=TP[u]||"idle";if(hy.render(e,a.x-d,a.y-d,d*2,d*2,n.animationProgress||0,h,{gender:n.gender,age:n.age,direction:[((m=n.direction)==null?void 0:m.x)||1,((y=n.direction)==null?void 0:y.y)||0],isPregnant:n.isPregnant??!1,hungryLevel:n.hunger,geneCode:n.geneCode}),n.hitpoints<n.maxHitpoints){const S=d*1.5,E=3,w=a.x-S/2,T=a.y-d-8;e.fillStyle="#555",e.fillRect(w,T,S,E);const C=n.hitpoints/n.maxHitpoints;e.fillStyle=C>.5?"#4CAF50":C>.25?"#FFC107":"#F44336",e.fillRect(w,T,S*C,E)}(n.attackCooldown&&n.attackCooldown>0||n.huntCooldown&&n.huntCooldown>0)&&(e.strokeStyle="#FF8C00",e.lineWidth=3,e.beginPath(),e.arc(a.x,a.y,d+3,0,2*Math.PI),e.stroke());const g=r&&(l===void 0||n.id===l);g&&n.aiBlackboard&&ah(e,n,o),g&&IP(e,n)}const gy=15;function g0(e,n,r,o,l=1.5){const a=r-n.startTime,u=Math.min(a/n.duration,1),d=1-u,g=1+Math.sin(u*Math.PI*2)*(l-1),m=gy*g;e.save(),e.globalAlpha=d,e.beginPath(),e.arc(n.position.x,n.position.y,Math.max(0,m),0,Math.PI*2),e.fillStyle=o,e.fill(),e.restore()}function uo(e,n,r,o,l=2){const a=r-n.startTime,u=Math.min(a/n.duration,1),d=1-u,h=gy*2*u;e.save(),e.globalAlpha=d,e.beginPath(),e.arc(n.position.x,n.position.y,h,0,Math.PI*2),e.strokeStyle=o,e.lineWidth=l,e.stroke(),e.restore()}function Hi(e,n,r,o){const l=r-n.startTime,a=Math.min(l/n.duration,1),u=1-a,d=-20*a;e.save(),e.globalAlpha=u,e.font="20px Arial",e.textAlign="center",e.fillText(o,n.position.x,n.position.y+d),e.restore()}function EP(e,n,r){switch(n.type){case le.Hunger:g0(e,n,r,"rgba(255, 165, 0, 0.7)",1);break;case le.Procreation:Hi(e,n,r,"");break;case le.Pregnant:g0(e,n,r,"rgba(255, 105, 180, 0.7)",1.2);break;case le.TargetAcquired:uo(e,n,r,"rgba(255, 0, 0, 0.8)",3);break;case le.Attack:Hi(e,n,r,"");break;case le.Partnered:Hi(e,n,r,"");break;case le.BushClaimed:uo(e,n,r,"rgba(0, 255, 0, 0.7)",2);break;case le.BushClaimLost:uo(e,n,r,"rgba(128, 128, 128, 0.7)",2);break;case le.Eating:Hi(e,n,r,"");break;case le.ChildFed:Hi(e,n,r,"");break;case le.AttackDeflected:Hi(e,n,r,"");break;case le.AttackResisted:Hi(e,n,r,"");break;case le.Hit:Hi(e,n,r,"");break;case le.SeizeBuildup:uo(e,n,r,"rgba(255, 215, 0, 0.8)",4);break;case le.Seize:uo(e,n,r,"rgba(148, 0, 211, 0.8)",4);break;case le.CallToAttack:uo(e,n,r,"rgba(255, 255, 0, 0.8)",4);break}}function p0(e,n,r,o,l,a,u){e.save();const{position:d}=n;e.strokeStyle=o,e.lineWidth=l+Math.sin(u*a)*(l/2),e.setLineDash([8,8]),e.beginPath(),e.arc(d.x,d.y,r,0,2*Math.PI),e.stroke(),e.restore()}const m0=8,CP=1.5,_P=.5,v0=2,RP="#5a5a5a",PP="#7e7e7e";function Kd(e){const n=Math.sin(e)*1e4;return n-Math.floor(n)}function py(e,n,r,o,l){const a=(n+r)*2,u=Math.floor(a/m0),d=-n/2,h=n/2,g=-r/2,m=r/2;for(let y=0;y<u;y++){const S=o+y*13,E=Kd(S),w=Kd(S+1);let T=y*m0,C=0,F=0;T<n?(C=d+T,F=g):T<n+r?(C=h,F=g+(T-n)):T<n*2+r?(C=h-(T-(n+r)),F=m):(C=d,F=m-(T-(n*2+r)));const B=(w-.5)*v0,D=(Kd(S+2)-.5)*v0;e.beginPath();const H=CP+E*_P;e.fillStyle=l||(E>.5?PP:RP),e.ellipse(C+B,F+D,H,H*.85,w*Math.PI,0,Math.PI*2),e.fill(),l||(e.strokeStyle="#2b2b2b",e.lineWidth=1,e.stroke())}}function NP(e,n,r){const{position:o,width:l,height:a,constructionProgress:u,destructionProgress:d,isConstructed:h,isBeingDestroyed:g,id:m}=n,y=aa[n.buildingType];e.save(),e.translate(o.x,o.y),h||(e.globalAlpha=.3+u*.7),py(e,l,a,m),e.globalAlpha=.5,e.font=`${Math.min(l,a,30)*.5}px Arial`,e.textAlign="center",e.textBaseline="middle",e.shadowColor="rgba(0,0,0,0.5)",e.shadowBlur=4,e.fillStyle="#FFFFFF",e.fillText(y.icon,0,0),e.shadowBlur=0,e.restore();const S=l,E=o.x-S/2,w=o.y+a/2+Tw;if(h?g&&Vi(e,E,w,S,Mm,1-d,Wi,Aw):Vi(e,E,w,S,Mm,u,Wi,Sw),n.buildingType==="storageSpot"&&n.storedFood!==void 0){const T=`${n.storedFood.length}/${n.storageCapacity??0}`,C=o.y-a/2-20;e.save(),e.font="14px Arial",e.textAlign="center",e.textBaseline="middle",e.strokeStyle="rgba(0, 0, 0, 0.8)",e.lineWidth=3,e.strokeText(T,o.x,C),e.fillStyle="#FFFFFF",e.fillText(T,o.x,C),e.restore()}}function DP(e,n,r,o,l){const a=aa[r],{width:u,height:d}=a.dimensions,h=(m,y)=>{m.save(),m.translate(y.x,y.y),m.globalAlpha=yw;const S=o?"#4CAF50":"#F44336";py(m,u,d,9999,S),m.font=`${Math.min(u,d)*.5}px Arial`,m.textAlign="center",m.textBaseline="middle",m.fillStyle=S,m.fillText(a.icon,0,0),m.restore()},g={position:{...n},radius:Math.max(u,d)/2,id:0,type:"building",direction:{x:0,y:0},acceleration:0,forces:[],velocity:{x:0,y:0},debuffs:[]};sn(e,l.width,l.height,(m,y)=>h(m,y.position),g)}function OP(e,n,r,o,l){const a=wt(n),u=a?Nt(n,a):[],d=pi(u),{width:h,height:g}=n.mapDimensions;Object.values(n.entities.entities).sort((w,T)=>w.position.y-T.position.y||w.id-T.id||w.type==="building"?-1:1).filter(w=>Bl(w,o,l,n.mapDimensions)).forEach(w=>{var T,C;if(w.type==="building")sn(e,h,g,NP,w,n,a,n.time);else if(w.type==="berryBush")sn(e,h,g,XR,w,n,a,n.time);else if(w.type==="human"){const F=w,B=F.id===(a==null?void 0:a.id),D=u.some(_e=>_e.id===F.id),H=F.id===(d==null?void 0:d.id),x=a&&(F.id===a.motherId||F.id===a.fatherId),U=a&&(((T=F.partnerIds)==null?void 0:T.includes(a.id))||((C=a.partnerIds)==null?void 0:C.includes(F.id))),$=(a==null?void 0:a.attackTargetId)===F.id,J=F.leaderId?n.entities.entities[F.leaderId]:void 0,Ce=a?F.leaderId===a.id&&F.activeAction==="moving"&&F.target===F.leaderId&&(J==null?void 0:J.isCallingToFollow):!1;sn(e,h,g,vP,F,B,x,D,U,H,$,Ce,r,n.time,n.debugCharacterId)}else w.type==="corpse"?sn(e,h,g,JR,w):w.type==="prey"?sn(e,h,g,AP,w,r,n.time,n.debugCharacterId):w.type==="predator"&&sn(e,h,g,wP,w,r,n.time,n.debugCharacterId)}),n.visualEffects.filter(w=>Bl(w,o,l,n.mapDimensions)).forEach(w=>{sn(e,h,g,EP,w,n.time)});const E=n.notifications.filter(w=>!w.isDismissed);for(const w of E)if(w.highlightedEntityIds&&w.renderHighlights)for(const T of w.highlightedEntityIds){const C=n.entities.entities[T];C&&Bl(C,o,l,n.mapDimensions)&&sn(e,h,g,p0,C,HE,bE,xE,GE,n.time)}if(n.tutorialState.isActive&&n.tutorialState.highlightedEntityIds.length>0)for(const w of n.tutorialState.highlightedEntityIds){const T=n.entities.entities[w];T&&Bl(T,o,l,n.mapDimensions)&&sn(e,h,g,p0,T,CE,Fv,Uv,qf,n.time)}}function kP(e,n,r,o,l,a){let u=null,d=null;e.textAlign="left";let h=qe+mn;const m=n.time/(At/Tt)/mu%1,y=_s[co.Time],S=25,E=qe+S;e.fillText(y,qe,h+nn/2+mn/3),Vi(e,E,h,Li,nn,m,Wi,Vw),h+=nn+si;const w=h+gr/2,T=h+(gr-nn)/2,C=5;oa(e,{x:qe*2,y:w},gr,5,r.gender,!1,!1,!1);const F=qe+gr+C,B=Li+S-(gr+C)*2;Vi(e,F,T,B,nn,Math.floor(r.age)/qs,Wi,jw),oa(e,{x:F+B+C+gr/2,y:w},gr,qs,r.gender,!1,!1,!1),h+=nn+si*2;const D=[],H=new Set;if(D.push({member:r,isPlayer:!0,isHeir:!1,isPartner:!1,isParent:!1}),H.add(r.id),o&&!H.has(o.id)&&(D.push({member:o,isPlayer:!1,isHeir:!0,isPartner:!1,isParent:!1}),H.add(o.id)),l.forEach(de=>{H.has(de.id)||(D.push({member:de,isPlayer:!1,isHeir:!1,isPartner:!0,isParent:!1}),H.add(de.id))}),a.forEach(de=>{H.has(de.id)||(D.push({member:de,isPlayer:!1,isHeir:!1,isPartner:!1,isParent:!1}),H.add(de.id))}),r.motherId&&!H.has(r.motherId)){const de=n.entities.entities[r.motherId];de&&(D.push({member:de,isPlayer:!1,isHeir:!1,isPartner:!1,isParent:!0}),H.add(de.id))}if(r.fatherId&&!H.has(r.fatherId)){const de=n.entities.entities[r.fatherId];de&&(D.push({member:de,isPlayer:!1,isHeir:!1,isPartner:!1,isParent:!0}),H.add(de.id))}const x=_s[co.Family],U=10,$=qe+mn+U,J=Li+S-(mn+U),Ce=h+wl/2;e.font=`${mn}px "Press Start 2P", Arial`,e.textBaseline="middle",e.fillText(x,qe,Ce);const _e=h+wl/2;$R(e,$,_e,D,wl,J),h+=wl+si,e.textBaseline="alphabetic";const Ge=_s[co.Hitpoints];e.fillText(Ge,qe,h+nn/2+mn/3),Vi(e,E,h,Li,nn,r.hitpoints/r.maxHitpoints,Wi,Yw),h+=nn+si;const Ne=_s[co.Hunger];e.fillText(Ne,qe,h+nn/2+mn/3),Vi(e,E,h,Li,nn,(Nr-r.hunger)/Nr,Wi,Ww),u={x:qe,y:h-si/2,width:Li+S,height:nn+si},h+=nn+si,e.textBaseline="middle";const Pe=_s[co.Food];return e.fillText(Pe,qe,h+Il/2),eP(e,E,h+Il/2,r.food,Il,Li),d={x:qe,y:h-si/5,width:Li+S,height:Il+si},e.textBaseline="alphabetic",{hungerBarRect:u,foodBarRect:d}}let Os=[],y0=0;const MP=36,FP=200;function UP(e,n,r,o){const l=n.search.prey.count(),a=n.search.predator.count(),u=n.search.berryBush.count();n.time-y0>=MP&&(Os.push({time:n.time,prey:l,predators:a,bushes:u}),Os.length>FP&&(Os=Os.slice(-200)),y0=n.time);const d=et*tt,h=l/d*1e6,g=a/d*1e6,m=u/d*1e6,y=CR(),S=Math.floor(n.time/(24*365)),E=Math.floor(n.time%(24*365)/24),w=Math.floor(n.time%24),T=400,C=Math.min(o*.8,600),F=r-T-10,B=qe+mn*2;e.save(),e.fillStyle="rgba(0, 0, 0, 0.9)",e.fillRect(F,B,T,C),e.strokeStyle="#444",e.lineWidth=2,e.strokeRect(F,B,T,C),e.fillStyle="white",e.font="12px monospace",e.textAlign="left";let D=B+20;const H=14,x=F+15;e.fillStyle="#66ccff",e.font="bold 14px monospace",e.fillText(" Ecosystem Debugger",x,D),D+=25,e.fillStyle="white",e.font="12px monospace",e.fillText(`Game Time: Year ${S}, Day ${E}, Hour ${w}`,x,D),D+=H,e.fillText(`Map Size: ${et}  ${tt} pixels`,x,D),D+=20,e.fillStyle="#66ccff",e.font="bold 13px monospace",e.fillText(" Q-Learning Status",x,D),D+=18,y&&(e.fillText(`Q-Table Size: ${y.qTableSize} entries`,x,D),D+=H,e.fillText(`Exploration Rate: ${(y.explorationRate*100).toFixed(1)}%`,x,D),D+=H);const U=Os.slice(-20);U.length>1&&(e.fillStyle="#66ccff",e.font="bold 13px monospace",e.fillText(" Population Trends (Last 20 Points)",x,D),D+=30,LP(e,x,D,U),D+=50),e.fillStyle="#66ccff",e.font="bold 13px monospace",e.fillText(" Density (per 1000 px)",x,D),D+=18,e.fillStyle="white",e.font="12px monospace";const $=(di/d*1e6).toFixed(2),J=(fi/d*1e6).toFixed(2),Ce=(hi/d*1e6).toFixed(2);e.fillText(`Prey: ${h.toFixed(2)} (target: ${$})`,x,D),D+=H,e.fillText(`Predators: ${g.toFixed(2)} (target: ${J})`,x,D),D+=H,e.fillText(`Bushes: ${m.toFixed(2)} (target: ${Ce})`,x,D),D+=20,e.fillStyle="#66ccff",e.font="bold 13px monospace",e.fillText(" Current Population Status",x,D),D+=18,e.fillStyle="white",e.font="12px monospace";const _e=Math.round(l/di*100),Ge=Math.round(a/fi*100),Ne=Math.round(u/hi*100),Pe=de=>de<50?"#ff4444":de<80?"#ffaa44":de>120?"#44aaff":"#44ff44";e.fillStyle=Pe(_e),e.fillText(`Prey: ${l}/${di} (${_e}%)`,x,D),D+=H,e.fillStyle=Pe(Ge),e.fillText(`Predators: ${a}/${fi} (${Ge}%)`,x,D),D+=H,e.fillStyle=Pe(Ne),e.fillText(`Bushes: ${u}/${hi} (${Ne}%)`,x,D),D+=20,e.fillStyle="#66ccff",e.font="bold 13px monospace",e.fillText(" Current Parameters",x,D),D+=18,e.fillStyle="white",e.font="10px monospace",e.fillText("Prey:",x,D),D+=13,e.fillText(` Gestation: ${n.ecosystem.preyGestationPeriod.toFixed(1)}h`,x,D),D+=11,e.fillText(` Procreation: ${n.ecosystem.preyProcreationCooldown.toFixed(1)}h`,x,D),D+=11,e.fillText(` Hunger: ${n.ecosystem.preyHungerIncreasePerHour.toFixed(1)}/h`,x,D),D+=13,e.fillText("Predators:",x,D),D+=13,e.fillText(` Gestation: ${n.ecosystem.predatorGestationPeriod.toFixed(1)}h`,x,D),D+=11,e.fillText(` Procreation: ${n.ecosystem.predatorProcreationCooldown.toFixed(1)}h`,x,D),D+=11,e.fillText(` Hunger: ${n.ecosystem.predatorHungerIncreasePerHour.toFixed(1)}/h`,x,D),D+=13,e.fillText("Bushes:",x,D),D+=13,e.fillText(` Spread Chance: ${(n.ecosystem.berryBushSpreadChance*100).toFixed(1)}%`,x,D),D+=15,e.fillStyle="#888",e.font="10px monospace",e.textAlign="center",e.fillText("Press '1' to toggle this debugger",F+T/2,B+C-10),e.restore()}function LP(e,n,r,o){if(o.length<2)return;const d={prey:Math.max(...o.map(g=>g.prey),di),predators:Math.max(...o.map(g=>g.predators),fi),bushes:Math.max(...o.map(g=>g.bushes),hi)};[{data:o.map(g=>g.prey),color:"#44ff44",label:"Prey",target:di,max:d.prey},{data:o.map(g=>g.predators),color:"#ff4444",label:"Predators",target:fi,max:d.predators},{data:o.map(g=>g.bushes),color:"#ffaa44",label:"Bushes",target:hi,max:d.bushes}].forEach((g,m)=>{const y=n+m*115,S=r;e.fillStyle=g.color,e.font="10px monospace",e.fillText(g.label,y,S-5),e.strokeStyle="#333",e.lineWidth=1,e.strokeRect(y,S,100,30),e.beginPath(),e.strokeStyle=g.color;for(let w=0;w<g.data.length;w++){const T=y+w/(g.data.length-1)*100,C=S+30-g.data[w]/g.max*30;w===0?e.moveTo(T,C):e.lineTo(T,C)}e.stroke(),e.beginPath(),e.strokeStyle="#888",e.setLineDash([2,2]);const E=S+30-g.target/g.max*30;e.moveTo(y,E),e.lineTo(y+100,E),e.stroke(),e.setLineDash([])})}function S0(e,n,r){e.save();const{x:o,y:l,width:a,height:u}=n.rect,d=Rv;if(e.beginPath(),e.moveTo(o+d,l),e.lineTo(o+a-d,l),e.quadraticCurveTo(o+a,l,o+a,l+d),e.lineTo(o+a,l+u-d),e.quadraticCurveTo(o+a,l+u,o+a-d,l+u),e.lineTo(o+d,l+u),e.quadraticCurveTo(o,l+u,o,l+u-d),e.lineTo(o,l+d),e.quadraticCurveTo(o,l,o+d,l),e.closePath(),e.fillStyle=n.isDisabled?Pv:n.backgroundColor,e.fill(),n.activated){e.save();const h=(Math.sin(Date.now()/1e3*kv)+1)/2;e.strokeStyle=Ov,e.lineWidth=2+h*2,e.globalAlpha=.7+h*.3,e.stroke(),e.restore()}if(n.lastActivated){const h=Date.now()-n.lastActivated;if(h<iu){const g=1-h/iu;e.fillStyle=Dv,e.globalAlpha=g,e.fill(),e.globalAlpha=1}}r&&!n.isDisabled&&(e.fillStyle=Kf,e.globalAlpha=.5,e.fill(),e.globalAlpha=1),e.fillStyle=n.isDisabled?Nv:n.textColor,n.icon?(e.font=`${u*.55}px "Press Start 2P", Arial`,e.textAlign="center",e.textBaseline="middle",e.fillText(n.icon,o+a/2,l+u/2),n.text&&(e.font=`${u*.18}px "Press Start 2P", Arial`,e.textAlign="right",e.textBaseline="bottom",e.fillText(n.text,o+a-4,l+u-2))):(e.font=`${mn*1.5}px "Press Start 2P", Arial`,e.textAlign="center",e.textBaseline="middle",e.fillText(n.text,o+a/2,l+u/2)),e.restore()}function BP(e,n,r,o){e.save(),e.fillStyle="rgba(0, 0, 0, 0.6)",e.fillRect(0,0,r,o);const l=500,a=150,u=(r-l)/2,d=(o-a)/2;e.fillStyle=vn,e.font=`${mn*1.1}px "Press Start 2P", Arial`,e.textAlign="center",e.textBaseline="middle",e.fillText("Are you sure you want to exit",r/2,d+a/3-10),e.fillText("to the main menu?",r/2,d+a/3+10);const h=ci*1.5,g=_v,m=d+a-g-qe*2,y=20,S=h*2+y,E=u+(l-S)/2,w={id:"confirmExitYes",action:ge.ConfirmExitYes,rect:{x:E,y:m,width:h,height:g},text:"Yes",backgroundColor:$i,textColor:vn,currentWidth:h},T=E+h+y,C={id:"confirmExitNo",action:ge.ConfirmExitNo,rect:{x:T,y:m,width:h,height:g},text:"No",backgroundColor:$i,textColor:vn,currentWidth:h};n.uiButtons.push(w,C),S0(e,w,n.hoveredButtonId===w.id),S0(e,C,n.hoveredButtonId===C.id),e.restore()}function lu(e,n,r,o,l,a=!1){var h;if(e.save(),e.clearRect(0,0,e.canvas.width,e.canvas.height),e.fillStyle="#2c5234",e.fillRect(0,0,e.canvas.width,e.canvas.height),e.translate(e.canvas.width/2-r.x,e.canvas.height/2-r.y),!a&&n.gameOver){e.restore(),jR(e,n);return}OP(e,n,n.debugPanel===Rt.General,r,l);const u=wt(n);if(u&&n.selectedBuildingType&&n.selectedBuildingType!=="removal"&&n.mousePosition){const g=If(n.mousePosition,r,l,n.mapDimensions),m=zv(g,n.selectedBuildingType,u.leaderId,n);DP(e,g,n.selectedBuildingType,m,n.mapDimensions)}const d=n.notifications.filter(g=>!g.isDismissed);for(const g of d){const m=(Math.sin(n.time*UE)+1)/2;e.globalAlpha=m*.5+.25,e.fillStyle=FE,g.targetArea&&e.fillRect(g.targetArea.x,g.targetArea.y,g.targetArea.width,g.targetArea.height),g.targetRadius&&(e.beginPath(),e.arc(g.targetRadius.x,g.targetRadius.y,g.targetRadius.radius,0,Math.PI*2),e.fill())}if(e.globalAlpha=1,rP(e,n),e.restore(),!a){e.fillStyle=xw,e.font=`${mn}px "Press Start 2P", Arial`,e.shadowColor=$w,e.shadowBlur=zw,n.uiButtons=[];let g=null,m=null;if(u){const E=Nt(n,u),w=pi(E),T=((h=u.partnerIds)==null?void 0:h.map(F=>n.entities.entities[F]).filter(F=>F!==void 0))||[],C=kP(e,n,u,w,T,E);g=C.hungerBarRect,m=C.foodBarRect}const y=mv(n,u==null?void 0:u.leaderId);zR(e,n,y,e.canvas.width,e.canvas.height);const{commandButtonsRect:S}=DR(e,n,e.canvas.width);if(e.shadowColor="transparent",e.shadowBlur=0,u&&(tP(e,n,r,e.canvas.width,e.canvas.height),o.length>0&&FR(e,o,u,r,e.canvas.width,e.canvas.height,n.mapDimensions)),n.tutorialState.activeUIHighlights.length>0){const{activeUIHighlights:E}=n.tutorialState;E.includes(Pr.HUNGER_BAR)&&g&&Yd(e,g,n.time),E.includes(Pr.FOOD_BAR)&&m&&Yd(e,m,n.time),E.includes(Pr.COMMAND_BUTTONS)&&S&&Yd(e,S,n.time)}if(n.tutorialState.isActive){const E=YR(e,n,e.canvas.width,e.canvas.height);E&&n.uiButtons.push({id:"tutorial-dismiss",action:ge.DismissTutorial,rect:E,text:"",currentWidth:E.width,backgroundColor:"transparent",textColor:"transparent"})}switch(sP(e,n,e.canvas.width,e.canvas.height),n.debugPanel){case Rt.Ecosystem:UP(e,n,e.canvas.width,e.canvas.height);break;case Rt.Performance:lP(e,n,l.width);break}n.isPaused&&n.exitConfirmation!=="pending"&&OR(e),n.exitConfirmation==="pending"&&BP(e,n,e.canvas.width,e.canvas.height)}}const HP=An.div`
  position: relative;
  width: 100vw;
  height: 100vh;
  overflow: hidden;
`,bP=An.canvas`
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background-color: #2c5234;
`,GP=An.div`
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  text-align: center;
  z-index: 1;
  background: linear-gradient(to bottom, rgba(0, 0, 0, 0.7) 0%, rgba(0, 0, 0, 0) 50%, rgba(0, 0, 0, 0.7) 100%);
`,xP=An.h1`
  font-family: 'Press Start 2P', cursive;
  font-size: 4rem;
  color: #fff;
  text-shadow: 4px 4px 0px #ff0000;
  margin-bottom: 2rem;
`,A0=An.button`
  font-family: 'Press Start 2P', cursive;
  font-size: 1.5rem;
  padding: 1rem 2rem;
  color: #fff;
  background-color: #ff0000;
  border: 2px solid #fff;
  box-shadow: 4px 4px 0px #fff;
  cursor: pointer;
  transition: all 0.2s ease-in-out;

  &:hover {
    background-color: #fff;
    color: #ff0000;
    box-shadow: 4px 4px 0px #ff0000;
  }
`,$P=An.div`
  display: flex;
  flex-direction: column;
  gap: 1.5rem;
  align-items: center;
`,zP=An.div`
  position: absolute;
  bottom: 1rem;
  font-family: 'Press Start 2P', cursive;
  font-size: 0.8rem;
  color: #fff;
  text-shadow: 2px 2px 0px #000;
  a {
    color: #fff;
    text-decoration: none;
    &:hover {
      text-decoration: underline;
    }
  }
`,Gl="intro-soundtrack",T0=()=>{const{setAppState:e,savedGameState:n,clearCurrentSave:r}=ko(),o=Re.useRef(null),l=Re.useRef(null),a=Re.useRef(U1()),u=Re.useRef(),d=Re.useRef(a.current.viewportCenter),h=Re.useRef(),g=Re.useCallback(()=>{Od(Gl,2),r(),e("game")},[e,r]),m=Re.useCallback(()=>{n&&(Od(Gl,2),e("game"))},[e,n]);Re.useEffect(()=>{const E=w=>{(w.key==="Enter"||w.key===" ")&&(n?m():g())};return window.addEventListener("keydown",E),()=>{window.removeEventListener("keydown",E)}},[g,m,n]),Re.useEffect(()=>(Qf(fe.SoundTrack1,{loop:!0,trackId:Gl}),()=>{Od(Gl,2)}),[]),Re.useEffect(()=>{const E=o.current;if(!E)return;l.current=E.getContext("2d");const w=()=>{E&&l.current&&(E.width=window.innerWidth,E.height=window.innerHeight,lu(l.current,a.current,d.current,[],{width:E.width,height:E.height},!0))};return w(),window.addEventListener("resize",w),()=>window.removeEventListener("resize",w)},[]),Re.useEffect(()=>{const E=()=>{const T=pw(a.current);if(T.length>0){const C=Math.floor(Math.random()*T.length);h.current=T[C].id}};E();const w=setInterval(E,xT);return()=>clearInterval(w)},[]);const[y,S]=Q0(E=>{var C,F;if(!l.current)return;if(u.current===void 0){u.current=E;return}const w=Math.min((E-u.current)/1e3,1);a.current=Tu(a.current,w);const T=h.current?a.current.entities.entities[h.current]:void 0;if(T){const{mapDimensions:B}=a.current,{width:D,height:H}=B;let x={...T.position};const U=x.x-d.current.x;Math.abs(U)>D/2&&(U>0?x.x-=D:x.x+=D);const $=x.y-d.current.y;Math.abs($)>H/2&&($>0?x.y-=H:x.y+=H);let J=$f(d.current,x,Uf*w);J={x:(J.x%D+D)%D,y:(J.y%H+H)%H},d.current=J}lu(l.current,a.current,d.current,[],{width:((C=o.current)==null?void 0:C.width)||800,height:((F=o.current)==null?void 0:F.height)||600},!0),u.current=E});return Re.useEffect(()=>(S(),y),[S,y]),Fe.jsxs(HP,{children:[Fe.jsx(bP,{ref:o}),Fe.jsxs(GP,{children:[Fe.jsx(xP,{children:"Tribe2"}),Fe.jsxs($P,{children:[Fe.jsx(A0,{onClick:g,children:"New Game"}),n&&Fe.jsx(A0,{onClick:m,children:"Load Game"})]}),Fe.jsxs(zP,{children:["by"," ",Fe.jsx("a",{href:"https://github.com/gtanczyk",target:"_blank",rel:"noopener noreferrer",children:"gtanczyk"})]})]})]})};function WP(){console.log("Tribe game initialized with detailed 2D world state.");const e=F1();return e.ecosystem={preyGestationPeriod:wr,preyProcreationCooldown:Er,predatorGestationPeriod:Cr,predatorProcreationCooldown:_r,preyHungerIncreasePerHour:Yi,predatorHungerIncreasePerHour:ji,berryBushSpreadChance:gi},e.debugPanel=Rt.None,e.performanceMetrics={currentBucket:{renderTime:0,worldUpdateTime:0,aiUpdateTime:0},history:[]},e}const YP=({canvasRef:e,ctxRef:n,gameStateRef:r,viewportCenterRef:o,playerActionHintsRef:l})=>(Re.useEffect(()=>{const a=e.current;if(!a)return;n.current=a.getContext("2d");const u=()=>{a&&n.current&&r.current&&(a.width=window.innerWidth,a.height=window.innerHeight,lu(n.current,r.current,o.current,l.current,{width:a.width,height:a.height},!1))};return u(),window.addEventListener("resize",u),()=>window.removeEventListener("resize",u)},[]),Fe.jsx("canvas",{ref:e,style:{display:"block",background:"#2c5234"}})),jP=(e,n,r)=>{let o;const l=mw(e,r);if(l){if(n.isAdult&&l.type==="berryBush"&&l.food.length>0)o={action:ce.AutopilotGather,targetEntityId:l.id};else if(n.isAdult&&l.type==="corpse"&&l.food.length>0)o={action:ce.AutopilotGather,targetEntityId:l.id};else if(l.type==="human"){const a=l;n.isAdult&&Uo(n,a,r)?o={action:ce.AutopilotAttack,targetEntityId:a.id}:Mr(n,a,r)?o={action:ce.AutopilotProcreate,targetEntityId:a.id}:n.food.length>0&&!a.isAdult&&(a.motherId===n.id||a.fatherId===n.id)&&(o={action:ce.AutopilotFeedChild,targetEntityId:a.id})}else if(l.type==="prey")o={action:ce.AutopilotAttack,targetEntityId:l.id};else if(l.type==="predator")o={action:ce.AutopilotAttack,targetEntityId:l.id};else if(l.type==="building"){const a=l;r.selectedBuildingType==="removal"?o={action:ce.Removal,position:l.position}:a.buildingType==="storageSpot"?a.ownerId===n.leaderId&&a.isConstructed?n.food.length>0&&a.storedFood!==void 0&&a.storageCapacity!==void 0&&a.storedFood.length<a.storageCapacity?o={action:ce.AutopilotDeposit,targetEntityId:l.id}:n.food.length<n.maxFood&&a.storedFood!==void 0&&a.storedFood.length>0?o={action:ce.AutopilotRetrieve,targetEntityId:l.id}:o={action:ce.AutopilotMove,position:e}:o={action:ce.AutopilotMove,position:e}:a.buildingType==="plantingZone"&&n.food.filter(u=>u.type===qn.Berry).length>=_o&&!kn(e,r,Zi)?o={action:ce.AutopilotPlant,position:e}:o={action:ce.AutopilotMove,position:e}}}else n.food.filter(a=>a.type===qn.Berry).length>=_o&&(r.autopilotControls.isManuallyPlanting||vw(e,n,r))?o={action:ce.AutopilotPlant,position:e}:o={action:ce.AutopilotMove,position:e};return o},VP=(e,n)=>{if(e.isPaused)return;const r=wt(e);if(!r)return;if(e.selectedBuildingType&&e.selectedBuildingType!=="removal"){zv(n,e.selectedBuildingType,r.leaderId,e)&&(pC(n,e.selectedBuildingType,r.leaderId,e),e.selectedBuildingType=null);return}if(e.selectedBuildingType==="removal"){const l=vC(n,e);l&&mC(l.id,e);return}const o=e.autopilotControls.hoveredAutopilotAction;e.autopilotControls.activeAutopilotAction=void 0,o?(e.autopilotControls.activeAutopilotAction=o,(o.action===ce.AutopilotMove||o.action===ce.AutopilotGather)&&(e.hasPlayerMovedEver=!0),o.action===ce.AutopilotPlant&&(e.hasPlayerPlantedBush=!0)):e.autopilotControls.activeAutopilotAction={action:ce.AutopilotMove,position:n},e.autopilotControls.isManuallyMoving=!1,e.autopilotControls.isManuallyPlanting=!1},XP=(e,n)=>{var u,d,h,g;const r=e.key.toLowerCase(),o=e.ctrlKey||e.metaKey;let l=!0,a=n;if(o){switch(r){case"s":Rf(n);break;default:l=!1;break}return{newState:a,handled:l}}switch(r){case"escape":const{autopilotControls:m}=n;m.activeAutopilotAction||m.isManuallyMoving||m.isManuallyPlanting||n.buildMenuOpen||n.selectedBuildingType?(m.activeAutopilotAction=void 0,m.isManuallyMoving=!1,m.isManuallyPlanting=!1,n.buildMenuOpen=!1,n.selectedBuildingType=null):a.exitConfirmation==="pending"?(a.exitConfirmation="inactive",a.isPaused=!1):(a.exitConfirmation="pending",a.isPaused=!0);break;case"m":n.isMuted=!n.isMuted,bs(n.masterVolume,n.isMuted);break;case"=":case"+":const y=Math.min(1,n.masterVolume+.1);n.masterVolume=parseFloat(y.toFixed(1)),bs(n.masterVolume,n.isMuted);break;case"-":const S=Math.max(0,n.masterVolume-.1);n.masterVolume=parseFloat(S.toFixed(1)),bs(n.masterVolume,n.isMuted);break;case"t":a=Tu(n,bv);break;case" ":case"p":n.isPaused=!n.isPaused;break;case"":case"`":a.debugPanel===Rt.General?(a.debugPanel=Rt.None,a.debugCharacterId=void 0):(a.debugPanel=Rt.General,a.debugCharacterId||(a.debugCharacterId=((u=wt(a))==null?void 0:u.id)??((d=Object.values(a.entities.entities).find(w=>w.type==="human"||w.type==="prey"||w.type==="predator"))==null?void 0:d.id)));break;case"!":if(e.shiftKey){if(a.debugPanel===Rt.Ecosystem){a.debugPanel=Rt.None;break}a.debugPanel=Rt.Ecosystem,a.debugCharacterId||(a.debugCharacterId=((h=wt(a))==null?void 0:h.id)??((g=Object.values(a.entities.entities).find(w=>w.type==="human"||w.type==="prey"||w.type==="predator"))==null?void 0:g.id))}else l=!1;break;case"@":if(e.shiftKey){if(a.debugPanel===Rt.Performance){a.debugPanel=Rt.None;break}a.debugPanel=Rt.Performance}else l=!1;break;case"tab":a.debugPanel=Rt.General;const E=Object.values(a.entities.entities).filter(w=>w.type==="human"||w.type==="prey"||w.type==="predator");if(E.length>0){const w=E.sort((B,D)=>{if(B.type==="human"&&B.isPlayer)return-1;if(D.type==="human"&&D.isPlayer)return 1;if(B.type!==D.type){const H={human:0,prey:1,predator:2},x=H[B.type]??999,U=H[D.type]??999;return x-U}return B.id-D.id}),T=a.debugCharacterId,F=((T?w.findIndex(B=>B.id===T):-1)+1)%w.length;a.debugCharacterId=w[F].id}else a.debugCharacterId=void 0;break;default:l=!1;break}return{newState:a,handled:l}},KP=(e,n,r,o,l)=>{const a={gameState:r};if(n&&["e","b","r","h"].includes(e)&&r.hasPlayerEnabledAutopilot++,r.buildMenuOpen){if(e==="1"){r.selectedBuildingType="storageSpot",Ie(a,fe.ButtonClick,o.position);return}else if(e==="2"){r.selectedBuildingType="plantingZone",Ie(a,fe.ButtonClick,o.position);return}else if(e==="3"){r.selectedBuildingType="removal",Ie(a,fe.ButtonClick,o.position);return}}if(e==="escape"&&r.selectedBuildingType){r.selectedBuildingType=null;return}if(e==="e"){if(n){r.autopilotControls.behaviors.gathering=!r.autopilotControls.behaviors.gathering;return}const u=De(o,r,"berryBush",It,g=>g.food.length>0&&o.food.length<o.maxFood),d=De(o,r,"corpse",It,g=>g.food.length>0&&o.food.length<o.maxFood);let h=null;u&&d?h=V(o.position,u.position,r.mapDimensions.width,r.mapDimensions.height)<=V(o.position,d.position,r.mapDimensions.width,r.mapDimensions.height)?u:d:h=u||d,h&&(o.activeAction="gathering",Ie(a,fe.Gather,o.position))}else if(e==="r"){if(n){r.autopilotControls.behaviors.procreation=!r.autopilotControls.behaviors.procreation;return}De(o,r,"human",It,d=>Mr(o,d,r))&&(o.activeAction="procreating",Ie(a,fe.Procreate,o.position))}else if(e==="f")o.food.length>0&&(o.activeAction="eating",Ie(a,fe.Eat,o.position));else if(e==="h"){if(n){r.autopilotControls.behaviors.feedChildren=!r.autopilotControls.behaviors.feedChildren;return}const u=l.find(d=>d.type===ce.FeedChild);u&&u.targetEntity&&(o.activeAction="feeding",o.target=u.targetEntity.id)}else if(e==="arrowup"||e==="w")o.direction.y=-1,o.activeAction="moving",o.target=void 0,r.hasPlayerMovedEver=!0,r.autopilotControls.isManuallyMoving=!0,r.autopilotControls.activeAutopilotAction=void 0;else if(e==="arrowdown"||e==="s")o.direction.y=1,o.activeAction="moving",o.target=void 0,r.hasPlayerMovedEver=!0,r.autopilotControls.isManuallyMoving=!0,r.autopilotControls.activeAutopilotAction=void 0;else if(e==="arrowleft"||e==="a")o.direction.x=-1,o.activeAction="moving",o.target=void 0,r.hasPlayerMovedEver=!0,r.autopilotControls.isManuallyMoving=!0,r.autopilotControls.activeAutopilotAction=void 0;else if(e==="arrowright"||e==="d")o.direction.x=1,o.activeAction="moving",o.target=void 0,r.hasPlayerMovedEver=!0,r.autopilotControls.isManuallyMoving=!0,r.autopilotControls.activeAutopilotAction=void 0;else if(e==="q"){if(n){r.autopilotControls.behaviors.attack=!r.autopilotControls.behaviors.attack;return}const u=De(o,r,"human",Kn,d=>Uo(o,d,r))??De(o,r,"predator",Kn)??De(o,r,"prey",Kn);u&&(o.activeAction="attacking",o.attackTargetId=u.id)}else if(e==="b"){if(n){r.autopilotControls.behaviors.planting=!r.autopilotControls.behaviors.planting;return}if(l.find(d=>d.type===ce.Plant)){const d=yv(o.position,r,50,uf);d&&(o.activeAction="planting",o.target=d,r.hasPlayerPlantedBush=!0)}}else if(e==="x"){if(n){r.autopilotControls.behaviors.gathering=!r.autopilotControls.behaviors.gathering;return}const u=De(o,r,"building",Sn,d=>{const h=d;return h.buildingType==="storageSpot"&&h.ownerId===o.leaderId&&h.isConstructed&&h.storedFood!==void 0&&h.storageCapacity!==void 0&&h.storedFood.length<h.storageCapacity});u&&(o.activeAction="idle",o.target=u.id,Ie(a,fe.StorageDeposit,o.position))}else if(e==="z"){if(n){r.autopilotControls.behaviors.feedChildren=!r.autopilotControls.behaviors.feedChildren;return}const u=De(o,r,"building",Sn,d=>{const h=d;return h.buildingType==="storageSpot"&&h.ownerId===o.leaderId&&h.isConstructed&&h.storedFood!==void 0&&h.storedFood.length>0});u&&(o.activeAction="idle",o.target=u.id,Ie(a,fe.StorageRetrieve,o.position))}else e==="v"?(o.isCallingToAttack=!0,o.callToAttackEndTime=r.time+No,Oe(r,le.CallToAttack,o.position,No),Ie(a,fe.CallToAttack,o.position)):e==="c"?(o.isCallingToFollow=!0,o.callToFollowEndTime=r.time+Qs,Oe(r,le.CallToFollow,o.position,Qs),Ie(a,fe.CallToFollow,o.position)):e==="k"?eh(o,r):e==="l"&&(r.buildMenuOpen=!r.buildMenuOpen,Ie(a,fe.ButtonClick,o.position))},qP=(e,n,r,o)=>{e==="arrowup"||e==="w"||e==="arrowdown"||e==="s"?n.direction.y=0:(e==="arrowleft"||e==="a"||e==="arrowright"||e==="d")&&(n.direction.x=0),!o.current.has("arrowup")&&!o.current.has("arrowdown")&&!o.current.has("arrowleft")&&!o.current.has("arrowright")&&!o.current.has("w")&&!o.current.has("a")&&!o.current.has("s")&&!o.current.has("d")&&(n.activeAction==="moving"&&(n.activeAction="idle"),r.autopilotControls.isManuallyMoving=!1),!o.current.has("e")&&n.activeAction==="gathering"&&(n.activeAction="idle"),!o.current.has("f")&&n.activeAction==="eating"&&(n.activeAction="idle"),!o.current.has("r")&&n.activeAction==="procreating"&&(n.activeAction="idle"),!o.current.has("h")&&n.activeAction==="feeding"&&(n.activeAction="idle")},ZP=(e,n,r)=>{let l=wt(e);if(e.debugCharacterId){const a=e.entities.entities[e.debugCharacterId];a&&"position"in a&&(l=a)}if(l){const{mapDimensions:a}=e,{width:u,height:d}=a;let h={...l.position};const g=h.x-n.x;Math.abs(g)>u/2&&(g>0?h.x-=u:h.x+=u);const m=h.y-n.y;Math.abs(m)>d/2&&(m>0?h.y-=d:h.y+=d);let y=$f(n,h,Uf*r);return y={x:(y.x%u+u)%u,y:(y.y%d+d)%d},y}return e.viewportCenter};function QP(e,n){const{width:r,height:o}=e.mapDimensions;e.viewportCenter={x:(n.x%r+r)%r,y:(n.y%o+o)%o}}const JP=(e,n,r,o)=>{const l={gameState:r},a=wt(r);a&&Ie(l,fe.ButtonClick,a.position);const u=r.uiButtons.find(h=>h.id===e.id);u&&(u.lastActivated=Date.now()),n&&[ge.CommandGather,ge.CommandPlant,ge.ToggleProcreationBehavior].includes(e.action)&&r.hasPlayerEnabledAutopilot++;const{behaviors:d}=r.autopilotControls;switch(e.action){case ge.ReturnToIntro:r.exitConfirmation="pending",r.isPaused=!0;break;case ge.ConfirmExitYes:o(),r.exitConfirmation="inactive";break;case ge.ConfirmExitNo:r.exitConfirmation="inactive",r.isPaused=!1;break;case ge.ToggleMute:r.isMuted=!r.isMuted,bs(r.masterVolume,r.isMuted);break;case ge.TogglePause:r.isPaused=!r.isPaused;break;case ge.FastForward:return Tu(r,bv);case ge.DismissTutorial:r.tutorialState.isActive=!1;break;case ge.CommandEat:a&&a.food.length>0&&(a.activeAction="eating");break;case ge.CommandGather:n?d.gathering=!d.gathering:a&&(a.activeAction="gathering");break;case ge.CommandPlant:n?d.planting=!d.planting:a&&(r.autopilotControls.isManuallyPlanting=!0);break;case ge.ToggleProcreationBehavior:d.procreation=!d.procreation;break;case ge.ToggleAttackBehavior:d.attack=!d.attack;break;case ge.ToggleFeedChildBehavior:d.feedChildren=!d.feedChildren;break;case ge.ToggleAutopilotFollowLeaderBehavior:d.followLeader=!d.followLeader;break;case ge.CommandCallToAttack:a&&a.leaderId===a.id&&(a.isCallingToAttack=!0,a.callToAttackEndTime=r.time+No,Oe(r,le.CallToAttack,a.position,No),Ie(l,fe.CallToAttack,a.position));break;case ge.CommandFollowMe:n?d.followLeader=!d.followLeader:a&&a.leaderId===a.id&&(a.isCallingToFollow=!0,a.callToFollowEndTime=r.time+Qs,Oe(r,le.CallToFollow,a.position,Qs),Ie(l,fe.CallToFollow,a.position));break;case ge.CommandTribeSplit:a&&eh(a,r);break;case ge.CommandBuild:r.buildMenuOpen=!r.buildMenuOpen;break;case ge.SelectStorageSpot:r.selectedBuildingType="storageSpot";break;case ge.SelectPlantingZone:r.selectedBuildingType="plantingZone";break;case ge.SelectRemovalTool:r.selectedBuildingType="removal";break;case ge.ToggleDiplomacy:if(a&&a.leaderId&&e.targetTribeId){const h=a.leaderId,g=e.targetTribeId,m=r.entities.entities[g],y=a.diplomacy,S=m==null?void 0:m.diplomacy;if(y&&S){const w=(y[g]||St.Friendly)===St.Friendly?St.Hostile:St.Friendly;y[g]=w,S[h]=w}}break}return r};function eN(e,n,r){if(!e.notificationButtonRects)return!1;const o=wt(e);for(const[l,a]of Object.entries(e.notificationButtonRects.dismiss))if(n>=a.x&&n<=a.x+a.width&&r>=a.y&&r<=a.y+a.height)return qE(e,l),o&&Ie({gameState:e},fe.ButtonClick,o.position),!0;for(const[l,a]of Object.entries(e.notificationButtonRects.view))if(n>=a.x&&n<=a.x+a.width&&r>=a.y&&r<=a.y+a.height){const u=e.notifications.find(d=>d.id===l);if(u){let d=u.targetPosition;if(!d&&u.targetEntityIds&&u.targetEntityIds.length>0){const h=e.entities.entities[u.targetEntityIds[0]];h&&(d=h.position)}return d&&QP(e,d),o&&Ie({gameState:e},fe.ButtonClick,o.position),u.highlightedEntityIds&&(u.renderHighlights=!u.renderHighlights),!0}}return!1}const tN=({isActive:e,gameStateRef:n,canvasRef:r,viewportCenterRef:o,playerActionHintsRef:l,keysPressed:a,returnToIntro:u})=>(Re.useEffect(()=>{const d=h=>{if(!e()||n.current.gameOver||!r.current||!h.target||h.target!==r.current)return;const g=r.current.getBoundingClientRect(),m=h.clientX-g.left,y=h.clientY-g.top;if(eN(n.current,m,y))return;const E=n.current.uiButtons.find(T=>m>=T.rect.x&&m<=T.rect.x+T.rect.width&&y>=T.rect.y&&y<=T.rect.y+T.rect.height);if(E){n.current=JP(E,h.shiftKey,n.current,u);return}const w=If({x:m,y},o.current,{width:r.current.width,height:r.current.height},n.current.mapDimensions);VP(n.current,w)};return window.addEventListener("mousedown",d),()=>{window.removeEventListener("mousedown",d)}},[e,r,n,o,u]),Re.useEffect(()=>{const d=h=>{if(!e()||!r.current)return;const g=r.current.getBoundingClientRect(),m=h.clientX-g.left,y=h.clientY-g.top;n.current.mousePosition={x:m,y};let S;if(n.current.notificationButtonRects){for(const[w,T]of Object.entries(n.current.notificationButtonRects.dismiss))if(m>=T.x&&m<=T.x+T.width&&y>=T.y&&y<=T.y+T.height){S=`notification-dismiss-${w}`;break}if(!S){for(const[w,T]of Object.entries(n.current.notificationButtonRects.view))if(m>=T.x&&m<=T.x+T.width&&y>=T.y&&y<=T.y+T.height){S=`notification-view-${w}`;break}}}if(!S)for(let w=n.current.uiButtons.length-1;w>=0;w--){const T=n.current.uiButtons[w];if(m>=T.rect.x&&m<=T.rect.x+T.rect.width&&y>=T.rect.y&&y<=T.rect.y+T.rect.height){S=T.id;break}}if(n.current.hoveredButtonId=S,S){n.current.autopilotControls.hoveredAutopilotAction=void 0;return}const E=wt(n.current);if(E){const w=If({x:m,y},o.current,{width:r.current.width,height:r.current.height},n.current.mapDimensions);n.current.autopilotControls.hoveredAutopilotAction=jP(w,E,n.current)}else n.current.autopilotControls.hoveredAutopilotAction=void 0};return window.addEventListener("mousemove",d),()=>{window.removeEventListener("mousemove",d)}},[e,r,n,o]),Re.useEffect(()=>{const d=g=>{if(!e()||n.current.gameOver)return;const m=g.key.toLowerCase();(m===" "||m==="p"||m==="tab"||(g.ctrlKey||g.metaKey)&&(m==="s"||m==="a"))&&g.preventDefault();const y=XP(g,n.current);if(n.current=y.newState,y.handled)return;const S=wt(n.current);S&&(a.current.add(m),KP(m,g.shiftKey,n.current,S,l.current))},h=g=>{if(!e()||n.current.gameOver)return;const m=g.key.toLowerCase();a.current.delete(m);const y=wt(n.current);y&&qP(m,y,n.current,a)};return window.addEventListener("keydown",d),window.addEventListener("keyup",h),()=>{window.removeEventListener("keydown",d),window.removeEventListener("keyup",h)}},[e,n,l,a,u]),null),nN=({gameStateRef:e,ctxRef:n,debugPanelTypeRef:r,viewportCenterRef:o,playerActionHintsRef:l,keysPressed:a,canvasRef:u,setAppState:d,appState:h})=>{const g=Re.useRef(),{returnToIntro:m}=ko(),[y,S,E]=Q0(w=>{var H,x;if(!n.current||!g.current){g.current=w;return}const T=Math.min(w-g.current,1e3)/1e3,{performanceMetrics:C}=e.current;C.currentBucket={renderTime:0,worldUpdateTime:0,aiUpdateTime:0};const F=performance.now();e.current=Tu(e.current,T),C.currentBucket.worldUpdateTime=performance.now()-F;const B=wt(e.current);B?l.current=th(e.current,B):l.current=[],o.current=ZP(e.current,o.current,T);const D=performance.now();lu(n.current,e.current,o.current,l.current,{width:((H=u.current)==null?void 0:H.width)||800,height:((x=u.current)==null?void 0:x.height)||600},!1),C.currentBucket.renderTime=performance.now()-D,C.history.push({bucketTime:e.current.time,...C.currentBucket}),C.history.length>$T&&C.history.shift(),g.current=w,e.current.gameOver&&h!=="gameOver"&&(Qf(fe.GameOver,{masterVolume:e.current.masterVolume,isMuted:e.current.isMuted}),d("gameOver",{generations:e.current.generationCount,cause:e.current.causeOfGameOver||"Unknown"}))});return Re.useEffect(()=>(S(),y),[S,y]),Fe.jsx(tN,{isActive:E,gameStateRef:e,canvasRef:u,viewportCenterRef:o,playerActionHintsRef:l,debugPanelTypeRef:r,keysPressed:a,returnToIntro:m})},I0=()=>{const{savedGameState:e,contextReady:n}=ko(),[r,o]=Re.useState(null);return Re.useEffect(()=>{n&&(e?(console.log("Loading saved game state..."),o(e)):(console.log("Initializing new game state..."),o(WP())))},[n,e]),!n||!r?Fe.jsx("div",{children:"Loading..."}):Fe.jsx(iN,{initialState:r})},iN=({initialState:e})=>{const n=Re.useRef(null),r=Re.useRef(null),o=Re.useRef(e),l=Re.useRef(new Set),a=Re.useRef(e.debugPanel),u=Re.useRef(e.viewportCenter),d=Re.useRef([]),{appState:h,setAppState:g}=ko();return Fe.jsxs(Fe.Fragment,{children:[Fe.jsx(YP,{canvasRef:n,ctxRef:r,gameStateRef:o,debugPanelTypeRef:a,viewportCenterRef:u,playerActionHintsRef:d}),Fe.jsx(nN,{gameStateRef:o,ctxRef:r,debugPanelTypeRef:a,viewportCenterRef:u,playerActionHintsRef:d,keysPressed:l,canvasRef:n,setAppState:g,appState:h})]})},rN=An.div`
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  text-align: center;
  background-color: rgba(0, 0, 0, 0.75); // Semi-transparent overlay
  color: #fff;
  padding: 20px;
  z-index: 10; // Ensure it's on top
`,oN=An.h1`
  font-family: 'Press Start 2P', cursive;
  font-size: 4rem;
  color: #ff4136; // Red for emphasis
  text-shadow: 4px 4px 0px #000;
  margin-bottom: 1.5rem;
`,xl=An.p`
  font-family: 'Press Start 2P', cursive;
  font-size: 1.2rem;
  margin: 0.5em 0;
  color: #fff;
  text-shadow: 2px 2px 0px #000;
`,sN=An.button`
  font-family: 'Press Start 2P', cursive;
  font-size: 1rem;
  padding: 1rem 2rem;
  margin-top: 2em;
  color: #fff;
  background-color: #ff4136; // Red button
  border: 2px solid #fff;
  box-shadow: 4px 4px 0px #fff;
  cursor: pointer;
  transition: all 0.2s ease-in-out;
  text-transform: uppercase;

  &:hover {
    background-color: #fff;
    color: #ff4136;
    box-shadow: 4px 4px 0px #ff4136;
  }
`,aN=()=>{const{setAppState:e,gameOverDetails:n}=ko(),r=()=>{e("intro")};return Fe.jsxs(rN,{children:[Fe.jsx(oN,{children:"Game Over"}),Fe.jsx(xl,{children:"Your tribe's lineage has ended."}),n&&Fe.jsxs(Fe.Fragment,{children:[Fe.jsxs(xl,{children:["Generations Survived: ",n.generations]}),Fe.jsxs(xl,{children:["Cause of Extinction: ",n.cause]})]}),!n&&Fe.jsx(xl,{children:"Game details are unavailable."}),Fe.jsx(sN,{onClick:r,children:"Return to Menu"})]})},lN=UT`
  /* CSS Reset */
  *, *::before, *::after {
    box-sizing: border-box;
  }

  body {
    margin: 0;
    padding: 0;
    font-family: 'Press Start 2P', 'Arial', sans-serif;
    background-color: #121212;
    color: #f0f0f0;
    line-height: 1.6;
  }

  /* Additional global styles */
  h1, h2, h3, h4, h5, h6 {
    margin-top: 0;
  }

  button {
    cursor: pointer;
    font-family: inherit;
  }

  /* Prevent overflow issues */
  html, body {
    height: 100%;
    overflow-x: hidden;
  }

  /* Root element for React app */
  #root {
    height: 100%;
  }
`;function uN(e,n){Re.useEffect(()=>{const r=()=>{const o=document.location.hash==="#game"?"game":"intro";n(o)};return window.addEventListener("hashchange",r),r(),()=>{window.removeEventListener("hashchange",r)}},[]),Re.useEffect(()=>{e==="game"?document.location.hash="#game":e==="intro"&&(document.location.hash="")},[e])}const cN=()=>{const{appState:e,setAppState:n}=ko();uN(e,n);const r=()=>{switch(e){case"intro":return Fe.jsx(T0,{});case"game":return Fe.jsx(I0,{});case"gameOver":return Fe.jsxs(Fe.Fragment,{children:[Fe.jsx(I0,{}),Fe.jsx(aN,{})]});default:return Fe.jsx(T0,{})}};return Fe.jsxs(Fe.Fragment,{children:[Fe.jsx(lN,{}),r()]})},w0=document.getElementById("root");w0?uC().then(()=>{wA.createRoot(w0).render(Fe.jsx(Xn.StrictMode,{children:Fe.jsx(FA,{initialAppState:document.location.hash==="#game"?"game":"intro",children:Fe.jsx(cN,{})})}))}):console.error("Failed to find the root element");
