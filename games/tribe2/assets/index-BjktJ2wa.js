var GA=Object.defineProperty;var xA=(e,t,i)=>t in e?GA(e,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[t]=i;var Ne=(e,t,i)=>xA(e,typeof t!="symbol"?t+"":t,i);(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))o(a);new MutationObserver(a=>{for(const s of a)if(s.type==="childList")for(const u of s.addedNodes)u.tagName==="LINK"&&u.rel==="modulepreload"&&o(u)}).observe(document,{childList:!0,subtree:!0});function i(a){const s={};return a.integrity&&(s.integrity=a.integrity),a.referrerPolicy&&(s.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?s.credentials="include":a.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function o(a){if(a.ep)return;a.ep=!0;const s=i(a);fetch(a.href,s)}})();function q0(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var Ld={exports:{}},zs={},Ud={exports:{}},He={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var mm;function $A(){if(mm)return He;mm=1;var e=Symbol.for("react.element"),t=Symbol.for("react.portal"),i=Symbol.for("react.fragment"),o=Symbol.for("react.strict_mode"),a=Symbol.for("react.profiler"),s=Symbol.for("react.provider"),u=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),f=Symbol.for("react.suspense"),g=Symbol.for("react.memo"),m=Symbol.for("react.lazy"),v=Symbol.iterator;function T(P){return P===null||typeof P!="object"?null:(P=v&&P[v]||P["@@iterator"],typeof P=="function"?P:null)}var A={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},I=Object.assign,y={};function w(P,H,Z){this.props=P,this.context=H,this.refs=y,this.updater=Z||A}w.prototype.isReactComponent={},w.prototype.setState=function(P,H){if(typeof P!="object"&&typeof P!="function"&&P!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,P,H,"setState")},w.prototype.forceUpdate=function(P){this.updater.enqueueForceUpdate(this,P,"forceUpdate")};function M(){}M.prototype=w.prototype;function F(P,H,Z){this.props=P,this.context=H,this.refs=y,this.updater=Z||A}var N=F.prototype=new M;N.constructor=F,I(N,w.prototype),N.isPureReactComponent=!0;var b=Array.isArray,B=Object.prototype.hasOwnProperty,L={current:null},G={key:!0,ref:!0,__self:!0,__source:!0};function Q(P,H,Z){var ee,Ie={},se=null,Re=null;if(H!=null)for(ee in H.ref!==void 0&&(Re=H.ref),H.key!==void 0&&(se=""+H.key),H)B.call(H,ee)&&!G.hasOwnProperty(ee)&&(Ie[ee]=H[ee]);var Ce=arguments.length-2;if(Ce===1)Ie.children=Z;else if(1<Ce){for(var K=Array(Ce),ae=0;ae<Ce;ae++)K[ae]=arguments[ae+2];Ie.children=K}if(P&&P.defaultProps)for(ee in Ce=P.defaultProps,Ce)Ie[ee]===void 0&&(Ie[ee]=Ce[ee]);return{$$typeof:e,type:P,key:se,ref:Re,props:Ie,_owner:L.current}}function re(P,H){return{$$typeof:e,type:P.type,key:H,ref:P.ref,props:P.props,_owner:P._owner}}function ve(P){return typeof P=="object"&&P!==null&&P.$$typeof===e}function be(P){var H={"=":"=0",":":"=2"};return"$"+P.replace(/[=:]/g,function(Z){return H[Z]})}var De=/\/+/g;function Te(P,H){return typeof P=="object"&&P!==null&&P.key!=null?be(""+P.key):H.toString(36)}function de(P,H,Z,ee,Ie){var se=typeof P;(se==="undefined"||se==="boolean")&&(P=null);var Re=!1;if(P===null)Re=!0;else switch(se){case"string":case"number":Re=!0;break;case"object":switch(P.$$typeof){case e:case t:Re=!0}}if(Re)return Re=P,Ie=Ie(Re),P=ee===""?"."+Te(Re,0):ee,b(Ie)?(Z="",P!=null&&(Z=P.replace(De,"$&/")+"/"),de(Ie,H,Z,"",function(ae){return ae})):Ie!=null&&(ve(Ie)&&(Ie=re(Ie,Z+(!Ie.key||Re&&Re.key===Ie.key?"":(""+Ie.key).replace(De,"$&/")+"/")+P)),H.push(Ie)),1;if(Re=0,ee=ee===""?".":ee+":",b(P))for(var Ce=0;Ce<P.length;Ce++){se=P[Ce];var K=ee+Te(se,Ce);Re+=de(se,H,Z,K,Ie)}else if(K=T(P),typeof K=="function")for(P=K.call(P),Ce=0;!(se=P.next()).done;)se=se.value,K=ee+Te(se,Ce++),Re+=de(se,H,Z,K,Ie);else if(se==="object")throw H=String(P),Error("Objects are not valid as a React child (found: "+(H==="[object Object]"?"object with keys {"+Object.keys(P).join(", ")+"}":H)+"). If you meant to render a collection of children, use an array instead.");return Re}function Be(P,H,Z){if(P==null)return P;var ee=[],Ie=0;return de(P,ee,"","",function(se){return H.call(Z,se,Ie++)}),ee}function Ae(P){if(P._status===-1){var H=P._result;H=H(),H.then(function(Z){(P._status===0||P._status===-1)&&(P._status=1,P._result=Z)},function(Z){(P._status===0||P._status===-1)&&(P._status=2,P._result=Z)}),P._status===-1&&(P._status=0,P._result=H)}if(P._status===1)return P._result.default;throw P._result}var le={current:null},Y={transition:null},X={ReactCurrentDispatcher:le,ReactCurrentBatchConfig:Y,ReactCurrentOwner:L};function W(){throw Error("act(...) is not supported in production builds of React.")}return He.Children={map:Be,forEach:function(P,H,Z){Be(P,function(){H.apply(this,arguments)},Z)},count:function(P){var H=0;return Be(P,function(){H++}),H},toArray:function(P){return Be(P,function(H){return H})||[]},only:function(P){if(!ve(P))throw Error("React.Children.only expected to receive a single React element child.");return P}},He.Component=w,He.Fragment=i,He.Profiler=a,He.PureComponent=F,He.StrictMode=o,He.Suspense=f,He.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=X,He.act=W,He.cloneElement=function(P,H,Z){if(P==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+P+".");var ee=I({},P.props),Ie=P.key,se=P.ref,Re=P._owner;if(H!=null){if(H.ref!==void 0&&(se=H.ref,Re=L.current),H.key!==void 0&&(Ie=""+H.key),P.type&&P.type.defaultProps)var Ce=P.type.defaultProps;for(K in H)B.call(H,K)&&!G.hasOwnProperty(K)&&(ee[K]=H[K]===void 0&&Ce!==void 0?Ce[K]:H[K])}var K=arguments.length-2;if(K===1)ee.children=Z;else if(1<K){Ce=Array(K);for(var ae=0;ae<K;ae++)Ce[ae]=arguments[ae+2];ee.children=Ce}return{$$typeof:e,type:P.type,key:Ie,ref:se,props:ee,_owner:Re}},He.createContext=function(P){return P={$$typeof:u,_currentValue:P,_currentValue2:P,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},P.Provider={$$typeof:s,_context:P},P.Consumer=P},He.createElement=Q,He.createFactory=function(P){var H=Q.bind(null,P);return H.type=P,H},He.createRef=function(){return{current:null}},He.forwardRef=function(P){return{$$typeof:c,render:P}},He.isValidElement=ve,He.lazy=function(P){return{$$typeof:m,_payload:{_status:-1,_result:P},_init:Ae}},He.memo=function(P,H){return{$$typeof:g,type:P,compare:H===void 0?null:H}},He.startTransition=function(P){var H=Y.transition;Y.transition={};try{P()}finally{Y.transition=H}},He.unstable_act=W,He.useCallback=function(P,H){return le.current.useCallback(P,H)},He.useContext=function(P){return le.current.useContext(P)},He.useDebugValue=function(){},He.useDeferredValue=function(P){return le.current.useDeferredValue(P)},He.useEffect=function(P,H){return le.current.useEffect(P,H)},He.useId=function(){return le.current.useId()},He.useImperativeHandle=function(P,H,Z){return le.current.useImperativeHandle(P,H,Z)},He.useInsertionEffect=function(P,H){return le.current.useInsertionEffect(P,H)},He.useLayoutEffect=function(P,H){return le.current.useLayoutEffect(P,H)},He.useMemo=function(P,H){return le.current.useMemo(P,H)},He.useReducer=function(P,H,Z){return le.current.useReducer(P,H,Z)},He.useRef=function(P){return le.current.useRef(P)},He.useState=function(P){return le.current.useState(P)},He.useSyncExternalStore=function(P,H,Z){return le.current.useSyncExternalStore(P,H,Z)},He.useTransition=function(){return le.current.useTransition()},He.version="18.3.1",He}var vm;function $f(){return vm||(vm=1,Ud.exports=$A()),Ud.exports}/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Sm;function WA(){if(Sm)return zs;Sm=1;var e=$f(),t=Symbol.for("react.element"),i=Symbol.for("react.fragment"),o=Object.prototype.hasOwnProperty,a=e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,s={key:!0,ref:!0,__self:!0,__source:!0};function u(c,f,g){var m,v={},T=null,A=null;g!==void 0&&(T=""+g),f.key!==void 0&&(T=""+f.key),f.ref!==void 0&&(A=f.ref);for(m in f)o.call(f,m)&&!s.hasOwnProperty(m)&&(v[m]=f[m]);if(c&&c.defaultProps)for(m in f=c.defaultProps,f)v[m]===void 0&&(v[m]=f[m]);return{$$typeof:t,type:c,key:T,ref:A,props:v,_owner:a.current}}return zs.Fragment=i,zs.jsx=u,zs.jsxs=u,zs}var ym;function zA(){return ym||(ym=1,Ld.exports=WA()),Ld.exports}var Le=zA(),Oe=$f();const ti=q0(Oe);var xl={},Bd={exports:{}},tn={},Hd={exports:{}},bd={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Am;function YA(){return Am||(Am=1,function(e){function t(Y,X){var W=Y.length;Y.push(X);e:for(;0<W;){var P=W-1>>>1,H=Y[P];if(0<a(H,X))Y[P]=X,Y[W]=H,W=P;else break e}}function i(Y){return Y.length===0?null:Y[0]}function o(Y){if(Y.length===0)return null;var X=Y[0],W=Y.pop();if(W!==X){Y[0]=W;e:for(var P=0,H=Y.length,Z=H>>>1;P<Z;){var ee=2*(P+1)-1,Ie=Y[ee],se=ee+1,Re=Y[se];if(0>a(Ie,W))se<H&&0>a(Re,Ie)?(Y[P]=Re,Y[se]=W,P=se):(Y[P]=Ie,Y[ee]=W,P=ee);else if(se<H&&0>a(Re,W))Y[P]=Re,Y[se]=W,P=se;else break e}}return X}function a(Y,X){var W=Y.sortIndex-X.sortIndex;return W!==0?W:Y.id-X.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;e.unstable_now=function(){return s.now()}}else{var u=Date,c=u.now();e.unstable_now=function(){return u.now()-c}}var f=[],g=[],m=1,v=null,T=3,A=!1,I=!1,y=!1,w=typeof setTimeout=="function"?setTimeout:null,M=typeof clearTimeout=="function"?clearTimeout:null,F=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function N(Y){for(var X=i(g);X!==null;){if(X.callback===null)o(g);else if(X.startTime<=Y)o(g),X.sortIndex=X.expirationTime,t(f,X);else break;X=i(g)}}function b(Y){if(y=!1,N(Y),!I)if(i(f)!==null)I=!0,Ae(B);else{var X=i(g);X!==null&&le(b,X.startTime-Y)}}function B(Y,X){I=!1,y&&(y=!1,M(Q),Q=-1),A=!0;var W=T;try{for(N(X),v=i(f);v!==null&&(!(v.expirationTime>X)||Y&&!be());){var P=v.callback;if(typeof P=="function"){v.callback=null,T=v.priorityLevel;var H=P(v.expirationTime<=X);X=e.unstable_now(),typeof H=="function"?v.callback=H:v===i(f)&&o(f),N(X)}else o(f);v=i(f)}if(v!==null)var Z=!0;else{var ee=i(g);ee!==null&&le(b,ee.startTime-X),Z=!1}return Z}finally{v=null,T=W,A=!1}}var L=!1,G=null,Q=-1,re=5,ve=-1;function be(){return!(e.unstable_now()-ve<re)}function De(){if(G!==null){var Y=e.unstable_now();ve=Y;var X=!0;try{X=G(!0,Y)}finally{X?Te():(L=!1,G=null)}}else L=!1}var Te;if(typeof F=="function")Te=function(){F(De)};else if(typeof MessageChannel<"u"){var de=new MessageChannel,Be=de.port2;de.port1.onmessage=De,Te=function(){Be.postMessage(null)}}else Te=function(){w(De,0)};function Ae(Y){G=Y,L||(L=!0,Te())}function le(Y,X){Q=w(function(){Y(e.unstable_now())},X)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(Y){Y.callback=null},e.unstable_continueExecution=function(){I||A||(I=!0,Ae(B))},e.unstable_forceFrameRate=function(Y){0>Y||125<Y?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):re=0<Y?Math.floor(1e3/Y):5},e.unstable_getCurrentPriorityLevel=function(){return T},e.unstable_getFirstCallbackNode=function(){return i(f)},e.unstable_next=function(Y){switch(T){case 1:case 2:case 3:var X=3;break;default:X=T}var W=T;T=X;try{return Y()}finally{T=W}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(Y,X){switch(Y){case 1:case 2:case 3:case 4:case 5:break;default:Y=3}var W=T;T=Y;try{return X()}finally{T=W}},e.unstable_scheduleCallback=function(Y,X,W){var P=e.unstable_now();switch(typeof W=="object"&&W!==null?(W=W.delay,W=typeof W=="number"&&0<W?P+W:P):W=P,Y){case 1:var H=-1;break;case 2:H=250;break;case 5:H=1073741823;break;case 4:H=1e4;break;default:H=5e3}return H=W+H,Y={id:m++,callback:X,priorityLevel:Y,startTime:W,expirationTime:H,sortIndex:-1},W>P?(Y.sortIndex=W,t(g,Y),i(f)===null&&Y===i(g)&&(y?(M(Q),Q=-1):y=!0,le(b,W-P))):(Y.sortIndex=H,t(f,Y),I||A||(I=!0,Ae(B))),Y},e.unstable_shouldYield=be,e.unstable_wrapCallback=function(Y){var X=T;return function(){var W=T;T=X;try{return Y.apply(this,arguments)}finally{T=W}}}}(bd)),bd}var Tm;function jA(){return Tm||(Tm=1,Hd.exports=YA()),Hd.exports}/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Im;function VA(){if(Im)return tn;Im=1;var e=$f(),t=jA();function i(n){for(var r="https://reactjs.org/docs/error-decoder.html?invariant="+n,l=1;l<arguments.length;l++)r+="&args[]="+encodeURIComponent(arguments[l]);return"Minified React error #"+n+"; visit "+r+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var o=new Set,a={};function s(n,r){u(n,r),u(n+"Capture",r)}function u(n,r){for(a[n]=r,n=0;n<r.length;n++)o.add(r[n])}var c=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),f=Object.prototype.hasOwnProperty,g=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,m={},v={};function T(n){return f.call(v,n)?!0:f.call(m,n)?!1:g.test(n)?v[n]=!0:(m[n]=!0,!1)}function A(n,r,l,d){if(l!==null&&l.type===0)return!1;switch(typeof r){case"function":case"symbol":return!0;case"boolean":return d?!1:l!==null?!l.acceptsBooleans:(n=n.toLowerCase().slice(0,5),n!=="data-"&&n!=="aria-");default:return!1}}function I(n,r,l,d){if(r===null||typeof r>"u"||A(n,r,l,d))return!0;if(d)return!1;if(l!==null)switch(l.type){case 3:return!r;case 4:return r===!1;case 5:return isNaN(r);case 6:return isNaN(r)||1>r}return!1}function y(n,r,l,d,h,p,S){this.acceptsBooleans=r===2||r===3||r===4,this.attributeName=d,this.attributeNamespace=h,this.mustUseProperty=l,this.propertyName=n,this.type=r,this.sanitizeURL=p,this.removeEmptyString=S}var w={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(n){w[n]=new y(n,0,!1,n,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(n){var r=n[0];w[r]=new y(r,1,!1,n[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(n){w[n]=new y(n,2,!1,n.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(n){w[n]=new y(n,2,!1,n,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(n){w[n]=new y(n,3,!1,n.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(n){w[n]=new y(n,3,!0,n,null,!1,!1)}),["capture","download"].forEach(function(n){w[n]=new y(n,4,!1,n,null,!1,!1)}),["cols","rows","size","span"].forEach(function(n){w[n]=new y(n,6,!1,n,null,!1,!1)}),["rowSpan","start"].forEach(function(n){w[n]=new y(n,5,!1,n.toLowerCase(),null,!1,!1)});var M=/[\-:]([a-z])/g;function F(n){return n[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(n){var r=n.replace(M,F);w[r]=new y(r,1,!1,n,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(n){var r=n.replace(M,F);w[r]=new y(r,1,!1,n,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(n){var r=n.replace(M,F);w[r]=new y(r,1,!1,n,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(n){w[n]=new y(n,1,!1,n.toLowerCase(),null,!1,!1)}),w.xlinkHref=new y("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(n){w[n]=new y(n,1,!1,n.toLowerCase(),null,!0,!0)});function N(n,r,l,d){var h=w.hasOwnProperty(r)?w[r]:null;(h!==null?h.type!==0:d||!(2<r.length)||r[0]!=="o"&&r[0]!=="O"||r[1]!=="n"&&r[1]!=="N")&&(I(r,l,h,d)&&(l=null),d||h===null?T(r)&&(l===null?n.removeAttribute(r):n.setAttribute(r,""+l)):h.mustUseProperty?n[h.propertyName]=l===null?h.type===3?!1:"":l:(r=h.attributeName,d=h.attributeNamespace,l===null?n.removeAttribute(r):(h=h.type,l=h===3||h===4&&l===!0?"":""+l,d?n.setAttributeNS(d,r,l):n.setAttribute(r,l))))}var b=e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,B=Symbol.for("react.element"),L=Symbol.for("react.portal"),G=Symbol.for("react.fragment"),Q=Symbol.for("react.strict_mode"),re=Symbol.for("react.profiler"),ve=Symbol.for("react.provider"),be=Symbol.for("react.context"),De=Symbol.for("react.forward_ref"),Te=Symbol.for("react.suspense"),de=Symbol.for("react.suspense_list"),Be=Symbol.for("react.memo"),Ae=Symbol.for("react.lazy"),le=Symbol.for("react.offscreen"),Y=Symbol.iterator;function X(n){return n===null||typeof n!="object"?null:(n=Y&&n[Y]||n["@@iterator"],typeof n=="function"?n:null)}var W=Object.assign,P;function H(n){if(P===void 0)try{throw Error()}catch(l){var r=l.stack.trim().match(/\n( *(at )?)/);P=r&&r[1]||""}return`
`+P+n}var Z=!1;function ee(n,r){if(!n||Z)return"";Z=!0;var l=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(r)if(r=function(){throw Error()},Object.defineProperty(r.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(r,[])}catch(U){var d=U}Reflect.construct(n,[],r)}else{try{r.call()}catch(U){d=U}n.call(r.prototype)}else{try{throw Error()}catch(U){d=U}n()}}catch(U){if(U&&d&&typeof U.stack=="string"){for(var h=U.stack.split(`
`),p=d.stack.split(`
`),S=h.length-1,_=p.length-1;1<=S&&0<=_&&h[S]!==p[_];)_--;for(;1<=S&&0<=_;S--,_--)if(h[S]!==p[_]){if(S!==1||_!==1)do if(S--,_--,0>_||h[S]!==p[_]){var R=`
`+h[S].replace(" at new "," at ");return n.displayName&&R.includes("<anonymous>")&&(R=R.replace("<anonymous>",n.displayName)),R}while(1<=S&&0<=_);break}}}finally{Z=!1,Error.prepareStackTrace=l}return(n=n?n.displayName||n.name:"")?H(n):""}function Ie(n){switch(n.tag){case 5:return H(n.type);case 16:return H("Lazy");case 13:return H("Suspense");case 19:return H("SuspenseList");case 0:case 2:case 15:return n=ee(n.type,!1),n;case 11:return n=ee(n.type.render,!1),n;case 1:return n=ee(n.type,!0),n;default:return""}}function se(n){if(n==null)return null;if(typeof n=="function")return n.displayName||n.name||null;if(typeof n=="string")return n;switch(n){case G:return"Fragment";case L:return"Portal";case re:return"Profiler";case Q:return"StrictMode";case Te:return"Suspense";case de:return"SuspenseList"}if(typeof n=="object")switch(n.$$typeof){case be:return(n.displayName||"Context")+".Consumer";case ve:return(n._context.displayName||"Context")+".Provider";case De:var r=n.render;return n=n.displayName,n||(n=r.displayName||r.name||"",n=n!==""?"ForwardRef("+n+")":"ForwardRef"),n;case Be:return r=n.displayName||null,r!==null?r:se(n.type)||"Memo";case Ae:r=n._payload,n=n._init;try{return se(n(r))}catch{}}return null}function Re(n){var r=n.type;switch(n.tag){case 24:return"Cache";case 9:return(r.displayName||"Context")+".Consumer";case 10:return(r._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return n=r.render,n=n.displayName||n.name||"",r.displayName||(n!==""?"ForwardRef("+n+")":"ForwardRef");case 7:return"Fragment";case 5:return r;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return se(r);case 8:return r===Q?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof r=="function")return r.displayName||r.name||null;if(typeof r=="string")return r}return null}function Ce(n){switch(typeof n){case"boolean":case"number":case"string":case"undefined":return n;case"object":return n;default:return""}}function K(n){var r=n.type;return(n=n.nodeName)&&n.toLowerCase()==="input"&&(r==="checkbox"||r==="radio")}function ae(n){var r=K(n)?"checked":"value",l=Object.getOwnPropertyDescriptor(n.constructor.prototype,r),d=""+n[r];if(!n.hasOwnProperty(r)&&typeof l<"u"&&typeof l.get=="function"&&typeof l.set=="function"){var h=l.get,p=l.set;return Object.defineProperty(n,r,{configurable:!0,get:function(){return h.call(this)},set:function(S){d=""+S,p.call(this,S)}}),Object.defineProperty(n,r,{enumerable:l.enumerable}),{getValue:function(){return d},setValue:function(S){d=""+S},stopTracking:function(){n._valueTracker=null,delete n[r]}}}}function Ue(n){n._valueTracker||(n._valueTracker=ae(n))}function me(n){if(!n)return!1;var r=n._valueTracker;if(!r)return!0;var l=r.getValue(),d="";return n&&(d=K(n)?n.checked?"true":"false":n.value),n=d,n!==l?(r.setValue(n),!0):!1}function Gn(n){if(n=n||(typeof document<"u"?document:void 0),typeof n>"u")return null;try{return n.activeElement||n.body}catch{return n.body}}function nt(n,r){var l=r.checked;return W({},r,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:l??n._wrapperState.initialChecked})}function qe(n,r){var l=r.defaultValue==null?"":r.defaultValue,d=r.checked!=null?r.checked:r.defaultChecked;l=Ce(r.value!=null?r.value:l),n._wrapperState={initialChecked:d,initialValue:l,controlled:r.type==="checkbox"||r.type==="radio"?r.checked!=null:r.value!=null}}function xn(n,r){r=r.checked,r!=null&&N(n,"checked",r,!1)}function Kt(n,r){xn(n,r);var l=Ce(r.value),d=r.type;if(l!=null)d==="number"?(l===0&&n.value===""||n.value!=l)&&(n.value=""+l):n.value!==""+l&&(n.value=""+l);else if(d==="submit"||d==="reset"){n.removeAttribute("value");return}r.hasOwnProperty("value")?$n(n,r.type,l):r.hasOwnProperty("defaultValue")&&$n(n,r.type,Ce(r.defaultValue)),r.checked==null&&r.defaultChecked!=null&&(n.defaultChecked=!!r.defaultChecked)}function hn(n,r,l){if(r.hasOwnProperty("value")||r.hasOwnProperty("defaultValue")){var d=r.type;if(!(d!=="submit"&&d!=="reset"||r.value!==void 0&&r.value!==null))return;r=""+n._wrapperState.initialValue,l||r===n.value||(n.value=r),n.defaultValue=r}l=n.name,l!==""&&(n.name=""),n.defaultChecked=!!n._wrapperState.initialChecked,l!==""&&(n.name=l)}function $n(n,r,l){(r!=="number"||Gn(n.ownerDocument)!==n)&&(l==null?n.defaultValue=""+n._wrapperState.initialValue:n.defaultValue!==""+l&&(n.defaultValue=""+l))}var Wn=Array.isArray;function Ei(n,r,l,d){if(n=n.options,r){r={};for(var h=0;h<l.length;h++)r["$"+l[h]]=!0;for(l=0;l<n.length;l++)h=r.hasOwnProperty("$"+n[l].value),n[l].selected!==h&&(n[l].selected=h),h&&d&&(n[l].defaultSelected=!0)}else{for(l=""+Ce(l),r=null,h=0;h<n.length;h++){if(n[h].value===l){n[h].selected=!0,d&&(n[h].defaultSelected=!0);return}r!==null||n[h].disabled||(r=n[h])}r!==null&&(r.selected=!0)}}function dr(n,r){if(r.dangerouslySetInnerHTML!=null)throw Error(i(91));return W({},r,{value:void 0,defaultValue:void 0,children:""+n._wrapperState.initialValue})}function _h(n,r){var l=r.value;if(l==null){if(l=r.children,r=r.defaultValue,l!=null){if(r!=null)throw Error(i(92));if(Wn(l)){if(1<l.length)throw Error(i(93));l=l[0]}r=l}r==null&&(r=""),l=r}n._wrapperState={initialValue:Ce(l)}}function Rh(n,r){var l=Ce(r.value),d=Ce(r.defaultValue);l!=null&&(l=""+l,l!==n.value&&(n.value=l),r.defaultValue==null&&n.defaultValue!==l&&(n.defaultValue=l)),d!=null&&(n.defaultValue=""+d)}function Ph(n){var r=n.textContent;r===n._wrapperState.initialValue&&r!==""&&r!==null&&(n.value=r)}function Nh(n){switch(n){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function ju(n,r){return n==null||n==="http://www.w3.org/1999/xhtml"?Nh(r):n==="http://www.w3.org/2000/svg"&&r==="foreignObject"?"http://www.w3.org/1999/xhtml":n}var ka,Dh=function(n){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(r,l,d,h){MSApp.execUnsafeLocalFunction(function(){return n(r,l,d,h)})}:n}(function(n,r){if(n.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in n)n.innerHTML=r;else{for(ka=ka||document.createElement("div"),ka.innerHTML="<svg>"+r.valueOf().toString()+"</svg>",r=ka.firstChild;n.firstChild;)n.removeChild(n.firstChild);for(;r.firstChild;)n.appendChild(r.firstChild)}});function ss(n,r){if(r){var l=n.firstChild;if(l&&l===n.lastChild&&l.nodeType===3){l.nodeValue=r;return}}n.textContent=r}var as={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},zS=["Webkit","ms","Moz","O"];Object.keys(as).forEach(function(n){zS.forEach(function(r){r=r+n.charAt(0).toUpperCase()+n.substring(1),as[r]=as[n]})});function Oh(n,r,l){return r==null||typeof r=="boolean"||r===""?"":l||typeof r!="number"||r===0||as.hasOwnProperty(n)&&as[n]?(""+r).trim():r+"px"}function Mh(n,r){n=n.style;for(var l in r)if(r.hasOwnProperty(l)){var d=l.indexOf("--")===0,h=Oh(l,r[l],d);l==="float"&&(l="cssFloat"),d?n.setProperty(l,h):n[l]=h}}var YS=W({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Vu(n,r){if(r){if(YS[n]&&(r.children!=null||r.dangerouslySetInnerHTML!=null))throw Error(i(137,n));if(r.dangerouslySetInnerHTML!=null){if(r.children!=null)throw Error(i(60));if(typeof r.dangerouslySetInnerHTML!="object"||!("__html"in r.dangerouslySetInnerHTML))throw Error(i(61))}if(r.style!=null&&typeof r.style!="object")throw Error(i(62))}}function Xu(n,r){if(n.indexOf("-")===-1)return typeof r.is=="string";switch(n){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Ku=null;function Zu(n){return n=n.target||n.srcElement||window,n.correspondingUseElement&&(n=n.correspondingUseElement),n.nodeType===3?n.parentNode:n}var qu=null,Vr=null,Xr=null;function kh(n){if(n=Ns(n)){if(typeof qu!="function")throw Error(i(280));var r=n.stateNode;r&&(r=nl(r),qu(n.stateNode,n.type,r))}}function Fh(n){Vr?Xr?Xr.push(n):Xr=[n]:Vr=n}function Lh(){if(Vr){var n=Vr,r=Xr;if(Xr=Vr=null,kh(n),r)for(n=0;n<r.length;n++)kh(r[n])}}function Uh(n,r){return n(r)}function Bh(){}var Qu=!1;function Hh(n,r,l){if(Qu)return n(r,l);Qu=!0;try{return Uh(n,r,l)}finally{Qu=!1,(Vr!==null||Xr!==null)&&(Bh(),Lh())}}function ls(n,r){var l=n.stateNode;if(l===null)return null;var d=nl(l);if(d===null)return null;l=d[r];e:switch(r){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(d=!d.disabled)||(n=n.type,d=!(n==="button"||n==="input"||n==="select"||n==="textarea")),n=!d;break e;default:n=!1}if(n)return null;if(l&&typeof l!="function")throw Error(i(231,r,typeof l));return l}var Ju=!1;if(c)try{var us={};Object.defineProperty(us,"passive",{get:function(){Ju=!0}}),window.addEventListener("test",us,us),window.removeEventListener("test",us,us)}catch{Ju=!1}function jS(n,r,l,d,h,p,S,_,R){var U=Array.prototype.slice.call(arguments,3);try{r.apply(l,U)}catch($){this.onError($)}}var cs=!1,Fa=null,La=!1,ec=null,VS={onError:function(n){cs=!0,Fa=n}};function XS(n,r,l,d,h,p,S,_,R){cs=!1,Fa=null,jS.apply(VS,arguments)}function KS(n,r,l,d,h,p,S,_,R){if(XS.apply(this,arguments),cs){if(cs){var U=Fa;cs=!1,Fa=null}else throw Error(i(198));La||(La=!0,ec=U)}}function fr(n){var r=n,l=n;if(n.alternate)for(;r.return;)r=r.return;else{n=r;do r=n,(r.flags&4098)!==0&&(l=r.return),n=r.return;while(n)}return r.tag===3?l:null}function bh(n){if(n.tag===13){var r=n.memoizedState;if(r===null&&(n=n.alternate,n!==null&&(r=n.memoizedState)),r!==null)return r.dehydrated}return null}function Gh(n){if(fr(n)!==n)throw Error(i(188))}function ZS(n){var r=n.alternate;if(!r){if(r=fr(n),r===null)throw Error(i(188));return r!==n?null:n}for(var l=n,d=r;;){var h=l.return;if(h===null)break;var p=h.alternate;if(p===null){if(d=h.return,d!==null){l=d;continue}break}if(h.child===p.child){for(p=h.child;p;){if(p===l)return Gh(h),n;if(p===d)return Gh(h),r;p=p.sibling}throw Error(i(188))}if(l.return!==d.return)l=h,d=p;else{for(var S=!1,_=h.child;_;){if(_===l){S=!0,l=h,d=p;break}if(_===d){S=!0,d=h,l=p;break}_=_.sibling}if(!S){for(_=p.child;_;){if(_===l){S=!0,l=p,d=h;break}if(_===d){S=!0,d=p,l=h;break}_=_.sibling}if(!S)throw Error(i(189))}}if(l.alternate!==d)throw Error(i(190))}if(l.tag!==3)throw Error(i(188));return l.stateNode.current===l?n:r}function xh(n){return n=ZS(n),n!==null?$h(n):null}function $h(n){if(n.tag===5||n.tag===6)return n;for(n=n.child;n!==null;){var r=$h(n);if(r!==null)return r;n=n.sibling}return null}var Wh=t.unstable_scheduleCallback,zh=t.unstable_cancelCallback,qS=t.unstable_shouldYield,QS=t.unstable_requestPaint,ut=t.unstable_now,JS=t.unstable_getCurrentPriorityLevel,tc=t.unstable_ImmediatePriority,Yh=t.unstable_UserBlockingPriority,Ua=t.unstable_NormalPriority,ey=t.unstable_LowPriority,jh=t.unstable_IdlePriority,Ba=null,zn=null;function ty(n){if(zn&&typeof zn.onCommitFiberRoot=="function")try{zn.onCommitFiberRoot(Ba,n,void 0,(n.current.flags&128)===128)}catch{}}var _n=Math.clz32?Math.clz32:ry,ny=Math.log,iy=Math.LN2;function ry(n){return n>>>=0,n===0?32:31-(ny(n)/iy|0)|0}var Ha=64,ba=4194304;function ds(n){switch(n&-n){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return n&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return n&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return n}}function Ga(n,r){var l=n.pendingLanes;if(l===0)return 0;var d=0,h=n.suspendedLanes,p=n.pingedLanes,S=l&268435455;if(S!==0){var _=S&~h;_!==0?d=ds(_):(p&=S,p!==0&&(d=ds(p)))}else S=l&~h,S!==0?d=ds(S):p!==0&&(d=ds(p));if(d===0)return 0;if(r!==0&&r!==d&&(r&h)===0&&(h=d&-d,p=r&-r,h>=p||h===16&&(p&4194240)!==0))return r;if((d&4)!==0&&(d|=l&16),r=n.entangledLanes,r!==0)for(n=n.entanglements,r&=d;0<r;)l=31-_n(r),h=1<<l,d|=n[l],r&=~h;return d}function oy(n,r){switch(n){case 1:case 2:case 4:return r+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return r+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function sy(n,r){for(var l=n.suspendedLanes,d=n.pingedLanes,h=n.expirationTimes,p=n.pendingLanes;0<p;){var S=31-_n(p),_=1<<S,R=h[S];R===-1?((_&l)===0||(_&d)!==0)&&(h[S]=oy(_,r)):R<=r&&(n.expiredLanes|=_),p&=~_}}function nc(n){return n=n.pendingLanes&-1073741825,n!==0?n:n&1073741824?1073741824:0}function Vh(){var n=Ha;return Ha<<=1,(Ha&4194240)===0&&(Ha=64),n}function ic(n){for(var r=[],l=0;31>l;l++)r.push(n);return r}function fs(n,r,l){n.pendingLanes|=r,r!==536870912&&(n.suspendedLanes=0,n.pingedLanes=0),n=n.eventTimes,r=31-_n(r),n[r]=l}function ay(n,r){var l=n.pendingLanes&~r;n.pendingLanes=r,n.suspendedLanes=0,n.pingedLanes=0,n.expiredLanes&=r,n.mutableReadLanes&=r,n.entangledLanes&=r,r=n.entanglements;var d=n.eventTimes;for(n=n.expirationTimes;0<l;){var h=31-_n(l),p=1<<h;r[h]=0,d[h]=-1,n[h]=-1,l&=~p}}function rc(n,r){var l=n.entangledLanes|=r;for(n=n.entanglements;l;){var d=31-_n(l),h=1<<d;h&r|n[d]&r&&(n[d]|=r),l&=~h}}var ze=0;function Xh(n){return n&=-n,1<n?4<n?(n&268435455)!==0?16:536870912:4:1}var Kh,oc,Zh,qh,Qh,sc=!1,xa=[],Ci=null,wi=null,_i=null,hs=new Map,gs=new Map,Ri=[],ly="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Jh(n,r){switch(n){case"focusin":case"focusout":Ci=null;break;case"dragenter":case"dragleave":wi=null;break;case"mouseover":case"mouseout":_i=null;break;case"pointerover":case"pointerout":hs.delete(r.pointerId);break;case"gotpointercapture":case"lostpointercapture":gs.delete(r.pointerId)}}function ps(n,r,l,d,h,p){return n===null||n.nativeEvent!==p?(n={blockedOn:r,domEventName:l,eventSystemFlags:d,nativeEvent:p,targetContainers:[h]},r!==null&&(r=Ns(r),r!==null&&oc(r)),n):(n.eventSystemFlags|=d,r=n.targetContainers,h!==null&&r.indexOf(h)===-1&&r.push(h),n)}function uy(n,r,l,d,h){switch(r){case"focusin":return Ci=ps(Ci,n,r,l,d,h),!0;case"dragenter":return wi=ps(wi,n,r,l,d,h),!0;case"mouseover":return _i=ps(_i,n,r,l,d,h),!0;case"pointerover":var p=h.pointerId;return hs.set(p,ps(hs.get(p)||null,n,r,l,d,h)),!0;case"gotpointercapture":return p=h.pointerId,gs.set(p,ps(gs.get(p)||null,n,r,l,d,h)),!0}return!1}function eg(n){var r=hr(n.target);if(r!==null){var l=fr(r);if(l!==null){if(r=l.tag,r===13){if(r=bh(l),r!==null){n.blockedOn=r,Qh(n.priority,function(){Zh(l)});return}}else if(r===3&&l.stateNode.current.memoizedState.isDehydrated){n.blockedOn=l.tag===3?l.stateNode.containerInfo:null;return}}}n.blockedOn=null}function $a(n){if(n.blockedOn!==null)return!1;for(var r=n.targetContainers;0<r.length;){var l=lc(n.domEventName,n.eventSystemFlags,r[0],n.nativeEvent);if(l===null){l=n.nativeEvent;var d=new l.constructor(l.type,l);Ku=d,l.target.dispatchEvent(d),Ku=null}else return r=Ns(l),r!==null&&oc(r),n.blockedOn=l,!1;r.shift()}return!0}function tg(n,r,l){$a(n)&&l.delete(r)}function cy(){sc=!1,Ci!==null&&$a(Ci)&&(Ci=null),wi!==null&&$a(wi)&&(wi=null),_i!==null&&$a(_i)&&(_i=null),hs.forEach(tg),gs.forEach(tg)}function ms(n,r){n.blockedOn===r&&(n.blockedOn=null,sc||(sc=!0,t.unstable_scheduleCallback(t.unstable_NormalPriority,cy)))}function vs(n){function r(h){return ms(h,n)}if(0<xa.length){ms(xa[0],n);for(var l=1;l<xa.length;l++){var d=xa[l];d.blockedOn===n&&(d.blockedOn=null)}}for(Ci!==null&&ms(Ci,n),wi!==null&&ms(wi,n),_i!==null&&ms(_i,n),hs.forEach(r),gs.forEach(r),l=0;l<Ri.length;l++)d=Ri[l],d.blockedOn===n&&(d.blockedOn=null);for(;0<Ri.length&&(l=Ri[0],l.blockedOn===null);)eg(l),l.blockedOn===null&&Ri.shift()}var Kr=b.ReactCurrentBatchConfig,Wa=!0;function dy(n,r,l,d){var h=ze,p=Kr.transition;Kr.transition=null;try{ze=1,ac(n,r,l,d)}finally{ze=h,Kr.transition=p}}function fy(n,r,l,d){var h=ze,p=Kr.transition;Kr.transition=null;try{ze=4,ac(n,r,l,d)}finally{ze=h,Kr.transition=p}}function ac(n,r,l,d){if(Wa){var h=lc(n,r,l,d);if(h===null)wc(n,r,d,za,l),Jh(n,d);else if(uy(h,n,r,l,d))d.stopPropagation();else if(Jh(n,d),r&4&&-1<ly.indexOf(n)){for(;h!==null;){var p=Ns(h);if(p!==null&&Kh(p),p=lc(n,r,l,d),p===null&&wc(n,r,d,za,l),p===h)break;h=p}h!==null&&d.stopPropagation()}else wc(n,r,d,null,l)}}var za=null;function lc(n,r,l,d){if(za=null,n=Zu(d),n=hr(n),n!==null)if(r=fr(n),r===null)n=null;else if(l=r.tag,l===13){if(n=bh(r),n!==null)return n;n=null}else if(l===3){if(r.stateNode.current.memoizedState.isDehydrated)return r.tag===3?r.stateNode.containerInfo:null;n=null}else r!==n&&(n=null);return za=n,null}function ng(n){switch(n){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(JS()){case tc:return 1;case Yh:return 4;case Ua:case ey:return 16;case jh:return 536870912;default:return 16}default:return 16}}var Pi=null,uc=null,Ya=null;function ig(){if(Ya)return Ya;var n,r=uc,l=r.length,d,h="value"in Pi?Pi.value:Pi.textContent,p=h.length;for(n=0;n<l&&r[n]===h[n];n++);var S=l-n;for(d=1;d<=S&&r[l-d]===h[p-d];d++);return Ya=h.slice(n,1<d?1-d:void 0)}function ja(n){var r=n.keyCode;return"charCode"in n?(n=n.charCode,n===0&&r===13&&(n=13)):n=r,n===10&&(n=13),32<=n||n===13?n:0}function Va(){return!0}function rg(){return!1}function nn(n){function r(l,d,h,p,S){this._reactName=l,this._targetInst=h,this.type=d,this.nativeEvent=p,this.target=S,this.currentTarget=null;for(var _ in n)n.hasOwnProperty(_)&&(l=n[_],this[_]=l?l(p):p[_]);return this.isDefaultPrevented=(p.defaultPrevented!=null?p.defaultPrevented:p.returnValue===!1)?Va:rg,this.isPropagationStopped=rg,this}return W(r.prototype,{preventDefault:function(){this.defaultPrevented=!0;var l=this.nativeEvent;l&&(l.preventDefault?l.preventDefault():typeof l.returnValue!="unknown"&&(l.returnValue=!1),this.isDefaultPrevented=Va)},stopPropagation:function(){var l=this.nativeEvent;l&&(l.stopPropagation?l.stopPropagation():typeof l.cancelBubble!="unknown"&&(l.cancelBubble=!0),this.isPropagationStopped=Va)},persist:function(){},isPersistent:Va}),r}var Zr={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(n){return n.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},cc=nn(Zr),Ss=W({},Zr,{view:0,detail:0}),hy=nn(Ss),dc,fc,ys,Xa=W({},Ss,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:gc,button:0,buttons:0,relatedTarget:function(n){return n.relatedTarget===void 0?n.fromElement===n.srcElement?n.toElement:n.fromElement:n.relatedTarget},movementX:function(n){return"movementX"in n?n.movementX:(n!==ys&&(ys&&n.type==="mousemove"?(dc=n.screenX-ys.screenX,fc=n.screenY-ys.screenY):fc=dc=0,ys=n),dc)},movementY:function(n){return"movementY"in n?n.movementY:fc}}),og=nn(Xa),gy=W({},Xa,{dataTransfer:0}),py=nn(gy),my=W({},Ss,{relatedTarget:0}),hc=nn(my),vy=W({},Zr,{animationName:0,elapsedTime:0,pseudoElement:0}),Sy=nn(vy),yy=W({},Zr,{clipboardData:function(n){return"clipboardData"in n?n.clipboardData:window.clipboardData}}),Ay=nn(yy),Ty=W({},Zr,{data:0}),sg=nn(Ty),Iy={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Ey={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Cy={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function wy(n){var r=this.nativeEvent;return r.getModifierState?r.getModifierState(n):(n=Cy[n])?!!r[n]:!1}function gc(){return wy}var _y=W({},Ss,{key:function(n){if(n.key){var r=Iy[n.key]||n.key;if(r!=="Unidentified")return r}return n.type==="keypress"?(n=ja(n),n===13?"Enter":String.fromCharCode(n)):n.type==="keydown"||n.type==="keyup"?Ey[n.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:gc,charCode:function(n){return n.type==="keypress"?ja(n):0},keyCode:function(n){return n.type==="keydown"||n.type==="keyup"?n.keyCode:0},which:function(n){return n.type==="keypress"?ja(n):n.type==="keydown"||n.type==="keyup"?n.keyCode:0}}),Ry=nn(_y),Py=W({},Xa,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),ag=nn(Py),Ny=W({},Ss,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:gc}),Dy=nn(Ny),Oy=W({},Zr,{propertyName:0,elapsedTime:0,pseudoElement:0}),My=nn(Oy),ky=W({},Xa,{deltaX:function(n){return"deltaX"in n?n.deltaX:"wheelDeltaX"in n?-n.wheelDeltaX:0},deltaY:function(n){return"deltaY"in n?n.deltaY:"wheelDeltaY"in n?-n.wheelDeltaY:"wheelDelta"in n?-n.wheelDelta:0},deltaZ:0,deltaMode:0}),Fy=nn(ky),Ly=[9,13,27,32],pc=c&&"CompositionEvent"in window,As=null;c&&"documentMode"in document&&(As=document.documentMode);var Uy=c&&"TextEvent"in window&&!As,lg=c&&(!pc||As&&8<As&&11>=As),ug=" ",cg=!1;function dg(n,r){switch(n){case"keyup":return Ly.indexOf(r.keyCode)!==-1;case"keydown":return r.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function fg(n){return n=n.detail,typeof n=="object"&&"data"in n?n.data:null}var qr=!1;function By(n,r){switch(n){case"compositionend":return fg(r);case"keypress":return r.which!==32?null:(cg=!0,ug);case"textInput":return n=r.data,n===ug&&cg?null:n;default:return null}}function Hy(n,r){if(qr)return n==="compositionend"||!pc&&dg(n,r)?(n=ig(),Ya=uc=Pi=null,qr=!1,n):null;switch(n){case"paste":return null;case"keypress":if(!(r.ctrlKey||r.altKey||r.metaKey)||r.ctrlKey&&r.altKey){if(r.char&&1<r.char.length)return r.char;if(r.which)return String.fromCharCode(r.which)}return null;case"compositionend":return lg&&r.locale!=="ko"?null:r.data;default:return null}}var by={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function hg(n){var r=n&&n.nodeName&&n.nodeName.toLowerCase();return r==="input"?!!by[n.type]:r==="textarea"}function gg(n,r,l,d){Fh(d),r=Ja(r,"onChange"),0<r.length&&(l=new cc("onChange","change",null,l,d),n.push({event:l,listeners:r}))}var Ts=null,Is=null;function Gy(n){Mg(n,0)}function Ka(n){var r=no(n);if(me(r))return n}function xy(n,r){if(n==="change")return r}var pg=!1;if(c){var mc;if(c){var vc="oninput"in document;if(!vc){var mg=document.createElement("div");mg.setAttribute("oninput","return;"),vc=typeof mg.oninput=="function"}mc=vc}else mc=!1;pg=mc&&(!document.documentMode||9<document.documentMode)}function vg(){Ts&&(Ts.detachEvent("onpropertychange",Sg),Is=Ts=null)}function Sg(n){if(n.propertyName==="value"&&Ka(Is)){var r=[];gg(r,Is,n,Zu(n)),Hh(Gy,r)}}function $y(n,r,l){n==="focusin"?(vg(),Ts=r,Is=l,Ts.attachEvent("onpropertychange",Sg)):n==="focusout"&&vg()}function Wy(n){if(n==="selectionchange"||n==="keyup"||n==="keydown")return Ka(Is)}function zy(n,r){if(n==="click")return Ka(r)}function Yy(n,r){if(n==="input"||n==="change")return Ka(r)}function jy(n,r){return n===r&&(n!==0||1/n===1/r)||n!==n&&r!==r}var Rn=typeof Object.is=="function"?Object.is:jy;function Es(n,r){if(Rn(n,r))return!0;if(typeof n!="object"||n===null||typeof r!="object"||r===null)return!1;var l=Object.keys(n),d=Object.keys(r);if(l.length!==d.length)return!1;for(d=0;d<l.length;d++){var h=l[d];if(!f.call(r,h)||!Rn(n[h],r[h]))return!1}return!0}function yg(n){for(;n&&n.firstChild;)n=n.firstChild;return n}function Ag(n,r){var l=yg(n);n=0;for(var d;l;){if(l.nodeType===3){if(d=n+l.textContent.length,n<=r&&d>=r)return{node:l,offset:r-n};n=d}e:{for(;l;){if(l.nextSibling){l=l.nextSibling;break e}l=l.parentNode}l=void 0}l=yg(l)}}function Tg(n,r){return n&&r?n===r?!0:n&&n.nodeType===3?!1:r&&r.nodeType===3?Tg(n,r.parentNode):"contains"in n?n.contains(r):n.compareDocumentPosition?!!(n.compareDocumentPosition(r)&16):!1:!1}function Ig(){for(var n=window,r=Gn();r instanceof n.HTMLIFrameElement;){try{var l=typeof r.contentWindow.location.href=="string"}catch{l=!1}if(l)n=r.contentWindow;else break;r=Gn(n.document)}return r}function Sc(n){var r=n&&n.nodeName&&n.nodeName.toLowerCase();return r&&(r==="input"&&(n.type==="text"||n.type==="search"||n.type==="tel"||n.type==="url"||n.type==="password")||r==="textarea"||n.contentEditable==="true")}function Vy(n){var r=Ig(),l=n.focusedElem,d=n.selectionRange;if(r!==l&&l&&l.ownerDocument&&Tg(l.ownerDocument.documentElement,l)){if(d!==null&&Sc(l)){if(r=d.start,n=d.end,n===void 0&&(n=r),"selectionStart"in l)l.selectionStart=r,l.selectionEnd=Math.min(n,l.value.length);else if(n=(r=l.ownerDocument||document)&&r.defaultView||window,n.getSelection){n=n.getSelection();var h=l.textContent.length,p=Math.min(d.start,h);d=d.end===void 0?p:Math.min(d.end,h),!n.extend&&p>d&&(h=d,d=p,p=h),h=Ag(l,p);var S=Ag(l,d);h&&S&&(n.rangeCount!==1||n.anchorNode!==h.node||n.anchorOffset!==h.offset||n.focusNode!==S.node||n.focusOffset!==S.offset)&&(r=r.createRange(),r.setStart(h.node,h.offset),n.removeAllRanges(),p>d?(n.addRange(r),n.extend(S.node,S.offset)):(r.setEnd(S.node,S.offset),n.addRange(r)))}}for(r=[],n=l;n=n.parentNode;)n.nodeType===1&&r.push({element:n,left:n.scrollLeft,top:n.scrollTop});for(typeof l.focus=="function"&&l.focus(),l=0;l<r.length;l++)n=r[l],n.element.scrollLeft=n.left,n.element.scrollTop=n.top}}var Xy=c&&"documentMode"in document&&11>=document.documentMode,Qr=null,yc=null,Cs=null,Ac=!1;function Eg(n,r,l){var d=l.window===l?l.document:l.nodeType===9?l:l.ownerDocument;Ac||Qr==null||Qr!==Gn(d)||(d=Qr,"selectionStart"in d&&Sc(d)?d={start:d.selectionStart,end:d.selectionEnd}:(d=(d.ownerDocument&&d.ownerDocument.defaultView||window).getSelection(),d={anchorNode:d.anchorNode,anchorOffset:d.anchorOffset,focusNode:d.focusNode,focusOffset:d.focusOffset}),Cs&&Es(Cs,d)||(Cs=d,d=Ja(yc,"onSelect"),0<d.length&&(r=new cc("onSelect","select",null,r,l),n.push({event:r,listeners:d}),r.target=Qr)))}function Za(n,r){var l={};return l[n.toLowerCase()]=r.toLowerCase(),l["Webkit"+n]="webkit"+r,l["Moz"+n]="moz"+r,l}var Jr={animationend:Za("Animation","AnimationEnd"),animationiteration:Za("Animation","AnimationIteration"),animationstart:Za("Animation","AnimationStart"),transitionend:Za("Transition","TransitionEnd")},Tc={},Cg={};c&&(Cg=document.createElement("div").style,"AnimationEvent"in window||(delete Jr.animationend.animation,delete Jr.animationiteration.animation,delete Jr.animationstart.animation),"TransitionEvent"in window||delete Jr.transitionend.transition);function qa(n){if(Tc[n])return Tc[n];if(!Jr[n])return n;var r=Jr[n],l;for(l in r)if(r.hasOwnProperty(l)&&l in Cg)return Tc[n]=r[l];return n}var wg=qa("animationend"),_g=qa("animationiteration"),Rg=qa("animationstart"),Pg=qa("transitionend"),Ng=new Map,Dg="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Ni(n,r){Ng.set(n,r),s(r,[n])}for(var Ic=0;Ic<Dg.length;Ic++){var Ec=Dg[Ic],Ky=Ec.toLowerCase(),Zy=Ec[0].toUpperCase()+Ec.slice(1);Ni(Ky,"on"+Zy)}Ni(wg,"onAnimationEnd"),Ni(_g,"onAnimationIteration"),Ni(Rg,"onAnimationStart"),Ni("dblclick","onDoubleClick"),Ni("focusin","onFocus"),Ni("focusout","onBlur"),Ni(Pg,"onTransitionEnd"),u("onMouseEnter",["mouseout","mouseover"]),u("onMouseLeave",["mouseout","mouseover"]),u("onPointerEnter",["pointerout","pointerover"]),u("onPointerLeave",["pointerout","pointerover"]),s("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),s("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),s("onBeforeInput",["compositionend","keypress","textInput","paste"]),s("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),s("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),s("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var ws="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),qy=new Set("cancel close invalid load scroll toggle".split(" ").concat(ws));function Og(n,r,l){var d=n.type||"unknown-event";n.currentTarget=l,KS(d,r,void 0,n),n.currentTarget=null}function Mg(n,r){r=(r&4)!==0;for(var l=0;l<n.length;l++){var d=n[l],h=d.event;d=d.listeners;e:{var p=void 0;if(r)for(var S=d.length-1;0<=S;S--){var _=d[S],R=_.instance,U=_.currentTarget;if(_=_.listener,R!==p&&h.isPropagationStopped())break e;Og(h,_,U),p=R}else for(S=0;S<d.length;S++){if(_=d[S],R=_.instance,U=_.currentTarget,_=_.listener,R!==p&&h.isPropagationStopped())break e;Og(h,_,U),p=R}}}if(La)throw n=ec,La=!1,ec=null,n}function Qe(n,r){var l=r[Oc];l===void 0&&(l=r[Oc]=new Set);var d=n+"__bubble";l.has(d)||(kg(r,n,2,!1),l.add(d))}function Cc(n,r,l){var d=0;r&&(d|=4),kg(l,n,d,r)}var Qa="_reactListening"+Math.random().toString(36).slice(2);function _s(n){if(!n[Qa]){n[Qa]=!0,o.forEach(function(l){l!=="selectionchange"&&(qy.has(l)||Cc(l,!1,n),Cc(l,!0,n))});var r=n.nodeType===9?n:n.ownerDocument;r===null||r[Qa]||(r[Qa]=!0,Cc("selectionchange",!1,r))}}function kg(n,r,l,d){switch(ng(r)){case 1:var h=dy;break;case 4:h=fy;break;default:h=ac}l=h.bind(null,r,l,n),h=void 0,!Ju||r!=="touchstart"&&r!=="touchmove"&&r!=="wheel"||(h=!0),d?h!==void 0?n.addEventListener(r,l,{capture:!0,passive:h}):n.addEventListener(r,l,!0):h!==void 0?n.addEventListener(r,l,{passive:h}):n.addEventListener(r,l,!1)}function wc(n,r,l,d,h){var p=d;if((r&1)===0&&(r&2)===0&&d!==null)e:for(;;){if(d===null)return;var S=d.tag;if(S===3||S===4){var _=d.stateNode.containerInfo;if(_===h||_.nodeType===8&&_.parentNode===h)break;if(S===4)for(S=d.return;S!==null;){var R=S.tag;if((R===3||R===4)&&(R=S.stateNode.containerInfo,R===h||R.nodeType===8&&R.parentNode===h))return;S=S.return}for(;_!==null;){if(S=hr(_),S===null)return;if(R=S.tag,R===5||R===6){d=p=S;continue e}_=_.parentNode}}d=d.return}Hh(function(){var U=p,$=Zu(l),z=[];e:{var x=Ng.get(n);if(x!==void 0){var q=cc,oe=n;switch(n){case"keypress":if(ja(l)===0)break e;case"keydown":case"keyup":q=Ry;break;case"focusin":oe="focus",q=hc;break;case"focusout":oe="blur",q=hc;break;case"beforeblur":case"afterblur":q=hc;break;case"click":if(l.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":q=og;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":q=py;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":q=Dy;break;case wg:case _g:case Rg:q=Sy;break;case Pg:q=My;break;case"scroll":q=hy;break;case"wheel":q=Fy;break;case"copy":case"cut":case"paste":q=Ay;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":q=ag}var ue=(r&4)!==0,ct=!ue&&n==="scroll",O=ue?x!==null?x+"Capture":null:x;ue=[];for(var D=U,k;D!==null;){k=D;var j=k.stateNode;if(k.tag===5&&j!==null&&(k=j,O!==null&&(j=ls(D,O),j!=null&&ue.push(Rs(D,j,k)))),ct)break;D=D.return}0<ue.length&&(x=new q(x,oe,null,l,$),z.push({event:x,listeners:ue}))}}if((r&7)===0){e:{if(x=n==="mouseover"||n==="pointerover",q=n==="mouseout"||n==="pointerout",x&&l!==Ku&&(oe=l.relatedTarget||l.fromElement)&&(hr(oe)||oe[oi]))break e;if((q||x)&&(x=$.window===$?$:(x=$.ownerDocument)?x.defaultView||x.parentWindow:window,q?(oe=l.relatedTarget||l.toElement,q=U,oe=oe?hr(oe):null,oe!==null&&(ct=fr(oe),oe!==ct||oe.tag!==5&&oe.tag!==6)&&(oe=null)):(q=null,oe=U),q!==oe)){if(ue=og,j="onMouseLeave",O="onMouseEnter",D="mouse",(n==="pointerout"||n==="pointerover")&&(ue=ag,j="onPointerLeave",O="onPointerEnter",D="pointer"),ct=q==null?x:no(q),k=oe==null?x:no(oe),x=new ue(j,D+"leave",q,l,$),x.target=ct,x.relatedTarget=k,j=null,hr($)===U&&(ue=new ue(O,D+"enter",oe,l,$),ue.target=k,ue.relatedTarget=ct,j=ue),ct=j,q&&oe)t:{for(ue=q,O=oe,D=0,k=ue;k;k=eo(k))D++;for(k=0,j=O;j;j=eo(j))k++;for(;0<D-k;)ue=eo(ue),D--;for(;0<k-D;)O=eo(O),k--;for(;D--;){if(ue===O||O!==null&&ue===O.alternate)break t;ue=eo(ue),O=eo(O)}ue=null}else ue=null;q!==null&&Fg(z,x,q,ue,!1),oe!==null&&ct!==null&&Fg(z,ct,oe,ue,!0)}}e:{if(x=U?no(U):window,q=x.nodeName&&x.nodeName.toLowerCase(),q==="select"||q==="input"&&x.type==="file")var fe=xy;else if(hg(x))if(pg)fe=Yy;else{fe=Wy;var Se=$y}else(q=x.nodeName)&&q.toLowerCase()==="input"&&(x.type==="checkbox"||x.type==="radio")&&(fe=zy);if(fe&&(fe=fe(n,U))){gg(z,fe,l,$);break e}Se&&Se(n,x,U),n==="focusout"&&(Se=x._wrapperState)&&Se.controlled&&x.type==="number"&&$n(x,"number",x.value)}switch(Se=U?no(U):window,n){case"focusin":(hg(Se)||Se.contentEditable==="true")&&(Qr=Se,yc=U,Cs=null);break;case"focusout":Cs=yc=Qr=null;break;case"mousedown":Ac=!0;break;case"contextmenu":case"mouseup":case"dragend":Ac=!1,Eg(z,l,$);break;case"selectionchange":if(Xy)break;case"keydown":case"keyup":Eg(z,l,$)}var ye;if(pc)e:{switch(n){case"compositionstart":var Pe="onCompositionStart";break e;case"compositionend":Pe="onCompositionEnd";break e;case"compositionupdate":Pe="onCompositionUpdate";break e}Pe=void 0}else qr?dg(n,l)&&(Pe="onCompositionEnd"):n==="keydown"&&l.keyCode===229&&(Pe="onCompositionStart");Pe&&(lg&&l.locale!=="ko"&&(qr||Pe!=="onCompositionStart"?Pe==="onCompositionEnd"&&qr&&(ye=ig()):(Pi=$,uc="value"in Pi?Pi.value:Pi.textContent,qr=!0)),Se=Ja(U,Pe),0<Se.length&&(Pe=new sg(Pe,n,null,l,$),z.push({event:Pe,listeners:Se}),ye?Pe.data=ye:(ye=fg(l),ye!==null&&(Pe.data=ye)))),(ye=Uy?By(n,l):Hy(n,l))&&(U=Ja(U,"onBeforeInput"),0<U.length&&($=new sg("onBeforeInput","beforeinput",null,l,$),z.push({event:$,listeners:U}),$.data=ye))}Mg(z,r)})}function Rs(n,r,l){return{instance:n,listener:r,currentTarget:l}}function Ja(n,r){for(var l=r+"Capture",d=[];n!==null;){var h=n,p=h.stateNode;h.tag===5&&p!==null&&(h=p,p=ls(n,l),p!=null&&d.unshift(Rs(n,p,h)),p=ls(n,r),p!=null&&d.push(Rs(n,p,h))),n=n.return}return d}function eo(n){if(n===null)return null;do n=n.return;while(n&&n.tag!==5);return n||null}function Fg(n,r,l,d,h){for(var p=r._reactName,S=[];l!==null&&l!==d;){var _=l,R=_.alternate,U=_.stateNode;if(R!==null&&R===d)break;_.tag===5&&U!==null&&(_=U,h?(R=ls(l,p),R!=null&&S.unshift(Rs(l,R,_))):h||(R=ls(l,p),R!=null&&S.push(Rs(l,R,_)))),l=l.return}S.length!==0&&n.push({event:r,listeners:S})}var Qy=/\r\n?/g,Jy=/\u0000|\uFFFD/g;function Lg(n){return(typeof n=="string"?n:""+n).replace(Qy,`
`).replace(Jy,"")}function el(n,r,l){if(r=Lg(r),Lg(n)!==r&&l)throw Error(i(425))}function tl(){}var _c=null,Rc=null;function Pc(n,r){return n==="textarea"||n==="noscript"||typeof r.children=="string"||typeof r.children=="number"||typeof r.dangerouslySetInnerHTML=="object"&&r.dangerouslySetInnerHTML!==null&&r.dangerouslySetInnerHTML.__html!=null}var Nc=typeof setTimeout=="function"?setTimeout:void 0,eA=typeof clearTimeout=="function"?clearTimeout:void 0,Ug=typeof Promise=="function"?Promise:void 0,tA=typeof queueMicrotask=="function"?queueMicrotask:typeof Ug<"u"?function(n){return Ug.resolve(null).then(n).catch(nA)}:Nc;function nA(n){setTimeout(function(){throw n})}function Dc(n,r){var l=r,d=0;do{var h=l.nextSibling;if(n.removeChild(l),h&&h.nodeType===8)if(l=h.data,l==="/$"){if(d===0){n.removeChild(h),vs(r);return}d--}else l!=="$"&&l!=="$?"&&l!=="$!"||d++;l=h}while(l);vs(r)}function Di(n){for(;n!=null;n=n.nextSibling){var r=n.nodeType;if(r===1||r===3)break;if(r===8){if(r=n.data,r==="$"||r==="$!"||r==="$?")break;if(r==="/$")return null}}return n}function Bg(n){n=n.previousSibling;for(var r=0;n;){if(n.nodeType===8){var l=n.data;if(l==="$"||l==="$!"||l==="$?"){if(r===0)return n;r--}else l==="/$"&&r++}n=n.previousSibling}return null}var to=Math.random().toString(36).slice(2),Yn="__reactFiber$"+to,Ps="__reactProps$"+to,oi="__reactContainer$"+to,Oc="__reactEvents$"+to,iA="__reactListeners$"+to,rA="__reactHandles$"+to;function hr(n){var r=n[Yn];if(r)return r;for(var l=n.parentNode;l;){if(r=l[oi]||l[Yn]){if(l=r.alternate,r.child!==null||l!==null&&l.child!==null)for(n=Bg(n);n!==null;){if(l=n[Yn])return l;n=Bg(n)}return r}n=l,l=n.parentNode}return null}function Ns(n){return n=n[Yn]||n[oi],!n||n.tag!==5&&n.tag!==6&&n.tag!==13&&n.tag!==3?null:n}function no(n){if(n.tag===5||n.tag===6)return n.stateNode;throw Error(i(33))}function nl(n){return n[Ps]||null}var Mc=[],io=-1;function Oi(n){return{current:n}}function Je(n){0>io||(n.current=Mc[io],Mc[io]=null,io--)}function Xe(n,r){io++,Mc[io]=n.current,n.current=r}var Mi={},Mt=Oi(Mi),Zt=Oi(!1),gr=Mi;function ro(n,r){var l=n.type.contextTypes;if(!l)return Mi;var d=n.stateNode;if(d&&d.__reactInternalMemoizedUnmaskedChildContext===r)return d.__reactInternalMemoizedMaskedChildContext;var h={},p;for(p in l)h[p]=r[p];return d&&(n=n.stateNode,n.__reactInternalMemoizedUnmaskedChildContext=r,n.__reactInternalMemoizedMaskedChildContext=h),h}function qt(n){return n=n.childContextTypes,n!=null}function il(){Je(Zt),Je(Mt)}function Hg(n,r,l){if(Mt.current!==Mi)throw Error(i(168));Xe(Mt,r),Xe(Zt,l)}function bg(n,r,l){var d=n.stateNode;if(r=r.childContextTypes,typeof d.getChildContext!="function")return l;d=d.getChildContext();for(var h in d)if(!(h in r))throw Error(i(108,Re(n)||"Unknown",h));return W({},l,d)}function rl(n){return n=(n=n.stateNode)&&n.__reactInternalMemoizedMergedChildContext||Mi,gr=Mt.current,Xe(Mt,n),Xe(Zt,Zt.current),!0}function Gg(n,r,l){var d=n.stateNode;if(!d)throw Error(i(169));l?(n=bg(n,r,gr),d.__reactInternalMemoizedMergedChildContext=n,Je(Zt),Je(Mt),Xe(Mt,n)):Je(Zt),Xe(Zt,l)}var si=null,ol=!1,kc=!1;function xg(n){si===null?si=[n]:si.push(n)}function oA(n){ol=!0,xg(n)}function ki(){if(!kc&&si!==null){kc=!0;var n=0,r=ze;try{var l=si;for(ze=1;n<l.length;n++){var d=l[n];do d=d(!0);while(d!==null)}si=null,ol=!1}catch(h){throw si!==null&&(si=si.slice(n+1)),Wh(tc,ki),h}finally{ze=r,kc=!1}}return null}var oo=[],so=0,sl=null,al=0,gn=[],pn=0,pr=null,ai=1,li="";function mr(n,r){oo[so++]=al,oo[so++]=sl,sl=n,al=r}function $g(n,r,l){gn[pn++]=ai,gn[pn++]=li,gn[pn++]=pr,pr=n;var d=ai;n=li;var h=32-_n(d)-1;d&=~(1<<h),l+=1;var p=32-_n(r)+h;if(30<p){var S=h-h%5;p=(d&(1<<S)-1).toString(32),d>>=S,h-=S,ai=1<<32-_n(r)+h|l<<h|d,li=p+n}else ai=1<<p|l<<h|d,li=n}function Fc(n){n.return!==null&&(mr(n,1),$g(n,1,0))}function Lc(n){for(;n===sl;)sl=oo[--so],oo[so]=null,al=oo[--so],oo[so]=null;for(;n===pr;)pr=gn[--pn],gn[pn]=null,li=gn[--pn],gn[pn]=null,ai=gn[--pn],gn[pn]=null}var rn=null,on=null,it=!1,Pn=null;function Wg(n,r){var l=yn(5,null,null,0);l.elementType="DELETED",l.stateNode=r,l.return=n,r=n.deletions,r===null?(n.deletions=[l],n.flags|=16):r.push(l)}function zg(n,r){switch(n.tag){case 5:var l=n.type;return r=r.nodeType!==1||l.toLowerCase()!==r.nodeName.toLowerCase()?null:r,r!==null?(n.stateNode=r,rn=n,on=Di(r.firstChild),!0):!1;case 6:return r=n.pendingProps===""||r.nodeType!==3?null:r,r!==null?(n.stateNode=r,rn=n,on=null,!0):!1;case 13:return r=r.nodeType!==8?null:r,r!==null?(l=pr!==null?{id:ai,overflow:li}:null,n.memoizedState={dehydrated:r,treeContext:l,retryLane:1073741824},l=yn(18,null,null,0),l.stateNode=r,l.return=n,n.child=l,rn=n,on=null,!0):!1;default:return!1}}function Uc(n){return(n.mode&1)!==0&&(n.flags&128)===0}function Bc(n){if(it){var r=on;if(r){var l=r;if(!zg(n,r)){if(Uc(n))throw Error(i(418));r=Di(l.nextSibling);var d=rn;r&&zg(n,r)?Wg(d,l):(n.flags=n.flags&-4097|2,it=!1,rn=n)}}else{if(Uc(n))throw Error(i(418));n.flags=n.flags&-4097|2,it=!1,rn=n}}}function Yg(n){for(n=n.return;n!==null&&n.tag!==5&&n.tag!==3&&n.tag!==13;)n=n.return;rn=n}function ll(n){if(n!==rn)return!1;if(!it)return Yg(n),it=!0,!1;var r;if((r=n.tag!==3)&&!(r=n.tag!==5)&&(r=n.type,r=r!=="head"&&r!=="body"&&!Pc(n.type,n.memoizedProps)),r&&(r=on)){if(Uc(n))throw jg(),Error(i(418));for(;r;)Wg(n,r),r=Di(r.nextSibling)}if(Yg(n),n.tag===13){if(n=n.memoizedState,n=n!==null?n.dehydrated:null,!n)throw Error(i(317));e:{for(n=n.nextSibling,r=0;n;){if(n.nodeType===8){var l=n.data;if(l==="/$"){if(r===0){on=Di(n.nextSibling);break e}r--}else l!=="$"&&l!=="$!"&&l!=="$?"||r++}n=n.nextSibling}on=null}}else on=rn?Di(n.stateNode.nextSibling):null;return!0}function jg(){for(var n=on;n;)n=Di(n.nextSibling)}function ao(){on=rn=null,it=!1}function Hc(n){Pn===null?Pn=[n]:Pn.push(n)}var sA=b.ReactCurrentBatchConfig;function Ds(n,r,l){if(n=l.ref,n!==null&&typeof n!="function"&&typeof n!="object"){if(l._owner){if(l=l._owner,l){if(l.tag!==1)throw Error(i(309));var d=l.stateNode}if(!d)throw Error(i(147,n));var h=d,p=""+n;return r!==null&&r.ref!==null&&typeof r.ref=="function"&&r.ref._stringRef===p?r.ref:(r=function(S){var _=h.refs;S===null?delete _[p]:_[p]=S},r._stringRef=p,r)}if(typeof n!="string")throw Error(i(284));if(!l._owner)throw Error(i(290,n))}return n}function ul(n,r){throw n=Object.prototype.toString.call(r),Error(i(31,n==="[object Object]"?"object with keys {"+Object.keys(r).join(", ")+"}":n))}function Vg(n){var r=n._init;return r(n._payload)}function Xg(n){function r(O,D){if(n){var k=O.deletions;k===null?(O.deletions=[D],O.flags|=16):k.push(D)}}function l(O,D){if(!n)return null;for(;D!==null;)r(O,D),D=D.sibling;return null}function d(O,D){for(O=new Map;D!==null;)D.key!==null?O.set(D.key,D):O.set(D.index,D),D=D.sibling;return O}function h(O,D){return O=xi(O,D),O.index=0,O.sibling=null,O}function p(O,D,k){return O.index=k,n?(k=O.alternate,k!==null?(k=k.index,k<D?(O.flags|=2,D):k):(O.flags|=2,D)):(O.flags|=1048576,D)}function S(O){return n&&O.alternate===null&&(O.flags|=2),O}function _(O,D,k,j){return D===null||D.tag!==6?(D=Nd(k,O.mode,j),D.return=O,D):(D=h(D,k),D.return=O,D)}function R(O,D,k,j){var fe=k.type;return fe===G?$(O,D,k.props.children,j,k.key):D!==null&&(D.elementType===fe||typeof fe=="object"&&fe!==null&&fe.$$typeof===Ae&&Vg(fe)===D.type)?(j=h(D,k.props),j.ref=Ds(O,D,k),j.return=O,j):(j=kl(k.type,k.key,k.props,null,O.mode,j),j.ref=Ds(O,D,k),j.return=O,j)}function U(O,D,k,j){return D===null||D.tag!==4||D.stateNode.containerInfo!==k.containerInfo||D.stateNode.implementation!==k.implementation?(D=Dd(k,O.mode,j),D.return=O,D):(D=h(D,k.children||[]),D.return=O,D)}function $(O,D,k,j,fe){return D===null||D.tag!==7?(D=Cr(k,O.mode,j,fe),D.return=O,D):(D=h(D,k),D.return=O,D)}function z(O,D,k){if(typeof D=="string"&&D!==""||typeof D=="number")return D=Nd(""+D,O.mode,k),D.return=O,D;if(typeof D=="object"&&D!==null){switch(D.$$typeof){case B:return k=kl(D.type,D.key,D.props,null,O.mode,k),k.ref=Ds(O,null,D),k.return=O,k;case L:return D=Dd(D,O.mode,k),D.return=O,D;case Ae:var j=D._init;return z(O,j(D._payload),k)}if(Wn(D)||X(D))return D=Cr(D,O.mode,k,null),D.return=O,D;ul(O,D)}return null}function x(O,D,k,j){var fe=D!==null?D.key:null;if(typeof k=="string"&&k!==""||typeof k=="number")return fe!==null?null:_(O,D,""+k,j);if(typeof k=="object"&&k!==null){switch(k.$$typeof){case B:return k.key===fe?R(O,D,k,j):null;case L:return k.key===fe?U(O,D,k,j):null;case Ae:return fe=k._init,x(O,D,fe(k._payload),j)}if(Wn(k)||X(k))return fe!==null?null:$(O,D,k,j,null);ul(O,k)}return null}function q(O,D,k,j,fe){if(typeof j=="string"&&j!==""||typeof j=="number")return O=O.get(k)||null,_(D,O,""+j,fe);if(typeof j=="object"&&j!==null){switch(j.$$typeof){case B:return O=O.get(j.key===null?k:j.key)||null,R(D,O,j,fe);case L:return O=O.get(j.key===null?k:j.key)||null,U(D,O,j,fe);case Ae:var Se=j._init;return q(O,D,k,Se(j._payload),fe)}if(Wn(j)||X(j))return O=O.get(k)||null,$(D,O,j,fe,null);ul(D,j)}return null}function oe(O,D,k,j){for(var fe=null,Se=null,ye=D,Pe=D=0,It=null;ye!==null&&Pe<k.length;Pe++){ye.index>Pe?(It=ye,ye=null):It=ye.sibling;var xe=x(O,ye,k[Pe],j);if(xe===null){ye===null&&(ye=It);break}n&&ye&&xe.alternate===null&&r(O,ye),D=p(xe,D,Pe),Se===null?fe=xe:Se.sibling=xe,Se=xe,ye=It}if(Pe===k.length)return l(O,ye),it&&mr(O,Pe),fe;if(ye===null){for(;Pe<k.length;Pe++)ye=z(O,k[Pe],j),ye!==null&&(D=p(ye,D,Pe),Se===null?fe=ye:Se.sibling=ye,Se=ye);return it&&mr(O,Pe),fe}for(ye=d(O,ye);Pe<k.length;Pe++)It=q(ye,O,Pe,k[Pe],j),It!==null&&(n&&It.alternate!==null&&ye.delete(It.key===null?Pe:It.key),D=p(It,D,Pe),Se===null?fe=It:Se.sibling=It,Se=It);return n&&ye.forEach(function($i){return r(O,$i)}),it&&mr(O,Pe),fe}function ue(O,D,k,j){var fe=X(k);if(typeof fe!="function")throw Error(i(150));if(k=fe.call(k),k==null)throw Error(i(151));for(var Se=fe=null,ye=D,Pe=D=0,It=null,xe=k.next();ye!==null&&!xe.done;Pe++,xe=k.next()){ye.index>Pe?(It=ye,ye=null):It=ye.sibling;var $i=x(O,ye,xe.value,j);if($i===null){ye===null&&(ye=It);break}n&&ye&&$i.alternate===null&&r(O,ye),D=p($i,D,Pe),Se===null?fe=$i:Se.sibling=$i,Se=$i,ye=It}if(xe.done)return l(O,ye),it&&mr(O,Pe),fe;if(ye===null){for(;!xe.done;Pe++,xe=k.next())xe=z(O,xe.value,j),xe!==null&&(D=p(xe,D,Pe),Se===null?fe=xe:Se.sibling=xe,Se=xe);return it&&mr(O,Pe),fe}for(ye=d(O,ye);!xe.done;Pe++,xe=k.next())xe=q(ye,O,Pe,xe.value,j),xe!==null&&(n&&xe.alternate!==null&&ye.delete(xe.key===null?Pe:xe.key),D=p(xe,D,Pe),Se===null?fe=xe:Se.sibling=xe,Se=xe);return n&&ye.forEach(function(bA){return r(O,bA)}),it&&mr(O,Pe),fe}function ct(O,D,k,j){if(typeof k=="object"&&k!==null&&k.type===G&&k.key===null&&(k=k.props.children),typeof k=="object"&&k!==null){switch(k.$$typeof){case B:e:{for(var fe=k.key,Se=D;Se!==null;){if(Se.key===fe){if(fe=k.type,fe===G){if(Se.tag===7){l(O,Se.sibling),D=h(Se,k.props.children),D.return=O,O=D;break e}}else if(Se.elementType===fe||typeof fe=="object"&&fe!==null&&fe.$$typeof===Ae&&Vg(fe)===Se.type){l(O,Se.sibling),D=h(Se,k.props),D.ref=Ds(O,Se,k),D.return=O,O=D;break e}l(O,Se);break}else r(O,Se);Se=Se.sibling}k.type===G?(D=Cr(k.props.children,O.mode,j,k.key),D.return=O,O=D):(j=kl(k.type,k.key,k.props,null,O.mode,j),j.ref=Ds(O,D,k),j.return=O,O=j)}return S(O);case L:e:{for(Se=k.key;D!==null;){if(D.key===Se)if(D.tag===4&&D.stateNode.containerInfo===k.containerInfo&&D.stateNode.implementation===k.implementation){l(O,D.sibling),D=h(D,k.children||[]),D.return=O,O=D;break e}else{l(O,D);break}else r(O,D);D=D.sibling}D=Dd(k,O.mode,j),D.return=O,O=D}return S(O);case Ae:return Se=k._init,ct(O,D,Se(k._payload),j)}if(Wn(k))return oe(O,D,k,j);if(X(k))return ue(O,D,k,j);ul(O,k)}return typeof k=="string"&&k!==""||typeof k=="number"?(k=""+k,D!==null&&D.tag===6?(l(O,D.sibling),D=h(D,k),D.return=O,O=D):(l(O,D),D=Nd(k,O.mode,j),D.return=O,O=D),S(O)):l(O,D)}return ct}var lo=Xg(!0),Kg=Xg(!1),cl=Oi(null),dl=null,uo=null,bc=null;function Gc(){bc=uo=dl=null}function xc(n){var r=cl.current;Je(cl),n._currentValue=r}function $c(n,r,l){for(;n!==null;){var d=n.alternate;if((n.childLanes&r)!==r?(n.childLanes|=r,d!==null&&(d.childLanes|=r)):d!==null&&(d.childLanes&r)!==r&&(d.childLanes|=r),n===l)break;n=n.return}}function co(n,r){dl=n,bc=uo=null,n=n.dependencies,n!==null&&n.firstContext!==null&&((n.lanes&r)!==0&&(Qt=!0),n.firstContext=null)}function mn(n){var r=n._currentValue;if(bc!==n)if(n={context:n,memoizedValue:r,next:null},uo===null){if(dl===null)throw Error(i(308));uo=n,dl.dependencies={lanes:0,firstContext:n}}else uo=uo.next=n;return r}var vr=null;function Wc(n){vr===null?vr=[n]:vr.push(n)}function Zg(n,r,l,d){var h=r.interleaved;return h===null?(l.next=l,Wc(r)):(l.next=h.next,h.next=l),r.interleaved=l,ui(n,d)}function ui(n,r){n.lanes|=r;var l=n.alternate;for(l!==null&&(l.lanes|=r),l=n,n=n.return;n!==null;)n.childLanes|=r,l=n.alternate,l!==null&&(l.childLanes|=r),l=n,n=n.return;return l.tag===3?l.stateNode:null}var Fi=!1;function zc(n){n.updateQueue={baseState:n.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function qg(n,r){n=n.updateQueue,r.updateQueue===n&&(r.updateQueue={baseState:n.baseState,firstBaseUpdate:n.firstBaseUpdate,lastBaseUpdate:n.lastBaseUpdate,shared:n.shared,effects:n.effects})}function ci(n,r){return{eventTime:n,lane:r,tag:0,payload:null,callback:null,next:null}}function Li(n,r,l){var d=n.updateQueue;if(d===null)return null;if(d=d.shared,(Ge&2)!==0){var h=d.pending;return h===null?r.next=r:(r.next=h.next,h.next=r),d.pending=r,ui(n,l)}return h=d.interleaved,h===null?(r.next=r,Wc(d)):(r.next=h.next,h.next=r),d.interleaved=r,ui(n,l)}function fl(n,r,l){if(r=r.updateQueue,r!==null&&(r=r.shared,(l&4194240)!==0)){var d=r.lanes;d&=n.pendingLanes,l|=d,r.lanes=l,rc(n,l)}}function Qg(n,r){var l=n.updateQueue,d=n.alternate;if(d!==null&&(d=d.updateQueue,l===d)){var h=null,p=null;if(l=l.firstBaseUpdate,l!==null){do{var S={eventTime:l.eventTime,lane:l.lane,tag:l.tag,payload:l.payload,callback:l.callback,next:null};p===null?h=p=S:p=p.next=S,l=l.next}while(l!==null);p===null?h=p=r:p=p.next=r}else h=p=r;l={baseState:d.baseState,firstBaseUpdate:h,lastBaseUpdate:p,shared:d.shared,effects:d.effects},n.updateQueue=l;return}n=l.lastBaseUpdate,n===null?l.firstBaseUpdate=r:n.next=r,l.lastBaseUpdate=r}function hl(n,r,l,d){var h=n.updateQueue;Fi=!1;var p=h.firstBaseUpdate,S=h.lastBaseUpdate,_=h.shared.pending;if(_!==null){h.shared.pending=null;var R=_,U=R.next;R.next=null,S===null?p=U:S.next=U,S=R;var $=n.alternate;$!==null&&($=$.updateQueue,_=$.lastBaseUpdate,_!==S&&(_===null?$.firstBaseUpdate=U:_.next=U,$.lastBaseUpdate=R))}if(p!==null){var z=h.baseState;S=0,$=U=R=null,_=p;do{var x=_.lane,q=_.eventTime;if((d&x)===x){$!==null&&($=$.next={eventTime:q,lane:0,tag:_.tag,payload:_.payload,callback:_.callback,next:null});e:{var oe=n,ue=_;switch(x=r,q=l,ue.tag){case 1:if(oe=ue.payload,typeof oe=="function"){z=oe.call(q,z,x);break e}z=oe;break e;case 3:oe.flags=oe.flags&-65537|128;case 0:if(oe=ue.payload,x=typeof oe=="function"?oe.call(q,z,x):oe,x==null)break e;z=W({},z,x);break e;case 2:Fi=!0}}_.callback!==null&&_.lane!==0&&(n.flags|=64,x=h.effects,x===null?h.effects=[_]:x.push(_))}else q={eventTime:q,lane:x,tag:_.tag,payload:_.payload,callback:_.callback,next:null},$===null?(U=$=q,R=z):$=$.next=q,S|=x;if(_=_.next,_===null){if(_=h.shared.pending,_===null)break;x=_,_=x.next,x.next=null,h.lastBaseUpdate=x,h.shared.pending=null}}while(!0);if($===null&&(R=z),h.baseState=R,h.firstBaseUpdate=U,h.lastBaseUpdate=$,r=h.shared.interleaved,r!==null){h=r;do S|=h.lane,h=h.next;while(h!==r)}else p===null&&(h.shared.lanes=0);Ar|=S,n.lanes=S,n.memoizedState=z}}function Jg(n,r,l){if(n=r.effects,r.effects=null,n!==null)for(r=0;r<n.length;r++){var d=n[r],h=d.callback;if(h!==null){if(d.callback=null,d=l,typeof h!="function")throw Error(i(191,h));h.call(d)}}}var Os={},jn=Oi(Os),Ms=Oi(Os),ks=Oi(Os);function Sr(n){if(n===Os)throw Error(i(174));return n}function Yc(n,r){switch(Xe(ks,r),Xe(Ms,n),Xe(jn,Os),n=r.nodeType,n){case 9:case 11:r=(r=r.documentElement)?r.namespaceURI:ju(null,"");break;default:n=n===8?r.parentNode:r,r=n.namespaceURI||null,n=n.tagName,r=ju(r,n)}Je(jn),Xe(jn,r)}function fo(){Je(jn),Je(Ms),Je(ks)}function ep(n){Sr(ks.current);var r=Sr(jn.current),l=ju(r,n.type);r!==l&&(Xe(Ms,n),Xe(jn,l))}function jc(n){Ms.current===n&&(Je(jn),Je(Ms))}var ot=Oi(0);function gl(n){for(var r=n;r!==null;){if(r.tag===13){var l=r.memoizedState;if(l!==null&&(l=l.dehydrated,l===null||l.data==="$?"||l.data==="$!"))return r}else if(r.tag===19&&r.memoizedProps.revealOrder!==void 0){if((r.flags&128)!==0)return r}else if(r.child!==null){r.child.return=r,r=r.child;continue}if(r===n)break;for(;r.sibling===null;){if(r.return===null||r.return===n)return null;r=r.return}r.sibling.return=r.return,r=r.sibling}return null}var Vc=[];function Xc(){for(var n=0;n<Vc.length;n++)Vc[n]._workInProgressVersionPrimary=null;Vc.length=0}var pl=b.ReactCurrentDispatcher,Kc=b.ReactCurrentBatchConfig,yr=0,st=null,mt=null,At=null,ml=!1,Fs=!1,Ls=0,aA=0;function kt(){throw Error(i(321))}function Zc(n,r){if(r===null)return!1;for(var l=0;l<r.length&&l<n.length;l++)if(!Rn(n[l],r[l]))return!1;return!0}function qc(n,r,l,d,h,p){if(yr=p,st=r,r.memoizedState=null,r.updateQueue=null,r.lanes=0,pl.current=n===null||n.memoizedState===null?dA:fA,n=l(d,h),Fs){p=0;do{if(Fs=!1,Ls=0,25<=p)throw Error(i(301));p+=1,At=mt=null,r.updateQueue=null,pl.current=hA,n=l(d,h)}while(Fs)}if(pl.current=yl,r=mt!==null&&mt.next!==null,yr=0,At=mt=st=null,ml=!1,r)throw Error(i(300));return n}function Qc(){var n=Ls!==0;return Ls=0,n}function Vn(){var n={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return At===null?st.memoizedState=At=n:At=At.next=n,At}function vn(){if(mt===null){var n=st.alternate;n=n!==null?n.memoizedState:null}else n=mt.next;var r=At===null?st.memoizedState:At.next;if(r!==null)At=r,mt=n;else{if(n===null)throw Error(i(310));mt=n,n={memoizedState:mt.memoizedState,baseState:mt.baseState,baseQueue:mt.baseQueue,queue:mt.queue,next:null},At===null?st.memoizedState=At=n:At=At.next=n}return At}function Us(n,r){return typeof r=="function"?r(n):r}function Jc(n){var r=vn(),l=r.queue;if(l===null)throw Error(i(311));l.lastRenderedReducer=n;var d=mt,h=d.baseQueue,p=l.pending;if(p!==null){if(h!==null){var S=h.next;h.next=p.next,p.next=S}d.baseQueue=h=p,l.pending=null}if(h!==null){p=h.next,d=d.baseState;var _=S=null,R=null,U=p;do{var $=U.lane;if((yr&$)===$)R!==null&&(R=R.next={lane:0,action:U.action,hasEagerState:U.hasEagerState,eagerState:U.eagerState,next:null}),d=U.hasEagerState?U.eagerState:n(d,U.action);else{var z={lane:$,action:U.action,hasEagerState:U.hasEagerState,eagerState:U.eagerState,next:null};R===null?(_=R=z,S=d):R=R.next=z,st.lanes|=$,Ar|=$}U=U.next}while(U!==null&&U!==p);R===null?S=d:R.next=_,Rn(d,r.memoizedState)||(Qt=!0),r.memoizedState=d,r.baseState=S,r.baseQueue=R,l.lastRenderedState=d}if(n=l.interleaved,n!==null){h=n;do p=h.lane,st.lanes|=p,Ar|=p,h=h.next;while(h!==n)}else h===null&&(l.lanes=0);return[r.memoizedState,l.dispatch]}function ed(n){var r=vn(),l=r.queue;if(l===null)throw Error(i(311));l.lastRenderedReducer=n;var d=l.dispatch,h=l.pending,p=r.memoizedState;if(h!==null){l.pending=null;var S=h=h.next;do p=n(p,S.action),S=S.next;while(S!==h);Rn(p,r.memoizedState)||(Qt=!0),r.memoizedState=p,r.baseQueue===null&&(r.baseState=p),l.lastRenderedState=p}return[p,d]}function tp(){}function np(n,r){var l=st,d=vn(),h=r(),p=!Rn(d.memoizedState,h);if(p&&(d.memoizedState=h,Qt=!0),d=d.queue,td(op.bind(null,l,d,n),[n]),d.getSnapshot!==r||p||At!==null&&At.memoizedState.tag&1){if(l.flags|=2048,Bs(9,rp.bind(null,l,d,h,r),void 0,null),Tt===null)throw Error(i(349));(yr&30)!==0||ip(l,r,h)}return h}function ip(n,r,l){n.flags|=16384,n={getSnapshot:r,value:l},r=st.updateQueue,r===null?(r={lastEffect:null,stores:null},st.updateQueue=r,r.stores=[n]):(l=r.stores,l===null?r.stores=[n]:l.push(n))}function rp(n,r,l,d){r.value=l,r.getSnapshot=d,sp(r)&&ap(n)}function op(n,r,l){return l(function(){sp(r)&&ap(n)})}function sp(n){var r=n.getSnapshot;n=n.value;try{var l=r();return!Rn(n,l)}catch{return!0}}function ap(n){var r=ui(n,1);r!==null&&Mn(r,n,1,-1)}function lp(n){var r=Vn();return typeof n=="function"&&(n=n()),r.memoizedState=r.baseState=n,n={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Us,lastRenderedState:n},r.queue=n,n=n.dispatch=cA.bind(null,st,n),[r.memoizedState,n]}function Bs(n,r,l,d){return n={tag:n,create:r,destroy:l,deps:d,next:null},r=st.updateQueue,r===null?(r={lastEffect:null,stores:null},st.updateQueue=r,r.lastEffect=n.next=n):(l=r.lastEffect,l===null?r.lastEffect=n.next=n:(d=l.next,l.next=n,n.next=d,r.lastEffect=n)),n}function up(){return vn().memoizedState}function vl(n,r,l,d){var h=Vn();st.flags|=n,h.memoizedState=Bs(1|r,l,void 0,d===void 0?null:d)}function Sl(n,r,l,d){var h=vn();d=d===void 0?null:d;var p=void 0;if(mt!==null){var S=mt.memoizedState;if(p=S.destroy,d!==null&&Zc(d,S.deps)){h.memoizedState=Bs(r,l,p,d);return}}st.flags|=n,h.memoizedState=Bs(1|r,l,p,d)}function cp(n,r){return vl(8390656,8,n,r)}function td(n,r){return Sl(2048,8,n,r)}function dp(n,r){return Sl(4,2,n,r)}function fp(n,r){return Sl(4,4,n,r)}function hp(n,r){if(typeof r=="function")return n=n(),r(n),function(){r(null)};if(r!=null)return n=n(),r.current=n,function(){r.current=null}}function gp(n,r,l){return l=l!=null?l.concat([n]):null,Sl(4,4,hp.bind(null,r,n),l)}function nd(){}function pp(n,r){var l=vn();r=r===void 0?null:r;var d=l.memoizedState;return d!==null&&r!==null&&Zc(r,d[1])?d[0]:(l.memoizedState=[n,r],n)}function mp(n,r){var l=vn();r=r===void 0?null:r;var d=l.memoizedState;return d!==null&&r!==null&&Zc(r,d[1])?d[0]:(n=n(),l.memoizedState=[n,r],n)}function vp(n,r,l){return(yr&21)===0?(n.baseState&&(n.baseState=!1,Qt=!0),n.memoizedState=l):(Rn(l,r)||(l=Vh(),st.lanes|=l,Ar|=l,n.baseState=!0),r)}function lA(n,r){var l=ze;ze=l!==0&&4>l?l:4,n(!0);var d=Kc.transition;Kc.transition={};try{n(!1),r()}finally{ze=l,Kc.transition=d}}function Sp(){return vn().memoizedState}function uA(n,r,l){var d=bi(n);if(l={lane:d,action:l,hasEagerState:!1,eagerState:null,next:null},yp(n))Ap(r,l);else if(l=Zg(n,r,l,d),l!==null){var h=xt();Mn(l,n,d,h),Tp(l,r,d)}}function cA(n,r,l){var d=bi(n),h={lane:d,action:l,hasEagerState:!1,eagerState:null,next:null};if(yp(n))Ap(r,h);else{var p=n.alternate;if(n.lanes===0&&(p===null||p.lanes===0)&&(p=r.lastRenderedReducer,p!==null))try{var S=r.lastRenderedState,_=p(S,l);if(h.hasEagerState=!0,h.eagerState=_,Rn(_,S)){var R=r.interleaved;R===null?(h.next=h,Wc(r)):(h.next=R.next,R.next=h),r.interleaved=h;return}}catch{}finally{}l=Zg(n,r,h,d),l!==null&&(h=xt(),Mn(l,n,d,h),Tp(l,r,d))}}function yp(n){var r=n.alternate;return n===st||r!==null&&r===st}function Ap(n,r){Fs=ml=!0;var l=n.pending;l===null?r.next=r:(r.next=l.next,l.next=r),n.pending=r}function Tp(n,r,l){if((l&4194240)!==0){var d=r.lanes;d&=n.pendingLanes,l|=d,r.lanes=l,rc(n,l)}}var yl={readContext:mn,useCallback:kt,useContext:kt,useEffect:kt,useImperativeHandle:kt,useInsertionEffect:kt,useLayoutEffect:kt,useMemo:kt,useReducer:kt,useRef:kt,useState:kt,useDebugValue:kt,useDeferredValue:kt,useTransition:kt,useMutableSource:kt,useSyncExternalStore:kt,useId:kt,unstable_isNewReconciler:!1},dA={readContext:mn,useCallback:function(n,r){return Vn().memoizedState=[n,r===void 0?null:r],n},useContext:mn,useEffect:cp,useImperativeHandle:function(n,r,l){return l=l!=null?l.concat([n]):null,vl(4194308,4,hp.bind(null,r,n),l)},useLayoutEffect:function(n,r){return vl(4194308,4,n,r)},useInsertionEffect:function(n,r){return vl(4,2,n,r)},useMemo:function(n,r){var l=Vn();return r=r===void 0?null:r,n=n(),l.memoizedState=[n,r],n},useReducer:function(n,r,l){var d=Vn();return r=l!==void 0?l(r):r,d.memoizedState=d.baseState=r,n={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:n,lastRenderedState:r},d.queue=n,n=n.dispatch=uA.bind(null,st,n),[d.memoizedState,n]},useRef:function(n){var r=Vn();return n={current:n},r.memoizedState=n},useState:lp,useDebugValue:nd,useDeferredValue:function(n){return Vn().memoizedState=n},useTransition:function(){var n=lp(!1),r=n[0];return n=lA.bind(null,n[1]),Vn().memoizedState=n,[r,n]},useMutableSource:function(){},useSyncExternalStore:function(n,r,l){var d=st,h=Vn();if(it){if(l===void 0)throw Error(i(407));l=l()}else{if(l=r(),Tt===null)throw Error(i(349));(yr&30)!==0||ip(d,r,l)}h.memoizedState=l;var p={value:l,getSnapshot:r};return h.queue=p,cp(op.bind(null,d,p,n),[n]),d.flags|=2048,Bs(9,rp.bind(null,d,p,l,r),void 0,null),l},useId:function(){var n=Vn(),r=Tt.identifierPrefix;if(it){var l=li,d=ai;l=(d&~(1<<32-_n(d)-1)).toString(32)+l,r=":"+r+"R"+l,l=Ls++,0<l&&(r+="H"+l.toString(32)),r+=":"}else l=aA++,r=":"+r+"r"+l.toString(32)+":";return n.memoizedState=r},unstable_isNewReconciler:!1},fA={readContext:mn,useCallback:pp,useContext:mn,useEffect:td,useImperativeHandle:gp,useInsertionEffect:dp,useLayoutEffect:fp,useMemo:mp,useReducer:Jc,useRef:up,useState:function(){return Jc(Us)},useDebugValue:nd,useDeferredValue:function(n){var r=vn();return vp(r,mt.memoizedState,n)},useTransition:function(){var n=Jc(Us)[0],r=vn().memoizedState;return[n,r]},useMutableSource:tp,useSyncExternalStore:np,useId:Sp,unstable_isNewReconciler:!1},hA={readContext:mn,useCallback:pp,useContext:mn,useEffect:td,useImperativeHandle:gp,useInsertionEffect:dp,useLayoutEffect:fp,useMemo:mp,useReducer:ed,useRef:up,useState:function(){return ed(Us)},useDebugValue:nd,useDeferredValue:function(n){var r=vn();return mt===null?r.memoizedState=n:vp(r,mt.memoizedState,n)},useTransition:function(){var n=ed(Us)[0],r=vn().memoizedState;return[n,r]},useMutableSource:tp,useSyncExternalStore:np,useId:Sp,unstable_isNewReconciler:!1};function Nn(n,r){if(n&&n.defaultProps){r=W({},r),n=n.defaultProps;for(var l in n)r[l]===void 0&&(r[l]=n[l]);return r}return r}function id(n,r,l,d){r=n.memoizedState,l=l(d,r),l=l==null?r:W({},r,l),n.memoizedState=l,n.lanes===0&&(n.updateQueue.baseState=l)}var Al={isMounted:function(n){return(n=n._reactInternals)?fr(n)===n:!1},enqueueSetState:function(n,r,l){n=n._reactInternals;var d=xt(),h=bi(n),p=ci(d,h);p.payload=r,l!=null&&(p.callback=l),r=Li(n,p,h),r!==null&&(Mn(r,n,h,d),fl(r,n,h))},enqueueReplaceState:function(n,r,l){n=n._reactInternals;var d=xt(),h=bi(n),p=ci(d,h);p.tag=1,p.payload=r,l!=null&&(p.callback=l),r=Li(n,p,h),r!==null&&(Mn(r,n,h,d),fl(r,n,h))},enqueueForceUpdate:function(n,r){n=n._reactInternals;var l=xt(),d=bi(n),h=ci(l,d);h.tag=2,r!=null&&(h.callback=r),r=Li(n,h,d),r!==null&&(Mn(r,n,d,l),fl(r,n,d))}};function Ip(n,r,l,d,h,p,S){return n=n.stateNode,typeof n.shouldComponentUpdate=="function"?n.shouldComponentUpdate(d,p,S):r.prototype&&r.prototype.isPureReactComponent?!Es(l,d)||!Es(h,p):!0}function Ep(n,r,l){var d=!1,h=Mi,p=r.contextType;return typeof p=="object"&&p!==null?p=mn(p):(h=qt(r)?gr:Mt.current,d=r.contextTypes,p=(d=d!=null)?ro(n,h):Mi),r=new r(l,p),n.memoizedState=r.state!==null&&r.state!==void 0?r.state:null,r.updater=Al,n.stateNode=r,r._reactInternals=n,d&&(n=n.stateNode,n.__reactInternalMemoizedUnmaskedChildContext=h,n.__reactInternalMemoizedMaskedChildContext=p),r}function Cp(n,r,l,d){n=r.state,typeof r.componentWillReceiveProps=="function"&&r.componentWillReceiveProps(l,d),typeof r.UNSAFE_componentWillReceiveProps=="function"&&r.UNSAFE_componentWillReceiveProps(l,d),r.state!==n&&Al.enqueueReplaceState(r,r.state,null)}function rd(n,r,l,d){var h=n.stateNode;h.props=l,h.state=n.memoizedState,h.refs={},zc(n);var p=r.contextType;typeof p=="object"&&p!==null?h.context=mn(p):(p=qt(r)?gr:Mt.current,h.context=ro(n,p)),h.state=n.memoizedState,p=r.getDerivedStateFromProps,typeof p=="function"&&(id(n,r,p,l),h.state=n.memoizedState),typeof r.getDerivedStateFromProps=="function"||typeof h.getSnapshotBeforeUpdate=="function"||typeof h.UNSAFE_componentWillMount!="function"&&typeof h.componentWillMount!="function"||(r=h.state,typeof h.componentWillMount=="function"&&h.componentWillMount(),typeof h.UNSAFE_componentWillMount=="function"&&h.UNSAFE_componentWillMount(),r!==h.state&&Al.enqueueReplaceState(h,h.state,null),hl(n,l,h,d),h.state=n.memoizedState),typeof h.componentDidMount=="function"&&(n.flags|=4194308)}function ho(n,r){try{var l="",d=r;do l+=Ie(d),d=d.return;while(d);var h=l}catch(p){h=`
Error generating stack: `+p.message+`
`+p.stack}return{value:n,source:r,stack:h,digest:null}}function od(n,r,l){return{value:n,source:null,stack:l??null,digest:r??null}}function sd(n,r){try{console.error(r.value)}catch(l){setTimeout(function(){throw l})}}var gA=typeof WeakMap=="function"?WeakMap:Map;function wp(n,r,l){l=ci(-1,l),l.tag=3,l.payload={element:null};var d=r.value;return l.callback=function(){Rl||(Rl=!0,Td=d),sd(n,r)},l}function _p(n,r,l){l=ci(-1,l),l.tag=3;var d=n.type.getDerivedStateFromError;if(typeof d=="function"){var h=r.value;l.payload=function(){return d(h)},l.callback=function(){sd(n,r)}}var p=n.stateNode;return p!==null&&typeof p.componentDidCatch=="function"&&(l.callback=function(){sd(n,r),typeof d!="function"&&(Bi===null?Bi=new Set([this]):Bi.add(this));var S=r.stack;this.componentDidCatch(r.value,{componentStack:S!==null?S:""})}),l}function Rp(n,r,l){var d=n.pingCache;if(d===null){d=n.pingCache=new gA;var h=new Set;d.set(r,h)}else h=d.get(r),h===void 0&&(h=new Set,d.set(r,h));h.has(l)||(h.add(l),n=PA.bind(null,n,r,l),r.then(n,n))}function Pp(n){do{var r;if((r=n.tag===13)&&(r=n.memoizedState,r=r!==null?r.dehydrated!==null:!0),r)return n;n=n.return}while(n!==null);return null}function Np(n,r,l,d,h){return(n.mode&1)===0?(n===r?n.flags|=65536:(n.flags|=128,l.flags|=131072,l.flags&=-52805,l.tag===1&&(l.alternate===null?l.tag=17:(r=ci(-1,1),r.tag=2,Li(l,r,1))),l.lanes|=1),n):(n.flags|=65536,n.lanes=h,n)}var pA=b.ReactCurrentOwner,Qt=!1;function Gt(n,r,l,d){r.child=n===null?Kg(r,null,l,d):lo(r,n.child,l,d)}function Dp(n,r,l,d,h){l=l.render;var p=r.ref;return co(r,h),d=qc(n,r,l,d,p,h),l=Qc(),n!==null&&!Qt?(r.updateQueue=n.updateQueue,r.flags&=-2053,n.lanes&=~h,di(n,r,h)):(it&&l&&Fc(r),r.flags|=1,Gt(n,r,d,h),r.child)}function Op(n,r,l,d,h){if(n===null){var p=l.type;return typeof p=="function"&&!Pd(p)&&p.defaultProps===void 0&&l.compare===null&&l.defaultProps===void 0?(r.tag=15,r.type=p,Mp(n,r,p,d,h)):(n=kl(l.type,null,d,r,r.mode,h),n.ref=r.ref,n.return=r,r.child=n)}if(p=n.child,(n.lanes&h)===0){var S=p.memoizedProps;if(l=l.compare,l=l!==null?l:Es,l(S,d)&&n.ref===r.ref)return di(n,r,h)}return r.flags|=1,n=xi(p,d),n.ref=r.ref,n.return=r,r.child=n}function Mp(n,r,l,d,h){if(n!==null){var p=n.memoizedProps;if(Es(p,d)&&n.ref===r.ref)if(Qt=!1,r.pendingProps=d=p,(n.lanes&h)!==0)(n.flags&131072)!==0&&(Qt=!0);else return r.lanes=n.lanes,di(n,r,h)}return ad(n,r,l,d,h)}function kp(n,r,l){var d=r.pendingProps,h=d.children,p=n!==null?n.memoizedState:null;if(d.mode==="hidden")if((r.mode&1)===0)r.memoizedState={baseLanes:0,cachePool:null,transitions:null},Xe(po,sn),sn|=l;else{if((l&1073741824)===0)return n=p!==null?p.baseLanes|l:l,r.lanes=r.childLanes=1073741824,r.memoizedState={baseLanes:n,cachePool:null,transitions:null},r.updateQueue=null,Xe(po,sn),sn|=n,null;r.memoizedState={baseLanes:0,cachePool:null,transitions:null},d=p!==null?p.baseLanes:l,Xe(po,sn),sn|=d}else p!==null?(d=p.baseLanes|l,r.memoizedState=null):d=l,Xe(po,sn),sn|=d;return Gt(n,r,h,l),r.child}function Fp(n,r){var l=r.ref;(n===null&&l!==null||n!==null&&n.ref!==l)&&(r.flags|=512,r.flags|=2097152)}function ad(n,r,l,d,h){var p=qt(l)?gr:Mt.current;return p=ro(r,p),co(r,h),l=qc(n,r,l,d,p,h),d=Qc(),n!==null&&!Qt?(r.updateQueue=n.updateQueue,r.flags&=-2053,n.lanes&=~h,di(n,r,h)):(it&&d&&Fc(r),r.flags|=1,Gt(n,r,l,h),r.child)}function Lp(n,r,l,d,h){if(qt(l)){var p=!0;rl(r)}else p=!1;if(co(r,h),r.stateNode===null)Il(n,r),Ep(r,l,d),rd(r,l,d,h),d=!0;else if(n===null){var S=r.stateNode,_=r.memoizedProps;S.props=_;var R=S.context,U=l.contextType;typeof U=="object"&&U!==null?U=mn(U):(U=qt(l)?gr:Mt.current,U=ro(r,U));var $=l.getDerivedStateFromProps,z=typeof $=="function"||typeof S.getSnapshotBeforeUpdate=="function";z||typeof S.UNSAFE_componentWillReceiveProps!="function"&&typeof S.componentWillReceiveProps!="function"||(_!==d||R!==U)&&Cp(r,S,d,U),Fi=!1;var x=r.memoizedState;S.state=x,hl(r,d,S,h),R=r.memoizedState,_!==d||x!==R||Zt.current||Fi?(typeof $=="function"&&(id(r,l,$,d),R=r.memoizedState),(_=Fi||Ip(r,l,_,d,x,R,U))?(z||typeof S.UNSAFE_componentWillMount!="function"&&typeof S.componentWillMount!="function"||(typeof S.componentWillMount=="function"&&S.componentWillMount(),typeof S.UNSAFE_componentWillMount=="function"&&S.UNSAFE_componentWillMount()),typeof S.componentDidMount=="function"&&(r.flags|=4194308)):(typeof S.componentDidMount=="function"&&(r.flags|=4194308),r.memoizedProps=d,r.memoizedState=R),S.props=d,S.state=R,S.context=U,d=_):(typeof S.componentDidMount=="function"&&(r.flags|=4194308),d=!1)}else{S=r.stateNode,qg(n,r),_=r.memoizedProps,U=r.type===r.elementType?_:Nn(r.type,_),S.props=U,z=r.pendingProps,x=S.context,R=l.contextType,typeof R=="object"&&R!==null?R=mn(R):(R=qt(l)?gr:Mt.current,R=ro(r,R));var q=l.getDerivedStateFromProps;($=typeof q=="function"||typeof S.getSnapshotBeforeUpdate=="function")||typeof S.UNSAFE_componentWillReceiveProps!="function"&&typeof S.componentWillReceiveProps!="function"||(_!==z||x!==R)&&Cp(r,S,d,R),Fi=!1,x=r.memoizedState,S.state=x,hl(r,d,S,h);var oe=r.memoizedState;_!==z||x!==oe||Zt.current||Fi?(typeof q=="function"&&(id(r,l,q,d),oe=r.memoizedState),(U=Fi||Ip(r,l,U,d,x,oe,R)||!1)?($||typeof S.UNSAFE_componentWillUpdate!="function"&&typeof S.componentWillUpdate!="function"||(typeof S.componentWillUpdate=="function"&&S.componentWillUpdate(d,oe,R),typeof S.UNSAFE_componentWillUpdate=="function"&&S.UNSAFE_componentWillUpdate(d,oe,R)),typeof S.componentDidUpdate=="function"&&(r.flags|=4),typeof S.getSnapshotBeforeUpdate=="function"&&(r.flags|=1024)):(typeof S.componentDidUpdate!="function"||_===n.memoizedProps&&x===n.memoizedState||(r.flags|=4),typeof S.getSnapshotBeforeUpdate!="function"||_===n.memoizedProps&&x===n.memoizedState||(r.flags|=1024),r.memoizedProps=d,r.memoizedState=oe),S.props=d,S.state=oe,S.context=R,d=U):(typeof S.componentDidUpdate!="function"||_===n.memoizedProps&&x===n.memoizedState||(r.flags|=4),typeof S.getSnapshotBeforeUpdate!="function"||_===n.memoizedProps&&x===n.memoizedState||(r.flags|=1024),d=!1)}return ld(n,r,l,d,p,h)}function ld(n,r,l,d,h,p){Fp(n,r);var S=(r.flags&128)!==0;if(!d&&!S)return h&&Gg(r,l,!1),di(n,r,p);d=r.stateNode,pA.current=r;var _=S&&typeof l.getDerivedStateFromError!="function"?null:d.render();return r.flags|=1,n!==null&&S?(r.child=lo(r,n.child,null,p),r.child=lo(r,null,_,p)):Gt(n,r,_,p),r.memoizedState=d.state,h&&Gg(r,l,!0),r.child}function Up(n){var r=n.stateNode;r.pendingContext?Hg(n,r.pendingContext,r.pendingContext!==r.context):r.context&&Hg(n,r.context,!1),Yc(n,r.containerInfo)}function Bp(n,r,l,d,h){return ao(),Hc(h),r.flags|=256,Gt(n,r,l,d),r.child}var ud={dehydrated:null,treeContext:null,retryLane:0};function cd(n){return{baseLanes:n,cachePool:null,transitions:null}}function Hp(n,r,l){var d=r.pendingProps,h=ot.current,p=!1,S=(r.flags&128)!==0,_;if((_=S)||(_=n!==null&&n.memoizedState===null?!1:(h&2)!==0),_?(p=!0,r.flags&=-129):(n===null||n.memoizedState!==null)&&(h|=1),Xe(ot,h&1),n===null)return Bc(r),n=r.memoizedState,n!==null&&(n=n.dehydrated,n!==null)?((r.mode&1)===0?r.lanes=1:n.data==="$!"?r.lanes=8:r.lanes=1073741824,null):(S=d.children,n=d.fallback,p?(d=r.mode,p=r.child,S={mode:"hidden",children:S},(d&1)===0&&p!==null?(p.childLanes=0,p.pendingProps=S):p=Fl(S,d,0,null),n=Cr(n,d,l,null),p.return=r,n.return=r,p.sibling=n,r.child=p,r.child.memoizedState=cd(l),r.memoizedState=ud,n):dd(r,S));if(h=n.memoizedState,h!==null&&(_=h.dehydrated,_!==null))return mA(n,r,S,d,_,h,l);if(p){p=d.fallback,S=r.mode,h=n.child,_=h.sibling;var R={mode:"hidden",children:d.children};return(S&1)===0&&r.child!==h?(d=r.child,d.childLanes=0,d.pendingProps=R,r.deletions=null):(d=xi(h,R),d.subtreeFlags=h.subtreeFlags&14680064),_!==null?p=xi(_,p):(p=Cr(p,S,l,null),p.flags|=2),p.return=r,d.return=r,d.sibling=p,r.child=d,d=p,p=r.child,S=n.child.memoizedState,S=S===null?cd(l):{baseLanes:S.baseLanes|l,cachePool:null,transitions:S.transitions},p.memoizedState=S,p.childLanes=n.childLanes&~l,r.memoizedState=ud,d}return p=n.child,n=p.sibling,d=xi(p,{mode:"visible",children:d.children}),(r.mode&1)===0&&(d.lanes=l),d.return=r,d.sibling=null,n!==null&&(l=r.deletions,l===null?(r.deletions=[n],r.flags|=16):l.push(n)),r.child=d,r.memoizedState=null,d}function dd(n,r){return r=Fl({mode:"visible",children:r},n.mode,0,null),r.return=n,n.child=r}function Tl(n,r,l,d){return d!==null&&Hc(d),lo(r,n.child,null,l),n=dd(r,r.pendingProps.children),n.flags|=2,r.memoizedState=null,n}function mA(n,r,l,d,h,p,S){if(l)return r.flags&256?(r.flags&=-257,d=od(Error(i(422))),Tl(n,r,S,d)):r.memoizedState!==null?(r.child=n.child,r.flags|=128,null):(p=d.fallback,h=r.mode,d=Fl({mode:"visible",children:d.children},h,0,null),p=Cr(p,h,S,null),p.flags|=2,d.return=r,p.return=r,d.sibling=p,r.child=d,(r.mode&1)!==0&&lo(r,n.child,null,S),r.child.memoizedState=cd(S),r.memoizedState=ud,p);if((r.mode&1)===0)return Tl(n,r,S,null);if(h.data==="$!"){if(d=h.nextSibling&&h.nextSibling.dataset,d)var _=d.dgst;return d=_,p=Error(i(419)),d=od(p,d,void 0),Tl(n,r,S,d)}if(_=(S&n.childLanes)!==0,Qt||_){if(d=Tt,d!==null){switch(S&-S){case 4:h=2;break;case 16:h=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:h=32;break;case 536870912:h=268435456;break;default:h=0}h=(h&(d.suspendedLanes|S))!==0?0:h,h!==0&&h!==p.retryLane&&(p.retryLane=h,ui(n,h),Mn(d,n,h,-1))}return Rd(),d=od(Error(i(421))),Tl(n,r,S,d)}return h.data==="$?"?(r.flags|=128,r.child=n.child,r=NA.bind(null,n),h._reactRetry=r,null):(n=p.treeContext,on=Di(h.nextSibling),rn=r,it=!0,Pn=null,n!==null&&(gn[pn++]=ai,gn[pn++]=li,gn[pn++]=pr,ai=n.id,li=n.overflow,pr=r),r=dd(r,d.children),r.flags|=4096,r)}function bp(n,r,l){n.lanes|=r;var d=n.alternate;d!==null&&(d.lanes|=r),$c(n.return,r,l)}function fd(n,r,l,d,h){var p=n.memoizedState;p===null?n.memoizedState={isBackwards:r,rendering:null,renderingStartTime:0,last:d,tail:l,tailMode:h}:(p.isBackwards=r,p.rendering=null,p.renderingStartTime=0,p.last=d,p.tail=l,p.tailMode=h)}function Gp(n,r,l){var d=r.pendingProps,h=d.revealOrder,p=d.tail;if(Gt(n,r,d.children,l),d=ot.current,(d&2)!==0)d=d&1|2,r.flags|=128;else{if(n!==null&&(n.flags&128)!==0)e:for(n=r.child;n!==null;){if(n.tag===13)n.memoizedState!==null&&bp(n,l,r);else if(n.tag===19)bp(n,l,r);else if(n.child!==null){n.child.return=n,n=n.child;continue}if(n===r)break e;for(;n.sibling===null;){if(n.return===null||n.return===r)break e;n=n.return}n.sibling.return=n.return,n=n.sibling}d&=1}if(Xe(ot,d),(r.mode&1)===0)r.memoizedState=null;else switch(h){case"forwards":for(l=r.child,h=null;l!==null;)n=l.alternate,n!==null&&gl(n)===null&&(h=l),l=l.sibling;l=h,l===null?(h=r.child,r.child=null):(h=l.sibling,l.sibling=null),fd(r,!1,h,l,p);break;case"backwards":for(l=null,h=r.child,r.child=null;h!==null;){if(n=h.alternate,n!==null&&gl(n)===null){r.child=h;break}n=h.sibling,h.sibling=l,l=h,h=n}fd(r,!0,l,null,p);break;case"together":fd(r,!1,null,null,void 0);break;default:r.memoizedState=null}return r.child}function Il(n,r){(r.mode&1)===0&&n!==null&&(n.alternate=null,r.alternate=null,r.flags|=2)}function di(n,r,l){if(n!==null&&(r.dependencies=n.dependencies),Ar|=r.lanes,(l&r.childLanes)===0)return null;if(n!==null&&r.child!==n.child)throw Error(i(153));if(r.child!==null){for(n=r.child,l=xi(n,n.pendingProps),r.child=l,l.return=r;n.sibling!==null;)n=n.sibling,l=l.sibling=xi(n,n.pendingProps),l.return=r;l.sibling=null}return r.child}function vA(n,r,l){switch(r.tag){case 3:Up(r),ao();break;case 5:ep(r);break;case 1:qt(r.type)&&rl(r);break;case 4:Yc(r,r.stateNode.containerInfo);break;case 10:var d=r.type._context,h=r.memoizedProps.value;Xe(cl,d._currentValue),d._currentValue=h;break;case 13:if(d=r.memoizedState,d!==null)return d.dehydrated!==null?(Xe(ot,ot.current&1),r.flags|=128,null):(l&r.child.childLanes)!==0?Hp(n,r,l):(Xe(ot,ot.current&1),n=di(n,r,l),n!==null?n.sibling:null);Xe(ot,ot.current&1);break;case 19:if(d=(l&r.childLanes)!==0,(n.flags&128)!==0){if(d)return Gp(n,r,l);r.flags|=128}if(h=r.memoizedState,h!==null&&(h.rendering=null,h.tail=null,h.lastEffect=null),Xe(ot,ot.current),d)break;return null;case 22:case 23:return r.lanes=0,kp(n,r,l)}return di(n,r,l)}var xp,hd,$p,Wp;xp=function(n,r){for(var l=r.child;l!==null;){if(l.tag===5||l.tag===6)n.appendChild(l.stateNode);else if(l.tag!==4&&l.child!==null){l.child.return=l,l=l.child;continue}if(l===r)break;for(;l.sibling===null;){if(l.return===null||l.return===r)return;l=l.return}l.sibling.return=l.return,l=l.sibling}},hd=function(){},$p=function(n,r,l,d){var h=n.memoizedProps;if(h!==d){n=r.stateNode,Sr(jn.current);var p=null;switch(l){case"input":h=nt(n,h),d=nt(n,d),p=[];break;case"select":h=W({},h,{value:void 0}),d=W({},d,{value:void 0}),p=[];break;case"textarea":h=dr(n,h),d=dr(n,d),p=[];break;default:typeof h.onClick!="function"&&typeof d.onClick=="function"&&(n.onclick=tl)}Vu(l,d);var S;l=null;for(U in h)if(!d.hasOwnProperty(U)&&h.hasOwnProperty(U)&&h[U]!=null)if(U==="style"){var _=h[U];for(S in _)_.hasOwnProperty(S)&&(l||(l={}),l[S]="")}else U!=="dangerouslySetInnerHTML"&&U!=="children"&&U!=="suppressContentEditableWarning"&&U!=="suppressHydrationWarning"&&U!=="autoFocus"&&(a.hasOwnProperty(U)?p||(p=[]):(p=p||[]).push(U,null));for(U in d){var R=d[U];if(_=h!=null?h[U]:void 0,d.hasOwnProperty(U)&&R!==_&&(R!=null||_!=null))if(U==="style")if(_){for(S in _)!_.hasOwnProperty(S)||R&&R.hasOwnProperty(S)||(l||(l={}),l[S]="");for(S in R)R.hasOwnProperty(S)&&_[S]!==R[S]&&(l||(l={}),l[S]=R[S])}else l||(p||(p=[]),p.push(U,l)),l=R;else U==="dangerouslySetInnerHTML"?(R=R?R.__html:void 0,_=_?_.__html:void 0,R!=null&&_!==R&&(p=p||[]).push(U,R)):U==="children"?typeof R!="string"&&typeof R!="number"||(p=p||[]).push(U,""+R):U!=="suppressContentEditableWarning"&&U!=="suppressHydrationWarning"&&(a.hasOwnProperty(U)?(R!=null&&U==="onScroll"&&Qe("scroll",n),p||_===R||(p=[])):(p=p||[]).push(U,R))}l&&(p=p||[]).push("style",l);var U=p;(r.updateQueue=U)&&(r.flags|=4)}},Wp=function(n,r,l,d){l!==d&&(r.flags|=4)};function Hs(n,r){if(!it)switch(n.tailMode){case"hidden":r=n.tail;for(var l=null;r!==null;)r.alternate!==null&&(l=r),r=r.sibling;l===null?n.tail=null:l.sibling=null;break;case"collapsed":l=n.tail;for(var d=null;l!==null;)l.alternate!==null&&(d=l),l=l.sibling;d===null?r||n.tail===null?n.tail=null:n.tail.sibling=null:d.sibling=null}}function Ft(n){var r=n.alternate!==null&&n.alternate.child===n.child,l=0,d=0;if(r)for(var h=n.child;h!==null;)l|=h.lanes|h.childLanes,d|=h.subtreeFlags&14680064,d|=h.flags&14680064,h.return=n,h=h.sibling;else for(h=n.child;h!==null;)l|=h.lanes|h.childLanes,d|=h.subtreeFlags,d|=h.flags,h.return=n,h=h.sibling;return n.subtreeFlags|=d,n.childLanes=l,r}function SA(n,r,l){var d=r.pendingProps;switch(Lc(r),r.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Ft(r),null;case 1:return qt(r.type)&&il(),Ft(r),null;case 3:return d=r.stateNode,fo(),Je(Zt),Je(Mt),Xc(),d.pendingContext&&(d.context=d.pendingContext,d.pendingContext=null),(n===null||n.child===null)&&(ll(r)?r.flags|=4:n===null||n.memoizedState.isDehydrated&&(r.flags&256)===0||(r.flags|=1024,Pn!==null&&(Cd(Pn),Pn=null))),hd(n,r),Ft(r),null;case 5:jc(r);var h=Sr(ks.current);if(l=r.type,n!==null&&r.stateNode!=null)$p(n,r,l,d,h),n.ref!==r.ref&&(r.flags|=512,r.flags|=2097152);else{if(!d){if(r.stateNode===null)throw Error(i(166));return Ft(r),null}if(n=Sr(jn.current),ll(r)){d=r.stateNode,l=r.type;var p=r.memoizedProps;switch(d[Yn]=r,d[Ps]=p,n=(r.mode&1)!==0,l){case"dialog":Qe("cancel",d),Qe("close",d);break;case"iframe":case"object":case"embed":Qe("load",d);break;case"video":case"audio":for(h=0;h<ws.length;h++)Qe(ws[h],d);break;case"source":Qe("error",d);break;case"img":case"image":case"link":Qe("error",d),Qe("load",d);break;case"details":Qe("toggle",d);break;case"input":qe(d,p),Qe("invalid",d);break;case"select":d._wrapperState={wasMultiple:!!p.multiple},Qe("invalid",d);break;case"textarea":_h(d,p),Qe("invalid",d)}Vu(l,p),h=null;for(var S in p)if(p.hasOwnProperty(S)){var _=p[S];S==="children"?typeof _=="string"?d.textContent!==_&&(p.suppressHydrationWarning!==!0&&el(d.textContent,_,n),h=["children",_]):typeof _=="number"&&d.textContent!==""+_&&(p.suppressHydrationWarning!==!0&&el(d.textContent,_,n),h=["children",""+_]):a.hasOwnProperty(S)&&_!=null&&S==="onScroll"&&Qe("scroll",d)}switch(l){case"input":Ue(d),hn(d,p,!0);break;case"textarea":Ue(d),Ph(d);break;case"select":case"option":break;default:typeof p.onClick=="function"&&(d.onclick=tl)}d=h,r.updateQueue=d,d!==null&&(r.flags|=4)}else{S=h.nodeType===9?h:h.ownerDocument,n==="http://www.w3.org/1999/xhtml"&&(n=Nh(l)),n==="http://www.w3.org/1999/xhtml"?l==="script"?(n=S.createElement("div"),n.innerHTML="<script><\/script>",n=n.removeChild(n.firstChild)):typeof d.is=="string"?n=S.createElement(l,{is:d.is}):(n=S.createElement(l),l==="select"&&(S=n,d.multiple?S.multiple=!0:d.size&&(S.size=d.size))):n=S.createElementNS(n,l),n[Yn]=r,n[Ps]=d,xp(n,r,!1,!1),r.stateNode=n;e:{switch(S=Xu(l,d),l){case"dialog":Qe("cancel",n),Qe("close",n),h=d;break;case"iframe":case"object":case"embed":Qe("load",n),h=d;break;case"video":case"audio":for(h=0;h<ws.length;h++)Qe(ws[h],n);h=d;break;case"source":Qe("error",n),h=d;break;case"img":case"image":case"link":Qe("error",n),Qe("load",n),h=d;break;case"details":Qe("toggle",n),h=d;break;case"input":qe(n,d),h=nt(n,d),Qe("invalid",n);break;case"option":h=d;break;case"select":n._wrapperState={wasMultiple:!!d.multiple},h=W({},d,{value:void 0}),Qe("invalid",n);break;case"textarea":_h(n,d),h=dr(n,d),Qe("invalid",n);break;default:h=d}Vu(l,h),_=h;for(p in _)if(_.hasOwnProperty(p)){var R=_[p];p==="style"?Mh(n,R):p==="dangerouslySetInnerHTML"?(R=R?R.__html:void 0,R!=null&&Dh(n,R)):p==="children"?typeof R=="string"?(l!=="textarea"||R!=="")&&ss(n,R):typeof R=="number"&&ss(n,""+R):p!=="suppressContentEditableWarning"&&p!=="suppressHydrationWarning"&&p!=="autoFocus"&&(a.hasOwnProperty(p)?R!=null&&p==="onScroll"&&Qe("scroll",n):R!=null&&N(n,p,R,S))}switch(l){case"input":Ue(n),hn(n,d,!1);break;case"textarea":Ue(n),Ph(n);break;case"option":d.value!=null&&n.setAttribute("value",""+Ce(d.value));break;case"select":n.multiple=!!d.multiple,p=d.value,p!=null?Ei(n,!!d.multiple,p,!1):d.defaultValue!=null&&Ei(n,!!d.multiple,d.defaultValue,!0);break;default:typeof h.onClick=="function"&&(n.onclick=tl)}switch(l){case"button":case"input":case"select":case"textarea":d=!!d.autoFocus;break e;case"img":d=!0;break e;default:d=!1}}d&&(r.flags|=4)}r.ref!==null&&(r.flags|=512,r.flags|=2097152)}return Ft(r),null;case 6:if(n&&r.stateNode!=null)Wp(n,r,n.memoizedProps,d);else{if(typeof d!="string"&&r.stateNode===null)throw Error(i(166));if(l=Sr(ks.current),Sr(jn.current),ll(r)){if(d=r.stateNode,l=r.memoizedProps,d[Yn]=r,(p=d.nodeValue!==l)&&(n=rn,n!==null))switch(n.tag){case 3:el(d.nodeValue,l,(n.mode&1)!==0);break;case 5:n.memoizedProps.suppressHydrationWarning!==!0&&el(d.nodeValue,l,(n.mode&1)!==0)}p&&(r.flags|=4)}else d=(l.nodeType===9?l:l.ownerDocument).createTextNode(d),d[Yn]=r,r.stateNode=d}return Ft(r),null;case 13:if(Je(ot),d=r.memoizedState,n===null||n.memoizedState!==null&&n.memoizedState.dehydrated!==null){if(it&&on!==null&&(r.mode&1)!==0&&(r.flags&128)===0)jg(),ao(),r.flags|=98560,p=!1;else if(p=ll(r),d!==null&&d.dehydrated!==null){if(n===null){if(!p)throw Error(i(318));if(p=r.memoizedState,p=p!==null?p.dehydrated:null,!p)throw Error(i(317));p[Yn]=r}else ao(),(r.flags&128)===0&&(r.memoizedState=null),r.flags|=4;Ft(r),p=!1}else Pn!==null&&(Cd(Pn),Pn=null),p=!0;if(!p)return r.flags&65536?r:null}return(r.flags&128)!==0?(r.lanes=l,r):(d=d!==null,d!==(n!==null&&n.memoizedState!==null)&&d&&(r.child.flags|=8192,(r.mode&1)!==0&&(n===null||(ot.current&1)!==0?vt===0&&(vt=3):Rd())),r.updateQueue!==null&&(r.flags|=4),Ft(r),null);case 4:return fo(),hd(n,r),n===null&&_s(r.stateNode.containerInfo),Ft(r),null;case 10:return xc(r.type._context),Ft(r),null;case 17:return qt(r.type)&&il(),Ft(r),null;case 19:if(Je(ot),p=r.memoizedState,p===null)return Ft(r),null;if(d=(r.flags&128)!==0,S=p.rendering,S===null)if(d)Hs(p,!1);else{if(vt!==0||n!==null&&(n.flags&128)!==0)for(n=r.child;n!==null;){if(S=gl(n),S!==null){for(r.flags|=128,Hs(p,!1),d=S.updateQueue,d!==null&&(r.updateQueue=d,r.flags|=4),r.subtreeFlags=0,d=l,l=r.child;l!==null;)p=l,n=d,p.flags&=14680066,S=p.alternate,S===null?(p.childLanes=0,p.lanes=n,p.child=null,p.subtreeFlags=0,p.memoizedProps=null,p.memoizedState=null,p.updateQueue=null,p.dependencies=null,p.stateNode=null):(p.childLanes=S.childLanes,p.lanes=S.lanes,p.child=S.child,p.subtreeFlags=0,p.deletions=null,p.memoizedProps=S.memoizedProps,p.memoizedState=S.memoizedState,p.updateQueue=S.updateQueue,p.type=S.type,n=S.dependencies,p.dependencies=n===null?null:{lanes:n.lanes,firstContext:n.firstContext}),l=l.sibling;return Xe(ot,ot.current&1|2),r.child}n=n.sibling}p.tail!==null&&ut()>mo&&(r.flags|=128,d=!0,Hs(p,!1),r.lanes=4194304)}else{if(!d)if(n=gl(S),n!==null){if(r.flags|=128,d=!0,l=n.updateQueue,l!==null&&(r.updateQueue=l,r.flags|=4),Hs(p,!0),p.tail===null&&p.tailMode==="hidden"&&!S.alternate&&!it)return Ft(r),null}else 2*ut()-p.renderingStartTime>mo&&l!==1073741824&&(r.flags|=128,d=!0,Hs(p,!1),r.lanes=4194304);p.isBackwards?(S.sibling=r.child,r.child=S):(l=p.last,l!==null?l.sibling=S:r.child=S,p.last=S)}return p.tail!==null?(r=p.tail,p.rendering=r,p.tail=r.sibling,p.renderingStartTime=ut(),r.sibling=null,l=ot.current,Xe(ot,d?l&1|2:l&1),r):(Ft(r),null);case 22:case 23:return _d(),d=r.memoizedState!==null,n!==null&&n.memoizedState!==null!==d&&(r.flags|=8192),d&&(r.mode&1)!==0?(sn&1073741824)!==0&&(Ft(r),r.subtreeFlags&6&&(r.flags|=8192)):Ft(r),null;case 24:return null;case 25:return null}throw Error(i(156,r.tag))}function yA(n,r){switch(Lc(r),r.tag){case 1:return qt(r.type)&&il(),n=r.flags,n&65536?(r.flags=n&-65537|128,r):null;case 3:return fo(),Je(Zt),Je(Mt),Xc(),n=r.flags,(n&65536)!==0&&(n&128)===0?(r.flags=n&-65537|128,r):null;case 5:return jc(r),null;case 13:if(Je(ot),n=r.memoizedState,n!==null&&n.dehydrated!==null){if(r.alternate===null)throw Error(i(340));ao()}return n=r.flags,n&65536?(r.flags=n&-65537|128,r):null;case 19:return Je(ot),null;case 4:return fo(),null;case 10:return xc(r.type._context),null;case 22:case 23:return _d(),null;case 24:return null;default:return null}}var El=!1,Lt=!1,AA=typeof WeakSet=="function"?WeakSet:Set,te=null;function go(n,r){var l=n.ref;if(l!==null)if(typeof l=="function")try{l(null)}catch(d){at(n,r,d)}else l.current=null}function gd(n,r,l){try{l()}catch(d){at(n,r,d)}}var zp=!1;function TA(n,r){if(_c=Wa,n=Ig(),Sc(n)){if("selectionStart"in n)var l={start:n.selectionStart,end:n.selectionEnd};else e:{l=(l=n.ownerDocument)&&l.defaultView||window;var d=l.getSelection&&l.getSelection();if(d&&d.rangeCount!==0){l=d.anchorNode;var h=d.anchorOffset,p=d.focusNode;d=d.focusOffset;try{l.nodeType,p.nodeType}catch{l=null;break e}var S=0,_=-1,R=-1,U=0,$=0,z=n,x=null;t:for(;;){for(var q;z!==l||h!==0&&z.nodeType!==3||(_=S+h),z!==p||d!==0&&z.nodeType!==3||(R=S+d),z.nodeType===3&&(S+=z.nodeValue.length),(q=z.firstChild)!==null;)x=z,z=q;for(;;){if(z===n)break t;if(x===l&&++U===h&&(_=S),x===p&&++$===d&&(R=S),(q=z.nextSibling)!==null)break;z=x,x=z.parentNode}z=q}l=_===-1||R===-1?null:{start:_,end:R}}else l=null}l=l||{start:0,end:0}}else l=null;for(Rc={focusedElem:n,selectionRange:l},Wa=!1,te=r;te!==null;)if(r=te,n=r.child,(r.subtreeFlags&1028)!==0&&n!==null)n.return=r,te=n;else for(;te!==null;){r=te;try{var oe=r.alternate;if((r.flags&1024)!==0)switch(r.tag){case 0:case 11:case 15:break;case 1:if(oe!==null){var ue=oe.memoizedProps,ct=oe.memoizedState,O=r.stateNode,D=O.getSnapshotBeforeUpdate(r.elementType===r.type?ue:Nn(r.type,ue),ct);O.__reactInternalSnapshotBeforeUpdate=D}break;case 3:var k=r.stateNode.containerInfo;k.nodeType===1?k.textContent="":k.nodeType===9&&k.documentElement&&k.removeChild(k.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(i(163))}}catch(j){at(r,r.return,j)}if(n=r.sibling,n!==null){n.return=r.return,te=n;break}te=r.return}return oe=zp,zp=!1,oe}function bs(n,r,l){var d=r.updateQueue;if(d=d!==null?d.lastEffect:null,d!==null){var h=d=d.next;do{if((h.tag&n)===n){var p=h.destroy;h.destroy=void 0,p!==void 0&&gd(r,l,p)}h=h.next}while(h!==d)}}function Cl(n,r){if(r=r.updateQueue,r=r!==null?r.lastEffect:null,r!==null){var l=r=r.next;do{if((l.tag&n)===n){var d=l.create;l.destroy=d()}l=l.next}while(l!==r)}}function pd(n){var r=n.ref;if(r!==null){var l=n.stateNode;switch(n.tag){case 5:n=l;break;default:n=l}typeof r=="function"?r(n):r.current=n}}function Yp(n){var r=n.alternate;r!==null&&(n.alternate=null,Yp(r)),n.child=null,n.deletions=null,n.sibling=null,n.tag===5&&(r=n.stateNode,r!==null&&(delete r[Yn],delete r[Ps],delete r[Oc],delete r[iA],delete r[rA])),n.stateNode=null,n.return=null,n.dependencies=null,n.memoizedProps=null,n.memoizedState=null,n.pendingProps=null,n.stateNode=null,n.updateQueue=null}function jp(n){return n.tag===5||n.tag===3||n.tag===4}function Vp(n){e:for(;;){for(;n.sibling===null;){if(n.return===null||jp(n.return))return null;n=n.return}for(n.sibling.return=n.return,n=n.sibling;n.tag!==5&&n.tag!==6&&n.tag!==18;){if(n.flags&2||n.child===null||n.tag===4)continue e;n.child.return=n,n=n.child}if(!(n.flags&2))return n.stateNode}}function md(n,r,l){var d=n.tag;if(d===5||d===6)n=n.stateNode,r?l.nodeType===8?l.parentNode.insertBefore(n,r):l.insertBefore(n,r):(l.nodeType===8?(r=l.parentNode,r.insertBefore(n,l)):(r=l,r.appendChild(n)),l=l._reactRootContainer,l!=null||r.onclick!==null||(r.onclick=tl));else if(d!==4&&(n=n.child,n!==null))for(md(n,r,l),n=n.sibling;n!==null;)md(n,r,l),n=n.sibling}function vd(n,r,l){var d=n.tag;if(d===5||d===6)n=n.stateNode,r?l.insertBefore(n,r):l.appendChild(n);else if(d!==4&&(n=n.child,n!==null))for(vd(n,r,l),n=n.sibling;n!==null;)vd(n,r,l),n=n.sibling}var Rt=null,Dn=!1;function Ui(n,r,l){for(l=l.child;l!==null;)Xp(n,r,l),l=l.sibling}function Xp(n,r,l){if(zn&&typeof zn.onCommitFiberUnmount=="function")try{zn.onCommitFiberUnmount(Ba,l)}catch{}switch(l.tag){case 5:Lt||go(l,r);case 6:var d=Rt,h=Dn;Rt=null,Ui(n,r,l),Rt=d,Dn=h,Rt!==null&&(Dn?(n=Rt,l=l.stateNode,n.nodeType===8?n.parentNode.removeChild(l):n.removeChild(l)):Rt.removeChild(l.stateNode));break;case 18:Rt!==null&&(Dn?(n=Rt,l=l.stateNode,n.nodeType===8?Dc(n.parentNode,l):n.nodeType===1&&Dc(n,l),vs(n)):Dc(Rt,l.stateNode));break;case 4:d=Rt,h=Dn,Rt=l.stateNode.containerInfo,Dn=!0,Ui(n,r,l),Rt=d,Dn=h;break;case 0:case 11:case 14:case 15:if(!Lt&&(d=l.updateQueue,d!==null&&(d=d.lastEffect,d!==null))){h=d=d.next;do{var p=h,S=p.destroy;p=p.tag,S!==void 0&&((p&2)!==0||(p&4)!==0)&&gd(l,r,S),h=h.next}while(h!==d)}Ui(n,r,l);break;case 1:if(!Lt&&(go(l,r),d=l.stateNode,typeof d.componentWillUnmount=="function"))try{d.props=l.memoizedProps,d.state=l.memoizedState,d.componentWillUnmount()}catch(_){at(l,r,_)}Ui(n,r,l);break;case 21:Ui(n,r,l);break;case 22:l.mode&1?(Lt=(d=Lt)||l.memoizedState!==null,Ui(n,r,l),Lt=d):Ui(n,r,l);break;default:Ui(n,r,l)}}function Kp(n){var r=n.updateQueue;if(r!==null){n.updateQueue=null;var l=n.stateNode;l===null&&(l=n.stateNode=new AA),r.forEach(function(d){var h=DA.bind(null,n,d);l.has(d)||(l.add(d),d.then(h,h))})}}function On(n,r){var l=r.deletions;if(l!==null)for(var d=0;d<l.length;d++){var h=l[d];try{var p=n,S=r,_=S;e:for(;_!==null;){switch(_.tag){case 5:Rt=_.stateNode,Dn=!1;break e;case 3:Rt=_.stateNode.containerInfo,Dn=!0;break e;case 4:Rt=_.stateNode.containerInfo,Dn=!0;break e}_=_.return}if(Rt===null)throw Error(i(160));Xp(p,S,h),Rt=null,Dn=!1;var R=h.alternate;R!==null&&(R.return=null),h.return=null}catch(U){at(h,r,U)}}if(r.subtreeFlags&12854)for(r=r.child;r!==null;)Zp(r,n),r=r.sibling}function Zp(n,r){var l=n.alternate,d=n.flags;switch(n.tag){case 0:case 11:case 14:case 15:if(On(r,n),Xn(n),d&4){try{bs(3,n,n.return),Cl(3,n)}catch(ue){at(n,n.return,ue)}try{bs(5,n,n.return)}catch(ue){at(n,n.return,ue)}}break;case 1:On(r,n),Xn(n),d&512&&l!==null&&go(l,l.return);break;case 5:if(On(r,n),Xn(n),d&512&&l!==null&&go(l,l.return),n.flags&32){var h=n.stateNode;try{ss(h,"")}catch(ue){at(n,n.return,ue)}}if(d&4&&(h=n.stateNode,h!=null)){var p=n.memoizedProps,S=l!==null?l.memoizedProps:p,_=n.type,R=n.updateQueue;if(n.updateQueue=null,R!==null)try{_==="input"&&p.type==="radio"&&p.name!=null&&xn(h,p),Xu(_,S);var U=Xu(_,p);for(S=0;S<R.length;S+=2){var $=R[S],z=R[S+1];$==="style"?Mh(h,z):$==="dangerouslySetInnerHTML"?Dh(h,z):$==="children"?ss(h,z):N(h,$,z,U)}switch(_){case"input":Kt(h,p);break;case"textarea":Rh(h,p);break;case"select":var x=h._wrapperState.wasMultiple;h._wrapperState.wasMultiple=!!p.multiple;var q=p.value;q!=null?Ei(h,!!p.multiple,q,!1):x!==!!p.multiple&&(p.defaultValue!=null?Ei(h,!!p.multiple,p.defaultValue,!0):Ei(h,!!p.multiple,p.multiple?[]:"",!1))}h[Ps]=p}catch(ue){at(n,n.return,ue)}}break;case 6:if(On(r,n),Xn(n),d&4){if(n.stateNode===null)throw Error(i(162));h=n.stateNode,p=n.memoizedProps;try{h.nodeValue=p}catch(ue){at(n,n.return,ue)}}break;case 3:if(On(r,n),Xn(n),d&4&&l!==null&&l.memoizedState.isDehydrated)try{vs(r.containerInfo)}catch(ue){at(n,n.return,ue)}break;case 4:On(r,n),Xn(n);break;case 13:On(r,n),Xn(n),h=n.child,h.flags&8192&&(p=h.memoizedState!==null,h.stateNode.isHidden=p,!p||h.alternate!==null&&h.alternate.memoizedState!==null||(Ad=ut())),d&4&&Kp(n);break;case 22:if($=l!==null&&l.memoizedState!==null,n.mode&1?(Lt=(U=Lt)||$,On(r,n),Lt=U):On(r,n),Xn(n),d&8192){if(U=n.memoizedState!==null,(n.stateNode.isHidden=U)&&!$&&(n.mode&1)!==0)for(te=n,$=n.child;$!==null;){for(z=te=$;te!==null;){switch(x=te,q=x.child,x.tag){case 0:case 11:case 14:case 15:bs(4,x,x.return);break;case 1:go(x,x.return);var oe=x.stateNode;if(typeof oe.componentWillUnmount=="function"){d=x,l=x.return;try{r=d,oe.props=r.memoizedProps,oe.state=r.memoizedState,oe.componentWillUnmount()}catch(ue){at(d,l,ue)}}break;case 5:go(x,x.return);break;case 22:if(x.memoizedState!==null){Jp(z);continue}}q!==null?(q.return=x,te=q):Jp(z)}$=$.sibling}e:for($=null,z=n;;){if(z.tag===5){if($===null){$=z;try{h=z.stateNode,U?(p=h.style,typeof p.setProperty=="function"?p.setProperty("display","none","important"):p.display="none"):(_=z.stateNode,R=z.memoizedProps.style,S=R!=null&&R.hasOwnProperty("display")?R.display:null,_.style.display=Oh("display",S))}catch(ue){at(n,n.return,ue)}}}else if(z.tag===6){if($===null)try{z.stateNode.nodeValue=U?"":z.memoizedProps}catch(ue){at(n,n.return,ue)}}else if((z.tag!==22&&z.tag!==23||z.memoizedState===null||z===n)&&z.child!==null){z.child.return=z,z=z.child;continue}if(z===n)break e;for(;z.sibling===null;){if(z.return===null||z.return===n)break e;$===z&&($=null),z=z.return}$===z&&($=null),z.sibling.return=z.return,z=z.sibling}}break;case 19:On(r,n),Xn(n),d&4&&Kp(n);break;case 21:break;default:On(r,n),Xn(n)}}function Xn(n){var r=n.flags;if(r&2){try{e:{for(var l=n.return;l!==null;){if(jp(l)){var d=l;break e}l=l.return}throw Error(i(160))}switch(d.tag){case 5:var h=d.stateNode;d.flags&32&&(ss(h,""),d.flags&=-33);var p=Vp(n);vd(n,p,h);break;case 3:case 4:var S=d.stateNode.containerInfo,_=Vp(n);md(n,_,S);break;default:throw Error(i(161))}}catch(R){at(n,n.return,R)}n.flags&=-3}r&4096&&(n.flags&=-4097)}function IA(n,r,l){te=n,qp(n)}function qp(n,r,l){for(var d=(n.mode&1)!==0;te!==null;){var h=te,p=h.child;if(h.tag===22&&d){var S=h.memoizedState!==null||El;if(!S){var _=h.alternate,R=_!==null&&_.memoizedState!==null||Lt;_=El;var U=Lt;if(El=S,(Lt=R)&&!U)for(te=h;te!==null;)S=te,R=S.child,S.tag===22&&S.memoizedState!==null?em(h):R!==null?(R.return=S,te=R):em(h);for(;p!==null;)te=p,qp(p),p=p.sibling;te=h,El=_,Lt=U}Qp(n)}else(h.subtreeFlags&8772)!==0&&p!==null?(p.return=h,te=p):Qp(n)}}function Qp(n){for(;te!==null;){var r=te;if((r.flags&8772)!==0){var l=r.alternate;try{if((r.flags&8772)!==0)switch(r.tag){case 0:case 11:case 15:Lt||Cl(5,r);break;case 1:var d=r.stateNode;if(r.flags&4&&!Lt)if(l===null)d.componentDidMount();else{var h=r.elementType===r.type?l.memoizedProps:Nn(r.type,l.memoizedProps);d.componentDidUpdate(h,l.memoizedState,d.__reactInternalSnapshotBeforeUpdate)}var p=r.updateQueue;p!==null&&Jg(r,p,d);break;case 3:var S=r.updateQueue;if(S!==null){if(l=null,r.child!==null)switch(r.child.tag){case 5:l=r.child.stateNode;break;case 1:l=r.child.stateNode}Jg(r,S,l)}break;case 5:var _=r.stateNode;if(l===null&&r.flags&4){l=_;var R=r.memoizedProps;switch(r.type){case"button":case"input":case"select":case"textarea":R.autoFocus&&l.focus();break;case"img":R.src&&(l.src=R.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(r.memoizedState===null){var U=r.alternate;if(U!==null){var $=U.memoizedState;if($!==null){var z=$.dehydrated;z!==null&&vs(z)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(i(163))}Lt||r.flags&512&&pd(r)}catch(x){at(r,r.return,x)}}if(r===n){te=null;break}if(l=r.sibling,l!==null){l.return=r.return,te=l;break}te=r.return}}function Jp(n){for(;te!==null;){var r=te;if(r===n){te=null;break}var l=r.sibling;if(l!==null){l.return=r.return,te=l;break}te=r.return}}function em(n){for(;te!==null;){var r=te;try{switch(r.tag){case 0:case 11:case 15:var l=r.return;try{Cl(4,r)}catch(R){at(r,l,R)}break;case 1:var d=r.stateNode;if(typeof d.componentDidMount=="function"){var h=r.return;try{d.componentDidMount()}catch(R){at(r,h,R)}}var p=r.return;try{pd(r)}catch(R){at(r,p,R)}break;case 5:var S=r.return;try{pd(r)}catch(R){at(r,S,R)}}}catch(R){at(r,r.return,R)}if(r===n){te=null;break}var _=r.sibling;if(_!==null){_.return=r.return,te=_;break}te=r.return}}var EA=Math.ceil,wl=b.ReactCurrentDispatcher,Sd=b.ReactCurrentOwner,Sn=b.ReactCurrentBatchConfig,Ge=0,Tt=null,ht=null,Pt=0,sn=0,po=Oi(0),vt=0,Gs=null,Ar=0,_l=0,yd=0,xs=null,Jt=null,Ad=0,mo=1/0,fi=null,Rl=!1,Td=null,Bi=null,Pl=!1,Hi=null,Nl=0,$s=0,Id=null,Dl=-1,Ol=0;function xt(){return(Ge&6)!==0?ut():Dl!==-1?Dl:Dl=ut()}function bi(n){return(n.mode&1)===0?1:(Ge&2)!==0&&Pt!==0?Pt&-Pt:sA.transition!==null?(Ol===0&&(Ol=Vh()),Ol):(n=ze,n!==0||(n=window.event,n=n===void 0?16:ng(n.type)),n)}function Mn(n,r,l,d){if(50<$s)throw $s=0,Id=null,Error(i(185));fs(n,l,d),((Ge&2)===0||n!==Tt)&&(n===Tt&&((Ge&2)===0&&(_l|=l),vt===4&&Gi(n,Pt)),en(n,d),l===1&&Ge===0&&(r.mode&1)===0&&(mo=ut()+500,ol&&ki()))}function en(n,r){var l=n.callbackNode;sy(n,r);var d=Ga(n,n===Tt?Pt:0);if(d===0)l!==null&&zh(l),n.callbackNode=null,n.callbackPriority=0;else if(r=d&-d,n.callbackPriority!==r){if(l!=null&&zh(l),r===1)n.tag===0?oA(nm.bind(null,n)):xg(nm.bind(null,n)),tA(function(){(Ge&6)===0&&ki()}),l=null;else{switch(Xh(d)){case 1:l=tc;break;case 4:l=Yh;break;case 16:l=Ua;break;case 536870912:l=jh;break;default:l=Ua}l=cm(l,tm.bind(null,n))}n.callbackPriority=r,n.callbackNode=l}}function tm(n,r){if(Dl=-1,Ol=0,(Ge&6)!==0)throw Error(i(327));var l=n.callbackNode;if(vo()&&n.callbackNode!==l)return null;var d=Ga(n,n===Tt?Pt:0);if(d===0)return null;if((d&30)!==0||(d&n.expiredLanes)!==0||r)r=Ml(n,d);else{r=d;var h=Ge;Ge|=2;var p=rm();(Tt!==n||Pt!==r)&&(fi=null,mo=ut()+500,Ir(n,r));do try{_A();break}catch(_){im(n,_)}while(!0);Gc(),wl.current=p,Ge=h,ht!==null?r=0:(Tt=null,Pt=0,r=vt)}if(r!==0){if(r===2&&(h=nc(n),h!==0&&(d=h,r=Ed(n,h))),r===1)throw l=Gs,Ir(n,0),Gi(n,d),en(n,ut()),l;if(r===6)Gi(n,d);else{if(h=n.current.alternate,(d&30)===0&&!CA(h)&&(r=Ml(n,d),r===2&&(p=nc(n),p!==0&&(d=p,r=Ed(n,p))),r===1))throw l=Gs,Ir(n,0),Gi(n,d),en(n,ut()),l;switch(n.finishedWork=h,n.finishedLanes=d,r){case 0:case 1:throw Error(i(345));case 2:Er(n,Jt,fi);break;case 3:if(Gi(n,d),(d&130023424)===d&&(r=Ad+500-ut(),10<r)){if(Ga(n,0)!==0)break;if(h=n.suspendedLanes,(h&d)!==d){xt(),n.pingedLanes|=n.suspendedLanes&h;break}n.timeoutHandle=Nc(Er.bind(null,n,Jt,fi),r);break}Er(n,Jt,fi);break;case 4:if(Gi(n,d),(d&4194240)===d)break;for(r=n.eventTimes,h=-1;0<d;){var S=31-_n(d);p=1<<S,S=r[S],S>h&&(h=S),d&=~p}if(d=h,d=ut()-d,d=(120>d?120:480>d?480:1080>d?1080:1920>d?1920:3e3>d?3e3:4320>d?4320:1960*EA(d/1960))-d,10<d){n.timeoutHandle=Nc(Er.bind(null,n,Jt,fi),d);break}Er(n,Jt,fi);break;case 5:Er(n,Jt,fi);break;default:throw Error(i(329))}}}return en(n,ut()),n.callbackNode===l?tm.bind(null,n):null}function Ed(n,r){var l=xs;return n.current.memoizedState.isDehydrated&&(Ir(n,r).flags|=256),n=Ml(n,r),n!==2&&(r=Jt,Jt=l,r!==null&&Cd(r)),n}function Cd(n){Jt===null?Jt=n:Jt.push.apply(Jt,n)}function CA(n){for(var r=n;;){if(r.flags&16384){var l=r.updateQueue;if(l!==null&&(l=l.stores,l!==null))for(var d=0;d<l.length;d++){var h=l[d],p=h.getSnapshot;h=h.value;try{if(!Rn(p(),h))return!1}catch{return!1}}}if(l=r.child,r.subtreeFlags&16384&&l!==null)l.return=r,r=l;else{if(r===n)break;for(;r.sibling===null;){if(r.return===null||r.return===n)return!0;r=r.return}r.sibling.return=r.return,r=r.sibling}}return!0}function Gi(n,r){for(r&=~yd,r&=~_l,n.suspendedLanes|=r,n.pingedLanes&=~r,n=n.expirationTimes;0<r;){var l=31-_n(r),d=1<<l;n[l]=-1,r&=~d}}function nm(n){if((Ge&6)!==0)throw Error(i(327));vo();var r=Ga(n,0);if((r&1)===0)return en(n,ut()),null;var l=Ml(n,r);if(n.tag!==0&&l===2){var d=nc(n);d!==0&&(r=d,l=Ed(n,d))}if(l===1)throw l=Gs,Ir(n,0),Gi(n,r),en(n,ut()),l;if(l===6)throw Error(i(345));return n.finishedWork=n.current.alternate,n.finishedLanes=r,Er(n,Jt,fi),en(n,ut()),null}function wd(n,r){var l=Ge;Ge|=1;try{return n(r)}finally{Ge=l,Ge===0&&(mo=ut()+500,ol&&ki())}}function Tr(n){Hi!==null&&Hi.tag===0&&(Ge&6)===0&&vo();var r=Ge;Ge|=1;var l=Sn.transition,d=ze;try{if(Sn.transition=null,ze=1,n)return n()}finally{ze=d,Sn.transition=l,Ge=r,(Ge&6)===0&&ki()}}function _d(){sn=po.current,Je(po)}function Ir(n,r){n.finishedWork=null,n.finishedLanes=0;var l=n.timeoutHandle;if(l!==-1&&(n.timeoutHandle=-1,eA(l)),ht!==null)for(l=ht.return;l!==null;){var d=l;switch(Lc(d),d.tag){case 1:d=d.type.childContextTypes,d!=null&&il();break;case 3:fo(),Je(Zt),Je(Mt),Xc();break;case 5:jc(d);break;case 4:fo();break;case 13:Je(ot);break;case 19:Je(ot);break;case 10:xc(d.type._context);break;case 22:case 23:_d()}l=l.return}if(Tt=n,ht=n=xi(n.current,null),Pt=sn=r,vt=0,Gs=null,yd=_l=Ar=0,Jt=xs=null,vr!==null){for(r=0;r<vr.length;r++)if(l=vr[r],d=l.interleaved,d!==null){l.interleaved=null;var h=d.next,p=l.pending;if(p!==null){var S=p.next;p.next=h,d.next=S}l.pending=d}vr=null}return n}function im(n,r){do{var l=ht;try{if(Gc(),pl.current=yl,ml){for(var d=st.memoizedState;d!==null;){var h=d.queue;h!==null&&(h.pending=null),d=d.next}ml=!1}if(yr=0,At=mt=st=null,Fs=!1,Ls=0,Sd.current=null,l===null||l.return===null){vt=1,Gs=r,ht=null;break}e:{var p=n,S=l.return,_=l,R=r;if(r=Pt,_.flags|=32768,R!==null&&typeof R=="object"&&typeof R.then=="function"){var U=R,$=_,z=$.tag;if(($.mode&1)===0&&(z===0||z===11||z===15)){var x=$.alternate;x?($.updateQueue=x.updateQueue,$.memoizedState=x.memoizedState,$.lanes=x.lanes):($.updateQueue=null,$.memoizedState=null)}var q=Pp(S);if(q!==null){q.flags&=-257,Np(q,S,_,p,r),q.mode&1&&Rp(p,U,r),r=q,R=U;var oe=r.updateQueue;if(oe===null){var ue=new Set;ue.add(R),r.updateQueue=ue}else oe.add(R);break e}else{if((r&1)===0){Rp(p,U,r),Rd();break e}R=Error(i(426))}}else if(it&&_.mode&1){var ct=Pp(S);if(ct!==null){(ct.flags&65536)===0&&(ct.flags|=256),Np(ct,S,_,p,r),Hc(ho(R,_));break e}}p=R=ho(R,_),vt!==4&&(vt=2),xs===null?xs=[p]:xs.push(p),p=S;do{switch(p.tag){case 3:p.flags|=65536,r&=-r,p.lanes|=r;var O=wp(p,R,r);Qg(p,O);break e;case 1:_=R;var D=p.type,k=p.stateNode;if((p.flags&128)===0&&(typeof D.getDerivedStateFromError=="function"||k!==null&&typeof k.componentDidCatch=="function"&&(Bi===null||!Bi.has(k)))){p.flags|=65536,r&=-r,p.lanes|=r;var j=_p(p,_,r);Qg(p,j);break e}}p=p.return}while(p!==null)}sm(l)}catch(fe){r=fe,ht===l&&l!==null&&(ht=l=l.return);continue}break}while(!0)}function rm(){var n=wl.current;return wl.current=yl,n===null?yl:n}function Rd(){(vt===0||vt===3||vt===2)&&(vt=4),Tt===null||(Ar&268435455)===0&&(_l&268435455)===0||Gi(Tt,Pt)}function Ml(n,r){var l=Ge;Ge|=2;var d=rm();(Tt!==n||Pt!==r)&&(fi=null,Ir(n,r));do try{wA();break}catch(h){im(n,h)}while(!0);if(Gc(),Ge=l,wl.current=d,ht!==null)throw Error(i(261));return Tt=null,Pt=0,vt}function wA(){for(;ht!==null;)om(ht)}function _A(){for(;ht!==null&&!qS();)om(ht)}function om(n){var r=um(n.alternate,n,sn);n.memoizedProps=n.pendingProps,r===null?sm(n):ht=r,Sd.current=null}function sm(n){var r=n;do{var l=r.alternate;if(n=r.return,(r.flags&32768)===0){if(l=SA(l,r,sn),l!==null){ht=l;return}}else{if(l=yA(l,r),l!==null){l.flags&=32767,ht=l;return}if(n!==null)n.flags|=32768,n.subtreeFlags=0,n.deletions=null;else{vt=6,ht=null;return}}if(r=r.sibling,r!==null){ht=r;return}ht=r=n}while(r!==null);vt===0&&(vt=5)}function Er(n,r,l){var d=ze,h=Sn.transition;try{Sn.transition=null,ze=1,RA(n,r,l,d)}finally{Sn.transition=h,ze=d}return null}function RA(n,r,l,d){do vo();while(Hi!==null);if((Ge&6)!==0)throw Error(i(327));l=n.finishedWork;var h=n.finishedLanes;if(l===null)return null;if(n.finishedWork=null,n.finishedLanes=0,l===n.current)throw Error(i(177));n.callbackNode=null,n.callbackPriority=0;var p=l.lanes|l.childLanes;if(ay(n,p),n===Tt&&(ht=Tt=null,Pt=0),(l.subtreeFlags&2064)===0&&(l.flags&2064)===0||Pl||(Pl=!0,cm(Ua,function(){return vo(),null})),p=(l.flags&15990)!==0,(l.subtreeFlags&15990)!==0||p){p=Sn.transition,Sn.transition=null;var S=ze;ze=1;var _=Ge;Ge|=4,Sd.current=null,TA(n,l),Zp(l,n),Vy(Rc),Wa=!!_c,Rc=_c=null,n.current=l,IA(l),QS(),Ge=_,ze=S,Sn.transition=p}else n.current=l;if(Pl&&(Pl=!1,Hi=n,Nl=h),p=n.pendingLanes,p===0&&(Bi=null),ty(l.stateNode),en(n,ut()),r!==null)for(d=n.onRecoverableError,l=0;l<r.length;l++)h=r[l],d(h.value,{componentStack:h.stack,digest:h.digest});if(Rl)throw Rl=!1,n=Td,Td=null,n;return(Nl&1)!==0&&n.tag!==0&&vo(),p=n.pendingLanes,(p&1)!==0?n===Id?$s++:($s=0,Id=n):$s=0,ki(),null}function vo(){if(Hi!==null){var n=Xh(Nl),r=Sn.transition,l=ze;try{if(Sn.transition=null,ze=16>n?16:n,Hi===null)var d=!1;else{if(n=Hi,Hi=null,Nl=0,(Ge&6)!==0)throw Error(i(331));var h=Ge;for(Ge|=4,te=n.current;te!==null;){var p=te,S=p.child;if((te.flags&16)!==0){var _=p.deletions;if(_!==null){for(var R=0;R<_.length;R++){var U=_[R];for(te=U;te!==null;){var $=te;switch($.tag){case 0:case 11:case 15:bs(8,$,p)}var z=$.child;if(z!==null)z.return=$,te=z;else for(;te!==null;){$=te;var x=$.sibling,q=$.return;if(Yp($),$===U){te=null;break}if(x!==null){x.return=q,te=x;break}te=q}}}var oe=p.alternate;if(oe!==null){var ue=oe.child;if(ue!==null){oe.child=null;do{var ct=ue.sibling;ue.sibling=null,ue=ct}while(ue!==null)}}te=p}}if((p.subtreeFlags&2064)!==0&&S!==null)S.return=p,te=S;else e:for(;te!==null;){if(p=te,(p.flags&2048)!==0)switch(p.tag){case 0:case 11:case 15:bs(9,p,p.return)}var O=p.sibling;if(O!==null){O.return=p.return,te=O;break e}te=p.return}}var D=n.current;for(te=D;te!==null;){S=te;var k=S.child;if((S.subtreeFlags&2064)!==0&&k!==null)k.return=S,te=k;else e:for(S=D;te!==null;){if(_=te,(_.flags&2048)!==0)try{switch(_.tag){case 0:case 11:case 15:Cl(9,_)}}catch(fe){at(_,_.return,fe)}if(_===S){te=null;break e}var j=_.sibling;if(j!==null){j.return=_.return,te=j;break e}te=_.return}}if(Ge=h,ki(),zn&&typeof zn.onPostCommitFiberRoot=="function")try{zn.onPostCommitFiberRoot(Ba,n)}catch{}d=!0}return d}finally{ze=l,Sn.transition=r}}return!1}function am(n,r,l){r=ho(l,r),r=wp(n,r,1),n=Li(n,r,1),r=xt(),n!==null&&(fs(n,1,r),en(n,r))}function at(n,r,l){if(n.tag===3)am(n,n,l);else for(;r!==null;){if(r.tag===3){am(r,n,l);break}else if(r.tag===1){var d=r.stateNode;if(typeof r.type.getDerivedStateFromError=="function"||typeof d.componentDidCatch=="function"&&(Bi===null||!Bi.has(d))){n=ho(l,n),n=_p(r,n,1),r=Li(r,n,1),n=xt(),r!==null&&(fs(r,1,n),en(r,n));break}}r=r.return}}function PA(n,r,l){var d=n.pingCache;d!==null&&d.delete(r),r=xt(),n.pingedLanes|=n.suspendedLanes&l,Tt===n&&(Pt&l)===l&&(vt===4||vt===3&&(Pt&130023424)===Pt&&500>ut()-Ad?Ir(n,0):yd|=l),en(n,r)}function lm(n,r){r===0&&((n.mode&1)===0?r=1:(r=ba,ba<<=1,(ba&130023424)===0&&(ba=4194304)));var l=xt();n=ui(n,r),n!==null&&(fs(n,r,l),en(n,l))}function NA(n){var r=n.memoizedState,l=0;r!==null&&(l=r.retryLane),lm(n,l)}function DA(n,r){var l=0;switch(n.tag){case 13:var d=n.stateNode,h=n.memoizedState;h!==null&&(l=h.retryLane);break;case 19:d=n.stateNode;break;default:throw Error(i(314))}d!==null&&d.delete(r),lm(n,l)}var um;um=function(n,r,l){if(n!==null)if(n.memoizedProps!==r.pendingProps||Zt.current)Qt=!0;else{if((n.lanes&l)===0&&(r.flags&128)===0)return Qt=!1,vA(n,r,l);Qt=(n.flags&131072)!==0}else Qt=!1,it&&(r.flags&1048576)!==0&&$g(r,al,r.index);switch(r.lanes=0,r.tag){case 2:var d=r.type;Il(n,r),n=r.pendingProps;var h=ro(r,Mt.current);co(r,l),h=qc(null,r,d,n,h,l);var p=Qc();return r.flags|=1,typeof h=="object"&&h!==null&&typeof h.render=="function"&&h.$$typeof===void 0?(r.tag=1,r.memoizedState=null,r.updateQueue=null,qt(d)?(p=!0,rl(r)):p=!1,r.memoizedState=h.state!==null&&h.state!==void 0?h.state:null,zc(r),h.updater=Al,r.stateNode=h,h._reactInternals=r,rd(r,d,n,l),r=ld(null,r,d,!0,p,l)):(r.tag=0,it&&p&&Fc(r),Gt(null,r,h,l),r=r.child),r;case 16:d=r.elementType;e:{switch(Il(n,r),n=r.pendingProps,h=d._init,d=h(d._payload),r.type=d,h=r.tag=MA(d),n=Nn(d,n),h){case 0:r=ad(null,r,d,n,l);break e;case 1:r=Lp(null,r,d,n,l);break e;case 11:r=Dp(null,r,d,n,l);break e;case 14:r=Op(null,r,d,Nn(d.type,n),l);break e}throw Error(i(306,d,""))}return r;case 0:return d=r.type,h=r.pendingProps,h=r.elementType===d?h:Nn(d,h),ad(n,r,d,h,l);case 1:return d=r.type,h=r.pendingProps,h=r.elementType===d?h:Nn(d,h),Lp(n,r,d,h,l);case 3:e:{if(Up(r),n===null)throw Error(i(387));d=r.pendingProps,p=r.memoizedState,h=p.element,qg(n,r),hl(r,d,null,l);var S=r.memoizedState;if(d=S.element,p.isDehydrated)if(p={element:d,isDehydrated:!1,cache:S.cache,pendingSuspenseBoundaries:S.pendingSuspenseBoundaries,transitions:S.transitions},r.updateQueue.baseState=p,r.memoizedState=p,r.flags&256){h=ho(Error(i(423)),r),r=Bp(n,r,d,l,h);break e}else if(d!==h){h=ho(Error(i(424)),r),r=Bp(n,r,d,l,h);break e}else for(on=Di(r.stateNode.containerInfo.firstChild),rn=r,it=!0,Pn=null,l=Kg(r,null,d,l),r.child=l;l;)l.flags=l.flags&-3|4096,l=l.sibling;else{if(ao(),d===h){r=di(n,r,l);break e}Gt(n,r,d,l)}r=r.child}return r;case 5:return ep(r),n===null&&Bc(r),d=r.type,h=r.pendingProps,p=n!==null?n.memoizedProps:null,S=h.children,Pc(d,h)?S=null:p!==null&&Pc(d,p)&&(r.flags|=32),Fp(n,r),Gt(n,r,S,l),r.child;case 6:return n===null&&Bc(r),null;case 13:return Hp(n,r,l);case 4:return Yc(r,r.stateNode.containerInfo),d=r.pendingProps,n===null?r.child=lo(r,null,d,l):Gt(n,r,d,l),r.child;case 11:return d=r.type,h=r.pendingProps,h=r.elementType===d?h:Nn(d,h),Dp(n,r,d,h,l);case 7:return Gt(n,r,r.pendingProps,l),r.child;case 8:return Gt(n,r,r.pendingProps.children,l),r.child;case 12:return Gt(n,r,r.pendingProps.children,l),r.child;case 10:e:{if(d=r.type._context,h=r.pendingProps,p=r.memoizedProps,S=h.value,Xe(cl,d._currentValue),d._currentValue=S,p!==null)if(Rn(p.value,S)){if(p.children===h.children&&!Zt.current){r=di(n,r,l);break e}}else for(p=r.child,p!==null&&(p.return=r);p!==null;){var _=p.dependencies;if(_!==null){S=p.child;for(var R=_.firstContext;R!==null;){if(R.context===d){if(p.tag===1){R=ci(-1,l&-l),R.tag=2;var U=p.updateQueue;if(U!==null){U=U.shared;var $=U.pending;$===null?R.next=R:(R.next=$.next,$.next=R),U.pending=R}}p.lanes|=l,R=p.alternate,R!==null&&(R.lanes|=l),$c(p.return,l,r),_.lanes|=l;break}R=R.next}}else if(p.tag===10)S=p.type===r.type?null:p.child;else if(p.tag===18){if(S=p.return,S===null)throw Error(i(341));S.lanes|=l,_=S.alternate,_!==null&&(_.lanes|=l),$c(S,l,r),S=p.sibling}else S=p.child;if(S!==null)S.return=p;else for(S=p;S!==null;){if(S===r){S=null;break}if(p=S.sibling,p!==null){p.return=S.return,S=p;break}S=S.return}p=S}Gt(n,r,h.children,l),r=r.child}return r;case 9:return h=r.type,d=r.pendingProps.children,co(r,l),h=mn(h),d=d(h),r.flags|=1,Gt(n,r,d,l),r.child;case 14:return d=r.type,h=Nn(d,r.pendingProps),h=Nn(d.type,h),Op(n,r,d,h,l);case 15:return Mp(n,r,r.type,r.pendingProps,l);case 17:return d=r.type,h=r.pendingProps,h=r.elementType===d?h:Nn(d,h),Il(n,r),r.tag=1,qt(d)?(n=!0,rl(r)):n=!1,co(r,l),Ep(r,d,h),rd(r,d,h,l),ld(null,r,d,!0,n,l);case 19:return Gp(n,r,l);case 22:return kp(n,r,l)}throw Error(i(156,r.tag))};function cm(n,r){return Wh(n,r)}function OA(n,r,l,d){this.tag=n,this.key=l,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=r,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=d,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function yn(n,r,l,d){return new OA(n,r,l,d)}function Pd(n){return n=n.prototype,!(!n||!n.isReactComponent)}function MA(n){if(typeof n=="function")return Pd(n)?1:0;if(n!=null){if(n=n.$$typeof,n===De)return 11;if(n===Be)return 14}return 2}function xi(n,r){var l=n.alternate;return l===null?(l=yn(n.tag,r,n.key,n.mode),l.elementType=n.elementType,l.type=n.type,l.stateNode=n.stateNode,l.alternate=n,n.alternate=l):(l.pendingProps=r,l.type=n.type,l.flags=0,l.subtreeFlags=0,l.deletions=null),l.flags=n.flags&14680064,l.childLanes=n.childLanes,l.lanes=n.lanes,l.child=n.child,l.memoizedProps=n.memoizedProps,l.memoizedState=n.memoizedState,l.updateQueue=n.updateQueue,r=n.dependencies,l.dependencies=r===null?null:{lanes:r.lanes,firstContext:r.firstContext},l.sibling=n.sibling,l.index=n.index,l.ref=n.ref,l}function kl(n,r,l,d,h,p){var S=2;if(d=n,typeof n=="function")Pd(n)&&(S=1);else if(typeof n=="string")S=5;else e:switch(n){case G:return Cr(l.children,h,p,r);case Q:S=8,h|=8;break;case re:return n=yn(12,l,r,h|2),n.elementType=re,n.lanes=p,n;case Te:return n=yn(13,l,r,h),n.elementType=Te,n.lanes=p,n;case de:return n=yn(19,l,r,h),n.elementType=de,n.lanes=p,n;case le:return Fl(l,h,p,r);default:if(typeof n=="object"&&n!==null)switch(n.$$typeof){case ve:S=10;break e;case be:S=9;break e;case De:S=11;break e;case Be:S=14;break e;case Ae:S=16,d=null;break e}throw Error(i(130,n==null?n:typeof n,""))}return r=yn(S,l,r,h),r.elementType=n,r.type=d,r.lanes=p,r}function Cr(n,r,l,d){return n=yn(7,n,d,r),n.lanes=l,n}function Fl(n,r,l,d){return n=yn(22,n,d,r),n.elementType=le,n.lanes=l,n.stateNode={isHidden:!1},n}function Nd(n,r,l){return n=yn(6,n,null,r),n.lanes=l,n}function Dd(n,r,l){return r=yn(4,n.children!==null?n.children:[],n.key,r),r.lanes=l,r.stateNode={containerInfo:n.containerInfo,pendingChildren:null,implementation:n.implementation},r}function kA(n,r,l,d,h){this.tag=r,this.containerInfo=n,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=ic(0),this.expirationTimes=ic(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=ic(0),this.identifierPrefix=d,this.onRecoverableError=h,this.mutableSourceEagerHydrationData=null}function Od(n,r,l,d,h,p,S,_,R){return n=new kA(n,r,l,_,R),r===1?(r=1,p===!0&&(r|=8)):r=0,p=yn(3,null,null,r),n.current=p,p.stateNode=n,p.memoizedState={element:d,isDehydrated:l,cache:null,transitions:null,pendingSuspenseBoundaries:null},zc(p),n}function FA(n,r,l){var d=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:L,key:d==null?null:""+d,children:n,containerInfo:r,implementation:l}}function dm(n){if(!n)return Mi;n=n._reactInternals;e:{if(fr(n)!==n||n.tag!==1)throw Error(i(170));var r=n;do{switch(r.tag){case 3:r=r.stateNode.context;break e;case 1:if(qt(r.type)){r=r.stateNode.__reactInternalMemoizedMergedChildContext;break e}}r=r.return}while(r!==null);throw Error(i(171))}if(n.tag===1){var l=n.type;if(qt(l))return bg(n,l,r)}return r}function fm(n,r,l,d,h,p,S,_,R){return n=Od(l,d,!0,n,h,p,S,_,R),n.context=dm(null),l=n.current,d=xt(),h=bi(l),p=ci(d,h),p.callback=r??null,Li(l,p,h),n.current.lanes=h,fs(n,h,d),en(n,d),n}function Ll(n,r,l,d){var h=r.current,p=xt(),S=bi(h);return l=dm(l),r.context===null?r.context=l:r.pendingContext=l,r=ci(p,S),r.payload={element:n},d=d===void 0?null:d,d!==null&&(r.callback=d),n=Li(h,r,S),n!==null&&(Mn(n,h,S,p),fl(n,h,S)),S}function Ul(n){if(n=n.current,!n.child)return null;switch(n.child.tag){case 5:return n.child.stateNode;default:return n.child.stateNode}}function hm(n,r){if(n=n.memoizedState,n!==null&&n.dehydrated!==null){var l=n.retryLane;n.retryLane=l!==0&&l<r?l:r}}function Md(n,r){hm(n,r),(n=n.alternate)&&hm(n,r)}function LA(){return null}var gm=typeof reportError=="function"?reportError:function(n){console.error(n)};function kd(n){this._internalRoot=n}Bl.prototype.render=kd.prototype.render=function(n){var r=this._internalRoot;if(r===null)throw Error(i(409));Ll(n,r,null,null)},Bl.prototype.unmount=kd.prototype.unmount=function(){var n=this._internalRoot;if(n!==null){this._internalRoot=null;var r=n.containerInfo;Tr(function(){Ll(null,n,null,null)}),r[oi]=null}};function Bl(n){this._internalRoot=n}Bl.prototype.unstable_scheduleHydration=function(n){if(n){var r=qh();n={blockedOn:null,target:n,priority:r};for(var l=0;l<Ri.length&&r!==0&&r<Ri[l].priority;l++);Ri.splice(l,0,n),l===0&&eg(n)}};function Fd(n){return!(!n||n.nodeType!==1&&n.nodeType!==9&&n.nodeType!==11)}function Hl(n){return!(!n||n.nodeType!==1&&n.nodeType!==9&&n.nodeType!==11&&(n.nodeType!==8||n.nodeValue!==" react-mount-point-unstable "))}function pm(){}function UA(n,r,l,d,h){if(h){if(typeof d=="function"){var p=d;d=function(){var U=Ul(S);p.call(U)}}var S=fm(r,d,n,0,null,!1,!1,"",pm);return n._reactRootContainer=S,n[oi]=S.current,_s(n.nodeType===8?n.parentNode:n),Tr(),S}for(;h=n.lastChild;)n.removeChild(h);if(typeof d=="function"){var _=d;d=function(){var U=Ul(R);_.call(U)}}var R=Od(n,0,!1,null,null,!1,!1,"",pm);return n._reactRootContainer=R,n[oi]=R.current,_s(n.nodeType===8?n.parentNode:n),Tr(function(){Ll(r,R,l,d)}),R}function bl(n,r,l,d,h){var p=l._reactRootContainer;if(p){var S=p;if(typeof h=="function"){var _=h;h=function(){var R=Ul(S);_.call(R)}}Ll(r,S,n,h)}else S=UA(l,r,n,h,d);return Ul(S)}Kh=function(n){switch(n.tag){case 3:var r=n.stateNode;if(r.current.memoizedState.isDehydrated){var l=ds(r.pendingLanes);l!==0&&(rc(r,l|1),en(r,ut()),(Ge&6)===0&&(mo=ut()+500,ki()))}break;case 13:Tr(function(){var d=ui(n,1);if(d!==null){var h=xt();Mn(d,n,1,h)}}),Md(n,1)}},oc=function(n){if(n.tag===13){var r=ui(n,134217728);if(r!==null){var l=xt();Mn(r,n,134217728,l)}Md(n,134217728)}},Zh=function(n){if(n.tag===13){var r=bi(n),l=ui(n,r);if(l!==null){var d=xt();Mn(l,n,r,d)}Md(n,r)}},qh=function(){return ze},Qh=function(n,r){var l=ze;try{return ze=n,r()}finally{ze=l}},qu=function(n,r,l){switch(r){case"input":if(Kt(n,l),r=l.name,l.type==="radio"&&r!=null){for(l=n;l.parentNode;)l=l.parentNode;for(l=l.querySelectorAll("input[name="+JSON.stringify(""+r)+'][type="radio"]'),r=0;r<l.length;r++){var d=l[r];if(d!==n&&d.form===n.form){var h=nl(d);if(!h)throw Error(i(90));me(d),Kt(d,h)}}}break;case"textarea":Rh(n,l);break;case"select":r=l.value,r!=null&&Ei(n,!!l.multiple,r,!1)}},Uh=wd,Bh=Tr;var BA={usingClientEntryPoint:!1,Events:[Ns,no,nl,Fh,Lh,wd]},Ws={findFiberByHostInstance:hr,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},HA={bundleType:Ws.bundleType,version:Ws.version,rendererPackageName:Ws.rendererPackageName,rendererConfig:Ws.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:b.ReactCurrentDispatcher,findHostInstanceByFiber:function(n){return n=xh(n),n===null?null:n.stateNode},findFiberByHostInstance:Ws.findFiberByHostInstance||LA,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Gl=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Gl.isDisabled&&Gl.supportsFiber)try{Ba=Gl.inject(HA),zn=Gl}catch{}}return tn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=BA,tn.createPortal=function(n,r){var l=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Fd(r))throw Error(i(200));return FA(n,r,null,l)},tn.createRoot=function(n,r){if(!Fd(n))throw Error(i(299));var l=!1,d="",h=gm;return r!=null&&(r.unstable_strictMode===!0&&(l=!0),r.identifierPrefix!==void 0&&(d=r.identifierPrefix),r.onRecoverableError!==void 0&&(h=r.onRecoverableError)),r=Od(n,1,!1,null,null,l,!1,d,h),n[oi]=r.current,_s(n.nodeType===8?n.parentNode:n),new kd(r)},tn.findDOMNode=function(n){if(n==null)return null;if(n.nodeType===1)return n;var r=n._reactInternals;if(r===void 0)throw typeof n.render=="function"?Error(i(188)):(n=Object.keys(n).join(","),Error(i(268,n)));return n=xh(r),n=n===null?null:n.stateNode,n},tn.flushSync=function(n){return Tr(n)},tn.hydrate=function(n,r,l){if(!Hl(r))throw Error(i(200));return bl(null,n,r,!0,l)},tn.hydrateRoot=function(n,r,l){if(!Fd(n))throw Error(i(405));var d=l!=null&&l.hydratedSources||null,h=!1,p="",S=gm;if(l!=null&&(l.unstable_strictMode===!0&&(h=!0),l.identifierPrefix!==void 0&&(p=l.identifierPrefix),l.onRecoverableError!==void 0&&(S=l.onRecoverableError)),r=fm(r,null,n,1,l??null,h,!1,p,S),n[oi]=r.current,_s(n),d)for(n=0;n<d.length;n++)l=d[n],h=l._getVersion,h=h(l._source),r.mutableSourceEagerHydrationData==null?r.mutableSourceEagerHydrationData=[l,h]:r.mutableSourceEagerHydrationData.push(l,h);return new Bl(r)},tn.render=function(n,r,l){if(!Hl(r))throw Error(i(200));return bl(null,n,r,!1,l)},tn.unmountComponentAtNode=function(n){if(!Hl(n))throw Error(i(40));return n._reactRootContainer?(Tr(function(){bl(null,null,n,!1,function(){n._reactRootContainer=null,n[oi]=null})}),!0):!1},tn.unstable_batchedUpdates=wd,tn.unstable_renderSubtreeIntoContainer=function(n,r,l,d){if(!Hl(l))throw Error(i(200));if(n==null||n._reactInternals===void 0)throw Error(i(38));return bl(n,r,l,!1,d)},tn.version="18.3.1-next-f1338f8080-20240426",tn}var Em;function XA(){if(Em)return Bd.exports;Em=1;function e(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}return e(),Bd.exports=VA(),Bd.exports}var Cm;function KA(){if(Cm)return xl;Cm=1;var e=XA();return xl.createRoot=e.createRoot,xl.hydrateRoot=e.hydrateRoot,xl}var ZA=KA();const qA=q0(ZA);class QA{constructor(){this.ids=[],this.values=[],this.length=0}clear(){this.length=0}push(t,i){let o=this.length++;for(;o>0;){const a=o-1>>1,s=this.values[a];if(i>=s)break;this.ids[o]=this.ids[a],this.values[o]=s,o=a}this.ids[o]=t,this.values[o]=i}pop(){if(this.length===0)return;const t=this.ids[0];if(this.length--,this.length>0){const i=this.ids[0]=this.ids[this.length],o=this.values[0]=this.values[this.length],a=this.length>>1;let s=0;for(;s<a;){let u=(s<<1)+1;const c=u+1;let f=this.ids[u],g=this.values[u];const m=this.values[c];if(c<this.length&&m<g&&(u=c,f=this.ids[c],g=m),g>=o)break;this.ids[s]=f,this.values[s]=g,s=u}this.ids[s]=i,this.values[s]=o}return t}peek(){if(this.length!==0)return this.ids[0]}peekValue(){if(this.length!==0)return this.values[0]}shrink(){this.ids.length=this.values.length=this.length}}const wm=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array],Gd=3;class Wf{static from(t,i=0){if(i%8!==0)throw new Error("byteOffset must be 8-byte aligned.");if(!t||t.byteLength===void 0||t.buffer)throw new Error("Data must be an instance of ArrayBuffer or SharedArrayBuffer.");const[o,a]=new Uint8Array(t,i+0,2);if(o!==251)throw new Error("Data does not appear to be in a Flatbush format.");const s=a>>4;if(s!==Gd)throw new Error(`Got v${s} data when expected v${Gd}.`);const u=wm[a&15];if(!u)throw new Error("Unrecognized array type.");const[c]=new Uint16Array(t,i+2,1),[f]=new Uint32Array(t,i+4,1);return new Wf(f,c,u,void 0,t,i)}constructor(t,i=16,o=Float64Array,a=ArrayBuffer,s,u=0){if(t===void 0)throw new Error("Missing required argument: numItems.");if(isNaN(t)||t<=0)throw new Error(`Unexpected numItems value: ${t}.`);this.numItems=+t,this.nodeSize=Math.min(Math.max(+i,2),65535),this.byteOffset=u;let c=t,f=c;this._levelBounds=[c*4];do c=Math.ceil(c/this.nodeSize),f+=c,this._levelBounds.push(f*4);while(c!==1);this.ArrayType=o,this.IndexArrayType=f<16384?Uint16Array:Uint32Array;const g=wm.indexOf(this.ArrayType),m=f*4*this.ArrayType.BYTES_PER_ELEMENT;if(g<0)throw new Error(`Unexpected typed array class: ${o}.`);s&&s.byteLength!==void 0&&!s.buffer?(this.data=s,this._boxes=new this.ArrayType(this.data,u+8,f*4),this._indices=new this.IndexArrayType(this.data,u+8+m,f),this._pos=f*4,this.minX=this._boxes[this._pos-4],this.minY=this._boxes[this._pos-3],this.maxX=this._boxes[this._pos-2],this.maxY=this._boxes[this._pos-1]):(this.data=new a(8+m+f*this.IndexArrayType.BYTES_PER_ELEMENT),this._boxes=new this.ArrayType(this.data,8,f*4),this._indices=new this.IndexArrayType(this.data,8+m,f),this._pos=0,this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0,new Uint8Array(this.data,0,2).set([251,(Gd<<4)+g]),new Uint16Array(this.data,2,1)[0]=i,new Uint32Array(this.data,4,1)[0]=t),this._queue=new QA}add(t,i,o=t,a=i){const s=this._pos>>2,u=this._boxes;return this._indices[s]=s,u[this._pos++]=t,u[this._pos++]=i,u[this._pos++]=o,u[this._pos++]=a,t<this.minX&&(this.minX=t),i<this.minY&&(this.minY=i),o>this.maxX&&(this.maxX=o),a>this.maxY&&(this.maxY=a),s}finish(){if(this._pos>>2!==this.numItems)throw new Error(`Added ${this._pos>>2} items when expected ${this.numItems}.`);const t=this._boxes;if(this.numItems<=this.nodeSize){t[this._pos++]=this.minX,t[this._pos++]=this.minY,t[this._pos++]=this.maxX,t[this._pos++]=this.maxY;return}const i=this.maxX-this.minX||1,o=this.maxY-this.minY||1,a=new Uint32Array(this.numItems),s=65535;for(let u=0,c=0;u<this.numItems;u++){const f=t[c++],g=t[c++],m=t[c++],v=t[c++],T=Math.floor(s*((f+m)/2-this.minX)/i),A=Math.floor(s*((g+v)/2-this.minY)/o);a[u]=eT(T,A)}yf(a,t,this._indices,0,this.numItems-1,this.nodeSize);for(let u=0,c=0;u<this._levelBounds.length-1;u++){const f=this._levelBounds[u];for(;c<f;){const g=c;let m=t[c++],v=t[c++],T=t[c++],A=t[c++];for(let I=1;I<this.nodeSize&&c<f;I++)m=Math.min(m,t[c++]),v=Math.min(v,t[c++]),T=Math.max(T,t[c++]),A=Math.max(A,t[c++]);this._indices[this._pos>>2]=g,t[this._pos++]=m,t[this._pos++]=v,t[this._pos++]=T,t[this._pos++]=A}}}search(t,i,o,a,s){if(this._pos!==this._boxes.length)throw new Error("Data not yet indexed - call index.finish().");let u=this._boxes.length-4;const c=[],f=[];for(;u!==void 0;){const g=Math.min(u+this.nodeSize*4,Rm(u,this._levelBounds));for(let m=u;m<g;m+=4){if(o<this._boxes[m]||a<this._boxes[m+1]||t>this._boxes[m+2]||i>this._boxes[m+3])continue;const v=this._indices[m>>2]|0;u>=this.numItems*4?c.push(v):(s===void 0||s(v))&&f.push(v)}u=c.pop()}return f}neighbors(t,i,o=1/0,a=1/0,s){if(this._pos!==this._boxes.length)throw new Error("Data not yet indexed - call index.finish().");let u=this._boxes.length-4;const c=this._queue,f=[],g=a*a;e:for(;u!==void 0;){const m=Math.min(u+this.nodeSize*4,Rm(u,this._levelBounds));for(let v=u;v<m;v+=4){const T=this._indices[v>>2]|0,A=_m(t,this._boxes[v],this._boxes[v+2]),I=_m(i,this._boxes[v+1],this._boxes[v+3]),y=A*A+I*I;y>g||(u>=this.numItems*4?c.push(T<<1,y):(s===void 0||s(T))&&c.push((T<<1)+1,y))}for(;c.length&&c.peek()&1;)if(c.peekValue()>g||(f.push(c.pop()>>1),f.length===o))break e;u=c.length?c.pop()>>1:void 0}return c.clear(),f}}function _m(e,t,i){return e<t?t-e:e<=i?0:e-i}function Rm(e,t){let i=0,o=t.length-1;for(;i<o;){const a=i+o>>1;t[a]>e?o=a:i=a+1}return t[i]}function yf(e,t,i,o,a,s){if(Math.floor(o/s)>=Math.floor(a/s))return;const u=e[o+a>>1];let c=o-1,f=a+1;for(;;){do c++;while(e[c]<u);do f--;while(e[f]>u);if(c>=f)break;JA(e,t,i,c,f)}yf(e,t,i,o,f,s),yf(e,t,i,f+1,a,s)}function JA(e,t,i,o,a){const s=e[o];e[o]=e[a],e[a]=s;const u=4*o,c=4*a,f=t[u],g=t[u+1],m=t[u+2],v=t[u+3];t[u]=t[c],t[u+1]=t[c+1],t[u+2]=t[c+2],t[u+3]=t[c+3],t[c]=f,t[c+1]=g,t[c+2]=m,t[c+3]=v;const T=i[o];i[o]=i[a],i[a]=T}function eT(e,t){let i=e^t,o=65535^i,a=65535^(e|t),s=e&(t^65535),u=i|o>>1,c=i>>1^i,f=a>>1^o&s>>1^a,g=i&a>>1^s>>1^s;i=u,o=c,a=f,s=g,u=i&i>>2^o&o>>2,c=i&o>>2^o&(i^o)>>2,f^=i&a>>2^o&s>>2,g^=o&a>>2^(i^o)&s>>2,i=u,o=c,a=f,s=g,u=i&i>>4^o&o>>4,c=i&o>>4^o&(i^o)>>4,f^=i&a>>4^o&s>>4,g^=o&a>>4^(i^o)&s>>4,i=u,o=c,a=f,s=g,f^=i&a>>8^o&s>>8,g^=o&a>>8^(i^o)&s>>8,i=f^f>>1,o=g^g>>1;let m=e^t,v=o|65535^(m|i);return m=(m|m<<8)&16711935,m=(m|m<<4)&252645135,m=(m|m<<2)&858993459,m=(m|m<<1)&1431655765,v=(v|v<<8)&16711935,v=(v|v<<4)&252645135,v=(v|v<<2)&858993459,v=(v|v<<1)&1431655765,(v<<1|m)>>>0}function So(e,t){if(e.length===0)return{all:()=>[],byRect:()=>[],byRadius:()=>[],byProperty:()=>[],resetPropertyCache:()=>{},count:()=>0};const i=new Wf(e.length),o=new Map;for(const s of e)i.add(s.position.x,s.position.y,s.position.x,s.position.y);return i.finish(),{all(){return e},byRect(s){return i.search(s.left,s.top,s.right,s.bottom).map(c=>e[c])},byRadius(s,u){return i.neighbors(s.x,s.y,void 0,u).map(f=>e[f])},byProperty(s,u){var c;if(!o.has(s)){const f=new Map;for(const g of e){const m=g[s];f.has(m)||f.set(m,[]),f.get(m).push(g)}o.set(s,f)}return((c=o.get(s))==null?void 0:c.get(u))||[]},resetPropertyCache(){o.clear()},count(){return e.length}}}function Ou(e){const t=Object.values(e.entities.entities),i=t.filter(g=>g.type==="human"),o=t.filter(g=>g.type==="berryBush"),a=t.filter(g=>g.type==="corpse"),s=t.filter(g=>g.type==="prey"),u=t.filter(g=>g.type==="predator"),c=t.filter(g=>g.type==="building");return{...e,search:{human:So(i),berryBush:So(o),corpse:So(a),prey:So(s),predator:So(u),building:So(c)}}}const tT="tribe-game-db",or="save-files",zf="tribe-game-save",Af=1;async function Yf(e){try{const t={version:Af,savedAt:Date.now(),gameState:e},i=JSON.stringify(t),o=await iT(i);await oT(zf,o),console.log(`Game saved successfully. Size: ${(o.size/1024).toFixed(2)} KB`)}catch(t){throw console.error("Failed to save game:",t),t}}async function nT(){try{const e=await sT(zf);if(!e)return null;const t=await rT(e),i=JSON.parse(t);return i.version!==Af?(console.warn(`Save game version mismatch. Expected ${Af}, found ${i.version}. Discarding save.`),await Tf(),null):(console.log("Game loaded successfully."),Ou(i.gameState))}catch(e){return console.error("Failed to load game:",e),await Tf(),null}}async function Tf(){try{await aT(zf),console.log("Saved game cleared.")}catch(e){console.error("Failed to clear saved game:",e)}}async function iT(e){const i=new Blob([e]).stream().pipeThrough(new CompressionStream("gzip"));return await new Response(i).blob()}async function rT(e){const t=e.stream().pipeThrough(new DecompressionStream("gzip"));return await new Response(t).text()}function jf(){return new Promise((e,t)=>{const i=indexedDB.open(tT,1);i.onupgradeneeded=o=>{const a=o.target.result;a.objectStoreNames.contains(or)||a.createObjectStore(or)},i.onsuccess=()=>e(i.result),i.onerror=()=>t(i.error)})}async function oT(e,t){const i=await jf();return new Promise((o,a)=>{const c=i.transaction(or,"readwrite").objectStore(or).put(t,e);c.onsuccess=()=>o(),c.onerror=()=>a(c.error)})}async function sT(e){const t=await jf();return new Promise((i,o)=>{const u=t.transaction(or,"readonly").objectStore(or).get(e);u.onsuccess=()=>i(u.result),u.onerror=()=>o(u.error)})}async function aT(e){const t=await jf();return new Promise((i,o)=>{const u=t.transaction(or,"readwrite").objectStore(or).delete(e);u.onsuccess=()=>i(),u.onerror=()=>o(u.error)})}const Q0=Oe.createContext(void 0),lT=({initialAppState:e,children:t})=>{const[i,o]=Oe.useState(e),[a,s]=Oe.useState(void 0),[u,c]=Oe.useState(null),[f,g]=Oe.useState(!1);Oe.useEffect(()=>{nT().then(I=>{I&&c(I),g(!0)})},[]);const m=(I,y)=>{o(I),I==="gameOver"&&y?s(y):I!=="gameOver"&&s(void 0)},v=()=>{o("intro"),s(void 0),A()},T=I=>{Yf(I),c(I)},A=()=>{Tf(),c(null)};return Le.jsx(Q0.Provider,{value:{appState:i,setAppState:m,returnToIntro:v,gameOverDetails:a,contextReady:f,savedGameState:u,setSavedGameState:c,saveCurrentGame:T,clearCurrentSave:A},children:t})},Jo=()=>{const e=Oe.useContext(Q0);if(e===void 0)throw new Error("useGameContext must be used within a GameProvider");return e};var Ht=function(){return Ht=Object.assign||function(t){for(var i,o=1,a=arguments.length;o<a;o++){i=arguments[o];for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&(t[s]=i[s])}return t},Ht.apply(this,arguments)};function ga(e,t,i){if(i||arguments.length===2)for(var o=0,a=t.length,s;o<a;o++)(s||!(o in t))&&(s||(s=Array.prototype.slice.call(t,0,o)),s[o]=t[o]);return e.concat(s||Array.prototype.slice.call(t))}var et="-ms-",ra="-moz-",We="-webkit-",J0="comm",Mu="rule",Vf="decl",uT="@import",ev="@keyframes",cT="@layer",tv=Math.abs,Xf=String.fromCharCode,If=Object.assign;function dT(e,t){return Et(e,0)^45?(((t<<2^Et(e,0))<<2^Et(e,1))<<2^Et(e,2))<<2^Et(e,3):0}function nv(e){return e.trim()}function pi(e,t){return(e=t.exec(e))?e[0]:e}function Fe(e,t,i){return e.replace(t,i)}function fu(e,t,i){return e.indexOf(t,i)}function Et(e,t){return e.charCodeAt(t)|0}function bo(e,t,i){return e.slice(t,i)}function ei(e){return e.length}function iv(e){return e.length}function Js(e,t){return t.push(e),e}function fT(e,t){return e.map(t).join("")}function Pm(e,t){return e.filter(function(i){return!pi(i,t)})}var ku=1,Go=1,rv=0,En=0,gt=0,es="";function Fu(e,t,i,o,a,s,u,c){return{value:e,root:t,parent:i,type:o,props:a,children:s,line:ku,column:Go,length:u,return:"",siblings:c}}function Xi(e,t){return If(Fu("",null,null,"",null,null,0,e.siblings),e,{length:-e.length},t)}function yo(e){for(;e.root;)e=Xi(e.root,{children:[e]});Js(e,e.siblings)}function hT(){return gt}function gT(){return gt=En>0?Et(es,--En):0,Go--,gt===10&&(Go=1,ku--),gt}function Un(){return gt=En<rv?Et(es,En++):0,Go++,gt===10&&(Go=1,ku++),gt}function kr(){return Et(es,En)}function hu(){return En}function Lu(e,t){return bo(es,e,t)}function Ef(e){switch(e){case 0:case 9:case 10:case 13:case 32:return 5;case 33:case 43:case 44:case 47:case 62:case 64:case 126:case 59:case 123:case 125:return 4;case 58:return 3;case 34:case 39:case 40:case 91:return 2;case 41:case 93:return 1}return 0}function pT(e){return ku=Go=1,rv=ei(es=e),En=0,[]}function mT(e){return es="",e}function xd(e){return nv(Lu(En-1,Cf(e===91?e+2:e===40?e+1:e)))}function vT(e){for(;(gt=kr())&&gt<33;)Un();return Ef(e)>2||Ef(gt)>3?"":" "}function ST(e,t){for(;--t&&Un()&&!(gt<48||gt>102||gt>57&&gt<65||gt>70&&gt<97););return Lu(e,hu()+(t<6&&kr()==32&&Un()==32))}function Cf(e){for(;Un();)switch(gt){case e:return En;case 34:case 39:e!==34&&e!==39&&Cf(gt);break;case 40:e===41&&Cf(e);break;case 92:Un();break}return En}function yT(e,t){for(;Un()&&e+gt!==57;)if(e+gt===84&&kr()===47)break;return"/*"+Lu(t,En-1)+"*"+Xf(e===47?e:Un())}function AT(e){for(;!Ef(kr());)Un();return Lu(e,En)}function TT(e){return mT(gu("",null,null,null,[""],e=pT(e),0,[0],e))}function gu(e,t,i,o,a,s,u,c,f){for(var g=0,m=0,v=u,T=0,A=0,I=0,y=1,w=1,M=1,F=0,N="",b=a,B=s,L=o,G=N;w;)switch(I=F,F=Un()){case 40:if(I!=108&&Et(G,v-1)==58){fu(G+=Fe(xd(F),"&","&\f"),"&\f",tv(g?c[g-1]:0))!=-1&&(M=-1);break}case 34:case 39:case 91:G+=xd(F);break;case 9:case 10:case 13:case 32:G+=vT(I);break;case 92:G+=ST(hu()-1,7);continue;case 47:switch(kr()){case 42:case 47:Js(IT(yT(Un(),hu()),t,i,f),f);break;default:G+="/"}break;case 123*y:c[g++]=ei(G)*M;case 125*y:case 59:case 0:switch(F){case 0:case 125:w=0;case 59+m:M==-1&&(G=Fe(G,/\f/g,"")),A>0&&ei(G)-v&&Js(A>32?Dm(G+";",o,i,v-1,f):Dm(Fe(G," ","")+";",o,i,v-2,f),f);break;case 59:G+=";";default:if(Js(L=Nm(G,t,i,g,m,a,c,N,b=[],B=[],v,s),s),F===123)if(m===0)gu(G,t,L,L,b,s,v,c,B);else switch(T===99&&Et(G,3)===110?100:T){case 100:case 108:case 109:case 115:gu(e,L,L,o&&Js(Nm(e,L,L,0,0,a,c,N,a,b=[],v,B),B),a,B,v,c,o?b:B);break;default:gu(G,L,L,L,[""],B,0,c,B)}}g=m=A=0,y=M=1,N=G="",v=u;break;case 58:v=1+ei(G),A=I;default:if(y<1){if(F==123)--y;else if(F==125&&y++==0&&gT()==125)continue}switch(G+=Xf(F),F*y){case 38:M=m>0?1:(G+="\f",-1);break;case 44:c[g++]=(ei(G)-1)*M,M=1;break;case 64:kr()===45&&(G+=xd(Un())),T=kr(),m=v=ei(N=G+=AT(hu())),F++;break;case 45:I===45&&ei(G)==2&&(y=0)}}return s}function Nm(e,t,i,o,a,s,u,c,f,g,m,v){for(var T=a-1,A=a===0?s:[""],I=iv(A),y=0,w=0,M=0;y<o;++y)for(var F=0,N=bo(e,T+1,T=tv(w=u[y])),b=e;F<I;++F)(b=nv(w>0?A[F]+" "+N:Fe(N,/&\f/g,A[F])))&&(f[M++]=b);return Fu(e,t,i,a===0?Mu:c,f,g,m,v)}function IT(e,t,i,o){return Fu(e,t,i,J0,Xf(hT()),bo(e,2,-2),0,o)}function Dm(e,t,i,o,a){return Fu(e,t,i,Vf,bo(e,0,o),bo(e,o+1,-1),o,a)}function ov(e,t,i){switch(dT(e,t)){case 5103:return We+"print-"+e+e;case 5737:case 4201:case 3177:case 3433:case 1641:case 4457:case 2921:case 5572:case 6356:case 5844:case 3191:case 6645:case 3005:case 6391:case 5879:case 5623:case 6135:case 4599:case 4855:case 4215:case 6389:case 5109:case 5365:case 5621:case 3829:return We+e+e;case 4789:return ra+e+e;case 5349:case 4246:case 4810:case 6968:case 2756:return We+e+ra+e+et+e+e;case 5936:switch(Et(e,t+11)){case 114:return We+e+et+Fe(e,/[svh]\w+-[tblr]{2}/,"tb")+e;case 108:return We+e+et+Fe(e,/[svh]\w+-[tblr]{2}/,"tb-rl")+e;case 45:return We+e+et+Fe(e,/[svh]\w+-[tblr]{2}/,"lr")+e}case 6828:case 4268:case 2903:return We+e+et+e+e;case 6165:return We+e+et+"flex-"+e+e;case 5187:return We+e+Fe(e,/(\w+).+(:[^]+)/,We+"box-$1$2"+et+"flex-$1$2")+e;case 5443:return We+e+et+"flex-item-"+Fe(e,/flex-|-self/g,"")+(pi(e,/flex-|baseline/)?"":et+"grid-row-"+Fe(e,/flex-|-self/g,""))+e;case 4675:return We+e+et+"flex-line-pack"+Fe(e,/align-content|flex-|-self/g,"")+e;case 5548:return We+e+et+Fe(e,"shrink","negative")+e;case 5292:return We+e+et+Fe(e,"basis","preferred-size")+e;case 6060:return We+"box-"+Fe(e,"-grow","")+We+e+et+Fe(e,"grow","positive")+e;case 4554:return We+Fe(e,/([^-])(transform)/g,"$1"+We+"$2")+e;case 6187:return Fe(Fe(Fe(e,/(zoom-|grab)/,We+"$1"),/(image-set)/,We+"$1"),e,"")+e;case 5495:case 3959:return Fe(e,/(image-set\([^]*)/,We+"$1$`$1");case 4968:return Fe(Fe(e,/(.+:)(flex-)?(.*)/,We+"box-pack:$3"+et+"flex-pack:$3"),/s.+-b[^;]+/,"justify")+We+e+e;case 4200:if(!pi(e,/flex-|baseline/))return et+"grid-column-align"+bo(e,t)+e;break;case 2592:case 3360:return et+Fe(e,"template-","")+e;case 4384:case 3616:return i&&i.some(function(o,a){return t=a,pi(o.props,/grid-\w+-end/)})?~fu(e+(i=i[t].value),"span",0)?e:et+Fe(e,"-start","")+e+et+"grid-row-span:"+(~fu(i,"span",0)?pi(i,/\d+/):+pi(i,/\d+/)-+pi(e,/\d+/))+";":et+Fe(e,"-start","")+e;case 4896:case 4128:return i&&i.some(function(o){return pi(o.props,/grid-\w+-start/)})?e:et+Fe(Fe(e,"-end","-span"),"span ","")+e;case 4095:case 3583:case 4068:case 2532:return Fe(e,/(.+)-inline(.+)/,We+"$1$2")+e;case 8116:case 7059:case 5753:case 5535:case 5445:case 5701:case 4933:case 4677:case 5533:case 5789:case 5021:case 4765:if(ei(e)-1-t>6)switch(Et(e,t+1)){case 109:if(Et(e,t+4)!==45)break;case 102:return Fe(e,/(.+:)(.+)-([^]+)/,"$1"+We+"$2-$3$1"+ra+(Et(e,t+3)==108?"$3":"$2-$3"))+e;case 115:return~fu(e,"stretch",0)?ov(Fe(e,"stretch","fill-available"),t,i)+e:e}break;case 5152:case 5920:return Fe(e,/(.+?):(\d+)(\s*\/\s*(span)?\s*(\d+))?(.*)/,function(o,a,s,u,c,f,g){return et+a+":"+s+g+(u?et+a+"-span:"+(c?f:+f-+s)+g:"")+e});case 4949:if(Et(e,t+6)===121)return Fe(e,":",":"+We)+e;break;case 6444:switch(Et(e,Et(e,14)===45?18:11)){case 120:return Fe(e,/(.+:)([^;\s!]+)(;|(\s+)?!.+)?/,"$1"+We+(Et(e,14)===45?"inline-":"")+"box$3$1"+We+"$2$3$1"+et+"$2box$3")+e;case 100:return Fe(e,":",":"+et)+e}break;case 5719:case 2647:case 2135:case 3927:case 2391:return Fe(e,"scroll-","scroll-snap-")+e}return e}function Au(e,t){for(var i="",o=0;o<e.length;o++)i+=t(e[o],o,e,t)||"";return i}function ET(e,t,i,o){switch(e.type){case cT:if(e.children.length)break;case uT:case Vf:return e.return=e.return||e.value;case J0:return"";case ev:return e.return=e.value+"{"+Au(e.children,o)+"}";case Mu:if(!ei(e.value=e.props.join(",")))return""}return ei(i=Au(e.children,o))?e.return=e.value+"{"+i+"}":""}function CT(e){var t=iv(e);return function(i,o,a,s){for(var u="",c=0;c<t;c++)u+=e[c](i,o,a,s)||"";return u}}function wT(e){return function(t){t.root||(t=t.return)&&e(t)}}function _T(e,t,i,o){if(e.length>-1&&!e.return)switch(e.type){case Vf:e.return=ov(e.value,e.length,i);return;case ev:return Au([Xi(e,{value:Fe(e.value,"@","@"+We)})],o);case Mu:if(e.length)return fT(i=e.props,function(a){switch(pi(a,o=/(::plac\w+|:read-\w+)/)){case":read-only":case":read-write":yo(Xi(e,{props:[Fe(a,/:(read-\w+)/,":"+ra+"$1")]})),yo(Xi(e,{props:[a]})),If(e,{props:Pm(i,o)});break;case"::placeholder":yo(Xi(e,{props:[Fe(a,/:(plac\w+)/,":"+We+"input-$1")]})),yo(Xi(e,{props:[Fe(a,/:(plac\w+)/,":"+ra+"$1")]})),yo(Xi(e,{props:[Fe(a,/:(plac\w+)/,et+"input-$1")]})),yo(Xi(e,{props:[a]})),If(e,{props:Pm(i,o)});break}return""})}}var RT={animationIterationCount:1,aspectRatio:1,borderImageOutset:1,borderImageSlice:1,borderImageWidth:1,boxFlex:1,boxFlexGroup:1,boxOrdinalGroup:1,columnCount:1,columns:1,flex:1,flexGrow:1,flexPositive:1,flexShrink:1,flexNegative:1,flexOrder:1,gridRow:1,gridRowEnd:1,gridRowSpan:1,gridRowStart:1,gridColumn:1,gridColumnEnd:1,gridColumnSpan:1,gridColumnStart:1,msGridRow:1,msGridRowSpan:1,msGridColumn:1,msGridColumnSpan:1,fontWeight:1,lineHeight:1,opacity:1,order:1,orphans:1,tabSize:1,widows:1,zIndex:1,zoom:1,WebkitLineClamp:1,fillOpacity:1,floodOpacity:1,stopOpacity:1,strokeDasharray:1,strokeDashoffset:1,strokeMiterlimit:1,strokeOpacity:1,strokeWidth:1},un={},xo=typeof process<"u"&&un!==void 0&&(un.REACT_APP_SC_ATTR||un.SC_ATTR)||"data-styled",sv="active",av="data-styled-version",Uu="6.1.13",Kf=`/*!sc*/
`,Tu=typeof window<"u"&&"HTMLElement"in window,PT=!!(typeof SC_DISABLE_SPEEDY=="boolean"?SC_DISABLE_SPEEDY:typeof process<"u"&&un!==void 0&&un.REACT_APP_SC_DISABLE_SPEEDY!==void 0&&un.REACT_APP_SC_DISABLE_SPEEDY!==""?un.REACT_APP_SC_DISABLE_SPEEDY!=="false"&&un.REACT_APP_SC_DISABLE_SPEEDY:typeof process<"u"&&un!==void 0&&un.SC_DISABLE_SPEEDY!==void 0&&un.SC_DISABLE_SPEEDY!==""&&un.SC_DISABLE_SPEEDY!=="false"&&un.SC_DISABLE_SPEEDY),NT={},Bu=Object.freeze([]),$o=Object.freeze({});function lv(e,t,i){return i===void 0&&(i=$o),e.theme!==i.theme&&e.theme||t||i.theme}var uv=new Set(["a","abbr","address","area","article","aside","audio","b","base","bdi","bdo","big","blockquote","body","br","button","canvas","caption","cite","code","col","colgroup","data","datalist","dd","del","details","dfn","dialog","div","dl","dt","em","embed","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","header","hgroup","hr","html","i","iframe","img","input","ins","kbd","keygen","label","legend","li","link","main","map","mark","menu","menuitem","meta","meter","nav","noscript","object","ol","optgroup","option","output","p","param","picture","pre","progress","q","rp","rt","ruby","s","samp","script","section","select","small","source","span","strong","style","sub","summary","sup","table","tbody","td","textarea","tfoot","th","thead","time","tr","track","u","ul","use","var","video","wbr","circle","clipPath","defs","ellipse","foreignObject","g","image","line","linearGradient","marker","mask","path","pattern","polygon","polyline","radialGradient","rect","stop","svg","text","tspan"]),DT=/[!"#$%&'()*+,./:;<=>?@[\\\]^`{|}~-]+/g,OT=/(^-|-$)/g;function Om(e){return e.replace(DT,"-").replace(OT,"")}var MT=/(a)(d)/gi,$l=52,Mm=function(e){return String.fromCharCode(e+(e>25?39:97))};function wf(e){var t,i="";for(t=Math.abs(e);t>$l;t=t/$l|0)i=Mm(t%$l)+i;return(Mm(t%$l)+i).replace(MT,"$1-$2")}var $d,cv=5381,Oo=function(e,t){for(var i=t.length;i;)e=33*e^t.charCodeAt(--i);return e},dv=function(e){return Oo(cv,e)};function fv(e){return wf(dv(e)>>>0)}function kT(e){return e.displayName||e.name||"Component"}function Wd(e){return typeof e=="string"&&!0}var hv=typeof Symbol=="function"&&Symbol.for,gv=hv?Symbol.for("react.memo"):60115,FT=hv?Symbol.for("react.forward_ref"):60112,LT={childContextTypes:!0,contextType:!0,contextTypes:!0,defaultProps:!0,displayName:!0,getDefaultProps:!0,getDerivedStateFromError:!0,getDerivedStateFromProps:!0,mixins:!0,propTypes:!0,type:!0},UT={name:!0,length:!0,prototype:!0,caller:!0,callee:!0,arguments:!0,arity:!0},pv={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},BT=(($d={})[FT]={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},$d[gv]=pv,$d);function km(e){return("type"in(t=e)&&t.type.$$typeof)===gv?pv:"$$typeof"in e?BT[e.$$typeof]:LT;var t}var HT=Object.defineProperty,bT=Object.getOwnPropertyNames,Fm=Object.getOwnPropertySymbols,GT=Object.getOwnPropertyDescriptor,xT=Object.getPrototypeOf,Lm=Object.prototype;function mv(e,t,i){if(typeof t!="string"){if(Lm){var o=xT(t);o&&o!==Lm&&mv(e,o,i)}var a=bT(t);Fm&&(a=a.concat(Fm(t)));for(var s=km(e),u=km(t),c=0;c<a.length;++c){var f=a[c];if(!(f in UT||i&&i[f]||u&&f in u||s&&f in s)){var g=GT(t,f);try{HT(e,f,g)}catch{}}}}return e}function Wo(e){return typeof e=="function"}function Zf(e){return typeof e=="object"&&"styledComponentId"in e}function Mr(e,t){return e&&t?"".concat(e," ").concat(t):e||t||""}function _f(e,t){if(e.length===0)return"";for(var i=e[0],o=1;o<e.length;o++)i+=e[o];return i}function pa(e){return e!==null&&typeof e=="object"&&e.constructor.name===Object.name&&!("props"in e&&e.$$typeof)}function Rf(e,t,i){if(i===void 0&&(i=!1),!i&&!pa(e)&&!Array.isArray(e))return t;if(Array.isArray(t))for(var o=0;o<t.length;o++)e[o]=Rf(e[o],t[o]);else if(pa(t))for(var o in t)e[o]=Rf(e[o],t[o]);return e}function qf(e,t){Object.defineProperty(e,"toString",{value:t})}function Ra(e){for(var t=[],i=1;i<arguments.length;i++)t[i-1]=arguments[i];return new Error("An error occurred. See https://github.com/styled-components/styled-components/blob/main/packages/styled-components/src/utils/errors.md#".concat(e," for more information.").concat(t.length>0?" Args: ".concat(t.join(", ")):""))}var $T=function(){function e(t){this.groupSizes=new Uint32Array(512),this.length=512,this.tag=t}return e.prototype.indexOfGroup=function(t){for(var i=0,o=0;o<t;o++)i+=this.groupSizes[o];return i},e.prototype.insertRules=function(t,i){if(t>=this.groupSizes.length){for(var o=this.groupSizes,a=o.length,s=a;t>=s;)if((s<<=1)<0)throw Ra(16,"".concat(t));this.groupSizes=new Uint32Array(s),this.groupSizes.set(o),this.length=s;for(var u=a;u<s;u++)this.groupSizes[u]=0}for(var c=this.indexOfGroup(t+1),f=(u=0,i.length);u<f;u++)this.tag.insertRule(c,i[u])&&(this.groupSizes[t]++,c++)},e.prototype.clearGroup=function(t){if(t<this.length){var i=this.groupSizes[t],o=this.indexOfGroup(t),a=o+i;this.groupSizes[t]=0;for(var s=o;s<a;s++)this.tag.deleteRule(o)}},e.prototype.getGroup=function(t){var i="";if(t>=this.length||this.groupSizes[t]===0)return i;for(var o=this.groupSizes[t],a=this.indexOfGroup(t),s=a+o,u=a;u<s;u++)i+="".concat(this.tag.getRule(u)).concat(Kf);return i},e}(),pu=new Map,Iu=new Map,mu=1,Wl=function(e){if(pu.has(e))return pu.get(e);for(;Iu.has(mu);)mu++;var t=mu++;return pu.set(e,t),Iu.set(t,e),t},WT=function(e,t){mu=t+1,pu.set(e,t),Iu.set(t,e)},zT="style[".concat(xo,"][").concat(av,'="').concat(Uu,'"]'),YT=new RegExp("^".concat(xo,'\\.g(\\d+)\\[id="([\\w\\d-]+)"\\].*?"([^"]*)')),jT=function(e,t,i){for(var o,a=i.split(","),s=0,u=a.length;s<u;s++)(o=a[s])&&e.registerName(t,o)},VT=function(e,t){for(var i,o=((i=t.textContent)!==null&&i!==void 0?i:"").split(Kf),a=[],s=0,u=o.length;s<u;s++){var c=o[s].trim();if(c){var f=c.match(YT);if(f){var g=0|parseInt(f[1],10),m=f[2];g!==0&&(WT(m,g),jT(e,m,f[3]),e.getTag().insertRules(g,a)),a.length=0}else a.push(c)}}},Um=function(e){for(var t=document.querySelectorAll(zT),i=0,o=t.length;i<o;i++){var a=t[i];a&&a.getAttribute(xo)!==sv&&(VT(e,a),a.parentNode&&a.parentNode.removeChild(a))}};function XT(){return typeof __webpack_nonce__<"u"?__webpack_nonce__:null}var vv=function(e){var t=document.head,i=e||t,o=document.createElement("style"),a=function(c){var f=Array.from(c.querySelectorAll("style[".concat(xo,"]")));return f[f.length-1]}(i),s=a!==void 0?a.nextSibling:null;o.setAttribute(xo,sv),o.setAttribute(av,Uu);var u=XT();return u&&o.setAttribute("nonce",u),i.insertBefore(o,s),o},KT=function(){function e(t){this.element=vv(t),this.element.appendChild(document.createTextNode("")),this.sheet=function(i){if(i.sheet)return i.sheet;for(var o=document.styleSheets,a=0,s=o.length;a<s;a++){var u=o[a];if(u.ownerNode===i)return u}throw Ra(17)}(this.element),this.length=0}return e.prototype.insertRule=function(t,i){try{return this.sheet.insertRule(i,t),this.length++,!0}catch{return!1}},e.prototype.deleteRule=function(t){this.sheet.deleteRule(t),this.length--},e.prototype.getRule=function(t){var i=this.sheet.cssRules[t];return i&&i.cssText?i.cssText:""},e}(),ZT=function(){function e(t){this.element=vv(t),this.nodes=this.element.childNodes,this.length=0}return e.prototype.insertRule=function(t,i){if(t<=this.length&&t>=0){var o=document.createTextNode(i);return this.element.insertBefore(o,this.nodes[t]||null),this.length++,!0}return!1},e.prototype.deleteRule=function(t){this.element.removeChild(this.nodes[t]),this.length--},e.prototype.getRule=function(t){return t<this.length?this.nodes[t].textContent:""},e}(),qT=function(){function e(t){this.rules=[],this.length=0}return e.prototype.insertRule=function(t,i){return t<=this.length&&(this.rules.splice(t,0,i),this.length++,!0)},e.prototype.deleteRule=function(t){this.rules.splice(t,1),this.length--},e.prototype.getRule=function(t){return t<this.length?this.rules[t]:""},e}(),Bm=Tu,QT={isServer:!Tu,useCSSOMInjection:!PT},Eu=function(){function e(t,i,o){t===void 0&&(t=$o),i===void 0&&(i={});var a=this;this.options=Ht(Ht({},QT),t),this.gs=i,this.names=new Map(o),this.server=!!t.isServer,!this.server&&Tu&&Bm&&(Bm=!1,Um(this)),qf(this,function(){return function(s){for(var u=s.getTag(),c=u.length,f="",g=function(v){var T=function(M){return Iu.get(M)}(v);if(T===void 0)return"continue";var A=s.names.get(T),I=u.getGroup(v);if(A===void 0||!A.size||I.length===0)return"continue";var y="".concat(xo,".g").concat(v,'[id="').concat(T,'"]'),w="";A!==void 0&&A.forEach(function(M){M.length>0&&(w+="".concat(M,","))}),f+="".concat(I).concat(y,'{content:"').concat(w,'"}').concat(Kf)},m=0;m<c;m++)g(m);return f}(a)})}return e.registerId=function(t){return Wl(t)},e.prototype.rehydrate=function(){!this.server&&Tu&&Um(this)},e.prototype.reconstructWithOptions=function(t,i){return i===void 0&&(i=!0),new e(Ht(Ht({},this.options),t),this.gs,i&&this.names||void 0)},e.prototype.allocateGSInstance=function(t){return this.gs[t]=(this.gs[t]||0)+1},e.prototype.getTag=function(){return this.tag||(this.tag=(t=function(i){var o=i.useCSSOMInjection,a=i.target;return i.isServer?new qT(a):o?new KT(a):new ZT(a)}(this.options),new $T(t)));var t},e.prototype.hasNameForId=function(t,i){return this.names.has(t)&&this.names.get(t).has(i)},e.prototype.registerName=function(t,i){if(Wl(t),this.names.has(t))this.names.get(t).add(i);else{var o=new Set;o.add(i),this.names.set(t,o)}},e.prototype.insertRules=function(t,i,o){this.registerName(t,i),this.getTag().insertRules(Wl(t),o)},e.prototype.clearNames=function(t){this.names.has(t)&&this.names.get(t).clear()},e.prototype.clearRules=function(t){this.getTag().clearGroup(Wl(t)),this.clearNames(t)},e.prototype.clearTag=function(){this.tag=void 0},e}(),JT=/&/g,eI=/^\s*\/\/.*$/gm;function Sv(e,t){return e.map(function(i){return i.type==="rule"&&(i.value="".concat(t," ").concat(i.value),i.value=i.value.replaceAll(",",",".concat(t," ")),i.props=i.props.map(function(o){return"".concat(t," ").concat(o)})),Array.isArray(i.children)&&i.type!=="@keyframes"&&(i.children=Sv(i.children,t)),i})}function tI(e){var t,i,o,a=$o,s=a.options,u=s===void 0?$o:s,c=a.plugins,f=c===void 0?Bu:c,g=function(T,A,I){return I.startsWith(i)&&I.endsWith(i)&&I.replaceAll(i,"").length>0?".".concat(t):T},m=f.slice();m.push(function(T){T.type===Mu&&T.value.includes("&")&&(T.props[0]=T.props[0].replace(JT,i).replace(o,g))}),u.prefix&&m.push(_T),m.push(ET);var v=function(T,A,I,y){A===void 0&&(A=""),I===void 0&&(I=""),y===void 0&&(y="&"),t=y,i=A,o=new RegExp("\\".concat(i,"\\b"),"g");var w=T.replace(eI,""),M=TT(I||A?"".concat(I," ").concat(A," { ").concat(w," }"):w);u.namespace&&(M=Sv(M,u.namespace));var F=[];return Au(M,CT(m.concat(wT(function(N){return F.push(N)})))),F};return v.hash=f.length?f.reduce(function(T,A){return A.name||Ra(15),Oo(T,A.name)},cv).toString():"",v}var nI=new Eu,Pf=tI(),yv=ti.createContext({shouldForwardProp:void 0,styleSheet:nI,stylis:Pf});yv.Consumer;ti.createContext(void 0);function Nf(){return Oe.useContext(yv)}var iI=function(){function e(t,i){var o=this;this.inject=function(a,s){s===void 0&&(s=Pf);var u=o.name+s.hash;a.hasNameForId(o.id,u)||a.insertRules(o.id,u,s(o.rules,u,"@keyframes"))},this.name=t,this.id="sc-keyframes-".concat(t),this.rules=i,qf(this,function(){throw Ra(12,String(o.name))})}return e.prototype.getName=function(t){return t===void 0&&(t=Pf),this.name+t.hash},e}(),rI=function(e){return e>="A"&&e<="Z"};function Hm(e){for(var t="",i=0;i<e.length;i++){var o=e[i];if(i===1&&o==="-"&&e[0]==="-")return e;rI(o)?t+="-"+o.toLowerCase():t+=o}return t.startsWith("ms-")?"-"+t:t}var Av=function(e){return e==null||e===!1||e===""},Tv=function(e){var t,i,o=[];for(var a in e){var s=e[a];e.hasOwnProperty(a)&&!Av(s)&&(Array.isArray(s)&&s.isCss||Wo(s)?o.push("".concat(Hm(a),":"),s,";"):pa(s)?o.push.apply(o,ga(ga(["".concat(a," {")],Tv(s),!1),["}"],!1)):o.push("".concat(Hm(a),": ").concat((t=a,(i=s)==null||typeof i=="boolean"||i===""?"":typeof i!="number"||i===0||t in RT||t.startsWith("--")?String(i).trim():"".concat(i,"px")),";")))}return o};function ir(e,t,i,o){if(Av(e))return[];if(Zf(e))return[".".concat(e.styledComponentId)];if(Wo(e)){if(!Wo(s=e)||s.prototype&&s.prototype.isReactComponent||!t)return[e];var a=e(t);return ir(a,t,i,o)}var s;return e instanceof iI?i?(e.inject(i,o),[e.getName(o)]):[e]:pa(e)?Tv(e):Array.isArray(e)?Array.prototype.concat.apply(Bu,e.map(function(u){return ir(u,t,i,o)})):[e.toString()]}function Iv(e){for(var t=0;t<e.length;t+=1){var i=e[t];if(Wo(i)&&!Zf(i))return!1}return!0}var oI=dv(Uu),sI=function(){function e(t,i,o){this.rules=t,this.staticRulesId="",this.isStatic=(o===void 0||o.isStatic)&&Iv(t),this.componentId=i,this.baseHash=Oo(oI,i),this.baseStyle=o,Eu.registerId(i)}return e.prototype.generateAndInjectStyles=function(t,i,o){var a=this.baseStyle?this.baseStyle.generateAndInjectStyles(t,i,o):"";if(this.isStatic&&!o.hash)if(this.staticRulesId&&i.hasNameForId(this.componentId,this.staticRulesId))a=Mr(a,this.staticRulesId);else{var s=_f(ir(this.rules,t,i,o)),u=wf(Oo(this.baseHash,s)>>>0);if(!i.hasNameForId(this.componentId,u)){var c=o(s,".".concat(u),void 0,this.componentId);i.insertRules(this.componentId,u,c)}a=Mr(a,u),this.staticRulesId=u}else{for(var f=Oo(this.baseHash,o.hash),g="",m=0;m<this.rules.length;m++){var v=this.rules[m];if(typeof v=="string")g+=v;else if(v){var T=_f(ir(v,t,i,o));f=Oo(f,T+m),g+=T}}if(g){var A=wf(f>>>0);i.hasNameForId(this.componentId,A)||i.insertRules(this.componentId,A,o(g,".".concat(A),void 0,this.componentId)),a=Mr(a,A)}}return a},e}(),Qf=ti.createContext(void 0);Qf.Consumer;var zd={};function aI(e,t,i){var o=Zf(e),a=e,s=!Wd(e),u=t.attrs,c=u===void 0?Bu:u,f=t.componentId,g=f===void 0?function(b,B){var L=typeof b!="string"?"sc":Om(b);zd[L]=(zd[L]||0)+1;var G="".concat(L,"-").concat(fv(Uu+L+zd[L]));return B?"".concat(B,"-").concat(G):G}(t.displayName,t.parentComponentId):f,m=t.displayName,v=m===void 0?function(b){return Wd(b)?"styled.".concat(b):"Styled(".concat(kT(b),")")}(e):m,T=t.displayName&&t.componentId?"".concat(Om(t.displayName),"-").concat(t.componentId):t.componentId||g,A=o&&a.attrs?a.attrs.concat(c).filter(Boolean):c,I=t.shouldForwardProp;if(o&&a.shouldForwardProp){var y=a.shouldForwardProp;if(t.shouldForwardProp){var w=t.shouldForwardProp;I=function(b,B){return y(b,B)&&w(b,B)}}else I=y}var M=new sI(i,T,o?a.componentStyle:void 0);function F(b,B){return function(L,G,Q){var re=L.attrs,ve=L.componentStyle,be=L.defaultProps,De=L.foldedComponentIds,Te=L.styledComponentId,de=L.target,Be=ti.useContext(Qf),Ae=Nf(),le=L.shouldForwardProp||Ae.shouldForwardProp,Y=lv(G,Be,be)||$o,X=function(Ie,se,Re){for(var Ce,K=Ht(Ht({},se),{className:void 0,theme:Re}),ae=0;ae<Ie.length;ae+=1){var Ue=Wo(Ce=Ie[ae])?Ce(K):Ce;for(var me in Ue)K[me]=me==="className"?Mr(K[me],Ue[me]):me==="style"?Ht(Ht({},K[me]),Ue[me]):Ue[me]}return se.className&&(K.className=Mr(K.className,se.className)),K}(re,G,Y),W=X.as||de,P={};for(var H in X)X[H]===void 0||H[0]==="$"||H==="as"||H==="theme"&&X.theme===Y||(H==="forwardedAs"?P.as=X.forwardedAs:le&&!le(H,W)||(P[H]=X[H]));var Z=function(Ie,se){var Re=Nf(),Ce=Ie.generateAndInjectStyles(se,Re.styleSheet,Re.stylis);return Ce}(ve,X),ee=Mr(De,Te);return Z&&(ee+=" "+Z),X.className&&(ee+=" "+X.className),P[Wd(W)&&!uv.has(W)?"class":"className"]=ee,P.ref=Q,Oe.createElement(W,P)}(N,b,B)}F.displayName=v;var N=ti.forwardRef(F);return N.attrs=A,N.componentStyle=M,N.displayName=v,N.shouldForwardProp=I,N.foldedComponentIds=o?Mr(a.foldedComponentIds,a.styledComponentId):"",N.styledComponentId=T,N.target=o?a.target:e,Object.defineProperty(N,"defaultProps",{get:function(){return this._foldedDefaultProps},set:function(b){this._foldedDefaultProps=o?function(B){for(var L=[],G=1;G<arguments.length;G++)L[G-1]=arguments[G];for(var Q=0,re=L;Q<re.length;Q++)Rf(B,re[Q],!0);return B}({},a.defaultProps,b):b}}),qf(N,function(){return".".concat(N.styledComponentId)}),s&&mv(N,e,{attrs:!0,componentStyle:!0,displayName:!0,foldedComponentIds:!0,shouldForwardProp:!0,styledComponentId:!0,target:!0}),N}function bm(e,t){for(var i=[e[0]],o=0,a=t.length;o<a;o+=1)i.push(t[o],e[o+1]);return i}var Gm=function(e){return Object.assign(e,{isCss:!0})};function Ev(e){for(var t=[],i=1;i<arguments.length;i++)t[i-1]=arguments[i];if(Wo(e)||pa(e))return Gm(ir(bm(Bu,ga([e],t,!0))));var o=e;return t.length===0&&o.length===1&&typeof o[0]=="string"?ir(o):Gm(ir(bm(o,t)))}function Df(e,t,i){if(i===void 0&&(i=$o),!t)throw Ra(1,t);var o=function(a){for(var s=[],u=1;u<arguments.length;u++)s[u-1]=arguments[u];return e(t,i,Ev.apply(void 0,ga([a],s,!1)))};return o.attrs=function(a){return Df(e,t,Ht(Ht({},i),{attrs:Array.prototype.concat(i.attrs,a).filter(Boolean)}))},o.withConfig=function(a){return Df(e,t,Ht(Ht({},i),a))},o}var Cv=function(e){return Df(aI,e)},wn=Cv;uv.forEach(function(e){wn[e]=Cv(e)});var lI=function(){function e(t,i){this.rules=t,this.componentId=i,this.isStatic=Iv(t),Eu.registerId(this.componentId+1)}return e.prototype.createStyles=function(t,i,o,a){var s=a(_f(ir(this.rules,i,o,a)),""),u=this.componentId+t;o.insertRules(u,u,s)},e.prototype.removeStyles=function(t,i){i.clearRules(this.componentId+t)},e.prototype.renderStyles=function(t,i,o,a){t>2&&Eu.registerId(this.componentId+t),this.removeStyles(t,o),this.createStyles(t,i,o,a)},e}();function uI(e){for(var t=[],i=1;i<arguments.length;i++)t[i-1]=arguments[i];var o=Ev.apply(void 0,ga([e],t,!1)),a="sc-global-".concat(fv(JSON.stringify(o))),s=new lI(o,a),u=function(f){var g=Nf(),m=ti.useContext(Qf),v=ti.useRef(g.styleSheet.allocateGSInstance(a)).current;return g.styleSheet.server&&c(v,f,g.styleSheet,m,g.stylis),ti.useLayoutEffect(function(){if(!g.styleSheet.server)return c(v,f,g.styleSheet,m,g.stylis),function(){return s.removeStyles(v,g.styleSheet)}},[v,f,g.styleSheet,m,g.stylis]),null};function c(f,g,m,v,T){if(s.isStatic)s.renderStyles(f,NT,m,T);else{var A=Ht(Ht({},g),{theme:lv(g,v,u.defaultProps)});s.renderStyles(f,A,m,T)}}return ti.memo(u)}function wv(e,t){var i=Oe.useRef(null),o=Oe.useRef(!1),a=Oe.useRef(e);a.current=e;var s=Oe.useCallback(function(c){o.current&&(a.current(c),i.current=requestAnimationFrame(s))},[]),u=Oe.useMemo(function(){return[function(){o.current&&(o.current=!1,i.current&&cancelAnimationFrame(i.current))},function(){o.current||(o.current=!0,i.current=requestAnimationFrame(s))},function(){return o.current}]},[]);return Oe.useEffect(function(){return u[0]},[]),u}function cI(e,t,i,o,a){var u;(u=e.onExit)==null||u.call(e,o,t);const s=a.find(({id:c})=>c===t);return s!=null&&s.onEnter?s.onEnter(o,i):{...i,enteredAt:o.updateContext.gameState.time}}function dI(e,t){return t.find(({id:i})=>i===e)}function fI(e,t){return e!==t}function hI(e){console.warn(`No handler found for state: ${e}`)}const oa="bushGrowing",Or="bushFull",vu="bushSpreading",ma="bushDying",Ct=24,wt=10,Ke=4e3,tt=4e3,Jf=2,gI=15,pI=5e3,Si=100,yi=20,Ai=60,mI=1e3,vI=5,SI=3,yI=12,AI=940,Of=20,xm=90,_v=45,Gr=5,TI=.5,xr=30,Ti=.1,ea=.9;var Hn=(e=>(e.Berry="berry",e.Meat="meat",e))(Hn||{});const eh={berry:"",meat:""},II={id:oa,update:(e,t)=>{const{entity:i,updateContext:o}=t,a=o.deltaTime*(Ct/wt);return i.age+=a,i.age>=i.lifespan?{nextState:ma,data:{...e,enteredAt:o.gameState.time}}:(i.timeSinceLastBerryRegen+=a,i.timeSinceLastBerryRegen>=yI&&i.food.length<i.maxFood&&(i.food.push({type:Hn.Berry}),i.timeSinceLastBerryRegen=0),i.food.length>=i.maxFood?{nextState:Or,data:{...e,enteredAt:o.gameState.time,previousState:oa}}:{nextState:oa,data:e})},onEnter:(e,t)=>({...t,enteredAt:e.updateContext.gameState.time})},EI={id:Or,update:(e,t)=>{const{entity:i,updateContext:o}=t,a=o.deltaTime*(Ct/wt);return i.age+=a,i.age>=i.lifespan?{nextState:ma,data:{...e,enteredAt:o.gameState.time,previousState:Or}}:i.food.length<i.maxFood?{nextState:oa,data:{...e,enteredAt:o.gameState.time,previousState:Or}}:(i.timeSinceLastSpreadAttempt+=a,i.timeSinceLastSpreadAttempt>=xm&&(i.timeSinceLastSpreadAttempt=0,o.gameState.time-i.timeSinceLastHarvest>=xm&&Math.random()<o.gameState.ecosystem.berryBushSpreadChance)?{nextState:vu,data:{...e,enteredAt:o.gameState.time,previousState:Or}}:{nextState:Or,data:e})},onEnter:(e,t)=>({...t,enteredAt:e.updateContext.gameState.time})},va=1,Mf=150*.6,CI=150*.25,wI=150*.7,_I=150*.8,RI=400,PI=800,Rv=300,NI=350,DI=120,OI=2,$m=400,MI=1e3,kI=150*.85,FI=100,LI=3,UI=24,Pv=600,BI=1,HI=1,bI=.5,GI=2,kf=24,sa=12,xI=24,Wm=24,$I=1500,Yd=500,WI=400,zI=10,YI=-5,jI=1.5,VI=1.5,XI=1.2,KI=10,ZI=150,qI=200,QI=100,JI=.7,eE=300,tE=100,nE=120,zm=600,Nv=.15,Dv=200,Su=30*.75*1.2,iE=20,rE=.3,oE=.6,sE=.8,aE=1,lE=3,uE=5,cE=6,Ym=.5,dE=.4,fE=.6,hE=.8,gE=2,zl=Ke/2,jm=60,Vm=2,Xm=.7,Km=.2,Zm=5,qm=50,pE=.1,Qm=400,mE=800,Ov=5,Mv=600,Hu=10,Sa=80,vE=3,Ys=5,$r=150,kv=$r*.8,SE=$r*.2,Wr=$r*.95,sr=30,Fv=10,yE=10,AE=.5,yt=30,zo=yt*.75,Lv=50,TE=20,IE=Sa*.8,EE=.7,CE=16,Uv=40,wE=24,th=16,_E=72/3,Jm=24,RE=1.25,PE=1.5,nh=$r*.6,ih=50,NE=1,DE=350,rh=Sa*.65,OE=80,ME=50,kE=1,FE=128,Bv=10,e0=100,oh=35,ii=yt,Hv=.5,bu=2.5,LE=5,sh=.5,ah=1.5,UE=.1,BE=.5,HE=1.5,bE=.25,GE=2.5,xE=45,$E=.05;function Bn(e,t){return{x:e.x+t.x,y:e.y+t.y}}function bv(e,t){return{x:e.x-t.x,y:e.y-t.y}}function Ot(e,t){return{x:e.x*t,y:e.y*t}}function Yo(e){return Math.sqrt(e.x*e.x+e.y*e.y)}function lt(e){const t=Yo(e);return t===0?{x:0,y:0}:Ot(e,1/t)}function WE(e,t){return Yo(bv(e,t))}function lh(e,t,i){return{x:e.x+(t.x-e.x)*i,y:e.y+(t.y-e.y)*i}}function Cu(e){if(e.length===0)return{x:0,y:0};const t=e.reduce((i,o)=>({x:i.x+o.x,y:i.y+o.y}),{x:0,y:0});return{x:t.x/e.length,y:t.y/e.length}}function Ye(e,t,i,o){let a=t.x-e.x,s=t.y-e.y;return Math.abs(a)>i/2&&(a=a-Math.sign(a)*i),Math.abs(s)>o/2&&(s=s-Math.sign(s)*o),{x:a,y:s}}function Bt(e,t,i){const o=Ye(e,t,i.width,i.height);return lt(o)}function V(e,t,i,o){const a=Ye(e,t,i,o);return Yo(a)}function zE(e,t){return e.x*t.x+e.y*t.y}function YE(e,t){const i=zE(e,t),o=Yo(e),a=Yo(t);if(o===0||a===0)return 0;const s=Math.max(-1,Math.min(1,i/(o*a)));return Math.acos(s)}function jE(e,t,i){const o=Math.max(0,Math.min(1,i)),a={r:parseInt(e.substring(1,3),16),g:parseInt(e.substring(3,5),16),b:parseInt(e.substring(5,7),16)},s={r:parseInt(t.substring(1,3),16),g:parseInt(t.substring(3,5),16),b:parseInt(t.substring(5,7),16)},u=Math.round(a.r+(s.r-a.r)*o),c=Math.round(a.g+(s.g-a.g)*o),f=Math.round(a.b+(s.b-a.b)*o),g=m=>("00"+m.toString(16)).slice(-2);return`#${g(u)}${g(c)}${g(f)}`}var Dt=(e=>(e.Friendly="Friendly",e.Hostile="Hostile",e))(Dt||{}),je=(e=>(e[e.None=0]="None",e[e.General=1]="General",e[e.Performance=2]="Performance",e[e.Ecosystem=3]="Ecosystem",e[e.Tribe=4]="Tribe",e))(je||{});function t0(e,t,i){return t.search.human.byRadius(e.position,i).filter(s=>{var c;return!(s.id===e.id||s.gender===e.gender||!s.isAdult||s.hunger>=Wr||(s.procreationCooldown||0)>0||s.gender==="female"&&s.isPregnant||(e.motherId===s.id||e.fatherId===s.id)&&((c=s.partnerIds)!=null&&c.length))}).sort((s,u)=>{const c=s.id===e.motherId||s.id===e.fatherId,f=e.id===s.motherId||e.id===s.fatherId,g=u.id===e.motherId||u.id===e.fatherId,m=e.id===u.motherId||e.id===u.fatherId;return c||f?1:g||m?-1:s.age-u.age})}function zr(e){if(e.length===0)return;const t=e.filter(a=>a.gender==="male"),i=e.filter(a=>a.gender==="female"),o=(a,s)=>a.age!==s.age?s.age-a.age:a.id-s.id;if(t.sort(o),t.length>0)return t[0];if(i.sort(o),i.length>0)return i[0]}function dn(e,t){const i=e,o=i.search.human.byProperty("motherId",t.id),a=i.search.human.byProperty("fatherId",t.id);return[...o,...a]}function VE(e,t,i){var a;if(e.id===t.id||e.motherId===t.id||e.fatherId===t.id||t.motherId===e.id||t.fatherId===e.id||e.motherId&&e.motherId===t.motherId||e.fatherId&&e.fatherId===t.fatherId||(a=e.partnerIds)!=null&&a.includes(t.id))return!0;if(e.motherId){const s=i.entities.entities[e.motherId];if(s&&(s.motherId===t.id||s.fatherId===t.id))return!0}if(e.fatherId){const s=i.entities.entities[e.fatherId];if(s&&(s.motherId===t.id||s.fatherId===t.id))return!0}if(t.motherId){const s=i.entities.entities[t.motherId];if(s&&(s.motherId===e.id||s.fatherId===e.id))return!0}if(t.fatherId){const s=i.entities.entities[t.fatherId];if(s&&(s.motherId===e.id||s.fatherId===e.id))return!0}return!1}function n0(e,t){var s,u,c,f;if(e.id===t.id||e.motherId===t.id||e.fatherId===t.id||t.motherId===e.id||t.fatherId===e.id||(s=e.partnerIds)!=null&&s.includes(t.id)||(u=t.partnerIds)!=null&&u.includes(e.id))return!0;if(e.fatherId===void 0&&e.motherId===void 0||t.fatherId===void 0&&t.motherId===void 0)return!1;const i=e.motherId===t.motherId||e.fatherId===t.fatherId,o=t.motherId===e.motherId||t.fatherId===e.fatherId,a=((c=e.ancestorIds)==null?void 0:c.some(g=>t.ancestorIds.includes(g)))||((f=t.ancestorIds)==null?void 0:f.some(g=>e.ancestorIds.includes(g)));return i||o||a}function XE(e,t){const i=[];if(e.motherId){const o=t.entities.entities[e.motherId];o&&i.push(o)}if(e.fatherId){const o=t.entities.entities[e.fatherId];o&&i.push(o)}return i}function KE(e,t){if(e.gender!=="female"||!e.partnerIds||e.partnerIds.length===0)return null;for(const i of e.partnerIds){const o=t.entities.entities[i];if(o&&o.gender==="male")return o}return null}function ZE(e,t){var i;if(!e.isAdult&&e.fatherId){const o=t.entities.entities[e.fatherId];if(o&&o.type==="human")return o}if(e.isAdult&&e.fatherId){const o=t.entities.entities[e.fatherId];if(o&&o.type==="human"&&((i=zr(dn(t,o)))==null?void 0:i.id)===e.id)return o}return e.isAdult&&e.gender==="female"&&e.partnerIds&&e.partnerIds.length>0?KE(e,t):null}function wu(e,t){var o;const i=new Set;if(e.motherId){const a=t.entities.entities[e.motherId];a&&i.add(a)}if(e.fatherId){const a=t.entities.entities[e.fatherId];a&&i.add(a)}return(o=e.partnerIds)==null||o.forEach(a=>{const s=t.entities.entities[a];s&&i.add(s)}),dn(t,e).forEach(a=>i.add(a)),Array.from(i)}function Gv(e,t){const i=new Map;function o(a){const s=dn(t,a);for(const u of s)i.has(u.id)||(i.set(u.id,u),o(u))}return o(e),Array.from(i.values())}function jo(e,t){return t.search.human.byProperty("leaderId",e)}function xv(e,t){var u,c,f;const i=new Map,o=Object.values(e.entities.entities).filter(g=>g.type==="human");for(const g of o)g.leaderId&&(i.has(g.leaderId)||i.set(g.leaderId,{leaderId:g.leaderId,tribeBadge:g.tribeBadge||"?",members:[]}),(u=i.get(g.leaderId))==null||u.members.push(g));const a=t?(f=(c=e.entities.entities[t])==null?void 0:c.tribeControl)==null?void 0:f.diplomacy:void 0,s=Array.from(i.values()).map(g=>{const m=e.entities.entities[g.leaderId],v=g.members.filter(A=>A.isAdult).length,T=g.members.length-v;return{leaderId:g.leaderId,tribeBadge:g.tribeBadge,adultCount:v,childCount:T,isPlayerTribe:g.leaderId===t,leaderAge:(m==null?void 0:m.age)??0,leaderGender:(m==null?void 0:m.gender)??"male",diplomacyStatus:(a==null?void 0:a[g.leaderId??-1])??Dt.Friendly}});return s.sort((g,m)=>g.isPlayerTribe?-1:m.isPlayerTribe?1:m.adultCount+m.childCount-(g.adultCount+g.childCount)),s}function ri(e,t){return e.leaderId?t.search.human.byProperty("leaderId",e.leaderId):[]}function $v(e,t,i,o){const a=Math.random()*Math.PI*2,s=Math.sqrt(Math.random())*t,u={x:Math.cos(a)*s,y:Math.sin(a)*s},c=Bn(e,u);return{x:(c.x%i+i)%i,y:(c.y%o+o)%o}}function bn(e,t,i,o){const a=t,s={left:e.x-i,top:e.y-i,right:e.x+i,bottom:e.y+i},u=[...a.search.human.byRect(s),...a.search.berryBush.byRect(s),...a.search.corpse.byRect(s)];for(const c of u){if(o!==void 0&&c.id===o)continue;if(V(e,c.position,t.mapDimensions.width,t.mapDimensions.height)<i+c.radius)return!0}return!1}function qE(e,t,i,o,a){const s=t.mapDimensions.width,u=t.mapDimensions.height;if(!bn(e,t,o,a))return e;const c=o;for(let f=c;f<=i;f+=c){const g=Math.ceil(2*Math.PI*f/c);for(let m=0;m<g;m++){const v=m/g*2*Math.PI,T={x:Math.cos(v)*f,y:Math.sin(v)*f},A=Bn(e,T),I={x:(A.x%s+s)%s,y:(A.y%u+u)%u};if(!bn(I,t,o,a))return I}}return null}function ar(e,t){const i=t.search.building.byProperty("ownerId",e);if(i.length>0){const s=i.map(u=>u.position);return Cu(s)}const o=jo(e,t);if(o.length===0){const s=t.entities.entities[e];return s?s.position:{x:0,y:0}}const a=o.map(s=>s.position);return Cu(a)}function i0(e,t){const o=[...wu(e,t),e].map(a=>a.position);return Cu(o)}function QE(e,t,i){const o=i.mapDimensions.width,a=i.mapDimensions.height;let s=e.x-t.position.x,u=e.y-t.position.y;return Math.abs(s)>o/2&&(s-=Math.sign(s)*o),Math.abs(u)>a/2&&(u-=Math.sign(u)*a),Math.abs(s)<=t.width/2&&Math.abs(u)<=t.height/2}function JE(e,t,i){return t.search.human.byRadius(e.position,i).filter(a=>{var s;return a.activeAction==="procreating"&&a.gender===e.gender&&typeof a.target=="number"&&((s=e.partnerIds)==null?void 0:s.includes(a.target))})[0]}function eC(e,t,i){const o=wu(e,t),a=t;for(const s of o){if(V(e.position,s.position,t.mapDimensions.width,t.mapDimensions.height)>i)continue;const c=a.search.human.byProperty("attackTargetId",s.id);for(const f of c)if(f.leaderId!==e.leaderId)return{familyMember:s,aggressor:f}}}function tC(e,t){const o=t.search.human.byRadius(e.position,eE);let a,s=1/0;for(const u of o){if(u.id===e.id||u.hitpoints<=0||u.hitpoints/u.maxHitpoints>JI||VE(e,u,t))continue;const c=V(e.position,u.position,t.mapDimensions.width,t.mapDimensions.height);c<s&&(s=c,a=u)}return a}function uh(e,t,i){return t.search.human.byRadius(e.position,i).filter(a=>ns(e,a,t))}function nC(e,t,i){const o=i.search.human.byProperty("leaderId",e);let a=0;for(const s of o)s.attackTargetId===t&&a++;return a}function r0(e,t,i,o){const a=i.search.berryBush.byRadius(e,t),s=i.search.human.byRadius(e,t).filter(f=>f.leaderId!==o);let u=a.length*zI;u+=s.length*YI;let c;if(s.length>0){const f={};for(const m of s)m.leaderId&&(f[m.leaderId]=(f[m.leaderId]||0)+1);let g=0;for(const m in f)f[m]>g&&(g=f[m],c=parseInt(m,10))}return{score:u,occupyingTribeId:c}}function _u(e){return e.filter(t=>t.isAdult).reduce((t,i)=>{let o=i.hitpoints;return o+=(i.maxAge-i.age)*.5,o+=i.food.length*2,t+o},0)}function iC(e,t){if(e.id!==e.leaderId)return null;const i=t,o=ar(e.id,t),{score:a}=r0(o,Yd/2,i,e.id);let s=null,u=a;const c=WI,f=$I;for(let g=e.position.x-f;g<e.position.x+f;g+=c)for(let m=e.position.y-f;m<e.position.y+f;m+=c){const v={x:(g%t.mapDimensions.width+t.mapDimensions.width)%t.mapDimensions.width,y:(m%t.mapDimensions.height+t.mapDimensions.height)%t.mapDimensions.height};if(V(o,v,t.mapDimensions.width,t.mapDimensions.height)<Yd*2)continue;const{score:A}=r0(v,Yd/2,i,e.id);A>u*jI&&(u=A,s=v)}return s}function Me(e,t,i,o,a){const s=t,u=o,c="position"in e&&e.id?e:null,f=c?c.position:e,g=s.search[i].byRadius(f,u);let m=null,v=u;for(const T of g){if(T.id===(c==null?void 0:c.id)||a&&!a(T))continue;const A=V(f,T.position,t.mapDimensions.width,t.mapDimensions.height);A<v&&(v=A,m=T)}return m}function rC(e,t,i,o){return t.search[i].byRadius(e,o)}function o0(e,t,i,o){return rC(e,t,i,o).length}function pt(e){const i=e.search.human.byProperty("isPlayer",!0);return i.length>0?i[0]:void 0}function oC(e,t){var u;const o=t.search.human.byProperty("activeAction","attacking");let a=null,s=1/0;for(const c of o){if(c.attackTargetId!==e)continue;const f=V(c.position,((u=t.entities.entities[e])==null?void 0:u.position)||{x:0,y:0},t.mapDimensions.width,t.mapDimensions.height);f<s&&(a=c,s=f)}return a}function Wv(e){return Object.values(e.entities.entities).filter(t=>t.type==="human")}function sC(e,t,i){const o=Object.values(t.entities.entities).reverse();for(const a of o)if(WE(e,a.position)<a.radius)return a}function aC(e,t,i,o){const a=Wv(o),s={};for(const u of a)!u.leaderId||u.leaderId===t||(s[u.leaderId]||(s[u.leaderId]={sumX:0,sumY:0,count:0}),s[u.leaderId].sumX+=u.position.x,s[u.leaderId].sumY+=u.position.y,s[u.leaderId].count++);for(const u in s){const c=s[u],f={x:c.sumX/c.count,y:c.sumY/c.count};if(V(e,f,o.mapDimensions.width,o.mapDimensions.height)<i)return!0}return!1}const _t=30,ts=_t*.6,zv="#4CAF50",Yv="#FF5722",jv="#9C27B0",lC="#2196F3",Vv="#FFC107",uC="#DC143C",ch="#FFFFFF",dh=[5,5],Gu=5,Vo=15,cC=20,dC=16,fC=10,hC=16,gC=16,s0=["","","","","","","","","",""],Ff=8,pC="#FFFFFF",St=18,Ve=15,mC="rgba(0, 0, 0, 0.7)",vC=4,Wi=150,an=15,hi=10,Ji="#555",SC="#f44336",yC="#4CAF50",AC="#2196F3",TC="#FFC107",Yl=16,wr=32,jl=28,IC=10,EC=8,CC=8,wC=8,An=28,Vl=40,_C="rgba(255, 215, 0, 0.7)",RC="rgba(0, 0, 0, 0.3)",Kn=10,a0=8,jd=11,zi=20,Vd=40,l0=5,PC=10,NC="#FFA500",DC="#808080",vi=120,Xv=30,OC=20,qi="#2d3748",Yt="#ffffff",Xl="#4a5568",Kv=5,fh="#bdc9f792",Zv="#272c36ff",qv="#a0aec0",Ru=300,Qv="rgba(255, 255, 255, 0.5)",MC="rgba(0, 0, 0, 0.8)",kC="#FFFFFF",u0=14,c0=8,d0=-15,Jv="#FFD700",eS=5,FC=10,Xd=12,LC=10,UC="#4CAF50",BC="#F44336",HC="#FFC107",bC="rgba(255, 255, 255, 0.2)",f0="#FFFFFF",GC="#FF6B6B",xC=5,tS=30,Kl=50,Zl=8,$C=10,WC="rgba(0, 0, 0, 0.5)",zC="#FFFFFF",YC=33,jC=400,VC=20,XC=10,KC="rgba(0, 0, 0, 0.7)",ZC="#FFFFFF",Kd=20,h0=16,qC=.5,g0=5,nS="#FFD700",QC=40,hh=4,iS=3,JC=5,rS=20,oS=5,ew="#FFFFFF",tw="#FF6B6B",ln=80,_r=10,ql=300,Rr=15,nw=8,iw="rgba(0, 0, 0, 0.8)",rw="#FFFFFF",Zd=14,p0=10,Zn=20,ow="#FF6B6B",sw="#4CAF50",m0="#FFD700",aw="rgba(255, 255, 0, 0.3)",lw=2,uw=500,cw=120,dw=45,fw="#FFD700",hw=3,gw=4;let qd=0;function Lf(){const e=s0[qd];return qd=(qd+1)%s0.length,e}const v0=20,pw=.3,mw=24,S0=250,Xo=10,sS=250,ya=12,aS=10,vw=10;var we=(e=>(e.Leader="leader",e.Gatherer="gatherer",e.Planter="planter",e.Hunter="hunter",e.Mover="mover",e.Warrior="warrior",e))(we||{}),ce=(e=>(e.Gather="Gather",e.Eat="Eat",e.Procreate="Procreate",e.Attack="Attack",e.Plant="Plant",e.CallToAttack="CallToAttack",e.TribeSplit="TribeSplit",e.FollowMe="FollowMe",e.FeedChild="FeedChild",e.HuntPrey="HuntPrey",e.DefendAgainstPredator="DefendAgainstPredator",e.Build="Build",e.Removal="Removal",e.Deposit="Deposit",e.Retrieve="Retrieve",e.TakeOverBuilding="TakeOverBuilding",e.RemoveEnemyBuilding="RemoveEnemyBuilding",e.AutopilotMove="AutopilotMove",e.AutopilotGather="AutopilotGather",e.AutopilotAttack="AutopilotAttack",e.AutopilotProcreate="AutopilotProcreate",e.AutopilotPlant="AutopilotPlant",e.AutopilotFeedChild="AutopilotFeedChild",e.AutopilotFollowMe="AutopilotFollowMe",e.AutopilotDeposit="AutopilotDeposit",e.AutopilotRetrieve="AutopilotRetrieve",e))(ce||{});const xu={Gather:"",Eat:"",Procreate:"",Attack:"",Plant:"",CallToAttack:"",TribeSplit:"",FollowMe:"",FeedChild:"",HuntPrey:"",DefendAgainstPredator:"",Build:"",Removal:"",Deposit:"",Retrieve:"",TakeOverBuilding:"",RemoveEnemyBuilding:"",AutopilotMove:"",AutopilotGather:"",AutopilotAttack:"",AutopilotProcreate:"",AutopilotPlant:"",AutopilotFeedChild:"",AutopilotFollowMe:"",AutopilotDeposit:"",AutopilotRetrieve:""},lS={Gather:"Gather",Eat:"Eat",Procreate:"Procreate",Attack:"Attack",Plant:"Plant",CallToAttack:"Call to Attack",TribeSplit:"Split Tribe",FollowMe:"Follow Me",FeedChild:"Feed Child",HuntPrey:"Hunt Prey",DefendAgainstPredator:"Defend",Build:"Build",Removal:"Remove",Deposit:"Deposit",Retrieve:"Retrieve",TakeOverBuilding:"Take Over",RemoveEnemyBuilding:"Destroy Enemy Building",AutopilotMove:"Walk",AutopilotGather:"Gather",AutopilotAttack:"Attack",AutopilotProcreate:"Procreate",AutopilotPlant:"Plant",AutopilotFeedChild:"Feed",AutopilotFollowMe:"Follow",AutopilotDeposit:"Deposit",AutopilotRetrieve:"Retrieve"};we.Leader+"",we.Gatherer+"",we.Planter+"",we.Hunter+"",we.Mover+"",we.Warrior+"";we.Leader+"",we.Gatherer+"",we.Planter+"",we.Hunter+"",we.Mover+"",we.Warrior+"";var Po=(e=>(e.Time="Time",e.Hunger="Hunger",e.Hitpoints="Hitpoints",e.Food="Food",e.Autopilot="Autopilot",e.Muted="Muted",e.Family="Family",e.Tribes="Tribes",e))(Po||{});const js={Time:"",Hunger:"",Hitpoints:"",Food:"",Autopilot:"",Muted:"",Family:"",Tribes:""};var ne=(e=>(e.ToggleMute="ToggleMute",e.TogglePause="TogglePause",e.FastForward="FastForward",e.DismissTutorial="DismissTutorial",e.ReturnToIntro="ReturnToIntro",e.ConfirmExitYes="ConfirmExitYes",e.ConfirmExitNo="ConfirmExitNo",e.CommandEat="CommandEat",e.CommandPlant="CommandPlant",e.CommandCallToAttack="CommandCallToAttack",e.CommandFollowMe="CommandFollowMe",e.CommandGather="CommandGather",e.CommandTribeSplit="CommandTribeSplit",e.CommandBuild="CommandBuild",e.SelectStorageSpot="SelectStorageSpot",e.SelectPlantingZone="SelectPlantingZone",e.SelectRemovalTool="SelectRemovalTool",e.ToggleProcreationBehavior="ToggleProcreationBehavior",e.ToggleAttackBehavior="ToggleAttackBehavior",e.ToggleFeedChildBehavior="ToggleFeedChildBehavior",e.TogglePlantingBehavior="TogglePlantingBehavior",e.ToggleGatheringBehavior="ToggleGatheringBehavior",e.ToggleAutopilotFollowLeaderBehavior="ToggleAutopilotFollowLeaderBehavior",e.ToggleDiplomacy="ToggleDiplomacy",e.OpenRoleManager="OpenRoleManager",e.CloseRoleManager="CloseRoleManager",e.IncreaseRoleWeight="IncreaseRoleWeight",e.DecreaseRoleWeight="DecreaseRoleWeight",e))(ne||{});const Sw=12,yw=24,Aw=150*.9,Tw=24;var Aa=(e=>(e.Hello="HELLO",e.NewTribeFormed="NEW_TRIBE_FORMED",e.NoHeir="NO_HEIR",e.ChildrenStarving="CHILDREN_STARVING",e))(Aa||{});let Iw=0;function Ew(){return`notification-${Date.now()}-${Iw++}`}function Uf(e,t){if(t.identifier){const o=e.notifications.find(a=>a.identifier===t.identifier);if(o){if(o.dismissedUntil&&e.time<o.dismissedUntil)return;o.message=t.message,o.timestamp=e.time,o.creationTime=Date.now(),o.duration=t.duration,o.targetEntityIds=t.targetEntityIds,o.highlightedEntityIds=t.highlightedEntityIds,o.targetPosition=t.targetPosition,o.targetArea=t.targetArea,o.targetRadius=t.targetRadius,o.isDismissed=!1,o.dismissedUntil=void 0;return}}const i={...t,id:Ew(),timestamp:e.time,creationTime:Date.now(),isDismissed:!1};e.notifications.push(i)}function Cw(e,t){const i=e.notifications.find(o=>o.id===t);i&&(i.isDismissed=!0,i.identifier&&(i.dismissedUntil=e.time+Tw))}function ww(e){const t=e.time;e.notifications=e.notifications.filter(i=>i.duration===0?!0:!(t-i.timestamp>i.duration))}function _w(e){for(const i of Object.values(e.entities.entities))i.isHighlighted=!1;const t=e.notifications.filter(i=>!i.isDismissed);for(const i of t)if(i.highlightedEntityIds)for(const o of i.highlightedEntityIds){const a=e.entities.entities[o];a&&(a.isHighlighted=!0)}}const y0=600,Rw=1.5,uS=.1,Ql=""+new URL("attack-D4MA8VWK.mp3",import.meta.url).href,Qd=""+new URL("gather-CU75596W.mp3",import.meta.url).href,Pw=""+new URL("eat-DCjHq2QD.mp3",import.meta.url).href,Jd=""+new URL("procreate-CfE4r5Cp.mp3",import.meta.url).href,Nw=""+new URL("birth-Cbd67GHT.mp3",import.meta.url).href,Dw=""+new URL("child-fed-DzEPuMid.mp3",import.meta.url).href,Ow=""+new URL("human-death-B6HFLXES.mp3",import.meta.url).href,Mw=""+new URL("game-over-C5dqkyER.mp3",import.meta.url).href,kw=""+new URL("button-click-DomLUeaU.mp3",import.meta.url).href,Fw=""+new URL("soundtrack-1-BdlYUGye.mp3",import.meta.url).href;var ge=(e=>(e[e.Attack=0]="Attack",e[e.Gather=1]="Gather",e[e.Eat=2]="Eat",e[e.Procreate=3]="Procreate",e[e.Birth=4]="Birth",e[e.ChildFed=5]="ChildFed",e[e.HumanDeath=6]="HumanDeath",e[e.Seize=7]="Seize",e[e.CallToAttack=8]="CallToAttack",e[e.TribeSplit=9]="TribeSplit",e[e.CallToFollow=10]="CallToFollow",e[e.StorageDeposit=11]="StorageDeposit",e[e.StorageRetrieve=12]="StorageRetrieve",e[e.StorageSteal=13]="StorageSteal",e[e.GameOver=14]="GameOver",e[e.ButtonClick=15]="ButtonClick",e[e.SoundTrack1=16]="SoundTrack1",e))(ge||{});const Lw=new Map([[0,Ql],[1,Qd],[2,Pw],[3,Jd],[4,Nw],[5,Dw],[6,Ow],[14,Mw],[15,kw],[7,Ql],[8,Ql],[9,Jd],[10,Jd],[11,Qd],[12,Qd],[13,Ql],[16,Fw]]);let Vs,Ta;function Uw(){if(!(typeof window>"u"))return Ta}function gh(){if(!(typeof window>"u"))return!Vs&&typeof window.AudioContext=="function"&&(Vs=new window.AudioContext,Ta=Vs.createGain(),Ta.connect(Vs.destination),aa(.1,!1)),Vs}function aa(e,t){Ta&&(Ta.gain.value=t?0:e/10)}const cS=new Map;let Jl=!1,A0=!1;async function Bw(){if(A0||Jl)return;const e=gh();if(!e){console.error("AudioContext not supported. Cannot load sounds.");return}e.state==="suspended"&&e.resume(),Jl=!0,console.log("Starting sound loading...");const t=[];Lw.forEach((i,o)=>{const a=fetch(i).then(s=>{if(!s.ok)throw new Error(`Failed to fetch sound: ${i}`);return s.arrayBuffer()}).then(s=>e.decodeAudioData(s)).then(s=>{cS.set(o,s)}).catch(s=>{console.error(`Error loading sound ${ge[o]} from ${i}:`,s)});t.push(a)});try{await Promise.all(t),A0=!0,Jl=!1,console.log("All sounds loaded successfully.")}catch(i){Jl=!1,console.error("An error occurred while loading sounds:",i)}}const la=new Map;function ph(e,t){const i=gh(),o=Uw();if(!i||!o||o.gain.value===0&&(t==null?void 0:t.trackId)===void 0)return;i.state==="suspended"&&i.resume();const a=cS.get(e);if(!a){console.warn(`Sound buffer not found for type: ${ge[e]}`);return}if(t!=null&&t.trackId&&la.has(t.trackId))return;const s=i.createBufferSource();s.buffer=a,s.loop=(t==null?void 0:t.loop)??!1;const u=i.createGain(),c=i.createStereoPanner();let f=u;if(t!=null&&t.position&&(t!=null&&t.listenerPosition)&&(t!=null&&t.worldDimensions)){const g=Ye(t.listenerPosition,t.position,t.worldDimensions.width,t.worldDimensions.height),m=V(t.listenerPosition,t.position,t.worldDimensions.width,t.worldDimensions.height);if(m>y0)return;const v=1-Math.pow(m/y0,Rw);u.gain.value=Math.max(0,v);const T=Math.sin(g.x/m*(Math.PI/2));c.pan.value=isNaN(T)?0:T,u.connect(c),f=c}else{const g=e===ge.GameOver?.4:e===ge.SoundTrack1?1:.2;u.gain.value=g}s.connect(f),f.connect(o),s.start(0),t!=null&&t.trackId&&(la.set(t.trackId,{sourceNode:s,gainNode:u}),s.onended=()=>{la.delete(t.trackId)})}function ef(e,t=1){const i=la.get(e),o=gh();if(i&&o){const{sourceNode:a,gainNode:s}=i,u=o.currentTime;s.gain.setValueAtTime(s.gain.value,u),s.gain.linearRampToValueAtTime(0,u+t),a.stop(u+t),a.onended=null,la.delete(e)}}function _e(e,t,i){const o=pt(e.gameState);o&&ph(t,{position:i,listenerPosition:o.position,worldDimensions:e.gameState.mapDimensions,masterVolume:e.gameState.masterVolume,isMuted:e.gameState.isMuted})}function Hw(e,t,i){const o=i.mapDimensions.width,a=i.mapDimensions.height,s=t.radius*2;for(let u=S0;u<o/2;u+=50)for(let c=0;c<10;c++){const f=$v(e,u,o,a);if(!(V(e,f,o,a)<S0)&&!bn(f,i,s,t.id))return f}return null}function $u(e,t){if(!e.isAdult||e.gender!=="male"||e.leaderId===e.id||!e.leaderId)return{canSplit:!1};if(!e.leaderId)return{canSplit:!1};const i=t.entities.entities[e.leaderId];if(!i||i.type!=="human")return{canSplit:!1};const o=zr(dn(t,i));if(o&&o.id===e.id)return{canSplit:!1};const a=jo(e.leaderId,t).filter(f=>f.isAdult);if(a.length<v0)return{canSplit:!1};const u=Gv(e,t).filter(f=>f.isAdult).length+1,c=Math.min(a.length*pw,v0);return{canSplit:u>=c,progress:u/c}}function mh(e,t){var u;if(!$u(e,t).canSplit)return;const i=e.leaderId?t.entities.entities[e.leaderId]:void 0,o=Lf(),a=Gv(e,t);e.leaderId=e.id,e.tribeBadge=o,e.tribeRole=we.Leader,e.tribeControl={roleWeights:{gatherer:1,planter:1,hunter:1,mover:1,warrior:1,leader:0},diplomacy:{}},i&&((u=i.tribeControl)!=null&&u.diplomacy)&&(i.tribeControl.diplomacy[e.id]=Dt.Hostile);for(const c of a)c.leaderId=e.id,c.tribeBadge=o;Uf(t,{type:Aa.NewTribeFormed,message:`A new tribe has formed! ${o}`,duration:yw,targetEntityIds:[e.id],highlightedEntityIds:[e.id,...a.map(c=>c.id)]}),_e({gameState:t},ge.TribeSplit,e.position)}const ns=(e,t,i)=>{var o,a;return e.id===t.id?!1:e.leaderId&&!t.leaderId?!0:e.leaderId===t.leaderId?!1:e.leaderId&&t.leaderId?((a=(o=i.entities.entities[e.leaderId])==null?void 0:o.tribeControl)==null?void 0:a.diplomacy[t.leaderId])===Dt.Hostile:!1},Ln=(e,t,i)=>{var a,s;return!e.leaderId||!t.ownerId||t.ownerId===e.leaderId?!1:((s=(a=i.entities.entities[e.leaderId])==null?void 0:a.tribeControl)==null?void 0:s.diplomacy[t.ownerId])===Dt.Hostile},jr=(e,t,i)=>{if(e.id===t.id||e.gender===t.gender||!e.isAdult||!t.isAdult||e.hunger>=Wr||t.hunger>=Wr||(e.procreationCooldown||0)>0||(t.procreationCooldown||0)>0||ns(e,t,i))return!1;const o=e.gender==="female"?e:t;return!(o.isPregnant||o.age>Uv)},bw=20,Cn=30,Gw=.5,xw=.3,$w=2,Ww=50;function vh(e,t){const i=[];if(t.food.length>0&&t.hunger>sr&&i.push({type:ce.Eat,action:"eating",key:"f"}),t.food.length<t.maxFood){const s=Me(t,e,"berryBush",yt,f=>f.food.length>0),u=Me(t,e,"corpse",yt,f=>f.food.length>0);let c=null;s&&u?c=V(t.position,s.position,e.mapDimensions.width,e.mapDimensions.height)<=V(t.position,u.position,e.mapDimensions.width,e.mapDimensions.height)?s:u:c=s||u,c&&i.push({type:ce.Gather,action:"gathering",key:"e",targetEntity:c})}const o=Me(t,e,"human",yt,s=>jr(t,s,e));if(o&&i.push({type:ce.Procreate,action:"procreating",key:"r",targetEntity:o}),t.food.length>0&&t.isAdult){const s=Me(t,e,"human",yt,u=>{const c=u;return!c.isAdult&&(c.motherId===t.id||c.fatherId===t.id)&&c.hunger>=sr});s&&i.push({type:ce.FeedChild,action:"feeding",key:"h",targetEntity:s})}const a=Me(t,e,"human",ii,s=>ns(t,s,e))??Me(t,e,"predator",ii)??Me(t,e,"prey",ii);if(a&&i.push({type:ce.Attack,action:"attacking",key:"q",targetEntity:a}),t.food.filter(s=>s.type===Hn.Berry).length>=Gr&&i.push({type:ce.Plant,action:"planting",key:"b"}),t.food.length>0&&t.isAdult){const s=Me(t,e,"building",Cn,u=>{const c=u;return c.buildingType==="storageSpot"&&c.ownerId===t.leaderId&&c.isConstructed&&c.storedFood!==void 0&&c.storageCapacity!==void 0&&c.storedFood.length<c.storageCapacity});s&&i.push({type:ce.Deposit,action:"idle",key:"x",targetEntity:s})}if(t.food.length<t.maxFood&&t.isAdult){const s=Me(t,e,"building",Cn,u=>{const c=u;return c.buildingType==="storageSpot"&&c.ownerId===t.leaderId&&c.isConstructed&&c.storedFood!==void 0&&c.storedFood.length>0});s&&i.push({type:ce.Retrieve,action:"idle",key:"z",targetEntity:s})}return t.leaderId===t.id&&!t.isCallingToAttack&&uh(t,e,sS).length>0&&i.push({type:ce.CallToAttack,action:"idle",key:"v"}),$u(t,e).canSplit&&i.push({type:ce.TribeSplit,action:"idle",key:"k"}),t.leaderId===t.id&&!t.isCallingToFollow&&i.push({type:ce.FollowMe,action:"idle",key:"c"}),i}const ni={StorageSpot:"storageSpot",PlantingZone:"plantingZone"},Pa={[ni.StorageSpot]:{name:"Storage Spot",description:"A designated area for storing excess food.",icon:"",dimensions:{width:40,height:40},constructionTimeHours:.1,destructionTimeHours:.1,cost:{}},[ni.PlantingZone]:{name:"Planting Zone",description:"An area marked for agricultural use.",icon:"",dimensions:{width:60,height:60},constructionTimeHours:.1,destructionTimeHours:.1,cost:{}}},zw=.5,Yw="#FFA500",jw="#FF4500",T0=4,Vw=10;function dS(e){return Pa[e].dimensions}function Xw(e){return Pa[e].constructionTimeHours}function Kw(e){return Pa[e].destructionTimeHours}function Sh(e,t,i,o){if(i===void 0)return!1;const a=dS(t),s=Math.sqrt(a.width*a.width+a.height*a.height)/2;if(bn(e,o,s*.8))return!1;const c=o.search.building.byRadius(e,s*2);for(const f of c){const g=V(e,f.position,o.mapDimensions.width,o.mapDimensions.height),m=(Math.max(a.width,a.height)+Math.max(f.width,f.height))/2;if(g<m*.9)return!1}return!0}function Bf(e,t,i,o){return OR(o.entities,e,t,i)}function Zw(e,t){const i=t.entities.entities[e];i&&i.type==="building"&&!i.isBeingDestroyed&&(i.isBeingDestroyed=!0,i.destructionProgress=0)}function qw(e,t){const a=t.search.building.byRadius(e,100);for(const s of a){let u=e.x-s.position.x,c=e.y-s.position.y;const f=t.mapDimensions.width,g=t.mapDimensions.height;if(Math.abs(u)>f/2&&(u-=Math.sign(u)*f),Math.abs(c)>g/2&&(c-=Math.sign(c)*g),Math.abs(u)<=s.width/2&&Math.abs(c)<=s.height/2)return s}}const Qw=500,Jw=500;function e_(e,t){if(!e.leaderId)return 0;const i=t_(e.leaderId,t),o=n_(e.leaderId,t);return o===0?0:Math.min(1,i/o)}function t_(e,t){const i=ri({leaderId:e},t),o=Na(e,t),a=i.reduce((u,c)=>u+c.food.length,0),s=o.reduce((u,c)=>{var f;return u+(((f=c.storedFood)==null?void 0:f.length)||0)},0);return a+s}function n_(e,t){const i=ri({leaderId:e},t),o=Na(e,t),a=i.reduce((u,c)=>u+c.maxFood,0),s=o.reduce((u,c)=>u+(c.storageCapacity||0),0);return a+s}function fS(e,t){const i=Na(e,t);if(i.length===0)return 0;const o=i.reduce((s,u)=>{var c;return s+(((c=u.storedFood)==null?void 0:c.length)||0)},0),a=i.reduce((s,u)=>s+(u.storageCapacity||0),0);return a===0?0:Math.min(1,o/a)}function hS(e,t){const i=ri({leaderId:e},t);return i.length===0?0:i_(e,t)/i.length}function i_(e,t){const i=t,o=ar(e,t);return i.search.berryBush.byRadius(o,Qw).filter(u=>{const c=u.stateMachine&&u.stateMachine[0]==="bushDying",f=u.food.length>0;return!c&&f}).length}function yh(e,t){return e.leaderId?t.search.building.all().filter(a=>{if(a.buildingType!==ni.PlantingZone||!a.isConstructed)return!1;if(a.ownerId){const s=t.entities.entities[a.ownerId];return s&&s.leaderId===e.leaderId}return!1}):[]}function r_(e){const t=xr*2,i=Math.floor(e.width/t),o=Math.floor(e.height/t);return i*o}function o_(e,t){const i=t,o=Math.max(e.width,e.height);return i.search.berryBush.byRadius(e.position,o).filter(u=>{const c=Math.abs(u.position.x-e.position.x),f=Math.abs(u.position.y-e.position.y);return c<=e.width/2&&f<=e.height/2}).length}function s_(e,t){if(!e.leaderId)return[];const i=Na(e.leaderId,t),o=ri(e,t);return i.map(a=>{var g;const s=a.storageCapacity||0,u=((g=a.storedFood)==null?void 0:g.length)||0,c=o.filter(m=>{if(m.activeAction!=="depositing")return!1;if(typeof m.target=="object"&&"x"in m.target){const v=m.target;return V(v,a.position,t.mapDimensions.width,t.mapDimensions.height)<=50}return!1}).length,f=V(e.position,a.position,t.mapDimensions.width,t.mapDimensions.height);return{storage:a,capacity:s,currentFood:u,assignedDepositors:c,distance:f}})}function a_(e,t){const i=s_(e,t);if(i.length===0)return null;const o=i.filter(a=>{const s=a.currentFood<a.capacity,u=a.distance<=Jw;return s&&u});return o.length===0?null:(o.sort((a,s)=>{const u=a.currentFood/a.capacity,c=s.currentFood/s.capacity;return Math.abs(u-c)>.1?u-c:a.assignedDepositors!==s.assignedDepositors?a.assignedDepositors-s.assignedDepositors:a.distance-s.distance}),o[0].storage)}function gS(e,t,i){return ri({leaderId:e},t).filter(a=>a.activeAction===i).length}function Na(e,t){return t.search.building.all().filter(a=>{if(a.buildingType!==ni.StorageSpot||!a.isConstructed)return!1;if(a.ownerId){const s=t.entities.entities[a.ownerId];return s&&s.leaderId===e}return!1})}function l_(e,t){const i=yh(e,t);if(i.length===0)return null;const o=t.mapDimensions.width,a=t.mapDimensions.height;for(const s of i){const u=r_(s);if(o_(s,t)>=u)continue;const f=20;for(let g=0;g<f;g++){const m=s.position.x+(Math.random()-.5)*s.width,v=s.position.y+(Math.random()-.5)*s.height,T={x:(m%o+o)%o,y:(v%a+a)%a};if(!bn(T,t,xr))return{position:T,zoneId:s.id}}}return null}function u_(e,t,i){return yh(t,i).some(s=>QE(e,s,i))?!bn(e,i,xr):!1}const c_={id:vu,update:(e,t)=>{const{entity:i,updateContext:o}=t,{gameState:a}=o,s=o.deltaTime*(Ct/wt);if(i.age+=s,i.age>=i.lifespan)return{nextState:ma,data:{...e,enteredAt:a.time,previousState:vu}};const u=$v(i.position,i.spreadRadius,a.mapDimensions.width,a.mapDimensions.height);return bn(u,a,15)||Ma(a.entities,u,a.time),{nextState:Or,data:{...e,enteredAt:a.time,previousState:vu}}},onEnter:(e,t)=>({...t,enteredAt:e.updateContext.gameState.time})},d_={id:ma,update:e=>({nextState:ma,data:e}),onEnter:(e,t)=>(os(e.updateContext.gameState.entities,e.entity.id),{...t,enteredAt:e.updateContext.gameState.time})},f_=[II,EI,c_,d_],ft="humanIdle",Dr="humanMoving",ta="humanEating",Da="humanGathering",ua="humanDepositing",ca="humanRetrieving",Ia="humanProcreating",lr="humanAttacking",yu="humanPlanting",h_={id:ft,update:(e,t)=>{const{entity:i,updateContext:o}=t;return i.activeAction==="attacking"&&i.attackTargetId?{nextState:lr,data:{...e,enteredAt:o.gameState.time,previousState:ft,attackTargetId:i.attackTargetId,attackStartTime:o.gameState.time}}:(i.hunger>=kv?(i.debuffs=i.debuffs.filter(a=>a.type!=="slow"),i.debuffs.push({type:"slow",startTime:o.gameState.time,duration:.1})):i.debuffs=i.debuffs.filter(a=>a.type!=="slow"),i.activeAction==="moving"?{nextState:Dr,data:{...e,enteredAt:o.gameState.time,previousState:ft,target:i.target}}:i.activeAction==="gathering"?{nextState:Da,data:{...e,enteredAt:o.gameState.time,previousState:ft,target:i.target}}:i.activeAction==="eating"?{nextState:ta,data:{...e,enteredAt:o.gameState.time,previousState:ft}}:i.activeAction==="planting"&&i.target?{nextState:yu,data:{...e,enteredAt:o.gameState.time,previousState:ft,plantingSpot:i.target}}:i.activeAction==="depositing"?{nextState:ua,data:{...e,enteredAt:o.gameState.time,previousState:ft}}:i.activeAction==="retrieving"?{nextState:ca,data:{...e,enteredAt:o.gameState.time,previousState:ft}}:{nextState:ft,data:e})},onEnter:(e,t)=>(e.entity.acceleration=0,e.entity.velocity={x:0,y:0},{...t,enteredAt:e.updateContext.gameState.time})};function pS(e){let t=yE;return e.hunger>=kv&&(t*=AE),e.age>=IE&&(t*=EE),e.movementSlowdown&&(t*=e.movementSlowdown.modifier),t}const tf=7.5;class g_{constructor(){Ne(this,"id",Dr)}update(t,i){var f;const{entity:o,updateContext:a}=i;if(o.activeAction==="attacking"&&o.attackTargetId)return{nextState:lr,data:{...t,enteredAt:a.gameState.time,previousState:Dr,attackTargetId:o.attackTargetId,attackStartTime:a.gameState.time}};if(o.activeAction!=="moving")return{nextState:ft,data:{...t,enteredAt:a.gameState.time,previousState:Dr}};let s;if(typeof o.target=="object"?s=o.target:typeof o.target=="number"&&(s=(f=i.updateContext.gameState.entities.entities[o.target])==null?void 0:f.position),!s&&(o.direction.x!==0||o.direction.y!==0)&&(s={x:o.position.x+o.direction.x*tf*2,y:o.position.y+o.direction.y*tf*2}),!s)return{nextState:ft,data:{...t,enteredAt:a.gameState.time,previousState:Dr}};const u=Ye(o.position,s,i.updateContext.gameState.mapDimensions.width,i.updateContext.gameState.mapDimensions.height);return o.direction=lt(u),o.acceleration=pS(o),V(o.position,s,a.gameState.mapDimensions.width,a.gameState.mapDimensions.height)<tf?{nextState:ft,data:{...t,enteredAt:a.gameState.time,previousState:Dr}}:{nextState:Dr,data:t}}onExit(t){const{entity:i}=t;i.acceleration=0}}const p_=new g_,$e=1,Ea=3;function ke(e,t,i,o,a){const s={id:e.nextVisualEffectId,type:t,position:i,startTime:e.time,duration:o,entityId:a};return e.visualEffects.push(s),e.nextVisualEffectId++,s.id}var he=(e=>(e[e.Procreation=0]="Procreation",e[e.Pregnant=1]="Pregnant",e[e.TargetAcquired=2]="TargetAcquired",e[e.Attack=3]="Attack",e[e.Partnered=4]="Partnered",e[e.BushClaimed=5]="BushClaimed",e[e.BushClaimLost=6]="BushClaimLost",e[e.Eating=7]="Eating",e[e.ChildFed=8]="ChildFed",e[e.AttackDeflected=9]="AttackDeflected",e[e.AttackResisted=10]="AttackResisted",e[e.Hit=11]="Hit",e[e.SeizeBuildup=12]="SeizeBuildup",e[e.Seize=13]="Seize",e[e.CallToAttack=14]="CallToAttack",e[e.CallToFollow=15]="CallToFollow",e[e.AutopilotMoveTarget=16]="AutopilotMoveTarget",e))(he||{});const m_={id:ta,update:(e,t)=>{const{entity:i,updateContext:o}=t;return i.activeAction!=="eating"?{nextState:ft,data:{...e,enteredAt:o.gameState.time,previousState:ta}}:(i.food.length>0&&(!i.eatingCooldownTime||o.gameState.time>=i.eatingCooldownTime)&&i.hunger>sr&&(i.hunger=Math.max(0,i.hunger-sr),i.food.pop(),i.eatingCooldownTime=o.gameState.time+1,_e(o,ge.Eat,i.position),(!i.lastEatingEffectTime||o.gameState.time-i.lastEatingEffectTime>2)&&(ke(o.gameState,he.Eating,i.position,$e,i.id),i.lastEatingEffectTime=o.gameState.time)),i.hunger<=0||i.food.length<=0?{nextState:ft,data:{...e,enteredAt:o.gameState.time,previousState:ta}}:{nextState:ta,data:e})},onEnter:(e,t)=>(e.entity.acceleration=0,e.entity.velocity={x:0,y:0},{...t,enteredAt:e.updateContext.gameState.time})};class v_{constructor(){Ne(this,"id",Da)}update(t,i){return i.entity.activeAction!=="gathering"?{nextState:"humanIdle",data:{...t,enteredAt:i.updateContext.gameState.time,previousState:this.id}}:{nextState:this.id,data:t}}}const S_=new v_,y_={id:ua,update:(e,t)=>{const{entity:i}=t;return i.activeAction!=="depositing"?{nextState:ft,data:{...e,enteredAt:t.updateContext.gameState.time,previousState:ua}}:{nextState:ua,data:e}},onEnter:(e,t)=>{const{entity:i}=e;return i.activeAction="depositing",t},onExit:e=>{const{entity:t}=e;t.activeAction==="depositing"&&(t.activeAction="idle")}},A_={id:ca,update:(e,t)=>{const{entity:i}=t;return i.activeAction!=="retrieving"?{nextState:ft,data:{...e,enteredAt:t.updateContext.gameState.time,previousState:ca}}:{nextState:ca,data:e}},onEnter:(e,t)=>{const{entity:i}=e;return i.activeAction="retrieving",t},onExit:e=>{const{entity:t}=e;t.activeAction==="retrieving"&&(t.activeAction="idle")}},T_=(e,t)=>(t.procreationEndTime=e.updateContext.gameState.time+(t.duration||2),t),I_=(e,t)=>{const{entity:i,updateContext:o}=t,{gameState:a}=o;if(a.time<(e.procreationEndTime||0))return{nextState:Ia,data:e};const s=a.entities.entities[e.partnerId];if(s&&s.type==="human"&&!s.isPregnant&&i.hunger<Wr&&s.hunger<Wr&&!i.procreationCooldown&&!s.procreationCooldown){const u=i.gender==="female"?i:s.gender==="female"?s:void 0,c=i.gender==="male"?i:s.gender==="male"?s:void 0;u&&c&&(u.isPregnant=!0,u.gestationTime=_E,u.pregnancyFatherId=c.id,i.procreationCooldown=Jm,s.procreationCooldown=Jm,_e(o,ge.Procreate,u.position))}return i.activeAction="idle",s&&(s.activeAction="idle"),{nextState:ft,data:{...e,enteredAt:a.time,previousState:Ia}}},E_={id:Ia,onEnter:T_,update:I_},C_={id:lr,onEnter:(e,t)=>({...t,enteredAt:e.updateContext.gameState.time,attackStartTime:e.updateContext.gameState.time}),update:(e,t)=>{if(t.entity.activeAction!=="attacking"||!t.entity.attackTargetId)return t.entity.activeAction="idle",{nextState:ft,data:{...e}};const i=t.updateContext.gameState.entities.entities[t.entity.attackTargetId];if(!i)return t.entity.activeAction="idle",{nextState:ft,data:{...e}};const o=V(t.entity.position,i.position,t.updateContext.gameState.mapDimensions.width,t.updateContext.gameState.mapDimensions.height),a=Ye(t.entity.position,i.position,t.updateContext.gameState.mapDimensions.width,t.updateContext.gameState.mapDimensions.height);return t.entity.direction=lt(a),o>ii?t.entity.acceleration=pS(t.entity):t.entity.acceleration=0,{nextState:lr,data:e}}},w_={id:yu,update:(e,t)=>{const{entity:i,updateContext:o}=t,{gameState:a}=o;if(a.time-e.enteredAt>=TI){if(i.food.filter(c=>c.type===Hn.Berry).length>=Gr){for(let c=0;c<Gr;c++){const f=i.food.findIndex(g=>g.type===Hn.Berry);f>-1&&i.food.splice(f,1)}Ma(a.entities,e.plantingSpot,a.time)}return{nextState:ft,data:{...e,enteredAt:a.time,previousState:yu}}}return{nextState:yu,data:e}},onEnter:(e,t)=>(e.entity.acceleration=0,e.entity.velocity={x:0,y:0},{...t,enteredAt:e.updateContext.gameState.time})},__=[h_,p_,m_,S_,y_,A_,E_,C_,w_],kn="preyIdle",Qi="preyMoving",na="preyGrazing",ia="preyProcreating",R_={id:kn,update:(e,t)=>{const{entity:i,updateContext:o}=t;return i.activeAction==="moving"?{nextState:Qi,data:{...e,enteredAt:o.gameState.time,previousState:kn,target:i.target}}:i.activeAction==="grazing"?{nextState:na,data:{...e,enteredAt:o.gameState.time,previousState:kn}}:i.activeAction==="procreating"?{nextState:ia,data:{...e,enteredAt:o.gameState.time,previousState:kn}}:{nextState:kn,data:e}},onEnter:(e,t)=>(e.entity.acceleration=0,e.entity.velocity={x:0,y:0},{...t,enteredAt:e.updateContext.gameState.time})},mS=12,P_=120,I0=50,N_=12,vS=30,D_=2,Vt=50,O_=100,da=2,nf=3,M_=.9,k_=1,F_=50,L_=.5,SS=20,U_=140,E0=40,B_=12,yS=40,H_=3,rr=60,Fn=40,No=50,C0=320,AS=25,b_=60,TS=2,G_=90,x_=.7,$_=1,fa=3,rf=15,Ah=80,IS=10,Wu=80,is=40,ES=2,Pu=30,Mo=20,Fr=40,ko=24,Lr=48,Fo=12,Ur=40,Lo=20,Br=60,Uo=.75,er=2.5,Bo=.25,tr=2;function W_(e){let t=N_;return e.isAdult||(t*=.7),e.hunger>=F_&&(t*=L_),e.movementSlowdown&&(t*=e.movementSlowdown.modifier),t}function z_(e,t){const i=e>>16&255,o=e>>8&255,a=e&255,s=t>>16&255,u=t>>8&255,c=t&255;let f=Math.floor((i+s)/2),g=Math.floor((o+u)/2),m=Math.floor((a+c)/2);return Math.random()<.05&&(f=Math.max(0,Math.min(255,f+(Math.random()-.5)*60))),Math.random()<.05&&(g=Math.max(0,Math.min(255,g+(Math.random()-.5)*60))),Math.random()<.05&&(m=Math.max(0,Math.min(255,m+(Math.random()-.5)*60))),f<<16|g<<8|m}function Ca(){const e=Math.floor(Math.random()*100)+100,t=Math.floor(Math.random()*80)+60,i=Math.floor(Math.random()*60)+20;return e<<16|t<<8|i}const of=10;class Y_{constructor(){Ne(this,"id",Qi)}update(t,i){var f;const{entity:o,updateContext:a}=i;if(o.activeAction!=="moving")return{nextState:kn,data:{...t,enteredAt:a.gameState.time,previousState:Qi}};let s;if(typeof o.target=="object"?s=o.target:typeof o.target=="number"&&(s=(f=i.updateContext.gameState.entities.entities[o.target])==null?void 0:f.position),!s&&(o.direction.x!==0||o.direction.y!==0)&&(s={x:o.position.x+o.direction.x*of*2,y:o.position.y+o.direction.y*of*2}),!s)return{nextState:kn,data:{...t,enteredAt:a.gameState.time,previousState:Qi}};const u=Ye(o.position,s,i.updateContext.gameState.mapDimensions.width,i.updateContext.gameState.mapDimensions.height);return o.direction=lt(u),o.acceleration=W_(o),V(o.position,s,a.gameState.mapDimensions.width,a.gameState.mapDimensions.height)<of?{nextState:kn,data:{...t,enteredAt:a.gameState.time,previousState:Qi}}:{nextState:Qi,data:t}}onExit(t){const{entity:i}=t;i.acceleration=0}onEnter(t,i){return{...i,enteredAt:t.updateContext.gameState.time}}}const j_=new Y_,V_={id:na,update:(e,t)=>{const{entity:i,updateContext:o}=t;return i.activeAction==="moving"?{nextState:Qi,data:{...e,enteredAt:o.gameState.time,previousState:na,target:i.target}}:i.activeAction!=="grazing"?{nextState:kn,data:{...e,enteredAt:o.gameState.time,previousState:na}}:{nextState:na,data:e}},onEnter:(e,t)=>(e.entity.acceleration=0,e.entity.velocity={x:0,y:0},{...t,enteredAt:e.updateContext.gameState.time})},X_={id:ia,update:(e,t)=>{const{entity:i,updateContext:o}=t;return i.activeAction==="moving"?{nextState:Qi,data:{...e,enteredAt:o.gameState.time,previousState:ia,target:i.target}}:i.activeAction!=="procreating"?{nextState:kn,data:{...e,enteredAt:o.gameState.time,previousState:ia}}:{nextState:ia,data:e}},onEnter:(e,t)=>(e.entity.acceleration=0,e.entity.velocity={x:0,y:0},{...t,enteredAt:e.updateContext.gameState.time})},K_=[R_,j_,V_,X_],jt="predatorIdle",Ki="predatorMoving",mi="predatorAttacking",Do="predatorProcreating",Hr="predatorEating",Z_={id:jt,update:(e,t)=>{const{entity:i,updateContext:o}=t;return i.activeAction==="eating"?{nextState:Hr,data:{...e,enteredAt:o.gameState.time,previousState:jt,preyId:i.attackTargetId,eatingStartTime:o.gameState.time}}:i.activeAction==="attacking"&&i.attackTargetId?{nextState:mi,data:{...e,enteredAt:o.gameState.time,previousState:jt,attackTargetId:i.attackTargetId,attackStartTime:o.gameState.time}}:i.activeAction==="moving"?{nextState:Ki,data:{...e,enteredAt:o.gameState.time,previousState:jt,target:i.target}}:i.activeAction==="procreating"?{nextState:Do,data:{...e,enteredAt:o.gameState.time,previousState:jt}}:{nextState:jt,data:e}},onEnter:(e,t)=>(e.entity.acceleration=0,e.entity.velocity={x:0,y:0},{...t,enteredAt:e.updateContext.gameState.time})};function CS(e){let t=B_;return e.hunger>=G_&&(t*=x_),e.isAdult||(t*=.7),e.movementSlowdown&&(t*=e.movementSlowdown.modifier),t}function q_(e,t){const i=e>>16&255,o=e>>8&255,a=e&255,s=t>>16&255,u=t>>8&255,c=t&255;let f=Math.floor((i+s)/2),g=Math.floor((o+u)/2),m=Math.floor((a+c)/2);return Math.random()<.05&&(f=Math.max(0,Math.min(255,f+(Math.random()-.5)*60))),Math.random()<.05&&(g=Math.max(0,Math.min(255,g+(Math.random()-.5)*60))),Math.random()<.05&&(m=Math.max(0,Math.min(255,m+(Math.random()-.5)*60))),f<<16|g<<8|m}function wa(){const e=Math.floor(Math.random()*60)+60,t=Math.floor(Math.random()*50)+40,i=Math.floor(Math.random()*40)+20;return e<<16|t<<8|i}const sf=12;class Q_{constructor(){Ne(this,"id",Ki)}update(t,i){var f;const{entity:o,updateContext:a}=i;if(o.activeAction==="eating")return{nextState:Hr,data:{...t,enteredAt:a.gameState.time,previousState:Ki,preyId:o.attackTargetId,eatingStartTime:a.gameState.time}};if(o.activeAction==="attacking"&&o.attackTargetId)return{nextState:mi,data:{...t,enteredAt:a.gameState.time,previousState:Ki,attackTargetId:o.attackTargetId,attackStartTime:a.gameState.time}};if(o.activeAction!=="moving")return{nextState:jt,data:{...t,enteredAt:a.gameState.time,previousState:Ki}};let s;if(typeof o.target=="object"?s=o.target:typeof o.target=="number"&&(s=(f=i.updateContext.gameState.entities.entities[o.target])==null?void 0:f.position),!s&&(o.direction.x!==0||o.direction.y!==0)&&(s={x:o.position.x+o.direction.x*sf*2,y:o.position.y+o.direction.y*sf*2}),!s)return{nextState:jt,data:{...t,enteredAt:a.gameState.time,previousState:Ki}};const u=Ye(o.position,s,i.updateContext.gameState.mapDimensions.width,i.updateContext.gameState.mapDimensions.height);return o.direction=lt(u),o.acceleration=CS(o),V(o.position,s,a.gameState.mapDimensions.width,a.gameState.mapDimensions.height)<sf?{nextState:jt,data:{...t,enteredAt:a.gameState.time,previousState:Ki}}:{nextState:Ki,data:t}}onExit(t){const{entity:i}=t;i.acceleration=0}onEnter(t,i){return{...i,enteredAt:t.updateContext.gameState.time}}}const J_=new Q_,e1={id:mi,update:(e,t)=>{const{entity:i,updateContext:o}=t;if(i.activeAction==="eating")return{nextState:Hr,data:{...e,enteredAt:o.gameState.time,previousState:mi,preyId:i.attackTargetId,eatingStartTime:o.gameState.time}};if(i.activeAction!=="attacking"||!i.attackTargetId)return i.activeAction="idle",{nextState:jt,data:{...e,enteredAt:o.gameState.time,previousState:mi}};const a=o.gameState.entities.entities[i.attackTargetId];if(!a)return i.activeAction="idle",{nextState:jt,data:{...e,enteredAt:o.gameState.time,previousState:mi}};if(a.type==="prey"&&a.hitpoints<=0||a.type==="predator"&&a.hitpoints<=0||a.type==="human"&&a.hitpoints<=0)return i.activeAction="idle",{nextState:jt,data:{...e,enteredAt:o.gameState.time,previousState:mi}};const u=V(i.position,a.position,o.gameState.mapDimensions.width,o.gameState.mapDimensions.height),c=Ye(i.position,a.position,o.gameState.mapDimensions.width,o.gameState.mapDimensions.height);return i.direction=lt(c),u>Fn?i.acceleration=CS(i):i.acceleration=0,{nextState:mi,data:e}},onEnter:(e,t)=>({...t,enteredAt:e.updateContext.gameState.time})},t1={id:Do,update:(e,t)=>{const{entity:i,updateContext:o}=t;return i.activeAction==="eating"?{nextState:Hr,data:{...e,enteredAt:o.gameState.time,previousState:Do,preyId:i.attackTargetId,eatingStartTime:o.gameState.time}}:i.activeAction==="attacking"&&i.attackTargetId?{nextState:mi,data:{...e,enteredAt:o.gameState.time,previousState:Do,attackTargetId:i.attackTargetId,attackStartTime:o.gameState.time}}:i.activeAction!=="procreating"?{nextState:jt,data:{...e,enteredAt:o.gameState.time,previousState:Do}}:{nextState:Do,data:e}},onEnter:(e,t)=>(e.entity.acceleration=0,e.entity.velocity={x:0,y:0},{...t,enteredAt:e.updateContext.gameState.time})},n1={id:Hr,update:(e,t)=>{const{entity:i,updateContext:o}=t;return i.activeAction!=="eating"?{nextState:jt,data:{...e,enteredAt:o.gameState.time,previousState:Hr}}:{nextState:Hr,data:e}},onEnter:(e,t)=>(e.entity.acceleration=0,e.entity.velocity={x:0,y:0},{...t,enteredAt:e.updateContext.gameState.time})},i1=[Z_,J_,e1,t1,n1],w0=[...f_,...__,...K_,...i1];function r1(e,t,i){const o=dI(e,w0);if(!o)return hI(e),[e,t];const{nextState:a,data:s}=o.update(t,i);return fI(e,a)?[a,cI(o,a,s,i,w0)]:[a,s]}function o1(e,t,i){const{gameState:o}=t,a=i*(Ct/wt);if(e.isAdult=e.age>=th,e.isCallingToAttack&&e.callToAttackEndTime&&o.time>e.callToAttackEndTime&&(e.isCallingToAttack=!1,e.callToAttackEndTime=void 0),e.isCallingToFollow&&e.callToFollowEndTime&&o.time>e.callToFollowEndTime&&(e.isCallingToFollow=!1,e.callToFollowEndTime=void 0),e.movementSlowdown&&o.time>e.movementSlowdown.endTime&&(e.movementSlowdown=void 0),e.hitpoints<e.maxHitpoints){const u=1-e.hunger/100*BE,c=UE*u*a;e.hitpoints=Math.min(e.maxHitpoints,e.hitpoints+c)}if(e.hunger+=i*(Ys/(Ct/wt)),e.age+=i/Hu,e.isPlayer){const u=dn(o,e).filter(c=>c.hunger>=Aw);if(u.length>0){const c=u.map(f=>f.id);Uf(o,{identifier:"children_starving",type:Aa.ChildrenStarving,message:"Your children are starving!",duration:Sw,targetEntityIds:c,highlightedEntityIds:c})}}if(e.gender==="female"&&e.isPregnant&&e.gestationTime&&(e.gestationTime-=a,e.hunger+=i*((Ys*RE-Ys)/(Ct/wt)),(!e.lastPregnantEffectTime||o.time-e.lastPregnantEffectTime>Ea*3)&&(ke(o,he.Pregnant,e.position,Ea,e.id),e.lastPregnantEffectTime=o.time),e.gestationTime<=0&&(DR(e,e.pregnancyFatherId,t),e.isPregnant=!1,e.gestationTime=0,e.pregnancyFatherId=void 0)),e.procreationCooldown&&(e.procreationCooldown-=a,e.procreationCooldown<0&&(e.procreationCooldown=0)),e.attackCooldown&&(e.attackCooldown-=a,e.attackCooldown<0&&(e.attackCooldown=0)),e.feedParentCooldownTime&&(e.feedParentCooldownTime-=a,e.feedParentCooldownTime<0&&(e.feedParentCooldownTime=0)),e.feedChildCooldownTime&&(e.feedChildCooldownTime-=a,e.feedChildCooldownTime<0&&(e.feedChildCooldownTime=0)),e.leaderMetaStrategyCooldown&&(e.leaderMetaStrategyCooldown-=a,e.leaderMetaStrategyCooldown<0&&(e.leaderMetaStrategyCooldown=0)),e.isAdult?e.radius===ts&&(e.radius=_t):e.hunger+=i*((Ys*PE-Ys)/(Ct/wt)),e.isAdult&&e.food.length>0&&(!e.feedParentCooldownTime||e.feedParentCooldownTime<=0)){const u=[];if(e.motherId){const c=o.entities.entities[e.motherId];c&&u.push(c)}if(e.fatherId){const c=o.entities.entities[e.fatherId];c&&u.push(c)}for(const c of u)if(c.age>=rh&&c.hunger>=OE&&V(e.position,c.position,o.mapDimensions.width,o.mapDimensions.height)<=ME){e.food.pop(),c.hunger=Math.max(0,c.hunger-sr),e.feedParentCooldownTime=kE;break}}let s;if(e.hitpoints<=0?s="killed":e.hunger>=$r?e.food.length>0&&e.isAdult?(e.food.pop(),e.hunger=Math.max(0,e.hunger-sr)):s="hunger":e.age>=e.maxAge&&(s="oldAge"),s){if(e.leaderId===e.id){const u=zr(dn(o,e));u?(u.leaderId=u.id,u.tribeBadge=e.tribeBadge,u.tribeRole=we.Leader,u.tribeControl=e.tribeControl??{roleWeights:{[we.Leader]:0,[we.Gatherer]:2,[we.Planter]:2,[we.Hunter]:2,[we.Mover]:2,[we.Warrior]:2},diplomacy:{}},Object.values(o.entities.entities).forEach(c=>{if(c.type==="human"&&c.leaderId===e.id){const f=c;f.leaderId=u.id}if(c.type==="building"&&c.ownerId===e.id){const f=c;f.ownerId=u.id}})):Object.values(o.entities.entities).forEach(c=>{if(c.type==="human"&&c.leaderId===e.id){const f=c;f.leaderId=void 0,f.tribeBadge=void 0}if(c.type==="building"&&c.ownerId===e.id){const f=c;f.ownerId=void 0}})}if(e.isPlayer){const u=zr(dn(o,e));u?(u.isPlayer=!0,o.generationCount++):(o.gameOver=!0,o.causeOfGameOver=s,Uf(o,{identifier:"no_heir",type:Aa.NoHeir,message:"Your lineage has ended. You have no heir.",duration:0}))}RR(o.entities,e.position,e.gender,e.age,e.radius,e.id,o.time,e.food,e.hunger),os(o.entities,e.id);return}e.animationProgress===void 0&&(e.animationProgress=0),e.animationSpeed===void 0&&(e.animationSpeed=1),e.animationProgress+=i*e.animationSpeed,e.animationProgress>=1&&(e.animationProgress=0)}function s1(e,t){const i=t.gameState.time-e.timeOfDeath;e.decayProgress=Math.min(1,i/FE);const o=Math.floor(Bv*(1-e.decayProgress));e.food.length>o&&e.food.splice(o),e.decayProgress>=1&&e.food.length<=0&&os(t.gameState.entities,e.id)}function a1(e,t,i){const o=i*(Ct/wt);e.age+=i/Hu,e.isAdult=e.age>=da;let a=t.gameState.ecosystem.preyHungerIncreasePerHour*o;if(e.isPregnant&&(a*=1.2),e.hunger+=a,e.isPregnant&&e.gestationTime!==void 0&&(e.gestationTime-=o,e.gestationTime<=0)){const u={x:e.position.x+(Math.random()-.5)*40,y:e.position.y+(Math.random()-.5)*40};u.x=Math.max(20,Math.min(t.gameState.mapDimensions.width-20,u.x)),u.y=Math.max(20,Math.min(t.gameState.mapDimensions.height-20,u.y));const c=Math.random()<.5?"male":"female",f=e,g=e.fatherId?t.gameState.entities.entities[e.fatherId]:void 0;let m;if(g)m=z_(f.geneCode,g.geneCode);else{m=f.geneCode;const v=Math.floor((Math.random()-.5)*4096);m=Math.max(0,Math.min(16777215,m+v))}qo(t.gameState.entities,u,c,0,vS*.5,m,e.id,e.fatherId),ke(t.gameState,he.Procreation,e.position,Ea,e.id),_e(t,ge.Birth,e.position),e.isPregnant=!1,e.gestationTime=0,e.procreationCooldown=t.gameState.ecosystem.preyProcreationCooldown,e.fatherId=void 0}e.procreationCooldown&&e.procreationCooldown>0&&(e.procreationCooldown-=o,e.procreationCooldown<0&&(e.procreationCooldown=0)),e.eatingCooldownTime&&e.eatingCooldownTime>t.gameState.time||(e.eatingCooldownTime=void 0),e.fleeCooldown&&e.fleeCooldown>0&&(e.fleeCooldown-=o,e.fleeCooldown<0&&(e.fleeCooldown=0)),e.feedChildCooldownTime&&e.feedChildCooldownTime>0&&(e.feedChildCooldownTime-=o,e.feedChildCooldownTime<0&&(e.feedChildCooldownTime=0));let s=!1;e.hunger>=P_&&(s=!0),e.hitpoints<=0&&(s=!0),e.age>=mS&&(s=!0),s&&(PR(t.gameState.entities,e.position,e.gender,e.age,e.radius,e.id,t.gameState.time,e.geneCode),os(t.gameState.entities,e.id))}function l1(e,t,i){const o=i*(Ct/wt);e.age+=i/Hu,e.isAdult=e.age>=fa;let a=t.gameState.ecosystem.predatorHungerIncreasePerHour*o;if(e.isPregnant&&(a*=1.3),e.hunger+=a,e.isPregnant&&e.gestationTime!==void 0&&(e.gestationTime-=o,e.gestationTime<=0)){const u={x:e.position.x+(Math.random()-.5)*50,y:e.position.y+(Math.random()-.5)*50};u.x=Math.max(25,Math.min(t.gameState.mapDimensions.width-25,u.x)),u.y=Math.max(25,Math.min(t.gameState.mapDimensions.height-25,u.y));const c=Math.random()<.5?"male":"female",f=e,g=e.pregnancyFatherId?t.gameState.entities.entities[e.pregnancyFatherId]:void 0;let m;if(g)m=q_(f.geneCode,g.geneCode);else{m=f.geneCode;const v=Math.floor((Math.random()-.5)*4096);m=Math.max(0,Math.min(16777215,m+v))}Qo(t.gameState.entities,u,c,0,yS*.6,m,e.id,e.pregnancyFatherId),ke(t.gameState,he.Procreation,e.position,Ea,e.id),_e(t,ge.Birth,e.position),e.isPregnant=!1,e.gestationTime=0,e.procreationCooldown=t.gameState.ecosystem.predatorProcreationCooldown,e.pregnancyFatherId=void 0}e.procreationCooldown&&e.procreationCooldown>0&&(e.procreationCooldown-=o,e.procreationCooldown<0&&(e.procreationCooldown=0)),e.attackCooldown&&e.attackCooldown>0&&(e.attackCooldown-=o,e.attackCooldown<0&&(e.attackCooldown=0)),e.huntCooldown&&e.huntCooldown>0&&(e.huntCooldown-=o,e.huntCooldown<0&&(e.huntCooldown=0)),e.feedChildCooldownTime&&e.feedChildCooldownTime>0&&(e.feedChildCooldownTime-=o,e.feedChildCooldownTime<0&&(e.feedChildCooldownTime=0));let s=!1;e.hunger>=U_&&(s=!0),e.hitpoints<=0&&(s=!0),e.age>=SS&&(s=!0),s&&(NR(t.gameState.entities,e.position,e.gender,e.age,e.radius,e.id,t.gameState.time,e.geneCode),os(t.gameState.entities,e.id))}var Oa=(e=>(e[e.BehaviorTreeBased=0]="BehaviorTreeBased",e))(Oa||{}),E=(e=>(e[e.SUCCESS=0]="SUCCESS",e[e.FAILURE=1]="FAILURE",e[e.RUNNING=2]="RUNNING",e[e.NOT_EVALUATED=3]="NOT_EVALUATED",e))(E||{});class fn{constructor(){Ne(this,"name");Ne(this,"depth");Ne(this,"children");Ne(this,"child")}getLastStatus(t){return C.get(t.aiBlackboard,`${this.name}_lastStatus`)??3}setLastStatus(t,i){C.set(t.aiBlackboard,`${this.name}_lastStatus`,i)}getRunningChildIndex(t){return C.get(t.aiBlackboard,`${this.name}_runningChildIndex`)}setRunningChildIndex(t,i){C.set(t.aiBlackboard,`${this.name}_runningChildIndex`,i)}}const C={create(){return{data:{},nodeExecutionData:{}}},set({data:e},t,i){e[t]=i},get(e,t){return e==null?void 0:e.data[t]},delete({data:e},t){delete e[t]},has({data:e},t){return t in e},recordNodeExecution({nodeExecutionData:e},t,i,o,a,s){const u=e[t]||{lastExecuted:0,status:E.FAILURE,depth:0,debugInfo:"",executionHistory:[]},c=u.executionHistory[u.executionHistory.length-1];c&&o-(c==null?void 0:c.time)>va&&u.executionHistory.push({time:c.time+va,status:E.NOT_EVALUATED}),u.executionHistory.push({time:o,status:i});const f=tS/wt*Ct,g=o-f;u.executionHistory=u.executionHistory.filter(v=>v.time>=g);const m={...u,lastExecuted:o,status:i,depth:a,debugInfo:s};e[t]=m},getNodeExecutionData({nodeExecutionData:e}){return e},cleanupOldEntries({nodeExecutionData:e},t){const i=UI,o=[];for(const[a,s]of Object.entries(e))t-s.lastExecuted>i&&o.push(a);for(const a of o)delete e[a]}};function Th(e,t,i){if(e.aiBlackboard){const o=C.get(e.aiBlackboard,"lastAiUpdateTime")??0;t.gameState.time-o>=va&&(i.execute(e,t,e.aiBlackboard),C.set(e.aiBlackboard,"lastAiUpdateTime",t.gameState.time))}else console.warn(`Behavior Tree AI ticked for human ${e.id}, but the tree or blackboard was missing.`),e.activeAction="idle"}const _0="Human Behavior",u1=1;class c1{constructor(){Ne(this,"nodeData",new Map);Ne(this,"pathStack",[]);Ne(this,"startTimeStack",[])}nodeStart(t){this.pathStack.push(t),this.startTimeStack.push(performance.now())}nodeEnd(){if(this.startTimeStack.length===0||this.pathStack.length===0){console.error("BTProfiler: nodeEnd() called without a matching nodeStart().");return}const t=performance.now(),i=this.startTimeStack.pop(),o=t-i,a=this.pathStack.join(" > "),s=this.nodeData.get(a)??{path:a,totalTime:0,callCount:0,minTime:1/0,maxTime:-1/0};s.totalTime+=o,s.callCount++,s.minTime=Math.min(s.minTime,o),s.maxTime=Math.max(s.maxTime,o),this.nodeData.set(a,s),this.pathStack.pop()}report(t={}){const{showAll:i=!1}=t,o=Array.from(this.nodeData.values());if(o.length===0){console.log("--- Behavior Tree Profiler: No data collected. ---");return}let a=o,s="--- Behavior Tree Full Report ---";if(!i){const c=this.nodeData.get(_0);if(c){const f=c.totalTime*u1/100;a=o.filter(g=>g.totalTime>f&&g.path!==_0),s="--- Behavior Tree Problem Report ---"}else console.log('BTProfiler: Root node "Human Behavior" not found. Showing full report.'),s="--- Behavior Tree Full Report (Root Not Found) ---"}const u=a.sort((c,f)=>f.totalTime-c.totalTime);console.log(s),u.length>0?console.table(u.map(c=>({Path:c.path,"Total Time (ms)":c.totalTime.toFixed(3),Calls:c.callCount,"Avg Time (ms)":(c.totalTime/c.callCount).toFixed(3),"Min Time (ms)":c.minTime.toFixed(3),"Max Time (ms)":c.maxTime.toFixed(3)}))):console.log("No significant performance problems detected."),console.log("------------------------------------")}reset(){this.nodeData.clear(),this.pathStack=[],this.startTimeStack=[]}getNodeData(t){return this.nodeData.get(t)}}const Ze=new c1;function bt(e){return Array.isArray(e)?e:[e,""]}class pe extends fn{constructor(i,o,a=0){super();Ne(this,"name");Ne(this,"depth");this.children=i,this.name=o,this.depth=a,this.children.forEach(s=>{s.depth=(this.depth??0)+1})}execute(i,o,a){this.name&&Ze.nodeStart(this.name);try{for(const s of this.children){const[u,c]=bt(s.execute(i,o,a));if(u!==E.SUCCESS)return this.setLastStatus(i,u),this.name&&C.recordNodeExecution(a,this.name,u,o.gameState.time,this.depth,c),u}return this.setLastStatus(i,E.SUCCESS),this.name&&C.recordNodeExecution(a,this.name,E.SUCCESS,o.gameState.time,this.depth,""),E.SUCCESS}finally{this.name&&Ze.nodeEnd()}}}class Xt extends fn{constructor(i,o,a=0){super();Ne(this,"name");Ne(this,"depth");this.children=i,this.name=o,this.depth=a,this.children.forEach(s=>{s.depth=(this.depth??0)+1})}execute(i,o,a){this.name&&Ze.nodeStart(this.name);try{const s=this.getRunningChildIndex(i)??0;for(let u=s;u<this.children.length;u++){const c=this.children[u],[f,g]=bt(c.execute(i,o,a));if(f!==E.FAILURE){if(f===E.SUCCESS)return this.setRunningChildIndex(i,void 0),this.setLastStatus(i,E.SUCCESS),this.name&&C.recordNodeExecution(a,this.name,E.SUCCESS,o.gameState.time,this.depth,g),E.SUCCESS;if(f===E.RUNNING)return this.setRunningChildIndex(i,u),this.setLastStatus(i,E.RUNNING),this.name&&C.recordNodeExecution(a,this.name,E.RUNNING,o.gameState.time,this.depth,g),E.RUNNING}}return this.setRunningChildIndex(i,void 0),this.setLastStatus(i,E.FAILURE),this.name&&C.recordNodeExecution(a,this.name,E.FAILURE,o.gameState.time,this.depth,""),E.FAILURE}finally{this.name&&Ze.nodeEnd()}}}class ie extends fn{constructor(i,o,a=0){super();Ne(this,"name");Ne(this,"depth");this.action=i,this.name=o,this.depth=a}execute(i,o,a){this.name&&Ze.nodeStart(this.name);try{const[s,u]=bt(this.action(i,o,a));return this.setLastStatus(i,s),this.name&&C.recordNodeExecution(a,this.name,s,o.gameState.time,this.depth,u),s}finally{this.name&&Ze.nodeEnd()}}}class J extends fn{constructor(i,o,a=0){super();Ne(this,"name");Ne(this,"depth");this.condition=i,this.name=o,this.depth=a}execute(i,o,a){this.name&&Ze.nodeStart(this.name);try{const[s,u]=bt(this.condition(i,o,a)),c=s?E.SUCCESS:E.FAILURE;return this.setLastStatus(i,c),this.name&&C.recordNodeExecution(a,this.name,c,o.gameState.time,this.depth,u),c}finally{this.name&&Ze.nodeEnd()}}}class d1 extends fn{constructor(i,o,a=0){super();Ne(this,"name");Ne(this,"depth");this.child=i,this.name=o,this.depth=a,this.child.depth=(this.depth??0)+1}execute(i,o,a){this.name&&Ze.nodeStart(this.name);try{const[s,u]=bt(this.child.execute(i,o,a));let c;switch(s){case E.SUCCESS:c=E.FAILURE;break;case E.FAILURE:c=E.SUCCESS;break;case E.RUNNING:default:c=s;break}return this.setLastStatus(i,c),this.name&&C.recordNodeExecution(a,this.name,c,o.gameState.time,this.depth,u),c}finally{this.name&&Ze.nodeEnd()}}}class f1 extends fn{constructor(i,o,a=0){super();Ne(this,"name");Ne(this,"depth");this.child=i,this.name=o,this.depth=a,this.child.depth=(this.depth??0)+1}execute(i,o,a){this.name&&Ze.nodeStart(this.name);try{const[,s]=bt(this.child.execute(i,o,a)),u=E.SUCCESS;return this.setLastStatus(i,u),this.name&&C.recordNodeExecution(a,this.name,u,o.gameState.time,this.depth,s),u}finally{this.name&&Ze.nodeEnd()}}}class Nu extends fn{constructor(i,o,a,s=0){super();Ne(this,"name");Ne(this,"depth");Ne(this,"startTimeKey");this.child=i,this.timeoutDurationHours=o,this.name=a,this.depth=s,this.child.depth=(this.depth??0)+1,this.startTimeKey=`timeout_${this.name}_startTime`}execute(i,o,a){Ze.nodeStart(this.name);try{const s=o.gameState.time;let u=C.get(a,this.startTimeKey);const[c,f]=bt(this.child.execute(i,o,a));if(c===E.RUNNING){u===void 0&&(C.set(a,this.startTimeKey,s),u=s);const g=s-u;if(g>this.timeoutDurationHours){C.delete(a,this.startTimeKey),this.setLastStatus(i,E.FAILURE);const v=`Timed out after ${g.toFixed(2)}h.`;return C.recordNodeExecution(a,this.name,this.getLastStatus(i),s,this.depth,v),this.getLastStatus(i)}this.setLastStatus(i,E.RUNNING);const m=`Running for ${g.toFixed(2)}h. ${f}`;return C.recordNodeExecution(a,this.name,this.getLastStatus(i),s,this.depth,m),this.getLastStatus(i)}return u!==void 0&&C.delete(a,this.startTimeKey),this.setLastStatus(i,c),C.recordNodeExecution(a,this.name,this.getLastStatus(i),s,this.depth,f),this.getLastStatus(i)}finally{Ze.nodeEnd()}}}class Ii extends fn{constructor(i,o,a,s=0,u){super();Ne(this,"name");Ne(this,"depth");Ne(this,"statusKey");Ne(this,"timestampKey");this.child=i,this.cacheDurationHours=o,this.validityCheck=u,this.name=a,this.depth=s,this.child.depth=(this.depth??0)+1,this.statusKey=`caching_${this.name}_status`,this.timestampKey=`caching_${this.name}_timestamp`}execute(i,o,a){Ze.nodeStart(this.name);try{const s=o.gameState.time,u=C.get(a,this.statusKey),c=C.get(a,this.timestampKey);if(u!==void 0&&c!==void 0){const v=s-c>this.cacheDurationHours,T=this.validityCheck?this.validityCheck(i,o,a):!0;if(!v&&T){const A=(c+this.cacheDurationHours-s).toFixed(2),I=`Cache hit. Status: ${E[u]}. ${A}h left.`;return this.setLastStatus(i,u),C.recordNodeExecution(a,this.name,this.getLastStatus(i),s,this.depth,I),this.getLastStatus(i)}}const[f,g]=bt(this.child.execute(i,o,a));(f===E.SUCCESS||f===E.FAILURE)&&(C.set(a,this.statusKey,f),C.set(a,this.timestampKey,s)),this.setLastStatus(i,f);const m=`Cache miss. Child returned ${E[f]}. ${g}`;return C.recordNodeExecution(a,this.name,this.getLastStatus(i),s,this.depth,m),this.getLastStatus(i)}finally{Ze.nodeEnd()}}}class cr extends fn{constructor(i,o,a,s=0){super();Ne(this,"name");Ne(this,"depth");Ne(this,"cooldownKey");this.cooldownDurationHours=i,this.child=o,this.name=a,this.depth=s,this.child.depth=(this.depth??0)+1,this.cooldownKey=`cooldown_${this.name}`}execute(i,o,a){Ze.nodeStart(this.name);try{const s=o.gameState.time,u=C.get(a,this.cooldownKey);if(this.child.getLastStatus(i)===E.RUNNING){const[g,m]=bt(this.child.execute(i,o,a));if(this.setLastStatus(i,g),this.name){const v=`Continuing running child. ${m}`;C.recordNodeExecution(a,this.name,this.getLastStatus(i),s,this.depth,v)}return this.getLastStatus(i)}if(u!==void 0&&s<u){const m=`Cooldown active, ${(u-s).toFixed(2)}h left`;return this.setLastStatus(i,E.FAILURE),this.name&&C.recordNodeExecution(a,this.name,this.getLastStatus(i),s,this.depth,m),this.getLastStatus(i)}const[c,f]=bt(this.child.execute(i,o,a));return c===E.SUCCESS&&C.set(a,this.cooldownKey,s+this.cooldownDurationHours),this.setLastStatus(i,c),this.name&&C.recordNodeExecution(a,this.name,this.getLastStatus(i),s,this.depth,f),this.getLastStatus(i)}finally{Ze.nodeEnd()}}}class Tn extends fn{constructor(i,o,a,s=0){super();Ne(this,"name");Ne(this,"depth");this.child=i,this.behaviorKey=o,this.name=a,this.depth=s;const u=(c,f)=>{c.depth=f,c.children?c.children.forEach(g=>u(g,f+1)):c.child&&u(c.child,f+1)};u(this.child,(this.depth??0)+1)}execute(i,o,a){this.name&&Ze.nodeStart(this.name);try{if(i.isPlayer&&!o.gameState.autopilotControls.behaviors[this.behaviorKey]){const f=`Player autopilot for '${this.behaviorKey}' is disabled.`;return this.setLastStatus(i,E.FAILURE),this.name&&C.recordNodeExecution(a,this.name,this.getLastStatus(i),o.gameState.time,this.depth,f),this.getLastStatus(i)}const[u,c]=bt(this.child.execute(i,o,a));return this.setLastStatus(i,u),this.name&&C.recordNodeExecution(a,this.name,this.getLastStatus(i),o.gameState.time,this.depth,c),this.getLastStatus(i)}finally{this.name&&Ze.nodeEnd()}}}class h1 extends fn{constructor(i,o,a=0){super();Ne(this,"name");Ne(this,"depth");this.child=i,this.name=o,this.depth=a;const s=(u,c)=>{u.depth=c,u.children?u.children.forEach(f=>s(f,c+1)):u.child&&s(u.child,c+1)};s(this.child,(this.depth??0)+1)}execute(i,o,a){this.name&&Ze.nodeStart(this.name);try{if(i.isPlayer&&o.gameState.autopilotControls.isManuallyMoving)return this.setLastStatus(i,E.FAILURE),this.name&&C.recordNodeExecution(a,this.name,this.getLastStatus(i),o.gameState.time,this.depth,"Manual movement active, AI blocked."),this.getLastStatus(i);const[s,u]=bt(this.child.execute(i,o,a));return this.setLastStatus(i,s),this.name&&C.recordNodeExecution(a,this.name,this.getLastStatus(i),o.gameState.time,this.depth,u),this.getLastStatus(i)}finally{this.name&&Ze.nodeEnd()}}}class Ao extends fn{constructor(i,o,a=0){super();Ne(this,"name");Ne(this,"depth");this.child=i,this.name=o,this.depth=a;const s=(u,c)=>{u.depth=c,u.children?u.children.forEach(f=>s(f,c+1)):u.child&&s(u.child,c+1)};s(this.child,(this.depth??0)+1)}execute(i,o,a){this.name&&Ze.nodeStart(this.name);try{if(i.isPlayer)return this.setLastStatus(i,E.FAILURE),this.name&&C.recordNodeExecution(a,this.name,this.getLastStatus(i),o.gameState.time,this.depth,"Player controlled, AI blocked."),this.getLastStatus(i);const[s,u]=bt(this.child.execute(i,o,a));return this.setLastStatus(i,s),this.name&&C.recordNodeExecution(a,this.name,this.getLastStatus(i),o.gameState.time,this.depth,u),this.getLastStatus(i)}finally{this.name&&Ze.nodeEnd()}}}const Ko=24,Ih=2,Eh=3;function Yr(e,t){if(e.leaderId){const i=t.entities.entities[e.leaderId];if(i&&i.aiBlackboard)return i}if(e.isAdult&&e.aiBlackboard)return e;if(!e.isAdult&&e.fatherId){const i=t.entities.entities[e.fatherId];if(i&&i.aiBlackboard)return i}return null}function g1(e,t){if(!e.aiBlackboard)return;const i=e.aiBlackboard.data,o=[];for(const a in i)if(a.startsWith("tribal_")){const s=i[a];s&&typeof s=="object"&&"startTime"in s&&t-s.startTime>Ko&&o.push(a)}for(const a of o)C.delete(e.aiBlackboard,a)}class ur extends fn{constructor(i,o,a,s=0){super();Ne(this,"name");Ne(this,"depth");Ne(this,"registeredKey");this.child=i,this.config=o,this.name=a,this.depth=s,this.child.depth=(this.depth??0)+1,this.registeredKey=`${this.name}_registered`}execute(i,o,a){Ze.nodeStart(this.name);try{const s=Yr(i,o.gameState);if(!s||!s.aiBlackboard){const[I,y]=bt(this.child.execute(i,o,a));return this.setLastStatus(i,I),C.recordNodeExecution(a,this.name,I,o.gameState.time,this.depth,`No coordination: ${y}`),I}const u=o.gameState.time,c=C.get(a,this.registeredKey)??!1,f=this.getTaskTarget(i,o,a);if(!f)return this.setLastStatus(i,E.FAILURE),C.recordNodeExecution(a,this.name,E.FAILURE,u,this.depth,"No task target found"),E.FAILURE;const g=this.getTaskKey(f);if(c){const[I,y]=bt(this.child.execute(i,o,a));return I===E.RUNNING?(this.refreshTaskTimestamp(s.aiBlackboard,g,i.id,u),this.setLastStatus(i,I),C.recordNodeExecution(a,this.name,I,u,this.depth,`Continuing: ${y}`),I):(this.removeFromTask(s.aiBlackboard,g,i.id),C.delete(a,this.registeredKey),this.setLastStatus(i,I),C.recordNodeExecution(a,this.name,I,u,this.depth,`Completed: ${y}`),I)}if(!this.canJoinTask(s.aiBlackboard,g,i.id,u)){this.setLastStatus(i,E.FAILURE);const I=C.get(s.aiBlackboard,g),y=(I==null?void 0:I.memberIds.length)??0,w=this.config.maxCapacity??1;return C.recordNodeExecution(a,this.name,E.FAILURE,u,this.depth,`Task full: ${y}/${w}`),E.FAILURE}if(!this.registerTask(s.aiBlackboard,g,i.id,u))return this.setLastStatus(i,E.FAILURE),C.recordNodeExecution(a,this.name,E.FAILURE,u,this.depth,"Failed to register task"),E.FAILURE;C.set(a,this.registeredKey,!0);const[T,A]=bt(this.child.execute(i,o,a));if(T===E.RUNNING){this.setLastStatus(i,T);const I=C.get(s.aiBlackboard,g),y=(I==null?void 0:I.memberIds.length)??0,w=this.config.maxCapacity??1;return C.recordNodeExecution(a,this.name,T,u,this.depth,`Started (${y}/${w}): ${A}`),T}else return this.removeFromTask(s.aiBlackboard,g,i.id),C.delete(a,this.registeredKey),this.setLastStatus(i,T),C.recordNodeExecution(a,this.name,T,u,this.depth,`Immediate result: ${A}`),T}finally{Ze.nodeEnd()}}getTaskTarget(i,o,a){var u,c,f,g;if(this.config.taskType==="procreation")return((c=(u=this.config).getTargetId)==null?void 0:c.call(u,i,o,a))??null;const s=(g=(f=this.config).getTargetId)==null?void 0:g.call(f,i,o,a);return s??null}getTaskKey(i){return this.config.generateTaskKey?this.config.generateTaskKey(this.config.taskType,i):`tribal_${this.config.taskType}_${i}`}canJoinTask(i,o,a,s){const u=C.get(i,o);if(!u||s-u.startTime>Ko||u.memberIds.includes(a))return!0;const c=this.config.maxCapacity??1;return u.memberIds.length<c}registerTask(i,o,a,s){let u=C.get(i,o);return u?s-u.startTime>Ko?(u={memberIds:[a],startTime:s,maxCapacity:this.config.maxCapacity??1},C.set(i,o,u),!0):u.memberIds.length>=(this.config.maxCapacity??1)?!!u.memberIds.includes(a):(u.memberIds.includes(a)||(u.memberIds.push(a),C.set(i,o,u)),!0):(u={memberIds:[a],startTime:s,maxCapacity:this.config.maxCapacity??1},C.set(i,o,u),!0)}refreshTaskTimestamp(i,o,a,s){const u=C.get(i,o);u&&u.memberIds.includes(a)&&(u.startTime=s,C.set(i,o,u))}removeFromTask(i,o,a){const s=C.get(i,o);s&&(s.memberIds=s.memberIds.filter(u=>u!==a),s.memberIds.length===0?C.delete(i,o):C.set(i,o,s))}}function p1(e){return new pe([new J((t,i)=>{const o=t.hunger>=Mf,a=t.food.length>0,s=!t.eatingCooldownTime||i.gameState.time>=t.eatingCooldownTime;return[!!(o&&a&&s),`${Math.floor(t.hunger-Mf)}, ${t.food.length}, ${t.eatingCooldownTime?Math.floor(t.eatingCooldownTime-i.gameState.time):""}`]},"Can Eat",e+1),new ie(t=>(t.direction={x:0,y:0},t.target=void 0,t.activeAction="eating",E.RUNNING),"Eat",e+1)],"Eating",e)}function m1(e){return new pe([new J((t,i,o)=>{if(t.isAdult&&t.hitpoints>t.maxHitpoints*Nv||!(t.hitpoints<t.maxHitpoints*.1)&&t.isAdult&&t.hunger>kI)return!1;const s=oC(t.id,i.gameState);return s?(C.set(o,"fleeThreat",s.id),!0):!1},"Should Flee",e+1),new ie((t,i,o)=>{const a=C.get(o,"fleeThreat"),s=a&&i.gameState.entities.entities[a];if(!s)return E.FAILURE;t.activeAction="moving";const u=Ye(s.position,t.position,i.gameState.mapDimensions.width,i.gameState.mapDimensions.height),c=lt(u),f=Bn(t.position,Ot(c,Dv));return t.target={x:(f.x%i.gameState.mapDimensions.width+i.gameState.mapDimensions.width)%i.gameState.mapDimensions.width,y:(f.y%i.gameState.mapDimensions.height+i.gameState.mapDimensions.height)%i.gameState.mapDimensions.height},t.direction=c,E.RUNNING},"Execute Flee",e+1)],"Flee",e)}const wS=400,v1=25;function R0(e){const t=Math.sin(e)*1e4;return t-Math.floor(t)}function S1(e,t,i=wS){return t.search.building.byRadius(e.position,i).some(s=>{const u=s;return u.buildingType==="storageSpot"&&u.ownerId===e.leaderId&&u.isConstructed&&u.storedFood&&u.storageCapacity&&u.storedFood.length<u.storageCapacity/2})}function y1(e,t,i=wS,o,a){return t.search.building.byRadius(e.position,i).filter(c=>{const f=c;return f.buildingType==="storageSpot"&&f.ownerId===e.leaderId&&f.isConstructed&&f.storedFood&&f.storedFood.length>0}).filter(c=>{if(o){const f=`tribal_storage_${c.id}`,g=C.get(o,f);if(g&&g.memberIds.length>=Eh&&(!a||!g.memberIds.includes(a)))return!1}return!0})}function A1(e,t,i){if(t.length===0)return null;let o=null,a=1/0;for(const s of t){const u=V(e.position,s.position,i.mapDimensions.width,i.mapDimensions.height);u<a&&(a=u,o=s)}return o?{storage:o,distance:a}:null}function _S(e){const t=e.storedFood?e.storedFood.length:0,i=R0(t+e.id)*2*Math.PI,o=R0(t+e.id+1)*v1;return{x:Math.cos(i)*o,y:Math.sin(i)*o}}function Zo(e,t,i){return RS(e,i)?e.tribeRole===t:!0}function RS(e,t){if(!e.leaderId)return!1;const i=t.entities.entities[e.leaderId];return!i||!i.tribeControl?!1:t.search.human.byProperty("leaderId",i.id).filter(a=>a.isAdult).length>=vw}const To="foodSource";function T1(e){const t=new ie((o,a,s)=>{const u=Yr(o,a.gameState),c=new Map,f=Me(o,a.gameState,"berryBush",zm,v=>{var y;if(v.food.length===0)return!1;if(u&&u.aiBlackboard){const w=`tribal_gather_${v.id}`,M=C.get(u.aiBlackboard,w);if(M&&a.gameState.time-M.startTime<=Ko&&!M.memberIds.includes(o.id))return!1}const T=(y=a.gameState.search.building.byRadius(v.position,v.radius)[0])==null?void 0:y.ownerId,A=a.gameState.entities.entities[T];if(!A||A.leaderId===o.leaderId)return!0;const I=c.get(A.id)??V(o.position,A.position,a.gameState.mapDimensions.width,a.gameState.mapDimensions.height);return c.set(A.id,I),I>nE}),g=Me(o,a.gameState,"corpse",zm,v=>{if(v.food.length===0)return!1;if(u&&u.aiBlackboard){const T=`tribal_gather_${v.id}`,A=C.get(u.aiBlackboard,T);if(A&&a.gameState.time-A.startTime<=Ko&&!A.memberIds.includes(o.id))return!1}return!0});let m=null;if(f&&g){const v=V(o.position,f.position,a.gameState.mapDimensions.width,a.gameState.mapDimensions.height),T=V(o.position,g.position,a.gameState.mapDimensions.width,a.gameState.mapDimensions.height);m=v<=T?f:g}else m=f||g;return m?(C.set(s,To,m.id),[E.SUCCESS,`Found food: ${m.type} at ${m.position.x.toFixed(0)},${m.position.y.toFixed(0)}`]):[E.FAILURE,"No food source found"]},"Find Closest Food Source",e+4),i=new ur(new ie((o,a,s)=>{const u=C.get(s,To);if(!u)return[E.FAILURE,"No target in blackboard"];const c=a.gameState.entities.entities[u];return!c||c.food.length===0?(C.delete(s,To),[E.FAILURE,"Food source is invalid or depleted"]):V(o.position,c.position,a.gameState.mapDimensions.width,a.gameState.mapDimensions.height)<zo?(o.activeAction="gathering",o.direction={x:0,y:0},o.target=c.id,C.delete(s,To),[E.SUCCESS,`Gathering from ${c.type}`]):(o.activeAction="moving",o.target=c.id,o.direction=Bt(o.position,c.position,a.gameState.mapDimensions),[E.RUNNING,`Moving to ${c.type}`])},"Move To Food and Gather",e+3),{taskType:"gather",maxCapacity:2,getTargetId:(o,a,s)=>C.get(s,To)??null},"Tribal Gather Task",e+3);return new pe([new J((o,a)=>{const s=o.food.length<o.maxFood,u=o.hunger>CI,c=dn(a.gameState,o).filter(g=>g.hunger>nh),f=S1(o,a.gameState);return[(o.isAdult&&s&&(u||c.length>0||f&&Zo(o,we.Gatherer,a.gameState)))??!1,`${u?"Hungry":""}${c.length>0?" Children("+c.length+")":""}${f?" Storage":""}`]},"Should Gather Food",e+1),new Xt([new pe([new J((o,a,s)=>C.has(s,To),"Has Food Source?",e+2),i],"Continue Gathering Action",e+2),new pe([new Ii(t,bI,"Cache Food Source Search",e+3),i],"Find New Food Source and Gather",e+2)],"Perform or Start Gathering",e+1)],"Gather Food",e)}function I1(e){return new ie((t,i,o)=>(t.activeAction="idle",t.direction={x:0,y:0},t.target=void 0,C.set(o,"wanderTarget",void 0),E.SUCCESS),"Idle",e)}const eu="procreationWanderStartTime",P0=(e,t,i)=>t.find(o=>jr(e,o,i)),N0={taskType:"procreation",maxCapacity:2,getTargetId:(e,t,i)=>C.get(i,"procreationPartner")??null};function E1(e){const t=new J((s,u,c)=>{const f=t0(s,u.gameState,zo),g=P0(s,f,u.gameState);return g?(C.set(c,"procreationPartner",g.id),!0):[!1,"No immediate partner found"]},"Find Immediate Partner"),i=new ur(new ie((s,u,c)=>{var m;const f=C.get(c,"procreationPartner"),g=f&&u.gameState.entities.entities[f];return g?(s.activeAction="procreating",s.target=void 0,C.delete(c,"procreationPartner"),C.delete(c,eu),(m=s.partnerIds)!=null&&m.includes(g.id)||(s.partnerIds=s.partnerIds?[...s.partnerIds,g.id]:[g.id]),E.SUCCESS):E.FAILURE},"Start Procreating"),N0,"Tribal Start Procreating",e+2),o=new J((s,u,c)=>{const f=t0(s,u.gameState,MI),g=P0(s,f,u.gameState);return g?(C.set(c,"procreationPartner",g.id),!0):[!1,"No distant partner found"]},"Locate Distant Partner"),a=new ur(new ie((s,u,c)=>{const f=C.get(c,"procreationPartner"),g=f&&u.gameState.entities.entities[f];if(!g||g.isPregnant)return E.FAILURE;if(V(s.position,g.position,u.gameState.mapDimensions.width,u.gameState.mapDimensions.height)<zo)return E.SUCCESS;s.activeAction="moving",s.target=g.id;const v=Ye(s.position,g.position,u.gameState.mapDimensions.width,u.gameState.mapDimensions.height);return s.direction=lt(v),E.RUNNING},"Move Towards Partner"),N0,"Tribal Move To Partner",e+3);return new pe([new J(s=>!s.isAdult||s.gender==="female"&&s.isPregnant?[!1,"Not adult or pregnant"]:s.age<CE||s.gender==="female"&&s.age>Uv?[!1,"Not fertile due to age or pregnancy status"]:!0,"Is Fertile (age, not pregnant)",e+1),new J(s=>s.hunger<Wr,"Is Healthy (hunger)",e+1),new J(s=>(s.procreationCooldown||0)<=0,"Is Ready (cooldown)",e+1),new Xt([new pe([new J((s,u)=>{const c=o0(s.position,u.gameState,"berryBush",$m);return[c>=OI,`Found ${c} bushes`]},"Is Environment Viable (food)",e+3),new ie((s,u,c)=>(C.delete(c,eu),E.SUCCESS),"Clear Wander Timer",e+3)],"Sufficient Food Path",e+2),new pe([new J((s,u)=>{const c=dn(u.gameState,s);return zr(c)?[!1,"Has an heir"]:!0},"Is Male Without Heir",e+3),new ie((s,u,c)=>{const f=C.get(c,eu);if(f===void 0)return C.set(c,eu,u.gameState.time),[E.FAILURE,"Starting heirless wander timer"];const g=u.gameState.time-f;return g>=wE?o0(s.position,u.gameState,"berryBush",$m)>=1?[E.SUCCESS,`Wandered for ${g.toFixed(1)}h, minimum food found`]:[E.FAILURE,"Desperate but no food sources nearby"]:[E.FAILURE,`Wandering for heir, ${g.toFixed(1)}h elapsed`]},"Check Wander Timer",e+3)],"Heirless Desperation Path",e+2)],"Check Environment Or Desperation",e+1),new J((s,u,c)=>{var g;const f=C.get(c,"procreationPartner");return f&&((g=f.partnerIds)!=null&&g.length)&&!f.partnerIds.includes(s.id)&&f.partnerIds.map(m=>u.gameState.entities.entities[m]).filter(m=>!!m).some(m=>V(s.position,m.position,u.gameState.mapDimensions.width,u.gameState.mapDimensions.height)<tE)?[!1,"Partner's primary partner is too close"]:!0},"Is Partner's Primary Partner Nearby",e+1),new Xt([new pe([t,i],"Procreate With Immediate Partner",e+2),new cr(BI,new pe([o,a],"Seek Distant Partner Action",e+3),"Seek Distant Partner Cooldown",e+2)],"Find Partner And Procreate",e+1)],"Procreate",e)}const Io="attackTarget",Pr="homeCenter",af=150;function C1(e){return new pe([new J((t,i,o)=>{if(!t.isAdult)return[!1,"Not an adult"];const{gameState:a}=i;if(t.activeAction==="attacking"&&t.attackTargetId){const u=a.entities.entities[t.attackTargetId];if(u&&u.hitpoints>0&&V(t.position,u.position,a.mapDimensions.width,a.mapDimensions.height)<=af){if(C.set(o,Io,u.id),!C.get(o,Pr)){const c=t.leaderId?ar(t.leaderId,a):wu(t,a).length>0?i0(t,a):t.position;C.set(o,Pr,c)}return!0}}if(!Zo(t,we.Warrior,a))return[!1,"Not a Warrior"];const s=Me(t,a,"human",af,u=>u.hitpoints>0&&ns(t,u,a));if(s){C.set(o,Io,s.id);const u=t.leaderId?ar(t.leaderId,a):wu(t,a).length>0?i0(t,a):t.position;return C.set(o,Pr,u),!0}return C.set(o,Io,void 0),C.set(o,Pr,void 0),!1},"Find Attack Target",e+1),new ie((t,i,o)=>{const a=C.get(o,Io),s=a&&i.gameState.entities.entities[a],u=C.get(o,Pr);if(!s||!u)return E.FAILURE;const{gameState:c}=i;return V(t.position,u,c.mapDimensions.width,c.mapDimensions.height)>Pv?(t.activeAction="idle",t.attackTargetId=void 0,C.set(o,Io,void 0),C.set(o,Pr,void 0),E.FAILURE):s.hitpoints<=0||V(t.position,s.position,c.mapDimensions.width,c.mapDimensions.height)>af?(t.activeAction==="attacking"&&(t.activeAction="idle",t.attackTargetId=void 0),C.set(o,Io,void 0),C.set(o,Pr,void 0),E.SUCCESS):(t.activeAction==="attacking"&&t.attackTargetId===s.id||(t.activeAction="attacking",t.attackTargetId=s.id),E.RUNNING)},"Execute Attack",e+1)],"Attack",e)}const w1=(e,t,i)=>{const o=dn(t.gameState,e).filter(u=>!u.isAdult);if(o.length===0)return E.FAILURE;let a=null,s=nh;for(const u of o)u.hunger>=s&&(s=u.hunger,a=u);return a?(C.set(i,"targetChild",a.id),E.SUCCESS):E.FAILURE},_1=(e,t,i)=>{const o=C.get(i,"targetChild"),a=o&&t.gameState.entities.entities[o];return a?V(e.position,a.position,t.gameState.mapDimensions.width,t.gameState.mapDimensions.height)>ih?(e.activeAction="moving",e.target=a.id,e.direction=Bt(e.position,a.position,t.gameState.mapDimensions),E.RUNNING):(e.activeAction="feeding",e.target=void 0,C.set(i,"targetChild",void 0),E.SUCCESS):E.FAILURE};function R1(e){return new pe([new J(t=>(t.isAdult&&t.food.length>0&&(!t.feedChildCooldownTime||t.feedChildCooldownTime<=0))??!1,"Can Feed Child",e+1),new ie(w1,"Find Hungriest Child",e+1),new ie(_1,"Move To Child and Feed",e+1)],"Feed Child",e)}function P1(e){return new pe([new J(t=>!t.isAdult&&t.hunger>=nh,"Is Hungry Child",e+1),new ie((t,i,o)=>{const a=XE(t,i.gameState);if(a.length===0)return E.FAILURE;const s=Me(t,i.gameState,"human",DE,u=>a.some(c=>c.id===u.id)&&u.food.length>0);return s?(C.set(o,"targetParent",s.id),E.SUCCESS):E.FAILURE},"Find Parent With Food",e+1),new ie((t,i,o)=>{const a=C.get(o,"targetParent"),s=a&&i.gameState.entities.entities[a];if(!s)return E.FAILURE;const u=V(t.position,s.position,i.gameState.mapDimensions.width,i.gameState.mapDimensions.height);return t.activeAction="idle",u<=ih?(t.target=void 0,E.SUCCESS):(t.target=s.id,t.activeAction="moving",E.RUNNING)},"Move To Parent",e+1)],"Seek Food From Parent",e)}const Eo="plantingSpot",Xs="plantingZoneId",N1=50;function D1(e,t,i,o){const a=Ye(e,t,i,o);return Bn(e,a)}function O1(e){const t=new ie((a,s,u)=>{const c=C.get(u,Eo);if(!c)return C.delete(u,Eo),C.delete(u,Xs),[E.FAILURE,"Planting spot is missing"];if(bn(c,s.gameState,xr,a.id))return C.delete(u,Eo),C.delete(u,Xs),[E.FAILURE,"Planting spot is occupied"];const f=D1(a.position,c,s.gameState.mapDimensions.width,s.gameState.mapDimensions.height),g=V(a.position,f,s.gameState.mapDimensions.width,s.gameState.mapDimensions.height);return g>zo?(a.activeAction="moving",a.target=f,a.direction=Bt(a.position,f,s.gameState.mapDimensions),[E.RUNNING,"Moving to planting spot: "+g.toFixed(2)+" units away"]):bn(c,s.gameState,xr,a.id)?(C.delete(u,Eo),C.delete(u,Xs),[E.FAILURE,"Planting spot is now occupied"]):(a.activeAction="planting",a.target=c,[E.RUNNING,"Planting state initiated"])},"Move To Spot and Plant",e+4),i=new ur(t,{taskType:"plant",maxCapacity:2,proximityRadius:N1,getTargetId:(a,s,u)=>C.get(u,Xs)??null},"Coordinated Planting",e+3),o=new ie((a,s,u)=>{const c=l_(a,s.gameState);return c?(C.set(u,Eo,c.position),C.set(u,Xs,c.zoneId),[E.SUCCESS,`Found new spot at ${c.position.x.toFixed(0)}, ${c.position.y.toFixed(0)} (Zone ${c.zoneId})`]):[E.FAILURE,"No suitable planting spot found"]},"Find Optimal Planting Spot",e+3);return new pe([new J((a,s)=>{if(!Zo(a,we.Planter,s.gameState))return[!1,"Not a Planter"];const u=a.food.filter(g=>g.type===Hn.Berry).length>=Gr,c=a.hunger<wI,f=(a.isAdult&&u&&c)??!1;return[f,f?"Can plant":`Cannot plant: adult=${a.isAdult}, berries=${a.food.filter(g=>g.type===Hn.Berry).length}/${Gr}, hunger=${a.hunger.toFixed(0)}`]},"Can Plant",e+1),new J((a,s)=>{if(!a.leaderId)return[!1,"No tribe"];const u=e_(a,s.gameState),c=hS(a.leaderId,s.gameState);let f;return u<rE?f=aE:u<oE?f=lE:u<sE?f=uE:f=cE,[c<f,`Food security: ${(u*100).toFixed(0)}%, Bush density: ${c.toFixed(1)}/${f}`]},"Needs More Bushes (Adaptive)",e+1),new J((a,s)=>{if(!a.leaderId)return[!0,"No tribe coordination needed"];const u=ri(a,s.gameState),c=gS(a.leaderId,s.gameState,"planting"),f=Math.max(1,Math.ceil(u.length*.3));return[c<f,`Active planters: ${c}/${f}`]},"Not Too Many Planters",e+1),new Xt([new pe([new J((a,s,u)=>C.has(u,Eo),"Has Planting Spot?",e+2),i],"Continue Planting Action",e+2),new cr(HI,o,"Find Planting Spot Cooldown",e+2)],"Perform or Start Planting",e+1)],"Plant Bush",e)}const D0="lastDepositTime",Co="assignedStorageSpot";function M1(e){return new Xt([new pe([new J((t,i,o)=>{if(!Zo(t,we.Gatherer,i.gameState)&&!Zo(t,we.Mover,i.gameState))return[!1,"Not a Gatherer/Mover"];const a=C.get(o,D0)||0,s=i.gameState.time-a;if(s<Ym)return[!1,`Cooldown: ${(Ym-s).toFixed(1)}h remaining`];if(!t.isAdult)return[!1,"Not an adult"];if(!t.leaderId)return[!1,"No tribe"];const u=fS(t.leaderId,i.gameState);let c;u<.3?c=dE:u<.7?c=fE:c=hE;const f=t.food.length/t.maxFood;if(f<=c)return[!1,`Food ${(f*100).toFixed(0)}% < threshold ${(c*100).toFixed(0)}%`];const g=a_(t,i.gameState);return g?(C.set(o,Co,g.id),[!0,`Storage util: ${(u*100).toFixed(0)}%, Personal: ${(f*100).toFixed(0)}%`]):[!1,"No available tribe storage nearby"]},"Check for Excess Food and Storage",e+1),new J((t,i)=>{if(!t.leaderId)return[!0,"No tribe coordination needed"];const o=gS(t.leaderId,i.gameState,"depositing"),a=ri(t,i.gameState),s=Math.max(1,Math.ceil(a.length*.4));return[o<s,`Active depositors: ${o}/${s}`]},"Not Too Many Depositors",e+1),new ur(new ie((t,i,o)=>{var c;const a=C.get(o,Co);if(!a)return[E.FAILURE,"No storage assigned"];const s=i.gameState.entities.entities[a];if(!s)return C.delete(o,Co),[E.FAILURE,"Storage entity missing"];if((((c=s.storedFood)==null?void 0:c.length)??0)>=(s.storageCapacity??0))return C.delete(o,Co),[E.FAILURE,"Storage full"];const u=V(t.position,s.position,i.gameState.mapDimensions.width,i.gameState.mapDimensions.height);return u<=Cn?(t.activeAction="depositing",t.target=void 0,C.set(o,D0,i.gameState.time),C.delete(o,Co),[E.SUCCESS,"Depositing food"]):(t.activeAction="moving",t.target=s.position,[E.RUNNING,`Moving to storage (${u.toFixed(1)}px away)`])},"Navigate to Storage and Deposit",e+2),{taskType:"storage",maxCapacity:Eh,storageAction:"deposit",getTargetId:(t,i,o)=>C.get(o,Co)??null},"Tribal Storage Deposit Task",e+1)],"Deposit Sequence",e)],"Storage Deposit Behavior",e)}const tu="retrievalStorageId";function k1(e){return new Xt([new pe([new J((t,i,o)=>{if(t.hunger<=Mf)return[!1,"Not hungry enough"];if(t.food.length>=t.maxFood)return[!1,"Inventory full"];const a=Yr(t,i.gameState),s=y1(t,i.gameState,void 0,a==null?void 0:a.aiBlackboard,t.id),u=A1(t,s,i.gameState),c=u==null?void 0:u.storage;return c?(C.set(o,tu,c.id),[!0,`Storage with food found at distance ${u.distance.toFixed(1)}`]):[!1,"No tribe storage with food nearby"]},"Check for Hunger and Storage Food",e+1),new ur(new ie((t,i,o)=>{const a=C.get(o,tu);if(!a)return[E.FAILURE,"No storage target"];const s=i.gameState.entities.entities[a];if(!s)return C.delete(o,tu),[E.FAILURE,"Storage not found"];const u=V(t.position,s.position,i.gameState.mapDimensions.width,i.gameState.mapDimensions.height);return u<=Cn?(t.activeAction="retrieving",t.target=void 0,[E.SUCCESS,"Retrieving food"]):(t.activeAction="moving",t.target=s.position,[E.RUNNING,`Moving to storage (${u.toFixed(1)}px away)`])},"Navigate to Storage and Retrieve",e+2),{taskType:"storage",maxCapacity:Eh,storageAction:"retrieve",getTargetId:(t,i,o)=>C.get(o,tu)??null},"Coordinated Storage Retrieve",e+1)],"Retrieve Sequence",e)],"Storage Retrieve Behavior",e)}function F1(e){return new Xt([new pe([new J((t,i,o)=>{if(!t.isAdult)return[!1,"Not an adult"];if(t.food.length>=t.maxFood)return[!1,"Inventory full"];const u=i.gameState.search.building.byRadius(t.position,150).find(c=>{const f=c;return!(f.buildingType!=="storageSpot"||!f.isConstructed||!f.storedFood||f.storedFood.length===0||f.ownerId===t.leaderId)});return u?[!0,`Storage for stealing found at distance ${V(t.position,u.position,i.gameState.mapDimensions.width,i.gameState.mapDimensions.height).toFixed(1)}`]:[!1,"No storage for stealing nearby"]},"Check for Storage for Stealing",e+1),new ie((t,i,o)=>{const u=i.gameState.search.building.byRadius(t.position,150).filter(g=>{const m=g;return!(m.buildingType!=="storageSpot"||!m.isConstructed||!m.storedFood||m.storedFood.length===0||m.ownerId===t.leaderId)});if(u.length===0)return[E.FAILURE,"No undefended storage available"];let c=null,f=1/0;for(const g of u){const m=V(t.position,g.position,i.gameState.mapDimensions.width,i.gameState.mapDimensions.height);m<f&&(f=m,c=g)}return c?f<=Cn?(t.activeAction="idle",t.target=void 0,[E.SUCCESS,"Stealing food"]):(t.activeAction="moving",t.target=c.position,[E.RUNNING,`Moving to storage (${f.toFixed(1)}px away)`]):[E.FAILURE,"No storage found"]},"Navigate to Storage and Steal",e+1)],"Steal Sequence",e)],"Storage Steal Behavior",e)}const lf="enemiesNearby";function L1(e){const t=new J(s=>s.id===s.leaderId,"Is Leader?",e+1),i=new J(s=>!s.isCallingToAttack,"Is Not Already Calling?",e+1),o=new ie((s,u,c)=>{const f=uh(s,u.gameState,sS);return f.length>0?(C.set(c,lf,f.map(g=>g.id)),E.SUCCESS):E.FAILURE},"Find Nearby Enemies",e+1),a=new Xt([new pe([new J((s,u,c)=>{const f=C.get(c,lf),g=f==null?void 0:f.map(A=>u.gameState.entities.entities[A]).filter(A=>!!A);if(!g||g.length===0)return!1;const m=jo(s.id,u.gameState),v=_u(m),T=_u(g);return v>T*XI},"Is Strong Enough?",e+3),new ie((s,u)=>(s.isCallingToAttack=!0,s.callToAttackEndTime=u.gameState.time+Xo,ke(u.gameState,he.CallToAttack,s.position,Xo),_e(u,ge.CallToAttack,s.position),s.activeAction="idle",s.target=void 0,E.SUCCESS),"Issue Call to Attack",e+3)],"Attack",e+2),new ie((s,u,c)=>{const f=C.get(c,lf),g=f==null?void 0:f.map(y=>u.gameState.entities.entities[y]).filter(y=>!!y);if(!g||g.length===0)return E.FAILURE;const m=g.map(y=>y.position),v=Cu(m),T=Ye(v,s.position,u.gameState.mapDimensions.width,u.gameState.mapDimensions.height),A=lt(T),I=Bn(s.position,Ot(A,Dv*2));return s.activeAction="moving",s.target={x:(I.x%u.gameState.mapDimensions.width+u.gameState.mapDimensions.width)%u.gameState.mapDimensions.width,y:(I.y%u.gameState.mapDimensions.height+u.gameState.mapDimensions.height)%u.gameState.mapDimensions.height},s.direction=A,E.SUCCESS},"Retreat",e+2)],"Attack or Retreat",e+2);return new pe([t,i,o,new cr(KI,a,"Leader Combat Cooldown",e+1)],"Leader Combat Strategy",e)}const uf="combatTarget",cf="homeCenter";function U1(e){const t=new J(u=>u.isAdult&&u.leaderId?u.id!==u.leaderId:!1,"Is Tribe Follower?",e+1),i=new J(u=>u.hunger<_I&&u.hitpoints>=u.maxHitpoints*Nv,"Is Fit for Combat?",e+1),o=new J((u,c)=>{const f=c.gameState.entities.entities[u.leaderId];return!!(f!=null&&f.isCallingToAttack)},"Is Leader Calling to Attack?",e+1),a=new ie((u,c,f)=>{const{gameState:g}=c,m=g.entities.entities[u.leaderId];if(!m)return E.FAILURE;const v=uh(m,g,FI);if(v.length===0)return E.FAILURE;v.sort((T,A)=>{const I=V(u.position,T.position,g.mapDimensions.width,g.mapDimensions.height),y=V(u.position,A.position,g.mapDimensions.width,g.mapDimensions.height);return I-y});for(const T of v)if(nC(m.id,T.id,g)<LI){C.set(f,uf,T.id);const I=ar(m.id,g);return C.set(f,cf,I),E.SUCCESS}return E.FAILURE},"Find Best Target",e+1),s=new ie((u,c,f)=>{const g=C.get(f,uf),m=g&&c.gameState.entities.entities[g],v=C.get(f,cf);if(!m||!v)return E.FAILURE;const{gameState:T}=c;return V(u.position,v,T.mapDimensions.width,T.mapDimensions.height)>Pv?(u.activeAction==="attacking"&&u.attackTargetId===m.id&&(u.activeAction="idle",u.attackTargetId=void 0),C.set(f,uf,void 0),C.set(f,cf,void 0),E.FAILURE):((!u.lastTargetAcquiredEffectTime||c.gameState.time-u.lastTargetAcquiredEffectTime>$e*5)&&(ke(c.gameState,he.TargetAcquired,u.position,$e,u.id),u.lastTargetAcquiredEffectTime=c.gameState.time),u.activeAction="attacking",u.attackTargetId=m.id,u.target=void 0,E.RUNNING)},"Attack Target",e+1);return new pe([t,i,o,a,s],"Tribe Member Combat",e)}function O0(e,t,i,o,a,s,u){const c=u.mapDimensions.width,f=u.mapDimensions.height,g=Math.PI/8,v=i*2/(2*Math.PI);let T=0,A=0;for(;A<=t;){const I=e.x+A*Math.cos(T),y=e.y+A*Math.sin(T),w={x:(I%c+c)%c,y:(y%f+f)%f};if(Sh(w,a,s,u)&&!aC(w,void 0,o,u))return w;T+=g,A=v*T}}function B1(e){const t=new J(A=>!A.leaderId||A.leaderId!==A.id?[!1,"Not a tribe leader"]:[!0,"Is tribe leader"],"Is Leader",e+1),i=new ie((A,I,y)=>(C.delete(y,"tribeAnalysis_adultCount"),C.delete(y,"tribeAnalysis_existingStorageSpots"),C.delete(y,"tribeAnalysis_existingPlantingZones"),C.delete(y,"tribeAnalysis_storageUtilization"),C.delete(y,"tribeAnalysis_bushDensity"),C.delete(y,"tribeAnalysis_zoneDensity"),C.delete(y,"tribeAnalysis_projectedAdultCount"),[E.SUCCESS,"Reset tribe analysis from blackboard"]),"Reset Tribe Analysis",e+2),o=new ie((A,I,y)=>{const w=ri(A,I.gameState),M=w.filter(Q=>Q.isAdult),F=Na(A.leaderId,I.gameState),N=yh(A,I.gameState),b=fS(A.leaderId,I.gameState),B=hS(A.leaderId,I.gameState),L=N.length/Math.max(1,w.length),G=Math.ceil(M.length*(1+pE));return C.set(y,"tribeAnalysis_adultCount",M.length),C.set(y,"tribeAnalysis_existingStorageSpots",F.length),C.set(y,"tribeAnalysis_existingPlantingZones",N.length),C.set(y,"tribeAnalysis_storageUtilization",b),C.set(y,"tribeAnalysis_bushDensity",B),C.set(y,"tribeAnalysis_zoneDensity",L),C.set(y,"tribeAnalysis_projectedAdultCount",G),[E.SUCCESS,`Analyzed tribe: ${M.length} adults, ${F.length} storage, ${N.length} planting zones`]},"Analyze Tribe",e+1),a=new Ii(o,1,"Cached Tribe Analysis",e+1),s=new J((A,I,y)=>{const w=C.get(y,"tribeAnalysis_adultCount");return w===void 0?[!1,"No tribe analysis available"]:w<Vm?[!1,`Tribe too small: ${w}/${Vm} adults`]:[!0,`Tribe size sufficient: ${w} adults`]},"Has Minimum Tribe Size",e+1),u=new J((A,I,y)=>{const w=C.get(y,"tribeAnalysis_adultCount"),M=C.get(y,"tribeAnalysis_existingStorageSpots"),F=C.get(y,"tribeAnalysis_storageUtilization"),N=C.get(y,"tribeAnalysis_projectedAdultCount");if(w===void 0||M===void 0||F===void 0||N===void 0)return[!1,"No tribe analysis available"];const b=M===0,B=F*(N/Math.max(1,w));return M<Zm&&(b||F>Xm||B>Xm)?[!0,b?"Bootstrap: First storage spot":`Utilization: ${(F*100).toFixed(0)}% (projected: ${(B*100).toFixed(0)}%)`]:[!1,`Storage adequate: ${M}/${Zm}, util: ${(F*100).toFixed(0)}%`]},"Needs Storage",e+2),c=new ie((A,I,y)=>{const w=C.get(y,"tribeAnalysis_existingStorageSpots");if(w===void 0)return[E.FAILURE,"No tribe analysis available"];const F=w===0?mE:Qm,N=ar(A.leaderId,I.gameState),b=O0(N,zl,jm,F,ni.StorageSpot,A.id,I.gameState);return b?(Bf(b,ni.StorageSpot,A.id,I.gameState),[E.SUCCESS,`Placed storage at (${b.x.toFixed(0)}, ${b.y.toFixed(0)})`]):[E.FAILURE,`No valid location found for storage within ${zl}px`]},"Place Storage",e+2),f=new pe([u,c,i],"Storage Sequence",e+1),g=new J((A,I,y)=>{const w=C.get(y,"tribeAnalysis_adultCount"),M=C.get(y,"tribeAnalysis_existingPlantingZones"),F=C.get(y,"tribeAnalysis_bushDensity"),N=C.get(y,"tribeAnalysis_zoneDensity"),b=C.get(y,"tribeAnalysis_projectedAdultCount");if(w===void 0||M===void 0||F===void 0||N===void 0||b===void 0)return[!1,"No tribe analysis available"];const B=F*(w/Math.max(1,b)),G=M===0||M<qm&&(F<Km||B<Km);return G&&N>B?[!1,`Planting zone density (${N.toFixed(2)}) exceeds projected density (${B.toFixed(2)})`]:G?[!0,`Low bush density: ${F.toFixed(1)} (projected: ${B.toFixed(1)})`]:[!1,`Planting zones adequate: ${M}/${qm}, density: ${F.toFixed(1)}`]},"Needs Planting Zone",e+2),m=new ie((A,I)=>{const y=ar(A.leaderId,I.gameState),w=O0(y,zl,jm,Qm,ni.PlantingZone,A.id,I.gameState);return w?(Bf(w,ni.PlantingZone,A.id,I.gameState),[E.SUCCESS,`Placed planting zone at (${w.x.toFixed(0)}, ${w.y.toFixed(0)})`]):[E.FAILURE,`No valid location found for planting zone within ${zl}px`]},"Place Planting Zone",e+2),v=new pe([g,m,i],"Planting Zone Sequence",e+1),T=new Xt([f,v],"Building Type Selector",e+1);return new pe([t,a,s,T],"Leader Building Placement",e)}const Yi="takeOverBuildingTarget";function H1(e){const t=new pe([new J((i,o,a)=>{if(!i.leaderId||i.leaderId!==i.id)return[!1,"Not a tribe leader"];const s=C.get(a,Yi);if(s){const c=o.gameState.entities.entities[s];if(c&&c.type==="building"&&Ln(i,c,o.gameState))return[!0,`Continuing to target building ${s}`];C.delete(a,Yi)}const u=Me(i,o.gameState,"building",Mv,c=>Ln(i,c,o.gameState)&&c.isConstructed);return u?(C.set(a,Yi,u.id),[!0,`Found enemy building at distance ${V(i.position,u.position,o.gameState.mapDimensions.width,o.gameState.mapDimensions.height).toFixed(0)}px`]):[!1,"No enemy buildings found within range"]},"Find Enemy Building to Take Over",e+2),new ie((i,o,a)=>{const s=C.get(a,Yi);if(!s)return E.FAILURE;const u=o.gameState.entities.entities[s];return!u||u.type!=="building"||!Ln(i,u,o.gameState)?(C.delete(a,Yi),i.activeAction="idle",i.target=void 0,E.FAILURE):V(i.position,u.position,o.gameState.mapDimensions.width,o.gameState.mapDimensions.height)<yt?(i.activeAction="idle",i.target=void 0,E.SUCCESS):(i.activeAction="moving",i.target=u.id,E.RUNNING)},"Move to Enemy Building",e+2),new ie((i,o,a)=>{const s=C.get(a,Yi);if(!s)return E.FAILURE;const u=o.gameState.entities.entities[s];return!u||u.type!=="building"||!Ln(i,u,o.gameState)?(C.delete(a,Yi),E.FAILURE):(i.activeAction="takingOverBuilding",i.target=u.id,C.delete(a,Yi),E.SUCCESS)},"Initiate Building Takeover",e+2)],"Take Over Building Action",e+1);return new cr(Ov,t,"Take Over Building Cooldown",e)}const ji="removeEnemyBuildingTarget";function b1(e){const t=new pe([new J((i,o,a)=>{if(!i.leaderId||i.leaderId!==i.id)return[!1,"Not a tribe leader"];const s=C.get(a,ji);if(s){const c=o.gameState.entities.entities[s];if(c&&c.type==="building"&&Ln(i,c,o.gameState))return[!0,`Continuing to target building ${s}`];C.delete(a,ji)}const u=Me(i,o.gameState,"building",Mv,c=>Ln(i,c,o.gameState)&&c.isConstructed);return u?(C.set(a,ji,u.id),[!0,`Found enemy building at distance ${V(i.position,u.position,o.gameState.mapDimensions.width,o.gameState.mapDimensions.height).toFixed(0)}px`]):[!1,"No enemy buildings found within range"]},"Find Enemy Building to Destroy",e+2),new ie((i,o,a)=>{const s=C.get(a,ji);if(!s)return E.FAILURE;const u=o.gameState.entities.entities[s];return!u||u.type!=="building"||!Ln(i,u,o.gameState)?(C.delete(a,ji),i.activeAction="idle",i.target=void 0,E.FAILURE):V(i.position,u.position,o.gameState.mapDimensions.width,o.gameState.mapDimensions.height)<yt?(i.activeAction="idle",i.target=void 0,E.SUCCESS):(i.activeAction="moving",i.target=u.id,E.RUNNING)},"Move to Enemy Building",e+2),new ie((i,o,a)=>{const s=C.get(a,ji);if(!s)return E.FAILURE;const u=o.gameState.entities.entities[s];return!u||u.type!=="building"||!Ln(i,u,o.gameState)?(C.delete(a,ji),E.FAILURE):(i.activeAction="destroyingBuilding",i.target=u.id,C.delete(a,ji),E.SUCCESS)},"Initiate Building Destruction",e+2)],"Remove Enemy Building Action",e+1);return new cr(Ov,t,"Remove Enemy Building Cooldown",e)}function G1(e){return new pe([new ie((t,i,o)=>{const a=ZE(t,i.gameState);return a?(C.set(o,"patriarchTarget",a.id),[E.SUCCESS,`Found patriarch: ${a.id}`]):(C.delete(o,"patriarchTarget"),[E.FAILURE,"No patriarch found"])},"Find Patriarch",e+1),new ie((t,i,o)=>{const a=C.get(o,"patriarchTarget"),s=a&&i.gameState.entities.entities[a];if(!s)return[E.FAILURE,"Patriarch target missing from blackboard"];const u=V(t.position,s.position,i.gameState.mapDimensions.width,i.gameState.mapDimensions.height);if(u>Rv){t.activeAction="moving",t.target=s.id;const c=Ye(t.position,s.position,i.gameState.mapDimensions.width,i.gameState.mapDimensions.height);return t.direction=lt(c),[E.RUNNING,`Moving to patriarch at ${u.toFixed(0)}`]}return t.activeAction="idle",t.target=void 0,t.direction={x:0,y:0},[E.SUCCESS,`Arrived at patriarch at ${u.toFixed(0)}`]},"Move Towards Patriarch",e+1)],"Follow Patriarch",e)}const nu="tribeSplitMigrationTarget";function x1(e){const t=new pe([new J((i,o,a)=>{if(C.get(a,nu))return[!0,"Already migrating"];const{canSplit:u,progress:c}=$u(i,o.gameState);return u?[!0,`Progress: ${(c??0)*100}%`]:[!1,"Cannot split"]},"Can Split Tribe?",e+2),new ie((i,o,a)=>{const{gameState:s}=o;let u=C.get(a,nu);if(!u){if(!i.leaderId)return E.FAILURE;const f=s.entities.entities[i.leaderId];if(!f)return E.FAILURE;const g=Hw(f.position,i,s);if(g)C.set(a,nu,g),u=g;else return E.FAILURE}return V(i.position,u,s.mapDimensions.width,s.mapDimensions.height)<zo?(C.delete(a,nu),i.activeAction="idle",i.target=void 0,E.SUCCESS):(i.activeAction="moving",i.target=u,E.RUNNING)},"Move to New Territory",e+2),new ie((i,o)=>(mh(i,o.gameState),E.SUCCESS),"Perform Tribe Split",e+2)],"Tribe Split Action",e+1);return new cr(mw,t,"Tribe Split Cooldown",e)}const iu="jealousyAttackTarget";function $1(e){return new pe([new J((t,i,o)=>{if(!t.isAdult)return[!1,"Not an adult"];const a=JE(t,i.gameState,ZI);return a?t.leaderId&&a.id===t.leaderId?[!1,"Stranger is in same tribe - no attack"]:(C.set(o,iu,a.id),[!0,`Partner cheating with ${a.id}`]):(C.delete(o,iu),!1)},"Check for Infidelity",e+1),new ie((t,i,o)=>{const a=C.get(o,iu),s=a&&i.gameState.entities.entities[a];return!s||s.hitpoints<=0?(C.delete(o,iu),[E.FAILURE,"Target is invalid or dead"]):t.activeAction==="attacking"&&t.attackTargetId===s.id?E.RUNNING:(t.activeAction="attacking",t.attackTargetId=s.id,[E.RUNNING,`Attacking ${s.id}`])},"Execute Jealousy Attack",e+1)],"Jealousy Attack",e)}const ru="defendAggressor";function W1(e){return new pe([new J((t,i,o)=>{if(!t.isAdult)return[!1,"Not an adult"];const a=eC(t,i.gameState,qI);return a?(C.set(o,ru,a.aggressor.id),[!0,`Family member ${a.familyMember.id} attacked by ${a.aggressor.id}`]):(C.delete(o,ru),!1)},"Check Family Under Attack",e+1),new ie((t,i,o)=>{const a=C.get(o,ru),s=a&&i.gameState.entities.entities[a];return!s||s.hitpoints<=0?(C.delete(o,ru),[E.FAILURE,"Target invalid/dead"]):t.activeAction==="attacking"&&t.attackTargetId===s.id?E.RUNNING:(t.activeAction="attacking",t.attackTargetId=s.id,[E.RUNNING,`Attacking aggressor ${s.id}`])},"Execute Family Defense Attack",e+1)],"Defend Family",e)}const ou="desperateAttackTarget";function z1(e){return new pe([new J(t=>t.hunger>QI,"Is Starving",e+1),new J((t,i)=>{if(!t.isAdult)return[!1,"Not an adult"];const o=Me(t,i.gameState,"berryBush",yt,s=>s.food.length>0),a=Me(t,i.gameState,"corpse",yt,s=>s.food.length>0);return!o&&!a},"No Other Food Available",e+1),new J((t,i,o)=>{const a=tC(t,i.gameState);return a?(C.set(o,ou,a.id),[!0,`Found weak target ${a.id}`]):(C.delete(o,ou),!1)},"Find Weak Target",e+1),new ie((t,i,o)=>{const a=C.get(o,ou),s=a&&i.gameState.entities.entities[a];return!s||s.hitpoints<=0?(C.delete(o,ou),[E.FAILURE,"Target is invalid or dead"]):t.activeAction==="attacking"&&t.attackTargetId===s.id?E.RUNNING:(t.activeAction="attacking",t.attackTargetId=s.id,[E.RUNNING,`Desperately attacking ${s.id}`])},"Execute Desperate Attack",e+1)],"Desperate Attack",e)}function Y1(e,t,i,o){const a=e.entities.entities[i.targetEntityId];return!a||!("hitpoints"in a)||a.hitpoints<=0?(e.autopilotControls.activeAutopilotAction=void 0,E.FAILURE):V(t.position,a.position,e.mapDimensions.width,e.mapDimensions.height)<=Su?(t.activeAction="attacking",t.attackTargetId=a.id,e.autopilotControls.activeAutopilotAction=void 0,E.SUCCESS):(t.activeAction="moving",t.target=a.id,t.direction=Bt(t.position,a.position,e.mapDimensions),E.RUNNING)}function j1(e){return new pe([new J((t,i)=>t.isPlayer===!0&&!!i.gameState.autopilotControls.activeAutopilotAction,"Has Player Command",e+1),new ie((t,i)=>{var s;const{gameState:o}=i,a=o.autopilotControls.activeAutopilotAction;if(!a)return E.FAILURE;switch(a.action){case ce.AutopilotMove:{const u=a.position;return V(t.position,u,o.mapDimensions.width,o.mapDimensions.height)<iE?(o.autopilotControls.activeAutopilotAction=void 0,t.activeAction==="moving"&&(t.activeAction="idle",t.target=void 0),E.SUCCESS):(t.activeAction="moving",t.target=u,t.direction=Bt(t.position,u,o.mapDimensions),E.RUNNING)}case ce.AutopilotGather:{const u=o.entities.entities[a.targetEntityId];return!u||u.food.length===0?(o.autopilotControls.activeAutopilotAction=void 0,E.FAILURE):V(t.position,u.position,o.mapDimensions.width,o.mapDimensions.height)>zo?(t.activeAction="moving",t.target=u.id,t.direction=Bt(t.position,u.position,o.mapDimensions),E.RUNNING):(t.activeAction="gathering",t.target=u.id,o.autopilotControls.activeAutopilotAction=void 0,E.SUCCESS)}case ce.AutopilotAttack:return Y1(o,t,a);case ce.AutopilotProcreate:{const u=o.entities.entities[a.targetEntityId];return!u||u.type!=="human"||!jr(t,u,i.gameState)?(o.autopilotControls.activeAutopilotAction=void 0,E.FAILURE):V(t.position,u.position,o.mapDimensions.width,o.mapDimensions.height)<=Su?(t.activeAction="procreating",o.autopilotControls.activeAutopilotAction=void 0,E.SUCCESS):(t.activeAction="moving",t.target=u.id,t.direction=Bt(t.position,u.position,o.mapDimensions),E.RUNNING)}case ce.AutopilotPlant:{if(t.activeAction==="planting")return E.RUNNING;const u=a.position;return bn(u,o,xr,t.id)?(o.autopilotControls.activeAutopilotAction=void 0,E.FAILURE):V(t.position,u,o.mapDimensions.width,o.mapDimensions.height)<=Su?(t.activeAction="planting",t.target=u,o.autopilotControls.activeAutopilotAction=void 0,o.hasPlayerPlantedBush=!0,E.RUNNING):(t.activeAction="moving",t.target=u,t.direction=Bt(t.position,u,o.mapDimensions),E.RUNNING)}case ce.AutopilotFeedChild:{const u=o.entities.entities[a.targetEntityId];return!u||u.type!=="human"||u.isAdult||t.food.length===0?(o.autopilotControls.activeAutopilotAction=void 0,E.FAILURE):V(t.position,u.position,o.mapDimensions.width,o.mapDimensions.height)<=Su?(o.autopilotControls.activeAutopilotAction=void 0,t.activeAction="feeding",E.SUCCESS):(t.activeAction="moving",t.target=u.id,t.direction=Bt(t.position,u.position,o.mapDimensions),E.RUNNING)}case ce.AutopilotDeposit:{const u=o.entities.entities[a.targetEntityId];if(!u||u.buildingType!=="storageSpot"||!u.isConstructed)return o.autopilotControls.activeAutopilotAction=void 0,E.FAILURE;const c=u.storageCapacity??0;return(((s=u.storedFood)==null?void 0:s.length)??0)>=c||t.leaderId!==u.ownerId||t.food.length===0?(o.autopilotControls.activeAutopilotAction=void 0,E.FAILURE):V(t.position,u.position,o.mapDimensions.width,o.mapDimensions.height)<=Cn?(t.activeAction="depositing",t.target=void 0,o.autopilotControls.activeAutopilotAction=void 0,E.SUCCESS):(t.activeAction="moving",t.target=u.id,t.direction=Bt(t.position,u.position,o.mapDimensions),E.RUNNING)}case ce.AutopilotRetrieve:{const u=o.entities.entities[a.targetEntityId];return!u||u.buildingType!=="storageSpot"||!u.isConstructed||!u.storedFood||u.storedFood.length===0||t.leaderId!==u.ownerId||t.food.length>=t.maxFood?(o.autopilotControls.activeAutopilotAction=void 0,E.FAILURE):V(t.position,u.position,o.mapDimensions.width,o.mapDimensions.height)<=Cn?(t.activeAction="retrieving",t.target=void 0,o.autopilotControls.activeAutopilotAction=void 0,E.SUCCESS):(t.activeAction="moving",t.target=u.id,t.direction=Bt(t.position,u.position,o.mapDimensions),E.RUNNING)}case ce.AutopilotFollowMe:{const u=o.entities.entities[a.targetEntityId];return!u||u.type!=="human"||u.id!==u.leaderId?(o.autopilotControls.activeAutopilotAction=void 0,E.FAILURE):V(t.position,u.position,o.mapDimensions.width,o.mapDimensions.height)<=Rv?(o.autopilotControls.activeAutopilotAction=void 0,t.activeAction==="moving"&&(t.activeAction="idle"),E.SUCCESS):(t.activeAction="moving",t.target=u.id,t.direction=Bt(t.position,u.position,o.mapDimensions),E.RUNNING)}default:return o.autopilotControls.activeAutopilotAction=void 0,E.FAILURE}},"Execute Player Command",e+1)],"Player Command Handler",e)}function V1(e){return new pe([new J(t=>!!t.leaderId&&t.leaderId!==t.id,"Is Follower",e+1),new J((t,i)=>{if(!t.leaderId)return!1;const o=i.gameState.entities.entities[t.leaderId];return!!o&&o.isCallingToFollow===!0},"Is Leader Calling To Follow",e+1),new J(t=>t.hunger<DI,"Is Not Critically Hungry",e+1),new ie((t,i)=>{if(!t.leaderId)return E.FAILURE;const o=i.gameState.entities.entities[t.leaderId];return o?V(t.position,o.position,i.gameState.mapDimensions.width,i.gameState.mapDimensions.height)>NI?(t.activeAction="moving",t.target=o.id,t.direction=Bt(t.position,o.position,i.gameState.mapDimensions),E.RUNNING):(t.activeAction==="moving"&&t.target===o.id&&(t.activeAction="idle",t.target=void 0),E.SUCCESS):E.FAILURE},"Execute Follow Leader",e+1)],"Follow Leader Command",e)}const M0="tribeMigrationCheckCooldown";function X1(e){const t=new pe([new J(o=>!!o.leaderId&&o.leaderId===o.id,"Is Tribe Leader",e+2),new J((o,a)=>{const s=C.get(o.aiBlackboard,M0);return s?a.gameState.time-s>=Wm:!0},"Is Migration Check Cooldown Over",e+2),new ie((o,a)=>{o.aiBlackboard&&C.set(o.aiBlackboard,M0,a.gameState.time);const s=iC(o,a.gameState);return s?(o.isCallingToFollow=!0,o.callToFollowEndTime=a.gameState.time+ya,o.target=s,o.activeAction="moving",E.SUCCESS):E.FAILURE},"Execute Tribe Migration",e+2)],"Tribe Migration Strategy",e+1),i=new Ii(t,sa,"Cache Tribe Migration",e+1);return new cr(Wm,i,"Tribe Migration Cooldown",e)}function K1(e){const t=new J(o=>o.id===o.leaderId,"Is Leader?",e+1),i=new ie((o,a)=>{var g,m,v,T;const{gameState:s}=a,u=jo(o.id,s),c=_u(u),f=xv(s).filter(A=>A.leaderId!==o.id);for(const A of f){const I=jo(A.leaderId,s),y=_u(I),w=((m=(g=o.tribeControl)==null?void 0:g.diplomacy)==null?void 0:m[A.leaderId])||Dt.Friendly;c>y*VI?w!==Dt.Hostile&&((v=o.tribeControl)!=null&&v.diplomacy)&&(o.tribeControl.diplomacy[A.leaderId]=Dt.Hostile):w!==Dt.Friendly&&((T=o.tribeControl)!=null&&T.diplomacy)&&(o.tribeControl.diplomacy[A.leaderId]=Dt.Friendly)}return E.SUCCESS},"Evaluate Diplomacy",e+2);return new pe([t,new cr(xI,i,"Diplomacy Cooldown",e+1)],"Manage Diplomacy",e)}const Ks="huntTarget";function Z1(e){return new pe([new Ii(new J((i,o,a)=>{if(!i.isAdult)return[!1,"Not an adult"];if(!i.leaderId)return[!1,"Not in a tribe"];if(!Zo(i,we.Hunter,o.gameState))return[!1,"Not a Hunter"];const s=Me(i.position,o.gameState,"prey",RI,()=>!0);return s?(C.set(a,Ks,s.id),[!0,"Found prey"]):[!1,"No suitable prey found"]},"Find Prey Target",e+2),GI,"Cache Find Prey",e+1),new ur(new Nu(new ie((i,o,a)=>{if(!i.leaderId)return E.FAILURE;const s=C.get(a,Ks);if(!s)return E.FAILURE;const u=o.gameState.entities.entities[s];if(!u||u.hitpoints<=0)return C.delete(a,Ks),i.activeAction="idle",i.attackTargetId=void 0,E.SUCCESS;const{gameState:c}=o,f=ar(i.leaderId,c);return V(i.position,f,c.mapDimensions.width,c.mapDimensions.height)>PI?(C.delete(a,Ks),i.activeAction="idle",i.attackTargetId=void 0,E.FAILURE):(i.activeAction="attacking",i.attackTargetId=u.id,E.RUNNING)},"Hunt Prey Action",e+3),kf,"Hunt Prey Timeout",e+2),{taskType:"hunt",maxCapacity:Ih,getTargetId:(i,o,a)=>C.get(a,Ks)??null},"Tribal Hunt Task",e+1)],"Human Hunt Prey Sequence",e)}const su="defendTarget",df=150;function q1(e){return new pe([new J((t,i,o)=>{if(!t.isAdult)return[!1,"Not an adult - children flee instead"];if(t.hitpoints<=t.maxHitpoints*.3)return[!1,"Too injured to defend"];const{gameState:a}=i;if(t.activeAction==="attacking"&&t.attackTargetId){const u=a.entities.entities[t.attackTargetId];if(u&&u.type==="predator"&&u.hitpoints>0&&V(t.position,u.position,a.mapDimensions.width,a.mapDimensions.height)<=df)return C.set(o,su,u.id),[!0,"Continuing defense"]}const s=Me(t,a,"predator",df,u=>u.hitpoints>0&&(u.isAdult||!1));if(s){const u=V(t.position,s.position,a.mapDimensions.width,a.mapDimensions.height),c=s.attackTargetId===t.id,f=u<80;if(c||f)return C.set(o,su,s.id),[!0,"Predator threat detected"]}return C.set(o,su,void 0),[!1,"No predator threat"]},"Detect Predator Threat",e+1),new ie((t,i,o)=>{const a=C.get(o,su),s=a&&i.gameState.entities.entities[a];if(!s)return E.FAILURE;const{gameState:u}=i,c=V(t.position,s.position,u.mapDimensions.width,u.mapDimensions.height);return t.hitpoints<t.maxHitpoints*.3?E.FAILURE:s.hitpoints<=0||c>df*1.5?(t.activeAction="idle",t.attackTargetId=void 0,E.SUCCESS):(t.activeAction="attacking",t.attackTargetId=s.id,E.RUNNING)},"Defend Against Predator",e+1)],"Human Defend Against Predator",e)}function Q1(e){const t=new ie((i,o)=>{if(!i.leaderId||!i.isAdult)return E.FAILURE;const a=o.gameState.entities.entities[i.leaderId];if(!a||!a.tribeControl)return E.FAILURE;if(i.id===a.id)return i.tribeRole!==we.Leader&&(i.tribeRole=we.Leader),E.SUCCESS;const u=ri(a,o.gameState).filter(y=>y.id!==a.id),c=u.length;if(c===0)return E.SUCCESS;const f=a.tribeControl.roleWeights;let g=0;const m=[];for(const y of Object.values(we))y!==we.Leader&&(g+=f[y]||0,m.push(y));if(g===0)return i.tribeRole||(i.tribeRole=we.Gatherer),E.SUCCESS;const v={},T={},A={};for(const y of m)v[y]=0,T[y]=f[y]/g*c;for(const y of u)y.tribeRole&&y.tribeRole!==we.Leader&&(v[y.tribeRole]=(v[y.tribeRole]||0)+1);for(const y of m)A[y]=T[y]-v[y];let I=!1;if((!i.tribeRole||i.tribeRole===we.Leader||A[i.tribeRole]<-.5&&m.some(M=>A[M]>.5))&&(I=!0),I){let y=null,w=-1/0;const M=[...m].sort(()=>Math.random()-.5);for(const F of M){const N=A[F];N>w&&(w=N,y=F)}if(y)i.tribeRole=y;else{const F=Math.random()*g;let N=0;for(const b of m)if(N+=f[b],F<=N){i.tribeRole=b;break}}}return E.SUCCESS},"Assign Tribe Role",e+1);return new Ii(t,sa,"Cache Tribe Role Assignment",e)}function J1(e){return new pe([new J((t,i,o)=>{const a=Me(t,i.gameState,"predator",Vt*2,()=>!0),s=Me(t,i.gameState,"human",Vt*2,()=>!0);let u=null,c=1/0;if(a){const f=V(t.position,a.position,i.gameState.mapDimensions.width,i.gameState.mapDimensions.height);f<c&&(c=f,u=a)}if(s){const f=V(t.position,s.position,i.gameState.mapDimensions.width,i.gameState.mapDimensions.height);f<c&&(c=f,u=s)}return u&&c<Vt*1.5?(C.set(o,"fleeThreat",u.id),C.set(o,"fleeDistance",c),!0):!1},"Detect Threat",e+1),new ie((t,i,o)=>{const a=C.get(o,"fleeThreat"),s=a&&i.gameState.entities.entities[a];if(!s)return E.FAILURE;t.activeAction="moving";const u=Ye(s.position,t.position,i.gameState.mapDimensions.width,i.gameState.mapDimensions.height),c=lt(u),f=Bn(t.position,Ot(c,O_));return t.target={x:(f.x%i.gameState.mapDimensions.width+i.gameState.mapDimensions.width)%i.gameState.mapDimensions.width,y:(f.y%i.gameState.mapDimensions.height+i.gameState.mapDimensions.height)%i.gameState.mapDimensions.height},t.direction=c,t.fleeCooldown=i.gameState.time+2,E.RUNNING},"Execute Flee",e+1)],"Prey Flee",e)}function eR(e){return new pe([new J((t,i,o)=>{if(!t.isAdult)return[!1,"Not an adult"];if(t.hunger<=30||t.eatingCooldownTime&&t.eatingCooldownTime>i.gameState.time)return!1;const a=Me(t,i.gameState,"berryBush",Vt*10,s=>s.food.length>0);return a?V(t.position,a.position,i.gameState.mapDimensions.width,i.gameState.mapDimensions.height)<=Vt?(C.set(o,"grazingTarget",a.id),!0):(C.set(o,"grazingTarget",a.id),C.set(o,"needToMoveToTarget",!0),!0):!1},"Find Berry Bush",e+1),new ie((t,i,o)=>{const a=C.get(o,"grazingTarget"),s=a&&i.gameState.entities.entities[a],u=C.get(o,"needToMoveToTarget");if(!s)return E.FAILURE;const c=V(t.position,s.position,i.gameState.mapDimensions.width,i.gameState.mapDimensions.height);if(c<=Vt)return t.activeAction="grazing",t.target=s.id,t.direction={x:0,y:0},C.delete(o,"needToMoveToTarget"),E.RUNNING;if(u||c>Vt){t.activeAction="moving",t.target=s.id;const f=Bt(t.position,s.position,i.gameState.mapDimensions);return t.direction=f,E.RUNNING}return E.FAILURE},"Move to Bush or Graze",e+1)],"Prey Graze",e)}function tR(e){const t=new J((s,u,c)=>{const f=Me(s,u.gameState,"prey",Vt,g=>g.id!==s.id&&g.gender!==s.gender&&!!g.isAdult&&g.age>=da&&g.age<=nf&&!g.isPregnant&&(!g.procreationCooldown||g.procreationCooldown<=0)&&g.hunger<200);return f?(C.set(c,"procreationPartner",f.id),!0):!1},"Find Immediate Partner",e+2),i=new ie((s,u,c)=>{const f=C.get(c,"procreationPartner"),g=f&&u.gameState.entities.entities[f];return g?(s.activeAction="procreating",s.target=g.id,s.direction={x:0,y:0},C.delete(c,"procreationPartner"),E.SUCCESS):E.FAILURE},"Start Procreating",e+2),o=new J((s,u,c)=>{const f=Me(s,u.gameState,"prey",Vt*10,g=>g.id!==s.id&&g.gender!==s.gender&&!!g.isAdult&&g.age>=da&&g.age<=nf&&!g.isPregnant&&(!g.procreationCooldown||g.procreationCooldown<=0)&&g.hunger<200);return f?(C.set(c,"procreationPartner",f.id),!0):!1},"Locate Distant Partner",e+2),a=new ie((s,u,c)=>{const f=C.get(c,"procreationPartner"),g=f&&u.gameState.entities.entities[f];if(!g)return E.FAILURE;if(V(s.position,g.position,u.gameState.mapDimensions.width,u.gameState.mapDimensions.height)<=Vt)return E.SUCCESS;s.activeAction="moving",s.target=g.id;const v=Ye(s.position,g.position,u.gameState.mapDimensions.width,u.gameState.mapDimensions.height);return s.direction=lt(v),E.RUNNING},"Move Towards Partner",e+2);return new pe([new J(s=>!!(s.isAdult&&!s.isPregnant&&s.age>=da&&s.age<=nf&&s.hunger<200&&(!s.procreationCooldown||s.procreationCooldown<=0)),"Is Fertile and Ready",e+1),new Xt([new pe([t,i],"Procreate With Immediate Partner",e+2),new pe([o,a],"Seek Distant Partner",e+2)],"Find Partner And Procreate",e+1)],"Prey Procreate",e)}const nR=(e,t,i)=>{const o=t.gameState.search.prey.byProperty("motherId",e.id).filter(u=>!u.isAdult&&u.type==="prey");if(o.length===0)return E.FAILURE;let a=null,s=Wu;for(const u of o)u.hunger>=s&&(s=u.hunger,a=u);return a?(C.set(i,"targetChild",a.id),E.SUCCESS):E.FAILURE},iR=(e,t,i)=>{const o=C.get(i,"targetChild"),a=o&&t.gameState.entities.entities[o];return a?V(e.position,a.position,t.gameState.mapDimensions.width,t.gameState.mapDimensions.height)>is?(e.activeAction="moving",e.target=a.id,e.direction=Bt(e.position,a.position,t.gameState.mapDimensions),E.RUNNING):(e.activeAction="feeding",e.target=void 0,C.set(i,"targetChild",void 0),E.SUCCESS):E.FAILURE};function rR(e){return new pe([new J(t=>(t.isAdult&&t.gender==="female"&&t.hunger<80&&(!t.feedChildCooldownTime||t.feedChildCooldownTime<=0))??!1,"Can Feed Child (Female Only)",e+1),new ie(nR,"Find Hungriest Prey Child",e+1),new ie(iR,"Move To Child and Feed",e+1)],"Feed Prey Child",e)}function oR(e){return new pe([new J(t=>!t.isAdult&&t.hunger>=Wu,"Is Hungry Prey Child",e+1),new ie((t,i,o)=>{if(!t.motherId)return E.FAILURE;const a=i.gameState.entities.entities[t.motherId];return a?(C.set(o,"targetParent",a.id),E.SUCCESS):E.FAILURE},"Find Female Parent",e+1),new ie((t,i,o)=>{const a=C.get(o,"targetParent"),s=a&&i.gameState.entities.entities[a];if(!s)return E.FAILURE;const u=V(t.position,s.position,i.gameState.mapDimensions.width,i.gameState.mapDimensions.height);return t.activeAction="idle",u<=is?(t.target=void 0,E.SUCCESS):(t.target=s.id,t.activeAction="moving",E.RUNNING)},"Move To Female Parent",e+1)],"Seek Food From Female Parent",e)}const Zs="huntTarget";function sR(e,t,i){if(!(e!=null&&e.aiBlackboard))return!0;const o=`tribal_hunt_${t}`,a=C.get(e.aiBlackboard,o);return!a||i-a.startTime>Ko?!0:a.memberIds.length<(a.maxCapacity||Ih)}function aR(e,t){if(!(e!=null&&e.aiBlackboard))return 0;const i=`tribal_hunt_${t}`,o=C.get(e.aiBlackboard,i);return(o==null?void 0:o.memberIds.length)??0}function lR(e){return new pe([new J((t,i,o)=>{if(!t.isAdult)return[!1,"Not an adult"];if(t.hunger<=50||t.huntCooldown&&t.huntCooldown>0)return!1;const a=Me(t,i.gameState,"prey",No*10,s=>{if(s.hitpoints<=0)return!1;const u=Yr(t,i.gameState);return!(u&&!sR(u,s.id,i.gameState.time))});if(a){const s=V(t.position,a.position,i.gameState.mapDimensions.width,i.gameState.mapDimensions.height),u=Yr(t,i.gameState),c=u?aR(u,a.id):0;if(s<=No)return C.set(o,Zs,a.id),[!0,`Prey in range (${c} hunters)`];if(s<=No*10)return C.set(o,Zs,a.id),C.set(o,"needToApproach",!0),[!0,`Approaching prey (${c} hunters)`]}return!1},"Find Prey Target",e+1),new ur(new Nu(new ie((t,i,o)=>{const a=C.get(o,Zs),s=a&&i.gameState.entities.entities[a],u=C.get(o,"needToApproach");if(!s||s.hitpoints<=0)return C.delete(o,Zs),C.delete(o,"needToApproach"),E.SUCCESS;const c=V(t.position,s.position,i.gameState.mapDimensions.width,i.gameState.mapDimensions.height);if(c<=No)return t.activeAction="attacking",t.attackTargetId=s.id,t.target=s.id,t.direction={x:0,y:0},C.delete(o,"needToApproach"),E.RUNNING;if(u||c>No){t.activeAction="moving",t.target=s.id;const f=Ye(t.position,s.position,i.gameState.mapDimensions.width,i.gameState.mapDimensions.height);return t.direction=lt(f),E.RUNNING}return E.FAILURE},"Hunt or Approach Prey",e+3),10,"Hunt Timeout (10 hour)",e+2),{taskType:"hunt",maxCapacity:Ih,getTargetId:(t,i,o)=>C.get(o,Zs)},"Tribal Hunt Decorator",e+1)],"Predator Hunt",e)}function uR(e){return new pe([new J((t,i,o)=>{const a=t.hunger>100,s=t.hitpoints<t.maxHitpoints*.5;if(!a&&!s||t.attackCooldown&&t.attackCooldown>0)return!1;const u=Me(t,i.gameState,"human",Fn*2,c=>c.hitpoints>0);if(u){const c=V(t.position,u.position,i.gameState.mapDimensions.width,i.gameState.mapDimensions.height);if(c<=Fn)return C.set(o,"attackTarget",u.id),!0;if(a&&c<=Fn*2)return C.set(o,"attackTarget",u.id),C.set(o,"needToApproach",!0),!0}return!1},"Find Human Target",e+1),new ie((t,i,o)=>{const a=C.get(o,"attackTarget"),s=a&&i.gameState.entities.entities[a],u=C.get(o,"needToApproach");if(!s||s.hitpoints<=0)return E.FAILURE;const c=V(t.position,s.position,i.gameState.mapDimensions.width,i.gameState.mapDimensions.height);if(c<=Fn)return t.activeAction="attacking",t.attackTargetId=s.id,t.target=s.id,t.direction={x:0,y:0},C.delete(o,"needToApproach"),E.RUNNING;if(u||c>Fn){t.activeAction="moving",t.target=s.id;const f=Ye(t.position,s.position,i.gameState.mapDimensions.width,i.gameState.mapDimensions.height);return t.direction=lt(f),E.RUNNING}return E.FAILURE},"Attack or Approach Human",e+1)],"Predator Attack Human",e)}function cR(e){const t=new J((s,u,c)=>{const f=Me(s,u.gameState,"predator",rr,g=>g.id!==s.id&&g.gender!==s.gender&&!!g.isAdult&&g.age>=fa&&g.age<=rf&&!g.isPregnant&&(!g.procreationCooldown||g.procreationCooldown<=0)&&g.hunger<200);return f?(C.set(c,"procreationPartner",f.id),!0):!1},"Find Immediate Partner",e+2),i=new ie((s,u,c)=>{const f=C.get(c,"procreationPartner"),g=f&&u.gameState.entities.entities[f];return g?(s.activeAction="procreating",s.target=g.id,s.direction={x:0,y:0},C.delete(c,"procreationPartner"),E.SUCCESS):E.FAILURE},"Start Procreating",e+2),o=new J((s,u,c)=>{const f=Me(s,u.gameState,"predator",rr*10,g=>g.id!==s.id&&g.gender!==s.gender&&!!g.isAdult&&g.age>=fa&&g.age<=rf&&!g.isPregnant&&(!g.procreationCooldown||g.procreationCooldown<=0)&&g.hunger<200);return f?(C.set(c,"procreationPartner",f.id),!0):!1},"Locate Distant Partner",e+2),a=new ie((s,u,c)=>{const f=C.get(c,"procreationPartner"),g=f&&u.gameState.entities.entities[f];if(!g)return E.FAILURE;if(V(s.position,g.position,u.gameState.mapDimensions.width,u.gameState.mapDimensions.height)<=rr)return E.SUCCESS;s.activeAction="moving",s.target=g.id;const v=Ye(s.position,g.position,u.gameState.mapDimensions.width,u.gameState.mapDimensions.height);return s.direction=lt(v),E.RUNNING},"Move Towards Partner",e+2);return new pe([new J(s=>!!(s.isAdult&&!s.isPregnant&&s.age>=fa&&s.age<=rf&&s.hunger<200&&(!s.procreationCooldown||s.procreationCooldown<=0)),"Is Fertile and Ready",e+1),new Xt([new pe([t,i],"Procreate With Immediate Partner",e+2),new pe([o,a],"Seek Distant Partner",e+2)],"Find Partner And Procreate",e+1)],"Predator Procreate",e)}const dR=(e,t,i)=>{const o=t.gameState.search.predator.byProperty("motherId",e.id).filter(u=>!u.isAdult&&u.type==="predator");if(o.length===0)return E.FAILURE;let a=null,s=Wu;for(const u of o)u.hunger>=s&&(s=u.hunger,a=u);return a?(C.set(i,"targetChild",a.id),E.SUCCESS):E.FAILURE},fR=(e,t,i)=>{const o=C.get(i,"targetChild"),a=o&&t.gameState.entities.entities[o];return a?V(e.position,a.position,t.gameState.mapDimensions.width,t.gameState.mapDimensions.height)>is?(e.activeAction="moving",e.target=a.id,e.direction=Bt(e.position,a.position,t.gameState.mapDimensions),E.RUNNING):(e.activeAction="feeding",e.target=void 0,C.set(i,"targetChild",void 0),E.SUCCESS):E.FAILURE};function hR(e){return new pe([new J(t=>(t.isAdult&&t.gender==="female"&&t.hunger<90&&(!t.feedChildCooldownTime||t.feedChildCooldownTime<=0))??!1,"Can Feed Child (Female Only)",e+1),new ie(dR,"Find Hungriest Predator Child",e+1),new ie(fR,"Move To Child and Feed",e+1)],"Feed Predator Child",e)}function gR(e){return new pe([new J(t=>!t.isAdult&&t.hunger>=Wu,"Is Hungry Predator Child",e+1),new ie((t,i,o)=>{if(!t.motherId)return E.FAILURE;const a=i.gameState.entities.entities[t.motherId];return a?(C.set(o,"targetParent",a.id),E.SUCCESS):E.FAILURE},"Find Female Parent",e+1),new ie((t,i,o)=>{const a=C.get(o,"targetParent"),s=a&&i.gameState.entities.entities[a];if(!s)return E.FAILURE;const u=V(t.position,s.position,i.gameState.mapDimensions.width,i.gameState.mapDimensions.height);return t.activeAction="idle",u<=is?(t.target=void 0,E.SUCCESS):(t.target=s.id,t.activeAction="moving",E.RUNNING)},"Move To Female Parent",e+1)],"Seek Food From Female Parent",e)}function PS(e){return new ie((t,i,o)=>{t.activeAction="idle";let a=C.get(o,"wanderTarget"),s=C.get(o,"wanderStartTime");const u=i.gameState.time;if(!a||!s||u-s>2){const c=Math.random()*2*Math.PI,f=50+Math.random()*100,g={x:Math.cos(c),y:Math.sin(c)},m=Bn(t.position,Ot(g,f));a={x:(m.x%i.gameState.mapDimensions.width+i.gameState.mapDimensions.width)%i.gameState.mapDimensions.width,y:(m.y%i.gameState.mapDimensions.height+i.gameState.mapDimensions.height)%i.gameState.mapDimensions.height},C.set(o,"wanderTarget",a),C.set(o,"wanderStartTime",u)}if(a){t.target=a;let c=a.x-t.position.x,f=a.y-t.position.y;const g=i.gameState.mapDimensions.width,m=i.gameState.mapDimensions.height;Math.abs(c)>g/2&&(c=c>0?c-g:c+g),Math.abs(f)>m/2&&(f=f>0?f-m:f+m);const v=lt({x:c,y:f});t.direction=v}return E.SUCCESS},"Animal Wander",e)}function pR(e){return new pe([new J((t,i,o)=>{if(t.hunger>90||t.hitpoints<t.maxHitpoints*.3||t.activeAction==="grazing"||t.activeAction==="procreating")return!1;const a=Object.values(i.gameState.entities.entities),s=[];for(const u of a)if(u.type==="prey"&&u.id!==t.id){const c=u;c.hitpoints>0&&c.isAdult&&V(t.position,c.position,i.gameState.mapDimensions.width,i.gameState.mapDimensions.height)<=Vt*5&&s.push(c)}if(s.length>=2){let u=0,c=0;for(const m of s)u+=m.position.x,c+=m.position.y;u/=s.length,c/=s.length;const f={x:u,y:c};if(V(t.position,f,i.gameState.mapDimensions.width,i.gameState.mapDimensions.height)>Vt*2)return C.set(o,"herdCenter",f),C.set(o,"herdSize",s.length),!0}return!1},"Find Herd",e+1),new ie((t,i,o)=>{const a=C.get(o,"herdCenter");if(!a)return E.FAILURE;if(V(t.position,a,i.gameState.mapDimensions.width,i.gameState.mapDimensions.height)>Vt*2){t.activeAction="moving",t.target=a;const u=Ye(t.position,a,i.gameState.mapDimensions.width,i.gameState.mapDimensions.height);return t.direction=lt(u),E.RUNNING}else return t.activeAction="idle",t.direction={x:0,y:0},E.SUCCESS},"Join Herd",e+1)],"Prey Herd Behavior",e)}function mR(e){return new pe([new J((t,i,o)=>{if(t.hunger>100||t.hitpoints<t.maxHitpoints*.4||t.activeAction==="attacking"||t.activeAction==="procreating")return!1;const a=Me(t,i.gameState,"predator",rr*4,s=>s.id!==t.id&&s.hitpoints>0&&s.isAdult&&t.fatherId!==void 0&&s.fatherId===t.fatherId&&s.age>=t.age||s.hitpoints>t.hitpoints);return a&&V(t.position,a.position,i.gameState.mapDimensions.width,i.gameState.mapDimensions.height)>rr*2?(C.set(o,"packLeader",a.id),!0):!1},"Find Pack Leader",e+1),new ie((t,i,o)=>{const a=C.get(o,"packLeader"),s=a&&i.gameState.entities.entities[a];if(!s||s.hitpoints<=0)return E.FAILURE;if(V(t.position,s.position,i.gameState.mapDimensions.width,i.gameState.mapDimensions.height)>rr*2){t.activeAction="moving",t.target=s.id;const c=Ye(t.position,s.position,i.gameState.mapDimensions.width,i.gameState.mapDimensions.height);return t.direction=lt(c),E.RUNNING}else return t.activeAction="idle",t.direction={x:0,y:0},E.SUCCESS},"Follow Pack Leader",e+1)],"Predator Pack Behavior",e)}function vR(e){return new pe([new J((t,i,o)=>{if(!t.isAdult||t.hitpoints<t.maxHitpoints*.6||t.hunger>120||t.attackCooldown&&t.attackCooldown>0)return!1;const a=Me(t,i.gameState,"predator",C0,s=>!!(s.id!==t.id&&s.hitpoints>0&&s.isAdult&&t.fatherId!==s.fatherId&&t.gender===s.gender&&t.fatherId!==void 0&&s.fatherId!==void 0));if(a){const s=V(t.position,a.position,i.gameState.mapDimensions.width,i.gameState.mapDimensions.height);if(s<=Fn)return C.set(o,"territorialTarget",a.id),!0;if(s<=C0)return C.set(o,"territorialTarget",a.id),C.set(o,"needToApproach",!0),!0}return!1},"Find Territorial Rival",e+1),new ie((t,i,o)=>{const a=C.get(o,"territorialTarget"),s=a&&i.gameState.entities.entities[a],u=C.get(o,"needToApproach");if(!s||s.hitpoints<=0)return E.FAILURE;const c=V(t.position,s.position,i.gameState.mapDimensions.width,i.gameState.mapDimensions.height);if(c<=Fn)return t.activeAction="attacking",t.attackTargetId=s.id,t.target=s.id,t.direction={x:0,y:0},C.delete(o,"needToApproach"),E.RUNNING;if(u||c>Fn){t.activeAction="moving",t.target=s.id;const f=Ye(t.position,s.position,i.gameState.mapDimensions.width,i.gameState.mapDimensions.height);return t.direction=lt(f),E.RUNNING}return E.FAILURE},"Territorial Fight or Approach",e+1)],"Predator Territorial Defense",e)}function SR(){const e=new Xt([m1(2),W1(2),new Tn(q1(2),"attack","Gated Defend Against Predator",2),new Tn($1(2),"attack","Gated Jealousy Attack",2),new Tn(z1(2),"attack","Gated Desperate Attack",2),j1(2),new d1(new f1(Q1(4),"Role Assignment Success",3),"Role Assignment Gate",2),new Ao(L1(3),"Gated Leader Combat Strategy",2),new Ao(K1(3),"Gated Diplomacy",2),new Ao(new Xt([new Ii(H1(5),sa,"Cache Take Over Building",4),new Ii(b1(5),sa,"Cache Remove Enemy Building",4)],"Building Interaction Selector",3),"Gated Leader Building Interactions",2),new Tn(new Ii(B1(4),gE,"Cache Building Placement",3),"build","Gated Leader Building Placement",2),U1(2),F1(2),new Tn(C1(3),"attack","Gated Attacking",2),p1(2),k1(2),new Tn(E1(3),"procreation","Gated Procreation",2),new Nu(new Tn(T1(4),"gathering","Gated Gathering",3),kf,"Timeout Gathering",2),new Tn(M1(3),"gathering","Gated Storage Deposit",2),new Tn(R1(3),"feedChildren","Gated Feed Child",2),P1(2),new Nu(new Tn(O1(4),"planting","Gated Planting",3),kf,"Timeout Planting",2),new Tn(Z1(3),"attack","Gated Hunt Prey",2),new Ii(x1(3),sa,"Cache Tribe Split",2),new Ao(X1(3),"Gated Tribe Migration",2),new Tn(V1(3),"followLeader","Gated Follow Leader",2),new Ao(G1(2),"Gated Follow Patriarch",2),new Ao(I1(2),"Gated Idle Wander",2)],"AI Root Selector",1);return new h1(e,"Manual Control Gate",0)}const NS=SR();function yR(e,t){e.aiBlackboard&&C.cleanupOldEntries(e.aiBlackboard,t.gameState.time);const i=Yr(e,t.gameState);i&&i.id===e.id&&i.aiBlackboard&&g1(i,t.gameState.time);const o=performance.now();switch(e.aiType){case Oa.BehaviorTreeBased:default:Th(e,t,NS);break}t.gameState.performanceMetrics.currentBucket.aiUpdateTime+=performance.now()-o}function AR(){return new Xt([J1(1),rR(1),oR(1),eR(1),tR(1),pR(1),PS(1)],"Prey Behavior Root",0)}function TR(){return new Xt([lR(1),uR(1),hR(1),gR(1),vR(1),cR(1),mR(1),PS(1)],"Predator Behavior Root",0)}const DS=AR();function IR(e,t){e.aiBlackboard?Th(e,t,DS):(console.warn(`Behavior Tree AI ticked for prey ${e.id}, but the tree or blackboard was missing.`),e.activeAction="idle")}const OS=TR();function ER(e,t){e.aiBlackboard?Th(e,t,OS):(console.warn(`Behavior Tree AI ticked for predator ${e.id}, but the tree or blackboard was missing.`),e.activeAction="idle")}function CR(e,t){const{gameState:i,deltaTime:o}=t,a=o*(Ct/wt);if(e.isBeingDestroyed){const s=Kw(e.buildingType);if(s>0?e.destructionProgress+=a/s:e.destructionProgress=1,e.destructionProgress>=1){os(i.entities,e.id);return}}if(!e.isConstructed&&!e.isBeingDestroyed){const s=Xw(e.buildingType);s>0?e.constructionProgress+=a/s:e.constructionProgress=1,e.constructionProgress>=1&&(e.constructionProgress=1,e.isConstructed=!0)}}function wR(e,t){e.forces.push(Ot(e.velocity,-.1));const i=Ot(lt(e.direction),e.acceleration);e.forces.push(i),e.debuffs.forEach(o=>{t.gameState.time-o.startTime<o.duration&&o.type==="slow"&&(e.velocity=Ot(e.velocity,.5))}),e.debuffs=e.debuffs.filter(o=>t.gameState.time-o.startTime<o.duration),e.velocity=Bn(e.velocity,e.forces.reduce(Bn,{x:0,y:0})),Yo(e.velocity)<.001&&(e.velocity={x:0,y:0}),e.position=Bn(e.position,Ot(e.velocity,t.deltaTime)),e.position.x=(e.position.x%t.gameState.mapDimensions.width+t.gameState.mapDimensions.width)%t.gameState.mapDimensions.width,e.position.y=(e.position.y%t.gameState.mapDimensions.height+t.gameState.mapDimensions.height)%t.gameState.mapDimensions.height,e.forces=[],e.type==="human"?o1(e,t,t.deltaTime):e.type==="corpse"?s1(e,t):e.type==="prey"?a1(e,t,t.deltaTime):e.type==="predator"?l1(e,t,t.deltaTime):e.type==="building"&&CR(e,t),e.type==="human"&&yR(e,t),e.type==="prey"?IR(e,t):e.type==="predator"&&ER(e,t),e.stateMachine&&(e.stateMachine=r1(...e.stateMachine,{entity:e,updateContext:t}))}function _R(e){const t=e.gameState.entities;Object.values(t.entities).forEach(i=>{wR(i,e)})}function MS(){return{entities:{},nextEntityId:1}}function rs(e,t,i){const o={id:e.nextEntityId++,type:t,velocity:{x:0,y:0},direction:{x:0,y:0},acceleration:0,forces:[],debuffs:[],...i};return e.entities[o.id]=o,o}function Ma(e,t,i){return rs(e,"berryBush",{position:t,radius:Of,food:Array.from({length:SI},()=>({type:Hn.Berry})).map(a=>({...a,id:e.nextEntityId++})),maxFood:vI,lifespan:AI,age:0,spreadRadius:Of,timeSinceLastBerryRegen:0,timeSinceLastSpreadAttempt:0,timeSinceLastHarvest:0,stateMachine:[oa,{enteredAt:i,previousState:void 0}]})}function Ho(e,t,i,o,a=!1,s=TE,u=Lv,c,f,g=[],m,v){const T=s>=th;return rs(e,"human",{position:t,radius:T?_t:ts,hunger:u,hitpoints:e0,maxHitpoints:e0,age:s,gender:o,isPlayer:a,food:[],maxFood:Fv,maxAge:Sa,isAdult:T,isPregnant:!1,gestationTime:0,procreationCooldown:0,attackCooldown:0,motherId:c,fatherId:f,ancestorIds:g,stateMachine:[ft,{enteredAt:i,previousState:void 0}],leaderId:m,tribeBadge:v,aiType:Oa.BehaviorTreeBased,aiBlackboard:C.create()})}function Ch(e,t,i,o,a,s,u,c,f,g,m){let v,T;switch(u){case"human":v=Bv,T=Wr;break;case"prey":v=2,T=120;break;case"predator":v=4,T=140;break}return rs(e,"corpse",{position:t,radius:a,gender:i,age:o,originalEntityId:s,originalEntityType:u,timeOfDeath:c,decayProgress:0,geneCode:m,food:[...Array.from({length:Math.max(v*Math.max(T-g,0)/T,0)},()=>({type:Hn.Meat})),...f].map(I=>({...I,id:e.nextEntityId++})),stateMachine:void 0})}function RR(e,t,i,o,a,s,u,c,f){return Ch(e,t,i,o,a,s,"human",u,c,f)}function PR(e,t,i,o,a,s,u,c){return Ch(e,t,i,o,a,s,"prey",u,[],0,c)}function NR(e,t,i,o,a,s,u,c){return Ch(e,t,i,o,a,s,"predator",u,[],0,c)}function DR(e,t,i){const o=t?i.gameState.entities.entities[t]:void 0,a=[...e.ancestorIds||[],e.id],s=o?[...o.ancestorIds||[],o.id]:[],u=[...a,...s],c=[...new Set(u)],f=c.slice(Math.max(c.length-vE,0)),g=Math.random()<.5?"male":"female",m=Bn(e.position,{x:5,y:5}),v=Ho(i.gameState.entities,m,i.gameState.time,g,!1,0,Lv/2,e.id,t,f,(o==null?void 0:o.leaderId)??e.leaderId,(o==null?void 0:o.tribeBadge)??e.tribeBadge);return _e(i,ge.Birth,e.position),v}function os(e,t){return e.entities[t]?(delete e.entities[t],!0):!1}function qo(e,t,i,o=D_,a=vS,s,u,c){const f=o>=da,g=Date.now();return rs(e,"prey",{position:t,radius:f?_t*.7:ts*.7,hunger:a,hitpoints:I0,maxHitpoints:I0,age:o,maxAge:mS,gender:i,isAdult:f,isPregnant:!1,gestationTime:0,procreationCooldown:0,geneCode:s,motherId:u,fatherId:c,stateMachine:[kn,{enteredAt:g,previousState:void 0}],aiType:Oa.BehaviorTreeBased,aiBlackboard:C.create()})}function Qo(e,t,i,o=H_,a=yS,s,u,c){const f=o>=fa,g=Date.now();return rs(e,"predator",{position:t,radius:f?_t*.9:ts*.9,hunger:a,hitpoints:E0,maxHitpoints:E0,age:o,maxAge:SS,gender:i,isAdult:f,isPregnant:!1,gestationTime:0,procreationCooldown:0,geneCode:s,motherId:u,fatherId:c,stateMachine:[jt,{enteredAt:g,previousState:void 0}],aiType:Oa.BehaviorTreeBased,aiBlackboard:C.create()})}function OR(e,t,i,o){const a=dS(i),s={position:t,radius:Math.max(a.width,a.height)/2,buildingType:i,ownerId:o,width:a.width,height:a.height,constructionProgress:0,destructionProgress:0,isConstructed:!1,isBeingDestroyed:!1};return rs(e,"building",{...s,...i===ni.StorageSpot&&{storedFood:[],storageCapacity:bw,lastDepositTime:0,lastRetrieveTime:0,lastStealTime:0}})}var Wt=(e=>(e.MOVE="MOVE",e.HUNGER="HUNGER",e.EAT="EAT",e.FIND_BUSH="FIND_BUSH",e.GATHER="GATHER",e.PROCREATE="PROCREATE",e.PLANT_BUSH="PLANT_BUSH",e.AUTOPILOT="AUTOPILOT",e.ANIMALS_INTRODUCTION="ANIMALS_INTRODUCTION",e.HUNT_PREY="HUNT_PREY",e.DEFEND_FROM_PREDATORS="DEFEND_FROM_PREDATORS",e))(Wt||{}),br=(e=>(e.HUNGER_BAR="HUNGER_BAR",e.FOOD_BAR="FOOD_BAR",e.COMMAND_BUTTONS="COMMAND_BUTTONS",e))(br||{}),zt=(e=>(e[e.FADING_IN=0]="FADING_IN",e[e.ACTIVE=1]="ACTIVE",e[e.FADING_OUT=2]="FADING_OUT",e[e.INACTIVE=3]="INACTIVE",e))(zt||{});const Hf={},bf={},MR=[{key:Wt.MOVE,title:"Movement",text:"Use WASD or Arrow Keys to move your character around the world.",condition:e=>e.hasPlayerMovedEver||e.hasPlayerEnabledAutopilot>2,isCompleted:!1},{key:Wt.HUNGER,title:"Hunger",text:"Your character gets hungry over time. Watch the hunger bar!",condition:(e,t)=>t.hunger>SE,isCompleted:!1,minDisplayTime:g0,highlightedUIElements:[br.HUNGER_BAR]},{key:Wt.FIND_BUSH,title:"Find Food",text:"Look for berry bushes. They are your primary source of food.",condition:(e,t)=>!!Me(t,e,"berryBush",yt*5,o=>o.food.length>0),getTargets:(e,t)=>{const i=[];for(const o of Object.values(e.entities.entities))o.type==="berryBush"&&o.food.length>0&&V(t.position,o.position,e.mapDimensions.width,e.mapDimensions.height)<500&&i.push(o);return i.map(o=>o.id)},isCompleted:!1,minDisplayTime:g0},{key:Wt.GATHER,title:"Gather Berries",text:"Get close to a bush and press 'E' to gather berries.",condition:(e,t)=>t.food.length>0,getTargets:(e,t)=>{const i=Me(t,e,"berryBush",yt,o=>o.food.length>0);return i?[i.id]:[]},isCompleted:!1},{key:Wt.EAT,title:"Eat",text:"When you are hungry and have food, press 'F' to eat.",condition:(e,t)=>t.activeAction==="eating",isCompleted:!1,highlightedUIElements:[br.FOOD_BAR]},{key:Wt.PROCREATE,title:"Procreate",text:"Find a mate and press 'R' to start a family. This is how you continue your lineage.",condition:(e,t)=>dn(e,t).length>0,getTargets:(e,t)=>{const i=Me(t,e,"human",yt,o=>jr(t,o,e));return i?[i.id]:[]},isCompleted:!1},{key:Wt.PLANT_BUSH,title:"Farming",text:"You can plant new berry bushes. Carry some berries and press 'B' to plant.",condition:(e,t)=>vh(e,t).some(o=>o.type===ce.Plant)||e.hasPlayerPlantedBush===!0,isCompleted:!1},{key:Wt.AUTOPILOT,title:"Autopilot!",text:"You can turn autopilot for specific actions, press Shift and click on the action button to enable it.",condition:e=>e.hasPlayerEnabledAutopilot>2,highlightedUIElements:[br.COMMAND_BUTTONS],isCompleted:!1},{key:Wt.ANIMALS_INTRODUCTION,title:"Wild Animals!",text:"Your world now has wild animals! Prey provide meat when hunted, but beware of predators that may attack.",condition:e=>Object.values(e.entities.entities).some(i=>i.type==="prey"||i.type==="predator"),isCompleted:!1,dependsOn:Wt.AUTOPILOT},{key:Wt.HUNT_PREY,title:"Hunt for Meat",text:"Click on prey animals to hunt them for meat. Hunting provides more food than gathering berries!",condition:(e,t)=>{const i=Me(t,e,"prey",150);return t.hunger>40&&!!i},getTargets:(e,t)=>{const i=Me(t,e,"prey",150);return i?[i.id]:[]},isCompleted:!1,dependsOn:Wt.ANIMALS_INTRODUCTION},{key:Wt.DEFEND_FROM_PREDATORS,title:"Predators",text:"Predators may attack when hungry! Click on them to fight back. Fighting together with family is more effective.",condition:(e,t)=>!!Me(t,e,"predator",120),getTargets:(e,t)=>{const i=Me(t,e,"predator",120);return i?[i.id]:[]},isCompleted:!1,dependsOn:Wt.HUNT_PREY}].map(e=>({...e,condition:e.condition?LR(e.condition):void 0,getTargets:e.getTargets?UR(e.getTargets):void 0}));function kS(){return{steps:MR.map(e=>({...e,isCompleted:!1}))}}function FS(){return{currentStepIndex:0,completedSteps:[],isActive:!0,transitionState:zt.FADING_IN,transitionAlpha:0,highlightedEntityIds:[],stepStartTime:null,activeUIHighlights:[]}}function kR(e){for(let t=0;t<e.tutorial.steps.length;t++){const i=e.tutorial.steps[t];if(!i.isCompleted)if(i.dependsOn){if(e.tutorialState.completedSteps.includes(i.dependsOn))return t}else return t}return null}function FR(e,t){const i=e.tutorialState;if(!i.isActive){i.transitionState=zt.INACTIVE,i.highlightedEntityIds=[],i.activeUIHighlights=[];return}const o=pt(e);if(!o){i.isActive=!1,i.transitionState=zt.INACTIVE,i.highlightedEntityIds=[],i.activeUIHighlights=[];return}const a=e.tutorial.steps[i.currentStepIndex];if(!a){i.isActive=!1,i.transitionState=zt.INACTIVE,i.highlightedEntityIds=[],i.activeUIHighlights=[];return}const s=1/qC;switch(i.transitionState){case zt.FADING_IN:i.stepStartTime===null&&(i.stepStartTime=e.time),i.transitionAlpha+=s*t,i.transitionAlpha>=1&&(i.transitionAlpha=1,i.transitionState=zt.ACTIVE);break;case zt.ACTIVE:{const f=e.time-(i.stepStartTime||e.time)>=(a.minDisplayTime||0),g=Hf[a.condition];g&&f&&g(e,o)&&(a.isCompleted=!0,i.completedSteps.includes(a.key)||i.completedSteps.push(a.key),i.transitionState=zt.FADING_OUT);break}case zt.FADING_OUT:if(i.transitionAlpha-=s*t,i.transitionAlpha<=0){i.transitionAlpha=0,i.stepStartTime=null;const c=kR(e);c!==null?(i.currentStepIndex=c,i.transitionState=zt.FADING_IN):(i.isActive=!1,i.transitionState=zt.INACTIVE)}break}if(i.transitionState!==zt.FADING_OUT&&i.transitionState!==zt.INACTIVE){const c=bf[a.getTargets||""];c?i.highlightedEntityIds=[...c(e,o)]:i.highlightedEntityIds=[],a.highlightedUIElements?i.activeUIHighlights=[...a.highlightedUIElements]:i.activeUIHighlights=[]}else i.highlightedEntityIds=[],i.activeUIHighlights=[]}function LR(e){const t=`condition_${Object.keys(Hf).length+1}`;return Hf[t]=e,t}function UR(e){const t=`getTargets_${Object.keys(bf).length+1}`;return bf[t]=e,t}function BR(){const e=MS(),t=0;for(let v=0;v<_v;v++){const T={x:Math.random()*Ke,y:Math.random()*tt};Ma(e,T,t)}const i=Ke/2,o=tt/2,a=Ho(e,{x:i-25,y:o},t,"male",!0);Ho(e,{x:i+25,y:o},t,"female",!1);for(let v=0;v<5;v++){const T=v/5*Math.PI*2,A=Ke/2,I=tt/2,y={x:i+Math.cos(T)*A,y:o+Math.sin(T)*I};Ho(e,{x:y.x,y:y.y},t,"male",!1),Ho(e,{x:y.x+50,y:y.y},t,"female",!1)}for(let v=0;v<IS;v++){const T={x:i+Ke*(Math.random()-Math.random()),y:o+tt*(Math.random()-Math.random())};qo(e,T,"male",void 0,void 0,Ca()),qo(e,{x:T.x+20,y:T.y},"female",void 0,void 0,Ca())}const s={x:i+Ke*(Math.random()-Math.random()),y:o+tt*(Math.random()-Math.random())};Qo(e,s,"male",void 0,void 0,wa()),Qo(e,{x:s.x+20,y:s.y},"female",void 0,void 0,wa());const u=[{id:"muteButton",action:ne.ToggleMute,currentWidth:vi,rect:{x:0,y:0,width:0,height:0},text:"",backgroundColor:"",textColor:Yt},{id:"pauseButton",action:ne.TogglePause,currentWidth:vi,rect:{x:0,y:0,width:0,height:0},text:"",backgroundColor:"",textColor:Yt},{id:"returnToIntroButton",action:ne.ReturnToIntro,currentWidth:vi,rect:{x:0,y:0,width:0,height:0},text:"EXIT",backgroundColor:"",textColor:Yt}],c=kS(),f=FS(),g={time:t,entities:e,mapDimensions:{width:Ke,height:tt},generationCount:1,gameOver:!1,visualEffects:[],nextVisualEffectId:0,viewportCenter:{...a.position},isPaused:!1,exitConfirmation:"inactive",autopilotControls:{behaviors:{procreation:!1,planting:!1,gathering:!1,attack:!1,feedChildren:!0,followLeader:!1,build:!1},hoveredAutopilotAction:void 0,activeAutopilotAction:void 0,isManuallyMoving:!1},buildMenuOpen:!1,roleManagerOpen:!1,selectedBuildingType:null,selectedBuildingForRemoval:null,hasPlayerMovedEver:!1,hasPlayerPlantedBush:!1,hasPlayerEnabledAutopilot:0,masterVolume:uS,isMuted:!1,uiButtons:u,tutorial:c,tutorialState:f,debugPanel:je.None,performanceMetrics:{currentBucket:{renderTime:0,worldUpdateTime:0,aiUpdateTime:0},history:[]},hoveredButtonId:void 0,mousePosition:{x:0,y:0},notifications:[{id:"welcome",type:Aa.Hello,message:"Welcome to the game!",duration:50,targetEntityIds:[a.id],highlightedEntityIds:[a.id],timestamp:0,isDismissed:!1,creationTime:Date.now()}],ecosystem:{preyGestationPeriod:Fr,preyProcreationCooldown:Lr,predatorGestationPeriod:Ur,predatorProcreationCooldown:Br,preyHungerIncreasePerHour:er,predatorHungerIncreasePerHour:tr,berryBushSpreadChance:Ti},autosaveIntervalSeconds:5,lastAutosaveTime:Date.now()},m=Ou(g);return console.log("Game world initialized:",m),m}function HR(){const e=MS(),t=0;for(let u=0;u<_v;u++){const c={x:Math.random()*Ke,y:Math.random()*tt};Ma(e,c,t)}for(let u=0;u<gI;u++){const c={x:Math.random()*Ke,y:Math.random()*tt},f=Math.random()<.5?"male":"female";Ho(e,c,t,f,!1)}for(let u=0;u<IS;u++){const c={x:Math.random()*Ke,y:Math.random()*tt};qo(e,c,"male",void 0,void 0,Ca()),qo(e,{x:c.x+20,y:c.y},"female",void 0,void 0,Ca())}const i={x:Math.random()*Ke,y:Math.random()*tt};Qo(e,i,"male",void 0,void 0,wa()),Qo(e,{x:i.x+20,y:i.y},"female",void 0,void 0,wa());const o=kS(),a=FS(),s={time:t,entities:e,mapDimensions:{width:Ke,height:tt},generationCount:0,gameOver:!1,visualEffects:[],nextVisualEffectId:0,viewportCenter:{x:Ke/2,y:tt/2},isPaused:!1,exitConfirmation:"inactive",autopilotControls:{behaviors:{procreation:!1,planting:!1,gathering:!1,attack:!1,feedChildren:!0,followLeader:!1,build:!1},hoveredAutopilotAction:void 0,activeAutopilotAction:void 0,isManuallyMoving:!1},buildMenuOpen:!1,roleManagerOpen:!1,selectedBuildingType:null,selectedBuildingForRemoval:null,hasPlayerMovedEver:!1,hasPlayerPlantedBush:!1,hasPlayerEnabledAutopilot:0,masterVolume:uS,isMuted:!0,uiButtons:[],tutorial:o,tutorialState:a,debugPanel:je.None,performanceMetrics:{currentBucket:{renderTime:0,worldUpdateTime:0,aiUpdateTime:0},history:[]},hoveredButtonId:void 0,mousePosition:{x:0,y:0},notifications:[],ecosystem:{preyGestationPeriod:Fr,preyProcreationCooldown:Lr,predatorGestationPeriod:Ur,predatorProcreationCooldown:Br,preyHungerIncreasePerHour:er,predatorHungerIncreasePerHour:tr,berryBushSpreadChance:Ti},lastAutosaveTime:0};return Ou(s)}const bR="humanProcreation",GR="human",xR="human",$R=yt,WR=(e,t,i)=>jr(e,t,i.gameState)?e.gender==="male"?e.activeAction==="procreating":e.activeAction==="procreating"&&t.activeAction==="procreating":!1,zR=(e,t,i)=>{var f,g;const{gameState:o}=i,a={x:(e.position.x+t.position.x)/2,y:(e.position.y+t.position.y)/2},s=e.gender==="male"?e:t,u=e.gender==="female"?e:t,c=(s.partnerIds||[]).length===0;if(e.stateMachine=[Ia,{partnerId:t.id,previousState:(f=e.stateMachine)==null?void 0:f[0]}],t.stateMachine=[Ia,{partnerId:e.id,previousState:(g=t.stateMachine)==null?void 0:g[0]}],e.partnerIds||(e.partnerIds=[]),e.partnerIds.includes(t.id)||e.partnerIds.push(t.id),t.partnerIds||(t.partnerIds=[]),t.partnerIds.includes(e.id)||t.partnerIds.push(e.id),c&&s.leaderId&&s.leaderId!==s.id){const m=o.entities.entities[s.leaderId];if(m){const v=n0(s,m),T=n0(u,m);if(!v&&!T){const A=Lf();s.leaderId=s.id,s.tribeBadge=A,s.tribeRole=we.Leader,s.tribeControl={roleWeights:{gatherer:1,planter:1,hunter:1,mover:1,warrior:1,leader:0},diplomacy:{}},u.leaderId=s.id,u.tribeBadge=A}}}else if(!e.leaderId&&!t.leaderId&&s&&u){const m=Lf();s.leaderId=s.id,s.tribeBadge=m,s.tribeRole=we.Leader,s.tribeControl={roleWeights:{gatherer:1,planter:1,hunter:1,mover:1,warrior:1,leader:0},diplomacy:{}},u.leaderId=s.id,u.tribeBadge=m}e.activeAction=void 0,ke(o,he.Procreation,a,Ea),ke(o,he.Partnered,e.position,$e,e.id),ke(o,he.Partnered,t.position,$e,t.id),e.lastPartneredEffectTime=o.time,t.lastPartneredEffectTime=o.time,t.activeAction=void 0,_e(i,ge.Procreate,a)},YR={id:bR,sourceType:GR,targetType:xR,maxDistance:$R,checker:WR,perform:zR},jR={id:"humanChildFeeding",sourceType:"human",targetType:"human",maxDistance:ih,checker:(e,t)=>e.isAdult===!0&&e.food.length>0&&(!e.feedChildCooldownTime||e.feedChildCooldownTime<=0)&&t.isAdult===!1&&(t.motherId===e.id||t.fatherId===e.id)&&t.hunger>=sr&&e.activeAction==="feeding",perform:(e,t,i)=>{e.food.pop(),t.hunger=Math.max(0,t.hunger-sr),e.feedChildCooldownTime=NE,(!t.lastChildFedEffectTime||i.gameState.time-t.lastChildFedEffectTime>2)&&(ke(i.gameState,he.ChildFed,t.position,$e,t.id),t.lastChildFedEffectTime=i.gameState.time),_e(i,ge.ChildFed,t.position)}},VR={id:"human-attack",sourceType:"human",targetType:"human",maxDistance:ii,checker:(e,t,i)=>{var s;if(((s=e.stateMachine)==null?void 0:s[0])!==lr||e.attackTargetId!==t.id||(e.attackCooldown||0)>0)return!1;const o=e.stateMachine[1];return i.gameState.time-o.attackStartTime>=Hv},perform:(e,t,i)=>{const o=Ye(e.position,t.position,i.gameState.mapDimensions.width,i.gameState.mapDimensions.height),a=YE(lt(o),t.direction);if(Math.abs(a)<xE*Math.PI/180&&Math.random()<$E)ke(i.gameState,he.AttackDeflected,t.position,$e,t.id);else{let c=oh;e.gender==="male"&&(c*=HE),e.isAdult||(c*=bE),(!t.isAdult||t.age>=rh)&&e.isAdult&&(c*=GE),t.hitpoints-=c,t.movementSlowdown={modifier:sh,endTime:i.gameState.time+ah},ke(i.gameState,he.Hit,t.position,$e,t.id);const g=Ye(e.position,t.position,i.gameState.mapDimensions.width,i.gameState.mapDimensions.height),m=Ot(g,LE);t.forces.push(m),t.hitpoints<=0?_e(i,ge.HumanDeath,t.position):_e(i,ge.Attack,e.position)}e.attackCooldown=bu;const u=e.stateMachine[1];u.attackStartTime=i.gameState.time,ke(i.gameState,he.Attack,e.position,$e,e.id)}},XR={id:"human-collision",sourceType:"human",targetType:"human",maxDistance:_t*2,checker:(e,t,{gameState:i})=>V(e.position,t.position,i.mapDimensions.width,i.mapDimensions.height)<(e.radius+t.radius)/3,perform:(e,t,{gameState:i})=>{const o=V(e.position,t.position,i.mapDimensions.width,i.mapDimensions.height);if(o===0){e.forces.push({x:.1,y:0}),t.forces.push({x:-.1,y:0});return}const s=(e.radius+t.radius-o)*.05,u=lt(bv(e.position,t.position)),c=Ot(u,s);e.forces.push(c),t.forces.push(Ot(c,-1))}},KR={id:"humanBerryBushGather",sourceType:"human",targetType:"berryBush",maxDistance:yt,checker:(e,t,i)=>{var o;return e.isAdult&&t.food.length>0&&((o=e.stateMachine)==null?void 0:o[0])===Da&&e.food.length<e.maxFood&&(!e.gatheringCooldownTime||e.gatheringCooldownTime<i.gameState.time)||!1},perform:(e,t,i)=>{const o=t.food.pop();o&&e.food.push(o),e.gatheringCooldownTime=i.gameState.time+1,t.timeSinceLastHarvest=i.gameState.time,ke(i.gameState,he.BushClaimed,t.position,$e),_e(i,ge.Gather,e.position)}},ZR={id:"corpseGather",sourceType:"human",targetType:"corpse",maxDistance:yt,checker:(e,t,i)=>{var o;return e.isAdult&&t.food.length>0&&((o=e.stateMachine)==null?void 0:o[0])===Da&&e.food.length<e.maxFood&&(!e.gatheringCooldownTime||e.gatheringCooldownTime<i.gameState.time)||!1},perform:(e,t,i)=>{const o=t.food.pop();o&&e.food.push(o),e.gatheringCooldownTime=i.gameState.time+1,_e(i,ge.Gather,e.position)}},qR=[KR,ZR],QR={id:"prey-eat-berry-bush",sourceType:"prey",targetType:"berryBush",maxDistance:Vt,checker:(e,t,i)=>!!(e.isAdult&&t.food.length>0&&e.hunger>30&&(!e.eatingCooldownTime||e.eatingCooldownTime<i.gameState.time)),perform:(e,t,i)=>{t.food.pop()&&(e.hunger=Math.max(0,e.hunger-25),t.lifespan-=k_,t.timeSinceLastHarvest=i.gameState.time,e.eatingCooldownTime=i.gameState.time+M_,ke(i.gameState,he.BushClaimed,t.position,$e,e.id),_e(i,ge.Gather,e.position))}},JR={id:"predator-hunt-prey",sourceType:"predator",targetType:"prey",maxDistance:No,checker:(e,t,i)=>!!(e.isAdult&&e.hunger>50&&(!e.huntCooldown||e.huntCooldown<=0)&&t.hitpoints>0),perform:(e,t,i)=>{t.hitpoints-=b_;const o=Ye(e.position,t.position,i.gameState.mapDimensions.width,i.gameState.mapDimensions.height),a=Ot(o,8);t.forces.push(a),e.huntCooldown=$_,t.hitpoints<=0?(_e(i,ge.HumanDeath,t.position),ke(i.gameState,he.Hit,t.position,$e,t.id)):(ke(i.gameState,he.Hit,t.position,$e,t.id),t.fleeCooldown=5,_e(i,ge.Attack,e.position)),ke(i.gameState,he.Attack,e.position,$e,e.id)}},eP={id:"human-hunt-prey",sourceType:"human",targetType:"prey",maxDistance:ii,checker:(e,t,i)=>{var o;return!!(((o=e.stateMachine)==null?void 0:o[0])===lr&&e.attackTargetId===t.id&&(!e.attackCooldown||e.attackCooldown<=0)&&t.hitpoints>0&&e.isAdult)},perform:(e,t,i)=>{let o=oh*1.2;e.gender==="male"&&(o*=1.3),t.hitpoints-=o;const a=Ye(e.position,t.position,i.gameState.mapDimensions.width,i.gameState.mapDimensions.height),s=Ot(a,6);t.forces.push(s),e.attackCooldown=bu,t.hitpoints<=0?(_e(i,ge.HumanDeath,t.position),ke(i.gameState,he.Hit,t.position,$e,t.id)):(ke(i.gameState,he.Hit,t.position,$e,t.id),t.fleeCooldown=8,_e(i,ge.Attack,e.position)),ke(i.gameState,he.Attack,e.position,$e,e.id)}},tP={id:"predator-attack-human",sourceType:"predator",targetType:"human",maxDistance:Fn,checker:(e,t,i)=>{var o;return!!(e.isAdult&&(!e.attackCooldown||e.attackCooldown<=0)&&t.hitpoints>0&&(e.hunger>100||t.attackTargetId===e.id||t.attackTargetId&&((o=i.gameState.entities.entities[t.attackTargetId])==null?void 0:o.type)==="predator"))},perform:(e,t,i)=>{let o=AS;e.hunger>120&&(o*=1.3),t.hitpoints-=o,t.movementSlowdown={modifier:sh,endTime:i.gameState.time+ah};const a=Ye(e.position,t.position,i.gameState.mapDimensions.width,i.gameState.mapDimensions.height),s=Ot(a,7);t.forces.push(s),e.attackCooldown=TS,t.hitpoints<=0?(e.hunger=Math.max(0,e.hunger-Ah),_e(i,ge.HumanDeath,t.position),ke(i.gameState,he.Hit,t.position,$e,t.id)):(ke(i.gameState,he.Hit,t.position,$e,t.id),_e(i,ge.Attack,e.position)),ke(i.gameState,he.Attack,e.position,$e,e.id)}},nP={id:"human-attack-predator",sourceType:"human",targetType:"predator",maxDistance:ii,checker:(e,t,i)=>{var o;return!!(((o=e.stateMachine)==null?void 0:o[0])===lr&&e.attackTargetId===t.id&&(!e.attackCooldown||e.attackCooldown<=0)&&t.hitpoints>0&&e.isAdult)},perform:(e,t,i)=>{let o=oh*.8;e.gender==="male"&&(o*=1.2);const a=Object.values(i.gameState.entities.entities).filter(c=>c.type==="human"&&c.id!==e.id).filter(c=>{const f=c;return Math.sqrt(Math.pow(f.position.x-e.position.x,2)+Math.pow(f.position.y-e.position.y,2))<100&&f.activeAction==="attacking"&&f.attackTargetId===t.id}).length;a>0&&(o*=1+a*.2),t.hitpoints-=o;const s=Ye(e.position,t.position,i.gameState.mapDimensions.width,i.gameState.mapDimensions.height),u=Ot(s,8);t.forces.push(u),e.attackCooldown=bu,t.hitpoints<=0?(_e(i,ge.HumanDeath,t.position),ke(i.gameState,he.Hit,t.position,$e,t.id)):(ke(i.gameState,he.Hit,t.position,$e,t.id),t.hitpoints<t.maxHitpoints*.3&&(t.hunger+=20),_e(i,ge.Attack,e.position)),ke(i.gameState,he.Attack,e.position,$e,e.id)}},iP={id:"prey-procreation",sourceType:"prey",targetType:"prey",maxDistance:Vt,checker:(e,t,i)=>!!(e.isAdult&&t.isAdult&&e.gender!==t.gender&&e.id!==t.id&&!e.isPregnant&&!t.isPregnant&&e.hunger<200&&t.hunger<200&&(!e.procreationCooldown||e.procreationCooldown<=0)&&(!t.procreationCooldown||t.procreationCooldown<=0)),perform:(e,t,i)=>{const o=e.gender==="female"?e:t;o.isPregnant=!0,o.gestationTime=i.gameState.ecosystem.preyGestationPeriod,e.procreationCooldown=i.gameState.ecosystem.preyProcreationCooldown,t.procreationCooldown=i.gameState.ecosystem.preyProcreationCooldown,ke(i.gameState,he.Procreation,o.position,$e,o.id),_e(i,ge.Procreate,o.position)}},rP={id:"predator-procreation",sourceType:"predator",targetType:"predator",maxDistance:rr,checker:(e,t,i)=>!!(e.isAdult&&t.isAdult&&e.gender!==t.gender&&e.id!==t.id&&!e.isPregnant&&!t.isPregnant&&e.hunger<200&&t.hunger<200&&(!e.procreationCooldown||e.procreationCooldown<=0)&&(!t.procreationCooldown||t.procreationCooldown<=0)),perform:(e,t,i)=>{const o=e.gender==="female"?e:t;o.isPregnant=!0,o.pregnancyFatherId=e.gender==="male"?e.id:t.id,o.gestationTime=i.gameState.ecosystem.predatorGestationPeriod,e.procreationCooldown=i.gameState.ecosystem.predatorProcreationCooldown,t.procreationCooldown=i.gameState.ecosystem.predatorProcreationCooldown,ke(i.gameState,he.Procreation,o.position,$e,o.id),_e(i,ge.Procreate,o.position)}},oP={id:"preyChildFeeding",sourceType:"prey",targetType:"prey",maxDistance:is,checker:(e,t)=>e.isAdult===!0&&e.gender==="female"&&e.hunger<80&&(!e.feedChildCooldownTime||e.feedChildCooldownTime<=0)&&t.isAdult===!1&&(t.motherId===e.id||t.fatherId===e.id)&&t.hunger>=Pu&&e.activeAction==="feeding",perform:(e,t,i)=>{e.hunger=Math.min(120,e.hunger+10),t.hunger=Math.max(0,t.hunger-Pu),e.feedChildCooldownTime=ES,(!t.lastChildFedEffectTime||i.gameState.time-t.lastChildFedEffectTime>2)&&(ke(i.gameState,he.ChildFed,t.position,$e,t.id),t.lastChildFedEffectTime=i.gameState.time),_e(i,ge.ChildFed,t.position)}},sP={id:"predatorChildFeeding",sourceType:"predator",targetType:"predator",maxDistance:is,checker:(e,t)=>e.isAdult===!0&&e.gender==="female"&&e.hunger<90&&(!e.feedChildCooldownTime||e.feedChildCooldownTime<=0)&&t.isAdult===!1&&(t.motherId===e.id||t.fatherId===e.id)&&t.hunger>=Pu&&e.activeAction==="feeding",perform:(e,t,i)=>{e.hunger=Math.min(140,e.hunger+15),t.hunger=Math.max(0,t.hunger-Pu),e.feedChildCooldownTime=ES,(!t.lastChildFedEffectTime||i.gameState.time-t.lastChildFedEffectTime>2)&&(ke(i.gameState,he.ChildFed,t.position,$e,t.id),t.lastChildFedEffectTime=i.gameState.time),_e(i,ge.ChildFed,t.position)}},aP={id:"predator-eat-corpse",sourceType:"predator",targetType:"corpse",maxDistance:rr,checker:(e,t,i)=>!!(e.isAdult&&e.hunger>30&&t.food.length>0&&(!e.eatingCooldownTime||e.eatingCooldownTime<=i.gameState.time)),perform:(e,t,i)=>{t.food.pop()&&(e.hunger=Math.max(0,e.hunger-Ah),e.eatingCooldownTime=i.gameState.time+2,ke(i.gameState,he.Eating,e.position,$e,e.id),_e(i,ge.Gather,e.position))}},lP={id:"predator-attack-rival",sourceType:"predator",targetType:"predator",maxDistance:Fn,checker:(e,t,i)=>{var o;return!!(e.isAdult&&(!e.attackCooldown||e.attackCooldown<=0)&&t.hitpoints>0&&(e.hunger>100||t.attackTargetId===e.id||t.attackTargetId&&((o=i.gameState.entities.entities[t.attackTargetId])==null?void 0:o.type)==="predator"))},perform:(e,t,i)=>{let o=AS;e.hunger>120&&(o*=1.3),t.hitpoints-=o,t.movementSlowdown={modifier:sh,endTime:i.gameState.time+ah};const a=Ye(e.position,t.position,i.gameState.mapDimensions.width,i.gameState.mapDimensions.height),s=Ot(a,7);t.forces.push(s),e.attackCooldown=TS,t.hitpoints<=0?(e.hunger=Math.max(0,e.hunger-Ah),_e(i,ge.HumanDeath,t.position),ke(i.gameState,he.Hit,t.position,$e,t.id)):(ke(i.gameState,he.Hit,t.position,$e,t.id),_e(i,ge.Attack,e.position)),ke(i.gameState,he.Attack,e.position,$e,e.id)}},uP={id:"storageDeposit",sourceType:"human",targetType:"building",maxDistance:Cn,checker:(e,t,i)=>{var s;if(t.buildingType!=="storageSpot"||((s=e.stateMachine)==null?void 0:s[0])!==ua||!t.isConstructed||e.food.length===0)return!1;t.storedFood||(t.storedFood=[]);const o=t.storageCapacity??0;return!(t.storedFood.length>=o||e.leaderId!==t.ownerId||i.gameState.time-(t.lastDepositTime??0)<Gw)},perform:(e,t,i)=>{t.storedFood||(t.storedFood=[]);const o=e.food.pop();o&&t.storedFood.push({item:o,positionOffset:_S(t)}),t.lastDepositTime=i.gameState.time,_e(i,ge.StorageDeposit,t.position)}},cP={id:"storageRetrieve",sourceType:"human",targetType:"building",maxDistance:Cn,checker:(e,t,i)=>{var a;return!(t.buildingType!=="storageSpot"||((a=e.stateMachine)==null?void 0:a[0])!==ca||!t.isConstructed||!t.storedFood||t.storedFood.length===0||e.food.length>=e.maxFood||e.leaderId!==t.ownerId||i.gameState.time-(t.lastRetrieveTime??0)<xw)},perform:(e,t,i)=>{if(!t.storedFood||t.storedFood.length===0)return;const o=t.storedFood.pop();o&&(e.food.push(o.item),_S(t)),t.lastRetrieveTime=i.gameState.time,_e(i,ge.StorageRetrieve,t.position)}},dP={id:"storageSteal",sourceType:"human",targetType:"building",maxDistance:Cn,checker:(e,t,i)=>{var c,f;if(t.buildingType!=="storageSpot"||((c=e.stateMachine)==null?void 0:c[0])!==Da||!t.isConstructed||!t.storedFood||t.storedFood.length===0||e.food.length>=e.maxFood||e.leaderId===t.ownerId)return!1;const o=e.leaderId?i.gameState.entities.entities[e.leaderId]:void 0;if(!o||!((f=o.tribeControl)!=null&&f.diplomacy)||o.tribeControl.diplomacy[t.ownerId]!==Dt.Hostile||i.gameState.time-(t.lastStealTime??0)<$w)return!1;const u=ri({leaderId:t.ownerId},i.gameState);for(const g of u)if(V(e.position,g.position,i.gameState.mapDimensions.width,i.gameState.mapDimensions.height)<=Ww)return!1;return!0},perform:(e,t,i)=>{if(!t.storedFood||t.storedFood.length===0)return;const o=t.storedFood.pop();o&&e.food.push(o.item),t.lastStealTime=i.gameState.time,_e(i,ge.StorageSteal,t.position),ke(i.gameState,he.Attack,t.position,.5)}},fP={id:"human-takeover-building",sourceType:"human",targetType:"building",maxDistance:20,checker:(e,t,i)=>e.leaderId!==e.id||e.activeAction!=="takingOverBuilding"?!1:Ln(e,t,i.gameState),perform:(e,t,i)=>{t.ownerId=e.id,t.constructionProgress=1,t.isConstructed=!0,t.isBeingDestroyed=!1,t.destructionProgress=0,e.activeAction="idle",ke(i.gameState,he.BushClaimed,t.position,2,t.id)}},hP={id:"human-remove-enemy-building",sourceType:"human",targetType:"building",maxDistance:20,checker:(e,t,i)=>!(e.leaderId!==e.id||e.activeAction!=="destroyingBuilding"||!Ln(e,t,i.gameState)||t.isBeingDestroyed),perform:(e,t,i)=>{t.isBeingDestroyed=!0,e.activeAction="idle",ke(i.gameState,he.Hit,t.position,1,t.id)}},gP=[XR,...qR,YR,jR,VR,uP,cP,dP,fP,hP,QR,oP,sP,aP,JR,eP,nP,tP,lP,iP,rP];function pP(e){const{gameState:t}=e,i=t,o=Object.values(t.entities.entities);for(const a of gP)for(const s of o){if(a.sourceType&&s.type!==a.sourceType)continue;const u=i.search[a.targetType].byRadius(s.position,a.maxDistance);for(const c of u){if(s.id===c.id)continue;V(s.position,c.position,t.mapDimensions.width,t.mapDimensions.height)<=a.maxDistance&&a.checker(s,c,e)&&a.perform(s,c,e)}}}function mP(e){e.visualEffects=e.visualEffects.filter(t=>e.time-t.startTime<=t.duration)}function vP(e){const t=e.search.berryBush.byProperty("type","berryBush"),i=e.search.predator.byProperty("type","predator"),o=e.search.human.byProperty("type","human");for(let a=0;a<20;a++){let s;if(t.length>0&&a<15){const f=t[Math.floor(Math.random()*t.length)],g=Math.random()*2*Math.PI,m=50+Math.random()*100;s={x:Math.max(50,Math.min(Ke-50,f.position.x+Math.cos(g)*m)),y:Math.max(50,Math.min(tt-50,f.position.y+Math.sin(g)*m))}}else s={x:50+Math.random()*(Ke-100),y:50+Math.random()*(tt-100)};let u=!0;const c=100;for(const f of i)if(Math.sqrt((s.x-f.position.x)**2+(s.y-f.position.y)**2)<c){u=!1;break}if(u){for(const f of o)if(Math.sqrt((s.x-f.position.x)**2+(s.y-f.position.y)**2)<c){u=!1;break}}if(u)return s}return{x:Ke*.3+Math.random()*Ke*.4,y:tt*.3+Math.random()*tt*.4}}function SP(e){const t=e.search.prey.byProperty("type","prey"),i=e.search.human.byProperty("type","human");for(let a=0;a<15;a++){let s;if(t.length>0&&a<10){const f=t[Math.floor(Math.random()*t.length)],g=Math.random()*2*Math.PI,m=100+Math.random()*150;s={x:Math.max(50,Math.min(Ke-50,f.position.x+Math.cos(g)*m)),y:Math.max(50,Math.min(tt-50,f.position.y+Math.sin(g)*m))}}else s={x:50+Math.random()*(Ke-100),y:50+Math.random()*(tt-100)};let u=!0;const c=150;for(const f of i)if(Math.sqrt((s.x-f.position.x)**2+(s.y-f.position.y)**2)<c){u=!1;break}if(u)return s}switch(Math.floor(Math.random()*4)){case 0:return{x:Math.random()*Ke,y:50+Math.random()*100};case 1:return{x:Ke-150+Math.random()*100,y:Math.random()*tt};case 2:return{x:Math.random()*Ke,y:tt-150+Math.random()*100};default:return{x:50+Math.random()*100,y:Math.random()*tt}}}function yP(e){const t=e.search.human.byProperty("type","human"),i=e.search.berryBush.byProperty("type","berryBush");for(let o=0;o<20;o++){const a={x:50+Math.random()*(Ke-100),y:50+Math.random()*(tt-100)};let s=!0;const u=80,c=60;for(const f of t)if(Math.sqrt((a.x-f.position.x)**2+(a.y-f.position.y)**2)<u){s=!1;break}if(s){for(const f of i)if(Math.sqrt((a.x-f.position.x)**2+(a.y-f.position.y)**2)<c){s=!1;break}}if(s)return a}return{x:Math.random()*Ke,y:Math.random()*tt}}function LS(e,t=4){console.log(` Respawning ${t} prey to prevent extinction`);const i=e;for(let o=0;o<t;o++){const a=vP(i),s=o%2===0?"male":"female";qo(e.entities,a,s,void 0,void 0,Ca())}}function US(e,t=2){console.log(` Respawning ${t} predators to prevent extinction`);const i=e;for(let o=0;o<t;o++){const a=SP(i),s=o%2===0?"male":"female";Qo(e.entities,a,s,void 0,void 0,wa())}}function AP(e){const t=e,i=t.search.prey.count(),o=t.search.predator.count();let a=!1;return i===0&&(LS(e,6),a=!0),o===0&&(US(e,3),a=!0),a}function TP(e){const t=e,i=t.search.prey.count(),o=t.search.predator.count(),a=t.search.berryBush.count();let s=!1;if(i>0&&i<5){const u=Math.max(2,Math.floor(8-i));LS(e,u),s=!0}if(o>0&&o<2){const u=Math.max(1,Math.floor(3-o));US(e,u),s=!0}if(a<5){console.log(` Boosting bush count from ${a} to help ecosystem`);for(let u=0;u<5;u++){const c=yP(t);Ma(e.entities,c,e.time)}s=!0}return s}const IP=1,EP=.3,CP=.8,k0=.8,wP=.99,_P=.05;var BS=(e=>(e[e.INCREASE_PREY_GESTATION=0]="INCREASE_PREY_GESTATION",e[e.DECREASE_PREY_GESTATION=1]="DECREASE_PREY_GESTATION",e[e.INCREASE_PREY_PROCREATION_COOLDOWN=2]="INCREASE_PREY_PROCREATION_COOLDOWN",e[e.DECREASE_PREY_PROCREATION_COOLDOWN=3]="DECREASE_PREY_PROCREATION_COOLDOWN",e[e.INCREASE_PREY_HUNGER=4]="INCREASE_PREY_HUNGER",e[e.DECREASE_PREY_HUNGER=5]="DECREASE_PREY_HUNGER",e[e.INCREASE_PREDATOR_GESTATION=6]="INCREASE_PREDATOR_GESTATION",e[e.DECREASE_PREDATOR_GESTATION=7]="DECREASE_PREDATOR_GESTATION",e[e.INCREASE_PREDATOR_PROCREATION_COOLDOWN=8]="INCREASE_PREDATOR_PROCREATION_COOLDOWN",e[e.DECREASE_PREDATOR_PROCREATION_COOLDOWN=9]="DECREASE_PREDATOR_PROCREATION_COOLDOWN",e[e.INCREASE_PREDATOR_HUNGER=10]="INCREASE_PREDATOR_HUNGER",e[e.DECREASE_PREDATOR_HUNGER=11]="DECREASE_PREDATOR_HUNGER",e[e.INCREASE_BUSH_SPREAD=12]="INCREASE_BUSH_SPREAD",e[e.DECREASE_BUSH_SPREAD=13]="DECREASE_BUSH_SPREAD",e[e.NO_ACTION=14]="NO_ACTION",e))(BS||{});const ff=Object.keys(BS).length/2;class RP{constructor(){Ne(this,"qTable",new Map);Ne(this,"epsilon",k0);Ne(this,"lastState",null);Ne(this,"lastAction",null)}discretizeState(t,i,o){const a=Math.min(4,Math.floor(t/25)),s=Math.min(4,Math.floor(i/5)),u=Math.min(4,Math.floor(o/15));return`${a}-${s}-${u}`}getQValue(t,i){return this.qTable.has(t)||this.qTable.set(t,new Map),this.qTable.get(t).get(i)||0}setQValue(t,i,o){this.qTable.has(t)||this.qTable.set(t,new Map),this.qTable.get(t).set(i,o)}getBestAction(t){let i=0,o=this.getQValue(t,0);for(let a=1;a<ff;a++){const s=this.getQValue(t,a);s>o&&(o=s,i=a)}return i}chooseAction(t){return Math.random()<this.epsilon?Math.floor(Math.random()*ff):this.getBestAction(t)}applyEmergencyCorrections(t,i,o,a){t<Si*.5&&(a.ecosystem.preyGestationPeriod=Math.max(Mo,a.ecosystem.preyGestationPeriod*.8),a.ecosystem.preyProcreationCooldown=Math.max(ko,a.ecosystem.preyProcreationCooldown*.8),a.ecosystem.preyHungerIncreasePerHour=Math.max(Uo,a.ecosystem.preyHungerIncreasePerHour*.9)),i<yi*.6&&(a.ecosystem.predatorGestationPeriod=Math.max(Fo,a.ecosystem.predatorGestationPeriod*.75),a.ecosystem.predatorProcreationCooldown=Math.max(Lo,a.ecosystem.predatorProcreationCooldown*.75),a.ecosystem.predatorHungerIncreasePerHour=Math.max(Bo,a.ecosystem.predatorHungerIncreasePerHour*.85)),o<Ai*.5&&(a.ecosystem.berryBushSpreadChance=Math.min(ea,a.ecosystem.berryBushSpreadChance*1.2)),t>Si*1.4&&(a.ecosystem.preyHungerIncreasePerHour=Math.min(er,a.ecosystem.preyHungerIncreasePerHour*1.05)),i>yi*1.4&&(a.ecosystem.predatorHungerIncreasePerHour=Math.min(tr,a.ecosystem.predatorHungerIncreasePerHour*1.05)),o>Ai*1.4&&(a.ecosystem.berryBushSpreadChance=Math.max(Ti,a.ecosystem.berryBushSpreadChance*.95))}calculateReward(t,i,o){const a=Math.abs(t-Si),s=Math.abs(i-yi),u=Math.abs(o-Ai),c=a/Si,f=s/yi,g=u/Ai,m=c+f+g;return 100*Math.exp(-m*2)-50}applyAction(t,i){switch(t){case 0:i.ecosystem.preyGestationPeriod=Math.min(Fr,i.ecosystem.preyGestationPeriod+.2*(Fr-Mo));break;case 1:i.ecosystem.preyGestationPeriod=Math.max(Mo,i.ecosystem.preyGestationPeriod-.2*(Fr-Mo));break;case 2:i.ecosystem.preyProcreationCooldown=Math.min(Lr,i.ecosystem.preyProcreationCooldown+.2*(Lr-ko));break;case 3:i.ecosystem.preyProcreationCooldown=Math.max(ko,i.ecosystem.preyProcreationCooldown-.2*(Lr-ko));break;case 4:i.ecosystem.preyHungerIncreasePerHour=Math.min(er,i.ecosystem.preyHungerIncreasePerHour+.2*(er-Uo));break;case 5:i.ecosystem.preyHungerIncreasePerHour=Math.max(Uo,i.ecosystem.preyHungerIncreasePerHour-.2*(er-Uo));break;case 6:i.ecosystem.predatorGestationPeriod=Math.min(Ur,i.ecosystem.predatorGestationPeriod+.2*(Ur-Fo));break;case 7:i.ecosystem.predatorGestationPeriod=Math.max(Fo,i.ecosystem.predatorGestationPeriod-.2*(Ur-Fo));break;case 8:i.ecosystem.predatorProcreationCooldown=Math.min(Br,i.ecosystem.predatorProcreationCooldown+.2*(Br-Lo));break;case 9:i.ecosystem.predatorProcreationCooldown=Math.max(Lo,i.ecosystem.predatorProcreationCooldown-.2*(Br-Lo));break;case 10:i.ecosystem.predatorHungerIncreasePerHour=Math.min(tr,i.ecosystem.predatorHungerIncreasePerHour+.2*(tr-Bo));break;case 11:i.ecosystem.predatorHungerIncreasePerHour=Math.max(Bo,i.ecosystem.predatorHungerIncreasePerHour-.2*(tr-Bo));break;case 12:i.ecosystem.berryBushSpreadChance=Math.min(ea,i.ecosystem.berryBushSpreadChance+.2*(ea-Ti));break;case 13:i.ecosystem.berryBushSpreadChance=Math.max(Ti,i.ecosystem.berryBushSpreadChance-.2*(ea-Ti));break}}updateQTable(t,i,o,a){const s=this.getQValue(t,i),u=Math.max(...Array.from({length:ff},(f,g)=>this.getQValue(a,g))),c=s+EP*(o+CP*u-s);this.setQValue(t,i,c)}step(t){const i=t,o=i.search.prey.count(),a=i.search.predator.count(),s=i.search.berryBush.count();this.applyEmergencyCorrections(o,a,s,t);const u=this.discretizeState(o,a,s);if(this.lastState!==null&&this.lastAction!==null){const f=this.calculateReward(o,a,s);this.updateQTable(this.lastState,this.lastAction,f,u)}const c=this.chooseAction(u);this.applyAction(c,t),this.epsilon=Math.max(_P,this.epsilon*wP),this.lastState=u,this.lastAction=c}reset(){this.qTable.clear(),this.epsilon=k0,this.lastState=null,this.lastAction=null}getStats(){return{qTableSize:this.qTable.size,explorationRate:this.epsilon}}}let HS=new RP;function PP(e){AP(e),TP(e),e.ecosystem.lastUpdateTime||(e.ecosystem.preyGestationPeriod=Mo+(Fr-Mo)*.3,e.ecosystem.preyProcreationCooldown=ko+(Lr-ko)*.3,e.ecosystem.preyHungerIncreasePerHour=Uo+(er-Uo)*.3,e.ecosystem.predatorGestationPeriod=Fo+(Ur-Fo)*.3,e.ecosystem.predatorProcreationCooldown=Lo+(Br-Lo)*.3,e.ecosystem.predatorHungerIncreasePerHour=Bo+(tr-Bo)*.3,e.ecosystem.berryBushSpreadChance=Ti+(ea-Ti)*.7),HS.step(e)}function NP(e){e.ecosystem.lastUpdateTime||(e.ecosystem.lastUpdateTime=0),!(e.time-e.ecosystem.lastUpdateTime<IP)&&(e.ecosystem.lastUpdateTime=e.time,PP(e))}function DP(){return HS.getStats()}function OP(e,t){e.selectedBuildingType&&e.selectedBuildingType!=="removal"&&(e.autopilotControls.activeAutopilotAction=void 0,e.autopilotControls.hoveredAutopilotAction=void 0)}const MP=1/60;function kP(e,t){const i=pt(e);i&&(e.viewportCenter=lh(e.viewportCenter,i.position,Jf*t))}function zu(e,t){if(e.isPaused)return e;if(e.autosaveIntervalSeconds){const i=Date.now();i-e.lastAutosaveTime>e.autosaveIntervalSeconds*1e3&&(Yf(e),e.lastAutosaveTime=i)}for(;t>0;){const i=Ou(e),o=Math.min(t,MP),a=o*(Ct/wt);i.time+=a,kP(i,o),ww(i),NP(i),_w(i),_R({gameState:i,deltaTime:o}),pP({gameState:i,deltaTime:o}),mP(i),FR(i,o),OP(i),e=i,t-=o}return e}function hf(e,t,i){e.save();const{x:o,y:a,width:s,height:u}=t.rect,c=Kv;if(e.beginPath(),e.moveTo(o+c,a),e.lineTo(o+s-c,a),e.quadraticCurveTo(o+s,a,o+s,a+c),e.lineTo(o+s,a+u-c),e.quadraticCurveTo(o+s,a+u,o+s-c,a+u),e.lineTo(o+c,a+u),e.quadraticCurveTo(o,a+u,o,a+u-c),e.lineTo(o,a+c),e.quadraticCurveTo(o,a,o+c,a),e.closePath(),e.fillStyle=t.isDisabled?Zv:t.backgroundColor,e.fill(),t.activated){e.save();const f=(Math.sin(Date.now()/1e3*eS)+1)/2;e.strokeStyle=Jv,e.lineWidth=2+f*2,e.globalAlpha=.7+f*.3,e.stroke(),e.restore()}if(t.lastActivated){const f=Date.now()-t.lastActivated;if(f<Ru){const g=1-f/Ru;e.fillStyle=Qv,e.globalAlpha=g,e.fill(),e.globalAlpha=1}}i&&!t.isDisabled&&(e.fillStyle=fh,e.globalAlpha=.5,e.fill(),e.globalAlpha=1),e.fillStyle=t.isDisabled?qv:t.textColor,t.icon?(e.font=`${u*.55}px "Press Start 2P", Arial`,e.textAlign="center",e.textBaseline="middle",e.fillText(t.icon,o+s/2,a+u/2),t.text&&(e.font=`${u*.18}px "Press Start 2P", Arial`,e.textAlign="right",e.textBaseline="bottom",e.fillText(t.text,o+s-4,a+u-2))):(e.textAlign="center",e.textBaseline="middle",e.fillText(t.text,o+s/2,a+u/2)),e.restore()}function FP(e,t,i,o){e.save(),e.font=`${u0}px "Press Start 2P", Arial`,e.textAlign="center",e.textBaseline="bottom";const s=e.measureText(i).width,u=u0,c=s+c0*2,f=u+c0*2,g=o.x-c/2,m=e.canvas.height,v=t.y<m/2?t.y+t.height-d0:t.y-f+d0;e.fillStyle=MC,e.fillRect(g,v,c,f),e.fillStyle=kC,e.fillText(i,o.x,v+f/2+u/2),e.restore()}function LP(e,t,i){e.save();const o=pt(t),a=[{id:"fastForwardButton",action:ne.FastForward,text:"FFWD [T]",currentWidth:vi*1.3,backgroundColor:qi,textColor:Yt,tooltip:"Fast-forward time",rect:{x:0,y:0,width:0,height:0}},{id:"pauseButton",action:ne.TogglePause,text:t.isPaused?"UN[P]AUSE":"[P]AUSE",backgroundColor:t.isPaused?Xl:qi,currentWidth:t.isPaused?vi*1.4:vi*1.1,tooltip:t.isPaused?"Resume Game":"Pause Game",rect:{x:0,y:0,width:0,height:0},textColor:Yt},{id:"muteButton",action:ne.ToggleMute,text:t.isMuted?"UN[M]UTE":"[M]UTE",backgroundColor:t.isMuted?Xl:qi,tooltip:`Toggle Sound (${t.isMuted?"Muted":"Enabled"})`,currentWidth:vi,rect:{x:0,y:0,width:0,height:0},textColor:Yt},{id:"returnToIntroButton",action:ne.ReturnToIntro,text:"EXIT",backgroundColor:qi,tooltip:"Return to Main Menu [ESC]",currentWidth:vi*.9,rect:{x:0,y:0,width:0,height:0},textColor:Yt}];if(t.uiButtons.push(...a),o){const g=vh(t,o),m=new Set(g.map(F=>F.type));let v=[{playerAction:ce.Gather,buttonAction:ne.CommandGather,shortcut:"E",name:"Gather",toggleKey:"gathering",condition:()=>o.isAdult===!0},{playerAction:ce.Eat,buttonAction:ne.CommandEat,shortcut:"F",name:"Eat"},{playerAction:ce.Plant,buttonAction:ne.CommandPlant,shortcut:"B",name:"Plant",toggleKey:"planting",condition:()=>o.isAdult===!0},{playerAction:ce.Procreate,buttonAction:ne.ToggleProcreationBehavior,shortcut:"R",name:"Procreation",toggleKey:"procreation",condition:()=>o.isAdult===!0},{playerAction:ce.FeedChild,buttonAction:ne.ToggleFeedChildBehavior,shortcut:"H",name:"Feed Child",toggleKey:"feedChildren",condition:()=>o.isAdult===!0},{playerAction:ce.Attack,buttonAction:ne.ToggleAttackBehavior,shortcut:"Q",name:"Attack",toggleKey:"attack",condition:()=>o.isAdult===!0&&o.leaderId===o.id},{playerAction:ce.FollowMe,buttonAction:ne.CommandFollowMe,shortcut:"C",name:"Follow Me",toggleKey:"followLeader",condition:()=>o.isAdult===!0&&o.leaderId===o.id},{playerAction:ce.CallToAttack,buttonAction:ne.CommandCallToAttack,shortcut:"V",name:"Call to Attack",condition:()=>o.isAdult===!0&&o.leaderId===o.id},{playerAction:ce.TribeSplit,buttonAction:ne.CommandTribeSplit,shortcut:"K",name:"Split Tribe",condition:()=>o.leaderId!==void 0&&o.leaderId!==o.id&&o.isAdult===!0},{playerAction:ce.Build,buttonAction:ne.CommandBuild,shortcut:"L",name:"Build",toggleKey:"build",condition:()=>o.isAdult===!0&&o.leaderId===o.id},{playerAction:ce.Build,buttonAction:ne.OpenRoleManager,shortcut:"U",name:"Roles",condition:()=>o.isAdult===!0&&o.leaderId===o.id&&RS(o,t)}];v=v.filter(F=>F.condition?F.condition():!0);const T=1,A=v.length,I=A*ln+(A-1)*_r,y=T*ln+(T-1)*_r,w=(i-I)/2,M=e.canvas.height-y-20;if(v.forEach((F,N)=>{const b=N%A,B=Math.floor(N/A),L=w+b*(ln+_r),G=M+B*(ln+_r),Q=!!F.toggleKey,re=Q&&t.autopilotControls.behaviors[F.toggleKey],ve=!m.has(F.playerAction),De=F.playerAction===ce.Build&&t.buildMenuOpen,Te=!t.hasPlayerEnabledAutopilot||t.hasPlayerEnabledAutopilot<4?" (Press Shift to toggle Auto)":"",de=Q?`${F.name}${Te}`:F.name,Be=re||De||F.buttonAction===ne.OpenRoleManager&&t.roleManagerOpen?Xl:qi,Ae={id:`commandButton_${F.name}`,action:F.buttonAction,rect:{x:L,y:G,width:ln,height:ln},icon:F.buttonAction===ne.OpenRoleManager?"":xu[F.playerAction],text:F.shortcut,backgroundColor:Be,textColor:Yt,currentWidth:ln,tooltip:de,isDisabled:ve,activated:re||F.buttonAction===ne.CommandBuild&&De||F.buttonAction===ne.OpenRoleManager&&t.roleManagerOpen};t.uiButtons.push(Ae)}),t.buildMenuOpen){const F=[{id:"buildMenu_storageSpot",action:ne.SelectStorageSpot,icon:"",shortcut:"1",name:"Storage Spot"},{id:"buildMenu_plantingZone",action:ne.SelectPlantingZone,icon:"",shortcut:"2",name:"Planting Zone"},{id:"buildMenu_removal",action:ne.SelectRemovalTool,icon:"",shortcut:"3",name:"Remove Building"}],N=F.length,b=N*ln+(N-1)*_r,B=(i-b)/2,L=M-ln-_r;F.forEach((G,Q)=>{const re=B+Q*(ln+_r),ve=L,be=G.action===ne.SelectStorageSpot&&t.selectedBuildingType==="storageSpot"||G.action===ne.SelectPlantingZone&&t.selectedBuildingType==="plantingZone"||G.action===ne.SelectRemovalTool&&t.selectedBuildingType==="removal",De={id:G.id,action:G.action,rect:{x:re,y:ve,width:ln,height:ln},icon:G.icon,text:G.shortcut,backgroundColor:be?Xl:qi,textColor:Yt,currentWidth:ln,tooltip:G.name,activated:be};t.uiButtons.push(De),hf(e,De,t.hoveredButtonId===De.id)})}}let s=i-Ve;a.forEach(g=>{const m=Ve,v=s-g.currentWidth;g.rect={x:v,y:m,width:g.currentWidth,height:Xv},hf(e,g,t.hoveredButtonId===g.id),s-=g.currentWidth+OC});let u=null;t.uiButtons.filter(g=>g.id.startsWith("commandButton_")||g.id.startsWith("buildMenu_")).forEach(g=>{u||(u={x:g.rect.x,y:g.rect.y,width:g.rect.width,height:g.rect.height}),u.x=Math.min(u.x,g.rect.x),u.y=Math.min(u.y,g.rect.y),u.width=Math.max(u.width,g.rect.x+g.rect.width-u.x),u.height=Math.max(u.height,g.rect.y+g.rect.height-u.y),g.id.startsWith("commandButton_")&&hf(e,g,t.hoveredButtonId===g.id)});const f=t.hoveredButtonId?t.uiButtons.find(g=>g.id===t.hoveredButtonId):void 0;return f&&f.tooltip&&t.mousePosition&&FP(e,f.rect,f.tooltip,t.mousePosition),e.restore(),{commandButtonsRect:u}}function UP(e){e.save(),e.fillStyle=WC,e.fillRect(0,0,e.canvas.width,e.canvas.height),e.fillStyle=zC,e.font=`${YC}px "Press Start 2P", Arial`,e.textAlign="center",e.textBaseline="middle",e.fillText("PAUSED",e.canvas.width/2,e.canvas.height/2),e.restore()}function Gf(e,t,i,o){const a=t.x-i.width/2,s=t.y-i.height/2,u=a+e.x,c=s+e.y,f=(u%o.width+o.width)%o.width,g=(c%o.height+o.height)%o.height;return{x:f,y:g}}function Yu(e,t,i,o){let a=e.x-t.x,s=e.y-t.y;return Math.abs(a)>o.width/2&&(a=a-Math.sign(a)*o.width),Math.abs(s)>o.height/2&&(s=s-Math.sign(s)*o.height),{x:a+i.width/2,y:s+i.height/2}}function au(e,t,i,o){const a=Yu(e.position,t,i,o),u=("radius"in e?e.radius:20)+20;return a.x>=-u&&a.x<=i.width+u&&a.y>=-u&&a.y<=i.height+u}function cn(e,t,i,o,a,...s){const u={...a.position};for(let c=-i;c<=i;c+=i)for(let f=-t;f<=t;f+=t)a.position.x=u.x+f,a.position.y=u.y+c,o(e,a,...s);a.position=u}const BP=25,HP=0,F0=28;function bS(e,t,i,o,a,s,u,c,f,g){e.save();const{x:m,y:v}=Yu(t,u,{width:c,height:f},g);e.strokeStyle=o,e.lineWidth=s,e.setLineDash(a),e.beginPath(),e.arc(m,v,i+Gu,0,2*Math.PI),e.stroke(),e.restore()}function bP(e,t,i,o,a,s,u){if(t=t.filter(v=>v.type!==ce.FollowMe),t.length===0)return;e.save(),t.forEach(v=>{v.targetEntity&&bS(e,v.targetEntity.position,v.targetEntity.radius,ch,dh,2,o,a,s,u)}),e.font=`${Vo}px "Press Start 2P", Arial`,e.fillStyle="white",e.textAlign="center",e.textBaseline="bottom",e.shadowColor="black",e.shadowBlur=5;const{x:c,y:f}=Yu(i.position,o,{width:a,height:s},u);let g=0,m={};t.forEach(v=>{const T=xu[v.type];if(v.targetEntity){m[v.targetEntity.id]=(m[v.targetEntity.id]||0)+1;const A=v.targetEntity.position.x-o.x+a/2,I=v.targetEntity.position.y-o.y+s/2,y=`${T}${v.key.toUpperCase()}`,w=I-v.targetEntity.radius-Gu-Vo/2-(m[v.targetEntity.id]-1)*F0;e.fillText(y,A,w)}else{e.textAlign="left";const A=`${T}${v.key.toUpperCase()}`,I=c+BP,w=f+HP+g*F0;e.fillText(A,I,w),g++,e.textAlign="center"}}),e.restore()}const Ee=(e,t,i,o,a,s,u)=>{s==="transparent"||o<=0||a<=0||(e.fillStyle=s,e.fillRect(Math.floor(t*u),Math.floor(i*u),Math.ceil(o*u),Math.ceil(a*u)))},L0=10,U0=10,qn=6,gi=4,lu=2,GP=5,In=4,xP=2,Ut=4,$P=2,rt=3,wo=2,Zi=0,ha=Zi+gi-1,$t=ha,dt=ha+In-1,WP="rgba(0, 0, 0, 0.4)",zP=4,YP=1,wh={name:"tribe-human-2d",referenceImage:"swos.png",description:`A 2D human character asset for the Tribe game. This includes ensuring that the unique animations for stances like 'eat' and 'procreate' do not erroneously appear in other stances, such as 'walk', which was observed in the provided rendered media. The 'idle' animation was updated to a leg sway to better match the provided video for that stance, replacing a simpler body bob.

# Visual style

Human characters in the Tribe game are inspired by classic 2D pixel art, they look like Sensible Soccer players(Sensible Soccer game visual style is IMPORTANT), with a simple and recognizable design. The characters are designed to be easily distinguishable and animated in a way that conveys their actions clearly.

Character in Tribe game look like people from stone age, they have simple clothing, no shoes, and no modern accessories. The characters are designed to be easily distinguishable and animated in a way that conveys their actions clearly.

# Technical details

The asset is rendered on a canvas using the CanvasRenderingContext2D API. The rendering function takes parameters for position, size, progress, stance, direction, gender, and age. The character can face left or right, and the rendering adapts based on the stance (e.g., idle, walk, eat, procreate).
The rendering function must be simple and efficient, it should not use complex patterns or gradients, and should focus on solid colors and basic shapes to maintain the pixel art aesthetic.

15% padding from all edges of the rendering box is required to ensure the character is not cut off during rendering.

Subtle shadow should be drawn under the character to give it a sense of depth.

# Rendering parameters

- age: The age of the character, which affects the size and proportions of the body parts. Age is a number between 1 and 60, with 20 being the average age.
- gender: 
  - The male characters should have only pants, while female cover their breasts with a top. The clothing should be simple and muted, reflecting a stone-age style.
  - Female characters should have long hair, while male should have short hair and beard.
  - Male characters should have a more robust, muscular build
  - Female characters should have thinner arms and legs, with a more pronounced waist and hips.
- isPregnant: (applicable only for females) Indicates if the character is pregnant, like very large belly. Pregnant characters should have a larger torso.
- direction: A vector indicating the character's facing direction. There should be at least 8 directions (like in Sensible Soccer): top left, top, top right, left, right, bottom left, bottom, bottom right. The character should be flipped horizontally if the direction vector's X component is negative.
             When moving up(top, top left, top right), the character back of the head should be visible, when moving down(Y > 0), the character face should be visible.
- hungryLevel: A number between 0 and 100 indicating how hungry the character is, hunger level 100 means the character is starving, 0 means the character is not hungry at all. So hungry characters should be thinner, with less body fat, and more pronounced muscles. The character's hunger level affects the size and proportions of the body parts, with hungrier characters being smaller and more gaunt.

# Rendering details

- All parts of the body must be connected
- Rendering must take into account direction vector (X and Y) to flip the character horizontally if needed
- The character's age affects the size and proportions of the body parts, with older characters being larger and more robust. Hair color should become gray for older characters.

# Stances

- 'idle': The character stands still, with a slight leg sway to indicate life.
- 'walk': The character moves forward, with legs and arms in motion.
- 'gathering': The character is gathering food from berry bushes, with arms reaching out and a slight bend at the knees.
- 'eat': The character holds food and brings it to their mouth, with a slight bend at the knees.
- 'procreate': The character performs a mating animation, with a specific pose and movement. There should be some additional visual effects to indicate this action, such as a slight glow or aura around the characters, or dust particles to indicate movement.
- 'attacking': The character performs an attack animation, with arms raised and a forward motion.
- 'defending': The character takes a defensive stance, with arms raised and a slight bend at the knees.
- 'stunned': The character is stunned and laying on the ground, with limbs relaxed and a neutral expression.
- 'dead': The character lies on the ground, with limbs relaxed and a neutral expression, slowly turns into a skeleton over time.

`,stances:["idle","walk","gathering","eat","procreate","dead","attacking","defending","stunned"],render(e,t,i,o,a,s,u,c="male",f=20,g=[1,0],m=!1,v=0){const T=["dead","stunned"].includes(u),A=T?U0+4:L0,I=T?L0+4:U0+rt,y=.15,w=Math.min(o*(1-2*y)/A,a*(1-2*y)/I),M=A*w,F=I*w,N=t+(o-M)/2,b=i+(a-F)/2;e.save(),g[0]<0&&!T?(e.translate(N+M,b),e.scale(-1,1)):e.translate(N,b);const L="#D09A5A",G=f>50?"#BDBDBD":"#281808",Q="#7F5C4A",re="#6B4F3A",ve="#E0D8C0",be="#A0522D",De=1-Math.max(0,Math.min(100,v))/100*.2,Te=c==="male"?1.1:.9,de=.8+(Math.max(1,Math.min(f,60))-1)/59*.2;let Be=GP*De*Te*de,Ae=xP*De*Te*de,le=$P*De*de;m&&c==="female"&&(Be*=1.5);const Y=Math.round((A-Be)/2),X=Math.round((A-qn)/2),W=Y-Ae,P=Y+Be,H=1,Z=Y+(Be/2-H/2)-le,ee=Y+(Be/2+H/2),Ie=g[1]<-.2&&Math.abs(g[0])<.7,se=K=>{e.fillStyle=WP,e.beginPath();const ae=A/2,Ue=K;e.ellipse(Math.floor(ae*w),Math.floor(Ue*w),Math.max(1,Math.floor(zP*w)),Math.max(1,Math.floor(YP*w)),0,0,2*Math.PI),e.fill()},Re=(K,ae)=>{c==="male"?(Ee(e,Y,ha+K,Be,In-wo,ae,w),Ee(e,Y,ha+In-wo+K,Be,wo,Q,w)):Ee(e,Y,ha+K,Be,In,re,w)},Ce=(K,ae)=>{Ie?Ee(e,X,Zi+K,qn,gi,G,w):(Ee(e,X,Zi+K,qn,gi,ae,w),Ee(e,X,Zi+K,qn,lu,G,w),c==="female"?(Ee(e,X-1,Zi+lu+K,1,gi,G,w),Ee(e,X+qn,Zi+lu+K,1,gi,G,w)):Ee(e,X+1,Zi+2+K,qn-2,gi-2,G,w))};switch(u){case"idle":{const K=s*Math.PI*2,ae=Math.sin(K)*.5,me=(Math.cos(K*2)+1)*.25;se(dt+rt+1),Ee(e,Z+ae,dt+me,le,rt,L,w),Ee(e,ee-ae,dt+me,le,rt,L,w),Re(me,L),Ee(e,W,$t+me,Ae,Ut,L,w),Ee(e,P,$t+me,Ae,Ut,L,w),Ce(me,L);break}case"walk":{const K=s*Math.PI*2,ae=Math.sin(K)*2,me=Math.abs(Math.cos(K))*1;se(dt+rt+1),Ee(e,Z+ae,dt+me,le,rt,L,w),Ee(e,ee-ae,dt+me,le,rt,L,w),Re(me,L),Ee(e,W-ae,$t+me,Ae,Ut,L,w),Ee(e,P+ae,$t+me,Ae,Ut,L,w),Ce(me,L);break}case"gathering":{const K=s*Math.PI*2,ae=1,Ue=(Math.sin(K)+1)/2*2,me=ae+Math.abs(Math.cos(K))*.5;se(dt+rt+1),Ee(e,Z,dt+me,le,rt-ae,L,w),Ee(e,ee,dt+me,le,rt-ae,L,w),Re(me,L),Ee(e,W+1,$t+me-Ue,Ae,Ut,L,w),Ee(e,P-1,$t+me-Ue,Ae,Ut,L,w),Ce(me,L);break}case"eat":{se(dt+rt+1),Ee(e,Z,dt+1,le,rt-1,L,w),Ee(e,ee,dt+1,le,rt-1,L,w),Re(1,L);const Ue=(Math.sin(s*Math.PI*4)+1)/2,me=X+qn/2,Gn=Zi+gi/2,nt=P+(me-P)*Ue,qe=$t+1+(Gn-($t+1))*Ue;Ee(e,W,$t+1,Ae,Ut,L,w),Ee(e,nt,qe,Ae,Ut,L,w),Ee(e,nt,qe-1,1,1,be,w),Ce(1,L);break}case"procreate":{const K=(Math.sin(s*Math.PI*8)+1)/4,ae=(Math.sin(s*Math.PI*6)+1)*.5,Ue=1.5,me=Ue-ae;se(dt+rt+1),Ee(e,Z,dt+me,le,rt-Ue,L,w),Ee(e,ee,dt+me,le,rt-Ue,L,w),Re(me,L),Ee(e,W,$t+me,Ae,Ut,L,w),Ee(e,P,$t+me,Ae,Ut,L,w),Ce(me,L),e.globalAlpha=K,Re(me,"white"),e.globalAlpha=1;break}case"attacking":{const K=Math.sin(s*Math.PI)*1.5,ae=Math.abs(Math.sin(s*Math.PI));se(dt+rt+1),Ee(e,Z-K,dt+ae,le,rt,L,w),Ee(e,ee+K*.5,dt+ae,le,rt,L,w),Re(ae,L),Ee(e,W,$t+ae-2,Ae,Ut,L,w),Ee(e,P,$t+ae-2.5,Ae,Ut,L,w),Ce(ae,L);break}case"defending":{se(dt+rt+1),Ee(e,Z,dt+1,le,rt-1,L,w),Ee(e,ee,dt+1,le,rt-1,L,w),Re(1,L),Ee(e,W-1,$t+1-1,Ae,Ut,L,w),Ee(e,P+1,$t+1-1,Ae,Ut,L,w),Ce(1,L);break}case"stunned":case"dead":{const K=u==="dead",ae=K?Math.min(1,s):0,Ue=ae>.5?ve:L,me=c==="male"?Q:re,Gn=ae>.8?"transparent":G,nt=A/2,qe=I/2,xn=2;se(I-1),Ee(e,nt-le-xn,qe,le,rt,Ue,w),Ee(e,nt+xn,qe,le,rt,Ue,w),Ee(e,nt-Ae-xn,qe-In+1,Ae,Ut,Ue,w),Ee(e,nt+xn,qe-In+1,Ae,Ut,Ue,w);const Kt=nt-Be/2,hn=qe-In/2;c==="male"?(ae<.7&&Ee(e,Kt,hn+In-wo,Be,wo,me,w),Ee(e,Kt,hn,Be,In-wo,Ue,w)):ae<.7?Ee(e,Kt,hn,Be,In,me,w):Ee(e,Kt,hn,Be,In,Ue,w);const $n=nt-qn/2,Wn=qe-In/2-gi+1;if(Ee(e,$n,Wn,qn,gi,Ue,w),Gn!=="transparent"&&Ee(e,$n,Wn,qn,lu,Gn,w),K&&ae>.6){const Ei="#B0A890";for(let dr=0;dr<3;dr++)Ee(e,Kt+1,hn+dr*1+1,Be-2,.5,Ei,w)}break}default:Ee(e,0,0,A,I,"magenta",w);break}e.restore()}};function jP(e,t,i,o,a){const s=t.x,u=t.y-i-o/2;e.save(),e.fillStyle=a,e.strokeStyle=a,e.lineWidth=1.5,e.beginPath(),e.rect(s-o/2,u,o,o/2),e.fill(),e.beginPath(),e.moveTo(s-o/2,u),e.lineTo(s-o/4,u-o/3),e.lineTo(s-o/6,u),e.moveTo(s-o/6,u),e.lineTo(s,u-o/2),e.lineTo(s+o/6,u),e.moveTo(s+o/6,u),e.lineTo(s+o/4,u-o/3),e.lineTo(s+o/2,u),e.stroke(),e.restore()}function _a(e,t,i,o,a,s=!1,u=!1,c=!1,f=!1){o<th&&(i=i*.75),wh.render(e,t.x-i/2,t.y-i/2,i,i,0,"idle",a,o,[0,0],!1,0);let g,m;s?(g=IC,m=zv):u?(g=EC,m=Vv):c?(g=CC,m=jv):f&&(g=wC,m=Yv),g&&m&&jP(e,t,i/2,g,m)}function VP(e,t,i,o,a,s){if(e.save(),o.length===0){e.restore();return}const u=o.length*a,c=4;let f;const g=u+(o.length-1)*c;o.length>1&&g>s?f=(s-u)/(o.length-1):f=c,o.length<=1&&(f=0);for(let m=0;m<o.length;m++){const{member:v,isPlayer:T,isHeir:A,isPartner:I,isParent:y}=o[m],w=t+m*(a+f)+a/2,M=i+a/4;_a(e,{x:w,y:M},a,v.age,v.gender,T,A,I,y)}e.restore()}function XP(e,t,i,o,a){if(i.length===0)return;e.save();const s=Kn,u=" 00",c=" 00";e.font=`${jd}px "Press Start 2P", Arial`;const f=e.measureText(u).width,g=e.measureText(c).width,m=Kn+An+Kn+An+Kn+zi+f+Kn/2+zi+g,v=i.length*Vl+(i.length-1)*a0,T=a-v-Kn;e.fillStyle=RC,e.fillRect(s,T,m,v);for(let A=0;A<i.length;A++){const I=i[A],y=T+A*(Vl+a0),w=y+Vl/2;I.isPlayerTribe&&(e.fillStyle=_C,e.fillRect(s,y,m,Vl));let M=s+Kn;if(e.font=`${An}px "Press Start 2P", Arial`,e.textBaseline="middle",e.textAlign="left",e.fillText(I.tribeBadge,M,w-An/4),M+=An+Kn,!I.isPlayerTribe){const F=I.diplomacyStatus===Dt.Friendly?"":"",N=`diplomacyButton_${I.leaderId}`,b={x:M-2,y:w-An/2-2,width:An+4,height:An+4},B={id:N,action:ne.ToggleDiplomacy,rect:b,text:"",icon:F,backgroundColor:"transparent",textColor:"white",currentWidth:An,tooltip:`Toggle diplomacy with this tribe (Currently: ${I.diplomacyStatus})`,targetTribeId:I.leaderId};t.uiButtons.push(B),t.hoveredButtonId===N&&(e.fillStyle=fh,e.globalAlpha=.5,e.fillRect(b.x,b.y,b.width,b.height),e.globalAlpha=1),e.font=`${An*.8}px "Press Start 2P", Arial`,e.textBaseline="middle",e.textAlign="center",e.fillText(F,M+An/2,w)}M+=An+Kn,I.adultCount>0&&(_a(e,{x:M+zi/2,y:w},zi,25,"male"),M+=zi/2,e.font=`${jd}px "Press Start 2P", Arial`,e.fillStyle="white",e.textBaseline="middle",e.textAlign="left",e.fillText(` ${I.adultCount}`,M,w),M+=e.measureText(` ${I.adultCount}`).width+Kn/2),I.childCount>0&&(_a(e,{x:M+zi/2,y:w},zi,1,"female"),M+=zi/2,e.font=`${jd}px "Press Start 2P", Arial`,e.fillStyle="white",e.textBaseline="middle",e.textAlign="left",e.fillText(` ${I.childCount}`,M,w))}e.restore()}function KP(e,t,i,o,a){const s=rS,u=oS,c=t+o-s-u,f=i+u;e.save(),e.lineWidth=2,e.strokeStyle=a?tw:ew,e.beginPath();const g=5;e.moveTo(c+g,f+g),e.lineTo(c+s-g,f+s-g),e.moveTo(c+s-g,f+g),e.lineTo(c+g,f+s-g),e.stroke(),e.restore()}function ZP(e,t,i,o){const{tutorialState:a,tutorial:s}=t;if(a.transitionState===zt.INACTIVE)return;const u=s.steps[a.currentStepIndex];if(!u)return;e.save(),e.globalAlpha=a.transitionAlpha;const c=jC,f=VC,g=XC,m=`${Kd}px "Press Start 2P", Arial`,v=`${h0}px "Press Start 2P", Arial`,T=ZC,A=h0*1.5;e.font=v;const I=u.text.split(" ");let y="";const w=[];for(let ve=0;ve<I.length;ve++){const be=y+I[ve]+" ";e.measureText(be).width>c-f*2&&ve>0?(w.push(y),y=I[ve]+" "):y=be}w.push(y);const M=f*2+Kd+f/2+w.length*A,F=(i-c)/2,N=o-M-160;e.fillStyle=KC,e.beginPath(),e.moveTo(F+g,N),e.lineTo(F+c-g,N),e.quadraticCurveTo(F+c,N,F+c,N+g),e.lineTo(F+c,N+M-g),e.quadraticCurveTo(F+c,N+M,F+c-g,N+M),e.lineTo(F+g,N+M),e.quadraticCurveTo(F,N+M,F,N+M-g),e.lineTo(F,N+g),e.quadraticCurveTo(F,N,F+g,N),e.closePath(),e.fill(),e.fillStyle=T,e.textAlign="center",e.textBaseline="top",e.font=m,e.fillText(u.title,F+c/2,N+f),e.font=v;let b=N+f+Kd+f/2;for(const ve of w)e.fillText(ve,F+c/2,b),b+=A;const B=t.hoveredButtonId==="tutorial-dismiss";KP(e,F,N,c,B),e.restore();const L=rS,G=oS,Q=F+c-L-G,re=N+G;return{x:Q,y:re,width:L,height:L}}function gf(e,t,i){e.save();const o=JC,a={x:t.x-o,y:t.y-o,width:t.width+o*2,height:t.height+o*2};e.strokeStyle=nS,e.lineWidth=iS+Math.sin(i*hh)*1.5,e.setLineDash([8,8]),e.strokeRect(a.x,a.y,a.width,a.height),e.restore()}function qP(e,t){e.fillStyle="white",e.font='30px "Press Start 2P", Arial',e.textAlign="center",e.fillText("Game Over!",e.canvas.width/2,e.canvas.height/2-60),e.font='20px "Press Start 2P", Arial',e.fillText("Lineage Extinct.",e.canvas.width/2,e.canvas.height/2-20),e.fillText(`Cause: ${t.causeOfGameOver||"Unknown"}`,e.canvas.width/2,e.canvas.height/2+20)}const GS=10,QP=3,B0=GS*.7;function JP(e,t){const{position:i,food:o,maxFood:a}=t;if(e.beginPath(),e.arc(i.x,i.y,GS,0,Math.PI*2),e.fillStyle="#228B22",e.fill(),e.strokeStyle="#006400",e.lineWidth=1,e.stroke(),o.length>0){const s=Math.PI*2/Math.min(o.length,a);for(let u=0;u<o.length;u++){const c=u*s,f=i.x+B0*Math.cos(c),g=i.y+B0*Math.sin(c);e.beginPath(),e.arc(f,g,QP,0,Math.PI*2),e.fillStyle="#FF0000",e.fill()}}}const H0=(e,t,i=70,o=50)=>{const a=e>>t&255;return`hsl(${Math.floor(a/255*360)}, ${i}%, ${o}%)`},eN=(e,t)=>{const i=e.match(/hsl\((\d+),\s*(\d+)%,\s*(\d+)%\)/);if(!i)return e;const[o,a,s]=[parseInt(i[1]),parseInt(i[2]),parseInt(i[3])];return`hsl(${o}, ${a}%, ${Math.max(0,s-t)}%)`},uu=(e,t,i,o,a,s,u,c=!1)=>{e.save(),e.translate(t,i),e.rotate(s),e.fillStyle=c?eN(u,15):u,e.beginPath(),e.roundRect(-o/2,0,o,a,o/2),e.fill(),e.restore()},pf=(e,t)=>{const i=e.match(/hsl\((\d+),\s*(\d+)%,\s*(\d+)%\)/),o=75;if(!i)return`hsl(0, 0%, ${o}%)`;const[,a,s,u]=i.map(Number),c=s*(1-t),f=u+(o-u)*t;return`hsl(${a}, ${c}%, ${f}%)`},xS={name:"tribe-prey-2d",referenceImage:"swos.png",description:`A 2D prey asset for the Tribe game, featuring various stances and animations.

Prey is an animal which can be hunted by predators or humans in the Tribe game.

Preys look like small 4 leg mammals, with a simple and recognizable design. The characters are designed to be easily distinguishable and animated in a way that conveys their actions clearly.

# Visual style

Prey characters in the Tribe game are inspired by classic 2D pixel art, they look like Sensible Soccer players(Sensible Soccer game visual style is IMPORTANT), with a simple and recognizable design. The characters are designed to be easily distinguishable and animated in a way that conveys their actions clearly.

Character in Tribe game look like creatures from stone age, they have simple clothing, no shoes, and no modern accessories. The characters are designed to be easily distinguishable and animated in away that conveys their actions clearly.

Prey walks on all fours, unlike human (two legs).

Each prey is described by a unique gene code, which is a number that defines its appearance, size, and other characteristics. The gene code is used to generate the character's appearance, including body proportions, color, and other visual features. The gene code is a 32-bit integer, with each bit representing a specific characteristic of the character.

Prey should have should have visible body parts, such as head, torso, arms, and legs. The body parts should be connected and should not overlap. The character's body parts should be simple shapes, such as circles and rectangles, with solid colors and no gradients or patterns.

Preys are supposed to be sympathetic and friendly, so the character's face should have a friendly expression, with a smile and bright eyes. The character's eyes should be large and expressive, with a simple design.

# Technical details

The asset is rendered on a canvas using the CanvasRenderingContext2D API. The rendering function takes parameters for position, size, progress, stance, direction, gender, and age. The character can face left or right, and the rendering adapts based on the stance (e.g., idle, walk, eat, procreate).
The rendering function must be simple and efficient, it should not use complex patterns or gradients, and should focus on solid colors and basic shapes to maintain the pixel art aesthetic.

15% padding from all edges of the rendering box is required to ensure the character is not cut off during rendering.

Subtle shadow should be drawn under the a character to give it a sense of depth.

IMPORTANT: The character is visible from the side, just like in Sensible Soccer.

# Rendering parameters

- age: The age of the character, which affects the size and proportions of the body parts. Age is a number between 0 and 12, with 2 being the average age.
- gender:
  - 'male': Male prey are larger and more robust, with a more pronounced musculature.
  - 'female': Female prey are smaller and more agile, with a leaner build.
- isPregnant: (applicable only for females) Indicates if the character is pregnant, like very large belly. Pregnant characters should have a larger torso.
- direction: A vector indicating the character's facing direction. There should be at least 8 directions (like in Sensible Soccer): top left, top, top right, left, right, bottom left, bottom, bottom right. The character should be flipped horizontally if the direction vector's X component is negative.
             When moving up(top, top left, top right), the character back of the head should be visible, when moving down(Y > 0), the character face should be visible.
- hungryLevel: A number between 0 and 100 indicating how hungry the character is, hunger level 100 means the character is starving, 0 means the character is not hungry at all. So hungry characters should be thinner, with less body fat, and more pronounced muscles. The character's hunger level affects the size and proportions of the body parts, with hungrier characters being smaller and more gaunt.

# Rendering details

- All parts of the body must be connected
- Rendering must take into account direction vector (X and Y) to flip the character horizontally if needed
- The character's age affects the size and proportions of the body parts, with older characters being larger and more robust. Hair color should become gray for older characters.

# Stances

- 'idle': The character stands still, with a slight leg sway to indicate life.
- 'walk': The character moves forward, with legs and arms in motion.
- 'eat': The character holds food and brings it to their mouth, with a slight bend at the knees.
- 'procreate': The character performs a mating animation, with a specific pose and movement. There should be some additional visual effects to indicate this action, such as a slight glow or aura around the characters, or a dust particles to indicate movement.
- 'dead': The character lies on the ground, with limbs relaxed and a neutral expression, slowly turns into a grey skeleton over time. The character pose and body parts should not be animated in this stance, as the character is dead so it should not move.`,stances:["idle","walk","eat","dead","procreate"],render(e,t,i,o,a,s,u,c={gender:"male",age:2,direction:[1,0],isPregnant:!1,hungryLevel:0,geneCode:8405024}){e.save(),e.imageSmoothingEnabled=!1;const f=o*.15,g=t+o/2,m=i+a/2,v=o-f*2,T=a-f*2,{gender:A,age:I,direction:y,isPregnant:w,hungryLevel:M,geneCode:F}=c,N=.8+Math.min(I,10)/10*.4,b=A==="male"?1.05:.95,B=1-M/100*.3,L=v*.5*B*N*b;let G=T*.3*N*b;const Q=v*.15*N*b,re=L*.2,ve=T*.3,be=H0(F,0,30,50);let De=H0(F,8,50,40);if(I>45){const se=Math.min(1,(I-45)/15);De=pf(De,se)}e.translate(g,m),y[0]<0&&e.scale(-1,1);const Te=Math.sin(s*Math.PI*2),de=Math.cos(s*Math.PI*2),Be=ve+G*.2;if(u==="dead"){const se=Math.min(s,1);e.translate(0,T*.2),e.rotate(Math.PI/2);const Re=pf(De,se),Ce=pf(be,se);e.globalAlpha=.5+se*.5,e.strokeStyle=Re,e.lineWidth=re*.5,e.beginPath(),e.moveTo(-L*.4,0),e.lineTo(L*.4,0),e.stroke();for(let K=-1;K<=1;K+=1)e.beginPath(),e.arc(0,0,G*.4,Math.PI*.4*K-Math.PI*.2,Math.PI*.4*K+Math.PI*.2),e.stroke();e.fillStyle=Ce,e.beginPath(),e.arc(L*.5,0,Q,0,Math.PI*2),e.fill(),e.fillStyle="black",e.beginPath(),e.arc(L*.55,0,Q*.3,0,Math.PI*2),e.fill(),e.restore();return}e.fillStyle="rgba(0, 0, 0, 0.1)",e.beginPath(),e.ellipse(0,Be,L*.7,L*.25,0,0,2*Math.PI),e.fill();let Ae=0,le=0,Y=0,X=0,W=0,P=0;switch(u){case"idle":le=Te*(T*.02),Y=Te*.05,X=-Te*.05,W=-Te*.05,P=Te*.05;break;case"walk":le=Math.abs(de)*(T*-.04),Y=Te*.7,X=-Te*.7,W=-Te*.7,P=Te*.7;break;case"eat":Ae=T*.1,le=T*.05,Ae+=Te*(T*.02);break;case"procreate":le=T*.05;const se=(1-de)*-v*.05;e.translate(se,0),e.shadowColor="rgba(255, 182, 193, 0.9)",e.shadowBlur=10;break}w&&A==="female"&&(G*=1.6);const H=le,Z=H-G*.2;uu(e,L*-.35,Z,re,ve,W,De,!0),uu(e,L*.35,Z,re,ve,P,De,!0),e.fillStyle=De,e.beginPath(),e.ellipse(0,H,L/2,G/2,0,0,2*Math.PI),e.fill();const ee=L*.45,Ie=Z+Ae;e.fillStyle=be,e.beginPath(),e.arc(ee,Ie,Q,0,Math.PI*2),e.fill(),y[1]>=0&&(e.fillStyle="black",e.beginPath(),e.arc(ee+Q*.3,Ie-Q*.2,Q*.15,0,Math.PI*2),e.fill()),uu(e,L*-.35,Z,re,ve,Y,De),uu(e,L*.35,Z,re,ve,X,De),e.restore()}};function tN(e,t){let[i,o,a]=e.match(/\d+/g).map(Number);return i=Math.max(0,i-t),o=Math.max(0,o-t),a=Math.max(0,a-t),`rgb(${i}, ${o}, ${a})`}function nN(e){const t=(e&16711680)>>16,i=(e&65280)>>8,o=e&255,a=`rgb(${t}, ${i}, ${o})`,s=tN(a,40),u=(e&255)%100+50,c=(e>>8&255)%100,f=(e>>16&255)%100,g=`rgb(${u}, ${c}, ${f})`,m=(e&8388608)!==0?"#00aaff":"#ffaa00";return{furColor:a,darkerFurColor:s,skinColor:g,eyeColor:m}}const $S={name:"tribe-predator-2d",referenceImage:"swos.png",description:`A 2D predator asset for the Tribe game, featuring various stances and animations.

Predator is an animal which can hunt and attack humans in the Tribe game. It is designed to be a threat to the player, adding an element of danger and challenge to the game world.

Predator look like bears or wolves, with a simple and recognizable design. The characters are designed to be easily distinguishable and animated in a way that conveys their actions clearly.

# Visual style

Predator characters in the Tribe game are inspired by classic 2D pixel art, they look like Sensible Soccer players(Sensible Soccer game visual style is IMPORTANT), with a simple and recognizable design. The characters are designed to be easily distinguishable and animated in a way that conveys their actions clearly.

Character in Tribe game look like creatures from stone age, they have simple clothing, no shoes, and no modern accessories. The characters are designed to be easily distinguishable and animated in away that conveys their actions clearly.

Predator walks on arms and legs, unlike human (two legs).

Each predator is described by a unique gene code, which is a number that defines its appearance, size, and other characteristics. The gene code is used to generate the character's appearance, including body proportions, color, and other visual features. The gene code is a 32-bit integer, with each bit representing a specific characteristic of the character.

Predator should have visible ears, eyes, and mouth with teeth. It must have a tail. Front legs should be shorter than back legs, and they should be positioned closer to the body. The character's body should be wider at the top and narrower at the bottom, with a slight curve to the back. The character's head should be larger than the body, with a pronounced jaw and sharp teeth.

# Technical details

The asset is rendered on a canvas using the CanvasRenderingContext2D API. The rendering function takes parameters for position, size, progress, stance, direction, gender, and age. The character can face left or right, and the rendering adapts based on the stance (e.g., idle, walk, eat, procreate).
The rendering function must be simple and efficient, it should not use complex patterns or gradients, and should focus on solid colors and basic shapes to maintain the pixel art aesthetic.

15% padding from all edges of the rendering box is required to ensure the character is not cut off during rendering.

Subtle shadow should be drawn under the a character to give it a sense of depth.

IMPORTANT: The character is visible from the side, just like in Sensible Soccer.

# Rendering parameters

- age: The age of the character, which affects the size and proportions of the body parts. Age is a number between 1 and 20, with 3 being the average age.
- gender:
  - 'male': Male predators are larger and more robust, with a more pronounced musculature.
  - 'female': Female predators are smaller and more agile, with a leaner build.
- isPregnant: (applicable only for females) Indicates if the character is pregnant, like very large belly. Pregnant characters should have a larger torso.
- direction: A vector indicating the character's facing direction. There should be at least 8 directions (like in Sensible Soccer): top left, top, top right, left, right, bottom left, bottom, bottom right. The character should be flipped horizontally if the direction vector's X component is negative.
             When moving up(top, top left, top right), the character back of the head should be visible, when moving down(Y > 0), the character face should be visible.
- hungryLevel: A number between 0 and 100 indicating how hungry the character is, hunger level 100 means the character is starving, 0 means the character is not hungry at all. So hungry characters should be thinner, with less body fat, and more pronounced muscles. The character's hunger level affects the size and proportions of the body parts, with hungrier characters being smaller and more gaunt.

# Rendering details

- All parts of the body must be connected
- Rendering must take into account direction vector (X and Y) to flip the character horizontally if needed
- The character's age affects the size and proportions of the body parts, with older characters being larger and more robust. Hair color should become gray for older characters.

# Stances

- 'idle': The character stands still, with a slight leg sway to indicate life.
- 'walk': The character moves forward, with legs and arms in motion.
- 'eat': The character holds food and brings it to their mouth, with a slight bend at the knees.
- 'procreate': The character performs a mating animation, with a specific pose and movement. There should be some additional visual effects to indicate this action, such as a slight glow or aura around the characters, or a dust particles to indicate movement.
- 'attacking': The character performs an attack animation, with arms raised and a forward motion.
- 'dead': The character lies on the ground, with limbs relaxed and a neutral expression, slowly turns into a grey skeleton over time. The character pose and body parts should not be animated in this stance, as the character is dead so it should not move.`,stances:["idle","walk","eat","dead","attacking","procreate"],render(e,t,i,o,a,s,u,c={gender:"male",age:20,direction:[1,0],isPregnant:!1,hungryLevel:0,geneCode:8405024}){const{gender:f,age:g,direction:m,isPregnant:v,hungryLevel:T,geneCode:A}=c;e.save();const I=o*.15,y=Math.max(1,Math.floor((o-I*2)/10)),w=m[0]<0;e.translate(t+o/2,i+a/2),w&&e.scale(-1,1);const M=nN(A),F=.8+Math.min(g,20)/20*.4,N=f==="male"?1.05:.95,b=1-T/100*.25,B=F*N*b,L=Math.max(0,Math.min(1,(g-15)/5));e.filter=`grayscale(${L})`;const G=M.furColor,Q=M.darkerFurColor,re=M.eyeColor,ve="#FFFFFF",be="#c75c5c",De="#E0E0E0",Te="#A0A0A0",de=a/2-2*y,Be=Math.sin(s*Math.PI*2),Ae=Math.abs(Be);if(e.fillStyle="rgba(0,0,0,0.15)",e.beginPath(),e.ellipse(0,de,y*4,y,0,0,2*Math.PI),e.fill(),e.filter="none",u==="dead"){const nt=Math.min(1,s*2);e.save(),e.translate(0,de-y*3),e.rotate(-Math.PI/2);const qe=(xn,Kt,hn,$n,Wn=!1)=>{e.fillStyle=Wn?Te:De,e.fillRect(xn*y,Kt*y,hn*y,$n*y)};nt<1&&(e.globalAlpha=1-nt,e.fillStyle=G,e.beginPath(),e.ellipse(0,0,y*3,y*5,0,0,Math.PI*2),e.fill(),e.globalAlpha=1),nt>0&&(e.globalAlpha=nt,qe(-1,-4,2,2),qe(1,-3.5,1,1,!0),qe(-.5,-2,1,5,!0),qe(-2.5,-1,5,.5),qe(-2.5,0,5,.5),qe(-2.5,1,5,.5),qe(-3,-2,-1,2,!0),qe(3,-2,1,2),qe(-3,2,-1,2,!0),qe(3,2,1,2),e.globalAlpha=1),e.restore(),e.restore();return}e.fillStyle=G;let le=0,Y=0,X=0,W=[0,0,0,0];switch(u){case"idle":le=Be*y*.1;break;case"walk":const nt=Math.sin(s*Math.PI*4);le=Math.abs(nt)*-y*.5,W=[nt*y,-nt*y,-nt*y,nt*y];break;case"attacking":const qe=Math.sin(s*Math.PI*4);Y=y*2+qe*y,X=y*2,le=y;break;case"eat":X=y*3+Ae*y,le=y*1.5,e.fillStyle=be,e.fillRect(-y,de-y,y*2,y);break;case"procreate":le=Math.sin(s*Math.PI*8)*y*.3,e.fillStyle="rgba(139, 69, 19, 0.5)";for(let Kt=0;Kt<5;Kt++){const hn=(Math.random()-.5)*y*8,$n=de+(Math.random()-.5)*y*2;Ae>.5&&e.fillRect(hn,$n,y*.5,y*.5)}break}const P=y*3*B*(v?1.3:1),H=y*5*B,Z=-H/1.5,ee=de-P-y*2.5+le;e.fillStyle=G,e.beginPath(),e.moveTo(Z-y*.5,ee+P*.5),e.quadraticCurveTo(Z-y*3,ee-y,Z-y*2+Be*y,ee+P+y),e.fill();const Ie=y*1.2*B,se=y*3*B,Re=y*2.5*B,Ce=Z+H*.8,K=Z+H*.2;e.fillStyle=Q,e.fillRect(K,de-Re,Ie,Re+W[2]),e.fillRect(Ce,de-se,Ie,se+W[0]),e.fillStyle=G,e.beginPath(),e.moveTo(Z,ee+P),e.lineTo(Z,ee+y),e.quadraticCurveTo(Z+H/2,ee,Z+H,ee+y),e.lineTo(Z+H,ee+P),e.fill(),e.fillStyle=G,e.fillRect(K+y/2,de-Re,Ie,Re+W[3]),e.fillRect(Ce+y/2,de-se,Ie,se+W[1]);const ae=y*3.5*B,Ue=Z+H-ae*.3+Y,me=ee-ae*.3+X;e.fillStyle=G,e.beginPath(),e.arc(Ue,me,ae/2,0,Math.PI*2),e.fill(),e.beginPath(),e.ellipse(Ue+ae*.4,me+ae*.2,y*1.5,y,0,0,Math.PI*2),e.fill(),m[1]>=0&&(e.fillStyle=re,e.fillRect(Ue+y*.5,me-y*.5,y*.5,y*.5),u==="attacking"&&(e.fillStyle=ve,e.fillRect(Ue+ae*.5,me+ae*.4,y,y*.4))),e.fillStyle=Q,e.beginPath(),e.moveTo(Ue-ae*.4,me-ae*.3),e.lineTo(Ue,me-ae*.7),e.lineTo(Ue,me-ae*.2),e.fill(),e.restore()}},iN=9;function rN(e,t){const{position:i,gender:o,age:a,decayProgress:s,food:u,radius:c,originalEntityType:f,geneCode:g}=t;if(e.save(),e.globalAlpha=1-s,f==="human"?wh.render(e,i.x-c,i.y-c,c*2,c*2,s,"dead",o,a,[0,0],!1,0):f==="prey"?xS.render(e,i.x-c,i.y-c,c*2,c*2,s,"dead",{gender:o,age:a,direction:[0,0],isPregnant:!1,hungryLevel:0,geneCode:g||8405024}):f==="predator"&&$S.render(e,i.x-c,i.y-c,c*2,c*2,s,"dead",{gender:o,age:a,direction:[0,0],isPregnant:!1,hungryLevel:0,geneCode:g||8405024}),e.restore(),u.length>0){e.save(),e.font=`${iN}px Arial`,e.textAlign="center",e.textBaseline="middle";const m=_t*.9,v=Math.PI/Fv*3;u.forEach((T,A)=>{const I=A*v,y=i.x+m*Math.cos(I)*Math.atan2(A,A),w=i.y+m*Math.sin(I)*Math.atan2(A,A),M=eh[T.type];e.fillText(M,y,w)}),e.restore()}}function nr(e,t,i,o,a,s,u,c){e.save(),e.fillStyle=u,e.fillRect(t,i,o,a),e.fillStyle=c,e.fillRect(t,i,o*Math.max(0,s),a),e.restore()}function oN(e,t,i,o,a,s){if(e.save(),o.length===0){e.restore();return}const u=o.length*a;let c;u>s||u+(o.length-1)*4>s?c=(s-u)/(o.length-1):c=4,o.length===1&&(c=0);for(let f=0;f<o.length;f++){const g=eh[o[f].type];e.fillText(g,t+f*(a+c),i)}e.restore()}function sN(e,t,i,o,a){const s=t.autopilotControls.hoveredAutopilotAction;if(!s)return;let u,c=_t/2;const f=xu[s.action],g=lS[s.action],m=`${f} ${g}`;if("targetEntityId"in s){const v=t.entities.entities[s.targetEntityId];v&&(u=v.position,c=v.radius)}else"position"in s&&(u=s.position);if(u){bS(e,u,c,ch,dh,2,i,o,a,t.mapDimensions),e.save(),e.font=`${Vo}px "Press Start 2P", Arial`,e.fillStyle="white",e.textAlign="center",e.textBaseline="bottom",e.shadowColor="black",e.shadowBlur=5;const{x:v,y:T}=Yu(u,i,{width:o,height:a},t.mapDimensions),A=T-c-Gu-Vo/2;e.fillText(m,v,A),e.restore()}}function aN(e,t,i,o,a){e.save();const s=(Math.sin(a*hh)+1)/2,u=i+Gu+s*5;e.strokeStyle=ch,e.lineWidth=2,e.setLineDash(dh),e.beginPath(),e.arc(t.x,t.y,u,0,Math.PI*2),e.stroke(),e.setLineDash([]);const c=xu[o],f=lS[o];if(c){e.font=`${Vo*1.5}px "Press Start 2P", Arial`,e.textAlign="center",e.textBaseline="middle";const g=t.y-u-25;e.fillText(c,t.x,g),e.font=`${Vo*.8}px "Press Start 2P", Arial`,e.fillText(f,t.x,g+25)}e.restore()}function lN(e,t,i){e.save();const o=30,a=70,s=3,u=a/s;for(let c=0;c<s;c++){const f=c*u,g=(i*o+f)%a,m=1-g/a;e.strokeStyle=`rgba(255, 215, 0, ${m*.7})`,e.lineWidth=1+(1-m)*2,e.beginPath(),e.arc(t.x,t.y,g,0,Math.PI*2),e.stroke()}e.restore()}function uN(e,t){const{activeAutopilotAction:i,behaviors:o}=t.autopilotControls,a=pt(t);if(!a)return;const s=(u,c)=>{lN(u,c.position,t.time)};if(a.isCallingToFollow&&cn(e,t.mapDimensions.width,t.mapDimensions.height,s,{position:a.position}),o.followLeader&&!i&&cn(e,t.mapDimensions.width,t.mapDimensions.height,s,{position:a.position},70),i){let u,c=15;if("position"in i)u=i.position;else if("targetEntityId"in i){const f=t.entities.entities[i.targetEntityId];f&&(u=f.position,c=f.radius||30)}if(u&&i.action!==ce.AutopilotFollowMe&&!a.isCallingToFollow){const f=(g,m)=>{aN(g,m.position,c,i.action,t.time)};cn(e,t.mapDimensions.width,t.mapDimensions.height,f,{position:{...u}},u,c+30)}}}function b0(e,t,i,o,a,s,u=!0){const c=t.split(" ");let f="";const g=[];for(let m=0;m<c.length;m++){const v=f+c[m]+" ";e.measureText(v).width>a&&m>0?(g.push(f),f=c[m]+" "):f=v}if(g.push(f),u)for(let m=0;m<g.length;m++)e.fillText(g[m],i,o+m*s);return g.length*s}function cN(e){return 1-Math.pow(1-e,3)}function dN(e,t,i,o){t.notificationButtonRects={dismiss:{},view:{}};const a=t.notifications.filter(u=>!u.isDismissed);if(a.length===0)return;e.save();let s=o-cw;for(const u of a){const c=i-ql-Rr;e.font=`${Zd}px "Press Start 2P", Arial`;const f=c+Rr,g=ql-Rr*2,m=b0(e,u.message,-9999,-9999,g,Zd*1.2,!1),v=Rr*2+m+Zn,T=s-v,A=Date.now()-u.creationTime,I=Math.min(A/uw,1),y=cN(I),w=o,M=w+(T-w)*y;e.fillStyle=iw,e.beginPath(),e.roundRect(c,M,ql,v,nw),e.fill(),e.fillStyle=rw,e.textBaseline="top",b0(e,u.message,f,M+Rr,g,Zd*1.2,!0);const F=M+v-Zn-Rr/2,N=c+ql-Zn-Rr/2,b={x:N,y:F,width:Zn,height:Zn};t.notificationButtonRects&&(t.notificationButtonRects.dismiss[u.id]=b);const B=t.hoveredButtonId===`notification-dismiss-${u.id}`;if(e.fillStyle=B?m0:ow,e.font=`${Zn}px Arial`,e.textAlign="center",e.textBaseline="middle",e.fillText("",b.x+b.width/2,b.y+b.height/2),u.targetEntityIds||u.targetPosition||u.targetArea||u.targetRadius){const Q={x:N-Zn-p0,y:F,width:Zn,height:Zn};t.notificationButtonRects&&(t.notificationButtonRects.view[u.id]=Q);const re=t.hoveredButtonId===`notification-view-${u.id}`;e.fillStyle=re?m0:sw,e.font=`${Zn*(re?1.5:1.2)}px Arial`,e.fillText("",Q.x+Q.width/2,Q.y+Q.height/2)}s-=v+p0}e.restore()}function fN(e){return e.length===0?0:e.reduce((i,o)=>i+o,0)/e.length}function mf(e,t,i,o,a,s,u,c){e.save(),e.fillStyle="rgba(255, 255, 255, 0.1)",e.fillRect(o,a,s,u),e.strokeStyle="#555",e.lineWidth=1,e.strokeRect(o,a,s,u);const f=fN(i);e.fillStyle="white",e.font="11px monospace",e.textAlign="left",e.fillText(`${t}: ${f.toFixed(2)}ms`,o+Ve,a+Ve+8);const g=Math.max(...i,1),m=i.map(v=>v/g*u);if(e.beginPath(),e.strokeStyle=c,e.lineWidth=2,m.length>1){e.moveTo(o,a+u-m[0]);for(let v=1;v<m.length;v++){const T=o+v/(m.length-1)*s,A=a+u-m[v];e.lineTo(T,A)}}else if(m.length===1){const v=a+u-m[0];e.moveTo(o,v),e.lineTo(o+s,v)}e.stroke(),e.fillStyle="rgba(255, 255, 255, 0.7)",e.font="10px monospace",e.textAlign="right",e.fillText(`${g.toFixed(2)}ms`,o+s-Ve,a+Ve+8),e.restore()}function hN(e,t,i){const{performanceMetrics:o}=t;if(!o)return;const a=280,s=240,u=i-a-Ve,c=Ve+St*2;e.save(),e.fillStyle="rgba(0, 0, 0, 0.8)",e.fillRect(u,c,a,s),e.strokeStyle="#444",e.lineWidth=2,e.strokeRect(u,c,a,s),e.fillStyle="white",e.font="12px monospace",e.textAlign="left";let f=c+Ve+5;const g=u+Ve;e.fillStyle="#66ccff",e.font="bold 14px monospace",e.fillText(" Performance Debugger",g,f),f+=25,e.fillStyle="white",e.font="12px monospace";const m=gN(t);e.fillText(`FPS: ${m.toFixed(1)}`,g,f),f+=20;const v=a-Ve*2,T=45,A=10;mf(e,"Render",vf(t,"renderTime"),g,f,v,T,"#4CAF50"),f+=T+A,mf(e,"World Update",vf(t,"worldUpdateTime"),g,f,v,T,"#2196F3"),f+=T+A,mf(e,"AI Update",vf(t,"aiUpdateTime"),g,f,v,T,"#FFC107"),e.fillStyle="#888",e.font="10px monospace",e.textAlign="center",e.fillText("Press '2' to toggle this panel",u+a/2,c+s-10),e.restore()}function gN(e){const{performanceMetrics:t}=e;if(!t||t.history.length===0)return 0;const i=t.history[t.history.length-1].bucketTime/(Ct/wt);return t.history.filter(s=>i-s.bucketTime/(Ct/wt)<1).length}function pN(e,t){if(e.length===0)return[];const i=new Map;for(const s of e){const u=Math.floor(s.bucketTime/(Ct/wt));i.set(u,(i.get(u)||0)+s[t])}return Array.from(i.keys()).sort().map(s=>i.get(s)).slice(0,-1).slice(1).reverse()}function vf(e,t){return pN(e.performanceMetrics.history,t)}function mN(e,t,i,o){const{debugCharacterId:a,time:s}=t,u=500,c=Math.min(o*.9,800),f=i-u-10,g=Ve+St*2;e.save(),e.fillStyle="rgba(0, 0, 0, 0.9)",e.fillRect(f,g,u,c),e.strokeStyle="#444",e.lineWidth=2,e.strokeRect(f,g,u,c),e.fillStyle="white",e.font="12px monospace",e.textAlign="left",e.textBaseline="top";let m=g+20;const v=f+15;if(e.fillStyle="#66ccff",e.font="bold 14px monospace",e.fillText(" Behavior Tree Debugger",v,m),m+=25,!a){e.fillStyle="#888",e.font="12px monospace",e.fillText("No character selected for debugging.",v,m),e.fillText("Click on a character to inspect behavior.",v,m+20),e.restore();return}const T=t.entities.entities[a];if(!T){e.fillStyle="#ff4444",e.font="12px monospace",e.fillText(`Character #${a} not found (might be dead).`,v,m),e.restore();return}if(!T.aiBlackboard){e.fillStyle="#ffaa44",e.font="12px monospace",e.fillText(`Character #${a} has no AI Blackboard.`,v,m),e.restore();return}e.fillStyle="white",e.font="12px monospace",e.fillText(`Character: ${T.type} #${T.id} (${T.age.toFixed(1)}y)`,v,m),m+=20,vN(e,T,s,v,m,u-30,c-(m-g)-10),e.fillStyle="#888",e.font="10px monospace",e.textAlign="center",e.fillText("Press '~' to toggle this debugger",f+u/2,g+c-10),e.restore()}function vN(e,t,i,o,a,s,u){const c=t.aiBlackboard.nodeExecutionData,f=t.type==="human"?NS:t.type==="predator"?OS:t.type==="prey"?DS:null;if(!f)return;e.save(),e.beginPath(),e.rect(o-5,a,s+10,u),e.clip(),e.font=`${FC}px Arial`,e.textAlign="left",e.textBaseline="top";const g=v=>{switch(v){case E.SUCCESS:return UC;case E.FAILURE:return BC;case E.RUNNING:return HC;case E.NOT_EVALUATED:case null:default:return bC}},m=(v,T)=>{if(!v.name||!c[v.name])return T;let A=T;if(A>a+u)return A+Xd;const I=c[v.name],y=o+(v.depth??0)*LC;let w=E.NOT_EVALUATED,M=f0,F="";if(I){w=I.status,F=I.debugInfo;const B=xC/wt*Ct,L=i-I.lastExecuted,G=Math.max(0,1-L/B);M=jE(f0,GC,G),L>va&&(w=E.NOT_EVALUATED)}const N=g(w);e.fillStyle=N,e.fillText("",y,A),e.fillStyle=M;const b=` ${v.name}`+(F?`: ${F}`:"");if(e.fillText(b,y+8,A),I&&I.executionHistory.length>0){const{executionHistory:B}=I,L=tS/wt*Ct,G=i,Q=G-L,re=o+s-Kl-$C;let ve=re;const be=A+(Xd-Zl)/2,De=B.filter(W=>W.time<Q);let Te=De.length>0?De[De.length-1].status:null,de=Q;const Be=B.filter(W=>W.time>=Q&&W.time<=G),Ae=Kl/L;e.fillStyle="rgba(255, 255, 255, 0.1)",e.fillRect(re,be,Kl,Zl);for(const W of Be){const H=(W.time-de)*Ae;H>0&&(e.fillStyle=g(Te),e.fillRect(ve,be,H,Zl),ve+=H),Te=W.status,de=W.time}i-de>va&&(Te=E.NOT_EVALUATED);const Y=(G-de)*Ae;e.fillStyle=g(Te);const X=re+Kl-ve;e.fillRect(ve,be,Math.min(Y,X),Zl)}if(A+=Xd,v.children)for(const B of v.children)A=m(B,A);else v.child&&(A=m(v.child,A));return A};m(f,a),e.restore()}const SN={moving:"walk",gathering:"gathering",eating:"eat",feeding:"eat",procreating:"procreate",idle:"idle",attacking:"attacking",planting:"gathering",depositing:"gathering",retrieving:"gathering",takingOverBuilding:"attacking",destroyingBuilding:"attacking"};function yN(e,t){var c;const{radius:i,position:o,activeAction:a="idle"}=t,s=((c=t.stateMachine)==null?void 0:c[0])||"N/A",u=t.isAdult?_t+20:_t*.6+20;e.save(),e.fillStyle="white",e.font="10px Arial",e.textAlign="center",e.fillText(`Action: ${a}`,o.x,o.y-u),e.fillText(`State: ${s}`,o.x,o.y-u+10),e.fillText(`HP: ${t.hitpoints}`,o.x,o.y-u+20),e.fillText(`Cooldown: ${t.attackCooldown||"N/A"}`,o.x,o.y-u+30),e.fillText(`Tribe: ${t.leaderId||"N/A"}`,o.x,o.y-u+40),e.restore(),e.beginPath(),e.arc(o.x,o.y,i,0,Math.PI*2),e.strokeStyle="rgba(255, 0, 0, 0.5)",e.lineWidth=1,e.stroke(),e.closePath()}function AN(e,t,i,o,a){e.save(),e.font=`${Ff}px Arial`,e.textAlign="center",e.textBaseline="middle",e.fillText(i,t.x,t.y-(o?_t:ts)-Ff-a),e.restore()}function TN(e,t,i,o,a){const s=t.x,u=t.y-i-o/2;e.save(),e.fillStyle=a,e.strokeStyle=a,e.lineWidth=1.5,e.beginPath(),e.rect(s-o/2,u,o,o/2),e.fill(),e.beginPath(),e.moveTo(s-o/2,u),e.lineTo(s-o/4,u-o/3),e.lineTo(s-o/6,u),e.moveTo(s-o/6,u),e.lineTo(s,u-o/2),e.lineTo(s+o/6,u),e.moveTo(s+o/6,u),e.lineTo(s+o/4,u-o/3),e.lineTo(s+o/2,u),e.stroke(),e.restore()}function IN(e,t,i){var c;const{position:o,radius:a}=t,s=o.x-Vd/2,u=o.y-a-PC;if(((c=t.stateMachine)==null?void 0:c[0])===lr){const f=t.stateMachine[1],g=i-f.attackStartTime,m=Math.min(g/Hv,1);nr(e,s,u,Vd,l0,m,Ji,NC)}else if(t.attackCooldown&&t.attackCooldown>0){const f=1-t.attackCooldown/bu;nr(e,s,u,Vd,l0,f,Ji,DC)}}function EN(e,t,i){const a="";e.save(),e.font="15px Arial",e.textAlign="center",e.textBaseline="bottom",e.shadowColor="black",e.shadowBlur=3,e.fillText(a,t.x,t.y-i),e.restore()}function CN(e,t,i=!1,o=!1,a=!1,s=!1,u=!1,c=!1,f=!1,g=!1,m,v){const{position:T,activeAction:A="idle"}=t,I=t.isAdult?_t:_t*.6,y=SN[A]||"idle";wh.render(e,T.x-I,T.y-I,I*2,I*2,t.animationProgress||0,y,t.gender,t.age,[t.direction.x,t.direction.y],t.isPregnant??!1,t.hunger),c&&(e.save(),e.strokeStyle=uC,e.lineWidth=2,e.beginPath(),e.arc(T.x,T.y,I+3,0,2*Math.PI),e.stroke(),e.restore());let w,M;if(u?(w=dC,M=Vv):i?(w=cC,M=zv):a?(w=fC,M=lC):o?(w=hC,M=Yv):s&&(w=gC,M=jv),w&&M&&TN(e,T,I,w,M),t.tribeBadge&&AN(e,T,t.tribeBadge,t.isAdult??!1,w??0),f){let N=(t.isAdult?_t:ts)+5;w&&(N+=w),t.tribeBadge&&(N+=Ff),EN(e,T,N)}const F=g&&(v===void 0||t.id===v);IN(e,t,m),F&&yN(e,t)}const wN={grazing:"eat",moving:"walk",procreating:"procreate",feeding:"eat",idle:"idle"};function _N(e,t){var c;const{radius:i,position:o,activeAction:a="idle"}=t,s=((c=t.stateMachine)==null?void 0:c[0])||"N/A",u=t.isAdult?_t+20:_t*.6+20;e.save(),e.fillStyle="white",e.font="10px Arial",e.textAlign="center",e.fillText(`Action: ${a}`,o.x,o.y-u),e.fillText(`State: ${s}`,o.x,o.y-u+10),e.fillText(`HP: ${t.hitpoints}`,o.x,o.y-u+20),e.fillText(`Hunger: ${Math.round(t.hunger)}`,o.x,o.y-u+30),e.fillText(`Age: ${Math.round(t.age)}`,o.x,o.y-u+40),e.restore(),e.beginPath(),e.arc(o.x,o.y,i,0,Math.PI*2),e.strokeStyle="rgba(0, 255, 0, 0.5)",e.lineWidth=1,e.stroke(),e.closePath()}function RN(e,t,i=!1,o){var g,m;const{position:a,activeAction:s="idle"}=t,u=t.isAdult?t.radius:t.radius*.6,c=wN[s]||"idle";if(xS.render(e,a.x-u,a.y-u,u*2,u*2,t.animationProgress||0,c,{gender:t.gender,age:t.age,direction:[((g=t.direction)==null?void 0:g.x)||1,((m=t.direction)==null?void 0:m.y)||0],isPregnant:t.isPregnant??!1,hungryLevel:t.hunger,geneCode:t.geneCode}),t.hitpoints<t.maxHitpoints){const v=u*1.5,T=3,A=a.x-v/2,I=a.y-u-8;e.fillStyle="#555",e.fillRect(A,I,v,T);const y=t.hitpoints/t.maxHitpoints;e.fillStyle=y>.5?"#4CAF50":y>.25?"#FFC107":"#F44336",e.fillRect(A,I,v*y,T)}i&&(o===void 0||t.id===o)&&_N(e,t)}const PN={attacking:"attacking",eating:"eat",moving:"walk",procreating:"procreate",feeding:"eat",idle:"idle"};function NN(e,t){var c;const{radius:i,position:o,activeAction:a="idle"}=t,s=((c=t.stateMachine)==null?void 0:c[0])||"N/A",u=t.isAdult?_t+20:_t*.6+20;e.save(),e.fillStyle="white",e.font="10px Arial",e.textAlign="center",e.fillText(`Action: ${a}`,o.x,o.y-u),e.fillText(`State: ${s}`,o.x,o.y-u+10),e.fillText(`HP: ${t.hitpoints}`,o.x,o.y-u+20),e.fillText(`Hunger: ${Math.round(t.hunger)}`,o.x,o.y-u+30),e.fillText(`Age: ${Math.round(t.age)}`,o.x,o.y-u+40),e.restore(),e.beginPath(),e.arc(o.x,o.y,i,0,Math.PI*2),e.strokeStyle="rgba(255, 0, 0, 0.5)",e.lineWidth=1,e.stroke(),e.closePath()}function DN(e,t,i=!1,o){var g,m;const{position:a,activeAction:s="idle"}=t,u=t.isAdult?t.radius:t.radius*.6,c=PN[s]||"idle";if($S.render(e,a.x-u,a.y-u,u*2,u*2,t.animationProgress||0,c,{gender:t.gender,age:t.age,direction:[((g=t.direction)==null?void 0:g.x)||1,((m=t.direction)==null?void 0:m.y)||0],isPregnant:t.isPregnant??!1,hungryLevel:t.hunger,geneCode:t.geneCode}),t.hitpoints<t.maxHitpoints){const v=u*1.5,T=3,A=a.x-v/2,I=a.y-u-8;e.fillStyle="#555",e.fillRect(A,I,v,T);const y=t.hitpoints/t.maxHitpoints;e.fillStyle=y>.5?"#4CAF50":y>.25?"#FFC107":"#F44336",e.fillRect(A,I,v*y,T)}(t.attackCooldown&&t.attackCooldown>0||t.huntCooldown&&t.huntCooldown>0)&&(e.strokeStyle="#FF8C00",e.lineWidth=3,e.beginPath(),e.arc(a.x,a.y,u+3,0,2*Math.PI),e.stroke()),i&&(o===void 0||t.id===o)&&NN(e,t)}const WS=15;function ON(e,t,i,o,a=1.5){const s=i-t.startTime,u=Math.min(s/t.duration,1),c=1-u,g=1+Math.sin(u*Math.PI*2)*(a-1),m=WS*g;e.save(),e.globalAlpha=c,e.beginPath(),e.arc(t.position.x,t.position.y,Math.max(0,m),0,Math.PI*2),e.fillStyle=o,e.fill(),e.restore()}function _o(e,t,i,o,a=2){const s=i-t.startTime,u=Math.min(s/t.duration,1),c=1-u,f=WS*2*u;e.save(),e.globalAlpha=c,e.beginPath(),e.arc(t.position.x,t.position.y,f,0,Math.PI*2),e.strokeStyle=o,e.lineWidth=a,e.stroke(),e.restore()}function Vi(e,t,i,o){const a=i-t.startTime,s=Math.min(a/t.duration,1),u=1-s,c=-20*s;e.save(),e.globalAlpha=u,e.font="20px Arial",e.textAlign="center",e.fillText(o,t.position.x,t.position.y+c),e.restore()}function MN(e,t,i){switch(t.type){case he.Procreation:Vi(e,t,i,"");break;case he.Pregnant:ON(e,t,i,"rgba(255, 105, 180, 0.7)",1.2);break;case he.TargetAcquired:_o(e,t,i,"rgba(255, 0, 0, 0.8)",3);break;case he.Attack:Vi(e,t,i,"");break;case he.Partnered:Vi(e,t,i,"");break;case he.BushClaimed:_o(e,t,i,"rgba(0, 255, 0, 0.7)",2);break;case he.BushClaimLost:_o(e,t,i,"rgba(128, 128, 128, 0.7)",2);break;case he.Eating:Vi(e,t,i,"");break;case he.ChildFed:Vi(e,t,i,"");break;case he.AttackDeflected:Vi(e,t,i,"");break;case he.AttackResisted:Vi(e,t,i,"");break;case he.Hit:Vi(e,t,i,"");break;case he.SeizeBuildup:_o(e,t,i,"rgba(255, 215, 0, 0.8)",4);break;case he.Seize:_o(e,t,i,"rgba(148, 0, 211, 0.8)",4);break;case he.CallToAttack:_o(e,t,i,"rgba(255, 255, 0, 0.8)",4);break}}function G0(e,t,i,o,a,s,u){e.save();const{position:c}=t;e.strokeStyle=o,e.lineWidth=a+Math.sin(u*s)*(a/2),e.setLineDash([8,8]),e.beginPath(),e.arc(c.x,c.y,i,0,2*Math.PI),e.stroke(),e.restore()}const x0=8,kN=1.5,FN=.5,$0=2,LN="#5a5a5a",UN="#7e7e7e",BN="#8B0000",HN="#FF4444",bN=6;function Sf(e){const t=Math.sin(e)*1e4;return t-Math.floor(t)}function xf(e,t,i,o,a,s){const u=(t+i)*2,c=Math.floor(u/x0),f=-t/2,g=t/2,m=-i/2,v=i/2;for(let T=0;T<c;T++){const A=o+T*13,I=Sf(A),y=Sf(A+1);let w=T*x0,M=0,F=0;w<t?(M=f+w,F=m):w<t+i?(M=g,F=m+(w-t)):w<t*2+i?(M=g-(w-(t+i)),F=v):(M=f,F=v-(w-(t*2+i)));const N=(y-.5)*$0,b=(Sf(A+2)-.5)*$0;e.beginPath();const B=kN+I*FN;a?e.fillStyle=a:e.fillStyle=I>.5?s||UN:a||LN,e.ellipse(M+N,F+b,B,B*.85,y*Math.PI,0,Math.PI*2),e.fill(),a||(e.strokeStyle="#2b2b2b",e.lineWidth=1,e.stroke())}}function GN(e,t){if(!t.storedFood||t.storedFood.length===0)return;const{position:i,storedFood:o}=t;e.save(),e.font=`${bN}px Arial`,e.textAlign="center",e.textBaseline="middle",e.shadowColor="rgba(0,0,0,0.5)",e.shadowBlur=2,o.forEach(a=>{const s=eh[a.item.type],u={x:i.x+a.positionOffset.x,y:i.y+a.positionOffset.y};e.fillText(s,u.x,u.y)}),e.shadowBlur=0,e.shadowColor="transparent",e.restore()}function xN(e,t,i){const{position:o,width:a,height:s,constructionProgress:u,destructionProgress:c,isConstructed:f,isBeingDestroyed:g,id:m}=t,v=Pa[t.buildingType],T=pt(i),A=T&&Ln(T,t,i);e.save(),e.translate(o.x,o.y),f||(e.globalAlpha=.3+u*.7),A?xf(e,a,s,m,BN,HN):xf(e,a,s,m),e.globalAlpha=.5,e.font=`${Math.min(a,s,30)*.5}px Arial`,e.textAlign="center",e.textBaseline="middle",e.shadowColor="rgba(0,0,0,0.5)",e.shadowBlur=4,e.fillStyle="#FFFFFF",e.fillText(v.icon,0,0),e.shadowBlur=0,e.restore();const I=a,y=o.x-I/2,w=o.y+s/2+Vw;f?g&&nr(e,y,w,I,T0,1-c,Ji,jw):nr(e,y,w,I,T0,u,Ji,Yw),t.buildingType==="storageSpot"&&f&&GN(e,t)}function $N(e,t,i,o,a){const s=Pa[i],{width:u,height:c}=s.dimensions,f=(m,v)=>{m.save(),m.translate(v.x,v.y),m.globalAlpha=zw;const T=o?"#4CAF50":"#F44336";xf(m,u,c,9999,T),m.font=`${Math.min(u,c)*.5}px Arial`,m.textAlign="center",m.textBaseline="middle",m.fillStyle=T,m.fillText(s.icon,0,0),m.restore()},g={position:{...t},radius:Math.max(u,c)/2,id:0,type:"building",direction:{x:0,y:0},acceleration:0,forces:[],velocity:{x:0,y:0},debuffs:[]};cn(e,a.width,a.height,(m,v)=>f(m,v.position),g)}function WN(e,t,i,o,a){const s=pt(t),u=s?dn(t,s):[],c=zr(u),{width:f,height:g}=t.mapDimensions;Object.values(t.entities.entities).sort((I,y)=>i&&I.id===t.debugCharacterId&&I.id!==y.id||I.type==="building"&&y.type!=="building"?-1:I.position.y-y.position.y||I.id-y.id).filter(I=>au(I,o,a,t.mapDimensions)).forEach(I=>{var y,w;if(I.type==="building")cn(e,f,g,xN,I,t,s,t.time);else if(I.type==="berryBush")cn(e,f,g,JP,I,t,s,t.time);else if(I.type==="human"){const M=I,F=M.id===(s==null?void 0:s.id),N=u.some(ve=>ve.id===M.id),b=M.id===(c==null?void 0:c.id),B=s&&(M.id===s.motherId||M.id===s.fatherId),L=s&&(((y=M.partnerIds)==null?void 0:y.includes(s.id))||((w=s.partnerIds)==null?void 0:w.includes(M.id))),G=(s==null?void 0:s.attackTargetId)===M.id,Q=M.leaderId?t.entities.entities[M.leaderId]:void 0,re=s?M.leaderId===s.id&&M.activeAction==="moving"&&M.target===M.leaderId&&(Q==null?void 0:Q.isCallingToFollow):!1;cn(e,f,g,CN,M,F,B,N,L,b,G,re,i,t.time,t.debugCharacterId)}else I.type==="corpse"?cn(e,f,g,rN,I):I.type==="prey"?cn(e,f,g,RN,I,i,t.time,t.debugCharacterId):I.type==="predator"&&cn(e,f,g,DN,I,i,t.time,t.debugCharacterId)}),t.visualEffects.filter(I=>au(I,o,a,t.mapDimensions)).forEach(I=>{cn(e,f,g,MN,I,t.time)});const A=t.notifications.filter(I=>!I.isDismissed);for(const I of A)if(I.highlightedEntityIds&&I.renderHighlights)for(const y of I.highlightedEntityIds){const w=t.entities.entities[y];w&&au(w,o,a,t.mapDimensions)&&cn(e,f,g,G0,w,dw,fw,gw,hw,t.time)}if(t.tutorialState.isActive&&t.tutorialState.highlightedEntityIds.length>0)for(const I of t.tutorialState.highlightedEntityIds){const y=t.entities.entities[I];y&&au(y,o,a,t.mapDimensions)&&cn(e,f,g,G0,y,QC,nS,iS,hh,t.time)}}function zN(e,t,i,o,a,s){let u=null,c=null;e.textAlign="left";let f=Ve+St;const m=t.time/(Ct/wt)/Hu%1,v=js[Po.Time],T=25,A=Ve+T;e.fillText(v,Ve,f+an/2+St/3),nr(e,A,f,Wi,an,m,Ji,TC),f+=an+hi;const I=f+wr/2,y=f+(wr-an)/2,w=5;_a(e,{x:Ve*2,y:I},wr,5,i.gender,!1,!1,!1);const M=Ve+wr+w,F=Wi+T-(wr+w)*2;nr(e,M,y,F,an,Math.floor(i.age)/Sa,Ji,AC),_a(e,{x:M+F+w+wr/2,y:I},wr,Sa,i.gender,!1,!1,!1),f+=an+hi*2;const N=[],b=new Set;if(N.push({member:i,isPlayer:!0,isHeir:!1,isPartner:!1,isParent:!1}),b.add(i.id),o&&!b.has(o.id)&&(N.push({member:o,isPlayer:!1,isHeir:!0,isPartner:!1,isParent:!1}),b.add(o.id)),a.forEach(de=>{b.has(de.id)||(N.push({member:de,isPlayer:!1,isHeir:!1,isPartner:!0,isParent:!1}),b.add(de.id))}),s.forEach(de=>{b.has(de.id)||(N.push({member:de,isPlayer:!1,isHeir:!1,isPartner:!1,isParent:!1}),b.add(de.id))}),i.motherId&&!b.has(i.motherId)){const de=t.entities.entities[i.motherId];de&&(N.push({member:de,isPlayer:!1,isHeir:!1,isPartner:!1,isParent:!0}),b.add(de.id))}if(i.fatherId&&!b.has(i.fatherId)){const de=t.entities.entities[i.fatherId];de&&(N.push({member:de,isPlayer:!1,isHeir:!1,isPartner:!1,isParent:!0}),b.add(de.id))}const B=js[Po.Family],L=10,G=Ve+St+L,Q=Wi+T-(St+L),re=f+jl/2;e.font=`${St}px "Press Start 2P", Arial`,e.textBaseline="middle",e.fillText(B,Ve,re);const ve=f+jl/2;VP(e,G,ve,N,jl,Q),f+=jl+hi,e.textBaseline="alphabetic";const be=js[Po.Hitpoints];e.fillText(be,Ve,f+an/2+St/3),nr(e,A,f,Wi,an,i.hitpoints/i.maxHitpoints,Ji,yC),f+=an+hi;const De=js[Po.Hunger];e.fillText(De,Ve,f+an/2+St/3),nr(e,A,f,Wi,an,($r-i.hunger)/$r,Ji,SC),u={x:Ve,y:f-hi/2,width:Wi+T,height:an+hi},f+=an+hi,e.textBaseline="middle";const Te=js[Po.Food];return e.fillText(Te,Ve,f+Yl/2),oN(e,A,f+Yl/2,i.food,Yl,Wi),c={x:Ve,y:f-hi/5,width:Wi+T,height:Yl+hi},e.textBaseline="alphabetic",{hungerBarRect:u,foodBarRect:c}}let qs=[],W0=0;const YN=36,jN=200;function VN(e,t,i,o){const a=t.search.prey.count(),s=t.search.predator.count(),u=t.search.berryBush.count();t.time-W0>=YN&&(qs.push({time:t.time,prey:a,predators:s,bushes:u}),qs.length>jN&&(qs=qs.slice(-200)),W0=t.time);const c=Ke*tt,f=a/c*1e6,g=s/c*1e6,m=u/c*1e6,v=DP(),T=Math.floor(t.time/(24*365)),A=Math.floor(t.time%(24*365)/24),I=Math.floor(t.time%24),y=400,w=Math.min(o*.8,600),M=i-y-10,F=Ve+St*2;e.save(),e.fillStyle="rgba(0, 0, 0, 0.9)",e.fillRect(M,F,y,w),e.strokeStyle="#444",e.lineWidth=2,e.strokeRect(M,F,y,w),e.fillStyle="white",e.font="12px monospace",e.textAlign="left";let N=F+20;const b=14,B=M+15;e.fillStyle="#66ccff",e.font="bold 14px monospace",e.fillText(" Ecosystem Debugger",B,N),N+=25,e.fillStyle="white",e.font="12px monospace",e.fillText(`Game Time: Year ${T}, Day ${A}, Hour ${I}`,B,N),N+=b,e.fillText(`Map Size: ${Ke}  ${tt} pixels`,B,N),N+=20,e.fillStyle="#66ccff",e.font="bold 13px monospace",e.fillText(" Q-Learning Status",B,N),N+=18,v&&(e.fillText(`Q-Table Size: ${v.qTableSize} entries`,B,N),N+=b,e.fillText(`Exploration Rate: ${(v.explorationRate*100).toFixed(1)}%`,B,N),N+=b);const L=qs.slice(-20);L.length>1&&(e.fillStyle="#66ccff",e.font="bold 13px monospace",e.fillText(" Population Trends (Last 20 Points)",B,N),N+=30,XN(e,B,N,L),N+=50),e.fillStyle="#66ccff",e.font="bold 13px monospace",e.fillText(" Density (per 1000 px)",B,N),N+=18,e.fillStyle="white",e.font="12px monospace";const G=(Si/c*1e6).toFixed(2),Q=(yi/c*1e6).toFixed(2),re=(Ai/c*1e6).toFixed(2);e.fillText(`Prey: ${f.toFixed(2)} (target: ${G})`,B,N),N+=b,e.fillText(`Predators: ${g.toFixed(2)} (target: ${Q})`,B,N),N+=b,e.fillText(`Bushes: ${m.toFixed(2)} (target: ${re})`,B,N),N+=20,e.fillStyle="#66ccff",e.font="bold 13px monospace",e.fillText(" Current Population Status",B,N),N+=18,e.fillStyle="white",e.font="12px monospace";const ve=Math.round(a/Si*100),be=Math.round(s/yi*100),De=Math.round(u/Ai*100),Te=de=>de<50?"#ff4444":de<80?"#ffaa44":de>120?"#44aaff":"#44ff44";e.fillStyle=Te(ve),e.fillText(`Prey: ${a}/${Si} (${ve}%)`,B,N),N+=b,e.fillStyle=Te(be),e.fillText(`Predators: ${s}/${yi} (${be}%)`,B,N),N+=b,e.fillStyle=Te(De),e.fillText(`Bushes: ${u}/${Ai} (${De}%)`,B,N),N+=20,e.fillStyle="#66ccff",e.font="bold 13px monospace",e.fillText(" Current Parameters",B,N),N+=18,e.fillStyle="white",e.font="10px monospace",e.fillText("Prey:",B,N),N+=13,e.fillText(` Gestation: ${t.ecosystem.preyGestationPeriod.toFixed(1)}h`,B,N),N+=11,e.fillText(` Procreation: ${t.ecosystem.preyProcreationCooldown.toFixed(1)}h`,B,N),N+=11,e.fillText(` Hunger: ${t.ecosystem.preyHungerIncreasePerHour.toFixed(1)}/h`,B,N),N+=13,e.fillText("Predators:",B,N),N+=13,e.fillText(` Gestation: ${t.ecosystem.predatorGestationPeriod.toFixed(1)}h`,B,N),N+=11,e.fillText(` Procreation: ${t.ecosystem.predatorProcreationCooldown.toFixed(1)}h`,B,N),N+=11,e.fillText(` Hunger: ${t.ecosystem.predatorHungerIncreasePerHour.toFixed(1)}/h`,B,N),N+=13,e.fillText("Bushes:",B,N),N+=13,e.fillText(` Spread Chance: ${(t.ecosystem.berryBushSpreadChance*100).toFixed(1)}%`,B,N),N+=15,e.fillStyle="#888",e.font="10px monospace",e.textAlign="center",e.fillText("Press '1' to toggle this debugger",M+y/2,F+w-10),e.restore()}function XN(e,t,i,o){if(o.length<2)return;const c={prey:Math.max(...o.map(g=>g.prey),Si),predators:Math.max(...o.map(g=>g.predators),yi),bushes:Math.max(...o.map(g=>g.bushes),Ai)};[{data:o.map(g=>g.prey),color:"#44ff44",label:"Prey",target:Si,max:c.prey},{data:o.map(g=>g.predators),color:"#ff4444",label:"Predators",target:yi,max:c.predators},{data:o.map(g=>g.bushes),color:"#ffaa44",label:"Bushes",target:Ai,max:c.bushes}].forEach((g,m)=>{const v=t+m*115,T=i;e.fillStyle=g.color,e.font="10px monospace",e.fillText(g.label,v,T-5),e.strokeStyle="#333",e.lineWidth=1,e.strokeRect(v,T,100,30),e.beginPath(),e.strokeStyle=g.color;for(let I=0;I<g.data.length;I++){const y=v+I/(g.data.length-1)*100,w=T+30-g.data[I]/g.max*30;I===0?e.moveTo(y,w):e.lineTo(y,w)}e.stroke(),e.beginPath(),e.strokeStyle="#888",e.setLineDash([2,2]);const A=T+30-g.target/g.max*30;e.moveTo(v,A),e.lineTo(v+100,A),e.stroke(),e.setLineDash([])})}function KN(e,t){const i=t.search.human.byProperty("leaderId",e),o={total:i.length,children:0,males:0,females:0,old:0};for(const a of i)a.isAdult||o.children++,a.gender==="male"?o.males++:a.gender==="female"&&o.females++,a.age>=rh&&o.old++;return o}function ZN(e,t){const i=t.search,s=i.building.byProperty("ownerId",e).flatMap(g=>i.berryBush.byRadius(g.position,g.radius)).reduce((g,m)=>g+m.food.length,0),f=i.building.byProperty("ownerId",e).filter(g=>g.buildingType===ni.StorageSpot).reduce((g,m)=>{var v;return g+(((v=m.storedFood)==null?void 0:v.length)||0)},0);return{totalBushFood:s,totalStorageFood:f,consumptionRate:0}}function qN(e,t,i){const a=t.search.human.byProperty("leaderId",e),s=t.entities.entities,u=new Map,c=(m,v=new Set)=>{var A;if(u.has(m))return u.get(m);if(v.has(m))return m;v.add(m);const T=s[m];if(!T)return m;if(T.gender==="female"&&((A=T.partnerIds)!=null&&A.length)){const I=T.partnerIds.find(y=>{const w=s[y];return w&&w.gender==="male"});if(I){const y=c(I,v);return u.set(m,y),y}}if(T.fatherId&&s[T.fatherId]){const I=c(T.fatherId,v);return u.set(m,I),I}return u.set(m,m),m},f=new Map;for(const m of a){const v=c(m.id);f.has(v)||f.set(v,[]),f.get(v).push(m)}const g=[];for(const[m,v]of f.entries()){const T=s[m];T&&g.push({patriarch:T,memberCount:v.length,members:v.map(A=>A.id)})}return g.sort((m,v)=>v.memberCount-m.memberCount),g.slice(0,i)}let Qs=[],Qn=[],z0=0;const QN=36,Y0=200;function JN(e,t,i,o){var b;if(!t.debugCharacterId)return;const a=t.search.human.byProperty("id",t.debugCharacterId)[0];if(!a)return;let s=(b=Yr(a,t))==null?void 0:b.id;if(!s)return;const u=KN(s,t),c=ZN(s,t);if(t.time-z0>=QN){Qs.push({time:t.time,total:u.total,children:u.children,males:u.males,females:u.females,old:u.old});const B=c.totalBushFood+c.totalStorageFood;Qn.push({time:t.time,bushFood:c.totalBushFood,storageFood:c.totalStorageFood,totalFood:B}),Qs.length>Y0&&(Qs=Qs.slice(-200)),Qn.length>Y0&&(Qn=Qn.slice(-200)),z0=t.time}let f=0;if(Qn.length>=2){const B=Qn[Qn.length-1],L=Qn[Qn.length-2],G=B.time-L.time;G>0&&(f=(L.totalFood-B.totalFood)/G)}const g=400,m=Math.min(o*.9,700),v=i-g-10,T=Ve+St*2;e.save(),e.fillStyle="rgba(0, 0, 0, 0.9)",e.fillRect(v,T,g,m),e.strokeStyle="#444",e.lineWidth=2,e.strokeRect(v,T,g,m),e.fillStyle="white",e.font="12px monospace",e.textAlign="left";let A=T+20;const I=13,y=v+15;e.fillStyle="#66ccff",e.font="bold 14px monospace",e.fillText(" Tribe Debugger",y,A),A+=25,e.fillStyle="#66ccff",e.font="bold 13px monospace",e.fillText(" Population Over Time",y,A),A+=18,e.fillStyle="white",e.font="11px monospace",e.fillText(`Total: ${u.total}`,y,A),A+=I,e.fillStyle="#00ffff",e.fillText(`Children: ${u.children}`,y,A),A+=I,e.fillStyle="#4488ff",e.fillText(`Males: ${u.males}`,y,A),A+=I,e.fillStyle="#ff88ff",e.fillText(`Females: ${u.females}`,y,A),A+=I,e.fillStyle="#888888",e.fillText(`Old (${u.old})`,y,A),A+=20;const w=Qs.slice(-50);w.length>1&&(eD(e,y,A,w),A+=100),e.fillStyle="#66ccff",e.font="bold 13px monospace",e.fillText(" Food Metrics",y,A),A+=18;const M=c.totalBushFood+c.totalStorageFood;e.fillStyle="#ffff00",e.font="11px monospace",e.fillText(`Total Food: ${M}`,y,A),A+=I,e.fillStyle="#44ff44",e.fillText(`Bush Food: ${c.totalBushFood}`,y,A),A+=I,e.fillStyle="#ffaa44",e.fillText(`Storage Food: ${c.totalStorageFood}`,y,A),A+=I,e.fillStyle="#ff4444",e.fillText(`Consumption: ${f.toFixed(2)}/hour`,y,A),A+=20;const F=Qn.slice(-50);F.length>1&&(tD(e,y,A,F),A+=100),e.fillStyle="#66ccff",e.font="bold 13px monospace",e.fillText(" Top 5 Families",y,A),A+=18;const N=qN(s,t,5);e.fillStyle="white",e.font="11px monospace",N.length===0?(e.fillText("No families found",y,A),A+=I):N.forEach((B,L)=>{const Q=`${L+1}. ${B.patriarch.isPlayer?"Player":"#"+B.patriarch.id} (${B.memberCount} members, can split: ${$u(B.patriarch,t).canSplit})`;e.fillText(Q,y,A),A+=I}),A+=10,e.fillStyle="#888",e.font="10px monospace",e.textAlign="center",e.fillText("Press 'Shift+3' to toggle this debugger",v+g/2,T+m-10),e.restore()}function eD(e,t,i,o){if(o.length<2)return;const u=Math.max(...o.map(f=>Math.max(f.total,f.children,f.males,f.females,f.old)),10);e.strokeStyle="#333",e.lineWidth=1,e.strokeRect(t,i,350,80),[{data:o.map(f=>f.total),color:"#ffffff",label:"Total"},{data:o.map(f=>f.children),color:"#00ffff",label:"Children"},{data:o.map(f=>f.males),color:"#4488ff",label:"Males"},{data:o.map(f=>f.females),color:"#ff88ff",label:"Females"},{data:o.map(f=>f.old),color:"#888888",label:"Old"}].forEach(f=>{e.beginPath(),e.strokeStyle=f.color,e.lineWidth=2;for(let g=0;g<f.data.length;g++){const m=t+g/(f.data.length-1)*350,v=i+80-f.data[g]/u*80;g===0?e.moveTo(m,v):e.lineTo(m,v)}e.stroke()})}function tD(e,t,i,o){if(o.length<2)return;const u=Math.max(...o.map(f=>Math.max(f.totalFood,f.bushFood,f.storageFood)),10);e.strokeStyle="#333",e.lineWidth=1,e.strokeRect(t,i,350,80),[{data:o.map(f=>f.totalFood),color:"#ffff00",label:"Total"},{data:o.map(f=>f.bushFood),color:"#44ff44",label:"Bush"},{data:o.map(f=>f.storageFood),color:"#ffaa44",label:"Storage"}].forEach(f=>{e.beginPath(),e.strokeStyle=f.color,e.lineWidth=2;for(let g=0;g<f.data.length;g++){const m=t+g/(f.data.length-1)*350,v=i+80-f.data[g]/u*80;g===0?e.moveTo(m,v):e.lineTo(m,v)}e.stroke()})}function j0(e,t,i){e.save();const{x:o,y:a,width:s,height:u}=t.rect,c=Kv;if(e.beginPath(),e.moveTo(o+c,a),e.lineTo(o+s-c,a),e.quadraticCurveTo(o+s,a,o+s,a+c),e.lineTo(o+s,a+u-c),e.quadraticCurveTo(o+s,a+u,o+s-c,a+u),e.lineTo(o+c,a+u),e.quadraticCurveTo(o,a+u,o,a+u-c),e.lineTo(o,a+c),e.quadraticCurveTo(o,a,o+c,a),e.closePath(),e.fillStyle=t.isDisabled?Zv:t.backgroundColor,e.fill(),t.activated){e.save();const f=(Math.sin(Date.now()/1e3*eS)+1)/2;e.strokeStyle=Jv,e.lineWidth=2+f*2,e.globalAlpha=.7+f*.3,e.stroke(),e.restore()}if(t.lastActivated){const f=Date.now()-t.lastActivated;if(f<Ru){const g=1-f/Ru;e.fillStyle=Qv,e.globalAlpha=g,e.fill(),e.globalAlpha=1}}i&&!t.isDisabled&&(e.fillStyle=fh,e.globalAlpha=.5,e.fill(),e.globalAlpha=1),e.fillStyle=t.isDisabled?qv:t.textColor,t.icon?(e.font=`${u*.55}px "Press Start 2P", Arial`,e.textAlign="center",e.textBaseline="middle",e.fillText(t.icon,o+s/2,a+u/2),t.text&&(e.font=`${u*.18}px "Press Start 2P", Arial`,e.textAlign="right",e.textBaseline="bottom",e.fillText(t.text,o+s-4,a+u-2))):(e.font=`${St*1.5}px "Press Start 2P", Arial`,e.textAlign="center",e.textBaseline="middle",e.fillText(t.text,o+s/2,a+u/2)),e.restore()}function nD(e,t,i,o){e.save(),e.fillStyle="rgba(0, 0, 0, 0.6)",e.fillRect(0,0,i,o);const a=500,s=150,u=(i-a)/2,c=(o-s)/2;e.fillStyle=Yt,e.font=`${St*1.1}px "Press Start 2P", Arial`,e.textAlign="center",e.textBaseline="middle",e.fillText("Are you sure you want to exit",i/2,c+s/3-10),e.fillText("to the main menu?",i/2,c+s/3+10);const f=vi*1.5,g=Xv,m=c+s-g-Ve*2,v=20,T=f*2+v,A=u+(a-T)/2,I={id:"confirmExitYes",action:ne.ConfirmExitYes,rect:{x:A,y:m,width:f,height:g},text:"Yes",backgroundColor:qi,textColor:Yt,currentWidth:f},y=A+f+v,w={id:"confirmExitNo",action:ne.ConfirmExitNo,rect:{x:y,y:m,width:f,height:g},text:"No",backgroundColor:qi,textColor:Yt,currentWidth:f};t.uiButtons.push(I,w),j0(e,I,t.hoveredButtonId===I.id),j0(e,w,t.hoveredButtonId===w.id),e.restore()}const Nr=600,Ro=30,Jn=60,Nt=30,iD="";function rD(e,t,i){const o=[];if(!i.tribeControl||!i.leaderId)return o;const{width:a,height:s}=e.canvas,u=(a-Nr)/2,c=450,f=(s-c)/2;e.save(),e.fillStyle="rgba(0, 0, 0, 0.9)",e.beginPath(),e.roundRect(u,f,Nr,c,10),e.fill(),e.strokeStyle="#444",e.lineWidth=2,e.stroke(),e.fillStyle=Yt,e.font=`${St*1.2}px "Press Start 2P", Arial`,e.textAlign="center",e.textBaseline="top",e.fillText("Tribe Roles",u+Nr/2,f+Ro);const g=30,m=u+Nr-Ro-g,v=f+Ro,T=t.hoveredButtonId==="roleManager_close";e.fillStyle=T?"#ff7777":"#ff5555",e.fillRect(m,v,g,g),e.fillStyle="#ffffff",e.font="20px Arial",e.textAlign="center",e.textBaseline="middle",e.fillText("X",m+g/2,v+g/2),o.push({id:"roleManager_close",action:ne.CloseRoleManager,rect:{x:m,y:v,width:g,height:g},text:"X",currentWidth:g,backgroundColor:"#ff5555",textColor:"#ffffff"});const I=jo(i.leaderId,t).filter(re=>re.isAdult),y={[we.Leader]:0,[we.Gatherer]:0,[we.Planter]:0,[we.Hunter]:0,[we.Mover]:0,[we.Warrior]:0};I.forEach(re=>{re.tribeRole&&y[re.tribeRole]++});const w=i.tribeControl.roleWeights,M=[{role:we.Gatherer,emoji:"",name:"Gatherer"},{role:we.Planter,emoji:"",name:"Planter"},{role:we.Hunter,emoji:"",name:"Hunter"},{role:we.Mover,emoji:"",name:"Mover"},{role:we.Warrior,emoji:"",name:"Warrior"}];let F=0;M.forEach(re=>{F+=w[re.role]||0});let N=f+Ro+70;const b=u+Ro,B=u+Nr-Ro;M.forEach(re=>{const ve=w[re.role]||0,be=F>0?Math.round(ve/F*100):0,De=y[re.role]||0;e.textAlign="left",e.textBaseline="middle",e.font=`${St*.8}px "Press Start 2P", Arial`,e.fillStyle=Yt,e.fillText(`${re.emoji} ${De} ${re.name}`,b,N+Jn/2);const Te=u+220,de=Te+Nt+15,Ae=de+200+15,le=`role_minus_${re.role}`,Y=t.hoveredButtonId===le,X=ve<=0,W=X?"#555":Y?"#dd6666":"#cc4444";e.fillStyle=W,e.fillRect(Te,N+(Jn-Nt)/2,Nt,Nt),e.fillStyle=X?"#888":"#fff",e.textAlign="center",e.fillText("-",Te+Nt/2,N+Jn/2+2),o.push({id:le,action:ne.DecreaseRoleWeight,targetRole:re.role,rect:{x:Te,y:N+(Jn-Nt)/2,width:Nt,height:Nt},text:"-",currentWidth:Nt,backgroundColor:W,textColor:"#fff",isDisabled:X}),e.textAlign="left",e.font="16px Arial",e.fillStyle="#fff";let P=de;for(let se=0;se<ve;se++)e.fillText(iD,P,N+Jn/2+2),P+=18;const H=`role_plus_${re.role}`,Z=t.hoveredButtonId===H,ee=ve>=10,Ie=ee?"#555":Z?"#66dd66":"#44cc44";e.fillStyle=Ie,e.fillRect(Ae,N+(Jn-Nt)/2,Nt,Nt),e.fillStyle=ee?"#888":"#fff",e.textAlign="center",e.font=`${St*.8}px "Press Start 2P", Arial`,e.fillText("+",Ae+Nt/2,N+Jn/2+4),o.push({id:H,action:ne.IncreaseRoleWeight,targetRole:re.role,rect:{x:Ae,y:N+(Jn-Nt)/2,width:Nt,height:Nt},text:"+",currentWidth:Nt,backgroundColor:Ie,textColor:"#fff",isDisabled:ee}),e.textAlign="right",e.font=`${St*.8}px "Press Start 2P", Arial`,e.fillStyle=Yt,e.fillText(`${be}%`,B,N+Jn/2),N+=Jn});const L=y[we.Leader],G=Object.values(y).reduce((re,ve)=>re+ve,0),Q=I.length-G;return e.textAlign="center",e.fillStyle="#aaa",e.font=`${St*.6}px "Press Start 2P", Arial`,e.fillText(`Adults: ${I.length} | Leader: ${L} | Assigned: ${G} | Unassigned: ${Q}`,u+Nr/2,N+10),e.fillText("(Adjust weights to control role distribution)",u+Nr/2,N+30),e.restore(),o}function Du(e,t,i,o,a,s=!1){var f;if(e.save(),e.clearRect(0,0,e.canvas.width,e.canvas.height),e.fillStyle="#2c5234",e.fillRect(0,0,e.canvas.width,e.canvas.height),e.translate(e.canvas.width/2-i.x,e.canvas.height/2-i.y),!s&&t.gameOver){e.restore(),qP(e,t);return}WN(e,t,t.debugPanel===je.General,i,a);const u=pt(t);if(u&&t.selectedBuildingType&&t.selectedBuildingType!=="removal"&&t.mousePosition){const g=Gf(t.mousePosition,i,a,t.mapDimensions),m=Sh(g,t.selectedBuildingType,u.leaderId,t);$N(e,g,t.selectedBuildingType,m,t.mapDimensions)}const c=t.notifications.filter(g=>!g.isDismissed);for(const g of c){const m=(Math.sin(t.time*lw)+1)/2;e.globalAlpha=m*.5+.25,e.fillStyle=aw,g.targetArea&&e.fillRect(g.targetArea.x,g.targetArea.y,g.targetArea.width,g.targetArea.height),g.targetRadius&&(e.beginPath(),e.arc(g.targetRadius.x,g.targetRadius.y,g.targetRadius.radius,0,Math.PI*2),e.fill())}if(e.globalAlpha=1,uN(e,t),e.restore(),!s){e.fillStyle=pC,e.font=`${St}px "Press Start 2P", Arial`,e.shadowColor=mC,e.shadowBlur=vC,t.uiButtons=[];let g=null,m=null;if(u){const A=dn(t,u),I=zr(A),y=((f=u.partnerIds)==null?void 0:f.map(M=>t.entities.entities[M]).filter(M=>M!==void 0))||[],w=zN(e,t,u,I,y,A);g=w.hungerBarRect,m=w.foodBarRect}const v=xv(t,u==null?void 0:u.leaderId);XP(e,t,v,e.canvas.width,e.canvas.height);const{commandButtonsRect:T}=LP(e,t,e.canvas.width);if(e.shadowColor="transparent",e.shadowBlur=0,u&&(sN(e,t,i,e.canvas.width,e.canvas.height),o.length>0&&bP(e,o,u,i,e.canvas.width,e.canvas.height,t.mapDimensions)),t.tutorialState.activeUIHighlights.length>0){const{activeUIHighlights:A}=t.tutorialState;A.includes(br.HUNGER_BAR)&&g&&gf(e,g,t.time),A.includes(br.FOOD_BAR)&&m&&gf(e,m,t.time),A.includes(br.COMMAND_BUTTONS)&&T&&gf(e,T,t.time)}if(t.tutorialState.isActive){const A=ZP(e,t,e.canvas.width,e.canvas.height);A&&t.uiButtons.push({id:"tutorial-dismiss",action:ne.DismissTutorial,rect:A,text:"",currentWidth:A.width,backgroundColor:"transparent",textColor:"transparent"})}switch(dN(e,t,e.canvas.width,e.canvas.height),t.debugPanel){case je.Ecosystem:VN(e,t,e.canvas.width,e.canvas.height);break;case je.Tribe:JN(e,t,e.canvas.width,e.canvas.height);break;case je.Performance:hN(e,t,a.width);break;case je.General:mN(e,t,e.canvas.width,e.canvas.height);break}if(t.roleManagerOpen&&u&&u.leaderId===u.id){const A=rD(e,t,u);t.uiButtons.push(...A)}t.isPaused&&t.exitConfirmation!=="pending"&&UP(e),t.exitConfirmation==="pending"&&nD(e,t,e.canvas.width,e.canvas.height)}}const oD=wn.div`
  position: relative;
  width: 100vw;
  height: 100vh;
  overflow: hidden;
`,sD=wn.canvas`
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background-color: #2c5234;
`,aD=wn.div`
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  text-align: center;
  z-index: 1;
  background: linear-gradient(to bottom, rgba(0, 0, 0, 0.7) 0%, rgba(0, 0, 0, 0) 50%, rgba(0, 0, 0, 0.7) 100%);
`,lD=wn.h1`
  font-family: 'Press Start 2P', cursive;
  font-size: 4rem;
  color: #fff;
  text-shadow: 4px 4px 0px #ff0000;
  margin-bottom: 2rem;
`,V0=wn.button`
  font-family: 'Press Start 2P', cursive;
  font-size: 1.5rem;
  padding: 1rem 2rem;
  color: #fff;
  background-color: #ff0000;
  border: 2px solid #fff;
  box-shadow: 4px 4px 0px #fff;
  cursor: pointer;
  transition: all 0.2s ease-in-out;

  &:hover {
    background-color: #fff;
    color: #ff0000;
    box-shadow: 4px 4px 0px #ff0000;
  }
`,uD=wn.div`
  display: flex;
  flex-direction: column;
  gap: 1.5rem;
  align-items: center;
`,cD=wn.div`
  position: absolute;
  bottom: 1rem;
  font-family: 'Press Start 2P', cursive;
  font-size: 0.8rem;
  color: #fff;
  text-shadow: 2px 2px 0px #000;
  a {
    color: #fff;
    text-decoration: none;
    &:hover {
      text-decoration: underline;
    }
  }
`,cu="intro-soundtrack",X0=()=>{const{setAppState:e,savedGameState:t,clearCurrentSave:i}=Jo(),o=Oe.useRef(null),a=Oe.useRef(null),s=Oe.useRef(HR()),u=Oe.useRef(),c=Oe.useRef(s.current.viewportCenter),f=Oe.useRef(),g=Oe.useCallback(()=>{ef(cu,2),i(),e("game")},[e,i]),m=Oe.useCallback(()=>{t&&(ef(cu,2),e("game"))},[e,t]);Oe.useEffect(()=>{const A=I=>{(I.key==="Enter"||I.key===" ")&&(t?m():g())};return window.addEventListener("keydown",A),()=>{window.removeEventListener("keydown",A)}},[g,m,t]),Oe.useEffect(()=>(ph(ge.SoundTrack1,{loop:!0,trackId:cu}),()=>{ef(cu,2)}),[]),Oe.useEffect(()=>{const A=o.current;if(!A)return;a.current=A.getContext("2d");const I=()=>{A&&a.current&&(A.width=window.innerWidth,A.height=window.innerHeight,Du(a.current,s.current,c.current,[],{width:A.width,height:A.height},!0))};return I(),window.addEventListener("resize",I),()=>window.removeEventListener("resize",I)},[]),Oe.useEffect(()=>{const A=()=>{const y=Wv(s.current);if(y.length>0){const w=Math.floor(Math.random()*y.length);f.current=y[w].id}};A();const I=setInterval(A,pI);return()=>clearInterval(I)},[]);const[v,T]=wv(A=>{var w,M;if(!a.current)return;if(u.current===void 0){u.current=A;return}const I=Math.min((A-u.current)/1e3,1);s.current=zu(s.current,I);const y=f.current?s.current.entities.entities[f.current]:void 0;if(y){const{mapDimensions:F}=s.current,{width:N,height:b}=F;let B={...y.position};const L=B.x-c.current.x;Math.abs(L)>N/2&&(L>0?B.x-=N:B.x+=N);const G=B.y-c.current.y;Math.abs(G)>b/2&&(G>0?B.y-=b:B.y+=b);let Q=lh(c.current,B,Jf*I);Q={x:(Q.x%N+N)%N,y:(Q.y%b+b)%b},c.current=Q}Du(a.current,s.current,c.current,[],{width:((w=o.current)==null?void 0:w.width)||800,height:((M=o.current)==null?void 0:M.height)||600},!0),u.current=A});return Oe.useEffect(()=>(T(),v),[T,v]),Le.jsxs(oD,{children:[Le.jsx(sD,{ref:o}),Le.jsxs(aD,{children:[Le.jsx(lD,{children:"Tribe2"}),Le.jsxs(uD,{children:[Le.jsx(V0,{onClick:g,children:"New Game"}),t&&Le.jsx(V0,{onClick:m,children:"Load Game"})]}),Le.jsxs(cD,{children:["by"," ",Le.jsx("a",{href:"https://github.com/gtanczyk",target:"_blank",rel:"noopener noreferrer",children:"gtanczyk"})]})]})]})};function dD(){console.log("Tribe game initialized with detailed 2D world state.");const e=BR();return e.ecosystem={preyGestationPeriod:Fr,preyProcreationCooldown:Lr,predatorGestationPeriod:Ur,predatorProcreationCooldown:Br,preyHungerIncreasePerHour:er,predatorHungerIncreasePerHour:tr,berryBushSpreadChance:Ti},e.debugPanel=je.None,e.performanceMetrics={currentBucket:{renderTime:0,worldUpdateTime:0,aiUpdateTime:0},history:[]},e}const fD=({canvasRef:e,ctxRef:t,gameStateRef:i,viewportCenterRef:o,playerActionHintsRef:a})=>(Oe.useEffect(()=>{const s=e.current;if(!s)return;t.current=s.getContext("2d");const u=()=>{s&&t.current&&i.current&&(s.width=window.innerWidth,s.height=window.innerHeight,Du(t.current,i.current,o.current,a.current,{width:s.width,height:s.height},!1))};return u(),window.addEventListener("resize",u),()=>window.removeEventListener("resize",u)},[]),Le.jsx("canvas",{ref:e,style:{display:"block",background:"#2c5234"}})),hD=(e,t,i,o=!1)=>{var u;let a;const s=sC(e,i);if(s){if(t.isAdult&&s.type==="berryBush"&&s.food.length>0)a={action:ce.AutopilotGather,targetEntityId:s.id};else if(t.isAdult&&s.type==="corpse"&&s.food.length>0)a={action:ce.AutopilotGather,targetEntityId:s.id};else if(s.type==="human"){const c=s;t.isAdult&&ns(t,c,i)?a={action:ce.AutopilotAttack,targetEntityId:c.id}:jr(t,c,i)?a={action:ce.AutopilotProcreate,targetEntityId:c.id}:t.food.length>0&&!c.isAdult&&(c.motherId===t.id||c.fatherId===t.id)&&(a={action:ce.AutopilotFeedChild,targetEntityId:c.id})}else if(s.type==="prey")a={action:ce.AutopilotAttack,targetEntityId:s.id};else if(s.type==="predator")a={action:ce.AutopilotAttack,targetEntityId:s.id};else if(s.type==="building"){const c=s;if(i.selectedBuildingType==="removal")a={action:ce.Removal,position:s.position};else if(c.buildingType==="storageSpot"){const f=c.ownerId===t.leaderId,g=c.storedFood!==void 0&&c.storedFood.length>0,m=c.storedFood!==void 0&&c.storageCapacity!==void 0&&c.storedFood.length<c.storageCapacity;if(o&&c.isConstructed&&g&&t.food.length<t.maxFood)if(f)a={action:ce.AutopilotRetrieve,targetEntityId:s.id};else{const v=t.leaderId?i.entities.entities[t.leaderId]:void 0;v&&((u=v.tribeControl)!=null&&u.diplomacy)?v.tribeControl.diplomacy[c.ownerId]===Dt.Hostile?a={action:ce.AutopilotGather,targetEntityId:s.id}:a={action:ce.AutopilotMove,position:e}:a={action:ce.AutopilotMove,position:e}}else f&&c.isConstructed?t.food.length>0&&m?a={action:ce.AutopilotDeposit,targetEntityId:s.id}:t.food.length<t.maxFood&&g?a={action:ce.AutopilotRetrieve,targetEntityId:s.id}:a={action:ce.AutopilotMove,position:e}:a={action:ce.AutopilotMove,position:e}}else c.buildingType==="plantingZone"&&t.food.filter(f=>f.type===Hn.Berry).length>=Gr&&!bn(e,i,xr)?a={action:ce.AutopilotPlant,position:e}:a={action:ce.AutopilotMove,position:e}}}else t.food.filter(c=>c.type===Hn.Berry).length>=Gr&&(i.autopilotControls.isManuallyPlanting||u_(e,t,i))?a={action:ce.AutopilotPlant,position:e}:a={action:ce.AutopilotMove,position:e};return a},gD=(e,t)=>{if(e.isPaused)return;const i=pt(e);if(!i)return;if(e.selectedBuildingType&&e.selectedBuildingType!=="removal"){Sh(t,e.selectedBuildingType,i.leaderId,e)&&(Bf(t,e.selectedBuildingType,i.leaderId,e),e.selectedBuildingType=null);return}if(e.selectedBuildingType==="removal"){const a=qw(t,e);a&&Zw(a.id,e);return}const o=e.autopilotControls.hoveredAutopilotAction;e.autopilotControls.activeAutopilotAction=void 0,o?(e.autopilotControls.activeAutopilotAction=o,(o.action===ce.AutopilotMove||o.action===ce.AutopilotGather)&&(e.hasPlayerMovedEver=!0),o.action===ce.AutopilotPlant&&(e.hasPlayerPlantedBush=!0)):e.autopilotControls.activeAutopilotAction={action:ce.AutopilotMove,position:t},e.autopilotControls.isManuallyMoving=!1,e.autopilotControls.isManuallyPlanting=!1},pD=(e,t)=>{var u,c,f,g,m,v;const i=e.key.toLowerCase(),o=e.ctrlKey||e.metaKey;let a=!0,s=t;if(o){switch(i){case"s":Yf(t);break;default:a=!1;break}return{newState:s,handled:a}}switch(i){case"escape":const{autopilotControls:T}=t;T.activeAutopilotAction||T.isManuallyMoving||T.isManuallyPlanting||t.buildMenuOpen||t.selectedBuildingType?(T.activeAutopilotAction=void 0,T.isManuallyMoving=!1,T.isManuallyPlanting=!1,t.buildMenuOpen=!1,t.selectedBuildingType=null):s.exitConfirmation==="pending"?(s.exitConfirmation="inactive",s.isPaused=!1):(s.exitConfirmation="pending",s.isPaused=!0);break;case"u":const A=pt(t);A&&A.isAdult&&A.leaderId===A.id&&(t.roleManagerOpen=!t.roleManagerOpen);break;case"m":t.isMuted=!t.isMuted,aa(t.masterVolume,t.isMuted);break;case"=":case"+":const I=Math.min(1,t.masterVolume+.1);t.masterVolume=parseFloat(I.toFixed(1)),aa(t.masterVolume,t.isMuted);break;case"-":const y=Math.max(0,t.masterVolume-.1);t.masterVolume=parseFloat(y.toFixed(1)),aa(t.masterVolume,t.isMuted);break;case"t":s=zu(t,aS);break;case" ":case"p":t.isPaused=!t.isPaused;break;case"":case"`":s.debugPanel===je.General?(s.debugPanel=je.None,s.debugCharacterId=void 0):(s.debugPanel=je.General,s.debugCharacterId||(s.debugCharacterId=((u=pt(s))==null?void 0:u.id)??((c=Object.values(s.entities.entities).find(w=>w.type==="human"||w.type==="prey"||w.type==="predator"))==null?void 0:c.id)));break;case"!":if(e.shiftKey){if(s.debugPanel===je.Ecosystem){s.debugPanel=je.None;break}s.debugPanel=je.Ecosystem,s.debugCharacterId||(s.debugCharacterId=((f=pt(s))==null?void 0:f.id)??((g=Object.values(s.entities.entities).find(w=>w.type==="human"||w.type==="prey"||w.type==="predator"))==null?void 0:g.id))}else a=!1;break;case"#":if(e.shiftKey&&s.debugPanel===je.Tribe){s.debugPanel=je.None;break}s.debugPanel=je.Tribe,s.debugCharacterId?a=!1:s.debugCharacterId=((m=pt(s))==null?void 0:m.id)??((v=s.search.human.all().find(w=>w.leaderId===w.id))==null?void 0:v.id);break;case"@":if(e.shiftKey){if(s.debugPanel===je.Performance){s.debugPanel=je.None;break}s.debugPanel=je.Performance}else a=!1;break;case"tab":if(s.debugPanel!==je.General&&s.debugPanel!==je.Tribe&&(s.debugPanel=je.General),s.debugPanel===je.General){const w=Object.values(s.entities.entities).filter(M=>M.type==="human"||M.type==="prey"||M.type==="predator");if(w.length>0){const M=w.sort((B,L)=>{if(B.type==="human"&&B.isPlayer)return-1;if(L.type==="human"&&L.isPlayer)return 1;if(B.type!==L.type){const G={human:0,prey:1,predator:2},Q=G[B.type]??999,re=G[L.type]??999;return Q-re}return B.id-L.id}),F=s.debugCharacterId,b=((F?M.findIndex(B=>B.id===F):-1)+1)%M.length;s.debugCharacterId=M[b].id}else s.debugCharacterId=void 0}else if(s.debugPanel===je.Tribe){const w=s.search.human.all().filter(F=>F.leaderId===F.id);let M=w.findIndex(F=>F.id===s.debugCharacterId)+1;(M===-1||M>=w.length-1)&&(M=0),s.debugCharacterId=w[M].id}else s.debugPanel=je.None,s.debugCharacterId=void 0;break;default:a=!1;break}return{newState:s,handled:a}},mD=(e,t,i,o,a)=>{const s={gameState:i};if(t&&["e","b","r","h"].includes(e)&&i.hasPlayerEnabledAutopilot++,i.buildMenuOpen){if(e==="1"){i.selectedBuildingType="storageSpot",_e(s,ge.ButtonClick,o.position);return}else if(e==="2"){i.selectedBuildingType="plantingZone",_e(s,ge.ButtonClick,o.position);return}else if(e==="3"){i.selectedBuildingType="removal",_e(s,ge.ButtonClick,o.position);return}}if(e==="escape"&&i.selectedBuildingType){i.selectedBuildingType=null;return}if(e==="e"){if(t){i.autopilotControls.behaviors.gathering=!i.autopilotControls.behaviors.gathering;return}const u=Me(o,i,"berryBush",yt,g=>g.food.length>0&&o.food.length<o.maxFood),c=Me(o,i,"corpse",yt,g=>g.food.length>0&&o.food.length<o.maxFood);let f=null;u&&c?f=V(o.position,u.position,i.mapDimensions.width,i.mapDimensions.height)<=V(o.position,c.position,i.mapDimensions.width,i.mapDimensions.height)?u:c:f=u||c,f&&(o.activeAction="gathering",_e(s,ge.Gather,o.position))}else if(e==="r"){if(t){i.autopilotControls.behaviors.procreation=!i.autopilotControls.behaviors.procreation;return}Me(o,i,"human",yt,c=>jr(o,c,i))&&(o.activeAction="procreating",_e(s,ge.Procreate,o.position))}else if(e==="f")o.food.length>0&&(o.activeAction="eating",_e(s,ge.Eat,o.position));else if(e==="h"){if(t){i.autopilotControls.behaviors.feedChildren=!i.autopilotControls.behaviors.feedChildren;return}const u=a.find(c=>c.type===ce.FeedChild);u&&u.targetEntity&&(o.activeAction="feeding",o.target=u.targetEntity.id)}else if(e==="arrowup"||e==="w")o.direction.y=-1,o.activeAction="moving",o.target=void 0,i.hasPlayerMovedEver=!0,i.autopilotControls.isManuallyMoving=!0,i.autopilotControls.activeAutopilotAction=void 0;else if(e==="arrowdown"||e==="s")o.direction.y=1,o.activeAction="moving",o.target=void 0,i.hasPlayerMovedEver=!0,i.autopilotControls.isManuallyMoving=!0,i.autopilotControls.activeAutopilotAction=void 0;else if(e==="arrowleft"||e==="a")o.direction.x=-1,o.activeAction="moving",o.target=void 0,i.hasPlayerMovedEver=!0,i.autopilotControls.isManuallyMoving=!0,i.autopilotControls.activeAutopilotAction=void 0;else if(e==="arrowright"||e==="d")o.direction.x=1,o.activeAction="moving",o.target=void 0,i.hasPlayerMovedEver=!0,i.autopilotControls.isManuallyMoving=!0,i.autopilotControls.activeAutopilotAction=void 0;else if(e==="q"){if(t){i.autopilotControls.behaviors.attack=!i.autopilotControls.behaviors.attack;return}const u=Me(o,i,"human",ii,c=>ns(o,c,i))??Me(o,i,"predator",ii)??Me(o,i,"prey",ii);u&&(o.activeAction="attacking",o.attackTargetId=u.id)}else if(e==="b"){if(t){i.autopilotControls.behaviors.planting=!i.autopilotControls.behaviors.planting;return}if(a.find(c=>c.type===ce.Plant)){const c=qE(o.position,i,50,Of);c&&(o.activeAction="planting",o.target=c,i.hasPlayerPlantedBush=!0)}}else if(e==="x"){if(t){i.autopilotControls.behaviors.gathering=!i.autopilotControls.behaviors.gathering;return}const u=Me(o,i,"building",Cn,c=>{const f=c;return f.buildingType==="storageSpot"&&f.ownerId===o.leaderId&&f.isConstructed&&f.storedFood!==void 0&&f.storageCapacity!==void 0&&f.storedFood.length<f.storageCapacity});u&&(o.activeAction="idle",o.target=u.id,_e(s,ge.StorageDeposit,o.position))}else if(e==="z"){if(t){i.autopilotControls.behaviors.feedChildren=!i.autopilotControls.behaviors.feedChildren;return}const u=Me(o,i,"building",Cn,c=>{const f=c;return f.buildingType==="storageSpot"&&f.ownerId===o.leaderId&&f.isConstructed&&f.storedFood!==void 0&&f.storedFood.length>0});u&&(o.activeAction="idle",o.target=u.id,_e(s,ge.StorageRetrieve,o.position))}else e==="v"?(o.isCallingToAttack=!0,o.callToAttackEndTime=i.time+Xo,ke(i,he.CallToAttack,o.position,Xo),_e(s,ge.CallToAttack,o.position)):e==="c"?(o.isCallingToFollow=!0,o.callToFollowEndTime=i.time+ya,ke(i,he.CallToFollow,o.position,ya),_e(s,ge.CallToFollow,o.position)):e==="k"?mh(o,i):e==="l"&&(i.buildMenuOpen=!i.buildMenuOpen,_e(s,ge.ButtonClick,o.position))},vD=(e,t,i,o)=>{e==="arrowup"||e==="w"||e==="arrowdown"||e==="s"?t.direction.y=0:(e==="arrowleft"||e==="a"||e==="arrowright"||e==="d")&&(t.direction.x=0),!o.current.has("arrowup")&&!o.current.has("arrowdown")&&!o.current.has("arrowleft")&&!o.current.has("arrowright")&&!o.current.has("w")&&!o.current.has("a")&&!o.current.has("s")&&!o.current.has("d")&&(t.activeAction==="moving"&&(t.activeAction="idle"),i.autopilotControls.isManuallyMoving=!1),!o.current.has("e")&&t.activeAction==="gathering"&&(t.activeAction="idle"),!o.current.has("f")&&t.activeAction==="eating"&&(t.activeAction="idle"),!o.current.has("r")&&t.activeAction==="procreating"&&(t.activeAction="idle"),!o.current.has("h")&&t.activeAction==="feeding"&&(t.activeAction="idle")},SD=(e,t,i)=>{let a=pt(e);if(e.debugCharacterId){const s=e.entities.entities[e.debugCharacterId];s&&"position"in s&&(a=s)}if(a){const{mapDimensions:s}=e,{width:u,height:c}=s;let f={...a.position};const g=f.x-t.x;Math.abs(g)>u/2&&(g>0?f.x-=u:f.x+=u);const m=f.y-t.y;Math.abs(m)>c/2&&(m>0?f.y-=c:f.y+=c);let v=lh(t,f,Jf*i);return v={x:(v.x%u+u)%u,y:(v.y%c+c)%c},v}return e.viewportCenter};function yD(e,t){const{width:i,height:o}=e.mapDimensions;e.viewportCenter={x:(t.x%i+i)%i,y:(t.y%o+o)%o}}const AD=(e,t,i,o)=>{var f,g;const a={gameState:i},s=pt(i);s&&_e(a,ge.ButtonClick,s.position);const u=i.uiButtons.find(m=>m.id===e.id);u&&(u.lastActivated=Date.now()),t&&[ne.CommandGather,ne.CommandPlant,ne.ToggleProcreationBehavior,ne.CommandBuild].includes(e.action)&&i.hasPlayerEnabledAutopilot++;const{behaviors:c}=i.autopilotControls;switch(e.action){case ne.ReturnToIntro:i.exitConfirmation="pending",i.isPaused=!0;break;case ne.ConfirmExitYes:o(),i.exitConfirmation="inactive";break;case ne.ConfirmExitNo:i.exitConfirmation="inactive",i.isPaused=!1;break;case ne.ToggleMute:i.isMuted=!i.isMuted,aa(i.masterVolume,i.isMuted);break;case ne.TogglePause:i.isPaused=!i.isPaused;break;case ne.FastForward:return zu(i,aS);case ne.DismissTutorial:i.tutorialState.isActive=!1;break;case ne.CommandEat:s&&s.food.length>0&&(s.activeAction="eating");break;case ne.CommandGather:t?c.gathering=!c.gathering:s&&(s.activeAction="gathering");break;case ne.CommandPlant:t?c.planting=!c.planting:s&&(i.autopilotControls.isManuallyPlanting=!0);break;case ne.ToggleProcreationBehavior:c.procreation=!c.procreation;break;case ne.ToggleAttackBehavior:c.attack=!c.attack;break;case ne.ToggleFeedChildBehavior:c.feedChildren=!c.feedChildren;break;case ne.ToggleAutopilotFollowLeaderBehavior:c.followLeader=!c.followLeader;break;case ne.CommandCallToAttack:s&&s.leaderId===s.id&&(s.isCallingToAttack=!0,s.callToAttackEndTime=i.time+Xo,ke(i,he.CallToAttack,s.position,Xo),_e(a,ge.CallToAttack,s.position));break;case ne.CommandFollowMe:t?c.followLeader=!c.followLeader:s&&s.leaderId===s.id&&(s.isCallingToFollow=!0,s.callToFollowEndTime=i.time+ya,ke(i,he.CallToFollow,s.position,ya),_e(a,ge.CallToFollow,s.position));break;case ne.CommandTribeSplit:s&&mh(s,i);break;case ne.CommandBuild:t?c.build=!c.build:i.buildMenuOpen=!i.buildMenuOpen;break;case ne.SelectStorageSpot:i.selectedBuildingType="storageSpot";break;case ne.SelectPlantingZone:i.selectedBuildingType="plantingZone";break;case ne.SelectRemovalTool:i.selectedBuildingType="removal";break;case ne.ToggleDiplomacy:if(s&&s.leaderId&&e.targetTribeId){const m=s.leaderId,v=e.targetTribeId,T=i.entities.entities[v],A=(f=s.tribeControl)==null?void 0:f.diplomacy,I=(g=T==null?void 0:T.tribeControl)==null?void 0:g.diplomacy;if(A&&I){const w=(A[v]||Dt.Friendly)===Dt.Friendly?Dt.Hostile:Dt.Friendly;A[v]=w,I[m]=w}}break;case ne.OpenRoleManager:i.roleManagerOpen=!0;break;case ne.CloseRoleManager:i.roleManagerOpen=!1;break;case ne.IncreaseRoleWeight:if(s&&s.tribeControl&&e.targetRole){const m=s.tribeControl.roleWeights[e.targetRole]||0;m<10&&(s.tribeControl.roleWeights[e.targetRole]=m+1)}break;case ne.DecreaseRoleWeight:if(s&&s.tribeControl&&e.targetRole){const m=s.tribeControl.roleWeights[e.targetRole]||0;m>0&&(s.tribeControl.roleWeights[e.targetRole]=m-1)}break}return i};function TD(e,t,i){if(!e.notificationButtonRects)return!1;const o=pt(e);for(const[a,s]of Object.entries(e.notificationButtonRects.dismiss))if(t>=s.x&&t<=s.x+s.width&&i>=s.y&&i<=s.y+s.height)return Cw(e,a),o&&_e({gameState:e},ge.ButtonClick,o.position),!0;for(const[a,s]of Object.entries(e.notificationButtonRects.view))if(t>=s.x&&t<=s.x+s.width&&i>=s.y&&i<=s.y+s.height){const u=e.notifications.find(c=>c.id===a);if(u){let c=u.targetPosition;if(!c&&u.targetEntityIds&&u.targetEntityIds.length>0){const f=e.entities.entities[u.targetEntityIds[0]];f&&(c=f.position)}return c&&yD(e,c),o&&_e({gameState:e},ge.ButtonClick,o.position),u.highlightedEntityIds&&(u.renderHighlights=!u.renderHighlights),!0}}return!1}const ID=({isActive:e,gameStateRef:t,canvasRef:i,viewportCenterRef:o,playerActionHintsRef:a,keysPressed:s,returnToIntro:u})=>(Oe.useEffect(()=>{const c=f=>{if(!e()||t.current.gameOver||!i.current||!f.target||f.target!==i.current)return;const g=i.current.getBoundingClientRect(),m=f.clientX-g.left,v=f.clientY-g.top;if(TD(t.current,m,v))return;const A=t.current.uiButtons.find(y=>m>=y.rect.x&&m<=y.rect.x+y.rect.width&&v>=y.rect.y&&v<=y.rect.y+y.rect.height);if(A){t.current=AD(A,f.shiftKey,t.current,u);return}const I=Gf({x:m,y:v},o.current,{width:i.current.width,height:i.current.height},t.current.mapDimensions);gD(t.current,I)};return window.addEventListener("mousedown",c),()=>{window.removeEventListener("mousedown",c)}},[e,i,t,o,u]),Oe.useEffect(()=>{const c=f=>{if(!e()||!i.current)return;const g=i.current.getBoundingClientRect(),m=f.clientX-g.left,v=f.clientY-g.top;t.current.mousePosition={x:m,y:v};let T;if(t.current.notificationButtonRects){for(const[I,y]of Object.entries(t.current.notificationButtonRects.dismiss))if(m>=y.x&&m<=y.x+y.width&&v>=y.y&&v<=y.y+y.height){T=`notification-dismiss-${I}`;break}if(!T){for(const[I,y]of Object.entries(t.current.notificationButtonRects.view))if(m>=y.x&&m<=y.x+y.width&&v>=y.y&&v<=y.y+y.height){T=`notification-view-${I}`;break}}}if(!T)for(let I=t.current.uiButtons.length-1;I>=0;I--){const y=t.current.uiButtons[I];if(m>=y.rect.x&&m<=y.rect.x+y.rect.width&&v>=y.rect.y&&v<=y.rect.y+y.rect.height){T=y.id;break}}if(t.current.hoveredButtonId=T,T){t.current.autopilotControls.hoveredAutopilotAction=void 0;return}const A=pt(t.current);if(A){const I=Gf({x:m,y:v},o.current,{width:i.current.width,height:i.current.height},t.current.mapDimensions);t.current.autopilotControls.hoveredAutopilotAction=hD(I,A,t.current,f.shiftKey)}else t.current.autopilotControls.hoveredAutopilotAction=void 0};return window.addEventListener("mousemove",c),()=>{window.removeEventListener("mousemove",c)}},[e,i,t,o]),Oe.useEffect(()=>{const c=g=>{if(!e()||t.current.gameOver)return;const m=g.key.toLowerCase();(m===" "||m==="p"||m==="tab"||(g.ctrlKey||g.metaKey)&&(m==="s"||m==="a"))&&g.preventDefault();const v=pD(g,t.current);if(t.current=v.newState,v.handled)return;const T=pt(t.current);T&&(s.current.add(m),mD(m,g.shiftKey,t.current,T,a.current))},f=g=>{if(!e()||t.current.gameOver)return;const m=g.key.toLowerCase();s.current.delete(m);const v=pt(t.current);v&&vD(m,v,t.current,s)};return window.addEventListener("keydown",c),window.addEventListener("keyup",f),()=>{window.removeEventListener("keydown",c),window.removeEventListener("keyup",f)}},[e,t,a,s,u]),null),ED=({gameStateRef:e,ctxRef:t,debugPanelTypeRef:i,viewportCenterRef:o,playerActionHintsRef:a,keysPressed:s,canvasRef:u,setAppState:c,appState:f})=>{const g=Oe.useRef(),{returnToIntro:m}=Jo(),[v,T,A]=wv(I=>{var b,B;if(!t.current||!g.current){g.current=I;return}const y=Math.min(I-g.current,1e3)/1e3,{performanceMetrics:w}=e.current;w.currentBucket={renderTime:0,worldUpdateTime:0,aiUpdateTime:0};const M=performance.now();e.current=zu(e.current,y),w.currentBucket.worldUpdateTime=performance.now()-M;const F=pt(e.current);F?a.current=vh(e.current,F):a.current=[],o.current=SD(e.current,o.current,y);const N=performance.now();Du(t.current,e.current,o.current,a.current,{width:((b=u.current)==null?void 0:b.width)||800,height:((B=u.current)==null?void 0:B.height)||600},!1),w.currentBucket.renderTime=performance.now()-N,w.history.push({bucketTime:e.current.time,...w.currentBucket}),w.history.length>mI&&w.history.shift(),g.current=I,e.current.gameOver&&f!=="gameOver"&&(ph(ge.GameOver,{masterVolume:e.current.masterVolume,isMuted:e.current.isMuted}),c("gameOver",{generations:e.current.generationCount,cause:e.current.causeOfGameOver||"Unknown"}))});return Oe.useEffect(()=>(T(),v),[T,v]),Le.jsx(ID,{isActive:A,gameStateRef:e,canvasRef:u,viewportCenterRef:o,playerActionHintsRef:a,debugPanelTypeRef:i,keysPressed:s,returnToIntro:m})},K0=()=>{const{savedGameState:e,contextReady:t}=Jo(),[i,o]=Oe.useState(null);return Oe.useEffect(()=>{t&&(e?(console.log("Loading saved game state..."),o(e)):(console.log("Initializing new game state..."),o(dD())))},[t,e]),!t||!i?Le.jsx("div",{children:"Loading..."}):Le.jsx(CD,{initialState:i})},CD=({initialState:e})=>{const t=Oe.useRef(null),i=Oe.useRef(null),o=Oe.useRef(e),a=Oe.useRef(new Set),s=Oe.useRef(e.debugPanel),u=Oe.useRef(e.viewportCenter),c=Oe.useRef([]),{appState:f,setAppState:g}=Jo();return Le.jsxs(Le.Fragment,{children:[Le.jsx(fD,{canvasRef:t,ctxRef:i,gameStateRef:o,debugPanelTypeRef:s,viewportCenterRef:u,playerActionHintsRef:c}),Le.jsx(ED,{gameStateRef:o,ctxRef:i,debugPanelTypeRef:s,viewportCenterRef:u,playerActionHintsRef:c,keysPressed:a,canvasRef:t,setAppState:g,appState:f})]})},wD=wn.div`
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  text-align: center;
  background-color: rgba(0, 0, 0, 0.75); // Semi-transparent overlay
  color: #fff;
  padding: 20px;
  z-index: 10; // Ensure it's on top
`,_D=wn.h1`
  font-family: 'Press Start 2P', cursive;
  font-size: 4rem;
  color: #ff4136; // Red for emphasis
  text-shadow: 4px 4px 0px #000;
  margin-bottom: 1.5rem;
`,du=wn.p`
  font-family: 'Press Start 2P', cursive;
  font-size: 1.2rem;
  margin: 0.5em 0;
  color: #fff;
  text-shadow: 2px 2px 0px #000;
`,RD=wn.button`
  font-family: 'Press Start 2P', cursive;
  font-size: 1rem;
  padding: 1rem 2rem;
  margin-top: 2em;
  color: #fff;
  background-color: #ff4136; // Red button
  border: 2px solid #fff;
  box-shadow: 4px 4px 0px #fff;
  cursor: pointer;
  transition: all 0.2s ease-in-out;
  text-transform: uppercase;

  &:hover {
    background-color: #fff;
    color: #ff4136;
    box-shadow: 4px 4px 0px #ff4136;
  }
`,PD=()=>{const{setAppState:e,gameOverDetails:t}=Jo(),i=()=>{e("intro")};return Le.jsxs(wD,{children:[Le.jsx(_D,{children:"Game Over"}),Le.jsx(du,{children:"Your tribe's lineage has ended."}),t&&Le.jsxs(Le.Fragment,{children:[Le.jsxs(du,{children:["Generations Survived: ",t.generations]}),Le.jsxs(du,{children:["Cause of Extinction: ",t.cause]})]}),!t&&Le.jsx(du,{children:"Game details are unavailable."}),Le.jsx(RD,{onClick:i,children:"Return to Menu"})]})},ND=uI`
  /* CSS Reset */
  *, *::before, *::after {
    box-sizing: border-box;
  }

  body {
    margin: 0;
    padding: 0;
    font-family: 'Press Start 2P', 'Arial', sans-serif;
    background-color: #121212;
    color: #f0f0f0;
    line-height: 1.6;
  }

  /* Additional global styles */
  h1, h2, h3, h4, h5, h6 {
    margin-top: 0;
  }

  button {
    cursor: pointer;
    font-family: inherit;
  }

  /* Prevent overflow issues */
  html, body {
    height: 100%;
    overflow-x: hidden;
  }

  /* Root element for React app */
  #root {
    height: 100%;
  }
`;function DD(e,t){Oe.useEffect(()=>{const i=()=>{const o=document.location.hash==="#game"?"game":"intro";t(o)};return window.addEventListener("hashchange",i),i(),()=>{window.removeEventListener("hashchange",i)}},[]),Oe.useEffect(()=>{e==="game"?document.location.hash="#game":e==="intro"&&(document.location.hash="")},[e])}const OD=()=>{const{appState:e,setAppState:t}=Jo();DD(e,t);const i=()=>{switch(e){case"intro":return Le.jsx(X0,{});case"game":return Le.jsx(K0,{});case"gameOver":return Le.jsxs(Le.Fragment,{children:[Le.jsx(K0,{}),Le.jsx(PD,{})]});default:return Le.jsx(X0,{})}};return Le.jsxs(Le.Fragment,{children:[Le.jsx(ND,{}),i()]})},Z0=document.getElementById("root");Z0?Bw().then(()=>{qA.createRoot(Z0).render(Le.jsx(ti.StrictMode,{children:Le.jsx(lT,{initialAppState:document.location.hash==="#game"?"game":"intro",children:Le.jsx(OD,{})})}))}):console.error("Failed to find the root element");
