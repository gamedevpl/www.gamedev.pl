var OT=Object.defineProperty;var MT=(e,t,r)=>t in e?OT(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r;var Oe=(e,t,r)=>MT(e,typeof t!="symbol"?t+"":t,r);(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const l of document.querySelectorAll('link[rel="modulepreload"]'))o(l);new MutationObserver(l=>{for(const s of l)if(s.type==="childList")for(const u of s.addedNodes)u.tagName==="LINK"&&u.rel==="modulepreload"&&o(u)}).observe(document,{childList:!0,subtree:!0});function r(l){const s={};return l.integrity&&(s.integrity=l.integrity),l.referrerPolicy&&(s.referrerPolicy=l.referrerPolicy),l.crossOrigin==="use-credentials"?s.credentials="include":l.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function o(l){if(l.ep)return;l.ep=!0;const s=r(l);fetch(l.href,s)}})();function x0(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var _d={exports:{}},Us={},Cd={exports:{}},Be={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var am;function kT(){if(am)return Be;am=1;var e=Symbol.for("react.element"),t=Symbol.for("react.portal"),r=Symbol.for("react.fragment"),o=Symbol.for("react.strict_mode"),l=Symbol.for("react.profiler"),s=Symbol.for("react.provider"),u=Symbol.for("react.context"),d=Symbol.for("react.forward_ref"),f=Symbol.for("react.suspense"),g=Symbol.for("react.memo"),m=Symbol.for("react.lazy"),S=Symbol.iterator;function y(P){return P===null||typeof P!="object"?null:(P=S&&P[S]||P["@@iterator"],typeof P=="function"?P:null)}var w={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},A=Object.assign,I={};function C(P,L,K){this.props=P,this.context=L,this.refs=I,this.updater=K||w}C.prototype.isReactComponent={},C.prototype.setState=function(P,L){if(typeof P!="object"&&typeof P!="function"&&P!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,P,L,"setState")},C.prototype.forceUpdate=function(P){this.updater.enqueueForceUpdate(this,P,"forceUpdate")};function F(){}F.prototype=C.prototype;function B(P,L,K){this.props=P,this.context=L,this.refs=I,this.updater=K||w}var D=B.prototype=new F;D.constructor=B,A(D,C.prototype),D.isPureReactComponent=!0;var H=Array.isArray,b=Object.prototype.hasOwnProperty,U={current:null},$={key:!0,ref:!0,__self:!0,__source:!0};function ee(P,L,K){var ie,Se={},le=null,Ee=null;if(L!=null)for(ie in L.ref!==void 0&&(Ee=L.ref),L.key!==void 0&&(le=""+L.key),L)b.call(L,ie)&&!$.hasOwnProperty(ie)&&(Se[ie]=L[ie]);var Ae=arguments.length-2;if(Ae===1)Se.children=K;else if(1<Ae){for(var Z=Array(Ae),re=0;re<Ae;re++)Z[re]=arguments[re+2];Se.children=Z}if(P&&P.defaultProps)for(ie in Ae=P.defaultProps,Ae)Se[ie]===void 0&&(Se[ie]=Ae[ie]);return{$$typeof:e,type:P,key:le,ref:Ee,props:Se,_owner:U.current}}function _e(P,L){return{$$typeof:e,type:P.type,key:L,ref:P.ref,props:P.props,_owner:P._owner}}function Ce(P){return typeof P=="object"&&P!==null&&P.$$typeof===e}function be(P){var L={"=":"=0",":":"=2"};return"$"+P.replace(/[=:]/g,function(K){return L[K]})}var De=/\/+/g;function Pe(P,L){return typeof P=="object"&&P!==null&&P.key!=null?be(""+P.key):L.toString(36)}function de(P,L,K,ie,Se){var le=typeof P;(le==="undefined"||le==="boolean")&&(P=null);var Ee=!1;if(P===null)Ee=!0;else switch(le){case"string":case"number":Ee=!0;break;case"object":switch(P.$$typeof){case e:case t:Ee=!0}}if(Ee)return Ee=P,Se=Se(Ee),P=ie===""?"."+Pe(Ee,0):ie,H(Se)?(K="",P!=null&&(K=P.replace(De,"$&/")+"/"),de(Se,L,K,"",function(re){return re})):Se!=null&&(Ce(Se)&&(Se=_e(Se,K+(!Se.key||Ee&&Ee.key===Se.key?"":(""+Se.key).replace(De,"$&/")+"/")+P)),L.push(Se)),1;if(Ee=0,ie=ie===""?".":ie+":",H(P))for(var Ae=0;Ae<P.length;Ae++){le=P[Ae];var Z=ie+Pe(le,Ae);Ee+=de(le,L,K,Z,Se)}else if(Z=y(P),typeof Z=="function")for(P=Z.call(P),Ae=0;!(le=P.next()).done;)le=le.value,Z=ie+Pe(le,Ae++),Ee+=de(le,L,K,Z,Se);else if(le==="object")throw L=String(P),Error("Objects are not valid as a React child (found: "+(L==="[object Object]"?"object with keys {"+Object.keys(P).join(", ")+"}":L)+"). If you meant to render a collection of children, use an array instead.");return Ee}function Ue(P,L,K){if(P==null)return P;var ie=[],Se=0;return de(P,ie,"","",function(le){return L.call(K,le,Se++)}),ie}function Te(P){if(P._status===-1){var L=P._result;L=L(),L.then(function(K){(P._status===0||P._status===-1)&&(P._status=1,P._result=K)},function(K){(P._status===0||P._status===-1)&&(P._status=2,P._result=K)}),P._status===-1&&(P._status=0,P._result=L)}if(P._status===1)return P._result.default;throw P._result}var ne={current:null},W={transition:null},X={ReactCurrentDispatcher:ne,ReactCurrentBatchConfig:W,ReactCurrentOwner:U};function j(){throw Error("act(...) is not supported in production builds of React.")}return Be.Children={map:Ue,forEach:function(P,L,K){Ue(P,function(){L.apply(this,arguments)},K)},count:function(P){var L=0;return Ue(P,function(){L++}),L},toArray:function(P){return Ue(P,function(L){return L})||[]},only:function(P){if(!Ce(P))throw Error("React.Children.only expected to receive a single React element child.");return P}},Be.Component=C,Be.Fragment=r,Be.Profiler=l,Be.PureComponent=B,Be.StrictMode=o,Be.Suspense=f,Be.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=X,Be.act=j,Be.cloneElement=function(P,L,K){if(P==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+P+".");var ie=A({},P.props),Se=P.key,le=P.ref,Ee=P._owner;if(L!=null){if(L.ref!==void 0&&(le=L.ref,Ee=U.current),L.key!==void 0&&(Se=""+L.key),P.type&&P.type.defaultProps)var Ae=P.type.defaultProps;for(Z in L)b.call(L,Z)&&!$.hasOwnProperty(Z)&&(ie[Z]=L[Z]===void 0&&Ae!==void 0?Ae[Z]:L[Z])}var Z=arguments.length-2;if(Z===1)ie.children=K;else if(1<Z){Ae=Array(Z);for(var re=0;re<Z;re++)Ae[re]=arguments[re+2];ie.children=Ae}return{$$typeof:e,type:P.type,key:Se,ref:le,props:ie,_owner:Ee}},Be.createContext=function(P){return P={$$typeof:u,_currentValue:P,_currentValue2:P,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},P.Provider={$$typeof:s,_context:P},P.Consumer=P},Be.createElement=ee,Be.createFactory=function(P){var L=ee.bind(null,P);return L.type=P,L},Be.createRef=function(){return{current:null}},Be.forwardRef=function(P){return{$$typeof:d,render:P}},Be.isValidElement=Ce,Be.lazy=function(P){return{$$typeof:m,_payload:{_status:-1,_result:P},_init:Te}},Be.memo=function(P,L){return{$$typeof:g,type:P,compare:L===void 0?null:L}},Be.startTransition=function(P){var L=W.transition;W.transition={};try{P()}finally{W.transition=L}},Be.unstable_act=j,Be.useCallback=function(P,L){return ne.current.useCallback(P,L)},Be.useContext=function(P){return ne.current.useContext(P)},Be.useDebugValue=function(){},Be.useDeferredValue=function(P){return ne.current.useDeferredValue(P)},Be.useEffect=function(P,L){return ne.current.useEffect(P,L)},Be.useId=function(){return ne.current.useId()},Be.useImperativeHandle=function(P,L,K){return ne.current.useImperativeHandle(P,L,K)},Be.useInsertionEffect=function(P,L){return ne.current.useInsertionEffect(P,L)},Be.useLayoutEffect=function(P,L){return ne.current.useLayoutEffect(P,L)},Be.useMemo=function(P,L){return ne.current.useMemo(P,L)},Be.useReducer=function(P,L,K){return ne.current.useReducer(P,L,K)},Be.useRef=function(P){return ne.current.useRef(P)},Be.useState=function(P){return ne.current.useState(P)},Be.useSyncExternalStore=function(P,L,K){return ne.current.useSyncExternalStore(P,L,K)},Be.useTransition=function(){return ne.current.useTransition()},Be.version="18.3.1",Be}var lm;function Mf(){return lm||(lm=1,Cd.exports=kT()),Cd.exports}/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var um;function FT(){if(um)return Us;um=1;var e=Mf(),t=Symbol.for("react.element"),r=Symbol.for("react.fragment"),o=Object.prototype.hasOwnProperty,l=e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,s={key:!0,ref:!0,__self:!0,__source:!0};function u(d,f,g){var m,S={},y=null,w=null;g!==void 0&&(y=""+g),f.key!==void 0&&(y=""+f.key),f.ref!==void 0&&(w=f.ref);for(m in f)o.call(f,m)&&!s.hasOwnProperty(m)&&(S[m]=f[m]);if(d&&d.defaultProps)for(m in f=d.defaultProps,f)S[m]===void 0&&(S[m]=f[m]);return{$$typeof:t,type:d,key:y,ref:w,props:S,_owner:l.current}}return Us.Fragment=r,Us.jsx=u,Us.jsxs=u,Us}var cm;function UT(){return cm||(cm=1,_d.exports=FT()),_d.exports}var Fe=UT(),Re=Mf();const Jn=x0(Re);var kl={},Rd={exports:{}},qt={},Pd={exports:{}},Nd={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var dm;function LT(){return dm||(dm=1,function(e){function t(W,X){var j=W.length;W.push(X);e:for(;0<j;){var P=j-1>>>1,L=W[P];if(0<l(L,X))W[P]=X,W[j]=L,j=P;else break e}}function r(W){return W.length===0?null:W[0]}function o(W){if(W.length===0)return null;var X=W[0],j=W.pop();if(j!==X){W[0]=j;e:for(var P=0,L=W.length,K=L>>>1;P<K;){var ie=2*(P+1)-1,Se=W[ie],le=ie+1,Ee=W[le];if(0>l(Se,j))le<L&&0>l(Ee,Se)?(W[P]=Ee,W[le]=j,P=le):(W[P]=Se,W[ie]=j,P=ie);else if(le<L&&0>l(Ee,j))W[P]=Ee,W[le]=j,P=le;else break e}}return X}function l(W,X){var j=W.sortIndex-X.sortIndex;return j!==0?j:W.id-X.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;e.unstable_now=function(){return s.now()}}else{var u=Date,d=u.now();e.unstable_now=function(){return u.now()-d}}var f=[],g=[],m=1,S=null,y=3,w=!1,A=!1,I=!1,C=typeof setTimeout=="function"?setTimeout:null,F=typeof clearTimeout=="function"?clearTimeout:null,B=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function D(W){for(var X=r(g);X!==null;){if(X.callback===null)o(g);else if(X.startTime<=W)o(g),X.sortIndex=X.expirationTime,t(f,X);else break;X=r(g)}}function H(W){if(I=!1,D(W),!A)if(r(f)!==null)A=!0,Te(b);else{var X=r(g);X!==null&&ne(H,X.startTime-W)}}function b(W,X){A=!1,I&&(I=!1,F(ee),ee=-1),w=!0;var j=y;try{for(D(X),S=r(f);S!==null&&(!(S.expirationTime>X)||W&&!be());){var P=S.callback;if(typeof P=="function"){S.callback=null,y=S.priorityLevel;var L=P(S.expirationTime<=X);X=e.unstable_now(),typeof L=="function"?S.callback=L:S===r(f)&&o(f),D(X)}else o(f);S=r(f)}if(S!==null)var K=!0;else{var ie=r(g);ie!==null&&ne(H,ie.startTime-X),K=!1}return K}finally{S=null,y=j,w=!1}}var U=!1,$=null,ee=-1,_e=5,Ce=-1;function be(){return!(e.unstable_now()-Ce<_e)}function De(){if($!==null){var W=e.unstable_now();Ce=W;var X=!0;try{X=$(!0,W)}finally{X?Pe():(U=!1,$=null)}}else U=!1}var Pe;if(typeof B=="function")Pe=function(){B(De)};else if(typeof MessageChannel<"u"){var de=new MessageChannel,Ue=de.port2;de.port1.onmessage=De,Pe=function(){Ue.postMessage(null)}}else Pe=function(){C(De,0)};function Te(W){$=W,U||(U=!0,Pe())}function ne(W,X){ee=C(function(){W(e.unstable_now())},X)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(W){W.callback=null},e.unstable_continueExecution=function(){A||w||(A=!0,Te(b))},e.unstable_forceFrameRate=function(W){0>W||125<W?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):_e=0<W?Math.floor(1e3/W):5},e.unstable_getCurrentPriorityLevel=function(){return y},e.unstable_getFirstCallbackNode=function(){return r(f)},e.unstable_next=function(W){switch(y){case 1:case 2:case 3:var X=3;break;default:X=y}var j=y;y=X;try{return W()}finally{y=j}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(W,X){switch(W){case 1:case 2:case 3:case 4:case 5:break;default:W=3}var j=y;y=W;try{return X()}finally{y=j}},e.unstable_scheduleCallback=function(W,X,j){var P=e.unstable_now();switch(typeof j=="object"&&j!==null?(j=j.delay,j=typeof j=="number"&&0<j?P+j:P):j=P,W){case 1:var L=-1;break;case 2:L=250;break;case 5:L=1073741823;break;case 4:L=1e4;break;default:L=5e3}return L=j+L,W={id:m++,callback:X,priorityLevel:W,startTime:j,expirationTime:L,sortIndex:-1},j>P?(W.sortIndex=j,t(g,W),r(f)===null&&W===r(g)&&(I?(F(ee),ee=-1):I=!0,ne(H,j-P))):(W.sortIndex=L,t(f,W),A||w||(A=!0,Te(b))),W},e.unstable_shouldYield=be,e.unstable_wrapCallback=function(W){var X=y;return function(){var j=y;y=X;try{return W.apply(this,arguments)}finally{y=j}}}}(Nd)),Nd}var fm;function BT(){return fm||(fm=1,Pd.exports=LT()),Pd.exports}/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var hm;function HT(){if(hm)return qt;hm=1;var e=Mf(),t=BT();function r(n){for(var i="https://reactjs.org/docs/error-decoder.html?invariant="+n,a=1;a<arguments.length;a++)i+="&args[]="+encodeURIComponent(arguments[a]);return"Minified React error #"+n+"; visit "+i+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var o=new Set,l={};function s(n,i){u(n,i),u(n+"Capture",i)}function u(n,i){for(l[n]=i,n=0;n<i.length;n++)o.add(i[n])}var d=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),f=Object.prototype.hasOwnProperty,g=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,m={},S={};function y(n){return f.call(S,n)?!0:f.call(m,n)?!1:g.test(n)?S[n]=!0:(m[n]=!0,!1)}function w(n,i,a,c){if(a!==null&&a.type===0)return!1;switch(typeof i){case"function":case"symbol":return!0;case"boolean":return c?!1:a!==null?!a.acceptsBooleans:(n=n.toLowerCase().slice(0,5),n!=="data-"&&n!=="aria-");default:return!1}}function A(n,i,a,c){if(i===null||typeof i>"u"||w(n,i,a,c))return!0;if(c)return!1;if(a!==null)switch(a.type){case 3:return!i;case 4:return i===!1;case 5:return isNaN(i);case 6:return isNaN(i)||1>i}return!1}function I(n,i,a,c,h,p,v){this.acceptsBooleans=i===2||i===3||i===4,this.attributeName=c,this.attributeNamespace=h,this.mustUseProperty=a,this.propertyName=n,this.type=i,this.sanitizeURL=p,this.removeEmptyString=v}var C={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(n){C[n]=new I(n,0,!1,n,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(n){var i=n[0];C[i]=new I(i,1,!1,n[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(n){C[n]=new I(n,2,!1,n.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(n){C[n]=new I(n,2,!1,n,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(n){C[n]=new I(n,3,!1,n.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(n){C[n]=new I(n,3,!0,n,null,!1,!1)}),["capture","download"].forEach(function(n){C[n]=new I(n,4,!1,n,null,!1,!1)}),["cols","rows","size","span"].forEach(function(n){C[n]=new I(n,6,!1,n,null,!1,!1)}),["rowSpan","start"].forEach(function(n){C[n]=new I(n,5,!1,n.toLowerCase(),null,!1,!1)});var F=/[\-:]([a-z])/g;function B(n){return n[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(n){var i=n.replace(F,B);C[i]=new I(i,1,!1,n,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(n){var i=n.replace(F,B);C[i]=new I(i,1,!1,n,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(n){var i=n.replace(F,B);C[i]=new I(i,1,!1,n,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(n){C[n]=new I(n,1,!1,n.toLowerCase(),null,!1,!1)}),C.xlinkHref=new I("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(n){C[n]=new I(n,1,!1,n.toLowerCase(),null,!0,!0)});function D(n,i,a,c){var h=C.hasOwnProperty(i)?C[i]:null;(h!==null?h.type!==0:c||!(2<i.length)||i[0]!=="o"&&i[0]!=="O"||i[1]!=="n"&&i[1]!=="N")&&(A(i,a,h,c)&&(a=null),c||h===null?y(i)&&(a===null?n.removeAttribute(i):n.setAttribute(i,""+a)):h.mustUseProperty?n[h.propertyName]=a===null?h.type===3?!1:"":a:(i=h.attributeName,c=h.attributeNamespace,a===null?n.removeAttribute(i):(h=h.type,a=h===3||h===4&&a===!0?"":""+a,c?n.setAttributeNS(c,i,a):n.setAttribute(i,a))))}var H=e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,b=Symbol.for("react.element"),U=Symbol.for("react.portal"),$=Symbol.for("react.fragment"),ee=Symbol.for("react.strict_mode"),_e=Symbol.for("react.profiler"),Ce=Symbol.for("react.provider"),be=Symbol.for("react.context"),De=Symbol.for("react.forward_ref"),Pe=Symbol.for("react.suspense"),de=Symbol.for("react.suspense_list"),Ue=Symbol.for("react.memo"),Te=Symbol.for("react.lazy"),ne=Symbol.for("react.offscreen"),W=Symbol.iterator;function X(n){return n===null||typeof n!="object"?null:(n=W&&n[W]||n["@@iterator"],typeof n=="function"?n:null)}var j=Object.assign,P;function L(n){if(P===void 0)try{throw Error()}catch(a){var i=a.stack.trim().match(/\n( *(at )?)/);P=i&&i[1]||""}return`
`+P+n}var K=!1;function ie(n,i){if(!n||K)return"";K=!0;var a=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(i)if(i=function(){throw Error()},Object.defineProperty(i.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(i,[])}catch(k){var c=k}Reflect.construct(n,[],i)}else{try{i.call()}catch(k){c=k}n.call(i.prototype)}else{try{throw Error()}catch(k){c=k}n()}}catch(k){if(k&&c&&typeof k.stack=="string"){for(var h=k.stack.split(`
`),p=c.stack.split(`
`),v=h.length-1,_=p.length-1;1<=v&&0<=_&&h[v]!==p[_];)_--;for(;1<=v&&0<=_;v--,_--)if(h[v]!==p[_]){if(v!==1||_!==1)do if(v--,_--,0>_||h[v]!==p[_]){var R=`
`+h[v].replace(" at new "," at ");return n.displayName&&R.includes("<anonymous>")&&(R=R.replace("<anonymous>",n.displayName)),R}while(1<=v&&0<=_);break}}}finally{K=!1,Error.prepareStackTrace=a}return(n=n?n.displayName||n.name:"")?L(n):""}function Se(n){switch(n.tag){case 5:return L(n.type);case 16:return L("Lazy");case 13:return L("Suspense");case 19:return L("SuspenseList");case 0:case 2:case 15:return n=ie(n.type,!1),n;case 11:return n=ie(n.type.render,!1),n;case 1:return n=ie(n.type,!0),n;default:return""}}function le(n){if(n==null)return null;if(typeof n=="function")return n.displayName||n.name||null;if(typeof n=="string")return n;switch(n){case $:return"Fragment";case U:return"Portal";case _e:return"Profiler";case ee:return"StrictMode";case Pe:return"Suspense";case de:return"SuspenseList"}if(typeof n=="object")switch(n.$$typeof){case be:return(n.displayName||"Context")+".Consumer";case Ce:return(n._context.displayName||"Context")+".Provider";case De:var i=n.render;return n=n.displayName,n||(n=i.displayName||i.name||"",n=n!==""?"ForwardRef("+n+")":"ForwardRef"),n;case Ue:return i=n.displayName||null,i!==null?i:le(n.type)||"Memo";case Te:i=n._payload,n=n._init;try{return le(n(i))}catch{}}return null}function Ee(n){var i=n.type;switch(n.tag){case 24:return"Cache";case 9:return(i.displayName||"Context")+".Consumer";case 10:return(i._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return n=i.render,n=n.displayName||n.name||"",i.displayName||(n!==""?"ForwardRef("+n+")":"ForwardRef");case 7:return"Fragment";case 5:return i;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return le(i);case 8:return i===ee?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof i=="function")return i.displayName||i.name||null;if(typeof i=="string")return i}return null}function Ae(n){switch(typeof n){case"boolean":case"number":case"string":case"undefined":return n;case"object":return n;default:return""}}function Z(n){var i=n.type;return(n=n.nodeName)&&n.toLowerCase()==="input"&&(i==="checkbox"||i==="radio")}function re(n){var i=Z(n)?"checked":"value",a=Object.getOwnPropertyDescriptor(n.constructor.prototype,i),c=""+n[i];if(!n.hasOwnProperty(i)&&typeof a<"u"&&typeof a.get=="function"&&typeof a.set=="function"){var h=a.get,p=a.set;return Object.defineProperty(n,i,{configurable:!0,get:function(){return h.call(this)},set:function(v){c=""+v,p.call(this,v)}}),Object.defineProperty(n,i,{enumerable:a.enumerable}),{getValue:function(){return c},setValue:function(v){c=""+v},stopTracking:function(){n._valueTracker=null,delete n[i]}}}}function Le(n){n._valueTracker||(n._valueTracker=re(n))}function ge(n){if(!n)return!1;var i=n._valueTracker;if(!i)return!0;var a=i.getValue(),c="";return n&&(c=Z(n)?n.checked?"true":"false":n.value),n=c,n!==a?(i.setValue(n),!0):!1}function Gn(n){if(n=n||(typeof document<"u"?document:void 0),typeof n>"u")return null;try{return n.activeElement||n.body}catch{return n.body}}function qe(n,i){var a=i.checked;return j({},i,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:a??n._wrapperState.initialChecked})}function je(n,i){var a=i.defaultValue==null?"":i.defaultValue,c=i.checked!=null?i.checked:i.defaultChecked;a=Ae(i.value!=null?i.value:a),n._wrapperState={initialChecked:c,initialValue:a,controlled:i.type==="checkbox"||i.type==="radio"?i.checked!=null:i.value!=null}}function xn(n,i){i=i.checked,i!=null&&D(n,"checked",i,!1)}function Yt(n,i){xn(n,i);var a=Ae(i.value),c=i.type;if(a!=null)c==="number"?(a===0&&n.value===""||n.value!=a)&&(n.value=""+a):n.value!==""+a&&(n.value=""+a);else if(c==="submit"||c==="reset"){n.removeAttribute("value");return}i.hasOwnProperty("value")?$n(n,i.type,a):i.hasOwnProperty("defaultValue")&&$n(n,i.type,Ae(i.defaultValue)),i.checked==null&&i.defaultChecked!=null&&(n.defaultChecked=!!i.defaultChecked)}function un(n,i,a){if(i.hasOwnProperty("value")||i.hasOwnProperty("defaultValue")){var c=i.type;if(!(c!=="submit"&&c!=="reset"||i.value!==void 0&&i.value!==null))return;i=""+n._wrapperState.initialValue,a||i===n.value||(n.value=i),n.defaultValue=i}a=n.name,a!==""&&(n.name=""),n.defaultChecked=!!n._wrapperState.initialChecked,a!==""&&(n.name=a)}function $n(n,i,a){(i!=="number"||Gn(n.ownerDocument)!==n)&&(a==null?n.defaultValue=""+n._wrapperState.initialValue:n.defaultValue!==""+a&&(n.defaultValue=""+a))}var zn=Array.isArray;function Ti(n,i,a,c){if(n=n.options,i){i={};for(var h=0;h<a.length;h++)i["$"+a[h]]=!0;for(a=0;a<n.length;a++)h=i.hasOwnProperty("$"+n[a].value),n[a].selected!==h&&(n[a].selected=h),h&&c&&(n[a].defaultSelected=!0)}else{for(a=""+Ae(a),i=null,h=0;h<n.length;h++){if(n[h].value===a){n[h].selected=!0,c&&(n[h].defaultSelected=!0);return}i!==null||n[h].disabled||(i=n[h])}i!==null&&(i.selected=!0)}}function ar(n,i){if(i.dangerouslySetInnerHTML!=null)throw Error(r(91));return j({},i,{value:void 0,defaultValue:void 0,children:""+n._wrapperState.initialValue})}function vh(n,i){var a=i.value;if(a==null){if(a=i.children,i=i.defaultValue,a!=null){if(i!=null)throw Error(r(92));if(zn(a)){if(1<a.length)throw Error(r(93));a=a[0]}i=a}i==null&&(i=""),a=i}n._wrapperState={initialValue:Ae(a)}}function Sh(n,i){var a=Ae(i.value),c=Ae(i.defaultValue);a!=null&&(a=""+a,a!==n.value&&(n.value=a),i.defaultValue==null&&n.defaultValue!==a&&(n.defaultValue=a)),c!=null&&(n.defaultValue=""+c)}function yh(n){var i=n.textContent;i===n._wrapperState.initialValue&&i!==""&&i!==null&&(n.value=i)}function Th(n){switch(n){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Lu(n,i){return n==null||n==="http://www.w3.org/1999/xhtml"?Th(i):n==="http://www.w3.org/2000/svg"&&i==="foreignObject"?"http://www.w3.org/1999/xhtml":n}var _a,Ah=function(n){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(i,a,c,h){MSApp.execUnsafeLocalFunction(function(){return n(i,a,c,h)})}:n}(function(n,i){if(n.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in n)n.innerHTML=i;else{for(_a=_a||document.createElement("div"),_a.innerHTML="<svg>"+i.valueOf().toString()+"</svg>",i=_a.firstChild;n.firstChild;)n.removeChild(n.firstChild);for(;i.firstChild;)n.appendChild(i.firstChild)}});function qo(n,i){if(i){var a=n.firstChild;if(a&&a===n.lastChild&&a.nodeType===3){a.nodeValue=i;return}}n.textContent=i}var Qo={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},US=["Webkit","ms","Moz","O"];Object.keys(Qo).forEach(function(n){US.forEach(function(i){i=i+n.charAt(0).toUpperCase()+n.substring(1),Qo[i]=Qo[n]})});function Ih(n,i,a){return i==null||typeof i=="boolean"||i===""?"":a||typeof i!="number"||i===0||Qo.hasOwnProperty(n)&&Qo[n]?(""+i).trim():i+"px"}function Eh(n,i){n=n.style;for(var a in i)if(i.hasOwnProperty(a)){var c=a.indexOf("--")===0,h=Ih(a,i[a],c);a==="float"&&(a="cssFloat"),c?n.setProperty(a,h):n[a]=h}}var LS=j({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Bu(n,i){if(i){if(LS[n]&&(i.children!=null||i.dangerouslySetInnerHTML!=null))throw Error(r(137,n));if(i.dangerouslySetInnerHTML!=null){if(i.children!=null)throw Error(r(60));if(typeof i.dangerouslySetInnerHTML!="object"||!("__html"in i.dangerouslySetInnerHTML))throw Error(r(61))}if(i.style!=null&&typeof i.style!="object")throw Error(r(62))}}function Hu(n,i){if(n.indexOf("-")===-1)return typeof i.is=="string";switch(n){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var bu=null;function Gu(n){return n=n.target||n.srcElement||window,n.correspondingUseElement&&(n=n.correspondingUseElement),n.nodeType===3?n.parentNode:n}var xu=null,Wr=null,Yr=null;function wh(n){if(n=Ts(n)){if(typeof xu!="function")throw Error(r(280));var i=n.stateNode;i&&(i=Xa(i),xu(n.stateNode,n.type,i))}}function _h(n){Wr?Yr?Yr.push(n):Yr=[n]:Wr=n}function Ch(){if(Wr){var n=Wr,i=Yr;if(Yr=Wr=null,wh(n),i)for(n=0;n<i.length;n++)wh(i[n])}}function Rh(n,i){return n(i)}function Ph(){}var $u=!1;function Nh(n,i,a){if($u)return n(i,a);$u=!0;try{return Rh(n,i,a)}finally{$u=!1,(Wr!==null||Yr!==null)&&(Ph(),Ch())}}function Jo(n,i){var a=n.stateNode;if(a===null)return null;var c=Xa(a);if(c===null)return null;a=c[i];e:switch(i){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(c=!c.disabled)||(n=n.type,c=!(n==="button"||n==="input"||n==="select"||n==="textarea")),n=!c;break e;default:n=!1}if(n)return null;if(a&&typeof a!="function")throw Error(r(231,i,typeof a));return a}var zu=!1;if(d)try{var es={};Object.defineProperty(es,"passive",{get:function(){zu=!0}}),window.addEventListener("test",es,es),window.removeEventListener("test",es,es)}catch{zu=!1}function BS(n,i,a,c,h,p,v,_,R){var k=Array.prototype.slice.call(arguments,3);try{i.apply(a,k)}catch(x){this.onError(x)}}var ts=!1,Ca=null,Ra=!1,Wu=null,HS={onError:function(n){ts=!0,Ca=n}};function bS(n,i,a,c,h,p,v,_,R){ts=!1,Ca=null,BS.apply(HS,arguments)}function GS(n,i,a,c,h,p,v,_,R){if(bS.apply(this,arguments),ts){if(ts){var k=Ca;ts=!1,Ca=null}else throw Error(r(198));Ra||(Ra=!0,Wu=k)}}function lr(n){var i=n,a=n;if(n.alternate)for(;i.return;)i=i.return;else{n=i;do i=n,(i.flags&4098)!==0&&(a=i.return),n=i.return;while(n)}return i.tag===3?a:null}function Dh(n){if(n.tag===13){var i=n.memoizedState;if(i===null&&(n=n.alternate,n!==null&&(i=n.memoizedState)),i!==null)return i.dehydrated}return null}function Oh(n){if(lr(n)!==n)throw Error(r(188))}function xS(n){var i=n.alternate;if(!i){if(i=lr(n),i===null)throw Error(r(188));return i!==n?null:n}for(var a=n,c=i;;){var h=a.return;if(h===null)break;var p=h.alternate;if(p===null){if(c=h.return,c!==null){a=c;continue}break}if(h.child===p.child){for(p=h.child;p;){if(p===a)return Oh(h),n;if(p===c)return Oh(h),i;p=p.sibling}throw Error(r(188))}if(a.return!==c.return)a=h,c=p;else{for(var v=!1,_=h.child;_;){if(_===a){v=!0,a=h,c=p;break}if(_===c){v=!0,c=h,a=p;break}_=_.sibling}if(!v){for(_=p.child;_;){if(_===a){v=!0,a=p,c=h;break}if(_===c){v=!0,c=p,a=h;break}_=_.sibling}if(!v)throw Error(r(189))}}if(a.alternate!==c)throw Error(r(190))}if(a.tag!==3)throw Error(r(188));return a.stateNode.current===a?n:i}function Mh(n){return n=xS(n),n!==null?kh(n):null}function kh(n){if(n.tag===5||n.tag===6)return n;for(n=n.child;n!==null;){var i=kh(n);if(i!==null)return i;n=n.sibling}return null}var Fh=t.unstable_scheduleCallback,Uh=t.unstable_cancelCallback,$S=t.unstable_shouldYield,zS=t.unstable_requestPaint,at=t.unstable_now,WS=t.unstable_getCurrentPriorityLevel,Yu=t.unstable_ImmediatePriority,Lh=t.unstable_UserBlockingPriority,Pa=t.unstable_NormalPriority,YS=t.unstable_LowPriority,Bh=t.unstable_IdlePriority,Na=null,Wn=null;function jS(n){if(Wn&&typeof Wn.onCommitFiberRoot=="function")try{Wn.onCommitFiberRoot(Na,n,void 0,(n.current.flags&128)===128)}catch{}}var wn=Math.clz32?Math.clz32:KS,VS=Math.log,XS=Math.LN2;function KS(n){return n>>>=0,n===0?32:31-(VS(n)/XS|0)|0}var Da=64,Oa=4194304;function ns(n){switch(n&-n){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return n&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return n&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return n}}function Ma(n,i){var a=n.pendingLanes;if(a===0)return 0;var c=0,h=n.suspendedLanes,p=n.pingedLanes,v=a&268435455;if(v!==0){var _=v&~h;_!==0?c=ns(_):(p&=v,p!==0&&(c=ns(p)))}else v=a&~h,v!==0?c=ns(v):p!==0&&(c=ns(p));if(c===0)return 0;if(i!==0&&i!==c&&(i&h)===0&&(h=c&-c,p=i&-i,h>=p||h===16&&(p&4194240)!==0))return i;if((c&4)!==0&&(c|=a&16),i=n.entangledLanes,i!==0)for(n=n.entanglements,i&=c;0<i;)a=31-wn(i),h=1<<a,c|=n[a],i&=~h;return c}function ZS(n,i){switch(n){case 1:case 2:case 4:return i+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return i+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function qS(n,i){for(var a=n.suspendedLanes,c=n.pingedLanes,h=n.expirationTimes,p=n.pendingLanes;0<p;){var v=31-wn(p),_=1<<v,R=h[v];R===-1?((_&a)===0||(_&c)!==0)&&(h[v]=ZS(_,i)):R<=i&&(n.expiredLanes|=_),p&=~_}}function ju(n){return n=n.pendingLanes&-1073741825,n!==0?n:n&1073741824?1073741824:0}function Hh(){var n=Da;return Da<<=1,(Da&4194240)===0&&(Da=64),n}function Vu(n){for(var i=[],a=0;31>a;a++)i.push(n);return i}function is(n,i,a){n.pendingLanes|=i,i!==536870912&&(n.suspendedLanes=0,n.pingedLanes=0),n=n.eventTimes,i=31-wn(i),n[i]=a}function QS(n,i){var a=n.pendingLanes&~i;n.pendingLanes=i,n.suspendedLanes=0,n.pingedLanes=0,n.expiredLanes&=i,n.mutableReadLanes&=i,n.entangledLanes&=i,i=n.entanglements;var c=n.eventTimes;for(n=n.expirationTimes;0<a;){var h=31-wn(a),p=1<<h;i[h]=0,c[h]=-1,n[h]=-1,a&=~p}}function Xu(n,i){var a=n.entangledLanes|=i;for(n=n.entanglements;a;){var c=31-wn(a),h=1<<c;h&i|n[c]&i&&(n[c]|=i),a&=~h}}var We=0;function bh(n){return n&=-n,1<n?4<n?(n&268435455)!==0?16:536870912:4:1}var Gh,Ku,xh,$h,zh,Zu=!1,ka=[],Ai=null,Ii=null,Ei=null,rs=new Map,os=new Map,wi=[],JS="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Wh(n,i){switch(n){case"focusin":case"focusout":Ai=null;break;case"dragenter":case"dragleave":Ii=null;break;case"mouseover":case"mouseout":Ei=null;break;case"pointerover":case"pointerout":rs.delete(i.pointerId);break;case"gotpointercapture":case"lostpointercapture":os.delete(i.pointerId)}}function ss(n,i,a,c,h,p){return n===null||n.nativeEvent!==p?(n={blockedOn:i,domEventName:a,eventSystemFlags:c,nativeEvent:p,targetContainers:[h]},i!==null&&(i=Ts(i),i!==null&&Ku(i)),n):(n.eventSystemFlags|=c,i=n.targetContainers,h!==null&&i.indexOf(h)===-1&&i.push(h),n)}function ey(n,i,a,c,h){switch(i){case"focusin":return Ai=ss(Ai,n,i,a,c,h),!0;case"dragenter":return Ii=ss(Ii,n,i,a,c,h),!0;case"mouseover":return Ei=ss(Ei,n,i,a,c,h),!0;case"pointerover":var p=h.pointerId;return rs.set(p,ss(rs.get(p)||null,n,i,a,c,h)),!0;case"gotpointercapture":return p=h.pointerId,os.set(p,ss(os.get(p)||null,n,i,a,c,h)),!0}return!1}function Yh(n){var i=ur(n.target);if(i!==null){var a=lr(i);if(a!==null){if(i=a.tag,i===13){if(i=Dh(a),i!==null){n.blockedOn=i,zh(n.priority,function(){xh(a)});return}}else if(i===3&&a.stateNode.current.memoizedState.isDehydrated){n.blockedOn=a.tag===3?a.stateNode.containerInfo:null;return}}}n.blockedOn=null}function Fa(n){if(n.blockedOn!==null)return!1;for(var i=n.targetContainers;0<i.length;){var a=Qu(n.domEventName,n.eventSystemFlags,i[0],n.nativeEvent);if(a===null){a=n.nativeEvent;var c=new a.constructor(a.type,a);bu=c,a.target.dispatchEvent(c),bu=null}else return i=Ts(a),i!==null&&Ku(i),n.blockedOn=a,!1;i.shift()}return!0}function jh(n,i,a){Fa(n)&&a.delete(i)}function ty(){Zu=!1,Ai!==null&&Fa(Ai)&&(Ai=null),Ii!==null&&Fa(Ii)&&(Ii=null),Ei!==null&&Fa(Ei)&&(Ei=null),rs.forEach(jh),os.forEach(jh)}function as(n,i){n.blockedOn===i&&(n.blockedOn=null,Zu||(Zu=!0,t.unstable_scheduleCallback(t.unstable_NormalPriority,ty)))}function ls(n){function i(h){return as(h,n)}if(0<ka.length){as(ka[0],n);for(var a=1;a<ka.length;a++){var c=ka[a];c.blockedOn===n&&(c.blockedOn=null)}}for(Ai!==null&&as(Ai,n),Ii!==null&&as(Ii,n),Ei!==null&&as(Ei,n),rs.forEach(i),os.forEach(i),a=0;a<wi.length;a++)c=wi[a],c.blockedOn===n&&(c.blockedOn=null);for(;0<wi.length&&(a=wi[0],a.blockedOn===null);)Yh(a),a.blockedOn===null&&wi.shift()}var jr=H.ReactCurrentBatchConfig,Ua=!0;function ny(n,i,a,c){var h=We,p=jr.transition;jr.transition=null;try{We=1,qu(n,i,a,c)}finally{We=h,jr.transition=p}}function iy(n,i,a,c){var h=We,p=jr.transition;jr.transition=null;try{We=4,qu(n,i,a,c)}finally{We=h,jr.transition=p}}function qu(n,i,a,c){if(Ua){var h=Qu(n,i,a,c);if(h===null)pc(n,i,c,La,a),Wh(n,c);else if(ey(h,n,i,a,c))c.stopPropagation();else if(Wh(n,c),i&4&&-1<JS.indexOf(n)){for(;h!==null;){var p=Ts(h);if(p!==null&&Gh(p),p=Qu(n,i,a,c),p===null&&pc(n,i,c,La,a),p===h)break;h=p}h!==null&&c.stopPropagation()}else pc(n,i,c,null,a)}}var La=null;function Qu(n,i,a,c){if(La=null,n=Gu(c),n=ur(n),n!==null)if(i=lr(n),i===null)n=null;else if(a=i.tag,a===13){if(n=Dh(i),n!==null)return n;n=null}else if(a===3){if(i.stateNode.current.memoizedState.isDehydrated)return i.tag===3?i.stateNode.containerInfo:null;n=null}else i!==n&&(n=null);return La=n,null}function Vh(n){switch(n){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(WS()){case Yu:return 1;case Lh:return 4;case Pa:case YS:return 16;case Bh:return 536870912;default:return 16}default:return 16}}var _i=null,Ju=null,Ba=null;function Xh(){if(Ba)return Ba;var n,i=Ju,a=i.length,c,h="value"in _i?_i.value:_i.textContent,p=h.length;for(n=0;n<a&&i[n]===h[n];n++);var v=a-n;for(c=1;c<=v&&i[a-c]===h[p-c];c++);return Ba=h.slice(n,1<c?1-c:void 0)}function Ha(n){var i=n.keyCode;return"charCode"in n?(n=n.charCode,n===0&&i===13&&(n=13)):n=i,n===10&&(n=13),32<=n||n===13?n:0}function ba(){return!0}function Kh(){return!1}function Jt(n){function i(a,c,h,p,v){this._reactName=a,this._targetInst=h,this.type=c,this.nativeEvent=p,this.target=v,this.currentTarget=null;for(var _ in n)n.hasOwnProperty(_)&&(a=n[_],this[_]=a?a(p):p[_]);return this.isDefaultPrevented=(p.defaultPrevented!=null?p.defaultPrevented:p.returnValue===!1)?ba:Kh,this.isPropagationStopped=Kh,this}return j(i.prototype,{preventDefault:function(){this.defaultPrevented=!0;var a=this.nativeEvent;a&&(a.preventDefault?a.preventDefault():typeof a.returnValue!="unknown"&&(a.returnValue=!1),this.isDefaultPrevented=ba)},stopPropagation:function(){var a=this.nativeEvent;a&&(a.stopPropagation?a.stopPropagation():typeof a.cancelBubble!="unknown"&&(a.cancelBubble=!0),this.isPropagationStopped=ba)},persist:function(){},isPersistent:ba}),i}var Vr={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(n){return n.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},ec=Jt(Vr),us=j({},Vr,{view:0,detail:0}),ry=Jt(us),tc,nc,cs,Ga=j({},us,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:rc,button:0,buttons:0,relatedTarget:function(n){return n.relatedTarget===void 0?n.fromElement===n.srcElement?n.toElement:n.fromElement:n.relatedTarget},movementX:function(n){return"movementX"in n?n.movementX:(n!==cs&&(cs&&n.type==="mousemove"?(tc=n.screenX-cs.screenX,nc=n.screenY-cs.screenY):nc=tc=0,cs=n),tc)},movementY:function(n){return"movementY"in n?n.movementY:nc}}),Zh=Jt(Ga),oy=j({},Ga,{dataTransfer:0}),sy=Jt(oy),ay=j({},us,{relatedTarget:0}),ic=Jt(ay),ly=j({},Vr,{animationName:0,elapsedTime:0,pseudoElement:0}),uy=Jt(ly),cy=j({},Vr,{clipboardData:function(n){return"clipboardData"in n?n.clipboardData:window.clipboardData}}),dy=Jt(cy),fy=j({},Vr,{data:0}),qh=Jt(fy),hy={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},gy={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},py={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function my(n){var i=this.nativeEvent;return i.getModifierState?i.getModifierState(n):(n=py[n])?!!i[n]:!1}function rc(){return my}var vy=j({},us,{key:function(n){if(n.key){var i=hy[n.key]||n.key;if(i!=="Unidentified")return i}return n.type==="keypress"?(n=Ha(n),n===13?"Enter":String.fromCharCode(n)):n.type==="keydown"||n.type==="keyup"?gy[n.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:rc,charCode:function(n){return n.type==="keypress"?Ha(n):0},keyCode:function(n){return n.type==="keydown"||n.type==="keyup"?n.keyCode:0},which:function(n){return n.type==="keypress"?Ha(n):n.type==="keydown"||n.type==="keyup"?n.keyCode:0}}),Sy=Jt(vy),yy=j({},Ga,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Qh=Jt(yy),Ty=j({},us,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:rc}),Ay=Jt(Ty),Iy=j({},Vr,{propertyName:0,elapsedTime:0,pseudoElement:0}),Ey=Jt(Iy),wy=j({},Ga,{deltaX:function(n){return"deltaX"in n?n.deltaX:"wheelDeltaX"in n?-n.wheelDeltaX:0},deltaY:function(n){return"deltaY"in n?n.deltaY:"wheelDeltaY"in n?-n.wheelDeltaY:"wheelDelta"in n?-n.wheelDelta:0},deltaZ:0,deltaMode:0}),_y=Jt(wy),Cy=[9,13,27,32],oc=d&&"CompositionEvent"in window,ds=null;d&&"documentMode"in document&&(ds=document.documentMode);var Ry=d&&"TextEvent"in window&&!ds,Jh=d&&(!oc||ds&&8<ds&&11>=ds),eg=" ",tg=!1;function ng(n,i){switch(n){case"keyup":return Cy.indexOf(i.keyCode)!==-1;case"keydown":return i.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function ig(n){return n=n.detail,typeof n=="object"&&"data"in n?n.data:null}var Xr=!1;function Py(n,i){switch(n){case"compositionend":return ig(i);case"keypress":return i.which!==32?null:(tg=!0,eg);case"textInput":return n=i.data,n===eg&&tg?null:n;default:return null}}function Ny(n,i){if(Xr)return n==="compositionend"||!oc&&ng(n,i)?(n=Xh(),Ba=Ju=_i=null,Xr=!1,n):null;switch(n){case"paste":return null;case"keypress":if(!(i.ctrlKey||i.altKey||i.metaKey)||i.ctrlKey&&i.altKey){if(i.char&&1<i.char.length)return i.char;if(i.which)return String.fromCharCode(i.which)}return null;case"compositionend":return Jh&&i.locale!=="ko"?null:i.data;default:return null}}var Dy={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function rg(n){var i=n&&n.nodeName&&n.nodeName.toLowerCase();return i==="input"?!!Dy[n.type]:i==="textarea"}function og(n,i,a,c){_h(c),i=Ya(i,"onChange"),0<i.length&&(a=new ec("onChange","change",null,a,c),n.push({event:a,listeners:i}))}var fs=null,hs=null;function Oy(n){Eg(n,0)}function xa(n){var i=Jr(n);if(ge(i))return n}function My(n,i){if(n==="change")return i}var sg=!1;if(d){var sc;if(d){var ac="oninput"in document;if(!ac){var ag=document.createElement("div");ag.setAttribute("oninput","return;"),ac=typeof ag.oninput=="function"}sc=ac}else sc=!1;sg=sc&&(!document.documentMode||9<document.documentMode)}function lg(){fs&&(fs.detachEvent("onpropertychange",ug),hs=fs=null)}function ug(n){if(n.propertyName==="value"&&xa(hs)){var i=[];og(i,hs,n,Gu(n)),Nh(Oy,i)}}function ky(n,i,a){n==="focusin"?(lg(),fs=i,hs=a,fs.attachEvent("onpropertychange",ug)):n==="focusout"&&lg()}function Fy(n){if(n==="selectionchange"||n==="keyup"||n==="keydown")return xa(hs)}function Uy(n,i){if(n==="click")return xa(i)}function Ly(n,i){if(n==="input"||n==="change")return xa(i)}function By(n,i){return n===i&&(n!==0||1/n===1/i)||n!==n&&i!==i}var _n=typeof Object.is=="function"?Object.is:By;function gs(n,i){if(_n(n,i))return!0;if(typeof n!="object"||n===null||typeof i!="object"||i===null)return!1;var a=Object.keys(n),c=Object.keys(i);if(a.length!==c.length)return!1;for(c=0;c<a.length;c++){var h=a[c];if(!f.call(i,h)||!_n(n[h],i[h]))return!1}return!0}function cg(n){for(;n&&n.firstChild;)n=n.firstChild;return n}function dg(n,i){var a=cg(n);n=0;for(var c;a;){if(a.nodeType===3){if(c=n+a.textContent.length,n<=i&&c>=i)return{node:a,offset:i-n};n=c}e:{for(;a;){if(a.nextSibling){a=a.nextSibling;break e}a=a.parentNode}a=void 0}a=cg(a)}}function fg(n,i){return n&&i?n===i?!0:n&&n.nodeType===3?!1:i&&i.nodeType===3?fg(n,i.parentNode):"contains"in n?n.contains(i):n.compareDocumentPosition?!!(n.compareDocumentPosition(i)&16):!1:!1}function hg(){for(var n=window,i=Gn();i instanceof n.HTMLIFrameElement;){try{var a=typeof i.contentWindow.location.href=="string"}catch{a=!1}if(a)n=i.contentWindow;else break;i=Gn(n.document)}return i}function lc(n){var i=n&&n.nodeName&&n.nodeName.toLowerCase();return i&&(i==="input"&&(n.type==="text"||n.type==="search"||n.type==="tel"||n.type==="url"||n.type==="password")||i==="textarea"||n.contentEditable==="true")}function Hy(n){var i=hg(),a=n.focusedElem,c=n.selectionRange;if(i!==a&&a&&a.ownerDocument&&fg(a.ownerDocument.documentElement,a)){if(c!==null&&lc(a)){if(i=c.start,n=c.end,n===void 0&&(n=i),"selectionStart"in a)a.selectionStart=i,a.selectionEnd=Math.min(n,a.value.length);else if(n=(i=a.ownerDocument||document)&&i.defaultView||window,n.getSelection){n=n.getSelection();var h=a.textContent.length,p=Math.min(c.start,h);c=c.end===void 0?p:Math.min(c.end,h),!n.extend&&p>c&&(h=c,c=p,p=h),h=dg(a,p);var v=dg(a,c);h&&v&&(n.rangeCount!==1||n.anchorNode!==h.node||n.anchorOffset!==h.offset||n.focusNode!==v.node||n.focusOffset!==v.offset)&&(i=i.createRange(),i.setStart(h.node,h.offset),n.removeAllRanges(),p>c?(n.addRange(i),n.extend(v.node,v.offset)):(i.setEnd(v.node,v.offset),n.addRange(i)))}}for(i=[],n=a;n=n.parentNode;)n.nodeType===1&&i.push({element:n,left:n.scrollLeft,top:n.scrollTop});for(typeof a.focus=="function"&&a.focus(),a=0;a<i.length;a++)n=i[a],n.element.scrollLeft=n.left,n.element.scrollTop=n.top}}var by=d&&"documentMode"in document&&11>=document.documentMode,Kr=null,uc=null,ps=null,cc=!1;function gg(n,i,a){var c=a.window===a?a.document:a.nodeType===9?a:a.ownerDocument;cc||Kr==null||Kr!==Gn(c)||(c=Kr,"selectionStart"in c&&lc(c)?c={start:c.selectionStart,end:c.selectionEnd}:(c=(c.ownerDocument&&c.ownerDocument.defaultView||window).getSelection(),c={anchorNode:c.anchorNode,anchorOffset:c.anchorOffset,focusNode:c.focusNode,focusOffset:c.focusOffset}),ps&&gs(ps,c)||(ps=c,c=Ya(uc,"onSelect"),0<c.length&&(i=new ec("onSelect","select",null,i,a),n.push({event:i,listeners:c}),i.target=Kr)))}function $a(n,i){var a={};return a[n.toLowerCase()]=i.toLowerCase(),a["Webkit"+n]="webkit"+i,a["Moz"+n]="moz"+i,a}var Zr={animationend:$a("Animation","AnimationEnd"),animationiteration:$a("Animation","AnimationIteration"),animationstart:$a("Animation","AnimationStart"),transitionend:$a("Transition","TransitionEnd")},dc={},pg={};d&&(pg=document.createElement("div").style,"AnimationEvent"in window||(delete Zr.animationend.animation,delete Zr.animationiteration.animation,delete Zr.animationstart.animation),"TransitionEvent"in window||delete Zr.transitionend.transition);function za(n){if(dc[n])return dc[n];if(!Zr[n])return n;var i=Zr[n],a;for(a in i)if(i.hasOwnProperty(a)&&a in pg)return dc[n]=i[a];return n}var mg=za("animationend"),vg=za("animationiteration"),Sg=za("animationstart"),yg=za("transitionend"),Tg=new Map,Ag="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Ci(n,i){Tg.set(n,i),s(i,[n])}for(var fc=0;fc<Ag.length;fc++){var hc=Ag[fc],Gy=hc.toLowerCase(),xy=hc[0].toUpperCase()+hc.slice(1);Ci(Gy,"on"+xy)}Ci(mg,"onAnimationEnd"),Ci(vg,"onAnimationIteration"),Ci(Sg,"onAnimationStart"),Ci("dblclick","onDoubleClick"),Ci("focusin","onFocus"),Ci("focusout","onBlur"),Ci(yg,"onTransitionEnd"),u("onMouseEnter",["mouseout","mouseover"]),u("onMouseLeave",["mouseout","mouseover"]),u("onPointerEnter",["pointerout","pointerover"]),u("onPointerLeave",["pointerout","pointerover"]),s("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),s("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),s("onBeforeInput",["compositionend","keypress","textInput","paste"]),s("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),s("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),s("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var ms="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),$y=new Set("cancel close invalid load scroll toggle".split(" ").concat(ms));function Ig(n,i,a){var c=n.type||"unknown-event";n.currentTarget=a,GS(c,i,void 0,n),n.currentTarget=null}function Eg(n,i){i=(i&4)!==0;for(var a=0;a<n.length;a++){var c=n[a],h=c.event;c=c.listeners;e:{var p=void 0;if(i)for(var v=c.length-1;0<=v;v--){var _=c[v],R=_.instance,k=_.currentTarget;if(_=_.listener,R!==p&&h.isPropagationStopped())break e;Ig(h,_,k),p=R}else for(v=0;v<c.length;v++){if(_=c[v],R=_.instance,k=_.currentTarget,_=_.listener,R!==p&&h.isPropagationStopped())break e;Ig(h,_,k),p=R}}}if(Ra)throw n=Wu,Ra=!1,Wu=null,n}function Ve(n,i){var a=i[Ac];a===void 0&&(a=i[Ac]=new Set);var c=n+"__bubble";a.has(c)||(wg(i,n,2,!1),a.add(c))}function gc(n,i,a){var c=0;i&&(c|=4),wg(a,n,c,i)}var Wa="_reactListening"+Math.random().toString(36).slice(2);function vs(n){if(!n[Wa]){n[Wa]=!0,o.forEach(function(a){a!=="selectionchange"&&($y.has(a)||gc(a,!1,n),gc(a,!0,n))});var i=n.nodeType===9?n:n.ownerDocument;i===null||i[Wa]||(i[Wa]=!0,gc("selectionchange",!1,i))}}function wg(n,i,a,c){switch(Vh(i)){case 1:var h=ny;break;case 4:h=iy;break;default:h=qu}a=h.bind(null,i,a,n),h=void 0,!zu||i!=="touchstart"&&i!=="touchmove"&&i!=="wheel"||(h=!0),c?h!==void 0?n.addEventListener(i,a,{capture:!0,passive:h}):n.addEventListener(i,a,!0):h!==void 0?n.addEventListener(i,a,{passive:h}):n.addEventListener(i,a,!1)}function pc(n,i,a,c,h){var p=c;if((i&1)===0&&(i&2)===0&&c!==null)e:for(;;){if(c===null)return;var v=c.tag;if(v===3||v===4){var _=c.stateNode.containerInfo;if(_===h||_.nodeType===8&&_.parentNode===h)break;if(v===4)for(v=c.return;v!==null;){var R=v.tag;if((R===3||R===4)&&(R=v.stateNode.containerInfo,R===h||R.nodeType===8&&R.parentNode===h))return;v=v.return}for(;_!==null;){if(v=ur(_),v===null)return;if(R=v.tag,R===5||R===6){c=p=v;continue e}_=_.parentNode}}c=c.return}Nh(function(){var k=p,x=Gu(a),z=[];e:{var G=Tg.get(n);if(G!==void 0){var q=ec,te=n;switch(n){case"keypress":if(Ha(a)===0)break e;case"keydown":case"keyup":q=Sy;break;case"focusin":te="focus",q=ic;break;case"focusout":te="blur",q=ic;break;case"beforeblur":case"afterblur":q=ic;break;case"click":if(a.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":q=Zh;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":q=sy;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":q=Ay;break;case mg:case vg:case Sg:q=uy;break;case yg:q=Ey;break;case"scroll":q=ry;break;case"wheel":q=_y;break;case"copy":case"cut":case"paste":q=dy;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":q=Qh}var se=(i&4)!==0,lt=!se&&n==="scroll",O=se?G!==null?G+"Capture":null:G;se=[];for(var N=k,M;N!==null;){M=N;var V=M.stateNode;if(M.tag===5&&V!==null&&(M=V,O!==null&&(V=Jo(N,O),V!=null&&se.push(Ss(N,V,M)))),lt)break;N=N.return}0<se.length&&(G=new q(G,te,null,a,x),z.push({event:G,listeners:se}))}}if((i&7)===0){e:{if(G=n==="mouseover"||n==="pointerover",q=n==="mouseout"||n==="pointerout",G&&a!==bu&&(te=a.relatedTarget||a.fromElement)&&(ur(te)||te[ti]))break e;if((q||G)&&(G=x.window===x?x:(G=x.ownerDocument)?G.defaultView||G.parentWindow:window,q?(te=a.relatedTarget||a.toElement,q=k,te=te?ur(te):null,te!==null&&(lt=lr(te),te!==lt||te.tag!==5&&te.tag!==6)&&(te=null)):(q=null,te=k),q!==te)){if(se=Zh,V="onMouseLeave",O="onMouseEnter",N="mouse",(n==="pointerout"||n==="pointerover")&&(se=Qh,V="onPointerLeave",O="onPointerEnter",N="pointer"),lt=q==null?G:Jr(q),M=te==null?G:Jr(te),G=new se(V,N+"leave",q,a,x),G.target=lt,G.relatedTarget=M,V=null,ur(x)===k&&(se=new se(O,N+"enter",te,a,x),se.target=M,se.relatedTarget=lt,V=se),lt=V,q&&te)t:{for(se=q,O=te,N=0,M=se;M;M=qr(M))N++;for(M=0,V=O;V;V=qr(V))M++;for(;0<N-M;)se=qr(se),N--;for(;0<M-N;)O=qr(O),M--;for(;N--;){if(se===O||O!==null&&se===O.alternate)break t;se=qr(se),O=qr(O)}se=null}else se=null;q!==null&&_g(z,G,q,se,!1),te!==null&&lt!==null&&_g(z,lt,te,se,!0)}}e:{if(G=k?Jr(k):window,q=G.nodeName&&G.nodeName.toLowerCase(),q==="select"||q==="input"&&G.type==="file")var ue=My;else if(rg(G))if(sg)ue=Ly;else{ue=Fy;var me=ky}else(q=G.nodeName)&&q.toLowerCase()==="input"&&(G.type==="checkbox"||G.type==="radio")&&(ue=Uy);if(ue&&(ue=ue(n,k))){og(z,ue,a,x);break e}me&&me(n,G,k),n==="focusout"&&(me=G._wrapperState)&&me.controlled&&G.type==="number"&&$n(G,"number",G.value)}switch(me=k?Jr(k):window,n){case"focusin":(rg(me)||me.contentEditable==="true")&&(Kr=me,uc=k,ps=null);break;case"focusout":ps=uc=Kr=null;break;case"mousedown":cc=!0;break;case"contextmenu":case"mouseup":case"dragend":cc=!1,gg(z,a,x);break;case"selectionchange":if(by)break;case"keydown":case"keyup":gg(z,a,x)}var ve;if(oc)e:{switch(n){case"compositionstart":var we="onCompositionStart";break e;case"compositionend":we="onCompositionEnd";break e;case"compositionupdate":we="onCompositionUpdate";break e}we=void 0}else Xr?ng(n,a)&&(we="onCompositionEnd"):n==="keydown"&&a.keyCode===229&&(we="onCompositionStart");we&&(Jh&&a.locale!=="ko"&&(Xr||we!=="onCompositionStart"?we==="onCompositionEnd"&&Xr&&(ve=Xh()):(_i=x,Ju="value"in _i?_i.value:_i.textContent,Xr=!0)),me=Ya(k,we),0<me.length&&(we=new qh(we,n,null,a,x),z.push({event:we,listeners:me}),ve?we.data=ve:(ve=ig(a),ve!==null&&(we.data=ve)))),(ve=Ry?Py(n,a):Ny(n,a))&&(k=Ya(k,"onBeforeInput"),0<k.length&&(x=new qh("onBeforeInput","beforeinput",null,a,x),z.push({event:x,listeners:k}),x.data=ve))}Eg(z,i)})}function Ss(n,i,a){return{instance:n,listener:i,currentTarget:a}}function Ya(n,i){for(var a=i+"Capture",c=[];n!==null;){var h=n,p=h.stateNode;h.tag===5&&p!==null&&(h=p,p=Jo(n,a),p!=null&&c.unshift(Ss(n,p,h)),p=Jo(n,i),p!=null&&c.push(Ss(n,p,h))),n=n.return}return c}function qr(n){if(n===null)return null;do n=n.return;while(n&&n.tag!==5);return n||null}function _g(n,i,a,c,h){for(var p=i._reactName,v=[];a!==null&&a!==c;){var _=a,R=_.alternate,k=_.stateNode;if(R!==null&&R===c)break;_.tag===5&&k!==null&&(_=k,h?(R=Jo(a,p),R!=null&&v.unshift(Ss(a,R,_))):h||(R=Jo(a,p),R!=null&&v.push(Ss(a,R,_)))),a=a.return}v.length!==0&&n.push({event:i,listeners:v})}var zy=/\r\n?/g,Wy=/\u0000|\uFFFD/g;function Cg(n){return(typeof n=="string"?n:""+n).replace(zy,`
`).replace(Wy,"")}function ja(n,i,a){if(i=Cg(i),Cg(n)!==i&&a)throw Error(r(425))}function Va(){}var mc=null,vc=null;function Sc(n,i){return n==="textarea"||n==="noscript"||typeof i.children=="string"||typeof i.children=="number"||typeof i.dangerouslySetInnerHTML=="object"&&i.dangerouslySetInnerHTML!==null&&i.dangerouslySetInnerHTML.__html!=null}var yc=typeof setTimeout=="function"?setTimeout:void 0,Yy=typeof clearTimeout=="function"?clearTimeout:void 0,Rg=typeof Promise=="function"?Promise:void 0,jy=typeof queueMicrotask=="function"?queueMicrotask:typeof Rg<"u"?function(n){return Rg.resolve(null).then(n).catch(Vy)}:yc;function Vy(n){setTimeout(function(){throw n})}function Tc(n,i){var a=i,c=0;do{var h=a.nextSibling;if(n.removeChild(a),h&&h.nodeType===8)if(a=h.data,a==="/$"){if(c===0){n.removeChild(h),ls(i);return}c--}else a!=="$"&&a!=="$?"&&a!=="$!"||c++;a=h}while(a);ls(i)}function Ri(n){for(;n!=null;n=n.nextSibling){var i=n.nodeType;if(i===1||i===3)break;if(i===8){if(i=n.data,i==="$"||i==="$!"||i==="$?")break;if(i==="/$")return null}}return n}function Pg(n){n=n.previousSibling;for(var i=0;n;){if(n.nodeType===8){var a=n.data;if(a==="$"||a==="$!"||a==="$?"){if(i===0)return n;i--}else a==="/$"&&i++}n=n.previousSibling}return null}var Qr=Math.random().toString(36).slice(2),Yn="__reactFiber$"+Qr,ys="__reactProps$"+Qr,ti="__reactContainer$"+Qr,Ac="__reactEvents$"+Qr,Xy="__reactListeners$"+Qr,Ky="__reactHandles$"+Qr;function ur(n){var i=n[Yn];if(i)return i;for(var a=n.parentNode;a;){if(i=a[ti]||a[Yn]){if(a=i.alternate,i.child!==null||a!==null&&a.child!==null)for(n=Pg(n);n!==null;){if(a=n[Yn])return a;n=Pg(n)}return i}n=a,a=n.parentNode}return null}function Ts(n){return n=n[Yn]||n[ti],!n||n.tag!==5&&n.tag!==6&&n.tag!==13&&n.tag!==3?null:n}function Jr(n){if(n.tag===5||n.tag===6)return n.stateNode;throw Error(r(33))}function Xa(n){return n[ys]||null}var Ic=[],eo=-1;function Pi(n){return{current:n}}function Xe(n){0>eo||(n.current=Ic[eo],Ic[eo]=null,eo--)}function Ye(n,i){eo++,Ic[eo]=n.current,n.current=i}var Ni={},Nt=Pi(Ni),jt=Pi(!1),cr=Ni;function to(n,i){var a=n.type.contextTypes;if(!a)return Ni;var c=n.stateNode;if(c&&c.__reactInternalMemoizedUnmaskedChildContext===i)return c.__reactInternalMemoizedMaskedChildContext;var h={},p;for(p in a)h[p]=i[p];return c&&(n=n.stateNode,n.__reactInternalMemoizedUnmaskedChildContext=i,n.__reactInternalMemoizedMaskedChildContext=h),h}function Vt(n){return n=n.childContextTypes,n!=null}function Ka(){Xe(jt),Xe(Nt)}function Ng(n,i,a){if(Nt.current!==Ni)throw Error(r(168));Ye(Nt,i),Ye(jt,a)}function Dg(n,i,a){var c=n.stateNode;if(i=i.childContextTypes,typeof c.getChildContext!="function")return a;c=c.getChildContext();for(var h in c)if(!(h in i))throw Error(r(108,Ee(n)||"Unknown",h));return j({},a,c)}function Za(n){return n=(n=n.stateNode)&&n.__reactInternalMemoizedMergedChildContext||Ni,cr=Nt.current,Ye(Nt,n),Ye(jt,jt.current),!0}function Og(n,i,a){var c=n.stateNode;if(!c)throw Error(r(169));a?(n=Dg(n,i,cr),c.__reactInternalMemoizedMergedChildContext=n,Xe(jt),Xe(Nt),Ye(Nt,n)):Xe(jt),Ye(jt,a)}var ni=null,qa=!1,Ec=!1;function Mg(n){ni===null?ni=[n]:ni.push(n)}function Zy(n){qa=!0,Mg(n)}function Di(){if(!Ec&&ni!==null){Ec=!0;var n=0,i=We;try{var a=ni;for(We=1;n<a.length;n++){var c=a[n];do c=c(!0);while(c!==null)}ni=null,qa=!1}catch(h){throw ni!==null&&(ni=ni.slice(n+1)),Fh(Yu,Di),h}finally{We=i,Ec=!1}}return null}var no=[],io=0,Qa=null,Ja=0,cn=[],dn=0,dr=null,ii=1,ri="";function fr(n,i){no[io++]=Ja,no[io++]=Qa,Qa=n,Ja=i}function kg(n,i,a){cn[dn++]=ii,cn[dn++]=ri,cn[dn++]=dr,dr=n;var c=ii;n=ri;var h=32-wn(c)-1;c&=~(1<<h),a+=1;var p=32-wn(i)+h;if(30<p){var v=h-h%5;p=(c&(1<<v)-1).toString(32),c>>=v,h-=v,ii=1<<32-wn(i)+h|a<<h|c,ri=p+n}else ii=1<<p|a<<h|c,ri=n}function wc(n){n.return!==null&&(fr(n,1),kg(n,1,0))}function _c(n){for(;n===Qa;)Qa=no[--io],no[io]=null,Ja=no[--io],no[io]=null;for(;n===dr;)dr=cn[--dn],cn[dn]=null,ri=cn[--dn],cn[dn]=null,ii=cn[--dn],cn[dn]=null}var en=null,tn=null,Qe=!1,Cn=null;function Fg(n,i){var a=pn(5,null,null,0);a.elementType="DELETED",a.stateNode=i,a.return=n,i=n.deletions,i===null?(n.deletions=[a],n.flags|=16):i.push(a)}function Ug(n,i){switch(n.tag){case 5:var a=n.type;return i=i.nodeType!==1||a.toLowerCase()!==i.nodeName.toLowerCase()?null:i,i!==null?(n.stateNode=i,en=n,tn=Ri(i.firstChild),!0):!1;case 6:return i=n.pendingProps===""||i.nodeType!==3?null:i,i!==null?(n.stateNode=i,en=n,tn=null,!0):!1;case 13:return i=i.nodeType!==8?null:i,i!==null?(a=dr!==null?{id:ii,overflow:ri}:null,n.memoizedState={dehydrated:i,treeContext:a,retryLane:1073741824},a=pn(18,null,null,0),a.stateNode=i,a.return=n,n.child=a,en=n,tn=null,!0):!1;default:return!1}}function Cc(n){return(n.mode&1)!==0&&(n.flags&128)===0}function Rc(n){if(Qe){var i=tn;if(i){var a=i;if(!Ug(n,i)){if(Cc(n))throw Error(r(418));i=Ri(a.nextSibling);var c=en;i&&Ug(n,i)?Fg(c,a):(n.flags=n.flags&-4097|2,Qe=!1,en=n)}}else{if(Cc(n))throw Error(r(418));n.flags=n.flags&-4097|2,Qe=!1,en=n}}}function Lg(n){for(n=n.return;n!==null&&n.tag!==5&&n.tag!==3&&n.tag!==13;)n=n.return;en=n}function el(n){if(n!==en)return!1;if(!Qe)return Lg(n),Qe=!0,!1;var i;if((i=n.tag!==3)&&!(i=n.tag!==5)&&(i=n.type,i=i!=="head"&&i!=="body"&&!Sc(n.type,n.memoizedProps)),i&&(i=tn)){if(Cc(n))throw Bg(),Error(r(418));for(;i;)Fg(n,i),i=Ri(i.nextSibling)}if(Lg(n),n.tag===13){if(n=n.memoizedState,n=n!==null?n.dehydrated:null,!n)throw Error(r(317));e:{for(n=n.nextSibling,i=0;n;){if(n.nodeType===8){var a=n.data;if(a==="/$"){if(i===0){tn=Ri(n.nextSibling);break e}i--}else a!=="$"&&a!=="$!"&&a!=="$?"||i++}n=n.nextSibling}tn=null}}else tn=en?Ri(n.stateNode.nextSibling):null;return!0}function Bg(){for(var n=tn;n;)n=Ri(n.nextSibling)}function ro(){tn=en=null,Qe=!1}function Pc(n){Cn===null?Cn=[n]:Cn.push(n)}var qy=H.ReactCurrentBatchConfig;function As(n,i,a){if(n=a.ref,n!==null&&typeof n!="function"&&typeof n!="object"){if(a._owner){if(a=a._owner,a){if(a.tag!==1)throw Error(r(309));var c=a.stateNode}if(!c)throw Error(r(147,n));var h=c,p=""+n;return i!==null&&i.ref!==null&&typeof i.ref=="function"&&i.ref._stringRef===p?i.ref:(i=function(v){var _=h.refs;v===null?delete _[p]:_[p]=v},i._stringRef=p,i)}if(typeof n!="string")throw Error(r(284));if(!a._owner)throw Error(r(290,n))}return n}function tl(n,i){throw n=Object.prototype.toString.call(i),Error(r(31,n==="[object Object]"?"object with keys {"+Object.keys(i).join(", ")+"}":n))}function Hg(n){var i=n._init;return i(n._payload)}function bg(n){function i(O,N){if(n){var M=O.deletions;M===null?(O.deletions=[N],O.flags|=16):M.push(N)}}function a(O,N){if(!n)return null;for(;N!==null;)i(O,N),N=N.sibling;return null}function c(O,N){for(O=new Map;N!==null;)N.key!==null?O.set(N.key,N):O.set(N.index,N),N=N.sibling;return O}function h(O,N){return O=Hi(O,N),O.index=0,O.sibling=null,O}function p(O,N,M){return O.index=M,n?(M=O.alternate,M!==null?(M=M.index,M<N?(O.flags|=2,N):M):(O.flags|=2,N)):(O.flags|=1048576,N)}function v(O){return n&&O.alternate===null&&(O.flags|=2),O}function _(O,N,M,V){return N===null||N.tag!==6?(N=yd(M,O.mode,V),N.return=O,N):(N=h(N,M),N.return=O,N)}function R(O,N,M,V){var ue=M.type;return ue===$?x(O,N,M.props.children,V,M.key):N!==null&&(N.elementType===ue||typeof ue=="object"&&ue!==null&&ue.$$typeof===Te&&Hg(ue)===N.type)?(V=h(N,M.props),V.ref=As(O,N,M),V.return=O,V):(V=_l(M.type,M.key,M.props,null,O.mode,V),V.ref=As(O,N,M),V.return=O,V)}function k(O,N,M,V){return N===null||N.tag!==4||N.stateNode.containerInfo!==M.containerInfo||N.stateNode.implementation!==M.implementation?(N=Td(M,O.mode,V),N.return=O,N):(N=h(N,M.children||[]),N.return=O,N)}function x(O,N,M,V,ue){return N===null||N.tag!==7?(N=Tr(M,O.mode,V,ue),N.return=O,N):(N=h(N,M),N.return=O,N)}function z(O,N,M){if(typeof N=="string"&&N!==""||typeof N=="number")return N=yd(""+N,O.mode,M),N.return=O,N;if(typeof N=="object"&&N!==null){switch(N.$$typeof){case b:return M=_l(N.type,N.key,N.props,null,O.mode,M),M.ref=As(O,null,N),M.return=O,M;case U:return N=Td(N,O.mode,M),N.return=O,N;case Te:var V=N._init;return z(O,V(N._payload),M)}if(zn(N)||X(N))return N=Tr(N,O.mode,M,null),N.return=O,N;tl(O,N)}return null}function G(O,N,M,V){var ue=N!==null?N.key:null;if(typeof M=="string"&&M!==""||typeof M=="number")return ue!==null?null:_(O,N,""+M,V);if(typeof M=="object"&&M!==null){switch(M.$$typeof){case b:return M.key===ue?R(O,N,M,V):null;case U:return M.key===ue?k(O,N,M,V):null;case Te:return ue=M._init,G(O,N,ue(M._payload),V)}if(zn(M)||X(M))return ue!==null?null:x(O,N,M,V,null);tl(O,M)}return null}function q(O,N,M,V,ue){if(typeof V=="string"&&V!==""||typeof V=="number")return O=O.get(M)||null,_(N,O,""+V,ue);if(typeof V=="object"&&V!==null){switch(V.$$typeof){case b:return O=O.get(V.key===null?M:V.key)||null,R(N,O,V,ue);case U:return O=O.get(V.key===null?M:V.key)||null,k(N,O,V,ue);case Te:var me=V._init;return q(O,N,M,me(V._payload),ue)}if(zn(V)||X(V))return O=O.get(M)||null,x(N,O,V,ue,null);tl(N,V)}return null}function te(O,N,M,V){for(var ue=null,me=null,ve=N,we=N=0,Tt=null;ve!==null&&we<M.length;we++){ve.index>we?(Tt=ve,ve=null):Tt=ve.sibling;var Ge=G(O,ve,M[we],V);if(Ge===null){ve===null&&(ve=Tt);break}n&&ve&&Ge.alternate===null&&i(O,ve),N=p(Ge,N,we),me===null?ue=Ge:me.sibling=Ge,me=Ge,ve=Tt}if(we===M.length)return a(O,ve),Qe&&fr(O,we),ue;if(ve===null){for(;we<M.length;we++)ve=z(O,M[we],V),ve!==null&&(N=p(ve,N,we),me===null?ue=ve:me.sibling=ve,me=ve);return Qe&&fr(O,we),ue}for(ve=c(O,ve);we<M.length;we++)Tt=q(ve,O,we,M[we],V),Tt!==null&&(n&&Tt.alternate!==null&&ve.delete(Tt.key===null?we:Tt.key),N=p(Tt,N,we),me===null?ue=Tt:me.sibling=Tt,me=Tt);return n&&ve.forEach(function(bi){return i(O,bi)}),Qe&&fr(O,we),ue}function se(O,N,M,V){var ue=X(M);if(typeof ue!="function")throw Error(r(150));if(M=ue.call(M),M==null)throw Error(r(151));for(var me=ue=null,ve=N,we=N=0,Tt=null,Ge=M.next();ve!==null&&!Ge.done;we++,Ge=M.next()){ve.index>we?(Tt=ve,ve=null):Tt=ve.sibling;var bi=G(O,ve,Ge.value,V);if(bi===null){ve===null&&(ve=Tt);break}n&&ve&&bi.alternate===null&&i(O,ve),N=p(bi,N,we),me===null?ue=bi:me.sibling=bi,me=bi,ve=Tt}if(Ge.done)return a(O,ve),Qe&&fr(O,we),ue;if(ve===null){for(;!Ge.done;we++,Ge=M.next())Ge=z(O,Ge.value,V),Ge!==null&&(N=p(Ge,N,we),me===null?ue=Ge:me.sibling=Ge,me=Ge);return Qe&&fr(O,we),ue}for(ve=c(O,ve);!Ge.done;we++,Ge=M.next())Ge=q(ve,O,we,Ge.value,V),Ge!==null&&(n&&Ge.alternate!==null&&ve.delete(Ge.key===null?we:Ge.key),N=p(Ge,N,we),me===null?ue=Ge:me.sibling=Ge,me=Ge);return n&&ve.forEach(function(DT){return i(O,DT)}),Qe&&fr(O,we),ue}function lt(O,N,M,V){if(typeof M=="object"&&M!==null&&M.type===$&&M.key===null&&(M=M.props.children),typeof M=="object"&&M!==null){switch(M.$$typeof){case b:e:{for(var ue=M.key,me=N;me!==null;){if(me.key===ue){if(ue=M.type,ue===$){if(me.tag===7){a(O,me.sibling),N=h(me,M.props.children),N.return=O,O=N;break e}}else if(me.elementType===ue||typeof ue=="object"&&ue!==null&&ue.$$typeof===Te&&Hg(ue)===me.type){a(O,me.sibling),N=h(me,M.props),N.ref=As(O,me,M),N.return=O,O=N;break e}a(O,me);break}else i(O,me);me=me.sibling}M.type===$?(N=Tr(M.props.children,O.mode,V,M.key),N.return=O,O=N):(V=_l(M.type,M.key,M.props,null,O.mode,V),V.ref=As(O,N,M),V.return=O,O=V)}return v(O);case U:e:{for(me=M.key;N!==null;){if(N.key===me)if(N.tag===4&&N.stateNode.containerInfo===M.containerInfo&&N.stateNode.implementation===M.implementation){a(O,N.sibling),N=h(N,M.children||[]),N.return=O,O=N;break e}else{a(O,N);break}else i(O,N);N=N.sibling}N=Td(M,O.mode,V),N.return=O,O=N}return v(O);case Te:return me=M._init,lt(O,N,me(M._payload),V)}if(zn(M))return te(O,N,M,V);if(X(M))return se(O,N,M,V);tl(O,M)}return typeof M=="string"&&M!==""||typeof M=="number"?(M=""+M,N!==null&&N.tag===6?(a(O,N.sibling),N=h(N,M),N.return=O,O=N):(a(O,N),N=yd(M,O.mode,V),N.return=O,O=N),v(O)):a(O,N)}return lt}var oo=bg(!0),Gg=bg(!1),nl=Pi(null),il=null,so=null,Nc=null;function Dc(){Nc=so=il=null}function Oc(n){var i=nl.current;Xe(nl),n._currentValue=i}function Mc(n,i,a){for(;n!==null;){var c=n.alternate;if((n.childLanes&i)!==i?(n.childLanes|=i,c!==null&&(c.childLanes|=i)):c!==null&&(c.childLanes&i)!==i&&(c.childLanes|=i),n===a)break;n=n.return}}function ao(n,i){il=n,Nc=so=null,n=n.dependencies,n!==null&&n.firstContext!==null&&((n.lanes&i)!==0&&(Xt=!0),n.firstContext=null)}function fn(n){var i=n._currentValue;if(Nc!==n)if(n={context:n,memoizedValue:i,next:null},so===null){if(il===null)throw Error(r(308));so=n,il.dependencies={lanes:0,firstContext:n}}else so=so.next=n;return i}var hr=null;function kc(n){hr===null?hr=[n]:hr.push(n)}function xg(n,i,a,c){var h=i.interleaved;return h===null?(a.next=a,kc(i)):(a.next=h.next,h.next=a),i.interleaved=a,oi(n,c)}function oi(n,i){n.lanes|=i;var a=n.alternate;for(a!==null&&(a.lanes|=i),a=n,n=n.return;n!==null;)n.childLanes|=i,a=n.alternate,a!==null&&(a.childLanes|=i),a=n,n=n.return;return a.tag===3?a.stateNode:null}var Oi=!1;function Fc(n){n.updateQueue={baseState:n.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function $g(n,i){n=n.updateQueue,i.updateQueue===n&&(i.updateQueue={baseState:n.baseState,firstBaseUpdate:n.firstBaseUpdate,lastBaseUpdate:n.lastBaseUpdate,shared:n.shared,effects:n.effects})}function si(n,i){return{eventTime:n,lane:i,tag:0,payload:null,callback:null,next:null}}function Mi(n,i,a){var c=n.updateQueue;if(c===null)return null;if(c=c.shared,(He&2)!==0){var h=c.pending;return h===null?i.next=i:(i.next=h.next,h.next=i),c.pending=i,oi(n,a)}return h=c.interleaved,h===null?(i.next=i,kc(c)):(i.next=h.next,h.next=i),c.interleaved=i,oi(n,a)}function rl(n,i,a){if(i=i.updateQueue,i!==null&&(i=i.shared,(a&4194240)!==0)){var c=i.lanes;c&=n.pendingLanes,a|=c,i.lanes=a,Xu(n,a)}}function zg(n,i){var a=n.updateQueue,c=n.alternate;if(c!==null&&(c=c.updateQueue,a===c)){var h=null,p=null;if(a=a.firstBaseUpdate,a!==null){do{var v={eventTime:a.eventTime,lane:a.lane,tag:a.tag,payload:a.payload,callback:a.callback,next:null};p===null?h=p=v:p=p.next=v,a=a.next}while(a!==null);p===null?h=p=i:p=p.next=i}else h=p=i;a={baseState:c.baseState,firstBaseUpdate:h,lastBaseUpdate:p,shared:c.shared,effects:c.effects},n.updateQueue=a;return}n=a.lastBaseUpdate,n===null?a.firstBaseUpdate=i:n.next=i,a.lastBaseUpdate=i}function ol(n,i,a,c){var h=n.updateQueue;Oi=!1;var p=h.firstBaseUpdate,v=h.lastBaseUpdate,_=h.shared.pending;if(_!==null){h.shared.pending=null;var R=_,k=R.next;R.next=null,v===null?p=k:v.next=k,v=R;var x=n.alternate;x!==null&&(x=x.updateQueue,_=x.lastBaseUpdate,_!==v&&(_===null?x.firstBaseUpdate=k:_.next=k,x.lastBaseUpdate=R))}if(p!==null){var z=h.baseState;v=0,x=k=R=null,_=p;do{var G=_.lane,q=_.eventTime;if((c&G)===G){x!==null&&(x=x.next={eventTime:q,lane:0,tag:_.tag,payload:_.payload,callback:_.callback,next:null});e:{var te=n,se=_;switch(G=i,q=a,se.tag){case 1:if(te=se.payload,typeof te=="function"){z=te.call(q,z,G);break e}z=te;break e;case 3:te.flags=te.flags&-65537|128;case 0:if(te=se.payload,G=typeof te=="function"?te.call(q,z,G):te,G==null)break e;z=j({},z,G);break e;case 2:Oi=!0}}_.callback!==null&&_.lane!==0&&(n.flags|=64,G=h.effects,G===null?h.effects=[_]:G.push(_))}else q={eventTime:q,lane:G,tag:_.tag,payload:_.payload,callback:_.callback,next:null},x===null?(k=x=q,R=z):x=x.next=q,v|=G;if(_=_.next,_===null){if(_=h.shared.pending,_===null)break;G=_,_=G.next,G.next=null,h.lastBaseUpdate=G,h.shared.pending=null}}while(!0);if(x===null&&(R=z),h.baseState=R,h.firstBaseUpdate=k,h.lastBaseUpdate=x,i=h.shared.interleaved,i!==null){h=i;do v|=h.lane,h=h.next;while(h!==i)}else p===null&&(h.shared.lanes=0);mr|=v,n.lanes=v,n.memoizedState=z}}function Wg(n,i,a){if(n=i.effects,i.effects=null,n!==null)for(i=0;i<n.length;i++){var c=n[i],h=c.callback;if(h!==null){if(c.callback=null,c=a,typeof h!="function")throw Error(r(191,h));h.call(c)}}}var Is={},jn=Pi(Is),Es=Pi(Is),ws=Pi(Is);function gr(n){if(n===Is)throw Error(r(174));return n}function Uc(n,i){switch(Ye(ws,i),Ye(Es,n),Ye(jn,Is),n=i.nodeType,n){case 9:case 11:i=(i=i.documentElement)?i.namespaceURI:Lu(null,"");break;default:n=n===8?i.parentNode:i,i=n.namespaceURI||null,n=n.tagName,i=Lu(i,n)}Xe(jn),Ye(jn,i)}function lo(){Xe(jn),Xe(Es),Xe(ws)}function Yg(n){gr(ws.current);var i=gr(jn.current),a=Lu(i,n.type);i!==a&&(Ye(Es,n),Ye(jn,a))}function Lc(n){Es.current===n&&(Xe(jn),Xe(Es))}var it=Pi(0);function sl(n){for(var i=n;i!==null;){if(i.tag===13){var a=i.memoizedState;if(a!==null&&(a=a.dehydrated,a===null||a.data==="$?"||a.data==="$!"))return i}else if(i.tag===19&&i.memoizedProps.revealOrder!==void 0){if((i.flags&128)!==0)return i}else if(i.child!==null){i.child.return=i,i=i.child;continue}if(i===n)break;for(;i.sibling===null;){if(i.return===null||i.return===n)return null;i=i.return}i.sibling.return=i.return,i=i.sibling}return null}var Bc=[];function Hc(){for(var n=0;n<Bc.length;n++)Bc[n]._workInProgressVersionPrimary=null;Bc.length=0}var al=H.ReactCurrentDispatcher,bc=H.ReactCurrentBatchConfig,pr=0,rt=null,ht=null,St=null,ll=!1,_s=!1,Cs=0,Qy=0;function Dt(){throw Error(r(321))}function Gc(n,i){if(i===null)return!1;for(var a=0;a<i.length&&a<n.length;a++)if(!_n(n[a],i[a]))return!1;return!0}function xc(n,i,a,c,h,p){if(pr=p,rt=i,i.memoizedState=null,i.updateQueue=null,i.lanes=0,al.current=n===null||n.memoizedState===null?nT:iT,n=a(c,h),_s){p=0;do{if(_s=!1,Cs=0,25<=p)throw Error(r(301));p+=1,St=ht=null,i.updateQueue=null,al.current=rT,n=a(c,h)}while(_s)}if(al.current=dl,i=ht!==null&&ht.next!==null,pr=0,St=ht=rt=null,ll=!1,i)throw Error(r(300));return n}function $c(){var n=Cs!==0;return Cs=0,n}function Vn(){var n={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return St===null?rt.memoizedState=St=n:St=St.next=n,St}function hn(){if(ht===null){var n=rt.alternate;n=n!==null?n.memoizedState:null}else n=ht.next;var i=St===null?rt.memoizedState:St.next;if(i!==null)St=i,ht=n;else{if(n===null)throw Error(r(310));ht=n,n={memoizedState:ht.memoizedState,baseState:ht.baseState,baseQueue:ht.baseQueue,queue:ht.queue,next:null},St===null?rt.memoizedState=St=n:St=St.next=n}return St}function Rs(n,i){return typeof i=="function"?i(n):i}function zc(n){var i=hn(),a=i.queue;if(a===null)throw Error(r(311));a.lastRenderedReducer=n;var c=ht,h=c.baseQueue,p=a.pending;if(p!==null){if(h!==null){var v=h.next;h.next=p.next,p.next=v}c.baseQueue=h=p,a.pending=null}if(h!==null){p=h.next,c=c.baseState;var _=v=null,R=null,k=p;do{var x=k.lane;if((pr&x)===x)R!==null&&(R=R.next={lane:0,action:k.action,hasEagerState:k.hasEagerState,eagerState:k.eagerState,next:null}),c=k.hasEagerState?k.eagerState:n(c,k.action);else{var z={lane:x,action:k.action,hasEagerState:k.hasEagerState,eagerState:k.eagerState,next:null};R===null?(_=R=z,v=c):R=R.next=z,rt.lanes|=x,mr|=x}k=k.next}while(k!==null&&k!==p);R===null?v=c:R.next=_,_n(c,i.memoizedState)||(Xt=!0),i.memoizedState=c,i.baseState=v,i.baseQueue=R,a.lastRenderedState=c}if(n=a.interleaved,n!==null){h=n;do p=h.lane,rt.lanes|=p,mr|=p,h=h.next;while(h!==n)}else h===null&&(a.lanes=0);return[i.memoizedState,a.dispatch]}function Wc(n){var i=hn(),a=i.queue;if(a===null)throw Error(r(311));a.lastRenderedReducer=n;var c=a.dispatch,h=a.pending,p=i.memoizedState;if(h!==null){a.pending=null;var v=h=h.next;do p=n(p,v.action),v=v.next;while(v!==h);_n(p,i.memoizedState)||(Xt=!0),i.memoizedState=p,i.baseQueue===null&&(i.baseState=p),a.lastRenderedState=p}return[p,c]}function jg(){}function Vg(n,i){var a=rt,c=hn(),h=i(),p=!_n(c.memoizedState,h);if(p&&(c.memoizedState=h,Xt=!0),c=c.queue,Yc(Zg.bind(null,a,c,n),[n]),c.getSnapshot!==i||p||St!==null&&St.memoizedState.tag&1){if(a.flags|=2048,Ps(9,Kg.bind(null,a,c,h,i),void 0,null),yt===null)throw Error(r(349));(pr&30)!==0||Xg(a,i,h)}return h}function Xg(n,i,a){n.flags|=16384,n={getSnapshot:i,value:a},i=rt.updateQueue,i===null?(i={lastEffect:null,stores:null},rt.updateQueue=i,i.stores=[n]):(a=i.stores,a===null?i.stores=[n]:a.push(n))}function Kg(n,i,a,c){i.value=a,i.getSnapshot=c,qg(i)&&Qg(n)}function Zg(n,i,a){return a(function(){qg(i)&&Qg(n)})}function qg(n){var i=n.getSnapshot;n=n.value;try{var a=i();return!_n(n,a)}catch{return!0}}function Qg(n){var i=oi(n,1);i!==null&&Dn(i,n,1,-1)}function Jg(n){var i=Vn();return typeof n=="function"&&(n=n()),i.memoizedState=i.baseState=n,n={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Rs,lastRenderedState:n},i.queue=n,n=n.dispatch=tT.bind(null,rt,n),[i.memoizedState,n]}function Ps(n,i,a,c){return n={tag:n,create:i,destroy:a,deps:c,next:null},i=rt.updateQueue,i===null?(i={lastEffect:null,stores:null},rt.updateQueue=i,i.lastEffect=n.next=n):(a=i.lastEffect,a===null?i.lastEffect=n.next=n:(c=a.next,a.next=n,n.next=c,i.lastEffect=n)),n}function ep(){return hn().memoizedState}function ul(n,i,a,c){var h=Vn();rt.flags|=n,h.memoizedState=Ps(1|i,a,void 0,c===void 0?null:c)}function cl(n,i,a,c){var h=hn();c=c===void 0?null:c;var p=void 0;if(ht!==null){var v=ht.memoizedState;if(p=v.destroy,c!==null&&Gc(c,v.deps)){h.memoizedState=Ps(i,a,p,c);return}}rt.flags|=n,h.memoizedState=Ps(1|i,a,p,c)}function tp(n,i){return ul(8390656,8,n,i)}function Yc(n,i){return cl(2048,8,n,i)}function np(n,i){return cl(4,2,n,i)}function ip(n,i){return cl(4,4,n,i)}function rp(n,i){if(typeof i=="function")return n=n(),i(n),function(){i(null)};if(i!=null)return n=n(),i.current=n,function(){i.current=null}}function op(n,i,a){return a=a!=null?a.concat([n]):null,cl(4,4,rp.bind(null,i,n),a)}function jc(){}function sp(n,i){var a=hn();i=i===void 0?null:i;var c=a.memoizedState;return c!==null&&i!==null&&Gc(i,c[1])?c[0]:(a.memoizedState=[n,i],n)}function ap(n,i){var a=hn();i=i===void 0?null:i;var c=a.memoizedState;return c!==null&&i!==null&&Gc(i,c[1])?c[0]:(n=n(),a.memoizedState=[n,i],n)}function lp(n,i,a){return(pr&21)===0?(n.baseState&&(n.baseState=!1,Xt=!0),n.memoizedState=a):(_n(a,i)||(a=Hh(),rt.lanes|=a,mr|=a,n.baseState=!0),i)}function Jy(n,i){var a=We;We=a!==0&&4>a?a:4,n(!0);var c=bc.transition;bc.transition={};try{n(!1),i()}finally{We=a,bc.transition=c}}function up(){return hn().memoizedState}function eT(n,i,a){var c=Li(n);if(a={lane:c,action:a,hasEagerState:!1,eagerState:null,next:null},cp(n))dp(i,a);else if(a=xg(n,i,a,c),a!==null){var h=Ht();Dn(a,n,c,h),fp(a,i,c)}}function tT(n,i,a){var c=Li(n),h={lane:c,action:a,hasEagerState:!1,eagerState:null,next:null};if(cp(n))dp(i,h);else{var p=n.alternate;if(n.lanes===0&&(p===null||p.lanes===0)&&(p=i.lastRenderedReducer,p!==null))try{var v=i.lastRenderedState,_=p(v,a);if(h.hasEagerState=!0,h.eagerState=_,_n(_,v)){var R=i.interleaved;R===null?(h.next=h,kc(i)):(h.next=R.next,R.next=h),i.interleaved=h;return}}catch{}finally{}a=xg(n,i,h,c),a!==null&&(h=Ht(),Dn(a,n,c,h),fp(a,i,c))}}function cp(n){var i=n.alternate;return n===rt||i!==null&&i===rt}function dp(n,i){_s=ll=!0;var a=n.pending;a===null?i.next=i:(i.next=a.next,a.next=i),n.pending=i}function fp(n,i,a){if((a&4194240)!==0){var c=i.lanes;c&=n.pendingLanes,a|=c,i.lanes=a,Xu(n,a)}}var dl={readContext:fn,useCallback:Dt,useContext:Dt,useEffect:Dt,useImperativeHandle:Dt,useInsertionEffect:Dt,useLayoutEffect:Dt,useMemo:Dt,useReducer:Dt,useRef:Dt,useState:Dt,useDebugValue:Dt,useDeferredValue:Dt,useTransition:Dt,useMutableSource:Dt,useSyncExternalStore:Dt,useId:Dt,unstable_isNewReconciler:!1},nT={readContext:fn,useCallback:function(n,i){return Vn().memoizedState=[n,i===void 0?null:i],n},useContext:fn,useEffect:tp,useImperativeHandle:function(n,i,a){return a=a!=null?a.concat([n]):null,ul(4194308,4,rp.bind(null,i,n),a)},useLayoutEffect:function(n,i){return ul(4194308,4,n,i)},useInsertionEffect:function(n,i){return ul(4,2,n,i)},useMemo:function(n,i){var a=Vn();return i=i===void 0?null:i,n=n(),a.memoizedState=[n,i],n},useReducer:function(n,i,a){var c=Vn();return i=a!==void 0?a(i):i,c.memoizedState=c.baseState=i,n={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:n,lastRenderedState:i},c.queue=n,n=n.dispatch=eT.bind(null,rt,n),[c.memoizedState,n]},useRef:function(n){var i=Vn();return n={current:n},i.memoizedState=n},useState:Jg,useDebugValue:jc,useDeferredValue:function(n){return Vn().memoizedState=n},useTransition:function(){var n=Jg(!1),i=n[0];return n=Jy.bind(null,n[1]),Vn().memoizedState=n,[i,n]},useMutableSource:function(){},useSyncExternalStore:function(n,i,a){var c=rt,h=Vn();if(Qe){if(a===void 0)throw Error(r(407));a=a()}else{if(a=i(),yt===null)throw Error(r(349));(pr&30)!==0||Xg(c,i,a)}h.memoizedState=a;var p={value:a,getSnapshot:i};return h.queue=p,tp(Zg.bind(null,c,p,n),[n]),c.flags|=2048,Ps(9,Kg.bind(null,c,p,a,i),void 0,null),a},useId:function(){var n=Vn(),i=yt.identifierPrefix;if(Qe){var a=ri,c=ii;a=(c&~(1<<32-wn(c)-1)).toString(32)+a,i=":"+i+"R"+a,a=Cs++,0<a&&(i+="H"+a.toString(32)),i+=":"}else a=Qy++,i=":"+i+"r"+a.toString(32)+":";return n.memoizedState=i},unstable_isNewReconciler:!1},iT={readContext:fn,useCallback:sp,useContext:fn,useEffect:Yc,useImperativeHandle:op,useInsertionEffect:np,useLayoutEffect:ip,useMemo:ap,useReducer:zc,useRef:ep,useState:function(){return zc(Rs)},useDebugValue:jc,useDeferredValue:function(n){var i=hn();return lp(i,ht.memoizedState,n)},useTransition:function(){var n=zc(Rs)[0],i=hn().memoizedState;return[n,i]},useMutableSource:jg,useSyncExternalStore:Vg,useId:up,unstable_isNewReconciler:!1},rT={readContext:fn,useCallback:sp,useContext:fn,useEffect:Yc,useImperativeHandle:op,useInsertionEffect:np,useLayoutEffect:ip,useMemo:ap,useReducer:Wc,useRef:ep,useState:function(){return Wc(Rs)},useDebugValue:jc,useDeferredValue:function(n){var i=hn();return ht===null?i.memoizedState=n:lp(i,ht.memoizedState,n)},useTransition:function(){var n=Wc(Rs)[0],i=hn().memoizedState;return[n,i]},useMutableSource:jg,useSyncExternalStore:Vg,useId:up,unstable_isNewReconciler:!1};function Rn(n,i){if(n&&n.defaultProps){i=j({},i),n=n.defaultProps;for(var a in n)i[a]===void 0&&(i[a]=n[a]);return i}return i}function Vc(n,i,a,c){i=n.memoizedState,a=a(c,i),a=a==null?i:j({},i,a),n.memoizedState=a,n.lanes===0&&(n.updateQueue.baseState=a)}var fl={isMounted:function(n){return(n=n._reactInternals)?lr(n)===n:!1},enqueueSetState:function(n,i,a){n=n._reactInternals;var c=Ht(),h=Li(n),p=si(c,h);p.payload=i,a!=null&&(p.callback=a),i=Mi(n,p,h),i!==null&&(Dn(i,n,h,c),rl(i,n,h))},enqueueReplaceState:function(n,i,a){n=n._reactInternals;var c=Ht(),h=Li(n),p=si(c,h);p.tag=1,p.payload=i,a!=null&&(p.callback=a),i=Mi(n,p,h),i!==null&&(Dn(i,n,h,c),rl(i,n,h))},enqueueForceUpdate:function(n,i){n=n._reactInternals;var a=Ht(),c=Li(n),h=si(a,c);h.tag=2,i!=null&&(h.callback=i),i=Mi(n,h,c),i!==null&&(Dn(i,n,c,a),rl(i,n,c))}};function hp(n,i,a,c,h,p,v){return n=n.stateNode,typeof n.shouldComponentUpdate=="function"?n.shouldComponentUpdate(c,p,v):i.prototype&&i.prototype.isPureReactComponent?!gs(a,c)||!gs(h,p):!0}function gp(n,i,a){var c=!1,h=Ni,p=i.contextType;return typeof p=="object"&&p!==null?p=fn(p):(h=Vt(i)?cr:Nt.current,c=i.contextTypes,p=(c=c!=null)?to(n,h):Ni),i=new i(a,p),n.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,i.updater=fl,n.stateNode=i,i._reactInternals=n,c&&(n=n.stateNode,n.__reactInternalMemoizedUnmaskedChildContext=h,n.__reactInternalMemoizedMaskedChildContext=p),i}function pp(n,i,a,c){n=i.state,typeof i.componentWillReceiveProps=="function"&&i.componentWillReceiveProps(a,c),typeof i.UNSAFE_componentWillReceiveProps=="function"&&i.UNSAFE_componentWillReceiveProps(a,c),i.state!==n&&fl.enqueueReplaceState(i,i.state,null)}function Xc(n,i,a,c){var h=n.stateNode;h.props=a,h.state=n.memoizedState,h.refs={},Fc(n);var p=i.contextType;typeof p=="object"&&p!==null?h.context=fn(p):(p=Vt(i)?cr:Nt.current,h.context=to(n,p)),h.state=n.memoizedState,p=i.getDerivedStateFromProps,typeof p=="function"&&(Vc(n,i,p,a),h.state=n.memoizedState),typeof i.getDerivedStateFromProps=="function"||typeof h.getSnapshotBeforeUpdate=="function"||typeof h.UNSAFE_componentWillMount!="function"&&typeof h.componentWillMount!="function"||(i=h.state,typeof h.componentWillMount=="function"&&h.componentWillMount(),typeof h.UNSAFE_componentWillMount=="function"&&h.UNSAFE_componentWillMount(),i!==h.state&&fl.enqueueReplaceState(h,h.state,null),ol(n,a,h,c),h.state=n.memoizedState),typeof h.componentDidMount=="function"&&(n.flags|=4194308)}function uo(n,i){try{var a="",c=i;do a+=Se(c),c=c.return;while(c);var h=a}catch(p){h=`
Error generating stack: `+p.message+`
`+p.stack}return{value:n,source:i,stack:h,digest:null}}function Kc(n,i,a){return{value:n,source:null,stack:a??null,digest:i??null}}function Zc(n,i){try{console.error(i.value)}catch(a){setTimeout(function(){throw a})}}var oT=typeof WeakMap=="function"?WeakMap:Map;function mp(n,i,a){a=si(-1,a),a.tag=3,a.payload={element:null};var c=i.value;return a.callback=function(){yl||(yl=!0,dd=c),Zc(n,i)},a}function vp(n,i,a){a=si(-1,a),a.tag=3;var c=n.type.getDerivedStateFromError;if(typeof c=="function"){var h=i.value;a.payload=function(){return c(h)},a.callback=function(){Zc(n,i)}}var p=n.stateNode;return p!==null&&typeof p.componentDidCatch=="function"&&(a.callback=function(){Zc(n,i),typeof c!="function"&&(Fi===null?Fi=new Set([this]):Fi.add(this));var v=i.stack;this.componentDidCatch(i.value,{componentStack:v!==null?v:""})}),a}function Sp(n,i,a){var c=n.pingCache;if(c===null){c=n.pingCache=new oT;var h=new Set;c.set(i,h)}else h=c.get(i),h===void 0&&(h=new Set,c.set(i,h));h.has(a)||(h.add(a),n=yT.bind(null,n,i,a),i.then(n,n))}function yp(n){do{var i;if((i=n.tag===13)&&(i=n.memoizedState,i=i!==null?i.dehydrated!==null:!0),i)return n;n=n.return}while(n!==null);return null}function Tp(n,i,a,c,h){return(n.mode&1)===0?(n===i?n.flags|=65536:(n.flags|=128,a.flags|=131072,a.flags&=-52805,a.tag===1&&(a.alternate===null?a.tag=17:(i=si(-1,1),i.tag=2,Mi(a,i,1))),a.lanes|=1),n):(n.flags|=65536,n.lanes=h,n)}var sT=H.ReactCurrentOwner,Xt=!1;function Bt(n,i,a,c){i.child=n===null?Gg(i,null,a,c):oo(i,n.child,a,c)}function Ap(n,i,a,c,h){a=a.render;var p=i.ref;return ao(i,h),c=xc(n,i,a,c,p,h),a=$c(),n!==null&&!Xt?(i.updateQueue=n.updateQueue,i.flags&=-2053,n.lanes&=~h,ai(n,i,h)):(Qe&&a&&wc(i),i.flags|=1,Bt(n,i,c,h),i.child)}function Ip(n,i,a,c,h){if(n===null){var p=a.type;return typeof p=="function"&&!Sd(p)&&p.defaultProps===void 0&&a.compare===null&&a.defaultProps===void 0?(i.tag=15,i.type=p,Ep(n,i,p,c,h)):(n=_l(a.type,null,c,i,i.mode,h),n.ref=i.ref,n.return=i,i.child=n)}if(p=n.child,(n.lanes&h)===0){var v=p.memoizedProps;if(a=a.compare,a=a!==null?a:gs,a(v,c)&&n.ref===i.ref)return ai(n,i,h)}return i.flags|=1,n=Hi(p,c),n.ref=i.ref,n.return=i,i.child=n}function Ep(n,i,a,c,h){if(n!==null){var p=n.memoizedProps;if(gs(p,c)&&n.ref===i.ref)if(Xt=!1,i.pendingProps=c=p,(n.lanes&h)!==0)(n.flags&131072)!==0&&(Xt=!0);else return i.lanes=n.lanes,ai(n,i,h)}return qc(n,i,a,c,h)}function wp(n,i,a){var c=i.pendingProps,h=c.children,p=n!==null?n.memoizedState:null;if(c.mode==="hidden")if((i.mode&1)===0)i.memoizedState={baseLanes:0,cachePool:null,transitions:null},Ye(fo,nn),nn|=a;else{if((a&1073741824)===0)return n=p!==null?p.baseLanes|a:a,i.lanes=i.childLanes=1073741824,i.memoizedState={baseLanes:n,cachePool:null,transitions:null},i.updateQueue=null,Ye(fo,nn),nn|=n,null;i.memoizedState={baseLanes:0,cachePool:null,transitions:null},c=p!==null?p.baseLanes:a,Ye(fo,nn),nn|=c}else p!==null?(c=p.baseLanes|a,i.memoizedState=null):c=a,Ye(fo,nn),nn|=c;return Bt(n,i,h,a),i.child}function _p(n,i){var a=i.ref;(n===null&&a!==null||n!==null&&n.ref!==a)&&(i.flags|=512,i.flags|=2097152)}function qc(n,i,a,c,h){var p=Vt(a)?cr:Nt.current;return p=to(i,p),ao(i,h),a=xc(n,i,a,c,p,h),c=$c(),n!==null&&!Xt?(i.updateQueue=n.updateQueue,i.flags&=-2053,n.lanes&=~h,ai(n,i,h)):(Qe&&c&&wc(i),i.flags|=1,Bt(n,i,a,h),i.child)}function Cp(n,i,a,c,h){if(Vt(a)){var p=!0;Za(i)}else p=!1;if(ao(i,h),i.stateNode===null)gl(n,i),gp(i,a,c),Xc(i,a,c,h),c=!0;else if(n===null){var v=i.stateNode,_=i.memoizedProps;v.props=_;var R=v.context,k=a.contextType;typeof k=="object"&&k!==null?k=fn(k):(k=Vt(a)?cr:Nt.current,k=to(i,k));var x=a.getDerivedStateFromProps,z=typeof x=="function"||typeof v.getSnapshotBeforeUpdate=="function";z||typeof v.UNSAFE_componentWillReceiveProps!="function"&&typeof v.componentWillReceiveProps!="function"||(_!==c||R!==k)&&pp(i,v,c,k),Oi=!1;var G=i.memoizedState;v.state=G,ol(i,c,v,h),R=i.memoizedState,_!==c||G!==R||jt.current||Oi?(typeof x=="function"&&(Vc(i,a,x,c),R=i.memoizedState),(_=Oi||hp(i,a,_,c,G,R,k))?(z||typeof v.UNSAFE_componentWillMount!="function"&&typeof v.componentWillMount!="function"||(typeof v.componentWillMount=="function"&&v.componentWillMount(),typeof v.UNSAFE_componentWillMount=="function"&&v.UNSAFE_componentWillMount()),typeof v.componentDidMount=="function"&&(i.flags|=4194308)):(typeof v.componentDidMount=="function"&&(i.flags|=4194308),i.memoizedProps=c,i.memoizedState=R),v.props=c,v.state=R,v.context=k,c=_):(typeof v.componentDidMount=="function"&&(i.flags|=4194308),c=!1)}else{v=i.stateNode,$g(n,i),_=i.memoizedProps,k=i.type===i.elementType?_:Rn(i.type,_),v.props=k,z=i.pendingProps,G=v.context,R=a.contextType,typeof R=="object"&&R!==null?R=fn(R):(R=Vt(a)?cr:Nt.current,R=to(i,R));var q=a.getDerivedStateFromProps;(x=typeof q=="function"||typeof v.getSnapshotBeforeUpdate=="function")||typeof v.UNSAFE_componentWillReceiveProps!="function"&&typeof v.componentWillReceiveProps!="function"||(_!==z||G!==R)&&pp(i,v,c,R),Oi=!1,G=i.memoizedState,v.state=G,ol(i,c,v,h);var te=i.memoizedState;_!==z||G!==te||jt.current||Oi?(typeof q=="function"&&(Vc(i,a,q,c),te=i.memoizedState),(k=Oi||hp(i,a,k,c,G,te,R)||!1)?(x||typeof v.UNSAFE_componentWillUpdate!="function"&&typeof v.componentWillUpdate!="function"||(typeof v.componentWillUpdate=="function"&&v.componentWillUpdate(c,te,R),typeof v.UNSAFE_componentWillUpdate=="function"&&v.UNSAFE_componentWillUpdate(c,te,R)),typeof v.componentDidUpdate=="function"&&(i.flags|=4),typeof v.getSnapshotBeforeUpdate=="function"&&(i.flags|=1024)):(typeof v.componentDidUpdate!="function"||_===n.memoizedProps&&G===n.memoizedState||(i.flags|=4),typeof v.getSnapshotBeforeUpdate!="function"||_===n.memoizedProps&&G===n.memoizedState||(i.flags|=1024),i.memoizedProps=c,i.memoizedState=te),v.props=c,v.state=te,v.context=R,c=k):(typeof v.componentDidUpdate!="function"||_===n.memoizedProps&&G===n.memoizedState||(i.flags|=4),typeof v.getSnapshotBeforeUpdate!="function"||_===n.memoizedProps&&G===n.memoizedState||(i.flags|=1024),c=!1)}return Qc(n,i,a,c,p,h)}function Qc(n,i,a,c,h,p){_p(n,i);var v=(i.flags&128)!==0;if(!c&&!v)return h&&Og(i,a,!1),ai(n,i,p);c=i.stateNode,sT.current=i;var _=v&&typeof a.getDerivedStateFromError!="function"?null:c.render();return i.flags|=1,n!==null&&v?(i.child=oo(i,n.child,null,p),i.child=oo(i,null,_,p)):Bt(n,i,_,p),i.memoizedState=c.state,h&&Og(i,a,!0),i.child}function Rp(n){var i=n.stateNode;i.pendingContext?Ng(n,i.pendingContext,i.pendingContext!==i.context):i.context&&Ng(n,i.context,!1),Uc(n,i.containerInfo)}function Pp(n,i,a,c,h){return ro(),Pc(h),i.flags|=256,Bt(n,i,a,c),i.child}var Jc={dehydrated:null,treeContext:null,retryLane:0};function ed(n){return{baseLanes:n,cachePool:null,transitions:null}}function Np(n,i,a){var c=i.pendingProps,h=it.current,p=!1,v=(i.flags&128)!==0,_;if((_=v)||(_=n!==null&&n.memoizedState===null?!1:(h&2)!==0),_?(p=!0,i.flags&=-129):(n===null||n.memoizedState!==null)&&(h|=1),Ye(it,h&1),n===null)return Rc(i),n=i.memoizedState,n!==null&&(n=n.dehydrated,n!==null)?((i.mode&1)===0?i.lanes=1:n.data==="$!"?i.lanes=8:i.lanes=1073741824,null):(v=c.children,n=c.fallback,p?(c=i.mode,p=i.child,v={mode:"hidden",children:v},(c&1)===0&&p!==null?(p.childLanes=0,p.pendingProps=v):p=Cl(v,c,0,null),n=Tr(n,c,a,null),p.return=i,n.return=i,p.sibling=n,i.child=p,i.child.memoizedState=ed(a),i.memoizedState=Jc,n):td(i,v));if(h=n.memoizedState,h!==null&&(_=h.dehydrated,_!==null))return aT(n,i,v,c,_,h,a);if(p){p=c.fallback,v=i.mode,h=n.child,_=h.sibling;var R={mode:"hidden",children:c.children};return(v&1)===0&&i.child!==h?(c=i.child,c.childLanes=0,c.pendingProps=R,i.deletions=null):(c=Hi(h,R),c.subtreeFlags=h.subtreeFlags&14680064),_!==null?p=Hi(_,p):(p=Tr(p,v,a,null),p.flags|=2),p.return=i,c.return=i,c.sibling=p,i.child=c,c=p,p=i.child,v=n.child.memoizedState,v=v===null?ed(a):{baseLanes:v.baseLanes|a,cachePool:null,transitions:v.transitions},p.memoizedState=v,p.childLanes=n.childLanes&~a,i.memoizedState=Jc,c}return p=n.child,n=p.sibling,c=Hi(p,{mode:"visible",children:c.children}),(i.mode&1)===0&&(c.lanes=a),c.return=i,c.sibling=null,n!==null&&(a=i.deletions,a===null?(i.deletions=[n],i.flags|=16):a.push(n)),i.child=c,i.memoizedState=null,c}function td(n,i){return i=Cl({mode:"visible",children:i},n.mode,0,null),i.return=n,n.child=i}function hl(n,i,a,c){return c!==null&&Pc(c),oo(i,n.child,null,a),n=td(i,i.pendingProps.children),n.flags|=2,i.memoizedState=null,n}function aT(n,i,a,c,h,p,v){if(a)return i.flags&256?(i.flags&=-257,c=Kc(Error(r(422))),hl(n,i,v,c)):i.memoizedState!==null?(i.child=n.child,i.flags|=128,null):(p=c.fallback,h=i.mode,c=Cl({mode:"visible",children:c.children},h,0,null),p=Tr(p,h,v,null),p.flags|=2,c.return=i,p.return=i,c.sibling=p,i.child=c,(i.mode&1)!==0&&oo(i,n.child,null,v),i.child.memoizedState=ed(v),i.memoizedState=Jc,p);if((i.mode&1)===0)return hl(n,i,v,null);if(h.data==="$!"){if(c=h.nextSibling&&h.nextSibling.dataset,c)var _=c.dgst;return c=_,p=Error(r(419)),c=Kc(p,c,void 0),hl(n,i,v,c)}if(_=(v&n.childLanes)!==0,Xt||_){if(c=yt,c!==null){switch(v&-v){case 4:h=2;break;case 16:h=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:h=32;break;case 536870912:h=268435456;break;default:h=0}h=(h&(c.suspendedLanes|v))!==0?0:h,h!==0&&h!==p.retryLane&&(p.retryLane=h,oi(n,h),Dn(c,n,h,-1))}return vd(),c=Kc(Error(r(421))),hl(n,i,v,c)}return h.data==="$?"?(i.flags|=128,i.child=n.child,i=TT.bind(null,n),h._reactRetry=i,null):(n=p.treeContext,tn=Ri(h.nextSibling),en=i,Qe=!0,Cn=null,n!==null&&(cn[dn++]=ii,cn[dn++]=ri,cn[dn++]=dr,ii=n.id,ri=n.overflow,dr=i),i=td(i,c.children),i.flags|=4096,i)}function Dp(n,i,a){n.lanes|=i;var c=n.alternate;c!==null&&(c.lanes|=i),Mc(n.return,i,a)}function nd(n,i,a,c,h){var p=n.memoizedState;p===null?n.memoizedState={isBackwards:i,rendering:null,renderingStartTime:0,last:c,tail:a,tailMode:h}:(p.isBackwards=i,p.rendering=null,p.renderingStartTime=0,p.last=c,p.tail=a,p.tailMode=h)}function Op(n,i,a){var c=i.pendingProps,h=c.revealOrder,p=c.tail;if(Bt(n,i,c.children,a),c=it.current,(c&2)!==0)c=c&1|2,i.flags|=128;else{if(n!==null&&(n.flags&128)!==0)e:for(n=i.child;n!==null;){if(n.tag===13)n.memoizedState!==null&&Dp(n,a,i);else if(n.tag===19)Dp(n,a,i);else if(n.child!==null){n.child.return=n,n=n.child;continue}if(n===i)break e;for(;n.sibling===null;){if(n.return===null||n.return===i)break e;n=n.return}n.sibling.return=n.return,n=n.sibling}c&=1}if(Ye(it,c),(i.mode&1)===0)i.memoizedState=null;else switch(h){case"forwards":for(a=i.child,h=null;a!==null;)n=a.alternate,n!==null&&sl(n)===null&&(h=a),a=a.sibling;a=h,a===null?(h=i.child,i.child=null):(h=a.sibling,a.sibling=null),nd(i,!1,h,a,p);break;case"backwards":for(a=null,h=i.child,i.child=null;h!==null;){if(n=h.alternate,n!==null&&sl(n)===null){i.child=h;break}n=h.sibling,h.sibling=a,a=h,h=n}nd(i,!0,a,null,p);break;case"together":nd(i,!1,null,null,void 0);break;default:i.memoizedState=null}return i.child}function gl(n,i){(i.mode&1)===0&&n!==null&&(n.alternate=null,i.alternate=null,i.flags|=2)}function ai(n,i,a){if(n!==null&&(i.dependencies=n.dependencies),mr|=i.lanes,(a&i.childLanes)===0)return null;if(n!==null&&i.child!==n.child)throw Error(r(153));if(i.child!==null){for(n=i.child,a=Hi(n,n.pendingProps),i.child=a,a.return=i;n.sibling!==null;)n=n.sibling,a=a.sibling=Hi(n,n.pendingProps),a.return=i;a.sibling=null}return i.child}function lT(n,i,a){switch(i.tag){case 3:Rp(i),ro();break;case 5:Yg(i);break;case 1:Vt(i.type)&&Za(i);break;case 4:Uc(i,i.stateNode.containerInfo);break;case 10:var c=i.type._context,h=i.memoizedProps.value;Ye(nl,c._currentValue),c._currentValue=h;break;case 13:if(c=i.memoizedState,c!==null)return c.dehydrated!==null?(Ye(it,it.current&1),i.flags|=128,null):(a&i.child.childLanes)!==0?Np(n,i,a):(Ye(it,it.current&1),n=ai(n,i,a),n!==null?n.sibling:null);Ye(it,it.current&1);break;case 19:if(c=(a&i.childLanes)!==0,(n.flags&128)!==0){if(c)return Op(n,i,a);i.flags|=128}if(h=i.memoizedState,h!==null&&(h.rendering=null,h.tail=null,h.lastEffect=null),Ye(it,it.current),c)break;return null;case 22:case 23:return i.lanes=0,wp(n,i,a)}return ai(n,i,a)}var Mp,id,kp,Fp;Mp=function(n,i){for(var a=i.child;a!==null;){if(a.tag===5||a.tag===6)n.appendChild(a.stateNode);else if(a.tag!==4&&a.child!==null){a.child.return=a,a=a.child;continue}if(a===i)break;for(;a.sibling===null;){if(a.return===null||a.return===i)return;a=a.return}a.sibling.return=a.return,a=a.sibling}},id=function(){},kp=function(n,i,a,c){var h=n.memoizedProps;if(h!==c){n=i.stateNode,gr(jn.current);var p=null;switch(a){case"input":h=qe(n,h),c=qe(n,c),p=[];break;case"select":h=j({},h,{value:void 0}),c=j({},c,{value:void 0}),p=[];break;case"textarea":h=ar(n,h),c=ar(n,c),p=[];break;default:typeof h.onClick!="function"&&typeof c.onClick=="function"&&(n.onclick=Va)}Bu(a,c);var v;a=null;for(k in h)if(!c.hasOwnProperty(k)&&h.hasOwnProperty(k)&&h[k]!=null)if(k==="style"){var _=h[k];for(v in _)_.hasOwnProperty(v)&&(a||(a={}),a[v]="")}else k!=="dangerouslySetInnerHTML"&&k!=="children"&&k!=="suppressContentEditableWarning"&&k!=="suppressHydrationWarning"&&k!=="autoFocus"&&(l.hasOwnProperty(k)?p||(p=[]):(p=p||[]).push(k,null));for(k in c){var R=c[k];if(_=h!=null?h[k]:void 0,c.hasOwnProperty(k)&&R!==_&&(R!=null||_!=null))if(k==="style")if(_){for(v in _)!_.hasOwnProperty(v)||R&&R.hasOwnProperty(v)||(a||(a={}),a[v]="");for(v in R)R.hasOwnProperty(v)&&_[v]!==R[v]&&(a||(a={}),a[v]=R[v])}else a||(p||(p=[]),p.push(k,a)),a=R;else k==="dangerouslySetInnerHTML"?(R=R?R.__html:void 0,_=_?_.__html:void 0,R!=null&&_!==R&&(p=p||[]).push(k,R)):k==="children"?typeof R!="string"&&typeof R!="number"||(p=p||[]).push(k,""+R):k!=="suppressContentEditableWarning"&&k!=="suppressHydrationWarning"&&(l.hasOwnProperty(k)?(R!=null&&k==="onScroll"&&Ve("scroll",n),p||_===R||(p=[])):(p=p||[]).push(k,R))}a&&(p=p||[]).push("style",a);var k=p;(i.updateQueue=k)&&(i.flags|=4)}},Fp=function(n,i,a,c){a!==c&&(i.flags|=4)};function Ns(n,i){if(!Qe)switch(n.tailMode){case"hidden":i=n.tail;for(var a=null;i!==null;)i.alternate!==null&&(a=i),i=i.sibling;a===null?n.tail=null:a.sibling=null;break;case"collapsed":a=n.tail;for(var c=null;a!==null;)a.alternate!==null&&(c=a),a=a.sibling;c===null?i||n.tail===null?n.tail=null:n.tail.sibling=null:c.sibling=null}}function Ot(n){var i=n.alternate!==null&&n.alternate.child===n.child,a=0,c=0;if(i)for(var h=n.child;h!==null;)a|=h.lanes|h.childLanes,c|=h.subtreeFlags&14680064,c|=h.flags&14680064,h.return=n,h=h.sibling;else for(h=n.child;h!==null;)a|=h.lanes|h.childLanes,c|=h.subtreeFlags,c|=h.flags,h.return=n,h=h.sibling;return n.subtreeFlags|=c,n.childLanes=a,i}function uT(n,i,a){var c=i.pendingProps;switch(_c(i),i.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Ot(i),null;case 1:return Vt(i.type)&&Ka(),Ot(i),null;case 3:return c=i.stateNode,lo(),Xe(jt),Xe(Nt),Hc(),c.pendingContext&&(c.context=c.pendingContext,c.pendingContext=null),(n===null||n.child===null)&&(el(i)?i.flags|=4:n===null||n.memoizedState.isDehydrated&&(i.flags&256)===0||(i.flags|=1024,Cn!==null&&(gd(Cn),Cn=null))),id(n,i),Ot(i),null;case 5:Lc(i);var h=gr(ws.current);if(a=i.type,n!==null&&i.stateNode!=null)kp(n,i,a,c,h),n.ref!==i.ref&&(i.flags|=512,i.flags|=2097152);else{if(!c){if(i.stateNode===null)throw Error(r(166));return Ot(i),null}if(n=gr(jn.current),el(i)){c=i.stateNode,a=i.type;var p=i.memoizedProps;switch(c[Yn]=i,c[ys]=p,n=(i.mode&1)!==0,a){case"dialog":Ve("cancel",c),Ve("close",c);break;case"iframe":case"object":case"embed":Ve("load",c);break;case"video":case"audio":for(h=0;h<ms.length;h++)Ve(ms[h],c);break;case"source":Ve("error",c);break;case"img":case"image":case"link":Ve("error",c),Ve("load",c);break;case"details":Ve("toggle",c);break;case"input":je(c,p),Ve("invalid",c);break;case"select":c._wrapperState={wasMultiple:!!p.multiple},Ve("invalid",c);break;case"textarea":vh(c,p),Ve("invalid",c)}Bu(a,p),h=null;for(var v in p)if(p.hasOwnProperty(v)){var _=p[v];v==="children"?typeof _=="string"?c.textContent!==_&&(p.suppressHydrationWarning!==!0&&ja(c.textContent,_,n),h=["children",_]):typeof _=="number"&&c.textContent!==""+_&&(p.suppressHydrationWarning!==!0&&ja(c.textContent,_,n),h=["children",""+_]):l.hasOwnProperty(v)&&_!=null&&v==="onScroll"&&Ve("scroll",c)}switch(a){case"input":Le(c),un(c,p,!0);break;case"textarea":Le(c),yh(c);break;case"select":case"option":break;default:typeof p.onClick=="function"&&(c.onclick=Va)}c=h,i.updateQueue=c,c!==null&&(i.flags|=4)}else{v=h.nodeType===9?h:h.ownerDocument,n==="http://www.w3.org/1999/xhtml"&&(n=Th(a)),n==="http://www.w3.org/1999/xhtml"?a==="script"?(n=v.createElement("div"),n.innerHTML="<script><\/script>",n=n.removeChild(n.firstChild)):typeof c.is=="string"?n=v.createElement(a,{is:c.is}):(n=v.createElement(a),a==="select"&&(v=n,c.multiple?v.multiple=!0:c.size&&(v.size=c.size))):n=v.createElementNS(n,a),n[Yn]=i,n[ys]=c,Mp(n,i,!1,!1),i.stateNode=n;e:{switch(v=Hu(a,c),a){case"dialog":Ve("cancel",n),Ve("close",n),h=c;break;case"iframe":case"object":case"embed":Ve("load",n),h=c;break;case"video":case"audio":for(h=0;h<ms.length;h++)Ve(ms[h],n);h=c;break;case"source":Ve("error",n),h=c;break;case"img":case"image":case"link":Ve("error",n),Ve("load",n),h=c;break;case"details":Ve("toggle",n),h=c;break;case"input":je(n,c),h=qe(n,c),Ve("invalid",n);break;case"option":h=c;break;case"select":n._wrapperState={wasMultiple:!!c.multiple},h=j({},c,{value:void 0}),Ve("invalid",n);break;case"textarea":vh(n,c),h=ar(n,c),Ve("invalid",n);break;default:h=c}Bu(a,h),_=h;for(p in _)if(_.hasOwnProperty(p)){var R=_[p];p==="style"?Eh(n,R):p==="dangerouslySetInnerHTML"?(R=R?R.__html:void 0,R!=null&&Ah(n,R)):p==="children"?typeof R=="string"?(a!=="textarea"||R!=="")&&qo(n,R):typeof R=="number"&&qo(n,""+R):p!=="suppressContentEditableWarning"&&p!=="suppressHydrationWarning"&&p!=="autoFocus"&&(l.hasOwnProperty(p)?R!=null&&p==="onScroll"&&Ve("scroll",n):R!=null&&D(n,p,R,v))}switch(a){case"input":Le(n),un(n,c,!1);break;case"textarea":Le(n),yh(n);break;case"option":c.value!=null&&n.setAttribute("value",""+Ae(c.value));break;case"select":n.multiple=!!c.multiple,p=c.value,p!=null?Ti(n,!!c.multiple,p,!1):c.defaultValue!=null&&Ti(n,!!c.multiple,c.defaultValue,!0);break;default:typeof h.onClick=="function"&&(n.onclick=Va)}switch(a){case"button":case"input":case"select":case"textarea":c=!!c.autoFocus;break e;case"img":c=!0;break e;default:c=!1}}c&&(i.flags|=4)}i.ref!==null&&(i.flags|=512,i.flags|=2097152)}return Ot(i),null;case 6:if(n&&i.stateNode!=null)Fp(n,i,n.memoizedProps,c);else{if(typeof c!="string"&&i.stateNode===null)throw Error(r(166));if(a=gr(ws.current),gr(jn.current),el(i)){if(c=i.stateNode,a=i.memoizedProps,c[Yn]=i,(p=c.nodeValue!==a)&&(n=en,n!==null))switch(n.tag){case 3:ja(c.nodeValue,a,(n.mode&1)!==0);break;case 5:n.memoizedProps.suppressHydrationWarning!==!0&&ja(c.nodeValue,a,(n.mode&1)!==0)}p&&(i.flags|=4)}else c=(a.nodeType===9?a:a.ownerDocument).createTextNode(c),c[Yn]=i,i.stateNode=c}return Ot(i),null;case 13:if(Xe(it),c=i.memoizedState,n===null||n.memoizedState!==null&&n.memoizedState.dehydrated!==null){if(Qe&&tn!==null&&(i.mode&1)!==0&&(i.flags&128)===0)Bg(),ro(),i.flags|=98560,p=!1;else if(p=el(i),c!==null&&c.dehydrated!==null){if(n===null){if(!p)throw Error(r(318));if(p=i.memoizedState,p=p!==null?p.dehydrated:null,!p)throw Error(r(317));p[Yn]=i}else ro(),(i.flags&128)===0&&(i.memoizedState=null),i.flags|=4;Ot(i),p=!1}else Cn!==null&&(gd(Cn),Cn=null),p=!0;if(!p)return i.flags&65536?i:null}return(i.flags&128)!==0?(i.lanes=a,i):(c=c!==null,c!==(n!==null&&n.memoizedState!==null)&&c&&(i.child.flags|=8192,(i.mode&1)!==0&&(n===null||(it.current&1)!==0?gt===0&&(gt=3):vd())),i.updateQueue!==null&&(i.flags|=4),Ot(i),null);case 4:return lo(),id(n,i),n===null&&vs(i.stateNode.containerInfo),Ot(i),null;case 10:return Oc(i.type._context),Ot(i),null;case 17:return Vt(i.type)&&Ka(),Ot(i),null;case 19:if(Xe(it),p=i.memoizedState,p===null)return Ot(i),null;if(c=(i.flags&128)!==0,v=p.rendering,v===null)if(c)Ns(p,!1);else{if(gt!==0||n!==null&&(n.flags&128)!==0)for(n=i.child;n!==null;){if(v=sl(n),v!==null){for(i.flags|=128,Ns(p,!1),c=v.updateQueue,c!==null&&(i.updateQueue=c,i.flags|=4),i.subtreeFlags=0,c=a,a=i.child;a!==null;)p=a,n=c,p.flags&=14680066,v=p.alternate,v===null?(p.childLanes=0,p.lanes=n,p.child=null,p.subtreeFlags=0,p.memoizedProps=null,p.memoizedState=null,p.updateQueue=null,p.dependencies=null,p.stateNode=null):(p.childLanes=v.childLanes,p.lanes=v.lanes,p.child=v.child,p.subtreeFlags=0,p.deletions=null,p.memoizedProps=v.memoizedProps,p.memoizedState=v.memoizedState,p.updateQueue=v.updateQueue,p.type=v.type,n=v.dependencies,p.dependencies=n===null?null:{lanes:n.lanes,firstContext:n.firstContext}),a=a.sibling;return Ye(it,it.current&1|2),i.child}n=n.sibling}p.tail!==null&&at()>ho&&(i.flags|=128,c=!0,Ns(p,!1),i.lanes=4194304)}else{if(!c)if(n=sl(v),n!==null){if(i.flags|=128,c=!0,a=n.updateQueue,a!==null&&(i.updateQueue=a,i.flags|=4),Ns(p,!0),p.tail===null&&p.tailMode==="hidden"&&!v.alternate&&!Qe)return Ot(i),null}else 2*at()-p.renderingStartTime>ho&&a!==1073741824&&(i.flags|=128,c=!0,Ns(p,!1),i.lanes=4194304);p.isBackwards?(v.sibling=i.child,i.child=v):(a=p.last,a!==null?a.sibling=v:i.child=v,p.last=v)}return p.tail!==null?(i=p.tail,p.rendering=i,p.tail=i.sibling,p.renderingStartTime=at(),i.sibling=null,a=it.current,Ye(it,c?a&1|2:a&1),i):(Ot(i),null);case 22:case 23:return md(),c=i.memoizedState!==null,n!==null&&n.memoizedState!==null!==c&&(i.flags|=8192),c&&(i.mode&1)!==0?(nn&1073741824)!==0&&(Ot(i),i.subtreeFlags&6&&(i.flags|=8192)):Ot(i),null;case 24:return null;case 25:return null}throw Error(r(156,i.tag))}function cT(n,i){switch(_c(i),i.tag){case 1:return Vt(i.type)&&Ka(),n=i.flags,n&65536?(i.flags=n&-65537|128,i):null;case 3:return lo(),Xe(jt),Xe(Nt),Hc(),n=i.flags,(n&65536)!==0&&(n&128)===0?(i.flags=n&-65537|128,i):null;case 5:return Lc(i),null;case 13:if(Xe(it),n=i.memoizedState,n!==null&&n.dehydrated!==null){if(i.alternate===null)throw Error(r(340));ro()}return n=i.flags,n&65536?(i.flags=n&-65537|128,i):null;case 19:return Xe(it),null;case 4:return lo(),null;case 10:return Oc(i.type._context),null;case 22:case 23:return md(),null;case 24:return null;default:return null}}var pl=!1,Mt=!1,dT=typeof WeakSet=="function"?WeakSet:Set,J=null;function co(n,i){var a=n.ref;if(a!==null)if(typeof a=="function")try{a(null)}catch(c){ot(n,i,c)}else a.current=null}function rd(n,i,a){try{a()}catch(c){ot(n,i,c)}}var Up=!1;function fT(n,i){if(mc=Ua,n=hg(),lc(n)){if("selectionStart"in n)var a={start:n.selectionStart,end:n.selectionEnd};else e:{a=(a=n.ownerDocument)&&a.defaultView||window;var c=a.getSelection&&a.getSelection();if(c&&c.rangeCount!==0){a=c.anchorNode;var h=c.anchorOffset,p=c.focusNode;c=c.focusOffset;try{a.nodeType,p.nodeType}catch{a=null;break e}var v=0,_=-1,R=-1,k=0,x=0,z=n,G=null;t:for(;;){for(var q;z!==a||h!==0&&z.nodeType!==3||(_=v+h),z!==p||c!==0&&z.nodeType!==3||(R=v+c),z.nodeType===3&&(v+=z.nodeValue.length),(q=z.firstChild)!==null;)G=z,z=q;for(;;){if(z===n)break t;if(G===a&&++k===h&&(_=v),G===p&&++x===c&&(R=v),(q=z.nextSibling)!==null)break;z=G,G=z.parentNode}z=q}a=_===-1||R===-1?null:{start:_,end:R}}else a=null}a=a||{start:0,end:0}}else a=null;for(vc={focusedElem:n,selectionRange:a},Ua=!1,J=i;J!==null;)if(i=J,n=i.child,(i.subtreeFlags&1028)!==0&&n!==null)n.return=i,J=n;else for(;J!==null;){i=J;try{var te=i.alternate;if((i.flags&1024)!==0)switch(i.tag){case 0:case 11:case 15:break;case 1:if(te!==null){var se=te.memoizedProps,lt=te.memoizedState,O=i.stateNode,N=O.getSnapshotBeforeUpdate(i.elementType===i.type?se:Rn(i.type,se),lt);O.__reactInternalSnapshotBeforeUpdate=N}break;case 3:var M=i.stateNode.containerInfo;M.nodeType===1?M.textContent="":M.nodeType===9&&M.documentElement&&M.removeChild(M.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(r(163))}}catch(V){ot(i,i.return,V)}if(n=i.sibling,n!==null){n.return=i.return,J=n;break}J=i.return}return te=Up,Up=!1,te}function Ds(n,i,a){var c=i.updateQueue;if(c=c!==null?c.lastEffect:null,c!==null){var h=c=c.next;do{if((h.tag&n)===n){var p=h.destroy;h.destroy=void 0,p!==void 0&&rd(i,a,p)}h=h.next}while(h!==c)}}function ml(n,i){if(i=i.updateQueue,i=i!==null?i.lastEffect:null,i!==null){var a=i=i.next;do{if((a.tag&n)===n){var c=a.create;a.destroy=c()}a=a.next}while(a!==i)}}function od(n){var i=n.ref;if(i!==null){var a=n.stateNode;switch(n.tag){case 5:n=a;break;default:n=a}typeof i=="function"?i(n):i.current=n}}function Lp(n){var i=n.alternate;i!==null&&(n.alternate=null,Lp(i)),n.child=null,n.deletions=null,n.sibling=null,n.tag===5&&(i=n.stateNode,i!==null&&(delete i[Yn],delete i[ys],delete i[Ac],delete i[Xy],delete i[Ky])),n.stateNode=null,n.return=null,n.dependencies=null,n.memoizedProps=null,n.memoizedState=null,n.pendingProps=null,n.stateNode=null,n.updateQueue=null}function Bp(n){return n.tag===5||n.tag===3||n.tag===4}function Hp(n){e:for(;;){for(;n.sibling===null;){if(n.return===null||Bp(n.return))return null;n=n.return}for(n.sibling.return=n.return,n=n.sibling;n.tag!==5&&n.tag!==6&&n.tag!==18;){if(n.flags&2||n.child===null||n.tag===4)continue e;n.child.return=n,n=n.child}if(!(n.flags&2))return n.stateNode}}function sd(n,i,a){var c=n.tag;if(c===5||c===6)n=n.stateNode,i?a.nodeType===8?a.parentNode.insertBefore(n,i):a.insertBefore(n,i):(a.nodeType===8?(i=a.parentNode,i.insertBefore(n,a)):(i=a,i.appendChild(n)),a=a._reactRootContainer,a!=null||i.onclick!==null||(i.onclick=Va));else if(c!==4&&(n=n.child,n!==null))for(sd(n,i,a),n=n.sibling;n!==null;)sd(n,i,a),n=n.sibling}function ad(n,i,a){var c=n.tag;if(c===5||c===6)n=n.stateNode,i?a.insertBefore(n,i):a.appendChild(n);else if(c!==4&&(n=n.child,n!==null))for(ad(n,i,a),n=n.sibling;n!==null;)ad(n,i,a),n=n.sibling}var _t=null,Pn=!1;function ki(n,i,a){for(a=a.child;a!==null;)bp(n,i,a),a=a.sibling}function bp(n,i,a){if(Wn&&typeof Wn.onCommitFiberUnmount=="function")try{Wn.onCommitFiberUnmount(Na,a)}catch{}switch(a.tag){case 5:Mt||co(a,i);case 6:var c=_t,h=Pn;_t=null,ki(n,i,a),_t=c,Pn=h,_t!==null&&(Pn?(n=_t,a=a.stateNode,n.nodeType===8?n.parentNode.removeChild(a):n.removeChild(a)):_t.removeChild(a.stateNode));break;case 18:_t!==null&&(Pn?(n=_t,a=a.stateNode,n.nodeType===8?Tc(n.parentNode,a):n.nodeType===1&&Tc(n,a),ls(n)):Tc(_t,a.stateNode));break;case 4:c=_t,h=Pn,_t=a.stateNode.containerInfo,Pn=!0,ki(n,i,a),_t=c,Pn=h;break;case 0:case 11:case 14:case 15:if(!Mt&&(c=a.updateQueue,c!==null&&(c=c.lastEffect,c!==null))){h=c=c.next;do{var p=h,v=p.destroy;p=p.tag,v!==void 0&&((p&2)!==0||(p&4)!==0)&&rd(a,i,v),h=h.next}while(h!==c)}ki(n,i,a);break;case 1:if(!Mt&&(co(a,i),c=a.stateNode,typeof c.componentWillUnmount=="function"))try{c.props=a.memoizedProps,c.state=a.memoizedState,c.componentWillUnmount()}catch(_){ot(a,i,_)}ki(n,i,a);break;case 21:ki(n,i,a);break;case 22:a.mode&1?(Mt=(c=Mt)||a.memoizedState!==null,ki(n,i,a),Mt=c):ki(n,i,a);break;default:ki(n,i,a)}}function Gp(n){var i=n.updateQueue;if(i!==null){n.updateQueue=null;var a=n.stateNode;a===null&&(a=n.stateNode=new dT),i.forEach(function(c){var h=AT.bind(null,n,c);a.has(c)||(a.add(c),c.then(h,h))})}}function Nn(n,i){var a=i.deletions;if(a!==null)for(var c=0;c<a.length;c++){var h=a[c];try{var p=n,v=i,_=v;e:for(;_!==null;){switch(_.tag){case 5:_t=_.stateNode,Pn=!1;break e;case 3:_t=_.stateNode.containerInfo,Pn=!0;break e;case 4:_t=_.stateNode.containerInfo,Pn=!0;break e}_=_.return}if(_t===null)throw Error(r(160));bp(p,v,h),_t=null,Pn=!1;var R=h.alternate;R!==null&&(R.return=null),h.return=null}catch(k){ot(h,i,k)}}if(i.subtreeFlags&12854)for(i=i.child;i!==null;)xp(i,n),i=i.sibling}function xp(n,i){var a=n.alternate,c=n.flags;switch(n.tag){case 0:case 11:case 14:case 15:if(Nn(i,n),Xn(n),c&4){try{Ds(3,n,n.return),ml(3,n)}catch(se){ot(n,n.return,se)}try{Ds(5,n,n.return)}catch(se){ot(n,n.return,se)}}break;case 1:Nn(i,n),Xn(n),c&512&&a!==null&&co(a,a.return);break;case 5:if(Nn(i,n),Xn(n),c&512&&a!==null&&co(a,a.return),n.flags&32){var h=n.stateNode;try{qo(h,"")}catch(se){ot(n,n.return,se)}}if(c&4&&(h=n.stateNode,h!=null)){var p=n.memoizedProps,v=a!==null?a.memoizedProps:p,_=n.type,R=n.updateQueue;if(n.updateQueue=null,R!==null)try{_==="input"&&p.type==="radio"&&p.name!=null&&xn(h,p),Hu(_,v);var k=Hu(_,p);for(v=0;v<R.length;v+=2){var x=R[v],z=R[v+1];x==="style"?Eh(h,z):x==="dangerouslySetInnerHTML"?Ah(h,z):x==="children"?qo(h,z):D(h,x,z,k)}switch(_){case"input":Yt(h,p);break;case"textarea":Sh(h,p);break;case"select":var G=h._wrapperState.wasMultiple;h._wrapperState.wasMultiple=!!p.multiple;var q=p.value;q!=null?Ti(h,!!p.multiple,q,!1):G!==!!p.multiple&&(p.defaultValue!=null?Ti(h,!!p.multiple,p.defaultValue,!0):Ti(h,!!p.multiple,p.multiple?[]:"",!1))}h[ys]=p}catch(se){ot(n,n.return,se)}}break;case 6:if(Nn(i,n),Xn(n),c&4){if(n.stateNode===null)throw Error(r(162));h=n.stateNode,p=n.memoizedProps;try{h.nodeValue=p}catch(se){ot(n,n.return,se)}}break;case 3:if(Nn(i,n),Xn(n),c&4&&a!==null&&a.memoizedState.isDehydrated)try{ls(i.containerInfo)}catch(se){ot(n,n.return,se)}break;case 4:Nn(i,n),Xn(n);break;case 13:Nn(i,n),Xn(n),h=n.child,h.flags&8192&&(p=h.memoizedState!==null,h.stateNode.isHidden=p,!p||h.alternate!==null&&h.alternate.memoizedState!==null||(cd=at())),c&4&&Gp(n);break;case 22:if(x=a!==null&&a.memoizedState!==null,n.mode&1?(Mt=(k=Mt)||x,Nn(i,n),Mt=k):Nn(i,n),Xn(n),c&8192){if(k=n.memoizedState!==null,(n.stateNode.isHidden=k)&&!x&&(n.mode&1)!==0)for(J=n,x=n.child;x!==null;){for(z=J=x;J!==null;){switch(G=J,q=G.child,G.tag){case 0:case 11:case 14:case 15:Ds(4,G,G.return);break;case 1:co(G,G.return);var te=G.stateNode;if(typeof te.componentWillUnmount=="function"){c=G,a=G.return;try{i=c,te.props=i.memoizedProps,te.state=i.memoizedState,te.componentWillUnmount()}catch(se){ot(c,a,se)}}break;case 5:co(G,G.return);break;case 22:if(G.memoizedState!==null){Wp(z);continue}}q!==null?(q.return=G,J=q):Wp(z)}x=x.sibling}e:for(x=null,z=n;;){if(z.tag===5){if(x===null){x=z;try{h=z.stateNode,k?(p=h.style,typeof p.setProperty=="function"?p.setProperty("display","none","important"):p.display="none"):(_=z.stateNode,R=z.memoizedProps.style,v=R!=null&&R.hasOwnProperty("display")?R.display:null,_.style.display=Ih("display",v))}catch(se){ot(n,n.return,se)}}}else if(z.tag===6){if(x===null)try{z.stateNode.nodeValue=k?"":z.memoizedProps}catch(se){ot(n,n.return,se)}}else if((z.tag!==22&&z.tag!==23||z.memoizedState===null||z===n)&&z.child!==null){z.child.return=z,z=z.child;continue}if(z===n)break e;for(;z.sibling===null;){if(z.return===null||z.return===n)break e;x===z&&(x=null),z=z.return}x===z&&(x=null),z.sibling.return=z.return,z=z.sibling}}break;case 19:Nn(i,n),Xn(n),c&4&&Gp(n);break;case 21:break;default:Nn(i,n),Xn(n)}}function Xn(n){var i=n.flags;if(i&2){try{e:{for(var a=n.return;a!==null;){if(Bp(a)){var c=a;break e}a=a.return}throw Error(r(160))}switch(c.tag){case 5:var h=c.stateNode;c.flags&32&&(qo(h,""),c.flags&=-33);var p=Hp(n);ad(n,p,h);break;case 3:case 4:var v=c.stateNode.containerInfo,_=Hp(n);sd(n,_,v);break;default:throw Error(r(161))}}catch(R){ot(n,n.return,R)}n.flags&=-3}i&4096&&(n.flags&=-4097)}function hT(n,i,a){J=n,$p(n)}function $p(n,i,a){for(var c=(n.mode&1)!==0;J!==null;){var h=J,p=h.child;if(h.tag===22&&c){var v=h.memoizedState!==null||pl;if(!v){var _=h.alternate,R=_!==null&&_.memoizedState!==null||Mt;_=pl;var k=Mt;if(pl=v,(Mt=R)&&!k)for(J=h;J!==null;)v=J,R=v.child,v.tag===22&&v.memoizedState!==null?Yp(h):R!==null?(R.return=v,J=R):Yp(h);for(;p!==null;)J=p,$p(p),p=p.sibling;J=h,pl=_,Mt=k}zp(n)}else(h.subtreeFlags&8772)!==0&&p!==null?(p.return=h,J=p):zp(n)}}function zp(n){for(;J!==null;){var i=J;if((i.flags&8772)!==0){var a=i.alternate;try{if((i.flags&8772)!==0)switch(i.tag){case 0:case 11:case 15:Mt||ml(5,i);break;case 1:var c=i.stateNode;if(i.flags&4&&!Mt)if(a===null)c.componentDidMount();else{var h=i.elementType===i.type?a.memoizedProps:Rn(i.type,a.memoizedProps);c.componentDidUpdate(h,a.memoizedState,c.__reactInternalSnapshotBeforeUpdate)}var p=i.updateQueue;p!==null&&Wg(i,p,c);break;case 3:var v=i.updateQueue;if(v!==null){if(a=null,i.child!==null)switch(i.child.tag){case 5:a=i.child.stateNode;break;case 1:a=i.child.stateNode}Wg(i,v,a)}break;case 5:var _=i.stateNode;if(a===null&&i.flags&4){a=_;var R=i.memoizedProps;switch(i.type){case"button":case"input":case"select":case"textarea":R.autoFocus&&a.focus();break;case"img":R.src&&(a.src=R.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(i.memoizedState===null){var k=i.alternate;if(k!==null){var x=k.memoizedState;if(x!==null){var z=x.dehydrated;z!==null&&ls(z)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(r(163))}Mt||i.flags&512&&od(i)}catch(G){ot(i,i.return,G)}}if(i===n){J=null;break}if(a=i.sibling,a!==null){a.return=i.return,J=a;break}J=i.return}}function Wp(n){for(;J!==null;){var i=J;if(i===n){J=null;break}var a=i.sibling;if(a!==null){a.return=i.return,J=a;break}J=i.return}}function Yp(n){for(;J!==null;){var i=J;try{switch(i.tag){case 0:case 11:case 15:var a=i.return;try{ml(4,i)}catch(R){ot(i,a,R)}break;case 1:var c=i.stateNode;if(typeof c.componentDidMount=="function"){var h=i.return;try{c.componentDidMount()}catch(R){ot(i,h,R)}}var p=i.return;try{od(i)}catch(R){ot(i,p,R)}break;case 5:var v=i.return;try{od(i)}catch(R){ot(i,v,R)}}}catch(R){ot(i,i.return,R)}if(i===n){J=null;break}var _=i.sibling;if(_!==null){_.return=i.return,J=_;break}J=i.return}}var gT=Math.ceil,vl=H.ReactCurrentDispatcher,ld=H.ReactCurrentOwner,gn=H.ReactCurrentBatchConfig,He=0,yt=null,dt=null,Ct=0,nn=0,fo=Pi(0),gt=0,Os=null,mr=0,Sl=0,ud=0,Ms=null,Kt=null,cd=0,ho=1/0,li=null,yl=!1,dd=null,Fi=null,Tl=!1,Ui=null,Al=0,ks=0,fd=null,Il=-1,El=0;function Ht(){return(He&6)!==0?at():Il!==-1?Il:Il=at()}function Li(n){return(n.mode&1)===0?1:(He&2)!==0&&Ct!==0?Ct&-Ct:qy.transition!==null?(El===0&&(El=Hh()),El):(n=We,n!==0||(n=window.event,n=n===void 0?16:Vh(n.type)),n)}function Dn(n,i,a,c){if(50<ks)throw ks=0,fd=null,Error(r(185));is(n,a,c),((He&2)===0||n!==yt)&&(n===yt&&((He&2)===0&&(Sl|=a),gt===4&&Bi(n,Ct)),Zt(n,c),a===1&&He===0&&(i.mode&1)===0&&(ho=at()+500,qa&&Di()))}function Zt(n,i){var a=n.callbackNode;qS(n,i);var c=Ma(n,n===yt?Ct:0);if(c===0)a!==null&&Uh(a),n.callbackNode=null,n.callbackPriority=0;else if(i=c&-c,n.callbackPriority!==i){if(a!=null&&Uh(a),i===1)n.tag===0?Zy(Vp.bind(null,n)):Mg(Vp.bind(null,n)),jy(function(){(He&6)===0&&Di()}),a=null;else{switch(bh(c)){case 1:a=Yu;break;case 4:a=Lh;break;case 16:a=Pa;break;case 536870912:a=Bh;break;default:a=Pa}a=tm(a,jp.bind(null,n))}n.callbackPriority=i,n.callbackNode=a}}function jp(n,i){if(Il=-1,El=0,(He&6)!==0)throw Error(r(327));var a=n.callbackNode;if(go()&&n.callbackNode!==a)return null;var c=Ma(n,n===yt?Ct:0);if(c===0)return null;if((c&30)!==0||(c&n.expiredLanes)!==0||i)i=wl(n,c);else{i=c;var h=He;He|=2;var p=Kp();(yt!==n||Ct!==i)&&(li=null,ho=at()+500,Sr(n,i));do try{vT();break}catch(_){Xp(n,_)}while(!0);Dc(),vl.current=p,He=h,dt!==null?i=0:(yt=null,Ct=0,i=gt)}if(i!==0){if(i===2&&(h=ju(n),h!==0&&(c=h,i=hd(n,h))),i===1)throw a=Os,Sr(n,0),Bi(n,c),Zt(n,at()),a;if(i===6)Bi(n,c);else{if(h=n.current.alternate,(c&30)===0&&!pT(h)&&(i=wl(n,c),i===2&&(p=ju(n),p!==0&&(c=p,i=hd(n,p))),i===1))throw a=Os,Sr(n,0),Bi(n,c),Zt(n,at()),a;switch(n.finishedWork=h,n.finishedLanes=c,i){case 0:case 1:throw Error(r(345));case 2:yr(n,Kt,li);break;case 3:if(Bi(n,c),(c&130023424)===c&&(i=cd+500-at(),10<i)){if(Ma(n,0)!==0)break;if(h=n.suspendedLanes,(h&c)!==c){Ht(),n.pingedLanes|=n.suspendedLanes&h;break}n.timeoutHandle=yc(yr.bind(null,n,Kt,li),i);break}yr(n,Kt,li);break;case 4:if(Bi(n,c),(c&4194240)===c)break;for(i=n.eventTimes,h=-1;0<c;){var v=31-wn(c);p=1<<v,v=i[v],v>h&&(h=v),c&=~p}if(c=h,c=at()-c,c=(120>c?120:480>c?480:1080>c?1080:1920>c?1920:3e3>c?3e3:4320>c?4320:1960*gT(c/1960))-c,10<c){n.timeoutHandle=yc(yr.bind(null,n,Kt,li),c);break}yr(n,Kt,li);break;case 5:yr(n,Kt,li);break;default:throw Error(r(329))}}}return Zt(n,at()),n.callbackNode===a?jp.bind(null,n):null}function hd(n,i){var a=Ms;return n.current.memoizedState.isDehydrated&&(Sr(n,i).flags|=256),n=wl(n,i),n!==2&&(i=Kt,Kt=a,i!==null&&gd(i)),n}function gd(n){Kt===null?Kt=n:Kt.push.apply(Kt,n)}function pT(n){for(var i=n;;){if(i.flags&16384){var a=i.updateQueue;if(a!==null&&(a=a.stores,a!==null))for(var c=0;c<a.length;c++){var h=a[c],p=h.getSnapshot;h=h.value;try{if(!_n(p(),h))return!1}catch{return!1}}}if(a=i.child,i.subtreeFlags&16384&&a!==null)a.return=i,i=a;else{if(i===n)break;for(;i.sibling===null;){if(i.return===null||i.return===n)return!0;i=i.return}i.sibling.return=i.return,i=i.sibling}}return!0}function Bi(n,i){for(i&=~ud,i&=~Sl,n.suspendedLanes|=i,n.pingedLanes&=~i,n=n.expirationTimes;0<i;){var a=31-wn(i),c=1<<a;n[a]=-1,i&=~c}}function Vp(n){if((He&6)!==0)throw Error(r(327));go();var i=Ma(n,0);if((i&1)===0)return Zt(n,at()),null;var a=wl(n,i);if(n.tag!==0&&a===2){var c=ju(n);c!==0&&(i=c,a=hd(n,c))}if(a===1)throw a=Os,Sr(n,0),Bi(n,i),Zt(n,at()),a;if(a===6)throw Error(r(345));return n.finishedWork=n.current.alternate,n.finishedLanes=i,yr(n,Kt,li),Zt(n,at()),null}function pd(n,i){var a=He;He|=1;try{return n(i)}finally{He=a,He===0&&(ho=at()+500,qa&&Di())}}function vr(n){Ui!==null&&Ui.tag===0&&(He&6)===0&&go();var i=He;He|=1;var a=gn.transition,c=We;try{if(gn.transition=null,We=1,n)return n()}finally{We=c,gn.transition=a,He=i,(He&6)===0&&Di()}}function md(){nn=fo.current,Xe(fo)}function Sr(n,i){n.finishedWork=null,n.finishedLanes=0;var a=n.timeoutHandle;if(a!==-1&&(n.timeoutHandle=-1,Yy(a)),dt!==null)for(a=dt.return;a!==null;){var c=a;switch(_c(c),c.tag){case 1:c=c.type.childContextTypes,c!=null&&Ka();break;case 3:lo(),Xe(jt),Xe(Nt),Hc();break;case 5:Lc(c);break;case 4:lo();break;case 13:Xe(it);break;case 19:Xe(it);break;case 10:Oc(c.type._context);break;case 22:case 23:md()}a=a.return}if(yt=n,dt=n=Hi(n.current,null),Ct=nn=i,gt=0,Os=null,ud=Sl=mr=0,Kt=Ms=null,hr!==null){for(i=0;i<hr.length;i++)if(a=hr[i],c=a.interleaved,c!==null){a.interleaved=null;var h=c.next,p=a.pending;if(p!==null){var v=p.next;p.next=h,c.next=v}a.pending=c}hr=null}return n}function Xp(n,i){do{var a=dt;try{if(Dc(),al.current=dl,ll){for(var c=rt.memoizedState;c!==null;){var h=c.queue;h!==null&&(h.pending=null),c=c.next}ll=!1}if(pr=0,St=ht=rt=null,_s=!1,Cs=0,ld.current=null,a===null||a.return===null){gt=1,Os=i,dt=null;break}e:{var p=n,v=a.return,_=a,R=i;if(i=Ct,_.flags|=32768,R!==null&&typeof R=="object"&&typeof R.then=="function"){var k=R,x=_,z=x.tag;if((x.mode&1)===0&&(z===0||z===11||z===15)){var G=x.alternate;G?(x.updateQueue=G.updateQueue,x.memoizedState=G.memoizedState,x.lanes=G.lanes):(x.updateQueue=null,x.memoizedState=null)}var q=yp(v);if(q!==null){q.flags&=-257,Tp(q,v,_,p,i),q.mode&1&&Sp(p,k,i),i=q,R=k;var te=i.updateQueue;if(te===null){var se=new Set;se.add(R),i.updateQueue=se}else te.add(R);break e}else{if((i&1)===0){Sp(p,k,i),vd();break e}R=Error(r(426))}}else if(Qe&&_.mode&1){var lt=yp(v);if(lt!==null){(lt.flags&65536)===0&&(lt.flags|=256),Tp(lt,v,_,p,i),Pc(uo(R,_));break e}}p=R=uo(R,_),gt!==4&&(gt=2),Ms===null?Ms=[p]:Ms.push(p),p=v;do{switch(p.tag){case 3:p.flags|=65536,i&=-i,p.lanes|=i;var O=mp(p,R,i);zg(p,O);break e;case 1:_=R;var N=p.type,M=p.stateNode;if((p.flags&128)===0&&(typeof N.getDerivedStateFromError=="function"||M!==null&&typeof M.componentDidCatch=="function"&&(Fi===null||!Fi.has(M)))){p.flags|=65536,i&=-i,p.lanes|=i;var V=vp(p,_,i);zg(p,V);break e}}p=p.return}while(p!==null)}qp(a)}catch(ue){i=ue,dt===a&&a!==null&&(dt=a=a.return);continue}break}while(!0)}function Kp(){var n=vl.current;return vl.current=dl,n===null?dl:n}function vd(){(gt===0||gt===3||gt===2)&&(gt=4),yt===null||(mr&268435455)===0&&(Sl&268435455)===0||Bi(yt,Ct)}function wl(n,i){var a=He;He|=2;var c=Kp();(yt!==n||Ct!==i)&&(li=null,Sr(n,i));do try{mT();break}catch(h){Xp(n,h)}while(!0);if(Dc(),He=a,vl.current=c,dt!==null)throw Error(r(261));return yt=null,Ct=0,gt}function mT(){for(;dt!==null;)Zp(dt)}function vT(){for(;dt!==null&&!$S();)Zp(dt)}function Zp(n){var i=em(n.alternate,n,nn);n.memoizedProps=n.pendingProps,i===null?qp(n):dt=i,ld.current=null}function qp(n){var i=n;do{var a=i.alternate;if(n=i.return,(i.flags&32768)===0){if(a=uT(a,i,nn),a!==null){dt=a;return}}else{if(a=cT(a,i),a!==null){a.flags&=32767,dt=a;return}if(n!==null)n.flags|=32768,n.subtreeFlags=0,n.deletions=null;else{gt=6,dt=null;return}}if(i=i.sibling,i!==null){dt=i;return}dt=i=n}while(i!==null);gt===0&&(gt=5)}function yr(n,i,a){var c=We,h=gn.transition;try{gn.transition=null,We=1,ST(n,i,a,c)}finally{gn.transition=h,We=c}return null}function ST(n,i,a,c){do go();while(Ui!==null);if((He&6)!==0)throw Error(r(327));a=n.finishedWork;var h=n.finishedLanes;if(a===null)return null;if(n.finishedWork=null,n.finishedLanes=0,a===n.current)throw Error(r(177));n.callbackNode=null,n.callbackPriority=0;var p=a.lanes|a.childLanes;if(QS(n,p),n===yt&&(dt=yt=null,Ct=0),(a.subtreeFlags&2064)===0&&(a.flags&2064)===0||Tl||(Tl=!0,tm(Pa,function(){return go(),null})),p=(a.flags&15990)!==0,(a.subtreeFlags&15990)!==0||p){p=gn.transition,gn.transition=null;var v=We;We=1;var _=He;He|=4,ld.current=null,fT(n,a),xp(a,n),Hy(vc),Ua=!!mc,vc=mc=null,n.current=a,hT(a),zS(),He=_,We=v,gn.transition=p}else n.current=a;if(Tl&&(Tl=!1,Ui=n,Al=h),p=n.pendingLanes,p===0&&(Fi=null),jS(a.stateNode),Zt(n,at()),i!==null)for(c=n.onRecoverableError,a=0;a<i.length;a++)h=i[a],c(h.value,{componentStack:h.stack,digest:h.digest});if(yl)throw yl=!1,n=dd,dd=null,n;return(Al&1)!==0&&n.tag!==0&&go(),p=n.pendingLanes,(p&1)!==0?n===fd?ks++:(ks=0,fd=n):ks=0,Di(),null}function go(){if(Ui!==null){var n=bh(Al),i=gn.transition,a=We;try{if(gn.transition=null,We=16>n?16:n,Ui===null)var c=!1;else{if(n=Ui,Ui=null,Al=0,(He&6)!==0)throw Error(r(331));var h=He;for(He|=4,J=n.current;J!==null;){var p=J,v=p.child;if((J.flags&16)!==0){var _=p.deletions;if(_!==null){for(var R=0;R<_.length;R++){var k=_[R];for(J=k;J!==null;){var x=J;switch(x.tag){case 0:case 11:case 15:Ds(8,x,p)}var z=x.child;if(z!==null)z.return=x,J=z;else for(;J!==null;){x=J;var G=x.sibling,q=x.return;if(Lp(x),x===k){J=null;break}if(G!==null){G.return=q,J=G;break}J=q}}}var te=p.alternate;if(te!==null){var se=te.child;if(se!==null){te.child=null;do{var lt=se.sibling;se.sibling=null,se=lt}while(se!==null)}}J=p}}if((p.subtreeFlags&2064)!==0&&v!==null)v.return=p,J=v;else e:for(;J!==null;){if(p=J,(p.flags&2048)!==0)switch(p.tag){case 0:case 11:case 15:Ds(9,p,p.return)}var O=p.sibling;if(O!==null){O.return=p.return,J=O;break e}J=p.return}}var N=n.current;for(J=N;J!==null;){v=J;var M=v.child;if((v.subtreeFlags&2064)!==0&&M!==null)M.return=v,J=M;else e:for(v=N;J!==null;){if(_=J,(_.flags&2048)!==0)try{switch(_.tag){case 0:case 11:case 15:ml(9,_)}}catch(ue){ot(_,_.return,ue)}if(_===v){J=null;break e}var V=_.sibling;if(V!==null){V.return=_.return,J=V;break e}J=_.return}}if(He=h,Di(),Wn&&typeof Wn.onPostCommitFiberRoot=="function")try{Wn.onPostCommitFiberRoot(Na,n)}catch{}c=!0}return c}finally{We=a,gn.transition=i}}return!1}function Qp(n,i,a){i=uo(a,i),i=mp(n,i,1),n=Mi(n,i,1),i=Ht(),n!==null&&(is(n,1,i),Zt(n,i))}function ot(n,i,a){if(n.tag===3)Qp(n,n,a);else for(;i!==null;){if(i.tag===3){Qp(i,n,a);break}else if(i.tag===1){var c=i.stateNode;if(typeof i.type.getDerivedStateFromError=="function"||typeof c.componentDidCatch=="function"&&(Fi===null||!Fi.has(c))){n=uo(a,n),n=vp(i,n,1),i=Mi(i,n,1),n=Ht(),i!==null&&(is(i,1,n),Zt(i,n));break}}i=i.return}}function yT(n,i,a){var c=n.pingCache;c!==null&&c.delete(i),i=Ht(),n.pingedLanes|=n.suspendedLanes&a,yt===n&&(Ct&a)===a&&(gt===4||gt===3&&(Ct&130023424)===Ct&&500>at()-cd?Sr(n,0):ud|=a),Zt(n,i)}function Jp(n,i){i===0&&((n.mode&1)===0?i=1:(i=Oa,Oa<<=1,(Oa&130023424)===0&&(Oa=4194304)));var a=Ht();n=oi(n,i),n!==null&&(is(n,i,a),Zt(n,a))}function TT(n){var i=n.memoizedState,a=0;i!==null&&(a=i.retryLane),Jp(n,a)}function AT(n,i){var a=0;switch(n.tag){case 13:var c=n.stateNode,h=n.memoizedState;h!==null&&(a=h.retryLane);break;case 19:c=n.stateNode;break;default:throw Error(r(314))}c!==null&&c.delete(i),Jp(n,a)}var em;em=function(n,i,a){if(n!==null)if(n.memoizedProps!==i.pendingProps||jt.current)Xt=!0;else{if((n.lanes&a)===0&&(i.flags&128)===0)return Xt=!1,lT(n,i,a);Xt=(n.flags&131072)!==0}else Xt=!1,Qe&&(i.flags&1048576)!==0&&kg(i,Ja,i.index);switch(i.lanes=0,i.tag){case 2:var c=i.type;gl(n,i),n=i.pendingProps;var h=to(i,Nt.current);ao(i,a),h=xc(null,i,c,n,h,a);var p=$c();return i.flags|=1,typeof h=="object"&&h!==null&&typeof h.render=="function"&&h.$$typeof===void 0?(i.tag=1,i.memoizedState=null,i.updateQueue=null,Vt(c)?(p=!0,Za(i)):p=!1,i.memoizedState=h.state!==null&&h.state!==void 0?h.state:null,Fc(i),h.updater=fl,i.stateNode=h,h._reactInternals=i,Xc(i,c,n,a),i=Qc(null,i,c,!0,p,a)):(i.tag=0,Qe&&p&&wc(i),Bt(null,i,h,a),i=i.child),i;case 16:c=i.elementType;e:{switch(gl(n,i),n=i.pendingProps,h=c._init,c=h(c._payload),i.type=c,h=i.tag=ET(c),n=Rn(c,n),h){case 0:i=qc(null,i,c,n,a);break e;case 1:i=Cp(null,i,c,n,a);break e;case 11:i=Ap(null,i,c,n,a);break e;case 14:i=Ip(null,i,c,Rn(c.type,n),a);break e}throw Error(r(306,c,""))}return i;case 0:return c=i.type,h=i.pendingProps,h=i.elementType===c?h:Rn(c,h),qc(n,i,c,h,a);case 1:return c=i.type,h=i.pendingProps,h=i.elementType===c?h:Rn(c,h),Cp(n,i,c,h,a);case 3:e:{if(Rp(i),n===null)throw Error(r(387));c=i.pendingProps,p=i.memoizedState,h=p.element,$g(n,i),ol(i,c,null,a);var v=i.memoizedState;if(c=v.element,p.isDehydrated)if(p={element:c,isDehydrated:!1,cache:v.cache,pendingSuspenseBoundaries:v.pendingSuspenseBoundaries,transitions:v.transitions},i.updateQueue.baseState=p,i.memoizedState=p,i.flags&256){h=uo(Error(r(423)),i),i=Pp(n,i,c,a,h);break e}else if(c!==h){h=uo(Error(r(424)),i),i=Pp(n,i,c,a,h);break e}else for(tn=Ri(i.stateNode.containerInfo.firstChild),en=i,Qe=!0,Cn=null,a=Gg(i,null,c,a),i.child=a;a;)a.flags=a.flags&-3|4096,a=a.sibling;else{if(ro(),c===h){i=ai(n,i,a);break e}Bt(n,i,c,a)}i=i.child}return i;case 5:return Yg(i),n===null&&Rc(i),c=i.type,h=i.pendingProps,p=n!==null?n.memoizedProps:null,v=h.children,Sc(c,h)?v=null:p!==null&&Sc(c,p)&&(i.flags|=32),_p(n,i),Bt(n,i,v,a),i.child;case 6:return n===null&&Rc(i),null;case 13:return Np(n,i,a);case 4:return Uc(i,i.stateNode.containerInfo),c=i.pendingProps,n===null?i.child=oo(i,null,c,a):Bt(n,i,c,a),i.child;case 11:return c=i.type,h=i.pendingProps,h=i.elementType===c?h:Rn(c,h),Ap(n,i,c,h,a);case 7:return Bt(n,i,i.pendingProps,a),i.child;case 8:return Bt(n,i,i.pendingProps.children,a),i.child;case 12:return Bt(n,i,i.pendingProps.children,a),i.child;case 10:e:{if(c=i.type._context,h=i.pendingProps,p=i.memoizedProps,v=h.value,Ye(nl,c._currentValue),c._currentValue=v,p!==null)if(_n(p.value,v)){if(p.children===h.children&&!jt.current){i=ai(n,i,a);break e}}else for(p=i.child,p!==null&&(p.return=i);p!==null;){var _=p.dependencies;if(_!==null){v=p.child;for(var R=_.firstContext;R!==null;){if(R.context===c){if(p.tag===1){R=si(-1,a&-a),R.tag=2;var k=p.updateQueue;if(k!==null){k=k.shared;var x=k.pending;x===null?R.next=R:(R.next=x.next,x.next=R),k.pending=R}}p.lanes|=a,R=p.alternate,R!==null&&(R.lanes|=a),Mc(p.return,a,i),_.lanes|=a;break}R=R.next}}else if(p.tag===10)v=p.type===i.type?null:p.child;else if(p.tag===18){if(v=p.return,v===null)throw Error(r(341));v.lanes|=a,_=v.alternate,_!==null&&(_.lanes|=a),Mc(v,a,i),v=p.sibling}else v=p.child;if(v!==null)v.return=p;else for(v=p;v!==null;){if(v===i){v=null;break}if(p=v.sibling,p!==null){p.return=v.return,v=p;break}v=v.return}p=v}Bt(n,i,h.children,a),i=i.child}return i;case 9:return h=i.type,c=i.pendingProps.children,ao(i,a),h=fn(h),c=c(h),i.flags|=1,Bt(n,i,c,a),i.child;case 14:return c=i.type,h=Rn(c,i.pendingProps),h=Rn(c.type,h),Ip(n,i,c,h,a);case 15:return Ep(n,i,i.type,i.pendingProps,a);case 17:return c=i.type,h=i.pendingProps,h=i.elementType===c?h:Rn(c,h),gl(n,i),i.tag=1,Vt(c)?(n=!0,Za(i)):n=!1,ao(i,a),gp(i,c,h),Xc(i,c,h,a),Qc(null,i,c,!0,n,a);case 19:return Op(n,i,a);case 22:return wp(n,i,a)}throw Error(r(156,i.tag))};function tm(n,i){return Fh(n,i)}function IT(n,i,a,c){this.tag=n,this.key=a,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=i,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=c,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function pn(n,i,a,c){return new IT(n,i,a,c)}function Sd(n){return n=n.prototype,!(!n||!n.isReactComponent)}function ET(n){if(typeof n=="function")return Sd(n)?1:0;if(n!=null){if(n=n.$$typeof,n===De)return 11;if(n===Ue)return 14}return 2}function Hi(n,i){var a=n.alternate;return a===null?(a=pn(n.tag,i,n.key,n.mode),a.elementType=n.elementType,a.type=n.type,a.stateNode=n.stateNode,a.alternate=n,n.alternate=a):(a.pendingProps=i,a.type=n.type,a.flags=0,a.subtreeFlags=0,a.deletions=null),a.flags=n.flags&14680064,a.childLanes=n.childLanes,a.lanes=n.lanes,a.child=n.child,a.memoizedProps=n.memoizedProps,a.memoizedState=n.memoizedState,a.updateQueue=n.updateQueue,i=n.dependencies,a.dependencies=i===null?null:{lanes:i.lanes,firstContext:i.firstContext},a.sibling=n.sibling,a.index=n.index,a.ref=n.ref,a}function _l(n,i,a,c,h,p){var v=2;if(c=n,typeof n=="function")Sd(n)&&(v=1);else if(typeof n=="string")v=5;else e:switch(n){case $:return Tr(a.children,h,p,i);case ee:v=8,h|=8;break;case _e:return n=pn(12,a,i,h|2),n.elementType=_e,n.lanes=p,n;case Pe:return n=pn(13,a,i,h),n.elementType=Pe,n.lanes=p,n;case de:return n=pn(19,a,i,h),n.elementType=de,n.lanes=p,n;case ne:return Cl(a,h,p,i);default:if(typeof n=="object"&&n!==null)switch(n.$$typeof){case Ce:v=10;break e;case be:v=9;break e;case De:v=11;break e;case Ue:v=14;break e;case Te:v=16,c=null;break e}throw Error(r(130,n==null?n:typeof n,""))}return i=pn(v,a,i,h),i.elementType=n,i.type=c,i.lanes=p,i}function Tr(n,i,a,c){return n=pn(7,n,c,i),n.lanes=a,n}function Cl(n,i,a,c){return n=pn(22,n,c,i),n.elementType=ne,n.lanes=a,n.stateNode={isHidden:!1},n}function yd(n,i,a){return n=pn(6,n,null,i),n.lanes=a,n}function Td(n,i,a){return i=pn(4,n.children!==null?n.children:[],n.key,i),i.lanes=a,i.stateNode={containerInfo:n.containerInfo,pendingChildren:null,implementation:n.implementation},i}function wT(n,i,a,c,h){this.tag=i,this.containerInfo=n,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Vu(0),this.expirationTimes=Vu(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Vu(0),this.identifierPrefix=c,this.onRecoverableError=h,this.mutableSourceEagerHydrationData=null}function Ad(n,i,a,c,h,p,v,_,R){return n=new wT(n,i,a,_,R),i===1?(i=1,p===!0&&(i|=8)):i=0,p=pn(3,null,null,i),n.current=p,p.stateNode=n,p.memoizedState={element:c,isDehydrated:a,cache:null,transitions:null,pendingSuspenseBoundaries:null},Fc(p),n}function _T(n,i,a){var c=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:U,key:c==null?null:""+c,children:n,containerInfo:i,implementation:a}}function nm(n){if(!n)return Ni;n=n._reactInternals;e:{if(lr(n)!==n||n.tag!==1)throw Error(r(170));var i=n;do{switch(i.tag){case 3:i=i.stateNode.context;break e;case 1:if(Vt(i.type)){i=i.stateNode.__reactInternalMemoizedMergedChildContext;break e}}i=i.return}while(i!==null);throw Error(r(171))}if(n.tag===1){var a=n.type;if(Vt(a))return Dg(n,a,i)}return i}function im(n,i,a,c,h,p,v,_,R){return n=Ad(a,c,!0,n,h,p,v,_,R),n.context=nm(null),a=n.current,c=Ht(),h=Li(a),p=si(c,h),p.callback=i??null,Mi(a,p,h),n.current.lanes=h,is(n,h,c),Zt(n,c),n}function Rl(n,i,a,c){var h=i.current,p=Ht(),v=Li(h);return a=nm(a),i.context===null?i.context=a:i.pendingContext=a,i=si(p,v),i.payload={element:n},c=c===void 0?null:c,c!==null&&(i.callback=c),n=Mi(h,i,v),n!==null&&(Dn(n,h,v,p),rl(n,h,v)),v}function Pl(n){if(n=n.current,!n.child)return null;switch(n.child.tag){case 5:return n.child.stateNode;default:return n.child.stateNode}}function rm(n,i){if(n=n.memoizedState,n!==null&&n.dehydrated!==null){var a=n.retryLane;n.retryLane=a!==0&&a<i?a:i}}function Id(n,i){rm(n,i),(n=n.alternate)&&rm(n,i)}function CT(){return null}var om=typeof reportError=="function"?reportError:function(n){console.error(n)};function Ed(n){this._internalRoot=n}Nl.prototype.render=Ed.prototype.render=function(n){var i=this._internalRoot;if(i===null)throw Error(r(409));Rl(n,i,null,null)},Nl.prototype.unmount=Ed.prototype.unmount=function(){var n=this._internalRoot;if(n!==null){this._internalRoot=null;var i=n.containerInfo;vr(function(){Rl(null,n,null,null)}),i[ti]=null}};function Nl(n){this._internalRoot=n}Nl.prototype.unstable_scheduleHydration=function(n){if(n){var i=$h();n={blockedOn:null,target:n,priority:i};for(var a=0;a<wi.length&&i!==0&&i<wi[a].priority;a++);wi.splice(a,0,n),a===0&&Yh(n)}};function wd(n){return!(!n||n.nodeType!==1&&n.nodeType!==9&&n.nodeType!==11)}function Dl(n){return!(!n||n.nodeType!==1&&n.nodeType!==9&&n.nodeType!==11&&(n.nodeType!==8||n.nodeValue!==" react-mount-point-unstable "))}function sm(){}function RT(n,i,a,c,h){if(h){if(typeof c=="function"){var p=c;c=function(){var k=Pl(v);p.call(k)}}var v=im(i,c,n,0,null,!1,!1,"",sm);return n._reactRootContainer=v,n[ti]=v.current,vs(n.nodeType===8?n.parentNode:n),vr(),v}for(;h=n.lastChild;)n.removeChild(h);if(typeof c=="function"){var _=c;c=function(){var k=Pl(R);_.call(k)}}var R=Ad(n,0,!1,null,null,!1,!1,"",sm);return n._reactRootContainer=R,n[ti]=R.current,vs(n.nodeType===8?n.parentNode:n),vr(function(){Rl(i,R,a,c)}),R}function Ol(n,i,a,c,h){var p=a._reactRootContainer;if(p){var v=p;if(typeof h=="function"){var _=h;h=function(){var R=Pl(v);_.call(R)}}Rl(i,v,n,h)}else v=RT(a,i,n,h,c);return Pl(v)}Gh=function(n){switch(n.tag){case 3:var i=n.stateNode;if(i.current.memoizedState.isDehydrated){var a=ns(i.pendingLanes);a!==0&&(Xu(i,a|1),Zt(i,at()),(He&6)===0&&(ho=at()+500,Di()))}break;case 13:vr(function(){var c=oi(n,1);if(c!==null){var h=Ht();Dn(c,n,1,h)}}),Id(n,1)}},Ku=function(n){if(n.tag===13){var i=oi(n,134217728);if(i!==null){var a=Ht();Dn(i,n,134217728,a)}Id(n,134217728)}},xh=function(n){if(n.tag===13){var i=Li(n),a=oi(n,i);if(a!==null){var c=Ht();Dn(a,n,i,c)}Id(n,i)}},$h=function(){return We},zh=function(n,i){var a=We;try{return We=n,i()}finally{We=a}},xu=function(n,i,a){switch(i){case"input":if(Yt(n,a),i=a.name,a.type==="radio"&&i!=null){for(a=n;a.parentNode;)a=a.parentNode;for(a=a.querySelectorAll("input[name="+JSON.stringify(""+i)+'][type="radio"]'),i=0;i<a.length;i++){var c=a[i];if(c!==n&&c.form===n.form){var h=Xa(c);if(!h)throw Error(r(90));ge(c),Yt(c,h)}}}break;case"textarea":Sh(n,a);break;case"select":i=a.value,i!=null&&Ti(n,!!a.multiple,i,!1)}},Rh=pd,Ph=vr;var PT={usingClientEntryPoint:!1,Events:[Ts,Jr,Xa,_h,Ch,pd]},Fs={findFiberByHostInstance:ur,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},NT={bundleType:Fs.bundleType,version:Fs.version,rendererPackageName:Fs.rendererPackageName,rendererConfig:Fs.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:H.ReactCurrentDispatcher,findHostInstanceByFiber:function(n){return n=Mh(n),n===null?null:n.stateNode},findFiberByHostInstance:Fs.findFiberByHostInstance||CT,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Ml=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Ml.isDisabled&&Ml.supportsFiber)try{Na=Ml.inject(NT),Wn=Ml}catch{}}return qt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=PT,qt.createPortal=function(n,i){var a=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!wd(i))throw Error(r(200));return _T(n,i,null,a)},qt.createRoot=function(n,i){if(!wd(n))throw Error(r(299));var a=!1,c="",h=om;return i!=null&&(i.unstable_strictMode===!0&&(a=!0),i.identifierPrefix!==void 0&&(c=i.identifierPrefix),i.onRecoverableError!==void 0&&(h=i.onRecoverableError)),i=Ad(n,1,!1,null,null,a,!1,c,h),n[ti]=i.current,vs(n.nodeType===8?n.parentNode:n),new Ed(i)},qt.findDOMNode=function(n){if(n==null)return null;if(n.nodeType===1)return n;var i=n._reactInternals;if(i===void 0)throw typeof n.render=="function"?Error(r(188)):(n=Object.keys(n).join(","),Error(r(268,n)));return n=Mh(i),n=n===null?null:n.stateNode,n},qt.flushSync=function(n){return vr(n)},qt.hydrate=function(n,i,a){if(!Dl(i))throw Error(r(200));return Ol(null,n,i,!0,a)},qt.hydrateRoot=function(n,i,a){if(!wd(n))throw Error(r(405));var c=a!=null&&a.hydratedSources||null,h=!1,p="",v=om;if(a!=null&&(a.unstable_strictMode===!0&&(h=!0),a.identifierPrefix!==void 0&&(p=a.identifierPrefix),a.onRecoverableError!==void 0&&(v=a.onRecoverableError)),i=im(i,null,n,1,a??null,h,!1,p,v),n[ti]=i.current,vs(n),c)for(n=0;n<c.length;n++)a=c[n],h=a._getVersion,h=h(a._source),i.mutableSourceEagerHydrationData==null?i.mutableSourceEagerHydrationData=[a,h]:i.mutableSourceEagerHydrationData.push(a,h);return new Nl(i)},qt.render=function(n,i,a){if(!Dl(i))throw Error(r(200));return Ol(null,n,i,!1,a)},qt.unmountComponentAtNode=function(n){if(!Dl(n))throw Error(r(40));return n._reactRootContainer?(vr(function(){Ol(null,null,n,!1,function(){n._reactRootContainer=null,n[ti]=null})}),!0):!1},qt.unstable_batchedUpdates=pd,qt.unstable_renderSubtreeIntoContainer=function(n,i,a,c){if(!Dl(a))throw Error(r(200));if(n==null||n._reactInternals===void 0)throw Error(r(38));return Ol(n,i,a,!1,c)},qt.version="18.3.1-next-f1338f8080-20240426",qt}var gm;function bT(){if(gm)return Rd.exports;gm=1;function e(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}return e(),Rd.exports=HT(),Rd.exports}var pm;function GT(){if(pm)return kl;pm=1;var e=bT();return kl.createRoot=e.createRoot,kl.hydrateRoot=e.hydrateRoot,kl}var xT=GT();const $T=x0(xT);class zT{constructor(){this.ids=[],this.values=[],this.length=0}clear(){this.length=0}push(t,r){let o=this.length++;for(;o>0;){const l=o-1>>1,s=this.values[l];if(r>=s)break;this.ids[o]=this.ids[l],this.values[o]=s,o=l}this.ids[o]=t,this.values[o]=r}pop(){if(this.length===0)return;const t=this.ids[0];if(this.length--,this.length>0){const r=this.ids[0]=this.ids[this.length],o=this.values[0]=this.values[this.length],l=this.length>>1;let s=0;for(;s<l;){let u=(s<<1)+1;const d=u+1;let f=this.ids[u],g=this.values[u];const m=this.values[d];if(d<this.length&&m<g&&(u=d,f=this.ids[d],g=m),g>=o)break;this.ids[s]=f,this.values[s]=g,s=u}this.ids[s]=r,this.values[s]=o}return t}peek(){if(this.length!==0)return this.ids[0]}peekValue(){if(this.length!==0)return this.values[0]}shrink(){this.ids.length=this.values.length=this.length}}const mm=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array],Dd=3;class kf{static from(t,r=0){if(r%8!==0)throw new Error("byteOffset must be 8-byte aligned.");if(!t||t.byteLength===void 0||t.buffer)throw new Error("Data must be an instance of ArrayBuffer or SharedArrayBuffer.");const[o,l]=new Uint8Array(t,r+0,2);if(o!==251)throw new Error("Data does not appear to be in a Flatbush format.");const s=l>>4;if(s!==Dd)throw new Error(`Got v${s} data when expected v${Dd}.`);const u=mm[l&15];if(!u)throw new Error("Unrecognized array type.");const[d]=new Uint16Array(t,r+2,1),[f]=new Uint32Array(t,r+4,1);return new kf(f,d,u,void 0,t,r)}constructor(t,r=16,o=Float64Array,l=ArrayBuffer,s,u=0){if(t===void 0)throw new Error("Missing required argument: numItems.");if(isNaN(t)||t<=0)throw new Error(`Unexpected numItems value: ${t}.`);this.numItems=+t,this.nodeSize=Math.min(Math.max(+r,2),65535),this.byteOffset=u;let d=t,f=d;this._levelBounds=[d*4];do d=Math.ceil(d/this.nodeSize),f+=d,this._levelBounds.push(f*4);while(d!==1);this.ArrayType=o,this.IndexArrayType=f<16384?Uint16Array:Uint32Array;const g=mm.indexOf(this.ArrayType),m=f*4*this.ArrayType.BYTES_PER_ELEMENT;if(g<0)throw new Error(`Unexpected typed array class: ${o}.`);s&&s.byteLength!==void 0&&!s.buffer?(this.data=s,this._boxes=new this.ArrayType(this.data,u+8,f*4),this._indices=new this.IndexArrayType(this.data,u+8+m,f),this._pos=f*4,this.minX=this._boxes[this._pos-4],this.minY=this._boxes[this._pos-3],this.maxX=this._boxes[this._pos-2],this.maxY=this._boxes[this._pos-1]):(this.data=new l(8+m+f*this.IndexArrayType.BYTES_PER_ELEMENT),this._boxes=new this.ArrayType(this.data,8,f*4),this._indices=new this.IndexArrayType(this.data,8+m,f),this._pos=0,this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0,new Uint8Array(this.data,0,2).set([251,(Dd<<4)+g]),new Uint16Array(this.data,2,1)[0]=r,new Uint32Array(this.data,4,1)[0]=t),this._queue=new zT}add(t,r,o=t,l=r){const s=this._pos>>2,u=this._boxes;return this._indices[s]=s,u[this._pos++]=t,u[this._pos++]=r,u[this._pos++]=o,u[this._pos++]=l,t<this.minX&&(this.minX=t),r<this.minY&&(this.minY=r),o>this.maxX&&(this.maxX=o),l>this.maxY&&(this.maxY=l),s}finish(){if(this._pos>>2!==this.numItems)throw new Error(`Added ${this._pos>>2} items when expected ${this.numItems}.`);const t=this._boxes;if(this.numItems<=this.nodeSize){t[this._pos++]=this.minX,t[this._pos++]=this.minY,t[this._pos++]=this.maxX,t[this._pos++]=this.maxY;return}const r=this.maxX-this.minX||1,o=this.maxY-this.minY||1,l=new Uint32Array(this.numItems),s=65535;for(let u=0,d=0;u<this.numItems;u++){const f=t[d++],g=t[d++],m=t[d++],S=t[d++],y=Math.floor(s*((f+m)/2-this.minX)/r),w=Math.floor(s*((g+S)/2-this.minY)/o);l[u]=YT(y,w)}uf(l,t,this._indices,0,this.numItems-1,this.nodeSize);for(let u=0,d=0;u<this._levelBounds.length-1;u++){const f=this._levelBounds[u];for(;d<f;){const g=d;let m=t[d++],S=t[d++],y=t[d++],w=t[d++];for(let A=1;A<this.nodeSize&&d<f;A++)m=Math.min(m,t[d++]),S=Math.min(S,t[d++]),y=Math.max(y,t[d++]),w=Math.max(w,t[d++]);this._indices[this._pos>>2]=g,t[this._pos++]=m,t[this._pos++]=S,t[this._pos++]=y,t[this._pos++]=w}}}search(t,r,o,l,s){if(this._pos!==this._boxes.length)throw new Error("Data not yet indexed - call index.finish().");let u=this._boxes.length-4;const d=[],f=[];for(;u!==void 0;){const g=Math.min(u+this.nodeSize*4,Sm(u,this._levelBounds));for(let m=u;m<g;m+=4){if(o<this._boxes[m]||l<this._boxes[m+1]||t>this._boxes[m+2]||r>this._boxes[m+3])continue;const S=this._indices[m>>2]|0;u>=this.numItems*4?d.push(S):(s===void 0||s(S))&&f.push(S)}u=d.pop()}return f}neighbors(t,r,o=1/0,l=1/0,s){if(this._pos!==this._boxes.length)throw new Error("Data not yet indexed - call index.finish().");let u=this._boxes.length-4;const d=this._queue,f=[],g=l*l;e:for(;u!==void 0;){const m=Math.min(u+this.nodeSize*4,Sm(u,this._levelBounds));for(let S=u;S<m;S+=4){const y=this._indices[S>>2]|0,w=vm(t,this._boxes[S],this._boxes[S+2]),A=vm(r,this._boxes[S+1],this._boxes[S+3]),I=w*w+A*A;I>g||(u>=this.numItems*4?d.push(y<<1,I):(s===void 0||s(y))&&d.push((y<<1)+1,I))}for(;d.length&&d.peek()&1;)if(d.peekValue()>g||(f.push(d.pop()>>1),f.length===o))break e;u=d.length?d.pop()>>1:void 0}return d.clear(),f}}function vm(e,t,r){return e<t?t-e:e<=r?0:e-r}function Sm(e,t){let r=0,o=t.length-1;for(;r<o;){const l=r+o>>1;t[l]>e?o=l:r=l+1}return t[r]}function uf(e,t,r,o,l,s){if(Math.floor(o/s)>=Math.floor(l/s))return;const u=e[o+l>>1];let d=o-1,f=l+1;for(;;){do d++;while(e[d]<u);do f--;while(e[f]>u);if(d>=f)break;WT(e,t,r,d,f)}uf(e,t,r,o,f,s),uf(e,t,r,f+1,l,s)}function WT(e,t,r,o,l){const s=e[o];e[o]=e[l],e[l]=s;const u=4*o,d=4*l,f=t[u],g=t[u+1],m=t[u+2],S=t[u+3];t[u]=t[d],t[u+1]=t[d+1],t[u+2]=t[d+2],t[u+3]=t[d+3],t[d]=f,t[d+1]=g,t[d+2]=m,t[d+3]=S;const y=r[o];r[o]=r[l],r[l]=y}function YT(e,t){let r=e^t,o=65535^r,l=65535^(e|t),s=e&(t^65535),u=r|o>>1,d=r>>1^r,f=l>>1^o&s>>1^l,g=r&l>>1^s>>1^s;r=u,o=d,l=f,s=g,u=r&r>>2^o&o>>2,d=r&o>>2^o&(r^o)>>2,f^=r&l>>2^o&s>>2,g^=o&l>>2^(r^o)&s>>2,r=u,o=d,l=f,s=g,u=r&r>>4^o&o>>4,d=r&o>>4^o&(r^o)>>4,f^=r&l>>4^o&s>>4,g^=o&l>>4^(r^o)&s>>4,r=u,o=d,l=f,s=g,f^=r&l>>8^o&s>>8,g^=o&l>>8^(r^o)&s>>8,r=f^f>>1,o=g^g>>1;let m=e^t,S=o|65535^(m|r);return m=(m|m<<8)&16711935,m=(m|m<<4)&252645135,m=(m|m<<2)&858993459,m=(m|m<<1)&1431655765,S=(S|S<<8)&16711935,S=(S|S<<4)&252645135,S=(S|S<<2)&858993459,S=(S|S<<1)&1431655765,(S<<1|m)>>>0}function po(e,t){if(e.length===0)return{all:()=>[],byRect:()=>[],byRadius:()=>[],byProperty:()=>[],resetPropertyCache:()=>{},count:()=>0};const r=new kf(e.length),o=new Map;for(const s of e)r.add(s.position.x,s.position.y,s.position.x,s.position.y);return r.finish(),{all(){return e},byRect(s){return r.search(s.left,s.top,s.right,s.bottom).map(d=>e[d])},byRadius(s,u){return r.neighbors(s.x,s.y,void 0,u).map(f=>e[f])},byProperty(s,u){var d;if(!o.has(s)){const f=new Map;for(const g of e){const m=g[s];f.has(m)||f.set(m,[]),f.get(m).push(g)}o.set(s,f)}return((d=o.get(s))==null?void 0:d.get(u))||[]},resetPropertyCache(){o.clear()},count(){return e.length}}}function Iu(e){const t=Object.values(e.entities.entities),r=t.filter(g=>g.type==="human"),o=t.filter(g=>g.type==="berryBush"),l=t.filter(g=>g.type==="corpse"),s=t.filter(g=>g.type==="prey"),u=t.filter(g=>g.type==="predator"),d=t.filter(g=>g.type==="building");return{...e,search:{human:po(r),berryBush:po(o),corpse:po(l),prey:po(s),predator:po(u),building:po(d)}}}const jT="tribe-game-db",ir="save-files",Ff="tribe-game-save",cf=1;async function Uf(e){try{const t={version:cf,savedAt:Date.now(),gameState:e},r=JSON.stringify(t),o=await XT(r);await ZT(Ff,o),console.log(`Game saved successfully. Size: ${(o.size/1024).toFixed(2)} KB`)}catch(t){throw console.error("Failed to save game:",t),t}}async function VT(){try{const e=await qT(Ff);if(!e)return null;const t=await KT(e),r=JSON.parse(t);return r.version!==cf?(console.warn(`Save game version mismatch. Expected ${cf}, found ${r.version}. Discarding save.`),await df(),null):(console.log("Game loaded successfully."),Iu(r.gameState))}catch(e){return console.error("Failed to load game:",e),await df(),null}}async function df(){try{await QT(Ff),console.log("Saved game cleared.")}catch(e){console.error("Failed to clear saved game:",e)}}async function XT(e){const r=new Blob([e]).stream().pipeThrough(new CompressionStream("gzip"));return await new Response(r).blob()}async function KT(e){const t=e.stream().pipeThrough(new DecompressionStream("gzip"));return await new Response(t).text()}function Lf(){return new Promise((e,t)=>{const r=indexedDB.open(jT,1);r.onupgradeneeded=o=>{const l=o.target.result;l.objectStoreNames.contains(ir)||l.createObjectStore(ir)},r.onsuccess=()=>e(r.result),r.onerror=()=>t(r.error)})}async function ZT(e,t){const r=await Lf();return new Promise((o,l)=>{const d=r.transaction(ir,"readwrite").objectStore(ir).put(t,e);d.onsuccess=()=>o(),d.onerror=()=>l(d.error)})}async function qT(e){const t=await Lf();return new Promise((r,o)=>{const u=t.transaction(ir,"readonly").objectStore(ir).get(e);u.onsuccess=()=>r(u.result),u.onerror=()=>o(u.error)})}async function QT(e){const t=await Lf();return new Promise((r,o)=>{const u=t.transaction(ir,"readwrite").objectStore(ir).delete(e);u.onsuccess=()=>r(),u.onerror=()=>o(u.error)})}const $0=Re.createContext(void 0),JT=({initialAppState:e,children:t})=>{const[r,o]=Re.useState(e),[l,s]=Re.useState(void 0),[u,d]=Re.useState(null),[f,g]=Re.useState(!1);Re.useEffect(()=>{VT().then(A=>{A&&d(A),g(!0)})},[]);const m=(A,I)=>{o(A),A==="gameOver"&&I?s(I):A!=="gameOver"&&s(void 0)},S=()=>{o("intro"),s(void 0),w()},y=A=>{Uf(A),d(A)},w=()=>{df(),d(null)};return Fe.jsx($0.Provider,{value:{appState:r,setAppState:m,returnToIntro:S,gameOverDetails:l,contextReady:f,savedGameState:u,setSavedGameState:d,saveCurrentGame:y,clearCurrentSave:w},children:t})},Wo=()=>{const e=Re.useContext($0);if(e===void 0)throw new Error("useGameContext must be used within a GameProvider");return e};var Ut=function(){return Ut=Object.assign||function(t){for(var r,o=1,l=arguments.length;o<l;o++){r=arguments[o];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(t[s]=r[s])}return t},Ut.apply(this,arguments)};function oa(e,t,r){if(r||arguments.length===2)for(var o=0,l=t.length,s;o<l;o++)(s||!(o in t))&&(s||(s=Array.prototype.slice.call(t,0,o)),s[o]=t[o]);return e.concat(s||Array.prototype.slice.call(t))}var Ke="-ms-",Zs="-moz-",$e="-webkit-",z0="comm",Eu="rule",Bf="decl",eA="@import",W0="@keyframes",tA="@layer",Y0=Math.abs,Hf=String.fromCharCode,ff=Object.assign;function nA(e,t){return At(e,0)^45?(((t<<2^At(e,0))<<2^At(e,1))<<2^At(e,2))<<2^At(e,3):0}function j0(e){return e.trim()}function di(e,t){return(e=t.exec(e))?e[0]:e}function ke(e,t,r){return e.replace(t,r)}function nu(e,t,r){return e.indexOf(t,r)}function At(e,t){return e.charCodeAt(t)|0}function ko(e,t,r){return e.slice(t,r)}function Qn(e){return e.length}function V0(e){return e.length}function Ws(e,t){return t.push(e),e}function iA(e,t){return e.map(t).join("")}function ym(e,t){return e.filter(function(r){return!di(r,t)})}var wu=1,Fo=1,X0=0,Tn=0,ft=0,Yo="";function _u(e,t,r,o,l,s,u,d){return{value:e,root:t,parent:r,type:o,props:l,children:s,line:wu,column:Fo,length:u,return:"",siblings:d}}function Yi(e,t){return ff(_u("",null,null,"",null,null,0,e.siblings),e,{length:-e.length},t)}function mo(e){for(;e.root;)e=Yi(e.root,{children:[e]});Ws(e,e.siblings)}function rA(){return ft}function oA(){return ft=Tn>0?At(Yo,--Tn):0,Fo--,ft===10&&(Fo=1,wu--),ft}function Un(){return ft=Tn<X0?At(Yo,Tn++):0,Fo++,ft===10&&(Fo=1,wu++),ft}function Dr(){return At(Yo,Tn)}function iu(){return Tn}function Cu(e,t){return ko(Yo,e,t)}function hf(e){switch(e){case 0:case 9:case 10:case 13:case 32:return 5;case 33:case 43:case 44:case 47:case 62:case 64:case 126:case 59:case 123:case 125:return 4;case 58:return 3;case 34:case 39:case 40:case 91:return 2;case 41:case 93:return 1}return 0}function sA(e){return wu=Fo=1,X0=Qn(Yo=e),Tn=0,[]}function aA(e){return Yo="",e}function Od(e){return j0(Cu(Tn-1,gf(e===91?e+2:e===40?e+1:e)))}function lA(e){for(;(ft=Dr())&&ft<33;)Un();return hf(e)>2||hf(ft)>3?"":" "}function uA(e,t){for(;--t&&Un()&&!(ft<48||ft>102||ft>57&&ft<65||ft>70&&ft<97););return Cu(e,iu()+(t<6&&Dr()==32&&Un()==32))}function gf(e){for(;Un();)switch(ft){case e:return Tn;case 34:case 39:e!==34&&e!==39&&gf(ft);break;case 40:e===41&&gf(e);break;case 92:Un();break}return Tn}function cA(e,t){for(;Un()&&e+ft!==57;)if(e+ft===84&&Dr()===47)break;return"/*"+Cu(t,Tn-1)+"*"+Hf(e===47?e:Un())}function dA(e){for(;!hf(Dr());)Un();return Cu(e,Tn)}function fA(e){return aA(ru("",null,null,null,[""],e=sA(e),0,[0],e))}function ru(e,t,r,o,l,s,u,d,f){for(var g=0,m=0,S=u,y=0,w=0,A=0,I=1,C=1,F=1,B=0,D="",H=l,b=s,U=o,$=D;C;)switch(A=B,B=Un()){case 40:if(A!=108&&At($,S-1)==58){nu($+=ke(Od(B),"&","&\f"),"&\f",Y0(g?d[g-1]:0))!=-1&&(F=-1);break}case 34:case 39:case 91:$+=Od(B);break;case 9:case 10:case 13:case 32:$+=lA(A);break;case 92:$+=uA(iu()-1,7);continue;case 47:switch(Dr()){case 42:case 47:Ws(hA(cA(Un(),iu()),t,r,f),f);break;default:$+="/"}break;case 123*I:d[g++]=Qn($)*F;case 125*I:case 59:case 0:switch(B){case 0:case 125:C=0;case 59+m:F==-1&&($=ke($,/\f/g,"")),w>0&&Qn($)-S&&Ws(w>32?Am($+";",o,r,S-1,f):Am(ke($," ","")+";",o,r,S-2,f),f);break;case 59:$+=";";default:if(Ws(U=Tm($,t,r,g,m,l,d,D,H=[],b=[],S,s),s),B===123)if(m===0)ru($,t,U,U,H,s,S,d,b);else switch(y===99&&At($,3)===110?100:y){case 100:case 108:case 109:case 115:ru(e,U,U,o&&Ws(Tm(e,U,U,0,0,l,d,D,l,H=[],S,b),b),l,b,S,d,o?H:b);break;default:ru($,U,U,U,[""],b,0,d,b)}}g=m=w=0,I=F=1,D=$="",S=u;break;case 58:S=1+Qn($),w=A;default:if(I<1){if(B==123)--I;else if(B==125&&I++==0&&oA()==125)continue}switch($+=Hf(B),B*I){case 38:F=m>0?1:($+="\f",-1);break;case 44:d[g++]=(Qn($)-1)*F,F=1;break;case 64:Dr()===45&&($+=Od(Un())),y=Dr(),m=S=Qn(D=$+=dA(iu())),B++;break;case 45:A===45&&Qn($)==2&&(I=0)}}return s}function Tm(e,t,r,o,l,s,u,d,f,g,m,S){for(var y=l-1,w=l===0?s:[""],A=V0(w),I=0,C=0,F=0;I<o;++I)for(var B=0,D=ko(e,y+1,y=Y0(C=u[I])),H=e;B<A;++B)(H=j0(C>0?w[B]+" "+D:ke(D,/&\f/g,w[B])))&&(f[F++]=H);return _u(e,t,r,l===0?Eu:d,f,g,m,S)}function hA(e,t,r,o){return _u(e,t,r,z0,Hf(rA()),ko(e,2,-2),0,o)}function Am(e,t,r,o,l){return _u(e,t,r,Bf,ko(e,0,o),ko(e,o+1,-1),o,l)}function K0(e,t,r){switch(nA(e,t)){case 5103:return $e+"print-"+e+e;case 5737:case 4201:case 3177:case 3433:case 1641:case 4457:case 2921:case 5572:case 6356:case 5844:case 3191:case 6645:case 3005:case 6391:case 5879:case 5623:case 6135:case 4599:case 4855:case 4215:case 6389:case 5109:case 5365:case 5621:case 3829:return $e+e+e;case 4789:return Zs+e+e;case 5349:case 4246:case 4810:case 6968:case 2756:return $e+e+Zs+e+Ke+e+e;case 5936:switch(At(e,t+11)){case 114:return $e+e+Ke+ke(e,/[svh]\w+-[tblr]{2}/,"tb")+e;case 108:return $e+e+Ke+ke(e,/[svh]\w+-[tblr]{2}/,"tb-rl")+e;case 45:return $e+e+Ke+ke(e,/[svh]\w+-[tblr]{2}/,"lr")+e}case 6828:case 4268:case 2903:return $e+e+Ke+e+e;case 6165:return $e+e+Ke+"flex-"+e+e;case 5187:return $e+e+ke(e,/(\w+).+(:[^]+)/,$e+"box-$1$2"+Ke+"flex-$1$2")+e;case 5443:return $e+e+Ke+"flex-item-"+ke(e,/flex-|-self/g,"")+(di(e,/flex-|baseline/)?"":Ke+"grid-row-"+ke(e,/flex-|-self/g,""))+e;case 4675:return $e+e+Ke+"flex-line-pack"+ke(e,/align-content|flex-|-self/g,"")+e;case 5548:return $e+e+Ke+ke(e,"shrink","negative")+e;case 5292:return $e+e+Ke+ke(e,"basis","preferred-size")+e;case 6060:return $e+"box-"+ke(e,"-grow","")+$e+e+Ke+ke(e,"grow","positive")+e;case 4554:return $e+ke(e,/([^-])(transform)/g,"$1"+$e+"$2")+e;case 6187:return ke(ke(ke(e,/(zoom-|grab)/,$e+"$1"),/(image-set)/,$e+"$1"),e,"")+e;case 5495:case 3959:return ke(e,/(image-set\([^]*)/,$e+"$1$`$1");case 4968:return ke(ke(e,/(.+:)(flex-)?(.*)/,$e+"box-pack:$3"+Ke+"flex-pack:$3"),/s.+-b[^;]+/,"justify")+$e+e+e;case 4200:if(!di(e,/flex-|baseline/))return Ke+"grid-column-align"+ko(e,t)+e;break;case 2592:case 3360:return Ke+ke(e,"template-","")+e;case 4384:case 3616:return r&&r.some(function(o,l){return t=l,di(o.props,/grid-\w+-end/)})?~nu(e+(r=r[t].value),"span",0)?e:Ke+ke(e,"-start","")+e+Ke+"grid-row-span:"+(~nu(r,"span",0)?di(r,/\d+/):+di(r,/\d+/)-+di(e,/\d+/))+";":Ke+ke(e,"-start","")+e;case 4896:case 4128:return r&&r.some(function(o){return di(o.props,/grid-\w+-start/)})?e:Ke+ke(ke(e,"-end","-span"),"span ","")+e;case 4095:case 3583:case 4068:case 2532:return ke(e,/(.+)-inline(.+)/,$e+"$1$2")+e;case 8116:case 7059:case 5753:case 5535:case 5445:case 5701:case 4933:case 4677:case 5533:case 5789:case 5021:case 4765:if(Qn(e)-1-t>6)switch(At(e,t+1)){case 109:if(At(e,t+4)!==45)break;case 102:return ke(e,/(.+:)(.+)-([^]+)/,"$1"+$e+"$2-$3$1"+Zs+(At(e,t+3)==108?"$3":"$2-$3"))+e;case 115:return~nu(e,"stretch",0)?K0(ke(e,"stretch","fill-available"),t,r)+e:e}break;case 5152:case 5920:return ke(e,/(.+?):(\d+)(\s*\/\s*(span)?\s*(\d+))?(.*)/,function(o,l,s,u,d,f,g){return Ke+l+":"+s+g+(u?Ke+l+"-span:"+(d?f:+f-+s)+g:"")+e});case 4949:if(At(e,t+6)===121)return ke(e,":",":"+$e)+e;break;case 6444:switch(At(e,At(e,14)===45?18:11)){case 120:return ke(e,/(.+:)([^;\s!]+)(;|(\s+)?!.+)?/,"$1"+$e+(At(e,14)===45?"inline-":"")+"box$3$1"+$e+"$2$3$1"+Ke+"$2box$3")+e;case 100:return ke(e,":",":"+Ke)+e}break;case 5719:case 2647:case 2135:case 3927:case 2391:return ke(e,"scroll-","scroll-snap-")+e}return e}function cu(e,t){for(var r="",o=0;o<e.length;o++)r+=t(e[o],o,e,t)||"";return r}function gA(e,t,r,o){switch(e.type){case tA:if(e.children.length)break;case eA:case Bf:return e.return=e.return||e.value;case z0:return"";case W0:return e.return=e.value+"{"+cu(e.children,o)+"}";case Eu:if(!Qn(e.value=e.props.join(",")))return""}return Qn(r=cu(e.children,o))?e.return=e.value+"{"+r+"}":""}function pA(e){var t=V0(e);return function(r,o,l,s){for(var u="",d=0;d<t;d++)u+=e[d](r,o,l,s)||"";return u}}function mA(e){return function(t){t.root||(t=t.return)&&e(t)}}function vA(e,t,r,o){if(e.length>-1&&!e.return)switch(e.type){case Bf:e.return=K0(e.value,e.length,r);return;case W0:return cu([Yi(e,{value:ke(e.value,"@","@"+$e)})],o);case Eu:if(e.length)return iA(r=e.props,function(l){switch(di(l,o=/(::plac\w+|:read-\w+)/)){case":read-only":case":read-write":mo(Yi(e,{props:[ke(l,/:(read-\w+)/,":"+Zs+"$1")]})),mo(Yi(e,{props:[l]})),ff(e,{props:ym(r,o)});break;case"::placeholder":mo(Yi(e,{props:[ke(l,/:(plac\w+)/,":"+$e+"input-$1")]})),mo(Yi(e,{props:[ke(l,/:(plac\w+)/,":"+Zs+"$1")]})),mo(Yi(e,{props:[ke(l,/:(plac\w+)/,Ke+"input-$1")]})),mo(Yi(e,{props:[l]})),ff(e,{props:ym(r,o)});break}return""})}}var SA={animationIterationCount:1,aspectRatio:1,borderImageOutset:1,borderImageSlice:1,borderImageWidth:1,boxFlex:1,boxFlexGroup:1,boxOrdinalGroup:1,columnCount:1,columns:1,flex:1,flexGrow:1,flexPositive:1,flexShrink:1,flexNegative:1,flexOrder:1,gridRow:1,gridRowEnd:1,gridRowSpan:1,gridRowStart:1,gridColumn:1,gridColumnEnd:1,gridColumnSpan:1,gridColumnStart:1,msGridRow:1,msGridRowSpan:1,msGridColumn:1,msGridColumnSpan:1,fontWeight:1,lineHeight:1,opacity:1,order:1,orphans:1,tabSize:1,widows:1,zIndex:1,zoom:1,WebkitLineClamp:1,fillOpacity:1,floodOpacity:1,stopOpacity:1,strokeDasharray:1,strokeDashoffset:1,strokeMiterlimit:1,strokeOpacity:1,strokeWidth:1},an={},Uo=typeof process<"u"&&an!==void 0&&(an.REACT_APP_SC_ATTR||an.SC_ATTR)||"data-styled",Z0="active",q0="data-styled-version",Ru="6.1.13",bf=`/*!sc*/
`,du=typeof window<"u"&&"HTMLElement"in window,yA=!!(typeof SC_DISABLE_SPEEDY=="boolean"?SC_DISABLE_SPEEDY:typeof process<"u"&&an!==void 0&&an.REACT_APP_SC_DISABLE_SPEEDY!==void 0&&an.REACT_APP_SC_DISABLE_SPEEDY!==""?an.REACT_APP_SC_DISABLE_SPEEDY!=="false"&&an.REACT_APP_SC_DISABLE_SPEEDY:typeof process<"u"&&an!==void 0&&an.SC_DISABLE_SPEEDY!==void 0&&an.SC_DISABLE_SPEEDY!==""&&an.SC_DISABLE_SPEEDY!=="false"&&an.SC_DISABLE_SPEEDY),TA={},Pu=Object.freeze([]),Lo=Object.freeze({});function Q0(e,t,r){return r===void 0&&(r=Lo),e.theme!==r.theme&&e.theme||t||r.theme}var J0=new Set(["a","abbr","address","area","article","aside","audio","b","base","bdi","bdo","big","blockquote","body","br","button","canvas","caption","cite","code","col","colgroup","data","datalist","dd","del","details","dfn","dialog","div","dl","dt","em","embed","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","header","hgroup","hr","html","i","iframe","img","input","ins","kbd","keygen","label","legend","li","link","main","map","mark","menu","menuitem","meta","meter","nav","noscript","object","ol","optgroup","option","output","p","param","picture","pre","progress","q","rp","rt","ruby","s","samp","script","section","select","small","source","span","strong","style","sub","summary","sup","table","tbody","td","textarea","tfoot","th","thead","time","tr","track","u","ul","use","var","video","wbr","circle","clipPath","defs","ellipse","foreignObject","g","image","line","linearGradient","marker","mask","path","pattern","polygon","polyline","radialGradient","rect","stop","svg","text","tspan"]),AA=/[!"#$%&'()*+,./:;<=>?@[\\\]^`{|}~-]+/g,IA=/(^-|-$)/g;function Im(e){return e.replace(AA,"-").replace(IA,"")}var EA=/(a)(d)/gi,Fl=52,Em=function(e){return String.fromCharCode(e+(e>25?39:97))};function pf(e){var t,r="";for(t=Math.abs(e);t>Fl;t=t/Fl|0)r=Em(t%Fl)+r;return(Em(t%Fl)+r).replace(EA,"$1-$2")}var Md,ev=5381,Co=function(e,t){for(var r=t.length;r;)e=33*e^t.charCodeAt(--r);return e},tv=function(e){return Co(ev,e)};function nv(e){return pf(tv(e)>>>0)}function wA(e){return e.displayName||e.name||"Component"}function kd(e){return typeof e=="string"&&!0}var iv=typeof Symbol=="function"&&Symbol.for,rv=iv?Symbol.for("react.memo"):60115,_A=iv?Symbol.for("react.forward_ref"):60112,CA={childContextTypes:!0,contextType:!0,contextTypes:!0,defaultProps:!0,displayName:!0,getDefaultProps:!0,getDerivedStateFromError:!0,getDerivedStateFromProps:!0,mixins:!0,propTypes:!0,type:!0},RA={name:!0,length:!0,prototype:!0,caller:!0,callee:!0,arguments:!0,arity:!0},ov={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},PA=((Md={})[_A]={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},Md[rv]=ov,Md);function wm(e){return("type"in(t=e)&&t.type.$$typeof)===rv?ov:"$$typeof"in e?PA[e.$$typeof]:CA;var t}var NA=Object.defineProperty,DA=Object.getOwnPropertyNames,_m=Object.getOwnPropertySymbols,OA=Object.getOwnPropertyDescriptor,MA=Object.getPrototypeOf,Cm=Object.prototype;function sv(e,t,r){if(typeof t!="string"){if(Cm){var o=MA(t);o&&o!==Cm&&sv(e,o,r)}var l=DA(t);_m&&(l=l.concat(_m(t)));for(var s=wm(e),u=wm(t),d=0;d<l.length;++d){var f=l[d];if(!(f in RA||r&&r[f]||u&&f in u||s&&f in s)){var g=OA(t,f);try{NA(e,f,g)}catch{}}}}return e}function Bo(e){return typeof e=="function"}function Gf(e){return typeof e=="object"&&"styledComponentId"in e}function Pr(e,t){return e&&t?"".concat(e," ").concat(t):e||t||""}function mf(e,t){if(e.length===0)return"";for(var r=e[0],o=1;o<e.length;o++)r+=e[o];return r}function sa(e){return e!==null&&typeof e=="object"&&e.constructor.name===Object.name&&!("props"in e&&e.$$typeof)}function vf(e,t,r){if(r===void 0&&(r=!1),!r&&!sa(e)&&!Array.isArray(e))return t;if(Array.isArray(t))for(var o=0;o<t.length;o++)e[o]=vf(e[o],t[o]);else if(sa(t))for(var o in t)e[o]=vf(e[o],t[o]);return e}function xf(e,t){Object.defineProperty(e,"toString",{value:t})}function ya(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];return new Error("An error occurred. See https://github.com/styled-components/styled-components/blob/main/packages/styled-components/src/utils/errors.md#".concat(e," for more information.").concat(t.length>0?" Args: ".concat(t.join(", ")):""))}var kA=function(){function e(t){this.groupSizes=new Uint32Array(512),this.length=512,this.tag=t}return e.prototype.indexOfGroup=function(t){for(var r=0,o=0;o<t;o++)r+=this.groupSizes[o];return r},e.prototype.insertRules=function(t,r){if(t>=this.groupSizes.length){for(var o=this.groupSizes,l=o.length,s=l;t>=s;)if((s<<=1)<0)throw ya(16,"".concat(t));this.groupSizes=new Uint32Array(s),this.groupSizes.set(o),this.length=s;for(var u=l;u<s;u++)this.groupSizes[u]=0}for(var d=this.indexOfGroup(t+1),f=(u=0,r.length);u<f;u++)this.tag.insertRule(d,r[u])&&(this.groupSizes[t]++,d++)},e.prototype.clearGroup=function(t){if(t<this.length){var r=this.groupSizes[t],o=this.indexOfGroup(t),l=o+r;this.groupSizes[t]=0;for(var s=o;s<l;s++)this.tag.deleteRule(o)}},e.prototype.getGroup=function(t){var r="";if(t>=this.length||this.groupSizes[t]===0)return r;for(var o=this.groupSizes[t],l=this.indexOfGroup(t),s=l+o,u=l;u<s;u++)r+="".concat(this.tag.getRule(u)).concat(bf);return r},e}(),ou=new Map,fu=new Map,su=1,Ul=function(e){if(ou.has(e))return ou.get(e);for(;fu.has(su);)su++;var t=su++;return ou.set(e,t),fu.set(t,e),t},FA=function(e,t){su=t+1,ou.set(e,t),fu.set(t,e)},UA="style[".concat(Uo,"][").concat(q0,'="').concat(Ru,'"]'),LA=new RegExp("^".concat(Uo,'\\.g(\\d+)\\[id="([\\w\\d-]+)"\\].*?"([^"]*)')),BA=function(e,t,r){for(var o,l=r.split(","),s=0,u=l.length;s<u;s++)(o=l[s])&&e.registerName(t,o)},HA=function(e,t){for(var r,o=((r=t.textContent)!==null&&r!==void 0?r:"").split(bf),l=[],s=0,u=o.length;s<u;s++){var d=o[s].trim();if(d){var f=d.match(LA);if(f){var g=0|parseInt(f[1],10),m=f[2];g!==0&&(FA(m,g),BA(e,m,f[3]),e.getTag().insertRules(g,l)),l.length=0}else l.push(d)}}},Rm=function(e){for(var t=document.querySelectorAll(UA),r=0,o=t.length;r<o;r++){var l=t[r];l&&l.getAttribute(Uo)!==Z0&&(HA(e,l),l.parentNode&&l.parentNode.removeChild(l))}};function bA(){return typeof __webpack_nonce__<"u"?__webpack_nonce__:null}var av=function(e){var t=document.head,r=e||t,o=document.createElement("style"),l=function(d){var f=Array.from(d.querySelectorAll("style[".concat(Uo,"]")));return f[f.length-1]}(r),s=l!==void 0?l.nextSibling:null;o.setAttribute(Uo,Z0),o.setAttribute(q0,Ru);var u=bA();return u&&o.setAttribute("nonce",u),r.insertBefore(o,s),o},GA=function(){function e(t){this.element=av(t),this.element.appendChild(document.createTextNode("")),this.sheet=function(r){if(r.sheet)return r.sheet;for(var o=document.styleSheets,l=0,s=o.length;l<s;l++){var u=o[l];if(u.ownerNode===r)return u}throw ya(17)}(this.element),this.length=0}return e.prototype.insertRule=function(t,r){try{return this.sheet.insertRule(r,t),this.length++,!0}catch{return!1}},e.prototype.deleteRule=function(t){this.sheet.deleteRule(t),this.length--},e.prototype.getRule=function(t){var r=this.sheet.cssRules[t];return r&&r.cssText?r.cssText:""},e}(),xA=function(){function e(t){this.element=av(t),this.nodes=this.element.childNodes,this.length=0}return e.prototype.insertRule=function(t,r){if(t<=this.length&&t>=0){var o=document.createTextNode(r);return this.element.insertBefore(o,this.nodes[t]||null),this.length++,!0}return!1},e.prototype.deleteRule=function(t){this.element.removeChild(this.nodes[t]),this.length--},e.prototype.getRule=function(t){return t<this.length?this.nodes[t].textContent:""},e}(),$A=function(){function e(t){this.rules=[],this.length=0}return e.prototype.insertRule=function(t,r){return t<=this.length&&(this.rules.splice(t,0,r),this.length++,!0)},e.prototype.deleteRule=function(t){this.rules.splice(t,1),this.length--},e.prototype.getRule=function(t){return t<this.length?this.rules[t]:""},e}(),Pm=du,zA={isServer:!du,useCSSOMInjection:!yA},hu=function(){function e(t,r,o){t===void 0&&(t=Lo),r===void 0&&(r={});var l=this;this.options=Ut(Ut({},zA),t),this.gs=r,this.names=new Map(o),this.server=!!t.isServer,!this.server&&du&&Pm&&(Pm=!1,Rm(this)),xf(this,function(){return function(s){for(var u=s.getTag(),d=u.length,f="",g=function(S){var y=function(F){return fu.get(F)}(S);if(y===void 0)return"continue";var w=s.names.get(y),A=u.getGroup(S);if(w===void 0||!w.size||A.length===0)return"continue";var I="".concat(Uo,".g").concat(S,'[id="').concat(y,'"]'),C="";w!==void 0&&w.forEach(function(F){F.length>0&&(C+="".concat(F,","))}),f+="".concat(A).concat(I,'{content:"').concat(C,'"}').concat(bf)},m=0;m<d;m++)g(m);return f}(l)})}return e.registerId=function(t){return Ul(t)},e.prototype.rehydrate=function(){!this.server&&du&&Rm(this)},e.prototype.reconstructWithOptions=function(t,r){return r===void 0&&(r=!0),new e(Ut(Ut({},this.options),t),this.gs,r&&this.names||void 0)},e.prototype.allocateGSInstance=function(t){return this.gs[t]=(this.gs[t]||0)+1},e.prototype.getTag=function(){return this.tag||(this.tag=(t=function(r){var o=r.useCSSOMInjection,l=r.target;return r.isServer?new $A(l):o?new GA(l):new xA(l)}(this.options),new kA(t)));var t},e.prototype.hasNameForId=function(t,r){return this.names.has(t)&&this.names.get(t).has(r)},e.prototype.registerName=function(t,r){if(Ul(t),this.names.has(t))this.names.get(t).add(r);else{var o=new Set;o.add(r),this.names.set(t,o)}},e.prototype.insertRules=function(t,r,o){this.registerName(t,r),this.getTag().insertRules(Ul(t),o)},e.prototype.clearNames=function(t){this.names.has(t)&&this.names.get(t).clear()},e.prototype.clearRules=function(t){this.getTag().clearGroup(Ul(t)),this.clearNames(t)},e.prototype.clearTag=function(){this.tag=void 0},e}(),WA=/&/g,YA=/^\s*\/\/.*$/gm;function lv(e,t){return e.map(function(r){return r.type==="rule"&&(r.value="".concat(t," ").concat(r.value),r.value=r.value.replaceAll(",",",".concat(t," ")),r.props=r.props.map(function(o){return"".concat(t," ").concat(o)})),Array.isArray(r.children)&&r.type!=="@keyframes"&&(r.children=lv(r.children,t)),r})}function jA(e){var t,r,o,l=Lo,s=l.options,u=s===void 0?Lo:s,d=l.plugins,f=d===void 0?Pu:d,g=function(y,w,A){return A.startsWith(r)&&A.endsWith(r)&&A.replaceAll(r,"").length>0?".".concat(t):y},m=f.slice();m.push(function(y){y.type===Eu&&y.value.includes("&")&&(y.props[0]=y.props[0].replace(WA,r).replace(o,g))}),u.prefix&&m.push(vA),m.push(gA);var S=function(y,w,A,I){w===void 0&&(w=""),A===void 0&&(A=""),I===void 0&&(I="&"),t=I,r=w,o=new RegExp("\\".concat(r,"\\b"),"g");var C=y.replace(YA,""),F=fA(A||w?"".concat(A," ").concat(w," { ").concat(C," }"):C);u.namespace&&(F=lv(F,u.namespace));var B=[];return cu(F,pA(m.concat(mA(function(D){return B.push(D)})))),B};return S.hash=f.length?f.reduce(function(y,w){return w.name||ya(15),Co(y,w.name)},ev).toString():"",S}var VA=new hu,Sf=jA(),uv=Jn.createContext({shouldForwardProp:void 0,styleSheet:VA,stylis:Sf});uv.Consumer;Jn.createContext(void 0);function yf(){return Re.useContext(uv)}var XA=function(){function e(t,r){var o=this;this.inject=function(l,s){s===void 0&&(s=Sf);var u=o.name+s.hash;l.hasNameForId(o.id,u)||l.insertRules(o.id,u,s(o.rules,u,"@keyframes"))},this.name=t,this.id="sc-keyframes-".concat(t),this.rules=r,xf(this,function(){throw ya(12,String(o.name))})}return e.prototype.getName=function(t){return t===void 0&&(t=Sf),this.name+t.hash},e}(),KA=function(e){return e>="A"&&e<="Z"};function Nm(e){for(var t="",r=0;r<e.length;r++){var o=e[r];if(r===1&&o==="-"&&e[0]==="-")return e;KA(o)?t+="-"+o.toLowerCase():t+=o}return t.startsWith("ms-")?"-"+t:t}var cv=function(e){return e==null||e===!1||e===""},dv=function(e){var t,r,o=[];for(var l in e){var s=e[l];e.hasOwnProperty(l)&&!cv(s)&&(Array.isArray(s)&&s.isCss||Bo(s)?o.push("".concat(Nm(l),":"),s,";"):sa(s)?o.push.apply(o,oa(oa(["".concat(l," {")],dv(s),!1),["}"],!1)):o.push("".concat(Nm(l),": ").concat((t=l,(r=s)==null||typeof r=="boolean"||r===""?"":typeof r!="number"||r===0||t in SA||t.startsWith("--")?String(r).trim():"".concat(r,"px")),";")))}return o};function tr(e,t,r,o){if(cv(e))return[];if(Gf(e))return[".".concat(e.styledComponentId)];if(Bo(e)){if(!Bo(s=e)||s.prototype&&s.prototype.isReactComponent||!t)return[e];var l=e(t);return tr(l,t,r,o)}var s;return e instanceof XA?r?(e.inject(r,o),[e.getName(o)]):[e]:sa(e)?dv(e):Array.isArray(e)?Array.prototype.concat.apply(Pu,e.map(function(u){return tr(u,t,r,o)})):[e.toString()]}function fv(e){for(var t=0;t<e.length;t+=1){var r=e[t];if(Bo(r)&&!Gf(r))return!1}return!0}var ZA=tv(Ru),qA=function(){function e(t,r,o){this.rules=t,this.staticRulesId="",this.isStatic=(o===void 0||o.isStatic)&&fv(t),this.componentId=r,this.baseHash=Co(ZA,r),this.baseStyle=o,hu.registerId(r)}return e.prototype.generateAndInjectStyles=function(t,r,o){var l=this.baseStyle?this.baseStyle.generateAndInjectStyles(t,r,o):"";if(this.isStatic&&!o.hash)if(this.staticRulesId&&r.hasNameForId(this.componentId,this.staticRulesId))l=Pr(l,this.staticRulesId);else{var s=mf(tr(this.rules,t,r,o)),u=pf(Co(this.baseHash,s)>>>0);if(!r.hasNameForId(this.componentId,u)){var d=o(s,".".concat(u),void 0,this.componentId);r.insertRules(this.componentId,u,d)}l=Pr(l,u),this.staticRulesId=u}else{for(var f=Co(this.baseHash,o.hash),g="",m=0;m<this.rules.length;m++){var S=this.rules[m];if(typeof S=="string")g+=S;else if(S){var y=mf(tr(S,t,r,o));f=Co(f,y+m),g+=y}}if(g){var w=pf(f>>>0);r.hasNameForId(this.componentId,w)||r.insertRules(this.componentId,w,o(g,".".concat(w),void 0,this.componentId)),l=Pr(l,w)}}return l},e}(),$f=Jn.createContext(void 0);$f.Consumer;var Fd={};function QA(e,t,r){var o=Gf(e),l=e,s=!kd(e),u=t.attrs,d=u===void 0?Pu:u,f=t.componentId,g=f===void 0?function(H,b){var U=typeof H!="string"?"sc":Im(H);Fd[U]=(Fd[U]||0)+1;var $="".concat(U,"-").concat(nv(Ru+U+Fd[U]));return b?"".concat(b,"-").concat($):$}(t.displayName,t.parentComponentId):f,m=t.displayName,S=m===void 0?function(H){return kd(H)?"styled.".concat(H):"Styled(".concat(wA(H),")")}(e):m,y=t.displayName&&t.componentId?"".concat(Im(t.displayName),"-").concat(t.componentId):t.componentId||g,w=o&&l.attrs?l.attrs.concat(d).filter(Boolean):d,A=t.shouldForwardProp;if(o&&l.shouldForwardProp){var I=l.shouldForwardProp;if(t.shouldForwardProp){var C=t.shouldForwardProp;A=function(H,b){return I(H,b)&&C(H,b)}}else A=I}var F=new qA(r,y,o?l.componentStyle:void 0);function B(H,b){return function(U,$,ee){var _e=U.attrs,Ce=U.componentStyle,be=U.defaultProps,De=U.foldedComponentIds,Pe=U.styledComponentId,de=U.target,Ue=Jn.useContext($f),Te=yf(),ne=U.shouldForwardProp||Te.shouldForwardProp,W=Q0($,Ue,be)||Lo,X=function(Se,le,Ee){for(var Ae,Z=Ut(Ut({},le),{className:void 0,theme:Ee}),re=0;re<Se.length;re+=1){var Le=Bo(Ae=Se[re])?Ae(Z):Ae;for(var ge in Le)Z[ge]=ge==="className"?Pr(Z[ge],Le[ge]):ge==="style"?Ut(Ut({},Z[ge]),Le[ge]):Le[ge]}return le.className&&(Z.className=Pr(Z.className,le.className)),Z}(_e,$,W),j=X.as||de,P={};for(var L in X)X[L]===void 0||L[0]==="$"||L==="as"||L==="theme"&&X.theme===W||(L==="forwardedAs"?P.as=X.forwardedAs:ne&&!ne(L,j)||(P[L]=X[L]));var K=function(Se,le){var Ee=yf(),Ae=Se.generateAndInjectStyles(le,Ee.styleSheet,Ee.stylis);return Ae}(Ce,X),ie=Pr(De,Pe);return K&&(ie+=" "+K),X.className&&(ie+=" "+X.className),P[kd(j)&&!J0.has(j)?"class":"className"]=ie,P.ref=ee,Re.createElement(j,P)}(D,H,b)}B.displayName=S;var D=Jn.forwardRef(B);return D.attrs=w,D.componentStyle=F,D.displayName=S,D.shouldForwardProp=A,D.foldedComponentIds=o?Pr(l.foldedComponentIds,l.styledComponentId):"",D.styledComponentId=y,D.target=o?l.target:e,Object.defineProperty(D,"defaultProps",{get:function(){return this._foldedDefaultProps},set:function(H){this._foldedDefaultProps=o?function(b){for(var U=[],$=1;$<arguments.length;$++)U[$-1]=arguments[$];for(var ee=0,_e=U;ee<_e.length;ee++)vf(b,_e[ee],!0);return b}({},l.defaultProps,H):H}}),xf(D,function(){return".".concat(D.styledComponentId)}),s&&sv(D,e,{attrs:!0,componentStyle:!0,displayName:!0,foldedComponentIds:!0,shouldForwardProp:!0,styledComponentId:!0,target:!0}),D}function Dm(e,t){for(var r=[e[0]],o=0,l=t.length;o<l;o+=1)r.push(t[o],e[o+1]);return r}var Om=function(e){return Object.assign(e,{isCss:!0})};function hv(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];if(Bo(e)||sa(e))return Om(tr(Dm(Pu,oa([e],t,!0))));var o=e;return t.length===0&&o.length===1&&typeof o[0]=="string"?tr(o):Om(tr(Dm(o,t)))}function Tf(e,t,r){if(r===void 0&&(r=Lo),!t)throw ya(1,t);var o=function(l){for(var s=[],u=1;u<arguments.length;u++)s[u-1]=arguments[u];return e(t,r,hv.apply(void 0,oa([l],s,!1)))};return o.attrs=function(l){return Tf(e,t,Ut(Ut({},r),{attrs:Array.prototype.concat(r.attrs,l).filter(Boolean)}))},o.withConfig=function(l){return Tf(e,t,Ut(Ut({},r),l))},o}var gv=function(e){return Tf(QA,e)},In=gv;J0.forEach(function(e){In[e]=gv(e)});var JA=function(){function e(t,r){this.rules=t,this.componentId=r,this.isStatic=fv(t),hu.registerId(this.componentId+1)}return e.prototype.createStyles=function(t,r,o,l){var s=l(mf(tr(this.rules,r,o,l)),""),u=this.componentId+t;o.insertRules(u,u,s)},e.prototype.removeStyles=function(t,r){r.clearRules(this.componentId+t)},e.prototype.renderStyles=function(t,r,o,l){t>2&&hu.registerId(this.componentId+t),this.removeStyles(t,o),this.createStyles(t,r,o,l)},e}();function eI(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];var o=hv.apply(void 0,oa([e],t,!1)),l="sc-global-".concat(nv(JSON.stringify(o))),s=new JA(o,l),u=function(f){var g=yf(),m=Jn.useContext($f),S=Jn.useRef(g.styleSheet.allocateGSInstance(l)).current;return g.styleSheet.server&&d(S,f,g.styleSheet,m,g.stylis),Jn.useLayoutEffect(function(){if(!g.styleSheet.server)return d(S,f,g.styleSheet,m,g.stylis),function(){return s.removeStyles(S,g.styleSheet)}},[S,f,g.styleSheet,m,g.stylis]),null};function d(f,g,m,S,y){if(s.isStatic)s.renderStyles(f,TA,m,y);else{var w=Ut(Ut({},g),{theme:Q0(g,S,u.defaultProps)});s.renderStyles(f,w,m,y)}}return Jn.memo(u)}function pv(e,t){var r=Re.useRef(null),o=Re.useRef(!1),l=Re.useRef(e);l.current=e;var s=Re.useCallback(function(d){o.current&&(l.current(d),r.current=requestAnimationFrame(s))},[]),u=Re.useMemo(function(){return[function(){o.current&&(o.current=!1,r.current&&cancelAnimationFrame(r.current))},function(){o.current||(o.current=!0,r.current=requestAnimationFrame(s))},function(){return o.current}]},[]);return Re.useEffect(function(){return u[0]},[]),u}function tI(e,t,r,o,l){var u;(u=e.onExit)==null||u.call(e,o,t);const s=l.find(({id:d})=>d===t);return s!=null&&s.onEnter?s.onEnter(o,r):{...r,enteredAt:o.updateContext.gameState.time}}function nI(e,t){return t.find(({id:r})=>r===e)}function iI(e,t){return e!==t}function rI(e){console.warn(`No handler found for state: ${e}`)}const qs="bushGrowing",Rr="bushFull",au="bushSpreading",aa="bushDying",It=24,Et=10,et=3e3,tt=3e3,zf=2,oI=15,sI=5e3,gi=100,pi=20,mi=60,aI=1e3,lI=5,uI=3,cI=12,dI=940,Af=20,Mm=90,mv=45,Br=5,fI=.5,Hr=30,vi=.1,Ys=.9;var Bn=(e=>(e.Berry="berry",e.Meat="meat",e))(Bn||{});const Wf={berry:"",meat:""},hI={id:qs,update:(e,t)=>{const{entity:r,updateContext:o}=t,l=o.deltaTime*(It/Et);return r.age+=l,r.age>=r.lifespan?{nextState:aa,data:{...e,enteredAt:o.gameState.time}}:(r.timeSinceLastBerryRegen+=l,r.timeSinceLastBerryRegen>=cI&&r.food.length<r.maxFood&&(r.food.push({type:Bn.Berry}),r.timeSinceLastBerryRegen=0),r.food.length>=r.maxFood?{nextState:Rr,data:{...e,enteredAt:o.gameState.time,previousState:qs}}:{nextState:qs,data:e})},onEnter:(e,t)=>({...t,enteredAt:e.updateContext.gameState.time})},gI={id:Rr,update:(e,t)=>{const{entity:r,updateContext:o}=t,l=o.deltaTime*(It/Et);return r.age+=l,r.age>=r.lifespan?{nextState:aa,data:{...e,enteredAt:o.gameState.time,previousState:Rr}}:r.food.length<r.maxFood?{nextState:qs,data:{...e,enteredAt:o.gameState.time,previousState:Rr}}:(r.timeSinceLastSpreadAttempt+=l,r.timeSinceLastSpreadAttempt>=Mm&&(r.timeSinceLastSpreadAttempt=0,o.gameState.time-r.timeSinceLastHarvest>=Mm&&Math.random()<o.gameState.ecosystem.berryBushSpreadChance)?{nextState:au,data:{...e,enteredAt:o.gameState.time,previousState:Rr}}:{nextState:Rr,data:e})},onEnter:(e,t)=>({...t,enteredAt:e.updateContext.gameState.time})},la=1,If=150*.6,pI=150*.25,mI=150*.7,vI=150*.8,SI=400,yI=800,vv=100,TI=250,AI=120,II=2,km=400,EI=1e3,wI=150*.85,_I=100,CI=3,RI=96,PI=24,NI=600,Sv=600,DI=1,OI=24,MI=1,kI=.5,FI=2,Ef=24,js=12,UI=24,Fm=24,LI=1500,Ud=500,BI=400,HI=10,bI=-5,GI=1.5,xI=1.5,$I=1.2,zI=10,WI=150,YI=200,jI=100,VI=.7,XI=300,KI=100,ZI=120,Um=400,yv=.15,Tv=200,lu=30*.75*1.2,qI=20,QI=.3,JI=.6,eE=.8,tE=1,nE=3,iE=5,rE=6,Lm=.5,oE=.4,sE=.6,aE=.8,lE=2,Bm=800,uE=60,Hm=5,bm=.7,Gm=2.5,xm=3,$m=2,cE=.1,dE=400,fE=800,Av=5,Iv=600,Nu=10,ua=80,hE=3,Ls=5,br=150,Ev=br*.8,gE=br*.2,Gr=br*.95,rr=30,wv=10,pE=10,mE=.5,mt=30,xr=mt*.75,_v=50,vE=20,SE=ua*.8,yE=.7,TE=16,Cv=40,AE=24,Yf=16,IE=72/3,zm=24,EE=1.25,wE=1.5,jf=br*.6,Vf=50,_E=1,CE=350,Rv=ua*.65,RE=80,PE=50,NE=1,DE=128,Pv=10,Wm=100,Xf=35,ei=mt,Nv=.5,Du=2.5,OE=5,Kf=.5,Zf=1.5,ME=.1,kE=.5,FE=1.5,UE=.25,LE=2.5,BE=45,HE=.05;function Ln(e,t){return{x:e.x+t.x,y:e.y+t.y}}function Dv(e,t){return{x:e.x-t.x,y:e.y-t.y}}function Pt(e,t){return{x:e.x*t,y:e.y*t}}function Ho(e){return Math.sqrt(e.x*e.x+e.y*e.y)}function nt(e){const t=Ho(e);return t===0?{x:0,y:0}:Pt(e,1/t)}function bE(e,t){return Ho(Dv(e,t))}function qf(e,t,r){return{x:e.x+(t.x-e.x)*r,y:e.y+(t.y-e.y)*r}}function gu(e){if(e.length===0)return{x:0,y:0};const t=e.reduce((r,o)=>({x:r.x+o.x,y:r.y+o.y}),{x:0,y:0});return{x:t.x/e.length,y:t.y/e.length}}function ze(e,t,r,o){let l=t.x-e.x,s=t.y-e.y;return Math.abs(l)>r/2&&(l=l-Math.sign(l)*r),Math.abs(s)>o/2&&(s=s-Math.sign(s)*o),{x:l,y:s}}function Ft(e,t,r){const o=ze(e,t,r.width,r.height);return nt(o)}function Y(e,t,r,o){const l=ze(e,t,r,o);return Ho(l)}function GE(e,t){return e.x*t.x+e.y*t.y}function xE(e,t){const r=GE(e,t),o=Ho(e),l=Ho(t);if(o===0||l===0)return 0;const s=Math.max(-1,Math.min(1,r/(o*l)));return Math.acos(s)}function $E(e,t,r){const o=Math.max(0,Math.min(1,r)),l={r:parseInt(e.substring(1,3),16),g:parseInt(e.substring(3,5),16),b:parseInt(e.substring(5,7),16)},s={r:parseInt(t.substring(1,3),16),g:parseInt(t.substring(3,5),16),b:parseInt(t.substring(5,7),16)},u=Math.round(l.r+(s.r-l.r)*o),d=Math.round(l.g+(s.g-l.g)*o),f=Math.round(l.b+(s.b-l.b)*o),g=m=>("00"+m.toString(16)).slice(-2);return`#${g(u)}${g(d)}${g(f)}`}var pt=(e=>(e.Friendly="Friendly",e.Hostile="Hostile",e))(pt||{}),Rt=(e=>(e[e.None=0]="None",e[e.General=1]="General",e[e.Performance=2]="Performance",e[e.Ecosystem=3]="Ecosystem",e))(Rt||{});function Ym(e,t,r){return t.search.human.byRadius(e.position,r).filter(s=>{if(s.id===e.id||s.gender===e.gender||!s.isAdult||s.hunger>=Gr||(s.procreationCooldown||0)>0||s.gender==="female"&&s.isPregnant)return!1;const u=s.id===e.motherId||s.id===e.fatherId,d=e.id===s.motherId||e.id===s.fatherId;return!u&&!d})}function Si(e){if(e.length===0)return;const t=e.filter(l=>l.gender==="male"),r=e.filter(l=>l.gender==="female"),o=(l,s)=>l.age!==s.age?s.age-l.age:l.id-s.id;if(t.sort(o),t.length>0)return t[0];if(r.sort(o),r.length>0)return r[0]}function Lt(e,t){const r=e,o=r.search.human.byProperty("motherId",t.id),l=r.search.human.byProperty("fatherId",t.id);return[...o,...l]}function zE(e,t,r){var l;if(e.id===t.id||e.motherId===t.id||e.fatherId===t.id||t.motherId===e.id||t.fatherId===e.id||e.motherId&&e.motherId===t.motherId||e.fatherId&&e.fatherId===t.fatherId||(l=e.partnerIds)!=null&&l.includes(t.id))return!0;if(e.motherId){const s=r.entities.entities[e.motherId];if(s&&(s.motherId===t.id||s.fatherId===t.id))return!0}if(e.fatherId){const s=r.entities.entities[e.fatherId];if(s&&(s.motherId===t.id||s.fatherId===t.id))return!0}if(t.motherId){const s=r.entities.entities[t.motherId];if(s&&(s.motherId===e.id||s.fatherId===e.id))return!0}if(t.fatherId){const s=r.entities.entities[t.fatherId];if(s&&(s.motherId===e.id||s.fatherId===e.id))return!0}return!1}function jm(e,t){var s,u,d,f;if(e.id===t.id||e.motherId===t.id||e.fatherId===t.id||t.motherId===e.id||t.fatherId===e.id||(s=e.partnerIds)!=null&&s.includes(t.id)||(u=t.partnerIds)!=null&&u.includes(e.id))return!0;if(e.fatherId===void 0&&e.motherId===void 0||t.fatherId===void 0&&t.motherId===void 0)return!1;const r=e.motherId===t.motherId||e.fatherId===t.fatherId,o=t.motherId===e.motherId||t.fatherId===e.fatherId,l=((d=e.ancestorIds)==null?void 0:d.some(g=>t.ancestorIds.includes(g)))||((f=t.ancestorIds)==null?void 0:f.some(g=>e.ancestorIds.includes(g)));return r||o||l}function WE(e,t){const r=[];if(e.motherId){const o=t.entities.entities[e.motherId];o&&r.push(o)}if(e.fatherId){const o=t.entities.entities[e.fatherId];o&&r.push(o)}return r}function YE(e,t){if(e.gender!=="female"||!e.partnerIds||e.partnerIds.length===0)return null;for(const r of e.partnerIds){const o=t.entities.entities[r];if(o&&o.gender==="male")return o}return null}function jE(e,t){var r;if(!e.isAdult&&e.fatherId){const o=t.entities.entities[e.fatherId];if(o&&o.type==="human")return o}if(e.isAdult&&e.fatherId){const o=t.entities.entities[e.fatherId];if(o&&o.type==="human"&&((r=Si(Lt(t,o)))==null?void 0:r.id)===e.id)return o}return e.isAdult&&e.gender==="female"&&e.partnerIds&&e.partnerIds.length>0?YE(e,t):null}function pu(e,t){var o;const r=new Set;if(e.motherId){const l=t.entities.entities[e.motherId];l&&r.add(l)}if(e.fatherId){const l=t.entities.entities[e.fatherId];l&&r.add(l)}return(o=e.partnerIds)==null||o.forEach(l=>{const s=t.entities.entities[l];s&&r.add(s)}),Lt(t,e).forEach(l=>r.add(l)),Array.from(r)}function Ov(e,t){const r=new Map;function o(l){const s=Lt(t,l);for(const u of s)r.has(u.id)||(r.set(u.id,u),o(u))}return o(e),Array.from(r.values())}function ca(e,t){return t.search.human.byProperty("leaderId",e)}function Mv(e,t){var u,d;const r=new Map,o=Object.values(e.entities.entities).filter(f=>f.type==="human");for(const f of o)f.leaderId&&(r.has(f.leaderId)||r.set(f.leaderId,{leaderId:f.leaderId,tribeBadge:f.tribeBadge||"?",members:[]}),(u=r.get(f.leaderId))==null||u.members.push(f));const l=t?(d=e.entities.entities[t])==null?void 0:d.diplomacy:void 0,s=Array.from(r.values()).map(f=>{const g=e.entities.entities[f.leaderId],m=f.members.filter(y=>y.isAdult).length,S=f.members.length-m;return{leaderId:f.leaderId,tribeBadge:f.tribeBadge,adultCount:m,childCount:S,isPlayerTribe:f.leaderId===t,leaderAge:(g==null?void 0:g.age)??0,leaderGender:(g==null?void 0:g.gender)??"male",diplomacyStatus:(l==null?void 0:l[f.leaderId??-1])??pt.Friendly}});return s.sort((f,g)=>f.isPlayerTribe?-1:g.isPlayerTribe?1:g.adultCount+g.childCount-(f.adultCount+f.childCount)),s}function Hn(e,t){return e.leaderId?t.search.human.byProperty("leaderId",e.leaderId):[]}function Qf(e,t,r,o){const l=Math.random()*Math.PI*2,s=Math.sqrt(Math.random())*t,u={x:Math.cos(l)*s,y:Math.sin(l)*s},d=Ln(e,u);return{x:(d.x%r+r)%r,y:(d.y%o+o)%o}}function bn(e,t,r,o){const l=t,s={left:e.x-r,top:e.y-r,right:e.x+r,bottom:e.y+r},u=[...l.search.human.byRect(s),...l.search.berryBush.byRect(s),...l.search.corpse.byRect(s)];for(const d of u){if(o!==void 0&&d.id===o)continue;if(Y(e,d.position,t.mapDimensions.width,t.mapDimensions.height)<r+d.radius)return!0}return!1}function VE(e,t,r,o,l){const s=t.mapDimensions.width,u=t.mapDimensions.height;if(!bn(e,t,o,l))return e;const d=o;for(let f=d;f<=r;f+=d){const g=Math.ceil(2*Math.PI*f/d);for(let m=0;m<g;m++){const S=m/g*2*Math.PI,y={x:Math.cos(S)*f,y:Math.sin(S)*f},w=Ln(e,y),A={x:(w.x%s+s)%s,y:(w.y%u+u)%u};if(!bn(A,t,o,l))return A}}return null}function $r(e,t){const r=t.search.building.byProperty("ownerId",e);if(r.length>0){const s=r.map(u=>u.position);return gu(s)}const o=ca(e,t);if(o.length===0){const s=t.entities.entities[e];return s?s.position:{x:0,y:0}}const l=o.map(s=>s.position);return gu(l)}function Vm(e,t){const o=[...pu(e,t),e].map(l=>l.position);return gu(o)}function XE(e,t,r){const o=r.mapDimensions.width,l=r.mapDimensions.height;let s=e.x-t.position.x,u=e.y-t.position.y;return Math.abs(s)>o/2&&(s-=Math.sign(s)*o),Math.abs(u)>l/2&&(u-=Math.sign(u)*l),Math.abs(s)<=t.width/2&&Math.abs(u)<=t.height/2}function KE(e,t,r){return t.search.human.byRadius(e.position,r).filter(l=>{var s;return l.activeAction==="procreating"&&l.gender===e.gender&&typeof l.target=="number"&&((s=e.partnerIds)==null?void 0:s.includes(l.target))})[0]}function ZE(e,t,r){const o=pu(e,t),l=t;for(const s of o){if(Y(e.position,s.position,t.mapDimensions.width,t.mapDimensions.height)>r)continue;const d=l.search.human.byProperty("attackTargetId",s.id);for(const f of d)if(f.leaderId!==e.leaderId)return{familyMember:s,aggressor:f}}}function qE(e,t){const o=t.search.human.byRadius(e.position,XI);let l,s=1/0;for(const u of o){if(u.id===e.id||u.hitpoints<=0||u.hitpoints/u.maxHitpoints>VI||zE(e,u,t))continue;const d=Y(e.position,u.position,t.mapDimensions.width,t.mapDimensions.height);d<s&&(s=d,l=u)}return l}function Jf(e,t,r){return t.search.human.byRadius(e.position,r).filter(l=>Vo(e,l,t))}function QE(e,t,r){const o=r.search.human.byProperty("leaderId",e);let l=0;for(const s of o)s.attackTargetId===t&&l++;return l}function Xm(e,t,r,o){const l=r.search.berryBush.byRadius(e,t),s=r.search.human.byRadius(e,t).filter(f=>f.leaderId!==o);let u=l.length*HI;u+=s.length*bI;let d;if(s.length>0){const f={};for(const m of s)m.leaderId&&(f[m.leaderId]=(f[m.leaderId]||0)+1);let g=0;for(const m in f)f[m]>g&&(g=f[m],d=parseInt(m,10))}return{score:u,occupyingTribeId:d}}function mu(e){return e.filter(t=>t.isAdult).reduce((t,r)=>{let o=r.hitpoints;return o+=(r.maxAge-r.age)*.5,o+=r.food.length*2,t+o},0)}function JE(e,t){if(e.id!==e.leaderId)return null;const r=t,o=$r(e.id,t),{score:l}=Xm(o,Ud/2,r,e.id);let s=null,u=l;const d=BI,f=LI;for(let g=e.position.x-f;g<e.position.x+f;g+=d)for(let m=e.position.y-f;m<e.position.y+f;m+=d){const S={x:(g%t.mapDimensions.width+t.mapDimensions.width)%t.mapDimensions.width,y:(m%t.mapDimensions.height+t.mapDimensions.height)%t.mapDimensions.height};if(Y(o,S,t.mapDimensions.width,t.mapDimensions.height)<Ud*2)continue;const{score:w}=Xm(S,Ud/2,r,e.id);w>u*GI&&(u=w,s=S)}return s}function Ne(e,t,r,o,l){const s=t,u=o,d="position"in e&&e.id?e:null,f=d?d.position:e,g=s.search[r].byRadius(f,u);let m=null,S=u;for(const y of g){if(y.id===(d==null?void 0:d.id)||l&&!l(y))continue;const w=Y(f,y.position,t.mapDimensions.width,t.mapDimensions.height);w<S&&(S=w,m=y)}return m}function ew(e,t,r,o){return t.search[r].byRadius(e,o)}function Km(e,t,r,o){return ew(e,t,r,o).length}function vt(e){const r=e.search.human.byProperty("isPlayer",!0);return r.length>0?r[0]:void 0}function tw(e,t){var u;const o=t.search.human.byProperty("activeAction","attacking");let l=null,s=1/0;for(const d of o){if(d.attackTargetId!==e)continue;const f=Y(d.position,((u=t.entities.entities[e])==null?void 0:u.position)||{x:0,y:0},t.mapDimensions.width,t.mapDimensions.height);f<s&&(l=d,s=f)}return l}function kv(e){return Object.values(e.entities.entities).filter(t=>t.type==="human")}function nw(e,t,r){const o=Object.values(t.entities.entities).reverse();for(const l of o)if(bE(e,l.position)<l.radius)return l}function iw(e,t,r,o){const l=kv(o),s={};for(const u of l)!u.leaderId||u.leaderId===t||(s[u.leaderId]||(s[u.leaderId]={sumX:0,sumY:0,count:0}),s[u.leaderId].sumX+=u.position.x,s[u.leaderId].sumY+=u.position.y,s[u.leaderId].count++);for(const u in s){const d=s[u],f={x:d.sumX/d.count,y:d.sumY/d.count};if(Y(e,f,o.mapDimensions.width,o.mapDimensions.height)<r)return!0}return!1}const wt=30,jo=wt*.6,Fv="#4CAF50",Uv="#FF5722",Lv="#9C27B0",rw="#2196F3",Bv="#FFC107",ow="#DC143C",eh="#FFFFFF",th=[5,5],Ou=5,bo=15,sw=20,aw=16,lw=10,uw=16,cw=16,Zm=["","","","","","","","","",""],wf=8,dw="#FFFFFF",Sn=18,Ze=15,fw="rgba(0, 0, 0, 0.7)",hw=4,Gi=150,rn=15,ui=10,qi="#555",gw="#f44336",pw="#4CAF50",mw="#2196F3",vw="#FFC107",Ll=16,Ar=32,Bl=28,Sw=10,yw=8,Tw=8,Aw=8,mn=28,Hl=40,Iw="rgba(255, 215, 0, 0.7)",Ew="rgba(0, 0, 0, 0.3)",Kn=10,qm=8,Ld=11,xi=20,Bd=40,Qm=5,ww=10,_w="#FFA500",Cw="#808080",hi=120,Hv=30,Rw=20,Xi="#2d3748",yn="#ffffff",bl="#4a5568",bv=5,nh="#bdc9f792",Gv="#272c36ff",xv="#a0aec0",vu=300,$v="rgba(255, 255, 255, 0.5)",Pw="rgba(0, 0, 0, 0.8)",Nw="#FFFFFF",Jm=14,e0=8,t0=-15,zv="#FFD700",Wv=5,Dw=60,Ow=-50,Mw=10,Hd=12,n0=10,kw="rgba(0, 0, 0, 0.5)",Fw="#4CAF50",Uw="#F44336",Lw="#FFC107",Bw="rgba(255, 255, 255, 0.2)",i0="#FFFFFF",Hw="#FF6B6B",bw=5,Yv=30,Bs=50,Gl=8,r0=10,Gw="rgba(0, 0, 0, 0.5)",xw="#FFFFFF",$w=33,zw=400,Ww=20,Yw=10,jw="rgba(0, 0, 0, 0.7)",Vw="#FFFFFF",bd=20,o0=16,Xw=.5,s0=5,jv="#FFD700",Kw=40,ih=4,Vv=3,Zw=5,Xv=20,Kv=5,qw="#FFFFFF",Qw="#FF6B6B",on=80,Ir=10,xl=300,Er=15,Jw=8,e_="rgba(0, 0, 0, 0.8)",t_="#FFFFFF",Gd=14,a0=10,Zn=20,n_="#FF6B6B",i_="#4CAF50",l0="#FFD700",r_="rgba(255, 255, 0, 0.3)",o_=2,s_=500,a_=120,l_=45,u_="#FFD700",c_=3,d_=4;let xd=0;function _f(){const e=Zm[xd];return xd=(xd+1)%Zm.length,e}const u0=20,f_=.3,h_=24,c0=250,Go=10,Zv=250,da=12,qv=10;var ae=(e=>(e.Gather="Gather",e.Eat="Eat",e.Procreate="Procreate",e.Attack="Attack",e.Plant="Plant",e.CallToAttack="CallToAttack",e.TribeSplit="TribeSplit",e.FollowMe="FollowMe",e.FeedChild="FeedChild",e.HuntPrey="HuntPrey",e.DefendAgainstPredator="DefendAgainstPredator",e.Build="Build",e.Removal="Removal",e.Deposit="Deposit",e.Retrieve="Retrieve",e.TakeOverBuilding="TakeOverBuilding",e.RemoveEnemyBuilding="RemoveEnemyBuilding",e.AutopilotMove="AutopilotMove",e.AutopilotGather="AutopilotGather",e.AutopilotAttack="AutopilotAttack",e.AutopilotProcreate="AutopilotProcreate",e.AutopilotPlant="AutopilotPlant",e.AutopilotFeedChild="AutopilotFeedChild",e.AutopilotFollowMe="AutopilotFollowMe",e.AutopilotDeposit="AutopilotDeposit",e.AutopilotRetrieve="AutopilotRetrieve",e))(ae||{});const Mu={Gather:"",Eat:"",Procreate:"",Attack:"",Plant:"",CallToAttack:"",TribeSplit:"",FollowMe:"",FeedChild:"",HuntPrey:"",DefendAgainstPredator:"",Build:"",Removal:"",Deposit:"",Retrieve:"",TakeOverBuilding:"",RemoveEnemyBuilding:"",AutopilotMove:"",AutopilotGather:"",AutopilotAttack:"",AutopilotProcreate:"",AutopilotPlant:"",AutopilotFeedChild:"",AutopilotFollowMe:"",AutopilotDeposit:"",AutopilotRetrieve:""},Qv={Gather:"Gather",Eat:"Eat",Procreate:"Procreate",Attack:"Attack",Plant:"Plant",CallToAttack:"Call to Attack",TribeSplit:"Split Tribe",FollowMe:"Follow Me",FeedChild:"Feed Child",HuntPrey:"Hunt Prey",DefendAgainstPredator:"Defend",Build:"Build",Removal:"Remove",Deposit:"Deposit",Retrieve:"Retrieve",TakeOverBuilding:"Take Over",RemoveEnemyBuilding:"Destroy Enemy Building",AutopilotMove:"Walk",AutopilotGather:"Gather",AutopilotAttack:"Attack",AutopilotProcreate:"Procreate",AutopilotPlant:"Plant",AutopilotFeedChild:"Feed",AutopilotFollowMe:"Follow",AutopilotDeposit:"Deposit",AutopilotRetrieve:"Retrieve"};var Eo=(e=>(e.Time="Time",e.Hunger="Hunger",e.Hitpoints="Hitpoints",e.Food="Food",e.Autopilot="Autopilot",e.Muted="Muted",e.Family="Family",e.Tribes="Tribes",e))(Eo||{});const Hs={Time:"",Hunger:"",Hitpoints:"",Food:"",Autopilot:"",Muted:"",Family:"",Tribes:""};var pe=(e=>(e.ToggleMute="ToggleMute",e.TogglePause="TogglePause",e.FastForward="FastForward",e.DismissTutorial="DismissTutorial",e.ReturnToIntro="ReturnToIntro",e.ConfirmExitYes="ConfirmExitYes",e.ConfirmExitNo="ConfirmExitNo",e.CommandEat="CommandEat",e.CommandPlant="CommandPlant",e.CommandCallToAttack="CommandCallToAttack",e.CommandFollowMe="CommandFollowMe",e.CommandGather="CommandGather",e.CommandTribeSplit="CommandTribeSplit",e.CommandBuild="CommandBuild",e.SelectStorageSpot="SelectStorageSpot",e.SelectPlantingZone="SelectPlantingZone",e.SelectRemovalTool="SelectRemovalTool",e.ToggleProcreationBehavior="ToggleProcreationBehavior",e.ToggleAttackBehavior="ToggleAttackBehavior",e.ToggleFeedChildBehavior="ToggleFeedChildBehavior",e.TogglePlantingBehavior="TogglePlantingBehavior",e.ToggleGatheringBehavior="ToggleGatheringBehavior",e.ToggleAutopilotFollowLeaderBehavior="ToggleAutopilotFollowLeaderBehavior",e.ToggleDiplomacy="ToggleDiplomacy",e))(pe||{});const g_=12,p_=24,m_=150*.9,v_=24;var fa=(e=>(e.Hello="HELLO",e.NewTribeFormed="NEW_TRIBE_FORMED",e.NoHeir="NO_HEIR",e.ChildrenStarving="CHILDREN_STARVING",e))(fa||{});let S_=0;function y_(){return`notification-${Date.now()}-${S_++}`}function Cf(e,t){if(t.identifier){const o=e.notifications.find(l=>l.identifier===t.identifier);if(o){if(o.dismissedUntil&&e.time<o.dismissedUntil)return;o.message=t.message,o.timestamp=e.time,o.creationTime=Date.now(),o.duration=t.duration,o.targetEntityIds=t.targetEntityIds,o.highlightedEntityIds=t.highlightedEntityIds,o.targetPosition=t.targetPosition,o.targetArea=t.targetArea,o.targetRadius=t.targetRadius,o.isDismissed=!1,o.dismissedUntil=void 0;return}}const r={...t,id:y_(),timestamp:e.time,creationTime:Date.now(),isDismissed:!1};e.notifications.push(r)}function T_(e,t){const r=e.notifications.find(o=>o.id===t);r&&(r.isDismissed=!0,r.identifier&&(r.dismissedUntil=e.time+v_))}function A_(e){const t=e.time;e.notifications=e.notifications.filter(r=>r.duration===0?!0:!(t-r.timestamp>r.duration))}function I_(e){for(const r of Object.values(e.entities.entities))r.isHighlighted=!1;const t=e.notifications.filter(r=>!r.isDismissed);for(const r of t)if(r.highlightedEntityIds)for(const o of r.highlightedEntityIds){const l=e.entities.entities[o];l&&(l.isHighlighted=!0)}}const d0=600,E_=1.5,Jv=.1,$l=""+new URL("attack-D4MA8VWK.mp3",import.meta.url).href,$d=""+new URL("gather-CU75596W.mp3",import.meta.url).href,w_=""+new URL("eat-DCjHq2QD.mp3",import.meta.url).href,zd=""+new URL("procreate-CfE4r5Cp.mp3",import.meta.url).href,__=""+new URL("birth-Cbd67GHT.mp3",import.meta.url).href,C_=""+new URL("child-fed-DzEPuMid.mp3",import.meta.url).href,R_=""+new URL("human-death-B6HFLXES.mp3",import.meta.url).href,P_=""+new URL("game-over-C5dqkyER.mp3",import.meta.url).href,N_=""+new URL("button-click-DomLUeaU.mp3",import.meta.url).href,D_=""+new URL("soundtrack-1-BdlYUGye.mp3",import.meta.url).href;var fe=(e=>(e[e.Attack=0]="Attack",e[e.Gather=1]="Gather",e[e.Eat=2]="Eat",e[e.Procreate=3]="Procreate",e[e.Birth=4]="Birth",e[e.ChildFed=5]="ChildFed",e[e.HumanDeath=6]="HumanDeath",e[e.Seize=7]="Seize",e[e.CallToAttack=8]="CallToAttack",e[e.TribeSplit=9]="TribeSplit",e[e.CallToFollow=10]="CallToFollow",e[e.StorageDeposit=11]="StorageDeposit",e[e.StorageRetrieve=12]="StorageRetrieve",e[e.StorageSteal=13]="StorageSteal",e[e.GameOver=14]="GameOver",e[e.ButtonClick=15]="ButtonClick",e[e.SoundTrack1=16]="SoundTrack1",e))(fe||{});const O_=new Map([[0,$l],[1,$d],[2,w_],[3,zd],[4,__],[5,C_],[6,R_],[14,P_],[15,N_],[7,$l],[8,$l],[9,zd],[10,zd],[11,$d],[12,$d],[13,$l],[16,D_]]);let bs,ha;function M_(){if(!(typeof window>"u"))return ha}function rh(){if(!(typeof window>"u"))return!bs&&typeof window.AudioContext=="function"&&(bs=new window.AudioContext,ha=bs.createGain(),ha.connect(bs.destination),Qs(.1,!1)),bs}function Qs(e,t){ha&&(ha.gain.value=t?0:e/10)}const eS=new Map;let zl=!1,f0=!1;async function k_(){if(f0||zl)return;const e=rh();if(!e){console.error("AudioContext not supported. Cannot load sounds.");return}e.state==="suspended"&&e.resume(),zl=!0,console.log("Starting sound loading...");const t=[];O_.forEach((r,o)=>{const l=fetch(r).then(s=>{if(!s.ok)throw new Error(`Failed to fetch sound: ${r}`);return s.arrayBuffer()}).then(s=>e.decodeAudioData(s)).then(s=>{eS.set(o,s)}).catch(s=>{console.error(`Error loading sound ${fe[o]} from ${r}:`,s)});t.push(l)});try{await Promise.all(t),f0=!0,zl=!1,console.log("All sounds loaded successfully.")}catch(r){zl=!1,console.error("An error occurred while loading sounds:",r)}}const Js=new Map;function oh(e,t){const r=rh(),o=M_();if(!r||!o||o.gain.value===0&&(t==null?void 0:t.trackId)===void 0)return;r.state==="suspended"&&r.resume();const l=eS.get(e);if(!l){console.warn(`Sound buffer not found for type: ${fe[e]}`);return}if(t!=null&&t.trackId&&Js.has(t.trackId))return;const s=r.createBufferSource();s.buffer=l,s.loop=(t==null?void 0:t.loop)??!1;const u=r.createGain(),d=r.createStereoPanner();let f=u;if(t!=null&&t.position&&(t!=null&&t.listenerPosition)&&(t!=null&&t.worldDimensions)){const g=ze(t.listenerPosition,t.position,t.worldDimensions.width,t.worldDimensions.height),m=Y(t.listenerPosition,t.position,t.worldDimensions.width,t.worldDimensions.height);if(m>d0)return;const S=1-Math.pow(m/d0,E_);u.gain.value=Math.max(0,S);const y=Math.sin(g.x/m*(Math.PI/2));d.pan.value=isNaN(y)?0:y,u.connect(d),f=d}else{const g=e===fe.GameOver?.4:e===fe.SoundTrack1?1:.2;u.gain.value=g}s.connect(f),f.connect(o),s.start(0),t!=null&&t.trackId&&(Js.set(t.trackId,{sourceNode:s,gainNode:u}),s.onended=()=>{Js.delete(t.trackId)})}function Wd(e,t=1){const r=Js.get(e),o=rh();if(r&&o){const{sourceNode:l,gainNode:s}=r,u=o.currentTime;s.gain.setValueAtTime(s.gain.value,u),s.gain.linearRampToValueAtTime(0,u+t),l.stop(u+t),l.onended=null,Js.delete(e)}}function Ie(e,t,r){const o=vt(e.gameState);o&&oh(t,{position:r,listenerPosition:o.position,worldDimensions:e.gameState.mapDimensions,masterVolume:e.gameState.masterVolume,isMuted:e.gameState.isMuted})}function F_(e,t,r){const o=r.mapDimensions.width,l=r.mapDimensions.height,s=t.radius*2;for(let u=c0;u<o/2;u+=50)for(let d=0;d<10;d++){const f=Qf(e,u,o,l);if(!(Y(e,f,o,l)<c0)&&!bn(f,r,s,t.id))return f}return null}function sh(e,t){if(!e.isAdult||e.gender!=="male"||e.leaderId===e.id||!e.leaderId)return{canSplit:!1};if(!e.leaderId)return{canSplit:!1};const r=t.entities.entities[e.leaderId];if(!r||r.type!=="human")return{canSplit:!1};const o=Si(Lt(t,r));if(o&&o.id===e.id)return{canSplit:!1};const l=ca(e.leaderId,t).filter(f=>f.isAdult);if(l.length<u0)return{canSplit:!1};const u=Ov(e,t).filter(f=>f.isAdult).length+1,d=Math.min(l.length*f_,u0);return{canSplit:u>=d,progress:u/d}}function ah(e,t){if(!sh(e,t).canSplit)return;const r=e.leaderId?t.entities.entities[e.leaderId]:void 0,o=_f(),l=Ov(e,t);e.leaderId=e.id,e.tribeBadge=o,e.diplomacy={},r&&r.diplomacy&&(r.diplomacy[e.id]=pt.Hostile);for(const u of l)u.leaderId=e.id,u.tribeBadge=o;Cf(t,{type:fa.NewTribeFormed,message:`A new tribe has formed! ${o}`,duration:p_,targetEntityIds:[e.id],highlightedEntityIds:[e.id,...l.map(u=>u.id)]}),Ie({gameState:t},fe.TribeSplit,e.position)}const Vo=(e,t,r)=>{var o,l;return e.id===t.id?!1:e.leaderId&&!t.leaderId?!0:e.leaderId===t.leaderId?!1:e.leaderId&&t.leaderId?((l=(o=r.entities.entities[e.leaderId])==null?void 0:o.diplomacy)==null?void 0:l[t.leaderId])===pt.Hostile:!1},Fn=(e,t,r)=>{var l,s;return!e.leaderId||!t.ownerId||t.ownerId===e.leaderId?!1:((s=(l=r.entities.entities[e.leaderId])==null?void 0:l.diplomacy)==null?void 0:s[t.ownerId])===pt.Hostile},zr=(e,t,r)=>{if(e.id===t.id||e.gender===t.gender||!e.isAdult||!t.isAdult||e.hunger>=Gr||t.hunger>=Gr||(e.procreationCooldown||0)>0||(t.procreationCooldown||0)>0||Vo(e,t,r))return!1;const o=e.gender==="female"?e:t;return!(o.isPregnant||o.age>Cv)},U_=20,An=30,L_=.5,B_=.3,H_=2,Rf=50;function lh(e,t){const r=[];if(t.food.length>0&&t.hunger>rr&&r.push({type:ae.Eat,action:"eating",key:"f"}),t.food.length<t.maxFood){const s=Ne(t,e,"berryBush",mt,f=>f.food.length>0),u=Ne(t,e,"corpse",mt,f=>f.food.length>0);let d=null;s&&u?d=Y(t.position,s.position,e.mapDimensions.width,e.mapDimensions.height)<=Y(t.position,u.position,e.mapDimensions.width,e.mapDimensions.height)?s:u:d=s||u,d&&r.push({type:ae.Gather,action:"gathering",key:"e",targetEntity:d})}const o=Ne(t,e,"human",mt,s=>zr(t,s,e));if(o&&r.push({type:ae.Procreate,action:"procreating",key:"r",targetEntity:o}),t.food.length>0&&t.isAdult){const s=Ne(t,e,"human",mt,u=>{const d=u;return!d.isAdult&&(d.motherId===t.id||d.fatherId===t.id)&&d.hunger>=rr});s&&r.push({type:ae.FeedChild,action:"feeding",key:"h",targetEntity:s})}const l=Ne(t,e,"human",ei,s=>Vo(t,s,e))??Ne(t,e,"predator",ei)??Ne(t,e,"prey",ei);if(l&&r.push({type:ae.Attack,action:"attacking",key:"q",targetEntity:l}),t.food.filter(s=>s.type===Bn.Berry).length>=Br&&r.push({type:ae.Plant,action:"planting",key:"b"}),t.food.length>0&&t.isAdult){const s=Ne(t,e,"building",An,u=>{const d=u;return d.buildingType==="storageSpot"&&d.ownerId===t.leaderId&&d.isConstructed&&d.storedFood!==void 0&&d.storageCapacity!==void 0&&d.storedFood.length<d.storageCapacity});s&&r.push({type:ae.Deposit,action:"idle",key:"x",targetEntity:s})}if(t.food.length<t.maxFood&&t.isAdult){const s=Ne(t,e,"building",An,u=>{const d=u;return d.buildingType==="storageSpot"&&d.ownerId===t.leaderId&&d.isConstructed&&d.storedFood!==void 0&&d.storedFood.length>0});s&&r.push({type:ae.Retrieve,action:"idle",key:"z",targetEntity:s})}return t.leaderId===t.id&&!t.isCallingToAttack&&Jf(t,e,Zv).length>0&&r.push({type:ae.CallToAttack,action:"idle",key:"v"}),sh(t,e).canSplit&&r.push({type:ae.TribeSplit,action:"idle",key:"k"}),t.leaderId===t.id&&!t.isCallingToFollow&&r.push({type:ae.FollowMe,action:"idle",key:"c"}),r}const On={StorageSpot:"storageSpot",PlantingZone:"plantingZone"},Ta={[On.StorageSpot]:{name:"Storage Spot",description:"A designated area for storing excess food.",icon:"",dimensions:{width:40,height:40},constructionTimeHours:.1,destructionTimeHours:.1,cost:{}},[On.PlantingZone]:{name:"Planting Zone",description:"An area marked for agricultural use.",icon:"",dimensions:{width:60,height:60},constructionTimeHours:.1,destructionTimeHours:.1,cost:{}}},b_=.5,G_="#FFA500",x_="#FF4500",h0=4,$_=10;function tS(e){return Ta[e].dimensions}function z_(e){return Ta[e].constructionTimeHours}function W_(e){return Ta[e].destructionTimeHours}function uh(e,t,r,o){if(r===void 0)return!1;const l=tS(t),s=Math.sqrt(l.width*l.width+l.height*l.height)/2;if(bn(e,o,s*.8))return!1;const d=o.search.building.byRadius(e,s*2);for(const f of d){const g=Y(e,f.position,o.mapDimensions.width,o.mapDimensions.height),m=(Math.max(l.width,l.height)+Math.max(f.width,f.height))/2;if(g<m*.9)return!1}return!0}function nS(e,t,r,o){return RR(o.entities,e,t,r)}function Y_(e,t){const r=t.entities.entities[e];r&&r.type==="building"&&!r.isBeingDestroyed&&(r.isBeingDestroyed=!0,r.destructionProgress=0)}function j_(e,t){const l=t.search.building.byRadius(e,100);for(const s of l){let u=e.x-s.position.x,d=e.y-s.position.y;const f=t.mapDimensions.width,g=t.mapDimensions.height;if(Math.abs(u)>f/2&&(u-=Math.sign(u)*f),Math.abs(d)>g/2&&(d-=Math.sign(d)*g),Math.abs(u)<=s.width/2&&Math.abs(d)<=s.height/2)return s}}const V_=500,X_=500;function K_(e,t){if(!e.leaderId)return 0;const r=Z_(e.leaderId,t),o=q_(e.leaderId,t);return o===0?0:Math.min(1,r/o)}function Z_(e,t){const r=Hn({leaderId:e},t),o=Aa(e,t),l=r.reduce((u,d)=>u+d.food.length,0),s=o.reduce((u,d)=>{var f;return u+(((f=d.storedFood)==null?void 0:f.length)||0)},0);return l+s}function q_(e,t){const r=Hn({leaderId:e},t),o=Aa(e,t),l=r.reduce((u,d)=>u+d.maxFood,0),s=o.reduce((u,d)=>u+(d.storageCapacity||0),0);return l+s}function iS(e,t){const r=Aa(e,t);if(r.length===0)return 0;const o=r.reduce((s,u)=>{var d;return s+(((d=u.storedFood)==null?void 0:d.length)||0)},0),l=r.reduce((s,u)=>s+(u.storageCapacity||0),0);return l===0?0:Math.min(1,o/l)}function rS(e,t){const r=Hn({leaderId:e},t);return r.length===0?0:Q_(e,t)/r.length}function Q_(e,t){const r=t,o=$r(e,t);return r.search.berryBush.byRadius(o,V_).filter(u=>{const d=u.stateMachine&&u.stateMachine[0]==="bushDying",f=u.food.length>0;return!d&&f}).length}function ch(e,t){return e.leaderId?t.search.building.all().filter(l=>{if(l.buildingType!==On.PlantingZone||!l.isConstructed)return!1;if(l.ownerId){const s=t.entities.entities[l.ownerId];return s&&s.leaderId===e.leaderId}return!1}):[]}function J_(e){const t=Hr*2,r=Math.floor(e.width/t),o=Math.floor(e.height/t);return r*o}function eC(e,t){const r=t,o=Math.max(e.width,e.height);return r.search.berryBush.byRadius(e.position,o).filter(u=>{const d=Math.abs(u.position.x-e.position.x),f=Math.abs(u.position.y-e.position.y);return d<=e.width/2&&f<=e.height/2}).length}function tC(e,t){if(!e.leaderId)return[];const r=Aa(e.leaderId,t),o=Hn(e,t);return r.map(l=>{var g;const s=l.storageCapacity||0,u=((g=l.storedFood)==null?void 0:g.length)||0,d=o.filter(m=>{if(m.activeAction!=="depositing")return!1;if(typeof m.target=="object"&&"x"in m.target){const S=m.target;return Y(S,l.position,t.mapDimensions.width,t.mapDimensions.height)<=50}return!1}).length,f=Y(e.position,l.position,t.mapDimensions.width,t.mapDimensions.height);return{storage:l,capacity:s,currentFood:u,assignedDepositors:d,distance:f}})}function nC(e,t){const r=tC(e,t);if(r.length===0)return null;const o=r.filter(l=>{const s=l.currentFood<l.capacity,u=l.distance<=X_;return s&&u});return o.length===0?null:(o.sort((l,s)=>{const u=l.currentFood/l.capacity,d=s.currentFood/s.capacity;return Math.abs(u-d)>.1?u-d:l.assignedDepositors!==s.assignedDepositors?l.assignedDepositors-s.assignedDepositors:l.distance-s.distance}),o[0].storage)}function oS(e,t,r){return Hn({leaderId:e},t).filter(l=>l.activeAction===r).length}function Aa(e,t){return t.search.building.all().filter(l=>{if(l.buildingType!==On.StorageSpot||!l.isConstructed)return!1;if(l.ownerId){const s=t.entities.entities[l.ownerId];return s&&s.leaderId===e}return!1})}function iC(e,t){const r=ch(e,t);if(r.length===0)return null;const o=t.mapDimensions.width,l=t.mapDimensions.height;for(const s of r){const u=J_(s);if(eC(s,t)>=u)continue;const f=20;for(let g=0;g<f;g++){const m=s.position.x+(Math.random()-.5)*s.width,S=s.position.y+(Math.random()-.5)*s.height,y={x:(m%o+o)%o,y:(S%l+l)%l};if(!bn(y,t,Hr))return{position:y,zoneId:s.id}}}return null}function rC(e,t,r){return ch(t,r).some(s=>XE(e,s,r))?!bn(e,r,Hr):!1}const oC={id:au,update:(e,t)=>{const{entity:r,updateContext:o}=t,{gameState:l}=o,s=o.deltaTime*(It/Et);if(r.age+=s,r.age>=r.lifespan)return{nextState:aa,data:{...e,enteredAt:l.time,previousState:au}};const u=Qf(r.position,r.spreadRadius,l.mapDimensions.width,l.mapDimensions.height);return bn(u,l,15)||wa(l.entities,u,l.time),{nextState:Rr,data:{...e,enteredAt:l.time,previousState:au}}},onEnter:(e,t)=>({...t,enteredAt:e.updateContext.gameState.time})},sC={id:aa,update:e=>({nextState:aa,data:e}),onEnter:(e,t)=>(Zo(e.updateContext.gameState.entities,e.entity.id),{...t,enteredAt:e.updateContext.gameState.time})},aC=[hI,gI,oC,sC],ct="humanIdle",Cr="humanMoving",Vs="humanEating",Ia="humanGathering",ea="humanDepositing",ta="humanRetrieving",ga="humanProcreating",or="humanAttacking",uu="humanPlanting",lC={id:ct,update:(e,t)=>{const{entity:r,updateContext:o}=t;return r.activeAction==="attacking"&&r.attackTargetId?{nextState:or,data:{...e,enteredAt:o.gameState.time,previousState:ct,attackTargetId:r.attackTargetId,attackStartTime:o.gameState.time}}:(r.hunger>=Ev?(r.debuffs=r.debuffs.filter(l=>l.type!=="slow"),r.debuffs.push({type:"slow",startTime:o.gameState.time,duration:.1})):r.debuffs=r.debuffs.filter(l=>l.type!=="slow"),r.activeAction==="moving"?{nextState:Cr,data:{...e,enteredAt:o.gameState.time,previousState:ct,target:r.target}}:r.activeAction==="gathering"?{nextState:Ia,data:{...e,enteredAt:o.gameState.time,previousState:ct,target:r.target}}:r.activeAction==="eating"?{nextState:Vs,data:{...e,enteredAt:o.gameState.time,previousState:ct}}:r.activeAction==="planting"&&r.target?{nextState:uu,data:{...e,enteredAt:o.gameState.time,previousState:ct,plantingSpot:r.target}}:r.activeAction==="depositing"?{nextState:ea,data:{...e,enteredAt:o.gameState.time,previousState:ct}}:r.activeAction==="retrieving"?{nextState:ta,data:{...e,enteredAt:o.gameState.time,previousState:ct}}:{nextState:ct,data:e})},onEnter:(e,t)=>(e.entity.acceleration=0,e.entity.velocity={x:0,y:0},{...t,enteredAt:e.updateContext.gameState.time})};function sS(e){let t=pE;return e.hunger>=Ev&&(t*=mE),e.age>=SE&&(t*=yE),e.movementSlowdown&&(t*=e.movementSlowdown.modifier),t}const Yd=7.5;class uC{constructor(){Oe(this,"id",Cr)}update(t,r){var f;const{entity:o,updateContext:l}=r;if(o.activeAction==="attacking"&&o.attackTargetId)return{nextState:or,data:{...t,enteredAt:l.gameState.time,previousState:Cr,attackTargetId:o.attackTargetId,attackStartTime:l.gameState.time}};if(o.activeAction!=="moving")return{nextState:ct,data:{...t,enteredAt:l.gameState.time,previousState:Cr}};let s;if(typeof o.target=="object"?s=o.target:typeof o.target=="number"&&(s=(f=r.updateContext.gameState.entities.entities[o.target])==null?void 0:f.position),!s&&(o.direction.x!==0||o.direction.y!==0)&&(s={x:o.position.x+o.direction.x*Yd*2,y:o.position.y+o.direction.y*Yd*2}),!s)return{nextState:ct,data:{...t,enteredAt:l.gameState.time,previousState:Cr}};const u=ze(o.position,s,r.updateContext.gameState.mapDimensions.width,r.updateContext.gameState.mapDimensions.height);return o.direction=nt(u),o.acceleration=sS(o),Y(o.position,s,l.gameState.mapDimensions.width,l.gameState.mapDimensions.height)<Yd?{nextState:ct,data:{...t,enteredAt:l.gameState.time,previousState:Cr}}:{nextState:Cr,data:t}}onExit(t){const{entity:r}=t;r.acceleration=0}}const cC=new uC,xe=1,Nr=3,dC=70;function Me(e,t,r,o,l){const s={id:e.nextVisualEffectId,type:t,position:r,startTime:e.time,duration:o,entityId:l};return e.visualEffects.push(s),e.nextVisualEffectId++,s.id}var ce=(e=>(e[e.Hunger=0]="Hunger",e[e.Procreation=1]="Procreation",e[e.Pregnant=2]="Pregnant",e[e.TargetAcquired=3]="TargetAcquired",e[e.Attack=4]="Attack",e[e.Partnered=5]="Partnered",e[e.BushClaimed=6]="BushClaimed",e[e.BushClaimLost=7]="BushClaimLost",e[e.Eating=8]="Eating",e[e.ChildFed=9]="ChildFed",e[e.AttackDeflected=10]="AttackDeflected",e[e.AttackResisted=11]="AttackResisted",e[e.Hit=12]="Hit",e[e.SeizeBuildup=13]="SeizeBuildup",e[e.Seize=14]="Seize",e[e.CallToAttack=15]="CallToAttack",e[e.CallToFollow=16]="CallToFollow",e[e.AutopilotMoveTarget=17]="AutopilotMoveTarget",e))(ce||{});const fC={id:Vs,update:(e,t)=>{const{entity:r,updateContext:o}=t;return r.activeAction!=="eating"?{nextState:ct,data:{...e,enteredAt:o.gameState.time,previousState:Vs}}:(r.food.length>0&&(!r.eatingCooldownTime||o.gameState.time>=r.eatingCooldownTime)&&r.hunger>rr&&(r.hunger=Math.max(0,r.hunger-rr),r.food.pop(),r.eatingCooldownTime=o.gameState.time+1,Ie(o,fe.Eat,r.position),(!r.lastEatingEffectTime||o.gameState.time-r.lastEatingEffectTime>2)&&(Me(o.gameState,ce.Eating,r.position,xe,r.id),r.lastEatingEffectTime=o.gameState.time)),r.hunger<=0||r.food.length<=0?{nextState:ct,data:{...e,enteredAt:o.gameState.time,previousState:Vs}}:{nextState:Vs,data:e})},onEnter:(e,t)=>(e.entity.acceleration=0,e.entity.velocity={x:0,y:0},{...t,enteredAt:e.updateContext.gameState.time})};class hC{constructor(){Oe(this,"id",Ia)}update(t,r){return r.entity.activeAction!=="gathering"?{nextState:"humanIdle",data:{...t,enteredAt:r.updateContext.gameState.time,previousState:this.id}}:{nextState:this.id,data:t}}}const gC=new hC,pC={id:ea,update:(e,t)=>{const{entity:r}=t;return r.activeAction!=="depositing"?{nextState:ct,data:{...e,enteredAt:t.updateContext.gameState.time,previousState:ea}}:{nextState:ea,data:e}},onEnter:(e,t)=>{const{entity:r}=e;return r.activeAction="depositing",t},onExit:e=>{const{entity:t}=e;t.activeAction==="depositing"&&(t.activeAction="idle")}},mC={id:ta,update:(e,t)=>{const{entity:r}=t;return r.activeAction!=="retrieving"?{nextState:ct,data:{...e,enteredAt:t.updateContext.gameState.time,previousState:ta}}:{nextState:ta,data:e}},onEnter:(e,t)=>{const{entity:r}=e;return r.activeAction="retrieving",t},onExit:e=>{const{entity:t}=e;t.activeAction==="retrieving"&&(t.activeAction="idle")}},vC=(e,t)=>(t.procreationEndTime=e.updateContext.gameState.time+(t.duration||2),t),SC=(e,t)=>{const{entity:r,updateContext:o}=t,{gameState:l}=o;if(l.time<(e.procreationEndTime||0))return{nextState:ga,data:e};const s=l.entities.entities[e.partnerId];if(s&&s.type==="human"&&!s.isPregnant&&r.hunger<Gr&&s.hunger<Gr&&!r.procreationCooldown&&!s.procreationCooldown){const u=r.gender==="female"?r:s.gender==="female"?s:void 0,d=r.gender==="male"?r:s.gender==="male"?s:void 0;u&&d&&(u.isPregnant=!0,u.gestationTime=IE,u.pregnancyFatherId=d.id,r.procreationCooldown=zm,s.procreationCooldown=zm,Ie(o,fe.Procreate,u.position))}return r.activeAction="idle",s&&(s.activeAction="idle"),{nextState:ct,data:{...e,enteredAt:l.time,previousState:ga}}},yC={id:ga,onEnter:vC,update:SC},TC={id:or,onEnter:(e,t)=>({...t,enteredAt:e.updateContext.gameState.time,attackStartTime:e.updateContext.gameState.time}),update:(e,t)=>{if(t.entity.activeAction!=="attacking"||!t.entity.attackTargetId)return t.entity.activeAction="idle",{nextState:ct,data:{...e}};const r=t.updateContext.gameState.entities.entities[t.entity.attackTargetId];if(!r)return t.entity.activeAction="idle",{nextState:ct,data:{...e}};const o=Y(t.entity.position,r.position,t.updateContext.gameState.mapDimensions.width,t.updateContext.gameState.mapDimensions.height),l=ze(t.entity.position,r.position,t.updateContext.gameState.mapDimensions.width,t.updateContext.gameState.mapDimensions.height);return t.entity.direction=nt(l),o>ei?t.entity.acceleration=sS(t.entity):t.entity.acceleration=0,{nextState:or,data:e}}},AC={id:uu,update:(e,t)=>{const{entity:r,updateContext:o}=t,{gameState:l}=o;if(l.time-e.enteredAt>=fI){if(r.food.filter(d=>d.type===Bn.Berry).length>=Br){for(let d=0;d<Br;d++){const f=r.food.findIndex(g=>g.type===Bn.Berry);f>-1&&r.food.splice(f,1)}wa(l.entities,e.plantingSpot,l.time)}return{nextState:ct,data:{...e,enteredAt:l.time,previousState:uu}}}return{nextState:uu,data:e}},onEnter:(e,t)=>(e.entity.acceleration=0,e.entity.velocity={x:0,y:0},{...t,enteredAt:e.updateContext.gameState.time})},IC=[lC,cC,fC,gC,pC,mC,yC,TC,AC],Mn="preyIdle",Ki="preyMoving",Xs="preyGrazing",Ks="preyProcreating",EC={id:Mn,update:(e,t)=>{const{entity:r,updateContext:o}=t;return r.activeAction==="moving"?{nextState:Ki,data:{...e,enteredAt:o.gameState.time,previousState:Mn,target:r.target}}:r.activeAction==="grazing"?{nextState:Xs,data:{...e,enteredAt:o.gameState.time,previousState:Mn}}:r.activeAction==="procreating"?{nextState:Ks,data:{...e,enteredAt:o.gameState.time,previousState:Mn}}:{nextState:Mn,data:e}},onEnter:(e,t)=>(e.entity.acceleration=0,e.entity.velocity={x:0,y:0},{...t,enteredAt:e.updateContext.gameState.time})},aS=12,wC=120,g0=50,_C=12,lS=30,CC=2,zt=50,RC=100,na=2,jd=3,PC=.9,NC=1,DC=50,OC=.5,uS=20,MC=140,p0=40,kC=12,cS=40,FC=3,nr=60,kn=40,wo=50,m0=320,dS=25,UC=60,fS=2,LC=90,BC=.7,HC=1,ia=3,Vd=15,dh=80,hS=10,ku=80,Xo=40,gS=2,Su=30,Ro=20,Or=40,Po=24,Mr=48,No=12,kr=40,Do=20,Fr=60,Oo=.75,Qi=2.5,Mo=.25,Ji=2;function bC(e){let t=_C;return e.isAdult||(t*=.7),e.hunger>=DC&&(t*=OC),e.movementSlowdown&&(t*=e.movementSlowdown.modifier),t}function GC(e,t){const r=e>>16&255,o=e>>8&255,l=e&255,s=t>>16&255,u=t>>8&255,d=t&255;let f=Math.floor((r+s)/2),g=Math.floor((o+u)/2),m=Math.floor((l+d)/2);return Math.random()<.05&&(f=Math.max(0,Math.min(255,f+(Math.random()-.5)*60))),Math.random()<.05&&(g=Math.max(0,Math.min(255,g+(Math.random()-.5)*60))),Math.random()<.05&&(m=Math.max(0,Math.min(255,m+(Math.random()-.5)*60))),f<<16|g<<8|m}function pa(){const e=Math.floor(Math.random()*100)+100,t=Math.floor(Math.random()*80)+60,r=Math.floor(Math.random()*60)+20;return e<<16|t<<8|r}const Xd=10;class xC{constructor(){Oe(this,"id",Ki)}update(t,r){var f;const{entity:o,updateContext:l}=r;if(o.activeAction!=="moving")return{nextState:Mn,data:{...t,enteredAt:l.gameState.time,previousState:Ki}};let s;if(typeof o.target=="object"?s=o.target:typeof o.target=="number"&&(s=(f=r.updateContext.gameState.entities.entities[o.target])==null?void 0:f.position),!s&&(o.direction.x!==0||o.direction.y!==0)&&(s={x:o.position.x+o.direction.x*Xd*2,y:o.position.y+o.direction.y*Xd*2}),!s)return{nextState:Mn,data:{...t,enteredAt:l.gameState.time,previousState:Ki}};const u=ze(o.position,s,r.updateContext.gameState.mapDimensions.width,r.updateContext.gameState.mapDimensions.height);return o.direction=nt(u),o.acceleration=bC(o),Y(o.position,s,l.gameState.mapDimensions.width,l.gameState.mapDimensions.height)<Xd?{nextState:Mn,data:{...t,enteredAt:l.gameState.time,previousState:Ki}}:{nextState:Ki,data:t}}onExit(t){const{entity:r}=t;r.acceleration=0}onEnter(t,r){return{...r,enteredAt:t.updateContext.gameState.time}}}const $C=new xC,zC={id:Xs,update:(e,t)=>{const{entity:r,updateContext:o}=t;return r.activeAction==="moving"?{nextState:Ki,data:{...e,enteredAt:o.gameState.time,previousState:Xs,target:r.target}}:r.activeAction!=="grazing"?{nextState:Mn,data:{...e,enteredAt:o.gameState.time,previousState:Xs}}:{nextState:Xs,data:e}},onEnter:(e,t)=>(e.entity.acceleration=0,e.entity.velocity={x:0,y:0},{...t,enteredAt:e.updateContext.gameState.time})},WC={id:Ks,update:(e,t)=>{const{entity:r,updateContext:o}=t;return r.activeAction==="moving"?{nextState:Ki,data:{...e,enteredAt:o.gameState.time,previousState:Ks,target:r.target}}:r.activeAction!=="procreating"?{nextState:Mn,data:{...e,enteredAt:o.gameState.time,previousState:Ks}}:{nextState:Ks,data:e}},onEnter:(e,t)=>(e.entity.acceleration=0,e.entity.velocity={x:0,y:0},{...t,enteredAt:e.updateContext.gameState.time})},YC=[EC,$C,zC,WC],$t="predatorIdle",ji="predatorMoving",fi="predatorAttacking",_o="predatorProcreating",Ur="predatorEating",jC={id:$t,update:(e,t)=>{const{entity:r,updateContext:o}=t;return r.activeAction==="eating"?{nextState:Ur,data:{...e,enteredAt:o.gameState.time,previousState:$t,preyId:r.attackTargetId,eatingStartTime:o.gameState.time}}:r.activeAction==="attacking"&&r.attackTargetId?{nextState:fi,data:{...e,enteredAt:o.gameState.time,previousState:$t,attackTargetId:r.attackTargetId,attackStartTime:o.gameState.time}}:r.activeAction==="moving"?{nextState:ji,data:{...e,enteredAt:o.gameState.time,previousState:$t,target:r.target}}:r.activeAction==="procreating"?{nextState:_o,data:{...e,enteredAt:o.gameState.time,previousState:$t}}:{nextState:$t,data:e}},onEnter:(e,t)=>(e.entity.acceleration=0,e.entity.velocity={x:0,y:0},{...t,enteredAt:e.updateContext.gameState.time})};function pS(e){let t=kC;return e.hunger>=LC&&(t*=BC),e.isAdult||(t*=.7),e.movementSlowdown&&(t*=e.movementSlowdown.modifier),t}function VC(e,t){const r=e>>16&255,o=e>>8&255,l=e&255,s=t>>16&255,u=t>>8&255,d=t&255;let f=Math.floor((r+s)/2),g=Math.floor((o+u)/2),m=Math.floor((l+d)/2);return Math.random()<.05&&(f=Math.max(0,Math.min(255,f+(Math.random()-.5)*60))),Math.random()<.05&&(g=Math.max(0,Math.min(255,g+(Math.random()-.5)*60))),Math.random()<.05&&(m=Math.max(0,Math.min(255,m+(Math.random()-.5)*60))),f<<16|g<<8|m}function ma(){const e=Math.floor(Math.random()*60)+60,t=Math.floor(Math.random()*50)+40,r=Math.floor(Math.random()*40)+20;return e<<16|t<<8|r}const Kd=12;class XC{constructor(){Oe(this,"id",ji)}update(t,r){var f;const{entity:o,updateContext:l}=r;if(o.activeAction==="eating")return{nextState:Ur,data:{...t,enteredAt:l.gameState.time,previousState:ji,preyId:o.attackTargetId,eatingStartTime:l.gameState.time}};if(o.activeAction==="attacking"&&o.attackTargetId)return{nextState:fi,data:{...t,enteredAt:l.gameState.time,previousState:ji,attackTargetId:o.attackTargetId,attackStartTime:l.gameState.time}};if(o.activeAction!=="moving")return{nextState:$t,data:{...t,enteredAt:l.gameState.time,previousState:ji}};let s;if(typeof o.target=="object"?s=o.target:typeof o.target=="number"&&(s=(f=r.updateContext.gameState.entities.entities[o.target])==null?void 0:f.position),!s&&(o.direction.x!==0||o.direction.y!==0)&&(s={x:o.position.x+o.direction.x*Kd*2,y:o.position.y+o.direction.y*Kd*2}),!s)return{nextState:$t,data:{...t,enteredAt:l.gameState.time,previousState:ji}};const u=ze(o.position,s,r.updateContext.gameState.mapDimensions.width,r.updateContext.gameState.mapDimensions.height);return o.direction=nt(u),o.acceleration=pS(o),Y(o.position,s,l.gameState.mapDimensions.width,l.gameState.mapDimensions.height)<Kd?{nextState:$t,data:{...t,enteredAt:l.gameState.time,previousState:ji}}:{nextState:ji,data:t}}onExit(t){const{entity:r}=t;r.acceleration=0}onEnter(t,r){return{...r,enteredAt:t.updateContext.gameState.time}}}const KC=new XC,ZC={id:fi,update:(e,t)=>{const{entity:r,updateContext:o}=t;if(r.activeAction==="eating")return{nextState:Ur,data:{...e,enteredAt:o.gameState.time,previousState:fi,preyId:r.attackTargetId,eatingStartTime:o.gameState.time}};if(r.activeAction!=="attacking"||!r.attackTargetId)return r.activeAction="idle",{nextState:$t,data:{...e,enteredAt:o.gameState.time,previousState:fi}};const l=o.gameState.entities.entities[r.attackTargetId];if(!l)return r.activeAction="idle",{nextState:$t,data:{...e,enteredAt:o.gameState.time,previousState:fi}};if(l.type==="prey"&&l.hitpoints<=0||l.type==="predator"&&l.hitpoints<=0||l.type==="human"&&l.hitpoints<=0)return r.activeAction="idle",{nextState:$t,data:{...e,enteredAt:o.gameState.time,previousState:fi}};const u=Y(r.position,l.position,o.gameState.mapDimensions.width,o.gameState.mapDimensions.height),d=ze(r.position,l.position,o.gameState.mapDimensions.width,o.gameState.mapDimensions.height);return r.direction=nt(d),u>kn?r.acceleration=pS(r):r.acceleration=0,{nextState:fi,data:e}},onEnter:(e,t)=>({...t,enteredAt:e.updateContext.gameState.time})},qC={id:_o,update:(e,t)=>{const{entity:r,updateContext:o}=t;return r.activeAction==="eating"?{nextState:Ur,data:{...e,enteredAt:o.gameState.time,previousState:_o,preyId:r.attackTargetId,eatingStartTime:o.gameState.time}}:r.activeAction==="attacking"&&r.attackTargetId?{nextState:fi,data:{...e,enteredAt:o.gameState.time,previousState:_o,attackTargetId:r.attackTargetId,attackStartTime:o.gameState.time}}:r.activeAction!=="procreating"?{nextState:$t,data:{...e,enteredAt:o.gameState.time,previousState:_o}}:{nextState:_o,data:e}},onEnter:(e,t)=>(e.entity.acceleration=0,e.entity.velocity={x:0,y:0},{...t,enteredAt:e.updateContext.gameState.time})},QC={id:Ur,update:(e,t)=>{const{entity:r,updateContext:o}=t;return r.activeAction!=="eating"?{nextState:$t,data:{...e,enteredAt:o.gameState.time,previousState:Ur}}:{nextState:Ur,data:e}},onEnter:(e,t)=>(e.entity.acceleration=0,e.entity.velocity={x:0,y:0},{...t,enteredAt:e.updateContext.gameState.time})},JC=[jC,KC,ZC,qC,QC],v0=[...aC,...IC,...YC,...JC];function e1(e,t,r){const o=nI(e,v0);if(!o)return rI(e),[e,t];const{nextState:l,data:s}=o.update(t,r);return iI(e,l)?[l,tI(o,l,s,r,v0)]:[l,s]}function t1(e,t,r){const{gameState:o}=t,l=r*(It/Et);if(e.isAdult=e.age>=Yf,e.isCallingToAttack&&e.callToAttackEndTime&&o.time>e.callToAttackEndTime&&(e.isCallingToAttack=!1,e.callToAttackEndTime=void 0),e.isCallingToFollow&&e.callToFollowEndTime&&o.time>e.callToFollowEndTime&&(e.isCallingToFollow=!1,e.callToFollowEndTime=void 0),e.movementSlowdown&&o.time>e.movementSlowdown.endTime&&(e.movementSlowdown=void 0),e.hitpoints<e.maxHitpoints){const u=1-e.hunger/100*kE,d=ME*u*l;e.hitpoints=Math.min(e.maxHitpoints,e.hitpoints+d)}if(e.hunger+=r*(Ls/(It/Et)),e.hunger>dC&&(!e.lastHungerEffectTime||o.time-e.lastHungerEffectTime>Nr*2)&&(Me(o,ce.Hunger,e.position,Nr,e.id),e.lastHungerEffectTime=o.time),e.age+=r/Nu,e.isPlayer){const u=Lt(o,e).filter(d=>d.hunger>=m_);if(u.length>0){const d=u.map(f=>f.id);Cf(o,{identifier:"children_starving",type:fa.ChildrenStarving,message:"Your children are starving!",duration:g_,targetEntityIds:d,highlightedEntityIds:d})}}if(e.gender==="female"&&e.isPregnant&&e.gestationTime&&(e.gestationTime-=l,e.hunger+=r*((Ls*EE-Ls)/(It/Et)),(!e.lastPregnantEffectTime||o.time-e.lastPregnantEffectTime>Nr*3)&&(Me(o,ce.Pregnant,e.position,Nr,e.id),e.lastPregnantEffectTime=o.time),e.gestationTime<=0&&(CR(e,e.pregnancyFatherId,t),e.isPregnant=!1,e.gestationTime=0,e.pregnancyFatherId=void 0)),e.procreationCooldown&&(e.procreationCooldown-=l,e.procreationCooldown<0&&(e.procreationCooldown=0)),e.attackCooldown&&(e.attackCooldown-=l,e.attackCooldown<0&&(e.attackCooldown=0)),e.feedParentCooldownTime&&(e.feedParentCooldownTime-=l,e.feedParentCooldownTime<0&&(e.feedParentCooldownTime=0)),e.feedChildCooldownTime&&(e.feedChildCooldownTime-=l,e.feedChildCooldownTime<0&&(e.feedChildCooldownTime=0)),e.leaderMetaStrategyCooldown&&(e.leaderMetaStrategyCooldown-=l,e.leaderMetaStrategyCooldown<0&&(e.leaderMetaStrategyCooldown=0)),e.isAdult?e.radius===jo&&(e.radius=wt):e.hunger+=r*((Ls*wE-Ls)/(It/Et)),e.isAdult&&e.food.length>0&&(!e.feedParentCooldownTime||e.feedParentCooldownTime<=0)){const u=[];if(e.motherId){const d=o.entities.entities[e.motherId];d&&u.push(d)}if(e.fatherId){const d=o.entities.entities[e.fatherId];d&&u.push(d)}for(const d of u)if(d.age>=Rv&&d.hunger>=RE&&Y(e.position,d.position,o.mapDimensions.width,o.mapDimensions.height)<=PE){e.food.pop(),d.hunger=Math.max(0,d.hunger-rr),e.feedParentCooldownTime=NE;break}}let s;if(e.hitpoints<=0?s="killed":e.hunger>=br?e.food.length>0&&e.isAdult?(e.food.pop(),e.hunger=Math.max(0,e.hunger-rr)):s="hunger":e.age>=e.maxAge&&(s="oldAge"),s){if(e.leaderId===e.id){const u=Si(Lt(o,e));u?(u.leaderId=u.id,u.tribeBadge=e.tribeBadge,u.diplomacy={...e.diplomacy},Object.values(o.entities.entities).forEach(d=>{if(d.type==="human"&&d.leaderId===e.id){const f=d;f.leaderId=u.id}if(d.type==="building"&&d.ownerId===e.id){const f=d;f.ownerId=u.id}})):Object.values(o.entities.entities).forEach(d=>{if(d.type==="human"&&d.leaderId===e.id){const f=d;f.leaderId=void 0,f.tribeBadge=void 0}if(d.type==="building"&&d.ownerId===e.id){const f=d;f.ownerId=void 0}})}if(e.isPlayer){const u=Si(Lt(o,e));u?(u.isPlayer=!0,o.generationCount++):(o.gameOver=!0,o.causeOfGameOver=s,Cf(o,{identifier:"no_heir",type:fa.NoHeir,message:"Your lineage has ended. You have no heir.",duration:0}))}ER(o.entities,e.position,e.gender,e.age,e.radius,e.id,o.time,e.food,e.hunger),Zo(o.entities,e.id);return}e.animationProgress===void 0&&(e.animationProgress=0),e.animationSpeed===void 0&&(e.animationSpeed=1),e.animationProgress+=r*e.animationSpeed,e.animationProgress>=1&&(e.animationProgress=0)}function n1(e,t){const r=t.gameState.time-e.timeOfDeath;e.decayProgress=Math.min(1,r/DE);const o=Math.floor(Pv*(1-e.decayProgress));e.food.length>o&&e.food.splice(o),e.decayProgress>=1&&e.food.length<=0&&Zo(t.gameState.entities,e.id)}function i1(e,t,r){const o=r*(It/Et);e.age+=r/Nu,e.isAdult=e.age>=na;let l=t.gameState.ecosystem.preyHungerIncreasePerHour*o;if(e.isPregnant&&(l*=1.2),e.hunger+=l,e.isPregnant&&e.gestationTime!==void 0&&(e.gestationTime-=o,e.gestationTime<=0)){const u={x:e.position.x+(Math.random()-.5)*40,y:e.position.y+(Math.random()-.5)*40};u.x=Math.max(20,Math.min(t.gameState.mapDimensions.width-20,u.x)),u.y=Math.max(20,Math.min(t.gameState.mapDimensions.height-20,u.y));const d=Math.random()<.5?"male":"female",f=e,g=e.fatherId?t.gameState.entities.entities[e.fatherId]:void 0;let m;if(g)m=GC(f.geneCode,g.geneCode);else{m=f.geneCode;const S=Math.floor((Math.random()-.5)*4096);m=Math.max(0,Math.min(16777215,m+S))}$o(t.gameState.entities,u,d,0,lS*.5,m,e.id,e.fatherId),Me(t.gameState,ce.Procreation,e.position,Nr,e.id),Ie(t,fe.Birth,e.position),e.isPregnant=!1,e.gestationTime=0,e.procreationCooldown=t.gameState.ecosystem.preyProcreationCooldown,e.fatherId=void 0}e.procreationCooldown&&e.procreationCooldown>0&&(e.procreationCooldown-=o,e.procreationCooldown<0&&(e.procreationCooldown=0)),e.eatingCooldownTime&&e.eatingCooldownTime>t.gameState.time||(e.eatingCooldownTime=void 0),e.fleeCooldown&&e.fleeCooldown>0&&(e.fleeCooldown-=o,e.fleeCooldown<0&&(e.fleeCooldown=0)),e.feedChildCooldownTime&&e.feedChildCooldownTime>0&&(e.feedChildCooldownTime-=o,e.feedChildCooldownTime<0&&(e.feedChildCooldownTime=0));let s=!1;e.hunger>=wC&&(s=!0),e.hitpoints<=0&&(s=!0),e.age>=aS&&(s=!0),s&&(wR(t.gameState.entities,e.position,e.gender,e.age,e.radius,e.id,t.gameState.time,e.geneCode),Zo(t.gameState.entities,e.id))}function r1(e,t,r){const o=r*(It/Et);e.age+=r/Nu,e.isAdult=e.age>=ia;let l=t.gameState.ecosystem.predatorHungerIncreasePerHour*o;if(e.isPregnant&&(l*=1.3),e.hunger+=l,e.isPregnant&&e.gestationTime!==void 0&&(e.gestationTime-=o,e.gestationTime<=0)){const u={x:e.position.x+(Math.random()-.5)*50,y:e.position.y+(Math.random()-.5)*50};u.x=Math.max(25,Math.min(t.gameState.mapDimensions.width-25,u.x)),u.y=Math.max(25,Math.min(t.gameState.mapDimensions.height-25,u.y));const d=Math.random()<.5?"male":"female",f=e,g=e.pregnancyFatherId?t.gameState.entities.entities[e.pregnancyFatherId]:void 0;let m;if(g)m=VC(f.geneCode,g.geneCode);else{m=f.geneCode;const S=Math.floor((Math.random()-.5)*4096);m=Math.max(0,Math.min(16777215,m+S))}zo(t.gameState.entities,u,d,0,cS*.6,m,e.id,e.pregnancyFatherId),Me(t.gameState,ce.Procreation,e.position,Nr,e.id),Ie(t,fe.Birth,e.position),e.isPregnant=!1,e.gestationTime=0,e.procreationCooldown=t.gameState.ecosystem.predatorProcreationCooldown,e.pregnancyFatherId=void 0}e.procreationCooldown&&e.procreationCooldown>0&&(e.procreationCooldown-=o,e.procreationCooldown<0&&(e.procreationCooldown=0)),e.attackCooldown&&e.attackCooldown>0&&(e.attackCooldown-=o,e.attackCooldown<0&&(e.attackCooldown=0)),e.huntCooldown&&e.huntCooldown>0&&(e.huntCooldown-=o,e.huntCooldown<0&&(e.huntCooldown=0)),e.feedChildCooldownTime&&e.feedChildCooldownTime>0&&(e.feedChildCooldownTime-=o,e.feedChildCooldownTime<0&&(e.feedChildCooldownTime=0));let s=!1;e.hunger>=MC&&(s=!0),e.hitpoints<=0&&(s=!0),e.age>=uS&&(s=!0),s&&(_R(t.gameState.entities,e.position,e.gender,e.age,e.radius,e.id,t.gameState.time,e.geneCode),Zo(t.gameState.entities,e.id))}var Ea=(e=>(e[e.BehaviorTreeBased=0]="BehaviorTreeBased",e))(Ea||{}),T=(e=>(e[e.SUCCESS=0]="SUCCESS",e[e.FAILURE=1]="FAILURE",e[e.RUNNING=2]="RUNNING",e[e.NOT_EVALUATED=3]="NOT_EVALUATED",e))(T||{});class En{constructor(){Oe(this,"name");Oe(this,"depth");Oe(this,"children");Oe(this,"child")}getLastStatus(t){return E.get(t.aiBlackboard,`${this.name}_lastStatus`)??3}setLastStatus(t,r){E.set(t.aiBlackboard,`${this.name}_lastStatus`,r)}getRunningChildIndex(t){return E.get(t.aiBlackboard,`${this.name}_runningChildIndex`)}setRunningChildIndex(t,r){E.set(t.aiBlackboard,`${this.name}_runningChildIndex`,r)}}const E={create(){return{data:{},nodeExecutionData:{}}},set({data:e},t,r){e[t]=r},get(e,t){return e==null?void 0:e.data[t]},delete({data:e},t){delete e[t]},has({data:e},t){return t in e},recordNodeExecution({nodeExecutionData:e},t,r,o,l,s){const u=e[t]||{lastExecuted:0,status:T.FAILURE,depth:0,debugInfo:"",executionHistory:[]},d=u.executionHistory[u.executionHistory.length-1];d&&o-(d==null?void 0:d.time)>la&&u.executionHistory.push({time:d.time+la,status:T.NOT_EVALUATED}),u.executionHistory.push({time:o,status:r});const f=Yv/Et*It,g=o-f;u.executionHistory=u.executionHistory.filter(S=>S.time>=g);const m={...u,lastExecuted:o,status:r,depth:l,debugInfo:s};e[t]=m},getNodeExecutionData({nodeExecutionData:e}){return e},cleanupOldEntries({nodeExecutionData:e},t){const r=PI,o=[];for(const[l,s]of Object.entries(e))t-s.lastExecuted>r&&o.push(l);for(const l of o)delete e[l]}};function fh(e,t,r){if(e.aiBlackboard){const o=E.get(e.aiBlackboard,"lastAiUpdateTime")??0;t.gameState.time-o>=la&&(r.execute(e,t,e.aiBlackboard),E.set(e.aiBlackboard,"lastAiUpdateTime",t.gameState.time))}else console.warn(`Behavior Tree AI ticked for human ${e.id}, but the tree or blackboard was missing.`),e.activeAction="idle"}const S0="Human Behavior",o1=1;class s1{constructor(){Oe(this,"nodeData",new Map);Oe(this,"pathStack",[]);Oe(this,"startTimeStack",[])}nodeStart(t){this.pathStack.push(t),this.startTimeStack.push(performance.now())}nodeEnd(){if(this.startTimeStack.length===0||this.pathStack.length===0){console.error("BTProfiler: nodeEnd() called without a matching nodeStart().");return}const t=performance.now(),r=this.startTimeStack.pop(),o=t-r,l=this.pathStack.join(" > "),s=this.nodeData.get(l)??{path:l,totalTime:0,callCount:0,minTime:1/0,maxTime:-1/0};s.totalTime+=o,s.callCount++,s.minTime=Math.min(s.minTime,o),s.maxTime=Math.max(s.maxTime,o),this.nodeData.set(l,s),this.pathStack.pop()}report(t={}){const{showAll:r=!1}=t,o=Array.from(this.nodeData.values());if(o.length===0){console.log("--- Behavior Tree Profiler: No data collected. ---");return}let l=o,s="--- Behavior Tree Full Report ---";if(!r){const d=this.nodeData.get(S0);if(d){const f=d.totalTime*o1/100;l=o.filter(g=>g.totalTime>f&&g.path!==S0),s="--- Behavior Tree Problem Report ---"}else console.log('BTProfiler: Root node "Human Behavior" not found. Showing full report.'),s="--- Behavior Tree Full Report (Root Not Found) ---"}const u=l.sort((d,f)=>f.totalTime-d.totalTime);console.log(s),u.length>0?console.table(u.map(d=>({Path:d.path,"Total Time (ms)":d.totalTime.toFixed(3),Calls:d.callCount,"Avg Time (ms)":(d.totalTime/d.callCount).toFixed(3),"Min Time (ms)":d.minTime.toFixed(3),"Max Time (ms)":d.maxTime.toFixed(3)}))):console.log("No significant performance problems detected."),console.log("------------------------------------")}reset(){this.nodeData.clear(),this.pathStack=[],this.startTimeStack=[]}}const st=new s1;function Qt(e){return Array.isArray(e)?e:[e,""]}class he extends En{constructor(r,o,l=0){super();Oe(this,"name");Oe(this,"depth");this.children=r,this.name=o,this.depth=l,this.children.forEach(s=>{s.depth=(this.depth??0)+1})}execute(r,o,l){this.name&&st.nodeStart(this.name);try{for(const s of this.children){const[u,d]=Qt(s.execute(r,o,l));if(u!==T.SUCCESS)return this.setLastStatus(r,u),this.name&&E.recordNodeExecution(l,this.name,u,o.gameState.time,this.depth,d),u}return this.setLastStatus(r,T.SUCCESS),this.name&&E.recordNodeExecution(l,this.name,T.SUCCESS,o.gameState.time,this.depth,""),T.SUCCESS}finally{this.name&&st.nodeEnd()}}}class Wt extends En{constructor(r,o,l=0){super();Oe(this,"name");Oe(this,"depth");this.children=r,this.name=o,this.depth=l,this.children.forEach(s=>{s.depth=(this.depth??0)+1})}execute(r,o,l){this.name&&st.nodeStart(this.name);try{const s=this.getRunningChildIndex(r)??0;for(let u=s;u<this.children.length;u++){const d=this.children[u],[f,g]=Qt(d.execute(r,o,l));if(f!==T.FAILURE){if(f===T.SUCCESS)return this.setRunningChildIndex(r,void 0),this.setLastStatus(r,T.SUCCESS),this.name&&E.recordNodeExecution(l,this.name,T.SUCCESS,o.gameState.time,this.depth,g),T.SUCCESS;if(f===T.RUNNING)return this.setRunningChildIndex(r,u),this.setLastStatus(r,T.RUNNING),this.name&&E.recordNodeExecution(l,this.name,T.RUNNING,o.gameState.time,this.depth,g),T.RUNNING}}return this.setRunningChildIndex(r,void 0),this.setLastStatus(r,T.FAILURE),this.name&&E.recordNodeExecution(l,this.name,T.FAILURE,o.gameState.time,this.depth,""),T.FAILURE}finally{this.name&&st.nodeEnd()}}}class oe extends En{constructor(r,o,l=0){super();Oe(this,"name");Oe(this,"depth");this.action=r,this.name=o,this.depth=l}execute(r,o,l){this.name&&st.nodeStart(this.name);try{const[s,u]=Qt(this.action(r,o,l));return this.setLastStatus(r,s),this.name&&E.recordNodeExecution(l,this.name,s,o.gameState.time,this.depth,u),s}finally{this.name&&st.nodeEnd()}}}class Q extends En{constructor(r,o,l=0){super();Oe(this,"name");Oe(this,"depth");this.condition=r,this.name=o,this.depth=l}execute(r,o,l){this.name&&st.nodeStart(this.name);try{const[s,u]=Qt(this.condition(r,o,l)),d=s?T.SUCCESS:T.FAILURE;return this.setLastStatus(r,d),this.name&&E.recordNodeExecution(l,this.name,d,o.gameState.time,this.depth,u),d}finally{this.name&&st.nodeEnd()}}}class yu extends En{constructor(r,o,l,s=0){super();Oe(this,"name");Oe(this,"depth");Oe(this,"startTimeKey");this.child=r,this.timeoutDurationHours=o,this.name=l,this.depth=s,this.child.depth=(this.depth??0)+1,this.startTimeKey=`timeout_${this.name}_startTime`}execute(r,o,l){st.nodeStart(this.name);try{const s=o.gameState.time;let u=E.get(l,this.startTimeKey);const[d,f]=Qt(this.child.execute(r,o,l));if(d===T.RUNNING){u===void 0&&(E.set(l,this.startTimeKey,s),u=s);const g=s-u;if(g>this.timeoutDurationHours){E.delete(l,this.startTimeKey),this.setLastStatus(r,T.FAILURE);const S=`Timed out after ${g.toFixed(2)}h.`;return E.recordNodeExecution(l,this.name,this.getLastStatus(r),s,this.depth,S),this.getLastStatus(r)}this.setLastStatus(r,T.RUNNING);const m=`Running for ${g.toFixed(2)}h. ${f}`;return E.recordNodeExecution(l,this.name,this.getLastStatus(r),s,this.depth,m),this.getLastStatus(r)}return u!==void 0&&E.delete(l,this.startTimeKey),this.setLastStatus(r,d),E.recordNodeExecution(l,this.name,this.getLastStatus(r),s,this.depth,f),this.getLastStatus(r)}finally{st.nodeEnd()}}}class Zi extends En{constructor(r,o,l,s=0,u){super();Oe(this,"name");Oe(this,"depth");Oe(this,"statusKey");Oe(this,"timestampKey");this.child=r,this.cacheDurationHours=o,this.validityCheck=u,this.name=l,this.depth=s,this.child.depth=(this.depth??0)+1,this.statusKey=`caching_${this.name}_status`,this.timestampKey=`caching_${this.name}_timestamp`}execute(r,o,l){st.nodeStart(this.name);try{const s=o.gameState.time,u=E.get(l,this.statusKey),d=E.get(l,this.timestampKey);if(u!==void 0&&d!==void 0){const S=s-d>this.cacheDurationHours,y=this.validityCheck?this.validityCheck(r,o,l):!0;if(!S&&y){const w=(d+this.cacheDurationHours-s).toFixed(2),A=`Cache hit. Status: ${T[u]}. ${w}h left.`;return this.setLastStatus(r,u),E.recordNodeExecution(l,this.name,this.getLastStatus(r),s,this.depth,A),this.getLastStatus(r)}}const[f,g]=Qt(this.child.execute(r,o,l));(f===T.SUCCESS||f===T.FAILURE)&&(E.set(l,this.statusKey,f),E.set(l,this.timestampKey,s)),this.setLastStatus(r,f);const m=`Cache miss. Child returned ${T[f]}. ${g}`;return E.recordNodeExecution(l,this.name,this.getLastStatus(r),s,this.depth,m),this.getLastStatus(r)}finally{st.nodeEnd()}}}class yi extends En{constructor(r,o,l,s=0){super();Oe(this,"name");Oe(this,"depth");Oe(this,"cooldownKey");this.cooldownDurationHours=r,this.child=o,this.name=l,this.depth=s,this.child.depth=(this.depth??0)+1,this.cooldownKey=`cooldown_${this.name}`}execute(r,o,l){st.nodeStart(this.name);try{const s=o.gameState.time,u=E.get(l,this.cooldownKey);if(this.child.getLastStatus(r)===T.RUNNING){const[g,m]=Qt(this.child.execute(r,o,l));if(this.setLastStatus(r,g),this.name){const S=`Continuing running child. ${m}`;E.recordNodeExecution(l,this.name,this.getLastStatus(r),s,this.depth,S)}return this.getLastStatus(r)}if(u!==void 0&&s<u){const m=`Cooldown active, ${(u-s).toFixed(2)}h left`;return this.setLastStatus(r,T.FAILURE),this.name&&E.recordNodeExecution(l,this.name,this.getLastStatus(r),s,this.depth,m),this.getLastStatus(r)}const[d,f]=Qt(this.child.execute(r,o,l));return d===T.SUCCESS&&E.set(l,this.cooldownKey,s+this.cooldownDurationHours),this.setLastStatus(r,d),this.name&&E.recordNodeExecution(l,this.name,this.getLastStatus(r),s,this.depth,f),this.getLastStatus(r)}finally{st.nodeEnd()}}}class sn extends En{constructor(r,o,l,s=0){super();Oe(this,"name");Oe(this,"depth");this.child=r,this.behaviorKey=o,this.name=l,this.depth=s;const u=(d,f)=>{d.depth=f,d.children?d.children.forEach(g=>u(g,f+1)):d.child&&u(d.child,f+1)};u(this.child,(this.depth??0)+1)}execute(r,o,l){this.name&&st.nodeStart(this.name);try{if(r.isPlayer&&!o.gameState.autopilotControls.behaviors[this.behaviorKey]){const f=`Player autopilot for '${this.behaviorKey}' is disabled.`;return this.setLastStatus(r,T.FAILURE),this.name&&E.recordNodeExecution(l,this.name,this.getLastStatus(r),o.gameState.time,this.depth,f),this.getLastStatus(r)}const[u,d]=Qt(this.child.execute(r,o,l));return this.setLastStatus(r,u),this.name&&E.recordNodeExecution(l,this.name,this.getLastStatus(r),o.gameState.time,this.depth,d),this.getLastStatus(r)}finally{this.name&&st.nodeEnd()}}}class a1 extends En{constructor(r,o,l=0){super();Oe(this,"name");Oe(this,"depth");this.child=r,this.name=o,this.depth=l;const s=(u,d)=>{u.depth=d,u.children?u.children.forEach(f=>s(f,d+1)):u.child&&s(u.child,d+1)};s(this.child,(this.depth??0)+1)}execute(r,o,l){this.name&&st.nodeStart(this.name);try{if(r.isPlayer&&o.gameState.autopilotControls.isManuallyMoving)return this.setLastStatus(r,T.FAILURE),this.name&&E.recordNodeExecution(l,this.name,this.getLastStatus(r),o.gameState.time,this.depth,"Manual movement active, AI blocked."),this.getLastStatus(r);const[s,u]=Qt(this.child.execute(r,o,l));return this.setLastStatus(r,s),this.name&&E.recordNodeExecution(l,this.name,this.getLastStatus(r),o.gameState.time,this.depth,u),this.getLastStatus(r)}finally{this.name&&st.nodeEnd()}}}class wr extends En{constructor(r,o,l=0){super();Oe(this,"name");Oe(this,"depth");this.child=r,this.name=o,this.depth=l;const s=(u,d)=>{u.depth=d,u.children?u.children.forEach(f=>s(f,d+1)):u.child&&s(u.child,d+1)};s(this.child,(this.depth??0)+1)}execute(r,o,l){this.name&&st.nodeStart(this.name);try{if(r.isPlayer)return this.setLastStatus(r,T.FAILURE),this.name&&E.recordNodeExecution(l,this.name,this.getLastStatus(r),o.gameState.time,this.depth,"Player controlled, AI blocked."),this.getLastStatus(r);const[s,u]=Qt(this.child.execute(r,o,l));return this.setLastStatus(r,s),this.name&&E.recordNodeExecution(l,this.name,this.getLastStatus(r),o.gameState.time,this.depth,u),this.getLastStatus(r)}finally{this.name&&st.nodeEnd()}}}const xo=24,hh=2,mS=2;function va(e,t){if(e.leaderId){const r=t.entities.entities[e.leaderId];if(r&&r.aiBlackboard)return r}if(e.isAdult&&e.aiBlackboard)return e;if(!e.isAdult&&e.fatherId){const r=t.entities.entities[e.fatherId];if(r&&r.aiBlackboard)return r}return null}function l1(e,t){if(!e.aiBlackboard)return;const r=e.aiBlackboard.data,o=[];for(const l in r)if(l.startsWith("tribal_")){const s=r[l];s&&typeof s=="object"&&"startTime"in s&&t-s.startTime>xo&&o.push(l)}for(const l of o)E.delete(e.aiBlackboard,l)}class sr extends En{constructor(r,o,l,s=0){super();Oe(this,"name");Oe(this,"depth");Oe(this,"registeredKey");this.child=r,this.config=o,this.name=l,this.depth=s,this.child.depth=(this.depth??0)+1,this.registeredKey=`${this.name}_registered`}execute(r,o,l){st.nodeStart(this.name);try{const s=va(r,o.gameState);if(!s||!s.aiBlackboard){const[A,I]=Qt(this.child.execute(r,o,l));return this.setLastStatus(r,A),E.recordNodeExecution(l,this.name,A,o.gameState.time,this.depth,`No coordination: ${I}`),A}const u=o.gameState.time,d=E.get(l,this.registeredKey)??!1,f=this.getTaskTarget(r,o,l);if(!f)return this.setLastStatus(r,T.FAILURE),E.recordNodeExecution(l,this.name,T.FAILURE,u,this.depth,"No task target found"),T.FAILURE;const g=this.getTaskKey(f);if(d){const[A,I]=Qt(this.child.execute(r,o,l));return A===T.RUNNING?(this.refreshTaskTimestamp(s.aiBlackboard,g,r.id,u),this.setLastStatus(r,A),E.recordNodeExecution(l,this.name,A,u,this.depth,`Continuing: ${I}`),A):(this.removeFromTask(s.aiBlackboard,g,r.id),E.delete(l,this.registeredKey),this.setLastStatus(r,A),E.recordNodeExecution(l,this.name,A,u,this.depth,`Completed: ${I}`),A)}if(!this.canJoinTask(s.aiBlackboard,g,r.id,u)){this.setLastStatus(r,T.FAILURE);const A=E.get(s.aiBlackboard,g),I=(A==null?void 0:A.memberIds.length)??0,C=this.config.maxCapacity??1;return E.recordNodeExecution(l,this.name,T.FAILURE,u,this.depth,`Task full: ${I}/${C}`),T.FAILURE}if(!this.registerTask(s.aiBlackboard,g,r.id,u))return this.setLastStatus(r,T.FAILURE),E.recordNodeExecution(l,this.name,T.FAILURE,u,this.depth,"Failed to register task"),T.FAILURE;E.set(l,this.registeredKey,!0);const[y,w]=Qt(this.child.execute(r,o,l));if(y===T.RUNNING){this.setLastStatus(r,y);const A=E.get(s.aiBlackboard,g),I=(A==null?void 0:A.memberIds.length)??0,C=this.config.maxCapacity??1;return E.recordNodeExecution(l,this.name,y,u,this.depth,`Started (${I}/${C}): ${w}`),y}else return this.removeFromTask(s.aiBlackboard,g,r.id),E.delete(l,this.registeredKey),this.setLastStatus(r,y),E.recordNodeExecution(l,this.name,y,u,this.depth,`Immediate result: ${w}`),y}finally{st.nodeEnd()}}getTaskTarget(r,o,l){var u,d,f,g;if(this.config.taskType==="procreation")return((d=(u=this.config).getTargetId)==null?void 0:d.call(u,r,o,l))??null;const s=(g=(f=this.config).getTargetId)==null?void 0:g.call(f,r,o,l);return s??null}getTaskKey(r){return this.config.generateTaskKey?this.config.generateTaskKey(this.config.taskType,r):`tribal_${this.config.taskType}_${r}`}canJoinTask(r,o,l,s){const u=E.get(r,o);if(!u||s-u.startTime>xo||u.memberIds.includes(l))return!0;const d=this.config.maxCapacity??1;return u.memberIds.length<d}registerTask(r,o,l,s){let u=E.get(r,o);return u?s-u.startTime>xo?(u={memberIds:[l],startTime:s,maxCapacity:this.config.maxCapacity??1},E.set(r,o,u),!0):u.memberIds.length>=(this.config.maxCapacity??1)?!!u.memberIds.includes(l):(u.memberIds.includes(l)||(u.memberIds.push(l),E.set(r,o,u)),!0):(u={memberIds:[l],startTime:s,maxCapacity:this.config.maxCapacity??1},E.set(r,o,u),!0)}refreshTaskTimestamp(r,o,l,s){const u=E.get(r,o);u&&u.memberIds.includes(l)&&(u.startTime=s,E.set(r,o,u))}removeFromTask(r,o,l){const s=E.get(r,o);s&&(s.memberIds=s.memberIds.filter(u=>u!==l),s.memberIds.length===0?E.delete(r,o):E.set(r,o,s))}}function u1(e){return new he([new Q((t,r)=>{const o=t.hunger>=If,l=t.food.length>0,s=!t.eatingCooldownTime||r.gameState.time>=t.eatingCooldownTime;return[!!(o&&l&&s),`${Math.floor(t.hunger-If)}, ${t.food.length}, ${t.eatingCooldownTime?Math.floor(t.eatingCooldownTime-r.gameState.time):""}`]},"Can Eat",e+1),new oe(t=>(t.direction={x:0,y:0},t.target=void 0,t.activeAction="eating",T.RUNNING),"Eat",e+1)],"Eating",e)}function c1(e){return new he([new Q((t,r,o)=>{if(t.isAdult&&t.hitpoints>t.maxHitpoints*yv||!(t.hitpoints<t.maxHitpoints*.1)&&t.isAdult&&t.hunger>wI)return!1;const s=tw(t.id,r.gameState);return s?(E.set(o,"fleeThreat",s.id),!0):!1},"Should Flee",e+1),new oe((t,r,o)=>{const l=E.get(o,"fleeThreat"),s=l&&r.gameState.entities.entities[l];if(!s)return T.FAILURE;t.activeAction="moving";const u=ze(s.position,t.position,r.gameState.mapDimensions.width,r.gameState.mapDimensions.height),d=nt(u),f=Ln(t.position,Pt(d,Tv));return t.target={x:(f.x%r.gameState.mapDimensions.width+r.gameState.mapDimensions.width)%r.gameState.mapDimensions.width,y:(f.y%r.gameState.mapDimensions.height+r.gameState.mapDimensions.height)%r.gameState.mapDimensions.height},t.direction=d,T.RUNNING},"Execute Flee",e+1)],"Flee",e)}const vS=100,d1=25;function y0(e){const t=Math.sin(e)*1e4;return t-Math.floor(t)}function f1(e,t,r=vS){return t.search.building.byRadius(e.position,r).some(s=>{const u=s;return u.buildingType==="storageSpot"&&u.ownerId===e.leaderId&&u.isConstructed&&u.storedFood&&u.storageCapacity&&u.storedFood.length<u.storageCapacity})}function h1(e,t,r=vS){return t.search.building.byRadius(e.position,r).filter(s=>{const u=s;return u.buildingType==="storageSpot"&&u.ownerId===e.leaderId&&u.isConstructed&&u.storedFood&&u.storedFood.length>0})}function g1(e,t,r){if(t.length===0)return null;let o=null,l=1/0;for(const s of t){const u=Y(e.position,s.position,r.mapDimensions.width,r.mapDimensions.height);u<l&&(l=u,o=s)}return o?{storage:o,distance:l}:null}function SS(e){const t=e.storedFood?e.storedFood.length:0,r=y0(t+e.id)*2*Math.PI,o=y0(t+e.id+1)*d1;return{x:Math.cos(r)*o,y:Math.sin(r)*o}}const vo="foodSource";function p1(e){const t=new oe((o,l,s)=>{const u=va(o,l.gameState),d=new Map,f=Ne(o,l.gameState,"berryBush",Um,S=>{var I;if(S.food.length===0)return!1;if(u&&u.aiBlackboard){const C=`tribal_gather_${S.id}`,F=E.get(u.aiBlackboard,C);if(F&&l.gameState.time-F.startTime<=xo&&!F.memberIds.includes(o.id))return!1}const y=(I=l.gameState.search.building.byRadius(S.position,S.radius)[0])==null?void 0:I.ownerId,w=l.gameState.entities.entities[y];if(!w||w.leaderId===o.leaderId)return!0;const A=d.get(w.id)??Y(o.position,w.position,l.gameState.mapDimensions.width,l.gameState.mapDimensions.height);return d.set(w.id,A),A>ZI}),g=Ne(o,l.gameState,"corpse",Um,S=>{if(S.food.length===0)return!1;if(u&&u.aiBlackboard){const y=`tribal_gather_${S.id}`,w=E.get(u.aiBlackboard,y);if(w&&l.gameState.time-w.startTime<=xo&&!w.memberIds.includes(o.id))return!1}return!0});let m=null;if(f&&g){const S=Y(o.position,f.position,l.gameState.mapDimensions.width,l.gameState.mapDimensions.height),y=Y(o.position,g.position,l.gameState.mapDimensions.width,l.gameState.mapDimensions.height);m=S<=y?f:g}else m=f||g;return m?(E.set(s,vo,m.id),[T.SUCCESS,`Found food: ${m.type} at ${m.position.x.toFixed(0)},${m.position.y.toFixed(0)}`]):[T.FAILURE,"No food source found"]},"Find Closest Food Source",e+4),r=new sr(new oe((o,l,s)=>{const u=E.get(s,vo);if(!u)return[T.FAILURE,"No target in blackboard"];const d=l.gameState.entities.entities[u];return!d||d.food.length===0?(E.delete(s,vo),[T.FAILURE,"Food source is invalid or depleted"]):Y(o.position,d.position,l.gameState.mapDimensions.width,l.gameState.mapDimensions.height)<xr?(o.activeAction="gathering",o.direction={x:0,y:0},o.target=d.id,E.delete(s,vo),[T.SUCCESS,`Gathering from ${d.type}`]):(o.activeAction="moving",o.target=d.id,o.direction=Ft(o.position,d.position,l.gameState.mapDimensions),[T.RUNNING,`Moving to ${d.type}`])},"Move To Food and Gather",e+3),{taskType:"gather",maxCapacity:2,getTargetId:(o,l,s)=>E.get(s,vo)??null},"Tribal Gather Task",e+3);return new he([new Q((o,l)=>{const s=o.food.length<o.maxFood,u=o.hunger>pI,d=Lt(l.gameState,o).filter(g=>g.hunger>jf),f=f1(o,l.gameState);return[(o.isAdult&&s&&(u||d.length>0||f))??!1,`${u?"H":""}${d.length>0?" HC("+d.length+")":""}${f?" S":""}`]},"Should Gather Food",e+1),new Wt([new he([new Q((o,l,s)=>E.has(s,vo),"Has Food Source?",e+2),r],"Continue Gathering Action",e+2),new he([new Zi(t,kI,"Cache Food Source Search",e+3),r],"Find New Food Source and Gather",e+2)],"Perform or Start Gathering",e+1)],"Gather Food",e)}function m1(e){return new oe((t,r,o)=>(t.activeAction="idle",t.direction={x:0,y:0},t.target=void 0,E.set(o,"wanderTarget",void 0),T.SUCCESS),"Idle",e)}const Wl="procreationWanderStartTime",T0=(e,t,r)=>t.find(o=>zr(e,o,r)),A0={taskType:"procreation",maxCapacity:2,getTargetId:(e,t,r)=>E.get(r,"procreationPartner")??null};function v1(e){const t=new Q((s,u,d)=>{const f=Ym(s,u.gameState,xr),g=T0(s,f,u.gameState);return g?(E.set(d,"procreationPartner",g.id),!0):!1},"Find Immediate Partner"),r=new sr(new oe((s,u,d)=>{var m;const f=E.get(d,"procreationPartner"),g=f&&u.gameState.entities.entities[f];return g?(s.activeAction="procreating",s.target=void 0,E.delete(d,"procreationPartner"),E.delete(d,Wl),(m=s.partnerIds)!=null&&m.includes(g.id)||(s.partnerIds=s.partnerIds?[...s.partnerIds,g.id]:[g.id]),T.SUCCESS):T.FAILURE},"Start Procreating"),A0,"Tribal Start Procreating",e+2),o=new Q((s,u,d)=>{const f=Ym(s,u.gameState,EI),g=T0(s,f,u.gameState);return g?(E.set(d,"procreationPartner",g.id),!0):!1},"Locate Distant Partner"),l=new sr(new oe((s,u,d)=>{const f=E.get(d,"procreationPartner"),g=f&&u.gameState.entities.entities[f];if(!g||g.isPregnant)return T.FAILURE;if(Y(s.position,g.position,u.gameState.mapDimensions.width,u.gameState.mapDimensions.height)<xr)return T.SUCCESS;s.activeAction="moving",s.target=g.id;const S=ze(s.position,g.position,u.gameState.mapDimensions.width,u.gameState.mapDimensions.height);return s.direction=nt(S),T.RUNNING},"Move Towards Partner"),A0,"Tribal Move To Partner",e+3);return new he([new Q(s=>!(!s.isAdult||s.gender==="female"&&s.isPregnant||s.age<TE||s.gender==="female"&&s.age>Cv),"Is Fertile (age, not pregnant)",e+1),new Q(s=>s.hunger<Gr,"Is Healthy (hunger)",e+1),new Q(s=>(s.procreationCooldown||0)<=0,"Is Ready (cooldown)",e+1),new Wt([new he([new Q((s,u)=>Km(s.position,u.gameState,"berryBush",km)>=II,"Is Environment Viable (food)",e+3),new oe((s,u,d)=>(E.delete(d,Wl),T.SUCCESS),"Clear Wander Timer",e+3)],"Sufficient Food Path",e+2),new he([new Q((s,u)=>{if(s.gender==="male"){const d=Lt(u.gameState,s);return!Si(d)}return!1},"Is Male Without Heir",e+3),new oe((s,u,d)=>{const f=E.get(d,Wl);if(f===void 0)return E.set(d,Wl,u.gameState.time),[T.FAILURE,"Starting heirless wander timer"];const g=u.gameState.time-f;return g>=AE?Km(s.position,u.gameState,"berryBush",km)>=1?[T.SUCCESS,`Wandered for ${g.toFixed(1)}h, minimum food found`]:[T.FAILURE,"Desperate but no food sources nearby"]:[T.FAILURE,`Wandering for heir, ${g.toFixed(1)}h elapsed`]},"Check Wander Timer",e+3)],"Heirless Desperation Path",e+2)],"Check Environment Or Desperation",e+1),new Q((s,u,d)=>{var g;const f=E.get(d,"procreationPartner");return f&&((g=f.partnerIds)!=null&&g.length)&&!f.partnerIds.includes(s.id)&&f.partnerIds.map(m=>u.gameState.entities.entities[m]).filter(m=>!!m).some(m=>Y(s.position,m.position,u.gameState.mapDimensions.width,u.gameState.mapDimensions.height)<KI)?[!1,"Partner's primary partner is too close"]:!0},"Is Partner's Primary Partner Nearby",e+1),new Wt([new he([t,r],"Procreate With Immediate Partner",e+2),new yi(DI,new he([o,l],"Seek Distant Partner Action",e+3),"Seek Distant Partner Cooldown",e+2)],"Find Partner And Procreate",e+1)],"Procreate",e)}const So="attackTarget",_r="homeCenter",Zd=150;function S1(e){return new he([new Q((t,r,o)=>{if(!t.isAdult)return[!1,"Not an adult"];const{gameState:l}=r;if(t.activeAction==="attacking"&&t.attackTargetId){const u=l.entities.entities[t.attackTargetId];if(u&&u.hitpoints>0&&Y(t.position,u.position,l.mapDimensions.width,l.mapDimensions.height)<=Zd){if(E.set(o,So,u.id),!E.get(o,_r)){const d=t.leaderId?$r(t.leaderId,l):pu(t,l).length>0?Vm(t,l):t.position;E.set(o,_r,d)}return!0}}const s=Ne(t,l,"human",Zd,u=>u.hitpoints>0&&Vo(t,u,l));if(s){E.set(o,So,s.id);const u=t.leaderId?$r(t.leaderId,l):pu(t,l).length>0?Vm(t,l):t.position;return E.set(o,_r,u),!0}return E.set(o,So,void 0),E.set(o,_r,void 0),!1},"Find Attack Target",e+1),new oe((t,r,o)=>{const l=E.get(o,So),s=l&&r.gameState.entities.entities[l],u=E.get(o,_r);if(!s||!u)return T.FAILURE;const{gameState:d}=r;return Y(t.position,u,d.mapDimensions.width,d.mapDimensions.height)>Sv?(t.activeAction="idle",t.attackTargetId=void 0,E.set(o,So,void 0),E.set(o,_r,void 0),T.FAILURE):s.hitpoints<=0||Y(t.position,s.position,d.mapDimensions.width,d.mapDimensions.height)>Zd?(t.activeAction==="attacking"&&(t.activeAction="idle",t.attackTargetId=void 0),E.set(o,So,void 0),E.set(o,_r,void 0),T.SUCCESS):(t.activeAction==="attacking"&&t.attackTargetId===s.id||(t.activeAction="attacking",t.attackTargetId=s.id),T.RUNNING)},"Execute Attack",e+1)],"Attack",e)}const y1=(e,t,r)=>{const o=Lt(t.gameState,e).filter(u=>!u.isAdult);if(o.length===0)return T.FAILURE;let l=null,s=jf;for(const u of o)u.hunger>=s&&(s=u.hunger,l=u);return l?(E.set(r,"targetChild",l.id),T.SUCCESS):T.FAILURE},T1=(e,t,r)=>{const o=E.get(r,"targetChild"),l=o&&t.gameState.entities.entities[o];return l?Y(e.position,l.position,t.gameState.mapDimensions.width,t.gameState.mapDimensions.height)>Vf?(e.activeAction="moving",e.target=l.id,e.direction=Ft(e.position,l.position,t.gameState.mapDimensions),T.RUNNING):(e.activeAction="feeding",e.target=void 0,E.set(r,"targetChild",void 0),T.SUCCESS):T.FAILURE};function A1(e){return new he([new Q(t=>(t.isAdult&&t.food.length>0&&(!t.feedChildCooldownTime||t.feedChildCooldownTime<=0))??!1,"Can Feed Child",e+1),new oe(y1,"Find Hungriest Child",e+1),new oe(T1,"Move To Child and Feed",e+1)],"Feed Child",e)}function I1(e){return new he([new Q(t=>!t.isAdult&&t.hunger>=jf,"Is Hungry Child",e+1),new oe((t,r,o)=>{const l=WE(t,r.gameState);if(l.length===0)return T.FAILURE;const s=Ne(t,r.gameState,"human",CE,u=>l.some(d=>d.id===u.id)&&u.food.length>0);return s?(E.set(o,"targetParent",s.id),T.SUCCESS):T.FAILURE},"Find Parent With Food",e+1),new oe((t,r,o)=>{const l=E.get(o,"targetParent"),s=l&&r.gameState.entities.entities[l];if(!s)return T.FAILURE;const u=Y(t.position,s.position,r.gameState.mapDimensions.width,r.gameState.mapDimensions.height);return t.activeAction="idle",u<=Vf?(t.target=void 0,T.SUCCESS):(t.target=s.id,t.activeAction="moving",T.RUNNING)},"Move To Parent",e+1)],"Seek Food From Parent",e)}const yo="plantingSpot",Gs="plantingZoneId",E1=50;function w1(e,t,r,o){const l=ze(e,t,r,o);return Ln(e,l)}function _1(e){const t=new oe((l,s,u)=>{const d=E.get(u,yo);if(!d)return E.delete(u,yo),E.delete(u,Gs),[T.FAILURE,"Planting spot is missing"];if(bn(d,s.gameState,Hr,l.id))return E.delete(u,yo),E.delete(u,Gs),[T.FAILURE,"Planting spot is occupied"];const f=w1(l.position,d,s.gameState.mapDimensions.width,s.gameState.mapDimensions.height),g=Y(l.position,f,s.gameState.mapDimensions.width,s.gameState.mapDimensions.height);return g>xr?(l.activeAction="moving",l.target=f,l.direction=Ft(l.position,f,s.gameState.mapDimensions),[T.RUNNING,"Moving to planting spot: "+g.toFixed(2)+" units away"]):bn(d,s.gameState,Hr,l.id)?(E.delete(u,yo),E.delete(u,Gs),[T.FAILURE,"Planting spot is now occupied"]):(l.activeAction="planting",l.target=d,[T.RUNNING,"Planting state initiated"])},"Move To Spot and Plant",e+4),r=new sr(t,{taskType:"plant",maxCapacity:2,proximityRadius:E1,getTargetId:(l,s,u)=>E.get(u,Gs)??null},"Coordinated Planting",e+3),o=new oe((l,s,u)=>{const d=iC(l,s.gameState);return d?(E.set(u,yo,d.position),E.set(u,Gs,d.zoneId),[T.SUCCESS,`Found new spot at ${d.position.x.toFixed(0)}, ${d.position.y.toFixed(0)} (Zone ${d.zoneId})`]):[T.FAILURE,"No suitable planting spot found"]},"Find Optimal Planting Spot",e+3);return new he([new Q(l=>{const s=l.food.filter(f=>f.type===Bn.Berry).length>=Br,u=l.hunger<mI,d=(l.isAdult&&s&&u)??!1;return[d,d?"Can plant":`Cannot plant: adult=${l.isAdult}, berries=${l.food.filter(f=>f.type===Bn.Berry).length}/${Br}, hunger=${l.hunger.toFixed(0)}`]},"Can Plant",e+1),new Q((l,s)=>{if(!l.leaderId)return[!1,"No tribe"];const u=K_(l,s.gameState),d=rS(l.leaderId,s.gameState);let f;return u<QI?f=tE:u<JI?f=nE:u<eE?f=iE:f=rE,[d<f,`Food security: ${(u*100).toFixed(0)}%, Bush density: ${d.toFixed(1)}/${f}`]},"Needs More Bushes (Adaptive)",e+1),new Q((l,s)=>{if(!l.leaderId)return[!0,"No tribe coordination needed"];const u=Hn(l,s.gameState),d=oS(l.leaderId,s.gameState,"planting"),f=Math.max(1,Math.ceil(u.length*.3));return[d<f,`Active planters: ${d}/${f}`]},"Not Too Many Planters",e+1),new Wt([new he([new Q((l,s,u)=>E.has(u,yo),"Has Planting Spot?",e+2),r],"Continue Planting Action",e+2),new yi(MI,o,"Find Planting Spot Cooldown",e+2)],"Perform or Start Planting",e+1)],"Plant Bush",e)}const I0="lastDepositTime",To="assignedStorageSpot";function C1(e){return new Wt([new he([new Q((t,r,o)=>{const l=E.get(o,I0)||0,s=r.gameState.time-l;if(s<Lm)return[!1,`Cooldown: ${(Lm-s).toFixed(1)}h remaining`];if(!t.isAdult)return[!1,"Not an adult"];if(!t.leaderId)return[!1,"No tribe"];const u=iS(t.leaderId,r.gameState);let d;u<.3?d=oE:u<.7?d=sE:d=aE;const f=t.food.length/t.maxFood;if(f<=d)return[!1,`Food ${(f*100).toFixed(0)}% < threshold ${(d*100).toFixed(0)}%`];const g=nC(t,r.gameState);return g?(E.set(o,To,g.id),[!0,`Storage util: ${(u*100).toFixed(0)}%, Personal: ${(f*100).toFixed(0)}%`]):[!1,"No available tribe storage nearby"]},"Check for Excess Food and Storage",e+1),new Q((t,r)=>{if(!t.leaderId)return[!0,"No tribe coordination needed"];const o=oS(t.leaderId,r.gameState,"depositing"),l=Hn(t,r.gameState),s=Math.max(1,Math.ceil(l.length*.4));return[o<s,`Active depositors: ${o}/${s}`]},"Not Too Many Depositors",e+1),new sr(new oe((t,r,o)=>{var d;const l=E.get(o,To);if(!l)return[T.FAILURE,"No storage assigned"];const s=r.gameState.entities.entities[l];if(!s)return E.delete(o,To),[T.FAILURE,"Storage entity missing"];if((((d=s.storedFood)==null?void 0:d.length)??0)>=(s.storageCapacity??0))return E.delete(o,To),[T.FAILURE,"Storage full"];const u=Y(t.position,s.position,r.gameState.mapDimensions.width,r.gameState.mapDimensions.height);return u<=An?(t.activeAction="depositing",t.target=void 0,E.set(o,I0,r.gameState.time),E.delete(o,To),[T.SUCCESS,"Depositing food"]):(t.activeAction="moving",t.target=s.position,[T.RUNNING,`Moving to storage (${u.toFixed(1)}px away)`])},"Navigate to Storage and Deposit",e+2),{taskType:"storage",maxCapacity:mS,storageAction:"deposit",getTargetId:(t,r,o)=>E.get(o,To)??null},"Tribal Storage Deposit Task",e+1)],"Deposit Sequence",e)],"Storage Deposit Behavior",e)}const Yl="retrievalStorageId";function R1(e){return new Wt([new he([new Q((t,r,o)=>{if(t.hunger<=If)return[!1,"Not hungry enough"];if(t.food.length>=t.maxFood)return[!1,"Inventory full"];const l=h1(t,r.gameState),s=g1(t,l,r.gameState),u=s==null?void 0:s.storage;return u?(E.set(o,Yl,u.id),[!0,`Storage with food found at distance ${s.distance.toFixed(1)}`]):[!1,"No tribe storage with food nearby"]},"Check for Hunger and Storage Food",e+1),new sr(new oe((t,r,o)=>{const l=E.get(o,Yl);if(!l)return[T.FAILURE,"No storage target"];const s=r.gameState.entities.entities[l];if(!s)return E.delete(o,Yl),[T.FAILURE,"Storage not found"];const u=Y(t.position,s.position,r.gameState.mapDimensions.width,r.gameState.mapDimensions.height);return u<=An?(t.activeAction="retrieving",t.target=void 0,[T.SUCCESS,"Retrieving food"]):(t.activeAction="moving",t.target=s.position,[T.RUNNING,`Moving to storage (${u.toFixed(1)}px away)`])},"Navigate to Storage and Retrieve",e+2),{taskType:"storage",maxCapacity:mS,storageAction:"retrieve",getTargetId:(t,r,o)=>E.get(o,Yl)??null},"Coordinated Storage Retrieve",e+1)],"Retrieve Sequence",e)],"Storage Retrieve Behavior",e)}function P1(e){return new Wt([new he([new Q((t,r,o)=>{if(!t.isAdult)return[!1,"Not an adult"];if(t.food.length>=t.maxFood)return[!1,"Inventory full"];if(!t.leaderId)return[!1,"No tribe leader"];const l=r.gameState.entities.entities[t.leaderId];if(!l||!l.diplomacy)return[!1,"No diplomacy info"];const d=r.gameState.search.building.byRadius(t.position,150).find(f=>{const g=f;if(g.buildingType!=="storageSpot"||!g.isConstructed||!g.storedFood||g.storedFood.length===0||g.ownerId===t.leaderId||l.diplomacy[g.ownerId]!==pt.Hostile)return!1;const S=Hn({leaderId:g.ownerId},r.gameState);for(const y of S)if(Y(t.position,y.position,r.gameState.mapDimensions.width,r.gameState.mapDimensions.height)<=Rf)return!1;return!0});return d?[!0,`Undefended enemy storage found at distance ${Y(t.position,d.position,r.gameState.mapDimensions.width,r.gameState.mapDimensions.height).toFixed(1)}`]:[!1,"No undefended enemy storage nearby"]},"Check for Undefended Enemy Storage",e+1),new oe((t,r,o)=>{if(!t.leaderId)return[T.FAILURE,"No tribe leader"];const l=r.gameState.entities.entities[t.leaderId];if(!l||!l.diplomacy)return[T.FAILURE,"No diplomacy info"];const d=r.gameState.search.building.byRadius(t.position,150).filter(m=>{const S=m;if(S.buildingType!=="storageSpot"||!S.isConstructed||!S.storedFood||S.storedFood.length===0||S.ownerId===t.leaderId||l.diplomacy[S.ownerId]!==pt.Hostile)return!1;const w=Hn({leaderId:S.ownerId},r.gameState);for(const A of w)if(Y(t.position,A.position,r.gameState.mapDimensions.width,r.gameState.mapDimensions.height)<=Rf)return!1;return!0});if(d.length===0)return[T.FAILURE,"No undefended storage available"];let f=null,g=1/0;for(const m of d){const S=Y(t.position,m.position,r.gameState.mapDimensions.width,r.gameState.mapDimensions.height);S<g&&(g=S,f=m)}return f?g<=An?(t.activeAction="idle",t.target=void 0,[T.SUCCESS,"Stealing food"]):(t.activeAction="moving",t.target=f.position,[T.RUNNING,`Moving to enemy storage (${g.toFixed(1)}px away)`]):[T.FAILURE,"No storage found"]},"Navigate to Enemy Storage and Steal",e+1)],"Steal Sequence",e)],"Storage Steal Behavior",e)}const qd="enemiesNearby";function N1(e){const t=new Q(s=>s.id===s.leaderId,"Is Leader?",e+1),r=new Q(s=>!s.isCallingToAttack,"Is Not Already Calling?",e+1),o=new oe((s,u,d)=>{const f=Jf(s,u.gameState,Zv);return f.length>0?(E.set(d,qd,f.map(g=>g.id)),T.SUCCESS):T.FAILURE},"Find Nearby Enemies",e+1),l=new Wt([new he([new Q((s,u,d)=>{const f=E.get(d,qd),g=f==null?void 0:f.map(w=>u.gameState.entities.entities[w]).filter(w=>!!w);if(!g||g.length===0)return!1;const m=ca(s.id,u.gameState),S=mu(m),y=mu(g);return S>y*$I},"Is Strong Enough?",e+3),new oe((s,u)=>(s.isCallingToAttack=!0,s.callToAttackEndTime=u.gameState.time+Go,Me(u.gameState,ce.CallToAttack,s.position,Go),Ie(u,fe.CallToAttack,s.position),s.activeAction="idle",s.target=void 0,T.SUCCESS),"Issue Call to Attack",e+3)],"Attack",e+2),new oe((s,u,d)=>{const f=E.get(d,qd),g=f==null?void 0:f.map(I=>u.gameState.entities.entities[I]).filter(I=>!!I);if(!g||g.length===0)return T.FAILURE;const m=g.map(I=>I.position),S=gu(m),y=ze(S,s.position,u.gameState.mapDimensions.width,u.gameState.mapDimensions.height),w=nt(y),A=Ln(s.position,Pt(w,Tv*2));return s.activeAction="moving",s.target={x:(A.x%u.gameState.mapDimensions.width+u.gameState.mapDimensions.width)%u.gameState.mapDimensions.width,y:(A.y%u.gameState.mapDimensions.height+u.gameState.mapDimensions.height)%u.gameState.mapDimensions.height},s.direction=w,T.SUCCESS},"Retreat",e+2)],"Attack or Retreat",e+2);return new he([t,r,o,new yi(zI,l,"Leader Combat Cooldown",e+1)],"Leader Combat Strategy",e)}const Qd="combatTarget",Jd="homeCenter";function D1(e){const t=new Q(u=>u.isAdult&&u.leaderId?u.id!==u.leaderId:!1,"Is Tribe Follower?",e+1),r=new Q(u=>u.hunger<vI&&u.hitpoints>=u.maxHitpoints*yv,"Is Fit for Combat?",e+1),o=new Q((u,d)=>{const f=d.gameState.entities.entities[u.leaderId];return!!(f!=null&&f.isCallingToAttack)},"Is Leader Calling to Attack?",e+1),l=new oe((u,d,f)=>{const{gameState:g}=d,m=g.entities.entities[u.leaderId];if(!m)return T.FAILURE;const S=Jf(m,g,_I);if(S.length===0)return T.FAILURE;S.sort((y,w)=>{const A=Y(u.position,y.position,g.mapDimensions.width,g.mapDimensions.height),I=Y(u.position,w.position,g.mapDimensions.width,g.mapDimensions.height);return A-I});for(const y of S)if(QE(m.id,y.id,g)<CI){E.set(f,Qd,y.id);const A=$r(m.id,g);return E.set(f,Jd,A),T.SUCCESS}return T.FAILURE},"Find Best Target",e+1),s=new oe((u,d,f)=>{const g=E.get(f,Qd),m=g&&d.gameState.entities.entities[g],S=E.get(f,Jd);if(!m||!S)return T.FAILURE;const{gameState:y}=d;return Y(u.position,S,y.mapDimensions.width,y.mapDimensions.height)>Sv?(u.activeAction==="attacking"&&u.attackTargetId===m.id&&(u.activeAction="idle",u.attackTargetId=void 0),E.set(f,Qd,void 0),E.set(f,Jd,void 0),T.FAILURE):((!u.lastTargetAcquiredEffectTime||d.gameState.time-u.lastTargetAcquiredEffectTime>xe*5)&&(Me(d.gameState,ce.TargetAcquired,u.position,xe,u.id),u.lastTargetAcquiredEffectTime=d.gameState.time),u.activeAction="attacking",u.attackTargetId=m.id,u.target=void 0,T.RUNNING)},"Attack Target",e+1);return new he([t,r,o,l,s],"Tribe Member Combat",e)}function O1(e,t,r,o,l,s,u){const d=u.mapDimensions.width,f=u.mapDimensions.height,g=Math.PI/8,S=r*2/(2*Math.PI);let y=0,w=0;for(;w<=t;){const A=e.x+w*Math.cos(y),I=e.y+w*Math.sin(y),C={x:(A%d+d)%d,y:(I%f+f)%f};if(uh(C,l,s,u)&&!iw(C,void 0,o,u))return C;y+=g,w=S*y}}class M1 extends En{constructor(t){super(),this.name="Leader Building Placement",this.depth=t}execute(t,r,o){if(!t.leaderId||t.leaderId!==t.id)return[T.FAILURE,"Not a tribe leader"];const s=Hn(t,r.gameState).filter(H=>H.isAdult);if(s.length<Hm)return[T.FAILURE,`Tribe too small: ${s.length}/${Hm} adults`];const u=Aa(t.leaderId,r.gameState),d=ch(t,r.gameState),f=iS(t.leaderId,r.gameState),g=rS(t.leaderId,r.gameState),m=Math.ceil(s.length*(1+cE)),S=u.length===0,y=u.length<xm&&(S||f>bm||f*(m/s.length)>bm),w=g*(s.length/m),A=d.length<$m&&(g<Gm||w<Gm);let I=null,C="";if(y&&A?S?(I=On.StorageSpot,C="Bootstrap: First storage spot for tribe"):f>.85?(I=On.StorageSpot,C=`High storage utilization: ${(f*100).toFixed(0)}% (projected: ${m} adults)`):(I=On.PlantingZone,C=`Low bush density: ${g.toFixed(1)} bushes/member (projected: ${w.toFixed(1)})`):y?S?(I=On.StorageSpot,C="Bootstrap: First storage spot for tribe"):(I=On.StorageSpot,C=`Storage utilization: ${(f*100).toFixed(0)}% (projected: ${m} adults)`):A&&(I=On.PlantingZone,C=`Bush density: ${g.toFixed(1)} bushes/member (projected: ${w.toFixed(1)} for ${m} adults)`),!I)return[T.FAILURE,`No building needed. Storage: ${u.length}/${xm} (${(f*100).toFixed(0)}%), Planting: ${d.length}/${$m} (${g.toFixed(1)} bushes/member)`];const F=S?fE:dE,B=$r(t.leaderId,r.gameState),D=O1(B,Bm,uE,F,I,t.id,r.gameState);return D?(nS(D,I,t.id,r.gameState),[T.SUCCESS,`Placed ${I} at (${D.x.toFixed(0)}, ${D.y.toFixed(0)}). Reason: ${C}`]):[T.FAILURE,`No valid location found for ${I} within ${Bm}px of tribe center`]}}function k1(e){return new M1(e)}const $i="takeOverBuildingTarget";function F1(e){const t=new he([new Q((r,o,l)=>{if(!r.leaderId||r.leaderId!==r.id)return[!1,"Not a tribe leader"];const s=E.get(l,$i);if(s){const d=o.gameState.entities.entities[s];if(d&&d.type==="building"&&Fn(r,d,o.gameState))return[!0,`Continuing to target building ${s}`];E.delete(l,$i)}const u=Ne(r,o.gameState,"building",Iv,d=>Fn(r,d,o.gameState)&&d.isConstructed);return u?(E.set(l,$i,u.id),[!0,`Found enemy building at distance ${Y(r.position,u.position,o.gameState.mapDimensions.width,o.gameState.mapDimensions.height).toFixed(0)}px`]):[!1,"No enemy buildings found within range"]},"Find Enemy Building to Take Over",e+2),new oe((r,o,l)=>{const s=E.get(l,$i);if(!s)return T.FAILURE;const u=o.gameState.entities.entities[s];return!u||u.type!=="building"||!Fn(r,u,o.gameState)?(E.delete(l,$i),r.activeAction="idle",r.target=void 0,T.FAILURE):Y(r.position,u.position,o.gameState.mapDimensions.width,o.gameState.mapDimensions.height)<mt?(r.activeAction="idle",r.target=void 0,T.SUCCESS):(r.activeAction="moving",r.target=u.id,T.RUNNING)},"Move to Enemy Building",e+2),new oe((r,o,l)=>{const s=E.get(l,$i);if(!s)return T.FAILURE;const u=o.gameState.entities.entities[s];return!u||u.type!=="building"||!Fn(r,u,o.gameState)?(E.delete(l,$i),T.FAILURE):(r.activeAction="takingOverBuilding",r.target=u.id,E.delete(l,$i),T.SUCCESS)},"Initiate Building Takeover",e+2)],"Take Over Building Action",e+1);return new yi(Av,t,"Take Over Building Cooldown",e)}const zi="removeEnemyBuildingTarget";function U1(e){const t=new he([new Q((r,o,l)=>{if(!r.leaderId||r.leaderId!==r.id)return[!1,"Not a tribe leader"];const s=E.get(l,zi);if(s){const d=o.gameState.entities.entities[s];if(d&&d.type==="building"&&Fn(r,d,o.gameState))return[!0,`Continuing to target building ${s}`];E.delete(l,zi)}const u=Ne(r,o.gameState,"building",Iv,d=>Fn(r,d,o.gameState)&&d.isConstructed);return u?(E.set(l,zi,u.id),[!0,`Found enemy building at distance ${Y(r.position,u.position,o.gameState.mapDimensions.width,o.gameState.mapDimensions.height).toFixed(0)}px`]):[!1,"No enemy buildings found within range"]},"Find Enemy Building to Destroy",e+2),new oe((r,o,l)=>{const s=E.get(l,zi);if(!s)return T.FAILURE;const u=o.gameState.entities.entities[s];return!u||u.type!=="building"||!Fn(r,u,o.gameState)?(E.delete(l,zi),r.activeAction="idle",r.target=void 0,T.FAILURE):Y(r.position,u.position,o.gameState.mapDimensions.width,o.gameState.mapDimensions.height)<mt?(r.activeAction="idle",r.target=void 0,T.SUCCESS):(r.activeAction="moving",r.target=u.id,T.RUNNING)},"Move to Enemy Building",e+2),new oe((r,o,l)=>{const s=E.get(l,zi);if(!s)return T.FAILURE;const u=o.gameState.entities.entities[s];return!u||u.type!=="building"||!Fn(r,u,o.gameState)?(E.delete(l,zi),T.FAILURE):(r.activeAction="destroyingBuilding",r.target=u.id,E.delete(l,zi),T.SUCCESS)},"Initiate Building Destruction",e+2)],"Remove Enemy Building Action",e+1);return new yi(Av,t,"Remove Enemy Building Cooldown",e)}function L1(e){const t=new Q((m,S)=>{if(!m.isAdult||m.gender!=="male")return!1;const y=m.partnerIds&&m.partnerIds.length>0,w=Lt(S.gameState,m).length>0;return y||w},"Is Adult Male With Family?",e+1),r=new Q((m,S)=>{var I;const y=vt(S.gameState);if(y){const C=Si(Lt(S.gameState,y));if((C==null?void 0:C.id)===m.id)return!1}if(!m.fatherId)return!1;const w=S.gameState.entities.entities[m.fatherId];return!w||((I=Si(Lt(S.gameState,w)))==null?void 0:I.id)===m.id?!1:Y(m.position,w.position,S.gameState.mapDimensions.width,S.gameState.mapDimensions.height)<NI},"Is Too Close To Father?",e+1),o=new Q((m,S,y)=>E.get(y,"territoryMoveTarget")!==void 0,"Is Moving To Territory?",e+3),l=new oe((m,S,y)=>{const w=E.get(y,"territoryMoveTarget"),A=E.get(y,"territoryMoveStartTime");if(!w||!A)return[T.FAILURE,"Missing move data"];if(S.gameState.time-A>RI)return E.delete(y,"territoryMoveTarget"),E.delete(y,"territoryMoveStartTime"),[T.FAILURE,"Territory move timed out"];if(Y(m.position,w,S.gameState.mapDimensions.width,S.gameState.mapDimensions.height)<xr)return E.delete(y,"territoryMoveTarget"),E.delete(y,"territoryMoveStartTime"),[T.SUCCESS,"Arrived at new territory"];m.activeAction="moving",m.target=w;const F=ze(m.position,m.target,S.gameState.mapDimensions.width,S.gameState.mapDimensions.height);return m.direction=nt(F),[T.RUNNING,"Continuing move to territory"]},"Check Timeout & Arrival",e+3),s=new he([o,l],"Handle In-Progress Move",e+2),u=new Q((m,S,y)=>E.get(y,"territoryMoveTarget")===void 0,"Should Start New Move?",e+4),d=new oe((m,S,y)=>{const w=Qf(m.position,S.gameState.mapDimensions.width/4,S.gameState.mapDimensions.width,S.gameState.mapDimensions.height);E.set(y,"territoryMoveTarget",w),E.set(y,"territoryMoveStartTime",S.gameState.time),m.activeAction="moving",m.target=w;const A=ze(m.position,m.target,S.gameState.mapDimensions.width,S.gameState.mapDimensions.height);return m.direction=nt(A),[T.RUNNING,"Started moving to new territory"]},"Start New Territory Move",e+4),f=new he([u,d],"Start New Territory Move Action",e+3),g=new Wt([s,new yi(OI,f,"Establish Territory Cooldown",e+2)],"Establish or Continue Move",e+1);return new he([t,r,g],"Establish Family Territory",e)}function B1(e){return new he([new oe((t,r,o)=>{const l=jE(t,r.gameState);return l?(E.set(o,"patriarchTarget",l.id),[T.SUCCESS,`Found patriarch: ${l.id}`]):(E.delete(o,"patriarchTarget"),[T.FAILURE,"No patriarch found"])},"Find Patriarch",e+1),new oe((t,r,o)=>{const l=E.get(o,"patriarchTarget"),s=l&&r.gameState.entities.entities[l];if(!s)return[T.FAILURE,"Patriarch target missing from blackboard"];const u=Y(t.position,s.position,r.gameState.mapDimensions.width,r.gameState.mapDimensions.height);if(u>vv){t.activeAction="moving",t.target=s.id;const d=ze(t.position,s.position,r.gameState.mapDimensions.width,r.gameState.mapDimensions.height);return t.direction=nt(d),[T.RUNNING,`Moving to patriarch at ${u.toFixed(0)}`]}return t.activeAction="idle",t.target=void 0,t.direction={x:0,y:0},[T.SUCCESS,`Arrived at patriarch at ${u.toFixed(0)}`]},"Move Towards Patriarch",e+1)],"Follow Patriarch",e)}const jl="tribeSplitMigrationTarget";function H1(e){const t=new he([new Q((r,o,l)=>{if(E.get(l,jl))return[!0,"Already migrating"];const{canSplit:u,progress:d}=sh(r,o.gameState);return u?[!0,`Progress: ${(d??0)*100}%`]:[!1,"Cannot split"]},"Can Split Tribe?",e+2),new oe((r,o,l)=>{const{gameState:s}=o;let u=E.get(l,jl);if(!u){if(!r.leaderId)return T.FAILURE;const f=s.entities.entities[r.leaderId];if(!f)return T.FAILURE;const g=F_(f.position,r,s);if(g)E.set(l,jl,g),u=g;else return T.FAILURE}return Y(r.position,u,s.mapDimensions.width,s.mapDimensions.height)<xr?(E.delete(l,jl),r.activeAction="idle",r.target=void 0,T.SUCCESS):(r.activeAction="moving",r.target=u,T.RUNNING)},"Move to New Territory",e+2),new oe((r,o)=>(ah(r,o.gameState),T.SUCCESS),"Perform Tribe Split",e+2)],"Tribe Split Action",e+1);return new yi(h_,t,"Tribe Split Cooldown",e)}const Vl="jealousyAttackTarget";function b1(e){return new he([new Q((t,r,o)=>{if(!t.isAdult)return[!1,"Not an adult"];const l=KE(t,r.gameState,WI);return l?t.leaderId&&l.id===t.leaderId?[!1,"Stranger is in same tribe - no attack"]:(E.set(o,Vl,l.id),[!0,`Partner cheating with ${l.id}`]):(E.delete(o,Vl),!1)},"Check for Infidelity",e+1),new oe((t,r,o)=>{const l=E.get(o,Vl),s=l&&r.gameState.entities.entities[l];return!s||s.hitpoints<=0?(E.delete(o,Vl),[T.FAILURE,"Target is invalid or dead"]):t.activeAction==="attacking"&&t.attackTargetId===s.id?T.RUNNING:(t.activeAction="attacking",t.attackTargetId=s.id,[T.RUNNING,`Attacking ${s.id}`])},"Execute Jealousy Attack",e+1)],"Jealousy Attack",e)}const Xl="defendAggressor";function G1(e){return new he([new Q((t,r,o)=>{if(!t.isAdult)return[!1,"Not an adult"];const l=ZE(t,r.gameState,YI);return l?(E.set(o,Xl,l.aggressor.id),[!0,`Family member ${l.familyMember.id} attacked by ${l.aggressor.id}`]):(E.delete(o,Xl),!1)},"Check Family Under Attack",e+1),new oe((t,r,o)=>{const l=E.get(o,Xl),s=l&&r.gameState.entities.entities[l];return!s||s.hitpoints<=0?(E.delete(o,Xl),[T.FAILURE,"Target invalid/dead"]):t.activeAction==="attacking"&&t.attackTargetId===s.id?T.RUNNING:(t.activeAction="attacking",t.attackTargetId=s.id,[T.RUNNING,`Attacking aggressor ${s.id}`])},"Execute Family Defense Attack",e+1)],"Defend Family",e)}const Kl="desperateAttackTarget";function x1(e){return new he([new Q(t=>t.hunger>jI,"Is Starving",e+1),new Q((t,r)=>{if(!t.isAdult)return[!1,"Not an adult"];const o=Ne(t,r.gameState,"berryBush",mt,s=>s.food.length>0),l=Ne(t,r.gameState,"corpse",mt,s=>s.food.length>0);return!o&&!l},"No Other Food Available",e+1),new Q((t,r,o)=>{const l=qE(t,r.gameState);return l?(E.set(o,Kl,l.id),[!0,`Found weak target ${l.id}`]):(E.delete(o,Kl),!1)},"Find Weak Target",e+1),new oe((t,r,o)=>{const l=E.get(o,Kl),s=l&&r.gameState.entities.entities[l];return!s||s.hitpoints<=0?(E.delete(o,Kl),[T.FAILURE,"Target is invalid or dead"]):t.activeAction==="attacking"&&t.attackTargetId===s.id?T.RUNNING:(t.activeAction="attacking",t.attackTargetId=s.id,[T.RUNNING,`Desperately attacking ${s.id}`])},"Execute Desperate Attack",e+1)],"Desperate Attack",e)}function $1(e,t,r,o){const l=e.entities.entities[r.targetEntityId];return!l||!("hitpoints"in l)||l.hitpoints<=0?(e.autopilotControls.activeAutopilotAction=void 0,T.FAILURE):Y(t.position,l.position,e.mapDimensions.width,e.mapDimensions.height)<=lu?(t.activeAction="attacking",t.attackTargetId=l.id,e.autopilotControls.activeAutopilotAction=void 0,T.SUCCESS):(t.activeAction="moving",t.target=l.id,t.direction=Ft(t.position,l.position,e.mapDimensions),T.RUNNING)}function z1(e){return new he([new Q((t,r)=>t.isPlayer===!0&&!!r.gameState.autopilotControls.activeAutopilotAction,"Has Player Command",e+1),new oe((t,r)=>{var s;const{gameState:o}=r,l=o.autopilotControls.activeAutopilotAction;if(!l)return T.FAILURE;switch(l.action){case ae.AutopilotMove:{const u=l.position;return Y(t.position,u,o.mapDimensions.width,o.mapDimensions.height)<qI?(o.autopilotControls.activeAutopilotAction=void 0,t.activeAction==="moving"&&(t.activeAction="idle",t.target=void 0),T.SUCCESS):(t.activeAction="moving",t.target=u,t.direction=Ft(t.position,u,o.mapDimensions),T.RUNNING)}case ae.AutopilotGather:{const u=o.entities.entities[l.targetEntityId];return!u||u.food.length===0?(o.autopilotControls.activeAutopilotAction=void 0,T.FAILURE):Y(t.position,u.position,o.mapDimensions.width,o.mapDimensions.height)>xr?(t.activeAction="moving",t.target=u.id,t.direction=Ft(t.position,u.position,o.mapDimensions),T.RUNNING):(t.activeAction="gathering",t.target=u.id,o.autopilotControls.activeAutopilotAction=void 0,T.SUCCESS)}case ae.AutopilotAttack:return $1(o,t,l);case ae.AutopilotProcreate:{const u=o.entities.entities[l.targetEntityId];return!u||u.type!=="human"||!zr(t,u,r.gameState)?(o.autopilotControls.activeAutopilotAction=void 0,T.FAILURE):Y(t.position,u.position,o.mapDimensions.width,o.mapDimensions.height)<=lu?(t.activeAction="procreating",o.autopilotControls.activeAutopilotAction=void 0,T.SUCCESS):(t.activeAction="moving",t.target=u.id,t.direction=Ft(t.position,u.position,o.mapDimensions),T.RUNNING)}case ae.AutopilotPlant:{if(t.activeAction==="planting")return T.RUNNING;const u=l.position;return bn(u,o,Hr,t.id)?(o.autopilotControls.activeAutopilotAction=void 0,T.FAILURE):Y(t.position,u,o.mapDimensions.width,o.mapDimensions.height)<=lu?(t.activeAction="planting",t.target=u,o.autopilotControls.activeAutopilotAction=void 0,o.hasPlayerPlantedBush=!0,T.RUNNING):(t.activeAction="moving",t.target=u,t.direction=Ft(t.position,u,o.mapDimensions),T.RUNNING)}case ae.AutopilotFeedChild:{const u=o.entities.entities[l.targetEntityId];return!u||u.type!=="human"||u.isAdult||t.food.length===0?(o.autopilotControls.activeAutopilotAction=void 0,T.FAILURE):Y(t.position,u.position,o.mapDimensions.width,o.mapDimensions.height)<=lu?(o.autopilotControls.activeAutopilotAction=void 0,t.activeAction="feeding",T.SUCCESS):(t.activeAction="moving",t.target=u.id,t.direction=Ft(t.position,u.position,o.mapDimensions),T.RUNNING)}case ae.AutopilotDeposit:{const u=o.entities.entities[l.targetEntityId];if(!u||u.buildingType!=="storageSpot"||!u.isConstructed)return o.autopilotControls.activeAutopilotAction=void 0,T.FAILURE;const d=u.storageCapacity??0;return(((s=u.storedFood)==null?void 0:s.length)??0)>=d||t.leaderId!==u.ownerId||t.food.length===0?(o.autopilotControls.activeAutopilotAction=void 0,T.FAILURE):Y(t.position,u.position,o.mapDimensions.width,o.mapDimensions.height)<=An?(t.activeAction="depositing",t.target=void 0,o.autopilotControls.activeAutopilotAction=void 0,T.SUCCESS):(t.activeAction="moving",t.target=u.id,t.direction=Ft(t.position,u.position,o.mapDimensions),T.RUNNING)}case ae.AutopilotRetrieve:{const u=o.entities.entities[l.targetEntityId];return!u||u.buildingType!=="storageSpot"||!u.isConstructed||!u.storedFood||u.storedFood.length===0||t.leaderId!==u.ownerId||t.food.length>=t.maxFood?(o.autopilotControls.activeAutopilotAction=void 0,T.FAILURE):Y(t.position,u.position,o.mapDimensions.width,o.mapDimensions.height)<=An?(t.activeAction="retrieving",t.target=void 0,o.autopilotControls.activeAutopilotAction=void 0,T.SUCCESS):(t.activeAction="moving",t.target=u.id,t.direction=Ft(t.position,u.position,o.mapDimensions),T.RUNNING)}case ae.AutopilotFollowMe:{const u=o.entities.entities[l.targetEntityId];return!u||u.type!=="human"||u.id!==u.leaderId?(o.autopilotControls.activeAutopilotAction=void 0,T.FAILURE):Y(t.position,u.position,o.mapDimensions.width,o.mapDimensions.height)<=vv?(o.autopilotControls.activeAutopilotAction=void 0,t.activeAction==="moving"&&(t.activeAction="idle"),T.SUCCESS):(t.activeAction="moving",t.target=u.id,t.direction=Ft(t.position,u.position,o.mapDimensions),T.RUNNING)}default:return o.autopilotControls.activeAutopilotAction=void 0,T.FAILURE}},"Execute Player Command",e+1)],"Player Command Handler",e)}function W1(e){return new he([new Q(t=>!!t.leaderId&&t.leaderId!==t.id,"Is Follower",e+1),new Q((t,r)=>{if(!t.leaderId)return!1;const o=r.gameState.entities.entities[t.leaderId];return!!o&&o.isCallingToFollow===!0},"Is Leader Calling To Follow",e+1),new Q(t=>t.hunger<AI,"Is Not Critically Hungry",e+1),new oe((t,r)=>{if(!t.leaderId)return T.FAILURE;const o=r.gameState.entities.entities[t.leaderId];return o?Y(t.position,o.position,r.gameState.mapDimensions.width,r.gameState.mapDimensions.height)>TI?(t.activeAction="moving",t.target=o.id,t.direction=Ft(t.position,o.position,r.gameState.mapDimensions),T.RUNNING):(t.activeAction==="moving"&&t.target===o.id&&(t.activeAction="idle",t.target=void 0),T.SUCCESS):T.FAILURE},"Execute Follow Leader",e+1)],"Follow Leader Command",e)}const E0="tribeMigrationCheckCooldown";function Y1(e){const t=new he([new Q(o=>!!o.leaderId&&o.leaderId===o.id,"Is Tribe Leader",e+2),new Q((o,l)=>{const s=E.get(o.aiBlackboard,E0);return s?l.gameState.time-s>=Fm:!0},"Is Migration Check Cooldown Over",e+2),new oe((o,l)=>{o.aiBlackboard&&E.set(o.aiBlackboard,E0,l.gameState.time);const s=JE(o,l.gameState);return s?(o.isCallingToFollow=!0,o.callToFollowEndTime=l.gameState.time+da,o.target=s,o.activeAction="moving",T.SUCCESS):T.FAILURE},"Execute Tribe Migration",e+2)],"Tribe Migration Strategy",e+1),r=new Zi(t,js,"Cache Tribe Migration",e+1);return new yi(Fm,r,"Tribe Migration Cooldown",e)}function j1(e){const t=new Q(o=>o.id===o.leaderId,"Is Leader?",e+1),r=new oe((o,l)=>{var g;const{gameState:s}=l,u=ca(o.id,s),d=mu(u),f=Mv(s).filter(m=>m.leaderId!==o.id);for(const m of f){const S=ca(m.leaderId,s),y=mu(S),w=((g=o.diplomacy)==null?void 0:g[m.leaderId])||pt.Friendly;d>y*xI?w!==pt.Hostile&&o.diplomacy&&(o.diplomacy[m.leaderId]=pt.Hostile):w!==pt.Friendly&&o.diplomacy&&(o.diplomacy[m.leaderId]=pt.Friendly)}return T.SUCCESS},"Evaluate Diplomacy",e+2);return new he([t,new yi(UI,r,"Diplomacy Cooldown",e+1)],"Manage Diplomacy",e)}const xs="huntTarget";function V1(e){return new he([new Zi(new Q((r,o,l)=>{if(!r.isAdult)return[!1,"Not an adult"];if(!r.leaderId)return[!1,"Not in a tribe"];const s=Ne(r.position,o.gameState,"prey",SI,()=>!0);return s?(E.set(l,xs,s.id),[!0,"Found prey"]):[!1,"No suitable prey found"]},"Find Prey Target",e+2),FI,"Cache Find Prey",e+1),new sr(new yu(new oe((r,o,l)=>{if(!r.leaderId)return T.FAILURE;const s=E.get(l,xs);if(!s)return T.FAILURE;const u=o.gameState.entities.entities[s];if(!u||u.hitpoints<=0)return E.delete(l,xs),r.activeAction="idle",r.attackTargetId=void 0,T.SUCCESS;const{gameState:d}=o,f=$r(r.leaderId,d);return Y(r.position,f,d.mapDimensions.width,d.mapDimensions.height)>yI?(E.delete(l,xs),r.activeAction="idle",r.attackTargetId=void 0,T.FAILURE):(r.activeAction="attacking",r.attackTargetId=u.id,T.RUNNING)},"Hunt Prey Action",e+3),Ef,"Hunt Prey Timeout",e+2),{taskType:"hunt",maxCapacity:hh,getTargetId:(r,o,l)=>E.get(l,xs)??null},"Tribal Hunt Task",e+1)],"Human Hunt Prey Sequence",e)}const Zl="defendTarget",ef=150;function X1(e){return new he([new Q((t,r,o)=>{if(!t.isAdult)return[!1,"Not an adult - children flee instead"];if(t.hitpoints<=t.maxHitpoints*.3)return[!1,"Too injured to defend"];const{gameState:l}=r;if(t.activeAction==="attacking"&&t.attackTargetId){const u=l.entities.entities[t.attackTargetId];if(u&&u.type==="predator"&&u.hitpoints>0&&Y(t.position,u.position,l.mapDimensions.width,l.mapDimensions.height)<=ef)return E.set(o,Zl,u.id),[!0,"Continuing defense"]}const s=Ne(t,l,"predator",ef,u=>u.hitpoints>0&&(u.isAdult||!1));if(s){const u=Y(t.position,s.position,l.mapDimensions.width,l.mapDimensions.height),d=s.attackTargetId===t.id,f=u<80;if(d||f)return E.set(o,Zl,s.id),[!0,"Predator threat detected"]}return E.set(o,Zl,void 0),[!1,"No predator threat"]},"Detect Predator Threat",e+1),new oe((t,r,o)=>{const l=E.get(o,Zl),s=l&&r.gameState.entities.entities[l];if(!s)return T.FAILURE;const{gameState:u}=r,d=Y(t.position,s.position,u.mapDimensions.width,u.mapDimensions.height);return t.hitpoints<t.maxHitpoints*.3?T.FAILURE:s.hitpoints<=0||d>ef*1.5?(t.activeAction="idle",t.attackTargetId=void 0,T.SUCCESS):(t.activeAction="attacking",t.attackTargetId=s.id,T.RUNNING)},"Defend Against Predator",e+1)],"Human Defend Against Predator",e)}function K1(e){return new he([new Q((t,r,o)=>{const l=Ne(t,r.gameState,"predator",zt*2,()=>!0),s=Ne(t,r.gameState,"human",zt*2,()=>!0);let u=null,d=1/0;if(l){const f=Y(t.position,l.position,r.gameState.mapDimensions.width,r.gameState.mapDimensions.height);f<d&&(d=f,u=l)}if(s){const f=Y(t.position,s.position,r.gameState.mapDimensions.width,r.gameState.mapDimensions.height);f<d&&(d=f,u=s)}return u&&d<zt*1.5?(E.set(o,"fleeThreat",u.id),E.set(o,"fleeDistance",d),!0):!1},"Detect Threat",e+1),new oe((t,r,o)=>{const l=E.get(o,"fleeThreat"),s=l&&r.gameState.entities.entities[l];if(!s)return T.FAILURE;t.activeAction="moving";const u=ze(s.position,t.position,r.gameState.mapDimensions.width,r.gameState.mapDimensions.height),d=nt(u),f=Ln(t.position,Pt(d,RC));return t.target={x:(f.x%r.gameState.mapDimensions.width+r.gameState.mapDimensions.width)%r.gameState.mapDimensions.width,y:(f.y%r.gameState.mapDimensions.height+r.gameState.mapDimensions.height)%r.gameState.mapDimensions.height},t.direction=d,t.fleeCooldown=r.gameState.time+2,T.RUNNING},"Execute Flee",e+1)],"Prey Flee",e)}function Z1(e){return new he([new Q((t,r,o)=>{if(!t.isAdult)return[!1,"Not an adult"];if(t.hunger<=30||t.eatingCooldownTime&&t.eatingCooldownTime>r.gameState.time)return!1;const l=Ne(t,r.gameState,"berryBush",zt*10,s=>s.food.length>0);return l?Y(t.position,l.position,r.gameState.mapDimensions.width,r.gameState.mapDimensions.height)<=zt?(E.set(o,"grazingTarget",l.id),!0):(E.set(o,"grazingTarget",l.id),E.set(o,"needToMoveToTarget",!0),!0):!1},"Find Berry Bush",e+1),new oe((t,r,o)=>{const l=E.get(o,"grazingTarget"),s=l&&r.gameState.entities.entities[l],u=E.get(o,"needToMoveToTarget");if(!s)return T.FAILURE;const d=Y(t.position,s.position,r.gameState.mapDimensions.width,r.gameState.mapDimensions.height);if(d<=zt)return t.activeAction="grazing",t.target=s.id,t.direction={x:0,y:0},E.delete(o,"needToMoveToTarget"),T.RUNNING;if(u||d>zt){t.activeAction="moving",t.target=s.id;const f=Ft(t.position,s.position,r.gameState.mapDimensions);return t.direction=f,T.RUNNING}return T.FAILURE},"Move to Bush or Graze",e+1)],"Prey Graze",e)}function q1(e){const t=new Q((s,u,d)=>{const f=Ne(s,u.gameState,"prey",zt,g=>g.id!==s.id&&g.gender!==s.gender&&!!g.isAdult&&g.age>=na&&g.age<=jd&&!g.isPregnant&&(!g.procreationCooldown||g.procreationCooldown<=0)&&g.hunger<200);return f?(E.set(d,"procreationPartner",f.id),!0):!1},"Find Immediate Partner",e+2),r=new oe((s,u,d)=>{const f=E.get(d,"procreationPartner"),g=f&&u.gameState.entities.entities[f];return g?(s.activeAction="procreating",s.target=g.id,s.direction={x:0,y:0},E.delete(d,"procreationPartner"),T.SUCCESS):T.FAILURE},"Start Procreating",e+2),o=new Q((s,u,d)=>{const f=Ne(s,u.gameState,"prey",zt*10,g=>g.id!==s.id&&g.gender!==s.gender&&!!g.isAdult&&g.age>=na&&g.age<=jd&&!g.isPregnant&&(!g.procreationCooldown||g.procreationCooldown<=0)&&g.hunger<200);return f?(E.set(d,"procreationPartner",f.id),!0):!1},"Locate Distant Partner",e+2),l=new oe((s,u,d)=>{const f=E.get(d,"procreationPartner"),g=f&&u.gameState.entities.entities[f];if(!g)return T.FAILURE;if(Y(s.position,g.position,u.gameState.mapDimensions.width,u.gameState.mapDimensions.height)<=zt)return T.SUCCESS;s.activeAction="moving",s.target=g.id;const S=ze(s.position,g.position,u.gameState.mapDimensions.width,u.gameState.mapDimensions.height);return s.direction=nt(S),T.RUNNING},"Move Towards Partner",e+2);return new he([new Q(s=>!!(s.isAdult&&!s.isPregnant&&s.age>=na&&s.age<=jd&&s.hunger<200&&(!s.procreationCooldown||s.procreationCooldown<=0)),"Is Fertile and Ready",e+1),new Wt([new he([t,r],"Procreate With Immediate Partner",e+2),new he([o,l],"Seek Distant Partner",e+2)],"Find Partner And Procreate",e+1)],"Prey Procreate",e)}const Q1=(e,t,r)=>{const o=t.gameState.search.prey.byProperty("motherId",e.id).filter(u=>!u.isAdult&&u.type==="prey");if(o.length===0)return T.FAILURE;let l=null,s=ku;for(const u of o)u.hunger>=s&&(s=u.hunger,l=u);return l?(E.set(r,"targetChild",l.id),T.SUCCESS):T.FAILURE},J1=(e,t,r)=>{const o=E.get(r,"targetChild"),l=o&&t.gameState.entities.entities[o];return l?Y(e.position,l.position,t.gameState.mapDimensions.width,t.gameState.mapDimensions.height)>Xo?(e.activeAction="moving",e.target=l.id,e.direction=Ft(e.position,l.position,t.gameState.mapDimensions),T.RUNNING):(e.activeAction="feeding",e.target=void 0,E.set(r,"targetChild",void 0),T.SUCCESS):T.FAILURE};function eR(e){return new he([new Q(t=>(t.isAdult&&t.gender==="female"&&t.hunger<80&&(!t.feedChildCooldownTime||t.feedChildCooldownTime<=0))??!1,"Can Feed Child (Female Only)",e+1),new oe(Q1,"Find Hungriest Prey Child",e+1),new oe(J1,"Move To Child and Feed",e+1)],"Feed Prey Child",e)}function tR(e){return new he([new Q(t=>!t.isAdult&&t.hunger>=ku,"Is Hungry Prey Child",e+1),new oe((t,r,o)=>{if(!t.motherId)return T.FAILURE;const l=r.gameState.entities.entities[t.motherId];return l?(E.set(o,"targetParent",l.id),T.SUCCESS):T.FAILURE},"Find Female Parent",e+1),new oe((t,r,o)=>{const l=E.get(o,"targetParent"),s=l&&r.gameState.entities.entities[l];if(!s)return T.FAILURE;const u=Y(t.position,s.position,r.gameState.mapDimensions.width,r.gameState.mapDimensions.height);return t.activeAction="idle",u<=Xo?(t.target=void 0,T.SUCCESS):(t.target=s.id,t.activeAction="moving",T.RUNNING)},"Move To Female Parent",e+1)],"Seek Food From Female Parent",e)}const $s="huntTarget";function nR(e,t,r){if(!(e!=null&&e.aiBlackboard))return!0;const o=`tribal_hunt_${t}`,l=E.get(e.aiBlackboard,o);return!l||r-l.startTime>xo?!0:l.memberIds.length<(l.maxCapacity||hh)}function iR(e,t){if(!(e!=null&&e.aiBlackboard))return 0;const r=`tribal_hunt_${t}`,o=E.get(e.aiBlackboard,r);return(o==null?void 0:o.memberIds.length)??0}function rR(e){return new he([new Q((t,r,o)=>{if(!t.isAdult)return[!1,"Not an adult"];if(t.hunger<=50||t.huntCooldown&&t.huntCooldown>0)return!1;const l=Ne(t,r.gameState,"prey",wo*10,s=>{if(s.hitpoints<=0)return!1;const u=va(t,r.gameState);return!(u&&!nR(u,s.id,r.gameState.time))});if(l){const s=Y(t.position,l.position,r.gameState.mapDimensions.width,r.gameState.mapDimensions.height),u=va(t,r.gameState),d=u?iR(u,l.id):0;if(s<=wo)return E.set(o,$s,l.id),[!0,`Prey in range (${d} hunters)`];if(s<=wo*10)return E.set(o,$s,l.id),E.set(o,"needToApproach",!0),[!0,`Approaching prey (${d} hunters)`]}return!1},"Find Prey Target",e+1),new sr(new yu(new oe((t,r,o)=>{const l=E.get(o,$s),s=l&&r.gameState.entities.entities[l],u=E.get(o,"needToApproach");if(!s||s.hitpoints<=0)return E.delete(o,$s),E.delete(o,"needToApproach"),T.SUCCESS;const d=Y(t.position,s.position,r.gameState.mapDimensions.width,r.gameState.mapDimensions.height);if(d<=wo)return t.activeAction="attacking",t.attackTargetId=s.id,t.target=s.id,t.direction={x:0,y:0},E.delete(o,"needToApproach"),T.RUNNING;if(u||d>wo){t.activeAction="moving",t.target=s.id;const f=ze(t.position,s.position,r.gameState.mapDimensions.width,r.gameState.mapDimensions.height);return t.direction=nt(f),T.RUNNING}return T.FAILURE},"Hunt or Approach Prey",e+3),10,"Hunt Timeout (10 hour)",e+2),{taskType:"hunt",maxCapacity:hh,getTargetId:(t,r,o)=>E.get(o,$s)},"Tribal Hunt Decorator",e+1)],"Predator Hunt",e)}function oR(e){return new he([new Q((t,r,o)=>{const l=t.hunger>100,s=t.hitpoints<t.maxHitpoints*.5;if(!l&&!s||t.attackCooldown&&t.attackCooldown>0)return!1;const u=Ne(t,r.gameState,"human",kn*2,d=>d.hitpoints>0);if(u){const d=Y(t.position,u.position,r.gameState.mapDimensions.width,r.gameState.mapDimensions.height);if(d<=kn)return E.set(o,"attackTarget",u.id),!0;if(l&&d<=kn*2)return E.set(o,"attackTarget",u.id),E.set(o,"needToApproach",!0),!0}return!1},"Find Human Target",e+1),new oe((t,r,o)=>{const l=E.get(o,"attackTarget"),s=l&&r.gameState.entities.entities[l],u=E.get(o,"needToApproach");if(!s||s.hitpoints<=0)return T.FAILURE;const d=Y(t.position,s.position,r.gameState.mapDimensions.width,r.gameState.mapDimensions.height);if(d<=kn)return t.activeAction="attacking",t.attackTargetId=s.id,t.target=s.id,t.direction={x:0,y:0},E.delete(o,"needToApproach"),T.RUNNING;if(u||d>kn){t.activeAction="moving",t.target=s.id;const f=ze(t.position,s.position,r.gameState.mapDimensions.width,r.gameState.mapDimensions.height);return t.direction=nt(f),T.RUNNING}return T.FAILURE},"Attack or Approach Human",e+1)],"Predator Attack Human",e)}function sR(e){const t=new Q((s,u,d)=>{const f=Ne(s,u.gameState,"predator",nr,g=>g.id!==s.id&&g.gender!==s.gender&&!!g.isAdult&&g.age>=ia&&g.age<=Vd&&!g.isPregnant&&(!g.procreationCooldown||g.procreationCooldown<=0)&&g.hunger<200);return f?(E.set(d,"procreationPartner",f.id),!0):!1},"Find Immediate Partner",e+2),r=new oe((s,u,d)=>{const f=E.get(d,"procreationPartner"),g=f&&u.gameState.entities.entities[f];return g?(s.activeAction="procreating",s.target=g.id,s.direction={x:0,y:0},E.delete(d,"procreationPartner"),T.SUCCESS):T.FAILURE},"Start Procreating",e+2),o=new Q((s,u,d)=>{const f=Ne(s,u.gameState,"predator",nr*10,g=>g.id!==s.id&&g.gender!==s.gender&&!!g.isAdult&&g.age>=ia&&g.age<=Vd&&!g.isPregnant&&(!g.procreationCooldown||g.procreationCooldown<=0)&&g.hunger<200);return f?(E.set(d,"procreationPartner",f.id),!0):!1},"Locate Distant Partner",e+2),l=new oe((s,u,d)=>{const f=E.get(d,"procreationPartner"),g=f&&u.gameState.entities.entities[f];if(!g)return T.FAILURE;if(Y(s.position,g.position,u.gameState.mapDimensions.width,u.gameState.mapDimensions.height)<=nr)return T.SUCCESS;s.activeAction="moving",s.target=g.id;const S=ze(s.position,g.position,u.gameState.mapDimensions.width,u.gameState.mapDimensions.height);return s.direction=nt(S),T.RUNNING},"Move Towards Partner",e+2);return new he([new Q(s=>!!(s.isAdult&&!s.isPregnant&&s.age>=ia&&s.age<=Vd&&s.hunger<200&&(!s.procreationCooldown||s.procreationCooldown<=0)),"Is Fertile and Ready",e+1),new Wt([new he([t,r],"Procreate With Immediate Partner",e+2),new he([o,l],"Seek Distant Partner",e+2)],"Find Partner And Procreate",e+1)],"Predator Procreate",e)}const aR=(e,t,r)=>{const o=t.gameState.search.predator.byProperty("motherId",e.id).filter(u=>!u.isAdult&&u.type==="predator");if(o.length===0)return T.FAILURE;let l=null,s=ku;for(const u of o)u.hunger>=s&&(s=u.hunger,l=u);return l?(E.set(r,"targetChild",l.id),T.SUCCESS):T.FAILURE},lR=(e,t,r)=>{const o=E.get(r,"targetChild"),l=o&&t.gameState.entities.entities[o];return l?Y(e.position,l.position,t.gameState.mapDimensions.width,t.gameState.mapDimensions.height)>Xo?(e.activeAction="moving",e.target=l.id,e.direction=Ft(e.position,l.position,t.gameState.mapDimensions),T.RUNNING):(e.activeAction="feeding",e.target=void 0,E.set(r,"targetChild",void 0),T.SUCCESS):T.FAILURE};function uR(e){return new he([new Q(t=>(t.isAdult&&t.gender==="female"&&t.hunger<90&&(!t.feedChildCooldownTime||t.feedChildCooldownTime<=0))??!1,"Can Feed Child (Female Only)",e+1),new oe(aR,"Find Hungriest Predator Child",e+1),new oe(lR,"Move To Child and Feed",e+1)],"Feed Predator Child",e)}function cR(e){return new he([new Q(t=>!t.isAdult&&t.hunger>=ku,"Is Hungry Predator Child",e+1),new oe((t,r,o)=>{if(!t.motherId)return T.FAILURE;const l=r.gameState.entities.entities[t.motherId];return l?(E.set(o,"targetParent",l.id),T.SUCCESS):T.FAILURE},"Find Female Parent",e+1),new oe((t,r,o)=>{const l=E.get(o,"targetParent"),s=l&&r.gameState.entities.entities[l];if(!s)return T.FAILURE;const u=Y(t.position,s.position,r.gameState.mapDimensions.width,r.gameState.mapDimensions.height);return t.activeAction="idle",u<=Xo?(t.target=void 0,T.SUCCESS):(t.target=s.id,t.activeAction="moving",T.RUNNING)},"Move To Female Parent",e+1)],"Seek Food From Female Parent",e)}function yS(e){return new oe((t,r,o)=>{t.activeAction="idle";let l=E.get(o,"wanderTarget"),s=E.get(o,"wanderStartTime");const u=r.gameState.time;if(!l||!s||u-s>2){const d=Math.random()*2*Math.PI,f=50+Math.random()*100,g={x:Math.cos(d),y:Math.sin(d)},m=Ln(t.position,Pt(g,f));l={x:(m.x%r.gameState.mapDimensions.width+r.gameState.mapDimensions.width)%r.gameState.mapDimensions.width,y:(m.y%r.gameState.mapDimensions.height+r.gameState.mapDimensions.height)%r.gameState.mapDimensions.height},E.set(o,"wanderTarget",l),E.set(o,"wanderStartTime",u)}if(l){t.target=l;let d=l.x-t.position.x,f=l.y-t.position.y;const g=r.gameState.mapDimensions.width,m=r.gameState.mapDimensions.height;Math.abs(d)>g/2&&(d=d>0?d-g:d+g),Math.abs(f)>m/2&&(f=f>0?f-m:f+m);const S=nt({x:d,y:f});t.direction=S}return T.SUCCESS},"Animal Wander",e)}function dR(e){return new he([new Q((t,r,o)=>{if(t.hunger>90||t.hitpoints<t.maxHitpoints*.3||t.activeAction==="grazing"||t.activeAction==="procreating")return!1;const l=Object.values(r.gameState.entities.entities),s=[];for(const u of l)if(u.type==="prey"&&u.id!==t.id){const d=u;d.hitpoints>0&&d.isAdult&&Y(t.position,d.position,r.gameState.mapDimensions.width,r.gameState.mapDimensions.height)<=zt*5&&s.push(d)}if(s.length>=2){let u=0,d=0;for(const m of s)u+=m.position.x,d+=m.position.y;u/=s.length,d/=s.length;const f={x:u,y:d};if(Y(t.position,f,r.gameState.mapDimensions.width,r.gameState.mapDimensions.height)>zt*2)return E.set(o,"herdCenter",f),E.set(o,"herdSize",s.length),!0}return!1},"Find Herd",e+1),new oe((t,r,o)=>{const l=E.get(o,"herdCenter");if(!l)return T.FAILURE;if(Y(t.position,l,r.gameState.mapDimensions.width,r.gameState.mapDimensions.height)>zt*2){t.activeAction="moving",t.target=l;const u=ze(t.position,l,r.gameState.mapDimensions.width,r.gameState.mapDimensions.height);return t.direction=nt(u),T.RUNNING}else return t.activeAction="idle",t.direction={x:0,y:0},T.SUCCESS},"Join Herd",e+1)],"Prey Herd Behavior",e)}function fR(e){return new he([new Q((t,r,o)=>{if(t.hunger>100||t.hitpoints<t.maxHitpoints*.4||t.activeAction==="attacking"||t.activeAction==="procreating")return!1;const l=Ne(t,r.gameState,"predator",nr*4,s=>s.id!==t.id&&s.hitpoints>0&&s.isAdult&&t.fatherId!==void 0&&s.fatherId===t.fatherId&&s.age>=t.age||s.hitpoints>t.hitpoints);return l&&Y(t.position,l.position,r.gameState.mapDimensions.width,r.gameState.mapDimensions.height)>nr*2?(E.set(o,"packLeader",l.id),!0):!1},"Find Pack Leader",e+1),new oe((t,r,o)=>{const l=E.get(o,"packLeader"),s=l&&r.gameState.entities.entities[l];if(!s||s.hitpoints<=0)return T.FAILURE;if(Y(t.position,s.position,r.gameState.mapDimensions.width,r.gameState.mapDimensions.height)>nr*2){t.activeAction="moving",t.target=s.id;const d=ze(t.position,s.position,r.gameState.mapDimensions.width,r.gameState.mapDimensions.height);return t.direction=nt(d),T.RUNNING}else return t.activeAction="idle",t.direction={x:0,y:0},T.SUCCESS},"Follow Pack Leader",e+1)],"Predator Pack Behavior",e)}function hR(e){return new he([new Q((t,r,o)=>{if(!t.isAdult||t.hitpoints<t.maxHitpoints*.6||t.hunger>120||t.attackCooldown&&t.attackCooldown>0)return!1;const l=Ne(t,r.gameState,"predator",m0,s=>!!(s.id!==t.id&&s.hitpoints>0&&s.isAdult&&t.fatherId!==s.fatherId&&t.gender===s.gender&&t.fatherId!==void 0&&s.fatherId!==void 0));if(l){const s=Y(t.position,l.position,r.gameState.mapDimensions.width,r.gameState.mapDimensions.height);if(s<=kn)return E.set(o,"territorialTarget",l.id),!0;if(s<=m0)return E.set(o,"territorialTarget",l.id),E.set(o,"needToApproach",!0),!0}return!1},"Find Territorial Rival",e+1),new oe((t,r,o)=>{const l=E.get(o,"territorialTarget"),s=l&&r.gameState.entities.entities[l],u=E.get(o,"needToApproach");if(!s||s.hitpoints<=0)return T.FAILURE;const d=Y(t.position,s.position,r.gameState.mapDimensions.width,r.gameState.mapDimensions.height);if(d<=kn)return t.activeAction="attacking",t.attackTargetId=s.id,t.target=s.id,t.direction={x:0,y:0},E.delete(o,"needToApproach"),T.RUNNING;if(u||d>kn){t.activeAction="moving",t.target=s.id;const f=ze(t.position,s.position,r.gameState.mapDimensions.width,r.gameState.mapDimensions.height);return t.direction=nt(f),T.RUNNING}return T.FAILURE},"Territorial Fight or Approach",e+1)],"Predator Territorial Defense",e)}function gR(){const e=new Wt([c1(2),G1(2),new sn(X1(2),"attack","Gated Defend Against Predator",2),new sn(b1(2),"attack","Gated Jealousy Attack",2),new sn(x1(2),"attack","Gated Desperate Attack",2),z1(2),new wr(N1(3),"Gated Leader Combat Strategy",2),new wr(j1(3),"Gated Diplomacy",2),new wr(new Wt([new Zi(F1(5),js,"Cache Take Over Building",4),new Zi(U1(5),js,"Cache Remove Enemy Building",4)],"Building Interaction Selector",3),"Gated Leader Building Interactions",2),new wr(new Zi(k1(4),lE,"Cache Building Placement",3),"Gated Leader Building Placement",2),D1(2),new sn(P1(3),"attack","Gated Storage Steal",2),new sn(S1(3),"attack","Gated Attacking",2),u1(2),new sn(R1(3),"gathering","Gated Storage Retrieve",2),new yu(new sn(p1(4),"gathering","Gated Gathering",3),Ef,"Timeout Gathering",2),new sn(C1(3),"gathering","Gated Storage Deposit",2),new sn(A1(3),"feedChildren","Gated Feed Child",2),I1(2),new sn(v1(3),"procreation","Gated Procreation",2),new yu(new sn(_1(4),"planting","Gated Planting",3),Ef,"Timeout Planting",2),new sn(V1(3),"attack","Gated Hunt Prey",2),new Zi(H1(3),js,"Cache Tribe Split",2),new wr(Y1(3),"Gated Tribe Migration",2),new Zi(L1(3),js,"Cache Establish Territory",2),new sn(W1(3),"followLeader","Gated Follow Leader",2),new wr(B1(2),"Gated Follow Patriarch",2),new wr(m1(2),"Gated Idle Wander",2)],"AI Root Selector",1);return new a1(e,"Manual Control Gate",0)}const TS=gR();function pR(e,t){e.aiBlackboard&&E.cleanupOldEntries(e.aiBlackboard,t.gameState.time);const r=va(e,t.gameState);r&&r.id===e.id&&r.aiBlackboard&&l1(r,t.gameState.time);const o=performance.now();switch(e.aiType){case Ea.BehaviorTreeBased:default:fh(e,t,TS);break}t.gameState.performanceMetrics.currentBucket.aiUpdateTime+=performance.now()-o}function mR(){return new Wt([K1(1),eR(1),tR(1),Z1(1),q1(1),dR(1),yS(1)],"Prey Behavior Root",0)}function vR(){return new Wt([rR(1),oR(1),uR(1),cR(1),hR(1),sR(1),fR(1),yS(1)],"Predator Behavior Root",0)}const AS=mR();function SR(e,t){e.aiBlackboard?fh(e,t,AS):(console.warn(`Behavior Tree AI ticked for prey ${e.id}, but the tree or blackboard was missing.`),e.activeAction="idle")}const IS=vR();function yR(e,t){e.aiBlackboard?fh(e,t,IS):(console.warn(`Behavior Tree AI ticked for predator ${e.id}, but the tree or blackboard was missing.`),e.activeAction="idle")}function TR(e,t){const{gameState:r,deltaTime:o}=t,l=o*(It/Et);if(e.isBeingDestroyed){const s=W_(e.buildingType);if(s>0?e.destructionProgress+=l/s:e.destructionProgress=1,e.destructionProgress>=1){Zo(r.entities,e.id);return}}if(!e.isConstructed&&!e.isBeingDestroyed){const s=z_(e.buildingType);s>0?e.constructionProgress+=l/s:e.constructionProgress=1,e.constructionProgress>=1&&(e.constructionProgress=1,e.isConstructed=!0)}}function AR(e,t){e.forces.push(Pt(e.velocity,-.1));const r=Pt(nt(e.direction),e.acceleration);e.forces.push(r),e.debuffs.forEach(o=>{t.gameState.time-o.startTime<o.duration&&o.type==="slow"&&(e.velocity=Pt(e.velocity,.5))}),e.debuffs=e.debuffs.filter(o=>t.gameState.time-o.startTime<o.duration),e.velocity=Ln(e.velocity,e.forces.reduce(Ln,{x:0,y:0})),Ho(e.velocity)<.001&&(e.velocity={x:0,y:0}),e.position=Ln(e.position,Pt(e.velocity,t.deltaTime)),e.position.x=(e.position.x%t.gameState.mapDimensions.width+t.gameState.mapDimensions.width)%t.gameState.mapDimensions.width,e.position.y=(e.position.y%t.gameState.mapDimensions.height+t.gameState.mapDimensions.height)%t.gameState.mapDimensions.height,e.forces=[],e.type==="human"?t1(e,t,t.deltaTime):e.type==="corpse"?n1(e,t):e.type==="prey"?i1(e,t,t.deltaTime):e.type==="predator"?r1(e,t,t.deltaTime):e.type==="building"&&TR(e,t),e.type==="human"&&pR(e,t),e.type==="prey"?SR(e,t):e.type==="predator"&&yR(e,t),e.stateMachine&&(e.stateMachine=e1(...e.stateMachine,{entity:e,updateContext:t}))}function IR(e){const t=e.gameState.entities;Object.values(t.entities).forEach(r=>{AR(r,e)})}function ES(){return{entities:{},nextEntityId:1}}function Ko(e,t,r){const o={id:e.nextEntityId++,type:t,velocity:{x:0,y:0},direction:{x:0,y:0},acceleration:0,forces:[],debuffs:[],...r};return e.entities[o.id]=o,o}function wa(e,t,r){return Ko(e,"berryBush",{position:t,radius:Af,food:Array.from({length:uI},()=>({type:Bn.Berry})).map(l=>({...l,id:e.nextEntityId++})),maxFood:lI,lifespan:dI,age:0,spreadRadius:Af,timeSinceLastBerryRegen:0,timeSinceLastSpreadAttempt:0,timeSinceLastHarvest:0,stateMachine:[qs,{enteredAt:r,previousState:void 0}]})}function Tu(e,t,r,o,l=!1,s=vE,u=_v,d,f,g=[],m,S){const y=s>=Yf;return Ko(e,"human",{position:t,radius:y?wt:jo,hunger:u,hitpoints:Wm,maxHitpoints:Wm,age:s,gender:o,isPlayer:l,food:[],maxFood:wv,maxAge:ua,isAdult:y,isPregnant:!1,gestationTime:0,procreationCooldown:0,attackCooldown:0,motherId:d,fatherId:f,ancestorIds:g,stateMachine:[ct,{enteredAt:r,previousState:void 0}],leaderId:m,tribeBadge:S,aiType:Ea.BehaviorTreeBased,aiBlackboard:E.create()})}function gh(e,t,r,o,l,s,u,d,f,g,m){let S,y;switch(u){case"human":S=Pv,y=Gr;break;case"prey":S=2,y=120;break;case"predator":S=4,y=140;break}return Ko(e,"corpse",{position:t,radius:l,gender:r,age:o,originalEntityId:s,originalEntityType:u,timeOfDeath:d,decayProgress:0,geneCode:m,food:[...Array.from({length:Math.max(S*Math.max(y-g,0)/y,0)},()=>({type:Bn.Meat})),...f].map(A=>({...A,id:e.nextEntityId++})),stateMachine:void 0})}function ER(e,t,r,o,l,s,u,d,f){return gh(e,t,r,o,l,s,"human",u,d,f)}function wR(e,t,r,o,l,s,u,d){return gh(e,t,r,o,l,s,"prey",u,[],0,d)}function _R(e,t,r,o,l,s,u,d){return gh(e,t,r,o,l,s,"predator",u,[],0,d)}function CR(e,t,r){const o=t?r.gameState.entities.entities[t]:void 0,l=[...e.ancestorIds||[],e.id],s=o?[...o.ancestorIds||[],o.id]:[],u=[...l,...s],d=[...new Set(u)],f=d.slice(Math.max(d.length-hE,0)),g=Math.random()<.5?"male":"female",m=Ln(e.position,{x:5,y:5}),S=Tu(r.gameState.entities,m,r.gameState.time,g,!1,0,_v/2,e.id,t,f,(o==null?void 0:o.leaderId)??e.leaderId,(o==null?void 0:o.tribeBadge)??e.tribeBadge);return Ie(r,fe.Birth,e.position),S}function Zo(e,t){return e.entities[t]?(delete e.entities[t],!0):!1}function $o(e,t,r,o=CC,l=lS,s,u,d){const f=o>=na,g=Date.now();return Ko(e,"prey",{position:t,radius:f?wt*.7:jo*.7,hunger:l,hitpoints:g0,maxHitpoints:g0,age:o,maxAge:aS,gender:r,isAdult:f,isPregnant:!1,gestationTime:0,procreationCooldown:0,geneCode:s,motherId:u,fatherId:d,stateMachine:[Mn,{enteredAt:g,previousState:void 0}],aiType:Ea.BehaviorTreeBased,aiBlackboard:E.create()})}function zo(e,t,r,o=FC,l=cS,s,u,d){const f=o>=ia,g=Date.now();return Ko(e,"predator",{position:t,radius:f?wt*.9:jo*.9,hunger:l,hitpoints:p0,maxHitpoints:p0,age:o,maxAge:uS,gender:r,isAdult:f,isPregnant:!1,gestationTime:0,procreationCooldown:0,geneCode:s,motherId:u,fatherId:d,stateMachine:[$t,{enteredAt:g,previousState:void 0}],aiType:Ea.BehaviorTreeBased,aiBlackboard:E.create()})}function RR(e,t,r,o){const l=tS(r),s={position:t,radius:Math.max(l.width,l.height)/2,buildingType:r,ownerId:o,width:l.width,height:l.height,constructionProgress:0,destructionProgress:0,isConstructed:!1,isBeingDestroyed:!1};return Ko(e,"building",{...s,...r===On.StorageSpot&&{storedFood:[],storageCapacity:U_,lastDepositTime:0,lastRetrieveTime:0,lastStealTime:0}})}var Gt=(e=>(e.MOVE="MOVE",e.HUNGER="HUNGER",e.EAT="EAT",e.FIND_BUSH="FIND_BUSH",e.GATHER="GATHER",e.PROCREATE="PROCREATE",e.PLANT_BUSH="PLANT_BUSH",e.AUTOPILOT="AUTOPILOT",e.ANIMALS_INTRODUCTION="ANIMALS_INTRODUCTION",e.HUNT_PREY="HUNT_PREY",e.DEFEND_FROM_PREDATORS="DEFEND_FROM_PREDATORS",e))(Gt||{}),Lr=(e=>(e.HUNGER_BAR="HUNGER_BAR",e.FOOD_BAR="FOOD_BAR",e.COMMAND_BUTTONS="COMMAND_BUTTONS",e))(Lr||{}),xt=(e=>(e[e.FADING_IN=0]="FADING_IN",e[e.ACTIVE=1]="ACTIVE",e[e.FADING_OUT=2]="FADING_OUT",e[e.INACTIVE=3]="INACTIVE",e))(xt||{});const Pf={},Nf={},PR=[{key:Gt.MOVE,title:"Movement",text:"Use WASD or Arrow Keys to move your character around the world.",condition:e=>e.hasPlayerMovedEver||e.hasPlayerEnabledAutopilot>2,isCompleted:!1},{key:Gt.HUNGER,title:"Hunger",text:"Your character gets hungry over time. Watch the hunger bar!",condition:(e,t)=>t.hunger>gE,isCompleted:!1,minDisplayTime:s0,highlightedUIElements:[Lr.HUNGER_BAR]},{key:Gt.FIND_BUSH,title:"Find Food",text:"Look for berry bushes. They are your primary source of food.",condition:(e,t)=>!!Ne(t,e,"berryBush",mt*5,o=>o.food.length>0),getTargets:(e,t)=>{const r=[];for(const o of Object.values(e.entities.entities))o.type==="berryBush"&&o.food.length>0&&Y(t.position,o.position,e.mapDimensions.width,e.mapDimensions.height)<500&&r.push(o);return r.map(o=>o.id)},isCompleted:!1,minDisplayTime:s0},{key:Gt.GATHER,title:"Gather Berries",text:"Get close to a bush and press 'E' to gather berries.",condition:(e,t)=>t.food.length>0,getTargets:(e,t)=>{const r=Ne(t,e,"berryBush",mt,o=>o.food.length>0);return r?[r.id]:[]},isCompleted:!1},{key:Gt.EAT,title:"Eat",text:"When you are hungry and have food, press 'F' to eat.",condition:(e,t)=>t.activeAction==="eating",isCompleted:!1,highlightedUIElements:[Lr.FOOD_BAR]},{key:Gt.PROCREATE,title:"Procreate",text:"Find a mate and press 'R' to start a family. This is how you continue your lineage.",condition:(e,t)=>Lt(e,t).length>0,getTargets:(e,t)=>{const r=Ne(t,e,"human",mt,o=>zr(t,o,e));return r?[r.id]:[]},isCompleted:!1},{key:Gt.PLANT_BUSH,title:"Farming",text:"You can plant new berry bushes. Carry some berries and press 'B' to plant.",condition:(e,t)=>lh(e,t).some(o=>o.type===ae.Plant)||e.hasPlayerPlantedBush===!0,isCompleted:!1},{key:Gt.AUTOPILOT,title:"Autopilot!",text:"You can turn autopilot for specific actions, press Shift and click on the action button to enable it.",condition:e=>e.hasPlayerEnabledAutopilot>2,highlightedUIElements:[Lr.COMMAND_BUTTONS],isCompleted:!1},{key:Gt.ANIMALS_INTRODUCTION,title:"Wild Animals!",text:"Your world now has wild animals! Prey provide meat when hunted, but beware of predators that may attack.",condition:e=>Object.values(e.entities.entities).some(r=>r.type==="prey"||r.type==="predator"),isCompleted:!1,dependsOn:Gt.AUTOPILOT},{key:Gt.HUNT_PREY,title:"Hunt for Meat",text:"Click on prey animals to hunt them for meat. Hunting provides more food than gathering berries!",condition:(e,t)=>{const r=Ne(t,e,"prey",150);return t.hunger>40&&!!r},getTargets:(e,t)=>{const r=Ne(t,e,"prey",150);return r?[r.id]:[]},isCompleted:!1,dependsOn:Gt.ANIMALS_INTRODUCTION},{key:Gt.DEFEND_FROM_PREDATORS,title:"Predators",text:"Predators may attack when hungry! Click on them to fight back. Fighting together with family is more effective.",condition:(e,t)=>!!Ne(t,e,"predator",120),getTargets:(e,t)=>{const r=Ne(t,e,"predator",120);return r?[r.id]:[]},isCompleted:!1,dependsOn:Gt.HUNT_PREY}].map(e=>({...e,condition:e.condition?OR(e.condition):void 0,getTargets:e.getTargets?MR(e.getTargets):void 0}));function wS(){return{steps:PR.map(e=>({...e,isCompleted:!1}))}}function _S(){return{currentStepIndex:0,completedSteps:[],isActive:!0,transitionState:xt.FADING_IN,transitionAlpha:0,highlightedEntityIds:[],stepStartTime:null,activeUIHighlights:[]}}function NR(e){for(let t=0;t<e.tutorial.steps.length;t++){const r=e.tutorial.steps[t];if(!r.isCompleted)if(r.dependsOn){if(e.tutorialState.completedSteps.includes(r.dependsOn))return t}else return t}return null}function DR(e,t){const r=e.tutorialState;if(!r.isActive){r.transitionState=xt.INACTIVE,r.highlightedEntityIds=[],r.activeUIHighlights=[];return}const o=vt(e);if(!o){r.isActive=!1,r.transitionState=xt.INACTIVE,r.highlightedEntityIds=[],r.activeUIHighlights=[];return}const l=e.tutorial.steps[r.currentStepIndex];if(!l){r.isActive=!1,r.transitionState=xt.INACTIVE,r.highlightedEntityIds=[],r.activeUIHighlights=[];return}const s=1/Xw;switch(r.transitionState){case xt.FADING_IN:r.stepStartTime===null&&(r.stepStartTime=e.time),r.transitionAlpha+=s*t,r.transitionAlpha>=1&&(r.transitionAlpha=1,r.transitionState=xt.ACTIVE);break;case xt.ACTIVE:{const f=e.time-(r.stepStartTime||e.time)>=(l.minDisplayTime||0),g=Pf[l.condition];g&&f&&g(e,o)&&(l.isCompleted=!0,r.completedSteps.includes(l.key)||r.completedSteps.push(l.key),r.transitionState=xt.FADING_OUT);break}case xt.FADING_OUT:if(r.transitionAlpha-=s*t,r.transitionAlpha<=0){r.transitionAlpha=0,r.stepStartTime=null;const d=NR(e);d!==null?(r.currentStepIndex=d,r.transitionState=xt.FADING_IN):(r.isActive=!1,r.transitionState=xt.INACTIVE)}break}if(r.transitionState!==xt.FADING_OUT&&r.transitionState!==xt.INACTIVE){const d=Nf[l.getTargets||""];d?r.highlightedEntityIds=[...d(e,o)]:r.highlightedEntityIds=[],l.highlightedUIElements?r.activeUIHighlights=[...l.highlightedUIElements]:r.activeUIHighlights=[]}else r.highlightedEntityIds=[],r.activeUIHighlights=[]}function OR(e){const t=`condition_${Object.keys(Pf).length+1}`;return Pf[t]=e,t}function MR(e){const t=`getTargets_${Object.keys(Nf).length+1}`;return Nf[t]=e,t}function kR(){const e=ES(),t=0;for(let S=0;S<mv;S++){const y={x:Math.random()*et,y:Math.random()*tt};wa(e,y,t)}const r=et/2,o=tt/2,l=Tu(e,{x:r,y:o},t,"male",!0);Tu(e,{x:r+50,y:o},t,"female",!1);for(let S=0;S<hS;S++){const y={x:r+et*(Math.random()-Math.random()),y:o+tt*(Math.random()-Math.random())};$o(e,y,"male",void 0,void 0,pa()),$o(e,{x:y.x+20,y:y.y},"female",void 0,void 0,pa())}const s={x:r+et*(Math.random()-Math.random()),y:o+tt*(Math.random()-Math.random())};zo(e,s,"male",void 0,void 0,ma()),zo(e,{x:s.x+20,y:s.y},"female",void 0,void 0,ma());const u=[{id:"muteButton",action:pe.ToggleMute,currentWidth:hi,rect:{x:0,y:0,width:0,height:0},text:"",backgroundColor:"",textColor:yn},{id:"pauseButton",action:pe.TogglePause,currentWidth:hi,rect:{x:0,y:0,width:0,height:0},text:"",backgroundColor:"",textColor:yn},{id:"returnToIntroButton",action:pe.ReturnToIntro,currentWidth:hi,rect:{x:0,y:0,width:0,height:0},text:"EXIT",backgroundColor:"",textColor:yn}],d=wS(),f=_S(),g={time:t,entities:e,mapDimensions:{width:et,height:tt},generationCount:1,gameOver:!1,visualEffects:[],nextVisualEffectId:0,viewportCenter:{...l.position},isPaused:!1,exitConfirmation:"inactive",autopilotControls:{behaviors:{procreation:!1,planting:!1,gathering:!1,attack:!1,feedChildren:!0,followLeader:!1},hoveredAutopilotAction:void 0,activeAutopilotAction:void 0,isManuallyMoving:!1},buildMenuOpen:!1,selectedBuildingType:null,selectedBuildingForRemoval:null,hasPlayerMovedEver:!1,hasPlayerPlantedBush:!1,hasPlayerEnabledAutopilot:0,masterVolume:Jv,isMuted:!1,uiButtons:u,tutorial:d,tutorialState:f,debugPanel:Rt.None,performanceMetrics:{currentBucket:{renderTime:0,worldUpdateTime:0,aiUpdateTime:0},history:[]},hoveredButtonId:void 0,mousePosition:{x:0,y:0},notifications:[{id:"welcome",type:fa.Hello,message:"Welcome to the game!",duration:50,targetEntityIds:[l.id],highlightedEntityIds:[l.id],timestamp:0,isDismissed:!1,creationTime:Date.now()}],ecosystem:{preyGestationPeriod:Or,preyProcreationCooldown:Mr,predatorGestationPeriod:kr,predatorProcreationCooldown:Fr,preyHungerIncreasePerHour:Qi,predatorHungerIncreasePerHour:Ji,berryBushSpreadChance:vi},autosaveIntervalSeconds:5,lastAutosaveTime:Date.now()},m=Iu(g);return console.log("Game world initialized:",m),m}function FR(){const e=ES(),t=0;for(let u=0;u<mv;u++){const d={x:Math.random()*et,y:Math.random()*tt};wa(e,d,t)}for(let u=0;u<oI;u++){const d={x:Math.random()*et,y:Math.random()*tt},f=Math.random()<.5?"male":"female";Tu(e,d,t,f,!1)}for(let u=0;u<hS;u++){const d={x:Math.random()*et,y:Math.random()*tt};$o(e,d,"male",void 0,void 0,pa()),$o(e,{x:d.x+20,y:d.y},"female",void 0,void 0,pa())}const r={x:Math.random()*et,y:Math.random()*tt};zo(e,r,"male",void 0,void 0,ma()),zo(e,{x:r.x+20,y:r.y},"female",void 0,void 0,ma());const o=wS(),l=_S(),s={time:t,entities:e,mapDimensions:{width:et,height:tt},generationCount:0,gameOver:!1,visualEffects:[],nextVisualEffectId:0,viewportCenter:{x:et/2,y:tt/2},isPaused:!1,exitConfirmation:"inactive",autopilotControls:{behaviors:{procreation:!1,planting:!1,gathering:!1,attack:!1,feedChildren:!0,followLeader:!1},hoveredAutopilotAction:void 0,activeAutopilotAction:void 0,isManuallyMoving:!1},buildMenuOpen:!1,selectedBuildingType:null,selectedBuildingForRemoval:null,hasPlayerMovedEver:!1,hasPlayerPlantedBush:!1,hasPlayerEnabledAutopilot:0,masterVolume:Jv,isMuted:!0,uiButtons:[],tutorial:o,tutorialState:l,debugPanel:Rt.None,performanceMetrics:{currentBucket:{renderTime:0,worldUpdateTime:0,aiUpdateTime:0},history:[]},hoveredButtonId:void 0,mousePosition:{x:0,y:0},notifications:[],ecosystem:{preyGestationPeriod:Or,preyProcreationCooldown:Mr,predatorGestationPeriod:kr,predatorProcreationCooldown:Fr,preyHungerIncreasePerHour:Qi,predatorHungerIncreasePerHour:Ji,berryBushSpreadChance:vi},lastAutosaveTime:0};return Iu(s)}const UR="humanProcreation",LR="human",BR="human",HR=mt,bR=(e,t,r)=>zr(e,t,r.gameState)?e.gender==="male"?e.activeAction==="procreating":e.activeAction==="procreating"&&t.activeAction==="procreating":!1,GR=(e,t,r)=>{var f,g;const{gameState:o}=r,l={x:(e.position.x+t.position.x)/2,y:(e.position.y+t.position.y)/2},s=e.gender==="male"?e:t,u=e.gender==="female"?e:t,d=(s.partnerIds||[]).length===0;if(e.stateMachine=[ga,{partnerId:t.id,previousState:(f=e.stateMachine)==null?void 0:f[0]}],t.stateMachine=[ga,{partnerId:e.id,previousState:(g=t.stateMachine)==null?void 0:g[0]}],e.partnerIds||(e.partnerIds=[]),e.partnerIds.includes(t.id)||e.partnerIds.push(t.id),t.partnerIds||(t.partnerIds=[]),t.partnerIds.includes(e.id)||t.partnerIds.push(e.id),d&&s.leaderId&&s.leaderId!==s.id){const m=o.entities.entities[s.leaderId];if(m){const S=jm(s,m),y=jm(u,m);if(!S&&!y){const w=_f();s.leaderId=s.id,s.tribeBadge=w,s.diplomacy={},u.leaderId=s.id,u.tribeBadge=w}}}else if(!e.leaderId&&!t.leaderId&&s&&u){const m=_f();s.leaderId=s.id,s.tribeBadge=m,s.diplomacy={},u.leaderId=s.id,u.tribeBadge=m}e.activeAction=void 0,Me(o,ce.Procreation,l,Nr),Me(o,ce.Partnered,e.position,xe,e.id),Me(o,ce.Partnered,t.position,xe,t.id),e.lastPartneredEffectTime=o.time,t.lastPartneredEffectTime=o.time,t.activeAction=void 0,Ie(r,fe.Procreate,l)},xR={id:UR,sourceType:LR,targetType:BR,maxDistance:HR,checker:bR,perform:GR},$R={id:"humanChildFeeding",sourceType:"human",targetType:"human",maxDistance:Vf,checker:(e,t)=>e.isAdult===!0&&e.food.length>0&&(!e.feedChildCooldownTime||e.feedChildCooldownTime<=0)&&t.isAdult===!1&&(t.motherId===e.id||t.fatherId===e.id)&&t.hunger>=rr&&e.activeAction==="feeding",perform:(e,t,r)=>{e.food.pop(),t.hunger=Math.max(0,t.hunger-rr),e.feedChildCooldownTime=_E,(!t.lastChildFedEffectTime||r.gameState.time-t.lastChildFedEffectTime>2)&&(Me(r.gameState,ce.ChildFed,t.position,xe,t.id),t.lastChildFedEffectTime=r.gameState.time),Ie(r,fe.ChildFed,t.position)}},zR={id:"human-attack",sourceType:"human",targetType:"human",maxDistance:ei,checker:(e,t,r)=>{var s;if(((s=e.stateMachine)==null?void 0:s[0])!==or||e.attackTargetId!==t.id||(e.attackCooldown||0)>0)return!1;const o=e.stateMachine[1];return r.gameState.time-o.attackStartTime>=Nv},perform:(e,t,r)=>{const o=ze(e.position,t.position,r.gameState.mapDimensions.width,r.gameState.mapDimensions.height),l=xE(nt(o),t.direction);if(Math.abs(l)<BE*Math.PI/180&&Math.random()<HE)Me(r.gameState,ce.AttackDeflected,t.position,xe,t.id);else{let d=Xf;e.gender==="male"&&(d*=FE),e.isAdult||(d*=UE),(!t.isAdult||t.age>=Rv)&&e.isAdult&&(d*=LE),t.hitpoints-=d,t.movementSlowdown={modifier:Kf,endTime:r.gameState.time+Zf},Me(r.gameState,ce.Hit,t.position,xe,t.id);const g=ze(e.position,t.position,r.gameState.mapDimensions.width,r.gameState.mapDimensions.height),m=Pt(g,OE);t.forces.push(m),t.hitpoints<=0?Ie(r,fe.HumanDeath,t.position):Ie(r,fe.Attack,e.position)}e.attackCooldown=Du;const u=e.stateMachine[1];u.attackStartTime=r.gameState.time,Me(r.gameState,ce.Attack,e.position,xe,e.id)}},WR={id:"human-collision",sourceType:"human",targetType:"human",maxDistance:wt*2,checker:(e,t,{gameState:r})=>Y(e.position,t.position,r.mapDimensions.width,r.mapDimensions.height)<(e.radius+t.radius)/3,perform:(e,t,{gameState:r})=>{const o=Y(e.position,t.position,r.mapDimensions.width,r.mapDimensions.height);if(o===0){e.forces.push({x:.1,y:0}),t.forces.push({x:-.1,y:0});return}const s=(e.radius+t.radius-o)*.05,u=nt(Dv(e.position,t.position)),d=Pt(u,s);e.forces.push(d),t.forces.push(Pt(d,-1))}},YR={id:"humanBerryBushGather",sourceType:"human",targetType:"berryBush",maxDistance:mt,checker:(e,t,r)=>{var o;return e.isAdult&&t.food.length>0&&((o=e.stateMachine)==null?void 0:o[0])===Ia&&e.food.length<e.maxFood&&(!e.gatheringCooldownTime||e.gatheringCooldownTime<r.gameState.time)||!1},perform:(e,t,r)=>{const o=t.food.pop();o&&e.food.push(o),e.gatheringCooldownTime=r.gameState.time+1,t.timeSinceLastHarvest=r.gameState.time,Me(r.gameState,ce.BushClaimed,t.position,xe),Ie(r,fe.Gather,e.position)}},jR={id:"corpseGather",sourceType:"human",targetType:"corpse",maxDistance:mt,checker:(e,t,r)=>{var o;return e.isAdult&&t.food.length>0&&((o=e.stateMachine)==null?void 0:o[0])===Ia&&e.food.length<e.maxFood&&(!e.gatheringCooldownTime||e.gatheringCooldownTime<r.gameState.time)||!1},perform:(e,t,r)=>{const o=t.food.pop();o&&e.food.push(o),e.gatheringCooldownTime=r.gameState.time+1,Ie(r,fe.Gather,e.position)}},VR=[YR,jR],XR={id:"prey-eat-berry-bush",sourceType:"prey",targetType:"berryBush",maxDistance:zt,checker:(e,t,r)=>!!(e.isAdult&&t.food.length>0&&e.hunger>30&&(!e.eatingCooldownTime||e.eatingCooldownTime<r.gameState.time)),perform:(e,t,r)=>{t.food.pop()&&(e.hunger=Math.max(0,e.hunger-25),t.lifespan-=NC,t.timeSinceLastHarvest=r.gameState.time,e.eatingCooldownTime=r.gameState.time+PC,Me(r.gameState,ce.BushClaimed,t.position,xe,e.id),Ie(r,fe.Gather,e.position))}},KR={id:"predator-hunt-prey",sourceType:"predator",targetType:"prey",maxDistance:wo,checker:(e,t,r)=>!!(e.isAdult&&e.hunger>50&&(!e.huntCooldown||e.huntCooldown<=0)&&t.hitpoints>0),perform:(e,t,r)=>{t.hitpoints-=UC;const o=ze(e.position,t.position,r.gameState.mapDimensions.width,r.gameState.mapDimensions.height),l=Pt(o,8);t.forces.push(l),e.huntCooldown=HC,t.hitpoints<=0?(Ie(r,fe.HumanDeath,t.position),Me(r.gameState,ce.Hit,t.position,xe,t.id)):(Me(r.gameState,ce.Hit,t.position,xe,t.id),t.fleeCooldown=5,Ie(r,fe.Attack,e.position)),Me(r.gameState,ce.Attack,e.position,xe,e.id)}},ZR={id:"human-hunt-prey",sourceType:"human",targetType:"prey",maxDistance:ei,checker:(e,t,r)=>{var o;return!!(((o=e.stateMachine)==null?void 0:o[0])===or&&e.attackTargetId===t.id&&(!e.attackCooldown||e.attackCooldown<=0)&&t.hitpoints>0&&e.isAdult)},perform:(e,t,r)=>{let o=Xf*1.2;e.gender==="male"&&(o*=1.3),t.hitpoints-=o;const l=ze(e.position,t.position,r.gameState.mapDimensions.width,r.gameState.mapDimensions.height),s=Pt(l,6);t.forces.push(s),e.attackCooldown=Du,t.hitpoints<=0?(Ie(r,fe.HumanDeath,t.position),Me(r.gameState,ce.Hit,t.position,xe,t.id)):(Me(r.gameState,ce.Hit,t.position,xe,t.id),t.fleeCooldown=8,Ie(r,fe.Attack,e.position)),Me(r.gameState,ce.Attack,e.position,xe,e.id)}},qR={id:"predator-attack-human",sourceType:"predator",targetType:"human",maxDistance:kn,checker:(e,t,r)=>{var o;return!!(e.isAdult&&(!e.attackCooldown||e.attackCooldown<=0)&&t.hitpoints>0&&(e.hunger>100||t.attackTargetId===e.id||t.attackTargetId&&((o=r.gameState.entities.entities[t.attackTargetId])==null?void 0:o.type)==="predator"))},perform:(e,t,r)=>{let o=dS;e.hunger>120&&(o*=1.3),t.hitpoints-=o,t.movementSlowdown={modifier:Kf,endTime:r.gameState.time+Zf};const l=ze(e.position,t.position,r.gameState.mapDimensions.width,r.gameState.mapDimensions.height),s=Pt(l,7);t.forces.push(s),e.attackCooldown=fS,t.hitpoints<=0?(e.hunger=Math.max(0,e.hunger-dh),Ie(r,fe.HumanDeath,t.position),Me(r.gameState,ce.Hit,t.position,xe,t.id)):(Me(r.gameState,ce.Hit,t.position,xe,t.id),Ie(r,fe.Attack,e.position)),Me(r.gameState,ce.Attack,e.position,xe,e.id)}},QR={id:"human-attack-predator",sourceType:"human",targetType:"predator",maxDistance:ei,checker:(e,t,r)=>{var o;return!!(((o=e.stateMachine)==null?void 0:o[0])===or&&e.attackTargetId===t.id&&(!e.attackCooldown||e.attackCooldown<=0)&&t.hitpoints>0&&e.isAdult)},perform:(e,t,r)=>{let o=Xf*.8;e.gender==="male"&&(o*=1.2);const l=Object.values(r.gameState.entities.entities).filter(d=>d.type==="human"&&d.id!==e.id).filter(d=>{const f=d;return Math.sqrt(Math.pow(f.position.x-e.position.x,2)+Math.pow(f.position.y-e.position.y,2))<100&&f.activeAction==="attacking"&&f.attackTargetId===t.id}).length;l>0&&(o*=1+l*.2),t.hitpoints-=o;const s=ze(e.position,t.position,r.gameState.mapDimensions.width,r.gameState.mapDimensions.height),u=Pt(s,8);t.forces.push(u),e.attackCooldown=Du,t.hitpoints<=0?(Ie(r,fe.HumanDeath,t.position),Me(r.gameState,ce.Hit,t.position,xe,t.id)):(Me(r.gameState,ce.Hit,t.position,xe,t.id),t.hitpoints<t.maxHitpoints*.3&&(t.hunger+=20),Ie(r,fe.Attack,e.position)),Me(r.gameState,ce.Attack,e.position,xe,e.id)}},JR={id:"prey-procreation",sourceType:"prey",targetType:"prey",maxDistance:zt,checker:(e,t,r)=>!!(e.isAdult&&t.isAdult&&e.gender!==t.gender&&e.id!==t.id&&!e.isPregnant&&!t.isPregnant&&e.hunger<200&&t.hunger<200&&(!e.procreationCooldown||e.procreationCooldown<=0)&&(!t.procreationCooldown||t.procreationCooldown<=0)),perform:(e,t,r)=>{const o=e.gender==="female"?e:t;o.isPregnant=!0,o.gestationTime=r.gameState.ecosystem.preyGestationPeriod,e.procreationCooldown=r.gameState.ecosystem.preyProcreationCooldown,t.procreationCooldown=r.gameState.ecosystem.preyProcreationCooldown,Me(r.gameState,ce.Procreation,o.position,xe,o.id),Ie(r,fe.Procreate,o.position)}},eP={id:"predator-procreation",sourceType:"predator",targetType:"predator",maxDistance:nr,checker:(e,t,r)=>!!(e.isAdult&&t.isAdult&&e.gender!==t.gender&&e.id!==t.id&&!e.isPregnant&&!t.isPregnant&&e.hunger<200&&t.hunger<200&&(!e.procreationCooldown||e.procreationCooldown<=0)&&(!t.procreationCooldown||t.procreationCooldown<=0)),perform:(e,t,r)=>{const o=e.gender==="female"?e:t;o.isPregnant=!0,o.pregnancyFatherId=e.gender==="male"?e.id:t.id,o.gestationTime=r.gameState.ecosystem.predatorGestationPeriod,e.procreationCooldown=r.gameState.ecosystem.predatorProcreationCooldown,t.procreationCooldown=r.gameState.ecosystem.predatorProcreationCooldown,Me(r.gameState,ce.Procreation,o.position,xe,o.id),Ie(r,fe.Procreate,o.position)}},tP={id:"preyChildFeeding",sourceType:"prey",targetType:"prey",maxDistance:Xo,checker:(e,t)=>e.isAdult===!0&&e.gender==="female"&&e.hunger<80&&(!e.feedChildCooldownTime||e.feedChildCooldownTime<=0)&&t.isAdult===!1&&(t.motherId===e.id||t.fatherId===e.id)&&t.hunger>=Su&&e.activeAction==="feeding",perform:(e,t,r)=>{e.hunger=Math.min(120,e.hunger+10),t.hunger=Math.max(0,t.hunger-Su),e.feedChildCooldownTime=gS,(!t.lastChildFedEffectTime||r.gameState.time-t.lastChildFedEffectTime>2)&&(Me(r.gameState,ce.ChildFed,t.position,xe,t.id),t.lastChildFedEffectTime=r.gameState.time),Ie(r,fe.ChildFed,t.position)}},nP={id:"predatorChildFeeding",sourceType:"predator",targetType:"predator",maxDistance:Xo,checker:(e,t)=>e.isAdult===!0&&e.gender==="female"&&e.hunger<90&&(!e.feedChildCooldownTime||e.feedChildCooldownTime<=0)&&t.isAdult===!1&&(t.motherId===e.id||t.fatherId===e.id)&&t.hunger>=Su&&e.activeAction==="feeding",perform:(e,t,r)=>{e.hunger=Math.min(140,e.hunger+15),t.hunger=Math.max(0,t.hunger-Su),e.feedChildCooldownTime=gS,(!t.lastChildFedEffectTime||r.gameState.time-t.lastChildFedEffectTime>2)&&(Me(r.gameState,ce.ChildFed,t.position,xe,t.id),t.lastChildFedEffectTime=r.gameState.time),Ie(r,fe.ChildFed,t.position)}},iP={id:"predator-eat-corpse",sourceType:"predator",targetType:"corpse",maxDistance:nr,checker:(e,t,r)=>!!(e.isAdult&&e.hunger>30&&t.food.length>0&&(!e.eatingCooldownTime||e.eatingCooldownTime<=r.gameState.time)),perform:(e,t,r)=>{t.food.pop()&&(e.hunger=Math.max(0,e.hunger-dh),e.eatingCooldownTime=r.gameState.time+2,Me(r.gameState,ce.Eating,e.position,xe,e.id),Ie(r,fe.Gather,e.position))}},rP={id:"predator-attack-rival",sourceType:"predator",targetType:"predator",maxDistance:kn,checker:(e,t,r)=>{var o;return!!(e.isAdult&&(!e.attackCooldown||e.attackCooldown<=0)&&t.hitpoints>0&&(e.hunger>100||t.attackTargetId===e.id||t.attackTargetId&&((o=r.gameState.entities.entities[t.attackTargetId])==null?void 0:o.type)==="predator"))},perform:(e,t,r)=>{let o=dS;e.hunger>120&&(o*=1.3),t.hitpoints-=o,t.movementSlowdown={modifier:Kf,endTime:r.gameState.time+Zf};const l=ze(e.position,t.position,r.gameState.mapDimensions.width,r.gameState.mapDimensions.height),s=Pt(l,7);t.forces.push(s),e.attackCooldown=fS,t.hitpoints<=0?(e.hunger=Math.max(0,e.hunger-dh),Ie(r,fe.HumanDeath,t.position),Me(r.gameState,ce.Hit,t.position,xe,t.id)):(Me(r.gameState,ce.Hit,t.position,xe,t.id),Ie(r,fe.Attack,e.position)),Me(r.gameState,ce.Attack,e.position,xe,e.id)}},oP={id:"storageDeposit",sourceType:"human",targetType:"building",maxDistance:An,checker:(e,t,r)=>{var s;if(t.buildingType!=="storageSpot"||((s=e.stateMachine)==null?void 0:s[0])!==ea||!t.isConstructed||e.food.length===0)return!1;t.storedFood||(t.storedFood=[]);const o=t.storageCapacity??0;return!(t.storedFood.length>=o||e.leaderId!==t.ownerId||r.gameState.time-(t.lastDepositTime??0)<L_)},perform:(e,t,r)=>{t.storedFood||(t.storedFood=[]);const o=e.food.pop();o&&t.storedFood.push({item:o,positionOffset:SS(t)}),t.lastDepositTime=r.gameState.time,Ie(r,fe.StorageDeposit,t.position)}},sP={id:"storageRetrieve",sourceType:"human",targetType:"building",maxDistance:An,checker:(e,t,r)=>{var l;return!(t.buildingType!=="storageSpot"||((l=e.stateMachine)==null?void 0:l[0])!==ta||!t.isConstructed||!t.storedFood||t.storedFood.length===0||e.food.length>=e.maxFood||e.leaderId!==t.ownerId||r.gameState.time-(t.lastRetrieveTime??0)<B_)},perform:(e,t,r)=>{if(!t.storedFood||t.storedFood.length===0)return;const o=t.storedFood.pop();o&&(e.food.push(o.item),SS(t)),t.lastRetrieveTime=r.gameState.time,Ie(r,fe.StorageRetrieve,t.position)}},aP={id:"storageSteal",sourceType:"human",targetType:"building",maxDistance:An,checker:(e,t,r)=>{var d;if(t.buildingType!=="storageSpot"||((d=e.stateMachine)==null?void 0:d[0])!==Ia||!t.isConstructed||!t.storedFood||t.storedFood.length===0||e.food.length>=e.maxFood||e.leaderId===t.ownerId)return!1;const o=e.leaderId?r.gameState.entities.entities[e.leaderId]:void 0;if(!o||!o.diplomacy||o.diplomacy[t.ownerId]!==pt.Hostile||r.gameState.time-(t.lastStealTime??0)<H_)return!1;const u=Hn({leaderId:t.ownerId},r.gameState);for(const f of u)if(Y(e.position,f.position,r.gameState.mapDimensions.width,r.gameState.mapDimensions.height)<=Rf)return!1;return!0},perform:(e,t,r)=>{if(!t.storedFood||t.storedFood.length===0)return;const o=t.storedFood.pop();o&&e.food.push(o.item),t.lastStealTime=r.gameState.time,Ie(r,fe.StorageSteal,t.position),Me(r.gameState,ce.Attack,t.position,.5)}},lP={id:"human-takeover-building",sourceType:"human",targetType:"building",maxDistance:20,checker:(e,t,r)=>e.leaderId!==e.id||e.activeAction!=="takingOverBuilding"?!1:Fn(e,t,r.gameState),perform:(e,t,r)=>{t.ownerId=e.id,t.constructionProgress=1,t.isConstructed=!0,t.isBeingDestroyed=!1,t.destructionProgress=0,e.activeAction="idle",Me(r.gameState,ce.BushClaimed,t.position,2,t.id)}},uP={id:"human-remove-enemy-building",sourceType:"human",targetType:"building",maxDistance:20,checker:(e,t,r)=>!(e.leaderId!==e.id||e.activeAction!=="destroyingBuilding"||!Fn(e,t,r.gameState)||t.isBeingDestroyed),perform:(e,t,r)=>{t.isBeingDestroyed=!0,e.activeAction="idle",Me(r.gameState,ce.Hit,t.position,1,t.id)}},cP=[WR,...VR,xR,$R,zR,oP,sP,aP,lP,uP,XR,tP,nP,iP,KR,ZR,QR,qR,rP,JR,eP];function dP(e){const{gameState:t}=e,r=t,o=Object.values(t.entities.entities);for(const l of cP)for(const s of o){if(l.sourceType&&s.type!==l.sourceType)continue;const u=r.search[l.targetType].byRadius(s.position,l.maxDistance);for(const d of u){if(s.id===d.id)continue;Y(s.position,d.position,t.mapDimensions.width,t.mapDimensions.height)<=l.maxDistance&&l.checker(s,d,e)&&l.perform(s,d,e)}}}function fP(e){e.visualEffects=e.visualEffects.filter(t=>e.time-t.startTime<=t.duration)}function hP(e){const t=e.search.berryBush.byProperty("type","berryBush"),r=e.search.predator.byProperty("type","predator"),o=e.search.human.byProperty("type","human");for(let l=0;l<20;l++){let s;if(t.length>0&&l<15){const f=t[Math.floor(Math.random()*t.length)],g=Math.random()*2*Math.PI,m=50+Math.random()*100;s={x:Math.max(50,Math.min(et-50,f.position.x+Math.cos(g)*m)),y:Math.max(50,Math.min(tt-50,f.position.y+Math.sin(g)*m))}}else s={x:50+Math.random()*(et-100),y:50+Math.random()*(tt-100)};let u=!0;const d=100;for(const f of r)if(Math.sqrt((s.x-f.position.x)**2+(s.y-f.position.y)**2)<d){u=!1;break}if(u){for(const f of o)if(Math.sqrt((s.x-f.position.x)**2+(s.y-f.position.y)**2)<d){u=!1;break}}if(u)return s}return{x:et*.3+Math.random()*et*.4,y:tt*.3+Math.random()*tt*.4}}function gP(e){const t=e.search.prey.byProperty("type","prey"),r=e.search.human.byProperty("type","human");for(let l=0;l<15;l++){let s;if(t.length>0&&l<10){const f=t[Math.floor(Math.random()*t.length)],g=Math.random()*2*Math.PI,m=100+Math.random()*150;s={x:Math.max(50,Math.min(et-50,f.position.x+Math.cos(g)*m)),y:Math.max(50,Math.min(tt-50,f.position.y+Math.sin(g)*m))}}else s={x:50+Math.random()*(et-100),y:50+Math.random()*(tt-100)};let u=!0;const d=150;for(const f of r)if(Math.sqrt((s.x-f.position.x)**2+(s.y-f.position.y)**2)<d){u=!1;break}if(u)return s}switch(Math.floor(Math.random()*4)){case 0:return{x:Math.random()*et,y:50+Math.random()*100};case 1:return{x:et-150+Math.random()*100,y:Math.random()*tt};case 2:return{x:Math.random()*et,y:tt-150+Math.random()*100};default:return{x:50+Math.random()*100,y:Math.random()*tt}}}function pP(e){const t=e.search.human.byProperty("type","human"),r=e.search.berryBush.byProperty("type","berryBush");for(let o=0;o<20;o++){const l={x:50+Math.random()*(et-100),y:50+Math.random()*(tt-100)};let s=!0;const u=80,d=60;for(const f of t)if(Math.sqrt((l.x-f.position.x)**2+(l.y-f.position.y)**2)<u){s=!1;break}if(s){for(const f of r)if(Math.sqrt((l.x-f.position.x)**2+(l.y-f.position.y)**2)<d){s=!1;break}}if(s)return l}return{x:Math.random()*et,y:Math.random()*tt}}function CS(e,t=4){console.log(` Respawning ${t} prey to prevent extinction`);const r=e;for(let o=0;o<t;o++){const l=hP(r),s=o%2===0?"male":"female";$o(e.entities,l,s,void 0,void 0,pa())}}function RS(e,t=2){console.log(` Respawning ${t} predators to prevent extinction`);const r=e;for(let o=0;o<t;o++){const l=gP(r),s=o%2===0?"male":"female";zo(e.entities,l,s,void 0,void 0,ma())}}function mP(e){const t=e,r=t.search.prey.count(),o=t.search.predator.count();let l=!1;return r===0&&(CS(e,6),l=!0),o===0&&(RS(e,3),l=!0),l}function vP(e){const t=e,r=t.search.prey.count(),o=t.search.predator.count(),l=t.search.berryBush.count();let s=!1;if(r>0&&r<5){const u=Math.max(2,Math.floor(8-r));CS(e,u),s=!0}if(o>0&&o<2){const u=Math.max(1,Math.floor(3-o));RS(e,u),s=!0}if(l<5){console.log(` Boosting bush count from ${l} to help ecosystem`);for(let u=0;u<5;u++){const d=pP(t);wa(e.entities,d,e.time)}s=!0}return s}const SP=1,yP=.3,TP=.8,w0=.8,AP=.99,IP=.05;var PS=(e=>(e[e.INCREASE_PREY_GESTATION=0]="INCREASE_PREY_GESTATION",e[e.DECREASE_PREY_GESTATION=1]="DECREASE_PREY_GESTATION",e[e.INCREASE_PREY_PROCREATION_COOLDOWN=2]="INCREASE_PREY_PROCREATION_COOLDOWN",e[e.DECREASE_PREY_PROCREATION_COOLDOWN=3]="DECREASE_PREY_PROCREATION_COOLDOWN",e[e.INCREASE_PREY_HUNGER=4]="INCREASE_PREY_HUNGER",e[e.DECREASE_PREY_HUNGER=5]="DECREASE_PREY_HUNGER",e[e.INCREASE_PREDATOR_GESTATION=6]="INCREASE_PREDATOR_GESTATION",e[e.DECREASE_PREDATOR_GESTATION=7]="DECREASE_PREDATOR_GESTATION",e[e.INCREASE_PREDATOR_PROCREATION_COOLDOWN=8]="INCREASE_PREDATOR_PROCREATION_COOLDOWN",e[e.DECREASE_PREDATOR_PROCREATION_COOLDOWN=9]="DECREASE_PREDATOR_PROCREATION_COOLDOWN",e[e.INCREASE_PREDATOR_HUNGER=10]="INCREASE_PREDATOR_HUNGER",e[e.DECREASE_PREDATOR_HUNGER=11]="DECREASE_PREDATOR_HUNGER",e[e.INCREASE_BUSH_SPREAD=12]="INCREASE_BUSH_SPREAD",e[e.DECREASE_BUSH_SPREAD=13]="DECREASE_BUSH_SPREAD",e[e.NO_ACTION=14]="NO_ACTION",e))(PS||{});const tf=Object.keys(PS).length/2;class EP{constructor(){Oe(this,"qTable",new Map);Oe(this,"epsilon",w0);Oe(this,"lastState",null);Oe(this,"lastAction",null)}discretizeState(t,r,o){const l=Math.min(4,Math.floor(t/25)),s=Math.min(4,Math.floor(r/5)),u=Math.min(4,Math.floor(o/15));return`${l}-${s}-${u}`}getQValue(t,r){return this.qTable.has(t)||this.qTable.set(t,new Map),this.qTable.get(t).get(r)||0}setQValue(t,r,o){this.qTable.has(t)||this.qTable.set(t,new Map),this.qTable.get(t).set(r,o)}getBestAction(t){let r=0,o=this.getQValue(t,0);for(let l=1;l<tf;l++){const s=this.getQValue(t,l);s>o&&(o=s,r=l)}return r}chooseAction(t){return Math.random()<this.epsilon?Math.floor(Math.random()*tf):this.getBestAction(t)}applyEmergencyCorrections(t,r,o,l){t<gi*.5&&(l.ecosystem.preyGestationPeriod=Math.max(Ro,l.ecosystem.preyGestationPeriod*.8),l.ecosystem.preyProcreationCooldown=Math.max(Po,l.ecosystem.preyProcreationCooldown*.8),l.ecosystem.preyHungerIncreasePerHour=Math.max(Oo,l.ecosystem.preyHungerIncreasePerHour*.9)),r<pi*.6&&(l.ecosystem.predatorGestationPeriod=Math.max(No,l.ecosystem.predatorGestationPeriod*.75),l.ecosystem.predatorProcreationCooldown=Math.max(Do,l.ecosystem.predatorProcreationCooldown*.75),l.ecosystem.predatorHungerIncreasePerHour=Math.max(Mo,l.ecosystem.predatorHungerIncreasePerHour*.85)),o<mi*.5&&(l.ecosystem.berryBushSpreadChance=Math.min(Ys,l.ecosystem.berryBushSpreadChance*1.2)),t>gi*1.4&&(l.ecosystem.preyHungerIncreasePerHour=Math.min(Qi,l.ecosystem.preyHungerIncreasePerHour*1.05)),r>pi*1.4&&(l.ecosystem.predatorHungerIncreasePerHour=Math.min(Ji,l.ecosystem.predatorHungerIncreasePerHour*1.05)),o>mi*1.4&&(l.ecosystem.berryBushSpreadChance=Math.max(vi,l.ecosystem.berryBushSpreadChance*.95))}calculateReward(t,r,o){const l=Math.abs(t-gi),s=Math.abs(r-pi),u=Math.abs(o-mi),d=l/gi,f=s/pi,g=u/mi,m=d+f+g;return 100*Math.exp(-m*2)-50}applyAction(t,r){switch(t){case 0:r.ecosystem.preyGestationPeriod=Math.min(Or,r.ecosystem.preyGestationPeriod+.2*(Or-Ro));break;case 1:r.ecosystem.preyGestationPeriod=Math.max(Ro,r.ecosystem.preyGestationPeriod-.2*(Or-Ro));break;case 2:r.ecosystem.preyProcreationCooldown=Math.min(Mr,r.ecosystem.preyProcreationCooldown+.2*(Mr-Po));break;case 3:r.ecosystem.preyProcreationCooldown=Math.max(Po,r.ecosystem.preyProcreationCooldown-.2*(Mr-Po));break;case 4:r.ecosystem.preyHungerIncreasePerHour=Math.min(Qi,r.ecosystem.preyHungerIncreasePerHour+.2*(Qi-Oo));break;case 5:r.ecosystem.preyHungerIncreasePerHour=Math.max(Oo,r.ecosystem.preyHungerIncreasePerHour-.2*(Qi-Oo));break;case 6:r.ecosystem.predatorGestationPeriod=Math.min(kr,r.ecosystem.predatorGestationPeriod+.2*(kr-No));break;case 7:r.ecosystem.predatorGestationPeriod=Math.max(No,r.ecosystem.predatorGestationPeriod-.2*(kr-No));break;case 8:r.ecosystem.predatorProcreationCooldown=Math.min(Fr,r.ecosystem.predatorProcreationCooldown+.2*(Fr-Do));break;case 9:r.ecosystem.predatorProcreationCooldown=Math.max(Do,r.ecosystem.predatorProcreationCooldown-.2*(Fr-Do));break;case 10:r.ecosystem.predatorHungerIncreasePerHour=Math.min(Ji,r.ecosystem.predatorHungerIncreasePerHour+.2*(Ji-Mo));break;case 11:r.ecosystem.predatorHungerIncreasePerHour=Math.max(Mo,r.ecosystem.predatorHungerIncreasePerHour-.2*(Ji-Mo));break;case 12:r.ecosystem.berryBushSpreadChance=Math.min(Ys,r.ecosystem.berryBushSpreadChance+.2*(Ys-vi));break;case 13:r.ecosystem.berryBushSpreadChance=Math.max(vi,r.ecosystem.berryBushSpreadChance-.2*(Ys-vi));break}}updateQTable(t,r,o,l){const s=this.getQValue(t,r),u=Math.max(...Array.from({length:tf},(f,g)=>this.getQValue(l,g))),d=s+yP*(o+TP*u-s);this.setQValue(t,r,d)}step(t){const r=t,o=r.search.prey.count(),l=r.search.predator.count(),s=r.search.berryBush.count();this.applyEmergencyCorrections(o,l,s,t);const u=this.discretizeState(o,l,s);if(this.lastState!==null&&this.lastAction!==null){const f=this.calculateReward(o,l,s);this.updateQTable(this.lastState,this.lastAction,f,u)}const d=this.chooseAction(u);this.applyAction(d,t),this.epsilon=Math.max(IP,this.epsilon*AP),this.lastState=u,this.lastAction=d}reset(){this.qTable.clear(),this.epsilon=w0,this.lastState=null,this.lastAction=null}getStats(){return{qTableSize:this.qTable.size,explorationRate:this.epsilon}}}let NS=new EP;function wP(e){mP(e),vP(e),e.ecosystem.lastUpdateTime||(e.ecosystem.preyGestationPeriod=Ro+(Or-Ro)*.3,e.ecosystem.preyProcreationCooldown=Po+(Mr-Po)*.3,e.ecosystem.preyHungerIncreasePerHour=Oo+(Qi-Oo)*.3,e.ecosystem.predatorGestationPeriod=No+(kr-No)*.3,e.ecosystem.predatorProcreationCooldown=Do+(Fr-Do)*.3,e.ecosystem.predatorHungerIncreasePerHour=Mo+(Ji-Mo)*.3,e.ecosystem.berryBushSpreadChance=vi+(Ys-vi)*.7),NS.step(e)}function _P(e){e.ecosystem.lastUpdateTime||(e.ecosystem.lastUpdateTime=0),!(e.time-e.ecosystem.lastUpdateTime<SP)&&(e.ecosystem.lastUpdateTime=e.time,wP(e))}function CP(){return NS.getStats()}function RP(e,t){e.selectedBuildingType&&e.selectedBuildingType!=="removal"&&(e.autopilotControls.activeAutopilotAction=void 0,e.autopilotControls.hoveredAutopilotAction=void 0)}const PP=1/60;function NP(e,t){const r=vt(e);r&&(e.viewportCenter=qf(e.viewportCenter,r.position,zf*t))}function Fu(e,t){if(e.isPaused)return e;if(e.autosaveIntervalSeconds){const r=Date.now();r-e.lastAutosaveTime>e.autosaveIntervalSeconds*1e3&&(Uf(e),e.lastAutosaveTime=r)}for(;t>0;){const r=Iu(e),o=Math.min(t,PP),l=o*(It/Et);r.time+=l,NP(r,o),A_(r),_P(r),I_(r),IR({gameState:r,deltaTime:o}),dP({gameState:r,deltaTime:o}),fP(r),DR(r,o),RP(r),e=r,t-=o}return e}function nf(e,t,r){e.save();const{x:o,y:l,width:s,height:u}=t.rect,d=bv;if(e.beginPath(),e.moveTo(o+d,l),e.lineTo(o+s-d,l),e.quadraticCurveTo(o+s,l,o+s,l+d),e.lineTo(o+s,l+u-d),e.quadraticCurveTo(o+s,l+u,o+s-d,l+u),e.lineTo(o+d,l+u),e.quadraticCurveTo(o,l+u,o,l+u-d),e.lineTo(o,l+d),e.quadraticCurveTo(o,l,o+d,l),e.closePath(),e.fillStyle=t.isDisabled?Gv:t.backgroundColor,e.fill(),t.activated){e.save();const f=(Math.sin(Date.now()/1e3*Wv)+1)/2;e.strokeStyle=zv,e.lineWidth=2+f*2,e.globalAlpha=.7+f*.3,e.stroke(),e.restore()}if(t.lastActivated){const f=Date.now()-t.lastActivated;if(f<vu){const g=1-f/vu;e.fillStyle=$v,e.globalAlpha=g,e.fill(),e.globalAlpha=1}}r&&!t.isDisabled&&(e.fillStyle=nh,e.globalAlpha=.5,e.fill(),e.globalAlpha=1),e.fillStyle=t.isDisabled?xv:t.textColor,t.icon?(e.font=`${u*.55}px "Press Start 2P", Arial`,e.textAlign="center",e.textBaseline="middle",e.fillText(t.icon,o+s/2,l+u/2),t.text&&(e.font=`${u*.18}px "Press Start 2P", Arial`,e.textAlign="right",e.textBaseline="bottom",e.fillText(t.text,o+s-4,l+u-2))):(e.textAlign="center",e.textBaseline="middle",e.fillText(t.text,o+s/2,l+u/2)),e.restore()}function DP(e,t,r,o){e.save(),e.font=`${Jm}px "Press Start 2P", Arial`,e.textAlign="center",e.textBaseline="bottom";const s=e.measureText(r).width,u=Jm,d=s+e0*2,f=u+e0*2,g=o.x-d/2,m=e.canvas.height,S=t.y<m/2?t.y+t.height-t0:t.y-f+t0;e.fillStyle=Pw,e.fillRect(g,S,d,f),e.fillStyle=Nw,e.fillText(r,o.x,S+f/2+u/2),e.restore()}function OP(e,t,r){e.save();const o=vt(t),l=[{id:"fastForwardButton",action:pe.FastForward,text:"FFWD [T]",currentWidth:hi*1.3,backgroundColor:Xi,textColor:yn,tooltip:"Fast-forward time",rect:{x:0,y:0,width:0,height:0}},{id:"pauseButton",action:pe.TogglePause,text:t.isPaused?"UN[P]AUSE":"[P]AUSE",backgroundColor:t.isPaused?bl:Xi,currentWidth:t.isPaused?hi*1.4:hi*1.1,tooltip:t.isPaused?"Resume Game":"Pause Game",rect:{x:0,y:0,width:0,height:0},textColor:yn},{id:"muteButton",action:pe.ToggleMute,text:t.isMuted?"UN[M]UTE":"[M]UTE",backgroundColor:t.isMuted?bl:Xi,tooltip:`Toggle Sound (${t.isMuted?"Muted":"Enabled"})`,currentWidth:hi,rect:{x:0,y:0,width:0,height:0},textColor:yn},{id:"returnToIntroButton",action:pe.ReturnToIntro,text:"EXIT",backgroundColor:Xi,tooltip:"Return to Main Menu [ESC]",currentWidth:hi*.9,rect:{x:0,y:0,width:0,height:0},textColor:yn}];if(t.uiButtons.push(...l),o){const g=lh(t,o),m=new Set(g.map(B=>B.type));let S=[{playerAction:ae.Gather,buttonAction:pe.CommandGather,shortcut:"E",name:"Gather",toggleKey:"gathering",condition:()=>o.isAdult===!0},{playerAction:ae.Eat,buttonAction:pe.CommandEat,shortcut:"F",name:"Eat"},{playerAction:ae.Plant,buttonAction:pe.CommandPlant,shortcut:"B",name:"Plant",toggleKey:"planting",condition:()=>o.isAdult===!0},{playerAction:ae.Procreate,buttonAction:pe.ToggleProcreationBehavior,shortcut:"R",name:"Procreation",toggleKey:"procreation",condition:()=>o.isAdult===!0},{playerAction:ae.FeedChild,buttonAction:pe.ToggleFeedChildBehavior,shortcut:"H",name:"Feed Child",toggleKey:"feedChildren",condition:()=>o.isAdult===!0},{playerAction:ae.Attack,buttonAction:pe.ToggleAttackBehavior,shortcut:"Q",name:"Attack",toggleKey:"attack",condition:()=>o.isAdult===!0&&o.leaderId===o.id},{playerAction:ae.FollowMe,buttonAction:pe.CommandFollowMe,shortcut:"C",name:"Follow Me",toggleKey:"followLeader",condition:()=>o.isAdult===!0&&o.leaderId===o.id},{playerAction:ae.CallToAttack,buttonAction:pe.CommandCallToAttack,shortcut:"V",name:"Call to Attack",condition:()=>o.isAdult===!0&&o.leaderId===o.id},{playerAction:ae.TribeSplit,buttonAction:pe.CommandTribeSplit,shortcut:"K",name:"Split Tribe",condition:()=>o.leaderId!==void 0&&o.leaderId!==o.id&&o.isAdult===!0},{playerAction:ae.Build,buttonAction:pe.CommandBuild,shortcut:"L",name:"Build",condition:()=>o.isAdult===!0&&o.leaderId===o.id}];S=S.filter(B=>B.condition?B.condition():!0);const y=1,w=S.length,A=w*on+(w-1)*Ir,I=y*on+(y-1)*Ir,C=(r-A)/2,F=e.canvas.height-I-20;if(S.forEach((B,D)=>{const H=D%w,b=Math.floor(D/w),U=C+H*(on+Ir),$=F+b*(on+Ir),ee=!!B.toggleKey,_e=ee&&t.autopilotControls.behaviors[B.toggleKey],Ce=!m.has(B.playerAction),De=B.playerAction===ae.Build&&t.buildMenuOpen,Pe=!t.hasPlayerEnabledAutopilot||t.hasPlayerEnabledAutopilot<3?" (Press Shift to toggle Auto)":"",de=ee?`${B.name}${Pe}`:B.name,Ue=_e||De?bl:Xi,Te={id:`commandButton_${B.name}`,action:B.buttonAction,rect:{x:U,y:$,width:on,height:on},icon:Mu[B.playerAction],text:B.shortcut,backgroundColor:Ue,textColor:yn,currentWidth:on,tooltip:de,isDisabled:Ce,activated:_e||De};t.uiButtons.push(Te)}),t.buildMenuOpen){const B=[{id:"buildMenu_storageSpot",action:pe.SelectStorageSpot,icon:"",shortcut:"1",name:"Storage Spot"},{id:"buildMenu_plantingZone",action:pe.SelectPlantingZone,icon:"",shortcut:"2",name:"Planting Zone"},{id:"buildMenu_removal",action:pe.SelectRemovalTool,icon:"",shortcut:"3",name:"Remove Building"}],D=B.length,H=D*on+(D-1)*Ir,b=(r-H)/2,U=F-on-Ir;B.forEach(($,ee)=>{const _e=b+ee*(on+Ir),Ce=U,be=$.action===pe.SelectStorageSpot&&t.selectedBuildingType==="storageSpot"||$.action===pe.SelectPlantingZone&&t.selectedBuildingType==="plantingZone"||$.action===pe.SelectRemovalTool&&t.selectedBuildingType==="removal",De={id:$.id,action:$.action,rect:{x:_e,y:Ce,width:on,height:on},icon:$.icon,text:$.shortcut,backgroundColor:be?bl:Xi,textColor:yn,currentWidth:on,tooltip:$.name,activated:be};t.uiButtons.push(De),nf(e,De,t.hoveredButtonId===De.id)})}}let s=r-Ze;l.forEach(g=>{const m=Ze,S=s-g.currentWidth;g.rect={x:S,y:m,width:g.currentWidth,height:Hv},nf(e,g,t.hoveredButtonId===g.id),s-=g.currentWidth+Rw});let u=null;t.uiButtons.filter(g=>g.id.startsWith("commandButton_")||g.id.startsWith("buildMenu_")).forEach(g=>{u||(u={x:g.rect.x,y:g.rect.y,width:g.rect.width,height:g.rect.height}),u.x=Math.min(u.x,g.rect.x),u.y=Math.min(u.y,g.rect.y),u.width=Math.max(u.width,g.rect.x+g.rect.width-u.x),u.height=Math.max(u.height,g.rect.y+g.rect.height-u.y),g.id.startsWith("commandButton_")&&nf(e,g,t.hoveredButtonId===g.id)});const f=t.hoveredButtonId?t.uiButtons.find(g=>g.id===t.hoveredButtonId):void 0;return f&&f.tooltip&&t.mousePosition&&DP(e,f.rect,f.tooltip,t.mousePosition),e.restore(),{commandButtonsRect:u}}function MP(e){e.save(),e.fillStyle=Gw,e.fillRect(0,0,e.canvas.width,e.canvas.height),e.fillStyle=xw,e.font=`${$w}px "Press Start 2P", Arial`,e.textAlign="center",e.textBaseline="middle",e.fillText("PAUSED",e.canvas.width/2,e.canvas.height/2),e.restore()}function Df(e,t,r,o){const l=t.x-r.width/2,s=t.y-r.height/2,u=l+e.x,d=s+e.y,f=(u%o.width+o.width)%o.width,g=(d%o.height+o.height)%o.height;return{x:f,y:g}}function Uu(e,t,r,o){let l=e.x-t.x,s=e.y-t.y;return Math.abs(l)>o.width/2&&(l=l-Math.sign(l)*o.width),Math.abs(s)>o.height/2&&(s=s-Math.sign(s)*o.height),{x:l+r.width/2,y:s+r.height/2}}function ql(e,t,r,o){const l=Uu(e.position,t,r,o),u=("radius"in e?e.radius:20)+20;return l.x>=-u&&l.x<=r.width+u&&l.y>=-u&&l.y<=r.height+u}function ln(e,t,r,o,l,...s){const u={...l.position};for(let d=-r;d<=r;d+=r)for(let f=-t;f<=t;f+=t)l.position.x=u.x+f,l.position.y=u.y+d,o(e,l,...s);l.position=u}const kP=25,FP=0,_0=28;function DS(e,t,r,o,l,s,u,d,f,g){e.save();const{x:m,y:S}=Uu(t,u,{width:d,height:f},g);e.strokeStyle=o,e.lineWidth=s,e.setLineDash(l),e.beginPath(),e.arc(m,S,r+Ou,0,2*Math.PI),e.stroke(),e.restore()}function UP(e,t,r,o,l,s,u){if(t=t.filter(S=>S.type!==ae.FollowMe),t.length===0)return;e.save(),t.forEach(S=>{S.targetEntity&&DS(e,S.targetEntity.position,S.targetEntity.radius,eh,th,2,o,l,s,u)}),e.font=`${bo}px "Press Start 2P", Arial`,e.fillStyle="white",e.textAlign="center",e.textBaseline="bottom",e.shadowColor="black",e.shadowBlur=5;const{x:d,y:f}=Uu(r.position,o,{width:l,height:s},u);let g=0,m={};t.forEach(S=>{const y=Mu[S.type];if(S.targetEntity){m[S.targetEntity.id]=(m[S.targetEntity.id]||0)+1;const w=S.targetEntity.position.x-o.x+l/2,A=S.targetEntity.position.y-o.y+s/2,I=`${y}${S.key.toUpperCase()}`,C=A-S.targetEntity.radius-Ou-bo/2-(m[S.targetEntity.id]-1)*_0;e.fillText(I,w,C)}else{e.textAlign="left";const w=`${y}${S.key.toUpperCase()}`,A=d+kP,C=f+FP+g*_0;e.fillText(w,A,C),g++,e.textAlign="center"}}),e.restore()}const ye=(e,t,r,o,l,s,u)=>{s==="transparent"||o<=0||l<=0||(e.fillStyle=s,e.fillRect(Math.floor(t*u),Math.floor(r*u),Math.ceil(o*u),Math.ceil(l*u)))},C0=10,R0=10,qn=6,ci=4,Ql=2,LP=5,vn=4,BP=2,kt=4,HP=2,Je=3,Ao=2,Vi=0,ra=Vi+ci-1,bt=ra,ut=ra+vn-1,bP="rgba(0, 0, 0, 0.4)",GP=4,xP=1,ph={name:"tribe-human-2d",referenceImage:"swos.png",description:`A 2D human character asset for the Tribe game. This includes ensuring that the unique animations for stances like 'eat' and 'procreate' do not erroneously appear in other stances, such as 'walk', which was observed in the provided rendered media. The 'idle' animation was updated to a leg sway to better match the provided video for that stance, replacing a simpler body bob.

# Visual style

Human characters in the Tribe game are inspired by classic 2D pixel art, they look like Sensible Soccer players(Sensible Soccer game visual style is IMPORTANT), with a simple and recognizable design. The characters are designed to be easily distinguishable and animated in a way that conveys their actions clearly.

Character in Tribe game look like people from stone age, they have simple clothing, no shoes, and no modern accessories. The characters are designed to be easily distinguishable and animated in a way that conveys their actions clearly.

# Technical details

The asset is rendered on a canvas using the CanvasRenderingContext2D API. The rendering function takes parameters for position, size, progress, stance, direction, gender, and age. The character can face left or right, and the rendering adapts based on the stance (e.g., idle, walk, eat, procreate).
The rendering function must be simple and efficient, it should not use complex patterns or gradients, and should focus on solid colors and basic shapes to maintain the pixel art aesthetic.

15% padding from all edges of the rendering box is required to ensure the character is not cut off during rendering.

Subtle shadow should be drawn under the character to give it a sense of depth.

# Rendering parameters

- age: The age of the character, which affects the size and proportions of the body parts. Age is a number between 1 and 60, with 20 being the average age.
- gender: 
  - The male characters should have only pants, while female cover their breasts with a top. The clothing should be simple and muted, reflecting a stone-age style.
  - Female characters should have long hair, while male should have short hair and beard.
  - Male characters should have a more robust, muscular build
  - Female characters should have thinner arms and legs, with a more pronounced waist and hips.
- isPregnant: (applicable only for females) Indicates if the character is pregnant, like very large belly. Pregnant characters should have a larger torso.
- direction: A vector indicating the character's facing direction. There should be at least 8 directions (like in Sensible Soccer): top left, top, top right, left, right, bottom left, bottom, bottom right. The character should be flipped horizontally if the direction vector's X component is negative.
             When moving up(top, top left, top right), the character back of the head should be visible, when moving down(Y > 0), the character face should be visible.
- hungryLevel: A number between 0 and 100 indicating how hungry the character is, hunger level 100 means the character is starving, 0 means the character is not hungry at all. So hungry characters should be thinner, with less body fat, and more pronounced muscles. The character's hunger level affects the size and proportions of the body parts, with hungrier characters being smaller and more gaunt.

# Rendering details

- All parts of the body must be connected
- Rendering must take into account direction vector (X and Y) to flip the character horizontally if needed
- The character's age affects the size and proportions of the body parts, with older characters being larger and more robust. Hair color should become gray for older characters.

# Stances

- 'idle': The character stands still, with a slight leg sway to indicate life.
- 'walk': The character moves forward, with legs and arms in motion.
- 'gathering': The character is gathering food from berry bushes, with arms reaching out and a slight bend at the knees.
- 'eat': The character holds food and brings it to their mouth, with a slight bend at the knees.
- 'procreate': The character performs a mating animation, with a specific pose and movement. There should be some additional visual effects to indicate this action, such as a slight glow or aura around the characters, or dust particles to indicate movement.
- 'attacking': The character performs an attack animation, with arms raised and a forward motion.
- 'defending': The character takes a defensive stance, with arms raised and a slight bend at the knees.
- 'stunned': The character is stunned and laying on the ground, with limbs relaxed and a neutral expression.
- 'dead': The character lies on the ground, with limbs relaxed and a neutral expression, slowly turns into a skeleton over time.

`,stances:["idle","walk","gathering","eat","procreate","dead","attacking","defending","stunned"],render(e,t,r,o,l,s,u,d="male",f=20,g=[1,0],m=!1,S=0){const y=["dead","stunned"].includes(u),w=y?R0+4:C0,A=y?C0+4:R0+Je,I=.15,C=Math.min(o*(1-2*I)/w,l*(1-2*I)/A),F=w*C,B=A*C,D=t+(o-F)/2,H=r+(l-B)/2;e.save(),g[0]<0&&!y?(e.translate(D+F,H),e.scale(-1,1)):e.translate(D,H);const U="#D09A5A",$=f>50?"#BDBDBD":"#281808",ee="#7F5C4A",_e="#6B4F3A",Ce="#E0D8C0",be="#A0522D",De=1-Math.max(0,Math.min(100,S))/100*.2,Pe=d==="male"?1.1:.9,de=.8+(Math.max(1,Math.min(f,60))-1)/59*.2;let Ue=LP*De*Pe*de,Te=BP*De*Pe*de,ne=HP*De*de;m&&d==="female"&&(Ue*=1.5);const W=Math.round((w-Ue)/2),X=Math.round((w-qn)/2),j=W-Te,P=W+Ue,L=1,K=W+(Ue/2-L/2)-ne,ie=W+(Ue/2+L/2),Se=g[1]<-.2&&Math.abs(g[0])<.7,le=Z=>{e.fillStyle=bP,e.beginPath();const re=w/2,Le=Z;e.ellipse(Math.floor(re*C),Math.floor(Le*C),Math.max(1,Math.floor(GP*C)),Math.max(1,Math.floor(xP*C)),0,0,2*Math.PI),e.fill()},Ee=(Z,re)=>{d==="male"?(ye(e,W,ra+Z,Ue,vn-Ao,re,C),ye(e,W,ra+vn-Ao+Z,Ue,Ao,ee,C)):ye(e,W,ra+Z,Ue,vn,_e,C)},Ae=(Z,re)=>{Se?ye(e,X,Vi+Z,qn,ci,$,C):(ye(e,X,Vi+Z,qn,ci,re,C),ye(e,X,Vi+Z,qn,Ql,$,C),d==="female"?(ye(e,X-1,Vi+Ql+Z,1,ci,$,C),ye(e,X+qn,Vi+Ql+Z,1,ci,$,C)):ye(e,X+1,Vi+2+Z,qn-2,ci-2,$,C))};switch(u){case"idle":{const Z=s*Math.PI*2,re=Math.sin(Z)*.5,ge=(Math.cos(Z*2)+1)*.25;le(ut+Je+1),ye(e,K+re,ut+ge,ne,Je,U,C),ye(e,ie-re,ut+ge,ne,Je,U,C),Ee(ge,U),ye(e,j,bt+ge,Te,kt,U,C),ye(e,P,bt+ge,Te,kt,U,C),Ae(ge,U);break}case"walk":{const Z=s*Math.PI*2,re=Math.sin(Z)*2,ge=Math.abs(Math.cos(Z))*1;le(ut+Je+1),ye(e,K+re,ut+ge,ne,Je,U,C),ye(e,ie-re,ut+ge,ne,Je,U,C),Ee(ge,U),ye(e,j-re,bt+ge,Te,kt,U,C),ye(e,P+re,bt+ge,Te,kt,U,C),Ae(ge,U);break}case"gathering":{const Z=s*Math.PI*2,re=1,Le=(Math.sin(Z)+1)/2*2,ge=re+Math.abs(Math.cos(Z))*.5;le(ut+Je+1),ye(e,K,ut+ge,ne,Je-re,U,C),ye(e,ie,ut+ge,ne,Je-re,U,C),Ee(ge,U),ye(e,j+1,bt+ge-Le,Te,kt,U,C),ye(e,P-1,bt+ge-Le,Te,kt,U,C),Ae(ge,U);break}case"eat":{le(ut+Je+1),ye(e,K,ut+1,ne,Je-1,U,C),ye(e,ie,ut+1,ne,Je-1,U,C),Ee(1,U);const Le=(Math.sin(s*Math.PI*4)+1)/2,ge=X+qn/2,Gn=Vi+ci/2,qe=P+(ge-P)*Le,je=bt+1+(Gn-(bt+1))*Le;ye(e,j,bt+1,Te,kt,U,C),ye(e,qe,je,Te,kt,U,C),ye(e,qe,je-1,1,1,be,C),Ae(1,U);break}case"procreate":{const Z=(Math.sin(s*Math.PI*8)+1)/4,re=(Math.sin(s*Math.PI*6)+1)*.5,Le=1.5,ge=Le-re;le(ut+Je+1),ye(e,K,ut+ge,ne,Je-Le,U,C),ye(e,ie,ut+ge,ne,Je-Le,U,C),Ee(ge,U),ye(e,j,bt+ge,Te,kt,U,C),ye(e,P,bt+ge,Te,kt,U,C),Ae(ge,U),e.globalAlpha=Z,Ee(ge,"white"),e.globalAlpha=1;break}case"attacking":{const Z=Math.sin(s*Math.PI)*1.5,re=Math.abs(Math.sin(s*Math.PI));le(ut+Je+1),ye(e,K-Z,ut+re,ne,Je,U,C),ye(e,ie+Z*.5,ut+re,ne,Je,U,C),Ee(re,U),ye(e,j,bt+re-2,Te,kt,U,C),ye(e,P,bt+re-2.5,Te,kt,U,C),Ae(re,U);break}case"defending":{le(ut+Je+1),ye(e,K,ut+1,ne,Je-1,U,C),ye(e,ie,ut+1,ne,Je-1,U,C),Ee(1,U),ye(e,j-1,bt+1-1,Te,kt,U,C),ye(e,P+1,bt+1-1,Te,kt,U,C),Ae(1,U);break}case"stunned":case"dead":{const Z=u==="dead",re=Z?Math.min(1,s):0,Le=re>.5?Ce:U,ge=d==="male"?ee:_e,Gn=re>.8?"transparent":$,qe=w/2,je=A/2,xn=2;le(A-1),ye(e,qe-ne-xn,je,ne,Je,Le,C),ye(e,qe+xn,je,ne,Je,Le,C),ye(e,qe-Te-xn,je-vn+1,Te,kt,Le,C),ye(e,qe+xn,je-vn+1,Te,kt,Le,C);const Yt=qe-Ue/2,un=je-vn/2;d==="male"?(re<.7&&ye(e,Yt,un+vn-Ao,Ue,Ao,ge,C),ye(e,Yt,un,Ue,vn-Ao,Le,C)):re<.7?ye(e,Yt,un,Ue,vn,ge,C):ye(e,Yt,un,Ue,vn,Le,C);const $n=qe-qn/2,zn=je-vn/2-ci+1;if(ye(e,$n,zn,qn,ci,Le,C),Gn!=="transparent"&&ye(e,$n,zn,qn,Ql,Gn,C),Z&&re>.6){const Ti="#B0A890";for(let ar=0;ar<3;ar++)ye(e,Yt+1,un+ar*1+1,Ue-2,.5,Ti,C)}break}default:ye(e,0,0,w,A,"magenta",C);break}e.restore()}};function $P(e,t,r,o,l){const s=t.x,u=t.y-r-o/2;e.save(),e.fillStyle=l,e.strokeStyle=l,e.lineWidth=1.5,e.beginPath(),e.rect(s-o/2,u,o,o/2),e.fill(),e.beginPath(),e.moveTo(s-o/2,u),e.lineTo(s-o/4,u-o/3),e.lineTo(s-o/6,u),e.moveTo(s-o/6,u),e.lineTo(s,u-o/2),e.lineTo(s+o/6,u),e.moveTo(s+o/6,u),e.lineTo(s+o/4,u-o/3),e.lineTo(s+o/2,u),e.stroke(),e.restore()}function Sa(e,t,r,o,l,s=!1,u=!1,d=!1,f=!1){o<Yf&&(r=r*.75),ph.render(e,t.x-r/2,t.y-r/2,r,r,0,"idle",l,o,[0,0],!1,0);let g,m;s?(g=Sw,m=Fv):u?(g=yw,m=Bv):d?(g=Tw,m=Lv):f&&(g=Aw,m=Uv),g&&m&&$P(e,t,r/2,g,m)}function zP(e,t,r,o,l,s){if(e.save(),o.length===0){e.restore();return}const u=o.length*l,d=4;let f;const g=u+(o.length-1)*d;o.length>1&&g>s?f=(s-u)/(o.length-1):f=d,o.length<=1&&(f=0);for(let m=0;m<o.length;m++){const{member:S,isPlayer:y,isHeir:w,isPartner:A,isParent:I}=o[m],C=t+m*(l+f)+l/2,F=r+l/4;Sa(e,{x:C,y:F},l,S.age,S.gender,y,w,A,I)}e.restore()}function WP(e,t,r,o,l){if(r.length===0)return;e.save();const s=Kn,u=" 00",d=" 00";e.font=`${Ld}px "Press Start 2P", Arial`;const f=e.measureText(u).width,g=e.measureText(d).width,m=Kn+mn+Kn+mn+Kn+xi+f+Kn/2+xi+g,S=r.length*Hl+(r.length-1)*qm,y=l-S-Kn;e.fillStyle=Ew,e.fillRect(s,y,m,S);for(let w=0;w<r.length;w++){const A=r[w],I=y+w*(Hl+qm),C=I+Hl/2;A.isPlayerTribe&&(e.fillStyle=Iw,e.fillRect(s,I,m,Hl));let F=s+Kn;if(e.font=`${mn}px "Press Start 2P", Arial`,e.textBaseline="middle",e.textAlign="left",e.fillText(A.tribeBadge,F,C-mn/4),F+=mn+Kn,!A.isPlayerTribe){const B=A.diplomacyStatus===pt.Friendly?"":"",D=`diplomacyButton_${A.leaderId}`,H={x:F-2,y:C-mn/2-2,width:mn+4,height:mn+4},b={id:D,action:pe.ToggleDiplomacy,rect:H,text:"",icon:B,backgroundColor:"transparent",textColor:"white",currentWidth:mn,tooltip:`Toggle diplomacy with this tribe (Currently: ${A.diplomacyStatus})`,targetTribeId:A.leaderId};t.uiButtons.push(b),t.hoveredButtonId===D&&(e.fillStyle=nh,e.globalAlpha=.5,e.fillRect(H.x,H.y,H.width,H.height),e.globalAlpha=1),e.font=`${mn*.8}px "Press Start 2P", Arial`,e.textBaseline="middle",e.textAlign="center",e.fillText(B,F+mn/2,C)}F+=mn+Kn,A.adultCount>0&&(Sa(e,{x:F+xi/2,y:C},xi,25,"male"),F+=xi/2,e.font=`${Ld}px "Press Start 2P", Arial`,e.fillStyle="white",e.textBaseline="middle",e.textAlign="left",e.fillText(` ${A.adultCount}`,F,C),F+=e.measureText(` ${A.adultCount}`).width+Kn/2),A.childCount>0&&(Sa(e,{x:F+xi/2,y:C},xi,1,"female"),F+=xi/2,e.font=`${Ld}px "Press Start 2P", Arial`,e.fillStyle="white",e.textBaseline="middle",e.textAlign="left",e.fillText(` ${A.childCount}`,F,C))}e.restore()}function YP(e,t,r,o,l){const s=Xv,u=Kv,d=t+o-s-u,f=r+u;e.save(),e.lineWidth=2,e.strokeStyle=l?Qw:qw,e.beginPath();const g=5;e.moveTo(d+g,f+g),e.lineTo(d+s-g,f+s-g),e.moveTo(d+s-g,f+g),e.lineTo(d+g,f+s-g),e.stroke(),e.restore()}function jP(e,t,r,o){const{tutorialState:l,tutorial:s}=t;if(l.transitionState===xt.INACTIVE)return;const u=s.steps[l.currentStepIndex];if(!u)return;e.save(),e.globalAlpha=l.transitionAlpha;const d=zw,f=Ww,g=Yw,m=`${bd}px "Press Start 2P", Arial`,S=`${o0}px "Press Start 2P", Arial`,y=Vw,w=o0*1.5;e.font=S;const A=u.text.split(" ");let I="";const C=[];for(let Ce=0;Ce<A.length;Ce++){const be=I+A[Ce]+" ";e.measureText(be).width>d-f*2&&Ce>0?(C.push(I),I=A[Ce]+" "):I=be}C.push(I);const F=f*2+bd+f/2+C.length*w,B=(r-d)/2,D=o-F-160;e.fillStyle=jw,e.beginPath(),e.moveTo(B+g,D),e.lineTo(B+d-g,D),e.quadraticCurveTo(B+d,D,B+d,D+g),e.lineTo(B+d,D+F-g),e.quadraticCurveTo(B+d,D+F,B+d-g,D+F),e.lineTo(B+g,D+F),e.quadraticCurveTo(B,D+F,B,D+F-g),e.lineTo(B,D+g),e.quadraticCurveTo(B,D,B+g,D),e.closePath(),e.fill(),e.fillStyle=y,e.textAlign="center",e.textBaseline="top",e.font=m,e.fillText(u.title,B+d/2,D+f),e.font=S;let H=D+f+bd+f/2;for(const Ce of C)e.fillText(Ce,B+d/2,H),H+=w;const b=t.hoveredButtonId==="tutorial-dismiss";YP(e,B,D,d,b),e.restore();const U=Xv,$=Kv,ee=B+d-U-$,_e=D+$;return{x:ee,y:_e,width:U,height:U}}function rf(e,t,r){e.save();const o=Zw,l={x:t.x-o,y:t.y-o,width:t.width+o*2,height:t.height+o*2};e.strokeStyle=jv,e.lineWidth=Vv+Math.sin(r*ih)*1.5,e.setLineDash([8,8]),e.strokeRect(l.x,l.y,l.width,l.height),e.restore()}function VP(e,t){e.fillStyle="white",e.font='30px "Press Start 2P", Arial',e.textAlign="center",e.fillText("Game Over!",e.canvas.width/2,e.canvas.height/2-60),e.font='20px "Press Start 2P", Arial',e.fillText("Lineage Extinct.",e.canvas.width/2,e.canvas.height/2-20),e.fillText(`Cause: ${t.causeOfGameOver||"Unknown"}`,e.canvas.width/2,e.canvas.height/2+20)}const OS=10,XP=3,P0=OS*.7;function KP(e,t){const{position:r,food:o,maxFood:l}=t;if(e.beginPath(),e.arc(r.x,r.y,OS,0,Math.PI*2),e.fillStyle="#228B22",e.fill(),e.strokeStyle="#006400",e.lineWidth=1,e.stroke(),o.length>0){const s=Math.PI*2/Math.min(o.length,l);for(let u=0;u<o.length;u++){const d=u*s,f=r.x+P0*Math.cos(d),g=r.y+P0*Math.sin(d);e.beginPath(),e.arc(f,g,XP,0,Math.PI*2),e.fillStyle="#FF0000",e.fill()}}}const N0=(e,t,r=70,o=50)=>{const l=e>>t&255;return`hsl(${Math.floor(l/255*360)}, ${r}%, ${o}%)`},ZP=(e,t)=>{const r=e.match(/hsl\((\d+),\s*(\d+)%,\s*(\d+)%\)/);if(!r)return e;const[o,l,s]=[parseInt(r[1]),parseInt(r[2]),parseInt(r[3])];return`hsl(${o}, ${l}%, ${Math.max(0,s-t)}%)`},Jl=(e,t,r,o,l,s,u,d=!1)=>{e.save(),e.translate(t,r),e.rotate(s),e.fillStyle=d?ZP(u,15):u,e.beginPath(),e.roundRect(-o/2,0,o,l,o/2),e.fill(),e.restore()},of=(e,t)=>{const r=e.match(/hsl\((\d+),\s*(\d+)%,\s*(\d+)%\)/),o=75;if(!r)return`hsl(0, 0%, ${o}%)`;const[,l,s,u]=r.map(Number),d=s*(1-t),f=u+(o-u)*t;return`hsl(${l}, ${d}%, ${f}%)`},MS={name:"tribe-prey-2d",referenceImage:"swos.png",description:`A 2D prey asset for the Tribe game, featuring various stances and animations.

Prey is an animal which can be hunted by predators or humans in the Tribe game.

Preys look like small 4 leg mammals, with a simple and recognizable design. The characters are designed to be easily distinguishable and animated in a way that conveys their actions clearly.

# Visual style

Prey characters in the Tribe game are inspired by classic 2D pixel art, they look like Sensible Soccer players(Sensible Soccer game visual style is IMPORTANT), with a simple and recognizable design. The characters are designed to be easily distinguishable and animated in a way that conveys their actions clearly.

Character in Tribe game look like creatures from stone age, they have simple clothing, no shoes, and no modern accessories. The characters are designed to be easily distinguishable and animated in away that conveys their actions clearly.

Prey walks on all fours, unlike human (two legs).

Each prey is described by a unique gene code, which is a number that defines its appearance, size, and other characteristics. The gene code is used to generate the character's appearance, including body proportions, color, and other visual features. The gene code is a 32-bit integer, with each bit representing a specific characteristic of the character.

Prey should have should have visible body parts, such as head, torso, arms, and legs. The body parts should be connected and should not overlap. The character's body parts should be simple shapes, such as circles and rectangles, with solid colors and no gradients or patterns.

Preys are supposed to be sympathetic and friendly, so the character's face should have a friendly expression, with a smile and bright eyes. The character's eyes should be large and expressive, with a simple design.

# Technical details

The asset is rendered on a canvas using the CanvasRenderingContext2D API. The rendering function takes parameters for position, size, progress, stance, direction, gender, and age. The character can face left or right, and the rendering adapts based on the stance (e.g., idle, walk, eat, procreate).
The rendering function must be simple and efficient, it should not use complex patterns or gradients, and should focus on solid colors and basic shapes to maintain the pixel art aesthetic.

15% padding from all edges of the rendering box is required to ensure the character is not cut off during rendering.

Subtle shadow should be drawn under the a character to give it a sense of depth.

IMPORTANT: The character is visible from the side, just like in Sensible Soccer.

# Rendering parameters

- age: The age of the character, which affects the size and proportions of the body parts. Age is a number between 0 and 12, with 2 being the average age.
- gender:
  - 'male': Male prey are larger and more robust, with a more pronounced musculature.
  - 'female': Female prey are smaller and more agile, with a leaner build.
- isPregnant: (applicable only for females) Indicates if the character is pregnant, like very large belly. Pregnant characters should have a larger torso.
- direction: A vector indicating the character's facing direction. There should be at least 8 directions (like in Sensible Soccer): top left, top, top right, left, right, bottom left, bottom, bottom right. The character should be flipped horizontally if the direction vector's X component is negative.
             When moving up(top, top left, top right), the character back of the head should be visible, when moving down(Y > 0), the character face should be visible.
- hungryLevel: A number between 0 and 100 indicating how hungry the character is, hunger level 100 means the character is starving, 0 means the character is not hungry at all. So hungry characters should be thinner, with less body fat, and more pronounced muscles. The character's hunger level affects the size and proportions of the body parts, with hungrier characters being smaller and more gaunt.

# Rendering details

- All parts of the body must be connected
- Rendering must take into account direction vector (X and Y) to flip the character horizontally if needed
- The character's age affects the size and proportions of the body parts, with older characters being larger and more robust. Hair color should become gray for older characters.

# Stances

- 'idle': The character stands still, with a slight leg sway to indicate life.
- 'walk': The character moves forward, with legs and arms in motion.
- 'eat': The character holds food and brings it to their mouth, with a slight bend at the knees.
- 'procreate': The character performs a mating animation, with a specific pose and movement. There should be some additional visual effects to indicate this action, such as a slight glow or aura around the characters, or a dust particles to indicate movement.
- 'dead': The character lies on the ground, with limbs relaxed and a neutral expression, slowly turns into a grey skeleton over time. The character pose and body parts should not be animated in this stance, as the character is dead so it should not move.`,stances:["idle","walk","eat","dead","procreate"],render(e,t,r,o,l,s,u,d={gender:"male",age:2,direction:[1,0],isPregnant:!1,hungryLevel:0,geneCode:8405024}){e.save(),e.imageSmoothingEnabled=!1;const f=o*.15,g=t+o/2,m=r+l/2,S=o-f*2,y=l-f*2,{gender:w,age:A,direction:I,isPregnant:C,hungryLevel:F,geneCode:B}=d,D=.8+Math.min(A,10)/10*.4,H=w==="male"?1.05:.95,b=1-F/100*.3,U=S*.5*b*D*H;let $=y*.3*D*H;const ee=S*.15*D*H,_e=U*.2,Ce=y*.3,be=N0(B,0,30,50);let De=N0(B,8,50,40);if(A>45){const le=Math.min(1,(A-45)/15);De=of(De,le)}e.translate(g,m),I[0]<0&&e.scale(-1,1);const Pe=Math.sin(s*Math.PI*2),de=Math.cos(s*Math.PI*2),Ue=Ce+$*.2;if(u==="dead"){const le=Math.min(s,1);e.translate(0,y*.2),e.rotate(Math.PI/2);const Ee=of(De,le),Ae=of(be,le);e.globalAlpha=.5+le*.5,e.strokeStyle=Ee,e.lineWidth=_e*.5,e.beginPath(),e.moveTo(-U*.4,0),e.lineTo(U*.4,0),e.stroke();for(let Z=-1;Z<=1;Z+=1)e.beginPath(),e.arc(0,0,$*.4,Math.PI*.4*Z-Math.PI*.2,Math.PI*.4*Z+Math.PI*.2),e.stroke();e.fillStyle=Ae,e.beginPath(),e.arc(U*.5,0,ee,0,Math.PI*2),e.fill(),e.fillStyle="black",e.beginPath(),e.arc(U*.55,0,ee*.3,0,Math.PI*2),e.fill(),e.restore();return}e.fillStyle="rgba(0, 0, 0, 0.1)",e.beginPath(),e.ellipse(0,Ue,U*.7,U*.25,0,0,2*Math.PI),e.fill();let Te=0,ne=0,W=0,X=0,j=0,P=0;switch(u){case"idle":ne=Pe*(y*.02),W=Pe*.05,X=-Pe*.05,j=-Pe*.05,P=Pe*.05;break;case"walk":ne=Math.abs(de)*(y*-.04),W=Pe*.7,X=-Pe*.7,j=-Pe*.7,P=Pe*.7;break;case"eat":Te=y*.1,ne=y*.05,Te+=Pe*(y*.02);break;case"procreate":ne=y*.05;const le=(1-de)*-S*.05;e.translate(le,0),e.shadowColor="rgba(255, 182, 193, 0.9)",e.shadowBlur=10;break}C&&w==="female"&&($*=1.6);const L=ne,K=L-$*.2;Jl(e,U*-.35,K,_e,Ce,j,De,!0),Jl(e,U*.35,K,_e,Ce,P,De,!0),e.fillStyle=De,e.beginPath(),e.ellipse(0,L,U/2,$/2,0,0,2*Math.PI),e.fill();const ie=U*.45,Se=K+Te;e.fillStyle=be,e.beginPath(),e.arc(ie,Se,ee,0,Math.PI*2),e.fill(),I[1]>=0&&(e.fillStyle="black",e.beginPath(),e.arc(ie+ee*.3,Se-ee*.2,ee*.15,0,Math.PI*2),e.fill()),Jl(e,U*-.35,K,_e,Ce,W,De),Jl(e,U*.35,K,_e,Ce,X,De),e.restore()}};function qP(e,t){let[r,o,l]=e.match(/\d+/g).map(Number);return r=Math.max(0,r-t),o=Math.max(0,o-t),l=Math.max(0,l-t),`rgb(${r}, ${o}, ${l})`}function QP(e){const t=(e&16711680)>>16,r=(e&65280)>>8,o=e&255,l=`rgb(${t}, ${r}, ${o})`,s=qP(l,40),u=(e&255)%100+50,d=(e>>8&255)%100,f=(e>>16&255)%100,g=`rgb(${u}, ${d}, ${f})`,m=(e&8388608)!==0?"#00aaff":"#ffaa00";return{furColor:l,darkerFurColor:s,skinColor:g,eyeColor:m}}const kS={name:"tribe-predator-2d",referenceImage:"swos.png",description:`A 2D predator asset for the Tribe game, featuring various stances and animations.

Predator is an animal which can hunt and attack humans in the Tribe game. It is designed to be a threat to the player, adding an element of danger and challenge to the game world.

Predator look like bears or wolves, with a simple and recognizable design. The characters are designed to be easily distinguishable and animated in a way that conveys their actions clearly.

# Visual style

Predator characters in the Tribe game are inspired by classic 2D pixel art, they look like Sensible Soccer players(Sensible Soccer game visual style is IMPORTANT), with a simple and recognizable design. The characters are designed to be easily distinguishable and animated in a way that conveys their actions clearly.

Character in Tribe game look like creatures from stone age, they have simple clothing, no shoes, and no modern accessories. The characters are designed to be easily distinguishable and animated in away that conveys their actions clearly.

Predator walks on arms and legs, unlike human (two legs).

Each predator is described by a unique gene code, which is a number that defines its appearance, size, and other characteristics. The gene code is used to generate the character's appearance, including body proportions, color, and other visual features. The gene code is a 32-bit integer, with each bit representing a specific characteristic of the character.

Predator should have visible ears, eyes, and mouth with teeth. It must have a tail. Front legs should be shorter than back legs, and they should be positioned closer to the body. The character's body should be wider at the top and narrower at the bottom, with a slight curve to the back. The character's head should be larger than the body, with a pronounced jaw and sharp teeth.

# Technical details

The asset is rendered on a canvas using the CanvasRenderingContext2D API. The rendering function takes parameters for position, size, progress, stance, direction, gender, and age. The character can face left or right, and the rendering adapts based on the stance (e.g., idle, walk, eat, procreate).
The rendering function must be simple and efficient, it should not use complex patterns or gradients, and should focus on solid colors and basic shapes to maintain the pixel art aesthetic.

15% padding from all edges of the rendering box is required to ensure the character is not cut off during rendering.

Subtle shadow should be drawn under the a character to give it a sense of depth.

IMPORTANT: The character is visible from the side, just like in Sensible Soccer.

# Rendering parameters

- age: The age of the character, which affects the size and proportions of the body parts. Age is a number between 1 and 20, with 3 being the average age.
- gender:
  - 'male': Male predators are larger and more robust, with a more pronounced musculature.
  - 'female': Female predators are smaller and more agile, with a leaner build.
- isPregnant: (applicable only for females) Indicates if the character is pregnant, like very large belly. Pregnant characters should have a larger torso.
- direction: A vector indicating the character's facing direction. There should be at least 8 directions (like in Sensible Soccer): top left, top, top right, left, right, bottom left, bottom, bottom right. The character should be flipped horizontally if the direction vector's X component is negative.
             When moving up(top, top left, top right), the character back of the head should be visible, when moving down(Y > 0), the character face should be visible.
- hungryLevel: A number between 0 and 100 indicating how hungry the character is, hunger level 100 means the character is starving, 0 means the character is not hungry at all. So hungry characters should be thinner, with less body fat, and more pronounced muscles. The character's hunger level affects the size and proportions of the body parts, with hungrier characters being smaller and more gaunt.

# Rendering details

- All parts of the body must be connected
- Rendering must take into account direction vector (X and Y) to flip the character horizontally if needed
- The character's age affects the size and proportions of the body parts, with older characters being larger and more robust. Hair color should become gray for older characters.

# Stances

- 'idle': The character stands still, with a slight leg sway to indicate life.
- 'walk': The character moves forward, with legs and arms in motion.
- 'eat': The character holds food and brings it to their mouth, with a slight bend at the knees.
- 'procreate': The character performs a mating animation, with a specific pose and movement. There should be some additional visual effects to indicate this action, such as a slight glow or aura around the characters, or a dust particles to indicate movement.
- 'attacking': The character performs an attack animation, with arms raised and a forward motion.
- 'dead': The character lies on the ground, with limbs relaxed and a neutral expression, slowly turns into a grey skeleton over time. The character pose and body parts should not be animated in this stance, as the character is dead so it should not move.`,stances:["idle","walk","eat","dead","attacking","procreate"],render(e,t,r,o,l,s,u,d={gender:"male",age:20,direction:[1,0],isPregnant:!1,hungryLevel:0,geneCode:8405024}){const{gender:f,age:g,direction:m,isPregnant:S,hungryLevel:y,geneCode:w}=d;e.save();const A=o*.15,I=Math.max(1,Math.floor((o-A*2)/10)),C=m[0]<0;e.translate(t+o/2,r+l/2),C&&e.scale(-1,1);const F=QP(w),B=.8+Math.min(g,20)/20*.4,D=f==="male"?1.05:.95,H=1-y/100*.25,b=B*D*H,U=Math.max(0,Math.min(1,(g-15)/5));e.filter=`grayscale(${U})`;const $=F.furColor,ee=F.darkerFurColor,_e=F.eyeColor,Ce="#FFFFFF",be="#c75c5c",De="#E0E0E0",Pe="#A0A0A0",de=l/2-2*I,Ue=Math.sin(s*Math.PI*2),Te=Math.abs(Ue);if(e.fillStyle="rgba(0,0,0,0.15)",e.beginPath(),e.ellipse(0,de,I*4,I,0,0,2*Math.PI),e.fill(),e.filter="none",u==="dead"){const qe=Math.min(1,s*2);e.save(),e.translate(0,de-I*3),e.rotate(-Math.PI/2);const je=(xn,Yt,un,$n,zn=!1)=>{e.fillStyle=zn?Pe:De,e.fillRect(xn*I,Yt*I,un*I,$n*I)};qe<1&&(e.globalAlpha=1-qe,e.fillStyle=$,e.beginPath(),e.ellipse(0,0,I*3,I*5,0,0,Math.PI*2),e.fill(),e.globalAlpha=1),qe>0&&(e.globalAlpha=qe,je(-1,-4,2,2),je(1,-3.5,1,1,!0),je(-.5,-2,1,5,!0),je(-2.5,-1,5,.5),je(-2.5,0,5,.5),je(-2.5,1,5,.5),je(-3,-2,-1,2,!0),je(3,-2,1,2),je(-3,2,-1,2,!0),je(3,2,1,2),e.globalAlpha=1),e.restore(),e.restore();return}e.fillStyle=$;let ne=0,W=0,X=0,j=[0,0,0,0];switch(u){case"idle":ne=Ue*I*.1;break;case"walk":const qe=Math.sin(s*Math.PI*4);ne=Math.abs(qe)*-I*.5,j=[qe*I,-qe*I,-qe*I,qe*I];break;case"attacking":const je=Math.sin(s*Math.PI*4);W=I*2+je*I,X=I*2,ne=I;break;case"eat":X=I*3+Te*I,ne=I*1.5,e.fillStyle=be,e.fillRect(-I,de-I,I*2,I);break;case"procreate":ne=Math.sin(s*Math.PI*8)*I*.3,e.fillStyle="rgba(139, 69, 19, 0.5)";for(let Yt=0;Yt<5;Yt++){const un=(Math.random()-.5)*I*8,$n=de+(Math.random()-.5)*I*2;Te>.5&&e.fillRect(un,$n,I*.5,I*.5)}break}const P=I*3*b*(S?1.3:1),L=I*5*b,K=-L/1.5,ie=de-P-I*2.5+ne;e.fillStyle=$,e.beginPath(),e.moveTo(K-I*.5,ie+P*.5),e.quadraticCurveTo(K-I*3,ie-I,K-I*2+Ue*I,ie+P+I),e.fill();const Se=I*1.2*b,le=I*3*b,Ee=I*2.5*b,Ae=K+L*.8,Z=K+L*.2;e.fillStyle=ee,e.fillRect(Z,de-Ee,Se,Ee+j[2]),e.fillRect(Ae,de-le,Se,le+j[0]),e.fillStyle=$,e.beginPath(),e.moveTo(K,ie+P),e.lineTo(K,ie+I),e.quadraticCurveTo(K+L/2,ie,K+L,ie+I),e.lineTo(K+L,ie+P),e.fill(),e.fillStyle=$,e.fillRect(Z+I/2,de-Ee,Se,Ee+j[3]),e.fillRect(Ae+I/2,de-le,Se,le+j[1]);const re=I*3.5*b,Le=K+L-re*.3+W,ge=ie-re*.3+X;e.fillStyle=$,e.beginPath(),e.arc(Le,ge,re/2,0,Math.PI*2),e.fill(),e.beginPath(),e.ellipse(Le+re*.4,ge+re*.2,I*1.5,I,0,0,Math.PI*2),e.fill(),m[1]>=0&&(e.fillStyle=_e,e.fillRect(Le+I*.5,ge-I*.5,I*.5,I*.5),u==="attacking"&&(e.fillStyle=Ce,e.fillRect(Le+re*.5,ge+re*.4,I,I*.4))),e.fillStyle=ee,e.beginPath(),e.moveTo(Le-re*.4,ge-re*.3),e.lineTo(Le,ge-re*.7),e.lineTo(Le,ge-re*.2),e.fill(),e.restore()}},JP=9;function eN(e,t){const{position:r,gender:o,age:l,decayProgress:s,food:u,radius:d,originalEntityType:f,geneCode:g}=t;if(e.save(),e.globalAlpha=1-s,f==="human"?ph.render(e,r.x-d,r.y-d,d*2,d*2,s,"dead",o,l,[0,0],!1,0):f==="prey"?MS.render(e,r.x-d,r.y-d,d*2,d*2,s,"dead",{gender:o,age:l,direction:[0,0],isPregnant:!1,hungryLevel:0,geneCode:g||8405024}):f==="predator"&&kS.render(e,r.x-d,r.y-d,d*2,d*2,s,"dead",{gender:o,age:l,direction:[0,0],isPregnant:!1,hungryLevel:0,geneCode:g||8405024}),e.restore(),u.length>0){e.save(),e.font=`${JP}px Arial`,e.textAlign="center",e.textBaseline="middle";const m=wt*.9,S=Math.PI/wv*3;u.forEach((y,w)=>{const A=w*S,I=r.x+m*Math.cos(A)*Math.atan2(w,w),C=r.y+m*Math.sin(A)*Math.atan2(w,w),F=Wf[y.type];e.fillText(F,I,C)}),e.restore()}}function er(e,t,r,o,l,s,u,d){e.save(),e.fillStyle=u,e.fillRect(t,r,o,l),e.fillStyle=d,e.fillRect(t,r,o*Math.max(0,s),l),e.restore()}function tN(e,t,r,o,l,s){if(e.save(),o.length===0){e.restore();return}const u=o.length*l;let d;u>s||u+(o.length-1)*4>s?d=(s-u)/(o.length-1):d=4,o.length===1&&(d=0);for(let f=0;f<o.length;f++){const g=Wf[o[f].type];e.fillText(g,t+f*(l+d),r)}e.restore()}function nN(e,t,r,o,l){const s=t.autopilotControls.hoveredAutopilotAction;if(!s)return;let u,d=wt/2;const f=Mu[s.action],g=Qv[s.action],m=`${f} ${g}`;if("targetEntityId"in s){const S=t.entities.entities[s.targetEntityId];S&&(u=S.position,d=S.radius)}else"position"in s&&(u=s.position);if(u){DS(e,u,d,eh,th,2,r,o,l,t.mapDimensions),e.save(),e.font=`${bo}px "Press Start 2P", Arial`,e.fillStyle="white",e.textAlign="center",e.textBaseline="bottom",e.shadowColor="black",e.shadowBlur=5;const{x:S,y}=Uu(u,r,{width:o,height:l},t.mapDimensions),w=y-d-Ou-bo/2;e.fillText(m,S,w),e.restore()}}function iN(e,t,r,o,l){e.save();const s=(Math.sin(l*ih)+1)/2,u=r+Ou+s*5;e.strokeStyle=eh,e.lineWidth=2,e.setLineDash(th),e.beginPath(),e.arc(t.x,t.y,u,0,Math.PI*2),e.stroke(),e.setLineDash([]);const d=Mu[o],f=Qv[o];if(d){e.font=`${bo*1.5}px "Press Start 2P", Arial`,e.textAlign="center",e.textBaseline="middle";const g=t.y-u-25;e.fillText(d,t.x,g),e.font=`${bo*.8}px "Press Start 2P", Arial`,e.fillText(f,t.x,g+25)}e.restore()}function rN(e,t,r){e.save();const o=30,l=70,s=3,u=l/s;for(let d=0;d<s;d++){const f=d*u,g=(r*o+f)%l,m=1-g/l;e.strokeStyle=`rgba(255, 215, 0, ${m*.7})`,e.lineWidth=1+(1-m)*2,e.beginPath(),e.arc(t.x,t.y,g,0,Math.PI*2),e.stroke()}e.restore()}function oN(e,t){const{activeAutopilotAction:r,behaviors:o}=t.autopilotControls,l=vt(t);if(!l)return;const s=(u,d)=>{rN(u,d.position,t.time)};if(l.isCallingToFollow&&ln(e,t.mapDimensions.width,t.mapDimensions.height,s,{position:l.position}),o.followLeader&&!r&&ln(e,t.mapDimensions.width,t.mapDimensions.height,s,{position:l.position},70),r){let u,d=15;if("position"in r)u=r.position;else if("targetEntityId"in r){const f=t.entities.entities[r.targetEntityId];f&&(u=f.position,d=f.radius||30)}if(u&&r.action!==ae.AutopilotFollowMe&&!l.isCallingToFollow){const f=(g,m)=>{iN(g,m.position,d,r.action,t.time)};ln(e,t.mapDimensions.width,t.mapDimensions.height,f,{position:{...u}},u,d+30)}}}function D0(e,t,r,o,l,s,u=!0){const d=t.split(" ");let f="";const g=[];for(let m=0;m<d.length;m++){const S=f+d[m]+" ";e.measureText(S).width>l&&m>0?(g.push(f),f=d[m]+" "):f=S}if(g.push(f),u)for(let m=0;m<g.length;m++)e.fillText(g[m],r,o+m*s);return g.length*s}function sN(e){return 1-Math.pow(1-e,3)}function aN(e,t,r,o){t.notificationButtonRects={dismiss:{},view:{}};const l=t.notifications.filter(u=>!u.isDismissed);if(l.length===0)return;e.save();let s=o-a_;for(const u of l){const d=r-xl-Er;e.font=`${Gd}px "Press Start 2P", Arial`;const f=d+Er,g=xl-Er*2,m=D0(e,u.message,-9999,-9999,g,Gd*1.2,!1),S=Er*2+m+Zn,y=s-S,w=Date.now()-u.creationTime,A=Math.min(w/s_,1),I=sN(A),C=o,F=C+(y-C)*I;e.fillStyle=e_,e.beginPath(),e.roundRect(d,F,xl,S,Jw),e.fill(),e.fillStyle=t_,e.textBaseline="top",D0(e,u.message,f,F+Er,g,Gd*1.2,!0);const B=F+S-Zn-Er/2,D=d+xl-Zn-Er/2,H={x:D,y:B,width:Zn,height:Zn};t.notificationButtonRects&&(t.notificationButtonRects.dismiss[u.id]=H);const b=t.hoveredButtonId===`notification-dismiss-${u.id}`;if(e.fillStyle=b?l0:n_,e.font=`${Zn}px Arial`,e.textAlign="center",e.textBaseline="middle",e.fillText("",H.x+H.width/2,H.y+H.height/2),u.targetEntityIds||u.targetPosition||u.targetArea||u.targetRadius){const ee={x:D-Zn-a0,y:B,width:Zn,height:Zn};t.notificationButtonRects&&(t.notificationButtonRects.view[u.id]=ee);const _e=t.hoveredButtonId===`notification-view-${u.id}`;e.fillStyle=_e?l0:i_,e.font=`${Zn*(_e?1.5:1.2)}px Arial`,e.fillText("",ee.x+ee.width/2,ee.y+ee.height/2)}s-=S+a0}e.restore()}function lN(e){return e.length===0?0:e.reduce((r,o)=>r+o,0)/e.length}function sf(e,t,r,o,l,s,u,d){e.save(),e.fillStyle="rgba(255, 255, 255, 0.1)",e.fillRect(o,l,s,u),e.strokeStyle="#555",e.lineWidth=1,e.strokeRect(o,l,s,u);const f=lN(r);e.fillStyle="white",e.font="11px monospace",e.textAlign="left",e.fillText(`${t}: ${f.toFixed(2)}ms`,o+Ze,l+Ze+8);const g=Math.max(...r,1),m=r.map(S=>S/g*u);if(e.beginPath(),e.strokeStyle=d,e.lineWidth=2,m.length>1){e.moveTo(o,l+u-m[0]);for(let S=1;S<m.length;S++){const y=o+S/(m.length-1)*s,w=l+u-m[S];e.lineTo(y,w)}}else if(m.length===1){const S=l+u-m[0];e.moveTo(o,S),e.lineTo(o+s,S)}e.stroke(),e.fillStyle="rgba(255, 255, 255, 0.7)",e.font="10px monospace",e.textAlign="right",e.fillText(`${g.toFixed(2)}ms`,o+s-Ze,l+Ze+8),e.restore()}function uN(e,t,r){const{performanceMetrics:o}=t;if(!o)return;const l=280,s=240,u=r-l-Ze,d=Ze+Sn*2;e.save(),e.fillStyle="rgba(0, 0, 0, 0.8)",e.fillRect(u,d,l,s),e.strokeStyle="#444",e.lineWidth=2,e.strokeRect(u,d,l,s),e.fillStyle="white",e.font="12px monospace",e.textAlign="left";let f=d+Ze+5;const g=u+Ze;e.fillStyle="#66ccff",e.font="bold 14px monospace",e.fillText(" Performance Debugger",g,f),f+=25,e.fillStyle="white",e.font="12px monospace";const m=cN(t);e.fillText(`FPS: ${m.toFixed(1)}`,g,f),f+=20;const S=l-Ze*2,y=45,w=10;sf(e,"Render",af(t,"renderTime"),g,f,S,y,"#4CAF50"),f+=y+w,sf(e,"World Update",af(t,"worldUpdateTime"),g,f,S,y,"#2196F3"),f+=y+w,sf(e,"AI Update",af(t,"aiUpdateTime"),g,f,S,y,"#FFC107"),e.fillStyle="#888",e.font="10px monospace",e.textAlign="center",e.fillText("Press '2' to toggle this panel",u+l/2,d+s-10),e.restore()}function cN(e){const{performanceMetrics:t}=e;if(!t||t.history.length===0)return 0;const r=t.history[t.history.length-1].bucketTime/(It/Et);return t.history.filter(s=>r-s.bucketTime/(It/Et)<1).length}function dN(e,t){if(e.length===0)return[];const r=new Map;for(const s of e){const u=Math.floor(s.bucketTime/(It/Et));r.set(u,(r.get(u)||0)+s[t])}return Array.from(r.keys()).sort().map(s=>r.get(s)).slice(0,-1).slice(1).reverse()}function af(e,t){return dN(e.performanceMetrics.history,t)}function mh(e,t,r){if(!t.aiBlackboard)return;const o=t.aiBlackboard.nodeExecutionData,l=t.type==="human"?TS:t.type==="predator"?IS:t.type==="prey"?AS:null;if(!l)return;e.save(),e.font=`${Mw}px Arial`,e.textAlign="left",e.textBaseline="top";const s=y=>{switch(y){case T.SUCCESS:return Fw;case T.FAILURE:return Uw;case T.RUNNING:return Lw;case T.NOT_EVALUATED:case null:default:return Bw}},u=y=>{if(!y.name||!o[y.name])return{width:0,height:0};let w=0,A=0;const I=o[y.name],C=` ${y.name}`+(I!=null&&I.debugInfo?`: ${I.debugInfo}`:""),F=e.measureText(C).width,B=(y.depth??0)*n0+8+F+r0+Bs+20;if(w=Math.max(w,B),A+=Hd,y.children)for(const D of y.children){const H=u(D);w=Math.max(w,H.width),A+=H.height}else if(y.child){const D=u(y.child);w=Math.max(w,D.width),A+=D.height}return{width:w,height:A}},d=(y,w,A,I)=>{if(!y.name||!o[y.name])return w;let C=w;const F=o[y.name],B=A+2+(y.depth??0)*n0;let D=T.NOT_EVALUATED,H=i0,b="";if(F){D=F.status,b=F.debugInfo;const ee=bw/Et*It,_e=r-F.lastExecuted,Ce=Math.max(0,1-_e/ee);H=$E(i0,Hw,Ce),_e>la&&(D=T.NOT_EVALUATED)}const U=s(D);e.fillStyle=U,e.fillText("",B,C),e.fillStyle=H;const $=` ${y.name}`+(b?`: ${b}`:"");if(e.fillText($,B+8,C),F&&F.executionHistory.length>0){const{executionHistory:ee}=F,_e=Yv/Et*It,Ce=r,be=Ce-_e,De=A+I-Bs-r0;let Pe=De;const de=C+(Hd-Gl)/2,Ue=ee.filter(K=>K.time<be);let Te=Ue.length>0?Ue[Ue.length-1].status:null,ne=be;const W=ee.filter(K=>K.time>=be&&K.time<=Ce),X=Bs/_e;e.fillStyle="rgba(255, 255, 255, 0.1)",e.fillRect(De,de,Bs,Gl);for(const K of W){const Se=(K.time-ne)*X;Se>0&&(e.fillStyle=s(Te),e.fillRect(Pe,de,Se,Gl),Pe+=Se),Te=K.status,ne=K.time}r-ne>la&&(Te=T.NOT_EVALUATED);const P=(Ce-ne)*X;e.fillStyle=s(Te);const L=De+Bs-Pe;e.fillRect(Pe,de,Math.min(P,L),Gl)}if(C+=Hd,y.children)for(const ee of y.children)C=d(ee,C,A,I);else y.child&&(C=d(y.child,C,A,I));return C},{width:f,height:g}=u(l);if(g===0){e.restore();return}const m=t.position.x+Dw,S=t.position.y+Ow-g/2;e.fillStyle=kw,e.fillRect(m,S,f,g+4),d(l,S+2,m,f),e.restore()}const fN={moving:"walk",gathering:"gathering",eating:"eat",feeding:"eat",procreating:"procreate",idle:"idle",attacking:"attacking",planting:"gathering",depositing:"gathering",retrieving:"gathering",takingOverBuilding:"attacking",destroyingBuilding:"attacking"};function hN(e,t){var d;const{radius:r,position:o,activeAction:l="idle"}=t,s=((d=t.stateMachine)==null?void 0:d[0])||"N/A",u=t.isAdult?wt+20:wt*.6+20;e.save(),e.fillStyle="white",e.font="10px Arial",e.textAlign="center",e.fillText(`Action: ${l}`,o.x,o.y-u),e.fillText(`State: ${s}`,o.x,o.y-u+10),e.fillText(`HP: ${t.hitpoints}`,o.x,o.y-u+20),e.fillText(`Cooldown: ${t.attackCooldown||"N/A"}`,o.x,o.y-u+30),e.fillText(`Tribe: ${t.leaderId||"N/A"}`,o.x,o.y-u+40),e.restore(),e.beginPath(),e.arc(o.x,o.y,r,0,Math.PI*2),e.strokeStyle="rgba(255, 0, 0, 0.5)",e.lineWidth=1,e.stroke(),e.closePath()}function gN(e,t,r,o,l){e.save(),e.font=`${wf}px Arial`,e.textAlign="center",e.textBaseline="middle",e.fillText(r,t.x,t.y-(o?wt:jo)-wf-l),e.restore()}function pN(e,t,r,o,l){const s=t.x,u=t.y-r-o/2;e.save(),e.fillStyle=l,e.strokeStyle=l,e.lineWidth=1.5,e.beginPath(),e.rect(s-o/2,u,o,o/2),e.fill(),e.beginPath(),e.moveTo(s-o/2,u),e.lineTo(s-o/4,u-o/3),e.lineTo(s-o/6,u),e.moveTo(s-o/6,u),e.lineTo(s,u-o/2),e.lineTo(s+o/6,u),e.moveTo(s+o/6,u),e.lineTo(s+o/4,u-o/3),e.lineTo(s+o/2,u),e.stroke(),e.restore()}function mN(e,t,r){var d;const{position:o,radius:l}=t,s=o.x-Bd/2,u=o.y-l-ww;if(((d=t.stateMachine)==null?void 0:d[0])===or){const f=t.stateMachine[1],g=r-f.attackStartTime,m=Math.min(g/Nv,1);er(e,s,u,Bd,Qm,m,qi,_w)}else if(t.attackCooldown&&t.attackCooldown>0){const f=1-t.attackCooldown/Du;er(e,s,u,Bd,Qm,f,qi,Cw)}}function vN(e,t,r){const l="";e.save(),e.font="15px Arial",e.textAlign="center",e.textBaseline="bottom",e.shadowColor="black",e.shadowBlur=3,e.fillText(l,t.x,t.y-r),e.restore()}function SN(e,t,r=!1,o=!1,l=!1,s=!1,u=!1,d=!1,f=!1,g=!1,m,S){const{position:y,activeAction:w="idle"}=t,A=t.isAdult?wt:wt*.6,I=fN[w]||"idle";ph.render(e,y.x-A,y.y-A,A*2,A*2,t.animationProgress||0,I,t.gender,t.age,[t.direction.x,t.direction.y],t.isPregnant??!1,t.hunger),d&&(e.save(),e.strokeStyle=ow,e.lineWidth=2,e.beginPath(),e.arc(y.x,y.y,A+3,0,2*Math.PI),e.stroke(),e.restore());let C,F;if(u?(C=aw,F=Bv):r?(C=sw,F=Fv):l?(C=lw,F=rw):o?(C=uw,F=Uv):s&&(C=cw,F=Lv),C&&F&&pN(e,y,A,C,F),t.tribeBadge&&gN(e,y,t.tribeBadge,t.isAdult??!1,C??0),f){let D=(t.isAdult?wt:jo)+5;C&&(D+=C),t.tribeBadge&&(D+=wf),vN(e,y,D)}const B=g&&(S===void 0||t.id===S);B&&t.aiBlackboard&&mh(e,t,m),mN(e,t,m),B&&hN(e,t)}const yN={grazing:"eat",moving:"walk",procreating:"procreate",feeding:"eat",idle:"idle"};function TN(e,t){var d;const{radius:r,position:o,activeAction:l="idle"}=t,s=((d=t.stateMachine)==null?void 0:d[0])||"N/A",u=t.isAdult?wt+20:wt*.6+20;e.save(),e.fillStyle="white",e.font="10px Arial",e.textAlign="center",e.fillText(`Action: ${l}`,o.x,o.y-u),e.fillText(`State: ${s}`,o.x,o.y-u+10),e.fillText(`HP: ${t.hitpoints}`,o.x,o.y-u+20),e.fillText(`Hunger: ${Math.round(t.hunger)}`,o.x,o.y-u+30),e.fillText(`Age: ${Math.round(t.age)}`,o.x,o.y-u+40),e.restore(),e.beginPath(),e.arc(o.x,o.y,r,0,Math.PI*2),e.strokeStyle="rgba(0, 255, 0, 0.5)",e.lineWidth=1,e.stroke(),e.closePath()}function AN(e,t,r=!1,o=0,l){var m,S;const{position:s,activeAction:u="idle"}=t,d=t.isAdult?t.radius:t.radius*.6,f=yN[u]||"idle";if(MS.render(e,s.x-d,s.y-d,d*2,d*2,t.animationProgress||0,f,{gender:t.gender,age:t.age,direction:[((m=t.direction)==null?void 0:m.x)||1,((S=t.direction)==null?void 0:S.y)||0],isPregnant:t.isPregnant??!1,hungryLevel:t.hunger,geneCode:t.geneCode}),t.hitpoints<t.maxHitpoints){const y=d*1.5,w=3,A=s.x-y/2,I=s.y-d-8;e.fillStyle="#555",e.fillRect(A,I,y,w);const C=t.hitpoints/t.maxHitpoints;e.fillStyle=C>.5?"#4CAF50":C>.25?"#FFC107":"#F44336",e.fillRect(A,I,y*C,w)}const g=r&&(l===void 0||t.id===l);g&&t.aiBlackboard&&mh(e,t,o),g&&TN(e,t)}const IN={attacking:"attacking",eating:"eat",moving:"walk",procreating:"procreate",feeding:"eat",idle:"idle"};function EN(e,t){var d;const{radius:r,position:o,activeAction:l="idle"}=t,s=((d=t.stateMachine)==null?void 0:d[0])||"N/A",u=t.isAdult?wt+20:wt*.6+20;e.save(),e.fillStyle="white",e.font="10px Arial",e.textAlign="center",e.fillText(`Action: ${l}`,o.x,o.y-u),e.fillText(`State: ${s}`,o.x,o.y-u+10),e.fillText(`HP: ${t.hitpoints}`,o.x,o.y-u+20),e.fillText(`Hunger: ${Math.round(t.hunger)}`,o.x,o.y-u+30),e.fillText(`Age: ${Math.round(t.age)}`,o.x,o.y-u+40),e.restore(),e.beginPath(),e.arc(o.x,o.y,r,0,Math.PI*2),e.strokeStyle="rgba(255, 0, 0, 0.5)",e.lineWidth=1,e.stroke(),e.closePath()}function wN(e,t,r=!1,o=0,l){var m,S;const{position:s,activeAction:u="idle"}=t,d=t.isAdult?t.radius:t.radius*.6,f=IN[u]||"idle";if(kS.render(e,s.x-d,s.y-d,d*2,d*2,t.animationProgress||0,f,{gender:t.gender,age:t.age,direction:[((m=t.direction)==null?void 0:m.x)||1,((S=t.direction)==null?void 0:S.y)||0],isPregnant:t.isPregnant??!1,hungryLevel:t.hunger,geneCode:t.geneCode}),t.hitpoints<t.maxHitpoints){const y=d*1.5,w=3,A=s.x-y/2,I=s.y-d-8;e.fillStyle="#555",e.fillRect(A,I,y,w);const C=t.hitpoints/t.maxHitpoints;e.fillStyle=C>.5?"#4CAF50":C>.25?"#FFC107":"#F44336",e.fillRect(A,I,y*C,w)}(t.attackCooldown&&t.attackCooldown>0||t.huntCooldown&&t.huntCooldown>0)&&(e.strokeStyle="#FF8C00",e.lineWidth=3,e.beginPath(),e.arc(s.x,s.y,d+3,0,2*Math.PI),e.stroke());const g=r&&(l===void 0||t.id===l);g&&t.aiBlackboard&&mh(e,t,o),g&&EN(e,t)}const FS=15;function O0(e,t,r,o,l=1.5){const s=r-t.startTime,u=Math.min(s/t.duration,1),d=1-u,g=1+Math.sin(u*Math.PI*2)*(l-1),m=FS*g;e.save(),e.globalAlpha=d,e.beginPath(),e.arc(t.position.x,t.position.y,Math.max(0,m),0,Math.PI*2),e.fillStyle=o,e.fill(),e.restore()}function Io(e,t,r,o,l=2){const s=r-t.startTime,u=Math.min(s/t.duration,1),d=1-u,f=FS*2*u;e.save(),e.globalAlpha=d,e.beginPath(),e.arc(t.position.x,t.position.y,f,0,Math.PI*2),e.strokeStyle=o,e.lineWidth=l,e.stroke(),e.restore()}function Wi(e,t,r,o){const l=r-t.startTime,s=Math.min(l/t.duration,1),u=1-s,d=-20*s;e.save(),e.globalAlpha=u,e.font="20px Arial",e.textAlign="center",e.fillText(o,t.position.x,t.position.y+d),e.restore()}function _N(e,t,r){switch(t.type){case ce.Hunger:O0(e,t,r,"rgba(255, 165, 0, 0.7)",1);break;case ce.Procreation:Wi(e,t,r,"");break;case ce.Pregnant:O0(e,t,r,"rgba(255, 105, 180, 0.7)",1.2);break;case ce.TargetAcquired:Io(e,t,r,"rgba(255, 0, 0, 0.8)",3);break;case ce.Attack:Wi(e,t,r,"");break;case ce.Partnered:Wi(e,t,r,"");break;case ce.BushClaimed:Io(e,t,r,"rgba(0, 255, 0, 0.7)",2);break;case ce.BushClaimLost:Io(e,t,r,"rgba(128, 128, 128, 0.7)",2);break;case ce.Eating:Wi(e,t,r,"");break;case ce.ChildFed:Wi(e,t,r,"");break;case ce.AttackDeflected:Wi(e,t,r,"");break;case ce.AttackResisted:Wi(e,t,r,"");break;case ce.Hit:Wi(e,t,r,"");break;case ce.SeizeBuildup:Io(e,t,r,"rgba(255, 215, 0, 0.8)",4);break;case ce.Seize:Io(e,t,r,"rgba(148, 0, 211, 0.8)",4);break;case ce.CallToAttack:Io(e,t,r,"rgba(255, 255, 0, 0.8)",4);break}}function M0(e,t,r,o,l,s,u){e.save();const{position:d}=t;e.strokeStyle=o,e.lineWidth=l+Math.sin(u*s)*(l/2),e.setLineDash([8,8]),e.beginPath(),e.arc(d.x,d.y,r,0,2*Math.PI),e.stroke(),e.restore()}const k0=8,CN=1.5,RN=.5,F0=2,PN="#5a5a5a",NN="#7e7e7e",DN="#8B0000",ON="#FF4444",MN=6;function lf(e){const t=Math.sin(e)*1e4;return t-Math.floor(t)}function Of(e,t,r,o,l,s){const u=(t+r)*2,d=Math.floor(u/k0),f=-t/2,g=t/2,m=-r/2,S=r/2;for(let y=0;y<d;y++){const w=o+y*13,A=lf(w),I=lf(w+1);let C=y*k0,F=0,B=0;C<t?(F=f+C,B=m):C<t+r?(F=g,B=m+(C-t)):C<t*2+r?(F=g-(C-(t+r)),B=S):(F=f,B=S-(C-(t*2+r)));const D=(I-.5)*F0,H=(lf(w+2)-.5)*F0;e.beginPath();const b=CN+A*RN;l?e.fillStyle=l:e.fillStyle=A>.5?s||NN:l||PN,e.ellipse(F+D,B+H,b,b*.85,I*Math.PI,0,Math.PI*2),e.fill(),l||(e.strokeStyle="#2b2b2b",e.lineWidth=1,e.stroke())}}function kN(e,t){if(!t.storedFood||t.storedFood.length===0)return;const{position:r,storedFood:o}=t;e.save(),e.font=`${MN}px Arial`,e.textAlign="center",e.textBaseline="middle",e.shadowColor="rgba(0,0,0,0.5)",e.shadowBlur=2,o.forEach(l=>{const s=Wf[l.item.type],u={x:r.x+l.positionOffset.x,y:r.y+l.positionOffset.y};e.fillText(s,u.x,u.y)}),e.shadowBlur=0,e.shadowColor="transparent",e.restore()}function FN(e,t,r){const{position:o,width:l,height:s,constructionProgress:u,destructionProgress:d,isConstructed:f,isBeingDestroyed:g,id:m}=t,S=Ta[t.buildingType],y=vt(r),w=y&&Fn(y,t,r);e.save(),e.translate(o.x,o.y),f||(e.globalAlpha=.3+u*.7),w?Of(e,l,s,m,DN,ON):Of(e,l,s,m),e.globalAlpha=.5,e.font=`${Math.min(l,s,30)*.5}px Arial`,e.textAlign="center",e.textBaseline="middle",e.shadowColor="rgba(0,0,0,0.5)",e.shadowBlur=4,e.fillStyle="#FFFFFF",e.fillText(S.icon,0,0),e.shadowBlur=0,e.restore();const A=l,I=o.x-A/2,C=o.y+s/2+$_;f?g&&er(e,I,C,A,h0,1-d,qi,x_):er(e,I,C,A,h0,u,qi,G_),t.buildingType==="storageSpot"&&f&&kN(e,t)}function UN(e,t,r,o,l){const s=Ta[r],{width:u,height:d}=s.dimensions,f=(m,S)=>{m.save(),m.translate(S.x,S.y),m.globalAlpha=b_;const y=o?"#4CAF50":"#F44336";Of(m,u,d,9999,y),m.font=`${Math.min(u,d)*.5}px Arial`,m.textAlign="center",m.textBaseline="middle",m.fillStyle=y,m.fillText(s.icon,0,0),m.restore()},g={position:{...t},radius:Math.max(u,d)/2,id:0,type:"building",direction:{x:0,y:0},acceleration:0,forces:[],velocity:{x:0,y:0},debuffs:[]};ln(e,l.width,l.height,(m,S)=>f(m,S.position),g)}function LN(e,t,r,o,l){const s=vt(t),u=s?Lt(t,s):[],d=Si(u),{width:f,height:g}=t.mapDimensions;Object.values(t.entities.entities).sort((A,I)=>r&&A.id===t.debugCharacterId&&A.id!==I.id||A.type==="building"&&I.type!=="building"?-1:A.position.y-I.position.y||A.id-I.id).filter(A=>ql(A,o,l,t.mapDimensions)).forEach(A=>{var I,C;if(A.type==="building")ln(e,f,g,FN,A,t,s,t.time);else if(A.type==="berryBush")ln(e,f,g,KP,A,t,s,t.time);else if(A.type==="human"){const F=A,B=F.id===(s==null?void 0:s.id),D=u.some(Ce=>Ce.id===F.id),H=F.id===(d==null?void 0:d.id),b=s&&(F.id===s.motherId||F.id===s.fatherId),U=s&&(((I=F.partnerIds)==null?void 0:I.includes(s.id))||((C=s.partnerIds)==null?void 0:C.includes(F.id))),$=(s==null?void 0:s.attackTargetId)===F.id,ee=F.leaderId?t.entities.entities[F.leaderId]:void 0,_e=s?F.leaderId===s.id&&F.activeAction==="moving"&&F.target===F.leaderId&&(ee==null?void 0:ee.isCallingToFollow):!1;ln(e,f,g,SN,F,B,b,D,U,H,$,_e,r,t.time,t.debugCharacterId)}else A.type==="corpse"?ln(e,f,g,eN,A):A.type==="prey"?ln(e,f,g,AN,A,r,t.time,t.debugCharacterId):A.type==="predator"&&ln(e,f,g,wN,A,r,t.time,t.debugCharacterId)}),t.visualEffects.filter(A=>ql(A,o,l,t.mapDimensions)).forEach(A=>{ln(e,f,g,_N,A,t.time)});const w=t.notifications.filter(A=>!A.isDismissed);for(const A of w)if(A.highlightedEntityIds&&A.renderHighlights)for(const I of A.highlightedEntityIds){const C=t.entities.entities[I];C&&ql(C,o,l,t.mapDimensions)&&ln(e,f,g,M0,C,l_,u_,d_,c_,t.time)}if(t.tutorialState.isActive&&t.tutorialState.highlightedEntityIds.length>0)for(const A of t.tutorialState.highlightedEntityIds){const I=t.entities.entities[A];I&&ql(I,o,l,t.mapDimensions)&&ln(e,f,g,M0,I,Kw,jv,Vv,ih,t.time)}}function BN(e,t,r,o,l,s){let u=null,d=null;e.textAlign="left";let f=Ze+Sn;const m=t.time/(It/Et)/Nu%1,S=Hs[Eo.Time],y=25,w=Ze+y;e.fillText(S,Ze,f+rn/2+Sn/3),er(e,w,f,Gi,rn,m,qi,vw),f+=rn+ui;const A=f+Ar/2,I=f+(Ar-rn)/2,C=5;Sa(e,{x:Ze*2,y:A},Ar,5,r.gender,!1,!1,!1);const F=Ze+Ar+C,B=Gi+y-(Ar+C)*2;er(e,F,I,B,rn,Math.floor(r.age)/ua,qi,mw),Sa(e,{x:F+B+C+Ar/2,y:A},Ar,ua,r.gender,!1,!1,!1),f+=rn+ui*2;const D=[],H=new Set;if(D.push({member:r,isPlayer:!0,isHeir:!1,isPartner:!1,isParent:!1}),H.add(r.id),o&&!H.has(o.id)&&(D.push({member:o,isPlayer:!1,isHeir:!0,isPartner:!1,isParent:!1}),H.add(o.id)),l.forEach(de=>{H.has(de.id)||(D.push({member:de,isPlayer:!1,isHeir:!1,isPartner:!0,isParent:!1}),H.add(de.id))}),s.forEach(de=>{H.has(de.id)||(D.push({member:de,isPlayer:!1,isHeir:!1,isPartner:!1,isParent:!1}),H.add(de.id))}),r.motherId&&!H.has(r.motherId)){const de=t.entities.entities[r.motherId];de&&(D.push({member:de,isPlayer:!1,isHeir:!1,isPartner:!1,isParent:!0}),H.add(de.id))}if(r.fatherId&&!H.has(r.fatherId)){const de=t.entities.entities[r.fatherId];de&&(D.push({member:de,isPlayer:!1,isHeir:!1,isPartner:!1,isParent:!0}),H.add(de.id))}const b=Hs[Eo.Family],U=10,$=Ze+Sn+U,ee=Gi+y-(Sn+U),_e=f+Bl/2;e.font=`${Sn}px "Press Start 2P", Arial`,e.textBaseline="middle",e.fillText(b,Ze,_e);const Ce=f+Bl/2;zP(e,$,Ce,D,Bl,ee),f+=Bl+ui,e.textBaseline="alphabetic";const be=Hs[Eo.Hitpoints];e.fillText(be,Ze,f+rn/2+Sn/3),er(e,w,f,Gi,rn,r.hitpoints/r.maxHitpoints,qi,pw),f+=rn+ui;const De=Hs[Eo.Hunger];e.fillText(De,Ze,f+rn/2+Sn/3),er(e,w,f,Gi,rn,(br-r.hunger)/br,qi,gw),u={x:Ze,y:f-ui/2,width:Gi+y,height:rn+ui},f+=rn+ui,e.textBaseline="middle";const Pe=Hs[Eo.Food];return e.fillText(Pe,Ze,f+Ll/2),tN(e,w,f+Ll/2,r.food,Ll,Gi),d={x:Ze,y:f-ui/5,width:Gi+y,height:Ll+ui},e.textBaseline="alphabetic",{hungerBarRect:u,foodBarRect:d}}let zs=[],U0=0;const HN=36,bN=200;function GN(e,t,r,o){const l=t.search.prey.count(),s=t.search.predator.count(),u=t.search.berryBush.count();t.time-U0>=HN&&(zs.push({time:t.time,prey:l,predators:s,bushes:u}),zs.length>bN&&(zs=zs.slice(-200)),U0=t.time);const d=et*tt,f=l/d*1e6,g=s/d*1e6,m=u/d*1e6,S=CP(),y=Math.floor(t.time/(24*365)),w=Math.floor(t.time%(24*365)/24),A=Math.floor(t.time%24),I=400,C=Math.min(o*.8,600),F=r-I-10,B=Ze+Sn*2;e.save(),e.fillStyle="rgba(0, 0, 0, 0.9)",e.fillRect(F,B,I,C),e.strokeStyle="#444",e.lineWidth=2,e.strokeRect(F,B,I,C),e.fillStyle="white",e.font="12px monospace",e.textAlign="left";let D=B+20;const H=14,b=F+15;e.fillStyle="#66ccff",e.font="bold 14px monospace",e.fillText(" Ecosystem Debugger",b,D),D+=25,e.fillStyle="white",e.font="12px monospace",e.fillText(`Game Time: Year ${y}, Day ${w}, Hour ${A}`,b,D),D+=H,e.fillText(`Map Size: ${et}  ${tt} pixels`,b,D),D+=20,e.fillStyle="#66ccff",e.font="bold 13px monospace",e.fillText(" Q-Learning Status",b,D),D+=18,S&&(e.fillText(`Q-Table Size: ${S.qTableSize} entries`,b,D),D+=H,e.fillText(`Exploration Rate: ${(S.explorationRate*100).toFixed(1)}%`,b,D),D+=H);const U=zs.slice(-20);U.length>1&&(e.fillStyle="#66ccff",e.font="bold 13px monospace",e.fillText(" Population Trends (Last 20 Points)",b,D),D+=30,xN(e,b,D,U),D+=50),e.fillStyle="#66ccff",e.font="bold 13px monospace",e.fillText(" Density (per 1000 px)",b,D),D+=18,e.fillStyle="white",e.font="12px monospace";const $=(gi/d*1e6).toFixed(2),ee=(pi/d*1e6).toFixed(2),_e=(mi/d*1e6).toFixed(2);e.fillText(`Prey: ${f.toFixed(2)} (target: ${$})`,b,D),D+=H,e.fillText(`Predators: ${g.toFixed(2)} (target: ${ee})`,b,D),D+=H,e.fillText(`Bushes: ${m.toFixed(2)} (target: ${_e})`,b,D),D+=20,e.fillStyle="#66ccff",e.font="bold 13px monospace",e.fillText(" Current Population Status",b,D),D+=18,e.fillStyle="white",e.font="12px monospace";const Ce=Math.round(l/gi*100),be=Math.round(s/pi*100),De=Math.round(u/mi*100),Pe=de=>de<50?"#ff4444":de<80?"#ffaa44":de>120?"#44aaff":"#44ff44";e.fillStyle=Pe(Ce),e.fillText(`Prey: ${l}/${gi} (${Ce}%)`,b,D),D+=H,e.fillStyle=Pe(be),e.fillText(`Predators: ${s}/${pi} (${be}%)`,b,D),D+=H,e.fillStyle=Pe(De),e.fillText(`Bushes: ${u}/${mi} (${De}%)`,b,D),D+=20,e.fillStyle="#66ccff",e.font="bold 13px monospace",e.fillText(" Current Parameters",b,D),D+=18,e.fillStyle="white",e.font="10px monospace",e.fillText("Prey:",b,D),D+=13,e.fillText(` Gestation: ${t.ecosystem.preyGestationPeriod.toFixed(1)}h`,b,D),D+=11,e.fillText(` Procreation: ${t.ecosystem.preyProcreationCooldown.toFixed(1)}h`,b,D),D+=11,e.fillText(` Hunger: ${t.ecosystem.preyHungerIncreasePerHour.toFixed(1)}/h`,b,D),D+=13,e.fillText("Predators:",b,D),D+=13,e.fillText(` Gestation: ${t.ecosystem.predatorGestationPeriod.toFixed(1)}h`,b,D),D+=11,e.fillText(` Procreation: ${t.ecosystem.predatorProcreationCooldown.toFixed(1)}h`,b,D),D+=11,e.fillText(` Hunger: ${t.ecosystem.predatorHungerIncreasePerHour.toFixed(1)}/h`,b,D),D+=13,e.fillText("Bushes:",b,D),D+=13,e.fillText(` Spread Chance: ${(t.ecosystem.berryBushSpreadChance*100).toFixed(1)}%`,b,D),D+=15,e.fillStyle="#888",e.font="10px monospace",e.textAlign="center",e.fillText("Press '1' to toggle this debugger",F+I/2,B+C-10),e.restore()}function xN(e,t,r,o){if(o.length<2)return;const d={prey:Math.max(...o.map(g=>g.prey),gi),predators:Math.max(...o.map(g=>g.predators),pi),bushes:Math.max(...o.map(g=>g.bushes),mi)};[{data:o.map(g=>g.prey),color:"#44ff44",label:"Prey",target:gi,max:d.prey},{data:o.map(g=>g.predators),color:"#ff4444",label:"Predators",target:pi,max:d.predators},{data:o.map(g=>g.bushes),color:"#ffaa44",label:"Bushes",target:mi,max:d.bushes}].forEach((g,m)=>{const S=t+m*115,y=r;e.fillStyle=g.color,e.font="10px monospace",e.fillText(g.label,S,y-5),e.strokeStyle="#333",e.lineWidth=1,e.strokeRect(S,y,100,30),e.beginPath(),e.strokeStyle=g.color;for(let A=0;A<g.data.length;A++){const I=S+A/(g.data.length-1)*100,C=y+30-g.data[A]/g.max*30;A===0?e.moveTo(I,C):e.lineTo(I,C)}e.stroke(),e.beginPath(),e.strokeStyle="#888",e.setLineDash([2,2]);const w=y+30-g.target/g.max*30;e.moveTo(S,w),e.lineTo(S+100,w),e.stroke(),e.setLineDash([])})}function L0(e,t,r){e.save();const{x:o,y:l,width:s,height:u}=t.rect,d=bv;if(e.beginPath(),e.moveTo(o+d,l),e.lineTo(o+s-d,l),e.quadraticCurveTo(o+s,l,o+s,l+d),e.lineTo(o+s,l+u-d),e.quadraticCurveTo(o+s,l+u,o+s-d,l+u),e.lineTo(o+d,l+u),e.quadraticCurveTo(o,l+u,o,l+u-d),e.lineTo(o,l+d),e.quadraticCurveTo(o,l,o+d,l),e.closePath(),e.fillStyle=t.isDisabled?Gv:t.backgroundColor,e.fill(),t.activated){e.save();const f=(Math.sin(Date.now()/1e3*Wv)+1)/2;e.strokeStyle=zv,e.lineWidth=2+f*2,e.globalAlpha=.7+f*.3,e.stroke(),e.restore()}if(t.lastActivated){const f=Date.now()-t.lastActivated;if(f<vu){const g=1-f/vu;e.fillStyle=$v,e.globalAlpha=g,e.fill(),e.globalAlpha=1}}r&&!t.isDisabled&&(e.fillStyle=nh,e.globalAlpha=.5,e.fill(),e.globalAlpha=1),e.fillStyle=t.isDisabled?xv:t.textColor,t.icon?(e.font=`${u*.55}px "Press Start 2P", Arial`,e.textAlign="center",e.textBaseline="middle",e.fillText(t.icon,o+s/2,l+u/2),t.text&&(e.font=`${u*.18}px "Press Start 2P", Arial`,e.textAlign="right",e.textBaseline="bottom",e.fillText(t.text,o+s-4,l+u-2))):(e.font=`${Sn*1.5}px "Press Start 2P", Arial`,e.textAlign="center",e.textBaseline="middle",e.fillText(t.text,o+s/2,l+u/2)),e.restore()}function $N(e,t,r,o){e.save(),e.fillStyle="rgba(0, 0, 0, 0.6)",e.fillRect(0,0,r,o);const l=500,s=150,u=(r-l)/2,d=(o-s)/2;e.fillStyle=yn,e.font=`${Sn*1.1}px "Press Start 2P", Arial`,e.textAlign="center",e.textBaseline="middle",e.fillText("Are you sure you want to exit",r/2,d+s/3-10),e.fillText("to the main menu?",r/2,d+s/3+10);const f=hi*1.5,g=Hv,m=d+s-g-Ze*2,S=20,y=f*2+S,w=u+(l-y)/2,A={id:"confirmExitYes",action:pe.ConfirmExitYes,rect:{x:w,y:m,width:f,height:g},text:"Yes",backgroundColor:Xi,textColor:yn,currentWidth:f},I=w+f+S,C={id:"confirmExitNo",action:pe.ConfirmExitNo,rect:{x:I,y:m,width:f,height:g},text:"No",backgroundColor:Xi,textColor:yn,currentWidth:f};t.uiButtons.push(A,C),L0(e,A,t.hoveredButtonId===A.id),L0(e,C,t.hoveredButtonId===C.id),e.restore()}function Au(e,t,r,o,l,s=!1){var f;if(e.save(),e.clearRect(0,0,e.canvas.width,e.canvas.height),e.fillStyle="#2c5234",e.fillRect(0,0,e.canvas.width,e.canvas.height),e.translate(e.canvas.width/2-r.x,e.canvas.height/2-r.y),!s&&t.gameOver){e.restore(),VP(e,t);return}LN(e,t,t.debugPanel===Rt.General,r,l);const u=vt(t);if(u&&t.selectedBuildingType&&t.selectedBuildingType!=="removal"&&t.mousePosition){const g=Df(t.mousePosition,r,l,t.mapDimensions),m=uh(g,t.selectedBuildingType,u.leaderId,t);UN(e,g,t.selectedBuildingType,m,t.mapDimensions)}const d=t.notifications.filter(g=>!g.isDismissed);for(const g of d){const m=(Math.sin(t.time*o_)+1)/2;e.globalAlpha=m*.5+.25,e.fillStyle=r_,g.targetArea&&e.fillRect(g.targetArea.x,g.targetArea.y,g.targetArea.width,g.targetArea.height),g.targetRadius&&(e.beginPath(),e.arc(g.targetRadius.x,g.targetRadius.y,g.targetRadius.radius,0,Math.PI*2),e.fill())}if(e.globalAlpha=1,oN(e,t),e.restore(),!s){e.fillStyle=dw,e.font=`${Sn}px "Press Start 2P", Arial`,e.shadowColor=fw,e.shadowBlur=hw,t.uiButtons=[];let g=null,m=null;if(u){const w=Lt(t,u),A=Si(w),I=((f=u.partnerIds)==null?void 0:f.map(F=>t.entities.entities[F]).filter(F=>F!==void 0))||[],C=BN(e,t,u,A,I,w);g=C.hungerBarRect,m=C.foodBarRect}const S=Mv(t,u==null?void 0:u.leaderId);WP(e,t,S,e.canvas.width,e.canvas.height);const{commandButtonsRect:y}=OP(e,t,e.canvas.width);if(e.shadowColor="transparent",e.shadowBlur=0,u&&(nN(e,t,r,e.canvas.width,e.canvas.height),o.length>0&&UP(e,o,u,r,e.canvas.width,e.canvas.height,t.mapDimensions)),t.tutorialState.activeUIHighlights.length>0){const{activeUIHighlights:w}=t.tutorialState;w.includes(Lr.HUNGER_BAR)&&g&&rf(e,g,t.time),w.includes(Lr.FOOD_BAR)&&m&&rf(e,m,t.time),w.includes(Lr.COMMAND_BUTTONS)&&y&&rf(e,y,t.time)}if(t.tutorialState.isActive){const w=jP(e,t,e.canvas.width,e.canvas.height);w&&t.uiButtons.push({id:"tutorial-dismiss",action:pe.DismissTutorial,rect:w,text:"",currentWidth:w.width,backgroundColor:"transparent",textColor:"transparent"})}switch(aN(e,t,e.canvas.width,e.canvas.height),t.debugPanel){case Rt.Ecosystem:GN(e,t,e.canvas.width,e.canvas.height);break;case Rt.Performance:uN(e,t,l.width);break}t.isPaused&&t.exitConfirmation!=="pending"&&MP(e),t.exitConfirmation==="pending"&&$N(e,t,e.canvas.width,e.canvas.height)}}const zN=In.div`
  position: relative;
  width: 100vw;
  height: 100vh;
  overflow: hidden;
`,WN=In.canvas`
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background-color: #2c5234;
`,YN=In.div`
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  text-align: center;
  z-index: 1;
  background: linear-gradient(to bottom, rgba(0, 0, 0, 0.7) 0%, rgba(0, 0, 0, 0) 50%, rgba(0, 0, 0, 0.7) 100%);
`,jN=In.h1`
  font-family: 'Press Start 2P', cursive;
  font-size: 4rem;
  color: #fff;
  text-shadow: 4px 4px 0px #ff0000;
  margin-bottom: 2rem;
`,B0=In.button`
  font-family: 'Press Start 2P', cursive;
  font-size: 1.5rem;
  padding: 1rem 2rem;
  color: #fff;
  background-color: #ff0000;
  border: 2px solid #fff;
  box-shadow: 4px 4px 0px #fff;
  cursor: pointer;
  transition: all 0.2s ease-in-out;

  &:hover {
    background-color: #fff;
    color: #ff0000;
    box-shadow: 4px 4px 0px #ff0000;
  }
`,VN=In.div`
  display: flex;
  flex-direction: column;
  gap: 1.5rem;
  align-items: center;
`,XN=In.div`
  position: absolute;
  bottom: 1rem;
  font-family: 'Press Start 2P', cursive;
  font-size: 0.8rem;
  color: #fff;
  text-shadow: 2px 2px 0px #000;
  a {
    color: #fff;
    text-decoration: none;
    &:hover {
      text-decoration: underline;
    }
  }
`,eu="intro-soundtrack",H0=()=>{const{setAppState:e,savedGameState:t,clearCurrentSave:r}=Wo(),o=Re.useRef(null),l=Re.useRef(null),s=Re.useRef(FR()),u=Re.useRef(),d=Re.useRef(s.current.viewportCenter),f=Re.useRef(),g=Re.useCallback(()=>{Wd(eu,2),r(),e("game")},[e,r]),m=Re.useCallback(()=>{t&&(Wd(eu,2),e("game"))},[e,t]);Re.useEffect(()=>{const w=A=>{(A.key==="Enter"||A.key===" ")&&(t?m():g())};return window.addEventListener("keydown",w),()=>{window.removeEventListener("keydown",w)}},[g,m,t]),Re.useEffect(()=>(oh(fe.SoundTrack1,{loop:!0,trackId:eu}),()=>{Wd(eu,2)}),[]),Re.useEffect(()=>{const w=o.current;if(!w)return;l.current=w.getContext("2d");const A=()=>{w&&l.current&&(w.width=window.innerWidth,w.height=window.innerHeight,Au(l.current,s.current,d.current,[],{width:w.width,height:w.height},!0))};return A(),window.addEventListener("resize",A),()=>window.removeEventListener("resize",A)},[]),Re.useEffect(()=>{const w=()=>{const I=kv(s.current);if(I.length>0){const C=Math.floor(Math.random()*I.length);f.current=I[C].id}};w();const A=setInterval(w,sI);return()=>clearInterval(A)},[]);const[S,y]=pv(w=>{var C,F;if(!l.current)return;if(u.current===void 0){u.current=w;return}const A=Math.min((w-u.current)/1e3,1);s.current=Fu(s.current,A);const I=f.current?s.current.entities.entities[f.current]:void 0;if(I){const{mapDimensions:B}=s.current,{width:D,height:H}=B;let b={...I.position};const U=b.x-d.current.x;Math.abs(U)>D/2&&(U>0?b.x-=D:b.x+=D);const $=b.y-d.current.y;Math.abs($)>H/2&&($>0?b.y-=H:b.y+=H);let ee=qf(d.current,b,zf*A);ee={x:(ee.x%D+D)%D,y:(ee.y%H+H)%H},d.current=ee}Au(l.current,s.current,d.current,[],{width:((C=o.current)==null?void 0:C.width)||800,height:((F=o.current)==null?void 0:F.height)||600},!0),u.current=w});return Re.useEffect(()=>(y(),S),[y,S]),Fe.jsxs(zN,{children:[Fe.jsx(WN,{ref:o}),Fe.jsxs(YN,{children:[Fe.jsx(jN,{children:"Tribe2"}),Fe.jsxs(VN,{children:[Fe.jsx(B0,{onClick:g,children:"New Game"}),t&&Fe.jsx(B0,{onClick:m,children:"Load Game"})]}),Fe.jsxs(XN,{children:["by"," ",Fe.jsx("a",{href:"https://github.com/gtanczyk",target:"_blank",rel:"noopener noreferrer",children:"gtanczyk"})]})]})]})};function KN(){console.log("Tribe game initialized with detailed 2D world state.");const e=kR();return e.ecosystem={preyGestationPeriod:Or,preyProcreationCooldown:Mr,predatorGestationPeriod:kr,predatorProcreationCooldown:Fr,preyHungerIncreasePerHour:Qi,predatorHungerIncreasePerHour:Ji,berryBushSpreadChance:vi},e.debugPanel=Rt.None,e.performanceMetrics={currentBucket:{renderTime:0,worldUpdateTime:0,aiUpdateTime:0},history:[]},e}const ZN=({canvasRef:e,ctxRef:t,gameStateRef:r,viewportCenterRef:o,playerActionHintsRef:l})=>(Re.useEffect(()=>{const s=e.current;if(!s)return;t.current=s.getContext("2d");const u=()=>{s&&t.current&&r.current&&(s.width=window.innerWidth,s.height=window.innerHeight,Au(t.current,r.current,o.current,l.current,{width:s.width,height:s.height},!1))};return u(),window.addEventListener("resize",u),()=>window.removeEventListener("resize",u)},[]),Fe.jsx("canvas",{ref:e,style:{display:"block",background:"#2c5234"}})),qN=(e,t,r,o=!1)=>{let l;const s=nw(e,r);if(s){if(t.isAdult&&s.type==="berryBush"&&s.food.length>0)l={action:ae.AutopilotGather,targetEntityId:s.id};else if(t.isAdult&&s.type==="corpse"&&s.food.length>0)l={action:ae.AutopilotGather,targetEntityId:s.id};else if(s.type==="human"){const u=s;t.isAdult&&Vo(t,u,r)?l={action:ae.AutopilotAttack,targetEntityId:u.id}:zr(t,u,r)?l={action:ae.AutopilotProcreate,targetEntityId:u.id}:t.food.length>0&&!u.isAdult&&(u.motherId===t.id||u.fatherId===t.id)&&(l={action:ae.AutopilotFeedChild,targetEntityId:u.id})}else if(s.type==="prey")l={action:ae.AutopilotAttack,targetEntityId:s.id};else if(s.type==="predator")l={action:ae.AutopilotAttack,targetEntityId:s.id};else if(s.type==="building"){const u=s;if(r.selectedBuildingType==="removal")l={action:ae.Removal,position:s.position};else if(u.buildingType==="storageSpot"){const d=u.ownerId===t.leaderId,f=u.storedFood!==void 0&&u.storedFood.length>0,g=u.storedFood!==void 0&&u.storageCapacity!==void 0&&u.storedFood.length<u.storageCapacity;if(o&&u.isConstructed&&f&&t.food.length<t.maxFood)if(d)l={action:ae.AutopilotRetrieve,targetEntityId:s.id};else{const m=t.leaderId?r.entities.entities[t.leaderId]:void 0;m&&m.diplomacy?m.diplomacy[u.ownerId]===pt.Hostile?l={action:ae.AutopilotGather,targetEntityId:s.id}:l={action:ae.AutopilotMove,position:e}:l={action:ae.AutopilotMove,position:e}}else d&&u.isConstructed?t.food.length>0&&g?l={action:ae.AutopilotDeposit,targetEntityId:s.id}:t.food.length<t.maxFood&&f?l={action:ae.AutopilotRetrieve,targetEntityId:s.id}:l={action:ae.AutopilotMove,position:e}:l={action:ae.AutopilotMove,position:e}}else u.buildingType==="plantingZone"&&t.food.filter(d=>d.type===Bn.Berry).length>=Br&&!bn(e,r,Hr)?l={action:ae.AutopilotPlant,position:e}:l={action:ae.AutopilotMove,position:e}}}else t.food.filter(u=>u.type===Bn.Berry).length>=Br&&(r.autopilotControls.isManuallyPlanting||rC(e,t,r))?l={action:ae.AutopilotPlant,position:e}:l={action:ae.AutopilotMove,position:e};return l},QN=(e,t)=>{if(e.isPaused)return;const r=vt(e);if(!r)return;if(e.selectedBuildingType&&e.selectedBuildingType!=="removal"){uh(t,e.selectedBuildingType,r.leaderId,e)&&(nS(t,e.selectedBuildingType,r.leaderId,e),e.selectedBuildingType=null);return}if(e.selectedBuildingType==="removal"){const l=j_(t,e);l&&Y_(l.id,e);return}const o=e.autopilotControls.hoveredAutopilotAction;e.autopilotControls.activeAutopilotAction=void 0,o?(e.autopilotControls.activeAutopilotAction=o,(o.action===ae.AutopilotMove||o.action===ae.AutopilotGather)&&(e.hasPlayerMovedEver=!0),o.action===ae.AutopilotPlant&&(e.hasPlayerPlantedBush=!0)):e.autopilotControls.activeAutopilotAction={action:ae.AutopilotMove,position:t},e.autopilotControls.isManuallyMoving=!1,e.autopilotControls.isManuallyPlanting=!1},JN=(e,t)=>{var u,d,f,g;const r=e.key.toLowerCase(),o=e.ctrlKey||e.metaKey;let l=!0,s=t;if(o){switch(r){case"s":Uf(t);break;default:l=!1;break}return{newState:s,handled:l}}switch(r){case"escape":const{autopilotControls:m}=t;m.activeAutopilotAction||m.isManuallyMoving||m.isManuallyPlanting||t.buildMenuOpen||t.selectedBuildingType?(m.activeAutopilotAction=void 0,m.isManuallyMoving=!1,m.isManuallyPlanting=!1,t.buildMenuOpen=!1,t.selectedBuildingType=null):s.exitConfirmation==="pending"?(s.exitConfirmation="inactive",s.isPaused=!1):(s.exitConfirmation="pending",s.isPaused=!0);break;case"m":t.isMuted=!t.isMuted,Qs(t.masterVolume,t.isMuted);break;case"=":case"+":const S=Math.min(1,t.masterVolume+.1);t.masterVolume=parseFloat(S.toFixed(1)),Qs(t.masterVolume,t.isMuted);break;case"-":const y=Math.max(0,t.masterVolume-.1);t.masterVolume=parseFloat(y.toFixed(1)),Qs(t.masterVolume,t.isMuted);break;case"t":s=Fu(t,qv);break;case" ":case"p":t.isPaused=!t.isPaused;break;case"":case"`":s.debugPanel===Rt.General?(s.debugPanel=Rt.None,s.debugCharacterId=void 0):(s.debugPanel=Rt.General,s.debugCharacterId||(s.debugCharacterId=((u=vt(s))==null?void 0:u.id)??((d=Object.values(s.entities.entities).find(A=>A.type==="human"||A.type==="prey"||A.type==="predator"))==null?void 0:d.id)));break;case"!":if(e.shiftKey){if(s.debugPanel===Rt.Ecosystem){s.debugPanel=Rt.None;break}s.debugPanel=Rt.Ecosystem,s.debugCharacterId||(s.debugCharacterId=((f=vt(s))==null?void 0:f.id)??((g=Object.values(s.entities.entities).find(A=>A.type==="human"||A.type==="prey"||A.type==="predator"))==null?void 0:g.id))}else l=!1;break;case"@":if(e.shiftKey){if(s.debugPanel===Rt.Performance){s.debugPanel=Rt.None;break}s.debugPanel=Rt.Performance}else l=!1;break;case"tab":s.debugPanel=Rt.General;const w=Object.values(s.entities.entities).filter(A=>A.type==="human"||A.type==="prey"||A.type==="predator");if(w.length>0){const A=w.sort((B,D)=>{if(B.type==="human"&&B.isPlayer)return-1;if(D.type==="human"&&D.isPlayer)return 1;if(B.type!==D.type){const H={human:0,prey:1,predator:2},b=H[B.type]??999,U=H[D.type]??999;return b-U}return B.id-D.id}),I=s.debugCharacterId,F=((I?A.findIndex(B=>B.id===I):-1)+1)%A.length;s.debugCharacterId=A[F].id}else s.debugCharacterId=void 0;break;default:l=!1;break}return{newState:s,handled:l}},eD=(e,t,r,o,l)=>{const s={gameState:r};if(t&&["e","b","r","h"].includes(e)&&r.hasPlayerEnabledAutopilot++,r.buildMenuOpen){if(e==="1"){r.selectedBuildingType="storageSpot",Ie(s,fe.ButtonClick,o.position);return}else if(e==="2"){r.selectedBuildingType="plantingZone",Ie(s,fe.ButtonClick,o.position);return}else if(e==="3"){r.selectedBuildingType="removal",Ie(s,fe.ButtonClick,o.position);return}}if(e==="escape"&&r.selectedBuildingType){r.selectedBuildingType=null;return}if(e==="e"){if(t){r.autopilotControls.behaviors.gathering=!r.autopilotControls.behaviors.gathering;return}const u=Ne(o,r,"berryBush",mt,g=>g.food.length>0&&o.food.length<o.maxFood),d=Ne(o,r,"corpse",mt,g=>g.food.length>0&&o.food.length<o.maxFood);let f=null;u&&d?f=Y(o.position,u.position,r.mapDimensions.width,r.mapDimensions.height)<=Y(o.position,d.position,r.mapDimensions.width,r.mapDimensions.height)?u:d:f=u||d,f&&(o.activeAction="gathering",Ie(s,fe.Gather,o.position))}else if(e==="r"){if(t){r.autopilotControls.behaviors.procreation=!r.autopilotControls.behaviors.procreation;return}Ne(o,r,"human",mt,d=>zr(o,d,r))&&(o.activeAction="procreating",Ie(s,fe.Procreate,o.position))}else if(e==="f")o.food.length>0&&(o.activeAction="eating",Ie(s,fe.Eat,o.position));else if(e==="h"){if(t){r.autopilotControls.behaviors.feedChildren=!r.autopilotControls.behaviors.feedChildren;return}const u=l.find(d=>d.type===ae.FeedChild);u&&u.targetEntity&&(o.activeAction="feeding",o.target=u.targetEntity.id)}else if(e==="arrowup"||e==="w")o.direction.y=-1,o.activeAction="moving",o.target=void 0,r.hasPlayerMovedEver=!0,r.autopilotControls.isManuallyMoving=!0,r.autopilotControls.activeAutopilotAction=void 0;else if(e==="arrowdown"||e==="s")o.direction.y=1,o.activeAction="moving",o.target=void 0,r.hasPlayerMovedEver=!0,r.autopilotControls.isManuallyMoving=!0,r.autopilotControls.activeAutopilotAction=void 0;else if(e==="arrowleft"||e==="a")o.direction.x=-1,o.activeAction="moving",o.target=void 0,r.hasPlayerMovedEver=!0,r.autopilotControls.isManuallyMoving=!0,r.autopilotControls.activeAutopilotAction=void 0;else if(e==="arrowright"||e==="d")o.direction.x=1,o.activeAction="moving",o.target=void 0,r.hasPlayerMovedEver=!0,r.autopilotControls.isManuallyMoving=!0,r.autopilotControls.activeAutopilotAction=void 0;else if(e==="q"){if(t){r.autopilotControls.behaviors.attack=!r.autopilotControls.behaviors.attack;return}const u=Ne(o,r,"human",ei,d=>Vo(o,d,r))??Ne(o,r,"predator",ei)??Ne(o,r,"prey",ei);u&&(o.activeAction="attacking",o.attackTargetId=u.id)}else if(e==="b"){if(t){r.autopilotControls.behaviors.planting=!r.autopilotControls.behaviors.planting;return}if(l.find(d=>d.type===ae.Plant)){const d=VE(o.position,r,50,Af);d&&(o.activeAction="planting",o.target=d,r.hasPlayerPlantedBush=!0)}}else if(e==="x"){if(t){r.autopilotControls.behaviors.gathering=!r.autopilotControls.behaviors.gathering;return}const u=Ne(o,r,"building",An,d=>{const f=d;return f.buildingType==="storageSpot"&&f.ownerId===o.leaderId&&f.isConstructed&&f.storedFood!==void 0&&f.storageCapacity!==void 0&&f.storedFood.length<f.storageCapacity});u&&(o.activeAction="idle",o.target=u.id,Ie(s,fe.StorageDeposit,o.position))}else if(e==="z"){if(t){r.autopilotControls.behaviors.feedChildren=!r.autopilotControls.behaviors.feedChildren;return}const u=Ne(o,r,"building",An,d=>{const f=d;return f.buildingType==="storageSpot"&&f.ownerId===o.leaderId&&f.isConstructed&&f.storedFood!==void 0&&f.storedFood.length>0});u&&(o.activeAction="idle",o.target=u.id,Ie(s,fe.StorageRetrieve,o.position))}else e==="v"?(o.isCallingToAttack=!0,o.callToAttackEndTime=r.time+Go,Me(r,ce.CallToAttack,o.position,Go),Ie(s,fe.CallToAttack,o.position)):e==="c"?(o.isCallingToFollow=!0,o.callToFollowEndTime=r.time+da,Me(r,ce.CallToFollow,o.position,da),Ie(s,fe.CallToFollow,o.position)):e==="k"?ah(o,r):e==="l"&&(r.buildMenuOpen=!r.buildMenuOpen,Ie(s,fe.ButtonClick,o.position))},tD=(e,t,r,o)=>{e==="arrowup"||e==="w"||e==="arrowdown"||e==="s"?t.direction.y=0:(e==="arrowleft"||e==="a"||e==="arrowright"||e==="d")&&(t.direction.x=0),!o.current.has("arrowup")&&!o.current.has("arrowdown")&&!o.current.has("arrowleft")&&!o.current.has("arrowright")&&!o.current.has("w")&&!o.current.has("a")&&!o.current.has("s")&&!o.current.has("d")&&(t.activeAction==="moving"&&(t.activeAction="idle"),r.autopilotControls.isManuallyMoving=!1),!o.current.has("e")&&t.activeAction==="gathering"&&(t.activeAction="idle"),!o.current.has("f")&&t.activeAction==="eating"&&(t.activeAction="idle"),!o.current.has("r")&&t.activeAction==="procreating"&&(t.activeAction="idle"),!o.current.has("h")&&t.activeAction==="feeding"&&(t.activeAction="idle")},nD=(e,t,r)=>{let l=vt(e);if(e.debugCharacterId){const s=e.entities.entities[e.debugCharacterId];s&&"position"in s&&(l=s)}if(l){const{mapDimensions:s}=e,{width:u,height:d}=s;let f={...l.position};const g=f.x-t.x;Math.abs(g)>u/2&&(g>0?f.x-=u:f.x+=u);const m=f.y-t.y;Math.abs(m)>d/2&&(m>0?f.y-=d:f.y+=d);let S=qf(t,f,zf*r);return S={x:(S.x%u+u)%u,y:(S.y%d+d)%d},S}return e.viewportCenter};function iD(e,t){const{width:r,height:o}=e.mapDimensions;e.viewportCenter={x:(t.x%r+r)%r,y:(t.y%o+o)%o}}const rD=(e,t,r,o)=>{const l={gameState:r},s=vt(r);s&&Ie(l,fe.ButtonClick,s.position);const u=r.uiButtons.find(f=>f.id===e.id);u&&(u.lastActivated=Date.now()),t&&[pe.CommandGather,pe.CommandPlant,pe.ToggleProcreationBehavior].includes(e.action)&&r.hasPlayerEnabledAutopilot++;const{behaviors:d}=r.autopilotControls;switch(e.action){case pe.ReturnToIntro:r.exitConfirmation="pending",r.isPaused=!0;break;case pe.ConfirmExitYes:o(),r.exitConfirmation="inactive";break;case pe.ConfirmExitNo:r.exitConfirmation="inactive",r.isPaused=!1;break;case pe.ToggleMute:r.isMuted=!r.isMuted,Qs(r.masterVolume,r.isMuted);break;case pe.TogglePause:r.isPaused=!r.isPaused;break;case pe.FastForward:return Fu(r,qv);case pe.DismissTutorial:r.tutorialState.isActive=!1;break;case pe.CommandEat:s&&s.food.length>0&&(s.activeAction="eating");break;case pe.CommandGather:t?d.gathering=!d.gathering:s&&(s.activeAction="gathering");break;case pe.CommandPlant:t?d.planting=!d.planting:s&&(r.autopilotControls.isManuallyPlanting=!0);break;case pe.ToggleProcreationBehavior:d.procreation=!d.procreation;break;case pe.ToggleAttackBehavior:d.attack=!d.attack;break;case pe.ToggleFeedChildBehavior:d.feedChildren=!d.feedChildren;break;case pe.ToggleAutopilotFollowLeaderBehavior:d.followLeader=!d.followLeader;break;case pe.CommandCallToAttack:s&&s.leaderId===s.id&&(s.isCallingToAttack=!0,s.callToAttackEndTime=r.time+Go,Me(r,ce.CallToAttack,s.position,Go),Ie(l,fe.CallToAttack,s.position));break;case pe.CommandFollowMe:t?d.followLeader=!d.followLeader:s&&s.leaderId===s.id&&(s.isCallingToFollow=!0,s.callToFollowEndTime=r.time+da,Me(r,ce.CallToFollow,s.position,da),Ie(l,fe.CallToFollow,s.position));break;case pe.CommandTribeSplit:s&&ah(s,r);break;case pe.CommandBuild:r.buildMenuOpen=!r.buildMenuOpen;break;case pe.SelectStorageSpot:r.selectedBuildingType="storageSpot";break;case pe.SelectPlantingZone:r.selectedBuildingType="plantingZone";break;case pe.SelectRemovalTool:r.selectedBuildingType="removal";break;case pe.ToggleDiplomacy:if(s&&s.leaderId&&e.targetTribeId){const f=s.leaderId,g=e.targetTribeId,m=r.entities.entities[g],S=s.diplomacy,y=m==null?void 0:m.diplomacy;if(S&&y){const A=(S[g]||pt.Friendly)===pt.Friendly?pt.Hostile:pt.Friendly;S[g]=A,y[f]=A}}break}return r};function oD(e,t,r){if(!e.notificationButtonRects)return!1;const o=vt(e);for(const[l,s]of Object.entries(e.notificationButtonRects.dismiss))if(t>=s.x&&t<=s.x+s.width&&r>=s.y&&r<=s.y+s.height)return T_(e,l),o&&Ie({gameState:e},fe.ButtonClick,o.position),!0;for(const[l,s]of Object.entries(e.notificationButtonRects.view))if(t>=s.x&&t<=s.x+s.width&&r>=s.y&&r<=s.y+s.height){const u=e.notifications.find(d=>d.id===l);if(u){let d=u.targetPosition;if(!d&&u.targetEntityIds&&u.targetEntityIds.length>0){const f=e.entities.entities[u.targetEntityIds[0]];f&&(d=f.position)}return d&&iD(e,d),o&&Ie({gameState:e},fe.ButtonClick,o.position),u.highlightedEntityIds&&(u.renderHighlights=!u.renderHighlights),!0}}return!1}const sD=({isActive:e,gameStateRef:t,canvasRef:r,viewportCenterRef:o,playerActionHintsRef:l,keysPressed:s,returnToIntro:u})=>(Re.useEffect(()=>{const d=f=>{if(!e()||t.current.gameOver||!r.current||!f.target||f.target!==r.current)return;const g=r.current.getBoundingClientRect(),m=f.clientX-g.left,S=f.clientY-g.top;if(oD(t.current,m,S))return;const w=t.current.uiButtons.find(I=>m>=I.rect.x&&m<=I.rect.x+I.rect.width&&S>=I.rect.y&&S<=I.rect.y+I.rect.height);if(w){t.current=rD(w,f.shiftKey,t.current,u);return}const A=Df({x:m,y:S},o.current,{width:r.current.width,height:r.current.height},t.current.mapDimensions);QN(t.current,A)};return window.addEventListener("mousedown",d),()=>{window.removeEventListener("mousedown",d)}},[e,r,t,o,u]),Re.useEffect(()=>{const d=f=>{if(!e()||!r.current)return;const g=r.current.getBoundingClientRect(),m=f.clientX-g.left,S=f.clientY-g.top;t.current.mousePosition={x:m,y:S};let y;if(t.current.notificationButtonRects){for(const[A,I]of Object.entries(t.current.notificationButtonRects.dismiss))if(m>=I.x&&m<=I.x+I.width&&S>=I.y&&S<=I.y+I.height){y=`notification-dismiss-${A}`;break}if(!y){for(const[A,I]of Object.entries(t.current.notificationButtonRects.view))if(m>=I.x&&m<=I.x+I.width&&S>=I.y&&S<=I.y+I.height){y=`notification-view-${A}`;break}}}if(!y)for(let A=t.current.uiButtons.length-1;A>=0;A--){const I=t.current.uiButtons[A];if(m>=I.rect.x&&m<=I.rect.x+I.rect.width&&S>=I.rect.y&&S<=I.rect.y+I.rect.height){y=I.id;break}}if(t.current.hoveredButtonId=y,y){t.current.autopilotControls.hoveredAutopilotAction=void 0;return}const w=vt(t.current);if(w){const A=Df({x:m,y:S},o.current,{width:r.current.width,height:r.current.height},t.current.mapDimensions);t.current.autopilotControls.hoveredAutopilotAction=qN(A,w,t.current,f.shiftKey)}else t.current.autopilotControls.hoveredAutopilotAction=void 0};return window.addEventListener("mousemove",d),()=>{window.removeEventListener("mousemove",d)}},[e,r,t,o]),Re.useEffect(()=>{const d=g=>{if(!e()||t.current.gameOver)return;const m=g.key.toLowerCase();(m===" "||m==="p"||m==="tab"||(g.ctrlKey||g.metaKey)&&(m==="s"||m==="a"))&&g.preventDefault();const S=JN(g,t.current);if(t.current=S.newState,S.handled)return;const y=vt(t.current);y&&(s.current.add(m),eD(m,g.shiftKey,t.current,y,l.current))},f=g=>{if(!e()||t.current.gameOver)return;const m=g.key.toLowerCase();s.current.delete(m);const S=vt(t.current);S&&tD(m,S,t.current,s)};return window.addEventListener("keydown",d),window.addEventListener("keyup",f),()=>{window.removeEventListener("keydown",d),window.removeEventListener("keyup",f)}},[e,t,l,s,u]),null),aD=({gameStateRef:e,ctxRef:t,debugPanelTypeRef:r,viewportCenterRef:o,playerActionHintsRef:l,keysPressed:s,canvasRef:u,setAppState:d,appState:f})=>{const g=Re.useRef(),{returnToIntro:m}=Wo(),[S,y,w]=pv(A=>{var H,b;if(!t.current||!g.current){g.current=A;return}const I=Math.min(A-g.current,1e3)/1e3,{performanceMetrics:C}=e.current;C.currentBucket={renderTime:0,worldUpdateTime:0,aiUpdateTime:0};const F=performance.now();e.current=Fu(e.current,I),C.currentBucket.worldUpdateTime=performance.now()-F;const B=vt(e.current);B?l.current=lh(e.current,B):l.current=[],o.current=nD(e.current,o.current,I);const D=performance.now();Au(t.current,e.current,o.current,l.current,{width:((H=u.current)==null?void 0:H.width)||800,height:((b=u.current)==null?void 0:b.height)||600},!1),C.currentBucket.renderTime=performance.now()-D,C.history.push({bucketTime:e.current.time,...C.currentBucket}),C.history.length>aI&&C.history.shift(),g.current=A,e.current.gameOver&&f!=="gameOver"&&(oh(fe.GameOver,{masterVolume:e.current.masterVolume,isMuted:e.current.isMuted}),d("gameOver",{generations:e.current.generationCount,cause:e.current.causeOfGameOver||"Unknown"}))});return Re.useEffect(()=>(y(),S),[y,S]),Fe.jsx(sD,{isActive:w,gameStateRef:e,canvasRef:u,viewportCenterRef:o,playerActionHintsRef:l,debugPanelTypeRef:r,keysPressed:s,returnToIntro:m})},b0=()=>{const{savedGameState:e,contextReady:t}=Wo(),[r,o]=Re.useState(null);return Re.useEffect(()=>{t&&(e?(console.log("Loading saved game state..."),o(e)):(console.log("Initializing new game state..."),o(KN())))},[t,e]),!t||!r?Fe.jsx("div",{children:"Loading..."}):Fe.jsx(lD,{initialState:r})},lD=({initialState:e})=>{const t=Re.useRef(null),r=Re.useRef(null),o=Re.useRef(e),l=Re.useRef(new Set),s=Re.useRef(e.debugPanel),u=Re.useRef(e.viewportCenter),d=Re.useRef([]),{appState:f,setAppState:g}=Wo();return Fe.jsxs(Fe.Fragment,{children:[Fe.jsx(ZN,{canvasRef:t,ctxRef:r,gameStateRef:o,debugPanelTypeRef:s,viewportCenterRef:u,playerActionHintsRef:d}),Fe.jsx(aD,{gameStateRef:o,ctxRef:r,debugPanelTypeRef:s,viewportCenterRef:u,playerActionHintsRef:d,keysPressed:l,canvasRef:t,setAppState:g,appState:f})]})},uD=In.div`
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  text-align: center;
  background-color: rgba(0, 0, 0, 0.75); // Semi-transparent overlay
  color: #fff;
  padding: 20px;
  z-index: 10; // Ensure it's on top
`,cD=In.h1`
  font-family: 'Press Start 2P', cursive;
  font-size: 4rem;
  color: #ff4136; // Red for emphasis
  text-shadow: 4px 4px 0px #000;
  margin-bottom: 1.5rem;
`,tu=In.p`
  font-family: 'Press Start 2P', cursive;
  font-size: 1.2rem;
  margin: 0.5em 0;
  color: #fff;
  text-shadow: 2px 2px 0px #000;
`,dD=In.button`
  font-family: 'Press Start 2P', cursive;
  font-size: 1rem;
  padding: 1rem 2rem;
  margin-top: 2em;
  color: #fff;
  background-color: #ff4136; // Red button
  border: 2px solid #fff;
  box-shadow: 4px 4px 0px #fff;
  cursor: pointer;
  transition: all 0.2s ease-in-out;
  text-transform: uppercase;

  &:hover {
    background-color: #fff;
    color: #ff4136;
    box-shadow: 4px 4px 0px #ff4136;
  }
`,fD=()=>{const{setAppState:e,gameOverDetails:t}=Wo(),r=()=>{e("intro")};return Fe.jsxs(uD,{children:[Fe.jsx(cD,{children:"Game Over"}),Fe.jsx(tu,{children:"Your tribe's lineage has ended."}),t&&Fe.jsxs(Fe.Fragment,{children:[Fe.jsxs(tu,{children:["Generations Survived: ",t.generations]}),Fe.jsxs(tu,{children:["Cause of Extinction: ",t.cause]})]}),!t&&Fe.jsx(tu,{children:"Game details are unavailable."}),Fe.jsx(dD,{onClick:r,children:"Return to Menu"})]})},hD=eI`
  /* CSS Reset */
  *, *::before, *::after {
    box-sizing: border-box;
  }

  body {
    margin: 0;
    padding: 0;
    font-family: 'Press Start 2P', 'Arial', sans-serif;
    background-color: #121212;
    color: #f0f0f0;
    line-height: 1.6;
  }

  /* Additional global styles */
  h1, h2, h3, h4, h5, h6 {
    margin-top: 0;
  }

  button {
    cursor: pointer;
    font-family: inherit;
  }

  /* Prevent overflow issues */
  html, body {
    height: 100%;
    overflow-x: hidden;
  }

  /* Root element for React app */
  #root {
    height: 100%;
  }
`;function gD(e,t){Re.useEffect(()=>{const r=()=>{const o=document.location.hash==="#game"?"game":"intro";t(o)};return window.addEventListener("hashchange",r),r(),()=>{window.removeEventListener("hashchange",r)}},[]),Re.useEffect(()=>{e==="game"?document.location.hash="#game":e==="intro"&&(document.location.hash="")},[e])}const pD=()=>{const{appState:e,setAppState:t}=Wo();gD(e,t);const r=()=>{switch(e){case"intro":return Fe.jsx(H0,{});case"game":return Fe.jsx(b0,{});case"gameOver":return Fe.jsxs(Fe.Fragment,{children:[Fe.jsx(b0,{}),Fe.jsx(fD,{})]});default:return Fe.jsx(H0,{})}};return Fe.jsxs(Fe.Fragment,{children:[Fe.jsx(hD,{}),r()]})},G0=document.getElementById("root");G0?k_().then(()=>{$T.createRoot(G0).render(Fe.jsx(Jn.StrictMode,{children:Fe.jsx(JT,{initialAppState:document.location.hash==="#game"?"game":"intro",children:Fe.jsx(pD,{})})}))}):console.error("Failed to find the root element");
