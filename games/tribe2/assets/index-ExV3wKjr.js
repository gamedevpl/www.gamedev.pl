var LT=Object.defineProperty;var UT=(e,t,i)=>t in e?LT(e,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[t]=i;var Oe=(e,t,i)=>UT(e,typeof t!="symbol"?t+"":t,i);(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const l of document.querySelectorAll('link[rel="modulepreload"]'))o(l);new MutationObserver(l=>{for(const s of l)if(s.type==="childList")for(const u of s.addedNodes)u.tagName==="LINK"&&u.rel==="modulepreload"&&o(u)}).observe(document,{childList:!0,subtree:!0});function i(l){const s={};return l.integrity&&(s.integrity=l.integrity),l.referrerPolicy&&(s.referrerPolicy=l.referrerPolicy),l.crossOrigin==="use-credentials"?s.credentials="include":l.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function o(l){if(l.ep)return;l.ep=!0;const s=i(l);fetch(l.href,s)}})();function j0(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var Rd={exports:{}},Us={},Pd={exports:{}},Be={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var cm;function BT(){if(cm)return Be;cm=1;var e=Symbol.for("react.element"),t=Symbol.for("react.portal"),i=Symbol.for("react.fragment"),o=Symbol.for("react.strict_mode"),l=Symbol.for("react.profiler"),s=Symbol.for("react.provider"),u=Symbol.for("react.context"),d=Symbol.for("react.forward_ref"),f=Symbol.for("react.suspense"),g=Symbol.for("react.memo"),m=Symbol.for("react.lazy"),v=Symbol.iterator;function y(P){return P===null||typeof P!="object"?null:(P=v&&P[v]||P["@@iterator"],typeof P=="function"?P:null)}var A={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},I=Object.assign,E={};function C(P,B,K){this.props=P,this.context=B,this.refs=E,this.updater=K||A}C.prototype.isReactComponent={},C.prototype.setState=function(P,B){if(typeof P!="object"&&typeof P!="function"&&P!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,P,B,"setState")},C.prototype.forceUpdate=function(P){this.updater.enqueueForceUpdate(this,P,"forceUpdate")};function F(){}F.prototype=C.prototype;function L(P,B,K){this.props=P,this.context=B,this.refs=E,this.updater=K||A}var D=L.prototype=new F;D.constructor=L,I(D,C.prototype),D.isPureReactComponent=!0;var H=Array.isArray,b=Object.prototype.hasOwnProperty,U={current:null},$={key:!0,ref:!0,__self:!0,__source:!0};function ee(P,B,K){var ie,Se={},le=null,Ee=null;if(B!=null)for(ie in B.ref!==void 0&&(Ee=B.ref),B.key!==void 0&&(le=""+B.key),B)b.call(B,ie)&&!$.hasOwnProperty(ie)&&(Se[ie]=B[ie]);var Ae=arguments.length-2;if(Ae===1)Se.children=K;else if(1<Ae){for(var Z=Array(Ae),re=0;re<Ae;re++)Z[re]=arguments[re+2];Se.children=Z}if(P&&P.defaultProps)for(ie in Ae=P.defaultProps,Ae)Se[ie]===void 0&&(Se[ie]=Ae[ie]);return{$$typeof:e,type:P,key:le,ref:Ee,props:Se,_owner:U.current}}function _e(P,B){return{$$typeof:e,type:P.type,key:B,ref:P.ref,props:P.props,_owner:P._owner}}function Ce(P){return typeof P=="object"&&P!==null&&P.$$typeof===e}function be(P){var B={"=":"=0",":":"=2"};return"$"+P.replace(/[=:]/g,function(K){return B[K]})}var De=/\/+/g;function Pe(P,B){return typeof P=="object"&&P!==null&&P.key!=null?be(""+P.key):B.toString(36)}function de(P,B,K,ie,Se){var le=typeof P;(le==="undefined"||le==="boolean")&&(P=null);var Ee=!1;if(P===null)Ee=!0;else switch(le){case"string":case"number":Ee=!0;break;case"object":switch(P.$$typeof){case e:case t:Ee=!0}}if(Ee)return Ee=P,Se=Se(Ee),P=ie===""?"."+Pe(Ee,0):ie,H(Se)?(K="",P!=null&&(K=P.replace(De,"$&/")+"/"),de(Se,B,K,"",function(re){return re})):Se!=null&&(Ce(Se)&&(Se=_e(Se,K+(!Se.key||Ee&&Ee.key===Se.key?"":(""+Se.key).replace(De,"$&/")+"/")+P)),B.push(Se)),1;if(Ee=0,ie=ie===""?".":ie+":",H(P))for(var Ae=0;Ae<P.length;Ae++){le=P[Ae];var Z=ie+Pe(le,Ae);Ee+=de(le,B,K,Z,Se)}else if(Z=y(P),typeof Z=="function")for(P=Z.call(P),Ae=0;!(le=P.next()).done;)le=le.value,Z=ie+Pe(le,Ae++),Ee+=de(le,B,K,Z,Se);else if(le==="object")throw B=String(P),Error("Objects are not valid as a React child (found: "+(B==="[object Object]"?"object with keys {"+Object.keys(P).join(", ")+"}":B)+"). If you meant to render a collection of children, use an array instead.");return Ee}function Le(P,B,K){if(P==null)return P;var ie=[],Se=0;return de(P,ie,"","",function(le){return B.call(K,le,Se++)}),ie}function Te(P){if(P._status===-1){var B=P._result;B=B(),B.then(function(K){(P._status===0||P._status===-1)&&(P._status=1,P._result=K)},function(K){(P._status===0||P._status===-1)&&(P._status=2,P._result=K)}),P._status===-1&&(P._status=0,P._result=B)}if(P._status===1)return P._result.default;throw P._result}var ne={current:null},W={transition:null},X={ReactCurrentDispatcher:ne,ReactCurrentBatchConfig:W,ReactCurrentOwner:U};function j(){throw Error("act(...) is not supported in production builds of React.")}return Be.Children={map:Le,forEach:function(P,B,K){Le(P,function(){B.apply(this,arguments)},K)},count:function(P){var B=0;return Le(P,function(){B++}),B},toArray:function(P){return Le(P,function(B){return B})||[]},only:function(P){if(!Ce(P))throw Error("React.Children.only expected to receive a single React element child.");return P}},Be.Component=C,Be.Fragment=i,Be.Profiler=l,Be.PureComponent=L,Be.StrictMode=o,Be.Suspense=f,Be.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=X,Be.act=j,Be.cloneElement=function(P,B,K){if(P==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+P+".");var ie=I({},P.props),Se=P.key,le=P.ref,Ee=P._owner;if(B!=null){if(B.ref!==void 0&&(le=B.ref,Ee=U.current),B.key!==void 0&&(Se=""+B.key),P.type&&P.type.defaultProps)var Ae=P.type.defaultProps;for(Z in B)b.call(B,Z)&&!$.hasOwnProperty(Z)&&(ie[Z]=B[Z]===void 0&&Ae!==void 0?Ae[Z]:B[Z])}var Z=arguments.length-2;if(Z===1)ie.children=K;else if(1<Z){Ae=Array(Z);for(var re=0;re<Z;re++)Ae[re]=arguments[re+2];ie.children=Ae}return{$$typeof:e,type:P.type,key:Se,ref:le,props:ie,_owner:Ee}},Be.createContext=function(P){return P={$$typeof:u,_currentValue:P,_currentValue2:P,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},P.Provider={$$typeof:s,_context:P},P.Consumer=P},Be.createElement=ee,Be.createFactory=function(P){var B=ee.bind(null,P);return B.type=P,B},Be.createRef=function(){return{current:null}},Be.forwardRef=function(P){return{$$typeof:d,render:P}},Be.isValidElement=Ce,Be.lazy=function(P){return{$$typeof:m,_payload:{_status:-1,_result:P},_init:Te}},Be.memo=function(P,B){return{$$typeof:g,type:P,compare:B===void 0?null:B}},Be.startTransition=function(P){var B=W.transition;W.transition={};try{P()}finally{W.transition=B}},Be.unstable_act=j,Be.useCallback=function(P,B){return ne.current.useCallback(P,B)},Be.useContext=function(P){return ne.current.useContext(P)},Be.useDebugValue=function(){},Be.useDeferredValue=function(P){return ne.current.useDeferredValue(P)},Be.useEffect=function(P,B){return ne.current.useEffect(P,B)},Be.useId=function(){return ne.current.useId()},Be.useImperativeHandle=function(P,B,K){return ne.current.useImperativeHandle(P,B,K)},Be.useInsertionEffect=function(P,B){return ne.current.useInsertionEffect(P,B)},Be.useLayoutEffect=function(P,B){return ne.current.useLayoutEffect(P,B)},Be.useMemo=function(P,B){return ne.current.useMemo(P,B)},Be.useReducer=function(P,B,K){return ne.current.useReducer(P,B,K)},Be.useRef=function(P){return ne.current.useRef(P)},Be.useState=function(P){return ne.current.useState(P)},Be.useSyncExternalStore=function(P,B,K){return ne.current.useSyncExternalStore(P,B,K)},Be.useTransition=function(){return ne.current.useTransition()},Be.version="18.3.1",Be}var dm;function Ff(){return dm||(dm=1,Pd.exports=BT()),Pd.exports}/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var fm;function HT(){if(fm)return Us;fm=1;var e=Ff(),t=Symbol.for("react.element"),i=Symbol.for("react.fragment"),o=Object.prototype.hasOwnProperty,l=e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,s={key:!0,ref:!0,__self:!0,__source:!0};function u(d,f,g){var m,v={},y=null,A=null;g!==void 0&&(y=""+g),f.key!==void 0&&(y=""+f.key),f.ref!==void 0&&(A=f.ref);for(m in f)o.call(f,m)&&!s.hasOwnProperty(m)&&(v[m]=f[m]);if(d&&d.defaultProps)for(m in f=d.defaultProps,f)v[m]===void 0&&(v[m]=f[m]);return{$$typeof:t,type:d,key:y,ref:A,props:v,_owner:l.current}}return Us.Fragment=i,Us.jsx=u,Us.jsxs=u,Us}var hm;function bT(){return hm||(hm=1,Rd.exports=HT()),Rd.exports}var Fe=bT(),Re=Ff();const ei=j0(Re);var Ll={},Nd={exports:{}},qt={},Dd={exports:{}},Od={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var gm;function GT(){return gm||(gm=1,function(e){function t(W,X){var j=W.length;W.push(X);e:for(;0<j;){var P=j-1>>>1,B=W[P];if(0<l(B,X))W[P]=X,W[j]=B,j=P;else break e}}function i(W){return W.length===0?null:W[0]}function o(W){if(W.length===0)return null;var X=W[0],j=W.pop();if(j!==X){W[0]=j;e:for(var P=0,B=W.length,K=B>>>1;P<K;){var ie=2*(P+1)-1,Se=W[ie],le=ie+1,Ee=W[le];if(0>l(Se,j))le<B&&0>l(Ee,Se)?(W[P]=Ee,W[le]=j,P=le):(W[P]=Se,W[ie]=j,P=ie);else if(le<B&&0>l(Ee,j))W[P]=Ee,W[le]=j,P=le;else break e}}return X}function l(W,X){var j=W.sortIndex-X.sortIndex;return j!==0?j:W.id-X.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;e.unstable_now=function(){return s.now()}}else{var u=Date,d=u.now();e.unstable_now=function(){return u.now()-d}}var f=[],g=[],m=1,v=null,y=3,A=!1,I=!1,E=!1,C=typeof setTimeout=="function"?setTimeout:null,F=typeof clearTimeout=="function"?clearTimeout:null,L=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function D(W){for(var X=i(g);X!==null;){if(X.callback===null)o(g);else if(X.startTime<=W)o(g),X.sortIndex=X.expirationTime,t(f,X);else break;X=i(g)}}function H(W){if(E=!1,D(W),!I)if(i(f)!==null)I=!0,Te(b);else{var X=i(g);X!==null&&ne(H,X.startTime-W)}}function b(W,X){I=!1,E&&(E=!1,F(ee),ee=-1),A=!0;var j=y;try{for(D(X),v=i(f);v!==null&&(!(v.expirationTime>X)||W&&!be());){var P=v.callback;if(typeof P=="function"){v.callback=null,y=v.priorityLevel;var B=P(v.expirationTime<=X);X=e.unstable_now(),typeof B=="function"?v.callback=B:v===i(f)&&o(f),D(X)}else o(f);v=i(f)}if(v!==null)var K=!0;else{var ie=i(g);ie!==null&&ne(H,ie.startTime-X),K=!1}return K}finally{v=null,y=j,A=!1}}var U=!1,$=null,ee=-1,_e=5,Ce=-1;function be(){return!(e.unstable_now()-Ce<_e)}function De(){if($!==null){var W=e.unstable_now();Ce=W;var X=!0;try{X=$(!0,W)}finally{X?Pe():(U=!1,$=null)}}else U=!1}var Pe;if(typeof L=="function")Pe=function(){L(De)};else if(typeof MessageChannel<"u"){var de=new MessageChannel,Le=de.port2;de.port1.onmessage=De,Pe=function(){Le.postMessage(null)}}else Pe=function(){C(De,0)};function Te(W){$=W,U||(U=!0,Pe())}function ne(W,X){ee=C(function(){W(e.unstable_now())},X)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(W){W.callback=null},e.unstable_continueExecution=function(){I||A||(I=!0,Te(b))},e.unstable_forceFrameRate=function(W){0>W||125<W?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):_e=0<W?Math.floor(1e3/W):5},e.unstable_getCurrentPriorityLevel=function(){return y},e.unstable_getFirstCallbackNode=function(){return i(f)},e.unstable_next=function(W){switch(y){case 1:case 2:case 3:var X=3;break;default:X=y}var j=y;y=X;try{return W()}finally{y=j}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(W,X){switch(W){case 1:case 2:case 3:case 4:case 5:break;default:W=3}var j=y;y=W;try{return X()}finally{y=j}},e.unstable_scheduleCallback=function(W,X,j){var P=e.unstable_now();switch(typeof j=="object"&&j!==null?(j=j.delay,j=typeof j=="number"&&0<j?P+j:P):j=P,W){case 1:var B=-1;break;case 2:B=250;break;case 5:B=1073741823;break;case 4:B=1e4;break;default:B=5e3}return B=j+B,W={id:m++,callback:X,priorityLevel:W,startTime:j,expirationTime:B,sortIndex:-1},j>P?(W.sortIndex=j,t(g,W),i(f)===null&&W===i(g)&&(E?(F(ee),ee=-1):E=!0,ne(H,j-P))):(W.sortIndex=B,t(f,W),I||A||(I=!0,Te(b))),W},e.unstable_shouldYield=be,e.unstable_wrapCallback=function(W){var X=y;return function(){var j=y;y=X;try{return W.apply(this,arguments)}finally{y=j}}}}(Od)),Od}var pm;function xT(){return pm||(pm=1,Dd.exports=GT()),Dd.exports}/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var mm;function $T(){if(mm)return qt;mm=1;var e=Ff(),t=xT();function i(n){for(var r="https://reactjs.org/docs/error-decoder.html?invariant="+n,a=1;a<arguments.length;a++)r+="&args[]="+encodeURIComponent(arguments[a]);return"Minified React error #"+n+"; visit "+r+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var o=new Set,l={};function s(n,r){u(n,r),u(n+"Capture",r)}function u(n,r){for(l[n]=r,n=0;n<r.length;n++)o.add(r[n])}var d=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),f=Object.prototype.hasOwnProperty,g=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,m={},v={};function y(n){return f.call(v,n)?!0:f.call(m,n)?!1:g.test(n)?v[n]=!0:(m[n]=!0,!1)}function A(n,r,a,c){if(a!==null&&a.type===0)return!1;switch(typeof r){case"function":case"symbol":return!0;case"boolean":return c?!1:a!==null?!a.acceptsBooleans:(n=n.toLowerCase().slice(0,5),n!=="data-"&&n!=="aria-");default:return!1}}function I(n,r,a,c){if(r===null||typeof r>"u"||A(n,r,a,c))return!0;if(c)return!1;if(a!==null)switch(a.type){case 3:return!r;case 4:return r===!1;case 5:return isNaN(r);case 6:return isNaN(r)||1>r}return!1}function E(n,r,a,c,h,p,S){this.acceptsBooleans=r===2||r===3||r===4,this.attributeName=c,this.attributeNamespace=h,this.mustUseProperty=a,this.propertyName=n,this.type=r,this.sanitizeURL=p,this.removeEmptyString=S}var C={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(n){C[n]=new E(n,0,!1,n,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(n){var r=n[0];C[r]=new E(r,1,!1,n[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(n){C[n]=new E(n,2,!1,n.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(n){C[n]=new E(n,2,!1,n,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(n){C[n]=new E(n,3,!1,n.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(n){C[n]=new E(n,3,!0,n,null,!1,!1)}),["capture","download"].forEach(function(n){C[n]=new E(n,4,!1,n,null,!1,!1)}),["cols","rows","size","span"].forEach(function(n){C[n]=new E(n,6,!1,n,null,!1,!1)}),["rowSpan","start"].forEach(function(n){C[n]=new E(n,5,!1,n.toLowerCase(),null,!1,!1)});var F=/[\-:]([a-z])/g;function L(n){return n[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(n){var r=n.replace(F,L);C[r]=new E(r,1,!1,n,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(n){var r=n.replace(F,L);C[r]=new E(r,1,!1,n,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(n){var r=n.replace(F,L);C[r]=new E(r,1,!1,n,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(n){C[n]=new E(n,1,!1,n.toLowerCase(),null,!1,!1)}),C.xlinkHref=new E("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(n){C[n]=new E(n,1,!1,n.toLowerCase(),null,!0,!0)});function D(n,r,a,c){var h=C.hasOwnProperty(r)?C[r]:null;(h!==null?h.type!==0:c||!(2<r.length)||r[0]!=="o"&&r[0]!=="O"||r[1]!=="n"&&r[1]!=="N")&&(I(r,a,h,c)&&(a=null),c||h===null?y(r)&&(a===null?n.removeAttribute(r):n.setAttribute(r,""+a)):h.mustUseProperty?n[h.propertyName]=a===null?h.type===3?!1:"":a:(r=h.attributeName,c=h.attributeNamespace,a===null?n.removeAttribute(r):(h=h.type,a=h===3||h===4&&a===!0?"":""+a,c?n.setAttributeNS(c,r,a):n.setAttribute(r,a))))}var H=e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,b=Symbol.for("react.element"),U=Symbol.for("react.portal"),$=Symbol.for("react.fragment"),ee=Symbol.for("react.strict_mode"),_e=Symbol.for("react.profiler"),Ce=Symbol.for("react.provider"),be=Symbol.for("react.context"),De=Symbol.for("react.forward_ref"),Pe=Symbol.for("react.suspense"),de=Symbol.for("react.suspense_list"),Le=Symbol.for("react.memo"),Te=Symbol.for("react.lazy"),ne=Symbol.for("react.offscreen"),W=Symbol.iterator;function X(n){return n===null||typeof n!="object"?null:(n=W&&n[W]||n["@@iterator"],typeof n=="function"?n:null)}var j=Object.assign,P;function B(n){if(P===void 0)try{throw Error()}catch(a){var r=a.stack.trim().match(/\n( *(at )?)/);P=r&&r[1]||""}return`
`+P+n}var K=!1;function ie(n,r){if(!n||K)return"";K=!0;var a=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(r)if(r=function(){throw Error()},Object.defineProperty(r.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(r,[])}catch(k){var c=k}Reflect.construct(n,[],r)}else{try{r.call()}catch(k){c=k}n.call(r.prototype)}else{try{throw Error()}catch(k){c=k}n()}}catch(k){if(k&&c&&typeof k.stack=="string"){for(var h=k.stack.split(`
`),p=c.stack.split(`
`),S=h.length-1,_=p.length-1;1<=S&&0<=_&&h[S]!==p[_];)_--;for(;1<=S&&0<=_;S--,_--)if(h[S]!==p[_]){if(S!==1||_!==1)do if(S--,_--,0>_||h[S]!==p[_]){var R=`
`+h[S].replace(" at new "," at ");return n.displayName&&R.includes("<anonymous>")&&(R=R.replace("<anonymous>",n.displayName)),R}while(1<=S&&0<=_);break}}}finally{K=!1,Error.prepareStackTrace=a}return(n=n?n.displayName||n.name:"")?B(n):""}function Se(n){switch(n.tag){case 5:return B(n.type);case 16:return B("Lazy");case 13:return B("Suspense");case 19:return B("SuspenseList");case 0:case 2:case 15:return n=ie(n.type,!1),n;case 11:return n=ie(n.type.render,!1),n;case 1:return n=ie(n.type,!0),n;default:return""}}function le(n){if(n==null)return null;if(typeof n=="function")return n.displayName||n.name||null;if(typeof n=="string")return n;switch(n){case $:return"Fragment";case U:return"Portal";case _e:return"Profiler";case ee:return"StrictMode";case Pe:return"Suspense";case de:return"SuspenseList"}if(typeof n=="object")switch(n.$$typeof){case be:return(n.displayName||"Context")+".Consumer";case Ce:return(n._context.displayName||"Context")+".Provider";case De:var r=n.render;return n=n.displayName,n||(n=r.displayName||r.name||"",n=n!==""?"ForwardRef("+n+")":"ForwardRef"),n;case Le:return r=n.displayName||null,r!==null?r:le(n.type)||"Memo";case Te:r=n._payload,n=n._init;try{return le(n(r))}catch{}}return null}function Ee(n){var r=n.type;switch(n.tag){case 24:return"Cache";case 9:return(r.displayName||"Context")+".Consumer";case 10:return(r._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return n=r.render,n=n.displayName||n.name||"",r.displayName||(n!==""?"ForwardRef("+n+")":"ForwardRef");case 7:return"Fragment";case 5:return r;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return le(r);case 8:return r===ee?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof r=="function")return r.displayName||r.name||null;if(typeof r=="string")return r}return null}function Ae(n){switch(typeof n){case"boolean":case"number":case"string":case"undefined":return n;case"object":return n;default:return""}}function Z(n){var r=n.type;return(n=n.nodeName)&&n.toLowerCase()==="input"&&(r==="checkbox"||r==="radio")}function re(n){var r=Z(n)?"checked":"value",a=Object.getOwnPropertyDescriptor(n.constructor.prototype,r),c=""+n[r];if(!n.hasOwnProperty(r)&&typeof a<"u"&&typeof a.get=="function"&&typeof a.set=="function"){var h=a.get,p=a.set;return Object.defineProperty(n,r,{configurable:!0,get:function(){return h.call(this)},set:function(S){c=""+S,p.call(this,S)}}),Object.defineProperty(n,r,{enumerable:a.enumerable}),{getValue:function(){return c},setValue:function(S){c=""+S},stopTracking:function(){n._valueTracker=null,delete n[r]}}}}function Ue(n){n._valueTracker||(n._valueTracker=re(n))}function ge(n){if(!n)return!1;var r=n._valueTracker;if(!r)return!0;var a=r.getValue(),c="";return n&&(c=Z(n)?n.checked?"true":"false":n.value),n=c,n!==a?(r.setValue(n),!0):!1}function Gn(n){if(n=n||(typeof document<"u"?document:void 0),typeof n>"u")return null;try{return n.activeElement||n.body}catch{return n.body}}function qe(n,r){var a=r.checked;return j({},r,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:a??n._wrapperState.initialChecked})}function Ve(n,r){var a=r.defaultValue==null?"":r.defaultValue,c=r.checked!=null?r.checked:r.defaultChecked;a=Ae(r.value!=null?r.value:a),n._wrapperState={initialChecked:c,initialValue:a,controlled:r.type==="checkbox"||r.type==="radio"?r.checked!=null:r.value!=null}}function xn(n,r){r=r.checked,r!=null&&D(n,"checked",r,!1)}function Yt(n,r){xn(n,r);var a=Ae(r.value),c=r.type;if(a!=null)c==="number"?(a===0&&n.value===""||n.value!=a)&&(n.value=""+a):n.value!==""+a&&(n.value=""+a);else if(c==="submit"||c==="reset"){n.removeAttribute("value");return}r.hasOwnProperty("value")?$n(n,r.type,a):r.hasOwnProperty("defaultValue")&&$n(n,r.type,Ae(r.defaultValue)),r.checked==null&&r.defaultChecked!=null&&(n.defaultChecked=!!r.defaultChecked)}function cn(n,r,a){if(r.hasOwnProperty("value")||r.hasOwnProperty("defaultValue")){var c=r.type;if(!(c!=="submit"&&c!=="reset"||r.value!==void 0&&r.value!==null))return;r=""+n._wrapperState.initialValue,a||r===n.value||(n.value=r),n.defaultValue=r}a=n.name,a!==""&&(n.name=""),n.defaultChecked=!!n._wrapperState.initialChecked,a!==""&&(n.name=a)}function $n(n,r,a){(r!=="number"||Gn(n.ownerDocument)!==n)&&(a==null?n.defaultValue=""+n._wrapperState.initialValue:n.defaultValue!==""+a&&(n.defaultValue=""+a))}var zn=Array.isArray;function Ai(n,r,a,c){if(n=n.options,r){r={};for(var h=0;h<a.length;h++)r["$"+a[h]]=!0;for(a=0;a<n.length;a++)h=r.hasOwnProperty("$"+n[a].value),n[a].selected!==h&&(n[a].selected=h),h&&c&&(n[a].defaultSelected=!0)}else{for(a=""+Ae(a),r=null,h=0;h<n.length;h++){if(n[h].value===a){n[h].selected=!0,c&&(n[h].defaultSelected=!0);return}r!==null||n[h].disabled||(r=n[h])}r!==null&&(r.selected=!0)}}function lr(n,r){if(r.dangerouslySetInnerHTML!=null)throw Error(i(91));return j({},r,{value:void 0,defaultValue:void 0,children:""+n._wrapperState.initialValue})}function Th(n,r){var a=r.value;if(a==null){if(a=r.children,r=r.defaultValue,a!=null){if(r!=null)throw Error(i(92));if(zn(a)){if(1<a.length)throw Error(i(93));a=a[0]}r=a}r==null&&(r=""),a=r}n._wrapperState={initialValue:Ae(a)}}function Ah(n,r){var a=Ae(r.value),c=Ae(r.defaultValue);a!=null&&(a=""+a,a!==n.value&&(n.value=a),r.defaultValue==null&&n.defaultValue!==a&&(n.defaultValue=a)),c!=null&&(n.defaultValue=""+c)}function Ih(n){var r=n.textContent;r===n._wrapperState.initialValue&&r!==""&&r!==null&&(n.value=r)}function Eh(n){switch(n){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Hu(n,r){return n==null||n==="http://www.w3.org/1999/xhtml"?Eh(r):n==="http://www.w3.org/2000/svg"&&r==="foreignObject"?"http://www.w3.org/1999/xhtml":n}var Ra,wh=function(n){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(r,a,c,h){MSApp.execUnsafeLocalFunction(function(){return n(r,a,c,h)})}:n}(function(n,r){if(n.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in n)n.innerHTML=r;else{for(Ra=Ra||document.createElement("div"),Ra.innerHTML="<svg>"+r.valueOf().toString()+"</svg>",r=Ra.firstChild;n.firstChild;)n.removeChild(n.firstChild);for(;r.firstChild;)n.appendChild(r.firstChild)}});function Qo(n,r){if(r){var a=n.firstChild;if(a&&a===n.lastChild&&a.nodeType===3){a.nodeValue=r;return}}n.textContent=r}var Jo={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},bS=["Webkit","ms","Moz","O"];Object.keys(Jo).forEach(function(n){bS.forEach(function(r){r=r+n.charAt(0).toUpperCase()+n.substring(1),Jo[r]=Jo[n]})});function _h(n,r,a){return r==null||typeof r=="boolean"||r===""?"":a||typeof r!="number"||r===0||Jo.hasOwnProperty(n)&&Jo[n]?(""+r).trim():r+"px"}function Ch(n,r){n=n.style;for(var a in r)if(r.hasOwnProperty(a)){var c=a.indexOf("--")===0,h=_h(a,r[a],c);a==="float"&&(a="cssFloat"),c?n.setProperty(a,h):n[a]=h}}var GS=j({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function bu(n,r){if(r){if(GS[n]&&(r.children!=null||r.dangerouslySetInnerHTML!=null))throw Error(i(137,n));if(r.dangerouslySetInnerHTML!=null){if(r.children!=null)throw Error(i(60));if(typeof r.dangerouslySetInnerHTML!="object"||!("__html"in r.dangerouslySetInnerHTML))throw Error(i(61))}if(r.style!=null&&typeof r.style!="object")throw Error(i(62))}}function Gu(n,r){if(n.indexOf("-")===-1)return typeof r.is=="string";switch(n){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var xu=null;function $u(n){return n=n.target||n.srcElement||window,n.correspondingUseElement&&(n=n.correspondingUseElement),n.nodeType===3?n.parentNode:n}var zu=null,Yr=null,jr=null;function Rh(n){if(n=As(n)){if(typeof zu!="function")throw Error(i(280));var r=n.stateNode;r&&(r=Za(r),zu(n.stateNode,n.type,r))}}function Ph(n){Yr?jr?jr.push(n):jr=[n]:Yr=n}function Nh(){if(Yr){var n=Yr,r=jr;if(jr=Yr=null,Rh(n),r)for(n=0;n<r.length;n++)Rh(r[n])}}function Dh(n,r){return n(r)}function Oh(){}var Wu=!1;function Mh(n,r,a){if(Wu)return n(r,a);Wu=!0;try{return Dh(n,r,a)}finally{Wu=!1,(Yr!==null||jr!==null)&&(Oh(),Nh())}}function es(n,r){var a=n.stateNode;if(a===null)return null;var c=Za(a);if(c===null)return null;a=c[r];e:switch(r){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(c=!c.disabled)||(n=n.type,c=!(n==="button"||n==="input"||n==="select"||n==="textarea")),n=!c;break e;default:n=!1}if(n)return null;if(a&&typeof a!="function")throw Error(i(231,r,typeof a));return a}var Yu=!1;if(d)try{var ts={};Object.defineProperty(ts,"passive",{get:function(){Yu=!0}}),window.addEventListener("test",ts,ts),window.removeEventListener("test",ts,ts)}catch{Yu=!1}function xS(n,r,a,c,h,p,S,_,R){var k=Array.prototype.slice.call(arguments,3);try{r.apply(a,k)}catch(x){this.onError(x)}}var ns=!1,Pa=null,Na=!1,ju=null,$S={onError:function(n){ns=!0,Pa=n}};function zS(n,r,a,c,h,p,S,_,R){ns=!1,Pa=null,xS.apply($S,arguments)}function WS(n,r,a,c,h,p,S,_,R){if(zS.apply(this,arguments),ns){if(ns){var k=Pa;ns=!1,Pa=null}else throw Error(i(198));Na||(Na=!0,ju=k)}}function ur(n){var r=n,a=n;if(n.alternate)for(;r.return;)r=r.return;else{n=r;do r=n,(r.flags&4098)!==0&&(a=r.return),n=r.return;while(n)}return r.tag===3?a:null}function kh(n){if(n.tag===13){var r=n.memoizedState;if(r===null&&(n=n.alternate,n!==null&&(r=n.memoizedState)),r!==null)return r.dehydrated}return null}function Fh(n){if(ur(n)!==n)throw Error(i(188))}function YS(n){var r=n.alternate;if(!r){if(r=ur(n),r===null)throw Error(i(188));return r!==n?null:n}for(var a=n,c=r;;){var h=a.return;if(h===null)break;var p=h.alternate;if(p===null){if(c=h.return,c!==null){a=c;continue}break}if(h.child===p.child){for(p=h.child;p;){if(p===a)return Fh(h),n;if(p===c)return Fh(h),r;p=p.sibling}throw Error(i(188))}if(a.return!==c.return)a=h,c=p;else{for(var S=!1,_=h.child;_;){if(_===a){S=!0,a=h,c=p;break}if(_===c){S=!0,c=h,a=p;break}_=_.sibling}if(!S){for(_=p.child;_;){if(_===a){S=!0,a=p,c=h;break}if(_===c){S=!0,c=p,a=h;break}_=_.sibling}if(!S)throw Error(i(189))}}if(a.alternate!==c)throw Error(i(190))}if(a.tag!==3)throw Error(i(188));return a.stateNode.current===a?n:r}function Lh(n){return n=YS(n),n!==null?Uh(n):null}function Uh(n){if(n.tag===5||n.tag===6)return n;for(n=n.child;n!==null;){var r=Uh(n);if(r!==null)return r;n=n.sibling}return null}var Bh=t.unstable_scheduleCallback,Hh=t.unstable_cancelCallback,jS=t.unstable_shouldYield,VS=t.unstable_requestPaint,at=t.unstable_now,XS=t.unstable_getCurrentPriorityLevel,Vu=t.unstable_ImmediatePriority,bh=t.unstable_UserBlockingPriority,Da=t.unstable_NormalPriority,KS=t.unstable_LowPriority,Gh=t.unstable_IdlePriority,Oa=null,Wn=null;function ZS(n){if(Wn&&typeof Wn.onCommitFiberRoot=="function")try{Wn.onCommitFiberRoot(Oa,n,void 0,(n.current.flags&128)===128)}catch{}}var _n=Math.clz32?Math.clz32:JS,qS=Math.log,QS=Math.LN2;function JS(n){return n>>>=0,n===0?32:31-(qS(n)/QS|0)|0}var Ma=64,ka=4194304;function is(n){switch(n&-n){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return n&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return n&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return n}}function Fa(n,r){var a=n.pendingLanes;if(a===0)return 0;var c=0,h=n.suspendedLanes,p=n.pingedLanes,S=a&268435455;if(S!==0){var _=S&~h;_!==0?c=is(_):(p&=S,p!==0&&(c=is(p)))}else S=a&~h,S!==0?c=is(S):p!==0&&(c=is(p));if(c===0)return 0;if(r!==0&&r!==c&&(r&h)===0&&(h=c&-c,p=r&-r,h>=p||h===16&&(p&4194240)!==0))return r;if((c&4)!==0&&(c|=a&16),r=n.entangledLanes,r!==0)for(n=n.entanglements,r&=c;0<r;)a=31-_n(r),h=1<<a,c|=n[a],r&=~h;return c}function ey(n,r){switch(n){case 1:case 2:case 4:return r+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return r+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function ty(n,r){for(var a=n.suspendedLanes,c=n.pingedLanes,h=n.expirationTimes,p=n.pendingLanes;0<p;){var S=31-_n(p),_=1<<S,R=h[S];R===-1?((_&a)===0||(_&c)!==0)&&(h[S]=ey(_,r)):R<=r&&(n.expiredLanes|=_),p&=~_}}function Xu(n){return n=n.pendingLanes&-1073741825,n!==0?n:n&1073741824?1073741824:0}function xh(){var n=Ma;return Ma<<=1,(Ma&4194240)===0&&(Ma=64),n}function Ku(n){for(var r=[],a=0;31>a;a++)r.push(n);return r}function rs(n,r,a){n.pendingLanes|=r,r!==536870912&&(n.suspendedLanes=0,n.pingedLanes=0),n=n.eventTimes,r=31-_n(r),n[r]=a}function ny(n,r){var a=n.pendingLanes&~r;n.pendingLanes=r,n.suspendedLanes=0,n.pingedLanes=0,n.expiredLanes&=r,n.mutableReadLanes&=r,n.entangledLanes&=r,r=n.entanglements;var c=n.eventTimes;for(n=n.expirationTimes;0<a;){var h=31-_n(a),p=1<<h;r[h]=0,c[h]=-1,n[h]=-1,a&=~p}}function Zu(n,r){var a=n.entangledLanes|=r;for(n=n.entanglements;a;){var c=31-_n(a),h=1<<c;h&r|n[c]&r&&(n[c]|=r),a&=~h}}var We=0;function $h(n){return n&=-n,1<n?4<n?(n&268435455)!==0?16:536870912:4:1}var zh,qu,Wh,Yh,jh,Qu=!1,La=[],Ii=null,Ei=null,wi=null,os=new Map,ss=new Map,_i=[],iy="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Vh(n,r){switch(n){case"focusin":case"focusout":Ii=null;break;case"dragenter":case"dragleave":Ei=null;break;case"mouseover":case"mouseout":wi=null;break;case"pointerover":case"pointerout":os.delete(r.pointerId);break;case"gotpointercapture":case"lostpointercapture":ss.delete(r.pointerId)}}function as(n,r,a,c,h,p){return n===null||n.nativeEvent!==p?(n={blockedOn:r,domEventName:a,eventSystemFlags:c,nativeEvent:p,targetContainers:[h]},r!==null&&(r=As(r),r!==null&&qu(r)),n):(n.eventSystemFlags|=c,r=n.targetContainers,h!==null&&r.indexOf(h)===-1&&r.push(h),n)}function ry(n,r,a,c,h){switch(r){case"focusin":return Ii=as(Ii,n,r,a,c,h),!0;case"dragenter":return Ei=as(Ei,n,r,a,c,h),!0;case"mouseover":return wi=as(wi,n,r,a,c,h),!0;case"pointerover":var p=h.pointerId;return os.set(p,as(os.get(p)||null,n,r,a,c,h)),!0;case"gotpointercapture":return p=h.pointerId,ss.set(p,as(ss.get(p)||null,n,r,a,c,h)),!0}return!1}function Xh(n){var r=cr(n.target);if(r!==null){var a=ur(r);if(a!==null){if(r=a.tag,r===13){if(r=kh(a),r!==null){n.blockedOn=r,jh(n.priority,function(){Wh(a)});return}}else if(r===3&&a.stateNode.current.memoizedState.isDehydrated){n.blockedOn=a.tag===3?a.stateNode.containerInfo:null;return}}}n.blockedOn=null}function Ua(n){if(n.blockedOn!==null)return!1;for(var r=n.targetContainers;0<r.length;){var a=ec(n.domEventName,n.eventSystemFlags,r[0],n.nativeEvent);if(a===null){a=n.nativeEvent;var c=new a.constructor(a.type,a);xu=c,a.target.dispatchEvent(c),xu=null}else return r=As(a),r!==null&&qu(r),n.blockedOn=a,!1;r.shift()}return!0}function Kh(n,r,a){Ua(n)&&a.delete(r)}function oy(){Qu=!1,Ii!==null&&Ua(Ii)&&(Ii=null),Ei!==null&&Ua(Ei)&&(Ei=null),wi!==null&&Ua(wi)&&(wi=null),os.forEach(Kh),ss.forEach(Kh)}function ls(n,r){n.blockedOn===r&&(n.blockedOn=null,Qu||(Qu=!0,t.unstable_scheduleCallback(t.unstable_NormalPriority,oy)))}function us(n){function r(h){return ls(h,n)}if(0<La.length){ls(La[0],n);for(var a=1;a<La.length;a++){var c=La[a];c.blockedOn===n&&(c.blockedOn=null)}}for(Ii!==null&&ls(Ii,n),Ei!==null&&ls(Ei,n),wi!==null&&ls(wi,n),os.forEach(r),ss.forEach(r),a=0;a<_i.length;a++)c=_i[a],c.blockedOn===n&&(c.blockedOn=null);for(;0<_i.length&&(a=_i[0],a.blockedOn===null);)Xh(a),a.blockedOn===null&&_i.shift()}var Vr=H.ReactCurrentBatchConfig,Ba=!0;function sy(n,r,a,c){var h=We,p=Vr.transition;Vr.transition=null;try{We=1,Ju(n,r,a,c)}finally{We=h,Vr.transition=p}}function ay(n,r,a,c){var h=We,p=Vr.transition;Vr.transition=null;try{We=4,Ju(n,r,a,c)}finally{We=h,Vr.transition=p}}function Ju(n,r,a,c){if(Ba){var h=ec(n,r,a,c);if(h===null)vc(n,r,c,Ha,a),Vh(n,c);else if(ry(h,n,r,a,c))c.stopPropagation();else if(Vh(n,c),r&4&&-1<iy.indexOf(n)){for(;h!==null;){var p=As(h);if(p!==null&&zh(p),p=ec(n,r,a,c),p===null&&vc(n,r,c,Ha,a),p===h)break;h=p}h!==null&&c.stopPropagation()}else vc(n,r,c,null,a)}}var Ha=null;function ec(n,r,a,c){if(Ha=null,n=$u(c),n=cr(n),n!==null)if(r=ur(n),r===null)n=null;else if(a=r.tag,a===13){if(n=kh(r),n!==null)return n;n=null}else if(a===3){if(r.stateNode.current.memoizedState.isDehydrated)return r.tag===3?r.stateNode.containerInfo:null;n=null}else r!==n&&(n=null);return Ha=n,null}function Zh(n){switch(n){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(XS()){case Vu:return 1;case bh:return 4;case Da:case KS:return 16;case Gh:return 536870912;default:return 16}default:return 16}}var Ci=null,tc=null,ba=null;function qh(){if(ba)return ba;var n,r=tc,a=r.length,c,h="value"in Ci?Ci.value:Ci.textContent,p=h.length;for(n=0;n<a&&r[n]===h[n];n++);var S=a-n;for(c=1;c<=S&&r[a-c]===h[p-c];c++);return ba=h.slice(n,1<c?1-c:void 0)}function Ga(n){var r=n.keyCode;return"charCode"in n?(n=n.charCode,n===0&&r===13&&(n=13)):n=r,n===10&&(n=13),32<=n||n===13?n:0}function xa(){return!0}function Qh(){return!1}function Jt(n){function r(a,c,h,p,S){this._reactName=a,this._targetInst=h,this.type=c,this.nativeEvent=p,this.target=S,this.currentTarget=null;for(var _ in n)n.hasOwnProperty(_)&&(a=n[_],this[_]=a?a(p):p[_]);return this.isDefaultPrevented=(p.defaultPrevented!=null?p.defaultPrevented:p.returnValue===!1)?xa:Qh,this.isPropagationStopped=Qh,this}return j(r.prototype,{preventDefault:function(){this.defaultPrevented=!0;var a=this.nativeEvent;a&&(a.preventDefault?a.preventDefault():typeof a.returnValue!="unknown"&&(a.returnValue=!1),this.isDefaultPrevented=xa)},stopPropagation:function(){var a=this.nativeEvent;a&&(a.stopPropagation?a.stopPropagation():typeof a.cancelBubble!="unknown"&&(a.cancelBubble=!0),this.isPropagationStopped=xa)},persist:function(){},isPersistent:xa}),r}var Xr={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(n){return n.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},nc=Jt(Xr),cs=j({},Xr,{view:0,detail:0}),ly=Jt(cs),ic,rc,ds,$a=j({},cs,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:sc,button:0,buttons:0,relatedTarget:function(n){return n.relatedTarget===void 0?n.fromElement===n.srcElement?n.toElement:n.fromElement:n.relatedTarget},movementX:function(n){return"movementX"in n?n.movementX:(n!==ds&&(ds&&n.type==="mousemove"?(ic=n.screenX-ds.screenX,rc=n.screenY-ds.screenY):rc=ic=0,ds=n),ic)},movementY:function(n){return"movementY"in n?n.movementY:rc}}),Jh=Jt($a),uy=j({},$a,{dataTransfer:0}),cy=Jt(uy),dy=j({},cs,{relatedTarget:0}),oc=Jt(dy),fy=j({},Xr,{animationName:0,elapsedTime:0,pseudoElement:0}),hy=Jt(fy),gy=j({},Xr,{clipboardData:function(n){return"clipboardData"in n?n.clipboardData:window.clipboardData}}),py=Jt(gy),my=j({},Xr,{data:0}),eg=Jt(my),vy={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Sy={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},yy={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Ty(n){var r=this.nativeEvent;return r.getModifierState?r.getModifierState(n):(n=yy[n])?!!r[n]:!1}function sc(){return Ty}var Ay=j({},cs,{key:function(n){if(n.key){var r=vy[n.key]||n.key;if(r!=="Unidentified")return r}return n.type==="keypress"?(n=Ga(n),n===13?"Enter":String.fromCharCode(n)):n.type==="keydown"||n.type==="keyup"?Sy[n.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:sc,charCode:function(n){return n.type==="keypress"?Ga(n):0},keyCode:function(n){return n.type==="keydown"||n.type==="keyup"?n.keyCode:0},which:function(n){return n.type==="keypress"?Ga(n):n.type==="keydown"||n.type==="keyup"?n.keyCode:0}}),Iy=Jt(Ay),Ey=j({},$a,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),tg=Jt(Ey),wy=j({},cs,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:sc}),_y=Jt(wy),Cy=j({},Xr,{propertyName:0,elapsedTime:0,pseudoElement:0}),Ry=Jt(Cy),Py=j({},$a,{deltaX:function(n){return"deltaX"in n?n.deltaX:"wheelDeltaX"in n?-n.wheelDeltaX:0},deltaY:function(n){return"deltaY"in n?n.deltaY:"wheelDeltaY"in n?-n.wheelDeltaY:"wheelDelta"in n?-n.wheelDelta:0},deltaZ:0,deltaMode:0}),Ny=Jt(Py),Dy=[9,13,27,32],ac=d&&"CompositionEvent"in window,fs=null;d&&"documentMode"in document&&(fs=document.documentMode);var Oy=d&&"TextEvent"in window&&!fs,ng=d&&(!ac||fs&&8<fs&&11>=fs),ig=" ",rg=!1;function og(n,r){switch(n){case"keyup":return Dy.indexOf(r.keyCode)!==-1;case"keydown":return r.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function sg(n){return n=n.detail,typeof n=="object"&&"data"in n?n.data:null}var Kr=!1;function My(n,r){switch(n){case"compositionend":return sg(r);case"keypress":return r.which!==32?null:(rg=!0,ig);case"textInput":return n=r.data,n===ig&&rg?null:n;default:return null}}function ky(n,r){if(Kr)return n==="compositionend"||!ac&&og(n,r)?(n=qh(),ba=tc=Ci=null,Kr=!1,n):null;switch(n){case"paste":return null;case"keypress":if(!(r.ctrlKey||r.altKey||r.metaKey)||r.ctrlKey&&r.altKey){if(r.char&&1<r.char.length)return r.char;if(r.which)return String.fromCharCode(r.which)}return null;case"compositionend":return ng&&r.locale!=="ko"?null:r.data;default:return null}}var Fy={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function ag(n){var r=n&&n.nodeName&&n.nodeName.toLowerCase();return r==="input"?!!Fy[n.type]:r==="textarea"}function lg(n,r,a,c){Ph(c),r=Va(r,"onChange"),0<r.length&&(a=new nc("onChange","change",null,a,c),n.push({event:a,listeners:r}))}var hs=null,gs=null;function Ly(n){Cg(n,0)}function za(n){var r=eo(n);if(ge(r))return n}function Uy(n,r){if(n==="change")return r}var ug=!1;if(d){var lc;if(d){var uc="oninput"in document;if(!uc){var cg=document.createElement("div");cg.setAttribute("oninput","return;"),uc=typeof cg.oninput=="function"}lc=uc}else lc=!1;ug=lc&&(!document.documentMode||9<document.documentMode)}function dg(){hs&&(hs.detachEvent("onpropertychange",fg),gs=hs=null)}function fg(n){if(n.propertyName==="value"&&za(gs)){var r=[];lg(r,gs,n,$u(n)),Mh(Ly,r)}}function By(n,r,a){n==="focusin"?(dg(),hs=r,gs=a,hs.attachEvent("onpropertychange",fg)):n==="focusout"&&dg()}function Hy(n){if(n==="selectionchange"||n==="keyup"||n==="keydown")return za(gs)}function by(n,r){if(n==="click")return za(r)}function Gy(n,r){if(n==="input"||n==="change")return za(r)}function xy(n,r){return n===r&&(n!==0||1/n===1/r)||n!==n&&r!==r}var Cn=typeof Object.is=="function"?Object.is:xy;function ps(n,r){if(Cn(n,r))return!0;if(typeof n!="object"||n===null||typeof r!="object"||r===null)return!1;var a=Object.keys(n),c=Object.keys(r);if(a.length!==c.length)return!1;for(c=0;c<a.length;c++){var h=a[c];if(!f.call(r,h)||!Cn(n[h],r[h]))return!1}return!0}function hg(n){for(;n&&n.firstChild;)n=n.firstChild;return n}function gg(n,r){var a=hg(n);n=0;for(var c;a;){if(a.nodeType===3){if(c=n+a.textContent.length,n<=r&&c>=r)return{node:a,offset:r-n};n=c}e:{for(;a;){if(a.nextSibling){a=a.nextSibling;break e}a=a.parentNode}a=void 0}a=hg(a)}}function pg(n,r){return n&&r?n===r?!0:n&&n.nodeType===3?!1:r&&r.nodeType===3?pg(n,r.parentNode):"contains"in n?n.contains(r):n.compareDocumentPosition?!!(n.compareDocumentPosition(r)&16):!1:!1}function mg(){for(var n=window,r=Gn();r instanceof n.HTMLIFrameElement;){try{var a=typeof r.contentWindow.location.href=="string"}catch{a=!1}if(a)n=r.contentWindow;else break;r=Gn(n.document)}return r}function cc(n){var r=n&&n.nodeName&&n.nodeName.toLowerCase();return r&&(r==="input"&&(n.type==="text"||n.type==="search"||n.type==="tel"||n.type==="url"||n.type==="password")||r==="textarea"||n.contentEditable==="true")}function $y(n){var r=mg(),a=n.focusedElem,c=n.selectionRange;if(r!==a&&a&&a.ownerDocument&&pg(a.ownerDocument.documentElement,a)){if(c!==null&&cc(a)){if(r=c.start,n=c.end,n===void 0&&(n=r),"selectionStart"in a)a.selectionStart=r,a.selectionEnd=Math.min(n,a.value.length);else if(n=(r=a.ownerDocument||document)&&r.defaultView||window,n.getSelection){n=n.getSelection();var h=a.textContent.length,p=Math.min(c.start,h);c=c.end===void 0?p:Math.min(c.end,h),!n.extend&&p>c&&(h=c,c=p,p=h),h=gg(a,p);var S=gg(a,c);h&&S&&(n.rangeCount!==1||n.anchorNode!==h.node||n.anchorOffset!==h.offset||n.focusNode!==S.node||n.focusOffset!==S.offset)&&(r=r.createRange(),r.setStart(h.node,h.offset),n.removeAllRanges(),p>c?(n.addRange(r),n.extend(S.node,S.offset)):(r.setEnd(S.node,S.offset),n.addRange(r)))}}for(r=[],n=a;n=n.parentNode;)n.nodeType===1&&r.push({element:n,left:n.scrollLeft,top:n.scrollTop});for(typeof a.focus=="function"&&a.focus(),a=0;a<r.length;a++)n=r[a],n.element.scrollLeft=n.left,n.element.scrollTop=n.top}}var zy=d&&"documentMode"in document&&11>=document.documentMode,Zr=null,dc=null,ms=null,fc=!1;function vg(n,r,a){var c=a.window===a?a.document:a.nodeType===9?a:a.ownerDocument;fc||Zr==null||Zr!==Gn(c)||(c=Zr,"selectionStart"in c&&cc(c)?c={start:c.selectionStart,end:c.selectionEnd}:(c=(c.ownerDocument&&c.ownerDocument.defaultView||window).getSelection(),c={anchorNode:c.anchorNode,anchorOffset:c.anchorOffset,focusNode:c.focusNode,focusOffset:c.focusOffset}),ms&&ps(ms,c)||(ms=c,c=Va(dc,"onSelect"),0<c.length&&(r=new nc("onSelect","select",null,r,a),n.push({event:r,listeners:c}),r.target=Zr)))}function Wa(n,r){var a={};return a[n.toLowerCase()]=r.toLowerCase(),a["Webkit"+n]="webkit"+r,a["Moz"+n]="moz"+r,a}var qr={animationend:Wa("Animation","AnimationEnd"),animationiteration:Wa("Animation","AnimationIteration"),animationstart:Wa("Animation","AnimationStart"),transitionend:Wa("Transition","TransitionEnd")},hc={},Sg={};d&&(Sg=document.createElement("div").style,"AnimationEvent"in window||(delete qr.animationend.animation,delete qr.animationiteration.animation,delete qr.animationstart.animation),"TransitionEvent"in window||delete qr.transitionend.transition);function Ya(n){if(hc[n])return hc[n];if(!qr[n])return n;var r=qr[n],a;for(a in r)if(r.hasOwnProperty(a)&&a in Sg)return hc[n]=r[a];return n}var yg=Ya("animationend"),Tg=Ya("animationiteration"),Ag=Ya("animationstart"),Ig=Ya("transitionend"),Eg=new Map,wg="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Ri(n,r){Eg.set(n,r),s(r,[n])}for(var gc=0;gc<wg.length;gc++){var pc=wg[gc],Wy=pc.toLowerCase(),Yy=pc[0].toUpperCase()+pc.slice(1);Ri(Wy,"on"+Yy)}Ri(yg,"onAnimationEnd"),Ri(Tg,"onAnimationIteration"),Ri(Ag,"onAnimationStart"),Ri("dblclick","onDoubleClick"),Ri("focusin","onFocus"),Ri("focusout","onBlur"),Ri(Ig,"onTransitionEnd"),u("onMouseEnter",["mouseout","mouseover"]),u("onMouseLeave",["mouseout","mouseover"]),u("onPointerEnter",["pointerout","pointerover"]),u("onPointerLeave",["pointerout","pointerover"]),s("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),s("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),s("onBeforeInput",["compositionend","keypress","textInput","paste"]),s("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),s("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),s("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var vs="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),jy=new Set("cancel close invalid load scroll toggle".split(" ").concat(vs));function _g(n,r,a){var c=n.type||"unknown-event";n.currentTarget=a,WS(c,r,void 0,n),n.currentTarget=null}function Cg(n,r){r=(r&4)!==0;for(var a=0;a<n.length;a++){var c=n[a],h=c.event;c=c.listeners;e:{var p=void 0;if(r)for(var S=c.length-1;0<=S;S--){var _=c[S],R=_.instance,k=_.currentTarget;if(_=_.listener,R!==p&&h.isPropagationStopped())break e;_g(h,_,k),p=R}else for(S=0;S<c.length;S++){if(_=c[S],R=_.instance,k=_.currentTarget,_=_.listener,R!==p&&h.isPropagationStopped())break e;_g(h,_,k),p=R}}}if(Na)throw n=ju,Na=!1,ju=null,n}function Xe(n,r){var a=r[Ec];a===void 0&&(a=r[Ec]=new Set);var c=n+"__bubble";a.has(c)||(Rg(r,n,2,!1),a.add(c))}function mc(n,r,a){var c=0;r&&(c|=4),Rg(a,n,c,r)}var ja="_reactListening"+Math.random().toString(36).slice(2);function Ss(n){if(!n[ja]){n[ja]=!0,o.forEach(function(a){a!=="selectionchange"&&(jy.has(a)||mc(a,!1,n),mc(a,!0,n))});var r=n.nodeType===9?n:n.ownerDocument;r===null||r[ja]||(r[ja]=!0,mc("selectionchange",!1,r))}}function Rg(n,r,a,c){switch(Zh(r)){case 1:var h=sy;break;case 4:h=ay;break;default:h=Ju}a=h.bind(null,r,a,n),h=void 0,!Yu||r!=="touchstart"&&r!=="touchmove"&&r!=="wheel"||(h=!0),c?h!==void 0?n.addEventListener(r,a,{capture:!0,passive:h}):n.addEventListener(r,a,!0):h!==void 0?n.addEventListener(r,a,{passive:h}):n.addEventListener(r,a,!1)}function vc(n,r,a,c,h){var p=c;if((r&1)===0&&(r&2)===0&&c!==null)e:for(;;){if(c===null)return;var S=c.tag;if(S===3||S===4){var _=c.stateNode.containerInfo;if(_===h||_.nodeType===8&&_.parentNode===h)break;if(S===4)for(S=c.return;S!==null;){var R=S.tag;if((R===3||R===4)&&(R=S.stateNode.containerInfo,R===h||R.nodeType===8&&R.parentNode===h))return;S=S.return}for(;_!==null;){if(S=cr(_),S===null)return;if(R=S.tag,R===5||R===6){c=p=S;continue e}_=_.parentNode}}c=c.return}Mh(function(){var k=p,x=$u(a),z=[];e:{var G=Eg.get(n);if(G!==void 0){var q=nc,te=n;switch(n){case"keypress":if(Ga(a)===0)break e;case"keydown":case"keyup":q=Iy;break;case"focusin":te="focus",q=oc;break;case"focusout":te="blur",q=oc;break;case"beforeblur":case"afterblur":q=oc;break;case"click":if(a.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":q=Jh;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":q=cy;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":q=_y;break;case yg:case Tg:case Ag:q=hy;break;case Ig:q=Ry;break;case"scroll":q=ly;break;case"wheel":q=Ny;break;case"copy":case"cut":case"paste":q=py;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":q=tg}var se=(r&4)!==0,lt=!se&&n==="scroll",O=se?G!==null?G+"Capture":null:G;se=[];for(var N=k,M;N!==null;){M=N;var V=M.stateNode;if(M.tag===5&&V!==null&&(M=V,O!==null&&(V=es(N,O),V!=null&&se.push(ys(N,V,M)))),lt)break;N=N.return}0<se.length&&(G=new q(G,te,null,a,x),z.push({event:G,listeners:se}))}}if((r&7)===0){e:{if(G=n==="mouseover"||n==="pointerover",q=n==="mouseout"||n==="pointerout",G&&a!==xu&&(te=a.relatedTarget||a.fromElement)&&(cr(te)||te[ni]))break e;if((q||G)&&(G=x.window===x?x:(G=x.ownerDocument)?G.defaultView||G.parentWindow:window,q?(te=a.relatedTarget||a.toElement,q=k,te=te?cr(te):null,te!==null&&(lt=ur(te),te!==lt||te.tag!==5&&te.tag!==6)&&(te=null)):(q=null,te=k),q!==te)){if(se=Jh,V="onMouseLeave",O="onMouseEnter",N="mouse",(n==="pointerout"||n==="pointerover")&&(se=tg,V="onPointerLeave",O="onPointerEnter",N="pointer"),lt=q==null?G:eo(q),M=te==null?G:eo(te),G=new se(V,N+"leave",q,a,x),G.target=lt,G.relatedTarget=M,V=null,cr(x)===k&&(se=new se(O,N+"enter",te,a,x),se.target=M,se.relatedTarget=lt,V=se),lt=V,q&&te)t:{for(se=q,O=te,N=0,M=se;M;M=Qr(M))N++;for(M=0,V=O;V;V=Qr(V))M++;for(;0<N-M;)se=Qr(se),N--;for(;0<M-N;)O=Qr(O),M--;for(;N--;){if(se===O||O!==null&&se===O.alternate)break t;se=Qr(se),O=Qr(O)}se=null}else se=null;q!==null&&Pg(z,G,q,se,!1),te!==null&&lt!==null&&Pg(z,lt,te,se,!0)}}e:{if(G=k?eo(k):window,q=G.nodeName&&G.nodeName.toLowerCase(),q==="select"||q==="input"&&G.type==="file")var ue=Uy;else if(ag(G))if(ug)ue=Gy;else{ue=Hy;var me=By}else(q=G.nodeName)&&q.toLowerCase()==="input"&&(G.type==="checkbox"||G.type==="radio")&&(ue=by);if(ue&&(ue=ue(n,k))){lg(z,ue,a,x);break e}me&&me(n,G,k),n==="focusout"&&(me=G._wrapperState)&&me.controlled&&G.type==="number"&&$n(G,"number",G.value)}switch(me=k?eo(k):window,n){case"focusin":(ag(me)||me.contentEditable==="true")&&(Zr=me,dc=k,ms=null);break;case"focusout":ms=dc=Zr=null;break;case"mousedown":fc=!0;break;case"contextmenu":case"mouseup":case"dragend":fc=!1,vg(z,a,x);break;case"selectionchange":if(zy)break;case"keydown":case"keyup":vg(z,a,x)}var ve;if(ac)e:{switch(n){case"compositionstart":var we="onCompositionStart";break e;case"compositionend":we="onCompositionEnd";break e;case"compositionupdate":we="onCompositionUpdate";break e}we=void 0}else Kr?og(n,a)&&(we="onCompositionEnd"):n==="keydown"&&a.keyCode===229&&(we="onCompositionStart");we&&(ng&&a.locale!=="ko"&&(Kr||we!=="onCompositionStart"?we==="onCompositionEnd"&&Kr&&(ve=qh()):(Ci=x,tc="value"in Ci?Ci.value:Ci.textContent,Kr=!0)),me=Va(k,we),0<me.length&&(we=new eg(we,n,null,a,x),z.push({event:we,listeners:me}),ve?we.data=ve:(ve=sg(a),ve!==null&&(we.data=ve)))),(ve=Oy?My(n,a):ky(n,a))&&(k=Va(k,"onBeforeInput"),0<k.length&&(x=new eg("onBeforeInput","beforeinput",null,a,x),z.push({event:x,listeners:k}),x.data=ve))}Cg(z,r)})}function ys(n,r,a){return{instance:n,listener:r,currentTarget:a}}function Va(n,r){for(var a=r+"Capture",c=[];n!==null;){var h=n,p=h.stateNode;h.tag===5&&p!==null&&(h=p,p=es(n,a),p!=null&&c.unshift(ys(n,p,h)),p=es(n,r),p!=null&&c.push(ys(n,p,h))),n=n.return}return c}function Qr(n){if(n===null)return null;do n=n.return;while(n&&n.tag!==5);return n||null}function Pg(n,r,a,c,h){for(var p=r._reactName,S=[];a!==null&&a!==c;){var _=a,R=_.alternate,k=_.stateNode;if(R!==null&&R===c)break;_.tag===5&&k!==null&&(_=k,h?(R=es(a,p),R!=null&&S.unshift(ys(a,R,_))):h||(R=es(a,p),R!=null&&S.push(ys(a,R,_)))),a=a.return}S.length!==0&&n.push({event:r,listeners:S})}var Vy=/\r\n?/g,Xy=/\u0000|\uFFFD/g;function Ng(n){return(typeof n=="string"?n:""+n).replace(Vy,`
`).replace(Xy,"")}function Xa(n,r,a){if(r=Ng(r),Ng(n)!==r&&a)throw Error(i(425))}function Ka(){}var Sc=null,yc=null;function Tc(n,r){return n==="textarea"||n==="noscript"||typeof r.children=="string"||typeof r.children=="number"||typeof r.dangerouslySetInnerHTML=="object"&&r.dangerouslySetInnerHTML!==null&&r.dangerouslySetInnerHTML.__html!=null}var Ac=typeof setTimeout=="function"?setTimeout:void 0,Ky=typeof clearTimeout=="function"?clearTimeout:void 0,Dg=typeof Promise=="function"?Promise:void 0,Zy=typeof queueMicrotask=="function"?queueMicrotask:typeof Dg<"u"?function(n){return Dg.resolve(null).then(n).catch(qy)}:Ac;function qy(n){setTimeout(function(){throw n})}function Ic(n,r){var a=r,c=0;do{var h=a.nextSibling;if(n.removeChild(a),h&&h.nodeType===8)if(a=h.data,a==="/$"){if(c===0){n.removeChild(h),us(r);return}c--}else a!=="$"&&a!=="$?"&&a!=="$!"||c++;a=h}while(a);us(r)}function Pi(n){for(;n!=null;n=n.nextSibling){var r=n.nodeType;if(r===1||r===3)break;if(r===8){if(r=n.data,r==="$"||r==="$!"||r==="$?")break;if(r==="/$")return null}}return n}function Og(n){n=n.previousSibling;for(var r=0;n;){if(n.nodeType===8){var a=n.data;if(a==="$"||a==="$!"||a==="$?"){if(r===0)return n;r--}else a==="/$"&&r++}n=n.previousSibling}return null}var Jr=Math.random().toString(36).slice(2),Yn="__reactFiber$"+Jr,Ts="__reactProps$"+Jr,ni="__reactContainer$"+Jr,Ec="__reactEvents$"+Jr,Qy="__reactListeners$"+Jr,Jy="__reactHandles$"+Jr;function cr(n){var r=n[Yn];if(r)return r;for(var a=n.parentNode;a;){if(r=a[ni]||a[Yn]){if(a=r.alternate,r.child!==null||a!==null&&a.child!==null)for(n=Og(n);n!==null;){if(a=n[Yn])return a;n=Og(n)}return r}n=a,a=n.parentNode}return null}function As(n){return n=n[Yn]||n[ni],!n||n.tag!==5&&n.tag!==6&&n.tag!==13&&n.tag!==3?null:n}function eo(n){if(n.tag===5||n.tag===6)return n.stateNode;throw Error(i(33))}function Za(n){return n[Ts]||null}var wc=[],to=-1;function Ni(n){return{current:n}}function Ke(n){0>to||(n.current=wc[to],wc[to]=null,to--)}function Ye(n,r){to++,wc[to]=n.current,n.current=r}var Di={},Nt=Ni(Di),jt=Ni(!1),dr=Di;function no(n,r){var a=n.type.contextTypes;if(!a)return Di;var c=n.stateNode;if(c&&c.__reactInternalMemoizedUnmaskedChildContext===r)return c.__reactInternalMemoizedMaskedChildContext;var h={},p;for(p in a)h[p]=r[p];return c&&(n=n.stateNode,n.__reactInternalMemoizedUnmaskedChildContext=r,n.__reactInternalMemoizedMaskedChildContext=h),h}function Vt(n){return n=n.childContextTypes,n!=null}function qa(){Ke(jt),Ke(Nt)}function Mg(n,r,a){if(Nt.current!==Di)throw Error(i(168));Ye(Nt,r),Ye(jt,a)}function kg(n,r,a){var c=n.stateNode;if(r=r.childContextTypes,typeof c.getChildContext!="function")return a;c=c.getChildContext();for(var h in c)if(!(h in r))throw Error(i(108,Ee(n)||"Unknown",h));return j({},a,c)}function Qa(n){return n=(n=n.stateNode)&&n.__reactInternalMemoizedMergedChildContext||Di,dr=Nt.current,Ye(Nt,n),Ye(jt,jt.current),!0}function Fg(n,r,a){var c=n.stateNode;if(!c)throw Error(i(169));a?(n=kg(n,r,dr),c.__reactInternalMemoizedMergedChildContext=n,Ke(jt),Ke(Nt),Ye(Nt,n)):Ke(jt),Ye(jt,a)}var ii=null,Ja=!1,_c=!1;function Lg(n){ii===null?ii=[n]:ii.push(n)}function eT(n){Ja=!0,Lg(n)}function Oi(){if(!_c&&ii!==null){_c=!0;var n=0,r=We;try{var a=ii;for(We=1;n<a.length;n++){var c=a[n];do c=c(!0);while(c!==null)}ii=null,Ja=!1}catch(h){throw ii!==null&&(ii=ii.slice(n+1)),Bh(Vu,Oi),h}finally{We=r,_c=!1}}return null}var io=[],ro=0,el=null,tl=0,dn=[],fn=0,fr=null,ri=1,oi="";function hr(n,r){io[ro++]=tl,io[ro++]=el,el=n,tl=r}function Ug(n,r,a){dn[fn++]=ri,dn[fn++]=oi,dn[fn++]=fr,fr=n;var c=ri;n=oi;var h=32-_n(c)-1;c&=~(1<<h),a+=1;var p=32-_n(r)+h;if(30<p){var S=h-h%5;p=(c&(1<<S)-1).toString(32),c>>=S,h-=S,ri=1<<32-_n(r)+h|a<<h|c,oi=p+n}else ri=1<<p|a<<h|c,oi=n}function Cc(n){n.return!==null&&(hr(n,1),Ug(n,1,0))}function Rc(n){for(;n===el;)el=io[--ro],io[ro]=null,tl=io[--ro],io[ro]=null;for(;n===fr;)fr=dn[--fn],dn[fn]=null,oi=dn[--fn],dn[fn]=null,ri=dn[--fn],dn[fn]=null}var en=null,tn=null,Qe=!1,Rn=null;function Bg(n,r){var a=mn(5,null,null,0);a.elementType="DELETED",a.stateNode=r,a.return=n,r=n.deletions,r===null?(n.deletions=[a],n.flags|=16):r.push(a)}function Hg(n,r){switch(n.tag){case 5:var a=n.type;return r=r.nodeType!==1||a.toLowerCase()!==r.nodeName.toLowerCase()?null:r,r!==null?(n.stateNode=r,en=n,tn=Pi(r.firstChild),!0):!1;case 6:return r=n.pendingProps===""||r.nodeType!==3?null:r,r!==null?(n.stateNode=r,en=n,tn=null,!0):!1;case 13:return r=r.nodeType!==8?null:r,r!==null?(a=fr!==null?{id:ri,overflow:oi}:null,n.memoizedState={dehydrated:r,treeContext:a,retryLane:1073741824},a=mn(18,null,null,0),a.stateNode=r,a.return=n,n.child=a,en=n,tn=null,!0):!1;default:return!1}}function Pc(n){return(n.mode&1)!==0&&(n.flags&128)===0}function Nc(n){if(Qe){var r=tn;if(r){var a=r;if(!Hg(n,r)){if(Pc(n))throw Error(i(418));r=Pi(a.nextSibling);var c=en;r&&Hg(n,r)?Bg(c,a):(n.flags=n.flags&-4097|2,Qe=!1,en=n)}}else{if(Pc(n))throw Error(i(418));n.flags=n.flags&-4097|2,Qe=!1,en=n}}}function bg(n){for(n=n.return;n!==null&&n.tag!==5&&n.tag!==3&&n.tag!==13;)n=n.return;en=n}function nl(n){if(n!==en)return!1;if(!Qe)return bg(n),Qe=!0,!1;var r;if((r=n.tag!==3)&&!(r=n.tag!==5)&&(r=n.type,r=r!=="head"&&r!=="body"&&!Tc(n.type,n.memoizedProps)),r&&(r=tn)){if(Pc(n))throw Gg(),Error(i(418));for(;r;)Bg(n,r),r=Pi(r.nextSibling)}if(bg(n),n.tag===13){if(n=n.memoizedState,n=n!==null?n.dehydrated:null,!n)throw Error(i(317));e:{for(n=n.nextSibling,r=0;n;){if(n.nodeType===8){var a=n.data;if(a==="/$"){if(r===0){tn=Pi(n.nextSibling);break e}r--}else a!=="$"&&a!=="$!"&&a!=="$?"||r++}n=n.nextSibling}tn=null}}else tn=en?Pi(n.stateNode.nextSibling):null;return!0}function Gg(){for(var n=tn;n;)n=Pi(n.nextSibling)}function oo(){tn=en=null,Qe=!1}function Dc(n){Rn===null?Rn=[n]:Rn.push(n)}var tT=H.ReactCurrentBatchConfig;function Is(n,r,a){if(n=a.ref,n!==null&&typeof n!="function"&&typeof n!="object"){if(a._owner){if(a=a._owner,a){if(a.tag!==1)throw Error(i(309));var c=a.stateNode}if(!c)throw Error(i(147,n));var h=c,p=""+n;return r!==null&&r.ref!==null&&typeof r.ref=="function"&&r.ref._stringRef===p?r.ref:(r=function(S){var _=h.refs;S===null?delete _[p]:_[p]=S},r._stringRef=p,r)}if(typeof n!="string")throw Error(i(284));if(!a._owner)throw Error(i(290,n))}return n}function il(n,r){throw n=Object.prototype.toString.call(r),Error(i(31,n==="[object Object]"?"object with keys {"+Object.keys(r).join(", ")+"}":n))}function xg(n){var r=n._init;return r(n._payload)}function $g(n){function r(O,N){if(n){var M=O.deletions;M===null?(O.deletions=[N],O.flags|=16):M.push(N)}}function a(O,N){if(!n)return null;for(;N!==null;)r(O,N),N=N.sibling;return null}function c(O,N){for(O=new Map;N!==null;)N.key!==null?O.set(N.key,N):O.set(N.index,N),N=N.sibling;return O}function h(O,N){return O=bi(O,N),O.index=0,O.sibling=null,O}function p(O,N,M){return O.index=M,n?(M=O.alternate,M!==null?(M=M.index,M<N?(O.flags|=2,N):M):(O.flags|=2,N)):(O.flags|=1048576,N)}function S(O){return n&&O.alternate===null&&(O.flags|=2),O}function _(O,N,M,V){return N===null||N.tag!==6?(N=Ad(M,O.mode,V),N.return=O,N):(N=h(N,M),N.return=O,N)}function R(O,N,M,V){var ue=M.type;return ue===$?x(O,N,M.props.children,V,M.key):N!==null&&(N.elementType===ue||typeof ue=="object"&&ue!==null&&ue.$$typeof===Te&&xg(ue)===N.type)?(V=h(N,M.props),V.ref=Is(O,N,M),V.return=O,V):(V=Rl(M.type,M.key,M.props,null,O.mode,V),V.ref=Is(O,N,M),V.return=O,V)}function k(O,N,M,V){return N===null||N.tag!==4||N.stateNode.containerInfo!==M.containerInfo||N.stateNode.implementation!==M.implementation?(N=Id(M,O.mode,V),N.return=O,N):(N=h(N,M.children||[]),N.return=O,N)}function x(O,N,M,V,ue){return N===null||N.tag!==7?(N=Ar(M,O.mode,V,ue),N.return=O,N):(N=h(N,M),N.return=O,N)}function z(O,N,M){if(typeof N=="string"&&N!==""||typeof N=="number")return N=Ad(""+N,O.mode,M),N.return=O,N;if(typeof N=="object"&&N!==null){switch(N.$$typeof){case b:return M=Rl(N.type,N.key,N.props,null,O.mode,M),M.ref=Is(O,null,N),M.return=O,M;case U:return N=Id(N,O.mode,M),N.return=O,N;case Te:var V=N._init;return z(O,V(N._payload),M)}if(zn(N)||X(N))return N=Ar(N,O.mode,M,null),N.return=O,N;il(O,N)}return null}function G(O,N,M,V){var ue=N!==null?N.key:null;if(typeof M=="string"&&M!==""||typeof M=="number")return ue!==null?null:_(O,N,""+M,V);if(typeof M=="object"&&M!==null){switch(M.$$typeof){case b:return M.key===ue?R(O,N,M,V):null;case U:return M.key===ue?k(O,N,M,V):null;case Te:return ue=M._init,G(O,N,ue(M._payload),V)}if(zn(M)||X(M))return ue!==null?null:x(O,N,M,V,null);il(O,M)}return null}function q(O,N,M,V,ue){if(typeof V=="string"&&V!==""||typeof V=="number")return O=O.get(M)||null,_(N,O,""+V,ue);if(typeof V=="object"&&V!==null){switch(V.$$typeof){case b:return O=O.get(V.key===null?M:V.key)||null,R(N,O,V,ue);case U:return O=O.get(V.key===null?M:V.key)||null,k(N,O,V,ue);case Te:var me=V._init;return q(O,N,M,me(V._payload),ue)}if(zn(V)||X(V))return O=O.get(M)||null,x(N,O,V,ue,null);il(N,V)}return null}function te(O,N,M,V){for(var ue=null,me=null,ve=N,we=N=0,Tt=null;ve!==null&&we<M.length;we++){ve.index>we?(Tt=ve,ve=null):Tt=ve.sibling;var Ge=G(O,ve,M[we],V);if(Ge===null){ve===null&&(ve=Tt);break}n&&ve&&Ge.alternate===null&&r(O,ve),N=p(Ge,N,we),me===null?ue=Ge:me.sibling=Ge,me=Ge,ve=Tt}if(we===M.length)return a(O,ve),Qe&&hr(O,we),ue;if(ve===null){for(;we<M.length;we++)ve=z(O,M[we],V),ve!==null&&(N=p(ve,N,we),me===null?ue=ve:me.sibling=ve,me=ve);return Qe&&hr(O,we),ue}for(ve=c(O,ve);we<M.length;we++)Tt=q(ve,O,we,M[we],V),Tt!==null&&(n&&Tt.alternate!==null&&ve.delete(Tt.key===null?we:Tt.key),N=p(Tt,N,we),me===null?ue=Tt:me.sibling=Tt,me=Tt);return n&&ve.forEach(function(Gi){return r(O,Gi)}),Qe&&hr(O,we),ue}function se(O,N,M,V){var ue=X(M);if(typeof ue!="function")throw Error(i(150));if(M=ue.call(M),M==null)throw Error(i(151));for(var me=ue=null,ve=N,we=N=0,Tt=null,Ge=M.next();ve!==null&&!Ge.done;we++,Ge=M.next()){ve.index>we?(Tt=ve,ve=null):Tt=ve.sibling;var Gi=G(O,ve,Ge.value,V);if(Gi===null){ve===null&&(ve=Tt);break}n&&ve&&Gi.alternate===null&&r(O,ve),N=p(Gi,N,we),me===null?ue=Gi:me.sibling=Gi,me=Gi,ve=Tt}if(Ge.done)return a(O,ve),Qe&&hr(O,we),ue;if(ve===null){for(;!Ge.done;we++,Ge=M.next())Ge=z(O,Ge.value,V),Ge!==null&&(N=p(Ge,N,we),me===null?ue=Ge:me.sibling=Ge,me=Ge);return Qe&&hr(O,we),ue}for(ve=c(O,ve);!Ge.done;we++,Ge=M.next())Ge=q(ve,O,we,Ge.value,V),Ge!==null&&(n&&Ge.alternate!==null&&ve.delete(Ge.key===null?we:Ge.key),N=p(Ge,N,we),me===null?ue=Ge:me.sibling=Ge,me=Ge);return n&&ve.forEach(function(FT){return r(O,FT)}),Qe&&hr(O,we),ue}function lt(O,N,M,V){if(typeof M=="object"&&M!==null&&M.type===$&&M.key===null&&(M=M.props.children),typeof M=="object"&&M!==null){switch(M.$$typeof){case b:e:{for(var ue=M.key,me=N;me!==null;){if(me.key===ue){if(ue=M.type,ue===$){if(me.tag===7){a(O,me.sibling),N=h(me,M.props.children),N.return=O,O=N;break e}}else if(me.elementType===ue||typeof ue=="object"&&ue!==null&&ue.$$typeof===Te&&xg(ue)===me.type){a(O,me.sibling),N=h(me,M.props),N.ref=Is(O,me,M),N.return=O,O=N;break e}a(O,me);break}else r(O,me);me=me.sibling}M.type===$?(N=Ar(M.props.children,O.mode,V,M.key),N.return=O,O=N):(V=Rl(M.type,M.key,M.props,null,O.mode,V),V.ref=Is(O,N,M),V.return=O,O=V)}return S(O);case U:e:{for(me=M.key;N!==null;){if(N.key===me)if(N.tag===4&&N.stateNode.containerInfo===M.containerInfo&&N.stateNode.implementation===M.implementation){a(O,N.sibling),N=h(N,M.children||[]),N.return=O,O=N;break e}else{a(O,N);break}else r(O,N);N=N.sibling}N=Id(M,O.mode,V),N.return=O,O=N}return S(O);case Te:return me=M._init,lt(O,N,me(M._payload),V)}if(zn(M))return te(O,N,M,V);if(X(M))return se(O,N,M,V);il(O,M)}return typeof M=="string"&&M!==""||typeof M=="number"?(M=""+M,N!==null&&N.tag===6?(a(O,N.sibling),N=h(N,M),N.return=O,O=N):(a(O,N),N=Ad(M,O.mode,V),N.return=O,O=N),S(O)):a(O,N)}return lt}var so=$g(!0),zg=$g(!1),rl=Ni(null),ol=null,ao=null,Oc=null;function Mc(){Oc=ao=ol=null}function kc(n){var r=rl.current;Ke(rl),n._currentValue=r}function Fc(n,r,a){for(;n!==null;){var c=n.alternate;if((n.childLanes&r)!==r?(n.childLanes|=r,c!==null&&(c.childLanes|=r)):c!==null&&(c.childLanes&r)!==r&&(c.childLanes|=r),n===a)break;n=n.return}}function lo(n,r){ol=n,Oc=ao=null,n=n.dependencies,n!==null&&n.firstContext!==null&&((n.lanes&r)!==0&&(Xt=!0),n.firstContext=null)}function hn(n){var r=n._currentValue;if(Oc!==n)if(n={context:n,memoizedValue:r,next:null},ao===null){if(ol===null)throw Error(i(308));ao=n,ol.dependencies={lanes:0,firstContext:n}}else ao=ao.next=n;return r}var gr=null;function Lc(n){gr===null?gr=[n]:gr.push(n)}function Wg(n,r,a,c){var h=r.interleaved;return h===null?(a.next=a,Lc(r)):(a.next=h.next,h.next=a),r.interleaved=a,si(n,c)}function si(n,r){n.lanes|=r;var a=n.alternate;for(a!==null&&(a.lanes|=r),a=n,n=n.return;n!==null;)n.childLanes|=r,a=n.alternate,a!==null&&(a.childLanes|=r),a=n,n=n.return;return a.tag===3?a.stateNode:null}var Mi=!1;function Uc(n){n.updateQueue={baseState:n.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Yg(n,r){n=n.updateQueue,r.updateQueue===n&&(r.updateQueue={baseState:n.baseState,firstBaseUpdate:n.firstBaseUpdate,lastBaseUpdate:n.lastBaseUpdate,shared:n.shared,effects:n.effects})}function ai(n,r){return{eventTime:n,lane:r,tag:0,payload:null,callback:null,next:null}}function ki(n,r,a){var c=n.updateQueue;if(c===null)return null;if(c=c.shared,(He&2)!==0){var h=c.pending;return h===null?r.next=r:(r.next=h.next,h.next=r),c.pending=r,si(n,a)}return h=c.interleaved,h===null?(r.next=r,Lc(c)):(r.next=h.next,h.next=r),c.interleaved=r,si(n,a)}function sl(n,r,a){if(r=r.updateQueue,r!==null&&(r=r.shared,(a&4194240)!==0)){var c=r.lanes;c&=n.pendingLanes,a|=c,r.lanes=a,Zu(n,a)}}function jg(n,r){var a=n.updateQueue,c=n.alternate;if(c!==null&&(c=c.updateQueue,a===c)){var h=null,p=null;if(a=a.firstBaseUpdate,a!==null){do{var S={eventTime:a.eventTime,lane:a.lane,tag:a.tag,payload:a.payload,callback:a.callback,next:null};p===null?h=p=S:p=p.next=S,a=a.next}while(a!==null);p===null?h=p=r:p=p.next=r}else h=p=r;a={baseState:c.baseState,firstBaseUpdate:h,lastBaseUpdate:p,shared:c.shared,effects:c.effects},n.updateQueue=a;return}n=a.lastBaseUpdate,n===null?a.firstBaseUpdate=r:n.next=r,a.lastBaseUpdate=r}function al(n,r,a,c){var h=n.updateQueue;Mi=!1;var p=h.firstBaseUpdate,S=h.lastBaseUpdate,_=h.shared.pending;if(_!==null){h.shared.pending=null;var R=_,k=R.next;R.next=null,S===null?p=k:S.next=k,S=R;var x=n.alternate;x!==null&&(x=x.updateQueue,_=x.lastBaseUpdate,_!==S&&(_===null?x.firstBaseUpdate=k:_.next=k,x.lastBaseUpdate=R))}if(p!==null){var z=h.baseState;S=0,x=k=R=null,_=p;do{var G=_.lane,q=_.eventTime;if((c&G)===G){x!==null&&(x=x.next={eventTime:q,lane:0,tag:_.tag,payload:_.payload,callback:_.callback,next:null});e:{var te=n,se=_;switch(G=r,q=a,se.tag){case 1:if(te=se.payload,typeof te=="function"){z=te.call(q,z,G);break e}z=te;break e;case 3:te.flags=te.flags&-65537|128;case 0:if(te=se.payload,G=typeof te=="function"?te.call(q,z,G):te,G==null)break e;z=j({},z,G);break e;case 2:Mi=!0}}_.callback!==null&&_.lane!==0&&(n.flags|=64,G=h.effects,G===null?h.effects=[_]:G.push(_))}else q={eventTime:q,lane:G,tag:_.tag,payload:_.payload,callback:_.callback,next:null},x===null?(k=x=q,R=z):x=x.next=q,S|=G;if(_=_.next,_===null){if(_=h.shared.pending,_===null)break;G=_,_=G.next,G.next=null,h.lastBaseUpdate=G,h.shared.pending=null}}while(!0);if(x===null&&(R=z),h.baseState=R,h.firstBaseUpdate=k,h.lastBaseUpdate=x,r=h.shared.interleaved,r!==null){h=r;do S|=h.lane,h=h.next;while(h!==r)}else p===null&&(h.shared.lanes=0);vr|=S,n.lanes=S,n.memoizedState=z}}function Vg(n,r,a){if(n=r.effects,r.effects=null,n!==null)for(r=0;r<n.length;r++){var c=n[r],h=c.callback;if(h!==null){if(c.callback=null,c=a,typeof h!="function")throw Error(i(191,h));h.call(c)}}}var Es={},jn=Ni(Es),ws=Ni(Es),_s=Ni(Es);function pr(n){if(n===Es)throw Error(i(174));return n}function Bc(n,r){switch(Ye(_s,r),Ye(ws,n),Ye(jn,Es),n=r.nodeType,n){case 9:case 11:r=(r=r.documentElement)?r.namespaceURI:Hu(null,"");break;default:n=n===8?r.parentNode:r,r=n.namespaceURI||null,n=n.tagName,r=Hu(r,n)}Ke(jn),Ye(jn,r)}function uo(){Ke(jn),Ke(ws),Ke(_s)}function Xg(n){pr(_s.current);var r=pr(jn.current),a=Hu(r,n.type);r!==a&&(Ye(ws,n),Ye(jn,a))}function Hc(n){ws.current===n&&(Ke(jn),Ke(ws))}var it=Ni(0);function ll(n){for(var r=n;r!==null;){if(r.tag===13){var a=r.memoizedState;if(a!==null&&(a=a.dehydrated,a===null||a.data==="$?"||a.data==="$!"))return r}else if(r.tag===19&&r.memoizedProps.revealOrder!==void 0){if((r.flags&128)!==0)return r}else if(r.child!==null){r.child.return=r,r=r.child;continue}if(r===n)break;for(;r.sibling===null;){if(r.return===null||r.return===n)return null;r=r.return}r.sibling.return=r.return,r=r.sibling}return null}var bc=[];function Gc(){for(var n=0;n<bc.length;n++)bc[n]._workInProgressVersionPrimary=null;bc.length=0}var ul=H.ReactCurrentDispatcher,xc=H.ReactCurrentBatchConfig,mr=0,rt=null,ht=null,St=null,cl=!1,Cs=!1,Rs=0,nT=0;function Dt(){throw Error(i(321))}function $c(n,r){if(r===null)return!1;for(var a=0;a<r.length&&a<n.length;a++)if(!Cn(n[a],r[a]))return!1;return!0}function zc(n,r,a,c,h,p){if(mr=p,rt=r,r.memoizedState=null,r.updateQueue=null,r.lanes=0,ul.current=n===null||n.memoizedState===null?sT:aT,n=a(c,h),Cs){p=0;do{if(Cs=!1,Rs=0,25<=p)throw Error(i(301));p+=1,St=ht=null,r.updateQueue=null,ul.current=lT,n=a(c,h)}while(Cs)}if(ul.current=hl,r=ht!==null&&ht.next!==null,mr=0,St=ht=rt=null,cl=!1,r)throw Error(i(300));return n}function Wc(){var n=Rs!==0;return Rs=0,n}function Vn(){var n={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return St===null?rt.memoizedState=St=n:St=St.next=n,St}function gn(){if(ht===null){var n=rt.alternate;n=n!==null?n.memoizedState:null}else n=ht.next;var r=St===null?rt.memoizedState:St.next;if(r!==null)St=r,ht=n;else{if(n===null)throw Error(i(310));ht=n,n={memoizedState:ht.memoizedState,baseState:ht.baseState,baseQueue:ht.baseQueue,queue:ht.queue,next:null},St===null?rt.memoizedState=St=n:St=St.next=n}return St}function Ps(n,r){return typeof r=="function"?r(n):r}function Yc(n){var r=gn(),a=r.queue;if(a===null)throw Error(i(311));a.lastRenderedReducer=n;var c=ht,h=c.baseQueue,p=a.pending;if(p!==null){if(h!==null){var S=h.next;h.next=p.next,p.next=S}c.baseQueue=h=p,a.pending=null}if(h!==null){p=h.next,c=c.baseState;var _=S=null,R=null,k=p;do{var x=k.lane;if((mr&x)===x)R!==null&&(R=R.next={lane:0,action:k.action,hasEagerState:k.hasEagerState,eagerState:k.eagerState,next:null}),c=k.hasEagerState?k.eagerState:n(c,k.action);else{var z={lane:x,action:k.action,hasEagerState:k.hasEagerState,eagerState:k.eagerState,next:null};R===null?(_=R=z,S=c):R=R.next=z,rt.lanes|=x,vr|=x}k=k.next}while(k!==null&&k!==p);R===null?S=c:R.next=_,Cn(c,r.memoizedState)||(Xt=!0),r.memoizedState=c,r.baseState=S,r.baseQueue=R,a.lastRenderedState=c}if(n=a.interleaved,n!==null){h=n;do p=h.lane,rt.lanes|=p,vr|=p,h=h.next;while(h!==n)}else h===null&&(a.lanes=0);return[r.memoizedState,a.dispatch]}function jc(n){var r=gn(),a=r.queue;if(a===null)throw Error(i(311));a.lastRenderedReducer=n;var c=a.dispatch,h=a.pending,p=r.memoizedState;if(h!==null){a.pending=null;var S=h=h.next;do p=n(p,S.action),S=S.next;while(S!==h);Cn(p,r.memoizedState)||(Xt=!0),r.memoizedState=p,r.baseQueue===null&&(r.baseState=p),a.lastRenderedState=p}return[p,c]}function Kg(){}function Zg(n,r){var a=rt,c=gn(),h=r(),p=!Cn(c.memoizedState,h);if(p&&(c.memoizedState=h,Xt=!0),c=c.queue,Vc(Jg.bind(null,a,c,n),[n]),c.getSnapshot!==r||p||St!==null&&St.memoizedState.tag&1){if(a.flags|=2048,Ns(9,Qg.bind(null,a,c,h,r),void 0,null),yt===null)throw Error(i(349));(mr&30)!==0||qg(a,r,h)}return h}function qg(n,r,a){n.flags|=16384,n={getSnapshot:r,value:a},r=rt.updateQueue,r===null?(r={lastEffect:null,stores:null},rt.updateQueue=r,r.stores=[n]):(a=r.stores,a===null?r.stores=[n]:a.push(n))}function Qg(n,r,a,c){r.value=a,r.getSnapshot=c,ep(r)&&tp(n)}function Jg(n,r,a){return a(function(){ep(r)&&tp(n)})}function ep(n){var r=n.getSnapshot;n=n.value;try{var a=r();return!Cn(n,a)}catch{return!0}}function tp(n){var r=si(n,1);r!==null&&On(r,n,1,-1)}function np(n){var r=Vn();return typeof n=="function"&&(n=n()),r.memoizedState=r.baseState=n,n={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Ps,lastRenderedState:n},r.queue=n,n=n.dispatch=oT.bind(null,rt,n),[r.memoizedState,n]}function Ns(n,r,a,c){return n={tag:n,create:r,destroy:a,deps:c,next:null},r=rt.updateQueue,r===null?(r={lastEffect:null,stores:null},rt.updateQueue=r,r.lastEffect=n.next=n):(a=r.lastEffect,a===null?r.lastEffect=n.next=n:(c=a.next,a.next=n,n.next=c,r.lastEffect=n)),n}function ip(){return gn().memoizedState}function dl(n,r,a,c){var h=Vn();rt.flags|=n,h.memoizedState=Ns(1|r,a,void 0,c===void 0?null:c)}function fl(n,r,a,c){var h=gn();c=c===void 0?null:c;var p=void 0;if(ht!==null){var S=ht.memoizedState;if(p=S.destroy,c!==null&&$c(c,S.deps)){h.memoizedState=Ns(r,a,p,c);return}}rt.flags|=n,h.memoizedState=Ns(1|r,a,p,c)}function rp(n,r){return dl(8390656,8,n,r)}function Vc(n,r){return fl(2048,8,n,r)}function op(n,r){return fl(4,2,n,r)}function sp(n,r){return fl(4,4,n,r)}function ap(n,r){if(typeof r=="function")return n=n(),r(n),function(){r(null)};if(r!=null)return n=n(),r.current=n,function(){r.current=null}}function lp(n,r,a){return a=a!=null?a.concat([n]):null,fl(4,4,ap.bind(null,r,n),a)}function Xc(){}function up(n,r){var a=gn();r=r===void 0?null:r;var c=a.memoizedState;return c!==null&&r!==null&&$c(r,c[1])?c[0]:(a.memoizedState=[n,r],n)}function cp(n,r){var a=gn();r=r===void 0?null:r;var c=a.memoizedState;return c!==null&&r!==null&&$c(r,c[1])?c[0]:(n=n(),a.memoizedState=[n,r],n)}function dp(n,r,a){return(mr&21)===0?(n.baseState&&(n.baseState=!1,Xt=!0),n.memoizedState=a):(Cn(a,r)||(a=xh(),rt.lanes|=a,vr|=a,n.baseState=!0),r)}function iT(n,r){var a=We;We=a!==0&&4>a?a:4,n(!0);var c=xc.transition;xc.transition={};try{n(!1),r()}finally{We=a,xc.transition=c}}function fp(){return gn().memoizedState}function rT(n,r,a){var c=Bi(n);if(a={lane:c,action:a,hasEagerState:!1,eagerState:null,next:null},hp(n))gp(r,a);else if(a=Wg(n,r,a,c),a!==null){var h=Ht();On(a,n,c,h),pp(a,r,c)}}function oT(n,r,a){var c=Bi(n),h={lane:c,action:a,hasEagerState:!1,eagerState:null,next:null};if(hp(n))gp(r,h);else{var p=n.alternate;if(n.lanes===0&&(p===null||p.lanes===0)&&(p=r.lastRenderedReducer,p!==null))try{var S=r.lastRenderedState,_=p(S,a);if(h.hasEagerState=!0,h.eagerState=_,Cn(_,S)){var R=r.interleaved;R===null?(h.next=h,Lc(r)):(h.next=R.next,R.next=h),r.interleaved=h;return}}catch{}finally{}a=Wg(n,r,h,c),a!==null&&(h=Ht(),On(a,n,c,h),pp(a,r,c))}}function hp(n){var r=n.alternate;return n===rt||r!==null&&r===rt}function gp(n,r){Cs=cl=!0;var a=n.pending;a===null?r.next=r:(r.next=a.next,a.next=r),n.pending=r}function pp(n,r,a){if((a&4194240)!==0){var c=r.lanes;c&=n.pendingLanes,a|=c,r.lanes=a,Zu(n,a)}}var hl={readContext:hn,useCallback:Dt,useContext:Dt,useEffect:Dt,useImperativeHandle:Dt,useInsertionEffect:Dt,useLayoutEffect:Dt,useMemo:Dt,useReducer:Dt,useRef:Dt,useState:Dt,useDebugValue:Dt,useDeferredValue:Dt,useTransition:Dt,useMutableSource:Dt,useSyncExternalStore:Dt,useId:Dt,unstable_isNewReconciler:!1},sT={readContext:hn,useCallback:function(n,r){return Vn().memoizedState=[n,r===void 0?null:r],n},useContext:hn,useEffect:rp,useImperativeHandle:function(n,r,a){return a=a!=null?a.concat([n]):null,dl(4194308,4,ap.bind(null,r,n),a)},useLayoutEffect:function(n,r){return dl(4194308,4,n,r)},useInsertionEffect:function(n,r){return dl(4,2,n,r)},useMemo:function(n,r){var a=Vn();return r=r===void 0?null:r,n=n(),a.memoizedState=[n,r],n},useReducer:function(n,r,a){var c=Vn();return r=a!==void 0?a(r):r,c.memoizedState=c.baseState=r,n={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:n,lastRenderedState:r},c.queue=n,n=n.dispatch=rT.bind(null,rt,n),[c.memoizedState,n]},useRef:function(n){var r=Vn();return n={current:n},r.memoizedState=n},useState:np,useDebugValue:Xc,useDeferredValue:function(n){return Vn().memoizedState=n},useTransition:function(){var n=np(!1),r=n[0];return n=iT.bind(null,n[1]),Vn().memoizedState=n,[r,n]},useMutableSource:function(){},useSyncExternalStore:function(n,r,a){var c=rt,h=Vn();if(Qe){if(a===void 0)throw Error(i(407));a=a()}else{if(a=r(),yt===null)throw Error(i(349));(mr&30)!==0||qg(c,r,a)}h.memoizedState=a;var p={value:a,getSnapshot:r};return h.queue=p,rp(Jg.bind(null,c,p,n),[n]),c.flags|=2048,Ns(9,Qg.bind(null,c,p,a,r),void 0,null),a},useId:function(){var n=Vn(),r=yt.identifierPrefix;if(Qe){var a=oi,c=ri;a=(c&~(1<<32-_n(c)-1)).toString(32)+a,r=":"+r+"R"+a,a=Rs++,0<a&&(r+="H"+a.toString(32)),r+=":"}else a=nT++,r=":"+r+"r"+a.toString(32)+":";return n.memoizedState=r},unstable_isNewReconciler:!1},aT={readContext:hn,useCallback:up,useContext:hn,useEffect:Vc,useImperativeHandle:lp,useInsertionEffect:op,useLayoutEffect:sp,useMemo:cp,useReducer:Yc,useRef:ip,useState:function(){return Yc(Ps)},useDebugValue:Xc,useDeferredValue:function(n){var r=gn();return dp(r,ht.memoizedState,n)},useTransition:function(){var n=Yc(Ps)[0],r=gn().memoizedState;return[n,r]},useMutableSource:Kg,useSyncExternalStore:Zg,useId:fp,unstable_isNewReconciler:!1},lT={readContext:hn,useCallback:up,useContext:hn,useEffect:Vc,useImperativeHandle:lp,useInsertionEffect:op,useLayoutEffect:sp,useMemo:cp,useReducer:jc,useRef:ip,useState:function(){return jc(Ps)},useDebugValue:Xc,useDeferredValue:function(n){var r=gn();return ht===null?r.memoizedState=n:dp(r,ht.memoizedState,n)},useTransition:function(){var n=jc(Ps)[0],r=gn().memoizedState;return[n,r]},useMutableSource:Kg,useSyncExternalStore:Zg,useId:fp,unstable_isNewReconciler:!1};function Pn(n,r){if(n&&n.defaultProps){r=j({},r),n=n.defaultProps;for(var a in n)r[a]===void 0&&(r[a]=n[a]);return r}return r}function Kc(n,r,a,c){r=n.memoizedState,a=a(c,r),a=a==null?r:j({},r,a),n.memoizedState=a,n.lanes===0&&(n.updateQueue.baseState=a)}var gl={isMounted:function(n){return(n=n._reactInternals)?ur(n)===n:!1},enqueueSetState:function(n,r,a){n=n._reactInternals;var c=Ht(),h=Bi(n),p=ai(c,h);p.payload=r,a!=null&&(p.callback=a),r=ki(n,p,h),r!==null&&(On(r,n,h,c),sl(r,n,h))},enqueueReplaceState:function(n,r,a){n=n._reactInternals;var c=Ht(),h=Bi(n),p=ai(c,h);p.tag=1,p.payload=r,a!=null&&(p.callback=a),r=ki(n,p,h),r!==null&&(On(r,n,h,c),sl(r,n,h))},enqueueForceUpdate:function(n,r){n=n._reactInternals;var a=Ht(),c=Bi(n),h=ai(a,c);h.tag=2,r!=null&&(h.callback=r),r=ki(n,h,c),r!==null&&(On(r,n,c,a),sl(r,n,c))}};function mp(n,r,a,c,h,p,S){return n=n.stateNode,typeof n.shouldComponentUpdate=="function"?n.shouldComponentUpdate(c,p,S):r.prototype&&r.prototype.isPureReactComponent?!ps(a,c)||!ps(h,p):!0}function vp(n,r,a){var c=!1,h=Di,p=r.contextType;return typeof p=="object"&&p!==null?p=hn(p):(h=Vt(r)?dr:Nt.current,c=r.contextTypes,p=(c=c!=null)?no(n,h):Di),r=new r(a,p),n.memoizedState=r.state!==null&&r.state!==void 0?r.state:null,r.updater=gl,n.stateNode=r,r._reactInternals=n,c&&(n=n.stateNode,n.__reactInternalMemoizedUnmaskedChildContext=h,n.__reactInternalMemoizedMaskedChildContext=p),r}function Sp(n,r,a,c){n=r.state,typeof r.componentWillReceiveProps=="function"&&r.componentWillReceiveProps(a,c),typeof r.UNSAFE_componentWillReceiveProps=="function"&&r.UNSAFE_componentWillReceiveProps(a,c),r.state!==n&&gl.enqueueReplaceState(r,r.state,null)}function Zc(n,r,a,c){var h=n.stateNode;h.props=a,h.state=n.memoizedState,h.refs={},Uc(n);var p=r.contextType;typeof p=="object"&&p!==null?h.context=hn(p):(p=Vt(r)?dr:Nt.current,h.context=no(n,p)),h.state=n.memoizedState,p=r.getDerivedStateFromProps,typeof p=="function"&&(Kc(n,r,p,a),h.state=n.memoizedState),typeof r.getDerivedStateFromProps=="function"||typeof h.getSnapshotBeforeUpdate=="function"||typeof h.UNSAFE_componentWillMount!="function"&&typeof h.componentWillMount!="function"||(r=h.state,typeof h.componentWillMount=="function"&&h.componentWillMount(),typeof h.UNSAFE_componentWillMount=="function"&&h.UNSAFE_componentWillMount(),r!==h.state&&gl.enqueueReplaceState(h,h.state,null),al(n,a,h,c),h.state=n.memoizedState),typeof h.componentDidMount=="function"&&(n.flags|=4194308)}function co(n,r){try{var a="",c=r;do a+=Se(c),c=c.return;while(c);var h=a}catch(p){h=`
Error generating stack: `+p.message+`
`+p.stack}return{value:n,source:r,stack:h,digest:null}}function qc(n,r,a){return{value:n,source:null,stack:a??null,digest:r??null}}function Qc(n,r){try{console.error(r.value)}catch(a){setTimeout(function(){throw a})}}var uT=typeof WeakMap=="function"?WeakMap:Map;function yp(n,r,a){a=ai(-1,a),a.tag=3,a.payload={element:null};var c=r.value;return a.callback=function(){Al||(Al=!0,hd=c),Qc(n,r)},a}function Tp(n,r,a){a=ai(-1,a),a.tag=3;var c=n.type.getDerivedStateFromError;if(typeof c=="function"){var h=r.value;a.payload=function(){return c(h)},a.callback=function(){Qc(n,r)}}var p=n.stateNode;return p!==null&&typeof p.componentDidCatch=="function"&&(a.callback=function(){Qc(n,r),typeof c!="function"&&(Li===null?Li=new Set([this]):Li.add(this));var S=r.stack;this.componentDidCatch(r.value,{componentStack:S!==null?S:""})}),a}function Ap(n,r,a){var c=n.pingCache;if(c===null){c=n.pingCache=new uT;var h=new Set;c.set(r,h)}else h=c.get(r),h===void 0&&(h=new Set,c.set(r,h));h.has(a)||(h.add(a),n=ET.bind(null,n,r,a),r.then(n,n))}function Ip(n){do{var r;if((r=n.tag===13)&&(r=n.memoizedState,r=r!==null?r.dehydrated!==null:!0),r)return n;n=n.return}while(n!==null);return null}function Ep(n,r,a,c,h){return(n.mode&1)===0?(n===r?n.flags|=65536:(n.flags|=128,a.flags|=131072,a.flags&=-52805,a.tag===1&&(a.alternate===null?a.tag=17:(r=ai(-1,1),r.tag=2,ki(a,r,1))),a.lanes|=1),n):(n.flags|=65536,n.lanes=h,n)}var cT=H.ReactCurrentOwner,Xt=!1;function Bt(n,r,a,c){r.child=n===null?zg(r,null,a,c):so(r,n.child,a,c)}function wp(n,r,a,c,h){a=a.render;var p=r.ref;return lo(r,h),c=zc(n,r,a,c,p,h),a=Wc(),n!==null&&!Xt?(r.updateQueue=n.updateQueue,r.flags&=-2053,n.lanes&=~h,li(n,r,h)):(Qe&&a&&Cc(r),r.flags|=1,Bt(n,r,c,h),r.child)}function _p(n,r,a,c,h){if(n===null){var p=a.type;return typeof p=="function"&&!Td(p)&&p.defaultProps===void 0&&a.compare===null&&a.defaultProps===void 0?(r.tag=15,r.type=p,Cp(n,r,p,c,h)):(n=Rl(a.type,null,c,r,r.mode,h),n.ref=r.ref,n.return=r,r.child=n)}if(p=n.child,(n.lanes&h)===0){var S=p.memoizedProps;if(a=a.compare,a=a!==null?a:ps,a(S,c)&&n.ref===r.ref)return li(n,r,h)}return r.flags|=1,n=bi(p,c),n.ref=r.ref,n.return=r,r.child=n}function Cp(n,r,a,c,h){if(n!==null){var p=n.memoizedProps;if(ps(p,c)&&n.ref===r.ref)if(Xt=!1,r.pendingProps=c=p,(n.lanes&h)!==0)(n.flags&131072)!==0&&(Xt=!0);else return r.lanes=n.lanes,li(n,r,h)}return Jc(n,r,a,c,h)}function Rp(n,r,a){var c=r.pendingProps,h=c.children,p=n!==null?n.memoizedState:null;if(c.mode==="hidden")if((r.mode&1)===0)r.memoizedState={baseLanes:0,cachePool:null,transitions:null},Ye(ho,nn),nn|=a;else{if((a&1073741824)===0)return n=p!==null?p.baseLanes|a:a,r.lanes=r.childLanes=1073741824,r.memoizedState={baseLanes:n,cachePool:null,transitions:null},r.updateQueue=null,Ye(ho,nn),nn|=n,null;r.memoizedState={baseLanes:0,cachePool:null,transitions:null},c=p!==null?p.baseLanes:a,Ye(ho,nn),nn|=c}else p!==null?(c=p.baseLanes|a,r.memoizedState=null):c=a,Ye(ho,nn),nn|=c;return Bt(n,r,h,a),r.child}function Pp(n,r){var a=r.ref;(n===null&&a!==null||n!==null&&n.ref!==a)&&(r.flags|=512,r.flags|=2097152)}function Jc(n,r,a,c,h){var p=Vt(a)?dr:Nt.current;return p=no(r,p),lo(r,h),a=zc(n,r,a,c,p,h),c=Wc(),n!==null&&!Xt?(r.updateQueue=n.updateQueue,r.flags&=-2053,n.lanes&=~h,li(n,r,h)):(Qe&&c&&Cc(r),r.flags|=1,Bt(n,r,a,h),r.child)}function Np(n,r,a,c,h){if(Vt(a)){var p=!0;Qa(r)}else p=!1;if(lo(r,h),r.stateNode===null)ml(n,r),vp(r,a,c),Zc(r,a,c,h),c=!0;else if(n===null){var S=r.stateNode,_=r.memoizedProps;S.props=_;var R=S.context,k=a.contextType;typeof k=="object"&&k!==null?k=hn(k):(k=Vt(a)?dr:Nt.current,k=no(r,k));var x=a.getDerivedStateFromProps,z=typeof x=="function"||typeof S.getSnapshotBeforeUpdate=="function";z||typeof S.UNSAFE_componentWillReceiveProps!="function"&&typeof S.componentWillReceiveProps!="function"||(_!==c||R!==k)&&Sp(r,S,c,k),Mi=!1;var G=r.memoizedState;S.state=G,al(r,c,S,h),R=r.memoizedState,_!==c||G!==R||jt.current||Mi?(typeof x=="function"&&(Kc(r,a,x,c),R=r.memoizedState),(_=Mi||mp(r,a,_,c,G,R,k))?(z||typeof S.UNSAFE_componentWillMount!="function"&&typeof S.componentWillMount!="function"||(typeof S.componentWillMount=="function"&&S.componentWillMount(),typeof S.UNSAFE_componentWillMount=="function"&&S.UNSAFE_componentWillMount()),typeof S.componentDidMount=="function"&&(r.flags|=4194308)):(typeof S.componentDidMount=="function"&&(r.flags|=4194308),r.memoizedProps=c,r.memoizedState=R),S.props=c,S.state=R,S.context=k,c=_):(typeof S.componentDidMount=="function"&&(r.flags|=4194308),c=!1)}else{S=r.stateNode,Yg(n,r),_=r.memoizedProps,k=r.type===r.elementType?_:Pn(r.type,_),S.props=k,z=r.pendingProps,G=S.context,R=a.contextType,typeof R=="object"&&R!==null?R=hn(R):(R=Vt(a)?dr:Nt.current,R=no(r,R));var q=a.getDerivedStateFromProps;(x=typeof q=="function"||typeof S.getSnapshotBeforeUpdate=="function")||typeof S.UNSAFE_componentWillReceiveProps!="function"&&typeof S.componentWillReceiveProps!="function"||(_!==z||G!==R)&&Sp(r,S,c,R),Mi=!1,G=r.memoizedState,S.state=G,al(r,c,S,h);var te=r.memoizedState;_!==z||G!==te||jt.current||Mi?(typeof q=="function"&&(Kc(r,a,q,c),te=r.memoizedState),(k=Mi||mp(r,a,k,c,G,te,R)||!1)?(x||typeof S.UNSAFE_componentWillUpdate!="function"&&typeof S.componentWillUpdate!="function"||(typeof S.componentWillUpdate=="function"&&S.componentWillUpdate(c,te,R),typeof S.UNSAFE_componentWillUpdate=="function"&&S.UNSAFE_componentWillUpdate(c,te,R)),typeof S.componentDidUpdate=="function"&&(r.flags|=4),typeof S.getSnapshotBeforeUpdate=="function"&&(r.flags|=1024)):(typeof S.componentDidUpdate!="function"||_===n.memoizedProps&&G===n.memoizedState||(r.flags|=4),typeof S.getSnapshotBeforeUpdate!="function"||_===n.memoizedProps&&G===n.memoizedState||(r.flags|=1024),r.memoizedProps=c,r.memoizedState=te),S.props=c,S.state=te,S.context=R,c=k):(typeof S.componentDidUpdate!="function"||_===n.memoizedProps&&G===n.memoizedState||(r.flags|=4),typeof S.getSnapshotBeforeUpdate!="function"||_===n.memoizedProps&&G===n.memoizedState||(r.flags|=1024),c=!1)}return ed(n,r,a,c,p,h)}function ed(n,r,a,c,h,p){Pp(n,r);var S=(r.flags&128)!==0;if(!c&&!S)return h&&Fg(r,a,!1),li(n,r,p);c=r.stateNode,cT.current=r;var _=S&&typeof a.getDerivedStateFromError!="function"?null:c.render();return r.flags|=1,n!==null&&S?(r.child=so(r,n.child,null,p),r.child=so(r,null,_,p)):Bt(n,r,_,p),r.memoizedState=c.state,h&&Fg(r,a,!0),r.child}function Dp(n){var r=n.stateNode;r.pendingContext?Mg(n,r.pendingContext,r.pendingContext!==r.context):r.context&&Mg(n,r.context,!1),Bc(n,r.containerInfo)}function Op(n,r,a,c,h){return oo(),Dc(h),r.flags|=256,Bt(n,r,a,c),r.child}var td={dehydrated:null,treeContext:null,retryLane:0};function nd(n){return{baseLanes:n,cachePool:null,transitions:null}}function Mp(n,r,a){var c=r.pendingProps,h=it.current,p=!1,S=(r.flags&128)!==0,_;if((_=S)||(_=n!==null&&n.memoizedState===null?!1:(h&2)!==0),_?(p=!0,r.flags&=-129):(n===null||n.memoizedState!==null)&&(h|=1),Ye(it,h&1),n===null)return Nc(r),n=r.memoizedState,n!==null&&(n=n.dehydrated,n!==null)?((r.mode&1)===0?r.lanes=1:n.data==="$!"?r.lanes=8:r.lanes=1073741824,null):(S=c.children,n=c.fallback,p?(c=r.mode,p=r.child,S={mode:"hidden",children:S},(c&1)===0&&p!==null?(p.childLanes=0,p.pendingProps=S):p=Pl(S,c,0,null),n=Ar(n,c,a,null),p.return=r,n.return=r,p.sibling=n,r.child=p,r.child.memoizedState=nd(a),r.memoizedState=td,n):id(r,S));if(h=n.memoizedState,h!==null&&(_=h.dehydrated,_!==null))return dT(n,r,S,c,_,h,a);if(p){p=c.fallback,S=r.mode,h=n.child,_=h.sibling;var R={mode:"hidden",children:c.children};return(S&1)===0&&r.child!==h?(c=r.child,c.childLanes=0,c.pendingProps=R,r.deletions=null):(c=bi(h,R),c.subtreeFlags=h.subtreeFlags&14680064),_!==null?p=bi(_,p):(p=Ar(p,S,a,null),p.flags|=2),p.return=r,c.return=r,c.sibling=p,r.child=c,c=p,p=r.child,S=n.child.memoizedState,S=S===null?nd(a):{baseLanes:S.baseLanes|a,cachePool:null,transitions:S.transitions},p.memoizedState=S,p.childLanes=n.childLanes&~a,r.memoizedState=td,c}return p=n.child,n=p.sibling,c=bi(p,{mode:"visible",children:c.children}),(r.mode&1)===0&&(c.lanes=a),c.return=r,c.sibling=null,n!==null&&(a=r.deletions,a===null?(r.deletions=[n],r.flags|=16):a.push(n)),r.child=c,r.memoizedState=null,c}function id(n,r){return r=Pl({mode:"visible",children:r},n.mode,0,null),r.return=n,n.child=r}function pl(n,r,a,c){return c!==null&&Dc(c),so(r,n.child,null,a),n=id(r,r.pendingProps.children),n.flags|=2,r.memoizedState=null,n}function dT(n,r,a,c,h,p,S){if(a)return r.flags&256?(r.flags&=-257,c=qc(Error(i(422))),pl(n,r,S,c)):r.memoizedState!==null?(r.child=n.child,r.flags|=128,null):(p=c.fallback,h=r.mode,c=Pl({mode:"visible",children:c.children},h,0,null),p=Ar(p,h,S,null),p.flags|=2,c.return=r,p.return=r,c.sibling=p,r.child=c,(r.mode&1)!==0&&so(r,n.child,null,S),r.child.memoizedState=nd(S),r.memoizedState=td,p);if((r.mode&1)===0)return pl(n,r,S,null);if(h.data==="$!"){if(c=h.nextSibling&&h.nextSibling.dataset,c)var _=c.dgst;return c=_,p=Error(i(419)),c=qc(p,c,void 0),pl(n,r,S,c)}if(_=(S&n.childLanes)!==0,Xt||_){if(c=yt,c!==null){switch(S&-S){case 4:h=2;break;case 16:h=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:h=32;break;case 536870912:h=268435456;break;default:h=0}h=(h&(c.suspendedLanes|S))!==0?0:h,h!==0&&h!==p.retryLane&&(p.retryLane=h,si(n,h),On(c,n,h,-1))}return yd(),c=qc(Error(i(421))),pl(n,r,S,c)}return h.data==="$?"?(r.flags|=128,r.child=n.child,r=wT.bind(null,n),h._reactRetry=r,null):(n=p.treeContext,tn=Pi(h.nextSibling),en=r,Qe=!0,Rn=null,n!==null&&(dn[fn++]=ri,dn[fn++]=oi,dn[fn++]=fr,ri=n.id,oi=n.overflow,fr=r),r=id(r,c.children),r.flags|=4096,r)}function kp(n,r,a){n.lanes|=r;var c=n.alternate;c!==null&&(c.lanes|=r),Fc(n.return,r,a)}function rd(n,r,a,c,h){var p=n.memoizedState;p===null?n.memoizedState={isBackwards:r,rendering:null,renderingStartTime:0,last:c,tail:a,tailMode:h}:(p.isBackwards=r,p.rendering=null,p.renderingStartTime=0,p.last=c,p.tail=a,p.tailMode=h)}function Fp(n,r,a){var c=r.pendingProps,h=c.revealOrder,p=c.tail;if(Bt(n,r,c.children,a),c=it.current,(c&2)!==0)c=c&1|2,r.flags|=128;else{if(n!==null&&(n.flags&128)!==0)e:for(n=r.child;n!==null;){if(n.tag===13)n.memoizedState!==null&&kp(n,a,r);else if(n.tag===19)kp(n,a,r);else if(n.child!==null){n.child.return=n,n=n.child;continue}if(n===r)break e;for(;n.sibling===null;){if(n.return===null||n.return===r)break e;n=n.return}n.sibling.return=n.return,n=n.sibling}c&=1}if(Ye(it,c),(r.mode&1)===0)r.memoizedState=null;else switch(h){case"forwards":for(a=r.child,h=null;a!==null;)n=a.alternate,n!==null&&ll(n)===null&&(h=a),a=a.sibling;a=h,a===null?(h=r.child,r.child=null):(h=a.sibling,a.sibling=null),rd(r,!1,h,a,p);break;case"backwards":for(a=null,h=r.child,r.child=null;h!==null;){if(n=h.alternate,n!==null&&ll(n)===null){r.child=h;break}n=h.sibling,h.sibling=a,a=h,h=n}rd(r,!0,a,null,p);break;case"together":rd(r,!1,null,null,void 0);break;default:r.memoizedState=null}return r.child}function ml(n,r){(r.mode&1)===0&&n!==null&&(n.alternate=null,r.alternate=null,r.flags|=2)}function li(n,r,a){if(n!==null&&(r.dependencies=n.dependencies),vr|=r.lanes,(a&r.childLanes)===0)return null;if(n!==null&&r.child!==n.child)throw Error(i(153));if(r.child!==null){for(n=r.child,a=bi(n,n.pendingProps),r.child=a,a.return=r;n.sibling!==null;)n=n.sibling,a=a.sibling=bi(n,n.pendingProps),a.return=r;a.sibling=null}return r.child}function fT(n,r,a){switch(r.tag){case 3:Dp(r),oo();break;case 5:Xg(r);break;case 1:Vt(r.type)&&Qa(r);break;case 4:Bc(r,r.stateNode.containerInfo);break;case 10:var c=r.type._context,h=r.memoizedProps.value;Ye(rl,c._currentValue),c._currentValue=h;break;case 13:if(c=r.memoizedState,c!==null)return c.dehydrated!==null?(Ye(it,it.current&1),r.flags|=128,null):(a&r.child.childLanes)!==0?Mp(n,r,a):(Ye(it,it.current&1),n=li(n,r,a),n!==null?n.sibling:null);Ye(it,it.current&1);break;case 19:if(c=(a&r.childLanes)!==0,(n.flags&128)!==0){if(c)return Fp(n,r,a);r.flags|=128}if(h=r.memoizedState,h!==null&&(h.rendering=null,h.tail=null,h.lastEffect=null),Ye(it,it.current),c)break;return null;case 22:case 23:return r.lanes=0,Rp(n,r,a)}return li(n,r,a)}var Lp,od,Up,Bp;Lp=function(n,r){for(var a=r.child;a!==null;){if(a.tag===5||a.tag===6)n.appendChild(a.stateNode);else if(a.tag!==4&&a.child!==null){a.child.return=a,a=a.child;continue}if(a===r)break;for(;a.sibling===null;){if(a.return===null||a.return===r)return;a=a.return}a.sibling.return=a.return,a=a.sibling}},od=function(){},Up=function(n,r,a,c){var h=n.memoizedProps;if(h!==c){n=r.stateNode,pr(jn.current);var p=null;switch(a){case"input":h=qe(n,h),c=qe(n,c),p=[];break;case"select":h=j({},h,{value:void 0}),c=j({},c,{value:void 0}),p=[];break;case"textarea":h=lr(n,h),c=lr(n,c),p=[];break;default:typeof h.onClick!="function"&&typeof c.onClick=="function"&&(n.onclick=Ka)}bu(a,c);var S;a=null;for(k in h)if(!c.hasOwnProperty(k)&&h.hasOwnProperty(k)&&h[k]!=null)if(k==="style"){var _=h[k];for(S in _)_.hasOwnProperty(S)&&(a||(a={}),a[S]="")}else k!=="dangerouslySetInnerHTML"&&k!=="children"&&k!=="suppressContentEditableWarning"&&k!=="suppressHydrationWarning"&&k!=="autoFocus"&&(l.hasOwnProperty(k)?p||(p=[]):(p=p||[]).push(k,null));for(k in c){var R=c[k];if(_=h!=null?h[k]:void 0,c.hasOwnProperty(k)&&R!==_&&(R!=null||_!=null))if(k==="style")if(_){for(S in _)!_.hasOwnProperty(S)||R&&R.hasOwnProperty(S)||(a||(a={}),a[S]="");for(S in R)R.hasOwnProperty(S)&&_[S]!==R[S]&&(a||(a={}),a[S]=R[S])}else a||(p||(p=[]),p.push(k,a)),a=R;else k==="dangerouslySetInnerHTML"?(R=R?R.__html:void 0,_=_?_.__html:void 0,R!=null&&_!==R&&(p=p||[]).push(k,R)):k==="children"?typeof R!="string"&&typeof R!="number"||(p=p||[]).push(k,""+R):k!=="suppressContentEditableWarning"&&k!=="suppressHydrationWarning"&&(l.hasOwnProperty(k)?(R!=null&&k==="onScroll"&&Xe("scroll",n),p||_===R||(p=[])):(p=p||[]).push(k,R))}a&&(p=p||[]).push("style",a);var k=p;(r.updateQueue=k)&&(r.flags|=4)}},Bp=function(n,r,a,c){a!==c&&(r.flags|=4)};function Ds(n,r){if(!Qe)switch(n.tailMode){case"hidden":r=n.tail;for(var a=null;r!==null;)r.alternate!==null&&(a=r),r=r.sibling;a===null?n.tail=null:a.sibling=null;break;case"collapsed":a=n.tail;for(var c=null;a!==null;)a.alternate!==null&&(c=a),a=a.sibling;c===null?r||n.tail===null?n.tail=null:n.tail.sibling=null:c.sibling=null}}function Ot(n){var r=n.alternate!==null&&n.alternate.child===n.child,a=0,c=0;if(r)for(var h=n.child;h!==null;)a|=h.lanes|h.childLanes,c|=h.subtreeFlags&14680064,c|=h.flags&14680064,h.return=n,h=h.sibling;else for(h=n.child;h!==null;)a|=h.lanes|h.childLanes,c|=h.subtreeFlags,c|=h.flags,h.return=n,h=h.sibling;return n.subtreeFlags|=c,n.childLanes=a,r}function hT(n,r,a){var c=r.pendingProps;switch(Rc(r),r.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Ot(r),null;case 1:return Vt(r.type)&&qa(),Ot(r),null;case 3:return c=r.stateNode,uo(),Ke(jt),Ke(Nt),Gc(),c.pendingContext&&(c.context=c.pendingContext,c.pendingContext=null),(n===null||n.child===null)&&(nl(r)?r.flags|=4:n===null||n.memoizedState.isDehydrated&&(r.flags&256)===0||(r.flags|=1024,Rn!==null&&(md(Rn),Rn=null))),od(n,r),Ot(r),null;case 5:Hc(r);var h=pr(_s.current);if(a=r.type,n!==null&&r.stateNode!=null)Up(n,r,a,c,h),n.ref!==r.ref&&(r.flags|=512,r.flags|=2097152);else{if(!c){if(r.stateNode===null)throw Error(i(166));return Ot(r),null}if(n=pr(jn.current),nl(r)){c=r.stateNode,a=r.type;var p=r.memoizedProps;switch(c[Yn]=r,c[Ts]=p,n=(r.mode&1)!==0,a){case"dialog":Xe("cancel",c),Xe("close",c);break;case"iframe":case"object":case"embed":Xe("load",c);break;case"video":case"audio":for(h=0;h<vs.length;h++)Xe(vs[h],c);break;case"source":Xe("error",c);break;case"img":case"image":case"link":Xe("error",c),Xe("load",c);break;case"details":Xe("toggle",c);break;case"input":Ve(c,p),Xe("invalid",c);break;case"select":c._wrapperState={wasMultiple:!!p.multiple},Xe("invalid",c);break;case"textarea":Th(c,p),Xe("invalid",c)}bu(a,p),h=null;for(var S in p)if(p.hasOwnProperty(S)){var _=p[S];S==="children"?typeof _=="string"?c.textContent!==_&&(p.suppressHydrationWarning!==!0&&Xa(c.textContent,_,n),h=["children",_]):typeof _=="number"&&c.textContent!==""+_&&(p.suppressHydrationWarning!==!0&&Xa(c.textContent,_,n),h=["children",""+_]):l.hasOwnProperty(S)&&_!=null&&S==="onScroll"&&Xe("scroll",c)}switch(a){case"input":Ue(c),cn(c,p,!0);break;case"textarea":Ue(c),Ih(c);break;case"select":case"option":break;default:typeof p.onClick=="function"&&(c.onclick=Ka)}c=h,r.updateQueue=c,c!==null&&(r.flags|=4)}else{S=h.nodeType===9?h:h.ownerDocument,n==="http://www.w3.org/1999/xhtml"&&(n=Eh(a)),n==="http://www.w3.org/1999/xhtml"?a==="script"?(n=S.createElement("div"),n.innerHTML="<script><\/script>",n=n.removeChild(n.firstChild)):typeof c.is=="string"?n=S.createElement(a,{is:c.is}):(n=S.createElement(a),a==="select"&&(S=n,c.multiple?S.multiple=!0:c.size&&(S.size=c.size))):n=S.createElementNS(n,a),n[Yn]=r,n[Ts]=c,Lp(n,r,!1,!1),r.stateNode=n;e:{switch(S=Gu(a,c),a){case"dialog":Xe("cancel",n),Xe("close",n),h=c;break;case"iframe":case"object":case"embed":Xe("load",n),h=c;break;case"video":case"audio":for(h=0;h<vs.length;h++)Xe(vs[h],n);h=c;break;case"source":Xe("error",n),h=c;break;case"img":case"image":case"link":Xe("error",n),Xe("load",n),h=c;break;case"details":Xe("toggle",n),h=c;break;case"input":Ve(n,c),h=qe(n,c),Xe("invalid",n);break;case"option":h=c;break;case"select":n._wrapperState={wasMultiple:!!c.multiple},h=j({},c,{value:void 0}),Xe("invalid",n);break;case"textarea":Th(n,c),h=lr(n,c),Xe("invalid",n);break;default:h=c}bu(a,h),_=h;for(p in _)if(_.hasOwnProperty(p)){var R=_[p];p==="style"?Ch(n,R):p==="dangerouslySetInnerHTML"?(R=R?R.__html:void 0,R!=null&&wh(n,R)):p==="children"?typeof R=="string"?(a!=="textarea"||R!=="")&&Qo(n,R):typeof R=="number"&&Qo(n,""+R):p!=="suppressContentEditableWarning"&&p!=="suppressHydrationWarning"&&p!=="autoFocus"&&(l.hasOwnProperty(p)?R!=null&&p==="onScroll"&&Xe("scroll",n):R!=null&&D(n,p,R,S))}switch(a){case"input":Ue(n),cn(n,c,!1);break;case"textarea":Ue(n),Ih(n);break;case"option":c.value!=null&&n.setAttribute("value",""+Ae(c.value));break;case"select":n.multiple=!!c.multiple,p=c.value,p!=null?Ai(n,!!c.multiple,p,!1):c.defaultValue!=null&&Ai(n,!!c.multiple,c.defaultValue,!0);break;default:typeof h.onClick=="function"&&(n.onclick=Ka)}switch(a){case"button":case"input":case"select":case"textarea":c=!!c.autoFocus;break e;case"img":c=!0;break e;default:c=!1}}c&&(r.flags|=4)}r.ref!==null&&(r.flags|=512,r.flags|=2097152)}return Ot(r),null;case 6:if(n&&r.stateNode!=null)Bp(n,r,n.memoizedProps,c);else{if(typeof c!="string"&&r.stateNode===null)throw Error(i(166));if(a=pr(_s.current),pr(jn.current),nl(r)){if(c=r.stateNode,a=r.memoizedProps,c[Yn]=r,(p=c.nodeValue!==a)&&(n=en,n!==null))switch(n.tag){case 3:Xa(c.nodeValue,a,(n.mode&1)!==0);break;case 5:n.memoizedProps.suppressHydrationWarning!==!0&&Xa(c.nodeValue,a,(n.mode&1)!==0)}p&&(r.flags|=4)}else c=(a.nodeType===9?a:a.ownerDocument).createTextNode(c),c[Yn]=r,r.stateNode=c}return Ot(r),null;case 13:if(Ke(it),c=r.memoizedState,n===null||n.memoizedState!==null&&n.memoizedState.dehydrated!==null){if(Qe&&tn!==null&&(r.mode&1)!==0&&(r.flags&128)===0)Gg(),oo(),r.flags|=98560,p=!1;else if(p=nl(r),c!==null&&c.dehydrated!==null){if(n===null){if(!p)throw Error(i(318));if(p=r.memoizedState,p=p!==null?p.dehydrated:null,!p)throw Error(i(317));p[Yn]=r}else oo(),(r.flags&128)===0&&(r.memoizedState=null),r.flags|=4;Ot(r),p=!1}else Rn!==null&&(md(Rn),Rn=null),p=!0;if(!p)return r.flags&65536?r:null}return(r.flags&128)!==0?(r.lanes=a,r):(c=c!==null,c!==(n!==null&&n.memoizedState!==null)&&c&&(r.child.flags|=8192,(r.mode&1)!==0&&(n===null||(it.current&1)!==0?gt===0&&(gt=3):yd())),r.updateQueue!==null&&(r.flags|=4),Ot(r),null);case 4:return uo(),od(n,r),n===null&&Ss(r.stateNode.containerInfo),Ot(r),null;case 10:return kc(r.type._context),Ot(r),null;case 17:return Vt(r.type)&&qa(),Ot(r),null;case 19:if(Ke(it),p=r.memoizedState,p===null)return Ot(r),null;if(c=(r.flags&128)!==0,S=p.rendering,S===null)if(c)Ds(p,!1);else{if(gt!==0||n!==null&&(n.flags&128)!==0)for(n=r.child;n!==null;){if(S=ll(n),S!==null){for(r.flags|=128,Ds(p,!1),c=S.updateQueue,c!==null&&(r.updateQueue=c,r.flags|=4),r.subtreeFlags=0,c=a,a=r.child;a!==null;)p=a,n=c,p.flags&=14680066,S=p.alternate,S===null?(p.childLanes=0,p.lanes=n,p.child=null,p.subtreeFlags=0,p.memoizedProps=null,p.memoizedState=null,p.updateQueue=null,p.dependencies=null,p.stateNode=null):(p.childLanes=S.childLanes,p.lanes=S.lanes,p.child=S.child,p.subtreeFlags=0,p.deletions=null,p.memoizedProps=S.memoizedProps,p.memoizedState=S.memoizedState,p.updateQueue=S.updateQueue,p.type=S.type,n=S.dependencies,p.dependencies=n===null?null:{lanes:n.lanes,firstContext:n.firstContext}),a=a.sibling;return Ye(it,it.current&1|2),r.child}n=n.sibling}p.tail!==null&&at()>go&&(r.flags|=128,c=!0,Ds(p,!1),r.lanes=4194304)}else{if(!c)if(n=ll(S),n!==null){if(r.flags|=128,c=!0,a=n.updateQueue,a!==null&&(r.updateQueue=a,r.flags|=4),Ds(p,!0),p.tail===null&&p.tailMode==="hidden"&&!S.alternate&&!Qe)return Ot(r),null}else 2*at()-p.renderingStartTime>go&&a!==1073741824&&(r.flags|=128,c=!0,Ds(p,!1),r.lanes=4194304);p.isBackwards?(S.sibling=r.child,r.child=S):(a=p.last,a!==null?a.sibling=S:r.child=S,p.last=S)}return p.tail!==null?(r=p.tail,p.rendering=r,p.tail=r.sibling,p.renderingStartTime=at(),r.sibling=null,a=it.current,Ye(it,c?a&1|2:a&1),r):(Ot(r),null);case 22:case 23:return Sd(),c=r.memoizedState!==null,n!==null&&n.memoizedState!==null!==c&&(r.flags|=8192),c&&(r.mode&1)!==0?(nn&1073741824)!==0&&(Ot(r),r.subtreeFlags&6&&(r.flags|=8192)):Ot(r),null;case 24:return null;case 25:return null}throw Error(i(156,r.tag))}function gT(n,r){switch(Rc(r),r.tag){case 1:return Vt(r.type)&&qa(),n=r.flags,n&65536?(r.flags=n&-65537|128,r):null;case 3:return uo(),Ke(jt),Ke(Nt),Gc(),n=r.flags,(n&65536)!==0&&(n&128)===0?(r.flags=n&-65537|128,r):null;case 5:return Hc(r),null;case 13:if(Ke(it),n=r.memoizedState,n!==null&&n.dehydrated!==null){if(r.alternate===null)throw Error(i(340));oo()}return n=r.flags,n&65536?(r.flags=n&-65537|128,r):null;case 19:return Ke(it),null;case 4:return uo(),null;case 10:return kc(r.type._context),null;case 22:case 23:return Sd(),null;case 24:return null;default:return null}}var vl=!1,Mt=!1,pT=typeof WeakSet=="function"?WeakSet:Set,J=null;function fo(n,r){var a=n.ref;if(a!==null)if(typeof a=="function")try{a(null)}catch(c){ot(n,r,c)}else a.current=null}function sd(n,r,a){try{a()}catch(c){ot(n,r,c)}}var Hp=!1;function mT(n,r){if(Sc=Ba,n=mg(),cc(n)){if("selectionStart"in n)var a={start:n.selectionStart,end:n.selectionEnd};else e:{a=(a=n.ownerDocument)&&a.defaultView||window;var c=a.getSelection&&a.getSelection();if(c&&c.rangeCount!==0){a=c.anchorNode;var h=c.anchorOffset,p=c.focusNode;c=c.focusOffset;try{a.nodeType,p.nodeType}catch{a=null;break e}var S=0,_=-1,R=-1,k=0,x=0,z=n,G=null;t:for(;;){for(var q;z!==a||h!==0&&z.nodeType!==3||(_=S+h),z!==p||c!==0&&z.nodeType!==3||(R=S+c),z.nodeType===3&&(S+=z.nodeValue.length),(q=z.firstChild)!==null;)G=z,z=q;for(;;){if(z===n)break t;if(G===a&&++k===h&&(_=S),G===p&&++x===c&&(R=S),(q=z.nextSibling)!==null)break;z=G,G=z.parentNode}z=q}a=_===-1||R===-1?null:{start:_,end:R}}else a=null}a=a||{start:0,end:0}}else a=null;for(yc={focusedElem:n,selectionRange:a},Ba=!1,J=r;J!==null;)if(r=J,n=r.child,(r.subtreeFlags&1028)!==0&&n!==null)n.return=r,J=n;else for(;J!==null;){r=J;try{var te=r.alternate;if((r.flags&1024)!==0)switch(r.tag){case 0:case 11:case 15:break;case 1:if(te!==null){var se=te.memoizedProps,lt=te.memoizedState,O=r.stateNode,N=O.getSnapshotBeforeUpdate(r.elementType===r.type?se:Pn(r.type,se),lt);O.__reactInternalSnapshotBeforeUpdate=N}break;case 3:var M=r.stateNode.containerInfo;M.nodeType===1?M.textContent="":M.nodeType===9&&M.documentElement&&M.removeChild(M.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(i(163))}}catch(V){ot(r,r.return,V)}if(n=r.sibling,n!==null){n.return=r.return,J=n;break}J=r.return}return te=Hp,Hp=!1,te}function Os(n,r,a){var c=r.updateQueue;if(c=c!==null?c.lastEffect:null,c!==null){var h=c=c.next;do{if((h.tag&n)===n){var p=h.destroy;h.destroy=void 0,p!==void 0&&sd(r,a,p)}h=h.next}while(h!==c)}}function Sl(n,r){if(r=r.updateQueue,r=r!==null?r.lastEffect:null,r!==null){var a=r=r.next;do{if((a.tag&n)===n){var c=a.create;a.destroy=c()}a=a.next}while(a!==r)}}function ad(n){var r=n.ref;if(r!==null){var a=n.stateNode;switch(n.tag){case 5:n=a;break;default:n=a}typeof r=="function"?r(n):r.current=n}}function bp(n){var r=n.alternate;r!==null&&(n.alternate=null,bp(r)),n.child=null,n.deletions=null,n.sibling=null,n.tag===5&&(r=n.stateNode,r!==null&&(delete r[Yn],delete r[Ts],delete r[Ec],delete r[Qy],delete r[Jy])),n.stateNode=null,n.return=null,n.dependencies=null,n.memoizedProps=null,n.memoizedState=null,n.pendingProps=null,n.stateNode=null,n.updateQueue=null}function Gp(n){return n.tag===5||n.tag===3||n.tag===4}function xp(n){e:for(;;){for(;n.sibling===null;){if(n.return===null||Gp(n.return))return null;n=n.return}for(n.sibling.return=n.return,n=n.sibling;n.tag!==5&&n.tag!==6&&n.tag!==18;){if(n.flags&2||n.child===null||n.tag===4)continue e;n.child.return=n,n=n.child}if(!(n.flags&2))return n.stateNode}}function ld(n,r,a){var c=n.tag;if(c===5||c===6)n=n.stateNode,r?a.nodeType===8?a.parentNode.insertBefore(n,r):a.insertBefore(n,r):(a.nodeType===8?(r=a.parentNode,r.insertBefore(n,a)):(r=a,r.appendChild(n)),a=a._reactRootContainer,a!=null||r.onclick!==null||(r.onclick=Ka));else if(c!==4&&(n=n.child,n!==null))for(ld(n,r,a),n=n.sibling;n!==null;)ld(n,r,a),n=n.sibling}function ud(n,r,a){var c=n.tag;if(c===5||c===6)n=n.stateNode,r?a.insertBefore(n,r):a.appendChild(n);else if(c!==4&&(n=n.child,n!==null))for(ud(n,r,a),n=n.sibling;n!==null;)ud(n,r,a),n=n.sibling}var Ct=null,Nn=!1;function Fi(n,r,a){for(a=a.child;a!==null;)$p(n,r,a),a=a.sibling}function $p(n,r,a){if(Wn&&typeof Wn.onCommitFiberUnmount=="function")try{Wn.onCommitFiberUnmount(Oa,a)}catch{}switch(a.tag){case 5:Mt||fo(a,r);case 6:var c=Ct,h=Nn;Ct=null,Fi(n,r,a),Ct=c,Nn=h,Ct!==null&&(Nn?(n=Ct,a=a.stateNode,n.nodeType===8?n.parentNode.removeChild(a):n.removeChild(a)):Ct.removeChild(a.stateNode));break;case 18:Ct!==null&&(Nn?(n=Ct,a=a.stateNode,n.nodeType===8?Ic(n.parentNode,a):n.nodeType===1&&Ic(n,a),us(n)):Ic(Ct,a.stateNode));break;case 4:c=Ct,h=Nn,Ct=a.stateNode.containerInfo,Nn=!0,Fi(n,r,a),Ct=c,Nn=h;break;case 0:case 11:case 14:case 15:if(!Mt&&(c=a.updateQueue,c!==null&&(c=c.lastEffect,c!==null))){h=c=c.next;do{var p=h,S=p.destroy;p=p.tag,S!==void 0&&((p&2)!==0||(p&4)!==0)&&sd(a,r,S),h=h.next}while(h!==c)}Fi(n,r,a);break;case 1:if(!Mt&&(fo(a,r),c=a.stateNode,typeof c.componentWillUnmount=="function"))try{c.props=a.memoizedProps,c.state=a.memoizedState,c.componentWillUnmount()}catch(_){ot(a,r,_)}Fi(n,r,a);break;case 21:Fi(n,r,a);break;case 22:a.mode&1?(Mt=(c=Mt)||a.memoizedState!==null,Fi(n,r,a),Mt=c):Fi(n,r,a);break;default:Fi(n,r,a)}}function zp(n){var r=n.updateQueue;if(r!==null){n.updateQueue=null;var a=n.stateNode;a===null&&(a=n.stateNode=new pT),r.forEach(function(c){var h=_T.bind(null,n,c);a.has(c)||(a.add(c),c.then(h,h))})}}function Dn(n,r){var a=r.deletions;if(a!==null)for(var c=0;c<a.length;c++){var h=a[c];try{var p=n,S=r,_=S;e:for(;_!==null;){switch(_.tag){case 5:Ct=_.stateNode,Nn=!1;break e;case 3:Ct=_.stateNode.containerInfo,Nn=!0;break e;case 4:Ct=_.stateNode.containerInfo,Nn=!0;break e}_=_.return}if(Ct===null)throw Error(i(160));$p(p,S,h),Ct=null,Nn=!1;var R=h.alternate;R!==null&&(R.return=null),h.return=null}catch(k){ot(h,r,k)}}if(r.subtreeFlags&12854)for(r=r.child;r!==null;)Wp(r,n),r=r.sibling}function Wp(n,r){var a=n.alternate,c=n.flags;switch(n.tag){case 0:case 11:case 14:case 15:if(Dn(r,n),Xn(n),c&4){try{Os(3,n,n.return),Sl(3,n)}catch(se){ot(n,n.return,se)}try{Os(5,n,n.return)}catch(se){ot(n,n.return,se)}}break;case 1:Dn(r,n),Xn(n),c&512&&a!==null&&fo(a,a.return);break;case 5:if(Dn(r,n),Xn(n),c&512&&a!==null&&fo(a,a.return),n.flags&32){var h=n.stateNode;try{Qo(h,"")}catch(se){ot(n,n.return,se)}}if(c&4&&(h=n.stateNode,h!=null)){var p=n.memoizedProps,S=a!==null?a.memoizedProps:p,_=n.type,R=n.updateQueue;if(n.updateQueue=null,R!==null)try{_==="input"&&p.type==="radio"&&p.name!=null&&xn(h,p),Gu(_,S);var k=Gu(_,p);for(S=0;S<R.length;S+=2){var x=R[S],z=R[S+1];x==="style"?Ch(h,z):x==="dangerouslySetInnerHTML"?wh(h,z):x==="children"?Qo(h,z):D(h,x,z,k)}switch(_){case"input":Yt(h,p);break;case"textarea":Ah(h,p);break;case"select":var G=h._wrapperState.wasMultiple;h._wrapperState.wasMultiple=!!p.multiple;var q=p.value;q!=null?Ai(h,!!p.multiple,q,!1):G!==!!p.multiple&&(p.defaultValue!=null?Ai(h,!!p.multiple,p.defaultValue,!0):Ai(h,!!p.multiple,p.multiple?[]:"",!1))}h[Ts]=p}catch(se){ot(n,n.return,se)}}break;case 6:if(Dn(r,n),Xn(n),c&4){if(n.stateNode===null)throw Error(i(162));h=n.stateNode,p=n.memoizedProps;try{h.nodeValue=p}catch(se){ot(n,n.return,se)}}break;case 3:if(Dn(r,n),Xn(n),c&4&&a!==null&&a.memoizedState.isDehydrated)try{us(r.containerInfo)}catch(se){ot(n,n.return,se)}break;case 4:Dn(r,n),Xn(n);break;case 13:Dn(r,n),Xn(n),h=n.child,h.flags&8192&&(p=h.memoizedState!==null,h.stateNode.isHidden=p,!p||h.alternate!==null&&h.alternate.memoizedState!==null||(fd=at())),c&4&&zp(n);break;case 22:if(x=a!==null&&a.memoizedState!==null,n.mode&1?(Mt=(k=Mt)||x,Dn(r,n),Mt=k):Dn(r,n),Xn(n),c&8192){if(k=n.memoizedState!==null,(n.stateNode.isHidden=k)&&!x&&(n.mode&1)!==0)for(J=n,x=n.child;x!==null;){for(z=J=x;J!==null;){switch(G=J,q=G.child,G.tag){case 0:case 11:case 14:case 15:Os(4,G,G.return);break;case 1:fo(G,G.return);var te=G.stateNode;if(typeof te.componentWillUnmount=="function"){c=G,a=G.return;try{r=c,te.props=r.memoizedProps,te.state=r.memoizedState,te.componentWillUnmount()}catch(se){ot(c,a,se)}}break;case 5:fo(G,G.return);break;case 22:if(G.memoizedState!==null){Vp(z);continue}}q!==null?(q.return=G,J=q):Vp(z)}x=x.sibling}e:for(x=null,z=n;;){if(z.tag===5){if(x===null){x=z;try{h=z.stateNode,k?(p=h.style,typeof p.setProperty=="function"?p.setProperty("display","none","important"):p.display="none"):(_=z.stateNode,R=z.memoizedProps.style,S=R!=null&&R.hasOwnProperty("display")?R.display:null,_.style.display=_h("display",S))}catch(se){ot(n,n.return,se)}}}else if(z.tag===6){if(x===null)try{z.stateNode.nodeValue=k?"":z.memoizedProps}catch(se){ot(n,n.return,se)}}else if((z.tag!==22&&z.tag!==23||z.memoizedState===null||z===n)&&z.child!==null){z.child.return=z,z=z.child;continue}if(z===n)break e;for(;z.sibling===null;){if(z.return===null||z.return===n)break e;x===z&&(x=null),z=z.return}x===z&&(x=null),z.sibling.return=z.return,z=z.sibling}}break;case 19:Dn(r,n),Xn(n),c&4&&zp(n);break;case 21:break;default:Dn(r,n),Xn(n)}}function Xn(n){var r=n.flags;if(r&2){try{e:{for(var a=n.return;a!==null;){if(Gp(a)){var c=a;break e}a=a.return}throw Error(i(160))}switch(c.tag){case 5:var h=c.stateNode;c.flags&32&&(Qo(h,""),c.flags&=-33);var p=xp(n);ud(n,p,h);break;case 3:case 4:var S=c.stateNode.containerInfo,_=xp(n);ld(n,_,S);break;default:throw Error(i(161))}}catch(R){ot(n,n.return,R)}n.flags&=-3}r&4096&&(n.flags&=-4097)}function vT(n,r,a){J=n,Yp(n)}function Yp(n,r,a){for(var c=(n.mode&1)!==0;J!==null;){var h=J,p=h.child;if(h.tag===22&&c){var S=h.memoizedState!==null||vl;if(!S){var _=h.alternate,R=_!==null&&_.memoizedState!==null||Mt;_=vl;var k=Mt;if(vl=S,(Mt=R)&&!k)for(J=h;J!==null;)S=J,R=S.child,S.tag===22&&S.memoizedState!==null?Xp(h):R!==null?(R.return=S,J=R):Xp(h);for(;p!==null;)J=p,Yp(p),p=p.sibling;J=h,vl=_,Mt=k}jp(n)}else(h.subtreeFlags&8772)!==0&&p!==null?(p.return=h,J=p):jp(n)}}function jp(n){for(;J!==null;){var r=J;if((r.flags&8772)!==0){var a=r.alternate;try{if((r.flags&8772)!==0)switch(r.tag){case 0:case 11:case 15:Mt||Sl(5,r);break;case 1:var c=r.stateNode;if(r.flags&4&&!Mt)if(a===null)c.componentDidMount();else{var h=r.elementType===r.type?a.memoizedProps:Pn(r.type,a.memoizedProps);c.componentDidUpdate(h,a.memoizedState,c.__reactInternalSnapshotBeforeUpdate)}var p=r.updateQueue;p!==null&&Vg(r,p,c);break;case 3:var S=r.updateQueue;if(S!==null){if(a=null,r.child!==null)switch(r.child.tag){case 5:a=r.child.stateNode;break;case 1:a=r.child.stateNode}Vg(r,S,a)}break;case 5:var _=r.stateNode;if(a===null&&r.flags&4){a=_;var R=r.memoizedProps;switch(r.type){case"button":case"input":case"select":case"textarea":R.autoFocus&&a.focus();break;case"img":R.src&&(a.src=R.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(r.memoizedState===null){var k=r.alternate;if(k!==null){var x=k.memoizedState;if(x!==null){var z=x.dehydrated;z!==null&&us(z)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(i(163))}Mt||r.flags&512&&ad(r)}catch(G){ot(r,r.return,G)}}if(r===n){J=null;break}if(a=r.sibling,a!==null){a.return=r.return,J=a;break}J=r.return}}function Vp(n){for(;J!==null;){var r=J;if(r===n){J=null;break}var a=r.sibling;if(a!==null){a.return=r.return,J=a;break}J=r.return}}function Xp(n){for(;J!==null;){var r=J;try{switch(r.tag){case 0:case 11:case 15:var a=r.return;try{Sl(4,r)}catch(R){ot(r,a,R)}break;case 1:var c=r.stateNode;if(typeof c.componentDidMount=="function"){var h=r.return;try{c.componentDidMount()}catch(R){ot(r,h,R)}}var p=r.return;try{ad(r)}catch(R){ot(r,p,R)}break;case 5:var S=r.return;try{ad(r)}catch(R){ot(r,S,R)}}}catch(R){ot(r,r.return,R)}if(r===n){J=null;break}var _=r.sibling;if(_!==null){_.return=r.return,J=_;break}J=r.return}}var ST=Math.ceil,yl=H.ReactCurrentDispatcher,cd=H.ReactCurrentOwner,pn=H.ReactCurrentBatchConfig,He=0,yt=null,dt=null,Rt=0,nn=0,ho=Ni(0),gt=0,Ms=null,vr=0,Tl=0,dd=0,ks=null,Kt=null,fd=0,go=1/0,ui=null,Al=!1,hd=null,Li=null,Il=!1,Ui=null,El=0,Fs=0,gd=null,wl=-1,_l=0;function Ht(){return(He&6)!==0?at():wl!==-1?wl:wl=at()}function Bi(n){return(n.mode&1)===0?1:(He&2)!==0&&Rt!==0?Rt&-Rt:tT.transition!==null?(_l===0&&(_l=xh()),_l):(n=We,n!==0||(n=window.event,n=n===void 0?16:Zh(n.type)),n)}function On(n,r,a,c){if(50<Fs)throw Fs=0,gd=null,Error(i(185));rs(n,a,c),((He&2)===0||n!==yt)&&(n===yt&&((He&2)===0&&(Tl|=a),gt===4&&Hi(n,Rt)),Zt(n,c),a===1&&He===0&&(r.mode&1)===0&&(go=at()+500,Ja&&Oi()))}function Zt(n,r){var a=n.callbackNode;ty(n,r);var c=Fa(n,n===yt?Rt:0);if(c===0)a!==null&&Hh(a),n.callbackNode=null,n.callbackPriority=0;else if(r=c&-c,n.callbackPriority!==r){if(a!=null&&Hh(a),r===1)n.tag===0?eT(Zp.bind(null,n)):Lg(Zp.bind(null,n)),Zy(function(){(He&6)===0&&Oi()}),a=null;else{switch($h(c)){case 1:a=Vu;break;case 4:a=bh;break;case 16:a=Da;break;case 536870912:a=Gh;break;default:a=Da}a=rm(a,Kp.bind(null,n))}n.callbackPriority=r,n.callbackNode=a}}function Kp(n,r){if(wl=-1,_l=0,(He&6)!==0)throw Error(i(327));var a=n.callbackNode;if(po()&&n.callbackNode!==a)return null;var c=Fa(n,n===yt?Rt:0);if(c===0)return null;if((c&30)!==0||(c&n.expiredLanes)!==0||r)r=Cl(n,c);else{r=c;var h=He;He|=2;var p=Qp();(yt!==n||Rt!==r)&&(ui=null,go=at()+500,yr(n,r));do try{AT();break}catch(_){qp(n,_)}while(!0);Mc(),yl.current=p,He=h,dt!==null?r=0:(yt=null,Rt=0,r=gt)}if(r!==0){if(r===2&&(h=Xu(n),h!==0&&(c=h,r=pd(n,h))),r===1)throw a=Ms,yr(n,0),Hi(n,c),Zt(n,at()),a;if(r===6)Hi(n,c);else{if(h=n.current.alternate,(c&30)===0&&!yT(h)&&(r=Cl(n,c),r===2&&(p=Xu(n),p!==0&&(c=p,r=pd(n,p))),r===1))throw a=Ms,yr(n,0),Hi(n,c),Zt(n,at()),a;switch(n.finishedWork=h,n.finishedLanes=c,r){case 0:case 1:throw Error(i(345));case 2:Tr(n,Kt,ui);break;case 3:if(Hi(n,c),(c&130023424)===c&&(r=fd+500-at(),10<r)){if(Fa(n,0)!==0)break;if(h=n.suspendedLanes,(h&c)!==c){Ht(),n.pingedLanes|=n.suspendedLanes&h;break}n.timeoutHandle=Ac(Tr.bind(null,n,Kt,ui),r);break}Tr(n,Kt,ui);break;case 4:if(Hi(n,c),(c&4194240)===c)break;for(r=n.eventTimes,h=-1;0<c;){var S=31-_n(c);p=1<<S,S=r[S],S>h&&(h=S),c&=~p}if(c=h,c=at()-c,c=(120>c?120:480>c?480:1080>c?1080:1920>c?1920:3e3>c?3e3:4320>c?4320:1960*ST(c/1960))-c,10<c){n.timeoutHandle=Ac(Tr.bind(null,n,Kt,ui),c);break}Tr(n,Kt,ui);break;case 5:Tr(n,Kt,ui);break;default:throw Error(i(329))}}}return Zt(n,at()),n.callbackNode===a?Kp.bind(null,n):null}function pd(n,r){var a=ks;return n.current.memoizedState.isDehydrated&&(yr(n,r).flags|=256),n=Cl(n,r),n!==2&&(r=Kt,Kt=a,r!==null&&md(r)),n}function md(n){Kt===null?Kt=n:Kt.push.apply(Kt,n)}function yT(n){for(var r=n;;){if(r.flags&16384){var a=r.updateQueue;if(a!==null&&(a=a.stores,a!==null))for(var c=0;c<a.length;c++){var h=a[c],p=h.getSnapshot;h=h.value;try{if(!Cn(p(),h))return!1}catch{return!1}}}if(a=r.child,r.subtreeFlags&16384&&a!==null)a.return=r,r=a;else{if(r===n)break;for(;r.sibling===null;){if(r.return===null||r.return===n)return!0;r=r.return}r.sibling.return=r.return,r=r.sibling}}return!0}function Hi(n,r){for(r&=~dd,r&=~Tl,n.suspendedLanes|=r,n.pingedLanes&=~r,n=n.expirationTimes;0<r;){var a=31-_n(r),c=1<<a;n[a]=-1,r&=~c}}function Zp(n){if((He&6)!==0)throw Error(i(327));po();var r=Fa(n,0);if((r&1)===0)return Zt(n,at()),null;var a=Cl(n,r);if(n.tag!==0&&a===2){var c=Xu(n);c!==0&&(r=c,a=pd(n,c))}if(a===1)throw a=Ms,yr(n,0),Hi(n,r),Zt(n,at()),a;if(a===6)throw Error(i(345));return n.finishedWork=n.current.alternate,n.finishedLanes=r,Tr(n,Kt,ui),Zt(n,at()),null}function vd(n,r){var a=He;He|=1;try{return n(r)}finally{He=a,He===0&&(go=at()+500,Ja&&Oi())}}function Sr(n){Ui!==null&&Ui.tag===0&&(He&6)===0&&po();var r=He;He|=1;var a=pn.transition,c=We;try{if(pn.transition=null,We=1,n)return n()}finally{We=c,pn.transition=a,He=r,(He&6)===0&&Oi()}}function Sd(){nn=ho.current,Ke(ho)}function yr(n,r){n.finishedWork=null,n.finishedLanes=0;var a=n.timeoutHandle;if(a!==-1&&(n.timeoutHandle=-1,Ky(a)),dt!==null)for(a=dt.return;a!==null;){var c=a;switch(Rc(c),c.tag){case 1:c=c.type.childContextTypes,c!=null&&qa();break;case 3:uo(),Ke(jt),Ke(Nt),Gc();break;case 5:Hc(c);break;case 4:uo();break;case 13:Ke(it);break;case 19:Ke(it);break;case 10:kc(c.type._context);break;case 22:case 23:Sd()}a=a.return}if(yt=n,dt=n=bi(n.current,null),Rt=nn=r,gt=0,Ms=null,dd=Tl=vr=0,Kt=ks=null,gr!==null){for(r=0;r<gr.length;r++)if(a=gr[r],c=a.interleaved,c!==null){a.interleaved=null;var h=c.next,p=a.pending;if(p!==null){var S=p.next;p.next=h,c.next=S}a.pending=c}gr=null}return n}function qp(n,r){do{var a=dt;try{if(Mc(),ul.current=hl,cl){for(var c=rt.memoizedState;c!==null;){var h=c.queue;h!==null&&(h.pending=null),c=c.next}cl=!1}if(mr=0,St=ht=rt=null,Cs=!1,Rs=0,cd.current=null,a===null||a.return===null){gt=1,Ms=r,dt=null;break}e:{var p=n,S=a.return,_=a,R=r;if(r=Rt,_.flags|=32768,R!==null&&typeof R=="object"&&typeof R.then=="function"){var k=R,x=_,z=x.tag;if((x.mode&1)===0&&(z===0||z===11||z===15)){var G=x.alternate;G?(x.updateQueue=G.updateQueue,x.memoizedState=G.memoizedState,x.lanes=G.lanes):(x.updateQueue=null,x.memoizedState=null)}var q=Ip(S);if(q!==null){q.flags&=-257,Ep(q,S,_,p,r),q.mode&1&&Ap(p,k,r),r=q,R=k;var te=r.updateQueue;if(te===null){var se=new Set;se.add(R),r.updateQueue=se}else te.add(R);break e}else{if((r&1)===0){Ap(p,k,r),yd();break e}R=Error(i(426))}}else if(Qe&&_.mode&1){var lt=Ip(S);if(lt!==null){(lt.flags&65536)===0&&(lt.flags|=256),Ep(lt,S,_,p,r),Dc(co(R,_));break e}}p=R=co(R,_),gt!==4&&(gt=2),ks===null?ks=[p]:ks.push(p),p=S;do{switch(p.tag){case 3:p.flags|=65536,r&=-r,p.lanes|=r;var O=yp(p,R,r);jg(p,O);break e;case 1:_=R;var N=p.type,M=p.stateNode;if((p.flags&128)===0&&(typeof N.getDerivedStateFromError=="function"||M!==null&&typeof M.componentDidCatch=="function"&&(Li===null||!Li.has(M)))){p.flags|=65536,r&=-r,p.lanes|=r;var V=Tp(p,_,r);jg(p,V);break e}}p=p.return}while(p!==null)}em(a)}catch(ue){r=ue,dt===a&&a!==null&&(dt=a=a.return);continue}break}while(!0)}function Qp(){var n=yl.current;return yl.current=hl,n===null?hl:n}function yd(){(gt===0||gt===3||gt===2)&&(gt=4),yt===null||(vr&268435455)===0&&(Tl&268435455)===0||Hi(yt,Rt)}function Cl(n,r){var a=He;He|=2;var c=Qp();(yt!==n||Rt!==r)&&(ui=null,yr(n,r));do try{TT();break}catch(h){qp(n,h)}while(!0);if(Mc(),He=a,yl.current=c,dt!==null)throw Error(i(261));return yt=null,Rt=0,gt}function TT(){for(;dt!==null;)Jp(dt)}function AT(){for(;dt!==null&&!jS();)Jp(dt)}function Jp(n){var r=im(n.alternate,n,nn);n.memoizedProps=n.pendingProps,r===null?em(n):dt=r,cd.current=null}function em(n){var r=n;do{var a=r.alternate;if(n=r.return,(r.flags&32768)===0){if(a=hT(a,r,nn),a!==null){dt=a;return}}else{if(a=gT(a,r),a!==null){a.flags&=32767,dt=a;return}if(n!==null)n.flags|=32768,n.subtreeFlags=0,n.deletions=null;else{gt=6,dt=null;return}}if(r=r.sibling,r!==null){dt=r;return}dt=r=n}while(r!==null);gt===0&&(gt=5)}function Tr(n,r,a){var c=We,h=pn.transition;try{pn.transition=null,We=1,IT(n,r,a,c)}finally{pn.transition=h,We=c}return null}function IT(n,r,a,c){do po();while(Ui!==null);if((He&6)!==0)throw Error(i(327));a=n.finishedWork;var h=n.finishedLanes;if(a===null)return null;if(n.finishedWork=null,n.finishedLanes=0,a===n.current)throw Error(i(177));n.callbackNode=null,n.callbackPriority=0;var p=a.lanes|a.childLanes;if(ny(n,p),n===yt&&(dt=yt=null,Rt=0),(a.subtreeFlags&2064)===0&&(a.flags&2064)===0||Il||(Il=!0,rm(Da,function(){return po(),null})),p=(a.flags&15990)!==0,(a.subtreeFlags&15990)!==0||p){p=pn.transition,pn.transition=null;var S=We;We=1;var _=He;He|=4,cd.current=null,mT(n,a),Wp(a,n),$y(yc),Ba=!!Sc,yc=Sc=null,n.current=a,vT(a),VS(),He=_,We=S,pn.transition=p}else n.current=a;if(Il&&(Il=!1,Ui=n,El=h),p=n.pendingLanes,p===0&&(Li=null),ZS(a.stateNode),Zt(n,at()),r!==null)for(c=n.onRecoverableError,a=0;a<r.length;a++)h=r[a],c(h.value,{componentStack:h.stack,digest:h.digest});if(Al)throw Al=!1,n=hd,hd=null,n;return(El&1)!==0&&n.tag!==0&&po(),p=n.pendingLanes,(p&1)!==0?n===gd?Fs++:(Fs=0,gd=n):Fs=0,Oi(),null}function po(){if(Ui!==null){var n=$h(El),r=pn.transition,a=We;try{if(pn.transition=null,We=16>n?16:n,Ui===null)var c=!1;else{if(n=Ui,Ui=null,El=0,(He&6)!==0)throw Error(i(331));var h=He;for(He|=4,J=n.current;J!==null;){var p=J,S=p.child;if((J.flags&16)!==0){var _=p.deletions;if(_!==null){for(var R=0;R<_.length;R++){var k=_[R];for(J=k;J!==null;){var x=J;switch(x.tag){case 0:case 11:case 15:Os(8,x,p)}var z=x.child;if(z!==null)z.return=x,J=z;else for(;J!==null;){x=J;var G=x.sibling,q=x.return;if(bp(x),x===k){J=null;break}if(G!==null){G.return=q,J=G;break}J=q}}}var te=p.alternate;if(te!==null){var se=te.child;if(se!==null){te.child=null;do{var lt=se.sibling;se.sibling=null,se=lt}while(se!==null)}}J=p}}if((p.subtreeFlags&2064)!==0&&S!==null)S.return=p,J=S;else e:for(;J!==null;){if(p=J,(p.flags&2048)!==0)switch(p.tag){case 0:case 11:case 15:Os(9,p,p.return)}var O=p.sibling;if(O!==null){O.return=p.return,J=O;break e}J=p.return}}var N=n.current;for(J=N;J!==null;){S=J;var M=S.child;if((S.subtreeFlags&2064)!==0&&M!==null)M.return=S,J=M;else e:for(S=N;J!==null;){if(_=J,(_.flags&2048)!==0)try{switch(_.tag){case 0:case 11:case 15:Sl(9,_)}}catch(ue){ot(_,_.return,ue)}if(_===S){J=null;break e}var V=_.sibling;if(V!==null){V.return=_.return,J=V;break e}J=_.return}}if(He=h,Oi(),Wn&&typeof Wn.onPostCommitFiberRoot=="function")try{Wn.onPostCommitFiberRoot(Oa,n)}catch{}c=!0}return c}finally{We=a,pn.transition=r}}return!1}function tm(n,r,a){r=co(a,r),r=yp(n,r,1),n=ki(n,r,1),r=Ht(),n!==null&&(rs(n,1,r),Zt(n,r))}function ot(n,r,a){if(n.tag===3)tm(n,n,a);else for(;r!==null;){if(r.tag===3){tm(r,n,a);break}else if(r.tag===1){var c=r.stateNode;if(typeof r.type.getDerivedStateFromError=="function"||typeof c.componentDidCatch=="function"&&(Li===null||!Li.has(c))){n=co(a,n),n=Tp(r,n,1),r=ki(r,n,1),n=Ht(),r!==null&&(rs(r,1,n),Zt(r,n));break}}r=r.return}}function ET(n,r,a){var c=n.pingCache;c!==null&&c.delete(r),r=Ht(),n.pingedLanes|=n.suspendedLanes&a,yt===n&&(Rt&a)===a&&(gt===4||gt===3&&(Rt&130023424)===Rt&&500>at()-fd?yr(n,0):dd|=a),Zt(n,r)}function nm(n,r){r===0&&((n.mode&1)===0?r=1:(r=ka,ka<<=1,(ka&130023424)===0&&(ka=4194304)));var a=Ht();n=si(n,r),n!==null&&(rs(n,r,a),Zt(n,a))}function wT(n){var r=n.memoizedState,a=0;r!==null&&(a=r.retryLane),nm(n,a)}function _T(n,r){var a=0;switch(n.tag){case 13:var c=n.stateNode,h=n.memoizedState;h!==null&&(a=h.retryLane);break;case 19:c=n.stateNode;break;default:throw Error(i(314))}c!==null&&c.delete(r),nm(n,a)}var im;im=function(n,r,a){if(n!==null)if(n.memoizedProps!==r.pendingProps||jt.current)Xt=!0;else{if((n.lanes&a)===0&&(r.flags&128)===0)return Xt=!1,fT(n,r,a);Xt=(n.flags&131072)!==0}else Xt=!1,Qe&&(r.flags&1048576)!==0&&Ug(r,tl,r.index);switch(r.lanes=0,r.tag){case 2:var c=r.type;ml(n,r),n=r.pendingProps;var h=no(r,Nt.current);lo(r,a),h=zc(null,r,c,n,h,a);var p=Wc();return r.flags|=1,typeof h=="object"&&h!==null&&typeof h.render=="function"&&h.$$typeof===void 0?(r.tag=1,r.memoizedState=null,r.updateQueue=null,Vt(c)?(p=!0,Qa(r)):p=!1,r.memoizedState=h.state!==null&&h.state!==void 0?h.state:null,Uc(r),h.updater=gl,r.stateNode=h,h._reactInternals=r,Zc(r,c,n,a),r=ed(null,r,c,!0,p,a)):(r.tag=0,Qe&&p&&Cc(r),Bt(null,r,h,a),r=r.child),r;case 16:c=r.elementType;e:{switch(ml(n,r),n=r.pendingProps,h=c._init,c=h(c._payload),r.type=c,h=r.tag=RT(c),n=Pn(c,n),h){case 0:r=Jc(null,r,c,n,a);break e;case 1:r=Np(null,r,c,n,a);break e;case 11:r=wp(null,r,c,n,a);break e;case 14:r=_p(null,r,c,Pn(c.type,n),a);break e}throw Error(i(306,c,""))}return r;case 0:return c=r.type,h=r.pendingProps,h=r.elementType===c?h:Pn(c,h),Jc(n,r,c,h,a);case 1:return c=r.type,h=r.pendingProps,h=r.elementType===c?h:Pn(c,h),Np(n,r,c,h,a);case 3:e:{if(Dp(r),n===null)throw Error(i(387));c=r.pendingProps,p=r.memoizedState,h=p.element,Yg(n,r),al(r,c,null,a);var S=r.memoizedState;if(c=S.element,p.isDehydrated)if(p={element:c,isDehydrated:!1,cache:S.cache,pendingSuspenseBoundaries:S.pendingSuspenseBoundaries,transitions:S.transitions},r.updateQueue.baseState=p,r.memoizedState=p,r.flags&256){h=co(Error(i(423)),r),r=Op(n,r,c,a,h);break e}else if(c!==h){h=co(Error(i(424)),r),r=Op(n,r,c,a,h);break e}else for(tn=Pi(r.stateNode.containerInfo.firstChild),en=r,Qe=!0,Rn=null,a=zg(r,null,c,a),r.child=a;a;)a.flags=a.flags&-3|4096,a=a.sibling;else{if(oo(),c===h){r=li(n,r,a);break e}Bt(n,r,c,a)}r=r.child}return r;case 5:return Xg(r),n===null&&Nc(r),c=r.type,h=r.pendingProps,p=n!==null?n.memoizedProps:null,S=h.children,Tc(c,h)?S=null:p!==null&&Tc(c,p)&&(r.flags|=32),Pp(n,r),Bt(n,r,S,a),r.child;case 6:return n===null&&Nc(r),null;case 13:return Mp(n,r,a);case 4:return Bc(r,r.stateNode.containerInfo),c=r.pendingProps,n===null?r.child=so(r,null,c,a):Bt(n,r,c,a),r.child;case 11:return c=r.type,h=r.pendingProps,h=r.elementType===c?h:Pn(c,h),wp(n,r,c,h,a);case 7:return Bt(n,r,r.pendingProps,a),r.child;case 8:return Bt(n,r,r.pendingProps.children,a),r.child;case 12:return Bt(n,r,r.pendingProps.children,a),r.child;case 10:e:{if(c=r.type._context,h=r.pendingProps,p=r.memoizedProps,S=h.value,Ye(rl,c._currentValue),c._currentValue=S,p!==null)if(Cn(p.value,S)){if(p.children===h.children&&!jt.current){r=li(n,r,a);break e}}else for(p=r.child,p!==null&&(p.return=r);p!==null;){var _=p.dependencies;if(_!==null){S=p.child;for(var R=_.firstContext;R!==null;){if(R.context===c){if(p.tag===1){R=ai(-1,a&-a),R.tag=2;var k=p.updateQueue;if(k!==null){k=k.shared;var x=k.pending;x===null?R.next=R:(R.next=x.next,x.next=R),k.pending=R}}p.lanes|=a,R=p.alternate,R!==null&&(R.lanes|=a),Fc(p.return,a,r),_.lanes|=a;break}R=R.next}}else if(p.tag===10)S=p.type===r.type?null:p.child;else if(p.tag===18){if(S=p.return,S===null)throw Error(i(341));S.lanes|=a,_=S.alternate,_!==null&&(_.lanes|=a),Fc(S,a,r),S=p.sibling}else S=p.child;if(S!==null)S.return=p;else for(S=p;S!==null;){if(S===r){S=null;break}if(p=S.sibling,p!==null){p.return=S.return,S=p;break}S=S.return}p=S}Bt(n,r,h.children,a),r=r.child}return r;case 9:return h=r.type,c=r.pendingProps.children,lo(r,a),h=hn(h),c=c(h),r.flags|=1,Bt(n,r,c,a),r.child;case 14:return c=r.type,h=Pn(c,r.pendingProps),h=Pn(c.type,h),_p(n,r,c,h,a);case 15:return Cp(n,r,r.type,r.pendingProps,a);case 17:return c=r.type,h=r.pendingProps,h=r.elementType===c?h:Pn(c,h),ml(n,r),r.tag=1,Vt(c)?(n=!0,Qa(r)):n=!1,lo(r,a),vp(r,c,h),Zc(r,c,h,a),ed(null,r,c,!0,n,a);case 19:return Fp(n,r,a);case 22:return Rp(n,r,a)}throw Error(i(156,r.tag))};function rm(n,r){return Bh(n,r)}function CT(n,r,a,c){this.tag=n,this.key=a,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=r,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=c,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function mn(n,r,a,c){return new CT(n,r,a,c)}function Td(n){return n=n.prototype,!(!n||!n.isReactComponent)}function RT(n){if(typeof n=="function")return Td(n)?1:0;if(n!=null){if(n=n.$$typeof,n===De)return 11;if(n===Le)return 14}return 2}function bi(n,r){var a=n.alternate;return a===null?(a=mn(n.tag,r,n.key,n.mode),a.elementType=n.elementType,a.type=n.type,a.stateNode=n.stateNode,a.alternate=n,n.alternate=a):(a.pendingProps=r,a.type=n.type,a.flags=0,a.subtreeFlags=0,a.deletions=null),a.flags=n.flags&14680064,a.childLanes=n.childLanes,a.lanes=n.lanes,a.child=n.child,a.memoizedProps=n.memoizedProps,a.memoizedState=n.memoizedState,a.updateQueue=n.updateQueue,r=n.dependencies,a.dependencies=r===null?null:{lanes:r.lanes,firstContext:r.firstContext},a.sibling=n.sibling,a.index=n.index,a.ref=n.ref,a}function Rl(n,r,a,c,h,p){var S=2;if(c=n,typeof n=="function")Td(n)&&(S=1);else if(typeof n=="string")S=5;else e:switch(n){case $:return Ar(a.children,h,p,r);case ee:S=8,h|=8;break;case _e:return n=mn(12,a,r,h|2),n.elementType=_e,n.lanes=p,n;case Pe:return n=mn(13,a,r,h),n.elementType=Pe,n.lanes=p,n;case de:return n=mn(19,a,r,h),n.elementType=de,n.lanes=p,n;case ne:return Pl(a,h,p,r);default:if(typeof n=="object"&&n!==null)switch(n.$$typeof){case Ce:S=10;break e;case be:S=9;break e;case De:S=11;break e;case Le:S=14;break e;case Te:S=16,c=null;break e}throw Error(i(130,n==null?n:typeof n,""))}return r=mn(S,a,r,h),r.elementType=n,r.type=c,r.lanes=p,r}function Ar(n,r,a,c){return n=mn(7,n,c,r),n.lanes=a,n}function Pl(n,r,a,c){return n=mn(22,n,c,r),n.elementType=ne,n.lanes=a,n.stateNode={isHidden:!1},n}function Ad(n,r,a){return n=mn(6,n,null,r),n.lanes=a,n}function Id(n,r,a){return r=mn(4,n.children!==null?n.children:[],n.key,r),r.lanes=a,r.stateNode={containerInfo:n.containerInfo,pendingChildren:null,implementation:n.implementation},r}function PT(n,r,a,c,h){this.tag=r,this.containerInfo=n,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Ku(0),this.expirationTimes=Ku(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Ku(0),this.identifierPrefix=c,this.onRecoverableError=h,this.mutableSourceEagerHydrationData=null}function Ed(n,r,a,c,h,p,S,_,R){return n=new PT(n,r,a,_,R),r===1?(r=1,p===!0&&(r|=8)):r=0,p=mn(3,null,null,r),n.current=p,p.stateNode=n,p.memoizedState={element:c,isDehydrated:a,cache:null,transitions:null,pendingSuspenseBoundaries:null},Uc(p),n}function NT(n,r,a){var c=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:U,key:c==null?null:""+c,children:n,containerInfo:r,implementation:a}}function om(n){if(!n)return Di;n=n._reactInternals;e:{if(ur(n)!==n||n.tag!==1)throw Error(i(170));var r=n;do{switch(r.tag){case 3:r=r.stateNode.context;break e;case 1:if(Vt(r.type)){r=r.stateNode.__reactInternalMemoizedMergedChildContext;break e}}r=r.return}while(r!==null);throw Error(i(171))}if(n.tag===1){var a=n.type;if(Vt(a))return kg(n,a,r)}return r}function sm(n,r,a,c,h,p,S,_,R){return n=Ed(a,c,!0,n,h,p,S,_,R),n.context=om(null),a=n.current,c=Ht(),h=Bi(a),p=ai(c,h),p.callback=r??null,ki(a,p,h),n.current.lanes=h,rs(n,h,c),Zt(n,c),n}function Nl(n,r,a,c){var h=r.current,p=Ht(),S=Bi(h);return a=om(a),r.context===null?r.context=a:r.pendingContext=a,r=ai(p,S),r.payload={element:n},c=c===void 0?null:c,c!==null&&(r.callback=c),n=ki(h,r,S),n!==null&&(On(n,h,S,p),sl(n,h,S)),S}function Dl(n){if(n=n.current,!n.child)return null;switch(n.child.tag){case 5:return n.child.stateNode;default:return n.child.stateNode}}function am(n,r){if(n=n.memoizedState,n!==null&&n.dehydrated!==null){var a=n.retryLane;n.retryLane=a!==0&&a<r?a:r}}function wd(n,r){am(n,r),(n=n.alternate)&&am(n,r)}function DT(){return null}var lm=typeof reportError=="function"?reportError:function(n){console.error(n)};function _d(n){this._internalRoot=n}Ol.prototype.render=_d.prototype.render=function(n){var r=this._internalRoot;if(r===null)throw Error(i(409));Nl(n,r,null,null)},Ol.prototype.unmount=_d.prototype.unmount=function(){var n=this._internalRoot;if(n!==null){this._internalRoot=null;var r=n.containerInfo;Sr(function(){Nl(null,n,null,null)}),r[ni]=null}};function Ol(n){this._internalRoot=n}Ol.prototype.unstable_scheduleHydration=function(n){if(n){var r=Yh();n={blockedOn:null,target:n,priority:r};for(var a=0;a<_i.length&&r!==0&&r<_i[a].priority;a++);_i.splice(a,0,n),a===0&&Xh(n)}};function Cd(n){return!(!n||n.nodeType!==1&&n.nodeType!==9&&n.nodeType!==11)}function Ml(n){return!(!n||n.nodeType!==1&&n.nodeType!==9&&n.nodeType!==11&&(n.nodeType!==8||n.nodeValue!==" react-mount-point-unstable "))}function um(){}function OT(n,r,a,c,h){if(h){if(typeof c=="function"){var p=c;c=function(){var k=Dl(S);p.call(k)}}var S=sm(r,c,n,0,null,!1,!1,"",um);return n._reactRootContainer=S,n[ni]=S.current,Ss(n.nodeType===8?n.parentNode:n),Sr(),S}for(;h=n.lastChild;)n.removeChild(h);if(typeof c=="function"){var _=c;c=function(){var k=Dl(R);_.call(k)}}var R=Ed(n,0,!1,null,null,!1,!1,"",um);return n._reactRootContainer=R,n[ni]=R.current,Ss(n.nodeType===8?n.parentNode:n),Sr(function(){Nl(r,R,a,c)}),R}function kl(n,r,a,c,h){var p=a._reactRootContainer;if(p){var S=p;if(typeof h=="function"){var _=h;h=function(){var R=Dl(S);_.call(R)}}Nl(r,S,n,h)}else S=OT(a,r,n,h,c);return Dl(S)}zh=function(n){switch(n.tag){case 3:var r=n.stateNode;if(r.current.memoizedState.isDehydrated){var a=is(r.pendingLanes);a!==0&&(Zu(r,a|1),Zt(r,at()),(He&6)===0&&(go=at()+500,Oi()))}break;case 13:Sr(function(){var c=si(n,1);if(c!==null){var h=Ht();On(c,n,1,h)}}),wd(n,1)}},qu=function(n){if(n.tag===13){var r=si(n,134217728);if(r!==null){var a=Ht();On(r,n,134217728,a)}wd(n,134217728)}},Wh=function(n){if(n.tag===13){var r=Bi(n),a=si(n,r);if(a!==null){var c=Ht();On(a,n,r,c)}wd(n,r)}},Yh=function(){return We},jh=function(n,r){var a=We;try{return We=n,r()}finally{We=a}},zu=function(n,r,a){switch(r){case"input":if(Yt(n,a),r=a.name,a.type==="radio"&&r!=null){for(a=n;a.parentNode;)a=a.parentNode;for(a=a.querySelectorAll("input[name="+JSON.stringify(""+r)+'][type="radio"]'),r=0;r<a.length;r++){var c=a[r];if(c!==n&&c.form===n.form){var h=Za(c);if(!h)throw Error(i(90));ge(c),Yt(c,h)}}}break;case"textarea":Ah(n,a);break;case"select":r=a.value,r!=null&&Ai(n,!!a.multiple,r,!1)}},Dh=vd,Oh=Sr;var MT={usingClientEntryPoint:!1,Events:[As,eo,Za,Ph,Nh,vd]},Ls={findFiberByHostInstance:cr,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},kT={bundleType:Ls.bundleType,version:Ls.version,rendererPackageName:Ls.rendererPackageName,rendererConfig:Ls.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:H.ReactCurrentDispatcher,findHostInstanceByFiber:function(n){return n=Lh(n),n===null?null:n.stateNode},findFiberByHostInstance:Ls.findFiberByHostInstance||DT,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Fl=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Fl.isDisabled&&Fl.supportsFiber)try{Oa=Fl.inject(kT),Wn=Fl}catch{}}return qt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=MT,qt.createPortal=function(n,r){var a=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Cd(r))throw Error(i(200));return NT(n,r,null,a)},qt.createRoot=function(n,r){if(!Cd(n))throw Error(i(299));var a=!1,c="",h=lm;return r!=null&&(r.unstable_strictMode===!0&&(a=!0),r.identifierPrefix!==void 0&&(c=r.identifierPrefix),r.onRecoverableError!==void 0&&(h=r.onRecoverableError)),r=Ed(n,1,!1,null,null,a,!1,c,h),n[ni]=r.current,Ss(n.nodeType===8?n.parentNode:n),new _d(r)},qt.findDOMNode=function(n){if(n==null)return null;if(n.nodeType===1)return n;var r=n._reactInternals;if(r===void 0)throw typeof n.render=="function"?Error(i(188)):(n=Object.keys(n).join(","),Error(i(268,n)));return n=Lh(r),n=n===null?null:n.stateNode,n},qt.flushSync=function(n){return Sr(n)},qt.hydrate=function(n,r,a){if(!Ml(r))throw Error(i(200));return kl(null,n,r,!0,a)},qt.hydrateRoot=function(n,r,a){if(!Cd(n))throw Error(i(405));var c=a!=null&&a.hydratedSources||null,h=!1,p="",S=lm;if(a!=null&&(a.unstable_strictMode===!0&&(h=!0),a.identifierPrefix!==void 0&&(p=a.identifierPrefix),a.onRecoverableError!==void 0&&(S=a.onRecoverableError)),r=sm(r,null,n,1,a??null,h,!1,p,S),n[ni]=r.current,Ss(n),c)for(n=0;n<c.length;n++)a=c[n],h=a._getVersion,h=h(a._source),r.mutableSourceEagerHydrationData==null?r.mutableSourceEagerHydrationData=[a,h]:r.mutableSourceEagerHydrationData.push(a,h);return new Ol(r)},qt.render=function(n,r,a){if(!Ml(r))throw Error(i(200));return kl(null,n,r,!1,a)},qt.unmountComponentAtNode=function(n){if(!Ml(n))throw Error(i(40));return n._reactRootContainer?(Sr(function(){kl(null,null,n,!1,function(){n._reactRootContainer=null,n[ni]=null})}),!0):!1},qt.unstable_batchedUpdates=vd,qt.unstable_renderSubtreeIntoContainer=function(n,r,a,c){if(!Ml(a))throw Error(i(200));if(n==null||n._reactInternals===void 0)throw Error(i(38));return kl(n,r,a,!1,c)},qt.version="18.3.1-next-f1338f8080-20240426",qt}var vm;function zT(){if(vm)return Nd.exports;vm=1;function e(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}return e(),Nd.exports=$T(),Nd.exports}var Sm;function WT(){if(Sm)return Ll;Sm=1;var e=zT();return Ll.createRoot=e.createRoot,Ll.hydrateRoot=e.hydrateRoot,Ll}var YT=WT();const jT=j0(YT);class VT{constructor(){this.ids=[],this.values=[],this.length=0}clear(){this.length=0}push(t,i){let o=this.length++;for(;o>0;){const l=o-1>>1,s=this.values[l];if(i>=s)break;this.ids[o]=this.ids[l],this.values[o]=s,o=l}this.ids[o]=t,this.values[o]=i}pop(){if(this.length===0)return;const t=this.ids[0];if(this.length--,this.length>0){const i=this.ids[0]=this.ids[this.length],o=this.values[0]=this.values[this.length],l=this.length>>1;let s=0;for(;s<l;){let u=(s<<1)+1;const d=u+1;let f=this.ids[u],g=this.values[u];const m=this.values[d];if(d<this.length&&m<g&&(u=d,f=this.ids[d],g=m),g>=o)break;this.ids[s]=f,this.values[s]=g,s=u}this.ids[s]=i,this.values[s]=o}return t}peek(){if(this.length!==0)return this.ids[0]}peekValue(){if(this.length!==0)return this.values[0]}shrink(){this.ids.length=this.values.length=this.length}}const ym=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array],Md=3;class Lf{static from(t,i=0){if(i%8!==0)throw new Error("byteOffset must be 8-byte aligned.");if(!t||t.byteLength===void 0||t.buffer)throw new Error("Data must be an instance of ArrayBuffer or SharedArrayBuffer.");const[o,l]=new Uint8Array(t,i+0,2);if(o!==251)throw new Error("Data does not appear to be in a Flatbush format.");const s=l>>4;if(s!==Md)throw new Error(`Got v${s} data when expected v${Md}.`);const u=ym[l&15];if(!u)throw new Error("Unrecognized array type.");const[d]=new Uint16Array(t,i+2,1),[f]=new Uint32Array(t,i+4,1);return new Lf(f,d,u,void 0,t,i)}constructor(t,i=16,o=Float64Array,l=ArrayBuffer,s,u=0){if(t===void 0)throw new Error("Missing required argument: numItems.");if(isNaN(t)||t<=0)throw new Error(`Unexpected numItems value: ${t}.`);this.numItems=+t,this.nodeSize=Math.min(Math.max(+i,2),65535),this.byteOffset=u;let d=t,f=d;this._levelBounds=[d*4];do d=Math.ceil(d/this.nodeSize),f+=d,this._levelBounds.push(f*4);while(d!==1);this.ArrayType=o,this.IndexArrayType=f<16384?Uint16Array:Uint32Array;const g=ym.indexOf(this.ArrayType),m=f*4*this.ArrayType.BYTES_PER_ELEMENT;if(g<0)throw new Error(`Unexpected typed array class: ${o}.`);s&&s.byteLength!==void 0&&!s.buffer?(this.data=s,this._boxes=new this.ArrayType(this.data,u+8,f*4),this._indices=new this.IndexArrayType(this.data,u+8+m,f),this._pos=f*4,this.minX=this._boxes[this._pos-4],this.minY=this._boxes[this._pos-3],this.maxX=this._boxes[this._pos-2],this.maxY=this._boxes[this._pos-1]):(this.data=new l(8+m+f*this.IndexArrayType.BYTES_PER_ELEMENT),this._boxes=new this.ArrayType(this.data,8,f*4),this._indices=new this.IndexArrayType(this.data,8+m,f),this._pos=0,this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0,new Uint8Array(this.data,0,2).set([251,(Md<<4)+g]),new Uint16Array(this.data,2,1)[0]=i,new Uint32Array(this.data,4,1)[0]=t),this._queue=new VT}add(t,i,o=t,l=i){const s=this._pos>>2,u=this._boxes;return this._indices[s]=s,u[this._pos++]=t,u[this._pos++]=i,u[this._pos++]=o,u[this._pos++]=l,t<this.minX&&(this.minX=t),i<this.minY&&(this.minY=i),o>this.maxX&&(this.maxX=o),l>this.maxY&&(this.maxY=l),s}finish(){if(this._pos>>2!==this.numItems)throw new Error(`Added ${this._pos>>2} items when expected ${this.numItems}.`);const t=this._boxes;if(this.numItems<=this.nodeSize){t[this._pos++]=this.minX,t[this._pos++]=this.minY,t[this._pos++]=this.maxX,t[this._pos++]=this.maxY;return}const i=this.maxX-this.minX||1,o=this.maxY-this.minY||1,l=new Uint32Array(this.numItems),s=65535;for(let u=0,d=0;u<this.numItems;u++){const f=t[d++],g=t[d++],m=t[d++],v=t[d++],y=Math.floor(s*((f+m)/2-this.minX)/i),A=Math.floor(s*((g+v)/2-this.minY)/o);l[u]=KT(y,A)}df(l,t,this._indices,0,this.numItems-1,this.nodeSize);for(let u=0,d=0;u<this._levelBounds.length-1;u++){const f=this._levelBounds[u];for(;d<f;){const g=d;let m=t[d++],v=t[d++],y=t[d++],A=t[d++];for(let I=1;I<this.nodeSize&&d<f;I++)m=Math.min(m,t[d++]),v=Math.min(v,t[d++]),y=Math.max(y,t[d++]),A=Math.max(A,t[d++]);this._indices[this._pos>>2]=g,t[this._pos++]=m,t[this._pos++]=v,t[this._pos++]=y,t[this._pos++]=A}}}search(t,i,o,l,s){if(this._pos!==this._boxes.length)throw new Error("Data not yet indexed - call index.finish().");let u=this._boxes.length-4;const d=[],f=[];for(;u!==void 0;){const g=Math.min(u+this.nodeSize*4,Am(u,this._levelBounds));for(let m=u;m<g;m+=4){if(o<this._boxes[m]||l<this._boxes[m+1]||t>this._boxes[m+2]||i>this._boxes[m+3])continue;const v=this._indices[m>>2]|0;u>=this.numItems*4?d.push(v):(s===void 0||s(v))&&f.push(v)}u=d.pop()}return f}neighbors(t,i,o=1/0,l=1/0,s){if(this._pos!==this._boxes.length)throw new Error("Data not yet indexed - call index.finish().");let u=this._boxes.length-4;const d=this._queue,f=[],g=l*l;e:for(;u!==void 0;){const m=Math.min(u+this.nodeSize*4,Am(u,this._levelBounds));for(let v=u;v<m;v+=4){const y=this._indices[v>>2]|0,A=Tm(t,this._boxes[v],this._boxes[v+2]),I=Tm(i,this._boxes[v+1],this._boxes[v+3]),E=A*A+I*I;E>g||(u>=this.numItems*4?d.push(y<<1,E):(s===void 0||s(y))&&d.push((y<<1)+1,E))}for(;d.length&&d.peek()&1;)if(d.peekValue()>g||(f.push(d.pop()>>1),f.length===o))break e;u=d.length?d.pop()>>1:void 0}return d.clear(),f}}function Tm(e,t,i){return e<t?t-e:e<=i?0:e-i}function Am(e,t){let i=0,o=t.length-1;for(;i<o;){const l=i+o>>1;t[l]>e?o=l:i=l+1}return t[i]}function df(e,t,i,o,l,s){if(Math.floor(o/s)>=Math.floor(l/s))return;const u=e[o+l>>1];let d=o-1,f=l+1;for(;;){do d++;while(e[d]<u);do f--;while(e[f]>u);if(d>=f)break;XT(e,t,i,d,f)}df(e,t,i,o,f,s),df(e,t,i,f+1,l,s)}function XT(e,t,i,o,l){const s=e[o];e[o]=e[l],e[l]=s;const u=4*o,d=4*l,f=t[u],g=t[u+1],m=t[u+2],v=t[u+3];t[u]=t[d],t[u+1]=t[d+1],t[u+2]=t[d+2],t[u+3]=t[d+3],t[d]=f,t[d+1]=g,t[d+2]=m,t[d+3]=v;const y=i[o];i[o]=i[l],i[l]=y}function KT(e,t){let i=e^t,o=65535^i,l=65535^(e|t),s=e&(t^65535),u=i|o>>1,d=i>>1^i,f=l>>1^o&s>>1^l,g=i&l>>1^s>>1^s;i=u,o=d,l=f,s=g,u=i&i>>2^o&o>>2,d=i&o>>2^o&(i^o)>>2,f^=i&l>>2^o&s>>2,g^=o&l>>2^(i^o)&s>>2,i=u,o=d,l=f,s=g,u=i&i>>4^o&o>>4,d=i&o>>4^o&(i^o)>>4,f^=i&l>>4^o&s>>4,g^=o&l>>4^(i^o)&s>>4,i=u,o=d,l=f,s=g,f^=i&l>>8^o&s>>8,g^=o&l>>8^(i^o)&s>>8,i=f^f>>1,o=g^g>>1;let m=e^t,v=o|65535^(m|i);return m=(m|m<<8)&16711935,m=(m|m<<4)&252645135,m=(m|m<<2)&858993459,m=(m|m<<1)&1431655765,v=(v|v<<8)&16711935,v=(v|v<<4)&252645135,v=(v|v<<2)&858993459,v=(v|v<<1)&1431655765,(v<<1|m)>>>0}function mo(e,t){if(e.length===0)return{all:()=>[],byRect:()=>[],byRadius:()=>[],byProperty:()=>[],resetPropertyCache:()=>{},count:()=>0};const i=new Lf(e.length),o=new Map;for(const s of e)i.add(s.position.x,s.position.y,s.position.x,s.position.y);return i.finish(),{all(){return e},byRect(s){return i.search(s.left,s.top,s.right,s.bottom).map(d=>e[d])},byRadius(s,u){return i.neighbors(s.x,s.y,void 0,u).map(f=>e[f])},byProperty(s,u){var d;if(!o.has(s)){const f=new Map;for(const g of e){const m=g[s];f.has(m)||f.set(m,[]),f.get(m).push(g)}o.set(s,f)}return((d=o.get(s))==null?void 0:d.get(u))||[]},resetPropertyCache(){o.clear()},count(){return e.length}}}function wu(e){const t=Object.values(e.entities.entities),i=t.filter(g=>g.type==="human"),o=t.filter(g=>g.type==="berryBush"),l=t.filter(g=>g.type==="corpse"),s=t.filter(g=>g.type==="prey"),u=t.filter(g=>g.type==="predator"),d=t.filter(g=>g.type==="building");return{...e,search:{human:mo(i),berryBush:mo(o),corpse:mo(l),prey:mo(s),predator:mo(u),building:mo(d)}}}const ZT="tribe-game-db",rr="save-files",Uf="tribe-game-save",ff=1;async function Bf(e){try{const t={version:ff,savedAt:Date.now(),gameState:e},i=JSON.stringify(t),o=await QT(i);await eA(Uf,o),console.log(`Game saved successfully. Size: ${(o.size/1024).toFixed(2)} KB`)}catch(t){throw console.error("Failed to save game:",t),t}}async function qT(){try{const e=await tA(Uf);if(!e)return null;const t=await JT(e),i=JSON.parse(t);return i.version!==ff?(console.warn(`Save game version mismatch. Expected ${ff}, found ${i.version}. Discarding save.`),await hf(),null):(console.log("Game loaded successfully."),wu(i.gameState))}catch(e){return console.error("Failed to load game:",e),await hf(),null}}async function hf(){try{await nA(Uf),console.log("Saved game cleared.")}catch(e){console.error("Failed to clear saved game:",e)}}async function QT(e){const i=new Blob([e]).stream().pipeThrough(new CompressionStream("gzip"));return await new Response(i).blob()}async function JT(e){const t=e.stream().pipeThrough(new DecompressionStream("gzip"));return await new Response(t).text()}function Hf(){return new Promise((e,t)=>{const i=indexedDB.open(ZT,1);i.onupgradeneeded=o=>{const l=o.target.result;l.objectStoreNames.contains(rr)||l.createObjectStore(rr)},i.onsuccess=()=>e(i.result),i.onerror=()=>t(i.error)})}async function eA(e,t){const i=await Hf();return new Promise((o,l)=>{const d=i.transaction(rr,"readwrite").objectStore(rr).put(t,e);d.onsuccess=()=>o(),d.onerror=()=>l(d.error)})}async function tA(e){const t=await Hf();return new Promise((i,o)=>{const u=t.transaction(rr,"readonly").objectStore(rr).get(e);u.onsuccess=()=>i(u.result),u.onerror=()=>o(u.error)})}async function nA(e){const t=await Hf();return new Promise((i,o)=>{const u=t.transaction(rr,"readwrite").objectStore(rr).delete(e);u.onsuccess=()=>i(),u.onerror=()=>o(u.error)})}const V0=Re.createContext(void 0),iA=({initialAppState:e,children:t})=>{const[i,o]=Re.useState(e),[l,s]=Re.useState(void 0),[u,d]=Re.useState(null),[f,g]=Re.useState(!1);Re.useEffect(()=>{qT().then(I=>{I&&d(I),g(!0)})},[]);const m=(I,E)=>{o(I),I==="gameOver"&&E?s(E):I!=="gameOver"&&s(void 0)},v=()=>{o("intro"),s(void 0),A()},y=I=>{Bf(I),d(I)},A=()=>{hf(),d(null)};return Fe.jsx(V0.Provider,{value:{appState:i,setAppState:m,returnToIntro:v,gameOverDetails:l,contextReady:f,savedGameState:u,setSavedGameState:d,saveCurrentGame:y,clearCurrentSave:A},children:t})},Yo=()=>{const e=Re.useContext(V0);if(e===void 0)throw new Error("useGameContext must be used within a GameProvider");return e};var Lt=function(){return Lt=Object.assign||function(t){for(var i,o=1,l=arguments.length;o<l;o++){i=arguments[o];for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&(t[s]=i[s])}return t},Lt.apply(this,arguments)};function aa(e,t,i){if(i||arguments.length===2)for(var o=0,l=t.length,s;o<l;o++)(s||!(o in t))&&(s||(s=Array.prototype.slice.call(t,0,o)),s[o]=t[o]);return e.concat(s||Array.prototype.slice.call(t))}var Ze="-ms-",Qs="-moz-",$e="-webkit-",X0="comm",_u="rule",bf="decl",rA="@import",K0="@keyframes",oA="@layer",Z0=Math.abs,Gf=String.fromCharCode,gf=Object.assign;function sA(e,t){return It(e,0)^45?(((t<<2^It(e,0))<<2^It(e,1))<<2^It(e,2))<<2^It(e,3):0}function q0(e){return e.trim()}function fi(e,t){return(e=t.exec(e))?e[0]:e}function ke(e,t,i){return e.replace(t,i)}function ru(e,t,i){return e.indexOf(t,i)}function It(e,t){return e.charCodeAt(t)|0}function Fo(e,t,i){return e.slice(t,i)}function Jn(e){return e.length}function Q0(e){return e.length}function js(e,t){return t.push(e),e}function aA(e,t){return e.map(t).join("")}function Im(e,t){return e.filter(function(i){return!fi(i,t)})}var Cu=1,Lo=1,J0=0,An=0,ft=0,jo="";function Ru(e,t,i,o,l,s,u,d){return{value:e,root:t,parent:i,type:o,props:l,children:s,line:Cu,column:Lo,length:u,return:"",siblings:d}}function ji(e,t){return gf(Ru("",null,null,"",null,null,0,e.siblings),e,{length:-e.length},t)}function vo(e){for(;e.root;)e=ji(e.root,{children:[e]});js(e,e.siblings)}function lA(){return ft}function uA(){return ft=An>0?It(jo,--An):0,Lo--,ft===10&&(Lo=1,Cu--),ft}function Ln(){return ft=An<J0?It(jo,An++):0,Lo++,ft===10&&(Lo=1,Cu++),ft}function Or(){return It(jo,An)}function ou(){return An}function Pu(e,t){return Fo(jo,e,t)}function pf(e){switch(e){case 0:case 9:case 10:case 13:case 32:return 5;case 33:case 43:case 44:case 47:case 62:case 64:case 126:case 59:case 123:case 125:return 4;case 58:return 3;case 34:case 39:case 40:case 91:return 2;case 41:case 93:return 1}return 0}function cA(e){return Cu=Lo=1,J0=Jn(jo=e),An=0,[]}function dA(e){return jo="",e}function kd(e){return q0(Pu(An-1,mf(e===91?e+2:e===40?e+1:e)))}function fA(e){for(;(ft=Or())&&ft<33;)Ln();return pf(e)>2||pf(ft)>3?"":" "}function hA(e,t){for(;--t&&Ln()&&!(ft<48||ft>102||ft>57&&ft<65||ft>70&&ft<97););return Pu(e,ou()+(t<6&&Or()==32&&Ln()==32))}function mf(e){for(;Ln();)switch(ft){case e:return An;case 34:case 39:e!==34&&e!==39&&mf(ft);break;case 40:e===41&&mf(e);break;case 92:Ln();break}return An}function gA(e,t){for(;Ln()&&e+ft!==57;)if(e+ft===84&&Or()===47)break;return"/*"+Pu(t,An-1)+"*"+Gf(e===47?e:Ln())}function pA(e){for(;!pf(Or());)Ln();return Pu(e,An)}function mA(e){return dA(su("",null,null,null,[""],e=cA(e),0,[0],e))}function su(e,t,i,o,l,s,u,d,f){for(var g=0,m=0,v=u,y=0,A=0,I=0,E=1,C=1,F=1,L=0,D="",H=l,b=s,U=o,$=D;C;)switch(I=L,L=Ln()){case 40:if(I!=108&&It($,v-1)==58){ru($+=ke(kd(L),"&","&\f"),"&\f",Z0(g?d[g-1]:0))!=-1&&(F=-1);break}case 34:case 39:case 91:$+=kd(L);break;case 9:case 10:case 13:case 32:$+=fA(I);break;case 92:$+=hA(ou()-1,7);continue;case 47:switch(Or()){case 42:case 47:js(vA(gA(Ln(),ou()),t,i,f),f);break;default:$+="/"}break;case 123*E:d[g++]=Jn($)*F;case 125*E:case 59:case 0:switch(L){case 0:case 125:C=0;case 59+m:F==-1&&($=ke($,/\f/g,"")),A>0&&Jn($)-v&&js(A>32?wm($+";",o,i,v-1,f):wm(ke($," ","")+";",o,i,v-2,f),f);break;case 59:$+=";";default:if(js(U=Em($,t,i,g,m,l,d,D,H=[],b=[],v,s),s),L===123)if(m===0)su($,t,U,U,H,s,v,d,b);else switch(y===99&&It($,3)===110?100:y){case 100:case 108:case 109:case 115:su(e,U,U,o&&js(Em(e,U,U,0,0,l,d,D,l,H=[],v,b),b),l,b,v,d,o?H:b);break;default:su($,U,U,U,[""],b,0,d,b)}}g=m=A=0,E=F=1,D=$="",v=u;break;case 58:v=1+Jn($),A=I;default:if(E<1){if(L==123)--E;else if(L==125&&E++==0&&uA()==125)continue}switch($+=Gf(L),L*E){case 38:F=m>0?1:($+="\f",-1);break;case 44:d[g++]=(Jn($)-1)*F,F=1;break;case 64:Or()===45&&($+=kd(Ln())),y=Or(),m=v=Jn(D=$+=pA(ou())),L++;break;case 45:I===45&&Jn($)==2&&(E=0)}}return s}function Em(e,t,i,o,l,s,u,d,f,g,m,v){for(var y=l-1,A=l===0?s:[""],I=Q0(A),E=0,C=0,F=0;E<o;++E)for(var L=0,D=Fo(e,y+1,y=Z0(C=u[E])),H=e;L<I;++L)(H=q0(C>0?A[L]+" "+D:ke(D,/&\f/g,A[L])))&&(f[F++]=H);return Ru(e,t,i,l===0?_u:d,f,g,m,v)}function vA(e,t,i,o){return Ru(e,t,i,X0,Gf(lA()),Fo(e,2,-2),0,o)}function wm(e,t,i,o,l){return Ru(e,t,i,bf,Fo(e,0,o),Fo(e,o+1,-1),o,l)}function ev(e,t,i){switch(sA(e,t)){case 5103:return $e+"print-"+e+e;case 5737:case 4201:case 3177:case 3433:case 1641:case 4457:case 2921:case 5572:case 6356:case 5844:case 3191:case 6645:case 3005:case 6391:case 5879:case 5623:case 6135:case 4599:case 4855:case 4215:case 6389:case 5109:case 5365:case 5621:case 3829:return $e+e+e;case 4789:return Qs+e+e;case 5349:case 4246:case 4810:case 6968:case 2756:return $e+e+Qs+e+Ze+e+e;case 5936:switch(It(e,t+11)){case 114:return $e+e+Ze+ke(e,/[svh]\w+-[tblr]{2}/,"tb")+e;case 108:return $e+e+Ze+ke(e,/[svh]\w+-[tblr]{2}/,"tb-rl")+e;case 45:return $e+e+Ze+ke(e,/[svh]\w+-[tblr]{2}/,"lr")+e}case 6828:case 4268:case 2903:return $e+e+Ze+e+e;case 6165:return $e+e+Ze+"flex-"+e+e;case 5187:return $e+e+ke(e,/(\w+).+(:[^]+)/,$e+"box-$1$2"+Ze+"flex-$1$2")+e;case 5443:return $e+e+Ze+"flex-item-"+ke(e,/flex-|-self/g,"")+(fi(e,/flex-|baseline/)?"":Ze+"grid-row-"+ke(e,/flex-|-self/g,""))+e;case 4675:return $e+e+Ze+"flex-line-pack"+ke(e,/align-content|flex-|-self/g,"")+e;case 5548:return $e+e+Ze+ke(e,"shrink","negative")+e;case 5292:return $e+e+Ze+ke(e,"basis","preferred-size")+e;case 6060:return $e+"box-"+ke(e,"-grow","")+$e+e+Ze+ke(e,"grow","positive")+e;case 4554:return $e+ke(e,/([^-])(transform)/g,"$1"+$e+"$2")+e;case 6187:return ke(ke(ke(e,/(zoom-|grab)/,$e+"$1"),/(image-set)/,$e+"$1"),e,"")+e;case 5495:case 3959:return ke(e,/(image-set\([^]*)/,$e+"$1$`$1");case 4968:return ke(ke(e,/(.+:)(flex-)?(.*)/,$e+"box-pack:$3"+Ze+"flex-pack:$3"),/s.+-b[^;]+/,"justify")+$e+e+e;case 4200:if(!fi(e,/flex-|baseline/))return Ze+"grid-column-align"+Fo(e,t)+e;break;case 2592:case 3360:return Ze+ke(e,"template-","")+e;case 4384:case 3616:return i&&i.some(function(o,l){return t=l,fi(o.props,/grid-\w+-end/)})?~ru(e+(i=i[t].value),"span",0)?e:Ze+ke(e,"-start","")+e+Ze+"grid-row-span:"+(~ru(i,"span",0)?fi(i,/\d+/):+fi(i,/\d+/)-+fi(e,/\d+/))+";":Ze+ke(e,"-start","")+e;case 4896:case 4128:return i&&i.some(function(o){return fi(o.props,/grid-\w+-start/)})?e:Ze+ke(ke(e,"-end","-span"),"span ","")+e;case 4095:case 3583:case 4068:case 2532:return ke(e,/(.+)-inline(.+)/,$e+"$1$2")+e;case 8116:case 7059:case 5753:case 5535:case 5445:case 5701:case 4933:case 4677:case 5533:case 5789:case 5021:case 4765:if(Jn(e)-1-t>6)switch(It(e,t+1)){case 109:if(It(e,t+4)!==45)break;case 102:return ke(e,/(.+:)(.+)-([^]+)/,"$1"+$e+"$2-$3$1"+Qs+(It(e,t+3)==108?"$3":"$2-$3"))+e;case 115:return~ru(e,"stretch",0)?ev(ke(e,"stretch","fill-available"),t,i)+e:e}break;case 5152:case 5920:return ke(e,/(.+?):(\d+)(\s*\/\s*(span)?\s*(\d+))?(.*)/,function(o,l,s,u,d,f,g){return Ze+l+":"+s+g+(u?Ze+l+"-span:"+(d?f:+f-+s)+g:"")+e});case 4949:if(It(e,t+6)===121)return ke(e,":",":"+$e)+e;break;case 6444:switch(It(e,It(e,14)===45?18:11)){case 120:return ke(e,/(.+:)([^;\s!]+)(;|(\s+)?!.+)?/,"$1"+$e+(It(e,14)===45?"inline-":"")+"box$3$1"+$e+"$2$3$1"+Ze+"$2box$3")+e;case 100:return ke(e,":",":"+Ze)+e}break;case 5719:case 2647:case 2135:case 3927:case 2391:return ke(e,"scroll-","scroll-snap-")+e}return e}function fu(e,t){for(var i="",o=0;o<e.length;o++)i+=t(e[o],o,e,t)||"";return i}function SA(e,t,i,o){switch(e.type){case oA:if(e.children.length)break;case rA:case bf:return e.return=e.return||e.value;case X0:return"";case K0:return e.return=e.value+"{"+fu(e.children,o)+"}";case _u:if(!Jn(e.value=e.props.join(",")))return""}return Jn(i=fu(e.children,o))?e.return=e.value+"{"+i+"}":""}function yA(e){var t=Q0(e);return function(i,o,l,s){for(var u="",d=0;d<t;d++)u+=e[d](i,o,l,s)||"";return u}}function TA(e){return function(t){t.root||(t=t.return)&&e(t)}}function AA(e,t,i,o){if(e.length>-1&&!e.return)switch(e.type){case bf:e.return=ev(e.value,e.length,i);return;case K0:return fu([ji(e,{value:ke(e.value,"@","@"+$e)})],o);case _u:if(e.length)return aA(i=e.props,function(l){switch(fi(l,o=/(::plac\w+|:read-\w+)/)){case":read-only":case":read-write":vo(ji(e,{props:[ke(l,/:(read-\w+)/,":"+Qs+"$1")]})),vo(ji(e,{props:[l]})),gf(e,{props:Im(i,o)});break;case"::placeholder":vo(ji(e,{props:[ke(l,/:(plac\w+)/,":"+$e+"input-$1")]})),vo(ji(e,{props:[ke(l,/:(plac\w+)/,":"+Qs+"$1")]})),vo(ji(e,{props:[ke(l,/:(plac\w+)/,Ze+"input-$1")]})),vo(ji(e,{props:[l]})),gf(e,{props:Im(i,o)});break}return""})}}var IA={animationIterationCount:1,aspectRatio:1,borderImageOutset:1,borderImageSlice:1,borderImageWidth:1,boxFlex:1,boxFlexGroup:1,boxOrdinalGroup:1,columnCount:1,columns:1,flex:1,flexGrow:1,flexPositive:1,flexShrink:1,flexNegative:1,flexOrder:1,gridRow:1,gridRowEnd:1,gridRowSpan:1,gridRowStart:1,gridColumn:1,gridColumnEnd:1,gridColumnSpan:1,gridColumnStart:1,msGridRow:1,msGridRowSpan:1,msGridColumn:1,msGridColumnSpan:1,fontWeight:1,lineHeight:1,opacity:1,order:1,orphans:1,tabSize:1,widows:1,zIndex:1,zoom:1,WebkitLineClamp:1,fillOpacity:1,floodOpacity:1,stopOpacity:1,strokeDasharray:1,strokeDashoffset:1,strokeMiterlimit:1,strokeOpacity:1,strokeWidth:1},an={},Uo=typeof process<"u"&&an!==void 0&&(an.REACT_APP_SC_ATTR||an.SC_ATTR)||"data-styled",tv="active",nv="data-styled-version",Nu="6.1.13",xf=`/*!sc*/
`,hu=typeof window<"u"&&"HTMLElement"in window,EA=!!(typeof SC_DISABLE_SPEEDY=="boolean"?SC_DISABLE_SPEEDY:typeof process<"u"&&an!==void 0&&an.REACT_APP_SC_DISABLE_SPEEDY!==void 0&&an.REACT_APP_SC_DISABLE_SPEEDY!==""?an.REACT_APP_SC_DISABLE_SPEEDY!=="false"&&an.REACT_APP_SC_DISABLE_SPEEDY:typeof process<"u"&&an!==void 0&&an.SC_DISABLE_SPEEDY!==void 0&&an.SC_DISABLE_SPEEDY!==""&&an.SC_DISABLE_SPEEDY!=="false"&&an.SC_DISABLE_SPEEDY),wA={},Du=Object.freeze([]),Bo=Object.freeze({});function iv(e,t,i){return i===void 0&&(i=Bo),e.theme!==i.theme&&e.theme||t||i.theme}var rv=new Set(["a","abbr","address","area","article","aside","audio","b","base","bdi","bdo","big","blockquote","body","br","button","canvas","caption","cite","code","col","colgroup","data","datalist","dd","del","details","dfn","dialog","div","dl","dt","em","embed","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","header","hgroup","hr","html","i","iframe","img","input","ins","kbd","keygen","label","legend","li","link","main","map","mark","menu","menuitem","meta","meter","nav","noscript","object","ol","optgroup","option","output","p","param","picture","pre","progress","q","rp","rt","ruby","s","samp","script","section","select","small","source","span","strong","style","sub","summary","sup","table","tbody","td","textarea","tfoot","th","thead","time","tr","track","u","ul","use","var","video","wbr","circle","clipPath","defs","ellipse","foreignObject","g","image","line","linearGradient","marker","mask","path","pattern","polygon","polyline","radialGradient","rect","stop","svg","text","tspan"]),_A=/[!"#$%&'()*+,./:;<=>?@[\\\]^`{|}~-]+/g,CA=/(^-|-$)/g;function _m(e){return e.replace(_A,"-").replace(CA,"")}var RA=/(a)(d)/gi,Ul=52,Cm=function(e){return String.fromCharCode(e+(e>25?39:97))};function vf(e){var t,i="";for(t=Math.abs(e);t>Ul;t=t/Ul|0)i=Cm(t%Ul)+i;return(Cm(t%Ul)+i).replace(RA,"$1-$2")}var Fd,ov=5381,Ro=function(e,t){for(var i=t.length;i;)e=33*e^t.charCodeAt(--i);return e},sv=function(e){return Ro(ov,e)};function av(e){return vf(sv(e)>>>0)}function PA(e){return e.displayName||e.name||"Component"}function Ld(e){return typeof e=="string"&&!0}var lv=typeof Symbol=="function"&&Symbol.for,uv=lv?Symbol.for("react.memo"):60115,NA=lv?Symbol.for("react.forward_ref"):60112,DA={childContextTypes:!0,contextType:!0,contextTypes:!0,defaultProps:!0,displayName:!0,getDefaultProps:!0,getDerivedStateFromError:!0,getDerivedStateFromProps:!0,mixins:!0,propTypes:!0,type:!0},OA={name:!0,length:!0,prototype:!0,caller:!0,callee:!0,arguments:!0,arity:!0},cv={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},MA=((Fd={})[NA]={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},Fd[uv]=cv,Fd);function Rm(e){return("type"in(t=e)&&t.type.$$typeof)===uv?cv:"$$typeof"in e?MA[e.$$typeof]:DA;var t}var kA=Object.defineProperty,FA=Object.getOwnPropertyNames,Pm=Object.getOwnPropertySymbols,LA=Object.getOwnPropertyDescriptor,UA=Object.getPrototypeOf,Nm=Object.prototype;function dv(e,t,i){if(typeof t!="string"){if(Nm){var o=UA(t);o&&o!==Nm&&dv(e,o,i)}var l=FA(t);Pm&&(l=l.concat(Pm(t)));for(var s=Rm(e),u=Rm(t),d=0;d<l.length;++d){var f=l[d];if(!(f in OA||i&&i[f]||u&&f in u||s&&f in s)){var g=LA(t,f);try{kA(e,f,g)}catch{}}}}return e}function Ho(e){return typeof e=="function"}function $f(e){return typeof e=="object"&&"styledComponentId"in e}function Nr(e,t){return e&&t?"".concat(e," ").concat(t):e||t||""}function Sf(e,t){if(e.length===0)return"";for(var i=e[0],o=1;o<e.length;o++)i+=e[o];return i}function la(e){return e!==null&&typeof e=="object"&&e.constructor.name===Object.name&&!("props"in e&&e.$$typeof)}function yf(e,t,i){if(i===void 0&&(i=!1),!i&&!la(e)&&!Array.isArray(e))return t;if(Array.isArray(t))for(var o=0;o<t.length;o++)e[o]=yf(e[o],t[o]);else if(la(t))for(var o in t)e[o]=yf(e[o],t[o]);return e}function zf(e,t){Object.defineProperty(e,"toString",{value:t})}function Aa(e){for(var t=[],i=1;i<arguments.length;i++)t[i-1]=arguments[i];return new Error("An error occurred. See https://github.com/styled-components/styled-components/blob/main/packages/styled-components/src/utils/errors.md#".concat(e," for more information.").concat(t.length>0?" Args: ".concat(t.join(", ")):""))}var BA=function(){function e(t){this.groupSizes=new Uint32Array(512),this.length=512,this.tag=t}return e.prototype.indexOfGroup=function(t){for(var i=0,o=0;o<t;o++)i+=this.groupSizes[o];return i},e.prototype.insertRules=function(t,i){if(t>=this.groupSizes.length){for(var o=this.groupSizes,l=o.length,s=l;t>=s;)if((s<<=1)<0)throw Aa(16,"".concat(t));this.groupSizes=new Uint32Array(s),this.groupSizes.set(o),this.length=s;for(var u=l;u<s;u++)this.groupSizes[u]=0}for(var d=this.indexOfGroup(t+1),f=(u=0,i.length);u<f;u++)this.tag.insertRule(d,i[u])&&(this.groupSizes[t]++,d++)},e.prototype.clearGroup=function(t){if(t<this.length){var i=this.groupSizes[t],o=this.indexOfGroup(t),l=o+i;this.groupSizes[t]=0;for(var s=o;s<l;s++)this.tag.deleteRule(o)}},e.prototype.getGroup=function(t){var i="";if(t>=this.length||this.groupSizes[t]===0)return i;for(var o=this.groupSizes[t],l=this.indexOfGroup(t),s=l+o,u=l;u<s;u++)i+="".concat(this.tag.getRule(u)).concat(xf);return i},e}(),au=new Map,gu=new Map,lu=1,Bl=function(e){if(au.has(e))return au.get(e);for(;gu.has(lu);)lu++;var t=lu++;return au.set(e,t),gu.set(t,e),t},HA=function(e,t){lu=t+1,au.set(e,t),gu.set(t,e)},bA="style[".concat(Uo,"][").concat(nv,'="').concat(Nu,'"]'),GA=new RegExp("^".concat(Uo,'\\.g(\\d+)\\[id="([\\w\\d-]+)"\\].*?"([^"]*)')),xA=function(e,t,i){for(var o,l=i.split(","),s=0,u=l.length;s<u;s++)(o=l[s])&&e.registerName(t,o)},$A=function(e,t){for(var i,o=((i=t.textContent)!==null&&i!==void 0?i:"").split(xf),l=[],s=0,u=o.length;s<u;s++){var d=o[s].trim();if(d){var f=d.match(GA);if(f){var g=0|parseInt(f[1],10),m=f[2];g!==0&&(HA(m,g),xA(e,m,f[3]),e.getTag().insertRules(g,l)),l.length=0}else l.push(d)}}},Dm=function(e){for(var t=document.querySelectorAll(bA),i=0,o=t.length;i<o;i++){var l=t[i];l&&l.getAttribute(Uo)!==tv&&($A(e,l),l.parentNode&&l.parentNode.removeChild(l))}};function zA(){return typeof __webpack_nonce__<"u"?__webpack_nonce__:null}var fv=function(e){var t=document.head,i=e||t,o=document.createElement("style"),l=function(d){var f=Array.from(d.querySelectorAll("style[".concat(Uo,"]")));return f[f.length-1]}(i),s=l!==void 0?l.nextSibling:null;o.setAttribute(Uo,tv),o.setAttribute(nv,Nu);var u=zA();return u&&o.setAttribute("nonce",u),i.insertBefore(o,s),o},WA=function(){function e(t){this.element=fv(t),this.element.appendChild(document.createTextNode("")),this.sheet=function(i){if(i.sheet)return i.sheet;for(var o=document.styleSheets,l=0,s=o.length;l<s;l++){var u=o[l];if(u.ownerNode===i)return u}throw Aa(17)}(this.element),this.length=0}return e.prototype.insertRule=function(t,i){try{return this.sheet.insertRule(i,t),this.length++,!0}catch{return!1}},e.prototype.deleteRule=function(t){this.sheet.deleteRule(t),this.length--},e.prototype.getRule=function(t){var i=this.sheet.cssRules[t];return i&&i.cssText?i.cssText:""},e}(),YA=function(){function e(t){this.element=fv(t),this.nodes=this.element.childNodes,this.length=0}return e.prototype.insertRule=function(t,i){if(t<=this.length&&t>=0){var o=document.createTextNode(i);return this.element.insertBefore(o,this.nodes[t]||null),this.length++,!0}return!1},e.prototype.deleteRule=function(t){this.element.removeChild(this.nodes[t]),this.length--},e.prototype.getRule=function(t){return t<this.length?this.nodes[t].textContent:""},e}(),jA=function(){function e(t){this.rules=[],this.length=0}return e.prototype.insertRule=function(t,i){return t<=this.length&&(this.rules.splice(t,0,i),this.length++,!0)},e.prototype.deleteRule=function(t){this.rules.splice(t,1),this.length--},e.prototype.getRule=function(t){return t<this.length?this.rules[t]:""},e}(),Om=hu,VA={isServer:!hu,useCSSOMInjection:!EA},pu=function(){function e(t,i,o){t===void 0&&(t=Bo),i===void 0&&(i={});var l=this;this.options=Lt(Lt({},VA),t),this.gs=i,this.names=new Map(o),this.server=!!t.isServer,!this.server&&hu&&Om&&(Om=!1,Dm(this)),zf(this,function(){return function(s){for(var u=s.getTag(),d=u.length,f="",g=function(v){var y=function(F){return gu.get(F)}(v);if(y===void 0)return"continue";var A=s.names.get(y),I=u.getGroup(v);if(A===void 0||!A.size||I.length===0)return"continue";var E="".concat(Uo,".g").concat(v,'[id="').concat(y,'"]'),C="";A!==void 0&&A.forEach(function(F){F.length>0&&(C+="".concat(F,","))}),f+="".concat(I).concat(E,'{content:"').concat(C,'"}').concat(xf)},m=0;m<d;m++)g(m);return f}(l)})}return e.registerId=function(t){return Bl(t)},e.prototype.rehydrate=function(){!this.server&&hu&&Dm(this)},e.prototype.reconstructWithOptions=function(t,i){return i===void 0&&(i=!0),new e(Lt(Lt({},this.options),t),this.gs,i&&this.names||void 0)},e.prototype.allocateGSInstance=function(t){return this.gs[t]=(this.gs[t]||0)+1},e.prototype.getTag=function(){return this.tag||(this.tag=(t=function(i){var o=i.useCSSOMInjection,l=i.target;return i.isServer?new jA(l):o?new WA(l):new YA(l)}(this.options),new BA(t)));var t},e.prototype.hasNameForId=function(t,i){return this.names.has(t)&&this.names.get(t).has(i)},e.prototype.registerName=function(t,i){if(Bl(t),this.names.has(t))this.names.get(t).add(i);else{var o=new Set;o.add(i),this.names.set(t,o)}},e.prototype.insertRules=function(t,i,o){this.registerName(t,i),this.getTag().insertRules(Bl(t),o)},e.prototype.clearNames=function(t){this.names.has(t)&&this.names.get(t).clear()},e.prototype.clearRules=function(t){this.getTag().clearGroup(Bl(t)),this.clearNames(t)},e.prototype.clearTag=function(){this.tag=void 0},e}(),XA=/&/g,KA=/^\s*\/\/.*$/gm;function hv(e,t){return e.map(function(i){return i.type==="rule"&&(i.value="".concat(t," ").concat(i.value),i.value=i.value.replaceAll(",",",".concat(t," ")),i.props=i.props.map(function(o){return"".concat(t," ").concat(o)})),Array.isArray(i.children)&&i.type!=="@keyframes"&&(i.children=hv(i.children,t)),i})}function ZA(e){var t,i,o,l=Bo,s=l.options,u=s===void 0?Bo:s,d=l.plugins,f=d===void 0?Du:d,g=function(y,A,I){return I.startsWith(i)&&I.endsWith(i)&&I.replaceAll(i,"").length>0?".".concat(t):y},m=f.slice();m.push(function(y){y.type===_u&&y.value.includes("&")&&(y.props[0]=y.props[0].replace(XA,i).replace(o,g))}),u.prefix&&m.push(AA),m.push(SA);var v=function(y,A,I,E){A===void 0&&(A=""),I===void 0&&(I=""),E===void 0&&(E="&"),t=E,i=A,o=new RegExp("\\".concat(i,"\\b"),"g");var C=y.replace(KA,""),F=mA(I||A?"".concat(I," ").concat(A," { ").concat(C," }"):C);u.namespace&&(F=hv(F,u.namespace));var L=[];return fu(F,yA(m.concat(TA(function(D){return L.push(D)})))),L};return v.hash=f.length?f.reduce(function(y,A){return A.name||Aa(15),Ro(y,A.name)},ov).toString():"",v}var qA=new pu,Tf=ZA(),gv=ei.createContext({shouldForwardProp:void 0,styleSheet:qA,stylis:Tf});gv.Consumer;ei.createContext(void 0);function Af(){return Re.useContext(gv)}var QA=function(){function e(t,i){var o=this;this.inject=function(l,s){s===void 0&&(s=Tf);var u=o.name+s.hash;l.hasNameForId(o.id,u)||l.insertRules(o.id,u,s(o.rules,u,"@keyframes"))},this.name=t,this.id="sc-keyframes-".concat(t),this.rules=i,zf(this,function(){throw Aa(12,String(o.name))})}return e.prototype.getName=function(t){return t===void 0&&(t=Tf),this.name+t.hash},e}(),JA=function(e){return e>="A"&&e<="Z"};function Mm(e){for(var t="",i=0;i<e.length;i++){var o=e[i];if(i===1&&o==="-"&&e[0]==="-")return e;JA(o)?t+="-"+o.toLowerCase():t+=o}return t.startsWith("ms-")?"-"+t:t}var pv=function(e){return e==null||e===!1||e===""},mv=function(e){var t,i,o=[];for(var l in e){var s=e[l];e.hasOwnProperty(l)&&!pv(s)&&(Array.isArray(s)&&s.isCss||Ho(s)?o.push("".concat(Mm(l),":"),s,";"):la(s)?o.push.apply(o,aa(aa(["".concat(l," {")],mv(s),!1),["}"],!1)):o.push("".concat(Mm(l),": ").concat((t=l,(i=s)==null||typeof i=="boolean"||i===""?"":typeof i!="number"||i===0||t in IA||t.startsWith("--")?String(i).trim():"".concat(i,"px")),";")))}return o};function nr(e,t,i,o){if(pv(e))return[];if($f(e))return[".".concat(e.styledComponentId)];if(Ho(e)){if(!Ho(s=e)||s.prototype&&s.prototype.isReactComponent||!t)return[e];var l=e(t);return nr(l,t,i,o)}var s;return e instanceof QA?i?(e.inject(i,o),[e.getName(o)]):[e]:la(e)?mv(e):Array.isArray(e)?Array.prototype.concat.apply(Du,e.map(function(u){return nr(u,t,i,o)})):[e.toString()]}function vv(e){for(var t=0;t<e.length;t+=1){var i=e[t];if(Ho(i)&&!$f(i))return!1}return!0}var eI=sv(Nu),tI=function(){function e(t,i,o){this.rules=t,this.staticRulesId="",this.isStatic=(o===void 0||o.isStatic)&&vv(t),this.componentId=i,this.baseHash=Ro(eI,i),this.baseStyle=o,pu.registerId(i)}return e.prototype.generateAndInjectStyles=function(t,i,o){var l=this.baseStyle?this.baseStyle.generateAndInjectStyles(t,i,o):"";if(this.isStatic&&!o.hash)if(this.staticRulesId&&i.hasNameForId(this.componentId,this.staticRulesId))l=Nr(l,this.staticRulesId);else{var s=Sf(nr(this.rules,t,i,o)),u=vf(Ro(this.baseHash,s)>>>0);if(!i.hasNameForId(this.componentId,u)){var d=o(s,".".concat(u),void 0,this.componentId);i.insertRules(this.componentId,u,d)}l=Nr(l,u),this.staticRulesId=u}else{for(var f=Ro(this.baseHash,o.hash),g="",m=0;m<this.rules.length;m++){var v=this.rules[m];if(typeof v=="string")g+=v;else if(v){var y=Sf(nr(v,t,i,o));f=Ro(f,y+m),g+=y}}if(g){var A=vf(f>>>0);i.hasNameForId(this.componentId,A)||i.insertRules(this.componentId,A,o(g,".".concat(A),void 0,this.componentId)),l=Nr(l,A)}}return l},e}(),Wf=ei.createContext(void 0);Wf.Consumer;var Ud={};function nI(e,t,i){var o=$f(e),l=e,s=!Ld(e),u=t.attrs,d=u===void 0?Du:u,f=t.componentId,g=f===void 0?function(H,b){var U=typeof H!="string"?"sc":_m(H);Ud[U]=(Ud[U]||0)+1;var $="".concat(U,"-").concat(av(Nu+U+Ud[U]));return b?"".concat(b,"-").concat($):$}(t.displayName,t.parentComponentId):f,m=t.displayName,v=m===void 0?function(H){return Ld(H)?"styled.".concat(H):"Styled(".concat(PA(H),")")}(e):m,y=t.displayName&&t.componentId?"".concat(_m(t.displayName),"-").concat(t.componentId):t.componentId||g,A=o&&l.attrs?l.attrs.concat(d).filter(Boolean):d,I=t.shouldForwardProp;if(o&&l.shouldForwardProp){var E=l.shouldForwardProp;if(t.shouldForwardProp){var C=t.shouldForwardProp;I=function(H,b){return E(H,b)&&C(H,b)}}else I=E}var F=new tI(i,y,o?l.componentStyle:void 0);function L(H,b){return function(U,$,ee){var _e=U.attrs,Ce=U.componentStyle,be=U.defaultProps,De=U.foldedComponentIds,Pe=U.styledComponentId,de=U.target,Le=ei.useContext(Wf),Te=Af(),ne=U.shouldForwardProp||Te.shouldForwardProp,W=iv($,Le,be)||Bo,X=function(Se,le,Ee){for(var Ae,Z=Lt(Lt({},le),{className:void 0,theme:Ee}),re=0;re<Se.length;re+=1){var Ue=Ho(Ae=Se[re])?Ae(Z):Ae;for(var ge in Ue)Z[ge]=ge==="className"?Nr(Z[ge],Ue[ge]):ge==="style"?Lt(Lt({},Z[ge]),Ue[ge]):Ue[ge]}return le.className&&(Z.className=Nr(Z.className,le.className)),Z}(_e,$,W),j=X.as||de,P={};for(var B in X)X[B]===void 0||B[0]==="$"||B==="as"||B==="theme"&&X.theme===W||(B==="forwardedAs"?P.as=X.forwardedAs:ne&&!ne(B,j)||(P[B]=X[B]));var K=function(Se,le){var Ee=Af(),Ae=Se.generateAndInjectStyles(le,Ee.styleSheet,Ee.stylis);return Ae}(Ce,X),ie=Nr(De,Pe);return K&&(ie+=" "+K),X.className&&(ie+=" "+X.className),P[Ld(j)&&!rv.has(j)?"class":"className"]=ie,P.ref=ee,Re.createElement(j,P)}(D,H,b)}L.displayName=v;var D=ei.forwardRef(L);return D.attrs=A,D.componentStyle=F,D.displayName=v,D.shouldForwardProp=I,D.foldedComponentIds=o?Nr(l.foldedComponentIds,l.styledComponentId):"",D.styledComponentId=y,D.target=o?l.target:e,Object.defineProperty(D,"defaultProps",{get:function(){return this._foldedDefaultProps},set:function(H){this._foldedDefaultProps=o?function(b){for(var U=[],$=1;$<arguments.length;$++)U[$-1]=arguments[$];for(var ee=0,_e=U;ee<_e.length;ee++)yf(b,_e[ee],!0);return b}({},l.defaultProps,H):H}}),zf(D,function(){return".".concat(D.styledComponentId)}),s&&dv(D,e,{attrs:!0,componentStyle:!0,displayName:!0,foldedComponentIds:!0,shouldForwardProp:!0,styledComponentId:!0,target:!0}),D}function km(e,t){for(var i=[e[0]],o=0,l=t.length;o<l;o+=1)i.push(t[o],e[o+1]);return i}var Fm=function(e){return Object.assign(e,{isCss:!0})};function Sv(e){for(var t=[],i=1;i<arguments.length;i++)t[i-1]=arguments[i];if(Ho(e)||la(e))return Fm(nr(km(Du,aa([e],t,!0))));var o=e;return t.length===0&&o.length===1&&typeof o[0]=="string"?nr(o):Fm(nr(km(o,t)))}function If(e,t,i){if(i===void 0&&(i=Bo),!t)throw Aa(1,t);var o=function(l){for(var s=[],u=1;u<arguments.length;u++)s[u-1]=arguments[u];return e(t,i,Sv.apply(void 0,aa([l],s,!1)))};return o.attrs=function(l){return If(e,t,Lt(Lt({},i),{attrs:Array.prototype.concat(i.attrs,l).filter(Boolean)}))},o.withConfig=function(l){return If(e,t,Lt(Lt({},i),l))},o}var yv=function(e){return If(nI,e)},En=yv;rv.forEach(function(e){En[e]=yv(e)});var iI=function(){function e(t,i){this.rules=t,this.componentId=i,this.isStatic=vv(t),pu.registerId(this.componentId+1)}return e.prototype.createStyles=function(t,i,o,l){var s=l(Sf(nr(this.rules,i,o,l)),""),u=this.componentId+t;o.insertRules(u,u,s)},e.prototype.removeStyles=function(t,i){i.clearRules(this.componentId+t)},e.prototype.renderStyles=function(t,i,o,l){t>2&&pu.registerId(this.componentId+t),this.removeStyles(t,o),this.createStyles(t,i,o,l)},e}();function rI(e){for(var t=[],i=1;i<arguments.length;i++)t[i-1]=arguments[i];var o=Sv.apply(void 0,aa([e],t,!1)),l="sc-global-".concat(av(JSON.stringify(o))),s=new iI(o,l),u=function(f){var g=Af(),m=ei.useContext(Wf),v=ei.useRef(g.styleSheet.allocateGSInstance(l)).current;return g.styleSheet.server&&d(v,f,g.styleSheet,m,g.stylis),ei.useLayoutEffect(function(){if(!g.styleSheet.server)return d(v,f,g.styleSheet,m,g.stylis),function(){return s.removeStyles(v,g.styleSheet)}},[v,f,g.styleSheet,m,g.stylis]),null};function d(f,g,m,v,y){if(s.isStatic)s.renderStyles(f,wA,m,y);else{var A=Lt(Lt({},g),{theme:iv(g,v,u.defaultProps)});s.renderStyles(f,A,m,y)}}return ei.memo(u)}function Tv(e,t){var i=Re.useRef(null),o=Re.useRef(!1),l=Re.useRef(e);l.current=e;var s=Re.useCallback(function(d){o.current&&(l.current(d),i.current=requestAnimationFrame(s))},[]),u=Re.useMemo(function(){return[function(){o.current&&(o.current=!1,i.current&&cancelAnimationFrame(i.current))},function(){o.current||(o.current=!0,i.current=requestAnimationFrame(s))},function(){return o.current}]},[]);return Re.useEffect(function(){return u[0]},[]),u}function oI(e,t,i,o,l){var u;(u=e.onExit)==null||u.call(e,o,t);const s=l.find(({id:d})=>d===t);return s!=null&&s.onEnter?s.onEnter(o,i):{...i,enteredAt:o.updateContext.gameState.time}}function sI(e,t){return t.find(({id:i})=>i===e)}function aI(e,t){return e!==t}function lI(e){console.warn(`No handler found for state: ${e}`)}const Js="bushGrowing",Pr="bushFull",uu="bushSpreading",ua="bushDying",Et=24,wt=10,et=3e3,tt=3e3,Yf=2,uI=15,cI=5e3,pi=100,mi=20,vi=60,dI=1e3,fI=5,hI=3,gI=12,pI=940,Ef=20,Lm=90,Av=45,Hr=5,mI=.5,br=30,Si=.1,Vs=.9;var Bn=(e=>(e.Berry="berry",e.Meat="meat",e))(Bn||{});const jf={berry:"",meat:""},vI={id:Js,update:(e,t)=>{const{entity:i,updateContext:o}=t,l=o.deltaTime*(Et/wt);return i.age+=l,i.age>=i.lifespan?{nextState:ua,data:{...e,enteredAt:o.gameState.time}}:(i.timeSinceLastBerryRegen+=l,i.timeSinceLastBerryRegen>=gI&&i.food.length<i.maxFood&&(i.food.push({type:Bn.Berry}),i.timeSinceLastBerryRegen=0),i.food.length>=i.maxFood?{nextState:Pr,data:{...e,enteredAt:o.gameState.time,previousState:Js}}:{nextState:Js,data:e})},onEnter:(e,t)=>({...t,enteredAt:e.updateContext.gameState.time})},SI={id:Pr,update:(e,t)=>{const{entity:i,updateContext:o}=t,l=o.deltaTime*(Et/wt);return i.age+=l,i.age>=i.lifespan?{nextState:ua,data:{...e,enteredAt:o.gameState.time,previousState:Pr}}:i.food.length<i.maxFood?{nextState:Js,data:{...e,enteredAt:o.gameState.time,previousState:Pr}}:(i.timeSinceLastSpreadAttempt+=l,i.timeSinceLastSpreadAttempt>=Lm&&(i.timeSinceLastSpreadAttempt=0,o.gameState.time-i.timeSinceLastHarvest>=Lm&&Math.random()<o.gameState.ecosystem.berryBushSpreadChance)?{nextState:uu,data:{...e,enteredAt:o.gameState.time,previousState:Pr}}:{nextState:Pr,data:e})},onEnter:(e,t)=>({...t,enteredAt:e.updateContext.gameState.time})},ca=1,wf=150*.6,yI=150*.25,TI=150*.7,AI=150*.8,II=400,EI=800,Iv=100,wI=250,_I=120,CI=2,Um=400,RI=1e3,PI=150*.85,NI=100,DI=3,OI=96,MI=24,kI=600,Ev=600,FI=1,LI=24,UI=1,BI=.5,HI=2,_f=24,Xs=12,bI=24,Bm=24,GI=1500,Bd=500,xI=400,$I=10,zI=-5,WI=1.5,YI=1.5,jI=1.2,VI=10,XI=150,KI=200,ZI=100,qI=.7,QI=300,JI=100,eE=120,Hm=400,wv=.15,_v=200,cu=30*.75*1.2,tE=20,nE=.3,iE=.6,rE=.8,oE=1,sE=3,aE=5,lE=6,bm=.5,uE=.4,cE=.6,dE=.8,fE=2,Gm=800,hE=60,xm=5,$m=.7,zm=2.5,Wm=3,Ym=2,gE=.1,pE=400,mE=800,Cv=5,Rv=600,Ou=10,da=80,vE=3,Bs=5,Gr=150,Pv=Gr*.8,SE=Gr*.2,xr=Gr*.95,or=30,Nv=10,yE=10,TE=.5,mt=30,$r=mt*.75,Dv=50,AE=20,IE=da*.8,EE=.7,wE=16,Ov=40,_E=24,Vf=16,CE=72/3,jm=24,RE=1.25,PE=1.5,Xf=Gr*.6,Kf=50,NE=1,DE=350,Zf=da*.65,OE=80,ME=50,kE=1,FE=128,Mv=10,Vm=100,qf=35,ti=mt,kv=.5,Mu=2.5,LE=5,Qf=.5,Jf=1.5,UE=.1,BE=.5,HE=1.5,bE=.25,GE=2.5,xE=45,$E=.05;function Un(e,t){return{x:e.x+t.x,y:e.y+t.y}}function Fv(e,t){return{x:e.x-t.x,y:e.y-t.y}}function Pt(e,t){return{x:e.x*t,y:e.y*t}}function bo(e){return Math.sqrt(e.x*e.x+e.y*e.y)}function nt(e){const t=bo(e);return t===0?{x:0,y:0}:Pt(e,1/t)}function zE(e,t){return bo(Fv(e,t))}function eh(e,t,i){return{x:e.x+(t.x-e.x)*i,y:e.y+(t.y-e.y)*i}}function mu(e){if(e.length===0)return{x:0,y:0};const t=e.reduce((i,o)=>({x:i.x+o.x,y:i.y+o.y}),{x:0,y:0});return{x:t.x/e.length,y:t.y/e.length}}function ze(e,t,i,o){let l=t.x-e.x,s=t.y-e.y;return Math.abs(l)>i/2&&(l=l-Math.sign(l)*i),Math.abs(s)>o/2&&(s=s-Math.sign(s)*o),{x:l,y:s}}function Ft(e,t,i){const o=ze(e,t,i.width,i.height);return nt(o)}function Y(e,t,i,o){const l=ze(e,t,i,o);return bo(l)}function WE(e,t){return e.x*t.x+e.y*t.y}function YE(e,t){const i=WE(e,t),o=bo(e),l=bo(t);if(o===0||l===0)return 0;const s=Math.max(-1,Math.min(1,i/(o*l)));return Math.acos(s)}function jE(e,t,i){const o=Math.max(0,Math.min(1,i)),l={r:parseInt(e.substring(1,3),16),g:parseInt(e.substring(3,5),16),b:parseInt(e.substring(5,7),16)},s={r:parseInt(t.substring(1,3),16),g:parseInt(t.substring(3,5),16),b:parseInt(t.substring(5,7),16)},u=Math.round(l.r+(s.r-l.r)*o),d=Math.round(l.g+(s.g-l.g)*o),f=Math.round(l.b+(s.b-l.b)*o),g=m=>("00"+m.toString(16)).slice(-2);return`#${g(u)}${g(d)}${g(f)}`}var pt=(e=>(e.Friendly="Friendly",e.Hostile="Hostile",e))(pt||{}),At=(e=>(e[e.None=0]="None",e[e.General=1]="General",e[e.Performance=2]="Performance",e[e.Ecosystem=3]="Ecosystem",e[e.Tribe=4]="Tribe",e))(At||{});function Xm(e,t,i){return t.search.human.byRadius(e.position,i).filter(s=>{if(s.id===e.id||s.gender===e.gender||!s.isAdult||s.hunger>=xr||(s.procreationCooldown||0)>0||s.gender==="female"&&s.isPregnant)return!1;const u=s.id===e.motherId||s.id===e.fatherId,d=e.id===s.motherId||e.id===s.fatherId;return!u&&!d})}function yi(e){if(e.length===0)return;const t=e.filter(l=>l.gender==="male"),i=e.filter(l=>l.gender==="female"),o=(l,s)=>l.age!==s.age?s.age-l.age:l.id-s.id;if(t.sort(o),t.length>0)return t[0];if(i.sort(o),i.length>0)return i[0]}function Ut(e,t){const i=e,o=i.search.human.byProperty("motherId",t.id),l=i.search.human.byProperty("fatherId",t.id);return[...o,...l]}function VE(e,t,i){var l;if(e.id===t.id||e.motherId===t.id||e.fatherId===t.id||t.motherId===e.id||t.fatherId===e.id||e.motherId&&e.motherId===t.motherId||e.fatherId&&e.fatherId===t.fatherId||(l=e.partnerIds)!=null&&l.includes(t.id))return!0;if(e.motherId){const s=i.entities.entities[e.motherId];if(s&&(s.motherId===t.id||s.fatherId===t.id))return!0}if(e.fatherId){const s=i.entities.entities[e.fatherId];if(s&&(s.motherId===t.id||s.fatherId===t.id))return!0}if(t.motherId){const s=i.entities.entities[t.motherId];if(s&&(s.motherId===e.id||s.fatherId===e.id))return!0}if(t.fatherId){const s=i.entities.entities[t.fatherId];if(s&&(s.motherId===e.id||s.fatherId===e.id))return!0}return!1}function Km(e,t){var s,u,d,f;if(e.id===t.id||e.motherId===t.id||e.fatherId===t.id||t.motherId===e.id||t.fatherId===e.id||(s=e.partnerIds)!=null&&s.includes(t.id)||(u=t.partnerIds)!=null&&u.includes(e.id))return!0;if(e.fatherId===void 0&&e.motherId===void 0||t.fatherId===void 0&&t.motherId===void 0)return!1;const i=e.motherId===t.motherId||e.fatherId===t.fatherId,o=t.motherId===e.motherId||t.fatherId===e.fatherId,l=((d=e.ancestorIds)==null?void 0:d.some(g=>t.ancestorIds.includes(g)))||((f=t.ancestorIds)==null?void 0:f.some(g=>e.ancestorIds.includes(g)));return i||o||l}function XE(e,t){const i=[];if(e.motherId){const o=t.entities.entities[e.motherId];o&&i.push(o)}if(e.fatherId){const o=t.entities.entities[e.fatherId];o&&i.push(o)}return i}function KE(e,t){if(e.gender!=="female"||!e.partnerIds||e.partnerIds.length===0)return null;for(const i of e.partnerIds){const o=t.entities.entities[i];if(o&&o.gender==="male")return o}return null}function ZE(e,t){var i;if(!e.isAdult&&e.fatherId){const o=t.entities.entities[e.fatherId];if(o&&o.type==="human")return o}if(e.isAdult&&e.fatherId){const o=t.entities.entities[e.fatherId];if(o&&o.type==="human"&&((i=yi(Ut(t,o)))==null?void 0:i.id)===e.id)return o}return e.isAdult&&e.gender==="female"&&e.partnerIds&&e.partnerIds.length>0?KE(e,t):null}function vu(e,t){var o;const i=new Set;if(e.motherId){const l=t.entities.entities[e.motherId];l&&i.add(l)}if(e.fatherId){const l=t.entities.entities[e.fatherId];l&&i.add(l)}return(o=e.partnerIds)==null||o.forEach(l=>{const s=t.entities.entities[l];s&&i.add(s)}),Ut(t,e).forEach(l=>i.add(l)),Array.from(i)}function Lv(e,t){const i=new Map;function o(l){const s=Ut(t,l);for(const u of s)i.has(u.id)||(i.set(u.id,u),o(u))}return o(e),Array.from(i.values())}function fa(e,t){return t.search.human.byProperty("leaderId",e)}function Uv(e,t){var u,d;const i=new Map,o=Object.values(e.entities.entities).filter(f=>f.type==="human");for(const f of o)f.leaderId&&(i.has(f.leaderId)||i.set(f.leaderId,{leaderId:f.leaderId,tribeBadge:f.tribeBadge||"?",members:[]}),(u=i.get(f.leaderId))==null||u.members.push(f));const l=t?(d=e.entities.entities[t])==null?void 0:d.diplomacy:void 0,s=Array.from(i.values()).map(f=>{const g=e.entities.entities[f.leaderId],m=f.members.filter(y=>y.isAdult).length,v=f.members.length-m;return{leaderId:f.leaderId,tribeBadge:f.tribeBadge,adultCount:m,childCount:v,isPlayerTribe:f.leaderId===t,leaderAge:(g==null?void 0:g.age)??0,leaderGender:(g==null?void 0:g.gender)??"male",diplomacyStatus:(l==null?void 0:l[f.leaderId??-1])??pt.Friendly}});return s.sort((f,g)=>f.isPlayerTribe?-1:g.isPlayerTribe?1:g.adultCount+g.childCount-(f.adultCount+f.childCount)),s}function Hn(e,t){return e.leaderId?t.search.human.byProperty("leaderId",e.leaderId):[]}function th(e,t,i,o){const l=Math.random()*Math.PI*2,s=Math.sqrt(Math.random())*t,u={x:Math.cos(l)*s,y:Math.sin(l)*s},d=Un(e,u);return{x:(d.x%i+i)%i,y:(d.y%o+o)%o}}function bn(e,t,i,o){const l=t,s={left:e.x-i,top:e.y-i,right:e.x+i,bottom:e.y+i},u=[...l.search.human.byRect(s),...l.search.berryBush.byRect(s),...l.search.corpse.byRect(s)];for(const d of u){if(o!==void 0&&d.id===o)continue;if(Y(e,d.position,t.mapDimensions.width,t.mapDimensions.height)<i+d.radius)return!0}return!1}function qE(e,t,i,o,l){const s=t.mapDimensions.width,u=t.mapDimensions.height;if(!bn(e,t,o,l))return e;const d=o;for(let f=d;f<=i;f+=d){const g=Math.ceil(2*Math.PI*f/d);for(let m=0;m<g;m++){const v=m/g*2*Math.PI,y={x:Math.cos(v)*f,y:Math.sin(v)*f},A=Un(e,y),I={x:(A.x%s+s)%s,y:(A.y%u+u)%u};if(!bn(I,t,o,l))return I}}return null}function zr(e,t){const i=t.search.building.byProperty("ownerId",e);if(i.length>0){const s=i.map(u=>u.position);return mu(s)}const o=fa(e,t);if(o.length===0){const s=t.entities.entities[e];return s?s.position:{x:0,y:0}}const l=o.map(s=>s.position);return mu(l)}function Zm(e,t){const o=[...vu(e,t),e].map(l=>l.position);return mu(o)}function QE(e,t,i){const o=i.mapDimensions.width,l=i.mapDimensions.height;let s=e.x-t.position.x,u=e.y-t.position.y;return Math.abs(s)>o/2&&(s-=Math.sign(s)*o),Math.abs(u)>l/2&&(u-=Math.sign(u)*l),Math.abs(s)<=t.width/2&&Math.abs(u)<=t.height/2}function JE(e,t,i){return t.search.human.byRadius(e.position,i).filter(l=>{var s;return l.activeAction==="procreating"&&l.gender===e.gender&&typeof l.target=="number"&&((s=e.partnerIds)==null?void 0:s.includes(l.target))})[0]}function ew(e,t,i){const o=vu(e,t),l=t;for(const s of o){if(Y(e.position,s.position,t.mapDimensions.width,t.mapDimensions.height)>i)continue;const d=l.search.human.byProperty("attackTargetId",s.id);for(const f of d)if(f.leaderId!==e.leaderId)return{familyMember:s,aggressor:f}}}function tw(e,t){const o=t.search.human.byRadius(e.position,QI);let l,s=1/0;for(const u of o){if(u.id===e.id||u.hitpoints<=0||u.hitpoints/u.maxHitpoints>qI||VE(e,u,t))continue;const d=Y(e.position,u.position,t.mapDimensions.width,t.mapDimensions.height);d<s&&(s=d,l=u)}return l}function nh(e,t,i){return t.search.human.byRadius(e.position,i).filter(l=>Xo(e,l,t))}function nw(e,t,i){const o=i.search.human.byProperty("leaderId",e);let l=0;for(const s of o)s.attackTargetId===t&&l++;return l}function qm(e,t,i,o){const l=i.search.berryBush.byRadius(e,t),s=i.search.human.byRadius(e,t).filter(f=>f.leaderId!==o);let u=l.length*$I;u+=s.length*zI;let d;if(s.length>0){const f={};for(const m of s)m.leaderId&&(f[m.leaderId]=(f[m.leaderId]||0)+1);let g=0;for(const m in f)f[m]>g&&(g=f[m],d=parseInt(m,10))}return{score:u,occupyingTribeId:d}}function Su(e){return e.filter(t=>t.isAdult).reduce((t,i)=>{let o=i.hitpoints;return o+=(i.maxAge-i.age)*.5,o+=i.food.length*2,t+o},0)}function iw(e,t){if(e.id!==e.leaderId)return null;const i=t,o=zr(e.id,t),{score:l}=qm(o,Bd/2,i,e.id);let s=null,u=l;const d=xI,f=GI;for(let g=e.position.x-f;g<e.position.x+f;g+=d)for(let m=e.position.y-f;m<e.position.y+f;m+=d){const v={x:(g%t.mapDimensions.width+t.mapDimensions.width)%t.mapDimensions.width,y:(m%t.mapDimensions.height+t.mapDimensions.height)%t.mapDimensions.height};if(Y(o,v,t.mapDimensions.width,t.mapDimensions.height)<Bd*2)continue;const{score:A}=qm(v,Bd/2,i,e.id);A>u*WI&&(u=A,s=v)}return s}function Ne(e,t,i,o,l){const s=t,u=o,d="position"in e&&e.id?e:null,f=d?d.position:e,g=s.search[i].byRadius(f,u);let m=null,v=u;for(const y of g){if(y.id===(d==null?void 0:d.id)||l&&!l(y))continue;const A=Y(f,y.position,t.mapDimensions.width,t.mapDimensions.height);A<v&&(v=A,m=y)}return m}function rw(e,t,i,o){return t.search[i].byRadius(e,o)}function Qm(e,t,i,o){return rw(e,t,i,o).length}function vt(e){const i=e.search.human.byProperty("isPlayer",!0);return i.length>0?i[0]:void 0}function ow(e,t){var u;const o=t.search.human.byProperty("activeAction","attacking");let l=null,s=1/0;for(const d of o){if(d.attackTargetId!==e)continue;const f=Y(d.position,((u=t.entities.entities[e])==null?void 0:u.position)||{x:0,y:0},t.mapDimensions.width,t.mapDimensions.height);f<s&&(l=d,s=f)}return l}function Bv(e){return Object.values(e.entities.entities).filter(t=>t.type==="human")}function sw(e,t,i){const o=Object.values(t.entities.entities).reverse();for(const l of o)if(zE(e,l.position)<l.radius)return l}function aw(e,t,i,o){const l=Bv(o),s={};for(const u of l)!u.leaderId||u.leaderId===t||(s[u.leaderId]||(s[u.leaderId]={sumX:0,sumY:0,count:0}),s[u.leaderId].sumX+=u.position.x,s[u.leaderId].sumY+=u.position.y,s[u.leaderId].count++);for(const u in s){const d=s[u],f={x:d.sumX/d.count,y:d.sumY/d.count};if(Y(e,f,o.mapDimensions.width,o.mapDimensions.height)<i)return!0}return!1}const _t=30,Vo=_t*.6,Hv="#4CAF50",bv="#FF5722",Gv="#9C27B0",lw="#2196F3",xv="#FFC107",uw="#DC143C",ih="#FFFFFF",rh=[5,5],ku=5,Go=15,cw=20,dw=16,fw=10,hw=16,gw=16,Jm=["","","","","","","","","",""],Cf=8,pw="#FFFFFF",un=18,je=15,mw="rgba(0, 0, 0, 0.7)",vw=4,xi=150,rn=15,ci=10,Qi="#555",Sw="#f44336",yw="#4CAF50",Tw="#2196F3",Aw="#FFC107",Hl=16,Ir=32,bl=28,Iw=10,Ew=8,ww=8,_w=8,vn=28,Gl=40,Cw="rgba(255, 215, 0, 0.7)",Rw="rgba(0, 0, 0, 0.3)",Kn=10,e0=8,Hd=11,$i=20,bd=40,t0=5,Pw=10,Nw="#FFA500",Dw="#808080",gi=120,$v=30,Ow=20,Ki="#2d3748",yn="#ffffff",xl="#4a5568",zv=5,oh="#bdc9f792",Wv="#272c36ff",Yv="#a0aec0",yu=300,jv="rgba(255, 255, 255, 0.5)",Mw="rgba(0, 0, 0, 0.8)",kw="#FFFFFF",n0=14,i0=8,r0=-15,Vv="#FFD700",Xv=5,Fw=60,Lw=-50,Uw=10,Gd=12,o0=10,Bw="rgba(0, 0, 0, 0.5)",Hw="#4CAF50",bw="#F44336",Gw="#FFC107",xw="rgba(255, 255, 255, 0.2)",s0="#FFFFFF",$w="#FF6B6B",zw=5,Kv=30,Hs=50,$l=8,a0=10,Ww="rgba(0, 0, 0, 0.5)",Yw="#FFFFFF",jw=33,Vw=400,Xw=20,Kw=10,Zw="rgba(0, 0, 0, 0.7)",qw="#FFFFFF",xd=20,l0=16,Qw=.5,u0=5,Zv="#FFD700",Jw=40,sh=4,qv=3,e_=5,Qv=20,Jv=5,t_="#FFFFFF",n_="#FF6B6B",on=80,Er=10,zl=300,wr=15,i_=8,r_="rgba(0, 0, 0, 0.8)",o_="#FFFFFF",$d=14,c0=10,Zn=20,s_="#FF6B6B",a_="#4CAF50",d0="#FFD700",l_="rgba(255, 255, 0, 0.3)",u_=2,c_=500,d_=120,f_=45,h_="#FFD700",g_=3,p_=4;let zd=0;function Rf(){const e=Jm[zd];return zd=(zd+1)%Jm.length,e}const f0=20,m_=.3,v_=24,h0=250,xo=10,eS=250,ha=12,tS=10;var ae=(e=>(e.Gather="Gather",e.Eat="Eat",e.Procreate="Procreate",e.Attack="Attack",e.Plant="Plant",e.CallToAttack="CallToAttack",e.TribeSplit="TribeSplit",e.FollowMe="FollowMe",e.FeedChild="FeedChild",e.HuntPrey="HuntPrey",e.DefendAgainstPredator="DefendAgainstPredator",e.Build="Build",e.Removal="Removal",e.Deposit="Deposit",e.Retrieve="Retrieve",e.TakeOverBuilding="TakeOverBuilding",e.RemoveEnemyBuilding="RemoveEnemyBuilding",e.AutopilotMove="AutopilotMove",e.AutopilotGather="AutopilotGather",e.AutopilotAttack="AutopilotAttack",e.AutopilotProcreate="AutopilotProcreate",e.AutopilotPlant="AutopilotPlant",e.AutopilotFeedChild="AutopilotFeedChild",e.AutopilotFollowMe="AutopilotFollowMe",e.AutopilotDeposit="AutopilotDeposit",e.AutopilotRetrieve="AutopilotRetrieve",e))(ae||{});const Fu={Gather:"",Eat:"",Procreate:"",Attack:"",Plant:"",CallToAttack:"",TribeSplit:"",FollowMe:"",FeedChild:"",HuntPrey:"",DefendAgainstPredator:"",Build:"",Removal:"",Deposit:"",Retrieve:"",TakeOverBuilding:"",RemoveEnemyBuilding:"",AutopilotMove:"",AutopilotGather:"",AutopilotAttack:"",AutopilotProcreate:"",AutopilotPlant:"",AutopilotFeedChild:"",AutopilotFollowMe:"",AutopilotDeposit:"",AutopilotRetrieve:""},nS={Gather:"Gather",Eat:"Eat",Procreate:"Procreate",Attack:"Attack",Plant:"Plant",CallToAttack:"Call to Attack",TribeSplit:"Split Tribe",FollowMe:"Follow Me",FeedChild:"Feed Child",HuntPrey:"Hunt Prey",DefendAgainstPredator:"Defend",Build:"Build",Removal:"Remove",Deposit:"Deposit",Retrieve:"Retrieve",TakeOverBuilding:"Take Over",RemoveEnemyBuilding:"Destroy Enemy Building",AutopilotMove:"Walk",AutopilotGather:"Gather",AutopilotAttack:"Attack",AutopilotProcreate:"Procreate",AutopilotPlant:"Plant",AutopilotFeedChild:"Feed",AutopilotFollowMe:"Follow",AutopilotDeposit:"Deposit",AutopilotRetrieve:"Retrieve"};var wo=(e=>(e.Time="Time",e.Hunger="Hunger",e.Hitpoints="Hitpoints",e.Food="Food",e.Autopilot="Autopilot",e.Muted="Muted",e.Family="Family",e.Tribes="Tribes",e))(wo||{});const bs={Time:"",Hunger:"",Hitpoints:"",Food:"",Autopilot:"",Muted:"",Family:"",Tribes:""};var pe=(e=>(e.ToggleMute="ToggleMute",e.TogglePause="TogglePause",e.FastForward="FastForward",e.DismissTutorial="DismissTutorial",e.ReturnToIntro="ReturnToIntro",e.ConfirmExitYes="ConfirmExitYes",e.ConfirmExitNo="ConfirmExitNo",e.CommandEat="CommandEat",e.CommandPlant="CommandPlant",e.CommandCallToAttack="CommandCallToAttack",e.CommandFollowMe="CommandFollowMe",e.CommandGather="CommandGather",e.CommandTribeSplit="CommandTribeSplit",e.CommandBuild="CommandBuild",e.SelectStorageSpot="SelectStorageSpot",e.SelectPlantingZone="SelectPlantingZone",e.SelectRemovalTool="SelectRemovalTool",e.ToggleProcreationBehavior="ToggleProcreationBehavior",e.ToggleAttackBehavior="ToggleAttackBehavior",e.ToggleFeedChildBehavior="ToggleFeedChildBehavior",e.TogglePlantingBehavior="TogglePlantingBehavior",e.ToggleGatheringBehavior="ToggleGatheringBehavior",e.ToggleAutopilotFollowLeaderBehavior="ToggleAutopilotFollowLeaderBehavior",e.ToggleDiplomacy="ToggleDiplomacy",e))(pe||{});const S_=12,y_=24,T_=150*.9,A_=24;var ga=(e=>(e.Hello="HELLO",e.NewTribeFormed="NEW_TRIBE_FORMED",e.NoHeir="NO_HEIR",e.ChildrenStarving="CHILDREN_STARVING",e))(ga||{});let I_=0;function E_(){return`notification-${Date.now()}-${I_++}`}function Pf(e,t){if(t.identifier){const o=e.notifications.find(l=>l.identifier===t.identifier);if(o){if(o.dismissedUntil&&e.time<o.dismissedUntil)return;o.message=t.message,o.timestamp=e.time,o.creationTime=Date.now(),o.duration=t.duration,o.targetEntityIds=t.targetEntityIds,o.highlightedEntityIds=t.highlightedEntityIds,o.targetPosition=t.targetPosition,o.targetArea=t.targetArea,o.targetRadius=t.targetRadius,o.isDismissed=!1,o.dismissedUntil=void 0;return}}const i={...t,id:E_(),timestamp:e.time,creationTime:Date.now(),isDismissed:!1};e.notifications.push(i)}function w_(e,t){const i=e.notifications.find(o=>o.id===t);i&&(i.isDismissed=!0,i.identifier&&(i.dismissedUntil=e.time+A_))}function __(e){const t=e.time;e.notifications=e.notifications.filter(i=>i.duration===0?!0:!(t-i.timestamp>i.duration))}function C_(e){for(const i of Object.values(e.entities.entities))i.isHighlighted=!1;const t=e.notifications.filter(i=>!i.isDismissed);for(const i of t)if(i.highlightedEntityIds)for(const o of i.highlightedEntityIds){const l=e.entities.entities[o];l&&(l.isHighlighted=!0)}}const g0=600,R_=1.5,iS=.1,Wl=""+new URL("attack-D4MA8VWK.mp3",import.meta.url).href,Wd=""+new URL("gather-CU75596W.mp3",import.meta.url).href,P_=""+new URL("eat-DCjHq2QD.mp3",import.meta.url).href,Yd=""+new URL("procreate-CfE4r5Cp.mp3",import.meta.url).href,N_=""+new URL("birth-Cbd67GHT.mp3",import.meta.url).href,D_=""+new URL("child-fed-DzEPuMid.mp3",import.meta.url).href,O_=""+new URL("human-death-B6HFLXES.mp3",import.meta.url).href,M_=""+new URL("game-over-C5dqkyER.mp3",import.meta.url).href,k_=""+new URL("button-click-DomLUeaU.mp3",import.meta.url).href,F_=""+new URL("soundtrack-1-BdlYUGye.mp3",import.meta.url).href;var fe=(e=>(e[e.Attack=0]="Attack",e[e.Gather=1]="Gather",e[e.Eat=2]="Eat",e[e.Procreate=3]="Procreate",e[e.Birth=4]="Birth",e[e.ChildFed=5]="ChildFed",e[e.HumanDeath=6]="HumanDeath",e[e.Seize=7]="Seize",e[e.CallToAttack=8]="CallToAttack",e[e.TribeSplit=9]="TribeSplit",e[e.CallToFollow=10]="CallToFollow",e[e.StorageDeposit=11]="StorageDeposit",e[e.StorageRetrieve=12]="StorageRetrieve",e[e.StorageSteal=13]="StorageSteal",e[e.GameOver=14]="GameOver",e[e.ButtonClick=15]="ButtonClick",e[e.SoundTrack1=16]="SoundTrack1",e))(fe||{});const L_=new Map([[0,Wl],[1,Wd],[2,P_],[3,Yd],[4,N_],[5,D_],[6,O_],[14,M_],[15,k_],[7,Wl],[8,Wl],[9,Yd],[10,Yd],[11,Wd],[12,Wd],[13,Wl],[16,F_]]);let Gs,pa;function U_(){if(!(typeof window>"u"))return pa}function ah(){if(!(typeof window>"u"))return!Gs&&typeof window.AudioContext=="function"&&(Gs=new window.AudioContext,pa=Gs.createGain(),pa.connect(Gs.destination),ea(.1,!1)),Gs}function ea(e,t){pa&&(pa.gain.value=t?0:e/10)}const rS=new Map;let Yl=!1,p0=!1;async function B_(){if(p0||Yl)return;const e=ah();if(!e){console.error("AudioContext not supported. Cannot load sounds.");return}e.state==="suspended"&&e.resume(),Yl=!0,console.log("Starting sound loading...");const t=[];L_.forEach((i,o)=>{const l=fetch(i).then(s=>{if(!s.ok)throw new Error(`Failed to fetch sound: ${i}`);return s.arrayBuffer()}).then(s=>e.decodeAudioData(s)).then(s=>{rS.set(o,s)}).catch(s=>{console.error(`Error loading sound ${fe[o]} from ${i}:`,s)});t.push(l)});try{await Promise.all(t),p0=!0,Yl=!1,console.log("All sounds loaded successfully.")}catch(i){Yl=!1,console.error("An error occurred while loading sounds:",i)}}const ta=new Map;function lh(e,t){const i=ah(),o=U_();if(!i||!o||o.gain.value===0&&(t==null?void 0:t.trackId)===void 0)return;i.state==="suspended"&&i.resume();const l=rS.get(e);if(!l){console.warn(`Sound buffer not found for type: ${fe[e]}`);return}if(t!=null&&t.trackId&&ta.has(t.trackId))return;const s=i.createBufferSource();s.buffer=l,s.loop=(t==null?void 0:t.loop)??!1;const u=i.createGain(),d=i.createStereoPanner();let f=u;if(t!=null&&t.position&&(t!=null&&t.listenerPosition)&&(t!=null&&t.worldDimensions)){const g=ze(t.listenerPosition,t.position,t.worldDimensions.width,t.worldDimensions.height),m=Y(t.listenerPosition,t.position,t.worldDimensions.width,t.worldDimensions.height);if(m>g0)return;const v=1-Math.pow(m/g0,R_);u.gain.value=Math.max(0,v);const y=Math.sin(g.x/m*(Math.PI/2));d.pan.value=isNaN(y)?0:y,u.connect(d),f=d}else{const g=e===fe.GameOver?.4:e===fe.SoundTrack1?1:.2;u.gain.value=g}s.connect(f),f.connect(o),s.start(0),t!=null&&t.trackId&&(ta.set(t.trackId,{sourceNode:s,gainNode:u}),s.onended=()=>{ta.delete(t.trackId)})}function jd(e,t=1){const i=ta.get(e),o=ah();if(i&&o){const{sourceNode:l,gainNode:s}=i,u=o.currentTime;s.gain.setValueAtTime(s.gain.value,u),s.gain.linearRampToValueAtTime(0,u+t),l.stop(u+t),l.onended=null,ta.delete(e)}}function Ie(e,t,i){const o=vt(e.gameState);o&&lh(t,{position:i,listenerPosition:o.position,worldDimensions:e.gameState.mapDimensions,masterVolume:e.gameState.masterVolume,isMuted:e.gameState.isMuted})}function H_(e,t,i){const o=i.mapDimensions.width,l=i.mapDimensions.height,s=t.radius*2;for(let u=h0;u<o/2;u+=50)for(let d=0;d<10;d++){const f=th(e,u,o,l);if(!(Y(e,f,o,l)<h0)&&!bn(f,i,s,t.id))return f}return null}function uh(e,t){if(!e.isAdult||e.gender!=="male"||e.leaderId===e.id||!e.leaderId)return{canSplit:!1};if(!e.leaderId)return{canSplit:!1};const i=t.entities.entities[e.leaderId];if(!i||i.type!=="human")return{canSplit:!1};const o=yi(Ut(t,i));if(o&&o.id===e.id)return{canSplit:!1};const l=fa(e.leaderId,t).filter(f=>f.isAdult);if(l.length<f0)return{canSplit:!1};const u=Lv(e,t).filter(f=>f.isAdult).length+1,d=Math.min(l.length*m_,f0);return{canSplit:u>=d,progress:u/d}}function ch(e,t){if(!uh(e,t).canSplit)return;const i=e.leaderId?t.entities.entities[e.leaderId]:void 0,o=Rf(),l=Lv(e,t);e.leaderId=e.id,e.tribeBadge=o,e.diplomacy={},i&&i.diplomacy&&(i.diplomacy[e.id]=pt.Hostile);for(const u of l)u.leaderId=e.id,u.tribeBadge=o;Pf(t,{type:ga.NewTribeFormed,message:`A new tribe has formed! ${o}`,duration:y_,targetEntityIds:[e.id],highlightedEntityIds:[e.id,...l.map(u=>u.id)]}),Ie({gameState:t},fe.TribeSplit,e.position)}const Xo=(e,t,i)=>{var o,l;return e.id===t.id?!1:e.leaderId&&!t.leaderId?!0:e.leaderId===t.leaderId?!1:e.leaderId&&t.leaderId?((l=(o=i.entities.entities[e.leaderId])==null?void 0:o.diplomacy)==null?void 0:l[t.leaderId])===pt.Hostile:!1},Fn=(e,t,i)=>{var l,s;return!e.leaderId||!t.ownerId||t.ownerId===e.leaderId?!1:((s=(l=i.entities.entities[e.leaderId])==null?void 0:l.diplomacy)==null?void 0:s[t.ownerId])===pt.Hostile},Wr=(e,t,i)=>{if(e.id===t.id||e.gender===t.gender||!e.isAdult||!t.isAdult||e.hunger>=xr||t.hunger>=xr||(e.procreationCooldown||0)>0||(t.procreationCooldown||0)>0||Xo(e,t,i))return!1;const o=e.gender==="female"?e:t;return!(o.isPregnant||o.age>Ov)},b_=20,In=30,G_=.5,x_=.3,$_=2,Nf=50;function dh(e,t){const i=[];if(t.food.length>0&&t.hunger>or&&i.push({type:ae.Eat,action:"eating",key:"f"}),t.food.length<t.maxFood){const s=Ne(t,e,"berryBush",mt,f=>f.food.length>0),u=Ne(t,e,"corpse",mt,f=>f.food.length>0);let d=null;s&&u?d=Y(t.position,s.position,e.mapDimensions.width,e.mapDimensions.height)<=Y(t.position,u.position,e.mapDimensions.width,e.mapDimensions.height)?s:u:d=s||u,d&&i.push({type:ae.Gather,action:"gathering",key:"e",targetEntity:d})}const o=Ne(t,e,"human",mt,s=>Wr(t,s,e));if(o&&i.push({type:ae.Procreate,action:"procreating",key:"r",targetEntity:o}),t.food.length>0&&t.isAdult){const s=Ne(t,e,"human",mt,u=>{const d=u;return!d.isAdult&&(d.motherId===t.id||d.fatherId===t.id)&&d.hunger>=or});s&&i.push({type:ae.FeedChild,action:"feeding",key:"h",targetEntity:s})}const l=Ne(t,e,"human",ti,s=>Xo(t,s,e))??Ne(t,e,"predator",ti)??Ne(t,e,"prey",ti);if(l&&i.push({type:ae.Attack,action:"attacking",key:"q",targetEntity:l}),t.food.filter(s=>s.type===Bn.Berry).length>=Hr&&i.push({type:ae.Plant,action:"planting",key:"b"}),t.food.length>0&&t.isAdult){const s=Ne(t,e,"building",In,u=>{const d=u;return d.buildingType==="storageSpot"&&d.ownerId===t.leaderId&&d.isConstructed&&d.storedFood!==void 0&&d.storageCapacity!==void 0&&d.storedFood.length<d.storageCapacity});s&&i.push({type:ae.Deposit,action:"idle",key:"x",targetEntity:s})}if(t.food.length<t.maxFood&&t.isAdult){const s=Ne(t,e,"building",In,u=>{const d=u;return d.buildingType==="storageSpot"&&d.ownerId===t.leaderId&&d.isConstructed&&d.storedFood!==void 0&&d.storedFood.length>0});s&&i.push({type:ae.Retrieve,action:"idle",key:"z",targetEntity:s})}return t.leaderId===t.id&&!t.isCallingToAttack&&nh(t,e,eS).length>0&&i.push({type:ae.CallToAttack,action:"idle",key:"v"}),uh(t,e).canSplit&&i.push({type:ae.TribeSplit,action:"idle",key:"k"}),t.leaderId===t.id&&!t.isCallingToFollow&&i.push({type:ae.FollowMe,action:"idle",key:"c"}),i}const Tn={StorageSpot:"storageSpot",PlantingZone:"plantingZone"},Ia={[Tn.StorageSpot]:{name:"Storage Spot",description:"A designated area for storing excess food.",icon:"",dimensions:{width:40,height:40},constructionTimeHours:.1,destructionTimeHours:.1,cost:{}},[Tn.PlantingZone]:{name:"Planting Zone",description:"An area marked for agricultural use.",icon:"",dimensions:{width:60,height:60},constructionTimeHours:.1,destructionTimeHours:.1,cost:{}}},z_=.5,W_="#FFA500",Y_="#FF4500",m0=4,j_=10;function oS(e){return Ia[e].dimensions}function V_(e){return Ia[e].constructionTimeHours}function X_(e){return Ia[e].destructionTimeHours}function fh(e,t,i,o){if(i===void 0)return!1;const l=oS(t),s=Math.sqrt(l.width*l.width+l.height*l.height)/2;if(bn(e,o,s*.8))return!1;const d=o.search.building.byRadius(e,s*2);for(const f of d){const g=Y(e,f.position,o.mapDimensions.width,o.mapDimensions.height),m=(Math.max(l.width,l.height)+Math.max(f.width,f.height))/2;if(g<m*.9)return!1}return!0}function sS(e,t,i,o){return OR(o.entities,e,t,i)}function K_(e,t){const i=t.entities.entities[e];i&&i.type==="building"&&!i.isBeingDestroyed&&(i.isBeingDestroyed=!0,i.destructionProgress=0)}function Z_(e,t){const l=t.search.building.byRadius(e,100);for(const s of l){let u=e.x-s.position.x,d=e.y-s.position.y;const f=t.mapDimensions.width,g=t.mapDimensions.height;if(Math.abs(u)>f/2&&(u-=Math.sign(u)*f),Math.abs(d)>g/2&&(d-=Math.sign(d)*g),Math.abs(u)<=s.width/2&&Math.abs(d)<=s.height/2)return s}}const q_=500,Q_=500;function J_(e,t){if(!e.leaderId)return 0;const i=eC(e.leaderId,t),o=tC(e.leaderId,t);return o===0?0:Math.min(1,i/o)}function eC(e,t){const i=Hn({leaderId:e},t),o=Ea(e,t),l=i.reduce((u,d)=>u+d.food.length,0),s=o.reduce((u,d)=>{var f;return u+(((f=d.storedFood)==null?void 0:f.length)||0)},0);return l+s}function tC(e,t){const i=Hn({leaderId:e},t),o=Ea(e,t),l=i.reduce((u,d)=>u+d.maxFood,0),s=o.reduce((u,d)=>u+(d.storageCapacity||0),0);return l+s}function aS(e,t){const i=Ea(e,t);if(i.length===0)return 0;const o=i.reduce((s,u)=>{var d;return s+(((d=u.storedFood)==null?void 0:d.length)||0)},0),l=i.reduce((s,u)=>s+(u.storageCapacity||0),0);return l===0?0:Math.min(1,o/l)}function lS(e,t){const i=Hn({leaderId:e},t);return i.length===0?0:nC(e,t)/i.length}function nC(e,t){const i=t,o=zr(e,t);return i.search.berryBush.byRadius(o,q_).filter(u=>{const d=u.stateMachine&&u.stateMachine[0]==="bushDying",f=u.food.length>0;return!d&&f}).length}function hh(e,t){return e.leaderId?t.search.building.all().filter(l=>{if(l.buildingType!==Tn.PlantingZone||!l.isConstructed)return!1;if(l.ownerId){const s=t.entities.entities[l.ownerId];return s&&s.leaderId===e.leaderId}return!1}):[]}function iC(e){const t=br*2,i=Math.floor(e.width/t),o=Math.floor(e.height/t);return i*o}function rC(e,t){const i=t,o=Math.max(e.width,e.height);return i.search.berryBush.byRadius(e.position,o).filter(u=>{const d=Math.abs(u.position.x-e.position.x),f=Math.abs(u.position.y-e.position.y);return d<=e.width/2&&f<=e.height/2}).length}function oC(e,t){if(!e.leaderId)return[];const i=Ea(e.leaderId,t),o=Hn(e,t);return i.map(l=>{var g;const s=l.storageCapacity||0,u=((g=l.storedFood)==null?void 0:g.length)||0,d=o.filter(m=>{if(m.activeAction!=="depositing")return!1;if(typeof m.target=="object"&&"x"in m.target){const v=m.target;return Y(v,l.position,t.mapDimensions.width,t.mapDimensions.height)<=50}return!1}).length,f=Y(e.position,l.position,t.mapDimensions.width,t.mapDimensions.height);return{storage:l,capacity:s,currentFood:u,assignedDepositors:d,distance:f}})}function sC(e,t){const i=oC(e,t);if(i.length===0)return null;const o=i.filter(l=>{const s=l.currentFood<l.capacity,u=l.distance<=Q_;return s&&u});return o.length===0?null:(o.sort((l,s)=>{const u=l.currentFood/l.capacity,d=s.currentFood/s.capacity;return Math.abs(u-d)>.1?u-d:l.assignedDepositors!==s.assignedDepositors?l.assignedDepositors-s.assignedDepositors:l.distance-s.distance}),o[0].storage)}function uS(e,t,i){return Hn({leaderId:e},t).filter(l=>l.activeAction===i).length}function Ea(e,t){return t.search.building.all().filter(l=>{if(l.buildingType!==Tn.StorageSpot||!l.isConstructed)return!1;if(l.ownerId){const s=t.entities.entities[l.ownerId];return s&&s.leaderId===e}return!1})}function aC(e,t){const i=hh(e,t);if(i.length===0)return null;const o=t.mapDimensions.width,l=t.mapDimensions.height;for(const s of i){const u=iC(s);if(rC(s,t)>=u)continue;const f=20;for(let g=0;g<f;g++){const m=s.position.x+(Math.random()-.5)*s.width,v=s.position.y+(Math.random()-.5)*s.height,y={x:(m%o+o)%o,y:(v%l+l)%l};if(!bn(y,t,br))return{position:y,zoneId:s.id}}}return null}function lC(e,t,i){return hh(t,i).some(s=>QE(e,s,i))?!bn(e,i,br):!1}const uC={id:uu,update:(e,t)=>{const{entity:i,updateContext:o}=t,{gameState:l}=o,s=o.deltaTime*(Et/wt);if(i.age+=s,i.age>=i.lifespan)return{nextState:ua,data:{...e,enteredAt:l.time,previousState:uu}};const u=th(i.position,i.spreadRadius,l.mapDimensions.width,l.mapDimensions.height);return bn(u,l,15)||Ca(l.entities,u,l.time),{nextState:Pr,data:{...e,enteredAt:l.time,previousState:uu}}},onEnter:(e,t)=>({...t,enteredAt:e.updateContext.gameState.time})},cC={id:ua,update:e=>({nextState:ua,data:e}),onEnter:(e,t)=>(qo(e.updateContext.gameState.entities,e.entity.id),{...t,enteredAt:e.updateContext.gameState.time})},dC=[vI,SI,uC,cC],ct="humanIdle",Rr="humanMoving",Ks="humanEating",wa="humanGathering",na="humanDepositing",ia="humanRetrieving",ma="humanProcreating",sr="humanAttacking",du="humanPlanting",fC={id:ct,update:(e,t)=>{const{entity:i,updateContext:o}=t;return i.activeAction==="attacking"&&i.attackTargetId?{nextState:sr,data:{...e,enteredAt:o.gameState.time,previousState:ct,attackTargetId:i.attackTargetId,attackStartTime:o.gameState.time}}:(i.hunger>=Pv?(i.debuffs=i.debuffs.filter(l=>l.type!=="slow"),i.debuffs.push({type:"slow",startTime:o.gameState.time,duration:.1})):i.debuffs=i.debuffs.filter(l=>l.type!=="slow"),i.activeAction==="moving"?{nextState:Rr,data:{...e,enteredAt:o.gameState.time,previousState:ct,target:i.target}}:i.activeAction==="gathering"?{nextState:wa,data:{...e,enteredAt:o.gameState.time,previousState:ct,target:i.target}}:i.activeAction==="eating"?{nextState:Ks,data:{...e,enteredAt:o.gameState.time,previousState:ct}}:i.activeAction==="planting"&&i.target?{nextState:du,data:{...e,enteredAt:o.gameState.time,previousState:ct,plantingSpot:i.target}}:i.activeAction==="depositing"?{nextState:na,data:{...e,enteredAt:o.gameState.time,previousState:ct}}:i.activeAction==="retrieving"?{nextState:ia,data:{...e,enteredAt:o.gameState.time,previousState:ct}}:{nextState:ct,data:e})},onEnter:(e,t)=>(e.entity.acceleration=0,e.entity.velocity={x:0,y:0},{...t,enteredAt:e.updateContext.gameState.time})};function cS(e){let t=yE;return e.hunger>=Pv&&(t*=TE),e.age>=IE&&(t*=EE),e.movementSlowdown&&(t*=e.movementSlowdown.modifier),t}const Vd=7.5;class hC{constructor(){Oe(this,"id",Rr)}update(t,i){var f;const{entity:o,updateContext:l}=i;if(o.activeAction==="attacking"&&o.attackTargetId)return{nextState:sr,data:{...t,enteredAt:l.gameState.time,previousState:Rr,attackTargetId:o.attackTargetId,attackStartTime:l.gameState.time}};if(o.activeAction!=="moving")return{nextState:ct,data:{...t,enteredAt:l.gameState.time,previousState:Rr}};let s;if(typeof o.target=="object"?s=o.target:typeof o.target=="number"&&(s=(f=i.updateContext.gameState.entities.entities[o.target])==null?void 0:f.position),!s&&(o.direction.x!==0||o.direction.y!==0)&&(s={x:o.position.x+o.direction.x*Vd*2,y:o.position.y+o.direction.y*Vd*2}),!s)return{nextState:ct,data:{...t,enteredAt:l.gameState.time,previousState:Rr}};const u=ze(o.position,s,i.updateContext.gameState.mapDimensions.width,i.updateContext.gameState.mapDimensions.height);return o.direction=nt(u),o.acceleration=cS(o),Y(o.position,s,l.gameState.mapDimensions.width,l.gameState.mapDimensions.height)<Vd?{nextState:ct,data:{...t,enteredAt:l.gameState.time,previousState:Rr}}:{nextState:Rr,data:t}}onExit(t){const{entity:i}=t;i.acceleration=0}}const gC=new hC,xe=1,Dr=3,pC=70;function Me(e,t,i,o,l){const s={id:e.nextVisualEffectId,type:t,position:i,startTime:e.time,duration:o,entityId:l};return e.visualEffects.push(s),e.nextVisualEffectId++,s.id}var ce=(e=>(e[e.Hunger=0]="Hunger",e[e.Procreation=1]="Procreation",e[e.Pregnant=2]="Pregnant",e[e.TargetAcquired=3]="TargetAcquired",e[e.Attack=4]="Attack",e[e.Partnered=5]="Partnered",e[e.BushClaimed=6]="BushClaimed",e[e.BushClaimLost=7]="BushClaimLost",e[e.Eating=8]="Eating",e[e.ChildFed=9]="ChildFed",e[e.AttackDeflected=10]="AttackDeflected",e[e.AttackResisted=11]="AttackResisted",e[e.Hit=12]="Hit",e[e.SeizeBuildup=13]="SeizeBuildup",e[e.Seize=14]="Seize",e[e.CallToAttack=15]="CallToAttack",e[e.CallToFollow=16]="CallToFollow",e[e.AutopilotMoveTarget=17]="AutopilotMoveTarget",e))(ce||{});const mC={id:Ks,update:(e,t)=>{const{entity:i,updateContext:o}=t;return i.activeAction!=="eating"?{nextState:ct,data:{...e,enteredAt:o.gameState.time,previousState:Ks}}:(i.food.length>0&&(!i.eatingCooldownTime||o.gameState.time>=i.eatingCooldownTime)&&i.hunger>or&&(i.hunger=Math.max(0,i.hunger-or),i.food.pop(),i.eatingCooldownTime=o.gameState.time+1,Ie(o,fe.Eat,i.position),(!i.lastEatingEffectTime||o.gameState.time-i.lastEatingEffectTime>2)&&(Me(o.gameState,ce.Eating,i.position,xe,i.id),i.lastEatingEffectTime=o.gameState.time)),i.hunger<=0||i.food.length<=0?{nextState:ct,data:{...e,enteredAt:o.gameState.time,previousState:Ks}}:{nextState:Ks,data:e})},onEnter:(e,t)=>(e.entity.acceleration=0,e.entity.velocity={x:0,y:0},{...t,enteredAt:e.updateContext.gameState.time})};class vC{constructor(){Oe(this,"id",wa)}update(t,i){return i.entity.activeAction!=="gathering"?{nextState:"humanIdle",data:{...t,enteredAt:i.updateContext.gameState.time,previousState:this.id}}:{nextState:this.id,data:t}}}const SC=new vC,yC={id:na,update:(e,t)=>{const{entity:i}=t;return i.activeAction!=="depositing"?{nextState:ct,data:{...e,enteredAt:t.updateContext.gameState.time,previousState:na}}:{nextState:na,data:e}},onEnter:(e,t)=>{const{entity:i}=e;return i.activeAction="depositing",t},onExit:e=>{const{entity:t}=e;t.activeAction==="depositing"&&(t.activeAction="idle")}},TC={id:ia,update:(e,t)=>{const{entity:i}=t;return i.activeAction!=="retrieving"?{nextState:ct,data:{...e,enteredAt:t.updateContext.gameState.time,previousState:ia}}:{nextState:ia,data:e}},onEnter:(e,t)=>{const{entity:i}=e;return i.activeAction="retrieving",t},onExit:e=>{const{entity:t}=e;t.activeAction==="retrieving"&&(t.activeAction="idle")}},AC=(e,t)=>(t.procreationEndTime=e.updateContext.gameState.time+(t.duration||2),t),IC=(e,t)=>{const{entity:i,updateContext:o}=t,{gameState:l}=o;if(l.time<(e.procreationEndTime||0))return{nextState:ma,data:e};const s=l.entities.entities[e.partnerId];if(s&&s.type==="human"&&!s.isPregnant&&i.hunger<xr&&s.hunger<xr&&!i.procreationCooldown&&!s.procreationCooldown){const u=i.gender==="female"?i:s.gender==="female"?s:void 0,d=i.gender==="male"?i:s.gender==="male"?s:void 0;u&&d&&(u.isPregnant=!0,u.gestationTime=CE,u.pregnancyFatherId=d.id,i.procreationCooldown=jm,s.procreationCooldown=jm,Ie(o,fe.Procreate,u.position))}return i.activeAction="idle",s&&(s.activeAction="idle"),{nextState:ct,data:{...e,enteredAt:l.time,previousState:ma}}},EC={id:ma,onEnter:AC,update:IC},wC={id:sr,onEnter:(e,t)=>({...t,enteredAt:e.updateContext.gameState.time,attackStartTime:e.updateContext.gameState.time}),update:(e,t)=>{if(t.entity.activeAction!=="attacking"||!t.entity.attackTargetId)return t.entity.activeAction="idle",{nextState:ct,data:{...e}};const i=t.updateContext.gameState.entities.entities[t.entity.attackTargetId];if(!i)return t.entity.activeAction="idle",{nextState:ct,data:{...e}};const o=Y(t.entity.position,i.position,t.updateContext.gameState.mapDimensions.width,t.updateContext.gameState.mapDimensions.height),l=ze(t.entity.position,i.position,t.updateContext.gameState.mapDimensions.width,t.updateContext.gameState.mapDimensions.height);return t.entity.direction=nt(l),o>ti?t.entity.acceleration=cS(t.entity):t.entity.acceleration=0,{nextState:sr,data:e}}},_C={id:du,update:(e,t)=>{const{entity:i,updateContext:o}=t,{gameState:l}=o;if(l.time-e.enteredAt>=mI){if(i.food.filter(d=>d.type===Bn.Berry).length>=Hr){for(let d=0;d<Hr;d++){const f=i.food.findIndex(g=>g.type===Bn.Berry);f>-1&&i.food.splice(f,1)}Ca(l.entities,e.plantingSpot,l.time)}return{nextState:ct,data:{...e,enteredAt:l.time,previousState:du}}}return{nextState:du,data:e}},onEnter:(e,t)=>(e.entity.acceleration=0,e.entity.velocity={x:0,y:0},{...t,enteredAt:e.updateContext.gameState.time})},CC=[fC,gC,mC,SC,yC,TC,EC,wC,_C],Mn="preyIdle",Zi="preyMoving",Zs="preyGrazing",qs="preyProcreating",RC={id:Mn,update:(e,t)=>{const{entity:i,updateContext:o}=t;return i.activeAction==="moving"?{nextState:Zi,data:{...e,enteredAt:o.gameState.time,previousState:Mn,target:i.target}}:i.activeAction==="grazing"?{nextState:Zs,data:{...e,enteredAt:o.gameState.time,previousState:Mn}}:i.activeAction==="procreating"?{nextState:qs,data:{...e,enteredAt:o.gameState.time,previousState:Mn}}:{nextState:Mn,data:e}},onEnter:(e,t)=>(e.entity.acceleration=0,e.entity.velocity={x:0,y:0},{...t,enteredAt:e.updateContext.gameState.time})},dS=12,PC=120,v0=50,NC=12,fS=30,DC=2,zt=50,OC=100,ra=2,Xd=3,MC=.9,kC=1,FC=50,LC=.5,hS=20,UC=140,S0=40,BC=12,gS=40,HC=3,ir=60,kn=40,_o=50,y0=320,pS=25,bC=60,mS=2,GC=90,xC=.7,$C=1,oa=3,Kd=15,gh=80,vS=10,Lu=80,Ko=40,SS=2,Tu=30,Po=20,Mr=40,No=24,kr=48,Do=12,Fr=40,Oo=20,Lr=60,Mo=.75,Ji=2.5,ko=.25,er=2;function zC(e){let t=NC;return e.isAdult||(t*=.7),e.hunger>=FC&&(t*=LC),e.movementSlowdown&&(t*=e.movementSlowdown.modifier),t}function WC(e,t){const i=e>>16&255,o=e>>8&255,l=e&255,s=t>>16&255,u=t>>8&255,d=t&255;let f=Math.floor((i+s)/2),g=Math.floor((o+u)/2),m=Math.floor((l+d)/2);return Math.random()<.05&&(f=Math.max(0,Math.min(255,f+(Math.random()-.5)*60))),Math.random()<.05&&(g=Math.max(0,Math.min(255,g+(Math.random()-.5)*60))),Math.random()<.05&&(m=Math.max(0,Math.min(255,m+(Math.random()-.5)*60))),f<<16|g<<8|m}function va(){const e=Math.floor(Math.random()*100)+100,t=Math.floor(Math.random()*80)+60,i=Math.floor(Math.random()*60)+20;return e<<16|t<<8|i}const Zd=10;class YC{constructor(){Oe(this,"id",Zi)}update(t,i){var f;const{entity:o,updateContext:l}=i;if(o.activeAction!=="moving")return{nextState:Mn,data:{...t,enteredAt:l.gameState.time,previousState:Zi}};let s;if(typeof o.target=="object"?s=o.target:typeof o.target=="number"&&(s=(f=i.updateContext.gameState.entities.entities[o.target])==null?void 0:f.position),!s&&(o.direction.x!==0||o.direction.y!==0)&&(s={x:o.position.x+o.direction.x*Zd*2,y:o.position.y+o.direction.y*Zd*2}),!s)return{nextState:Mn,data:{...t,enteredAt:l.gameState.time,previousState:Zi}};const u=ze(o.position,s,i.updateContext.gameState.mapDimensions.width,i.updateContext.gameState.mapDimensions.height);return o.direction=nt(u),o.acceleration=zC(o),Y(o.position,s,l.gameState.mapDimensions.width,l.gameState.mapDimensions.height)<Zd?{nextState:Mn,data:{...t,enteredAt:l.gameState.time,previousState:Zi}}:{nextState:Zi,data:t}}onExit(t){const{entity:i}=t;i.acceleration=0}onEnter(t,i){return{...i,enteredAt:t.updateContext.gameState.time}}}const jC=new YC,VC={id:Zs,update:(e,t)=>{const{entity:i,updateContext:o}=t;return i.activeAction==="moving"?{nextState:Zi,data:{...e,enteredAt:o.gameState.time,previousState:Zs,target:i.target}}:i.activeAction!=="grazing"?{nextState:Mn,data:{...e,enteredAt:o.gameState.time,previousState:Zs}}:{nextState:Zs,data:e}},onEnter:(e,t)=>(e.entity.acceleration=0,e.entity.velocity={x:0,y:0},{...t,enteredAt:e.updateContext.gameState.time})},XC={id:qs,update:(e,t)=>{const{entity:i,updateContext:o}=t;return i.activeAction==="moving"?{nextState:Zi,data:{...e,enteredAt:o.gameState.time,previousState:qs,target:i.target}}:i.activeAction!=="procreating"?{nextState:Mn,data:{...e,enteredAt:o.gameState.time,previousState:qs}}:{nextState:qs,data:e}},onEnter:(e,t)=>(e.entity.acceleration=0,e.entity.velocity={x:0,y:0},{...t,enteredAt:e.updateContext.gameState.time})},KC=[RC,jC,VC,XC],$t="predatorIdle",Vi="predatorMoving",hi="predatorAttacking",Co="predatorProcreating",Ur="predatorEating",ZC={id:$t,update:(e,t)=>{const{entity:i,updateContext:o}=t;return i.activeAction==="eating"?{nextState:Ur,data:{...e,enteredAt:o.gameState.time,previousState:$t,preyId:i.attackTargetId,eatingStartTime:o.gameState.time}}:i.activeAction==="attacking"&&i.attackTargetId?{nextState:hi,data:{...e,enteredAt:o.gameState.time,previousState:$t,attackTargetId:i.attackTargetId,attackStartTime:o.gameState.time}}:i.activeAction==="moving"?{nextState:Vi,data:{...e,enteredAt:o.gameState.time,previousState:$t,target:i.target}}:i.activeAction==="procreating"?{nextState:Co,data:{...e,enteredAt:o.gameState.time,previousState:$t}}:{nextState:$t,data:e}},onEnter:(e,t)=>(e.entity.acceleration=0,e.entity.velocity={x:0,y:0},{...t,enteredAt:e.updateContext.gameState.time})};function yS(e){let t=BC;return e.hunger>=GC&&(t*=xC),e.isAdult||(t*=.7),e.movementSlowdown&&(t*=e.movementSlowdown.modifier),t}function qC(e,t){const i=e>>16&255,o=e>>8&255,l=e&255,s=t>>16&255,u=t>>8&255,d=t&255;let f=Math.floor((i+s)/2),g=Math.floor((o+u)/2),m=Math.floor((l+d)/2);return Math.random()<.05&&(f=Math.max(0,Math.min(255,f+(Math.random()-.5)*60))),Math.random()<.05&&(g=Math.max(0,Math.min(255,g+(Math.random()-.5)*60))),Math.random()<.05&&(m=Math.max(0,Math.min(255,m+(Math.random()-.5)*60))),f<<16|g<<8|m}function Sa(){const e=Math.floor(Math.random()*60)+60,t=Math.floor(Math.random()*50)+40,i=Math.floor(Math.random()*40)+20;return e<<16|t<<8|i}const qd=12;class QC{constructor(){Oe(this,"id",Vi)}update(t,i){var f;const{entity:o,updateContext:l}=i;if(o.activeAction==="eating")return{nextState:Ur,data:{...t,enteredAt:l.gameState.time,previousState:Vi,preyId:o.attackTargetId,eatingStartTime:l.gameState.time}};if(o.activeAction==="attacking"&&o.attackTargetId)return{nextState:hi,data:{...t,enteredAt:l.gameState.time,previousState:Vi,attackTargetId:o.attackTargetId,attackStartTime:l.gameState.time}};if(o.activeAction!=="moving")return{nextState:$t,data:{...t,enteredAt:l.gameState.time,previousState:Vi}};let s;if(typeof o.target=="object"?s=o.target:typeof o.target=="number"&&(s=(f=i.updateContext.gameState.entities.entities[o.target])==null?void 0:f.position),!s&&(o.direction.x!==0||o.direction.y!==0)&&(s={x:o.position.x+o.direction.x*qd*2,y:o.position.y+o.direction.y*qd*2}),!s)return{nextState:$t,data:{...t,enteredAt:l.gameState.time,previousState:Vi}};const u=ze(o.position,s,i.updateContext.gameState.mapDimensions.width,i.updateContext.gameState.mapDimensions.height);return o.direction=nt(u),o.acceleration=yS(o),Y(o.position,s,l.gameState.mapDimensions.width,l.gameState.mapDimensions.height)<qd?{nextState:$t,data:{...t,enteredAt:l.gameState.time,previousState:Vi}}:{nextState:Vi,data:t}}onExit(t){const{entity:i}=t;i.acceleration=0}onEnter(t,i){return{...i,enteredAt:t.updateContext.gameState.time}}}const JC=new QC,e1={id:hi,update:(e,t)=>{const{entity:i,updateContext:o}=t;if(i.activeAction==="eating")return{nextState:Ur,data:{...e,enteredAt:o.gameState.time,previousState:hi,preyId:i.attackTargetId,eatingStartTime:o.gameState.time}};if(i.activeAction!=="attacking"||!i.attackTargetId)return i.activeAction="idle",{nextState:$t,data:{...e,enteredAt:o.gameState.time,previousState:hi}};const l=o.gameState.entities.entities[i.attackTargetId];if(!l)return i.activeAction="idle",{nextState:$t,data:{...e,enteredAt:o.gameState.time,previousState:hi}};if(l.type==="prey"&&l.hitpoints<=0||l.type==="predator"&&l.hitpoints<=0||l.type==="human"&&l.hitpoints<=0)return i.activeAction="idle",{nextState:$t,data:{...e,enteredAt:o.gameState.time,previousState:hi}};const u=Y(i.position,l.position,o.gameState.mapDimensions.width,o.gameState.mapDimensions.height),d=ze(i.position,l.position,o.gameState.mapDimensions.width,o.gameState.mapDimensions.height);return i.direction=nt(d),u>kn?i.acceleration=yS(i):i.acceleration=0,{nextState:hi,data:e}},onEnter:(e,t)=>({...t,enteredAt:e.updateContext.gameState.time})},t1={id:Co,update:(e,t)=>{const{entity:i,updateContext:o}=t;return i.activeAction==="eating"?{nextState:Ur,data:{...e,enteredAt:o.gameState.time,previousState:Co,preyId:i.attackTargetId,eatingStartTime:o.gameState.time}}:i.activeAction==="attacking"&&i.attackTargetId?{nextState:hi,data:{...e,enteredAt:o.gameState.time,previousState:Co,attackTargetId:i.attackTargetId,attackStartTime:o.gameState.time}}:i.activeAction!=="procreating"?{nextState:$t,data:{...e,enteredAt:o.gameState.time,previousState:Co}}:{nextState:Co,data:e}},onEnter:(e,t)=>(e.entity.acceleration=0,e.entity.velocity={x:0,y:0},{...t,enteredAt:e.updateContext.gameState.time})},n1={id:Ur,update:(e,t)=>{const{entity:i,updateContext:o}=t;return i.activeAction!=="eating"?{nextState:$t,data:{...e,enteredAt:o.gameState.time,previousState:Ur}}:{nextState:Ur,data:e}},onEnter:(e,t)=>(e.entity.acceleration=0,e.entity.velocity={x:0,y:0},{...t,enteredAt:e.updateContext.gameState.time})},i1=[ZC,JC,e1,t1,n1],T0=[...dC,...CC,...KC,...i1];function r1(e,t,i){const o=sI(e,T0);if(!o)return lI(e),[e,t];const{nextState:l,data:s}=o.update(t,i);return aI(e,l)?[l,oI(o,l,s,i,T0)]:[l,s]}function o1(e,t,i){const{gameState:o}=t,l=i*(Et/wt);if(e.isAdult=e.age>=Vf,e.isCallingToAttack&&e.callToAttackEndTime&&o.time>e.callToAttackEndTime&&(e.isCallingToAttack=!1,e.callToAttackEndTime=void 0),e.isCallingToFollow&&e.callToFollowEndTime&&o.time>e.callToFollowEndTime&&(e.isCallingToFollow=!1,e.callToFollowEndTime=void 0),e.movementSlowdown&&o.time>e.movementSlowdown.endTime&&(e.movementSlowdown=void 0),e.hitpoints<e.maxHitpoints){const u=1-e.hunger/100*BE,d=UE*u*l;e.hitpoints=Math.min(e.maxHitpoints,e.hitpoints+d)}if(e.hunger+=i*(Bs/(Et/wt)),e.hunger>pC&&(!e.lastHungerEffectTime||o.time-e.lastHungerEffectTime>Dr*2)&&(Me(o,ce.Hunger,e.position,Dr,e.id),e.lastHungerEffectTime=o.time),e.age+=i/Ou,e.isPlayer){const u=Ut(o,e).filter(d=>d.hunger>=T_);if(u.length>0){const d=u.map(f=>f.id);Pf(o,{identifier:"children_starving",type:ga.ChildrenStarving,message:"Your children are starving!",duration:S_,targetEntityIds:d,highlightedEntityIds:d})}}if(e.gender==="female"&&e.isPregnant&&e.gestationTime&&(e.gestationTime-=l,e.hunger+=i*((Bs*RE-Bs)/(Et/wt)),(!e.lastPregnantEffectTime||o.time-e.lastPregnantEffectTime>Dr*3)&&(Me(o,ce.Pregnant,e.position,Dr,e.id),e.lastPregnantEffectTime=o.time),e.gestationTime<=0&&(DR(e,e.pregnancyFatherId,t),e.isPregnant=!1,e.gestationTime=0,e.pregnancyFatherId=void 0)),e.procreationCooldown&&(e.procreationCooldown-=l,e.procreationCooldown<0&&(e.procreationCooldown=0)),e.attackCooldown&&(e.attackCooldown-=l,e.attackCooldown<0&&(e.attackCooldown=0)),e.feedParentCooldownTime&&(e.feedParentCooldownTime-=l,e.feedParentCooldownTime<0&&(e.feedParentCooldownTime=0)),e.feedChildCooldownTime&&(e.feedChildCooldownTime-=l,e.feedChildCooldownTime<0&&(e.feedChildCooldownTime=0)),e.leaderMetaStrategyCooldown&&(e.leaderMetaStrategyCooldown-=l,e.leaderMetaStrategyCooldown<0&&(e.leaderMetaStrategyCooldown=0)),e.isAdult?e.radius===Vo&&(e.radius=_t):e.hunger+=i*((Bs*PE-Bs)/(Et/wt)),e.isAdult&&e.food.length>0&&(!e.feedParentCooldownTime||e.feedParentCooldownTime<=0)){const u=[];if(e.motherId){const d=o.entities.entities[e.motherId];d&&u.push(d)}if(e.fatherId){const d=o.entities.entities[e.fatherId];d&&u.push(d)}for(const d of u)if(d.age>=Zf&&d.hunger>=OE&&Y(e.position,d.position,o.mapDimensions.width,o.mapDimensions.height)<=ME){e.food.pop(),d.hunger=Math.max(0,d.hunger-or),e.feedParentCooldownTime=kE;break}}let s;if(e.hitpoints<=0?s="killed":e.hunger>=Gr?e.food.length>0&&e.isAdult?(e.food.pop(),e.hunger=Math.max(0,e.hunger-or)):s="hunger":e.age>=e.maxAge&&(s="oldAge"),s){if(e.leaderId===e.id){const u=yi(Ut(o,e));u?(u.leaderId=u.id,u.tribeBadge=e.tribeBadge,u.diplomacy={...e.diplomacy},Object.values(o.entities.entities).forEach(d=>{if(d.type==="human"&&d.leaderId===e.id){const f=d;f.leaderId=u.id}if(d.type==="building"&&d.ownerId===e.id){const f=d;f.ownerId=u.id}})):Object.values(o.entities.entities).forEach(d=>{if(d.type==="human"&&d.leaderId===e.id){const f=d;f.leaderId=void 0,f.tribeBadge=void 0}if(d.type==="building"&&d.ownerId===e.id){const f=d;f.ownerId=void 0}})}if(e.isPlayer){const u=yi(Ut(o,e));u?(u.isPlayer=!0,o.generationCount++):(o.gameOver=!0,o.causeOfGameOver=s,Pf(o,{identifier:"no_heir",type:ga.NoHeir,message:"Your lineage has ended. You have no heir.",duration:0}))}RR(o.entities,e.position,e.gender,e.age,e.radius,e.id,o.time,e.food,e.hunger),qo(o.entities,e.id);return}e.animationProgress===void 0&&(e.animationProgress=0),e.animationSpeed===void 0&&(e.animationSpeed=1),e.animationProgress+=i*e.animationSpeed,e.animationProgress>=1&&(e.animationProgress=0)}function s1(e,t){const i=t.gameState.time-e.timeOfDeath;e.decayProgress=Math.min(1,i/FE);const o=Math.floor(Mv*(1-e.decayProgress));e.food.length>o&&e.food.splice(o),e.decayProgress>=1&&e.food.length<=0&&qo(t.gameState.entities,e.id)}function a1(e,t,i){const o=i*(Et/wt);e.age+=i/Ou,e.isAdult=e.age>=ra;let l=t.gameState.ecosystem.preyHungerIncreasePerHour*o;if(e.isPregnant&&(l*=1.2),e.hunger+=l,e.isPregnant&&e.gestationTime!==void 0&&(e.gestationTime-=o,e.gestationTime<=0)){const u={x:e.position.x+(Math.random()-.5)*40,y:e.position.y+(Math.random()-.5)*40};u.x=Math.max(20,Math.min(t.gameState.mapDimensions.width-20,u.x)),u.y=Math.max(20,Math.min(t.gameState.mapDimensions.height-20,u.y));const d=Math.random()<.5?"male":"female",f=e,g=e.fatherId?t.gameState.entities.entities[e.fatherId]:void 0;let m;if(g)m=WC(f.geneCode,g.geneCode);else{m=f.geneCode;const v=Math.floor((Math.random()-.5)*4096);m=Math.max(0,Math.min(16777215,m+v))}zo(t.gameState.entities,u,d,0,fS*.5,m,e.id,e.fatherId),Me(t.gameState,ce.Procreation,e.position,Dr,e.id),Ie(t,fe.Birth,e.position),e.isPregnant=!1,e.gestationTime=0,e.procreationCooldown=t.gameState.ecosystem.preyProcreationCooldown,e.fatherId=void 0}e.procreationCooldown&&e.procreationCooldown>0&&(e.procreationCooldown-=o,e.procreationCooldown<0&&(e.procreationCooldown=0)),e.eatingCooldownTime&&e.eatingCooldownTime>t.gameState.time||(e.eatingCooldownTime=void 0),e.fleeCooldown&&e.fleeCooldown>0&&(e.fleeCooldown-=o,e.fleeCooldown<0&&(e.fleeCooldown=0)),e.feedChildCooldownTime&&e.feedChildCooldownTime>0&&(e.feedChildCooldownTime-=o,e.feedChildCooldownTime<0&&(e.feedChildCooldownTime=0));let s=!1;e.hunger>=PC&&(s=!0),e.hitpoints<=0&&(s=!0),e.age>=dS&&(s=!0),s&&(PR(t.gameState.entities,e.position,e.gender,e.age,e.radius,e.id,t.gameState.time,e.geneCode),qo(t.gameState.entities,e.id))}function l1(e,t,i){const o=i*(Et/wt);e.age+=i/Ou,e.isAdult=e.age>=oa;let l=t.gameState.ecosystem.predatorHungerIncreasePerHour*o;if(e.isPregnant&&(l*=1.3),e.hunger+=l,e.isPregnant&&e.gestationTime!==void 0&&(e.gestationTime-=o,e.gestationTime<=0)){const u={x:e.position.x+(Math.random()-.5)*50,y:e.position.y+(Math.random()-.5)*50};u.x=Math.max(25,Math.min(t.gameState.mapDimensions.width-25,u.x)),u.y=Math.max(25,Math.min(t.gameState.mapDimensions.height-25,u.y));const d=Math.random()<.5?"male":"female",f=e,g=e.pregnancyFatherId?t.gameState.entities.entities[e.pregnancyFatherId]:void 0;let m;if(g)m=qC(f.geneCode,g.geneCode);else{m=f.geneCode;const v=Math.floor((Math.random()-.5)*4096);m=Math.max(0,Math.min(16777215,m+v))}Wo(t.gameState.entities,u,d,0,gS*.6,m,e.id,e.pregnancyFatherId),Me(t.gameState,ce.Procreation,e.position,Dr,e.id),Ie(t,fe.Birth,e.position),e.isPregnant=!1,e.gestationTime=0,e.procreationCooldown=t.gameState.ecosystem.predatorProcreationCooldown,e.pregnancyFatherId=void 0}e.procreationCooldown&&e.procreationCooldown>0&&(e.procreationCooldown-=o,e.procreationCooldown<0&&(e.procreationCooldown=0)),e.attackCooldown&&e.attackCooldown>0&&(e.attackCooldown-=o,e.attackCooldown<0&&(e.attackCooldown=0)),e.huntCooldown&&e.huntCooldown>0&&(e.huntCooldown-=o,e.huntCooldown<0&&(e.huntCooldown=0)),e.feedChildCooldownTime&&e.feedChildCooldownTime>0&&(e.feedChildCooldownTime-=o,e.feedChildCooldownTime<0&&(e.feedChildCooldownTime=0));let s=!1;e.hunger>=UC&&(s=!0),e.hitpoints<=0&&(s=!0),e.age>=hS&&(s=!0),s&&(NR(t.gameState.entities,e.position,e.gender,e.age,e.radius,e.id,t.gameState.time,e.geneCode),qo(t.gameState.entities,e.id))}var _a=(e=>(e[e.BehaviorTreeBased=0]="BehaviorTreeBased",e))(_a||{}),T=(e=>(e[e.SUCCESS=0]="SUCCESS",e[e.FAILURE=1]="FAILURE",e[e.RUNNING=2]="RUNNING",e[e.NOT_EVALUATED=3]="NOT_EVALUATED",e))(T||{});class wn{constructor(){Oe(this,"name");Oe(this,"depth");Oe(this,"children");Oe(this,"child")}getLastStatus(t){return w.get(t.aiBlackboard,`${this.name}_lastStatus`)??3}setLastStatus(t,i){w.set(t.aiBlackboard,`${this.name}_lastStatus`,i)}getRunningChildIndex(t){return w.get(t.aiBlackboard,`${this.name}_runningChildIndex`)}setRunningChildIndex(t,i){w.set(t.aiBlackboard,`${this.name}_runningChildIndex`,i)}}const w={create(){return{data:{},nodeExecutionData:{}}},set({data:e},t,i){e[t]=i},get(e,t){return e==null?void 0:e.data[t]},delete({data:e},t){delete e[t]},has({data:e},t){return t in e},recordNodeExecution({nodeExecutionData:e},t,i,o,l,s){const u=e[t]||{lastExecuted:0,status:T.FAILURE,depth:0,debugInfo:"",executionHistory:[]},d=u.executionHistory[u.executionHistory.length-1];d&&o-(d==null?void 0:d.time)>ca&&u.executionHistory.push({time:d.time+ca,status:T.NOT_EVALUATED}),u.executionHistory.push({time:o,status:i});const f=Kv/wt*Et,g=o-f;u.executionHistory=u.executionHistory.filter(v=>v.time>=g);const m={...u,lastExecuted:o,status:i,depth:l,debugInfo:s};e[t]=m},getNodeExecutionData({nodeExecutionData:e}){return e},cleanupOldEntries({nodeExecutionData:e},t){const i=MI,o=[];for(const[l,s]of Object.entries(e))t-s.lastExecuted>i&&o.push(l);for(const l of o)delete e[l]}};function ph(e,t,i){if(e.aiBlackboard){const o=w.get(e.aiBlackboard,"lastAiUpdateTime")??0;t.gameState.time-o>=ca&&(i.execute(e,t,e.aiBlackboard),w.set(e.aiBlackboard,"lastAiUpdateTime",t.gameState.time))}else console.warn(`Behavior Tree AI ticked for human ${e.id}, but the tree or blackboard was missing.`),e.activeAction="idle"}const A0="Human Behavior",u1=1;class c1{constructor(){Oe(this,"nodeData",new Map);Oe(this,"pathStack",[]);Oe(this,"startTimeStack",[])}nodeStart(t){this.pathStack.push(t),this.startTimeStack.push(performance.now())}nodeEnd(){if(this.startTimeStack.length===0||this.pathStack.length===0){console.error("BTProfiler: nodeEnd() called without a matching nodeStart().");return}const t=performance.now(),i=this.startTimeStack.pop(),o=t-i,l=this.pathStack.join(" > "),s=this.nodeData.get(l)??{path:l,totalTime:0,callCount:0,minTime:1/0,maxTime:-1/0};s.totalTime+=o,s.callCount++,s.minTime=Math.min(s.minTime,o),s.maxTime=Math.max(s.maxTime,o),this.nodeData.set(l,s),this.pathStack.pop()}report(t={}){const{showAll:i=!1}=t,o=Array.from(this.nodeData.values());if(o.length===0){console.log("--- Behavior Tree Profiler: No data collected. ---");return}let l=o,s="--- Behavior Tree Full Report ---";if(!i){const d=this.nodeData.get(A0);if(d){const f=d.totalTime*u1/100;l=o.filter(g=>g.totalTime>f&&g.path!==A0),s="--- Behavior Tree Problem Report ---"}else console.log('BTProfiler: Root node "Human Behavior" not found. Showing full report.'),s="--- Behavior Tree Full Report (Root Not Found) ---"}const u=l.sort((d,f)=>f.totalTime-d.totalTime);console.log(s),u.length>0?console.table(u.map(d=>({Path:d.path,"Total Time (ms)":d.totalTime.toFixed(3),Calls:d.callCount,"Avg Time (ms)":(d.totalTime/d.callCount).toFixed(3),"Min Time (ms)":d.minTime.toFixed(3),"Max Time (ms)":d.maxTime.toFixed(3)}))):console.log("No significant performance problems detected."),console.log("------------------------------------")}reset(){this.nodeData.clear(),this.pathStack=[],this.startTimeStack=[]}}const st=new c1;function Qt(e){return Array.isArray(e)?e:[e,""]}class he extends wn{constructor(i,o,l=0){super();Oe(this,"name");Oe(this,"depth");this.children=i,this.name=o,this.depth=l,this.children.forEach(s=>{s.depth=(this.depth??0)+1})}execute(i,o,l){this.name&&st.nodeStart(this.name);try{for(const s of this.children){const[u,d]=Qt(s.execute(i,o,l));if(u!==T.SUCCESS)return this.setLastStatus(i,u),this.name&&w.recordNodeExecution(l,this.name,u,o.gameState.time,this.depth,d),u}return this.setLastStatus(i,T.SUCCESS),this.name&&w.recordNodeExecution(l,this.name,T.SUCCESS,o.gameState.time,this.depth,""),T.SUCCESS}finally{this.name&&st.nodeEnd()}}}class Wt extends wn{constructor(i,o,l=0){super();Oe(this,"name");Oe(this,"depth");this.children=i,this.name=o,this.depth=l,this.children.forEach(s=>{s.depth=(this.depth??0)+1})}execute(i,o,l){this.name&&st.nodeStart(this.name);try{const s=this.getRunningChildIndex(i)??0;for(let u=s;u<this.children.length;u++){const d=this.children[u],[f,g]=Qt(d.execute(i,o,l));if(f!==T.FAILURE){if(f===T.SUCCESS)return this.setRunningChildIndex(i,void 0),this.setLastStatus(i,T.SUCCESS),this.name&&w.recordNodeExecution(l,this.name,T.SUCCESS,o.gameState.time,this.depth,g),T.SUCCESS;if(f===T.RUNNING)return this.setRunningChildIndex(i,u),this.setLastStatus(i,T.RUNNING),this.name&&w.recordNodeExecution(l,this.name,T.RUNNING,o.gameState.time,this.depth,g),T.RUNNING}}return this.setRunningChildIndex(i,void 0),this.setLastStatus(i,T.FAILURE),this.name&&w.recordNodeExecution(l,this.name,T.FAILURE,o.gameState.time,this.depth,""),T.FAILURE}finally{this.name&&st.nodeEnd()}}}class oe extends wn{constructor(i,o,l=0){super();Oe(this,"name");Oe(this,"depth");this.action=i,this.name=o,this.depth=l}execute(i,o,l){this.name&&st.nodeStart(this.name);try{const[s,u]=Qt(this.action(i,o,l));return this.setLastStatus(i,s),this.name&&w.recordNodeExecution(l,this.name,s,o.gameState.time,this.depth,u),s}finally{this.name&&st.nodeEnd()}}}class Q extends wn{constructor(i,o,l=0){super();Oe(this,"name");Oe(this,"depth");this.condition=i,this.name=o,this.depth=l}execute(i,o,l){this.name&&st.nodeStart(this.name);try{const[s,u]=Qt(this.condition(i,o,l)),d=s?T.SUCCESS:T.FAILURE;return this.setLastStatus(i,d),this.name&&w.recordNodeExecution(l,this.name,d,o.gameState.time,this.depth,u),d}finally{this.name&&st.nodeEnd()}}}class Au extends wn{constructor(i,o,l,s=0){super();Oe(this,"name");Oe(this,"depth");Oe(this,"startTimeKey");this.child=i,this.timeoutDurationHours=o,this.name=l,this.depth=s,this.child.depth=(this.depth??0)+1,this.startTimeKey=`timeout_${this.name}_startTime`}execute(i,o,l){st.nodeStart(this.name);try{const s=o.gameState.time;let u=w.get(l,this.startTimeKey);const[d,f]=Qt(this.child.execute(i,o,l));if(d===T.RUNNING){u===void 0&&(w.set(l,this.startTimeKey,s),u=s);const g=s-u;if(g>this.timeoutDurationHours){w.delete(l,this.startTimeKey),this.setLastStatus(i,T.FAILURE);const v=`Timed out after ${g.toFixed(2)}h.`;return w.recordNodeExecution(l,this.name,this.getLastStatus(i),s,this.depth,v),this.getLastStatus(i)}this.setLastStatus(i,T.RUNNING);const m=`Running for ${g.toFixed(2)}h. ${f}`;return w.recordNodeExecution(l,this.name,this.getLastStatus(i),s,this.depth,m),this.getLastStatus(i)}return u!==void 0&&w.delete(l,this.startTimeKey),this.setLastStatus(i,d),w.recordNodeExecution(l,this.name,this.getLastStatus(i),s,this.depth,f),this.getLastStatus(i)}finally{st.nodeEnd()}}}class qi extends wn{constructor(i,o,l,s=0,u){super();Oe(this,"name");Oe(this,"depth");Oe(this,"statusKey");Oe(this,"timestampKey");this.child=i,this.cacheDurationHours=o,this.validityCheck=u,this.name=l,this.depth=s,this.child.depth=(this.depth??0)+1,this.statusKey=`caching_${this.name}_status`,this.timestampKey=`caching_${this.name}_timestamp`}execute(i,o,l){st.nodeStart(this.name);try{const s=o.gameState.time,u=w.get(l,this.statusKey),d=w.get(l,this.timestampKey);if(u!==void 0&&d!==void 0){const v=s-d>this.cacheDurationHours,y=this.validityCheck?this.validityCheck(i,o,l):!0;if(!v&&y){const A=(d+this.cacheDurationHours-s).toFixed(2),I=`Cache hit. Status: ${T[u]}. ${A}h left.`;return this.setLastStatus(i,u),w.recordNodeExecution(l,this.name,this.getLastStatus(i),s,this.depth,I),this.getLastStatus(i)}}const[f,g]=Qt(this.child.execute(i,o,l));(f===T.SUCCESS||f===T.FAILURE)&&(w.set(l,this.statusKey,f),w.set(l,this.timestampKey,s)),this.setLastStatus(i,f);const m=`Cache miss. Child returned ${T[f]}. ${g}`;return w.recordNodeExecution(l,this.name,this.getLastStatus(i),s,this.depth,m),this.getLastStatus(i)}finally{st.nodeEnd()}}}class Ti extends wn{constructor(i,o,l,s=0){super();Oe(this,"name");Oe(this,"depth");Oe(this,"cooldownKey");this.cooldownDurationHours=i,this.child=o,this.name=l,this.depth=s,this.child.depth=(this.depth??0)+1,this.cooldownKey=`cooldown_${this.name}`}execute(i,o,l){st.nodeStart(this.name);try{const s=o.gameState.time,u=w.get(l,this.cooldownKey);if(this.child.getLastStatus(i)===T.RUNNING){const[g,m]=Qt(this.child.execute(i,o,l));if(this.setLastStatus(i,g),this.name){const v=`Continuing running child. ${m}`;w.recordNodeExecution(l,this.name,this.getLastStatus(i),s,this.depth,v)}return this.getLastStatus(i)}if(u!==void 0&&s<u){const m=`Cooldown active, ${(u-s).toFixed(2)}h left`;return this.setLastStatus(i,T.FAILURE),this.name&&w.recordNodeExecution(l,this.name,this.getLastStatus(i),s,this.depth,m),this.getLastStatus(i)}const[d,f]=Qt(this.child.execute(i,o,l));return d===T.SUCCESS&&w.set(l,this.cooldownKey,s+this.cooldownDurationHours),this.setLastStatus(i,d),this.name&&w.recordNodeExecution(l,this.name,this.getLastStatus(i),s,this.depth,f),this.getLastStatus(i)}finally{st.nodeEnd()}}}class sn extends wn{constructor(i,o,l,s=0){super();Oe(this,"name");Oe(this,"depth");this.child=i,this.behaviorKey=o,this.name=l,this.depth=s;const u=(d,f)=>{d.depth=f,d.children?d.children.forEach(g=>u(g,f+1)):d.child&&u(d.child,f+1)};u(this.child,(this.depth??0)+1)}execute(i,o,l){this.name&&st.nodeStart(this.name);try{if(i.isPlayer&&!o.gameState.autopilotControls.behaviors[this.behaviorKey]){const f=`Player autopilot for '${this.behaviorKey}' is disabled.`;return this.setLastStatus(i,T.FAILURE),this.name&&w.recordNodeExecution(l,this.name,this.getLastStatus(i),o.gameState.time,this.depth,f),this.getLastStatus(i)}const[u,d]=Qt(this.child.execute(i,o,l));return this.setLastStatus(i,u),this.name&&w.recordNodeExecution(l,this.name,this.getLastStatus(i),o.gameState.time,this.depth,d),this.getLastStatus(i)}finally{this.name&&st.nodeEnd()}}}class d1 extends wn{constructor(i,o,l=0){super();Oe(this,"name");Oe(this,"depth");this.child=i,this.name=o,this.depth=l;const s=(u,d)=>{u.depth=d,u.children?u.children.forEach(f=>s(f,d+1)):u.child&&s(u.child,d+1)};s(this.child,(this.depth??0)+1)}execute(i,o,l){this.name&&st.nodeStart(this.name);try{if(i.isPlayer&&o.gameState.autopilotControls.isManuallyMoving)return this.setLastStatus(i,T.FAILURE),this.name&&w.recordNodeExecution(l,this.name,this.getLastStatus(i),o.gameState.time,this.depth,"Manual movement active, AI blocked."),this.getLastStatus(i);const[s,u]=Qt(this.child.execute(i,o,l));return this.setLastStatus(i,s),this.name&&w.recordNodeExecution(l,this.name,this.getLastStatus(i),o.gameState.time,this.depth,u),this.getLastStatus(i)}finally{this.name&&st.nodeEnd()}}}class _r extends wn{constructor(i,o,l=0){super();Oe(this,"name");Oe(this,"depth");this.child=i,this.name=o,this.depth=l;const s=(u,d)=>{u.depth=d,u.children?u.children.forEach(f=>s(f,d+1)):u.child&&s(u.child,d+1)};s(this.child,(this.depth??0)+1)}execute(i,o,l){this.name&&st.nodeStart(this.name);try{if(i.isPlayer)return this.setLastStatus(i,T.FAILURE),this.name&&w.recordNodeExecution(l,this.name,this.getLastStatus(i),o.gameState.time,this.depth,"Player controlled, AI blocked."),this.getLastStatus(i);const[s,u]=Qt(this.child.execute(i,o,l));return this.setLastStatus(i,s),this.name&&w.recordNodeExecution(l,this.name,this.getLastStatus(i),o.gameState.time,this.depth,u),this.getLastStatus(i)}finally{this.name&&st.nodeEnd()}}}const $o=24,mh=2,TS=2;function ya(e,t){if(e.leaderId){const i=t.entities.entities[e.leaderId];if(i&&i.aiBlackboard)return i}if(e.isAdult&&e.aiBlackboard)return e;if(!e.isAdult&&e.fatherId){const i=t.entities.entities[e.fatherId];if(i&&i.aiBlackboard)return i}return null}function f1(e,t){if(!e.aiBlackboard)return;const i=e.aiBlackboard.data,o=[];for(const l in i)if(l.startsWith("tribal_")){const s=i[l];s&&typeof s=="object"&&"startTime"in s&&t-s.startTime>$o&&o.push(l)}for(const l of o)w.delete(e.aiBlackboard,l)}class ar extends wn{constructor(i,o,l,s=0){super();Oe(this,"name");Oe(this,"depth");Oe(this,"registeredKey");this.child=i,this.config=o,this.name=l,this.depth=s,this.child.depth=(this.depth??0)+1,this.registeredKey=`${this.name}_registered`}execute(i,o,l){st.nodeStart(this.name);try{const s=ya(i,o.gameState);if(!s||!s.aiBlackboard){const[I,E]=Qt(this.child.execute(i,o,l));return this.setLastStatus(i,I),w.recordNodeExecution(l,this.name,I,o.gameState.time,this.depth,`No coordination: ${E}`),I}const u=o.gameState.time,d=w.get(l,this.registeredKey)??!1,f=this.getTaskTarget(i,o,l);if(!f)return this.setLastStatus(i,T.FAILURE),w.recordNodeExecution(l,this.name,T.FAILURE,u,this.depth,"No task target found"),T.FAILURE;const g=this.getTaskKey(f);if(d){const[I,E]=Qt(this.child.execute(i,o,l));return I===T.RUNNING?(this.refreshTaskTimestamp(s.aiBlackboard,g,i.id,u),this.setLastStatus(i,I),w.recordNodeExecution(l,this.name,I,u,this.depth,`Continuing: ${E}`),I):(this.removeFromTask(s.aiBlackboard,g,i.id),w.delete(l,this.registeredKey),this.setLastStatus(i,I),w.recordNodeExecution(l,this.name,I,u,this.depth,`Completed: ${E}`),I)}if(!this.canJoinTask(s.aiBlackboard,g,i.id,u)){this.setLastStatus(i,T.FAILURE);const I=w.get(s.aiBlackboard,g),E=(I==null?void 0:I.memberIds.length)??0,C=this.config.maxCapacity??1;return w.recordNodeExecution(l,this.name,T.FAILURE,u,this.depth,`Task full: ${E}/${C}`),T.FAILURE}if(!this.registerTask(s.aiBlackboard,g,i.id,u))return this.setLastStatus(i,T.FAILURE),w.recordNodeExecution(l,this.name,T.FAILURE,u,this.depth,"Failed to register task"),T.FAILURE;w.set(l,this.registeredKey,!0);const[y,A]=Qt(this.child.execute(i,o,l));if(y===T.RUNNING){this.setLastStatus(i,y);const I=w.get(s.aiBlackboard,g),E=(I==null?void 0:I.memberIds.length)??0,C=this.config.maxCapacity??1;return w.recordNodeExecution(l,this.name,y,u,this.depth,`Started (${E}/${C}): ${A}`),y}else return this.removeFromTask(s.aiBlackboard,g,i.id),w.delete(l,this.registeredKey),this.setLastStatus(i,y),w.recordNodeExecution(l,this.name,y,u,this.depth,`Immediate result: ${A}`),y}finally{st.nodeEnd()}}getTaskTarget(i,o,l){var u,d,f,g;if(this.config.taskType==="procreation")return((d=(u=this.config).getTargetId)==null?void 0:d.call(u,i,o,l))??null;const s=(g=(f=this.config).getTargetId)==null?void 0:g.call(f,i,o,l);return s??null}getTaskKey(i){return this.config.generateTaskKey?this.config.generateTaskKey(this.config.taskType,i):`tribal_${this.config.taskType}_${i}`}canJoinTask(i,o,l,s){const u=w.get(i,o);if(!u||s-u.startTime>$o||u.memberIds.includes(l))return!0;const d=this.config.maxCapacity??1;return u.memberIds.length<d}registerTask(i,o,l,s){let u=w.get(i,o);return u?s-u.startTime>$o?(u={memberIds:[l],startTime:s,maxCapacity:this.config.maxCapacity??1},w.set(i,o,u),!0):u.memberIds.length>=(this.config.maxCapacity??1)?!!u.memberIds.includes(l):(u.memberIds.includes(l)||(u.memberIds.push(l),w.set(i,o,u)),!0):(u={memberIds:[l],startTime:s,maxCapacity:this.config.maxCapacity??1},w.set(i,o,u),!0)}refreshTaskTimestamp(i,o,l,s){const u=w.get(i,o);u&&u.memberIds.includes(l)&&(u.startTime=s,w.set(i,o,u))}removeFromTask(i,o,l){const s=w.get(i,o);s&&(s.memberIds=s.memberIds.filter(u=>u!==l),s.memberIds.length===0?w.delete(i,o):w.set(i,o,s))}}function h1(e){return new he([new Q((t,i)=>{const o=t.hunger>=wf,l=t.food.length>0,s=!t.eatingCooldownTime||i.gameState.time>=t.eatingCooldownTime;return[!!(o&&l&&s),`${Math.floor(t.hunger-wf)}, ${t.food.length}, ${t.eatingCooldownTime?Math.floor(t.eatingCooldownTime-i.gameState.time):""}`]},"Can Eat",e+1),new oe(t=>(t.direction={x:0,y:0},t.target=void 0,t.activeAction="eating",T.RUNNING),"Eat",e+1)],"Eating",e)}function g1(e){return new he([new Q((t,i,o)=>{if(t.isAdult&&t.hitpoints>t.maxHitpoints*wv||!(t.hitpoints<t.maxHitpoints*.1)&&t.isAdult&&t.hunger>PI)return!1;const s=ow(t.id,i.gameState);return s?(w.set(o,"fleeThreat",s.id),!0):!1},"Should Flee",e+1),new oe((t,i,o)=>{const l=w.get(o,"fleeThreat"),s=l&&i.gameState.entities.entities[l];if(!s)return T.FAILURE;t.activeAction="moving";const u=ze(s.position,t.position,i.gameState.mapDimensions.width,i.gameState.mapDimensions.height),d=nt(u),f=Un(t.position,Pt(d,_v));return t.target={x:(f.x%i.gameState.mapDimensions.width+i.gameState.mapDimensions.width)%i.gameState.mapDimensions.width,y:(f.y%i.gameState.mapDimensions.height+i.gameState.mapDimensions.height)%i.gameState.mapDimensions.height},t.direction=d,T.RUNNING},"Execute Flee",e+1)],"Flee",e)}const AS=100,p1=25;function I0(e){const t=Math.sin(e)*1e4;return t-Math.floor(t)}function m1(e,t,i=AS){return t.search.building.byRadius(e.position,i).some(s=>{const u=s;return u.buildingType==="storageSpot"&&u.ownerId===e.leaderId&&u.isConstructed&&u.storedFood&&u.storageCapacity&&u.storedFood.length<u.storageCapacity})}function v1(e,t,i=AS){return t.search.building.byRadius(e.position,i).filter(s=>{const u=s;return u.buildingType==="storageSpot"&&u.ownerId===e.leaderId&&u.isConstructed&&u.storedFood&&u.storedFood.length>0})}function S1(e,t,i){if(t.length===0)return null;let o=null,l=1/0;for(const s of t){const u=Y(e.position,s.position,i.mapDimensions.width,i.mapDimensions.height);u<l&&(l=u,o=s)}return o?{storage:o,distance:l}:null}function IS(e){const t=e.storedFood?e.storedFood.length:0,i=I0(t+e.id)*2*Math.PI,o=I0(t+e.id+1)*p1;return{x:Math.cos(i)*o,y:Math.sin(i)*o}}const So="foodSource";function y1(e){const t=new oe((o,l,s)=>{const u=ya(o,l.gameState),d=new Map,f=Ne(o,l.gameState,"berryBush",Hm,v=>{var E;if(v.food.length===0)return!1;if(u&&u.aiBlackboard){const C=`tribal_gather_${v.id}`,F=w.get(u.aiBlackboard,C);if(F&&l.gameState.time-F.startTime<=$o&&!F.memberIds.includes(o.id))return!1}const y=(E=l.gameState.search.building.byRadius(v.position,v.radius)[0])==null?void 0:E.ownerId,A=l.gameState.entities.entities[y];if(!A||A.leaderId===o.leaderId)return!0;const I=d.get(A.id)??Y(o.position,A.position,l.gameState.mapDimensions.width,l.gameState.mapDimensions.height);return d.set(A.id,I),I>eE}),g=Ne(o,l.gameState,"corpse",Hm,v=>{if(v.food.length===0)return!1;if(u&&u.aiBlackboard){const y=`tribal_gather_${v.id}`,A=w.get(u.aiBlackboard,y);if(A&&l.gameState.time-A.startTime<=$o&&!A.memberIds.includes(o.id))return!1}return!0});let m=null;if(f&&g){const v=Y(o.position,f.position,l.gameState.mapDimensions.width,l.gameState.mapDimensions.height),y=Y(o.position,g.position,l.gameState.mapDimensions.width,l.gameState.mapDimensions.height);m=v<=y?f:g}else m=f||g;return m?(w.set(s,So,m.id),[T.SUCCESS,`Found food: ${m.type} at ${m.position.x.toFixed(0)},${m.position.y.toFixed(0)}`]):[T.FAILURE,"No food source found"]},"Find Closest Food Source",e+4),i=new ar(new oe((o,l,s)=>{const u=w.get(s,So);if(!u)return[T.FAILURE,"No target in blackboard"];const d=l.gameState.entities.entities[u];return!d||d.food.length===0?(w.delete(s,So),[T.FAILURE,"Food source is invalid or depleted"]):Y(o.position,d.position,l.gameState.mapDimensions.width,l.gameState.mapDimensions.height)<$r?(o.activeAction="gathering",o.direction={x:0,y:0},o.target=d.id,w.delete(s,So),[T.SUCCESS,`Gathering from ${d.type}`]):(o.activeAction="moving",o.target=d.id,o.direction=Ft(o.position,d.position,l.gameState.mapDimensions),[T.RUNNING,`Moving to ${d.type}`])},"Move To Food and Gather",e+3),{taskType:"gather",maxCapacity:2,getTargetId:(o,l,s)=>w.get(s,So)??null},"Tribal Gather Task",e+3);return new he([new Q((o,l)=>{const s=o.food.length<o.maxFood,u=o.hunger>yI,d=Ut(l.gameState,o).filter(g=>g.hunger>Xf),f=m1(o,l.gameState);return[(o.isAdult&&s&&(u||d.length>0||f))??!1,`${u?"H":""}${d.length>0?" HC("+d.length+")":""}${f?" S":""}`]},"Should Gather Food",e+1),new Wt([new he([new Q((o,l,s)=>w.has(s,So),"Has Food Source?",e+2),i],"Continue Gathering Action",e+2),new he([new qi(t,BI,"Cache Food Source Search",e+3),i],"Find New Food Source and Gather",e+2)],"Perform or Start Gathering",e+1)],"Gather Food",e)}function T1(e){return new oe((t,i,o)=>(t.activeAction="idle",t.direction={x:0,y:0},t.target=void 0,w.set(o,"wanderTarget",void 0),T.SUCCESS),"Idle",e)}const jl="procreationWanderStartTime",E0=(e,t,i)=>t.find(o=>Wr(e,o,i)),w0={taskType:"procreation",maxCapacity:2,getTargetId:(e,t,i)=>w.get(i,"procreationPartner")??null};function A1(e){const t=new Q((s,u,d)=>{const f=Xm(s,u.gameState,$r),g=E0(s,f,u.gameState);return g?(w.set(d,"procreationPartner",g.id),!0):!1},"Find Immediate Partner"),i=new ar(new oe((s,u,d)=>{var m;const f=w.get(d,"procreationPartner"),g=f&&u.gameState.entities.entities[f];return g?(s.activeAction="procreating",s.target=void 0,w.delete(d,"procreationPartner"),w.delete(d,jl),(m=s.partnerIds)!=null&&m.includes(g.id)||(s.partnerIds=s.partnerIds?[...s.partnerIds,g.id]:[g.id]),T.SUCCESS):T.FAILURE},"Start Procreating"),w0,"Tribal Start Procreating",e+2),o=new Q((s,u,d)=>{const f=Xm(s,u.gameState,RI),g=E0(s,f,u.gameState);return g?(w.set(d,"procreationPartner",g.id),!0):!1},"Locate Distant Partner"),l=new ar(new oe((s,u,d)=>{const f=w.get(d,"procreationPartner"),g=f&&u.gameState.entities.entities[f];if(!g||g.isPregnant)return T.FAILURE;if(Y(s.position,g.position,u.gameState.mapDimensions.width,u.gameState.mapDimensions.height)<$r)return T.SUCCESS;s.activeAction="moving",s.target=g.id;const v=ze(s.position,g.position,u.gameState.mapDimensions.width,u.gameState.mapDimensions.height);return s.direction=nt(v),T.RUNNING},"Move Towards Partner"),w0,"Tribal Move To Partner",e+3);return new he([new Q(s=>!(!s.isAdult||s.gender==="female"&&s.isPregnant||s.age<wE||s.gender==="female"&&s.age>Ov),"Is Fertile (age, not pregnant)",e+1),new Q(s=>s.hunger<xr,"Is Healthy (hunger)",e+1),new Q(s=>(s.procreationCooldown||0)<=0,"Is Ready (cooldown)",e+1),new Wt([new he([new Q((s,u)=>Qm(s.position,u.gameState,"berryBush",Um)>=CI,"Is Environment Viable (food)",e+3),new oe((s,u,d)=>(w.delete(d,jl),T.SUCCESS),"Clear Wander Timer",e+3)],"Sufficient Food Path",e+2),new he([new Q((s,u)=>{if(s.gender==="male"){const d=Ut(u.gameState,s);return!yi(d)}return!1},"Is Male Without Heir",e+3),new oe((s,u,d)=>{const f=w.get(d,jl);if(f===void 0)return w.set(d,jl,u.gameState.time),[T.FAILURE,"Starting heirless wander timer"];const g=u.gameState.time-f;return g>=_E?Qm(s.position,u.gameState,"berryBush",Um)>=1?[T.SUCCESS,`Wandered for ${g.toFixed(1)}h, minimum food found`]:[T.FAILURE,"Desperate but no food sources nearby"]:[T.FAILURE,`Wandering for heir, ${g.toFixed(1)}h elapsed`]},"Check Wander Timer",e+3)],"Heirless Desperation Path",e+2)],"Check Environment Or Desperation",e+1),new Q((s,u,d)=>{var g;const f=w.get(d,"procreationPartner");return f&&((g=f.partnerIds)!=null&&g.length)&&!f.partnerIds.includes(s.id)&&f.partnerIds.map(m=>u.gameState.entities.entities[m]).filter(m=>!!m).some(m=>Y(s.position,m.position,u.gameState.mapDimensions.width,u.gameState.mapDimensions.height)<JI)?[!1,"Partner's primary partner is too close"]:!0},"Is Partner's Primary Partner Nearby",e+1),new Wt([new he([t,i],"Procreate With Immediate Partner",e+2),new Ti(FI,new he([o,l],"Seek Distant Partner Action",e+3),"Seek Distant Partner Cooldown",e+2)],"Find Partner And Procreate",e+1)],"Procreate",e)}const yo="attackTarget",Cr="homeCenter",Qd=150;function I1(e){return new he([new Q((t,i,o)=>{if(!t.isAdult)return[!1,"Not an adult"];const{gameState:l}=i;if(t.activeAction==="attacking"&&t.attackTargetId){const u=l.entities.entities[t.attackTargetId];if(u&&u.hitpoints>0&&Y(t.position,u.position,l.mapDimensions.width,l.mapDimensions.height)<=Qd){if(w.set(o,yo,u.id),!w.get(o,Cr)){const d=t.leaderId?zr(t.leaderId,l):vu(t,l).length>0?Zm(t,l):t.position;w.set(o,Cr,d)}return!0}}const s=Ne(t,l,"human",Qd,u=>u.hitpoints>0&&Xo(t,u,l));if(s){w.set(o,yo,s.id);const u=t.leaderId?zr(t.leaderId,l):vu(t,l).length>0?Zm(t,l):t.position;return w.set(o,Cr,u),!0}return w.set(o,yo,void 0),w.set(o,Cr,void 0),!1},"Find Attack Target",e+1),new oe((t,i,o)=>{const l=w.get(o,yo),s=l&&i.gameState.entities.entities[l],u=w.get(o,Cr);if(!s||!u)return T.FAILURE;const{gameState:d}=i;return Y(t.position,u,d.mapDimensions.width,d.mapDimensions.height)>Ev?(t.activeAction="idle",t.attackTargetId=void 0,w.set(o,yo,void 0),w.set(o,Cr,void 0),T.FAILURE):s.hitpoints<=0||Y(t.position,s.position,d.mapDimensions.width,d.mapDimensions.height)>Qd?(t.activeAction==="attacking"&&(t.activeAction="idle",t.attackTargetId=void 0),w.set(o,yo,void 0),w.set(o,Cr,void 0),T.SUCCESS):(t.activeAction==="attacking"&&t.attackTargetId===s.id||(t.activeAction="attacking",t.attackTargetId=s.id),T.RUNNING)},"Execute Attack",e+1)],"Attack",e)}const E1=(e,t,i)=>{const o=Ut(t.gameState,e).filter(u=>!u.isAdult);if(o.length===0)return T.FAILURE;let l=null,s=Xf;for(const u of o)u.hunger>=s&&(s=u.hunger,l=u);return l?(w.set(i,"targetChild",l.id),T.SUCCESS):T.FAILURE},w1=(e,t,i)=>{const o=w.get(i,"targetChild"),l=o&&t.gameState.entities.entities[o];return l?Y(e.position,l.position,t.gameState.mapDimensions.width,t.gameState.mapDimensions.height)>Kf?(e.activeAction="moving",e.target=l.id,e.direction=Ft(e.position,l.position,t.gameState.mapDimensions),T.RUNNING):(e.activeAction="feeding",e.target=void 0,w.set(i,"targetChild",void 0),T.SUCCESS):T.FAILURE};function _1(e){return new he([new Q(t=>(t.isAdult&&t.food.length>0&&(!t.feedChildCooldownTime||t.feedChildCooldownTime<=0))??!1,"Can Feed Child",e+1),new oe(E1,"Find Hungriest Child",e+1),new oe(w1,"Move To Child and Feed",e+1)],"Feed Child",e)}function C1(e){return new he([new Q(t=>!t.isAdult&&t.hunger>=Xf,"Is Hungry Child",e+1),new oe((t,i,o)=>{const l=XE(t,i.gameState);if(l.length===0)return T.FAILURE;const s=Ne(t,i.gameState,"human",DE,u=>l.some(d=>d.id===u.id)&&u.food.length>0);return s?(w.set(o,"targetParent",s.id),T.SUCCESS):T.FAILURE},"Find Parent With Food",e+1),new oe((t,i,o)=>{const l=w.get(o,"targetParent"),s=l&&i.gameState.entities.entities[l];if(!s)return T.FAILURE;const u=Y(t.position,s.position,i.gameState.mapDimensions.width,i.gameState.mapDimensions.height);return t.activeAction="idle",u<=Kf?(t.target=void 0,T.SUCCESS):(t.target=s.id,t.activeAction="moving",T.RUNNING)},"Move To Parent",e+1)],"Seek Food From Parent",e)}const To="plantingSpot",xs="plantingZoneId",R1=50;function P1(e,t,i,o){const l=ze(e,t,i,o);return Un(e,l)}function N1(e){const t=new oe((l,s,u)=>{const d=w.get(u,To);if(!d)return w.delete(u,To),w.delete(u,xs),[T.FAILURE,"Planting spot is missing"];if(bn(d,s.gameState,br,l.id))return w.delete(u,To),w.delete(u,xs),[T.FAILURE,"Planting spot is occupied"];const f=P1(l.position,d,s.gameState.mapDimensions.width,s.gameState.mapDimensions.height),g=Y(l.position,f,s.gameState.mapDimensions.width,s.gameState.mapDimensions.height);return g>$r?(l.activeAction="moving",l.target=f,l.direction=Ft(l.position,f,s.gameState.mapDimensions),[T.RUNNING,"Moving to planting spot: "+g.toFixed(2)+" units away"]):bn(d,s.gameState,br,l.id)?(w.delete(u,To),w.delete(u,xs),[T.FAILURE,"Planting spot is now occupied"]):(l.activeAction="planting",l.target=d,[T.RUNNING,"Planting state initiated"])},"Move To Spot and Plant",e+4),i=new ar(t,{taskType:"plant",maxCapacity:2,proximityRadius:R1,getTargetId:(l,s,u)=>w.get(u,xs)??null},"Coordinated Planting",e+3),o=new oe((l,s,u)=>{const d=aC(l,s.gameState);return d?(w.set(u,To,d.position),w.set(u,xs,d.zoneId),[T.SUCCESS,`Found new spot at ${d.position.x.toFixed(0)}, ${d.position.y.toFixed(0)} (Zone ${d.zoneId})`]):[T.FAILURE,"No suitable planting spot found"]},"Find Optimal Planting Spot",e+3);return new he([new Q(l=>{const s=l.food.filter(f=>f.type===Bn.Berry).length>=Hr,u=l.hunger<TI,d=(l.isAdult&&s&&u)??!1;return[d,d?"Can plant":`Cannot plant: adult=${l.isAdult}, berries=${l.food.filter(f=>f.type===Bn.Berry).length}/${Hr}, hunger=${l.hunger.toFixed(0)}`]},"Can Plant",e+1),new Q((l,s)=>{if(!l.leaderId)return[!1,"No tribe"];const u=J_(l,s.gameState),d=lS(l.leaderId,s.gameState);let f;return u<nE?f=oE:u<iE?f=sE:u<rE?f=aE:f=lE,[d<f,`Food security: ${(u*100).toFixed(0)}%, Bush density: ${d.toFixed(1)}/${f}`]},"Needs More Bushes (Adaptive)",e+1),new Q((l,s)=>{if(!l.leaderId)return[!0,"No tribe coordination needed"];const u=Hn(l,s.gameState),d=uS(l.leaderId,s.gameState,"planting"),f=Math.max(1,Math.ceil(u.length*.3));return[d<f,`Active planters: ${d}/${f}`]},"Not Too Many Planters",e+1),new Wt([new he([new Q((l,s,u)=>w.has(u,To),"Has Planting Spot?",e+2),i],"Continue Planting Action",e+2),new Ti(UI,o,"Find Planting Spot Cooldown",e+2)],"Perform or Start Planting",e+1)],"Plant Bush",e)}const _0="lastDepositTime",Ao="assignedStorageSpot";function D1(e){return new Wt([new he([new Q((t,i,o)=>{const l=w.get(o,_0)||0,s=i.gameState.time-l;if(s<bm)return[!1,`Cooldown: ${(bm-s).toFixed(1)}h remaining`];if(!t.isAdult)return[!1,"Not an adult"];if(!t.leaderId)return[!1,"No tribe"];const u=aS(t.leaderId,i.gameState);let d;u<.3?d=uE:u<.7?d=cE:d=dE;const f=t.food.length/t.maxFood;if(f<=d)return[!1,`Food ${(f*100).toFixed(0)}% < threshold ${(d*100).toFixed(0)}%`];const g=sC(t,i.gameState);return g?(w.set(o,Ao,g.id),[!0,`Storage util: ${(u*100).toFixed(0)}%, Personal: ${(f*100).toFixed(0)}%`]):[!1,"No available tribe storage nearby"]},"Check for Excess Food and Storage",e+1),new Q((t,i)=>{if(!t.leaderId)return[!0,"No tribe coordination needed"];const o=uS(t.leaderId,i.gameState,"depositing"),l=Hn(t,i.gameState),s=Math.max(1,Math.ceil(l.length*.4));return[o<s,`Active depositors: ${o}/${s}`]},"Not Too Many Depositors",e+1),new ar(new oe((t,i,o)=>{var d;const l=w.get(o,Ao);if(!l)return[T.FAILURE,"No storage assigned"];const s=i.gameState.entities.entities[l];if(!s)return w.delete(o,Ao),[T.FAILURE,"Storage entity missing"];if((((d=s.storedFood)==null?void 0:d.length)??0)>=(s.storageCapacity??0))return w.delete(o,Ao),[T.FAILURE,"Storage full"];const u=Y(t.position,s.position,i.gameState.mapDimensions.width,i.gameState.mapDimensions.height);return u<=In?(t.activeAction="depositing",t.target=void 0,w.set(o,_0,i.gameState.time),w.delete(o,Ao),[T.SUCCESS,"Depositing food"]):(t.activeAction="moving",t.target=s.position,[T.RUNNING,`Moving to storage (${u.toFixed(1)}px away)`])},"Navigate to Storage and Deposit",e+2),{taskType:"storage",maxCapacity:TS,storageAction:"deposit",getTargetId:(t,i,o)=>w.get(o,Ao)??null},"Tribal Storage Deposit Task",e+1)],"Deposit Sequence",e)],"Storage Deposit Behavior",e)}const Vl="retrievalStorageId";function O1(e){return new Wt([new he([new Q((t,i,o)=>{if(t.hunger<=wf)return[!1,"Not hungry enough"];if(t.food.length>=t.maxFood)return[!1,"Inventory full"];const l=v1(t,i.gameState),s=S1(t,l,i.gameState),u=s==null?void 0:s.storage;return u?(w.set(o,Vl,u.id),[!0,`Storage with food found at distance ${s.distance.toFixed(1)}`]):[!1,"No tribe storage with food nearby"]},"Check for Hunger and Storage Food",e+1),new ar(new oe((t,i,o)=>{const l=w.get(o,Vl);if(!l)return[T.FAILURE,"No storage target"];const s=i.gameState.entities.entities[l];if(!s)return w.delete(o,Vl),[T.FAILURE,"Storage not found"];const u=Y(t.position,s.position,i.gameState.mapDimensions.width,i.gameState.mapDimensions.height);return u<=In?(t.activeAction="retrieving",t.target=void 0,[T.SUCCESS,"Retrieving food"]):(t.activeAction="moving",t.target=s.position,[T.RUNNING,`Moving to storage (${u.toFixed(1)}px away)`])},"Navigate to Storage and Retrieve",e+2),{taskType:"storage",maxCapacity:TS,storageAction:"retrieve",getTargetId:(t,i,o)=>w.get(o,Vl)??null},"Coordinated Storage Retrieve",e+1)],"Retrieve Sequence",e)],"Storage Retrieve Behavior",e)}function M1(e){return new Wt([new he([new Q((t,i,o)=>{if(!t.isAdult)return[!1,"Not an adult"];if(t.food.length>=t.maxFood)return[!1,"Inventory full"];if(!t.leaderId)return[!1,"No tribe leader"];const l=i.gameState.entities.entities[t.leaderId];if(!l||!l.diplomacy)return[!1,"No diplomacy info"];const d=i.gameState.search.building.byRadius(t.position,150).find(f=>{const g=f;if(g.buildingType!=="storageSpot"||!g.isConstructed||!g.storedFood||g.storedFood.length===0||g.ownerId===t.leaderId||l.diplomacy[g.ownerId]!==pt.Hostile)return!1;const v=Hn({leaderId:g.ownerId},i.gameState);for(const y of v)if(Y(t.position,y.position,i.gameState.mapDimensions.width,i.gameState.mapDimensions.height)<=Nf)return!1;return!0});return d?[!0,`Undefended enemy storage found at distance ${Y(t.position,d.position,i.gameState.mapDimensions.width,i.gameState.mapDimensions.height).toFixed(1)}`]:[!1,"No undefended enemy storage nearby"]},"Check for Undefended Enemy Storage",e+1),new oe((t,i,o)=>{if(!t.leaderId)return[T.FAILURE,"No tribe leader"];const l=i.gameState.entities.entities[t.leaderId];if(!l||!l.diplomacy)return[T.FAILURE,"No diplomacy info"];const d=i.gameState.search.building.byRadius(t.position,150).filter(m=>{const v=m;if(v.buildingType!=="storageSpot"||!v.isConstructed||!v.storedFood||v.storedFood.length===0||v.ownerId===t.leaderId||l.diplomacy[v.ownerId]!==pt.Hostile)return!1;const A=Hn({leaderId:v.ownerId},i.gameState);for(const I of A)if(Y(t.position,I.position,i.gameState.mapDimensions.width,i.gameState.mapDimensions.height)<=Nf)return!1;return!0});if(d.length===0)return[T.FAILURE,"No undefended storage available"];let f=null,g=1/0;for(const m of d){const v=Y(t.position,m.position,i.gameState.mapDimensions.width,i.gameState.mapDimensions.height);v<g&&(g=v,f=m)}return f?g<=In?(t.activeAction="idle",t.target=void 0,[T.SUCCESS,"Stealing food"]):(t.activeAction="moving",t.target=f.position,[T.RUNNING,`Moving to enemy storage (${g.toFixed(1)}px away)`]):[T.FAILURE,"No storage found"]},"Navigate to Enemy Storage and Steal",e+1)],"Steal Sequence",e)],"Storage Steal Behavior",e)}const Jd="enemiesNearby";function k1(e){const t=new Q(s=>s.id===s.leaderId,"Is Leader?",e+1),i=new Q(s=>!s.isCallingToAttack,"Is Not Already Calling?",e+1),o=new oe((s,u,d)=>{const f=nh(s,u.gameState,eS);return f.length>0?(w.set(d,Jd,f.map(g=>g.id)),T.SUCCESS):T.FAILURE},"Find Nearby Enemies",e+1),l=new Wt([new he([new Q((s,u,d)=>{const f=w.get(d,Jd),g=f==null?void 0:f.map(A=>u.gameState.entities.entities[A]).filter(A=>!!A);if(!g||g.length===0)return!1;const m=fa(s.id,u.gameState),v=Su(m),y=Su(g);return v>y*jI},"Is Strong Enough?",e+3),new oe((s,u)=>(s.isCallingToAttack=!0,s.callToAttackEndTime=u.gameState.time+xo,Me(u.gameState,ce.CallToAttack,s.position,xo),Ie(u,fe.CallToAttack,s.position),s.activeAction="idle",s.target=void 0,T.SUCCESS),"Issue Call to Attack",e+3)],"Attack",e+2),new oe((s,u,d)=>{const f=w.get(d,Jd),g=f==null?void 0:f.map(E=>u.gameState.entities.entities[E]).filter(E=>!!E);if(!g||g.length===0)return T.FAILURE;const m=g.map(E=>E.position),v=mu(m),y=ze(v,s.position,u.gameState.mapDimensions.width,u.gameState.mapDimensions.height),A=nt(y),I=Un(s.position,Pt(A,_v*2));return s.activeAction="moving",s.target={x:(I.x%u.gameState.mapDimensions.width+u.gameState.mapDimensions.width)%u.gameState.mapDimensions.width,y:(I.y%u.gameState.mapDimensions.height+u.gameState.mapDimensions.height)%u.gameState.mapDimensions.height},s.direction=A,T.SUCCESS},"Retreat",e+2)],"Attack or Retreat",e+2);return new he([t,i,o,new Ti(VI,l,"Leader Combat Cooldown",e+1)],"Leader Combat Strategy",e)}const ef="combatTarget",tf="homeCenter";function F1(e){const t=new Q(u=>u.isAdult&&u.leaderId?u.id!==u.leaderId:!1,"Is Tribe Follower?",e+1),i=new Q(u=>u.hunger<AI&&u.hitpoints>=u.maxHitpoints*wv,"Is Fit for Combat?",e+1),o=new Q((u,d)=>{const f=d.gameState.entities.entities[u.leaderId];return!!(f!=null&&f.isCallingToAttack)},"Is Leader Calling to Attack?",e+1),l=new oe((u,d,f)=>{const{gameState:g}=d,m=g.entities.entities[u.leaderId];if(!m)return T.FAILURE;const v=nh(m,g,NI);if(v.length===0)return T.FAILURE;v.sort((y,A)=>{const I=Y(u.position,y.position,g.mapDimensions.width,g.mapDimensions.height),E=Y(u.position,A.position,g.mapDimensions.width,g.mapDimensions.height);return I-E});for(const y of v)if(nw(m.id,y.id,g)<DI){w.set(f,ef,y.id);const I=zr(m.id,g);return w.set(f,tf,I),T.SUCCESS}return T.FAILURE},"Find Best Target",e+1),s=new oe((u,d,f)=>{const g=w.get(f,ef),m=g&&d.gameState.entities.entities[g],v=w.get(f,tf);if(!m||!v)return T.FAILURE;const{gameState:y}=d;return Y(u.position,v,y.mapDimensions.width,y.mapDimensions.height)>Ev?(u.activeAction==="attacking"&&u.attackTargetId===m.id&&(u.activeAction="idle",u.attackTargetId=void 0),w.set(f,ef,void 0),w.set(f,tf,void 0),T.FAILURE):((!u.lastTargetAcquiredEffectTime||d.gameState.time-u.lastTargetAcquiredEffectTime>xe*5)&&(Me(d.gameState,ce.TargetAcquired,u.position,xe,u.id),u.lastTargetAcquiredEffectTime=d.gameState.time),u.activeAction="attacking",u.attackTargetId=m.id,u.target=void 0,T.RUNNING)},"Attack Target",e+1);return new he([t,i,o,l,s],"Tribe Member Combat",e)}function L1(e,t,i,o,l,s,u){const d=u.mapDimensions.width,f=u.mapDimensions.height,g=Math.PI/8,v=i*2/(2*Math.PI);let y=0,A=0;for(;A<=t;){const I=e.x+A*Math.cos(y),E=e.y+A*Math.sin(y),C={x:(I%d+d)%d,y:(E%f+f)%f};if(fh(C,l,s,u)&&!aw(C,void 0,o,u))return C;y+=g,A=v*y}}class U1 extends wn{constructor(t){super(),this.name="Leader Building Placement",this.depth=t}execute(t,i,o){if(!t.leaderId||t.leaderId!==t.id)return[T.FAILURE,"Not a tribe leader"];const s=Hn(t,i.gameState).filter(H=>H.isAdult);if(s.length<xm)return[T.FAILURE,`Tribe too small: ${s.length}/${xm} adults`];const u=Ea(t.leaderId,i.gameState),d=hh(t,i.gameState),f=aS(t.leaderId,i.gameState),g=lS(t.leaderId,i.gameState),m=Math.ceil(s.length*(1+gE)),v=u.length===0,y=u.length<Wm&&(v||f>$m||f*(m/s.length)>$m),A=g*(s.length/m),I=d.length<Ym&&(g<zm||A<zm);let E=null,C="";if(y&&I?v?(E=Tn.StorageSpot,C="Bootstrap: First storage spot for tribe"):f>.85?(E=Tn.StorageSpot,C=`High storage utilization: ${(f*100).toFixed(0)}% (projected: ${m} adults)`):(E=Tn.PlantingZone,C=`Low bush density: ${g.toFixed(1)} bushes/member (projected: ${A.toFixed(1)})`):y?v?(E=Tn.StorageSpot,C="Bootstrap: First storage spot for tribe"):(E=Tn.StorageSpot,C=`Storage utilization: ${(f*100).toFixed(0)}% (projected: ${m} adults)`):I&&(E=Tn.PlantingZone,C=`Bush density: ${g.toFixed(1)} bushes/member (projected: ${A.toFixed(1)} for ${m} adults)`),!E)return[T.FAILURE,`No building needed. Storage: ${u.length}/${Wm} (${(f*100).toFixed(0)}%), Planting: ${d.length}/${Ym} (${g.toFixed(1)} bushes/member)`];const F=v?mE:pE,L=zr(t.leaderId,i.gameState),D=L1(L,Gm,hE,F,E,t.id,i.gameState);return D?(sS(D,E,t.id,i.gameState),[T.SUCCESS,`Placed ${E} at (${D.x.toFixed(0)}, ${D.y.toFixed(0)}). Reason: ${C}`]):[T.FAILURE,`No valid location found for ${E} within ${Gm}px of tribe center`]}}function B1(e){return new U1(e)}const zi="takeOverBuildingTarget";function H1(e){const t=new he([new Q((i,o,l)=>{if(!i.leaderId||i.leaderId!==i.id)return[!1,"Not a tribe leader"];const s=w.get(l,zi);if(s){const d=o.gameState.entities.entities[s];if(d&&d.type==="building"&&Fn(i,d,o.gameState))return[!0,`Continuing to target building ${s}`];w.delete(l,zi)}const u=Ne(i,o.gameState,"building",Rv,d=>Fn(i,d,o.gameState)&&d.isConstructed);return u?(w.set(l,zi,u.id),[!0,`Found enemy building at distance ${Y(i.position,u.position,o.gameState.mapDimensions.width,o.gameState.mapDimensions.height).toFixed(0)}px`]):[!1,"No enemy buildings found within range"]},"Find Enemy Building to Take Over",e+2),new oe((i,o,l)=>{const s=w.get(l,zi);if(!s)return T.FAILURE;const u=o.gameState.entities.entities[s];return!u||u.type!=="building"||!Fn(i,u,o.gameState)?(w.delete(l,zi),i.activeAction="idle",i.target=void 0,T.FAILURE):Y(i.position,u.position,o.gameState.mapDimensions.width,o.gameState.mapDimensions.height)<mt?(i.activeAction="idle",i.target=void 0,T.SUCCESS):(i.activeAction="moving",i.target=u.id,T.RUNNING)},"Move to Enemy Building",e+2),new oe((i,o,l)=>{const s=w.get(l,zi);if(!s)return T.FAILURE;const u=o.gameState.entities.entities[s];return!u||u.type!=="building"||!Fn(i,u,o.gameState)?(w.delete(l,zi),T.FAILURE):(i.activeAction="takingOverBuilding",i.target=u.id,w.delete(l,zi),T.SUCCESS)},"Initiate Building Takeover",e+2)],"Take Over Building Action",e+1);return new Ti(Cv,t,"Take Over Building Cooldown",e)}const Wi="removeEnemyBuildingTarget";function b1(e){const t=new he([new Q((i,o,l)=>{if(!i.leaderId||i.leaderId!==i.id)return[!1,"Not a tribe leader"];const s=w.get(l,Wi);if(s){const d=o.gameState.entities.entities[s];if(d&&d.type==="building"&&Fn(i,d,o.gameState))return[!0,`Continuing to target building ${s}`];w.delete(l,Wi)}const u=Ne(i,o.gameState,"building",Rv,d=>Fn(i,d,o.gameState)&&d.isConstructed);return u?(w.set(l,Wi,u.id),[!0,`Found enemy building at distance ${Y(i.position,u.position,o.gameState.mapDimensions.width,o.gameState.mapDimensions.height).toFixed(0)}px`]):[!1,"No enemy buildings found within range"]},"Find Enemy Building to Destroy",e+2),new oe((i,o,l)=>{const s=w.get(l,Wi);if(!s)return T.FAILURE;const u=o.gameState.entities.entities[s];return!u||u.type!=="building"||!Fn(i,u,o.gameState)?(w.delete(l,Wi),i.activeAction="idle",i.target=void 0,T.FAILURE):Y(i.position,u.position,o.gameState.mapDimensions.width,o.gameState.mapDimensions.height)<mt?(i.activeAction="idle",i.target=void 0,T.SUCCESS):(i.activeAction="moving",i.target=u.id,T.RUNNING)},"Move to Enemy Building",e+2),new oe((i,o,l)=>{const s=w.get(l,Wi);if(!s)return T.FAILURE;const u=o.gameState.entities.entities[s];return!u||u.type!=="building"||!Fn(i,u,o.gameState)?(w.delete(l,Wi),T.FAILURE):(i.activeAction="destroyingBuilding",i.target=u.id,w.delete(l,Wi),T.SUCCESS)},"Initiate Building Destruction",e+2)],"Remove Enemy Building Action",e+1);return new Ti(Cv,t,"Remove Enemy Building Cooldown",e)}function G1(e){const t=new Q((m,v)=>{if(!m.isAdult||m.gender!=="male")return!1;const y=m.partnerIds&&m.partnerIds.length>0,A=Ut(v.gameState,m).length>0;return y||A},"Is Adult Male With Family?",e+1),i=new Q((m,v)=>{var E;const y=vt(v.gameState);if(y){const C=yi(Ut(v.gameState,y));if((C==null?void 0:C.id)===m.id)return!1}if(!m.fatherId)return!1;const A=v.gameState.entities.entities[m.fatherId];return!A||((E=yi(Ut(v.gameState,A)))==null?void 0:E.id)===m.id?!1:Y(m.position,A.position,v.gameState.mapDimensions.width,v.gameState.mapDimensions.height)<kI},"Is Too Close To Father?",e+1),o=new Q((m,v,y)=>w.get(y,"territoryMoveTarget")!==void 0,"Is Moving To Territory?",e+3),l=new oe((m,v,y)=>{const A=w.get(y,"territoryMoveTarget"),I=w.get(y,"territoryMoveStartTime");if(!A||!I)return[T.FAILURE,"Missing move data"];if(v.gameState.time-I>OI)return w.delete(y,"territoryMoveTarget"),w.delete(y,"territoryMoveStartTime"),[T.FAILURE,"Territory move timed out"];if(Y(m.position,A,v.gameState.mapDimensions.width,v.gameState.mapDimensions.height)<$r)return w.delete(y,"territoryMoveTarget"),w.delete(y,"territoryMoveStartTime"),[T.SUCCESS,"Arrived at new territory"];m.activeAction="moving",m.target=A;const F=ze(m.position,m.target,v.gameState.mapDimensions.width,v.gameState.mapDimensions.height);return m.direction=nt(F),[T.RUNNING,"Continuing move to territory"]},"Check Timeout & Arrival",e+3),s=new he([o,l],"Handle In-Progress Move",e+2),u=new Q((m,v,y)=>w.get(y,"territoryMoveTarget")===void 0,"Should Start New Move?",e+4),d=new oe((m,v,y)=>{const A=th(m.position,v.gameState.mapDimensions.width/4,v.gameState.mapDimensions.width,v.gameState.mapDimensions.height);w.set(y,"territoryMoveTarget",A),w.set(y,"territoryMoveStartTime",v.gameState.time),m.activeAction="moving",m.target=A;const I=ze(m.position,m.target,v.gameState.mapDimensions.width,v.gameState.mapDimensions.height);return m.direction=nt(I),[T.RUNNING,"Started moving to new territory"]},"Start New Territory Move",e+4),f=new he([u,d],"Start New Territory Move Action",e+3),g=new Wt([s,new Ti(LI,f,"Establish Territory Cooldown",e+2)],"Establish or Continue Move",e+1);return new he([t,i,g],"Establish Family Territory",e)}function x1(e){return new he([new oe((t,i,o)=>{const l=ZE(t,i.gameState);return l?(w.set(o,"patriarchTarget",l.id),[T.SUCCESS,`Found patriarch: ${l.id}`]):(w.delete(o,"patriarchTarget"),[T.FAILURE,"No patriarch found"])},"Find Patriarch",e+1),new oe((t,i,o)=>{const l=w.get(o,"patriarchTarget"),s=l&&i.gameState.entities.entities[l];if(!s)return[T.FAILURE,"Patriarch target missing from blackboard"];const u=Y(t.position,s.position,i.gameState.mapDimensions.width,i.gameState.mapDimensions.height);if(u>Iv){t.activeAction="moving",t.target=s.id;const d=ze(t.position,s.position,i.gameState.mapDimensions.width,i.gameState.mapDimensions.height);return t.direction=nt(d),[T.RUNNING,`Moving to patriarch at ${u.toFixed(0)}`]}return t.activeAction="idle",t.target=void 0,t.direction={x:0,y:0},[T.SUCCESS,`Arrived at patriarch at ${u.toFixed(0)}`]},"Move Towards Patriarch",e+1)],"Follow Patriarch",e)}const Xl="tribeSplitMigrationTarget";function $1(e){const t=new he([new Q((i,o,l)=>{if(w.get(l,Xl))return[!0,"Already migrating"];const{canSplit:u,progress:d}=uh(i,o.gameState);return u?[!0,`Progress: ${(d??0)*100}%`]:[!1,"Cannot split"]},"Can Split Tribe?",e+2),new oe((i,o,l)=>{const{gameState:s}=o;let u=w.get(l,Xl);if(!u){if(!i.leaderId)return T.FAILURE;const f=s.entities.entities[i.leaderId];if(!f)return T.FAILURE;const g=H_(f.position,i,s);if(g)w.set(l,Xl,g),u=g;else return T.FAILURE}return Y(i.position,u,s.mapDimensions.width,s.mapDimensions.height)<$r?(w.delete(l,Xl),i.activeAction="idle",i.target=void 0,T.SUCCESS):(i.activeAction="moving",i.target=u,T.RUNNING)},"Move to New Territory",e+2),new oe((i,o)=>(ch(i,o.gameState),T.SUCCESS),"Perform Tribe Split",e+2)],"Tribe Split Action",e+1);return new Ti(v_,t,"Tribe Split Cooldown",e)}const Kl="jealousyAttackTarget";function z1(e){return new he([new Q((t,i,o)=>{if(!t.isAdult)return[!1,"Not an adult"];const l=JE(t,i.gameState,XI);return l?t.leaderId&&l.id===t.leaderId?[!1,"Stranger is in same tribe - no attack"]:(w.set(o,Kl,l.id),[!0,`Partner cheating with ${l.id}`]):(w.delete(o,Kl),!1)},"Check for Infidelity",e+1),new oe((t,i,o)=>{const l=w.get(o,Kl),s=l&&i.gameState.entities.entities[l];return!s||s.hitpoints<=0?(w.delete(o,Kl),[T.FAILURE,"Target is invalid or dead"]):t.activeAction==="attacking"&&t.attackTargetId===s.id?T.RUNNING:(t.activeAction="attacking",t.attackTargetId=s.id,[T.RUNNING,`Attacking ${s.id}`])},"Execute Jealousy Attack",e+1)],"Jealousy Attack",e)}const Zl="defendAggressor";function W1(e){return new he([new Q((t,i,o)=>{if(!t.isAdult)return[!1,"Not an adult"];const l=ew(t,i.gameState,KI);return l?(w.set(o,Zl,l.aggressor.id),[!0,`Family member ${l.familyMember.id} attacked by ${l.aggressor.id}`]):(w.delete(o,Zl),!1)},"Check Family Under Attack",e+1),new oe((t,i,o)=>{const l=w.get(o,Zl),s=l&&i.gameState.entities.entities[l];return!s||s.hitpoints<=0?(w.delete(o,Zl),[T.FAILURE,"Target invalid/dead"]):t.activeAction==="attacking"&&t.attackTargetId===s.id?T.RUNNING:(t.activeAction="attacking",t.attackTargetId=s.id,[T.RUNNING,`Attacking aggressor ${s.id}`])},"Execute Family Defense Attack",e+1)],"Defend Family",e)}const ql="desperateAttackTarget";function Y1(e){return new he([new Q(t=>t.hunger>ZI,"Is Starving",e+1),new Q((t,i)=>{if(!t.isAdult)return[!1,"Not an adult"];const o=Ne(t,i.gameState,"berryBush",mt,s=>s.food.length>0),l=Ne(t,i.gameState,"corpse",mt,s=>s.food.length>0);return!o&&!l},"No Other Food Available",e+1),new Q((t,i,o)=>{const l=tw(t,i.gameState);return l?(w.set(o,ql,l.id),[!0,`Found weak target ${l.id}`]):(w.delete(o,ql),!1)},"Find Weak Target",e+1),new oe((t,i,o)=>{const l=w.get(o,ql),s=l&&i.gameState.entities.entities[l];return!s||s.hitpoints<=0?(w.delete(o,ql),[T.FAILURE,"Target is invalid or dead"]):t.activeAction==="attacking"&&t.attackTargetId===s.id?T.RUNNING:(t.activeAction="attacking",t.attackTargetId=s.id,[T.RUNNING,`Desperately attacking ${s.id}`])},"Execute Desperate Attack",e+1)],"Desperate Attack",e)}function j1(e,t,i,o){const l=e.entities.entities[i.targetEntityId];return!l||!("hitpoints"in l)||l.hitpoints<=0?(e.autopilotControls.activeAutopilotAction=void 0,T.FAILURE):Y(t.position,l.position,e.mapDimensions.width,e.mapDimensions.height)<=cu?(t.activeAction="attacking",t.attackTargetId=l.id,e.autopilotControls.activeAutopilotAction=void 0,T.SUCCESS):(t.activeAction="moving",t.target=l.id,t.direction=Ft(t.position,l.position,e.mapDimensions),T.RUNNING)}function V1(e){return new he([new Q((t,i)=>t.isPlayer===!0&&!!i.gameState.autopilotControls.activeAutopilotAction,"Has Player Command",e+1),new oe((t,i)=>{var s;const{gameState:o}=i,l=o.autopilotControls.activeAutopilotAction;if(!l)return T.FAILURE;switch(l.action){case ae.AutopilotMove:{const u=l.position;return Y(t.position,u,o.mapDimensions.width,o.mapDimensions.height)<tE?(o.autopilotControls.activeAutopilotAction=void 0,t.activeAction==="moving"&&(t.activeAction="idle",t.target=void 0),T.SUCCESS):(t.activeAction="moving",t.target=u,t.direction=Ft(t.position,u,o.mapDimensions),T.RUNNING)}case ae.AutopilotGather:{const u=o.entities.entities[l.targetEntityId];return!u||u.food.length===0?(o.autopilotControls.activeAutopilotAction=void 0,T.FAILURE):Y(t.position,u.position,o.mapDimensions.width,o.mapDimensions.height)>$r?(t.activeAction="moving",t.target=u.id,t.direction=Ft(t.position,u.position,o.mapDimensions),T.RUNNING):(t.activeAction="gathering",t.target=u.id,o.autopilotControls.activeAutopilotAction=void 0,T.SUCCESS)}case ae.AutopilotAttack:return j1(o,t,l);case ae.AutopilotProcreate:{const u=o.entities.entities[l.targetEntityId];return!u||u.type!=="human"||!Wr(t,u,i.gameState)?(o.autopilotControls.activeAutopilotAction=void 0,T.FAILURE):Y(t.position,u.position,o.mapDimensions.width,o.mapDimensions.height)<=cu?(t.activeAction="procreating",o.autopilotControls.activeAutopilotAction=void 0,T.SUCCESS):(t.activeAction="moving",t.target=u.id,t.direction=Ft(t.position,u.position,o.mapDimensions),T.RUNNING)}case ae.AutopilotPlant:{if(t.activeAction==="planting")return T.RUNNING;const u=l.position;return bn(u,o,br,t.id)?(o.autopilotControls.activeAutopilotAction=void 0,T.FAILURE):Y(t.position,u,o.mapDimensions.width,o.mapDimensions.height)<=cu?(t.activeAction="planting",t.target=u,o.autopilotControls.activeAutopilotAction=void 0,o.hasPlayerPlantedBush=!0,T.RUNNING):(t.activeAction="moving",t.target=u,t.direction=Ft(t.position,u,o.mapDimensions),T.RUNNING)}case ae.AutopilotFeedChild:{const u=o.entities.entities[l.targetEntityId];return!u||u.type!=="human"||u.isAdult||t.food.length===0?(o.autopilotControls.activeAutopilotAction=void 0,T.FAILURE):Y(t.position,u.position,o.mapDimensions.width,o.mapDimensions.height)<=cu?(o.autopilotControls.activeAutopilotAction=void 0,t.activeAction="feeding",T.SUCCESS):(t.activeAction="moving",t.target=u.id,t.direction=Ft(t.position,u.position,o.mapDimensions),T.RUNNING)}case ae.AutopilotDeposit:{const u=o.entities.entities[l.targetEntityId];if(!u||u.buildingType!=="storageSpot"||!u.isConstructed)return o.autopilotControls.activeAutopilotAction=void 0,T.FAILURE;const d=u.storageCapacity??0;return(((s=u.storedFood)==null?void 0:s.length)??0)>=d||t.leaderId!==u.ownerId||t.food.length===0?(o.autopilotControls.activeAutopilotAction=void 0,T.FAILURE):Y(t.position,u.position,o.mapDimensions.width,o.mapDimensions.height)<=In?(t.activeAction="depositing",t.target=void 0,o.autopilotControls.activeAutopilotAction=void 0,T.SUCCESS):(t.activeAction="moving",t.target=u.id,t.direction=Ft(t.position,u.position,o.mapDimensions),T.RUNNING)}case ae.AutopilotRetrieve:{const u=o.entities.entities[l.targetEntityId];return!u||u.buildingType!=="storageSpot"||!u.isConstructed||!u.storedFood||u.storedFood.length===0||t.leaderId!==u.ownerId||t.food.length>=t.maxFood?(o.autopilotControls.activeAutopilotAction=void 0,T.FAILURE):Y(t.position,u.position,o.mapDimensions.width,o.mapDimensions.height)<=In?(t.activeAction="retrieving",t.target=void 0,o.autopilotControls.activeAutopilotAction=void 0,T.SUCCESS):(t.activeAction="moving",t.target=u.id,t.direction=Ft(t.position,u.position,o.mapDimensions),T.RUNNING)}case ae.AutopilotFollowMe:{const u=o.entities.entities[l.targetEntityId];return!u||u.type!=="human"||u.id!==u.leaderId?(o.autopilotControls.activeAutopilotAction=void 0,T.FAILURE):Y(t.position,u.position,o.mapDimensions.width,o.mapDimensions.height)<=Iv?(o.autopilotControls.activeAutopilotAction=void 0,t.activeAction==="moving"&&(t.activeAction="idle"),T.SUCCESS):(t.activeAction="moving",t.target=u.id,t.direction=Ft(t.position,u.position,o.mapDimensions),T.RUNNING)}default:return o.autopilotControls.activeAutopilotAction=void 0,T.FAILURE}},"Execute Player Command",e+1)],"Player Command Handler",e)}function X1(e){return new he([new Q(t=>!!t.leaderId&&t.leaderId!==t.id,"Is Follower",e+1),new Q((t,i)=>{if(!t.leaderId)return!1;const o=i.gameState.entities.entities[t.leaderId];return!!o&&o.isCallingToFollow===!0},"Is Leader Calling To Follow",e+1),new Q(t=>t.hunger<_I,"Is Not Critically Hungry",e+1),new oe((t,i)=>{if(!t.leaderId)return T.FAILURE;const o=i.gameState.entities.entities[t.leaderId];return o?Y(t.position,o.position,i.gameState.mapDimensions.width,i.gameState.mapDimensions.height)>wI?(t.activeAction="moving",t.target=o.id,t.direction=Ft(t.position,o.position,i.gameState.mapDimensions),T.RUNNING):(t.activeAction==="moving"&&t.target===o.id&&(t.activeAction="idle",t.target=void 0),T.SUCCESS):T.FAILURE},"Execute Follow Leader",e+1)],"Follow Leader Command",e)}const C0="tribeMigrationCheckCooldown";function K1(e){const t=new he([new Q(o=>!!o.leaderId&&o.leaderId===o.id,"Is Tribe Leader",e+2),new Q((o,l)=>{const s=w.get(o.aiBlackboard,C0);return s?l.gameState.time-s>=Bm:!0},"Is Migration Check Cooldown Over",e+2),new oe((o,l)=>{o.aiBlackboard&&w.set(o.aiBlackboard,C0,l.gameState.time);const s=iw(o,l.gameState);return s?(o.isCallingToFollow=!0,o.callToFollowEndTime=l.gameState.time+ha,o.target=s,o.activeAction="moving",T.SUCCESS):T.FAILURE},"Execute Tribe Migration",e+2)],"Tribe Migration Strategy",e+1),i=new qi(t,Xs,"Cache Tribe Migration",e+1);return new Ti(Bm,i,"Tribe Migration Cooldown",e)}function Z1(e){const t=new Q(o=>o.id===o.leaderId,"Is Leader?",e+1),i=new oe((o,l)=>{var g;const{gameState:s}=l,u=fa(o.id,s),d=Su(u),f=Uv(s).filter(m=>m.leaderId!==o.id);for(const m of f){const v=fa(m.leaderId,s),y=Su(v),A=((g=o.diplomacy)==null?void 0:g[m.leaderId])||pt.Friendly;d>y*YI?A!==pt.Hostile&&o.diplomacy&&(o.diplomacy[m.leaderId]=pt.Hostile):A!==pt.Friendly&&o.diplomacy&&(o.diplomacy[m.leaderId]=pt.Friendly)}return T.SUCCESS},"Evaluate Diplomacy",e+2);return new he([t,new Ti(bI,i,"Diplomacy Cooldown",e+1)],"Manage Diplomacy",e)}const $s="huntTarget";function q1(e){return new he([new qi(new Q((i,o,l)=>{if(!i.isAdult)return[!1,"Not an adult"];if(!i.leaderId)return[!1,"Not in a tribe"];const s=Ne(i.position,o.gameState,"prey",II,()=>!0);return s?(w.set(l,$s,s.id),[!0,"Found prey"]):[!1,"No suitable prey found"]},"Find Prey Target",e+2),HI,"Cache Find Prey",e+1),new ar(new Au(new oe((i,o,l)=>{if(!i.leaderId)return T.FAILURE;const s=w.get(l,$s);if(!s)return T.FAILURE;const u=o.gameState.entities.entities[s];if(!u||u.hitpoints<=0)return w.delete(l,$s),i.activeAction="idle",i.attackTargetId=void 0,T.SUCCESS;const{gameState:d}=o,f=zr(i.leaderId,d);return Y(i.position,f,d.mapDimensions.width,d.mapDimensions.height)>EI?(w.delete(l,$s),i.activeAction="idle",i.attackTargetId=void 0,T.FAILURE):(i.activeAction="attacking",i.attackTargetId=u.id,T.RUNNING)},"Hunt Prey Action",e+3),_f,"Hunt Prey Timeout",e+2),{taskType:"hunt",maxCapacity:mh,getTargetId:(i,o,l)=>w.get(l,$s)??null},"Tribal Hunt Task",e+1)],"Human Hunt Prey Sequence",e)}const Ql="defendTarget",nf=150;function Q1(e){return new he([new Q((t,i,o)=>{if(!t.isAdult)return[!1,"Not an adult - children flee instead"];if(t.hitpoints<=t.maxHitpoints*.3)return[!1,"Too injured to defend"];const{gameState:l}=i;if(t.activeAction==="attacking"&&t.attackTargetId){const u=l.entities.entities[t.attackTargetId];if(u&&u.type==="predator"&&u.hitpoints>0&&Y(t.position,u.position,l.mapDimensions.width,l.mapDimensions.height)<=nf)return w.set(o,Ql,u.id),[!0,"Continuing defense"]}const s=Ne(t,l,"predator",nf,u=>u.hitpoints>0&&(u.isAdult||!1));if(s){const u=Y(t.position,s.position,l.mapDimensions.width,l.mapDimensions.height),d=s.attackTargetId===t.id,f=u<80;if(d||f)return w.set(o,Ql,s.id),[!0,"Predator threat detected"]}return w.set(o,Ql,void 0),[!1,"No predator threat"]},"Detect Predator Threat",e+1),new oe((t,i,o)=>{const l=w.get(o,Ql),s=l&&i.gameState.entities.entities[l];if(!s)return T.FAILURE;const{gameState:u}=i,d=Y(t.position,s.position,u.mapDimensions.width,u.mapDimensions.height);return t.hitpoints<t.maxHitpoints*.3?T.FAILURE:s.hitpoints<=0||d>nf*1.5?(t.activeAction="idle",t.attackTargetId=void 0,T.SUCCESS):(t.activeAction="attacking",t.attackTargetId=s.id,T.RUNNING)},"Defend Against Predator",e+1)],"Human Defend Against Predator",e)}function J1(e){return new he([new Q((t,i,o)=>{const l=Ne(t,i.gameState,"predator",zt*2,()=>!0),s=Ne(t,i.gameState,"human",zt*2,()=>!0);let u=null,d=1/0;if(l){const f=Y(t.position,l.position,i.gameState.mapDimensions.width,i.gameState.mapDimensions.height);f<d&&(d=f,u=l)}if(s){const f=Y(t.position,s.position,i.gameState.mapDimensions.width,i.gameState.mapDimensions.height);f<d&&(d=f,u=s)}return u&&d<zt*1.5?(w.set(o,"fleeThreat",u.id),w.set(o,"fleeDistance",d),!0):!1},"Detect Threat",e+1),new oe((t,i,o)=>{const l=w.get(o,"fleeThreat"),s=l&&i.gameState.entities.entities[l];if(!s)return T.FAILURE;t.activeAction="moving";const u=ze(s.position,t.position,i.gameState.mapDimensions.width,i.gameState.mapDimensions.height),d=nt(u),f=Un(t.position,Pt(d,OC));return t.target={x:(f.x%i.gameState.mapDimensions.width+i.gameState.mapDimensions.width)%i.gameState.mapDimensions.width,y:(f.y%i.gameState.mapDimensions.height+i.gameState.mapDimensions.height)%i.gameState.mapDimensions.height},t.direction=d,t.fleeCooldown=i.gameState.time+2,T.RUNNING},"Execute Flee",e+1)],"Prey Flee",e)}function eR(e){return new he([new Q((t,i,o)=>{if(!t.isAdult)return[!1,"Not an adult"];if(t.hunger<=30||t.eatingCooldownTime&&t.eatingCooldownTime>i.gameState.time)return!1;const l=Ne(t,i.gameState,"berryBush",zt*10,s=>s.food.length>0);return l?Y(t.position,l.position,i.gameState.mapDimensions.width,i.gameState.mapDimensions.height)<=zt?(w.set(o,"grazingTarget",l.id),!0):(w.set(o,"grazingTarget",l.id),w.set(o,"needToMoveToTarget",!0),!0):!1},"Find Berry Bush",e+1),new oe((t,i,o)=>{const l=w.get(o,"grazingTarget"),s=l&&i.gameState.entities.entities[l],u=w.get(o,"needToMoveToTarget");if(!s)return T.FAILURE;const d=Y(t.position,s.position,i.gameState.mapDimensions.width,i.gameState.mapDimensions.height);if(d<=zt)return t.activeAction="grazing",t.target=s.id,t.direction={x:0,y:0},w.delete(o,"needToMoveToTarget"),T.RUNNING;if(u||d>zt){t.activeAction="moving",t.target=s.id;const f=Ft(t.position,s.position,i.gameState.mapDimensions);return t.direction=f,T.RUNNING}return T.FAILURE},"Move to Bush or Graze",e+1)],"Prey Graze",e)}function tR(e){const t=new Q((s,u,d)=>{const f=Ne(s,u.gameState,"prey",zt,g=>g.id!==s.id&&g.gender!==s.gender&&!!g.isAdult&&g.age>=ra&&g.age<=Xd&&!g.isPregnant&&(!g.procreationCooldown||g.procreationCooldown<=0)&&g.hunger<200);return f?(w.set(d,"procreationPartner",f.id),!0):!1},"Find Immediate Partner",e+2),i=new oe((s,u,d)=>{const f=w.get(d,"procreationPartner"),g=f&&u.gameState.entities.entities[f];return g?(s.activeAction="procreating",s.target=g.id,s.direction={x:0,y:0},w.delete(d,"procreationPartner"),T.SUCCESS):T.FAILURE},"Start Procreating",e+2),o=new Q((s,u,d)=>{const f=Ne(s,u.gameState,"prey",zt*10,g=>g.id!==s.id&&g.gender!==s.gender&&!!g.isAdult&&g.age>=ra&&g.age<=Xd&&!g.isPregnant&&(!g.procreationCooldown||g.procreationCooldown<=0)&&g.hunger<200);return f?(w.set(d,"procreationPartner",f.id),!0):!1},"Locate Distant Partner",e+2),l=new oe((s,u,d)=>{const f=w.get(d,"procreationPartner"),g=f&&u.gameState.entities.entities[f];if(!g)return T.FAILURE;if(Y(s.position,g.position,u.gameState.mapDimensions.width,u.gameState.mapDimensions.height)<=zt)return T.SUCCESS;s.activeAction="moving",s.target=g.id;const v=ze(s.position,g.position,u.gameState.mapDimensions.width,u.gameState.mapDimensions.height);return s.direction=nt(v),T.RUNNING},"Move Towards Partner",e+2);return new he([new Q(s=>!!(s.isAdult&&!s.isPregnant&&s.age>=ra&&s.age<=Xd&&s.hunger<200&&(!s.procreationCooldown||s.procreationCooldown<=0)),"Is Fertile and Ready",e+1),new Wt([new he([t,i],"Procreate With Immediate Partner",e+2),new he([o,l],"Seek Distant Partner",e+2)],"Find Partner And Procreate",e+1)],"Prey Procreate",e)}const nR=(e,t,i)=>{const o=t.gameState.search.prey.byProperty("motherId",e.id).filter(u=>!u.isAdult&&u.type==="prey");if(o.length===0)return T.FAILURE;let l=null,s=Lu;for(const u of o)u.hunger>=s&&(s=u.hunger,l=u);return l?(w.set(i,"targetChild",l.id),T.SUCCESS):T.FAILURE},iR=(e,t,i)=>{const o=w.get(i,"targetChild"),l=o&&t.gameState.entities.entities[o];return l?Y(e.position,l.position,t.gameState.mapDimensions.width,t.gameState.mapDimensions.height)>Ko?(e.activeAction="moving",e.target=l.id,e.direction=Ft(e.position,l.position,t.gameState.mapDimensions),T.RUNNING):(e.activeAction="feeding",e.target=void 0,w.set(i,"targetChild",void 0),T.SUCCESS):T.FAILURE};function rR(e){return new he([new Q(t=>(t.isAdult&&t.gender==="female"&&t.hunger<80&&(!t.feedChildCooldownTime||t.feedChildCooldownTime<=0))??!1,"Can Feed Child (Female Only)",e+1),new oe(nR,"Find Hungriest Prey Child",e+1),new oe(iR,"Move To Child and Feed",e+1)],"Feed Prey Child",e)}function oR(e){return new he([new Q(t=>!t.isAdult&&t.hunger>=Lu,"Is Hungry Prey Child",e+1),new oe((t,i,o)=>{if(!t.motherId)return T.FAILURE;const l=i.gameState.entities.entities[t.motherId];return l?(w.set(o,"targetParent",l.id),T.SUCCESS):T.FAILURE},"Find Female Parent",e+1),new oe((t,i,o)=>{const l=w.get(o,"targetParent"),s=l&&i.gameState.entities.entities[l];if(!s)return T.FAILURE;const u=Y(t.position,s.position,i.gameState.mapDimensions.width,i.gameState.mapDimensions.height);return t.activeAction="idle",u<=Ko?(t.target=void 0,T.SUCCESS):(t.target=s.id,t.activeAction="moving",T.RUNNING)},"Move To Female Parent",e+1)],"Seek Food From Female Parent",e)}const zs="huntTarget";function sR(e,t,i){if(!(e!=null&&e.aiBlackboard))return!0;const o=`tribal_hunt_${t}`,l=w.get(e.aiBlackboard,o);return!l||i-l.startTime>$o?!0:l.memberIds.length<(l.maxCapacity||mh)}function aR(e,t){if(!(e!=null&&e.aiBlackboard))return 0;const i=`tribal_hunt_${t}`,o=w.get(e.aiBlackboard,i);return(o==null?void 0:o.memberIds.length)??0}function lR(e){return new he([new Q((t,i,o)=>{if(!t.isAdult)return[!1,"Not an adult"];if(t.hunger<=50||t.huntCooldown&&t.huntCooldown>0)return!1;const l=Ne(t,i.gameState,"prey",_o*10,s=>{if(s.hitpoints<=0)return!1;const u=ya(t,i.gameState);return!(u&&!sR(u,s.id,i.gameState.time))});if(l){const s=Y(t.position,l.position,i.gameState.mapDimensions.width,i.gameState.mapDimensions.height),u=ya(t,i.gameState),d=u?aR(u,l.id):0;if(s<=_o)return w.set(o,zs,l.id),[!0,`Prey in range (${d} hunters)`];if(s<=_o*10)return w.set(o,zs,l.id),w.set(o,"needToApproach",!0),[!0,`Approaching prey (${d} hunters)`]}return!1},"Find Prey Target",e+1),new ar(new Au(new oe((t,i,o)=>{const l=w.get(o,zs),s=l&&i.gameState.entities.entities[l],u=w.get(o,"needToApproach");if(!s||s.hitpoints<=0)return w.delete(o,zs),w.delete(o,"needToApproach"),T.SUCCESS;const d=Y(t.position,s.position,i.gameState.mapDimensions.width,i.gameState.mapDimensions.height);if(d<=_o)return t.activeAction="attacking",t.attackTargetId=s.id,t.target=s.id,t.direction={x:0,y:0},w.delete(o,"needToApproach"),T.RUNNING;if(u||d>_o){t.activeAction="moving",t.target=s.id;const f=ze(t.position,s.position,i.gameState.mapDimensions.width,i.gameState.mapDimensions.height);return t.direction=nt(f),T.RUNNING}return T.FAILURE},"Hunt or Approach Prey",e+3),10,"Hunt Timeout (10 hour)",e+2),{taskType:"hunt",maxCapacity:mh,getTargetId:(t,i,o)=>w.get(o,zs)},"Tribal Hunt Decorator",e+1)],"Predator Hunt",e)}function uR(e){return new he([new Q((t,i,o)=>{const l=t.hunger>100,s=t.hitpoints<t.maxHitpoints*.5;if(!l&&!s||t.attackCooldown&&t.attackCooldown>0)return!1;const u=Ne(t,i.gameState,"human",kn*2,d=>d.hitpoints>0);if(u){const d=Y(t.position,u.position,i.gameState.mapDimensions.width,i.gameState.mapDimensions.height);if(d<=kn)return w.set(o,"attackTarget",u.id),!0;if(l&&d<=kn*2)return w.set(o,"attackTarget",u.id),w.set(o,"needToApproach",!0),!0}return!1},"Find Human Target",e+1),new oe((t,i,o)=>{const l=w.get(o,"attackTarget"),s=l&&i.gameState.entities.entities[l],u=w.get(o,"needToApproach");if(!s||s.hitpoints<=0)return T.FAILURE;const d=Y(t.position,s.position,i.gameState.mapDimensions.width,i.gameState.mapDimensions.height);if(d<=kn)return t.activeAction="attacking",t.attackTargetId=s.id,t.target=s.id,t.direction={x:0,y:0},w.delete(o,"needToApproach"),T.RUNNING;if(u||d>kn){t.activeAction="moving",t.target=s.id;const f=ze(t.position,s.position,i.gameState.mapDimensions.width,i.gameState.mapDimensions.height);return t.direction=nt(f),T.RUNNING}return T.FAILURE},"Attack or Approach Human",e+1)],"Predator Attack Human",e)}function cR(e){const t=new Q((s,u,d)=>{const f=Ne(s,u.gameState,"predator",ir,g=>g.id!==s.id&&g.gender!==s.gender&&!!g.isAdult&&g.age>=oa&&g.age<=Kd&&!g.isPregnant&&(!g.procreationCooldown||g.procreationCooldown<=0)&&g.hunger<200);return f?(w.set(d,"procreationPartner",f.id),!0):!1},"Find Immediate Partner",e+2),i=new oe((s,u,d)=>{const f=w.get(d,"procreationPartner"),g=f&&u.gameState.entities.entities[f];return g?(s.activeAction="procreating",s.target=g.id,s.direction={x:0,y:0},w.delete(d,"procreationPartner"),T.SUCCESS):T.FAILURE},"Start Procreating",e+2),o=new Q((s,u,d)=>{const f=Ne(s,u.gameState,"predator",ir*10,g=>g.id!==s.id&&g.gender!==s.gender&&!!g.isAdult&&g.age>=oa&&g.age<=Kd&&!g.isPregnant&&(!g.procreationCooldown||g.procreationCooldown<=0)&&g.hunger<200);return f?(w.set(d,"procreationPartner",f.id),!0):!1},"Locate Distant Partner",e+2),l=new oe((s,u,d)=>{const f=w.get(d,"procreationPartner"),g=f&&u.gameState.entities.entities[f];if(!g)return T.FAILURE;if(Y(s.position,g.position,u.gameState.mapDimensions.width,u.gameState.mapDimensions.height)<=ir)return T.SUCCESS;s.activeAction="moving",s.target=g.id;const v=ze(s.position,g.position,u.gameState.mapDimensions.width,u.gameState.mapDimensions.height);return s.direction=nt(v),T.RUNNING},"Move Towards Partner",e+2);return new he([new Q(s=>!!(s.isAdult&&!s.isPregnant&&s.age>=oa&&s.age<=Kd&&s.hunger<200&&(!s.procreationCooldown||s.procreationCooldown<=0)),"Is Fertile and Ready",e+1),new Wt([new he([t,i],"Procreate With Immediate Partner",e+2),new he([o,l],"Seek Distant Partner",e+2)],"Find Partner And Procreate",e+1)],"Predator Procreate",e)}const dR=(e,t,i)=>{const o=t.gameState.search.predator.byProperty("motherId",e.id).filter(u=>!u.isAdult&&u.type==="predator");if(o.length===0)return T.FAILURE;let l=null,s=Lu;for(const u of o)u.hunger>=s&&(s=u.hunger,l=u);return l?(w.set(i,"targetChild",l.id),T.SUCCESS):T.FAILURE},fR=(e,t,i)=>{const o=w.get(i,"targetChild"),l=o&&t.gameState.entities.entities[o];return l?Y(e.position,l.position,t.gameState.mapDimensions.width,t.gameState.mapDimensions.height)>Ko?(e.activeAction="moving",e.target=l.id,e.direction=Ft(e.position,l.position,t.gameState.mapDimensions),T.RUNNING):(e.activeAction="feeding",e.target=void 0,w.set(i,"targetChild",void 0),T.SUCCESS):T.FAILURE};function hR(e){return new he([new Q(t=>(t.isAdult&&t.gender==="female"&&t.hunger<90&&(!t.feedChildCooldownTime||t.feedChildCooldownTime<=0))??!1,"Can Feed Child (Female Only)",e+1),new oe(dR,"Find Hungriest Predator Child",e+1),new oe(fR,"Move To Child and Feed",e+1)],"Feed Predator Child",e)}function gR(e){return new he([new Q(t=>!t.isAdult&&t.hunger>=Lu,"Is Hungry Predator Child",e+1),new oe((t,i,o)=>{if(!t.motherId)return T.FAILURE;const l=i.gameState.entities.entities[t.motherId];return l?(w.set(o,"targetParent",l.id),T.SUCCESS):T.FAILURE},"Find Female Parent",e+1),new oe((t,i,o)=>{const l=w.get(o,"targetParent"),s=l&&i.gameState.entities.entities[l];if(!s)return T.FAILURE;const u=Y(t.position,s.position,i.gameState.mapDimensions.width,i.gameState.mapDimensions.height);return t.activeAction="idle",u<=Ko?(t.target=void 0,T.SUCCESS):(t.target=s.id,t.activeAction="moving",T.RUNNING)},"Move To Female Parent",e+1)],"Seek Food From Female Parent",e)}function ES(e){return new oe((t,i,o)=>{t.activeAction="idle";let l=w.get(o,"wanderTarget"),s=w.get(o,"wanderStartTime");const u=i.gameState.time;if(!l||!s||u-s>2){const d=Math.random()*2*Math.PI,f=50+Math.random()*100,g={x:Math.cos(d),y:Math.sin(d)},m=Un(t.position,Pt(g,f));l={x:(m.x%i.gameState.mapDimensions.width+i.gameState.mapDimensions.width)%i.gameState.mapDimensions.width,y:(m.y%i.gameState.mapDimensions.height+i.gameState.mapDimensions.height)%i.gameState.mapDimensions.height},w.set(o,"wanderTarget",l),w.set(o,"wanderStartTime",u)}if(l){t.target=l;let d=l.x-t.position.x,f=l.y-t.position.y;const g=i.gameState.mapDimensions.width,m=i.gameState.mapDimensions.height;Math.abs(d)>g/2&&(d=d>0?d-g:d+g),Math.abs(f)>m/2&&(f=f>0?f-m:f+m);const v=nt({x:d,y:f});t.direction=v}return T.SUCCESS},"Animal Wander",e)}function pR(e){return new he([new Q((t,i,o)=>{if(t.hunger>90||t.hitpoints<t.maxHitpoints*.3||t.activeAction==="grazing"||t.activeAction==="procreating")return!1;const l=Object.values(i.gameState.entities.entities),s=[];for(const u of l)if(u.type==="prey"&&u.id!==t.id){const d=u;d.hitpoints>0&&d.isAdult&&Y(t.position,d.position,i.gameState.mapDimensions.width,i.gameState.mapDimensions.height)<=zt*5&&s.push(d)}if(s.length>=2){let u=0,d=0;for(const m of s)u+=m.position.x,d+=m.position.y;u/=s.length,d/=s.length;const f={x:u,y:d};if(Y(t.position,f,i.gameState.mapDimensions.width,i.gameState.mapDimensions.height)>zt*2)return w.set(o,"herdCenter",f),w.set(o,"herdSize",s.length),!0}return!1},"Find Herd",e+1),new oe((t,i,o)=>{const l=w.get(o,"herdCenter");if(!l)return T.FAILURE;if(Y(t.position,l,i.gameState.mapDimensions.width,i.gameState.mapDimensions.height)>zt*2){t.activeAction="moving",t.target=l;const u=ze(t.position,l,i.gameState.mapDimensions.width,i.gameState.mapDimensions.height);return t.direction=nt(u),T.RUNNING}else return t.activeAction="idle",t.direction={x:0,y:0},T.SUCCESS},"Join Herd",e+1)],"Prey Herd Behavior",e)}function mR(e){return new he([new Q((t,i,o)=>{if(t.hunger>100||t.hitpoints<t.maxHitpoints*.4||t.activeAction==="attacking"||t.activeAction==="procreating")return!1;const l=Ne(t,i.gameState,"predator",ir*4,s=>s.id!==t.id&&s.hitpoints>0&&s.isAdult&&t.fatherId!==void 0&&s.fatherId===t.fatherId&&s.age>=t.age||s.hitpoints>t.hitpoints);return l&&Y(t.position,l.position,i.gameState.mapDimensions.width,i.gameState.mapDimensions.height)>ir*2?(w.set(o,"packLeader",l.id),!0):!1},"Find Pack Leader",e+1),new oe((t,i,o)=>{const l=w.get(o,"packLeader"),s=l&&i.gameState.entities.entities[l];if(!s||s.hitpoints<=0)return T.FAILURE;if(Y(t.position,s.position,i.gameState.mapDimensions.width,i.gameState.mapDimensions.height)>ir*2){t.activeAction="moving",t.target=s.id;const d=ze(t.position,s.position,i.gameState.mapDimensions.width,i.gameState.mapDimensions.height);return t.direction=nt(d),T.RUNNING}else return t.activeAction="idle",t.direction={x:0,y:0},T.SUCCESS},"Follow Pack Leader",e+1)],"Predator Pack Behavior",e)}function vR(e){return new he([new Q((t,i,o)=>{if(!t.isAdult||t.hitpoints<t.maxHitpoints*.6||t.hunger>120||t.attackCooldown&&t.attackCooldown>0)return!1;const l=Ne(t,i.gameState,"predator",y0,s=>!!(s.id!==t.id&&s.hitpoints>0&&s.isAdult&&t.fatherId!==s.fatherId&&t.gender===s.gender&&t.fatherId!==void 0&&s.fatherId!==void 0));if(l){const s=Y(t.position,l.position,i.gameState.mapDimensions.width,i.gameState.mapDimensions.height);if(s<=kn)return w.set(o,"territorialTarget",l.id),!0;if(s<=y0)return w.set(o,"territorialTarget",l.id),w.set(o,"needToApproach",!0),!0}return!1},"Find Territorial Rival",e+1),new oe((t,i,o)=>{const l=w.get(o,"territorialTarget"),s=l&&i.gameState.entities.entities[l],u=w.get(o,"needToApproach");if(!s||s.hitpoints<=0)return T.FAILURE;const d=Y(t.position,s.position,i.gameState.mapDimensions.width,i.gameState.mapDimensions.height);if(d<=kn)return t.activeAction="attacking",t.attackTargetId=s.id,t.target=s.id,t.direction={x:0,y:0},w.delete(o,"needToApproach"),T.RUNNING;if(u||d>kn){t.activeAction="moving",t.target=s.id;const f=ze(t.position,s.position,i.gameState.mapDimensions.width,i.gameState.mapDimensions.height);return t.direction=nt(f),T.RUNNING}return T.FAILURE},"Territorial Fight or Approach",e+1)],"Predator Territorial Defense",e)}function SR(){const e=new Wt([g1(2),W1(2),new sn(Q1(2),"attack","Gated Defend Against Predator",2),new sn(z1(2),"attack","Gated Jealousy Attack",2),new sn(Y1(2),"attack","Gated Desperate Attack",2),V1(2),new _r(k1(3),"Gated Leader Combat Strategy",2),new _r(Z1(3),"Gated Diplomacy",2),new _r(new Wt([new qi(H1(5),Xs,"Cache Take Over Building",4),new qi(b1(5),Xs,"Cache Remove Enemy Building",4)],"Building Interaction Selector",3),"Gated Leader Building Interactions",2),new _r(new qi(B1(4),fE,"Cache Building Placement",3),"Gated Leader Building Placement",2),F1(2),new sn(M1(3),"attack","Gated Storage Steal",2),new sn(I1(3),"attack","Gated Attacking",2),h1(2),new sn(O1(3),"gathering","Gated Storage Retrieve",2),new Au(new sn(y1(4),"gathering","Gated Gathering",3),_f,"Timeout Gathering",2),new sn(D1(3),"gathering","Gated Storage Deposit",2),new sn(_1(3),"feedChildren","Gated Feed Child",2),C1(2),new sn(A1(3),"procreation","Gated Procreation",2),new Au(new sn(N1(4),"planting","Gated Planting",3),_f,"Timeout Planting",2),new sn(q1(3),"attack","Gated Hunt Prey",2),new qi($1(3),Xs,"Cache Tribe Split",2),new _r(K1(3),"Gated Tribe Migration",2),new qi(G1(3),Xs,"Cache Establish Territory",2),new sn(X1(3),"followLeader","Gated Follow Leader",2),new _r(x1(2),"Gated Follow Patriarch",2),new _r(T1(2),"Gated Idle Wander",2)],"AI Root Selector",1);return new d1(e,"Manual Control Gate",0)}const wS=SR();function yR(e,t){e.aiBlackboard&&w.cleanupOldEntries(e.aiBlackboard,t.gameState.time);const i=ya(e,t.gameState);i&&i.id===e.id&&i.aiBlackboard&&f1(i,t.gameState.time);const o=performance.now();switch(e.aiType){case _a.BehaviorTreeBased:default:ph(e,t,wS);break}t.gameState.performanceMetrics.currentBucket.aiUpdateTime+=performance.now()-o}function TR(){return new Wt([J1(1),rR(1),oR(1),eR(1),tR(1),pR(1),ES(1)],"Prey Behavior Root",0)}function AR(){return new Wt([lR(1),uR(1),hR(1),gR(1),vR(1),cR(1),mR(1),ES(1)],"Predator Behavior Root",0)}const _S=TR();function IR(e,t){e.aiBlackboard?ph(e,t,_S):(console.warn(`Behavior Tree AI ticked for prey ${e.id}, but the tree or blackboard was missing.`),e.activeAction="idle")}const CS=AR();function ER(e,t){e.aiBlackboard?ph(e,t,CS):(console.warn(`Behavior Tree AI ticked for predator ${e.id}, but the tree or blackboard was missing.`),e.activeAction="idle")}function wR(e,t){const{gameState:i,deltaTime:o}=t,l=o*(Et/wt);if(e.isBeingDestroyed){const s=X_(e.buildingType);if(s>0?e.destructionProgress+=l/s:e.destructionProgress=1,e.destructionProgress>=1){qo(i.entities,e.id);return}}if(!e.isConstructed&&!e.isBeingDestroyed){const s=V_(e.buildingType);s>0?e.constructionProgress+=l/s:e.constructionProgress=1,e.constructionProgress>=1&&(e.constructionProgress=1,e.isConstructed=!0)}}function _R(e,t){e.forces.push(Pt(e.velocity,-.1));const i=Pt(nt(e.direction),e.acceleration);e.forces.push(i),e.debuffs.forEach(o=>{t.gameState.time-o.startTime<o.duration&&o.type==="slow"&&(e.velocity=Pt(e.velocity,.5))}),e.debuffs=e.debuffs.filter(o=>t.gameState.time-o.startTime<o.duration),e.velocity=Un(e.velocity,e.forces.reduce(Un,{x:0,y:0})),bo(e.velocity)<.001&&(e.velocity={x:0,y:0}),e.position=Un(e.position,Pt(e.velocity,t.deltaTime)),e.position.x=(e.position.x%t.gameState.mapDimensions.width+t.gameState.mapDimensions.width)%t.gameState.mapDimensions.width,e.position.y=(e.position.y%t.gameState.mapDimensions.height+t.gameState.mapDimensions.height)%t.gameState.mapDimensions.height,e.forces=[],e.type==="human"?o1(e,t,t.deltaTime):e.type==="corpse"?s1(e,t):e.type==="prey"?a1(e,t,t.deltaTime):e.type==="predator"?l1(e,t,t.deltaTime):e.type==="building"&&wR(e,t),e.type==="human"&&yR(e,t),e.type==="prey"?IR(e,t):e.type==="predator"&&ER(e,t),e.stateMachine&&(e.stateMachine=r1(...e.stateMachine,{entity:e,updateContext:t}))}function CR(e){const t=e.gameState.entities;Object.values(t.entities).forEach(i=>{_R(i,e)})}function RS(){return{entities:{},nextEntityId:1}}function Zo(e,t,i){const o={id:e.nextEntityId++,type:t,velocity:{x:0,y:0},direction:{x:0,y:0},acceleration:0,forces:[],debuffs:[],...i};return e.entities[o.id]=o,o}function Ca(e,t,i){return Zo(e,"berryBush",{position:t,radius:Ef,food:Array.from({length:hI},()=>({type:Bn.Berry})).map(l=>({...l,id:e.nextEntityId++})),maxFood:fI,lifespan:pI,age:0,spreadRadius:Ef,timeSinceLastBerryRegen:0,timeSinceLastSpreadAttempt:0,timeSinceLastHarvest:0,stateMachine:[Js,{enteredAt:i,previousState:void 0}]})}function Iu(e,t,i,o,l=!1,s=AE,u=Dv,d,f,g=[],m,v){const y=s>=Vf;return Zo(e,"human",{position:t,radius:y?_t:Vo,hunger:u,hitpoints:Vm,maxHitpoints:Vm,age:s,gender:o,isPlayer:l,food:[],maxFood:Nv,maxAge:da,isAdult:y,isPregnant:!1,gestationTime:0,procreationCooldown:0,attackCooldown:0,motherId:d,fatherId:f,ancestorIds:g,stateMachine:[ct,{enteredAt:i,previousState:void 0}],leaderId:m,tribeBadge:v,aiType:_a.BehaviorTreeBased,aiBlackboard:w.create()})}function vh(e,t,i,o,l,s,u,d,f,g,m){let v,y;switch(u){case"human":v=Mv,y=xr;break;case"prey":v=2,y=120;break;case"predator":v=4,y=140;break}return Zo(e,"corpse",{position:t,radius:l,gender:i,age:o,originalEntityId:s,originalEntityType:u,timeOfDeath:d,decayProgress:0,geneCode:m,food:[...Array.from({length:Math.max(v*Math.max(y-g,0)/y,0)},()=>({type:Bn.Meat})),...f].map(I=>({...I,id:e.nextEntityId++})),stateMachine:void 0})}function RR(e,t,i,o,l,s,u,d,f){return vh(e,t,i,o,l,s,"human",u,d,f)}function PR(e,t,i,o,l,s,u,d){return vh(e,t,i,o,l,s,"prey",u,[],0,d)}function NR(e,t,i,o,l,s,u,d){return vh(e,t,i,o,l,s,"predator",u,[],0,d)}function DR(e,t,i){const o=t?i.gameState.entities.entities[t]:void 0,l=[...e.ancestorIds||[],e.id],s=o?[...o.ancestorIds||[],o.id]:[],u=[...l,...s],d=[...new Set(u)],f=d.slice(Math.max(d.length-vE,0)),g=Math.random()<.5?"male":"female",m=Un(e.position,{x:5,y:5}),v=Iu(i.gameState.entities,m,i.gameState.time,g,!1,0,Dv/2,e.id,t,f,(o==null?void 0:o.leaderId)??e.leaderId,(o==null?void 0:o.tribeBadge)??e.tribeBadge);return Ie(i,fe.Birth,e.position),v}function qo(e,t){return e.entities[t]?(delete e.entities[t],!0):!1}function zo(e,t,i,o=DC,l=fS,s,u,d){const f=o>=ra,g=Date.now();return Zo(e,"prey",{position:t,radius:f?_t*.7:Vo*.7,hunger:l,hitpoints:v0,maxHitpoints:v0,age:o,maxAge:dS,gender:i,isAdult:f,isPregnant:!1,gestationTime:0,procreationCooldown:0,geneCode:s,motherId:u,fatherId:d,stateMachine:[Mn,{enteredAt:g,previousState:void 0}],aiType:_a.BehaviorTreeBased,aiBlackboard:w.create()})}function Wo(e,t,i,o=HC,l=gS,s,u,d){const f=o>=oa,g=Date.now();return Zo(e,"predator",{position:t,radius:f?_t*.9:Vo*.9,hunger:l,hitpoints:S0,maxHitpoints:S0,age:o,maxAge:hS,gender:i,isAdult:f,isPregnant:!1,gestationTime:0,procreationCooldown:0,geneCode:s,motherId:u,fatherId:d,stateMachine:[$t,{enteredAt:g,previousState:void 0}],aiType:_a.BehaviorTreeBased,aiBlackboard:w.create()})}function OR(e,t,i,o){const l=oS(i),s={position:t,radius:Math.max(l.width,l.height)/2,buildingType:i,ownerId:o,width:l.width,height:l.height,constructionProgress:0,destructionProgress:0,isConstructed:!1,isBeingDestroyed:!1};return Zo(e,"building",{...s,...i===Tn.StorageSpot&&{storedFood:[],storageCapacity:b_,lastDepositTime:0,lastRetrieveTime:0,lastStealTime:0}})}var Gt=(e=>(e.MOVE="MOVE",e.HUNGER="HUNGER",e.EAT="EAT",e.FIND_BUSH="FIND_BUSH",e.GATHER="GATHER",e.PROCREATE="PROCREATE",e.PLANT_BUSH="PLANT_BUSH",e.AUTOPILOT="AUTOPILOT",e.ANIMALS_INTRODUCTION="ANIMALS_INTRODUCTION",e.HUNT_PREY="HUNT_PREY",e.DEFEND_FROM_PREDATORS="DEFEND_FROM_PREDATORS",e))(Gt||{}),Br=(e=>(e.HUNGER_BAR="HUNGER_BAR",e.FOOD_BAR="FOOD_BAR",e.COMMAND_BUTTONS="COMMAND_BUTTONS",e))(Br||{}),xt=(e=>(e[e.FADING_IN=0]="FADING_IN",e[e.ACTIVE=1]="ACTIVE",e[e.FADING_OUT=2]="FADING_OUT",e[e.INACTIVE=3]="INACTIVE",e))(xt||{});const Df={},Of={},MR=[{key:Gt.MOVE,title:"Movement",text:"Use WASD or Arrow Keys to move your character around the world.",condition:e=>e.hasPlayerMovedEver||e.hasPlayerEnabledAutopilot>2,isCompleted:!1},{key:Gt.HUNGER,title:"Hunger",text:"Your character gets hungry over time. Watch the hunger bar!",condition:(e,t)=>t.hunger>SE,isCompleted:!1,minDisplayTime:u0,highlightedUIElements:[Br.HUNGER_BAR]},{key:Gt.FIND_BUSH,title:"Find Food",text:"Look for berry bushes. They are your primary source of food.",condition:(e,t)=>!!Ne(t,e,"berryBush",mt*5,o=>o.food.length>0),getTargets:(e,t)=>{const i=[];for(const o of Object.values(e.entities.entities))o.type==="berryBush"&&o.food.length>0&&Y(t.position,o.position,e.mapDimensions.width,e.mapDimensions.height)<500&&i.push(o);return i.map(o=>o.id)},isCompleted:!1,minDisplayTime:u0},{key:Gt.GATHER,title:"Gather Berries",text:"Get close to a bush and press 'E' to gather berries.",condition:(e,t)=>t.food.length>0,getTargets:(e,t)=>{const i=Ne(t,e,"berryBush",mt,o=>o.food.length>0);return i?[i.id]:[]},isCompleted:!1},{key:Gt.EAT,title:"Eat",text:"When you are hungry and have food, press 'F' to eat.",condition:(e,t)=>t.activeAction==="eating",isCompleted:!1,highlightedUIElements:[Br.FOOD_BAR]},{key:Gt.PROCREATE,title:"Procreate",text:"Find a mate and press 'R' to start a family. This is how you continue your lineage.",condition:(e,t)=>Ut(e,t).length>0,getTargets:(e,t)=>{const i=Ne(t,e,"human",mt,o=>Wr(t,o,e));return i?[i.id]:[]},isCompleted:!1},{key:Gt.PLANT_BUSH,title:"Farming",text:"You can plant new berry bushes. Carry some berries and press 'B' to plant.",condition:(e,t)=>dh(e,t).some(o=>o.type===ae.Plant)||e.hasPlayerPlantedBush===!0,isCompleted:!1},{key:Gt.AUTOPILOT,title:"Autopilot!",text:"You can turn autopilot for specific actions, press Shift and click on the action button to enable it.",condition:e=>e.hasPlayerEnabledAutopilot>2,highlightedUIElements:[Br.COMMAND_BUTTONS],isCompleted:!1},{key:Gt.ANIMALS_INTRODUCTION,title:"Wild Animals!",text:"Your world now has wild animals! Prey provide meat when hunted, but beware of predators that may attack.",condition:e=>Object.values(e.entities.entities).some(i=>i.type==="prey"||i.type==="predator"),isCompleted:!1,dependsOn:Gt.AUTOPILOT},{key:Gt.HUNT_PREY,title:"Hunt for Meat",text:"Click on prey animals to hunt them for meat. Hunting provides more food than gathering berries!",condition:(e,t)=>{const i=Ne(t,e,"prey",150);return t.hunger>40&&!!i},getTargets:(e,t)=>{const i=Ne(t,e,"prey",150);return i?[i.id]:[]},isCompleted:!1,dependsOn:Gt.ANIMALS_INTRODUCTION},{key:Gt.DEFEND_FROM_PREDATORS,title:"Predators",text:"Predators may attack when hungry! Click on them to fight back. Fighting together with family is more effective.",condition:(e,t)=>!!Ne(t,e,"predator",120),getTargets:(e,t)=>{const i=Ne(t,e,"predator",120);return i?[i.id]:[]},isCompleted:!1,dependsOn:Gt.HUNT_PREY}].map(e=>({...e,condition:e.condition?LR(e.condition):void 0,getTargets:e.getTargets?UR(e.getTargets):void 0}));function PS(){return{steps:MR.map(e=>({...e,isCompleted:!1}))}}function NS(){return{currentStepIndex:0,completedSteps:[],isActive:!0,transitionState:xt.FADING_IN,transitionAlpha:0,highlightedEntityIds:[],stepStartTime:null,activeUIHighlights:[]}}function kR(e){for(let t=0;t<e.tutorial.steps.length;t++){const i=e.tutorial.steps[t];if(!i.isCompleted)if(i.dependsOn){if(e.tutorialState.completedSteps.includes(i.dependsOn))return t}else return t}return null}function FR(e,t){const i=e.tutorialState;if(!i.isActive){i.transitionState=xt.INACTIVE,i.highlightedEntityIds=[],i.activeUIHighlights=[];return}const o=vt(e);if(!o){i.isActive=!1,i.transitionState=xt.INACTIVE,i.highlightedEntityIds=[],i.activeUIHighlights=[];return}const l=e.tutorial.steps[i.currentStepIndex];if(!l){i.isActive=!1,i.transitionState=xt.INACTIVE,i.highlightedEntityIds=[],i.activeUIHighlights=[];return}const s=1/Qw;switch(i.transitionState){case xt.FADING_IN:i.stepStartTime===null&&(i.stepStartTime=e.time),i.transitionAlpha+=s*t,i.transitionAlpha>=1&&(i.transitionAlpha=1,i.transitionState=xt.ACTIVE);break;case xt.ACTIVE:{const f=e.time-(i.stepStartTime||e.time)>=(l.minDisplayTime||0),g=Df[l.condition];g&&f&&g(e,o)&&(l.isCompleted=!0,i.completedSteps.includes(l.key)||i.completedSteps.push(l.key),i.transitionState=xt.FADING_OUT);break}case xt.FADING_OUT:if(i.transitionAlpha-=s*t,i.transitionAlpha<=0){i.transitionAlpha=0,i.stepStartTime=null;const d=kR(e);d!==null?(i.currentStepIndex=d,i.transitionState=xt.FADING_IN):(i.isActive=!1,i.transitionState=xt.INACTIVE)}break}if(i.transitionState!==xt.FADING_OUT&&i.transitionState!==xt.INACTIVE){const d=Of[l.getTargets||""];d?i.highlightedEntityIds=[...d(e,o)]:i.highlightedEntityIds=[],l.highlightedUIElements?i.activeUIHighlights=[...l.highlightedUIElements]:i.activeUIHighlights=[]}else i.highlightedEntityIds=[],i.activeUIHighlights=[]}function LR(e){const t=`condition_${Object.keys(Df).length+1}`;return Df[t]=e,t}function UR(e){const t=`getTargets_${Object.keys(Of).length+1}`;return Of[t]=e,t}function BR(){const e=RS(),t=0;for(let v=0;v<Av;v++){const y={x:Math.random()*et,y:Math.random()*tt};Ca(e,y,t)}const i=et/2,o=tt/2,l=Iu(e,{x:i,y:o},t,"male",!0);Iu(e,{x:i+50,y:o},t,"female",!1);for(let v=0;v<vS;v++){const y={x:i+et*(Math.random()-Math.random()),y:o+tt*(Math.random()-Math.random())};zo(e,y,"male",void 0,void 0,va()),zo(e,{x:y.x+20,y:y.y},"female",void 0,void 0,va())}const s={x:i+et*(Math.random()-Math.random()),y:o+tt*(Math.random()-Math.random())};Wo(e,s,"male",void 0,void 0,Sa()),Wo(e,{x:s.x+20,y:s.y},"female",void 0,void 0,Sa());const u=[{id:"muteButton",action:pe.ToggleMute,currentWidth:gi,rect:{x:0,y:0,width:0,height:0},text:"",backgroundColor:"",textColor:yn},{id:"pauseButton",action:pe.TogglePause,currentWidth:gi,rect:{x:0,y:0,width:0,height:0},text:"",backgroundColor:"",textColor:yn},{id:"returnToIntroButton",action:pe.ReturnToIntro,currentWidth:gi,rect:{x:0,y:0,width:0,height:0},text:"EXIT",backgroundColor:"",textColor:yn}],d=PS(),f=NS(),g={time:t,entities:e,mapDimensions:{width:et,height:tt},generationCount:1,gameOver:!1,visualEffects:[],nextVisualEffectId:0,viewportCenter:{...l.position},isPaused:!1,exitConfirmation:"inactive",autopilotControls:{behaviors:{procreation:!1,planting:!1,gathering:!1,attack:!1,feedChildren:!0,followLeader:!1},hoveredAutopilotAction:void 0,activeAutopilotAction:void 0,isManuallyMoving:!1},buildMenuOpen:!1,selectedBuildingType:null,selectedBuildingForRemoval:null,hasPlayerMovedEver:!1,hasPlayerPlantedBush:!1,hasPlayerEnabledAutopilot:0,masterVolume:iS,isMuted:!1,uiButtons:u,tutorial:d,tutorialState:f,debugPanel:At.None,performanceMetrics:{currentBucket:{renderTime:0,worldUpdateTime:0,aiUpdateTime:0},history:[]},hoveredButtonId:void 0,mousePosition:{x:0,y:0},notifications:[{id:"welcome",type:ga.Hello,message:"Welcome to the game!",duration:50,targetEntityIds:[l.id],highlightedEntityIds:[l.id],timestamp:0,isDismissed:!1,creationTime:Date.now()}],ecosystem:{preyGestationPeriod:Mr,preyProcreationCooldown:kr,predatorGestationPeriod:Fr,predatorProcreationCooldown:Lr,preyHungerIncreasePerHour:Ji,predatorHungerIncreasePerHour:er,berryBushSpreadChance:Si},autosaveIntervalSeconds:5,lastAutosaveTime:Date.now()},m=wu(g);return console.log("Game world initialized:",m),m}function HR(){const e=RS(),t=0;for(let u=0;u<Av;u++){const d={x:Math.random()*et,y:Math.random()*tt};Ca(e,d,t)}for(let u=0;u<uI;u++){const d={x:Math.random()*et,y:Math.random()*tt},f=Math.random()<.5?"male":"female";Iu(e,d,t,f,!1)}for(let u=0;u<vS;u++){const d={x:Math.random()*et,y:Math.random()*tt};zo(e,d,"male",void 0,void 0,va()),zo(e,{x:d.x+20,y:d.y},"female",void 0,void 0,va())}const i={x:Math.random()*et,y:Math.random()*tt};Wo(e,i,"male",void 0,void 0,Sa()),Wo(e,{x:i.x+20,y:i.y},"female",void 0,void 0,Sa());const o=PS(),l=NS(),s={time:t,entities:e,mapDimensions:{width:et,height:tt},generationCount:0,gameOver:!1,visualEffects:[],nextVisualEffectId:0,viewportCenter:{x:et/2,y:tt/2},isPaused:!1,exitConfirmation:"inactive",autopilotControls:{behaviors:{procreation:!1,planting:!1,gathering:!1,attack:!1,feedChildren:!0,followLeader:!1},hoveredAutopilotAction:void 0,activeAutopilotAction:void 0,isManuallyMoving:!1},buildMenuOpen:!1,selectedBuildingType:null,selectedBuildingForRemoval:null,hasPlayerMovedEver:!1,hasPlayerPlantedBush:!1,hasPlayerEnabledAutopilot:0,masterVolume:iS,isMuted:!0,uiButtons:[],tutorial:o,tutorialState:l,debugPanel:At.None,performanceMetrics:{currentBucket:{renderTime:0,worldUpdateTime:0,aiUpdateTime:0},history:[]},hoveredButtonId:void 0,mousePosition:{x:0,y:0},notifications:[],ecosystem:{preyGestationPeriod:Mr,preyProcreationCooldown:kr,predatorGestationPeriod:Fr,predatorProcreationCooldown:Lr,preyHungerIncreasePerHour:Ji,predatorHungerIncreasePerHour:er,berryBushSpreadChance:Si},lastAutosaveTime:0};return wu(s)}const bR="humanProcreation",GR="human",xR="human",$R=mt,zR=(e,t,i)=>Wr(e,t,i.gameState)?e.gender==="male"?e.activeAction==="procreating":e.activeAction==="procreating"&&t.activeAction==="procreating":!1,WR=(e,t,i)=>{var f,g;const{gameState:o}=i,l={x:(e.position.x+t.position.x)/2,y:(e.position.y+t.position.y)/2},s=e.gender==="male"?e:t,u=e.gender==="female"?e:t,d=(s.partnerIds||[]).length===0;if(e.stateMachine=[ma,{partnerId:t.id,previousState:(f=e.stateMachine)==null?void 0:f[0]}],t.stateMachine=[ma,{partnerId:e.id,previousState:(g=t.stateMachine)==null?void 0:g[0]}],e.partnerIds||(e.partnerIds=[]),e.partnerIds.includes(t.id)||e.partnerIds.push(t.id),t.partnerIds||(t.partnerIds=[]),t.partnerIds.includes(e.id)||t.partnerIds.push(e.id),d&&s.leaderId&&s.leaderId!==s.id){const m=o.entities.entities[s.leaderId];if(m){const v=Km(s,m),y=Km(u,m);if(!v&&!y){const A=Rf();s.leaderId=s.id,s.tribeBadge=A,s.diplomacy={},u.leaderId=s.id,u.tribeBadge=A}}}else if(!e.leaderId&&!t.leaderId&&s&&u){const m=Rf();s.leaderId=s.id,s.tribeBadge=m,s.diplomacy={},u.leaderId=s.id,u.tribeBadge=m}e.activeAction=void 0,Me(o,ce.Procreation,l,Dr),Me(o,ce.Partnered,e.position,xe,e.id),Me(o,ce.Partnered,t.position,xe,t.id),e.lastPartneredEffectTime=o.time,t.lastPartneredEffectTime=o.time,t.activeAction=void 0,Ie(i,fe.Procreate,l)},YR={id:bR,sourceType:GR,targetType:xR,maxDistance:$R,checker:zR,perform:WR},jR={id:"humanChildFeeding",sourceType:"human",targetType:"human",maxDistance:Kf,checker:(e,t)=>e.isAdult===!0&&e.food.length>0&&(!e.feedChildCooldownTime||e.feedChildCooldownTime<=0)&&t.isAdult===!1&&(t.motherId===e.id||t.fatherId===e.id)&&t.hunger>=or&&e.activeAction==="feeding",perform:(e,t,i)=>{e.food.pop(),t.hunger=Math.max(0,t.hunger-or),e.feedChildCooldownTime=NE,(!t.lastChildFedEffectTime||i.gameState.time-t.lastChildFedEffectTime>2)&&(Me(i.gameState,ce.ChildFed,t.position,xe,t.id),t.lastChildFedEffectTime=i.gameState.time),Ie(i,fe.ChildFed,t.position)}},VR={id:"human-attack",sourceType:"human",targetType:"human",maxDistance:ti,checker:(e,t,i)=>{var s;if(((s=e.stateMachine)==null?void 0:s[0])!==sr||e.attackTargetId!==t.id||(e.attackCooldown||0)>0)return!1;const o=e.stateMachine[1];return i.gameState.time-o.attackStartTime>=kv},perform:(e,t,i)=>{const o=ze(e.position,t.position,i.gameState.mapDimensions.width,i.gameState.mapDimensions.height),l=YE(nt(o),t.direction);if(Math.abs(l)<xE*Math.PI/180&&Math.random()<$E)Me(i.gameState,ce.AttackDeflected,t.position,xe,t.id);else{let d=qf;e.gender==="male"&&(d*=HE),e.isAdult||(d*=bE),(!t.isAdult||t.age>=Zf)&&e.isAdult&&(d*=GE),t.hitpoints-=d,t.movementSlowdown={modifier:Qf,endTime:i.gameState.time+Jf},Me(i.gameState,ce.Hit,t.position,xe,t.id);const g=ze(e.position,t.position,i.gameState.mapDimensions.width,i.gameState.mapDimensions.height),m=Pt(g,LE);t.forces.push(m),t.hitpoints<=0?Ie(i,fe.HumanDeath,t.position):Ie(i,fe.Attack,e.position)}e.attackCooldown=Mu;const u=e.stateMachine[1];u.attackStartTime=i.gameState.time,Me(i.gameState,ce.Attack,e.position,xe,e.id)}},XR={id:"human-collision",sourceType:"human",targetType:"human",maxDistance:_t*2,checker:(e,t,{gameState:i})=>Y(e.position,t.position,i.mapDimensions.width,i.mapDimensions.height)<(e.radius+t.radius)/3,perform:(e,t,{gameState:i})=>{const o=Y(e.position,t.position,i.mapDimensions.width,i.mapDimensions.height);if(o===0){e.forces.push({x:.1,y:0}),t.forces.push({x:-.1,y:0});return}const s=(e.radius+t.radius-o)*.05,u=nt(Fv(e.position,t.position)),d=Pt(u,s);e.forces.push(d),t.forces.push(Pt(d,-1))}},KR={id:"humanBerryBushGather",sourceType:"human",targetType:"berryBush",maxDistance:mt,checker:(e,t,i)=>{var o;return e.isAdult&&t.food.length>0&&((o=e.stateMachine)==null?void 0:o[0])===wa&&e.food.length<e.maxFood&&(!e.gatheringCooldownTime||e.gatheringCooldownTime<i.gameState.time)||!1},perform:(e,t,i)=>{const o=t.food.pop();o&&e.food.push(o),e.gatheringCooldownTime=i.gameState.time+1,t.timeSinceLastHarvest=i.gameState.time,Me(i.gameState,ce.BushClaimed,t.position,xe),Ie(i,fe.Gather,e.position)}},ZR={id:"corpseGather",sourceType:"human",targetType:"corpse",maxDistance:mt,checker:(e,t,i)=>{var o;return e.isAdult&&t.food.length>0&&((o=e.stateMachine)==null?void 0:o[0])===wa&&e.food.length<e.maxFood&&(!e.gatheringCooldownTime||e.gatheringCooldownTime<i.gameState.time)||!1},perform:(e,t,i)=>{const o=t.food.pop();o&&e.food.push(o),e.gatheringCooldownTime=i.gameState.time+1,Ie(i,fe.Gather,e.position)}},qR=[KR,ZR],QR={id:"prey-eat-berry-bush",sourceType:"prey",targetType:"berryBush",maxDistance:zt,checker:(e,t,i)=>!!(e.isAdult&&t.food.length>0&&e.hunger>30&&(!e.eatingCooldownTime||e.eatingCooldownTime<i.gameState.time)),perform:(e,t,i)=>{t.food.pop()&&(e.hunger=Math.max(0,e.hunger-25),t.lifespan-=kC,t.timeSinceLastHarvest=i.gameState.time,e.eatingCooldownTime=i.gameState.time+MC,Me(i.gameState,ce.BushClaimed,t.position,xe,e.id),Ie(i,fe.Gather,e.position))}},JR={id:"predator-hunt-prey",sourceType:"predator",targetType:"prey",maxDistance:_o,checker:(e,t,i)=>!!(e.isAdult&&e.hunger>50&&(!e.huntCooldown||e.huntCooldown<=0)&&t.hitpoints>0),perform:(e,t,i)=>{t.hitpoints-=bC;const o=ze(e.position,t.position,i.gameState.mapDimensions.width,i.gameState.mapDimensions.height),l=Pt(o,8);t.forces.push(l),e.huntCooldown=$C,t.hitpoints<=0?(Ie(i,fe.HumanDeath,t.position),Me(i.gameState,ce.Hit,t.position,xe,t.id)):(Me(i.gameState,ce.Hit,t.position,xe,t.id),t.fleeCooldown=5,Ie(i,fe.Attack,e.position)),Me(i.gameState,ce.Attack,e.position,xe,e.id)}},eP={id:"human-hunt-prey",sourceType:"human",targetType:"prey",maxDistance:ti,checker:(e,t,i)=>{var o;return!!(((o=e.stateMachine)==null?void 0:o[0])===sr&&e.attackTargetId===t.id&&(!e.attackCooldown||e.attackCooldown<=0)&&t.hitpoints>0&&e.isAdult)},perform:(e,t,i)=>{let o=qf*1.2;e.gender==="male"&&(o*=1.3),t.hitpoints-=o;const l=ze(e.position,t.position,i.gameState.mapDimensions.width,i.gameState.mapDimensions.height),s=Pt(l,6);t.forces.push(s),e.attackCooldown=Mu,t.hitpoints<=0?(Ie(i,fe.HumanDeath,t.position),Me(i.gameState,ce.Hit,t.position,xe,t.id)):(Me(i.gameState,ce.Hit,t.position,xe,t.id),t.fleeCooldown=8,Ie(i,fe.Attack,e.position)),Me(i.gameState,ce.Attack,e.position,xe,e.id)}},tP={id:"predator-attack-human",sourceType:"predator",targetType:"human",maxDistance:kn,checker:(e,t,i)=>{var o;return!!(e.isAdult&&(!e.attackCooldown||e.attackCooldown<=0)&&t.hitpoints>0&&(e.hunger>100||t.attackTargetId===e.id||t.attackTargetId&&((o=i.gameState.entities.entities[t.attackTargetId])==null?void 0:o.type)==="predator"))},perform:(e,t,i)=>{let o=pS;e.hunger>120&&(o*=1.3),t.hitpoints-=o,t.movementSlowdown={modifier:Qf,endTime:i.gameState.time+Jf};const l=ze(e.position,t.position,i.gameState.mapDimensions.width,i.gameState.mapDimensions.height),s=Pt(l,7);t.forces.push(s),e.attackCooldown=mS,t.hitpoints<=0?(e.hunger=Math.max(0,e.hunger-gh),Ie(i,fe.HumanDeath,t.position),Me(i.gameState,ce.Hit,t.position,xe,t.id)):(Me(i.gameState,ce.Hit,t.position,xe,t.id),Ie(i,fe.Attack,e.position)),Me(i.gameState,ce.Attack,e.position,xe,e.id)}},nP={id:"human-attack-predator",sourceType:"human",targetType:"predator",maxDistance:ti,checker:(e,t,i)=>{var o;return!!(((o=e.stateMachine)==null?void 0:o[0])===sr&&e.attackTargetId===t.id&&(!e.attackCooldown||e.attackCooldown<=0)&&t.hitpoints>0&&e.isAdult)},perform:(e,t,i)=>{let o=qf*.8;e.gender==="male"&&(o*=1.2);const l=Object.values(i.gameState.entities.entities).filter(d=>d.type==="human"&&d.id!==e.id).filter(d=>{const f=d;return Math.sqrt(Math.pow(f.position.x-e.position.x,2)+Math.pow(f.position.y-e.position.y,2))<100&&f.activeAction==="attacking"&&f.attackTargetId===t.id}).length;l>0&&(o*=1+l*.2),t.hitpoints-=o;const s=ze(e.position,t.position,i.gameState.mapDimensions.width,i.gameState.mapDimensions.height),u=Pt(s,8);t.forces.push(u),e.attackCooldown=Mu,t.hitpoints<=0?(Ie(i,fe.HumanDeath,t.position),Me(i.gameState,ce.Hit,t.position,xe,t.id)):(Me(i.gameState,ce.Hit,t.position,xe,t.id),t.hitpoints<t.maxHitpoints*.3&&(t.hunger+=20),Ie(i,fe.Attack,e.position)),Me(i.gameState,ce.Attack,e.position,xe,e.id)}},iP={id:"prey-procreation",sourceType:"prey",targetType:"prey",maxDistance:zt,checker:(e,t,i)=>!!(e.isAdult&&t.isAdult&&e.gender!==t.gender&&e.id!==t.id&&!e.isPregnant&&!t.isPregnant&&e.hunger<200&&t.hunger<200&&(!e.procreationCooldown||e.procreationCooldown<=0)&&(!t.procreationCooldown||t.procreationCooldown<=0)),perform:(e,t,i)=>{const o=e.gender==="female"?e:t;o.isPregnant=!0,o.gestationTime=i.gameState.ecosystem.preyGestationPeriod,e.procreationCooldown=i.gameState.ecosystem.preyProcreationCooldown,t.procreationCooldown=i.gameState.ecosystem.preyProcreationCooldown,Me(i.gameState,ce.Procreation,o.position,xe,o.id),Ie(i,fe.Procreate,o.position)}},rP={id:"predator-procreation",sourceType:"predator",targetType:"predator",maxDistance:ir,checker:(e,t,i)=>!!(e.isAdult&&t.isAdult&&e.gender!==t.gender&&e.id!==t.id&&!e.isPregnant&&!t.isPregnant&&e.hunger<200&&t.hunger<200&&(!e.procreationCooldown||e.procreationCooldown<=0)&&(!t.procreationCooldown||t.procreationCooldown<=0)),perform:(e,t,i)=>{const o=e.gender==="female"?e:t;o.isPregnant=!0,o.pregnancyFatherId=e.gender==="male"?e.id:t.id,o.gestationTime=i.gameState.ecosystem.predatorGestationPeriod,e.procreationCooldown=i.gameState.ecosystem.predatorProcreationCooldown,t.procreationCooldown=i.gameState.ecosystem.predatorProcreationCooldown,Me(i.gameState,ce.Procreation,o.position,xe,o.id),Ie(i,fe.Procreate,o.position)}},oP={id:"preyChildFeeding",sourceType:"prey",targetType:"prey",maxDistance:Ko,checker:(e,t)=>e.isAdult===!0&&e.gender==="female"&&e.hunger<80&&(!e.feedChildCooldownTime||e.feedChildCooldownTime<=0)&&t.isAdult===!1&&(t.motherId===e.id||t.fatherId===e.id)&&t.hunger>=Tu&&e.activeAction==="feeding",perform:(e,t,i)=>{e.hunger=Math.min(120,e.hunger+10),t.hunger=Math.max(0,t.hunger-Tu),e.feedChildCooldownTime=SS,(!t.lastChildFedEffectTime||i.gameState.time-t.lastChildFedEffectTime>2)&&(Me(i.gameState,ce.ChildFed,t.position,xe,t.id),t.lastChildFedEffectTime=i.gameState.time),Ie(i,fe.ChildFed,t.position)}},sP={id:"predatorChildFeeding",sourceType:"predator",targetType:"predator",maxDistance:Ko,checker:(e,t)=>e.isAdult===!0&&e.gender==="female"&&e.hunger<90&&(!e.feedChildCooldownTime||e.feedChildCooldownTime<=0)&&t.isAdult===!1&&(t.motherId===e.id||t.fatherId===e.id)&&t.hunger>=Tu&&e.activeAction==="feeding",perform:(e,t,i)=>{e.hunger=Math.min(140,e.hunger+15),t.hunger=Math.max(0,t.hunger-Tu),e.feedChildCooldownTime=SS,(!t.lastChildFedEffectTime||i.gameState.time-t.lastChildFedEffectTime>2)&&(Me(i.gameState,ce.ChildFed,t.position,xe,t.id),t.lastChildFedEffectTime=i.gameState.time),Ie(i,fe.ChildFed,t.position)}},aP={id:"predator-eat-corpse",sourceType:"predator",targetType:"corpse",maxDistance:ir,checker:(e,t,i)=>!!(e.isAdult&&e.hunger>30&&t.food.length>0&&(!e.eatingCooldownTime||e.eatingCooldownTime<=i.gameState.time)),perform:(e,t,i)=>{t.food.pop()&&(e.hunger=Math.max(0,e.hunger-gh),e.eatingCooldownTime=i.gameState.time+2,Me(i.gameState,ce.Eating,e.position,xe,e.id),Ie(i,fe.Gather,e.position))}},lP={id:"predator-attack-rival",sourceType:"predator",targetType:"predator",maxDistance:kn,checker:(e,t,i)=>{var o;return!!(e.isAdult&&(!e.attackCooldown||e.attackCooldown<=0)&&t.hitpoints>0&&(e.hunger>100||t.attackTargetId===e.id||t.attackTargetId&&((o=i.gameState.entities.entities[t.attackTargetId])==null?void 0:o.type)==="predator"))},perform:(e,t,i)=>{let o=pS;e.hunger>120&&(o*=1.3),t.hitpoints-=o,t.movementSlowdown={modifier:Qf,endTime:i.gameState.time+Jf};const l=ze(e.position,t.position,i.gameState.mapDimensions.width,i.gameState.mapDimensions.height),s=Pt(l,7);t.forces.push(s),e.attackCooldown=mS,t.hitpoints<=0?(e.hunger=Math.max(0,e.hunger-gh),Ie(i,fe.HumanDeath,t.position),Me(i.gameState,ce.Hit,t.position,xe,t.id)):(Me(i.gameState,ce.Hit,t.position,xe,t.id),Ie(i,fe.Attack,e.position)),Me(i.gameState,ce.Attack,e.position,xe,e.id)}},uP={id:"storageDeposit",sourceType:"human",targetType:"building",maxDistance:In,checker:(e,t,i)=>{var s;if(t.buildingType!=="storageSpot"||((s=e.stateMachine)==null?void 0:s[0])!==na||!t.isConstructed||e.food.length===0)return!1;t.storedFood||(t.storedFood=[]);const o=t.storageCapacity??0;return!(t.storedFood.length>=o||e.leaderId!==t.ownerId||i.gameState.time-(t.lastDepositTime??0)<G_)},perform:(e,t,i)=>{t.storedFood||(t.storedFood=[]);const o=e.food.pop();o&&t.storedFood.push({item:o,positionOffset:IS(t)}),t.lastDepositTime=i.gameState.time,Ie(i,fe.StorageDeposit,t.position)}},cP={id:"storageRetrieve",sourceType:"human",targetType:"building",maxDistance:In,checker:(e,t,i)=>{var l;return!(t.buildingType!=="storageSpot"||((l=e.stateMachine)==null?void 0:l[0])!==ia||!t.isConstructed||!t.storedFood||t.storedFood.length===0||e.food.length>=e.maxFood||e.leaderId!==t.ownerId||i.gameState.time-(t.lastRetrieveTime??0)<x_)},perform:(e,t,i)=>{if(!t.storedFood||t.storedFood.length===0)return;const o=t.storedFood.pop();o&&(e.food.push(o.item),IS(t)),t.lastRetrieveTime=i.gameState.time,Ie(i,fe.StorageRetrieve,t.position)}},dP={id:"storageSteal",sourceType:"human",targetType:"building",maxDistance:In,checker:(e,t,i)=>{var d;if(t.buildingType!=="storageSpot"||((d=e.stateMachine)==null?void 0:d[0])!==wa||!t.isConstructed||!t.storedFood||t.storedFood.length===0||e.food.length>=e.maxFood||e.leaderId===t.ownerId)return!1;const o=e.leaderId?i.gameState.entities.entities[e.leaderId]:void 0;if(!o||!o.diplomacy||o.diplomacy[t.ownerId]!==pt.Hostile||i.gameState.time-(t.lastStealTime??0)<$_)return!1;const u=Hn({leaderId:t.ownerId},i.gameState);for(const f of u)if(Y(e.position,f.position,i.gameState.mapDimensions.width,i.gameState.mapDimensions.height)<=Nf)return!1;return!0},perform:(e,t,i)=>{if(!t.storedFood||t.storedFood.length===0)return;const o=t.storedFood.pop();o&&e.food.push(o.item),t.lastStealTime=i.gameState.time,Ie(i,fe.StorageSteal,t.position),Me(i.gameState,ce.Attack,t.position,.5)}},fP={id:"human-takeover-building",sourceType:"human",targetType:"building",maxDistance:20,checker:(e,t,i)=>e.leaderId!==e.id||e.activeAction!=="takingOverBuilding"?!1:Fn(e,t,i.gameState),perform:(e,t,i)=>{t.ownerId=e.id,t.constructionProgress=1,t.isConstructed=!0,t.isBeingDestroyed=!1,t.destructionProgress=0,e.activeAction="idle",Me(i.gameState,ce.BushClaimed,t.position,2,t.id)}},hP={id:"human-remove-enemy-building",sourceType:"human",targetType:"building",maxDistance:20,checker:(e,t,i)=>!(e.leaderId!==e.id||e.activeAction!=="destroyingBuilding"||!Fn(e,t,i.gameState)||t.isBeingDestroyed),perform:(e,t,i)=>{t.isBeingDestroyed=!0,e.activeAction="idle",Me(i.gameState,ce.Hit,t.position,1,t.id)}},gP=[XR,...qR,YR,jR,VR,uP,cP,dP,fP,hP,QR,oP,sP,aP,JR,eP,nP,tP,lP,iP,rP];function pP(e){const{gameState:t}=e,i=t,o=Object.values(t.entities.entities);for(const l of gP)for(const s of o){if(l.sourceType&&s.type!==l.sourceType)continue;const u=i.search[l.targetType].byRadius(s.position,l.maxDistance);for(const d of u){if(s.id===d.id)continue;Y(s.position,d.position,t.mapDimensions.width,t.mapDimensions.height)<=l.maxDistance&&l.checker(s,d,e)&&l.perform(s,d,e)}}}function mP(e){e.visualEffects=e.visualEffects.filter(t=>e.time-t.startTime<=t.duration)}function vP(e){const t=e.search.berryBush.byProperty("type","berryBush"),i=e.search.predator.byProperty("type","predator"),o=e.search.human.byProperty("type","human");for(let l=0;l<20;l++){let s;if(t.length>0&&l<15){const f=t[Math.floor(Math.random()*t.length)],g=Math.random()*2*Math.PI,m=50+Math.random()*100;s={x:Math.max(50,Math.min(et-50,f.position.x+Math.cos(g)*m)),y:Math.max(50,Math.min(tt-50,f.position.y+Math.sin(g)*m))}}else s={x:50+Math.random()*(et-100),y:50+Math.random()*(tt-100)};let u=!0;const d=100;for(const f of i)if(Math.sqrt((s.x-f.position.x)**2+(s.y-f.position.y)**2)<d){u=!1;break}if(u){for(const f of o)if(Math.sqrt((s.x-f.position.x)**2+(s.y-f.position.y)**2)<d){u=!1;break}}if(u)return s}return{x:et*.3+Math.random()*et*.4,y:tt*.3+Math.random()*tt*.4}}function SP(e){const t=e.search.prey.byProperty("type","prey"),i=e.search.human.byProperty("type","human");for(let l=0;l<15;l++){let s;if(t.length>0&&l<10){const f=t[Math.floor(Math.random()*t.length)],g=Math.random()*2*Math.PI,m=100+Math.random()*150;s={x:Math.max(50,Math.min(et-50,f.position.x+Math.cos(g)*m)),y:Math.max(50,Math.min(tt-50,f.position.y+Math.sin(g)*m))}}else s={x:50+Math.random()*(et-100),y:50+Math.random()*(tt-100)};let u=!0;const d=150;for(const f of i)if(Math.sqrt((s.x-f.position.x)**2+(s.y-f.position.y)**2)<d){u=!1;break}if(u)return s}switch(Math.floor(Math.random()*4)){case 0:return{x:Math.random()*et,y:50+Math.random()*100};case 1:return{x:et-150+Math.random()*100,y:Math.random()*tt};case 2:return{x:Math.random()*et,y:tt-150+Math.random()*100};default:return{x:50+Math.random()*100,y:Math.random()*tt}}}function yP(e){const t=e.search.human.byProperty("type","human"),i=e.search.berryBush.byProperty("type","berryBush");for(let o=0;o<20;o++){const l={x:50+Math.random()*(et-100),y:50+Math.random()*(tt-100)};let s=!0;const u=80,d=60;for(const f of t)if(Math.sqrt((l.x-f.position.x)**2+(l.y-f.position.y)**2)<u){s=!1;break}if(s){for(const f of i)if(Math.sqrt((l.x-f.position.x)**2+(l.y-f.position.y)**2)<d){s=!1;break}}if(s)return l}return{x:Math.random()*et,y:Math.random()*tt}}function DS(e,t=4){console.log(` Respawning ${t} prey to prevent extinction`);const i=e;for(let o=0;o<t;o++){const l=vP(i),s=o%2===0?"male":"female";zo(e.entities,l,s,void 0,void 0,va())}}function OS(e,t=2){console.log(` Respawning ${t} predators to prevent extinction`);const i=e;for(let o=0;o<t;o++){const l=SP(i),s=o%2===0?"male":"female";Wo(e.entities,l,s,void 0,void 0,Sa())}}function TP(e){const t=e,i=t.search.prey.count(),o=t.search.predator.count();let l=!1;return i===0&&(DS(e,6),l=!0),o===0&&(OS(e,3),l=!0),l}function AP(e){const t=e,i=t.search.prey.count(),o=t.search.predator.count(),l=t.search.berryBush.count();let s=!1;if(i>0&&i<5){const u=Math.max(2,Math.floor(8-i));DS(e,u),s=!0}if(o>0&&o<2){const u=Math.max(1,Math.floor(3-o));OS(e,u),s=!0}if(l<5){console.log(` Boosting bush count from ${l} to help ecosystem`);for(let u=0;u<5;u++){const d=yP(t);Ca(e.entities,d,e.time)}s=!0}return s}const IP=1,EP=.3,wP=.8,R0=.8,_P=.99,CP=.05;var MS=(e=>(e[e.INCREASE_PREY_GESTATION=0]="INCREASE_PREY_GESTATION",e[e.DECREASE_PREY_GESTATION=1]="DECREASE_PREY_GESTATION",e[e.INCREASE_PREY_PROCREATION_COOLDOWN=2]="INCREASE_PREY_PROCREATION_COOLDOWN",e[e.DECREASE_PREY_PROCREATION_COOLDOWN=3]="DECREASE_PREY_PROCREATION_COOLDOWN",e[e.INCREASE_PREY_HUNGER=4]="INCREASE_PREY_HUNGER",e[e.DECREASE_PREY_HUNGER=5]="DECREASE_PREY_HUNGER",e[e.INCREASE_PREDATOR_GESTATION=6]="INCREASE_PREDATOR_GESTATION",e[e.DECREASE_PREDATOR_GESTATION=7]="DECREASE_PREDATOR_GESTATION",e[e.INCREASE_PREDATOR_PROCREATION_COOLDOWN=8]="INCREASE_PREDATOR_PROCREATION_COOLDOWN",e[e.DECREASE_PREDATOR_PROCREATION_COOLDOWN=9]="DECREASE_PREDATOR_PROCREATION_COOLDOWN",e[e.INCREASE_PREDATOR_HUNGER=10]="INCREASE_PREDATOR_HUNGER",e[e.DECREASE_PREDATOR_HUNGER=11]="DECREASE_PREDATOR_HUNGER",e[e.INCREASE_BUSH_SPREAD=12]="INCREASE_BUSH_SPREAD",e[e.DECREASE_BUSH_SPREAD=13]="DECREASE_BUSH_SPREAD",e[e.NO_ACTION=14]="NO_ACTION",e))(MS||{});const rf=Object.keys(MS).length/2;class RP{constructor(){Oe(this,"qTable",new Map);Oe(this,"epsilon",R0);Oe(this,"lastState",null);Oe(this,"lastAction",null)}discretizeState(t,i,o){const l=Math.min(4,Math.floor(t/25)),s=Math.min(4,Math.floor(i/5)),u=Math.min(4,Math.floor(o/15));return`${l}-${s}-${u}`}getQValue(t,i){return this.qTable.has(t)||this.qTable.set(t,new Map),this.qTable.get(t).get(i)||0}setQValue(t,i,o){this.qTable.has(t)||this.qTable.set(t,new Map),this.qTable.get(t).set(i,o)}getBestAction(t){let i=0,o=this.getQValue(t,0);for(let l=1;l<rf;l++){const s=this.getQValue(t,l);s>o&&(o=s,i=l)}return i}chooseAction(t){return Math.random()<this.epsilon?Math.floor(Math.random()*rf):this.getBestAction(t)}applyEmergencyCorrections(t,i,o,l){t<pi*.5&&(l.ecosystem.preyGestationPeriod=Math.max(Po,l.ecosystem.preyGestationPeriod*.8),l.ecosystem.preyProcreationCooldown=Math.max(No,l.ecosystem.preyProcreationCooldown*.8),l.ecosystem.preyHungerIncreasePerHour=Math.max(Mo,l.ecosystem.preyHungerIncreasePerHour*.9)),i<mi*.6&&(l.ecosystem.predatorGestationPeriod=Math.max(Do,l.ecosystem.predatorGestationPeriod*.75),l.ecosystem.predatorProcreationCooldown=Math.max(Oo,l.ecosystem.predatorProcreationCooldown*.75),l.ecosystem.predatorHungerIncreasePerHour=Math.max(ko,l.ecosystem.predatorHungerIncreasePerHour*.85)),o<vi*.5&&(l.ecosystem.berryBushSpreadChance=Math.min(Vs,l.ecosystem.berryBushSpreadChance*1.2)),t>pi*1.4&&(l.ecosystem.preyHungerIncreasePerHour=Math.min(Ji,l.ecosystem.preyHungerIncreasePerHour*1.05)),i>mi*1.4&&(l.ecosystem.predatorHungerIncreasePerHour=Math.min(er,l.ecosystem.predatorHungerIncreasePerHour*1.05)),o>vi*1.4&&(l.ecosystem.berryBushSpreadChance=Math.max(Si,l.ecosystem.berryBushSpreadChance*.95))}calculateReward(t,i,o){const l=Math.abs(t-pi),s=Math.abs(i-mi),u=Math.abs(o-vi),d=l/pi,f=s/mi,g=u/vi,m=d+f+g;return 100*Math.exp(-m*2)-50}applyAction(t,i){switch(t){case 0:i.ecosystem.preyGestationPeriod=Math.min(Mr,i.ecosystem.preyGestationPeriod+.2*(Mr-Po));break;case 1:i.ecosystem.preyGestationPeriod=Math.max(Po,i.ecosystem.preyGestationPeriod-.2*(Mr-Po));break;case 2:i.ecosystem.preyProcreationCooldown=Math.min(kr,i.ecosystem.preyProcreationCooldown+.2*(kr-No));break;case 3:i.ecosystem.preyProcreationCooldown=Math.max(No,i.ecosystem.preyProcreationCooldown-.2*(kr-No));break;case 4:i.ecosystem.preyHungerIncreasePerHour=Math.min(Ji,i.ecosystem.preyHungerIncreasePerHour+.2*(Ji-Mo));break;case 5:i.ecosystem.preyHungerIncreasePerHour=Math.max(Mo,i.ecosystem.preyHungerIncreasePerHour-.2*(Ji-Mo));break;case 6:i.ecosystem.predatorGestationPeriod=Math.min(Fr,i.ecosystem.predatorGestationPeriod+.2*(Fr-Do));break;case 7:i.ecosystem.predatorGestationPeriod=Math.max(Do,i.ecosystem.predatorGestationPeriod-.2*(Fr-Do));break;case 8:i.ecosystem.predatorProcreationCooldown=Math.min(Lr,i.ecosystem.predatorProcreationCooldown+.2*(Lr-Oo));break;case 9:i.ecosystem.predatorProcreationCooldown=Math.max(Oo,i.ecosystem.predatorProcreationCooldown-.2*(Lr-Oo));break;case 10:i.ecosystem.predatorHungerIncreasePerHour=Math.min(er,i.ecosystem.predatorHungerIncreasePerHour+.2*(er-ko));break;case 11:i.ecosystem.predatorHungerIncreasePerHour=Math.max(ko,i.ecosystem.predatorHungerIncreasePerHour-.2*(er-ko));break;case 12:i.ecosystem.berryBushSpreadChance=Math.min(Vs,i.ecosystem.berryBushSpreadChance+.2*(Vs-Si));break;case 13:i.ecosystem.berryBushSpreadChance=Math.max(Si,i.ecosystem.berryBushSpreadChance-.2*(Vs-Si));break}}updateQTable(t,i,o,l){const s=this.getQValue(t,i),u=Math.max(...Array.from({length:rf},(f,g)=>this.getQValue(l,g))),d=s+EP*(o+wP*u-s);this.setQValue(t,i,d)}step(t){const i=t,o=i.search.prey.count(),l=i.search.predator.count(),s=i.search.berryBush.count();this.applyEmergencyCorrections(o,l,s,t);const u=this.discretizeState(o,l,s);if(this.lastState!==null&&this.lastAction!==null){const f=this.calculateReward(o,l,s);this.updateQTable(this.lastState,this.lastAction,f,u)}const d=this.chooseAction(u);this.applyAction(d,t),this.epsilon=Math.max(CP,this.epsilon*_P),this.lastState=u,this.lastAction=d}reset(){this.qTable.clear(),this.epsilon=R0,this.lastState=null,this.lastAction=null}getStats(){return{qTableSize:this.qTable.size,explorationRate:this.epsilon}}}let kS=new RP;function PP(e){TP(e),AP(e),e.ecosystem.lastUpdateTime||(e.ecosystem.preyGestationPeriod=Po+(Mr-Po)*.3,e.ecosystem.preyProcreationCooldown=No+(kr-No)*.3,e.ecosystem.preyHungerIncreasePerHour=Mo+(Ji-Mo)*.3,e.ecosystem.predatorGestationPeriod=Do+(Fr-Do)*.3,e.ecosystem.predatorProcreationCooldown=Oo+(Lr-Oo)*.3,e.ecosystem.predatorHungerIncreasePerHour=ko+(er-ko)*.3,e.ecosystem.berryBushSpreadChance=Si+(Vs-Si)*.7),kS.step(e)}function NP(e){e.ecosystem.lastUpdateTime||(e.ecosystem.lastUpdateTime=0),!(e.time-e.ecosystem.lastUpdateTime<IP)&&(e.ecosystem.lastUpdateTime=e.time,PP(e))}function DP(){return kS.getStats()}function OP(e,t){e.selectedBuildingType&&e.selectedBuildingType!=="removal"&&(e.autopilotControls.activeAutopilotAction=void 0,e.autopilotControls.hoveredAutopilotAction=void 0)}const MP=1/60;function kP(e,t){const i=vt(e);i&&(e.viewportCenter=eh(e.viewportCenter,i.position,Yf*t))}function Uu(e,t){if(e.isPaused)return e;if(e.autosaveIntervalSeconds){const i=Date.now();i-e.lastAutosaveTime>e.autosaveIntervalSeconds*1e3&&(Bf(e),e.lastAutosaveTime=i)}for(;t>0;){const i=wu(e),o=Math.min(t,MP),l=o*(Et/wt);i.time+=l,kP(i,o),__(i),NP(i),C_(i),CR({gameState:i,deltaTime:o}),pP({gameState:i,deltaTime:o}),mP(i),FR(i,o),OP(i),e=i,t-=o}return e}function of(e,t,i){e.save();const{x:o,y:l,width:s,height:u}=t.rect,d=zv;if(e.beginPath(),e.moveTo(o+d,l),e.lineTo(o+s-d,l),e.quadraticCurveTo(o+s,l,o+s,l+d),e.lineTo(o+s,l+u-d),e.quadraticCurveTo(o+s,l+u,o+s-d,l+u),e.lineTo(o+d,l+u),e.quadraticCurveTo(o,l+u,o,l+u-d),e.lineTo(o,l+d),e.quadraticCurveTo(o,l,o+d,l),e.closePath(),e.fillStyle=t.isDisabled?Wv:t.backgroundColor,e.fill(),t.activated){e.save();const f=(Math.sin(Date.now()/1e3*Xv)+1)/2;e.strokeStyle=Vv,e.lineWidth=2+f*2,e.globalAlpha=.7+f*.3,e.stroke(),e.restore()}if(t.lastActivated){const f=Date.now()-t.lastActivated;if(f<yu){const g=1-f/yu;e.fillStyle=jv,e.globalAlpha=g,e.fill(),e.globalAlpha=1}}i&&!t.isDisabled&&(e.fillStyle=oh,e.globalAlpha=.5,e.fill(),e.globalAlpha=1),e.fillStyle=t.isDisabled?Yv:t.textColor,t.icon?(e.font=`${u*.55}px "Press Start 2P", Arial`,e.textAlign="center",e.textBaseline="middle",e.fillText(t.icon,o+s/2,l+u/2),t.text&&(e.font=`${u*.18}px "Press Start 2P", Arial`,e.textAlign="right",e.textBaseline="bottom",e.fillText(t.text,o+s-4,l+u-2))):(e.textAlign="center",e.textBaseline="middle",e.fillText(t.text,o+s/2,l+u/2)),e.restore()}function FP(e,t,i,o){e.save(),e.font=`${n0}px "Press Start 2P", Arial`,e.textAlign="center",e.textBaseline="bottom";const s=e.measureText(i).width,u=n0,d=s+i0*2,f=u+i0*2,g=o.x-d/2,m=e.canvas.height,v=t.y<m/2?t.y+t.height-r0:t.y-f+r0;e.fillStyle=Mw,e.fillRect(g,v,d,f),e.fillStyle=kw,e.fillText(i,o.x,v+f/2+u/2),e.restore()}function LP(e,t,i){e.save();const o=vt(t),l=[{id:"fastForwardButton",action:pe.FastForward,text:"FFWD [T]",currentWidth:gi*1.3,backgroundColor:Ki,textColor:yn,tooltip:"Fast-forward time",rect:{x:0,y:0,width:0,height:0}},{id:"pauseButton",action:pe.TogglePause,text:t.isPaused?"UN[P]AUSE":"[P]AUSE",backgroundColor:t.isPaused?xl:Ki,currentWidth:t.isPaused?gi*1.4:gi*1.1,tooltip:t.isPaused?"Resume Game":"Pause Game",rect:{x:0,y:0,width:0,height:0},textColor:yn},{id:"muteButton",action:pe.ToggleMute,text:t.isMuted?"UN[M]UTE":"[M]UTE",backgroundColor:t.isMuted?xl:Ki,tooltip:`Toggle Sound (${t.isMuted?"Muted":"Enabled"})`,currentWidth:gi,rect:{x:0,y:0,width:0,height:0},textColor:yn},{id:"returnToIntroButton",action:pe.ReturnToIntro,text:"EXIT",backgroundColor:Ki,tooltip:"Return to Main Menu [ESC]",currentWidth:gi*.9,rect:{x:0,y:0,width:0,height:0},textColor:yn}];if(t.uiButtons.push(...l),o){const g=dh(t,o),m=new Set(g.map(L=>L.type));let v=[{playerAction:ae.Gather,buttonAction:pe.CommandGather,shortcut:"E",name:"Gather",toggleKey:"gathering",condition:()=>o.isAdult===!0},{playerAction:ae.Eat,buttonAction:pe.CommandEat,shortcut:"F",name:"Eat"},{playerAction:ae.Plant,buttonAction:pe.CommandPlant,shortcut:"B",name:"Plant",toggleKey:"planting",condition:()=>o.isAdult===!0},{playerAction:ae.Procreate,buttonAction:pe.ToggleProcreationBehavior,shortcut:"R",name:"Procreation",toggleKey:"procreation",condition:()=>o.isAdult===!0},{playerAction:ae.FeedChild,buttonAction:pe.ToggleFeedChildBehavior,shortcut:"H",name:"Feed Child",toggleKey:"feedChildren",condition:()=>o.isAdult===!0},{playerAction:ae.Attack,buttonAction:pe.ToggleAttackBehavior,shortcut:"Q",name:"Attack",toggleKey:"attack",condition:()=>o.isAdult===!0&&o.leaderId===o.id},{playerAction:ae.FollowMe,buttonAction:pe.CommandFollowMe,shortcut:"C",name:"Follow Me",toggleKey:"followLeader",condition:()=>o.isAdult===!0&&o.leaderId===o.id},{playerAction:ae.CallToAttack,buttonAction:pe.CommandCallToAttack,shortcut:"V",name:"Call to Attack",condition:()=>o.isAdult===!0&&o.leaderId===o.id},{playerAction:ae.TribeSplit,buttonAction:pe.CommandTribeSplit,shortcut:"K",name:"Split Tribe",condition:()=>o.leaderId!==void 0&&o.leaderId!==o.id&&o.isAdult===!0},{playerAction:ae.Build,buttonAction:pe.CommandBuild,shortcut:"L",name:"Build",condition:()=>o.isAdult===!0&&o.leaderId===o.id}];v=v.filter(L=>L.condition?L.condition():!0);const y=1,A=v.length,I=A*on+(A-1)*Er,E=y*on+(y-1)*Er,C=(i-I)/2,F=e.canvas.height-E-20;if(v.forEach((L,D)=>{const H=D%A,b=Math.floor(D/A),U=C+H*(on+Er),$=F+b*(on+Er),ee=!!L.toggleKey,_e=ee&&t.autopilotControls.behaviors[L.toggleKey],Ce=!m.has(L.playerAction),De=L.playerAction===ae.Build&&t.buildMenuOpen,Pe=!t.hasPlayerEnabledAutopilot||t.hasPlayerEnabledAutopilot<3?" (Press Shift to toggle Auto)":"",de=ee?`${L.name}${Pe}`:L.name,Le=_e||De?xl:Ki,Te={id:`commandButton_${L.name}`,action:L.buttonAction,rect:{x:U,y:$,width:on,height:on},icon:Fu[L.playerAction],text:L.shortcut,backgroundColor:Le,textColor:yn,currentWidth:on,tooltip:de,isDisabled:Ce,activated:_e||De};t.uiButtons.push(Te)}),t.buildMenuOpen){const L=[{id:"buildMenu_storageSpot",action:pe.SelectStorageSpot,icon:"",shortcut:"1",name:"Storage Spot"},{id:"buildMenu_plantingZone",action:pe.SelectPlantingZone,icon:"",shortcut:"2",name:"Planting Zone"},{id:"buildMenu_removal",action:pe.SelectRemovalTool,icon:"",shortcut:"3",name:"Remove Building"}],D=L.length,H=D*on+(D-1)*Er,b=(i-H)/2,U=F-on-Er;L.forEach(($,ee)=>{const _e=b+ee*(on+Er),Ce=U,be=$.action===pe.SelectStorageSpot&&t.selectedBuildingType==="storageSpot"||$.action===pe.SelectPlantingZone&&t.selectedBuildingType==="plantingZone"||$.action===pe.SelectRemovalTool&&t.selectedBuildingType==="removal",De={id:$.id,action:$.action,rect:{x:_e,y:Ce,width:on,height:on},icon:$.icon,text:$.shortcut,backgroundColor:be?xl:Ki,textColor:yn,currentWidth:on,tooltip:$.name,activated:be};t.uiButtons.push(De),of(e,De,t.hoveredButtonId===De.id)})}}let s=i-je;l.forEach(g=>{const m=je,v=s-g.currentWidth;g.rect={x:v,y:m,width:g.currentWidth,height:$v},of(e,g,t.hoveredButtonId===g.id),s-=g.currentWidth+Ow});let u=null;t.uiButtons.filter(g=>g.id.startsWith("commandButton_")||g.id.startsWith("buildMenu_")).forEach(g=>{u||(u={x:g.rect.x,y:g.rect.y,width:g.rect.width,height:g.rect.height}),u.x=Math.min(u.x,g.rect.x),u.y=Math.min(u.y,g.rect.y),u.width=Math.max(u.width,g.rect.x+g.rect.width-u.x),u.height=Math.max(u.height,g.rect.y+g.rect.height-u.y),g.id.startsWith("commandButton_")&&of(e,g,t.hoveredButtonId===g.id)});const f=t.hoveredButtonId?t.uiButtons.find(g=>g.id===t.hoveredButtonId):void 0;return f&&f.tooltip&&t.mousePosition&&FP(e,f.rect,f.tooltip,t.mousePosition),e.restore(),{commandButtonsRect:u}}function UP(e){e.save(),e.fillStyle=Ww,e.fillRect(0,0,e.canvas.width,e.canvas.height),e.fillStyle=Yw,e.font=`${jw}px "Press Start 2P", Arial`,e.textAlign="center",e.textBaseline="middle",e.fillText("PAUSED",e.canvas.width/2,e.canvas.height/2),e.restore()}function Mf(e,t,i,o){const l=t.x-i.width/2,s=t.y-i.height/2,u=l+e.x,d=s+e.y,f=(u%o.width+o.width)%o.width,g=(d%o.height+o.height)%o.height;return{x:f,y:g}}function Bu(e,t,i,o){let l=e.x-t.x,s=e.y-t.y;return Math.abs(l)>o.width/2&&(l=l-Math.sign(l)*o.width),Math.abs(s)>o.height/2&&(s=s-Math.sign(s)*o.height),{x:l+i.width/2,y:s+i.height/2}}function Jl(e,t,i,o){const l=Bu(e.position,t,i,o),u=("radius"in e?e.radius:20)+20;return l.x>=-u&&l.x<=i.width+u&&l.y>=-u&&l.y<=i.height+u}function ln(e,t,i,o,l,...s){const u={...l.position};for(let d=-i;d<=i;d+=i)for(let f=-t;f<=t;f+=t)l.position.x=u.x+f,l.position.y=u.y+d,o(e,l,...s);l.position=u}const BP=25,HP=0,P0=28;function FS(e,t,i,o,l,s,u,d,f,g){e.save();const{x:m,y:v}=Bu(t,u,{width:d,height:f},g);e.strokeStyle=o,e.lineWidth=s,e.setLineDash(l),e.beginPath(),e.arc(m,v,i+ku,0,2*Math.PI),e.stroke(),e.restore()}function bP(e,t,i,o,l,s,u){if(t=t.filter(v=>v.type!==ae.FollowMe),t.length===0)return;e.save(),t.forEach(v=>{v.targetEntity&&FS(e,v.targetEntity.position,v.targetEntity.radius,ih,rh,2,o,l,s,u)}),e.font=`${Go}px "Press Start 2P", Arial`,e.fillStyle="white",e.textAlign="center",e.textBaseline="bottom",e.shadowColor="black",e.shadowBlur=5;const{x:d,y:f}=Bu(i.position,o,{width:l,height:s},u);let g=0,m={};t.forEach(v=>{const y=Fu[v.type];if(v.targetEntity){m[v.targetEntity.id]=(m[v.targetEntity.id]||0)+1;const A=v.targetEntity.position.x-o.x+l/2,I=v.targetEntity.position.y-o.y+s/2,E=`${y}${v.key.toUpperCase()}`,C=I-v.targetEntity.radius-ku-Go/2-(m[v.targetEntity.id]-1)*P0;e.fillText(E,A,C)}else{e.textAlign="left";const A=`${y}${v.key.toUpperCase()}`,I=d+BP,C=f+HP+g*P0;e.fillText(A,I,C),g++,e.textAlign="center"}}),e.restore()}const ye=(e,t,i,o,l,s,u)=>{s==="transparent"||o<=0||l<=0||(e.fillStyle=s,e.fillRect(Math.floor(t*u),Math.floor(i*u),Math.ceil(o*u),Math.ceil(l*u)))},N0=10,D0=10,qn=6,di=4,eu=2,GP=5,Sn=4,xP=2,kt=4,$P=2,Je=3,Io=2,Xi=0,sa=Xi+di-1,bt=sa,ut=sa+Sn-1,zP="rgba(0, 0, 0, 0.4)",WP=4,YP=1,Sh={name:"tribe-human-2d",referenceImage:"swos.png",description:`A 2D human character asset for the Tribe game. This includes ensuring that the unique animations for stances like 'eat' and 'procreate' do not erroneously appear in other stances, such as 'walk', which was observed in the provided rendered media. The 'idle' animation was updated to a leg sway to better match the provided video for that stance, replacing a simpler body bob.

# Visual style

Human characters in the Tribe game are inspired by classic 2D pixel art, they look like Sensible Soccer players(Sensible Soccer game visual style is IMPORTANT), with a simple and recognizable design. The characters are designed to be easily distinguishable and animated in a way that conveys their actions clearly.

Character in Tribe game look like people from stone age, they have simple clothing, no shoes, and no modern accessories. The characters are designed to be easily distinguishable and animated in a way that conveys their actions clearly.

# Technical details

The asset is rendered on a canvas using the CanvasRenderingContext2D API. The rendering function takes parameters for position, size, progress, stance, direction, gender, and age. The character can face left or right, and the rendering adapts based on the stance (e.g., idle, walk, eat, procreate).
The rendering function must be simple and efficient, it should not use complex patterns or gradients, and should focus on solid colors and basic shapes to maintain the pixel art aesthetic.

15% padding from all edges of the rendering box is required to ensure the character is not cut off during rendering.

Subtle shadow should be drawn under the character to give it a sense of depth.

# Rendering parameters

- age: The age of the character, which affects the size and proportions of the body parts. Age is a number between 1 and 60, with 20 being the average age.
- gender: 
  - The male characters should have only pants, while female cover their breasts with a top. The clothing should be simple and muted, reflecting a stone-age style.
  - Female characters should have long hair, while male should have short hair and beard.
  - Male characters should have a more robust, muscular build
  - Female characters should have thinner arms and legs, with a more pronounced waist and hips.
- isPregnant: (applicable only for females) Indicates if the character is pregnant, like very large belly. Pregnant characters should have a larger torso.
- direction: A vector indicating the character's facing direction. There should be at least 8 directions (like in Sensible Soccer): top left, top, top right, left, right, bottom left, bottom, bottom right. The character should be flipped horizontally if the direction vector's X component is negative.
             When moving up(top, top left, top right), the character back of the head should be visible, when moving down(Y > 0), the character face should be visible.
- hungryLevel: A number between 0 and 100 indicating how hungry the character is, hunger level 100 means the character is starving, 0 means the character is not hungry at all. So hungry characters should be thinner, with less body fat, and more pronounced muscles. The character's hunger level affects the size and proportions of the body parts, with hungrier characters being smaller and more gaunt.

# Rendering details

- All parts of the body must be connected
- Rendering must take into account direction vector (X and Y) to flip the character horizontally if needed
- The character's age affects the size and proportions of the body parts, with older characters being larger and more robust. Hair color should become gray for older characters.

# Stances

- 'idle': The character stands still, with a slight leg sway to indicate life.
- 'walk': The character moves forward, with legs and arms in motion.
- 'gathering': The character is gathering food from berry bushes, with arms reaching out and a slight bend at the knees.
- 'eat': The character holds food and brings it to their mouth, with a slight bend at the knees.
- 'procreate': The character performs a mating animation, with a specific pose and movement. There should be some additional visual effects to indicate this action, such as a slight glow or aura around the characters, or dust particles to indicate movement.
- 'attacking': The character performs an attack animation, with arms raised and a forward motion.
- 'defending': The character takes a defensive stance, with arms raised and a slight bend at the knees.
- 'stunned': The character is stunned and laying on the ground, with limbs relaxed and a neutral expression.
- 'dead': The character lies on the ground, with limbs relaxed and a neutral expression, slowly turns into a skeleton over time.

`,stances:["idle","walk","gathering","eat","procreate","dead","attacking","defending","stunned"],render(e,t,i,o,l,s,u,d="male",f=20,g=[1,0],m=!1,v=0){const y=["dead","stunned"].includes(u),A=y?D0+4:N0,I=y?N0+4:D0+Je,E=.15,C=Math.min(o*(1-2*E)/A,l*(1-2*E)/I),F=A*C,L=I*C,D=t+(o-F)/2,H=i+(l-L)/2;e.save(),g[0]<0&&!y?(e.translate(D+F,H),e.scale(-1,1)):e.translate(D,H);const U="#D09A5A",$=f>50?"#BDBDBD":"#281808",ee="#7F5C4A",_e="#6B4F3A",Ce="#E0D8C0",be="#A0522D",De=1-Math.max(0,Math.min(100,v))/100*.2,Pe=d==="male"?1.1:.9,de=.8+(Math.max(1,Math.min(f,60))-1)/59*.2;let Le=GP*De*Pe*de,Te=xP*De*Pe*de,ne=$P*De*de;m&&d==="female"&&(Le*=1.5);const W=Math.round((A-Le)/2),X=Math.round((A-qn)/2),j=W-Te,P=W+Le,B=1,K=W+(Le/2-B/2)-ne,ie=W+(Le/2+B/2),Se=g[1]<-.2&&Math.abs(g[0])<.7,le=Z=>{e.fillStyle=zP,e.beginPath();const re=A/2,Ue=Z;e.ellipse(Math.floor(re*C),Math.floor(Ue*C),Math.max(1,Math.floor(WP*C)),Math.max(1,Math.floor(YP*C)),0,0,2*Math.PI),e.fill()},Ee=(Z,re)=>{d==="male"?(ye(e,W,sa+Z,Le,Sn-Io,re,C),ye(e,W,sa+Sn-Io+Z,Le,Io,ee,C)):ye(e,W,sa+Z,Le,Sn,_e,C)},Ae=(Z,re)=>{Se?ye(e,X,Xi+Z,qn,di,$,C):(ye(e,X,Xi+Z,qn,di,re,C),ye(e,X,Xi+Z,qn,eu,$,C),d==="female"?(ye(e,X-1,Xi+eu+Z,1,di,$,C),ye(e,X+qn,Xi+eu+Z,1,di,$,C)):ye(e,X+1,Xi+2+Z,qn-2,di-2,$,C))};switch(u){case"idle":{const Z=s*Math.PI*2,re=Math.sin(Z)*.5,ge=(Math.cos(Z*2)+1)*.25;le(ut+Je+1),ye(e,K+re,ut+ge,ne,Je,U,C),ye(e,ie-re,ut+ge,ne,Je,U,C),Ee(ge,U),ye(e,j,bt+ge,Te,kt,U,C),ye(e,P,bt+ge,Te,kt,U,C),Ae(ge,U);break}case"walk":{const Z=s*Math.PI*2,re=Math.sin(Z)*2,ge=Math.abs(Math.cos(Z))*1;le(ut+Je+1),ye(e,K+re,ut+ge,ne,Je,U,C),ye(e,ie-re,ut+ge,ne,Je,U,C),Ee(ge,U),ye(e,j-re,bt+ge,Te,kt,U,C),ye(e,P+re,bt+ge,Te,kt,U,C),Ae(ge,U);break}case"gathering":{const Z=s*Math.PI*2,re=1,Ue=(Math.sin(Z)+1)/2*2,ge=re+Math.abs(Math.cos(Z))*.5;le(ut+Je+1),ye(e,K,ut+ge,ne,Je-re,U,C),ye(e,ie,ut+ge,ne,Je-re,U,C),Ee(ge,U),ye(e,j+1,bt+ge-Ue,Te,kt,U,C),ye(e,P-1,bt+ge-Ue,Te,kt,U,C),Ae(ge,U);break}case"eat":{le(ut+Je+1),ye(e,K,ut+1,ne,Je-1,U,C),ye(e,ie,ut+1,ne,Je-1,U,C),Ee(1,U);const Ue=(Math.sin(s*Math.PI*4)+1)/2,ge=X+qn/2,Gn=Xi+di/2,qe=P+(ge-P)*Ue,Ve=bt+1+(Gn-(bt+1))*Ue;ye(e,j,bt+1,Te,kt,U,C),ye(e,qe,Ve,Te,kt,U,C),ye(e,qe,Ve-1,1,1,be,C),Ae(1,U);break}case"procreate":{const Z=(Math.sin(s*Math.PI*8)+1)/4,re=(Math.sin(s*Math.PI*6)+1)*.5,Ue=1.5,ge=Ue-re;le(ut+Je+1),ye(e,K,ut+ge,ne,Je-Ue,U,C),ye(e,ie,ut+ge,ne,Je-Ue,U,C),Ee(ge,U),ye(e,j,bt+ge,Te,kt,U,C),ye(e,P,bt+ge,Te,kt,U,C),Ae(ge,U),e.globalAlpha=Z,Ee(ge,"white"),e.globalAlpha=1;break}case"attacking":{const Z=Math.sin(s*Math.PI)*1.5,re=Math.abs(Math.sin(s*Math.PI));le(ut+Je+1),ye(e,K-Z,ut+re,ne,Je,U,C),ye(e,ie+Z*.5,ut+re,ne,Je,U,C),Ee(re,U),ye(e,j,bt+re-2,Te,kt,U,C),ye(e,P,bt+re-2.5,Te,kt,U,C),Ae(re,U);break}case"defending":{le(ut+Je+1),ye(e,K,ut+1,ne,Je-1,U,C),ye(e,ie,ut+1,ne,Je-1,U,C),Ee(1,U),ye(e,j-1,bt+1-1,Te,kt,U,C),ye(e,P+1,bt+1-1,Te,kt,U,C),Ae(1,U);break}case"stunned":case"dead":{const Z=u==="dead",re=Z?Math.min(1,s):0,Ue=re>.5?Ce:U,ge=d==="male"?ee:_e,Gn=re>.8?"transparent":$,qe=A/2,Ve=I/2,xn=2;le(I-1),ye(e,qe-ne-xn,Ve,ne,Je,Ue,C),ye(e,qe+xn,Ve,ne,Je,Ue,C),ye(e,qe-Te-xn,Ve-Sn+1,Te,kt,Ue,C),ye(e,qe+xn,Ve-Sn+1,Te,kt,Ue,C);const Yt=qe-Le/2,cn=Ve-Sn/2;d==="male"?(re<.7&&ye(e,Yt,cn+Sn-Io,Le,Io,ge,C),ye(e,Yt,cn,Le,Sn-Io,Ue,C)):re<.7?ye(e,Yt,cn,Le,Sn,ge,C):ye(e,Yt,cn,Le,Sn,Ue,C);const $n=qe-qn/2,zn=Ve-Sn/2-di+1;if(ye(e,$n,zn,qn,di,Ue,C),Gn!=="transparent"&&ye(e,$n,zn,qn,eu,Gn,C),Z&&re>.6){const Ai="#B0A890";for(let lr=0;lr<3;lr++)ye(e,Yt+1,cn+lr*1+1,Le-2,.5,Ai,C)}break}default:ye(e,0,0,A,I,"magenta",C);break}e.restore()}};function jP(e,t,i,o,l){const s=t.x,u=t.y-i-o/2;e.save(),e.fillStyle=l,e.strokeStyle=l,e.lineWidth=1.5,e.beginPath(),e.rect(s-o/2,u,o,o/2),e.fill(),e.beginPath(),e.moveTo(s-o/2,u),e.lineTo(s-o/4,u-o/3),e.lineTo(s-o/6,u),e.moveTo(s-o/6,u),e.lineTo(s,u-o/2),e.lineTo(s+o/6,u),e.moveTo(s+o/6,u),e.lineTo(s+o/4,u-o/3),e.lineTo(s+o/2,u),e.stroke(),e.restore()}function Ta(e,t,i,o,l,s=!1,u=!1,d=!1,f=!1){o<Vf&&(i=i*.75),Sh.render(e,t.x-i/2,t.y-i/2,i,i,0,"idle",l,o,[0,0],!1,0);let g,m;s?(g=Iw,m=Hv):u?(g=Ew,m=xv):d?(g=ww,m=Gv):f&&(g=_w,m=bv),g&&m&&jP(e,t,i/2,g,m)}function VP(e,t,i,o,l,s){if(e.save(),o.length===0){e.restore();return}const u=o.length*l,d=4;let f;const g=u+(o.length-1)*d;o.length>1&&g>s?f=(s-u)/(o.length-1):f=d,o.length<=1&&(f=0);for(let m=0;m<o.length;m++){const{member:v,isPlayer:y,isHeir:A,isPartner:I,isParent:E}=o[m],C=t+m*(l+f)+l/2,F=i+l/4;Ta(e,{x:C,y:F},l,v.age,v.gender,y,A,I,E)}e.restore()}function XP(e,t,i,o,l){if(i.length===0)return;e.save();const s=Kn,u=" 00",d=" 00";e.font=`${Hd}px "Press Start 2P", Arial`;const f=e.measureText(u).width,g=e.measureText(d).width,m=Kn+vn+Kn+vn+Kn+$i+f+Kn/2+$i+g,v=i.length*Gl+(i.length-1)*e0,y=l-v-Kn;e.fillStyle=Rw,e.fillRect(s,y,m,v);for(let A=0;A<i.length;A++){const I=i[A],E=y+A*(Gl+e0),C=E+Gl/2;I.isPlayerTribe&&(e.fillStyle=Cw,e.fillRect(s,E,m,Gl));let F=s+Kn;if(e.font=`${vn}px "Press Start 2P", Arial`,e.textBaseline="middle",e.textAlign="left",e.fillText(I.tribeBadge,F,C-vn/4),F+=vn+Kn,!I.isPlayerTribe){const L=I.diplomacyStatus===pt.Friendly?"":"",D=`diplomacyButton_${I.leaderId}`,H={x:F-2,y:C-vn/2-2,width:vn+4,height:vn+4},b={id:D,action:pe.ToggleDiplomacy,rect:H,text:"",icon:L,backgroundColor:"transparent",textColor:"white",currentWidth:vn,tooltip:`Toggle diplomacy with this tribe (Currently: ${I.diplomacyStatus})`,targetTribeId:I.leaderId};t.uiButtons.push(b),t.hoveredButtonId===D&&(e.fillStyle=oh,e.globalAlpha=.5,e.fillRect(H.x,H.y,H.width,H.height),e.globalAlpha=1),e.font=`${vn*.8}px "Press Start 2P", Arial`,e.textBaseline="middle",e.textAlign="center",e.fillText(L,F+vn/2,C)}F+=vn+Kn,I.adultCount>0&&(Ta(e,{x:F+$i/2,y:C},$i,25,"male"),F+=$i/2,e.font=`${Hd}px "Press Start 2P", Arial`,e.fillStyle="white",e.textBaseline="middle",e.textAlign="left",e.fillText(` ${I.adultCount}`,F,C),F+=e.measureText(` ${I.adultCount}`).width+Kn/2),I.childCount>0&&(Ta(e,{x:F+$i/2,y:C},$i,1,"female"),F+=$i/2,e.font=`${Hd}px "Press Start 2P", Arial`,e.fillStyle="white",e.textBaseline="middle",e.textAlign="left",e.fillText(` ${I.childCount}`,F,C))}e.restore()}function KP(e,t,i,o,l){const s=Qv,u=Jv,d=t+o-s-u,f=i+u;e.save(),e.lineWidth=2,e.strokeStyle=l?n_:t_,e.beginPath();const g=5;e.moveTo(d+g,f+g),e.lineTo(d+s-g,f+s-g),e.moveTo(d+s-g,f+g),e.lineTo(d+g,f+s-g),e.stroke(),e.restore()}function ZP(e,t,i,o){const{tutorialState:l,tutorial:s}=t;if(l.transitionState===xt.INACTIVE)return;const u=s.steps[l.currentStepIndex];if(!u)return;e.save(),e.globalAlpha=l.transitionAlpha;const d=Vw,f=Xw,g=Kw,m=`${xd}px "Press Start 2P", Arial`,v=`${l0}px "Press Start 2P", Arial`,y=qw,A=l0*1.5;e.font=v;const I=u.text.split(" ");let E="";const C=[];for(let Ce=0;Ce<I.length;Ce++){const be=E+I[Ce]+" ";e.measureText(be).width>d-f*2&&Ce>0?(C.push(E),E=I[Ce]+" "):E=be}C.push(E);const F=f*2+xd+f/2+C.length*A,L=(i-d)/2,D=o-F-160;e.fillStyle=Zw,e.beginPath(),e.moveTo(L+g,D),e.lineTo(L+d-g,D),e.quadraticCurveTo(L+d,D,L+d,D+g),e.lineTo(L+d,D+F-g),e.quadraticCurveTo(L+d,D+F,L+d-g,D+F),e.lineTo(L+g,D+F),e.quadraticCurveTo(L,D+F,L,D+F-g),e.lineTo(L,D+g),e.quadraticCurveTo(L,D,L+g,D),e.closePath(),e.fill(),e.fillStyle=y,e.textAlign="center",e.textBaseline="top",e.font=m,e.fillText(u.title,L+d/2,D+f),e.font=v;let H=D+f+xd+f/2;for(const Ce of C)e.fillText(Ce,L+d/2,H),H+=A;const b=t.hoveredButtonId==="tutorial-dismiss";KP(e,L,D,d,b),e.restore();const U=Qv,$=Jv,ee=L+d-U-$,_e=D+$;return{x:ee,y:_e,width:U,height:U}}function sf(e,t,i){e.save();const o=e_,l={x:t.x-o,y:t.y-o,width:t.width+o*2,height:t.height+o*2};e.strokeStyle=Zv,e.lineWidth=qv+Math.sin(i*sh)*1.5,e.setLineDash([8,8]),e.strokeRect(l.x,l.y,l.width,l.height),e.restore()}function qP(e,t){e.fillStyle="white",e.font='30px "Press Start 2P", Arial',e.textAlign="center",e.fillText("Game Over!",e.canvas.width/2,e.canvas.height/2-60),e.font='20px "Press Start 2P", Arial',e.fillText("Lineage Extinct.",e.canvas.width/2,e.canvas.height/2-20),e.fillText(`Cause: ${t.causeOfGameOver||"Unknown"}`,e.canvas.width/2,e.canvas.height/2+20)}const LS=10,QP=3,O0=LS*.7;function JP(e,t){const{position:i,food:o,maxFood:l}=t;if(e.beginPath(),e.arc(i.x,i.y,LS,0,Math.PI*2),e.fillStyle="#228B22",e.fill(),e.strokeStyle="#006400",e.lineWidth=1,e.stroke(),o.length>0){const s=Math.PI*2/Math.min(o.length,l);for(let u=0;u<o.length;u++){const d=u*s,f=i.x+O0*Math.cos(d),g=i.y+O0*Math.sin(d);e.beginPath(),e.arc(f,g,QP,0,Math.PI*2),e.fillStyle="#FF0000",e.fill()}}}const M0=(e,t,i=70,o=50)=>{const l=e>>t&255;return`hsl(${Math.floor(l/255*360)}, ${i}%, ${o}%)`},eN=(e,t)=>{const i=e.match(/hsl\((\d+),\s*(\d+)%,\s*(\d+)%\)/);if(!i)return e;const[o,l,s]=[parseInt(i[1]),parseInt(i[2]),parseInt(i[3])];return`hsl(${o}, ${l}%, ${Math.max(0,s-t)}%)`},tu=(e,t,i,o,l,s,u,d=!1)=>{e.save(),e.translate(t,i),e.rotate(s),e.fillStyle=d?eN(u,15):u,e.beginPath(),e.roundRect(-o/2,0,o,l,o/2),e.fill(),e.restore()},af=(e,t)=>{const i=e.match(/hsl\((\d+),\s*(\d+)%,\s*(\d+)%\)/),o=75;if(!i)return`hsl(0, 0%, ${o}%)`;const[,l,s,u]=i.map(Number),d=s*(1-t),f=u+(o-u)*t;return`hsl(${l}, ${d}%, ${f}%)`},US={name:"tribe-prey-2d",referenceImage:"swos.png",description:`A 2D prey asset for the Tribe game, featuring various stances and animations.

Prey is an animal which can be hunted by predators or humans in the Tribe game.

Preys look like small 4 leg mammals, with a simple and recognizable design. The characters are designed to be easily distinguishable and animated in a way that conveys their actions clearly.

# Visual style

Prey characters in the Tribe game are inspired by classic 2D pixel art, they look like Sensible Soccer players(Sensible Soccer game visual style is IMPORTANT), with a simple and recognizable design. The characters are designed to be easily distinguishable and animated in a way that conveys their actions clearly.

Character in Tribe game look like creatures from stone age, they have simple clothing, no shoes, and no modern accessories. The characters are designed to be easily distinguishable and animated in away that conveys their actions clearly.

Prey walks on all fours, unlike human (two legs).

Each prey is described by a unique gene code, which is a number that defines its appearance, size, and other characteristics. The gene code is used to generate the character's appearance, including body proportions, color, and other visual features. The gene code is a 32-bit integer, with each bit representing a specific characteristic of the character.

Prey should have should have visible body parts, such as head, torso, arms, and legs. The body parts should be connected and should not overlap. The character's body parts should be simple shapes, such as circles and rectangles, with solid colors and no gradients or patterns.

Preys are supposed to be sympathetic and friendly, so the character's face should have a friendly expression, with a smile and bright eyes. The character's eyes should be large and expressive, with a simple design.

# Technical details

The asset is rendered on a canvas using the CanvasRenderingContext2D API. The rendering function takes parameters for position, size, progress, stance, direction, gender, and age. The character can face left or right, and the rendering adapts based on the stance (e.g., idle, walk, eat, procreate).
The rendering function must be simple and efficient, it should not use complex patterns or gradients, and should focus on solid colors and basic shapes to maintain the pixel art aesthetic.

15% padding from all edges of the rendering box is required to ensure the character is not cut off during rendering.

Subtle shadow should be drawn under the a character to give it a sense of depth.

IMPORTANT: The character is visible from the side, just like in Sensible Soccer.

# Rendering parameters

- age: The age of the character, which affects the size and proportions of the body parts. Age is a number between 0 and 12, with 2 being the average age.
- gender:
  - 'male': Male prey are larger and more robust, with a more pronounced musculature.
  - 'female': Female prey are smaller and more agile, with a leaner build.
- isPregnant: (applicable only for females) Indicates if the character is pregnant, like very large belly. Pregnant characters should have a larger torso.
- direction: A vector indicating the character's facing direction. There should be at least 8 directions (like in Sensible Soccer): top left, top, top right, left, right, bottom left, bottom, bottom right. The character should be flipped horizontally if the direction vector's X component is negative.
             When moving up(top, top left, top right), the character back of the head should be visible, when moving down(Y > 0), the character face should be visible.
- hungryLevel: A number between 0 and 100 indicating how hungry the character is, hunger level 100 means the character is starving, 0 means the character is not hungry at all. So hungry characters should be thinner, with less body fat, and more pronounced muscles. The character's hunger level affects the size and proportions of the body parts, with hungrier characters being smaller and more gaunt.

# Rendering details

- All parts of the body must be connected
- Rendering must take into account direction vector (X and Y) to flip the character horizontally if needed
- The character's age affects the size and proportions of the body parts, with older characters being larger and more robust. Hair color should become gray for older characters.

# Stances

- 'idle': The character stands still, with a slight leg sway to indicate life.
- 'walk': The character moves forward, with legs and arms in motion.
- 'eat': The character holds food and brings it to their mouth, with a slight bend at the knees.
- 'procreate': The character performs a mating animation, with a specific pose and movement. There should be some additional visual effects to indicate this action, such as a slight glow or aura around the characters, or a dust particles to indicate movement.
- 'dead': The character lies on the ground, with limbs relaxed and a neutral expression, slowly turns into a grey skeleton over time. The character pose and body parts should not be animated in this stance, as the character is dead so it should not move.`,stances:["idle","walk","eat","dead","procreate"],render(e,t,i,o,l,s,u,d={gender:"male",age:2,direction:[1,0],isPregnant:!1,hungryLevel:0,geneCode:8405024}){e.save(),e.imageSmoothingEnabled=!1;const f=o*.15,g=t+o/2,m=i+l/2,v=o-f*2,y=l-f*2,{gender:A,age:I,direction:E,isPregnant:C,hungryLevel:F,geneCode:L}=d,D=.8+Math.min(I,10)/10*.4,H=A==="male"?1.05:.95,b=1-F/100*.3,U=v*.5*b*D*H;let $=y*.3*D*H;const ee=v*.15*D*H,_e=U*.2,Ce=y*.3,be=M0(L,0,30,50);let De=M0(L,8,50,40);if(I>45){const le=Math.min(1,(I-45)/15);De=af(De,le)}e.translate(g,m),E[0]<0&&e.scale(-1,1);const Pe=Math.sin(s*Math.PI*2),de=Math.cos(s*Math.PI*2),Le=Ce+$*.2;if(u==="dead"){const le=Math.min(s,1);e.translate(0,y*.2),e.rotate(Math.PI/2);const Ee=af(De,le),Ae=af(be,le);e.globalAlpha=.5+le*.5,e.strokeStyle=Ee,e.lineWidth=_e*.5,e.beginPath(),e.moveTo(-U*.4,0),e.lineTo(U*.4,0),e.stroke();for(let Z=-1;Z<=1;Z+=1)e.beginPath(),e.arc(0,0,$*.4,Math.PI*.4*Z-Math.PI*.2,Math.PI*.4*Z+Math.PI*.2),e.stroke();e.fillStyle=Ae,e.beginPath(),e.arc(U*.5,0,ee,0,Math.PI*2),e.fill(),e.fillStyle="black",e.beginPath(),e.arc(U*.55,0,ee*.3,0,Math.PI*2),e.fill(),e.restore();return}e.fillStyle="rgba(0, 0, 0, 0.1)",e.beginPath(),e.ellipse(0,Le,U*.7,U*.25,0,0,2*Math.PI),e.fill();let Te=0,ne=0,W=0,X=0,j=0,P=0;switch(u){case"idle":ne=Pe*(y*.02),W=Pe*.05,X=-Pe*.05,j=-Pe*.05,P=Pe*.05;break;case"walk":ne=Math.abs(de)*(y*-.04),W=Pe*.7,X=-Pe*.7,j=-Pe*.7,P=Pe*.7;break;case"eat":Te=y*.1,ne=y*.05,Te+=Pe*(y*.02);break;case"procreate":ne=y*.05;const le=(1-de)*-v*.05;e.translate(le,0),e.shadowColor="rgba(255, 182, 193, 0.9)",e.shadowBlur=10;break}C&&A==="female"&&($*=1.6);const B=ne,K=B-$*.2;tu(e,U*-.35,K,_e,Ce,j,De,!0),tu(e,U*.35,K,_e,Ce,P,De,!0),e.fillStyle=De,e.beginPath(),e.ellipse(0,B,U/2,$/2,0,0,2*Math.PI),e.fill();const ie=U*.45,Se=K+Te;e.fillStyle=be,e.beginPath(),e.arc(ie,Se,ee,0,Math.PI*2),e.fill(),E[1]>=0&&(e.fillStyle="black",e.beginPath(),e.arc(ie+ee*.3,Se-ee*.2,ee*.15,0,Math.PI*2),e.fill()),tu(e,U*-.35,K,_e,Ce,W,De),tu(e,U*.35,K,_e,Ce,X,De),e.restore()}};function tN(e,t){let[i,o,l]=e.match(/\d+/g).map(Number);return i=Math.max(0,i-t),o=Math.max(0,o-t),l=Math.max(0,l-t),`rgb(${i}, ${o}, ${l})`}function nN(e){const t=(e&16711680)>>16,i=(e&65280)>>8,o=e&255,l=`rgb(${t}, ${i}, ${o})`,s=tN(l,40),u=(e&255)%100+50,d=(e>>8&255)%100,f=(e>>16&255)%100,g=`rgb(${u}, ${d}, ${f})`,m=(e&8388608)!==0?"#00aaff":"#ffaa00";return{furColor:l,darkerFurColor:s,skinColor:g,eyeColor:m}}const BS={name:"tribe-predator-2d",referenceImage:"swos.png",description:`A 2D predator asset for the Tribe game, featuring various stances and animations.

Predator is an animal which can hunt and attack humans in the Tribe game. It is designed to be a threat to the player, adding an element of danger and challenge to the game world.

Predator look like bears or wolves, with a simple and recognizable design. The characters are designed to be easily distinguishable and animated in a way that conveys their actions clearly.

# Visual style

Predator characters in the Tribe game are inspired by classic 2D pixel art, they look like Sensible Soccer players(Sensible Soccer game visual style is IMPORTANT), with a simple and recognizable design. The characters are designed to be easily distinguishable and animated in a way that conveys their actions clearly.

Character in Tribe game look like creatures from stone age, they have simple clothing, no shoes, and no modern accessories. The characters are designed to be easily distinguishable and animated in away that conveys their actions clearly.

Predator walks on arms and legs, unlike human (two legs).

Each predator is described by a unique gene code, which is a number that defines its appearance, size, and other characteristics. The gene code is used to generate the character's appearance, including body proportions, color, and other visual features. The gene code is a 32-bit integer, with each bit representing a specific characteristic of the character.

Predator should have visible ears, eyes, and mouth with teeth. It must have a tail. Front legs should be shorter than back legs, and they should be positioned closer to the body. The character's body should be wider at the top and narrower at the bottom, with a slight curve to the back. The character's head should be larger than the body, with a pronounced jaw and sharp teeth.

# Technical details

The asset is rendered on a canvas using the CanvasRenderingContext2D API. The rendering function takes parameters for position, size, progress, stance, direction, gender, and age. The character can face left or right, and the rendering adapts based on the stance (e.g., idle, walk, eat, procreate).
The rendering function must be simple and efficient, it should not use complex patterns or gradients, and should focus on solid colors and basic shapes to maintain the pixel art aesthetic.

15% padding from all edges of the rendering box is required to ensure the character is not cut off during rendering.

Subtle shadow should be drawn under the a character to give it a sense of depth.

IMPORTANT: The character is visible from the side, just like in Sensible Soccer.

# Rendering parameters

- age: The age of the character, which affects the size and proportions of the body parts. Age is a number between 1 and 20, with 3 being the average age.
- gender:
  - 'male': Male predators are larger and more robust, with a more pronounced musculature.
  - 'female': Female predators are smaller and more agile, with a leaner build.
- isPregnant: (applicable only for females) Indicates if the character is pregnant, like very large belly. Pregnant characters should have a larger torso.
- direction: A vector indicating the character's facing direction. There should be at least 8 directions (like in Sensible Soccer): top left, top, top right, left, right, bottom left, bottom, bottom right. The character should be flipped horizontally if the direction vector's X component is negative.
             When moving up(top, top left, top right), the character back of the head should be visible, when moving down(Y > 0), the character face should be visible.
- hungryLevel: A number between 0 and 100 indicating how hungry the character is, hunger level 100 means the character is starving, 0 means the character is not hungry at all. So hungry characters should be thinner, with less body fat, and more pronounced muscles. The character's hunger level affects the size and proportions of the body parts, with hungrier characters being smaller and more gaunt.

# Rendering details

- All parts of the body must be connected
- Rendering must take into account direction vector (X and Y) to flip the character horizontally if needed
- The character's age affects the size and proportions of the body parts, with older characters being larger and more robust. Hair color should become gray for older characters.

# Stances

- 'idle': The character stands still, with a slight leg sway to indicate life.
- 'walk': The character moves forward, with legs and arms in motion.
- 'eat': The character holds food and brings it to their mouth, with a slight bend at the knees.
- 'procreate': The character performs a mating animation, with a specific pose and movement. There should be some additional visual effects to indicate this action, such as a slight glow or aura around the characters, or a dust particles to indicate movement.
- 'attacking': The character performs an attack animation, with arms raised and a forward motion.
- 'dead': The character lies on the ground, with limbs relaxed and a neutral expression, slowly turns into a grey skeleton over time. The character pose and body parts should not be animated in this stance, as the character is dead so it should not move.`,stances:["idle","walk","eat","dead","attacking","procreate"],render(e,t,i,o,l,s,u,d={gender:"male",age:20,direction:[1,0],isPregnant:!1,hungryLevel:0,geneCode:8405024}){const{gender:f,age:g,direction:m,isPregnant:v,hungryLevel:y,geneCode:A}=d;e.save();const I=o*.15,E=Math.max(1,Math.floor((o-I*2)/10)),C=m[0]<0;e.translate(t+o/2,i+l/2),C&&e.scale(-1,1);const F=nN(A),L=.8+Math.min(g,20)/20*.4,D=f==="male"?1.05:.95,H=1-y/100*.25,b=L*D*H,U=Math.max(0,Math.min(1,(g-15)/5));e.filter=`grayscale(${U})`;const $=F.furColor,ee=F.darkerFurColor,_e=F.eyeColor,Ce="#FFFFFF",be="#c75c5c",De="#E0E0E0",Pe="#A0A0A0",de=l/2-2*E,Le=Math.sin(s*Math.PI*2),Te=Math.abs(Le);if(e.fillStyle="rgba(0,0,0,0.15)",e.beginPath(),e.ellipse(0,de,E*4,E,0,0,2*Math.PI),e.fill(),e.filter="none",u==="dead"){const qe=Math.min(1,s*2);e.save(),e.translate(0,de-E*3),e.rotate(-Math.PI/2);const Ve=(xn,Yt,cn,$n,zn=!1)=>{e.fillStyle=zn?Pe:De,e.fillRect(xn*E,Yt*E,cn*E,$n*E)};qe<1&&(e.globalAlpha=1-qe,e.fillStyle=$,e.beginPath(),e.ellipse(0,0,E*3,E*5,0,0,Math.PI*2),e.fill(),e.globalAlpha=1),qe>0&&(e.globalAlpha=qe,Ve(-1,-4,2,2),Ve(1,-3.5,1,1,!0),Ve(-.5,-2,1,5,!0),Ve(-2.5,-1,5,.5),Ve(-2.5,0,5,.5),Ve(-2.5,1,5,.5),Ve(-3,-2,-1,2,!0),Ve(3,-2,1,2),Ve(-3,2,-1,2,!0),Ve(3,2,1,2),e.globalAlpha=1),e.restore(),e.restore();return}e.fillStyle=$;let ne=0,W=0,X=0,j=[0,0,0,0];switch(u){case"idle":ne=Le*E*.1;break;case"walk":const qe=Math.sin(s*Math.PI*4);ne=Math.abs(qe)*-E*.5,j=[qe*E,-qe*E,-qe*E,qe*E];break;case"attacking":const Ve=Math.sin(s*Math.PI*4);W=E*2+Ve*E,X=E*2,ne=E;break;case"eat":X=E*3+Te*E,ne=E*1.5,e.fillStyle=be,e.fillRect(-E,de-E,E*2,E);break;case"procreate":ne=Math.sin(s*Math.PI*8)*E*.3,e.fillStyle="rgba(139, 69, 19, 0.5)";for(let Yt=0;Yt<5;Yt++){const cn=(Math.random()-.5)*E*8,$n=de+(Math.random()-.5)*E*2;Te>.5&&e.fillRect(cn,$n,E*.5,E*.5)}break}const P=E*3*b*(v?1.3:1),B=E*5*b,K=-B/1.5,ie=de-P-E*2.5+ne;e.fillStyle=$,e.beginPath(),e.moveTo(K-E*.5,ie+P*.5),e.quadraticCurveTo(K-E*3,ie-E,K-E*2+Le*E,ie+P+E),e.fill();const Se=E*1.2*b,le=E*3*b,Ee=E*2.5*b,Ae=K+B*.8,Z=K+B*.2;e.fillStyle=ee,e.fillRect(Z,de-Ee,Se,Ee+j[2]),e.fillRect(Ae,de-le,Se,le+j[0]),e.fillStyle=$,e.beginPath(),e.moveTo(K,ie+P),e.lineTo(K,ie+E),e.quadraticCurveTo(K+B/2,ie,K+B,ie+E),e.lineTo(K+B,ie+P),e.fill(),e.fillStyle=$,e.fillRect(Z+E/2,de-Ee,Se,Ee+j[3]),e.fillRect(Ae+E/2,de-le,Se,le+j[1]);const re=E*3.5*b,Ue=K+B-re*.3+W,ge=ie-re*.3+X;e.fillStyle=$,e.beginPath(),e.arc(Ue,ge,re/2,0,Math.PI*2),e.fill(),e.beginPath(),e.ellipse(Ue+re*.4,ge+re*.2,E*1.5,E,0,0,Math.PI*2),e.fill(),m[1]>=0&&(e.fillStyle=_e,e.fillRect(Ue+E*.5,ge-E*.5,E*.5,E*.5),u==="attacking"&&(e.fillStyle=Ce,e.fillRect(Ue+re*.5,ge+re*.4,E,E*.4))),e.fillStyle=ee,e.beginPath(),e.moveTo(Ue-re*.4,ge-re*.3),e.lineTo(Ue,ge-re*.7),e.lineTo(Ue,ge-re*.2),e.fill(),e.restore()}},iN=9;function rN(e,t){const{position:i,gender:o,age:l,decayProgress:s,food:u,radius:d,originalEntityType:f,geneCode:g}=t;if(e.save(),e.globalAlpha=1-s,f==="human"?Sh.render(e,i.x-d,i.y-d,d*2,d*2,s,"dead",o,l,[0,0],!1,0):f==="prey"?US.render(e,i.x-d,i.y-d,d*2,d*2,s,"dead",{gender:o,age:l,direction:[0,0],isPregnant:!1,hungryLevel:0,geneCode:g||8405024}):f==="predator"&&BS.render(e,i.x-d,i.y-d,d*2,d*2,s,"dead",{gender:o,age:l,direction:[0,0],isPregnant:!1,hungryLevel:0,geneCode:g||8405024}),e.restore(),u.length>0){e.save(),e.font=`${iN}px Arial`,e.textAlign="center",e.textBaseline="middle";const m=_t*.9,v=Math.PI/Nv*3;u.forEach((y,A)=>{const I=A*v,E=i.x+m*Math.cos(I)*Math.atan2(A,A),C=i.y+m*Math.sin(I)*Math.atan2(A,A),F=jf[y.type];e.fillText(F,E,C)}),e.restore()}}function tr(e,t,i,o,l,s,u,d){e.save(),e.fillStyle=u,e.fillRect(t,i,o,l),e.fillStyle=d,e.fillRect(t,i,o*Math.max(0,s),l),e.restore()}function oN(e,t,i,o,l,s){if(e.save(),o.length===0){e.restore();return}const u=o.length*l;let d;u>s||u+(o.length-1)*4>s?d=(s-u)/(o.length-1):d=4,o.length===1&&(d=0);for(let f=0;f<o.length;f++){const g=jf[o[f].type];e.fillText(g,t+f*(l+d),i)}e.restore()}function sN(e,t,i,o,l){const s=t.autopilotControls.hoveredAutopilotAction;if(!s)return;let u,d=_t/2;const f=Fu[s.action],g=nS[s.action],m=`${f} ${g}`;if("targetEntityId"in s){const v=t.entities.entities[s.targetEntityId];v&&(u=v.position,d=v.radius)}else"position"in s&&(u=s.position);if(u){FS(e,u,d,ih,rh,2,i,o,l,t.mapDimensions),e.save(),e.font=`${Go}px "Press Start 2P", Arial`,e.fillStyle="white",e.textAlign="center",e.textBaseline="bottom",e.shadowColor="black",e.shadowBlur=5;const{x:v,y}=Bu(u,i,{width:o,height:l},t.mapDimensions),A=y-d-ku-Go/2;e.fillText(m,v,A),e.restore()}}function aN(e,t,i,o,l){e.save();const s=(Math.sin(l*sh)+1)/2,u=i+ku+s*5;e.strokeStyle=ih,e.lineWidth=2,e.setLineDash(rh),e.beginPath(),e.arc(t.x,t.y,u,0,Math.PI*2),e.stroke(),e.setLineDash([]);const d=Fu[o],f=nS[o];if(d){e.font=`${Go*1.5}px "Press Start 2P", Arial`,e.textAlign="center",e.textBaseline="middle";const g=t.y-u-25;e.fillText(d,t.x,g),e.font=`${Go*.8}px "Press Start 2P", Arial`,e.fillText(f,t.x,g+25)}e.restore()}function lN(e,t,i){e.save();const o=30,l=70,s=3,u=l/s;for(let d=0;d<s;d++){const f=d*u,g=(i*o+f)%l,m=1-g/l;e.strokeStyle=`rgba(255, 215, 0, ${m*.7})`,e.lineWidth=1+(1-m)*2,e.beginPath(),e.arc(t.x,t.y,g,0,Math.PI*2),e.stroke()}e.restore()}function uN(e,t){const{activeAutopilotAction:i,behaviors:o}=t.autopilotControls,l=vt(t);if(!l)return;const s=(u,d)=>{lN(u,d.position,t.time)};if(l.isCallingToFollow&&ln(e,t.mapDimensions.width,t.mapDimensions.height,s,{position:l.position}),o.followLeader&&!i&&ln(e,t.mapDimensions.width,t.mapDimensions.height,s,{position:l.position},70),i){let u,d=15;if("position"in i)u=i.position;else if("targetEntityId"in i){const f=t.entities.entities[i.targetEntityId];f&&(u=f.position,d=f.radius||30)}if(u&&i.action!==ae.AutopilotFollowMe&&!l.isCallingToFollow){const f=(g,m)=>{aN(g,m.position,d,i.action,t.time)};ln(e,t.mapDimensions.width,t.mapDimensions.height,f,{position:{...u}},u,d+30)}}}function k0(e,t,i,o,l,s,u=!0){const d=t.split(" ");let f="";const g=[];for(let m=0;m<d.length;m++){const v=f+d[m]+" ";e.measureText(v).width>l&&m>0?(g.push(f),f=d[m]+" "):f=v}if(g.push(f),u)for(let m=0;m<g.length;m++)e.fillText(g[m],i,o+m*s);return g.length*s}function cN(e){return 1-Math.pow(1-e,3)}function dN(e,t,i,o){t.notificationButtonRects={dismiss:{},view:{}};const l=t.notifications.filter(u=>!u.isDismissed);if(l.length===0)return;e.save();let s=o-d_;for(const u of l){const d=i-zl-wr;e.font=`${$d}px "Press Start 2P", Arial`;const f=d+wr,g=zl-wr*2,m=k0(e,u.message,-9999,-9999,g,$d*1.2,!1),v=wr*2+m+Zn,y=s-v,A=Date.now()-u.creationTime,I=Math.min(A/c_,1),E=cN(I),C=o,F=C+(y-C)*E;e.fillStyle=r_,e.beginPath(),e.roundRect(d,F,zl,v,i_),e.fill(),e.fillStyle=o_,e.textBaseline="top",k0(e,u.message,f,F+wr,g,$d*1.2,!0);const L=F+v-Zn-wr/2,D=d+zl-Zn-wr/2,H={x:D,y:L,width:Zn,height:Zn};t.notificationButtonRects&&(t.notificationButtonRects.dismiss[u.id]=H);const b=t.hoveredButtonId===`notification-dismiss-${u.id}`;if(e.fillStyle=b?d0:s_,e.font=`${Zn}px Arial`,e.textAlign="center",e.textBaseline="middle",e.fillText("",H.x+H.width/2,H.y+H.height/2),u.targetEntityIds||u.targetPosition||u.targetArea||u.targetRadius){const ee={x:D-Zn-c0,y:L,width:Zn,height:Zn};t.notificationButtonRects&&(t.notificationButtonRects.view[u.id]=ee);const _e=t.hoveredButtonId===`notification-view-${u.id}`;e.fillStyle=_e?d0:a_,e.font=`${Zn*(_e?1.5:1.2)}px Arial`,e.fillText("",ee.x+ee.width/2,ee.y+ee.height/2)}s-=v+c0}e.restore()}function fN(e){return e.length===0?0:e.reduce((i,o)=>i+o,0)/e.length}function lf(e,t,i,o,l,s,u,d){e.save(),e.fillStyle="rgba(255, 255, 255, 0.1)",e.fillRect(o,l,s,u),e.strokeStyle="#555",e.lineWidth=1,e.strokeRect(o,l,s,u);const f=fN(i);e.fillStyle="white",e.font="11px monospace",e.textAlign="left",e.fillText(`${t}: ${f.toFixed(2)}ms`,o+je,l+je+8);const g=Math.max(...i,1),m=i.map(v=>v/g*u);if(e.beginPath(),e.strokeStyle=d,e.lineWidth=2,m.length>1){e.moveTo(o,l+u-m[0]);for(let v=1;v<m.length;v++){const y=o+v/(m.length-1)*s,A=l+u-m[v];e.lineTo(y,A)}}else if(m.length===1){const v=l+u-m[0];e.moveTo(o,v),e.lineTo(o+s,v)}e.stroke(),e.fillStyle="rgba(255, 255, 255, 0.7)",e.font="10px monospace",e.textAlign="right",e.fillText(`${g.toFixed(2)}ms`,o+s-je,l+je+8),e.restore()}function hN(e,t,i){const{performanceMetrics:o}=t;if(!o)return;const l=280,s=240,u=i-l-je,d=je+un*2;e.save(),e.fillStyle="rgba(0, 0, 0, 0.8)",e.fillRect(u,d,l,s),e.strokeStyle="#444",e.lineWidth=2,e.strokeRect(u,d,l,s),e.fillStyle="white",e.font="12px monospace",e.textAlign="left";let f=d+je+5;const g=u+je;e.fillStyle="#66ccff",e.font="bold 14px monospace",e.fillText(" Performance Debugger",g,f),f+=25,e.fillStyle="white",e.font="12px monospace";const m=gN(t);e.fillText(`FPS: ${m.toFixed(1)}`,g,f),f+=20;const v=l-je*2,y=45,A=10;lf(e,"Render",uf(t,"renderTime"),g,f,v,y,"#4CAF50"),f+=y+A,lf(e,"World Update",uf(t,"worldUpdateTime"),g,f,v,y,"#2196F3"),f+=y+A,lf(e,"AI Update",uf(t,"aiUpdateTime"),g,f,v,y,"#FFC107"),e.fillStyle="#888",e.font="10px monospace",e.textAlign="center",e.fillText("Press '2' to toggle this panel",u+l/2,d+s-10),e.restore()}function gN(e){const{performanceMetrics:t}=e;if(!t||t.history.length===0)return 0;const i=t.history[t.history.length-1].bucketTime/(Et/wt);return t.history.filter(s=>i-s.bucketTime/(Et/wt)<1).length}function pN(e,t){if(e.length===0)return[];const i=new Map;for(const s of e){const u=Math.floor(s.bucketTime/(Et/wt));i.set(u,(i.get(u)||0)+s[t])}return Array.from(i.keys()).sort().map(s=>i.get(s)).slice(0,-1).slice(1).reverse()}function uf(e,t){return pN(e.performanceMetrics.history,t)}function yh(e,t,i){if(!t.aiBlackboard)return;const o=t.aiBlackboard.nodeExecutionData,l=t.type==="human"?wS:t.type==="predator"?CS:t.type==="prey"?_S:null;if(!l)return;e.save(),e.font=`${Uw}px Arial`,e.textAlign="left",e.textBaseline="top";const s=y=>{switch(y){case T.SUCCESS:return Hw;case T.FAILURE:return bw;case T.RUNNING:return Gw;case T.NOT_EVALUATED:case null:default:return xw}},u=y=>{if(!y.name||!o[y.name])return{width:0,height:0};let A=0,I=0;const E=o[y.name],C=` ${y.name}`+(E!=null&&E.debugInfo?`: ${E.debugInfo}`:""),F=e.measureText(C).width,L=(y.depth??0)*o0+8+F+a0+Hs+20;if(A=Math.max(A,L),I+=Gd,y.children)for(const D of y.children){const H=u(D);A=Math.max(A,H.width),I+=H.height}else if(y.child){const D=u(y.child);A=Math.max(A,D.width),I+=D.height}return{width:A,height:I}},d=(y,A,I,E)=>{if(!y.name||!o[y.name])return A;let C=A;const F=o[y.name],L=I+2+(y.depth??0)*o0;let D=T.NOT_EVALUATED,H=s0,b="";if(F){D=F.status,b=F.debugInfo;const ee=zw/wt*Et,_e=i-F.lastExecuted,Ce=Math.max(0,1-_e/ee);H=jE(s0,$w,Ce),_e>ca&&(D=T.NOT_EVALUATED)}const U=s(D);e.fillStyle=U,e.fillText("",L,C),e.fillStyle=H;const $=` ${y.name}`+(b?`: ${b}`:"");if(e.fillText($,L+8,C),F&&F.executionHistory.length>0){const{executionHistory:ee}=F,_e=Kv/wt*Et,Ce=i,be=Ce-_e,De=I+E-Hs-a0;let Pe=De;const de=C+(Gd-$l)/2,Le=ee.filter(K=>K.time<be);let Te=Le.length>0?Le[Le.length-1].status:null,ne=be;const W=ee.filter(K=>K.time>=be&&K.time<=Ce),X=Hs/_e;e.fillStyle="rgba(255, 255, 255, 0.1)",e.fillRect(De,de,Hs,$l);for(const K of W){const Se=(K.time-ne)*X;Se>0&&(e.fillStyle=s(Te),e.fillRect(Pe,de,Se,$l),Pe+=Se),Te=K.status,ne=K.time}i-ne>ca&&(Te=T.NOT_EVALUATED);const P=(Ce-ne)*X;e.fillStyle=s(Te);const B=De+Hs-Pe;e.fillRect(Pe,de,Math.min(P,B),$l)}if(C+=Gd,y.children)for(const ee of y.children)C=d(ee,C,I,E);else y.child&&(C=d(y.child,C,I,E));return C},{width:f,height:g}=u(l);if(g===0){e.restore();return}const m=t.position.x+Fw,v=t.position.y+Lw-g/2;e.fillStyle=Bw,e.fillRect(m,v,f,g+4),d(l,v+2,m,f),e.restore()}const mN={moving:"walk",gathering:"gathering",eating:"eat",feeding:"eat",procreating:"procreate",idle:"idle",attacking:"attacking",planting:"gathering",depositing:"gathering",retrieving:"gathering",takingOverBuilding:"attacking",destroyingBuilding:"attacking"};function vN(e,t){var d;const{radius:i,position:o,activeAction:l="idle"}=t,s=((d=t.stateMachine)==null?void 0:d[0])||"N/A",u=t.isAdult?_t+20:_t*.6+20;e.save(),e.fillStyle="white",e.font="10px Arial",e.textAlign="center",e.fillText(`Action: ${l}`,o.x,o.y-u),e.fillText(`State: ${s}`,o.x,o.y-u+10),e.fillText(`HP: ${t.hitpoints}`,o.x,o.y-u+20),e.fillText(`Cooldown: ${t.attackCooldown||"N/A"}`,o.x,o.y-u+30),e.fillText(`Tribe: ${t.leaderId||"N/A"}`,o.x,o.y-u+40),e.restore(),e.beginPath(),e.arc(o.x,o.y,i,0,Math.PI*2),e.strokeStyle="rgba(255, 0, 0, 0.5)",e.lineWidth=1,e.stroke(),e.closePath()}function SN(e,t,i,o,l){e.save(),e.font=`${Cf}px Arial`,e.textAlign="center",e.textBaseline="middle",e.fillText(i,t.x,t.y-(o?_t:Vo)-Cf-l),e.restore()}function yN(e,t,i,o,l){const s=t.x,u=t.y-i-o/2;e.save(),e.fillStyle=l,e.strokeStyle=l,e.lineWidth=1.5,e.beginPath(),e.rect(s-o/2,u,o,o/2),e.fill(),e.beginPath(),e.moveTo(s-o/2,u),e.lineTo(s-o/4,u-o/3),e.lineTo(s-o/6,u),e.moveTo(s-o/6,u),e.lineTo(s,u-o/2),e.lineTo(s+o/6,u),e.moveTo(s+o/6,u),e.lineTo(s+o/4,u-o/3),e.lineTo(s+o/2,u),e.stroke(),e.restore()}function TN(e,t,i){var d;const{position:o,radius:l}=t,s=o.x-bd/2,u=o.y-l-Pw;if(((d=t.stateMachine)==null?void 0:d[0])===sr){const f=t.stateMachine[1],g=i-f.attackStartTime,m=Math.min(g/kv,1);tr(e,s,u,bd,t0,m,Qi,Nw)}else if(t.attackCooldown&&t.attackCooldown>0){const f=1-t.attackCooldown/Mu;tr(e,s,u,bd,t0,f,Qi,Dw)}}function AN(e,t,i){const l="";e.save(),e.font="15px Arial",e.textAlign="center",e.textBaseline="bottom",e.shadowColor="black",e.shadowBlur=3,e.fillText(l,t.x,t.y-i),e.restore()}function IN(e,t,i=!1,o=!1,l=!1,s=!1,u=!1,d=!1,f=!1,g=!1,m,v){const{position:y,activeAction:A="idle"}=t,I=t.isAdult?_t:_t*.6,E=mN[A]||"idle";Sh.render(e,y.x-I,y.y-I,I*2,I*2,t.animationProgress||0,E,t.gender,t.age,[t.direction.x,t.direction.y],t.isPregnant??!1,t.hunger),d&&(e.save(),e.strokeStyle=uw,e.lineWidth=2,e.beginPath(),e.arc(y.x,y.y,I+3,0,2*Math.PI),e.stroke(),e.restore());let C,F;if(u?(C=dw,F=xv):i?(C=cw,F=Hv):l?(C=fw,F=lw):o?(C=hw,F=bv):s&&(C=gw,F=Gv),C&&F&&yN(e,y,I,C,F),t.tribeBadge&&SN(e,y,t.tribeBadge,t.isAdult??!1,C??0),f){let D=(t.isAdult?_t:Vo)+5;C&&(D+=C),t.tribeBadge&&(D+=Cf),AN(e,y,D)}const L=g&&(v===void 0||t.id===v);L&&t.aiBlackboard&&yh(e,t,m),TN(e,t,m),L&&vN(e,t)}const EN={grazing:"eat",moving:"walk",procreating:"procreate",feeding:"eat",idle:"idle"};function wN(e,t){var d;const{radius:i,position:o,activeAction:l="idle"}=t,s=((d=t.stateMachine)==null?void 0:d[0])||"N/A",u=t.isAdult?_t+20:_t*.6+20;e.save(),e.fillStyle="white",e.font="10px Arial",e.textAlign="center",e.fillText(`Action: ${l}`,o.x,o.y-u),e.fillText(`State: ${s}`,o.x,o.y-u+10),e.fillText(`HP: ${t.hitpoints}`,o.x,o.y-u+20),e.fillText(`Hunger: ${Math.round(t.hunger)}`,o.x,o.y-u+30),e.fillText(`Age: ${Math.round(t.age)}`,o.x,o.y-u+40),e.restore(),e.beginPath(),e.arc(o.x,o.y,i,0,Math.PI*2),e.strokeStyle="rgba(0, 255, 0, 0.5)",e.lineWidth=1,e.stroke(),e.closePath()}function _N(e,t,i=!1,o=0,l){var m,v;const{position:s,activeAction:u="idle"}=t,d=t.isAdult?t.radius:t.radius*.6,f=EN[u]||"idle";if(US.render(e,s.x-d,s.y-d,d*2,d*2,t.animationProgress||0,f,{gender:t.gender,age:t.age,direction:[((m=t.direction)==null?void 0:m.x)||1,((v=t.direction)==null?void 0:v.y)||0],isPregnant:t.isPregnant??!1,hungryLevel:t.hunger,geneCode:t.geneCode}),t.hitpoints<t.maxHitpoints){const y=d*1.5,A=3,I=s.x-y/2,E=s.y-d-8;e.fillStyle="#555",e.fillRect(I,E,y,A);const C=t.hitpoints/t.maxHitpoints;e.fillStyle=C>.5?"#4CAF50":C>.25?"#FFC107":"#F44336",e.fillRect(I,E,y*C,A)}const g=i&&(l===void 0||t.id===l);g&&t.aiBlackboard&&yh(e,t,o),g&&wN(e,t)}const CN={attacking:"attacking",eating:"eat",moving:"walk",procreating:"procreate",feeding:"eat",idle:"idle"};function RN(e,t){var d;const{radius:i,position:o,activeAction:l="idle"}=t,s=((d=t.stateMachine)==null?void 0:d[0])||"N/A",u=t.isAdult?_t+20:_t*.6+20;e.save(),e.fillStyle="white",e.font="10px Arial",e.textAlign="center",e.fillText(`Action: ${l}`,o.x,o.y-u),e.fillText(`State: ${s}`,o.x,o.y-u+10),e.fillText(`HP: ${t.hitpoints}`,o.x,o.y-u+20),e.fillText(`Hunger: ${Math.round(t.hunger)}`,o.x,o.y-u+30),e.fillText(`Age: ${Math.round(t.age)}`,o.x,o.y-u+40),e.restore(),e.beginPath(),e.arc(o.x,o.y,i,0,Math.PI*2),e.strokeStyle="rgba(255, 0, 0, 0.5)",e.lineWidth=1,e.stroke(),e.closePath()}function PN(e,t,i=!1,o=0,l){var m,v;const{position:s,activeAction:u="idle"}=t,d=t.isAdult?t.radius:t.radius*.6,f=CN[u]||"idle";if(BS.render(e,s.x-d,s.y-d,d*2,d*2,t.animationProgress||0,f,{gender:t.gender,age:t.age,direction:[((m=t.direction)==null?void 0:m.x)||1,((v=t.direction)==null?void 0:v.y)||0],isPregnant:t.isPregnant??!1,hungryLevel:t.hunger,geneCode:t.geneCode}),t.hitpoints<t.maxHitpoints){const y=d*1.5,A=3,I=s.x-y/2,E=s.y-d-8;e.fillStyle="#555",e.fillRect(I,E,y,A);const C=t.hitpoints/t.maxHitpoints;e.fillStyle=C>.5?"#4CAF50":C>.25?"#FFC107":"#F44336",e.fillRect(I,E,y*C,A)}(t.attackCooldown&&t.attackCooldown>0||t.huntCooldown&&t.huntCooldown>0)&&(e.strokeStyle="#FF8C00",e.lineWidth=3,e.beginPath(),e.arc(s.x,s.y,d+3,0,2*Math.PI),e.stroke());const g=i&&(l===void 0||t.id===l);g&&t.aiBlackboard&&yh(e,t,o),g&&RN(e,t)}const HS=15;function F0(e,t,i,o,l=1.5){const s=i-t.startTime,u=Math.min(s/t.duration,1),d=1-u,g=1+Math.sin(u*Math.PI*2)*(l-1),m=HS*g;e.save(),e.globalAlpha=d,e.beginPath(),e.arc(t.position.x,t.position.y,Math.max(0,m),0,Math.PI*2),e.fillStyle=o,e.fill(),e.restore()}function Eo(e,t,i,o,l=2){const s=i-t.startTime,u=Math.min(s/t.duration,1),d=1-u,f=HS*2*u;e.save(),e.globalAlpha=d,e.beginPath(),e.arc(t.position.x,t.position.y,f,0,Math.PI*2),e.strokeStyle=o,e.lineWidth=l,e.stroke(),e.restore()}function Yi(e,t,i,o){const l=i-t.startTime,s=Math.min(l/t.duration,1),u=1-s,d=-20*s;e.save(),e.globalAlpha=u,e.font="20px Arial",e.textAlign="center",e.fillText(o,t.position.x,t.position.y+d),e.restore()}function NN(e,t,i){switch(t.type){case ce.Hunger:F0(e,t,i,"rgba(255, 165, 0, 0.7)",1);break;case ce.Procreation:Yi(e,t,i,"");break;case ce.Pregnant:F0(e,t,i,"rgba(255, 105, 180, 0.7)",1.2);break;case ce.TargetAcquired:Eo(e,t,i,"rgba(255, 0, 0, 0.8)",3);break;case ce.Attack:Yi(e,t,i,"");break;case ce.Partnered:Yi(e,t,i,"");break;case ce.BushClaimed:Eo(e,t,i,"rgba(0, 255, 0, 0.7)",2);break;case ce.BushClaimLost:Eo(e,t,i,"rgba(128, 128, 128, 0.7)",2);break;case ce.Eating:Yi(e,t,i,"");break;case ce.ChildFed:Yi(e,t,i,"");break;case ce.AttackDeflected:Yi(e,t,i,"");break;case ce.AttackResisted:Yi(e,t,i,"");break;case ce.Hit:Yi(e,t,i,"");break;case ce.SeizeBuildup:Eo(e,t,i,"rgba(255, 215, 0, 0.8)",4);break;case ce.Seize:Eo(e,t,i,"rgba(148, 0, 211, 0.8)",4);break;case ce.CallToAttack:Eo(e,t,i,"rgba(255, 255, 0, 0.8)",4);break}}function L0(e,t,i,o,l,s,u){e.save();const{position:d}=t;e.strokeStyle=o,e.lineWidth=l+Math.sin(u*s)*(l/2),e.setLineDash([8,8]),e.beginPath(),e.arc(d.x,d.y,i,0,2*Math.PI),e.stroke(),e.restore()}const U0=8,DN=1.5,ON=.5,B0=2,MN="#5a5a5a",kN="#7e7e7e",FN="#8B0000",LN="#FF4444",UN=6;function cf(e){const t=Math.sin(e)*1e4;return t-Math.floor(t)}function kf(e,t,i,o,l,s){const u=(t+i)*2,d=Math.floor(u/U0),f=-t/2,g=t/2,m=-i/2,v=i/2;for(let y=0;y<d;y++){const A=o+y*13,I=cf(A),E=cf(A+1);let C=y*U0,F=0,L=0;C<t?(F=f+C,L=m):C<t+i?(F=g,L=m+(C-t)):C<t*2+i?(F=g-(C-(t+i)),L=v):(F=f,L=v-(C-(t*2+i)));const D=(E-.5)*B0,H=(cf(A+2)-.5)*B0;e.beginPath();const b=DN+I*ON;l?e.fillStyle=l:e.fillStyle=I>.5?s||kN:l||MN,e.ellipse(F+D,L+H,b,b*.85,E*Math.PI,0,Math.PI*2),e.fill(),l||(e.strokeStyle="#2b2b2b",e.lineWidth=1,e.stroke())}}function BN(e,t){if(!t.storedFood||t.storedFood.length===0)return;const{position:i,storedFood:o}=t;e.save(),e.font=`${UN}px Arial`,e.textAlign="center",e.textBaseline="middle",e.shadowColor="rgba(0,0,0,0.5)",e.shadowBlur=2,o.forEach(l=>{const s=jf[l.item.type],u={x:i.x+l.positionOffset.x,y:i.y+l.positionOffset.y};e.fillText(s,u.x,u.y)}),e.shadowBlur=0,e.shadowColor="transparent",e.restore()}function HN(e,t,i){const{position:o,width:l,height:s,constructionProgress:u,destructionProgress:d,isConstructed:f,isBeingDestroyed:g,id:m}=t,v=Ia[t.buildingType],y=vt(i),A=y&&Fn(y,t,i);e.save(),e.translate(o.x,o.y),f||(e.globalAlpha=.3+u*.7),A?kf(e,l,s,m,FN,LN):kf(e,l,s,m),e.globalAlpha=.5,e.font=`${Math.min(l,s,30)*.5}px Arial`,e.textAlign="center",e.textBaseline="middle",e.shadowColor="rgba(0,0,0,0.5)",e.shadowBlur=4,e.fillStyle="#FFFFFF",e.fillText(v.icon,0,0),e.shadowBlur=0,e.restore();const I=l,E=o.x-I/2,C=o.y+s/2+j_;f?g&&tr(e,E,C,I,m0,1-d,Qi,Y_):tr(e,E,C,I,m0,u,Qi,W_),t.buildingType==="storageSpot"&&f&&BN(e,t)}function bN(e,t,i,o,l){const s=Ia[i],{width:u,height:d}=s.dimensions,f=(m,v)=>{m.save(),m.translate(v.x,v.y),m.globalAlpha=z_;const y=o?"#4CAF50":"#F44336";kf(m,u,d,9999,y),m.font=`${Math.min(u,d)*.5}px Arial`,m.textAlign="center",m.textBaseline="middle",m.fillStyle=y,m.fillText(s.icon,0,0),m.restore()},g={position:{...t},radius:Math.max(u,d)/2,id:0,type:"building",direction:{x:0,y:0},acceleration:0,forces:[],velocity:{x:0,y:0},debuffs:[]};ln(e,l.width,l.height,(m,v)=>f(m,v.position),g)}function GN(e,t,i,o,l){const s=vt(t),u=s?Ut(t,s):[],d=yi(u),{width:f,height:g}=t.mapDimensions;Object.values(t.entities.entities).sort((I,E)=>i&&I.id===t.debugCharacterId&&I.id!==E.id||I.type==="building"&&E.type!=="building"?-1:I.position.y-E.position.y||I.id-E.id).filter(I=>Jl(I,o,l,t.mapDimensions)).forEach(I=>{var E,C;if(I.type==="building")ln(e,f,g,HN,I,t,s,t.time);else if(I.type==="berryBush")ln(e,f,g,JP,I,t,s,t.time);else if(I.type==="human"){const F=I,L=F.id===(s==null?void 0:s.id),D=u.some(Ce=>Ce.id===F.id),H=F.id===(d==null?void 0:d.id),b=s&&(F.id===s.motherId||F.id===s.fatherId),U=s&&(((E=F.partnerIds)==null?void 0:E.includes(s.id))||((C=s.partnerIds)==null?void 0:C.includes(F.id))),$=(s==null?void 0:s.attackTargetId)===F.id,ee=F.leaderId?t.entities.entities[F.leaderId]:void 0,_e=s?F.leaderId===s.id&&F.activeAction==="moving"&&F.target===F.leaderId&&(ee==null?void 0:ee.isCallingToFollow):!1;ln(e,f,g,IN,F,L,b,D,U,H,$,_e,i,t.time,t.debugCharacterId)}else I.type==="corpse"?ln(e,f,g,rN,I):I.type==="prey"?ln(e,f,g,_N,I,i,t.time,t.debugCharacterId):I.type==="predator"&&ln(e,f,g,PN,I,i,t.time,t.debugCharacterId)}),t.visualEffects.filter(I=>Jl(I,o,l,t.mapDimensions)).forEach(I=>{ln(e,f,g,NN,I,t.time)});const A=t.notifications.filter(I=>!I.isDismissed);for(const I of A)if(I.highlightedEntityIds&&I.renderHighlights)for(const E of I.highlightedEntityIds){const C=t.entities.entities[E];C&&Jl(C,o,l,t.mapDimensions)&&ln(e,f,g,L0,C,f_,h_,p_,g_,t.time)}if(t.tutorialState.isActive&&t.tutorialState.highlightedEntityIds.length>0)for(const I of t.tutorialState.highlightedEntityIds){const E=t.entities.entities[I];E&&Jl(E,o,l,t.mapDimensions)&&ln(e,f,g,L0,E,Jw,Zv,qv,sh,t.time)}}function xN(e,t,i,o,l,s){let u=null,d=null;e.textAlign="left";let f=je+un;const m=t.time/(Et/wt)/Ou%1,v=bs[wo.Time],y=25,A=je+y;e.fillText(v,je,f+rn/2+un/3),tr(e,A,f,xi,rn,m,Qi,Aw),f+=rn+ci;const I=f+Ir/2,E=f+(Ir-rn)/2,C=5;Ta(e,{x:je*2,y:I},Ir,5,i.gender,!1,!1,!1);const F=je+Ir+C,L=xi+y-(Ir+C)*2;tr(e,F,E,L,rn,Math.floor(i.age)/da,Qi,Tw),Ta(e,{x:F+L+C+Ir/2,y:I},Ir,da,i.gender,!1,!1,!1),f+=rn+ci*2;const D=[],H=new Set;if(D.push({member:i,isPlayer:!0,isHeir:!1,isPartner:!1,isParent:!1}),H.add(i.id),o&&!H.has(o.id)&&(D.push({member:o,isPlayer:!1,isHeir:!0,isPartner:!1,isParent:!1}),H.add(o.id)),l.forEach(de=>{H.has(de.id)||(D.push({member:de,isPlayer:!1,isHeir:!1,isPartner:!0,isParent:!1}),H.add(de.id))}),s.forEach(de=>{H.has(de.id)||(D.push({member:de,isPlayer:!1,isHeir:!1,isPartner:!1,isParent:!1}),H.add(de.id))}),i.motherId&&!H.has(i.motherId)){const de=t.entities.entities[i.motherId];de&&(D.push({member:de,isPlayer:!1,isHeir:!1,isPartner:!1,isParent:!0}),H.add(de.id))}if(i.fatherId&&!H.has(i.fatherId)){const de=t.entities.entities[i.fatherId];de&&(D.push({member:de,isPlayer:!1,isHeir:!1,isPartner:!1,isParent:!0}),H.add(de.id))}const b=bs[wo.Family],U=10,$=je+un+U,ee=xi+y-(un+U),_e=f+bl/2;e.font=`${un}px "Press Start 2P", Arial`,e.textBaseline="middle",e.fillText(b,je,_e);const Ce=f+bl/2;VP(e,$,Ce,D,bl,ee),f+=bl+ci,e.textBaseline="alphabetic";const be=bs[wo.Hitpoints];e.fillText(be,je,f+rn/2+un/3),tr(e,A,f,xi,rn,i.hitpoints/i.maxHitpoints,Qi,yw),f+=rn+ci;const De=bs[wo.Hunger];e.fillText(De,je,f+rn/2+un/3),tr(e,A,f,xi,rn,(Gr-i.hunger)/Gr,Qi,Sw),u={x:je,y:f-ci/2,width:xi+y,height:rn+ci},f+=rn+ci,e.textBaseline="middle";const Pe=bs[wo.Food];return e.fillText(Pe,je,f+Hl/2),oN(e,A,f+Hl/2,i.food,Hl,xi),d={x:je,y:f-ci/5,width:xi+y,height:Hl+ci},e.textBaseline="alphabetic",{hungerBarRect:u,foodBarRect:d}}let Ws=[],H0=0;const $N=36,zN=200;function WN(e,t,i,o){const l=t.search.prey.count(),s=t.search.predator.count(),u=t.search.berryBush.count();t.time-H0>=$N&&(Ws.push({time:t.time,prey:l,predators:s,bushes:u}),Ws.length>zN&&(Ws=Ws.slice(-200)),H0=t.time);const d=et*tt,f=l/d*1e6,g=s/d*1e6,m=u/d*1e6,v=DP(),y=Math.floor(t.time/(24*365)),A=Math.floor(t.time%(24*365)/24),I=Math.floor(t.time%24),E=400,C=Math.min(o*.8,600),F=i-E-10,L=je+un*2;e.save(),e.fillStyle="rgba(0, 0, 0, 0.9)",e.fillRect(F,L,E,C),e.strokeStyle="#444",e.lineWidth=2,e.strokeRect(F,L,E,C),e.fillStyle="white",e.font="12px monospace",e.textAlign="left";let D=L+20;const H=14,b=F+15;e.fillStyle="#66ccff",e.font="bold 14px monospace",e.fillText(" Ecosystem Debugger",b,D),D+=25,e.fillStyle="white",e.font="12px monospace",e.fillText(`Game Time: Year ${y}, Day ${A}, Hour ${I}`,b,D),D+=H,e.fillText(`Map Size: ${et}  ${tt} pixels`,b,D),D+=20,e.fillStyle="#66ccff",e.font="bold 13px monospace",e.fillText(" Q-Learning Status",b,D),D+=18,v&&(e.fillText(`Q-Table Size: ${v.qTableSize} entries`,b,D),D+=H,e.fillText(`Exploration Rate: ${(v.explorationRate*100).toFixed(1)}%`,b,D),D+=H);const U=Ws.slice(-20);U.length>1&&(e.fillStyle="#66ccff",e.font="bold 13px monospace",e.fillText(" Population Trends (Last 20 Points)",b,D),D+=30,YN(e,b,D,U),D+=50),e.fillStyle="#66ccff",e.font="bold 13px monospace",e.fillText(" Density (per 1000 px)",b,D),D+=18,e.fillStyle="white",e.font="12px monospace";const $=(pi/d*1e6).toFixed(2),ee=(mi/d*1e6).toFixed(2),_e=(vi/d*1e6).toFixed(2);e.fillText(`Prey: ${f.toFixed(2)} (target: ${$})`,b,D),D+=H,e.fillText(`Predators: ${g.toFixed(2)} (target: ${ee})`,b,D),D+=H,e.fillText(`Bushes: ${m.toFixed(2)} (target: ${_e})`,b,D),D+=20,e.fillStyle="#66ccff",e.font="bold 13px monospace",e.fillText(" Current Population Status",b,D),D+=18,e.fillStyle="white",e.font="12px monospace";const Ce=Math.round(l/pi*100),be=Math.round(s/mi*100),De=Math.round(u/vi*100),Pe=de=>de<50?"#ff4444":de<80?"#ffaa44":de>120?"#44aaff":"#44ff44";e.fillStyle=Pe(Ce),e.fillText(`Prey: ${l}/${pi} (${Ce}%)`,b,D),D+=H,e.fillStyle=Pe(be),e.fillText(`Predators: ${s}/${mi} (${be}%)`,b,D),D+=H,e.fillStyle=Pe(De),e.fillText(`Bushes: ${u}/${vi} (${De}%)`,b,D),D+=20,e.fillStyle="#66ccff",e.font="bold 13px monospace",e.fillText(" Current Parameters",b,D),D+=18,e.fillStyle="white",e.font="10px monospace",e.fillText("Prey:",b,D),D+=13,e.fillText(` Gestation: ${t.ecosystem.preyGestationPeriod.toFixed(1)}h`,b,D),D+=11,e.fillText(` Procreation: ${t.ecosystem.preyProcreationCooldown.toFixed(1)}h`,b,D),D+=11,e.fillText(` Hunger: ${t.ecosystem.preyHungerIncreasePerHour.toFixed(1)}/h`,b,D),D+=13,e.fillText("Predators:",b,D),D+=13,e.fillText(` Gestation: ${t.ecosystem.predatorGestationPeriod.toFixed(1)}h`,b,D),D+=11,e.fillText(` Procreation: ${t.ecosystem.predatorProcreationCooldown.toFixed(1)}h`,b,D),D+=11,e.fillText(` Hunger: ${t.ecosystem.predatorHungerIncreasePerHour.toFixed(1)}/h`,b,D),D+=13,e.fillText("Bushes:",b,D),D+=13,e.fillText(` Spread Chance: ${(t.ecosystem.berryBushSpreadChance*100).toFixed(1)}%`,b,D),D+=15,e.fillStyle="#888",e.font="10px monospace",e.textAlign="center",e.fillText("Press '1' to toggle this debugger",F+E/2,L+C-10),e.restore()}function YN(e,t,i,o){if(o.length<2)return;const d={prey:Math.max(...o.map(g=>g.prey),pi),predators:Math.max(...o.map(g=>g.predators),mi),bushes:Math.max(...o.map(g=>g.bushes),vi)};[{data:o.map(g=>g.prey),color:"#44ff44",label:"Prey",target:pi,max:d.prey},{data:o.map(g=>g.predators),color:"#ff4444",label:"Predators",target:mi,max:d.predators},{data:o.map(g=>g.bushes),color:"#ffaa44",label:"Bushes",target:vi,max:d.bushes}].forEach((g,m)=>{const v=t+m*115,y=i;e.fillStyle=g.color,e.font="10px monospace",e.fillText(g.label,v,y-5),e.strokeStyle="#333",e.lineWidth=1,e.strokeRect(v,y,100,30),e.beginPath(),e.strokeStyle=g.color;for(let I=0;I<g.data.length;I++){const E=v+I/(g.data.length-1)*100,C=y+30-g.data[I]/g.max*30;I===0?e.moveTo(E,C):e.lineTo(E,C)}e.stroke(),e.beginPath(),e.strokeStyle="#888",e.setLineDash([2,2]);const A=y+30-g.target/g.max*30;e.moveTo(v,A),e.lineTo(v+100,A),e.stroke(),e.setLineDash([])})}function jN(e){const t=Object.values(e.entities.entities).filter(o=>o.type==="human"),i={total:t.length,children:0,males:0,females:0,old:0};for(const o of t)o.isAdult||i.children++,o.gender==="male"?i.males++:o.gender==="female"&&i.females++,o.age>=Zf&&i.old++;return i}function VN(e){const t=Object.values(e.entities.entities),o=t.filter(d=>d.type==="berryBush").reduce((d,f)=>d+f.food.length,0),u=t.filter(d=>d.type==="building").filter(d=>d.buildingType===Tn.StorageSpot).reduce((d,f)=>{var g;return d+(((g=f.storedFood)==null?void 0:g.length)||0)},0);return{totalBushFood:o,totalStorageFood:u,consumptionRate:0}}function XN(e,t){const o=e.search.human.all(),l=e.entities.entities,s=new Map,u=(g,m=new Set)=>{if(s.has(g))return s.get(g);if(m.has(g))return g;m.add(g);const v=l[g];if(!v)return g;if(v.fatherId&&l[v.fatherId]){const y=u(v.fatherId,m);return s.set(g,y),y}return s.set(g,g),g},d=new Map;for(const g of o){const m=u(g.id);d.has(m)||d.set(m,[]),d.get(m).push(g)}const f=[];for(const[g,m]of d.entries()){const v=l[g];if(!v)continue;const y=v.isPlayer?"Player":`${v.gender==="male"?"Male":"Female"} Leader #${v.id}`;f.push({patriarchId:v.id,patriarchName:y,memberCount:m.length,members:m.map(A=>A.id)})}return f.sort((g,m)=>m.memberCount-g.memberCount),f.slice(0,t)}let Ys=[],Qn=[],b0=0;const KN=36,G0=200;function ZN(e,t,i,o){const l=jN(t),s=VN(t);if(t.time-b0>=KN){Ys.push({time:t.time,total:l.total,children:l.children,males:l.males,females:l.females,old:l.old});const L=s.totalBushFood+s.totalStorageFood;Qn.push({time:t.time,bushFood:s.totalBushFood,storageFood:s.totalStorageFood,totalFood:L}),Ys.length>G0&&(Ys=Ys.slice(-200)),Qn.length>G0&&(Qn=Qn.slice(-200)),b0=t.time}let u=0;if(Qn.length>=2){const L=Qn[Qn.length-1],D=Qn[Qn.length-2],H=L.time-D.time;H>0&&(u=(D.totalFood-L.totalFood)/H)}const d=400,f=Math.min(o*.9,700),g=i-d-10,m=je+un*2;e.save(),e.fillStyle="rgba(0, 0, 0, 0.9)",e.fillRect(g,m,d,f),e.strokeStyle="#444",e.lineWidth=2,e.strokeRect(g,m,d,f),e.fillStyle="white",e.font="12px monospace",e.textAlign="left";let v=m+20;const y=13,A=g+15;e.fillStyle="#66ccff",e.font="bold 14px monospace",e.fillText(" Tribe Debugger",A,v),v+=25,e.fillStyle="#66ccff",e.font="bold 13px monospace",e.fillText(" Population Over Time",A,v),v+=18,e.fillStyle="white",e.font="11px monospace",e.fillText(`Total: ${l.total}`,A,v),v+=y,e.fillStyle="#00ffff",e.fillText(`Children: ${l.children}`,A,v),v+=y,e.fillStyle="#4488ff",e.fillText(`Males: ${l.males}`,A,v),v+=y,e.fillStyle="#ff88ff",e.fillText(`Females: ${l.females}`,A,v),v+=y,e.fillStyle="#888888",e.fillText(`Old (${l.old})`,A,v),v+=20;const I=Ys.slice(-50);I.length>1&&(qN(e,A,v,I),v+=100),e.fillStyle="#66ccff",e.font="bold 13px monospace",e.fillText(" Food Metrics",A,v),v+=18;const E=s.totalBushFood+s.totalStorageFood;e.fillStyle="#ffff00",e.font="11px monospace",e.fillText(`Total Food: ${E}`,A,v),v+=y,e.fillStyle="#44ff44",e.fillText(`Bush Food: ${s.totalBushFood}`,A,v),v+=y,e.fillStyle="#ffaa44",e.fillText(`Storage Food: ${s.totalStorageFood}`,A,v),v+=y,e.fillStyle="#ff4444",e.fillText(`Consumption: ${u.toFixed(2)}/hour`,A,v),v+=20;const C=Qn.slice(-50);C.length>1&&(QN(e,A,v,C),v+=100),e.fillStyle="#66ccff",e.font="bold 13px monospace",e.fillText(" Top 5 Families",A,v),v+=18;const F=XN(t,5);e.fillStyle="white",e.font="11px monospace",F.length===0?(e.fillText("No families found",A,v),v+=y):F.forEach((L,D)=>{const b=`${D+1}. ${L.patriarchName} (${L.memberCount} members)`;e.fillText(b,A,v),v+=y}),v+=10,e.fillStyle="#888",e.font="10px monospace",e.textAlign="center",e.fillText("Press 'Shift+3' to toggle this debugger",g+d/2,m+f-10),e.restore()}function qN(e,t,i,o){if(o.length<2)return;const u=Math.max(...o.map(f=>Math.max(f.total,f.children,f.males,f.females,f.old)),10);e.strokeStyle="#333",e.lineWidth=1,e.strokeRect(t,i,350,80),[{data:o.map(f=>f.total),color:"#ffffff",label:"Total"},{data:o.map(f=>f.children),color:"#00ffff",label:"Children"},{data:o.map(f=>f.males),color:"#4488ff",label:"Males"},{data:o.map(f=>f.females),color:"#ff88ff",label:"Females"},{data:o.map(f=>f.old),color:"#888888",label:"Old"}].forEach(f=>{e.beginPath(),e.strokeStyle=f.color,e.lineWidth=2;for(let g=0;g<f.data.length;g++){const m=t+g/(f.data.length-1)*350,v=i+80-f.data[g]/u*80;g===0?e.moveTo(m,v):e.lineTo(m,v)}e.stroke()})}function QN(e,t,i,o){if(o.length<2)return;const u=Math.max(...o.map(f=>Math.max(f.totalFood,f.bushFood,f.storageFood)),10);e.strokeStyle="#333",e.lineWidth=1,e.strokeRect(t,i,350,80),[{data:o.map(f=>f.totalFood),color:"#ffff00",label:"Total"},{data:o.map(f=>f.bushFood),color:"#44ff44",label:"Bush"},{data:o.map(f=>f.storageFood),color:"#ffaa44",label:"Storage"}].forEach(f=>{e.beginPath(),e.strokeStyle=f.color,e.lineWidth=2;for(let g=0;g<f.data.length;g++){const m=t+g/(f.data.length-1)*350,v=i+80-f.data[g]/u*80;g===0?e.moveTo(m,v):e.lineTo(m,v)}e.stroke()})}function x0(e,t,i){e.save();const{x:o,y:l,width:s,height:u}=t.rect,d=zv;if(e.beginPath(),e.moveTo(o+d,l),e.lineTo(o+s-d,l),e.quadraticCurveTo(o+s,l,o+s,l+d),e.lineTo(o+s,l+u-d),e.quadraticCurveTo(o+s,l+u,o+s-d,l+u),e.lineTo(o+d,l+u),e.quadraticCurveTo(o,l+u,o,l+u-d),e.lineTo(o,l+d),e.quadraticCurveTo(o,l,o+d,l),e.closePath(),e.fillStyle=t.isDisabled?Wv:t.backgroundColor,e.fill(),t.activated){e.save();const f=(Math.sin(Date.now()/1e3*Xv)+1)/2;e.strokeStyle=Vv,e.lineWidth=2+f*2,e.globalAlpha=.7+f*.3,e.stroke(),e.restore()}if(t.lastActivated){const f=Date.now()-t.lastActivated;if(f<yu){const g=1-f/yu;e.fillStyle=jv,e.globalAlpha=g,e.fill(),e.globalAlpha=1}}i&&!t.isDisabled&&(e.fillStyle=oh,e.globalAlpha=.5,e.fill(),e.globalAlpha=1),e.fillStyle=t.isDisabled?Yv:t.textColor,t.icon?(e.font=`${u*.55}px "Press Start 2P", Arial`,e.textAlign="center",e.textBaseline="middle",e.fillText(t.icon,o+s/2,l+u/2),t.text&&(e.font=`${u*.18}px "Press Start 2P", Arial`,e.textAlign="right",e.textBaseline="bottom",e.fillText(t.text,o+s-4,l+u-2))):(e.font=`${un*1.5}px "Press Start 2P", Arial`,e.textAlign="center",e.textBaseline="middle",e.fillText(t.text,o+s/2,l+u/2)),e.restore()}function JN(e,t,i,o){e.save(),e.fillStyle="rgba(0, 0, 0, 0.6)",e.fillRect(0,0,i,o);const l=500,s=150,u=(i-l)/2,d=(o-s)/2;e.fillStyle=yn,e.font=`${un*1.1}px "Press Start 2P", Arial`,e.textAlign="center",e.textBaseline="middle",e.fillText("Are you sure you want to exit",i/2,d+s/3-10),e.fillText("to the main menu?",i/2,d+s/3+10);const f=gi*1.5,g=$v,m=d+s-g-je*2,v=20,y=f*2+v,A=u+(l-y)/2,I={id:"confirmExitYes",action:pe.ConfirmExitYes,rect:{x:A,y:m,width:f,height:g},text:"Yes",backgroundColor:Ki,textColor:yn,currentWidth:f},E=A+f+v,C={id:"confirmExitNo",action:pe.ConfirmExitNo,rect:{x:E,y:m,width:f,height:g},text:"No",backgroundColor:Ki,textColor:yn,currentWidth:f};t.uiButtons.push(I,C),x0(e,I,t.hoveredButtonId===I.id),x0(e,C,t.hoveredButtonId===C.id),e.restore()}function Eu(e,t,i,o,l,s=!1){var f;if(e.save(),e.clearRect(0,0,e.canvas.width,e.canvas.height),e.fillStyle="#2c5234",e.fillRect(0,0,e.canvas.width,e.canvas.height),e.translate(e.canvas.width/2-i.x,e.canvas.height/2-i.y),!s&&t.gameOver){e.restore(),qP(e,t);return}GN(e,t,t.debugPanel===At.General,i,l);const u=vt(t);if(u&&t.selectedBuildingType&&t.selectedBuildingType!=="removal"&&t.mousePosition){const g=Mf(t.mousePosition,i,l,t.mapDimensions),m=fh(g,t.selectedBuildingType,u.leaderId,t);bN(e,g,t.selectedBuildingType,m,t.mapDimensions)}const d=t.notifications.filter(g=>!g.isDismissed);for(const g of d){const m=(Math.sin(t.time*u_)+1)/2;e.globalAlpha=m*.5+.25,e.fillStyle=l_,g.targetArea&&e.fillRect(g.targetArea.x,g.targetArea.y,g.targetArea.width,g.targetArea.height),g.targetRadius&&(e.beginPath(),e.arc(g.targetRadius.x,g.targetRadius.y,g.targetRadius.radius,0,Math.PI*2),e.fill())}if(e.globalAlpha=1,uN(e,t),e.restore(),!s){e.fillStyle=pw,e.font=`${un}px "Press Start 2P", Arial`,e.shadowColor=mw,e.shadowBlur=vw,t.uiButtons=[];let g=null,m=null;if(u){const A=Ut(t,u),I=yi(A),E=((f=u.partnerIds)==null?void 0:f.map(F=>t.entities.entities[F]).filter(F=>F!==void 0))||[],C=xN(e,t,u,I,E,A);g=C.hungerBarRect,m=C.foodBarRect}const v=Uv(t,u==null?void 0:u.leaderId);XP(e,t,v,e.canvas.width,e.canvas.height);const{commandButtonsRect:y}=LP(e,t,e.canvas.width);if(e.shadowColor="transparent",e.shadowBlur=0,u&&(sN(e,t,i,e.canvas.width,e.canvas.height),o.length>0&&bP(e,o,u,i,e.canvas.width,e.canvas.height,t.mapDimensions)),t.tutorialState.activeUIHighlights.length>0){const{activeUIHighlights:A}=t.tutorialState;A.includes(Br.HUNGER_BAR)&&g&&sf(e,g,t.time),A.includes(Br.FOOD_BAR)&&m&&sf(e,m,t.time),A.includes(Br.COMMAND_BUTTONS)&&y&&sf(e,y,t.time)}if(t.tutorialState.isActive){const A=ZP(e,t,e.canvas.width,e.canvas.height);A&&t.uiButtons.push({id:"tutorial-dismiss",action:pe.DismissTutorial,rect:A,text:"",currentWidth:A.width,backgroundColor:"transparent",textColor:"transparent"})}switch(dN(e,t,e.canvas.width,e.canvas.height),t.debugPanel){case At.Ecosystem:WN(e,t,e.canvas.width,e.canvas.height);break;case At.Tribe:ZN(e,t,e.canvas.width,e.canvas.height);break;case At.Performance:hN(e,t,l.width);break}t.isPaused&&t.exitConfirmation!=="pending"&&UP(e),t.exitConfirmation==="pending"&&JN(e,t,e.canvas.width,e.canvas.height)}}const eD=En.div`
  position: relative;
  width: 100vw;
  height: 100vh;
  overflow: hidden;
`,tD=En.canvas`
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background-color: #2c5234;
`,nD=En.div`
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  text-align: center;
  z-index: 1;
  background: linear-gradient(to bottom, rgba(0, 0, 0, 0.7) 0%, rgba(0, 0, 0, 0) 50%, rgba(0, 0, 0, 0.7) 100%);
`,iD=En.h1`
  font-family: 'Press Start 2P', cursive;
  font-size: 4rem;
  color: #fff;
  text-shadow: 4px 4px 0px #ff0000;
  margin-bottom: 2rem;
`,$0=En.button`
  font-family: 'Press Start 2P', cursive;
  font-size: 1.5rem;
  padding: 1rem 2rem;
  color: #fff;
  background-color: #ff0000;
  border: 2px solid #fff;
  box-shadow: 4px 4px 0px #fff;
  cursor: pointer;
  transition: all 0.2s ease-in-out;

  &:hover {
    background-color: #fff;
    color: #ff0000;
    box-shadow: 4px 4px 0px #ff0000;
  }
`,rD=En.div`
  display: flex;
  flex-direction: column;
  gap: 1.5rem;
  align-items: center;
`,oD=En.div`
  position: absolute;
  bottom: 1rem;
  font-family: 'Press Start 2P', cursive;
  font-size: 0.8rem;
  color: #fff;
  text-shadow: 2px 2px 0px #000;
  a {
    color: #fff;
    text-decoration: none;
    &:hover {
      text-decoration: underline;
    }
  }
`,nu="intro-soundtrack",z0=()=>{const{setAppState:e,savedGameState:t,clearCurrentSave:i}=Yo(),o=Re.useRef(null),l=Re.useRef(null),s=Re.useRef(HR()),u=Re.useRef(),d=Re.useRef(s.current.viewportCenter),f=Re.useRef(),g=Re.useCallback(()=>{jd(nu,2),i(),e("game")},[e,i]),m=Re.useCallback(()=>{t&&(jd(nu,2),e("game"))},[e,t]);Re.useEffect(()=>{const A=I=>{(I.key==="Enter"||I.key===" ")&&(t?m():g())};return window.addEventListener("keydown",A),()=>{window.removeEventListener("keydown",A)}},[g,m,t]),Re.useEffect(()=>(lh(fe.SoundTrack1,{loop:!0,trackId:nu}),()=>{jd(nu,2)}),[]),Re.useEffect(()=>{const A=o.current;if(!A)return;l.current=A.getContext("2d");const I=()=>{A&&l.current&&(A.width=window.innerWidth,A.height=window.innerHeight,Eu(l.current,s.current,d.current,[],{width:A.width,height:A.height},!0))};return I(),window.addEventListener("resize",I),()=>window.removeEventListener("resize",I)},[]),Re.useEffect(()=>{const A=()=>{const E=Bv(s.current);if(E.length>0){const C=Math.floor(Math.random()*E.length);f.current=E[C].id}};A();const I=setInterval(A,cI);return()=>clearInterval(I)},[]);const[v,y]=Tv(A=>{var C,F;if(!l.current)return;if(u.current===void 0){u.current=A;return}const I=Math.min((A-u.current)/1e3,1);s.current=Uu(s.current,I);const E=f.current?s.current.entities.entities[f.current]:void 0;if(E){const{mapDimensions:L}=s.current,{width:D,height:H}=L;let b={...E.position};const U=b.x-d.current.x;Math.abs(U)>D/2&&(U>0?b.x-=D:b.x+=D);const $=b.y-d.current.y;Math.abs($)>H/2&&($>0?b.y-=H:b.y+=H);let ee=eh(d.current,b,Yf*I);ee={x:(ee.x%D+D)%D,y:(ee.y%H+H)%H},d.current=ee}Eu(l.current,s.current,d.current,[],{width:((C=o.current)==null?void 0:C.width)||800,height:((F=o.current)==null?void 0:F.height)||600},!0),u.current=A});return Re.useEffect(()=>(y(),v),[y,v]),Fe.jsxs(eD,{children:[Fe.jsx(tD,{ref:o}),Fe.jsxs(nD,{children:[Fe.jsx(iD,{children:"Tribe2"}),Fe.jsxs(rD,{children:[Fe.jsx($0,{onClick:g,children:"New Game"}),t&&Fe.jsx($0,{onClick:m,children:"Load Game"})]}),Fe.jsxs(oD,{children:["by"," ",Fe.jsx("a",{href:"https://github.com/gtanczyk",target:"_blank",rel:"noopener noreferrer",children:"gtanczyk"})]})]})]})};function sD(){console.log("Tribe game initialized with detailed 2D world state.");const e=BR();return e.ecosystem={preyGestationPeriod:Mr,preyProcreationCooldown:kr,predatorGestationPeriod:Fr,predatorProcreationCooldown:Lr,preyHungerIncreasePerHour:Ji,predatorHungerIncreasePerHour:er,berryBushSpreadChance:Si},e.debugPanel=At.None,e.performanceMetrics={currentBucket:{renderTime:0,worldUpdateTime:0,aiUpdateTime:0},history:[]},e}const aD=({canvasRef:e,ctxRef:t,gameStateRef:i,viewportCenterRef:o,playerActionHintsRef:l})=>(Re.useEffect(()=>{const s=e.current;if(!s)return;t.current=s.getContext("2d");const u=()=>{s&&t.current&&i.current&&(s.width=window.innerWidth,s.height=window.innerHeight,Eu(t.current,i.current,o.current,l.current,{width:s.width,height:s.height},!1))};return u(),window.addEventListener("resize",u),()=>window.removeEventListener("resize",u)},[]),Fe.jsx("canvas",{ref:e,style:{display:"block",background:"#2c5234"}})),lD=(e,t,i,o=!1)=>{let l;const s=sw(e,i);if(s){if(t.isAdult&&s.type==="berryBush"&&s.food.length>0)l={action:ae.AutopilotGather,targetEntityId:s.id};else if(t.isAdult&&s.type==="corpse"&&s.food.length>0)l={action:ae.AutopilotGather,targetEntityId:s.id};else if(s.type==="human"){const u=s;t.isAdult&&Xo(t,u,i)?l={action:ae.AutopilotAttack,targetEntityId:u.id}:Wr(t,u,i)?l={action:ae.AutopilotProcreate,targetEntityId:u.id}:t.food.length>0&&!u.isAdult&&(u.motherId===t.id||u.fatherId===t.id)&&(l={action:ae.AutopilotFeedChild,targetEntityId:u.id})}else if(s.type==="prey")l={action:ae.AutopilotAttack,targetEntityId:s.id};else if(s.type==="predator")l={action:ae.AutopilotAttack,targetEntityId:s.id};else if(s.type==="building"){const u=s;if(i.selectedBuildingType==="removal")l={action:ae.Removal,position:s.position};else if(u.buildingType==="storageSpot"){const d=u.ownerId===t.leaderId,f=u.storedFood!==void 0&&u.storedFood.length>0,g=u.storedFood!==void 0&&u.storageCapacity!==void 0&&u.storedFood.length<u.storageCapacity;if(o&&u.isConstructed&&f&&t.food.length<t.maxFood)if(d)l={action:ae.AutopilotRetrieve,targetEntityId:s.id};else{const m=t.leaderId?i.entities.entities[t.leaderId]:void 0;m&&m.diplomacy?m.diplomacy[u.ownerId]===pt.Hostile?l={action:ae.AutopilotGather,targetEntityId:s.id}:l={action:ae.AutopilotMove,position:e}:l={action:ae.AutopilotMove,position:e}}else d&&u.isConstructed?t.food.length>0&&g?l={action:ae.AutopilotDeposit,targetEntityId:s.id}:t.food.length<t.maxFood&&f?l={action:ae.AutopilotRetrieve,targetEntityId:s.id}:l={action:ae.AutopilotMove,position:e}:l={action:ae.AutopilotMove,position:e}}else u.buildingType==="plantingZone"&&t.food.filter(d=>d.type===Bn.Berry).length>=Hr&&!bn(e,i,br)?l={action:ae.AutopilotPlant,position:e}:l={action:ae.AutopilotMove,position:e}}}else t.food.filter(u=>u.type===Bn.Berry).length>=Hr&&(i.autopilotControls.isManuallyPlanting||lC(e,t,i))?l={action:ae.AutopilotPlant,position:e}:l={action:ae.AutopilotMove,position:e};return l},uD=(e,t)=>{if(e.isPaused)return;const i=vt(e);if(!i)return;if(e.selectedBuildingType&&e.selectedBuildingType!=="removal"){fh(t,e.selectedBuildingType,i.leaderId,e)&&(sS(t,e.selectedBuildingType,i.leaderId,e),e.selectedBuildingType=null);return}if(e.selectedBuildingType==="removal"){const l=Z_(t,e);l&&K_(l.id,e);return}const o=e.autopilotControls.hoveredAutopilotAction;e.autopilotControls.activeAutopilotAction=void 0,o?(e.autopilotControls.activeAutopilotAction=o,(o.action===ae.AutopilotMove||o.action===ae.AutopilotGather)&&(e.hasPlayerMovedEver=!0),o.action===ae.AutopilotPlant&&(e.hasPlayerPlantedBush=!0)):e.autopilotControls.activeAutopilotAction={action:ae.AutopilotMove,position:t},e.autopilotControls.isManuallyMoving=!1,e.autopilotControls.isManuallyPlanting=!1},cD=(e,t)=>{var u,d,f,g;const i=e.key.toLowerCase(),o=e.ctrlKey||e.metaKey;let l=!0,s=t;if(o){switch(i){case"s":Bf(t);break;default:l=!1;break}return{newState:s,handled:l}}switch(i){case"escape":const{autopilotControls:m}=t;m.activeAutopilotAction||m.isManuallyMoving||m.isManuallyPlanting||t.buildMenuOpen||t.selectedBuildingType?(m.activeAutopilotAction=void 0,m.isManuallyMoving=!1,m.isManuallyPlanting=!1,t.buildMenuOpen=!1,t.selectedBuildingType=null):s.exitConfirmation==="pending"?(s.exitConfirmation="inactive",s.isPaused=!1):(s.exitConfirmation="pending",s.isPaused=!0);break;case"m":t.isMuted=!t.isMuted,ea(t.masterVolume,t.isMuted);break;case"=":case"+":const v=Math.min(1,t.masterVolume+.1);t.masterVolume=parseFloat(v.toFixed(1)),ea(t.masterVolume,t.isMuted);break;case"-":const y=Math.max(0,t.masterVolume-.1);t.masterVolume=parseFloat(y.toFixed(1)),ea(t.masterVolume,t.isMuted);break;case"t":s=Uu(t,tS);break;case" ":case"p":t.isPaused=!t.isPaused;break;case"":case"`":s.debugPanel===At.General?(s.debugPanel=At.None,s.debugCharacterId=void 0):(s.debugPanel=At.General,s.debugCharacterId||(s.debugCharacterId=((u=vt(s))==null?void 0:u.id)??((d=Object.values(s.entities.entities).find(I=>I.type==="human"||I.type==="prey"||I.type==="predator"))==null?void 0:d.id)));break;case"!":if(e.shiftKey){if(s.debugPanel===At.Ecosystem){s.debugPanel=At.None;break}s.debugPanel=At.Ecosystem,s.debugCharacterId||(s.debugCharacterId=((f=vt(s))==null?void 0:f.id)??((g=Object.values(s.entities.entities).find(I=>I.type==="human"||I.type==="prey"||I.type==="predator"))==null?void 0:g.id))}else l=!1;break;case"@":if(e.shiftKey){if(s.debugPanel===At.Performance){s.debugPanel=At.None;break}s.debugPanel=At.Performance}else l=!1;break;case"tab":s.debugPanel=At.General;const A=Object.values(s.entities.entities).filter(I=>I.type==="human"||I.type==="prey"||I.type==="predator");if(A.length>0){const I=A.sort((L,D)=>{if(L.type==="human"&&L.isPlayer)return-1;if(D.type==="human"&&D.isPlayer)return 1;if(L.type!==D.type){const H={human:0,prey:1,predator:2},b=H[L.type]??999,U=H[D.type]??999;return b-U}return L.id-D.id}),E=s.debugCharacterId,F=((E?I.findIndex(L=>L.id===E):-1)+1)%I.length;s.debugCharacterId=I[F].id}else s.debugCharacterId=void 0;break;default:l=!1;break}return{newState:s,handled:l}},dD=(e,t,i,o,l)=>{const s={gameState:i};if(t&&["e","b","r","h"].includes(e)&&i.hasPlayerEnabledAutopilot++,i.buildMenuOpen){if(e==="1"){i.selectedBuildingType="storageSpot",Ie(s,fe.ButtonClick,o.position);return}else if(e==="2"){i.selectedBuildingType="plantingZone",Ie(s,fe.ButtonClick,o.position);return}else if(e==="3"){i.selectedBuildingType="removal",Ie(s,fe.ButtonClick,o.position);return}}if(e==="escape"&&i.selectedBuildingType){i.selectedBuildingType=null;return}if(e==="e"){if(t){i.autopilotControls.behaviors.gathering=!i.autopilotControls.behaviors.gathering;return}const u=Ne(o,i,"berryBush",mt,g=>g.food.length>0&&o.food.length<o.maxFood),d=Ne(o,i,"corpse",mt,g=>g.food.length>0&&o.food.length<o.maxFood);let f=null;u&&d?f=Y(o.position,u.position,i.mapDimensions.width,i.mapDimensions.height)<=Y(o.position,d.position,i.mapDimensions.width,i.mapDimensions.height)?u:d:f=u||d,f&&(o.activeAction="gathering",Ie(s,fe.Gather,o.position))}else if(e==="r"){if(t){i.autopilotControls.behaviors.procreation=!i.autopilotControls.behaviors.procreation;return}Ne(o,i,"human",mt,d=>Wr(o,d,i))&&(o.activeAction="procreating",Ie(s,fe.Procreate,o.position))}else if(e==="f")o.food.length>0&&(o.activeAction="eating",Ie(s,fe.Eat,o.position));else if(e==="h"){if(t){i.autopilotControls.behaviors.feedChildren=!i.autopilotControls.behaviors.feedChildren;return}const u=l.find(d=>d.type===ae.FeedChild);u&&u.targetEntity&&(o.activeAction="feeding",o.target=u.targetEntity.id)}else if(e==="arrowup"||e==="w")o.direction.y=-1,o.activeAction="moving",o.target=void 0,i.hasPlayerMovedEver=!0,i.autopilotControls.isManuallyMoving=!0,i.autopilotControls.activeAutopilotAction=void 0;else if(e==="arrowdown"||e==="s")o.direction.y=1,o.activeAction="moving",o.target=void 0,i.hasPlayerMovedEver=!0,i.autopilotControls.isManuallyMoving=!0,i.autopilotControls.activeAutopilotAction=void 0;else if(e==="arrowleft"||e==="a")o.direction.x=-1,o.activeAction="moving",o.target=void 0,i.hasPlayerMovedEver=!0,i.autopilotControls.isManuallyMoving=!0,i.autopilotControls.activeAutopilotAction=void 0;else if(e==="arrowright"||e==="d")o.direction.x=1,o.activeAction="moving",o.target=void 0,i.hasPlayerMovedEver=!0,i.autopilotControls.isManuallyMoving=!0,i.autopilotControls.activeAutopilotAction=void 0;else if(e==="q"){if(t){i.autopilotControls.behaviors.attack=!i.autopilotControls.behaviors.attack;return}const u=Ne(o,i,"human",ti,d=>Xo(o,d,i))??Ne(o,i,"predator",ti)??Ne(o,i,"prey",ti);u&&(o.activeAction="attacking",o.attackTargetId=u.id)}else if(e==="b"){if(t){i.autopilotControls.behaviors.planting=!i.autopilotControls.behaviors.planting;return}if(l.find(d=>d.type===ae.Plant)){const d=qE(o.position,i,50,Ef);d&&(o.activeAction="planting",o.target=d,i.hasPlayerPlantedBush=!0)}}else if(e==="x"){if(t){i.autopilotControls.behaviors.gathering=!i.autopilotControls.behaviors.gathering;return}const u=Ne(o,i,"building",In,d=>{const f=d;return f.buildingType==="storageSpot"&&f.ownerId===o.leaderId&&f.isConstructed&&f.storedFood!==void 0&&f.storageCapacity!==void 0&&f.storedFood.length<f.storageCapacity});u&&(o.activeAction="idle",o.target=u.id,Ie(s,fe.StorageDeposit,o.position))}else if(e==="z"){if(t){i.autopilotControls.behaviors.feedChildren=!i.autopilotControls.behaviors.feedChildren;return}const u=Ne(o,i,"building",In,d=>{const f=d;return f.buildingType==="storageSpot"&&f.ownerId===o.leaderId&&f.isConstructed&&f.storedFood!==void 0&&f.storedFood.length>0});u&&(o.activeAction="idle",o.target=u.id,Ie(s,fe.StorageRetrieve,o.position))}else e==="v"?(o.isCallingToAttack=!0,o.callToAttackEndTime=i.time+xo,Me(i,ce.CallToAttack,o.position,xo),Ie(s,fe.CallToAttack,o.position)):e==="c"?(o.isCallingToFollow=!0,o.callToFollowEndTime=i.time+ha,Me(i,ce.CallToFollow,o.position,ha),Ie(s,fe.CallToFollow,o.position)):e==="k"?ch(o,i):e==="l"&&(i.buildMenuOpen=!i.buildMenuOpen,Ie(s,fe.ButtonClick,o.position))},fD=(e,t,i,o)=>{e==="arrowup"||e==="w"||e==="arrowdown"||e==="s"?t.direction.y=0:(e==="arrowleft"||e==="a"||e==="arrowright"||e==="d")&&(t.direction.x=0),!o.current.has("arrowup")&&!o.current.has("arrowdown")&&!o.current.has("arrowleft")&&!o.current.has("arrowright")&&!o.current.has("w")&&!o.current.has("a")&&!o.current.has("s")&&!o.current.has("d")&&(t.activeAction==="moving"&&(t.activeAction="idle"),i.autopilotControls.isManuallyMoving=!1),!o.current.has("e")&&t.activeAction==="gathering"&&(t.activeAction="idle"),!o.current.has("f")&&t.activeAction==="eating"&&(t.activeAction="idle"),!o.current.has("r")&&t.activeAction==="procreating"&&(t.activeAction="idle"),!o.current.has("h")&&t.activeAction==="feeding"&&(t.activeAction="idle")},hD=(e,t,i)=>{let l=vt(e);if(e.debugCharacterId){const s=e.entities.entities[e.debugCharacterId];s&&"position"in s&&(l=s)}if(l){const{mapDimensions:s}=e,{width:u,height:d}=s;let f={...l.position};const g=f.x-t.x;Math.abs(g)>u/2&&(g>0?f.x-=u:f.x+=u);const m=f.y-t.y;Math.abs(m)>d/2&&(m>0?f.y-=d:f.y+=d);let v=eh(t,f,Yf*i);return v={x:(v.x%u+u)%u,y:(v.y%d+d)%d},v}return e.viewportCenter};function gD(e,t){const{width:i,height:o}=e.mapDimensions;e.viewportCenter={x:(t.x%i+i)%i,y:(t.y%o+o)%o}}const pD=(e,t,i,o)=>{const l={gameState:i},s=vt(i);s&&Ie(l,fe.ButtonClick,s.position);const u=i.uiButtons.find(f=>f.id===e.id);u&&(u.lastActivated=Date.now()),t&&[pe.CommandGather,pe.CommandPlant,pe.ToggleProcreationBehavior].includes(e.action)&&i.hasPlayerEnabledAutopilot++;const{behaviors:d}=i.autopilotControls;switch(e.action){case pe.ReturnToIntro:i.exitConfirmation="pending",i.isPaused=!0;break;case pe.ConfirmExitYes:o(),i.exitConfirmation="inactive";break;case pe.ConfirmExitNo:i.exitConfirmation="inactive",i.isPaused=!1;break;case pe.ToggleMute:i.isMuted=!i.isMuted,ea(i.masterVolume,i.isMuted);break;case pe.TogglePause:i.isPaused=!i.isPaused;break;case pe.FastForward:return Uu(i,tS);case pe.DismissTutorial:i.tutorialState.isActive=!1;break;case pe.CommandEat:s&&s.food.length>0&&(s.activeAction="eating");break;case pe.CommandGather:t?d.gathering=!d.gathering:s&&(s.activeAction="gathering");break;case pe.CommandPlant:t?d.planting=!d.planting:s&&(i.autopilotControls.isManuallyPlanting=!0);break;case pe.ToggleProcreationBehavior:d.procreation=!d.procreation;break;case pe.ToggleAttackBehavior:d.attack=!d.attack;break;case pe.ToggleFeedChildBehavior:d.feedChildren=!d.feedChildren;break;case pe.ToggleAutopilotFollowLeaderBehavior:d.followLeader=!d.followLeader;break;case pe.CommandCallToAttack:s&&s.leaderId===s.id&&(s.isCallingToAttack=!0,s.callToAttackEndTime=i.time+xo,Me(i,ce.CallToAttack,s.position,xo),Ie(l,fe.CallToAttack,s.position));break;case pe.CommandFollowMe:t?d.followLeader=!d.followLeader:s&&s.leaderId===s.id&&(s.isCallingToFollow=!0,s.callToFollowEndTime=i.time+ha,Me(i,ce.CallToFollow,s.position,ha),Ie(l,fe.CallToFollow,s.position));break;case pe.CommandTribeSplit:s&&ch(s,i);break;case pe.CommandBuild:i.buildMenuOpen=!i.buildMenuOpen;break;case pe.SelectStorageSpot:i.selectedBuildingType="storageSpot";break;case pe.SelectPlantingZone:i.selectedBuildingType="plantingZone";break;case pe.SelectRemovalTool:i.selectedBuildingType="removal";break;case pe.ToggleDiplomacy:if(s&&s.leaderId&&e.targetTribeId){const f=s.leaderId,g=e.targetTribeId,m=i.entities.entities[g],v=s.diplomacy,y=m==null?void 0:m.diplomacy;if(v&&y){const I=(v[g]||pt.Friendly)===pt.Friendly?pt.Hostile:pt.Friendly;v[g]=I,y[f]=I}}break}return i};function mD(e,t,i){if(!e.notificationButtonRects)return!1;const o=vt(e);for(const[l,s]of Object.entries(e.notificationButtonRects.dismiss))if(t>=s.x&&t<=s.x+s.width&&i>=s.y&&i<=s.y+s.height)return w_(e,l),o&&Ie({gameState:e},fe.ButtonClick,o.position),!0;for(const[l,s]of Object.entries(e.notificationButtonRects.view))if(t>=s.x&&t<=s.x+s.width&&i>=s.y&&i<=s.y+s.height){const u=e.notifications.find(d=>d.id===l);if(u){let d=u.targetPosition;if(!d&&u.targetEntityIds&&u.targetEntityIds.length>0){const f=e.entities.entities[u.targetEntityIds[0]];f&&(d=f.position)}return d&&gD(e,d),o&&Ie({gameState:e},fe.ButtonClick,o.position),u.highlightedEntityIds&&(u.renderHighlights=!u.renderHighlights),!0}}return!1}const vD=({isActive:e,gameStateRef:t,canvasRef:i,viewportCenterRef:o,playerActionHintsRef:l,keysPressed:s,returnToIntro:u})=>(Re.useEffect(()=>{const d=f=>{if(!e()||t.current.gameOver||!i.current||!f.target||f.target!==i.current)return;const g=i.current.getBoundingClientRect(),m=f.clientX-g.left,v=f.clientY-g.top;if(mD(t.current,m,v))return;const A=t.current.uiButtons.find(E=>m>=E.rect.x&&m<=E.rect.x+E.rect.width&&v>=E.rect.y&&v<=E.rect.y+E.rect.height);if(A){t.current=pD(A,f.shiftKey,t.current,u);return}const I=Mf({x:m,y:v},o.current,{width:i.current.width,height:i.current.height},t.current.mapDimensions);uD(t.current,I)};return window.addEventListener("mousedown",d),()=>{window.removeEventListener("mousedown",d)}},[e,i,t,o,u]),Re.useEffect(()=>{const d=f=>{if(!e()||!i.current)return;const g=i.current.getBoundingClientRect(),m=f.clientX-g.left,v=f.clientY-g.top;t.current.mousePosition={x:m,y:v};let y;if(t.current.notificationButtonRects){for(const[I,E]of Object.entries(t.current.notificationButtonRects.dismiss))if(m>=E.x&&m<=E.x+E.width&&v>=E.y&&v<=E.y+E.height){y=`notification-dismiss-${I}`;break}if(!y){for(const[I,E]of Object.entries(t.current.notificationButtonRects.view))if(m>=E.x&&m<=E.x+E.width&&v>=E.y&&v<=E.y+E.height){y=`notification-view-${I}`;break}}}if(!y)for(let I=t.current.uiButtons.length-1;I>=0;I--){const E=t.current.uiButtons[I];if(m>=E.rect.x&&m<=E.rect.x+E.rect.width&&v>=E.rect.y&&v<=E.rect.y+E.rect.height){y=E.id;break}}if(t.current.hoveredButtonId=y,y){t.current.autopilotControls.hoveredAutopilotAction=void 0;return}const A=vt(t.current);if(A){const I=Mf({x:m,y:v},o.current,{width:i.current.width,height:i.current.height},t.current.mapDimensions);t.current.autopilotControls.hoveredAutopilotAction=lD(I,A,t.current,f.shiftKey)}else t.current.autopilotControls.hoveredAutopilotAction=void 0};return window.addEventListener("mousemove",d),()=>{window.removeEventListener("mousemove",d)}},[e,i,t,o]),Re.useEffect(()=>{const d=g=>{if(!e()||t.current.gameOver)return;const m=g.key.toLowerCase();(m===" "||m==="p"||m==="tab"||(g.ctrlKey||g.metaKey)&&(m==="s"||m==="a"))&&g.preventDefault();const v=cD(g,t.current);if(t.current=v.newState,v.handled)return;const y=vt(t.current);y&&(s.current.add(m),dD(m,g.shiftKey,t.current,y,l.current))},f=g=>{if(!e()||t.current.gameOver)return;const m=g.key.toLowerCase();s.current.delete(m);const v=vt(t.current);v&&fD(m,v,t.current,s)};return window.addEventListener("keydown",d),window.addEventListener("keyup",f),()=>{window.removeEventListener("keydown",d),window.removeEventListener("keyup",f)}},[e,t,l,s,u]),null),SD=({gameStateRef:e,ctxRef:t,debugPanelTypeRef:i,viewportCenterRef:o,playerActionHintsRef:l,keysPressed:s,canvasRef:u,setAppState:d,appState:f})=>{const g=Re.useRef(),{returnToIntro:m}=Yo(),[v,y,A]=Tv(I=>{var H,b;if(!t.current||!g.current){g.current=I;return}const E=Math.min(I-g.current,1e3)/1e3,{performanceMetrics:C}=e.current;C.currentBucket={renderTime:0,worldUpdateTime:0,aiUpdateTime:0};const F=performance.now();e.current=Uu(e.current,E),C.currentBucket.worldUpdateTime=performance.now()-F;const L=vt(e.current);L?l.current=dh(e.current,L):l.current=[],o.current=hD(e.current,o.current,E);const D=performance.now();Eu(t.current,e.current,o.current,l.current,{width:((H=u.current)==null?void 0:H.width)||800,height:((b=u.current)==null?void 0:b.height)||600},!1),C.currentBucket.renderTime=performance.now()-D,C.history.push({bucketTime:e.current.time,...C.currentBucket}),C.history.length>dI&&C.history.shift(),g.current=I,e.current.gameOver&&f!=="gameOver"&&(lh(fe.GameOver,{masterVolume:e.current.masterVolume,isMuted:e.current.isMuted}),d("gameOver",{generations:e.current.generationCount,cause:e.current.causeOfGameOver||"Unknown"}))});return Re.useEffect(()=>(y(),v),[y,v]),Fe.jsx(vD,{isActive:A,gameStateRef:e,canvasRef:u,viewportCenterRef:o,playerActionHintsRef:l,debugPanelTypeRef:i,keysPressed:s,returnToIntro:m})},W0=()=>{const{savedGameState:e,contextReady:t}=Yo(),[i,o]=Re.useState(null);return Re.useEffect(()=>{t&&(e?(console.log("Loading saved game state..."),o(e)):(console.log("Initializing new game state..."),o(sD())))},[t,e]),!t||!i?Fe.jsx("div",{children:"Loading..."}):Fe.jsx(yD,{initialState:i})},yD=({initialState:e})=>{const t=Re.useRef(null),i=Re.useRef(null),o=Re.useRef(e),l=Re.useRef(new Set),s=Re.useRef(e.debugPanel),u=Re.useRef(e.viewportCenter),d=Re.useRef([]),{appState:f,setAppState:g}=Yo();return Fe.jsxs(Fe.Fragment,{children:[Fe.jsx(aD,{canvasRef:t,ctxRef:i,gameStateRef:o,debugPanelTypeRef:s,viewportCenterRef:u,playerActionHintsRef:d}),Fe.jsx(SD,{gameStateRef:o,ctxRef:i,debugPanelTypeRef:s,viewportCenterRef:u,playerActionHintsRef:d,keysPressed:l,canvasRef:t,setAppState:g,appState:f})]})},TD=En.div`
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  text-align: center;
  background-color: rgba(0, 0, 0, 0.75); // Semi-transparent overlay
  color: #fff;
  padding: 20px;
  z-index: 10; // Ensure it's on top
`,AD=En.h1`
  font-family: 'Press Start 2P', cursive;
  font-size: 4rem;
  color: #ff4136; // Red for emphasis
  text-shadow: 4px 4px 0px #000;
  margin-bottom: 1.5rem;
`,iu=En.p`
  font-family: 'Press Start 2P', cursive;
  font-size: 1.2rem;
  margin: 0.5em 0;
  color: #fff;
  text-shadow: 2px 2px 0px #000;
`,ID=En.button`
  font-family: 'Press Start 2P', cursive;
  font-size: 1rem;
  padding: 1rem 2rem;
  margin-top: 2em;
  color: #fff;
  background-color: #ff4136; // Red button
  border: 2px solid #fff;
  box-shadow: 4px 4px 0px #fff;
  cursor: pointer;
  transition: all 0.2s ease-in-out;
  text-transform: uppercase;

  &:hover {
    background-color: #fff;
    color: #ff4136;
    box-shadow: 4px 4px 0px #ff4136;
  }
`,ED=()=>{const{setAppState:e,gameOverDetails:t}=Yo(),i=()=>{e("intro")};return Fe.jsxs(TD,{children:[Fe.jsx(AD,{children:"Game Over"}),Fe.jsx(iu,{children:"Your tribe's lineage has ended."}),t&&Fe.jsxs(Fe.Fragment,{children:[Fe.jsxs(iu,{children:["Generations Survived: ",t.generations]}),Fe.jsxs(iu,{children:["Cause of Extinction: ",t.cause]})]}),!t&&Fe.jsx(iu,{children:"Game details are unavailable."}),Fe.jsx(ID,{onClick:i,children:"Return to Menu"})]})},wD=rI`
  /* CSS Reset */
  *, *::before, *::after {
    box-sizing: border-box;
  }

  body {
    margin: 0;
    padding: 0;
    font-family: 'Press Start 2P', 'Arial', sans-serif;
    background-color: #121212;
    color: #f0f0f0;
    line-height: 1.6;
  }

  /* Additional global styles */
  h1, h2, h3, h4, h5, h6 {
    margin-top: 0;
  }

  button {
    cursor: pointer;
    font-family: inherit;
  }

  /* Prevent overflow issues */
  html, body {
    height: 100%;
    overflow-x: hidden;
  }

  /* Root element for React app */
  #root {
    height: 100%;
  }
`;function _D(e,t){Re.useEffect(()=>{const i=()=>{const o=document.location.hash==="#game"?"game":"intro";t(o)};return window.addEventListener("hashchange",i),i(),()=>{window.removeEventListener("hashchange",i)}},[]),Re.useEffect(()=>{e==="game"?document.location.hash="#game":e==="intro"&&(document.location.hash="")},[e])}const CD=()=>{const{appState:e,setAppState:t}=Yo();_D(e,t);const i=()=>{switch(e){case"intro":return Fe.jsx(z0,{});case"game":return Fe.jsx(W0,{});case"gameOver":return Fe.jsxs(Fe.Fragment,{children:[Fe.jsx(W0,{}),Fe.jsx(ED,{})]});default:return Fe.jsx(z0,{})}};return Fe.jsxs(Fe.Fragment,{children:[Fe.jsx(wD,{}),i()]})},Y0=document.getElementById("root");Y0?B_().then(()=>{jT.createRoot(Y0).render(Fe.jsx(ei.StrictMode,{children:Fe.jsx(iA,{initialAppState:document.location.hash==="#game"?"game":"intro",children:Fe.jsx(CD,{})})}))}):console.error("Failed to find the root element");
