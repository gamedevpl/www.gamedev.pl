var WS=Object.defineProperty;var YS=(e,n,r)=>n in e?WS(e,n,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[n]=r;var Ne=(e,n,r)=>YS(e,typeof n!="symbol"?n+"":n,r);(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const l of document.querySelectorAll('link[rel="modulepreload"]'))o(l);new MutationObserver(l=>{for(const a of l)if(a.type==="childList")for(const c of a.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&o(c)}).observe(document,{childList:!0,subtree:!0});function r(l){const a={};return l.integrity&&(a.integrity=l.integrity),l.referrerPolicy&&(a.referrerPolicy=l.referrerPolicy),l.crossOrigin==="use-credentials"?a.credentials="include":l.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function o(l){if(l.ep)return;l.ep=!0;const a=r(l);fetch(l.href,a)}})();function a0(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var sd={exports:{}},ms={},ad={exports:{}},Le={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Bg;function jS(){if(Bg)return Le;Bg=1;var e=Symbol.for("react.element"),n=Symbol.for("react.portal"),r=Symbol.for("react.fragment"),o=Symbol.for("react.strict_mode"),l=Symbol.for("react.profiler"),a=Symbol.for("react.provider"),c=Symbol.for("react.context"),d=Symbol.for("react.forward_ref"),h=Symbol.for("react.suspense"),g=Symbol.for("react.memo"),m=Symbol.for("react.lazy"),y=Symbol.iterator;function S(R){return R===null||typeof R!="object"?null:(R=y&&R[y]||R["@@iterator"],typeof R=="function"?R:null)}var E={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},I=Object.assign,T={};function C(R,F,X){this.props=R,this.context=F,this.refs=T,this.updater=X||E}C.prototype.isReactComponent={},C.prototype.setState=function(R,F){if(typeof R!="object"&&typeof R!="function"&&R!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,R,F,"setState")},C.prototype.forceUpdate=function(R){this.updater.enqueueForceUpdate(this,R,"forceUpdate")};function U(){}U.prototype=C.prototype;function H(R,F,X){this.props=R,this.context=F,this.refs=T,this.updater=X||E}var O=H.prototype=new U;O.constructor=H,I(O,C.prototype),O.isPureReactComponent=!0;var B=Array.isArray,x=Object.prototype.hasOwnProperty,L={current:null},j={key:!0,ref:!0,__self:!0,__source:!0};function ie(R,F,X){var te,pe={},se=null,Se=null;if(F!=null)for(te in F.ref!==void 0&&(Se=F.ref),F.key!==void 0&&(se=""+F.key),F)x.call(F,te)&&!j.hasOwnProperty(te)&&(pe[te]=F[te]);var ve=arguments.length-2;if(ve===1)pe.children=X;else if(1<ve){for(var q=Array(ve),ne=0;ne<ve;ne++)q[ne]=arguments[ne+2];pe.children=q}if(R&&R.defaultProps)for(te in ve=R.defaultProps,ve)pe[te]===void 0&&(pe[te]=ve[te]);return{$$typeof:e,type:R,key:se,ref:Se,props:pe,_owner:L.current}}function _e(R,F){return{$$typeof:e,type:R.type,key:F,ref:R.ref,props:R.props,_owner:R._owner}}function Ce(R){return typeof R=="object"&&R!==null&&R.$$typeof===e}function xe(R){var F={"=":"=0",":":"=2"};return"$"+R.replace(/[=:]/g,function(X){return F[X]})}var Me=/\/+/g;function we(R,F){return typeof R=="object"&&R!==null&&R.key!=null?xe(""+R.key):F.toString(36)}function ce(R,F,X,te,pe){var se=typeof R;(se==="undefined"||se==="boolean")&&(R=null);var Se=!1;if(R===null)Se=!0;else switch(se){case"string":case"number":Se=!0;break;case"object":switch(R.$$typeof){case e:case n:Se=!0}}if(Se)return Se=R,pe=pe(Se),R=te===""?"."+we(Se,0):te,B(pe)?(X="",R!=null&&(X=R.replace(Me,"$&/")+"/"),ce(pe,F,X,"",function(ne){return ne})):pe!=null&&(Ce(pe)&&(pe=_e(pe,X+(!pe.key||Se&&Se.key===pe.key?"":(""+pe.key).replace(Me,"$&/")+"/")+R)),F.push(pe)),1;if(Se=0,te=te===""?".":te+":",B(R))for(var ve=0;ve<R.length;ve++){se=R[ve];var q=te+we(se,ve);Se+=ce(se,F,X,q,pe)}else if(q=S(R),typeof q=="function")for(R=q.call(R),ve=0;!(se=R.next()).done;)se=se.value,q=te+we(se,ve++),Se+=ce(se,F,X,q,pe);else if(se==="object")throw F=String(R),Error("Objects are not valid as a React child (found: "+(F==="[object Object]"?"object with keys {"+Object.keys(R).join(", ")+"}":F)+"). If you meant to render a collection of children, use an array instead.");return Se}function He(R,F,X){if(R==null)return R;var te=[],pe=0;return ce(R,te,"","",function(se){return F.call(X,se,pe++)}),te}function ye(R){if(R._status===-1){var F=R._result;F=F(),F.then(function(X){(R._status===0||R._status===-1)&&(R._status=1,R._result=X)},function(X){(R._status===0||R._status===-1)&&(R._status=2,R._result=X)}),R._status===-1&&(R._status=0,R._result=F)}if(R._status===1)return R._result.default;throw R._result}var ee={current:null},z={transition:null},V={ReactCurrentDispatcher:ee,ReactCurrentBatchConfig:z,ReactCurrentOwner:L};function W(){throw Error("act(...) is not supported in production builds of React.")}return Le.Children={map:He,forEach:function(R,F,X){He(R,function(){F.apply(this,arguments)},X)},count:function(R){var F=0;return He(R,function(){F++}),F},toArray:function(R){return He(R,function(F){return F})||[]},only:function(R){if(!Ce(R))throw Error("React.Children.only expected to receive a single React element child.");return R}},Le.Component=C,Le.Fragment=r,Le.Profiler=l,Le.PureComponent=H,Le.StrictMode=o,Le.Suspense=h,Le.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=V,Le.act=W,Le.cloneElement=function(R,F,X){if(R==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+R+".");var te=I({},R.props),pe=R.key,se=R.ref,Se=R._owner;if(F!=null){if(F.ref!==void 0&&(se=F.ref,Se=L.current),F.key!==void 0&&(pe=""+F.key),R.type&&R.type.defaultProps)var ve=R.type.defaultProps;for(q in F)x.call(F,q)&&!j.hasOwnProperty(q)&&(te[q]=F[q]===void 0&&ve!==void 0?ve[q]:F[q])}var q=arguments.length-2;if(q===1)te.children=X;else if(1<q){ve=Array(q);for(var ne=0;ne<q;ne++)ve[ne]=arguments[ne+2];te.children=ve}return{$$typeof:e,type:R.type,key:pe,ref:se,props:te,_owner:Se}},Le.createContext=function(R){return R={$$typeof:c,_currentValue:R,_currentValue2:R,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},R.Provider={$$typeof:a,_context:R},R.Consumer=R},Le.createElement=ie,Le.createFactory=function(R){var F=ie.bind(null,R);return F.type=R,F},Le.createRef=function(){return{current:null}},Le.forwardRef=function(R){return{$$typeof:d,render:R}},Le.isValidElement=Ce,Le.lazy=function(R){return{$$typeof:m,_payload:{_status:-1,_result:R},_init:ye}},Le.memo=function(R,F){return{$$typeof:g,type:R,compare:F===void 0?null:F}},Le.startTransition=function(R){var F=z.transition;z.transition={};try{R()}finally{z.transition=F}},Le.unstable_act=W,Le.useCallback=function(R,F){return ee.current.useCallback(R,F)},Le.useContext=function(R){return ee.current.useContext(R)},Le.useDebugValue=function(){},Le.useDeferredValue=function(R){return ee.current.useDeferredValue(R)},Le.useEffect=function(R,F){return ee.current.useEffect(R,F)},Le.useId=function(){return ee.current.useId()},Le.useImperativeHandle=function(R,F,X){return ee.current.useImperativeHandle(R,F,X)},Le.useInsertionEffect=function(R,F){return ee.current.useInsertionEffect(R,F)},Le.useLayoutEffect=function(R,F){return ee.current.useLayoutEffect(R,F)},Le.useMemo=function(R,F){return ee.current.useMemo(R,F)},Le.useReducer=function(R,F,X){return ee.current.useReducer(R,F,X)},Le.useRef=function(R){return ee.current.useRef(R)},Le.useState=function(R){return ee.current.useState(R)},Le.useSyncExternalStore=function(R,F,X){return ee.current.useSyncExternalStore(R,F,X)},Le.useTransition=function(){return ee.current.useTransition()},Le.version="18.3.1",Le}var Gg;function df(){return Gg||(Gg=1,ad.exports=jS()),ad.exports}/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var bg;function VS(){if(bg)return ms;bg=1;var e=df(),n=Symbol.for("react.element"),r=Symbol.for("react.fragment"),o=Object.prototype.hasOwnProperty,l=e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,a={key:!0,ref:!0,__self:!0,__source:!0};function c(d,h,g){var m,y={},S=null,E=null;g!==void 0&&(S=""+g),h.key!==void 0&&(S=""+h.key),h.ref!==void 0&&(E=h.ref);for(m in h)o.call(h,m)&&!a.hasOwnProperty(m)&&(y[m]=h[m]);if(d&&d.defaultProps)for(m in h=d.defaultProps,h)y[m]===void 0&&(y[m]=h[m]);return{$$typeof:n,type:d,key:S,ref:E,props:y,_owner:l.current}}return ms.Fragment=r,ms.jsx=c,ms.jsxs=c,ms}var xg;function XS(){return xg||(xg=1,sd.exports=VS()),sd.exports}var De=XS(),Ie=df();const Wn=a0(Ie);var dl={},ld={exports:{}},Xt={},ud={exports:{}},cd={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var $g;function KS(){return $g||($g=1,function(e){function n(z,V){var W=z.length;z.push(V);e:for(;0<W;){var R=W-1>>>1,F=z[R];if(0<l(F,V))z[R]=V,z[W]=F,W=R;else break e}}function r(z){return z.length===0?null:z[0]}function o(z){if(z.length===0)return null;var V=z[0],W=z.pop();if(W!==V){z[0]=W;e:for(var R=0,F=z.length,X=F>>>1;R<X;){var te=2*(R+1)-1,pe=z[te],se=te+1,Se=z[se];if(0>l(pe,W))se<F&&0>l(Se,pe)?(z[R]=Se,z[se]=W,R=se):(z[R]=pe,z[te]=W,R=te);else if(se<F&&0>l(Se,W))z[R]=Se,z[se]=W,R=se;else break e}}return V}function l(z,V){var W=z.sortIndex-V.sortIndex;return W!==0?W:z.id-V.id}if(typeof performance=="object"&&typeof performance.now=="function"){var a=performance;e.unstable_now=function(){return a.now()}}else{var c=Date,d=c.now();e.unstable_now=function(){return c.now()-d}}var h=[],g=[],m=1,y=null,S=3,E=!1,I=!1,T=!1,C=typeof setTimeout=="function"?setTimeout:null,U=typeof clearTimeout=="function"?clearTimeout:null,H=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function O(z){for(var V=r(g);V!==null;){if(V.callback===null)o(g);else if(V.startTime<=z)o(g),V.sortIndex=V.expirationTime,n(h,V);else break;V=r(g)}}function B(z){if(T=!1,O(z),!I)if(r(h)!==null)I=!0,ye(x);else{var V=r(g);V!==null&&ee(B,V.startTime-z)}}function x(z,V){I=!1,T&&(T=!1,U(ie),ie=-1),E=!0;var W=S;try{for(O(V),y=r(h);y!==null&&(!(y.expirationTime>V)||z&&!xe());){var R=y.callback;if(typeof R=="function"){y.callback=null,S=y.priorityLevel;var F=R(y.expirationTime<=V);V=e.unstable_now(),typeof F=="function"?y.callback=F:y===r(h)&&o(h),O(V)}else o(h);y=r(h)}if(y!==null)var X=!0;else{var te=r(g);te!==null&&ee(B,te.startTime-V),X=!1}return X}finally{y=null,S=W,E=!1}}var L=!1,j=null,ie=-1,_e=5,Ce=-1;function xe(){return!(e.unstable_now()-Ce<_e)}function Me(){if(j!==null){var z=e.unstable_now();Ce=z;var V=!0;try{V=j(!0,z)}finally{V?we():(L=!1,j=null)}}else L=!1}var we;if(typeof H=="function")we=function(){H(Me)};else if(typeof MessageChannel<"u"){var ce=new MessageChannel,He=ce.port2;ce.port1.onmessage=Me,we=function(){He.postMessage(null)}}else we=function(){C(Me,0)};function ye(z){j=z,L||(L=!0,we())}function ee(z,V){ie=C(function(){z(e.unstable_now())},V)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(z){z.callback=null},e.unstable_continueExecution=function(){I||E||(I=!0,ye(x))},e.unstable_forceFrameRate=function(z){0>z||125<z?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):_e=0<z?Math.floor(1e3/z):5},e.unstable_getCurrentPriorityLevel=function(){return S},e.unstable_getFirstCallbackNode=function(){return r(h)},e.unstable_next=function(z){switch(S){case 1:case 2:case 3:var V=3;break;default:V=S}var W=S;S=V;try{return z()}finally{S=W}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(z,V){switch(z){case 1:case 2:case 3:case 4:case 5:break;default:z=3}var W=S;S=z;try{return V()}finally{S=W}},e.unstable_scheduleCallback=function(z,V,W){var R=e.unstable_now();switch(typeof W=="object"&&W!==null?(W=W.delay,W=typeof W=="number"&&0<W?R+W:R):W=R,z){case 1:var F=-1;break;case 2:F=250;break;case 5:F=1073741823;break;case 4:F=1e4;break;default:F=5e3}return F=W+F,z={id:m++,callback:V,priorityLevel:z,startTime:W,expirationTime:F,sortIndex:-1},W>R?(z.sortIndex=W,n(g,z),r(h)===null&&z===r(g)&&(T?(U(ie),ie=-1):T=!0,ee(B,W-R))):(z.sortIndex=F,n(h,z),I||E||(I=!0,ye(x))),z},e.unstable_shouldYield=xe,e.unstable_wrapCallback=function(z){var V=S;return function(){var W=S;S=V;try{return z.apply(this,arguments)}finally{S=W}}}}(cd)),cd}var zg;function qS(){return zg||(zg=1,ud.exports=KS()),ud.exports}/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Wg;function QS(){if(Wg)return Xt;Wg=1;var e=df(),n=qS();function r(t){for(var i="https://reactjs.org/docs/error-decoder.html?invariant="+t,s=1;s<arguments.length;s++)i+="&args[]="+encodeURIComponent(arguments[s]);return"Minified React error #"+t+"; visit "+i+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var o=new Set,l={};function a(t,i){c(t,i),c(t+"Capture",i)}function c(t,i){for(l[t]=i,t=0;t<i.length;t++)o.add(i[t])}var d=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),h=Object.prototype.hasOwnProperty,g=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,m={},y={};function S(t){return h.call(y,t)?!0:h.call(m,t)?!1:g.test(t)?y[t]=!0:(m[t]=!0,!1)}function E(t,i,s,u){if(s!==null&&s.type===0)return!1;switch(typeof i){case"function":case"symbol":return!0;case"boolean":return u?!1:s!==null?!s.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function I(t,i,s,u){if(i===null||typeof i>"u"||E(t,i,s,u))return!0;if(u)return!1;if(s!==null)switch(s.type){case 3:return!i;case 4:return i===!1;case 5:return isNaN(i);case 6:return isNaN(i)||1>i}return!1}function T(t,i,s,u,f,p,v){this.acceptsBooleans=i===2||i===3||i===4,this.attributeName=u,this.attributeNamespace=f,this.mustUseProperty=s,this.propertyName=t,this.type=i,this.sanitizeURL=p,this.removeEmptyString=v}var C={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){C[t]=new T(t,0,!1,t,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var i=t[0];C[i]=new T(i,1,!1,t[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(t){C[t]=new T(t,2,!1,t.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){C[t]=new T(t,2,!1,t,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){C[t]=new T(t,3,!1,t.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(t){C[t]=new T(t,3,!0,t,null,!1,!1)}),["capture","download"].forEach(function(t){C[t]=new T(t,4,!1,t,null,!1,!1)}),["cols","rows","size","span"].forEach(function(t){C[t]=new T(t,6,!1,t,null,!1,!1)}),["rowSpan","start"].forEach(function(t){C[t]=new T(t,5,!1,t.toLowerCase(),null,!1,!1)});var U=/[\-:]([a-z])/g;function H(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var i=t.replace(U,H);C[i]=new T(i,1,!1,t,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var i=t.replace(U,H);C[i]=new T(i,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(t){var i=t.replace(U,H);C[i]=new T(i,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(t){C[t]=new T(t,1,!1,t.toLowerCase(),null,!1,!1)}),C.xlinkHref=new T("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(t){C[t]=new T(t,1,!1,t.toLowerCase(),null,!0,!0)});function O(t,i,s,u){var f=C.hasOwnProperty(i)?C[i]:null;(f!==null?f.type!==0:u||!(2<i.length)||i[0]!=="o"&&i[0]!=="O"||i[1]!=="n"&&i[1]!=="N")&&(I(i,s,f,u)&&(s=null),u||f===null?S(i)&&(s===null?t.removeAttribute(i):t.setAttribute(i,""+s)):f.mustUseProperty?t[f.propertyName]=s===null?f.type===3?!1:"":s:(i=f.attributeName,u=f.attributeNamespace,s===null?t.removeAttribute(i):(f=f.type,s=f===3||f===4&&s===!0?"":""+s,u?t.setAttributeNS(u,i,s):t.setAttribute(i,s))))}var B=e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,x=Symbol.for("react.element"),L=Symbol.for("react.portal"),j=Symbol.for("react.fragment"),ie=Symbol.for("react.strict_mode"),_e=Symbol.for("react.profiler"),Ce=Symbol.for("react.provider"),xe=Symbol.for("react.context"),Me=Symbol.for("react.forward_ref"),we=Symbol.for("react.suspense"),ce=Symbol.for("react.suspense_list"),He=Symbol.for("react.memo"),ye=Symbol.for("react.lazy"),ee=Symbol.for("react.offscreen"),z=Symbol.iterator;function V(t){return t===null||typeof t!="object"?null:(t=z&&t[z]||t["@@iterator"],typeof t=="function"?t:null)}var W=Object.assign,R;function F(t){if(R===void 0)try{throw Error()}catch(s){var i=s.stack.trim().match(/\n( *(at )?)/);R=i&&i[1]||""}return`
`+R+t}var X=!1;function te(t,i){if(!t||X)return"";X=!0;var s=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(i)if(i=function(){throw Error()},Object.defineProperty(i.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(i,[])}catch(M){var u=M}Reflect.construct(t,[],i)}else{try{i.call()}catch(M){u=M}t.call(i.prototype)}else{try{throw Error()}catch(M){u=M}t()}}catch(M){if(M&&u&&typeof M.stack=="string"){for(var f=M.stack.split(`
`),p=u.stack.split(`
`),v=f.length-1,A=p.length-1;1<=v&&0<=A&&f[v]!==p[A];)A--;for(;1<=v&&0<=A;v--,A--)if(f[v]!==p[A]){if(v!==1||A!==1)do if(v--,A--,0>A||f[v]!==p[A]){var _=`
`+f[v].replace(" at new "," at ");return t.displayName&&_.includes("<anonymous>")&&(_=_.replace("<anonymous>",t.displayName)),_}while(1<=v&&0<=A);break}}}finally{X=!1,Error.prepareStackTrace=s}return(t=t?t.displayName||t.name:"")?F(t):""}function pe(t){switch(t.tag){case 5:return F(t.type);case 16:return F("Lazy");case 13:return F("Suspense");case 19:return F("SuspenseList");case 0:case 2:case 15:return t=te(t.type,!1),t;case 11:return t=te(t.type.render,!1),t;case 1:return t=te(t.type,!0),t;default:return""}}function se(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case j:return"Fragment";case L:return"Portal";case _e:return"Profiler";case ie:return"StrictMode";case we:return"Suspense";case ce:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case xe:return(t.displayName||"Context")+".Consumer";case Ce:return(t._context.displayName||"Context")+".Provider";case Me:var i=t.render;return t=t.displayName,t||(t=i.displayName||i.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case He:return i=t.displayName||null,i!==null?i:se(t.type)||"Memo";case ye:i=t._payload,t=t._init;try{return se(t(i))}catch{}}return null}function Se(t){var i=t.type;switch(t.tag){case 24:return"Cache";case 9:return(i.displayName||"Context")+".Consumer";case 10:return(i._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=i.render,t=t.displayName||t.name||"",i.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return i;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return se(i);case 8:return i===ie?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof i=="function")return i.displayName||i.name||null;if(typeof i=="string")return i}return null}function ve(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function q(t){var i=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(i==="checkbox"||i==="radio")}function ne(t){var i=q(t)?"checked":"value",s=Object.getOwnPropertyDescriptor(t.constructor.prototype,i),u=""+t[i];if(!t.hasOwnProperty(i)&&typeof s<"u"&&typeof s.get=="function"&&typeof s.set=="function"){var f=s.get,p=s.set;return Object.defineProperty(t,i,{configurable:!0,get:function(){return f.call(this)},set:function(v){u=""+v,p.call(this,v)}}),Object.defineProperty(t,i,{enumerable:s.enumerable}),{getValue:function(){return u},setValue:function(v){u=""+v},stopTracking:function(){t._valueTracker=null,delete t[i]}}}}function Fe(t){t._valueTracker||(t._valueTracker=ne(t))}function de(t){if(!t)return!1;var i=t._valueTracker;if(!i)return!0;var s=i.getValue(),u="";return t&&(u=q(t)?t.checked?"true":"false":t.value),t=u,t!==s?(i.setValue(t),!0):!1}function Dn(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function Qe(t,i){var s=i.checked;return W({},i,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:s??t._wrapperState.initialChecked})}function je(t,i){var s=i.defaultValue==null?"":i.defaultValue,u=i.checked!=null?i.checked:i.defaultChecked;s=ve(i.value!=null?i.value:s),t._wrapperState={initialChecked:u,initialValue:s,controlled:i.type==="checkbox"||i.type==="radio"?i.checked!=null:i.value!=null}}function kn(t,i){i=i.checked,i!=null&&O(t,"checked",i,!1)}function $t(t,i){kn(t,i);var s=ve(i.value),u=i.type;if(s!=null)u==="number"?(s===0&&t.value===""||t.value!=s)&&(t.value=""+s):t.value!==""+s&&(t.value=""+s);else if(u==="submit"||u==="reset"){t.removeAttribute("value");return}i.hasOwnProperty("value")?Mn(t,i.type,s):i.hasOwnProperty("defaultValue")&&Mn(t,i.type,ve(i.defaultValue)),i.checked==null&&i.defaultChecked!=null&&(t.defaultChecked=!!i.defaultChecked)}function on(t,i,s){if(i.hasOwnProperty("value")||i.hasOwnProperty("defaultValue")){var u=i.type;if(!(u!=="submit"&&u!=="reset"||i.value!==void 0&&i.value!==null))return;i=""+t._wrapperState.initialValue,s||i===t.value||(t.value=i),t.defaultValue=i}s=t.name,s!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,s!==""&&(t.name=s)}function Mn(t,i,s){(i!=="number"||Dn(t.ownerDocument)!==t)&&(s==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+s&&(t.defaultValue=""+s))}var Fn=Array.isArray;function hi(t,i,s,u){if(t=t.options,i){i={};for(var f=0;f<s.length;f++)i["$"+s[f]]=!0;for(s=0;s<t.length;s++)f=i.hasOwnProperty("$"+t[s].value),t[s].selected!==f&&(t[s].selected=f),f&&u&&(t[s].defaultSelected=!0)}else{for(s=""+ve(s),i=null,f=0;f<t.length;f++){if(t[f].value===s){t[f].selected=!0,u&&(t[f].defaultSelected=!0);return}i!==null||t[f].disabled||(i=t[f])}i!==null&&(i.selected=!0)}}function Vi(t,i){if(i.dangerouslySetInnerHTML!=null)throw Error(r(91));return W({},i,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function Xf(t,i){var s=i.value;if(s==null){if(s=i.children,i=i.defaultValue,s!=null){if(i!=null)throw Error(r(92));if(Fn(s)){if(1<s.length)throw Error(r(93));s=s[0]}i=s}i==null&&(i=""),s=i}t._wrapperState={initialValue:ve(s)}}function Kf(t,i){var s=ve(i.value),u=ve(i.defaultValue);s!=null&&(s=""+s,s!==t.value&&(t.value=s),i.defaultValue==null&&t.defaultValue!==s&&(t.defaultValue=s)),u!=null&&(t.defaultValue=""+u)}function qf(t){var i=t.textContent;i===t._wrapperState.initialValue&&i!==""&&i!==null&&(t.value=i)}function Qf(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function vu(t,i){return t==null||t==="http://www.w3.org/1999/xhtml"?Qf(i):t==="http://www.w3.org/2000/svg"&&i==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var ia,Zf=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(i,s,u,f){MSApp.execUnsafeLocalFunction(function(){return t(i,s,u,f)})}:t}(function(t,i){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=i;else{for(ia=ia||document.createElement("div"),ia.innerHTML="<svg>"+i.valueOf().toString()+"</svg>",i=ia.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;i.firstChild;)t.appendChild(i.firstChild)}});function ko(t,i){if(i){var s=t.firstChild;if(s&&s===t.lastChild&&s.nodeType===3){s.nodeValue=i;return}}t.textContent=i}var Mo={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Xv=["Webkit","ms","Moz","O"];Object.keys(Mo).forEach(function(t){Xv.forEach(function(i){i=i+t.charAt(0).toUpperCase()+t.substring(1),Mo[i]=Mo[t]})});function Jf(t,i,s){return i==null||typeof i=="boolean"||i===""?"":s||typeof i!="number"||i===0||Mo.hasOwnProperty(t)&&Mo[t]?(""+i).trim():i+"px"}function eh(t,i){t=t.style;for(var s in i)if(i.hasOwnProperty(s)){var u=s.indexOf("--")===0,f=Jf(s,i[s],u);s==="float"&&(s="cssFloat"),u?t.setProperty(s,f):t[s]=f}}var Kv=W({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function yu(t,i){if(i){if(Kv[t]&&(i.children!=null||i.dangerouslySetInnerHTML!=null))throw Error(r(137,t));if(i.dangerouslySetInnerHTML!=null){if(i.children!=null)throw Error(r(60));if(typeof i.dangerouslySetInnerHTML!="object"||!("__html"in i.dangerouslySetInnerHTML))throw Error(r(61))}if(i.style!=null&&typeof i.style!="object")throw Error(r(62))}}function Su(t,i){if(t.indexOf("-")===-1)return typeof i.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Au=null;function Tu(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var Iu=null,Nr=null,Or=null;function th(t){if(t=ts(t)){if(typeof Iu!="function")throw Error(r(280));var i=t.stateNode;i&&(i=Ca(i),Iu(t.stateNode,t.type,i))}}function nh(t){Nr?Or?Or.push(t):Or=[t]:Nr=t}function ih(){if(Nr){var t=Nr,i=Or;if(Or=Nr=null,th(t),i)for(t=0;t<i.length;t++)th(i[t])}}function rh(t,i){return t(i)}function oh(){}var Eu=!1;function sh(t,i,s){if(Eu)return t(i,s);Eu=!0;try{return rh(t,i,s)}finally{Eu=!1,(Nr!==null||Or!==null)&&(oh(),ih())}}function Fo(t,i){var s=t.stateNode;if(s===null)return null;var u=Ca(s);if(u===null)return null;s=u[i];e:switch(i){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(u=!u.disabled)||(t=t.type,u=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!u;break e;default:t=!1}if(t)return null;if(s&&typeof s!="function")throw Error(r(231,i,typeof s));return s}var wu=!1;if(d)try{var Uo={};Object.defineProperty(Uo,"passive",{get:function(){wu=!0}}),window.addEventListener("test",Uo,Uo),window.removeEventListener("test",Uo,Uo)}catch{wu=!1}function qv(t,i,s,u,f,p,v,A,_){var M=Array.prototype.slice.call(arguments,3);try{i.apply(s,M)}catch(b){this.onError(b)}}var Lo=!1,ra=null,oa=!1,_u=null,Qv={onError:function(t){Lo=!0,ra=t}};function Zv(t,i,s,u,f,p,v,A,_){Lo=!1,ra=null,qv.apply(Qv,arguments)}function Jv(t,i,s,u,f,p,v,A,_){if(Zv.apply(this,arguments),Lo){if(Lo){var M=ra;Lo=!1,ra=null}else throw Error(r(198));oa||(oa=!0,_u=M)}}function Xi(t){var i=t,s=t;if(t.alternate)for(;i.return;)i=i.return;else{t=i;do i=t,(i.flags&4098)!==0&&(s=i.return),t=i.return;while(t)}return i.tag===3?s:null}function ah(t){if(t.tag===13){var i=t.memoizedState;if(i===null&&(t=t.alternate,t!==null&&(i=t.memoizedState)),i!==null)return i.dehydrated}return null}function lh(t){if(Xi(t)!==t)throw Error(r(188))}function ey(t){var i=t.alternate;if(!i){if(i=Xi(t),i===null)throw Error(r(188));return i!==t?null:t}for(var s=t,u=i;;){var f=s.return;if(f===null)break;var p=f.alternate;if(p===null){if(u=f.return,u!==null){s=u;continue}break}if(f.child===p.child){for(p=f.child;p;){if(p===s)return lh(f),t;if(p===u)return lh(f),i;p=p.sibling}throw Error(r(188))}if(s.return!==u.return)s=f,u=p;else{for(var v=!1,A=f.child;A;){if(A===s){v=!0,s=f,u=p;break}if(A===u){v=!0,u=f,s=p;break}A=A.sibling}if(!v){for(A=p.child;A;){if(A===s){v=!0,s=p,u=f;break}if(A===u){v=!0,u=p,s=f;break}A=A.sibling}if(!v)throw Error(r(189))}}if(s.alternate!==u)throw Error(r(190))}if(s.tag!==3)throw Error(r(188));return s.stateNode.current===s?t:i}function uh(t){return t=ey(t),t!==null?ch(t):null}function ch(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var i=ch(t);if(i!==null)return i;t=t.sibling}return null}var dh=n.unstable_scheduleCallback,fh=n.unstable_cancelCallback,ty=n.unstable_shouldYield,ny=n.unstable_requestPaint,st=n.unstable_now,iy=n.unstable_getCurrentPriorityLevel,Cu=n.unstable_ImmediatePriority,hh=n.unstable_UserBlockingPriority,sa=n.unstable_NormalPriority,ry=n.unstable_LowPriority,ph=n.unstable_IdlePriority,aa=null,Un=null;function oy(t){if(Un&&typeof Un.onCommitFiberRoot=="function")try{Un.onCommitFiberRoot(aa,t,void 0,(t.current.flags&128)===128)}catch{}}var vn=Math.clz32?Math.clz32:ly,sy=Math.log,ay=Math.LN2;function ly(t){return t>>>=0,t===0?32:31-(sy(t)/ay|0)|0}var la=64,ua=4194304;function Ho(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function ca(t,i){var s=t.pendingLanes;if(s===0)return 0;var u=0,f=t.suspendedLanes,p=t.pingedLanes,v=s&268435455;if(v!==0){var A=v&~f;A!==0?u=Ho(A):(p&=v,p!==0&&(u=Ho(p)))}else v=s&~f,v!==0?u=Ho(v):p!==0&&(u=Ho(p));if(u===0)return 0;if(i!==0&&i!==u&&(i&f)===0&&(f=u&-u,p=i&-i,f>=p||f===16&&(p&4194240)!==0))return i;if((u&4)!==0&&(u|=s&16),i=t.entangledLanes,i!==0)for(t=t.entanglements,i&=u;0<i;)s=31-vn(i),f=1<<s,u|=t[s],i&=~f;return u}function uy(t,i){switch(t){case 1:case 2:case 4:return i+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return i+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function cy(t,i){for(var s=t.suspendedLanes,u=t.pingedLanes,f=t.expirationTimes,p=t.pendingLanes;0<p;){var v=31-vn(p),A=1<<v,_=f[v];_===-1?((A&s)===0||(A&u)!==0)&&(f[v]=uy(A,i)):_<=i&&(t.expiredLanes|=A),p&=~A}}function Ru(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function gh(){var t=la;return la<<=1,(la&4194240)===0&&(la=64),t}function Pu(t){for(var i=[],s=0;31>s;s++)i.push(t);return i}function Bo(t,i,s){t.pendingLanes|=i,i!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,i=31-vn(i),t[i]=s}function dy(t,i){var s=t.pendingLanes&~i;t.pendingLanes=i,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=i,t.mutableReadLanes&=i,t.entangledLanes&=i,i=t.entanglements;var u=t.eventTimes;for(t=t.expirationTimes;0<s;){var f=31-vn(s),p=1<<f;i[f]=0,u[f]=-1,t[f]=-1,s&=~p}}function Nu(t,i){var s=t.entangledLanes|=i;for(t=t.entanglements;s;){var u=31-vn(s),f=1<<u;f&i|t[u]&i&&(t[u]|=i),s&=~f}}var ze=0;function mh(t){return t&=-t,1<t?4<t?(t&268435455)!==0?16:536870912:4:1}var vh,Ou,yh,Sh,Ah,Du=!1,da=[],pi=null,gi=null,mi=null,Go=new Map,bo=new Map,vi=[],fy="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Th(t,i){switch(t){case"focusin":case"focusout":pi=null;break;case"dragenter":case"dragleave":gi=null;break;case"mouseover":case"mouseout":mi=null;break;case"pointerover":case"pointerout":Go.delete(i.pointerId);break;case"gotpointercapture":case"lostpointercapture":bo.delete(i.pointerId)}}function xo(t,i,s,u,f,p){return t===null||t.nativeEvent!==p?(t={blockedOn:i,domEventName:s,eventSystemFlags:u,nativeEvent:p,targetContainers:[f]},i!==null&&(i=ts(i),i!==null&&Ou(i)),t):(t.eventSystemFlags|=u,i=t.targetContainers,f!==null&&i.indexOf(f)===-1&&i.push(f),t)}function hy(t,i,s,u,f){switch(i){case"focusin":return pi=xo(pi,t,i,s,u,f),!0;case"dragenter":return gi=xo(gi,t,i,s,u,f),!0;case"mouseover":return mi=xo(mi,t,i,s,u,f),!0;case"pointerover":var p=f.pointerId;return Go.set(p,xo(Go.get(p)||null,t,i,s,u,f)),!0;case"gotpointercapture":return p=f.pointerId,bo.set(p,xo(bo.get(p)||null,t,i,s,u,f)),!0}return!1}function Ih(t){var i=Ki(t.target);if(i!==null){var s=Xi(i);if(s!==null){if(i=s.tag,i===13){if(i=ah(s),i!==null){t.blockedOn=i,Ah(t.priority,function(){yh(s)});return}}else if(i===3&&s.stateNode.current.memoizedState.isDehydrated){t.blockedOn=s.tag===3?s.stateNode.containerInfo:null;return}}}t.blockedOn=null}function fa(t){if(t.blockedOn!==null)return!1;for(var i=t.targetContainers;0<i.length;){var s=Mu(t.domEventName,t.eventSystemFlags,i[0],t.nativeEvent);if(s===null){s=t.nativeEvent;var u=new s.constructor(s.type,s);Au=u,s.target.dispatchEvent(u),Au=null}else return i=ts(s),i!==null&&Ou(i),t.blockedOn=s,!1;i.shift()}return!0}function Eh(t,i,s){fa(t)&&s.delete(i)}function py(){Du=!1,pi!==null&&fa(pi)&&(pi=null),gi!==null&&fa(gi)&&(gi=null),mi!==null&&fa(mi)&&(mi=null),Go.forEach(Eh),bo.forEach(Eh)}function $o(t,i){t.blockedOn===i&&(t.blockedOn=null,Du||(Du=!0,n.unstable_scheduleCallback(n.unstable_NormalPriority,py)))}function zo(t){function i(f){return $o(f,t)}if(0<da.length){$o(da[0],t);for(var s=1;s<da.length;s++){var u=da[s];u.blockedOn===t&&(u.blockedOn=null)}}for(pi!==null&&$o(pi,t),gi!==null&&$o(gi,t),mi!==null&&$o(mi,t),Go.forEach(i),bo.forEach(i),s=0;s<vi.length;s++)u=vi[s],u.blockedOn===t&&(u.blockedOn=null);for(;0<vi.length&&(s=vi[0],s.blockedOn===null);)Ih(s),s.blockedOn===null&&vi.shift()}var Dr=B.ReactCurrentBatchConfig,ha=!0;function gy(t,i,s,u){var f=ze,p=Dr.transition;Dr.transition=null;try{ze=1,ku(t,i,s,u)}finally{ze=f,Dr.transition=p}}function my(t,i,s,u){var f=ze,p=Dr.transition;Dr.transition=null;try{ze=4,ku(t,i,s,u)}finally{ze=f,Dr.transition=p}}function ku(t,i,s,u){if(ha){var f=Mu(t,i,s,u);if(f===null)qu(t,i,u,pa,s),Th(t,u);else if(hy(f,t,i,s,u))u.stopPropagation();else if(Th(t,u),i&4&&-1<fy.indexOf(t)){for(;f!==null;){var p=ts(f);if(p!==null&&vh(p),p=Mu(t,i,s,u),p===null&&qu(t,i,u,pa,s),p===f)break;f=p}f!==null&&u.stopPropagation()}else qu(t,i,u,null,s)}}var pa=null;function Mu(t,i,s,u){if(pa=null,t=Tu(u),t=Ki(t),t!==null)if(i=Xi(t),i===null)t=null;else if(s=i.tag,s===13){if(t=ah(i),t!==null)return t;t=null}else if(s===3){if(i.stateNode.current.memoizedState.isDehydrated)return i.tag===3?i.stateNode.containerInfo:null;t=null}else i!==t&&(t=null);return pa=t,null}function wh(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(iy()){case Cu:return 1;case hh:return 4;case sa:case ry:return 16;case ph:return 536870912;default:return 16}default:return 16}}var yi=null,Fu=null,ga=null;function _h(){if(ga)return ga;var t,i=Fu,s=i.length,u,f="value"in yi?yi.value:yi.textContent,p=f.length;for(t=0;t<s&&i[t]===f[t];t++);var v=s-t;for(u=1;u<=v&&i[s-u]===f[p-u];u++);return ga=f.slice(t,1<u?1-u:void 0)}function ma(t){var i=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&i===13&&(t=13)):t=i,t===10&&(t=13),32<=t||t===13?t:0}function va(){return!0}function Ch(){return!1}function Qt(t){function i(s,u,f,p,v){this._reactName=s,this._targetInst=f,this.type=u,this.nativeEvent=p,this.target=v,this.currentTarget=null;for(var A in t)t.hasOwnProperty(A)&&(s=t[A],this[A]=s?s(p):p[A]);return this.isDefaultPrevented=(p.defaultPrevented!=null?p.defaultPrevented:p.returnValue===!1)?va:Ch,this.isPropagationStopped=Ch,this}return W(i.prototype,{preventDefault:function(){this.defaultPrevented=!0;var s=this.nativeEvent;s&&(s.preventDefault?s.preventDefault():typeof s.returnValue!="unknown"&&(s.returnValue=!1),this.isDefaultPrevented=va)},stopPropagation:function(){var s=this.nativeEvent;s&&(s.stopPropagation?s.stopPropagation():typeof s.cancelBubble!="unknown"&&(s.cancelBubble=!0),this.isPropagationStopped=va)},persist:function(){},isPersistent:va}),i}var kr={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Uu=Qt(kr),Wo=W({},kr,{view:0,detail:0}),vy=Qt(Wo),Lu,Hu,Yo,ya=W({},Wo,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Gu,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==Yo&&(Yo&&t.type==="mousemove"?(Lu=t.screenX-Yo.screenX,Hu=t.screenY-Yo.screenY):Hu=Lu=0,Yo=t),Lu)},movementY:function(t){return"movementY"in t?t.movementY:Hu}}),Rh=Qt(ya),yy=W({},ya,{dataTransfer:0}),Sy=Qt(yy),Ay=W({},Wo,{relatedTarget:0}),Bu=Qt(Ay),Ty=W({},kr,{animationName:0,elapsedTime:0,pseudoElement:0}),Iy=Qt(Ty),Ey=W({},kr,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),wy=Qt(Ey),_y=W({},kr,{data:0}),Ph=Qt(_y),Cy={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Ry={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Py={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Ny(t){var i=this.nativeEvent;return i.getModifierState?i.getModifierState(t):(t=Py[t])?!!i[t]:!1}function Gu(){return Ny}var Oy=W({},Wo,{key:function(t){if(t.key){var i=Cy[t.key]||t.key;if(i!=="Unidentified")return i}return t.type==="keypress"?(t=ma(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?Ry[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Gu,charCode:function(t){return t.type==="keypress"?ma(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?ma(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),Dy=Qt(Oy),ky=W({},ya,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Nh=Qt(ky),My=W({},Wo,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Gu}),Fy=Qt(My),Uy=W({},kr,{propertyName:0,elapsedTime:0,pseudoElement:0}),Ly=Qt(Uy),Hy=W({},ya,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),By=Qt(Hy),Gy=[9,13,27,32],bu=d&&"CompositionEvent"in window,jo=null;d&&"documentMode"in document&&(jo=document.documentMode);var by=d&&"TextEvent"in window&&!jo,Oh=d&&(!bu||jo&&8<jo&&11>=jo),Dh=" ",kh=!1;function Mh(t,i){switch(t){case"keyup":return Gy.indexOf(i.keyCode)!==-1;case"keydown":return i.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Fh(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var Mr=!1;function xy(t,i){switch(t){case"compositionend":return Fh(i);case"keypress":return i.which!==32?null:(kh=!0,Dh);case"textInput":return t=i.data,t===Dh&&kh?null:t;default:return null}}function $y(t,i){if(Mr)return t==="compositionend"||!bu&&Mh(t,i)?(t=_h(),ga=Fu=yi=null,Mr=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(i.ctrlKey||i.altKey||i.metaKey)||i.ctrlKey&&i.altKey){if(i.char&&1<i.char.length)return i.char;if(i.which)return String.fromCharCode(i.which)}return null;case"compositionend":return Oh&&i.locale!=="ko"?null:i.data;default:return null}}var zy={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Uh(t){var i=t&&t.nodeName&&t.nodeName.toLowerCase();return i==="input"?!!zy[t.type]:i==="textarea"}function Lh(t,i,s,u){nh(u),i=Ea(i,"onChange"),0<i.length&&(s=new Uu("onChange","change",null,s,u),t.push({event:s,listeners:i}))}var Vo=null,Xo=null;function Wy(t){ep(t,0)}function Sa(t){var i=Br(t);if(de(i))return t}function Yy(t,i){if(t==="change")return i}var Hh=!1;if(d){var xu;if(d){var $u="oninput"in document;if(!$u){var Bh=document.createElement("div");Bh.setAttribute("oninput","return;"),$u=typeof Bh.oninput=="function"}xu=$u}else xu=!1;Hh=xu&&(!document.documentMode||9<document.documentMode)}function Gh(){Vo&&(Vo.detachEvent("onpropertychange",bh),Xo=Vo=null)}function bh(t){if(t.propertyName==="value"&&Sa(Xo)){var i=[];Lh(i,Xo,t,Tu(t)),sh(Wy,i)}}function jy(t,i,s){t==="focusin"?(Gh(),Vo=i,Xo=s,Vo.attachEvent("onpropertychange",bh)):t==="focusout"&&Gh()}function Vy(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return Sa(Xo)}function Xy(t,i){if(t==="click")return Sa(i)}function Ky(t,i){if(t==="input"||t==="change")return Sa(i)}function qy(t,i){return t===i&&(t!==0||1/t===1/i)||t!==t&&i!==i}var yn=typeof Object.is=="function"?Object.is:qy;function Ko(t,i){if(yn(t,i))return!0;if(typeof t!="object"||t===null||typeof i!="object"||i===null)return!1;var s=Object.keys(t),u=Object.keys(i);if(s.length!==u.length)return!1;for(u=0;u<s.length;u++){var f=s[u];if(!h.call(i,f)||!yn(t[f],i[f]))return!1}return!0}function xh(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function $h(t,i){var s=xh(t);t=0;for(var u;s;){if(s.nodeType===3){if(u=t+s.textContent.length,t<=i&&u>=i)return{node:s,offset:i-t};t=u}e:{for(;s;){if(s.nextSibling){s=s.nextSibling;break e}s=s.parentNode}s=void 0}s=xh(s)}}function zh(t,i){return t&&i?t===i?!0:t&&t.nodeType===3?!1:i&&i.nodeType===3?zh(t,i.parentNode):"contains"in t?t.contains(i):t.compareDocumentPosition?!!(t.compareDocumentPosition(i)&16):!1:!1}function Wh(){for(var t=window,i=Dn();i instanceof t.HTMLIFrameElement;){try{var s=typeof i.contentWindow.location.href=="string"}catch{s=!1}if(s)t=i.contentWindow;else break;i=Dn(t.document)}return i}function zu(t){var i=t&&t.nodeName&&t.nodeName.toLowerCase();return i&&(i==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||i==="textarea"||t.contentEditable==="true")}function Qy(t){var i=Wh(),s=t.focusedElem,u=t.selectionRange;if(i!==s&&s&&s.ownerDocument&&zh(s.ownerDocument.documentElement,s)){if(u!==null&&zu(s)){if(i=u.start,t=u.end,t===void 0&&(t=i),"selectionStart"in s)s.selectionStart=i,s.selectionEnd=Math.min(t,s.value.length);else if(t=(i=s.ownerDocument||document)&&i.defaultView||window,t.getSelection){t=t.getSelection();var f=s.textContent.length,p=Math.min(u.start,f);u=u.end===void 0?p:Math.min(u.end,f),!t.extend&&p>u&&(f=u,u=p,p=f),f=$h(s,p);var v=$h(s,u);f&&v&&(t.rangeCount!==1||t.anchorNode!==f.node||t.anchorOffset!==f.offset||t.focusNode!==v.node||t.focusOffset!==v.offset)&&(i=i.createRange(),i.setStart(f.node,f.offset),t.removeAllRanges(),p>u?(t.addRange(i),t.extend(v.node,v.offset)):(i.setEnd(v.node,v.offset),t.addRange(i)))}}for(i=[],t=s;t=t.parentNode;)t.nodeType===1&&i.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof s.focus=="function"&&s.focus(),s=0;s<i.length;s++)t=i[s],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var Zy=d&&"documentMode"in document&&11>=document.documentMode,Fr=null,Wu=null,qo=null,Yu=!1;function Yh(t,i,s){var u=s.window===s?s.document:s.nodeType===9?s:s.ownerDocument;Yu||Fr==null||Fr!==Dn(u)||(u=Fr,"selectionStart"in u&&zu(u)?u={start:u.selectionStart,end:u.selectionEnd}:(u=(u.ownerDocument&&u.ownerDocument.defaultView||window).getSelection(),u={anchorNode:u.anchorNode,anchorOffset:u.anchorOffset,focusNode:u.focusNode,focusOffset:u.focusOffset}),qo&&Ko(qo,u)||(qo=u,u=Ea(Wu,"onSelect"),0<u.length&&(i=new Uu("onSelect","select",null,i,s),t.push({event:i,listeners:u}),i.target=Fr)))}function Aa(t,i){var s={};return s[t.toLowerCase()]=i.toLowerCase(),s["Webkit"+t]="webkit"+i,s["Moz"+t]="moz"+i,s}var Ur={animationend:Aa("Animation","AnimationEnd"),animationiteration:Aa("Animation","AnimationIteration"),animationstart:Aa("Animation","AnimationStart"),transitionend:Aa("Transition","TransitionEnd")},ju={},jh={};d&&(jh=document.createElement("div").style,"AnimationEvent"in window||(delete Ur.animationend.animation,delete Ur.animationiteration.animation,delete Ur.animationstart.animation),"TransitionEvent"in window||delete Ur.transitionend.transition);function Ta(t){if(ju[t])return ju[t];if(!Ur[t])return t;var i=Ur[t],s;for(s in i)if(i.hasOwnProperty(s)&&s in jh)return ju[t]=i[s];return t}var Vh=Ta("animationend"),Xh=Ta("animationiteration"),Kh=Ta("animationstart"),qh=Ta("transitionend"),Qh=new Map,Zh="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Si(t,i){Qh.set(t,i),a(i,[t])}for(var Vu=0;Vu<Zh.length;Vu++){var Xu=Zh[Vu],Jy=Xu.toLowerCase(),eS=Xu[0].toUpperCase()+Xu.slice(1);Si(Jy,"on"+eS)}Si(Vh,"onAnimationEnd"),Si(Xh,"onAnimationIteration"),Si(Kh,"onAnimationStart"),Si("dblclick","onDoubleClick"),Si("focusin","onFocus"),Si("focusout","onBlur"),Si(qh,"onTransitionEnd"),c("onMouseEnter",["mouseout","mouseover"]),c("onMouseLeave",["mouseout","mouseover"]),c("onPointerEnter",["pointerout","pointerover"]),c("onPointerLeave",["pointerout","pointerover"]),a("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),a("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),a("onBeforeInput",["compositionend","keypress","textInput","paste"]),a("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),a("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),a("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Qo="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),tS=new Set("cancel close invalid load scroll toggle".split(" ").concat(Qo));function Jh(t,i,s){var u=t.type||"unknown-event";t.currentTarget=s,Jv(u,i,void 0,t),t.currentTarget=null}function ep(t,i){i=(i&4)!==0;for(var s=0;s<t.length;s++){var u=t[s],f=u.event;u=u.listeners;e:{var p=void 0;if(i)for(var v=u.length-1;0<=v;v--){var A=u[v],_=A.instance,M=A.currentTarget;if(A=A.listener,_!==p&&f.isPropagationStopped())break e;Jh(f,A,M),p=_}else for(v=0;v<u.length;v++){if(A=u[v],_=A.instance,M=A.currentTarget,A=A.listener,_!==p&&f.isPropagationStopped())break e;Jh(f,A,M),p=_}}}if(oa)throw t=_u,oa=!1,_u=null,t}function Ve(t,i){var s=i[nc];s===void 0&&(s=i[nc]=new Set);var u=t+"__bubble";s.has(u)||(tp(i,t,2,!1),s.add(u))}function Ku(t,i,s){var u=0;i&&(u|=4),tp(s,t,u,i)}var Ia="_reactListening"+Math.random().toString(36).slice(2);function Zo(t){if(!t[Ia]){t[Ia]=!0,o.forEach(function(s){s!=="selectionchange"&&(tS.has(s)||Ku(s,!1,t),Ku(s,!0,t))});var i=t.nodeType===9?t:t.ownerDocument;i===null||i[Ia]||(i[Ia]=!0,Ku("selectionchange",!1,i))}}function tp(t,i,s,u){switch(wh(i)){case 1:var f=gy;break;case 4:f=my;break;default:f=ku}s=f.bind(null,i,s,t),f=void 0,!wu||i!=="touchstart"&&i!=="touchmove"&&i!=="wheel"||(f=!0),u?f!==void 0?t.addEventListener(i,s,{capture:!0,passive:f}):t.addEventListener(i,s,!0):f!==void 0?t.addEventListener(i,s,{passive:f}):t.addEventListener(i,s,!1)}function qu(t,i,s,u,f){var p=u;if((i&1)===0&&(i&2)===0&&u!==null)e:for(;;){if(u===null)return;var v=u.tag;if(v===3||v===4){var A=u.stateNode.containerInfo;if(A===f||A.nodeType===8&&A.parentNode===f)break;if(v===4)for(v=u.return;v!==null;){var _=v.tag;if((_===3||_===4)&&(_=v.stateNode.containerInfo,_===f||_.nodeType===8&&_.parentNode===f))return;v=v.return}for(;A!==null;){if(v=Ki(A),v===null)return;if(_=v.tag,_===5||_===6){u=p=v;continue e}A=A.parentNode}}u=u.return}sh(function(){var M=p,b=Tu(s),$=[];e:{var G=Qh.get(t);if(G!==void 0){var Q=Uu,J=t;switch(t){case"keypress":if(ma(s)===0)break e;case"keydown":case"keyup":Q=Dy;break;case"focusin":J="focus",Q=Bu;break;case"focusout":J="blur",Q=Bu;break;case"beforeblur":case"afterblur":Q=Bu;break;case"click":if(s.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":Q=Rh;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":Q=Sy;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":Q=Fy;break;case Vh:case Xh:case Kh:Q=Iy;break;case qh:Q=Ly;break;case"scroll":Q=vy;break;case"wheel":Q=By;break;case"copy":case"cut":case"paste":Q=wy;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":Q=Nh}var re=(i&4)!==0,at=!re&&t==="scroll",D=re?G!==null?G+"Capture":null:G;re=[];for(var P=M,k;P!==null;){k=P;var Y=k.stateNode;if(k.tag===5&&Y!==null&&(k=Y,D!==null&&(Y=Fo(P,D),Y!=null&&re.push(Jo(P,Y,k)))),at)break;P=P.return}0<re.length&&(G=new Q(G,J,null,s,b),$.push({event:G,listeners:re}))}}if((i&7)===0){e:{if(G=t==="mouseover"||t==="pointerover",Q=t==="mouseout"||t==="pointerout",G&&s!==Au&&(J=s.relatedTarget||s.fromElement)&&(Ki(J)||J[Xn]))break e;if((Q||G)&&(G=b.window===b?b:(G=b.ownerDocument)?G.defaultView||G.parentWindow:window,Q?(J=s.relatedTarget||s.toElement,Q=M,J=J?Ki(J):null,J!==null&&(at=Xi(J),J!==at||J.tag!==5&&J.tag!==6)&&(J=null)):(Q=null,J=M),Q!==J)){if(re=Rh,Y="onMouseLeave",D="onMouseEnter",P="mouse",(t==="pointerout"||t==="pointerover")&&(re=Nh,Y="onPointerLeave",D="onPointerEnter",P="pointer"),at=Q==null?G:Br(Q),k=J==null?G:Br(J),G=new re(Y,P+"leave",Q,s,b),G.target=at,G.relatedTarget=k,Y=null,Ki(b)===M&&(re=new re(D,P+"enter",J,s,b),re.target=k,re.relatedTarget=at,Y=re),at=Y,Q&&J)t:{for(re=Q,D=J,P=0,k=re;k;k=Lr(k))P++;for(k=0,Y=D;Y;Y=Lr(Y))k++;for(;0<P-k;)re=Lr(re),P--;for(;0<k-P;)D=Lr(D),k--;for(;P--;){if(re===D||D!==null&&re===D.alternate)break t;re=Lr(re),D=Lr(D)}re=null}else re=null;Q!==null&&np($,G,Q,re,!1),J!==null&&at!==null&&np($,at,J,re,!0)}}e:{if(G=M?Br(M):window,Q=G.nodeName&&G.nodeName.toLowerCase(),Q==="select"||Q==="input"&&G.type==="file")var ae=Yy;else if(Uh(G))if(Hh)ae=Ky;else{ae=Vy;var fe=jy}else(Q=G.nodeName)&&Q.toLowerCase()==="input"&&(G.type==="checkbox"||G.type==="radio")&&(ae=Xy);if(ae&&(ae=ae(t,M))){Lh($,ae,s,b);break e}fe&&fe(t,G,M),t==="focusout"&&(fe=G._wrapperState)&&fe.controlled&&G.type==="number"&&Mn(G,"number",G.value)}switch(fe=M?Br(M):window,t){case"focusin":(Uh(fe)||fe.contentEditable==="true")&&(Fr=fe,Wu=M,qo=null);break;case"focusout":qo=Wu=Fr=null;break;case"mousedown":Yu=!0;break;case"contextmenu":case"mouseup":case"dragend":Yu=!1,Yh($,s,b);break;case"selectionchange":if(Zy)break;case"keydown":case"keyup":Yh($,s,b)}var he;if(bu)e:{switch(t){case"compositionstart":var Ae="onCompositionStart";break e;case"compositionend":Ae="onCompositionEnd";break e;case"compositionupdate":Ae="onCompositionUpdate";break e}Ae=void 0}else Mr?Mh(t,s)&&(Ae="onCompositionEnd"):t==="keydown"&&s.keyCode===229&&(Ae="onCompositionStart");Ae&&(Oh&&s.locale!=="ko"&&(Mr||Ae!=="onCompositionStart"?Ae==="onCompositionEnd"&&Mr&&(he=_h()):(yi=b,Fu="value"in yi?yi.value:yi.textContent,Mr=!0)),fe=Ea(M,Ae),0<fe.length&&(Ae=new Ph(Ae,t,null,s,b),$.push({event:Ae,listeners:fe}),he?Ae.data=he:(he=Fh(s),he!==null&&(Ae.data=he)))),(he=by?xy(t,s):$y(t,s))&&(M=Ea(M,"onBeforeInput"),0<M.length&&(b=new Ph("onBeforeInput","beforeinput",null,s,b),$.push({event:b,listeners:M}),b.data=he))}ep($,i)})}function Jo(t,i,s){return{instance:t,listener:i,currentTarget:s}}function Ea(t,i){for(var s=i+"Capture",u=[];t!==null;){var f=t,p=f.stateNode;f.tag===5&&p!==null&&(f=p,p=Fo(t,s),p!=null&&u.unshift(Jo(t,p,f)),p=Fo(t,i),p!=null&&u.push(Jo(t,p,f))),t=t.return}return u}function Lr(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function np(t,i,s,u,f){for(var p=i._reactName,v=[];s!==null&&s!==u;){var A=s,_=A.alternate,M=A.stateNode;if(_!==null&&_===u)break;A.tag===5&&M!==null&&(A=M,f?(_=Fo(s,p),_!=null&&v.unshift(Jo(s,_,A))):f||(_=Fo(s,p),_!=null&&v.push(Jo(s,_,A)))),s=s.return}v.length!==0&&t.push({event:i,listeners:v})}var nS=/\r\n?/g,iS=/\u0000|\uFFFD/g;function ip(t){return(typeof t=="string"?t:""+t).replace(nS,`
`).replace(iS,"")}function wa(t,i,s){if(i=ip(i),ip(t)!==i&&s)throw Error(r(425))}function _a(){}var Qu=null,Zu=null;function Ju(t,i){return t==="textarea"||t==="noscript"||typeof i.children=="string"||typeof i.children=="number"||typeof i.dangerouslySetInnerHTML=="object"&&i.dangerouslySetInnerHTML!==null&&i.dangerouslySetInnerHTML.__html!=null}var ec=typeof setTimeout=="function"?setTimeout:void 0,rS=typeof clearTimeout=="function"?clearTimeout:void 0,rp=typeof Promise=="function"?Promise:void 0,oS=typeof queueMicrotask=="function"?queueMicrotask:typeof rp<"u"?function(t){return rp.resolve(null).then(t).catch(sS)}:ec;function sS(t){setTimeout(function(){throw t})}function tc(t,i){var s=i,u=0;do{var f=s.nextSibling;if(t.removeChild(s),f&&f.nodeType===8)if(s=f.data,s==="/$"){if(u===0){t.removeChild(f),zo(i);return}u--}else s!=="$"&&s!=="$?"&&s!=="$!"||u++;s=f}while(s);zo(i)}function Ai(t){for(;t!=null;t=t.nextSibling){var i=t.nodeType;if(i===1||i===3)break;if(i===8){if(i=t.data,i==="$"||i==="$!"||i==="$?")break;if(i==="/$")return null}}return t}function op(t){t=t.previousSibling;for(var i=0;t;){if(t.nodeType===8){var s=t.data;if(s==="$"||s==="$!"||s==="$?"){if(i===0)return t;i--}else s==="/$"&&i++}t=t.previousSibling}return null}var Hr=Math.random().toString(36).slice(2),Ln="__reactFiber$"+Hr,es="__reactProps$"+Hr,Xn="__reactContainer$"+Hr,nc="__reactEvents$"+Hr,aS="__reactListeners$"+Hr,lS="__reactHandles$"+Hr;function Ki(t){var i=t[Ln];if(i)return i;for(var s=t.parentNode;s;){if(i=s[Xn]||s[Ln]){if(s=i.alternate,i.child!==null||s!==null&&s.child!==null)for(t=op(t);t!==null;){if(s=t[Ln])return s;t=op(t)}return i}t=s,s=t.parentNode}return null}function ts(t){return t=t[Ln]||t[Xn],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function Br(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(r(33))}function Ca(t){return t[es]||null}var ic=[],Gr=-1;function Ti(t){return{current:t}}function Xe(t){0>Gr||(t.current=ic[Gr],ic[Gr]=null,Gr--)}function Ye(t,i){Gr++,ic[Gr]=t.current,t.current=i}var Ii={},Pt=Ti(Ii),zt=Ti(!1),qi=Ii;function br(t,i){var s=t.type.contextTypes;if(!s)return Ii;var u=t.stateNode;if(u&&u.__reactInternalMemoizedUnmaskedChildContext===i)return u.__reactInternalMemoizedMaskedChildContext;var f={},p;for(p in s)f[p]=i[p];return u&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=i,t.__reactInternalMemoizedMaskedChildContext=f),f}function Wt(t){return t=t.childContextTypes,t!=null}function Ra(){Xe(zt),Xe(Pt)}function sp(t,i,s){if(Pt.current!==Ii)throw Error(r(168));Ye(Pt,i),Ye(zt,s)}function ap(t,i,s){var u=t.stateNode;if(i=i.childContextTypes,typeof u.getChildContext!="function")return s;u=u.getChildContext();for(var f in u)if(!(f in i))throw Error(r(108,Se(t)||"Unknown",f));return W({},s,u)}function Pa(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||Ii,qi=Pt.current,Ye(Pt,t),Ye(zt,zt.current),!0}function lp(t,i,s){var u=t.stateNode;if(!u)throw Error(r(169));s?(t=ap(t,i,qi),u.__reactInternalMemoizedMergedChildContext=t,Xe(zt),Xe(Pt),Ye(Pt,t)):Xe(zt),Ye(zt,s)}var Kn=null,Na=!1,rc=!1;function up(t){Kn===null?Kn=[t]:Kn.push(t)}function uS(t){Na=!0,up(t)}function Ei(){if(!rc&&Kn!==null){rc=!0;var t=0,i=ze;try{var s=Kn;for(ze=1;t<s.length;t++){var u=s[t];do u=u(!0);while(u!==null)}Kn=null,Na=!1}catch(f){throw Kn!==null&&(Kn=Kn.slice(t+1)),dh(Cu,Ei),f}finally{ze=i,rc=!1}}return null}var xr=[],$r=0,Oa=null,Da=0,sn=[],an=0,Qi=null,qn=1,Qn="";function Zi(t,i){xr[$r++]=Da,xr[$r++]=Oa,Oa=t,Da=i}function cp(t,i,s){sn[an++]=qn,sn[an++]=Qn,sn[an++]=Qi,Qi=t;var u=qn;t=Qn;var f=32-vn(u)-1;u&=~(1<<f),s+=1;var p=32-vn(i)+f;if(30<p){var v=f-f%5;p=(u&(1<<v)-1).toString(32),u>>=v,f-=v,qn=1<<32-vn(i)+f|s<<f|u,Qn=p+t}else qn=1<<p|s<<f|u,Qn=t}function oc(t){t.return!==null&&(Zi(t,1),cp(t,1,0))}function sc(t){for(;t===Oa;)Oa=xr[--$r],xr[$r]=null,Da=xr[--$r],xr[$r]=null;for(;t===Qi;)Qi=sn[--an],sn[an]=null,Qn=sn[--an],sn[an]=null,qn=sn[--an],sn[an]=null}var Zt=null,Jt=null,Ze=!1,Sn=null;function dp(t,i){var s=dn(5,null,null,0);s.elementType="DELETED",s.stateNode=i,s.return=t,i=t.deletions,i===null?(t.deletions=[s],t.flags|=16):i.push(s)}function fp(t,i){switch(t.tag){case 5:var s=t.type;return i=i.nodeType!==1||s.toLowerCase()!==i.nodeName.toLowerCase()?null:i,i!==null?(t.stateNode=i,Zt=t,Jt=Ai(i.firstChild),!0):!1;case 6:return i=t.pendingProps===""||i.nodeType!==3?null:i,i!==null?(t.stateNode=i,Zt=t,Jt=null,!0):!1;case 13:return i=i.nodeType!==8?null:i,i!==null?(s=Qi!==null?{id:qn,overflow:Qn}:null,t.memoizedState={dehydrated:i,treeContext:s,retryLane:1073741824},s=dn(18,null,null,0),s.stateNode=i,s.return=t,t.child=s,Zt=t,Jt=null,!0):!1;default:return!1}}function ac(t){return(t.mode&1)!==0&&(t.flags&128)===0}function lc(t){if(Ze){var i=Jt;if(i){var s=i;if(!fp(t,i)){if(ac(t))throw Error(r(418));i=Ai(s.nextSibling);var u=Zt;i&&fp(t,i)?dp(u,s):(t.flags=t.flags&-4097|2,Ze=!1,Zt=t)}}else{if(ac(t))throw Error(r(418));t.flags=t.flags&-4097|2,Ze=!1,Zt=t}}}function hp(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;Zt=t}function ka(t){if(t!==Zt)return!1;if(!Ze)return hp(t),Ze=!0,!1;var i;if((i=t.tag!==3)&&!(i=t.tag!==5)&&(i=t.type,i=i!=="head"&&i!=="body"&&!Ju(t.type,t.memoizedProps)),i&&(i=Jt)){if(ac(t))throw pp(),Error(r(418));for(;i;)dp(t,i),i=Ai(i.nextSibling)}if(hp(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(r(317));e:{for(t=t.nextSibling,i=0;t;){if(t.nodeType===8){var s=t.data;if(s==="/$"){if(i===0){Jt=Ai(t.nextSibling);break e}i--}else s!=="$"&&s!=="$!"&&s!=="$?"||i++}t=t.nextSibling}Jt=null}}else Jt=Zt?Ai(t.stateNode.nextSibling):null;return!0}function pp(){for(var t=Jt;t;)t=Ai(t.nextSibling)}function zr(){Jt=Zt=null,Ze=!1}function uc(t){Sn===null?Sn=[t]:Sn.push(t)}var cS=B.ReactCurrentBatchConfig;function ns(t,i,s){if(t=s.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(s._owner){if(s=s._owner,s){if(s.tag!==1)throw Error(r(309));var u=s.stateNode}if(!u)throw Error(r(147,t));var f=u,p=""+t;return i!==null&&i.ref!==null&&typeof i.ref=="function"&&i.ref._stringRef===p?i.ref:(i=function(v){var A=f.refs;v===null?delete A[p]:A[p]=v},i._stringRef=p,i)}if(typeof t!="string")throw Error(r(284));if(!s._owner)throw Error(r(290,t))}return t}function Ma(t,i){throw t=Object.prototype.toString.call(i),Error(r(31,t==="[object Object]"?"object with keys {"+Object.keys(i).join(", ")+"}":t))}function gp(t){var i=t._init;return i(t._payload)}function mp(t){function i(D,P){if(t){var k=D.deletions;k===null?(D.deletions=[P],D.flags|=16):k.push(P)}}function s(D,P){if(!t)return null;for(;P!==null;)i(D,P),P=P.sibling;return null}function u(D,P){for(D=new Map;P!==null;)P.key!==null?D.set(P.key,P):D.set(P.index,P),P=P.sibling;return D}function f(D,P){return D=Di(D,P),D.index=0,D.sibling=null,D}function p(D,P,k){return D.index=k,t?(k=D.alternate,k!==null?(k=k.index,k<P?(D.flags|=2,P):k):(D.flags|=2,P)):(D.flags|=1048576,P)}function v(D){return t&&D.alternate===null&&(D.flags|=2),D}function A(D,P,k,Y){return P===null||P.tag!==6?(P=ed(k,D.mode,Y),P.return=D,P):(P=f(P,k),P.return=D,P)}function _(D,P,k,Y){var ae=k.type;return ae===j?b(D,P,k.props.children,Y,k.key):P!==null&&(P.elementType===ae||typeof ae=="object"&&ae!==null&&ae.$$typeof===ye&&gp(ae)===P.type)?(Y=f(P,k.props),Y.ref=ns(D,P,k),Y.return=D,Y):(Y=il(k.type,k.key,k.props,null,D.mode,Y),Y.ref=ns(D,P,k),Y.return=D,Y)}function M(D,P,k,Y){return P===null||P.tag!==4||P.stateNode.containerInfo!==k.containerInfo||P.stateNode.implementation!==k.implementation?(P=td(k,D.mode,Y),P.return=D,P):(P=f(P,k.children||[]),P.return=D,P)}function b(D,P,k,Y,ae){return P===null||P.tag!==7?(P=sr(k,D.mode,Y,ae),P.return=D,P):(P=f(P,k),P.return=D,P)}function $(D,P,k){if(typeof P=="string"&&P!==""||typeof P=="number")return P=ed(""+P,D.mode,k),P.return=D,P;if(typeof P=="object"&&P!==null){switch(P.$$typeof){case x:return k=il(P.type,P.key,P.props,null,D.mode,k),k.ref=ns(D,null,P),k.return=D,k;case L:return P=td(P,D.mode,k),P.return=D,P;case ye:var Y=P._init;return $(D,Y(P._payload),k)}if(Fn(P)||V(P))return P=sr(P,D.mode,k,null),P.return=D,P;Ma(D,P)}return null}function G(D,P,k,Y){var ae=P!==null?P.key:null;if(typeof k=="string"&&k!==""||typeof k=="number")return ae!==null?null:A(D,P,""+k,Y);if(typeof k=="object"&&k!==null){switch(k.$$typeof){case x:return k.key===ae?_(D,P,k,Y):null;case L:return k.key===ae?M(D,P,k,Y):null;case ye:return ae=k._init,G(D,P,ae(k._payload),Y)}if(Fn(k)||V(k))return ae!==null?null:b(D,P,k,Y,null);Ma(D,k)}return null}function Q(D,P,k,Y,ae){if(typeof Y=="string"&&Y!==""||typeof Y=="number")return D=D.get(k)||null,A(P,D,""+Y,ae);if(typeof Y=="object"&&Y!==null){switch(Y.$$typeof){case x:return D=D.get(Y.key===null?k:Y.key)||null,_(P,D,Y,ae);case L:return D=D.get(Y.key===null?k:Y.key)||null,M(P,D,Y,ae);case ye:var fe=Y._init;return Q(D,P,k,fe(Y._payload),ae)}if(Fn(Y)||V(Y))return D=D.get(k)||null,b(P,D,Y,ae,null);Ma(P,Y)}return null}function J(D,P,k,Y){for(var ae=null,fe=null,he=P,Ae=P=0,mt=null;he!==null&&Ae<k.length;Ae++){he.index>Ae?(mt=he,he=null):mt=he.sibling;var be=G(D,he,k[Ae],Y);if(be===null){he===null&&(he=mt);break}t&&he&&be.alternate===null&&i(D,he),P=p(be,P,Ae),fe===null?ae=be:fe.sibling=be,fe=be,he=mt}if(Ae===k.length)return s(D,he),Ze&&Zi(D,Ae),ae;if(he===null){for(;Ae<k.length;Ae++)he=$(D,k[Ae],Y),he!==null&&(P=p(he,P,Ae),fe===null?ae=he:fe.sibling=he,fe=he);return Ze&&Zi(D,Ae),ae}for(he=u(D,he);Ae<k.length;Ae++)mt=Q(he,D,Ae,k[Ae],Y),mt!==null&&(t&&mt.alternate!==null&&he.delete(mt.key===null?Ae:mt.key),P=p(mt,P,Ae),fe===null?ae=mt:fe.sibling=mt,fe=mt);return t&&he.forEach(function(ki){return i(D,ki)}),Ze&&Zi(D,Ae),ae}function re(D,P,k,Y){var ae=V(k);if(typeof ae!="function")throw Error(r(150));if(k=ae.call(k),k==null)throw Error(r(151));for(var fe=ae=null,he=P,Ae=P=0,mt=null,be=k.next();he!==null&&!be.done;Ae++,be=k.next()){he.index>Ae?(mt=he,he=null):mt=he.sibling;var ki=G(D,he,be.value,Y);if(ki===null){he===null&&(he=mt);break}t&&he&&ki.alternate===null&&i(D,he),P=p(ki,P,Ae),fe===null?ae=ki:fe.sibling=ki,fe=ki,he=mt}if(be.done)return s(D,he),Ze&&Zi(D,Ae),ae;if(he===null){for(;!be.done;Ae++,be=k.next())be=$(D,be.value,Y),be!==null&&(P=p(be,P,Ae),fe===null?ae=be:fe.sibling=be,fe=be);return Ze&&Zi(D,Ae),ae}for(he=u(D,he);!be.done;Ae++,be=k.next())be=Q(he,D,Ae,be.value,Y),be!==null&&(t&&be.alternate!==null&&he.delete(be.key===null?Ae:be.key),P=p(be,P,Ae),fe===null?ae=be:fe.sibling=be,fe=be);return t&&he.forEach(function(zS){return i(D,zS)}),Ze&&Zi(D,Ae),ae}function at(D,P,k,Y){if(typeof k=="object"&&k!==null&&k.type===j&&k.key===null&&(k=k.props.children),typeof k=="object"&&k!==null){switch(k.$$typeof){case x:e:{for(var ae=k.key,fe=P;fe!==null;){if(fe.key===ae){if(ae=k.type,ae===j){if(fe.tag===7){s(D,fe.sibling),P=f(fe,k.props.children),P.return=D,D=P;break e}}else if(fe.elementType===ae||typeof ae=="object"&&ae!==null&&ae.$$typeof===ye&&gp(ae)===fe.type){s(D,fe.sibling),P=f(fe,k.props),P.ref=ns(D,fe,k),P.return=D,D=P;break e}s(D,fe);break}else i(D,fe);fe=fe.sibling}k.type===j?(P=sr(k.props.children,D.mode,Y,k.key),P.return=D,D=P):(Y=il(k.type,k.key,k.props,null,D.mode,Y),Y.ref=ns(D,P,k),Y.return=D,D=Y)}return v(D);case L:e:{for(fe=k.key;P!==null;){if(P.key===fe)if(P.tag===4&&P.stateNode.containerInfo===k.containerInfo&&P.stateNode.implementation===k.implementation){s(D,P.sibling),P=f(P,k.children||[]),P.return=D,D=P;break e}else{s(D,P);break}else i(D,P);P=P.sibling}P=td(k,D.mode,Y),P.return=D,D=P}return v(D);case ye:return fe=k._init,at(D,P,fe(k._payload),Y)}if(Fn(k))return J(D,P,k,Y);if(V(k))return re(D,P,k,Y);Ma(D,k)}return typeof k=="string"&&k!==""||typeof k=="number"?(k=""+k,P!==null&&P.tag===6?(s(D,P.sibling),P=f(P,k),P.return=D,D=P):(s(D,P),P=ed(k,D.mode,Y),P.return=D,D=P),v(D)):s(D,P)}return at}var Wr=mp(!0),vp=mp(!1),Fa=Ti(null),Ua=null,Yr=null,cc=null;function dc(){cc=Yr=Ua=null}function fc(t){var i=Fa.current;Xe(Fa),t._currentValue=i}function hc(t,i,s){for(;t!==null;){var u=t.alternate;if((t.childLanes&i)!==i?(t.childLanes|=i,u!==null&&(u.childLanes|=i)):u!==null&&(u.childLanes&i)!==i&&(u.childLanes|=i),t===s)break;t=t.return}}function jr(t,i){Ua=t,cc=Yr=null,t=t.dependencies,t!==null&&t.firstContext!==null&&((t.lanes&i)!==0&&(Yt=!0),t.firstContext=null)}function ln(t){var i=t._currentValue;if(cc!==t)if(t={context:t,memoizedValue:i,next:null},Yr===null){if(Ua===null)throw Error(r(308));Yr=t,Ua.dependencies={lanes:0,firstContext:t}}else Yr=Yr.next=t;return i}var Ji=null;function pc(t){Ji===null?Ji=[t]:Ji.push(t)}function yp(t,i,s,u){var f=i.interleaved;return f===null?(s.next=s,pc(i)):(s.next=f.next,f.next=s),i.interleaved=s,Zn(t,u)}function Zn(t,i){t.lanes|=i;var s=t.alternate;for(s!==null&&(s.lanes|=i),s=t,t=t.return;t!==null;)t.childLanes|=i,s=t.alternate,s!==null&&(s.childLanes|=i),s=t,t=t.return;return s.tag===3?s.stateNode:null}var wi=!1;function gc(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Sp(t,i){t=t.updateQueue,i.updateQueue===t&&(i.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function Jn(t,i){return{eventTime:t,lane:i,tag:0,payload:null,callback:null,next:null}}function _i(t,i,s){var u=t.updateQueue;if(u===null)return null;if(u=u.shared,(Be&2)!==0){var f=u.pending;return f===null?i.next=i:(i.next=f.next,f.next=i),u.pending=i,Zn(t,s)}return f=u.interleaved,f===null?(i.next=i,pc(u)):(i.next=f.next,f.next=i),u.interleaved=i,Zn(t,s)}function La(t,i,s){if(i=i.updateQueue,i!==null&&(i=i.shared,(s&4194240)!==0)){var u=i.lanes;u&=t.pendingLanes,s|=u,i.lanes=s,Nu(t,s)}}function Ap(t,i){var s=t.updateQueue,u=t.alternate;if(u!==null&&(u=u.updateQueue,s===u)){var f=null,p=null;if(s=s.firstBaseUpdate,s!==null){do{var v={eventTime:s.eventTime,lane:s.lane,tag:s.tag,payload:s.payload,callback:s.callback,next:null};p===null?f=p=v:p=p.next=v,s=s.next}while(s!==null);p===null?f=p=i:p=p.next=i}else f=p=i;s={baseState:u.baseState,firstBaseUpdate:f,lastBaseUpdate:p,shared:u.shared,effects:u.effects},t.updateQueue=s;return}t=s.lastBaseUpdate,t===null?s.firstBaseUpdate=i:t.next=i,s.lastBaseUpdate=i}function Ha(t,i,s,u){var f=t.updateQueue;wi=!1;var p=f.firstBaseUpdate,v=f.lastBaseUpdate,A=f.shared.pending;if(A!==null){f.shared.pending=null;var _=A,M=_.next;_.next=null,v===null?p=M:v.next=M,v=_;var b=t.alternate;b!==null&&(b=b.updateQueue,A=b.lastBaseUpdate,A!==v&&(A===null?b.firstBaseUpdate=M:A.next=M,b.lastBaseUpdate=_))}if(p!==null){var $=f.baseState;v=0,b=M=_=null,A=p;do{var G=A.lane,Q=A.eventTime;if((u&G)===G){b!==null&&(b=b.next={eventTime:Q,lane:0,tag:A.tag,payload:A.payload,callback:A.callback,next:null});e:{var J=t,re=A;switch(G=i,Q=s,re.tag){case 1:if(J=re.payload,typeof J=="function"){$=J.call(Q,$,G);break e}$=J;break e;case 3:J.flags=J.flags&-65537|128;case 0:if(J=re.payload,G=typeof J=="function"?J.call(Q,$,G):J,G==null)break e;$=W({},$,G);break e;case 2:wi=!0}}A.callback!==null&&A.lane!==0&&(t.flags|=64,G=f.effects,G===null?f.effects=[A]:G.push(A))}else Q={eventTime:Q,lane:G,tag:A.tag,payload:A.payload,callback:A.callback,next:null},b===null?(M=b=Q,_=$):b=b.next=Q,v|=G;if(A=A.next,A===null){if(A=f.shared.pending,A===null)break;G=A,A=G.next,G.next=null,f.lastBaseUpdate=G,f.shared.pending=null}}while(!0);if(b===null&&(_=$),f.baseState=_,f.firstBaseUpdate=M,f.lastBaseUpdate=b,i=f.shared.interleaved,i!==null){f=i;do v|=f.lane,f=f.next;while(f!==i)}else p===null&&(f.shared.lanes=0);nr|=v,t.lanes=v,t.memoizedState=$}}function Tp(t,i,s){if(t=i.effects,i.effects=null,t!==null)for(i=0;i<t.length;i++){var u=t[i],f=u.callback;if(f!==null){if(u.callback=null,u=s,typeof f!="function")throw Error(r(191,f));f.call(u)}}}var is={},Hn=Ti(is),rs=Ti(is),os=Ti(is);function er(t){if(t===is)throw Error(r(174));return t}function mc(t,i){switch(Ye(os,i),Ye(rs,t),Ye(Hn,is),t=i.nodeType,t){case 9:case 11:i=(i=i.documentElement)?i.namespaceURI:vu(null,"");break;default:t=t===8?i.parentNode:i,i=t.namespaceURI||null,t=t.tagName,i=vu(i,t)}Xe(Hn),Ye(Hn,i)}function Vr(){Xe(Hn),Xe(rs),Xe(os)}function Ip(t){er(os.current);var i=er(Hn.current),s=vu(i,t.type);i!==s&&(Ye(rs,t),Ye(Hn,s))}function vc(t){rs.current===t&&(Xe(Hn),Xe(rs))}var it=Ti(0);function Ba(t){for(var i=t;i!==null;){if(i.tag===13){var s=i.memoizedState;if(s!==null&&(s=s.dehydrated,s===null||s.data==="$?"||s.data==="$!"))return i}else if(i.tag===19&&i.memoizedProps.revealOrder!==void 0){if((i.flags&128)!==0)return i}else if(i.child!==null){i.child.return=i,i=i.child;continue}if(i===t)break;for(;i.sibling===null;){if(i.return===null||i.return===t)return null;i=i.return}i.sibling.return=i.return,i=i.sibling}return null}var yc=[];function Sc(){for(var t=0;t<yc.length;t++)yc[t]._workInProgressVersionPrimary=null;yc.length=0}var Ga=B.ReactCurrentDispatcher,Ac=B.ReactCurrentBatchConfig,tr=0,rt=null,ft=null,pt=null,ba=!1,ss=!1,as=0,dS=0;function Nt(){throw Error(r(321))}function Tc(t,i){if(i===null)return!1;for(var s=0;s<i.length&&s<t.length;s++)if(!yn(t[s],i[s]))return!1;return!0}function Ic(t,i,s,u,f,p){if(tr=p,rt=i,i.memoizedState=null,i.updateQueue=null,i.lanes=0,Ga.current=t===null||t.memoizedState===null?gS:mS,t=s(u,f),ss){p=0;do{if(ss=!1,as=0,25<=p)throw Error(r(301));p+=1,pt=ft=null,i.updateQueue=null,Ga.current=vS,t=s(u,f)}while(ss)}if(Ga.current=za,i=ft!==null&&ft.next!==null,tr=0,pt=ft=rt=null,ba=!1,i)throw Error(r(300));return t}function Ec(){var t=as!==0;return as=0,t}function Bn(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return pt===null?rt.memoizedState=pt=t:pt=pt.next=t,pt}function un(){if(ft===null){var t=rt.alternate;t=t!==null?t.memoizedState:null}else t=ft.next;var i=pt===null?rt.memoizedState:pt.next;if(i!==null)pt=i,ft=t;else{if(t===null)throw Error(r(310));ft=t,t={memoizedState:ft.memoizedState,baseState:ft.baseState,baseQueue:ft.baseQueue,queue:ft.queue,next:null},pt===null?rt.memoizedState=pt=t:pt=pt.next=t}return pt}function ls(t,i){return typeof i=="function"?i(t):i}function wc(t){var i=un(),s=i.queue;if(s===null)throw Error(r(311));s.lastRenderedReducer=t;var u=ft,f=u.baseQueue,p=s.pending;if(p!==null){if(f!==null){var v=f.next;f.next=p.next,p.next=v}u.baseQueue=f=p,s.pending=null}if(f!==null){p=f.next,u=u.baseState;var A=v=null,_=null,M=p;do{var b=M.lane;if((tr&b)===b)_!==null&&(_=_.next={lane:0,action:M.action,hasEagerState:M.hasEagerState,eagerState:M.eagerState,next:null}),u=M.hasEagerState?M.eagerState:t(u,M.action);else{var $={lane:b,action:M.action,hasEagerState:M.hasEagerState,eagerState:M.eagerState,next:null};_===null?(A=_=$,v=u):_=_.next=$,rt.lanes|=b,nr|=b}M=M.next}while(M!==null&&M!==p);_===null?v=u:_.next=A,yn(u,i.memoizedState)||(Yt=!0),i.memoizedState=u,i.baseState=v,i.baseQueue=_,s.lastRenderedState=u}if(t=s.interleaved,t!==null){f=t;do p=f.lane,rt.lanes|=p,nr|=p,f=f.next;while(f!==t)}else f===null&&(s.lanes=0);return[i.memoizedState,s.dispatch]}function _c(t){var i=un(),s=i.queue;if(s===null)throw Error(r(311));s.lastRenderedReducer=t;var u=s.dispatch,f=s.pending,p=i.memoizedState;if(f!==null){s.pending=null;var v=f=f.next;do p=t(p,v.action),v=v.next;while(v!==f);yn(p,i.memoizedState)||(Yt=!0),i.memoizedState=p,i.baseQueue===null&&(i.baseState=p),s.lastRenderedState=p}return[p,u]}function Ep(){}function wp(t,i){var s=rt,u=un(),f=i(),p=!yn(u.memoizedState,f);if(p&&(u.memoizedState=f,Yt=!0),u=u.queue,Cc(Rp.bind(null,s,u,t),[t]),u.getSnapshot!==i||p||pt!==null&&pt.memoizedState.tag&1){if(s.flags|=2048,us(9,Cp.bind(null,s,u,f,i),void 0,null),gt===null)throw Error(r(349));(tr&30)!==0||_p(s,i,f)}return f}function _p(t,i,s){t.flags|=16384,t={getSnapshot:i,value:s},i=rt.updateQueue,i===null?(i={lastEffect:null,stores:null},rt.updateQueue=i,i.stores=[t]):(s=i.stores,s===null?i.stores=[t]:s.push(t))}function Cp(t,i,s,u){i.value=s,i.getSnapshot=u,Pp(i)&&Np(t)}function Rp(t,i,s){return s(function(){Pp(i)&&Np(t)})}function Pp(t){var i=t.getSnapshot;t=t.value;try{var s=i();return!yn(t,s)}catch{return!0}}function Np(t){var i=Zn(t,1);i!==null&&En(i,t,1,-1)}function Op(t){var i=Bn();return typeof t=="function"&&(t=t()),i.memoizedState=i.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:ls,lastRenderedState:t},i.queue=t,t=t.dispatch=pS.bind(null,rt,t),[i.memoizedState,t]}function us(t,i,s,u){return t={tag:t,create:i,destroy:s,deps:u,next:null},i=rt.updateQueue,i===null?(i={lastEffect:null,stores:null},rt.updateQueue=i,i.lastEffect=t.next=t):(s=i.lastEffect,s===null?i.lastEffect=t.next=t:(u=s.next,s.next=t,t.next=u,i.lastEffect=t)),t}function Dp(){return un().memoizedState}function xa(t,i,s,u){var f=Bn();rt.flags|=t,f.memoizedState=us(1|i,s,void 0,u===void 0?null:u)}function $a(t,i,s,u){var f=un();u=u===void 0?null:u;var p=void 0;if(ft!==null){var v=ft.memoizedState;if(p=v.destroy,u!==null&&Tc(u,v.deps)){f.memoizedState=us(i,s,p,u);return}}rt.flags|=t,f.memoizedState=us(1|i,s,p,u)}function kp(t,i){return xa(8390656,8,t,i)}function Cc(t,i){return $a(2048,8,t,i)}function Mp(t,i){return $a(4,2,t,i)}function Fp(t,i){return $a(4,4,t,i)}function Up(t,i){if(typeof i=="function")return t=t(),i(t),function(){i(null)};if(i!=null)return t=t(),i.current=t,function(){i.current=null}}function Lp(t,i,s){return s=s!=null?s.concat([t]):null,$a(4,4,Up.bind(null,i,t),s)}function Rc(){}function Hp(t,i){var s=un();i=i===void 0?null:i;var u=s.memoizedState;return u!==null&&i!==null&&Tc(i,u[1])?u[0]:(s.memoizedState=[t,i],t)}function Bp(t,i){var s=un();i=i===void 0?null:i;var u=s.memoizedState;return u!==null&&i!==null&&Tc(i,u[1])?u[0]:(t=t(),s.memoizedState=[t,i],t)}function Gp(t,i,s){return(tr&21)===0?(t.baseState&&(t.baseState=!1,Yt=!0),t.memoizedState=s):(yn(s,i)||(s=gh(),rt.lanes|=s,nr|=s,t.baseState=!0),i)}function fS(t,i){var s=ze;ze=s!==0&&4>s?s:4,t(!0);var u=Ac.transition;Ac.transition={};try{t(!1),i()}finally{ze=s,Ac.transition=u}}function bp(){return un().memoizedState}function hS(t,i,s){var u=Ni(t);if(s={lane:u,action:s,hasEagerState:!1,eagerState:null,next:null},xp(t))$p(i,s);else if(s=yp(t,i,s,u),s!==null){var f=Ut();En(s,t,u,f),zp(s,i,u)}}function pS(t,i,s){var u=Ni(t),f={lane:u,action:s,hasEagerState:!1,eagerState:null,next:null};if(xp(t))$p(i,f);else{var p=t.alternate;if(t.lanes===0&&(p===null||p.lanes===0)&&(p=i.lastRenderedReducer,p!==null))try{var v=i.lastRenderedState,A=p(v,s);if(f.hasEagerState=!0,f.eagerState=A,yn(A,v)){var _=i.interleaved;_===null?(f.next=f,pc(i)):(f.next=_.next,_.next=f),i.interleaved=f;return}}catch{}finally{}s=yp(t,i,f,u),s!==null&&(f=Ut(),En(s,t,u,f),zp(s,i,u))}}function xp(t){var i=t.alternate;return t===rt||i!==null&&i===rt}function $p(t,i){ss=ba=!0;var s=t.pending;s===null?i.next=i:(i.next=s.next,s.next=i),t.pending=i}function zp(t,i,s){if((s&4194240)!==0){var u=i.lanes;u&=t.pendingLanes,s|=u,i.lanes=s,Nu(t,s)}}var za={readContext:ln,useCallback:Nt,useContext:Nt,useEffect:Nt,useImperativeHandle:Nt,useInsertionEffect:Nt,useLayoutEffect:Nt,useMemo:Nt,useReducer:Nt,useRef:Nt,useState:Nt,useDebugValue:Nt,useDeferredValue:Nt,useTransition:Nt,useMutableSource:Nt,useSyncExternalStore:Nt,useId:Nt,unstable_isNewReconciler:!1},gS={readContext:ln,useCallback:function(t,i){return Bn().memoizedState=[t,i===void 0?null:i],t},useContext:ln,useEffect:kp,useImperativeHandle:function(t,i,s){return s=s!=null?s.concat([t]):null,xa(4194308,4,Up.bind(null,i,t),s)},useLayoutEffect:function(t,i){return xa(4194308,4,t,i)},useInsertionEffect:function(t,i){return xa(4,2,t,i)},useMemo:function(t,i){var s=Bn();return i=i===void 0?null:i,t=t(),s.memoizedState=[t,i],t},useReducer:function(t,i,s){var u=Bn();return i=s!==void 0?s(i):i,u.memoizedState=u.baseState=i,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:i},u.queue=t,t=t.dispatch=hS.bind(null,rt,t),[u.memoizedState,t]},useRef:function(t){var i=Bn();return t={current:t},i.memoizedState=t},useState:Op,useDebugValue:Rc,useDeferredValue:function(t){return Bn().memoizedState=t},useTransition:function(){var t=Op(!1),i=t[0];return t=fS.bind(null,t[1]),Bn().memoizedState=t,[i,t]},useMutableSource:function(){},useSyncExternalStore:function(t,i,s){var u=rt,f=Bn();if(Ze){if(s===void 0)throw Error(r(407));s=s()}else{if(s=i(),gt===null)throw Error(r(349));(tr&30)!==0||_p(u,i,s)}f.memoizedState=s;var p={value:s,getSnapshot:i};return f.queue=p,kp(Rp.bind(null,u,p,t),[t]),u.flags|=2048,us(9,Cp.bind(null,u,p,s,i),void 0,null),s},useId:function(){var t=Bn(),i=gt.identifierPrefix;if(Ze){var s=Qn,u=qn;s=(u&~(1<<32-vn(u)-1)).toString(32)+s,i=":"+i+"R"+s,s=as++,0<s&&(i+="H"+s.toString(32)),i+=":"}else s=dS++,i=":"+i+"r"+s.toString(32)+":";return t.memoizedState=i},unstable_isNewReconciler:!1},mS={readContext:ln,useCallback:Hp,useContext:ln,useEffect:Cc,useImperativeHandle:Lp,useInsertionEffect:Mp,useLayoutEffect:Fp,useMemo:Bp,useReducer:wc,useRef:Dp,useState:function(){return wc(ls)},useDebugValue:Rc,useDeferredValue:function(t){var i=un();return Gp(i,ft.memoizedState,t)},useTransition:function(){var t=wc(ls)[0],i=un().memoizedState;return[t,i]},useMutableSource:Ep,useSyncExternalStore:wp,useId:bp,unstable_isNewReconciler:!1},vS={readContext:ln,useCallback:Hp,useContext:ln,useEffect:Cc,useImperativeHandle:Lp,useInsertionEffect:Mp,useLayoutEffect:Fp,useMemo:Bp,useReducer:_c,useRef:Dp,useState:function(){return _c(ls)},useDebugValue:Rc,useDeferredValue:function(t){var i=un();return ft===null?i.memoizedState=t:Gp(i,ft.memoizedState,t)},useTransition:function(){var t=_c(ls)[0],i=un().memoizedState;return[t,i]},useMutableSource:Ep,useSyncExternalStore:wp,useId:bp,unstable_isNewReconciler:!1};function An(t,i){if(t&&t.defaultProps){i=W({},i),t=t.defaultProps;for(var s in t)i[s]===void 0&&(i[s]=t[s]);return i}return i}function Pc(t,i,s,u){i=t.memoizedState,s=s(u,i),s=s==null?i:W({},i,s),t.memoizedState=s,t.lanes===0&&(t.updateQueue.baseState=s)}var Wa={isMounted:function(t){return(t=t._reactInternals)?Xi(t)===t:!1},enqueueSetState:function(t,i,s){t=t._reactInternals;var u=Ut(),f=Ni(t),p=Jn(u,f);p.payload=i,s!=null&&(p.callback=s),i=_i(t,p,f),i!==null&&(En(i,t,f,u),La(i,t,f))},enqueueReplaceState:function(t,i,s){t=t._reactInternals;var u=Ut(),f=Ni(t),p=Jn(u,f);p.tag=1,p.payload=i,s!=null&&(p.callback=s),i=_i(t,p,f),i!==null&&(En(i,t,f,u),La(i,t,f))},enqueueForceUpdate:function(t,i){t=t._reactInternals;var s=Ut(),u=Ni(t),f=Jn(s,u);f.tag=2,i!=null&&(f.callback=i),i=_i(t,f,u),i!==null&&(En(i,t,u,s),La(i,t,u))}};function Wp(t,i,s,u,f,p,v){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(u,p,v):i.prototype&&i.prototype.isPureReactComponent?!Ko(s,u)||!Ko(f,p):!0}function Yp(t,i,s){var u=!1,f=Ii,p=i.contextType;return typeof p=="object"&&p!==null?p=ln(p):(f=Wt(i)?qi:Pt.current,u=i.contextTypes,p=(u=u!=null)?br(t,f):Ii),i=new i(s,p),t.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,i.updater=Wa,t.stateNode=i,i._reactInternals=t,u&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=f,t.__reactInternalMemoizedMaskedChildContext=p),i}function jp(t,i,s,u){t=i.state,typeof i.componentWillReceiveProps=="function"&&i.componentWillReceiveProps(s,u),typeof i.UNSAFE_componentWillReceiveProps=="function"&&i.UNSAFE_componentWillReceiveProps(s,u),i.state!==t&&Wa.enqueueReplaceState(i,i.state,null)}function Nc(t,i,s,u){var f=t.stateNode;f.props=s,f.state=t.memoizedState,f.refs={},gc(t);var p=i.contextType;typeof p=="object"&&p!==null?f.context=ln(p):(p=Wt(i)?qi:Pt.current,f.context=br(t,p)),f.state=t.memoizedState,p=i.getDerivedStateFromProps,typeof p=="function"&&(Pc(t,i,p,s),f.state=t.memoizedState),typeof i.getDerivedStateFromProps=="function"||typeof f.getSnapshotBeforeUpdate=="function"||typeof f.UNSAFE_componentWillMount!="function"&&typeof f.componentWillMount!="function"||(i=f.state,typeof f.componentWillMount=="function"&&f.componentWillMount(),typeof f.UNSAFE_componentWillMount=="function"&&f.UNSAFE_componentWillMount(),i!==f.state&&Wa.enqueueReplaceState(f,f.state,null),Ha(t,s,f,u),f.state=t.memoizedState),typeof f.componentDidMount=="function"&&(t.flags|=4194308)}function Xr(t,i){try{var s="",u=i;do s+=pe(u),u=u.return;while(u);var f=s}catch(p){f=`
Error generating stack: `+p.message+`
`+p.stack}return{value:t,source:i,stack:f,digest:null}}function Oc(t,i,s){return{value:t,source:null,stack:s??null,digest:i??null}}function Dc(t,i){try{console.error(i.value)}catch(s){setTimeout(function(){throw s})}}var yS=typeof WeakMap=="function"?WeakMap:Map;function Vp(t,i,s){s=Jn(-1,s),s.tag=3,s.payload={element:null};var u=i.value;return s.callback=function(){Qa||(Qa=!0,jc=u),Dc(t,i)},s}function Xp(t,i,s){s=Jn(-1,s),s.tag=3;var u=t.type.getDerivedStateFromError;if(typeof u=="function"){var f=i.value;s.payload=function(){return u(f)},s.callback=function(){Dc(t,i)}}var p=t.stateNode;return p!==null&&typeof p.componentDidCatch=="function"&&(s.callback=function(){Dc(t,i),typeof u!="function"&&(Ri===null?Ri=new Set([this]):Ri.add(this));var v=i.stack;this.componentDidCatch(i.value,{componentStack:v!==null?v:""})}),s}function Kp(t,i,s){var u=t.pingCache;if(u===null){u=t.pingCache=new yS;var f=new Set;u.set(i,f)}else f=u.get(i),f===void 0&&(f=new Set,u.set(i,f));f.has(s)||(f.add(s),t=kS.bind(null,t,i,s),i.then(t,t))}function qp(t){do{var i;if((i=t.tag===13)&&(i=t.memoizedState,i=i!==null?i.dehydrated!==null:!0),i)return t;t=t.return}while(t!==null);return null}function Qp(t,i,s,u,f){return(t.mode&1)===0?(t===i?t.flags|=65536:(t.flags|=128,s.flags|=131072,s.flags&=-52805,s.tag===1&&(s.alternate===null?s.tag=17:(i=Jn(-1,1),i.tag=2,_i(s,i,1))),s.lanes|=1),t):(t.flags|=65536,t.lanes=f,t)}var SS=B.ReactCurrentOwner,Yt=!1;function Ft(t,i,s,u){i.child=t===null?vp(i,null,s,u):Wr(i,t.child,s,u)}function Zp(t,i,s,u,f){s=s.render;var p=i.ref;return jr(i,f),u=Ic(t,i,s,u,p,f),s=Ec(),t!==null&&!Yt?(i.updateQueue=t.updateQueue,i.flags&=-2053,t.lanes&=~f,ei(t,i,f)):(Ze&&s&&oc(i),i.flags|=1,Ft(t,i,u,f),i.child)}function Jp(t,i,s,u,f){if(t===null){var p=s.type;return typeof p=="function"&&!Jc(p)&&p.defaultProps===void 0&&s.compare===null&&s.defaultProps===void 0?(i.tag=15,i.type=p,eg(t,i,p,u,f)):(t=il(s.type,null,u,i,i.mode,f),t.ref=i.ref,t.return=i,i.child=t)}if(p=t.child,(t.lanes&f)===0){var v=p.memoizedProps;if(s=s.compare,s=s!==null?s:Ko,s(v,u)&&t.ref===i.ref)return ei(t,i,f)}return i.flags|=1,t=Di(p,u),t.ref=i.ref,t.return=i,i.child=t}function eg(t,i,s,u,f){if(t!==null){var p=t.memoizedProps;if(Ko(p,u)&&t.ref===i.ref)if(Yt=!1,i.pendingProps=u=p,(t.lanes&f)!==0)(t.flags&131072)!==0&&(Yt=!0);else return i.lanes=t.lanes,ei(t,i,f)}return kc(t,i,s,u,f)}function tg(t,i,s){var u=i.pendingProps,f=u.children,p=t!==null?t.memoizedState:null;if(u.mode==="hidden")if((i.mode&1)===0)i.memoizedState={baseLanes:0,cachePool:null,transitions:null},Ye(qr,en),en|=s;else{if((s&1073741824)===0)return t=p!==null?p.baseLanes|s:s,i.lanes=i.childLanes=1073741824,i.memoizedState={baseLanes:t,cachePool:null,transitions:null},i.updateQueue=null,Ye(qr,en),en|=t,null;i.memoizedState={baseLanes:0,cachePool:null,transitions:null},u=p!==null?p.baseLanes:s,Ye(qr,en),en|=u}else p!==null?(u=p.baseLanes|s,i.memoizedState=null):u=s,Ye(qr,en),en|=u;return Ft(t,i,f,s),i.child}function ng(t,i){var s=i.ref;(t===null&&s!==null||t!==null&&t.ref!==s)&&(i.flags|=512,i.flags|=2097152)}function kc(t,i,s,u,f){var p=Wt(s)?qi:Pt.current;return p=br(i,p),jr(i,f),s=Ic(t,i,s,u,p,f),u=Ec(),t!==null&&!Yt?(i.updateQueue=t.updateQueue,i.flags&=-2053,t.lanes&=~f,ei(t,i,f)):(Ze&&u&&oc(i),i.flags|=1,Ft(t,i,s,f),i.child)}function ig(t,i,s,u,f){if(Wt(s)){var p=!0;Pa(i)}else p=!1;if(jr(i,f),i.stateNode===null)ja(t,i),Yp(i,s,u),Nc(i,s,u,f),u=!0;else if(t===null){var v=i.stateNode,A=i.memoizedProps;v.props=A;var _=v.context,M=s.contextType;typeof M=="object"&&M!==null?M=ln(M):(M=Wt(s)?qi:Pt.current,M=br(i,M));var b=s.getDerivedStateFromProps,$=typeof b=="function"||typeof v.getSnapshotBeforeUpdate=="function";$||typeof v.UNSAFE_componentWillReceiveProps!="function"&&typeof v.componentWillReceiveProps!="function"||(A!==u||_!==M)&&jp(i,v,u,M),wi=!1;var G=i.memoizedState;v.state=G,Ha(i,u,v,f),_=i.memoizedState,A!==u||G!==_||zt.current||wi?(typeof b=="function"&&(Pc(i,s,b,u),_=i.memoizedState),(A=wi||Wp(i,s,A,u,G,_,M))?($||typeof v.UNSAFE_componentWillMount!="function"&&typeof v.componentWillMount!="function"||(typeof v.componentWillMount=="function"&&v.componentWillMount(),typeof v.UNSAFE_componentWillMount=="function"&&v.UNSAFE_componentWillMount()),typeof v.componentDidMount=="function"&&(i.flags|=4194308)):(typeof v.componentDidMount=="function"&&(i.flags|=4194308),i.memoizedProps=u,i.memoizedState=_),v.props=u,v.state=_,v.context=M,u=A):(typeof v.componentDidMount=="function"&&(i.flags|=4194308),u=!1)}else{v=i.stateNode,Sp(t,i),A=i.memoizedProps,M=i.type===i.elementType?A:An(i.type,A),v.props=M,$=i.pendingProps,G=v.context,_=s.contextType,typeof _=="object"&&_!==null?_=ln(_):(_=Wt(s)?qi:Pt.current,_=br(i,_));var Q=s.getDerivedStateFromProps;(b=typeof Q=="function"||typeof v.getSnapshotBeforeUpdate=="function")||typeof v.UNSAFE_componentWillReceiveProps!="function"&&typeof v.componentWillReceiveProps!="function"||(A!==$||G!==_)&&jp(i,v,u,_),wi=!1,G=i.memoizedState,v.state=G,Ha(i,u,v,f);var J=i.memoizedState;A!==$||G!==J||zt.current||wi?(typeof Q=="function"&&(Pc(i,s,Q,u),J=i.memoizedState),(M=wi||Wp(i,s,M,u,G,J,_)||!1)?(b||typeof v.UNSAFE_componentWillUpdate!="function"&&typeof v.componentWillUpdate!="function"||(typeof v.componentWillUpdate=="function"&&v.componentWillUpdate(u,J,_),typeof v.UNSAFE_componentWillUpdate=="function"&&v.UNSAFE_componentWillUpdate(u,J,_)),typeof v.componentDidUpdate=="function"&&(i.flags|=4),typeof v.getSnapshotBeforeUpdate=="function"&&(i.flags|=1024)):(typeof v.componentDidUpdate!="function"||A===t.memoizedProps&&G===t.memoizedState||(i.flags|=4),typeof v.getSnapshotBeforeUpdate!="function"||A===t.memoizedProps&&G===t.memoizedState||(i.flags|=1024),i.memoizedProps=u,i.memoizedState=J),v.props=u,v.state=J,v.context=_,u=M):(typeof v.componentDidUpdate!="function"||A===t.memoizedProps&&G===t.memoizedState||(i.flags|=4),typeof v.getSnapshotBeforeUpdate!="function"||A===t.memoizedProps&&G===t.memoizedState||(i.flags|=1024),u=!1)}return Mc(t,i,s,u,p,f)}function Mc(t,i,s,u,f,p){ng(t,i);var v=(i.flags&128)!==0;if(!u&&!v)return f&&lp(i,s,!1),ei(t,i,p);u=i.stateNode,SS.current=i;var A=v&&typeof s.getDerivedStateFromError!="function"?null:u.render();return i.flags|=1,t!==null&&v?(i.child=Wr(i,t.child,null,p),i.child=Wr(i,null,A,p)):Ft(t,i,A,p),i.memoizedState=u.state,f&&lp(i,s,!0),i.child}function rg(t){var i=t.stateNode;i.pendingContext?sp(t,i.pendingContext,i.pendingContext!==i.context):i.context&&sp(t,i.context,!1),mc(t,i.containerInfo)}function og(t,i,s,u,f){return zr(),uc(f),i.flags|=256,Ft(t,i,s,u),i.child}var Fc={dehydrated:null,treeContext:null,retryLane:0};function Uc(t){return{baseLanes:t,cachePool:null,transitions:null}}function sg(t,i,s){var u=i.pendingProps,f=it.current,p=!1,v=(i.flags&128)!==0,A;if((A=v)||(A=t!==null&&t.memoizedState===null?!1:(f&2)!==0),A?(p=!0,i.flags&=-129):(t===null||t.memoizedState!==null)&&(f|=1),Ye(it,f&1),t===null)return lc(i),t=i.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?((i.mode&1)===0?i.lanes=1:t.data==="$!"?i.lanes=8:i.lanes=1073741824,null):(v=u.children,t=u.fallback,p?(u=i.mode,p=i.child,v={mode:"hidden",children:v},(u&1)===0&&p!==null?(p.childLanes=0,p.pendingProps=v):p=rl(v,u,0,null),t=sr(t,u,s,null),p.return=i,t.return=i,p.sibling=t,i.child=p,i.child.memoizedState=Uc(s),i.memoizedState=Fc,t):Lc(i,v));if(f=t.memoizedState,f!==null&&(A=f.dehydrated,A!==null))return AS(t,i,v,u,A,f,s);if(p){p=u.fallback,v=i.mode,f=t.child,A=f.sibling;var _={mode:"hidden",children:u.children};return(v&1)===0&&i.child!==f?(u=i.child,u.childLanes=0,u.pendingProps=_,i.deletions=null):(u=Di(f,_),u.subtreeFlags=f.subtreeFlags&14680064),A!==null?p=Di(A,p):(p=sr(p,v,s,null),p.flags|=2),p.return=i,u.return=i,u.sibling=p,i.child=u,u=p,p=i.child,v=t.child.memoizedState,v=v===null?Uc(s):{baseLanes:v.baseLanes|s,cachePool:null,transitions:v.transitions},p.memoizedState=v,p.childLanes=t.childLanes&~s,i.memoizedState=Fc,u}return p=t.child,t=p.sibling,u=Di(p,{mode:"visible",children:u.children}),(i.mode&1)===0&&(u.lanes=s),u.return=i,u.sibling=null,t!==null&&(s=i.deletions,s===null?(i.deletions=[t],i.flags|=16):s.push(t)),i.child=u,i.memoizedState=null,u}function Lc(t,i){return i=rl({mode:"visible",children:i},t.mode,0,null),i.return=t,t.child=i}function Ya(t,i,s,u){return u!==null&&uc(u),Wr(i,t.child,null,s),t=Lc(i,i.pendingProps.children),t.flags|=2,i.memoizedState=null,t}function AS(t,i,s,u,f,p,v){if(s)return i.flags&256?(i.flags&=-257,u=Oc(Error(r(422))),Ya(t,i,v,u)):i.memoizedState!==null?(i.child=t.child,i.flags|=128,null):(p=u.fallback,f=i.mode,u=rl({mode:"visible",children:u.children},f,0,null),p=sr(p,f,v,null),p.flags|=2,u.return=i,p.return=i,u.sibling=p,i.child=u,(i.mode&1)!==0&&Wr(i,t.child,null,v),i.child.memoizedState=Uc(v),i.memoizedState=Fc,p);if((i.mode&1)===0)return Ya(t,i,v,null);if(f.data==="$!"){if(u=f.nextSibling&&f.nextSibling.dataset,u)var A=u.dgst;return u=A,p=Error(r(419)),u=Oc(p,u,void 0),Ya(t,i,v,u)}if(A=(v&t.childLanes)!==0,Yt||A){if(u=gt,u!==null){switch(v&-v){case 4:f=2;break;case 16:f=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:f=32;break;case 536870912:f=268435456;break;default:f=0}f=(f&(u.suspendedLanes|v))!==0?0:f,f!==0&&f!==p.retryLane&&(p.retryLane=f,Zn(t,f),En(u,t,f,-1))}return Zc(),u=Oc(Error(r(421))),Ya(t,i,v,u)}return f.data==="$?"?(i.flags|=128,i.child=t.child,i=MS.bind(null,t),f._reactRetry=i,null):(t=p.treeContext,Jt=Ai(f.nextSibling),Zt=i,Ze=!0,Sn=null,t!==null&&(sn[an++]=qn,sn[an++]=Qn,sn[an++]=Qi,qn=t.id,Qn=t.overflow,Qi=i),i=Lc(i,u.children),i.flags|=4096,i)}function ag(t,i,s){t.lanes|=i;var u=t.alternate;u!==null&&(u.lanes|=i),hc(t.return,i,s)}function Hc(t,i,s,u,f){var p=t.memoizedState;p===null?t.memoizedState={isBackwards:i,rendering:null,renderingStartTime:0,last:u,tail:s,tailMode:f}:(p.isBackwards=i,p.rendering=null,p.renderingStartTime=0,p.last=u,p.tail=s,p.tailMode=f)}function lg(t,i,s){var u=i.pendingProps,f=u.revealOrder,p=u.tail;if(Ft(t,i,u.children,s),u=it.current,(u&2)!==0)u=u&1|2,i.flags|=128;else{if(t!==null&&(t.flags&128)!==0)e:for(t=i.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&ag(t,s,i);else if(t.tag===19)ag(t,s,i);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===i)break e;for(;t.sibling===null;){if(t.return===null||t.return===i)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}u&=1}if(Ye(it,u),(i.mode&1)===0)i.memoizedState=null;else switch(f){case"forwards":for(s=i.child,f=null;s!==null;)t=s.alternate,t!==null&&Ba(t)===null&&(f=s),s=s.sibling;s=f,s===null?(f=i.child,i.child=null):(f=s.sibling,s.sibling=null),Hc(i,!1,f,s,p);break;case"backwards":for(s=null,f=i.child,i.child=null;f!==null;){if(t=f.alternate,t!==null&&Ba(t)===null){i.child=f;break}t=f.sibling,f.sibling=s,s=f,f=t}Hc(i,!0,s,null,p);break;case"together":Hc(i,!1,null,null,void 0);break;default:i.memoizedState=null}return i.child}function ja(t,i){(i.mode&1)===0&&t!==null&&(t.alternate=null,i.alternate=null,i.flags|=2)}function ei(t,i,s){if(t!==null&&(i.dependencies=t.dependencies),nr|=i.lanes,(s&i.childLanes)===0)return null;if(t!==null&&i.child!==t.child)throw Error(r(153));if(i.child!==null){for(t=i.child,s=Di(t,t.pendingProps),i.child=s,s.return=i;t.sibling!==null;)t=t.sibling,s=s.sibling=Di(t,t.pendingProps),s.return=i;s.sibling=null}return i.child}function TS(t,i,s){switch(i.tag){case 3:rg(i),zr();break;case 5:Ip(i);break;case 1:Wt(i.type)&&Pa(i);break;case 4:mc(i,i.stateNode.containerInfo);break;case 10:var u=i.type._context,f=i.memoizedProps.value;Ye(Fa,u._currentValue),u._currentValue=f;break;case 13:if(u=i.memoizedState,u!==null)return u.dehydrated!==null?(Ye(it,it.current&1),i.flags|=128,null):(s&i.child.childLanes)!==0?sg(t,i,s):(Ye(it,it.current&1),t=ei(t,i,s),t!==null?t.sibling:null);Ye(it,it.current&1);break;case 19:if(u=(s&i.childLanes)!==0,(t.flags&128)!==0){if(u)return lg(t,i,s);i.flags|=128}if(f=i.memoizedState,f!==null&&(f.rendering=null,f.tail=null,f.lastEffect=null),Ye(it,it.current),u)break;return null;case 22:case 23:return i.lanes=0,tg(t,i,s)}return ei(t,i,s)}var ug,Bc,cg,dg;ug=function(t,i){for(var s=i.child;s!==null;){if(s.tag===5||s.tag===6)t.appendChild(s.stateNode);else if(s.tag!==4&&s.child!==null){s.child.return=s,s=s.child;continue}if(s===i)break;for(;s.sibling===null;){if(s.return===null||s.return===i)return;s=s.return}s.sibling.return=s.return,s=s.sibling}},Bc=function(){},cg=function(t,i,s,u){var f=t.memoizedProps;if(f!==u){t=i.stateNode,er(Hn.current);var p=null;switch(s){case"input":f=Qe(t,f),u=Qe(t,u),p=[];break;case"select":f=W({},f,{value:void 0}),u=W({},u,{value:void 0}),p=[];break;case"textarea":f=Vi(t,f),u=Vi(t,u),p=[];break;default:typeof f.onClick!="function"&&typeof u.onClick=="function"&&(t.onclick=_a)}yu(s,u);var v;s=null;for(M in f)if(!u.hasOwnProperty(M)&&f.hasOwnProperty(M)&&f[M]!=null)if(M==="style"){var A=f[M];for(v in A)A.hasOwnProperty(v)&&(s||(s={}),s[v]="")}else M!=="dangerouslySetInnerHTML"&&M!=="children"&&M!=="suppressContentEditableWarning"&&M!=="suppressHydrationWarning"&&M!=="autoFocus"&&(l.hasOwnProperty(M)?p||(p=[]):(p=p||[]).push(M,null));for(M in u){var _=u[M];if(A=f!=null?f[M]:void 0,u.hasOwnProperty(M)&&_!==A&&(_!=null||A!=null))if(M==="style")if(A){for(v in A)!A.hasOwnProperty(v)||_&&_.hasOwnProperty(v)||(s||(s={}),s[v]="");for(v in _)_.hasOwnProperty(v)&&A[v]!==_[v]&&(s||(s={}),s[v]=_[v])}else s||(p||(p=[]),p.push(M,s)),s=_;else M==="dangerouslySetInnerHTML"?(_=_?_.__html:void 0,A=A?A.__html:void 0,_!=null&&A!==_&&(p=p||[]).push(M,_)):M==="children"?typeof _!="string"&&typeof _!="number"||(p=p||[]).push(M,""+_):M!=="suppressContentEditableWarning"&&M!=="suppressHydrationWarning"&&(l.hasOwnProperty(M)?(_!=null&&M==="onScroll"&&Ve("scroll",t),p||A===_||(p=[])):(p=p||[]).push(M,_))}s&&(p=p||[]).push("style",s);var M=p;(i.updateQueue=M)&&(i.flags|=4)}},dg=function(t,i,s,u){s!==u&&(i.flags|=4)};function cs(t,i){if(!Ze)switch(t.tailMode){case"hidden":i=t.tail;for(var s=null;i!==null;)i.alternate!==null&&(s=i),i=i.sibling;s===null?t.tail=null:s.sibling=null;break;case"collapsed":s=t.tail;for(var u=null;s!==null;)s.alternate!==null&&(u=s),s=s.sibling;u===null?i||t.tail===null?t.tail=null:t.tail.sibling=null:u.sibling=null}}function Ot(t){var i=t.alternate!==null&&t.alternate.child===t.child,s=0,u=0;if(i)for(var f=t.child;f!==null;)s|=f.lanes|f.childLanes,u|=f.subtreeFlags&14680064,u|=f.flags&14680064,f.return=t,f=f.sibling;else for(f=t.child;f!==null;)s|=f.lanes|f.childLanes,u|=f.subtreeFlags,u|=f.flags,f.return=t,f=f.sibling;return t.subtreeFlags|=u,t.childLanes=s,i}function IS(t,i,s){var u=i.pendingProps;switch(sc(i),i.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Ot(i),null;case 1:return Wt(i.type)&&Ra(),Ot(i),null;case 3:return u=i.stateNode,Vr(),Xe(zt),Xe(Pt),Sc(),u.pendingContext&&(u.context=u.pendingContext,u.pendingContext=null),(t===null||t.child===null)&&(ka(i)?i.flags|=4:t===null||t.memoizedState.isDehydrated&&(i.flags&256)===0||(i.flags|=1024,Sn!==null&&(Kc(Sn),Sn=null))),Bc(t,i),Ot(i),null;case 5:vc(i);var f=er(os.current);if(s=i.type,t!==null&&i.stateNode!=null)cg(t,i,s,u,f),t.ref!==i.ref&&(i.flags|=512,i.flags|=2097152);else{if(!u){if(i.stateNode===null)throw Error(r(166));return Ot(i),null}if(t=er(Hn.current),ka(i)){u=i.stateNode,s=i.type;var p=i.memoizedProps;switch(u[Ln]=i,u[es]=p,t=(i.mode&1)!==0,s){case"dialog":Ve("cancel",u),Ve("close",u);break;case"iframe":case"object":case"embed":Ve("load",u);break;case"video":case"audio":for(f=0;f<Qo.length;f++)Ve(Qo[f],u);break;case"source":Ve("error",u);break;case"img":case"image":case"link":Ve("error",u),Ve("load",u);break;case"details":Ve("toggle",u);break;case"input":je(u,p),Ve("invalid",u);break;case"select":u._wrapperState={wasMultiple:!!p.multiple},Ve("invalid",u);break;case"textarea":Xf(u,p),Ve("invalid",u)}yu(s,p),f=null;for(var v in p)if(p.hasOwnProperty(v)){var A=p[v];v==="children"?typeof A=="string"?u.textContent!==A&&(p.suppressHydrationWarning!==!0&&wa(u.textContent,A,t),f=["children",A]):typeof A=="number"&&u.textContent!==""+A&&(p.suppressHydrationWarning!==!0&&wa(u.textContent,A,t),f=["children",""+A]):l.hasOwnProperty(v)&&A!=null&&v==="onScroll"&&Ve("scroll",u)}switch(s){case"input":Fe(u),on(u,p,!0);break;case"textarea":Fe(u),qf(u);break;case"select":case"option":break;default:typeof p.onClick=="function"&&(u.onclick=_a)}u=f,i.updateQueue=u,u!==null&&(i.flags|=4)}else{v=f.nodeType===9?f:f.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=Qf(s)),t==="http://www.w3.org/1999/xhtml"?s==="script"?(t=v.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof u.is=="string"?t=v.createElement(s,{is:u.is}):(t=v.createElement(s),s==="select"&&(v=t,u.multiple?v.multiple=!0:u.size&&(v.size=u.size))):t=v.createElementNS(t,s),t[Ln]=i,t[es]=u,ug(t,i,!1,!1),i.stateNode=t;e:{switch(v=Su(s,u),s){case"dialog":Ve("cancel",t),Ve("close",t),f=u;break;case"iframe":case"object":case"embed":Ve("load",t),f=u;break;case"video":case"audio":for(f=0;f<Qo.length;f++)Ve(Qo[f],t);f=u;break;case"source":Ve("error",t),f=u;break;case"img":case"image":case"link":Ve("error",t),Ve("load",t),f=u;break;case"details":Ve("toggle",t),f=u;break;case"input":je(t,u),f=Qe(t,u),Ve("invalid",t);break;case"option":f=u;break;case"select":t._wrapperState={wasMultiple:!!u.multiple},f=W({},u,{value:void 0}),Ve("invalid",t);break;case"textarea":Xf(t,u),f=Vi(t,u),Ve("invalid",t);break;default:f=u}yu(s,f),A=f;for(p in A)if(A.hasOwnProperty(p)){var _=A[p];p==="style"?eh(t,_):p==="dangerouslySetInnerHTML"?(_=_?_.__html:void 0,_!=null&&Zf(t,_)):p==="children"?typeof _=="string"?(s!=="textarea"||_!=="")&&ko(t,_):typeof _=="number"&&ko(t,""+_):p!=="suppressContentEditableWarning"&&p!=="suppressHydrationWarning"&&p!=="autoFocus"&&(l.hasOwnProperty(p)?_!=null&&p==="onScroll"&&Ve("scroll",t):_!=null&&O(t,p,_,v))}switch(s){case"input":Fe(t),on(t,u,!1);break;case"textarea":Fe(t),qf(t);break;case"option":u.value!=null&&t.setAttribute("value",""+ve(u.value));break;case"select":t.multiple=!!u.multiple,p=u.value,p!=null?hi(t,!!u.multiple,p,!1):u.defaultValue!=null&&hi(t,!!u.multiple,u.defaultValue,!0);break;default:typeof f.onClick=="function"&&(t.onclick=_a)}switch(s){case"button":case"input":case"select":case"textarea":u=!!u.autoFocus;break e;case"img":u=!0;break e;default:u=!1}}u&&(i.flags|=4)}i.ref!==null&&(i.flags|=512,i.flags|=2097152)}return Ot(i),null;case 6:if(t&&i.stateNode!=null)dg(t,i,t.memoizedProps,u);else{if(typeof u!="string"&&i.stateNode===null)throw Error(r(166));if(s=er(os.current),er(Hn.current),ka(i)){if(u=i.stateNode,s=i.memoizedProps,u[Ln]=i,(p=u.nodeValue!==s)&&(t=Zt,t!==null))switch(t.tag){case 3:wa(u.nodeValue,s,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&wa(u.nodeValue,s,(t.mode&1)!==0)}p&&(i.flags|=4)}else u=(s.nodeType===9?s:s.ownerDocument).createTextNode(u),u[Ln]=i,i.stateNode=u}return Ot(i),null;case 13:if(Xe(it),u=i.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(Ze&&Jt!==null&&(i.mode&1)!==0&&(i.flags&128)===0)pp(),zr(),i.flags|=98560,p=!1;else if(p=ka(i),u!==null&&u.dehydrated!==null){if(t===null){if(!p)throw Error(r(318));if(p=i.memoizedState,p=p!==null?p.dehydrated:null,!p)throw Error(r(317));p[Ln]=i}else zr(),(i.flags&128)===0&&(i.memoizedState=null),i.flags|=4;Ot(i),p=!1}else Sn!==null&&(Kc(Sn),Sn=null),p=!0;if(!p)return i.flags&65536?i:null}return(i.flags&128)!==0?(i.lanes=s,i):(u=u!==null,u!==(t!==null&&t.memoizedState!==null)&&u&&(i.child.flags|=8192,(i.mode&1)!==0&&(t===null||(it.current&1)!==0?ht===0&&(ht=3):Zc())),i.updateQueue!==null&&(i.flags|=4),Ot(i),null);case 4:return Vr(),Bc(t,i),t===null&&Zo(i.stateNode.containerInfo),Ot(i),null;case 10:return fc(i.type._context),Ot(i),null;case 17:return Wt(i.type)&&Ra(),Ot(i),null;case 19:if(Xe(it),p=i.memoizedState,p===null)return Ot(i),null;if(u=(i.flags&128)!==0,v=p.rendering,v===null)if(u)cs(p,!1);else{if(ht!==0||t!==null&&(t.flags&128)!==0)for(t=i.child;t!==null;){if(v=Ba(t),v!==null){for(i.flags|=128,cs(p,!1),u=v.updateQueue,u!==null&&(i.updateQueue=u,i.flags|=4),i.subtreeFlags=0,u=s,s=i.child;s!==null;)p=s,t=u,p.flags&=14680066,v=p.alternate,v===null?(p.childLanes=0,p.lanes=t,p.child=null,p.subtreeFlags=0,p.memoizedProps=null,p.memoizedState=null,p.updateQueue=null,p.dependencies=null,p.stateNode=null):(p.childLanes=v.childLanes,p.lanes=v.lanes,p.child=v.child,p.subtreeFlags=0,p.deletions=null,p.memoizedProps=v.memoizedProps,p.memoizedState=v.memoizedState,p.updateQueue=v.updateQueue,p.type=v.type,t=v.dependencies,p.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),s=s.sibling;return Ye(it,it.current&1|2),i.child}t=t.sibling}p.tail!==null&&st()>Qr&&(i.flags|=128,u=!0,cs(p,!1),i.lanes=4194304)}else{if(!u)if(t=Ba(v),t!==null){if(i.flags|=128,u=!0,s=t.updateQueue,s!==null&&(i.updateQueue=s,i.flags|=4),cs(p,!0),p.tail===null&&p.tailMode==="hidden"&&!v.alternate&&!Ze)return Ot(i),null}else 2*st()-p.renderingStartTime>Qr&&s!==1073741824&&(i.flags|=128,u=!0,cs(p,!1),i.lanes=4194304);p.isBackwards?(v.sibling=i.child,i.child=v):(s=p.last,s!==null?s.sibling=v:i.child=v,p.last=v)}return p.tail!==null?(i=p.tail,p.rendering=i,p.tail=i.sibling,p.renderingStartTime=st(),i.sibling=null,s=it.current,Ye(it,u?s&1|2:s&1),i):(Ot(i),null);case 22:case 23:return Qc(),u=i.memoizedState!==null,t!==null&&t.memoizedState!==null!==u&&(i.flags|=8192),u&&(i.mode&1)!==0?(en&1073741824)!==0&&(Ot(i),i.subtreeFlags&6&&(i.flags|=8192)):Ot(i),null;case 24:return null;case 25:return null}throw Error(r(156,i.tag))}function ES(t,i){switch(sc(i),i.tag){case 1:return Wt(i.type)&&Ra(),t=i.flags,t&65536?(i.flags=t&-65537|128,i):null;case 3:return Vr(),Xe(zt),Xe(Pt),Sc(),t=i.flags,(t&65536)!==0&&(t&128)===0?(i.flags=t&-65537|128,i):null;case 5:return vc(i),null;case 13:if(Xe(it),t=i.memoizedState,t!==null&&t.dehydrated!==null){if(i.alternate===null)throw Error(r(340));zr()}return t=i.flags,t&65536?(i.flags=t&-65537|128,i):null;case 19:return Xe(it),null;case 4:return Vr(),null;case 10:return fc(i.type._context),null;case 22:case 23:return Qc(),null;case 24:return null;default:return null}}var Va=!1,Dt=!1,wS=typeof WeakSet=="function"?WeakSet:Set,Z=null;function Kr(t,i){var s=t.ref;if(s!==null)if(typeof s=="function")try{s(null)}catch(u){ot(t,i,u)}else s.current=null}function Gc(t,i,s){try{s()}catch(u){ot(t,i,u)}}var fg=!1;function _S(t,i){if(Qu=ha,t=Wh(),zu(t)){if("selectionStart"in t)var s={start:t.selectionStart,end:t.selectionEnd};else e:{s=(s=t.ownerDocument)&&s.defaultView||window;var u=s.getSelection&&s.getSelection();if(u&&u.rangeCount!==0){s=u.anchorNode;var f=u.anchorOffset,p=u.focusNode;u=u.focusOffset;try{s.nodeType,p.nodeType}catch{s=null;break e}var v=0,A=-1,_=-1,M=0,b=0,$=t,G=null;t:for(;;){for(var Q;$!==s||f!==0&&$.nodeType!==3||(A=v+f),$!==p||u!==0&&$.nodeType!==3||(_=v+u),$.nodeType===3&&(v+=$.nodeValue.length),(Q=$.firstChild)!==null;)G=$,$=Q;for(;;){if($===t)break t;if(G===s&&++M===f&&(A=v),G===p&&++b===u&&(_=v),(Q=$.nextSibling)!==null)break;$=G,G=$.parentNode}$=Q}s=A===-1||_===-1?null:{start:A,end:_}}else s=null}s=s||{start:0,end:0}}else s=null;for(Zu={focusedElem:t,selectionRange:s},ha=!1,Z=i;Z!==null;)if(i=Z,t=i.child,(i.subtreeFlags&1028)!==0&&t!==null)t.return=i,Z=t;else for(;Z!==null;){i=Z;try{var J=i.alternate;if((i.flags&1024)!==0)switch(i.tag){case 0:case 11:case 15:break;case 1:if(J!==null){var re=J.memoizedProps,at=J.memoizedState,D=i.stateNode,P=D.getSnapshotBeforeUpdate(i.elementType===i.type?re:An(i.type,re),at);D.__reactInternalSnapshotBeforeUpdate=P}break;case 3:var k=i.stateNode.containerInfo;k.nodeType===1?k.textContent="":k.nodeType===9&&k.documentElement&&k.removeChild(k.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(r(163))}}catch(Y){ot(i,i.return,Y)}if(t=i.sibling,t!==null){t.return=i.return,Z=t;break}Z=i.return}return J=fg,fg=!1,J}function ds(t,i,s){var u=i.updateQueue;if(u=u!==null?u.lastEffect:null,u!==null){var f=u=u.next;do{if((f.tag&t)===t){var p=f.destroy;f.destroy=void 0,p!==void 0&&Gc(i,s,p)}f=f.next}while(f!==u)}}function Xa(t,i){if(i=i.updateQueue,i=i!==null?i.lastEffect:null,i!==null){var s=i=i.next;do{if((s.tag&t)===t){var u=s.create;s.destroy=u()}s=s.next}while(s!==i)}}function bc(t){var i=t.ref;if(i!==null){var s=t.stateNode;switch(t.tag){case 5:t=s;break;default:t=s}typeof i=="function"?i(t):i.current=t}}function hg(t){var i=t.alternate;i!==null&&(t.alternate=null,hg(i)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(i=t.stateNode,i!==null&&(delete i[Ln],delete i[es],delete i[nc],delete i[aS],delete i[lS])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function pg(t){return t.tag===5||t.tag===3||t.tag===4}function gg(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||pg(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function xc(t,i,s){var u=t.tag;if(u===5||u===6)t=t.stateNode,i?s.nodeType===8?s.parentNode.insertBefore(t,i):s.insertBefore(t,i):(s.nodeType===8?(i=s.parentNode,i.insertBefore(t,s)):(i=s,i.appendChild(t)),s=s._reactRootContainer,s!=null||i.onclick!==null||(i.onclick=_a));else if(u!==4&&(t=t.child,t!==null))for(xc(t,i,s),t=t.sibling;t!==null;)xc(t,i,s),t=t.sibling}function $c(t,i,s){var u=t.tag;if(u===5||u===6)t=t.stateNode,i?s.insertBefore(t,i):s.appendChild(t);else if(u!==4&&(t=t.child,t!==null))for($c(t,i,s),t=t.sibling;t!==null;)$c(t,i,s),t=t.sibling}var Tt=null,Tn=!1;function Ci(t,i,s){for(s=s.child;s!==null;)mg(t,i,s),s=s.sibling}function mg(t,i,s){if(Un&&typeof Un.onCommitFiberUnmount=="function")try{Un.onCommitFiberUnmount(aa,s)}catch{}switch(s.tag){case 5:Dt||Kr(s,i);case 6:var u=Tt,f=Tn;Tt=null,Ci(t,i,s),Tt=u,Tn=f,Tt!==null&&(Tn?(t=Tt,s=s.stateNode,t.nodeType===8?t.parentNode.removeChild(s):t.removeChild(s)):Tt.removeChild(s.stateNode));break;case 18:Tt!==null&&(Tn?(t=Tt,s=s.stateNode,t.nodeType===8?tc(t.parentNode,s):t.nodeType===1&&tc(t,s),zo(t)):tc(Tt,s.stateNode));break;case 4:u=Tt,f=Tn,Tt=s.stateNode.containerInfo,Tn=!0,Ci(t,i,s),Tt=u,Tn=f;break;case 0:case 11:case 14:case 15:if(!Dt&&(u=s.updateQueue,u!==null&&(u=u.lastEffect,u!==null))){f=u=u.next;do{var p=f,v=p.destroy;p=p.tag,v!==void 0&&((p&2)!==0||(p&4)!==0)&&Gc(s,i,v),f=f.next}while(f!==u)}Ci(t,i,s);break;case 1:if(!Dt&&(Kr(s,i),u=s.stateNode,typeof u.componentWillUnmount=="function"))try{u.props=s.memoizedProps,u.state=s.memoizedState,u.componentWillUnmount()}catch(A){ot(s,i,A)}Ci(t,i,s);break;case 21:Ci(t,i,s);break;case 22:s.mode&1?(Dt=(u=Dt)||s.memoizedState!==null,Ci(t,i,s),Dt=u):Ci(t,i,s);break;default:Ci(t,i,s)}}function vg(t){var i=t.updateQueue;if(i!==null){t.updateQueue=null;var s=t.stateNode;s===null&&(s=t.stateNode=new wS),i.forEach(function(u){var f=FS.bind(null,t,u);s.has(u)||(s.add(u),u.then(f,f))})}}function In(t,i){var s=i.deletions;if(s!==null)for(var u=0;u<s.length;u++){var f=s[u];try{var p=t,v=i,A=v;e:for(;A!==null;){switch(A.tag){case 5:Tt=A.stateNode,Tn=!1;break e;case 3:Tt=A.stateNode.containerInfo,Tn=!0;break e;case 4:Tt=A.stateNode.containerInfo,Tn=!0;break e}A=A.return}if(Tt===null)throw Error(r(160));mg(p,v,f),Tt=null,Tn=!1;var _=f.alternate;_!==null&&(_.return=null),f.return=null}catch(M){ot(f,i,M)}}if(i.subtreeFlags&12854)for(i=i.child;i!==null;)yg(i,t),i=i.sibling}function yg(t,i){var s=t.alternate,u=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(In(i,t),Gn(t),u&4){try{ds(3,t,t.return),Xa(3,t)}catch(re){ot(t,t.return,re)}try{ds(5,t,t.return)}catch(re){ot(t,t.return,re)}}break;case 1:In(i,t),Gn(t),u&512&&s!==null&&Kr(s,s.return);break;case 5:if(In(i,t),Gn(t),u&512&&s!==null&&Kr(s,s.return),t.flags&32){var f=t.stateNode;try{ko(f,"")}catch(re){ot(t,t.return,re)}}if(u&4&&(f=t.stateNode,f!=null)){var p=t.memoizedProps,v=s!==null?s.memoizedProps:p,A=t.type,_=t.updateQueue;if(t.updateQueue=null,_!==null)try{A==="input"&&p.type==="radio"&&p.name!=null&&kn(f,p),Su(A,v);var M=Su(A,p);for(v=0;v<_.length;v+=2){var b=_[v],$=_[v+1];b==="style"?eh(f,$):b==="dangerouslySetInnerHTML"?Zf(f,$):b==="children"?ko(f,$):O(f,b,$,M)}switch(A){case"input":$t(f,p);break;case"textarea":Kf(f,p);break;case"select":var G=f._wrapperState.wasMultiple;f._wrapperState.wasMultiple=!!p.multiple;var Q=p.value;Q!=null?hi(f,!!p.multiple,Q,!1):G!==!!p.multiple&&(p.defaultValue!=null?hi(f,!!p.multiple,p.defaultValue,!0):hi(f,!!p.multiple,p.multiple?[]:"",!1))}f[es]=p}catch(re){ot(t,t.return,re)}}break;case 6:if(In(i,t),Gn(t),u&4){if(t.stateNode===null)throw Error(r(162));f=t.stateNode,p=t.memoizedProps;try{f.nodeValue=p}catch(re){ot(t,t.return,re)}}break;case 3:if(In(i,t),Gn(t),u&4&&s!==null&&s.memoizedState.isDehydrated)try{zo(i.containerInfo)}catch(re){ot(t,t.return,re)}break;case 4:In(i,t),Gn(t);break;case 13:In(i,t),Gn(t),f=t.child,f.flags&8192&&(p=f.memoizedState!==null,f.stateNode.isHidden=p,!p||f.alternate!==null&&f.alternate.memoizedState!==null||(Yc=st())),u&4&&vg(t);break;case 22:if(b=s!==null&&s.memoizedState!==null,t.mode&1?(Dt=(M=Dt)||b,In(i,t),Dt=M):In(i,t),Gn(t),u&8192){if(M=t.memoizedState!==null,(t.stateNode.isHidden=M)&&!b&&(t.mode&1)!==0)for(Z=t,b=t.child;b!==null;){for($=Z=b;Z!==null;){switch(G=Z,Q=G.child,G.tag){case 0:case 11:case 14:case 15:ds(4,G,G.return);break;case 1:Kr(G,G.return);var J=G.stateNode;if(typeof J.componentWillUnmount=="function"){u=G,s=G.return;try{i=u,J.props=i.memoizedProps,J.state=i.memoizedState,J.componentWillUnmount()}catch(re){ot(u,s,re)}}break;case 5:Kr(G,G.return);break;case 22:if(G.memoizedState!==null){Tg($);continue}}Q!==null?(Q.return=G,Z=Q):Tg($)}b=b.sibling}e:for(b=null,$=t;;){if($.tag===5){if(b===null){b=$;try{f=$.stateNode,M?(p=f.style,typeof p.setProperty=="function"?p.setProperty("display","none","important"):p.display="none"):(A=$.stateNode,_=$.memoizedProps.style,v=_!=null&&_.hasOwnProperty("display")?_.display:null,A.style.display=Jf("display",v))}catch(re){ot(t,t.return,re)}}}else if($.tag===6){if(b===null)try{$.stateNode.nodeValue=M?"":$.memoizedProps}catch(re){ot(t,t.return,re)}}else if(($.tag!==22&&$.tag!==23||$.memoizedState===null||$===t)&&$.child!==null){$.child.return=$,$=$.child;continue}if($===t)break e;for(;$.sibling===null;){if($.return===null||$.return===t)break e;b===$&&(b=null),$=$.return}b===$&&(b=null),$.sibling.return=$.return,$=$.sibling}}break;case 19:In(i,t),Gn(t),u&4&&vg(t);break;case 21:break;default:In(i,t),Gn(t)}}function Gn(t){var i=t.flags;if(i&2){try{e:{for(var s=t.return;s!==null;){if(pg(s)){var u=s;break e}s=s.return}throw Error(r(160))}switch(u.tag){case 5:var f=u.stateNode;u.flags&32&&(ko(f,""),u.flags&=-33);var p=gg(t);$c(t,p,f);break;case 3:case 4:var v=u.stateNode.containerInfo,A=gg(t);xc(t,A,v);break;default:throw Error(r(161))}}catch(_){ot(t,t.return,_)}t.flags&=-3}i&4096&&(t.flags&=-4097)}function CS(t,i,s){Z=t,Sg(t)}function Sg(t,i,s){for(var u=(t.mode&1)!==0;Z!==null;){var f=Z,p=f.child;if(f.tag===22&&u){var v=f.memoizedState!==null||Va;if(!v){var A=f.alternate,_=A!==null&&A.memoizedState!==null||Dt;A=Va;var M=Dt;if(Va=v,(Dt=_)&&!M)for(Z=f;Z!==null;)v=Z,_=v.child,v.tag===22&&v.memoizedState!==null?Ig(f):_!==null?(_.return=v,Z=_):Ig(f);for(;p!==null;)Z=p,Sg(p),p=p.sibling;Z=f,Va=A,Dt=M}Ag(t)}else(f.subtreeFlags&8772)!==0&&p!==null?(p.return=f,Z=p):Ag(t)}}function Ag(t){for(;Z!==null;){var i=Z;if((i.flags&8772)!==0){var s=i.alternate;try{if((i.flags&8772)!==0)switch(i.tag){case 0:case 11:case 15:Dt||Xa(5,i);break;case 1:var u=i.stateNode;if(i.flags&4&&!Dt)if(s===null)u.componentDidMount();else{var f=i.elementType===i.type?s.memoizedProps:An(i.type,s.memoizedProps);u.componentDidUpdate(f,s.memoizedState,u.__reactInternalSnapshotBeforeUpdate)}var p=i.updateQueue;p!==null&&Tp(i,p,u);break;case 3:var v=i.updateQueue;if(v!==null){if(s=null,i.child!==null)switch(i.child.tag){case 5:s=i.child.stateNode;break;case 1:s=i.child.stateNode}Tp(i,v,s)}break;case 5:var A=i.stateNode;if(s===null&&i.flags&4){s=A;var _=i.memoizedProps;switch(i.type){case"button":case"input":case"select":case"textarea":_.autoFocus&&s.focus();break;case"img":_.src&&(s.src=_.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(i.memoizedState===null){var M=i.alternate;if(M!==null){var b=M.memoizedState;if(b!==null){var $=b.dehydrated;$!==null&&zo($)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(r(163))}Dt||i.flags&512&&bc(i)}catch(G){ot(i,i.return,G)}}if(i===t){Z=null;break}if(s=i.sibling,s!==null){s.return=i.return,Z=s;break}Z=i.return}}function Tg(t){for(;Z!==null;){var i=Z;if(i===t){Z=null;break}var s=i.sibling;if(s!==null){s.return=i.return,Z=s;break}Z=i.return}}function Ig(t){for(;Z!==null;){var i=Z;try{switch(i.tag){case 0:case 11:case 15:var s=i.return;try{Xa(4,i)}catch(_){ot(i,s,_)}break;case 1:var u=i.stateNode;if(typeof u.componentDidMount=="function"){var f=i.return;try{u.componentDidMount()}catch(_){ot(i,f,_)}}var p=i.return;try{bc(i)}catch(_){ot(i,p,_)}break;case 5:var v=i.return;try{bc(i)}catch(_){ot(i,v,_)}}}catch(_){ot(i,i.return,_)}if(i===t){Z=null;break}var A=i.sibling;if(A!==null){A.return=i.return,Z=A;break}Z=i.return}}var RS=Math.ceil,Ka=B.ReactCurrentDispatcher,zc=B.ReactCurrentOwner,cn=B.ReactCurrentBatchConfig,Be=0,gt=null,ut=null,It=0,en=0,qr=Ti(0),ht=0,fs=null,nr=0,qa=0,Wc=0,hs=null,jt=null,Yc=0,Qr=1/0,ti=null,Qa=!1,jc=null,Ri=null,Za=!1,Pi=null,Ja=0,ps=0,Vc=null,el=-1,tl=0;function Ut(){return(Be&6)!==0?st():el!==-1?el:el=st()}function Ni(t){return(t.mode&1)===0?1:(Be&2)!==0&&It!==0?It&-It:cS.transition!==null?(tl===0&&(tl=gh()),tl):(t=ze,t!==0||(t=window.event,t=t===void 0?16:wh(t.type)),t)}function En(t,i,s,u){if(50<ps)throw ps=0,Vc=null,Error(r(185));Bo(t,s,u),((Be&2)===0||t!==gt)&&(t===gt&&((Be&2)===0&&(qa|=s),ht===4&&Oi(t,It)),Vt(t,u),s===1&&Be===0&&(i.mode&1)===0&&(Qr=st()+500,Na&&Ei()))}function Vt(t,i){var s=t.callbackNode;cy(t,i);var u=ca(t,t===gt?It:0);if(u===0)s!==null&&fh(s),t.callbackNode=null,t.callbackPriority=0;else if(i=u&-u,t.callbackPriority!==i){if(s!=null&&fh(s),i===1)t.tag===0?uS(wg.bind(null,t)):up(wg.bind(null,t)),oS(function(){(Be&6)===0&&Ei()}),s=null;else{switch(mh(u)){case 1:s=Cu;break;case 4:s=hh;break;case 16:s=sa;break;case 536870912:s=ph;break;default:s=sa}s=kg(s,Eg.bind(null,t))}t.callbackPriority=i,t.callbackNode=s}}function Eg(t,i){if(el=-1,tl=0,(Be&6)!==0)throw Error(r(327));var s=t.callbackNode;if(Zr()&&t.callbackNode!==s)return null;var u=ca(t,t===gt?It:0);if(u===0)return null;if((u&30)!==0||(u&t.expiredLanes)!==0||i)i=nl(t,u);else{i=u;var f=Be;Be|=2;var p=Cg();(gt!==t||It!==i)&&(ti=null,Qr=st()+500,rr(t,i));do try{OS();break}catch(A){_g(t,A)}while(!0);dc(),Ka.current=p,Be=f,ut!==null?i=0:(gt=null,It=0,i=ht)}if(i!==0){if(i===2&&(f=Ru(t),f!==0&&(u=f,i=Xc(t,f))),i===1)throw s=fs,rr(t,0),Oi(t,u),Vt(t,st()),s;if(i===6)Oi(t,u);else{if(f=t.current.alternate,(u&30)===0&&!PS(f)&&(i=nl(t,u),i===2&&(p=Ru(t),p!==0&&(u=p,i=Xc(t,p))),i===1))throw s=fs,rr(t,0),Oi(t,u),Vt(t,st()),s;switch(t.finishedWork=f,t.finishedLanes=u,i){case 0:case 1:throw Error(r(345));case 2:or(t,jt,ti);break;case 3:if(Oi(t,u),(u&130023424)===u&&(i=Yc+500-st(),10<i)){if(ca(t,0)!==0)break;if(f=t.suspendedLanes,(f&u)!==u){Ut(),t.pingedLanes|=t.suspendedLanes&f;break}t.timeoutHandle=ec(or.bind(null,t,jt,ti),i);break}or(t,jt,ti);break;case 4:if(Oi(t,u),(u&4194240)===u)break;for(i=t.eventTimes,f=-1;0<u;){var v=31-vn(u);p=1<<v,v=i[v],v>f&&(f=v),u&=~p}if(u=f,u=st()-u,u=(120>u?120:480>u?480:1080>u?1080:1920>u?1920:3e3>u?3e3:4320>u?4320:1960*RS(u/1960))-u,10<u){t.timeoutHandle=ec(or.bind(null,t,jt,ti),u);break}or(t,jt,ti);break;case 5:or(t,jt,ti);break;default:throw Error(r(329))}}}return Vt(t,st()),t.callbackNode===s?Eg.bind(null,t):null}function Xc(t,i){var s=hs;return t.current.memoizedState.isDehydrated&&(rr(t,i).flags|=256),t=nl(t,i),t!==2&&(i=jt,jt=s,i!==null&&Kc(i)),t}function Kc(t){jt===null?jt=t:jt.push.apply(jt,t)}function PS(t){for(var i=t;;){if(i.flags&16384){var s=i.updateQueue;if(s!==null&&(s=s.stores,s!==null))for(var u=0;u<s.length;u++){var f=s[u],p=f.getSnapshot;f=f.value;try{if(!yn(p(),f))return!1}catch{return!1}}}if(s=i.child,i.subtreeFlags&16384&&s!==null)s.return=i,i=s;else{if(i===t)break;for(;i.sibling===null;){if(i.return===null||i.return===t)return!0;i=i.return}i.sibling.return=i.return,i=i.sibling}}return!0}function Oi(t,i){for(i&=~Wc,i&=~qa,t.suspendedLanes|=i,t.pingedLanes&=~i,t=t.expirationTimes;0<i;){var s=31-vn(i),u=1<<s;t[s]=-1,i&=~u}}function wg(t){if((Be&6)!==0)throw Error(r(327));Zr();var i=ca(t,0);if((i&1)===0)return Vt(t,st()),null;var s=nl(t,i);if(t.tag!==0&&s===2){var u=Ru(t);u!==0&&(i=u,s=Xc(t,u))}if(s===1)throw s=fs,rr(t,0),Oi(t,i),Vt(t,st()),s;if(s===6)throw Error(r(345));return t.finishedWork=t.current.alternate,t.finishedLanes=i,or(t,jt,ti),Vt(t,st()),null}function qc(t,i){var s=Be;Be|=1;try{return t(i)}finally{Be=s,Be===0&&(Qr=st()+500,Na&&Ei())}}function ir(t){Pi!==null&&Pi.tag===0&&(Be&6)===0&&Zr();var i=Be;Be|=1;var s=cn.transition,u=ze;try{if(cn.transition=null,ze=1,t)return t()}finally{ze=u,cn.transition=s,Be=i,(Be&6)===0&&Ei()}}function Qc(){en=qr.current,Xe(qr)}function rr(t,i){t.finishedWork=null,t.finishedLanes=0;var s=t.timeoutHandle;if(s!==-1&&(t.timeoutHandle=-1,rS(s)),ut!==null)for(s=ut.return;s!==null;){var u=s;switch(sc(u),u.tag){case 1:u=u.type.childContextTypes,u!=null&&Ra();break;case 3:Vr(),Xe(zt),Xe(Pt),Sc();break;case 5:vc(u);break;case 4:Vr();break;case 13:Xe(it);break;case 19:Xe(it);break;case 10:fc(u.type._context);break;case 22:case 23:Qc()}s=s.return}if(gt=t,ut=t=Di(t.current,null),It=en=i,ht=0,fs=null,Wc=qa=nr=0,jt=hs=null,Ji!==null){for(i=0;i<Ji.length;i++)if(s=Ji[i],u=s.interleaved,u!==null){s.interleaved=null;var f=u.next,p=s.pending;if(p!==null){var v=p.next;p.next=f,u.next=v}s.pending=u}Ji=null}return t}function _g(t,i){do{var s=ut;try{if(dc(),Ga.current=za,ba){for(var u=rt.memoizedState;u!==null;){var f=u.queue;f!==null&&(f.pending=null),u=u.next}ba=!1}if(tr=0,pt=ft=rt=null,ss=!1,as=0,zc.current=null,s===null||s.return===null){ht=1,fs=i,ut=null;break}e:{var p=t,v=s.return,A=s,_=i;if(i=It,A.flags|=32768,_!==null&&typeof _=="object"&&typeof _.then=="function"){var M=_,b=A,$=b.tag;if((b.mode&1)===0&&($===0||$===11||$===15)){var G=b.alternate;G?(b.updateQueue=G.updateQueue,b.memoizedState=G.memoizedState,b.lanes=G.lanes):(b.updateQueue=null,b.memoizedState=null)}var Q=qp(v);if(Q!==null){Q.flags&=-257,Qp(Q,v,A,p,i),Q.mode&1&&Kp(p,M,i),i=Q,_=M;var J=i.updateQueue;if(J===null){var re=new Set;re.add(_),i.updateQueue=re}else J.add(_);break e}else{if((i&1)===0){Kp(p,M,i),Zc();break e}_=Error(r(426))}}else if(Ze&&A.mode&1){var at=qp(v);if(at!==null){(at.flags&65536)===0&&(at.flags|=256),Qp(at,v,A,p,i),uc(Xr(_,A));break e}}p=_=Xr(_,A),ht!==4&&(ht=2),hs===null?hs=[p]:hs.push(p),p=v;do{switch(p.tag){case 3:p.flags|=65536,i&=-i,p.lanes|=i;var D=Vp(p,_,i);Ap(p,D);break e;case 1:A=_;var P=p.type,k=p.stateNode;if((p.flags&128)===0&&(typeof P.getDerivedStateFromError=="function"||k!==null&&typeof k.componentDidCatch=="function"&&(Ri===null||!Ri.has(k)))){p.flags|=65536,i&=-i,p.lanes|=i;var Y=Xp(p,A,i);Ap(p,Y);break e}}p=p.return}while(p!==null)}Pg(s)}catch(ae){i=ae,ut===s&&s!==null&&(ut=s=s.return);continue}break}while(!0)}function Cg(){var t=Ka.current;return Ka.current=za,t===null?za:t}function Zc(){(ht===0||ht===3||ht===2)&&(ht=4),gt===null||(nr&268435455)===0&&(qa&268435455)===0||Oi(gt,It)}function nl(t,i){var s=Be;Be|=2;var u=Cg();(gt!==t||It!==i)&&(ti=null,rr(t,i));do try{NS();break}catch(f){_g(t,f)}while(!0);if(dc(),Be=s,Ka.current=u,ut!==null)throw Error(r(261));return gt=null,It=0,ht}function NS(){for(;ut!==null;)Rg(ut)}function OS(){for(;ut!==null&&!ty();)Rg(ut)}function Rg(t){var i=Dg(t.alternate,t,en);t.memoizedProps=t.pendingProps,i===null?Pg(t):ut=i,zc.current=null}function Pg(t){var i=t;do{var s=i.alternate;if(t=i.return,(i.flags&32768)===0){if(s=IS(s,i,en),s!==null){ut=s;return}}else{if(s=ES(s,i),s!==null){s.flags&=32767,ut=s;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{ht=6,ut=null;return}}if(i=i.sibling,i!==null){ut=i;return}ut=i=t}while(i!==null);ht===0&&(ht=5)}function or(t,i,s){var u=ze,f=cn.transition;try{cn.transition=null,ze=1,DS(t,i,s,u)}finally{cn.transition=f,ze=u}return null}function DS(t,i,s,u){do Zr();while(Pi!==null);if((Be&6)!==0)throw Error(r(327));s=t.finishedWork;var f=t.finishedLanes;if(s===null)return null;if(t.finishedWork=null,t.finishedLanes=0,s===t.current)throw Error(r(177));t.callbackNode=null,t.callbackPriority=0;var p=s.lanes|s.childLanes;if(dy(t,p),t===gt&&(ut=gt=null,It=0),(s.subtreeFlags&2064)===0&&(s.flags&2064)===0||Za||(Za=!0,kg(sa,function(){return Zr(),null})),p=(s.flags&15990)!==0,(s.subtreeFlags&15990)!==0||p){p=cn.transition,cn.transition=null;var v=ze;ze=1;var A=Be;Be|=4,zc.current=null,_S(t,s),yg(s,t),Qy(Zu),ha=!!Qu,Zu=Qu=null,t.current=s,CS(s),ny(),Be=A,ze=v,cn.transition=p}else t.current=s;if(Za&&(Za=!1,Pi=t,Ja=f),p=t.pendingLanes,p===0&&(Ri=null),oy(s.stateNode),Vt(t,st()),i!==null)for(u=t.onRecoverableError,s=0;s<i.length;s++)f=i[s],u(f.value,{componentStack:f.stack,digest:f.digest});if(Qa)throw Qa=!1,t=jc,jc=null,t;return(Ja&1)!==0&&t.tag!==0&&Zr(),p=t.pendingLanes,(p&1)!==0?t===Vc?ps++:(ps=0,Vc=t):ps=0,Ei(),null}function Zr(){if(Pi!==null){var t=mh(Ja),i=cn.transition,s=ze;try{if(cn.transition=null,ze=16>t?16:t,Pi===null)var u=!1;else{if(t=Pi,Pi=null,Ja=0,(Be&6)!==0)throw Error(r(331));var f=Be;for(Be|=4,Z=t.current;Z!==null;){var p=Z,v=p.child;if((Z.flags&16)!==0){var A=p.deletions;if(A!==null){for(var _=0;_<A.length;_++){var M=A[_];for(Z=M;Z!==null;){var b=Z;switch(b.tag){case 0:case 11:case 15:ds(8,b,p)}var $=b.child;if($!==null)$.return=b,Z=$;else for(;Z!==null;){b=Z;var G=b.sibling,Q=b.return;if(hg(b),b===M){Z=null;break}if(G!==null){G.return=Q,Z=G;break}Z=Q}}}var J=p.alternate;if(J!==null){var re=J.child;if(re!==null){J.child=null;do{var at=re.sibling;re.sibling=null,re=at}while(re!==null)}}Z=p}}if((p.subtreeFlags&2064)!==0&&v!==null)v.return=p,Z=v;else e:for(;Z!==null;){if(p=Z,(p.flags&2048)!==0)switch(p.tag){case 0:case 11:case 15:ds(9,p,p.return)}var D=p.sibling;if(D!==null){D.return=p.return,Z=D;break e}Z=p.return}}var P=t.current;for(Z=P;Z!==null;){v=Z;var k=v.child;if((v.subtreeFlags&2064)!==0&&k!==null)k.return=v,Z=k;else e:for(v=P;Z!==null;){if(A=Z,(A.flags&2048)!==0)try{switch(A.tag){case 0:case 11:case 15:Xa(9,A)}}catch(ae){ot(A,A.return,ae)}if(A===v){Z=null;break e}var Y=A.sibling;if(Y!==null){Y.return=A.return,Z=Y;break e}Z=A.return}}if(Be=f,Ei(),Un&&typeof Un.onPostCommitFiberRoot=="function")try{Un.onPostCommitFiberRoot(aa,t)}catch{}u=!0}return u}finally{ze=s,cn.transition=i}}return!1}function Ng(t,i,s){i=Xr(s,i),i=Vp(t,i,1),t=_i(t,i,1),i=Ut(),t!==null&&(Bo(t,1,i),Vt(t,i))}function ot(t,i,s){if(t.tag===3)Ng(t,t,s);else for(;i!==null;){if(i.tag===3){Ng(i,t,s);break}else if(i.tag===1){var u=i.stateNode;if(typeof i.type.getDerivedStateFromError=="function"||typeof u.componentDidCatch=="function"&&(Ri===null||!Ri.has(u))){t=Xr(s,t),t=Xp(i,t,1),i=_i(i,t,1),t=Ut(),i!==null&&(Bo(i,1,t),Vt(i,t));break}}i=i.return}}function kS(t,i,s){var u=t.pingCache;u!==null&&u.delete(i),i=Ut(),t.pingedLanes|=t.suspendedLanes&s,gt===t&&(It&s)===s&&(ht===4||ht===3&&(It&130023424)===It&&500>st()-Yc?rr(t,0):Wc|=s),Vt(t,i)}function Og(t,i){i===0&&((t.mode&1)===0?i=1:(i=ua,ua<<=1,(ua&130023424)===0&&(ua=4194304)));var s=Ut();t=Zn(t,i),t!==null&&(Bo(t,i,s),Vt(t,s))}function MS(t){var i=t.memoizedState,s=0;i!==null&&(s=i.retryLane),Og(t,s)}function FS(t,i){var s=0;switch(t.tag){case 13:var u=t.stateNode,f=t.memoizedState;f!==null&&(s=f.retryLane);break;case 19:u=t.stateNode;break;default:throw Error(r(314))}u!==null&&u.delete(i),Og(t,s)}var Dg;Dg=function(t,i,s){if(t!==null)if(t.memoizedProps!==i.pendingProps||zt.current)Yt=!0;else{if((t.lanes&s)===0&&(i.flags&128)===0)return Yt=!1,TS(t,i,s);Yt=(t.flags&131072)!==0}else Yt=!1,Ze&&(i.flags&1048576)!==0&&cp(i,Da,i.index);switch(i.lanes=0,i.tag){case 2:var u=i.type;ja(t,i),t=i.pendingProps;var f=br(i,Pt.current);jr(i,s),f=Ic(null,i,u,t,f,s);var p=Ec();return i.flags|=1,typeof f=="object"&&f!==null&&typeof f.render=="function"&&f.$$typeof===void 0?(i.tag=1,i.memoizedState=null,i.updateQueue=null,Wt(u)?(p=!0,Pa(i)):p=!1,i.memoizedState=f.state!==null&&f.state!==void 0?f.state:null,gc(i),f.updater=Wa,i.stateNode=f,f._reactInternals=i,Nc(i,u,t,s),i=Mc(null,i,u,!0,p,s)):(i.tag=0,Ze&&p&&oc(i),Ft(null,i,f,s),i=i.child),i;case 16:u=i.elementType;e:{switch(ja(t,i),t=i.pendingProps,f=u._init,u=f(u._payload),i.type=u,f=i.tag=LS(u),t=An(u,t),f){case 0:i=kc(null,i,u,t,s);break e;case 1:i=ig(null,i,u,t,s);break e;case 11:i=Zp(null,i,u,t,s);break e;case 14:i=Jp(null,i,u,An(u.type,t),s);break e}throw Error(r(306,u,""))}return i;case 0:return u=i.type,f=i.pendingProps,f=i.elementType===u?f:An(u,f),kc(t,i,u,f,s);case 1:return u=i.type,f=i.pendingProps,f=i.elementType===u?f:An(u,f),ig(t,i,u,f,s);case 3:e:{if(rg(i),t===null)throw Error(r(387));u=i.pendingProps,p=i.memoizedState,f=p.element,Sp(t,i),Ha(i,u,null,s);var v=i.memoizedState;if(u=v.element,p.isDehydrated)if(p={element:u,isDehydrated:!1,cache:v.cache,pendingSuspenseBoundaries:v.pendingSuspenseBoundaries,transitions:v.transitions},i.updateQueue.baseState=p,i.memoizedState=p,i.flags&256){f=Xr(Error(r(423)),i),i=og(t,i,u,s,f);break e}else if(u!==f){f=Xr(Error(r(424)),i),i=og(t,i,u,s,f);break e}else for(Jt=Ai(i.stateNode.containerInfo.firstChild),Zt=i,Ze=!0,Sn=null,s=vp(i,null,u,s),i.child=s;s;)s.flags=s.flags&-3|4096,s=s.sibling;else{if(zr(),u===f){i=ei(t,i,s);break e}Ft(t,i,u,s)}i=i.child}return i;case 5:return Ip(i),t===null&&lc(i),u=i.type,f=i.pendingProps,p=t!==null?t.memoizedProps:null,v=f.children,Ju(u,f)?v=null:p!==null&&Ju(u,p)&&(i.flags|=32),ng(t,i),Ft(t,i,v,s),i.child;case 6:return t===null&&lc(i),null;case 13:return sg(t,i,s);case 4:return mc(i,i.stateNode.containerInfo),u=i.pendingProps,t===null?i.child=Wr(i,null,u,s):Ft(t,i,u,s),i.child;case 11:return u=i.type,f=i.pendingProps,f=i.elementType===u?f:An(u,f),Zp(t,i,u,f,s);case 7:return Ft(t,i,i.pendingProps,s),i.child;case 8:return Ft(t,i,i.pendingProps.children,s),i.child;case 12:return Ft(t,i,i.pendingProps.children,s),i.child;case 10:e:{if(u=i.type._context,f=i.pendingProps,p=i.memoizedProps,v=f.value,Ye(Fa,u._currentValue),u._currentValue=v,p!==null)if(yn(p.value,v)){if(p.children===f.children&&!zt.current){i=ei(t,i,s);break e}}else for(p=i.child,p!==null&&(p.return=i);p!==null;){var A=p.dependencies;if(A!==null){v=p.child;for(var _=A.firstContext;_!==null;){if(_.context===u){if(p.tag===1){_=Jn(-1,s&-s),_.tag=2;var M=p.updateQueue;if(M!==null){M=M.shared;var b=M.pending;b===null?_.next=_:(_.next=b.next,b.next=_),M.pending=_}}p.lanes|=s,_=p.alternate,_!==null&&(_.lanes|=s),hc(p.return,s,i),A.lanes|=s;break}_=_.next}}else if(p.tag===10)v=p.type===i.type?null:p.child;else if(p.tag===18){if(v=p.return,v===null)throw Error(r(341));v.lanes|=s,A=v.alternate,A!==null&&(A.lanes|=s),hc(v,s,i),v=p.sibling}else v=p.child;if(v!==null)v.return=p;else for(v=p;v!==null;){if(v===i){v=null;break}if(p=v.sibling,p!==null){p.return=v.return,v=p;break}v=v.return}p=v}Ft(t,i,f.children,s),i=i.child}return i;case 9:return f=i.type,u=i.pendingProps.children,jr(i,s),f=ln(f),u=u(f),i.flags|=1,Ft(t,i,u,s),i.child;case 14:return u=i.type,f=An(u,i.pendingProps),f=An(u.type,f),Jp(t,i,u,f,s);case 15:return eg(t,i,i.type,i.pendingProps,s);case 17:return u=i.type,f=i.pendingProps,f=i.elementType===u?f:An(u,f),ja(t,i),i.tag=1,Wt(u)?(t=!0,Pa(i)):t=!1,jr(i,s),Yp(i,u,f),Nc(i,u,f,s),Mc(null,i,u,!0,t,s);case 19:return lg(t,i,s);case 22:return tg(t,i,s)}throw Error(r(156,i.tag))};function kg(t,i){return dh(t,i)}function US(t,i,s,u){this.tag=t,this.key=s,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=i,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=u,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function dn(t,i,s,u){return new US(t,i,s,u)}function Jc(t){return t=t.prototype,!(!t||!t.isReactComponent)}function LS(t){if(typeof t=="function")return Jc(t)?1:0;if(t!=null){if(t=t.$$typeof,t===Me)return 11;if(t===He)return 14}return 2}function Di(t,i){var s=t.alternate;return s===null?(s=dn(t.tag,i,t.key,t.mode),s.elementType=t.elementType,s.type=t.type,s.stateNode=t.stateNode,s.alternate=t,t.alternate=s):(s.pendingProps=i,s.type=t.type,s.flags=0,s.subtreeFlags=0,s.deletions=null),s.flags=t.flags&14680064,s.childLanes=t.childLanes,s.lanes=t.lanes,s.child=t.child,s.memoizedProps=t.memoizedProps,s.memoizedState=t.memoizedState,s.updateQueue=t.updateQueue,i=t.dependencies,s.dependencies=i===null?null:{lanes:i.lanes,firstContext:i.firstContext},s.sibling=t.sibling,s.index=t.index,s.ref=t.ref,s}function il(t,i,s,u,f,p){var v=2;if(u=t,typeof t=="function")Jc(t)&&(v=1);else if(typeof t=="string")v=5;else e:switch(t){case j:return sr(s.children,f,p,i);case ie:v=8,f|=8;break;case _e:return t=dn(12,s,i,f|2),t.elementType=_e,t.lanes=p,t;case we:return t=dn(13,s,i,f),t.elementType=we,t.lanes=p,t;case ce:return t=dn(19,s,i,f),t.elementType=ce,t.lanes=p,t;case ee:return rl(s,f,p,i);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case Ce:v=10;break e;case xe:v=9;break e;case Me:v=11;break e;case He:v=14;break e;case ye:v=16,u=null;break e}throw Error(r(130,t==null?t:typeof t,""))}return i=dn(v,s,i,f),i.elementType=t,i.type=u,i.lanes=p,i}function sr(t,i,s,u){return t=dn(7,t,u,i),t.lanes=s,t}function rl(t,i,s,u){return t=dn(22,t,u,i),t.elementType=ee,t.lanes=s,t.stateNode={isHidden:!1},t}function ed(t,i,s){return t=dn(6,t,null,i),t.lanes=s,t}function td(t,i,s){return i=dn(4,t.children!==null?t.children:[],t.key,i),i.lanes=s,i.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},i}function HS(t,i,s,u,f){this.tag=i,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Pu(0),this.expirationTimes=Pu(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Pu(0),this.identifierPrefix=u,this.onRecoverableError=f,this.mutableSourceEagerHydrationData=null}function nd(t,i,s,u,f,p,v,A,_){return t=new HS(t,i,s,A,_),i===1?(i=1,p===!0&&(i|=8)):i=0,p=dn(3,null,null,i),t.current=p,p.stateNode=t,p.memoizedState={element:u,isDehydrated:s,cache:null,transitions:null,pendingSuspenseBoundaries:null},gc(p),t}function BS(t,i,s){var u=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:L,key:u==null?null:""+u,children:t,containerInfo:i,implementation:s}}function Mg(t){if(!t)return Ii;t=t._reactInternals;e:{if(Xi(t)!==t||t.tag!==1)throw Error(r(170));var i=t;do{switch(i.tag){case 3:i=i.stateNode.context;break e;case 1:if(Wt(i.type)){i=i.stateNode.__reactInternalMemoizedMergedChildContext;break e}}i=i.return}while(i!==null);throw Error(r(171))}if(t.tag===1){var s=t.type;if(Wt(s))return ap(t,s,i)}return i}function Fg(t,i,s,u,f,p,v,A,_){return t=nd(s,u,!0,t,f,p,v,A,_),t.context=Mg(null),s=t.current,u=Ut(),f=Ni(s),p=Jn(u,f),p.callback=i??null,_i(s,p,f),t.current.lanes=f,Bo(t,f,u),Vt(t,u),t}function ol(t,i,s,u){var f=i.current,p=Ut(),v=Ni(f);return s=Mg(s),i.context===null?i.context=s:i.pendingContext=s,i=Jn(p,v),i.payload={element:t},u=u===void 0?null:u,u!==null&&(i.callback=u),t=_i(f,i,v),t!==null&&(En(t,f,v,p),La(t,f,v)),v}function sl(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function Ug(t,i){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var s=t.retryLane;t.retryLane=s!==0&&s<i?s:i}}function id(t,i){Ug(t,i),(t=t.alternate)&&Ug(t,i)}function GS(){return null}var Lg=typeof reportError=="function"?reportError:function(t){console.error(t)};function rd(t){this._internalRoot=t}al.prototype.render=rd.prototype.render=function(t){var i=this._internalRoot;if(i===null)throw Error(r(409));ol(t,i,null,null)},al.prototype.unmount=rd.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var i=t.containerInfo;ir(function(){ol(null,t,null,null)}),i[Xn]=null}};function al(t){this._internalRoot=t}al.prototype.unstable_scheduleHydration=function(t){if(t){var i=Sh();t={blockedOn:null,target:t,priority:i};for(var s=0;s<vi.length&&i!==0&&i<vi[s].priority;s++);vi.splice(s,0,t),s===0&&Ih(t)}};function od(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function ll(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function Hg(){}function bS(t,i,s,u,f){if(f){if(typeof u=="function"){var p=u;u=function(){var M=sl(v);p.call(M)}}var v=Fg(i,u,t,0,null,!1,!1,"",Hg);return t._reactRootContainer=v,t[Xn]=v.current,Zo(t.nodeType===8?t.parentNode:t),ir(),v}for(;f=t.lastChild;)t.removeChild(f);if(typeof u=="function"){var A=u;u=function(){var M=sl(_);A.call(M)}}var _=nd(t,0,!1,null,null,!1,!1,"",Hg);return t._reactRootContainer=_,t[Xn]=_.current,Zo(t.nodeType===8?t.parentNode:t),ir(function(){ol(i,_,s,u)}),_}function ul(t,i,s,u,f){var p=s._reactRootContainer;if(p){var v=p;if(typeof f=="function"){var A=f;f=function(){var _=sl(v);A.call(_)}}ol(i,v,t,f)}else v=bS(s,i,t,f,u);return sl(v)}vh=function(t){switch(t.tag){case 3:var i=t.stateNode;if(i.current.memoizedState.isDehydrated){var s=Ho(i.pendingLanes);s!==0&&(Nu(i,s|1),Vt(i,st()),(Be&6)===0&&(Qr=st()+500,Ei()))}break;case 13:ir(function(){var u=Zn(t,1);if(u!==null){var f=Ut();En(u,t,1,f)}}),id(t,1)}},Ou=function(t){if(t.tag===13){var i=Zn(t,134217728);if(i!==null){var s=Ut();En(i,t,134217728,s)}id(t,134217728)}},yh=function(t){if(t.tag===13){var i=Ni(t),s=Zn(t,i);if(s!==null){var u=Ut();En(s,t,i,u)}id(t,i)}},Sh=function(){return ze},Ah=function(t,i){var s=ze;try{return ze=t,i()}finally{ze=s}},Iu=function(t,i,s){switch(i){case"input":if($t(t,s),i=s.name,s.type==="radio"&&i!=null){for(s=t;s.parentNode;)s=s.parentNode;for(s=s.querySelectorAll("input[name="+JSON.stringify(""+i)+'][type="radio"]'),i=0;i<s.length;i++){var u=s[i];if(u!==t&&u.form===t.form){var f=Ca(u);if(!f)throw Error(r(90));de(u),$t(u,f)}}}break;case"textarea":Kf(t,s);break;case"select":i=s.value,i!=null&&hi(t,!!s.multiple,i,!1)}},rh=qc,oh=ir;var xS={usingClientEntryPoint:!1,Events:[ts,Br,Ca,nh,ih,qc]},gs={findFiberByHostInstance:Ki,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},$S={bundleType:gs.bundleType,version:gs.version,rendererPackageName:gs.rendererPackageName,rendererConfig:gs.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:B.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=uh(t),t===null?null:t.stateNode},findFiberByHostInstance:gs.findFiberByHostInstance||GS,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var cl=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!cl.isDisabled&&cl.supportsFiber)try{aa=cl.inject($S),Un=cl}catch{}}return Xt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=xS,Xt.createPortal=function(t,i){var s=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!od(i))throw Error(r(200));return BS(t,i,null,s)},Xt.createRoot=function(t,i){if(!od(t))throw Error(r(299));var s=!1,u="",f=Lg;return i!=null&&(i.unstable_strictMode===!0&&(s=!0),i.identifierPrefix!==void 0&&(u=i.identifierPrefix),i.onRecoverableError!==void 0&&(f=i.onRecoverableError)),i=nd(t,1,!1,null,null,s,!1,u,f),t[Xn]=i.current,Zo(t.nodeType===8?t.parentNode:t),new rd(i)},Xt.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var i=t._reactInternals;if(i===void 0)throw typeof t.render=="function"?Error(r(188)):(t=Object.keys(t).join(","),Error(r(268,t)));return t=uh(i),t=t===null?null:t.stateNode,t},Xt.flushSync=function(t){return ir(t)},Xt.hydrate=function(t,i,s){if(!ll(i))throw Error(r(200));return ul(null,t,i,!0,s)},Xt.hydrateRoot=function(t,i,s){if(!od(t))throw Error(r(405));var u=s!=null&&s.hydratedSources||null,f=!1,p="",v=Lg;if(s!=null&&(s.unstable_strictMode===!0&&(f=!0),s.identifierPrefix!==void 0&&(p=s.identifierPrefix),s.onRecoverableError!==void 0&&(v=s.onRecoverableError)),i=Fg(i,null,t,1,s??null,f,!1,p,v),t[Xn]=i.current,Zo(t),u)for(t=0;t<u.length;t++)s=u[t],f=s._getVersion,f=f(s._source),i.mutableSourceEagerHydrationData==null?i.mutableSourceEagerHydrationData=[s,f]:i.mutableSourceEagerHydrationData.push(s,f);return new al(i)},Xt.render=function(t,i,s){if(!ll(i))throw Error(r(200));return ul(null,t,i,!1,s)},Xt.unmountComponentAtNode=function(t){if(!ll(t))throw Error(r(40));return t._reactRootContainer?(ir(function(){ul(null,null,t,!1,function(){t._reactRootContainer=null,t[Xn]=null})}),!0):!1},Xt.unstable_batchedUpdates=qc,Xt.unstable_renderSubtreeIntoContainer=function(t,i,s,u){if(!ll(s))throw Error(r(200));if(t==null||t._reactInternals===void 0)throw Error(r(38));return ul(t,i,s,!1,u)},Xt.version="18.3.1-next-f1338f8080-20240426",Xt}var Yg;function ZS(){if(Yg)return ld.exports;Yg=1;function e(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(n){console.error(n)}}return e(),ld.exports=QS(),ld.exports}var jg;function JS(){if(jg)return dl;jg=1;var e=ZS();return dl.createRoot=e.createRoot,dl.hydrateRoot=e.hydrateRoot,dl}var eA=JS();const tA=a0(eA);class nA{constructor(){this.ids=[],this.values=[],this.length=0}clear(){this.length=0}push(n,r){let o=this.length++;for(;o>0;){const l=o-1>>1,a=this.values[l];if(r>=a)break;this.ids[o]=this.ids[l],this.values[o]=a,o=l}this.ids[o]=n,this.values[o]=r}pop(){if(this.length===0)return;const n=this.ids[0];if(this.length--,this.length>0){const r=this.ids[0]=this.ids[this.length],o=this.values[0]=this.values[this.length],l=this.length>>1;let a=0;for(;a<l;){let c=(a<<1)+1;const d=c+1;let h=this.ids[c],g=this.values[c];const m=this.values[d];if(d<this.length&&m<g&&(c=d,h=this.ids[d],g=m),g>=o)break;this.ids[a]=h,this.values[a]=g,a=c}this.ids[a]=r,this.values[a]=o}return n}peek(){if(this.length!==0)return this.ids[0]}peekValue(){if(this.length!==0)return this.values[0]}shrink(){this.ids.length=this.values.length=this.length}}const Vg=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array],dd=3;class ff{static from(n,r=0){if(r%8!==0)throw new Error("byteOffset must be 8-byte aligned.");if(!n||n.byteLength===void 0||n.buffer)throw new Error("Data must be an instance of ArrayBuffer or SharedArrayBuffer.");const[o,l]=new Uint8Array(n,r+0,2);if(o!==251)throw new Error("Data does not appear to be in a Flatbush format.");const a=l>>4;if(a!==dd)throw new Error(`Got v${a} data when expected v${dd}.`);const c=Vg[l&15];if(!c)throw new Error("Unrecognized array type.");const[d]=new Uint16Array(n,r+2,1),[h]=new Uint32Array(n,r+4,1);return new ff(h,d,c,void 0,n,r)}constructor(n,r=16,o=Float64Array,l=ArrayBuffer,a,c=0){if(n===void 0)throw new Error("Missing required argument: numItems.");if(isNaN(n)||n<=0)throw new Error(`Unexpected numItems value: ${n}.`);this.numItems=+n,this.nodeSize=Math.min(Math.max(+r,2),65535),this.byteOffset=c;let d=n,h=d;this._levelBounds=[d*4];do d=Math.ceil(d/this.nodeSize),h+=d,this._levelBounds.push(h*4);while(d!==1);this.ArrayType=o,this.IndexArrayType=h<16384?Uint16Array:Uint32Array;const g=Vg.indexOf(this.ArrayType),m=h*4*this.ArrayType.BYTES_PER_ELEMENT;if(g<0)throw new Error(`Unexpected typed array class: ${o}.`);a&&a.byteLength!==void 0&&!a.buffer?(this.data=a,this._boxes=new this.ArrayType(this.data,c+8,h*4),this._indices=new this.IndexArrayType(this.data,c+8+m,h),this._pos=h*4,this.minX=this._boxes[this._pos-4],this.minY=this._boxes[this._pos-3],this.maxX=this._boxes[this._pos-2],this.maxY=this._boxes[this._pos-1]):(this.data=new l(8+m+h*this.IndexArrayType.BYTES_PER_ELEMENT),this._boxes=new this.ArrayType(this.data,8,h*4),this._indices=new this.IndexArrayType(this.data,8+m,h),this._pos=0,this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0,new Uint8Array(this.data,0,2).set([251,(dd<<4)+g]),new Uint16Array(this.data,2,1)[0]=r,new Uint32Array(this.data,4,1)[0]=n),this._queue=new nA}add(n,r,o=n,l=r){const a=this._pos>>2,c=this._boxes;return this._indices[a]=a,c[this._pos++]=n,c[this._pos++]=r,c[this._pos++]=o,c[this._pos++]=l,n<this.minX&&(this.minX=n),r<this.minY&&(this.minY=r),o>this.maxX&&(this.maxX=o),l>this.maxY&&(this.maxY=l),a}finish(){if(this._pos>>2!==this.numItems)throw new Error(`Added ${this._pos>>2} items when expected ${this.numItems}.`);const n=this._boxes;if(this.numItems<=this.nodeSize){n[this._pos++]=this.minX,n[this._pos++]=this.minY,n[this._pos++]=this.maxX,n[this._pos++]=this.maxY;return}const r=this.maxX-this.minX||1,o=this.maxY-this.minY||1,l=new Uint32Array(this.numItems),a=65535;for(let c=0,d=0;c<this.numItems;c++){const h=n[d++],g=n[d++],m=n[d++],y=n[d++],S=Math.floor(a*((h+m)/2-this.minX)/r),E=Math.floor(a*((g+y)/2-this.minY)/o);l[c]=rA(S,E)}$d(l,n,this._indices,0,this.numItems-1,this.nodeSize);for(let c=0,d=0;c<this._levelBounds.length-1;c++){const h=this._levelBounds[c];for(;d<h;){const g=d;let m=n[d++],y=n[d++],S=n[d++],E=n[d++];for(let I=1;I<this.nodeSize&&d<h;I++)m=Math.min(m,n[d++]),y=Math.min(y,n[d++]),S=Math.max(S,n[d++]),E=Math.max(E,n[d++]);this._indices[this._pos>>2]=g,n[this._pos++]=m,n[this._pos++]=y,n[this._pos++]=S,n[this._pos++]=E}}}search(n,r,o,l,a){if(this._pos!==this._boxes.length)throw new Error("Data not yet indexed - call index.finish().");let c=this._boxes.length-4;const d=[],h=[];for(;c!==void 0;){const g=Math.min(c+this.nodeSize*4,Kg(c,this._levelBounds));for(let m=c;m<g;m+=4){if(o<this._boxes[m]||l<this._boxes[m+1]||n>this._boxes[m+2]||r>this._boxes[m+3])continue;const y=this._indices[m>>2]|0;c>=this.numItems*4?d.push(y):(a===void 0||a(y))&&h.push(y)}c=d.pop()}return h}neighbors(n,r,o=1/0,l=1/0,a){if(this._pos!==this._boxes.length)throw new Error("Data not yet indexed - call index.finish().");let c=this._boxes.length-4;const d=this._queue,h=[],g=l*l;e:for(;c!==void 0;){const m=Math.min(c+this.nodeSize*4,Kg(c,this._levelBounds));for(let y=c;y<m;y+=4){const S=this._indices[y>>2]|0,E=Xg(n,this._boxes[y],this._boxes[y+2]),I=Xg(r,this._boxes[y+1],this._boxes[y+3]),T=E*E+I*I;T>g||(c>=this.numItems*4?d.push(S<<1,T):(a===void 0||a(S))&&d.push((S<<1)+1,T))}for(;d.length&&d.peek()&1;)if(d.peekValue()>g||(h.push(d.pop()>>1),h.length===o))break e;c=d.length?d.pop()>>1:void 0}return d.clear(),h}}function Xg(e,n,r){return e<n?n-e:e<=r?0:e-r}function Kg(e,n){let r=0,o=n.length-1;for(;r<o;){const l=r+o>>1;n[l]>e?o=l:r=l+1}return n[r]}function $d(e,n,r,o,l,a){if(Math.floor(o/a)>=Math.floor(l/a))return;const c=e[o+l>>1];let d=o-1,h=l+1;for(;;){do d++;while(e[d]<c);do h--;while(e[h]>c);if(d>=h)break;iA(e,n,r,d,h)}$d(e,n,r,o,h,a),$d(e,n,r,h+1,l,a)}function iA(e,n,r,o,l){const a=e[o];e[o]=e[l],e[l]=a;const c=4*o,d=4*l,h=n[c],g=n[c+1],m=n[c+2],y=n[c+3];n[c]=n[d],n[c+1]=n[d+1],n[c+2]=n[d+2],n[c+3]=n[d+3],n[d]=h,n[d+1]=g,n[d+2]=m,n[d+3]=y;const S=r[o];r[o]=r[l],r[l]=S}function rA(e,n){let r=e^n,o=65535^r,l=65535^(e|n),a=e&(n^65535),c=r|o>>1,d=r>>1^r,h=l>>1^o&a>>1^l,g=r&l>>1^a>>1^a;r=c,o=d,l=h,a=g,c=r&r>>2^o&o>>2,d=r&o>>2^o&(r^o)>>2,h^=r&l>>2^o&a>>2,g^=o&l>>2^(r^o)&a>>2,r=c,o=d,l=h,a=g,c=r&r>>4^o&o>>4,d=r&o>>4^o&(r^o)>>4,h^=r&l>>4^o&a>>4,g^=o&l>>4^(r^o)&a>>4,r=c,o=d,l=h,a=g,h^=r&l>>8^o&a>>8,g^=o&l>>8^(r^o)&a>>8,r=h^h>>1,o=g^g>>1;let m=e^n,y=o|65535^(m|r);return m=(m|m<<8)&16711935,m=(m|m<<4)&252645135,m=(m|m<<2)&858993459,m=(m|m<<1)&1431655765,y=(y|y<<8)&16711935,y=(y|y<<4)&252645135,y=(y|y<<2)&858993459,y=(y|y<<1)&1431655765,(y<<1|m)>>>0}function vs(e,n){if(e.length===0)return{byRect:()=>[],byRadius:()=>[],byProperty:()=>[],resetPropertyCache:()=>{},count:()=>0};const r=new ff(e.length),o=new Map;for(const a of e)r.add(a.position.x,a.position.y,a.position.x,a.position.y);return r.finish(),{byRect(a){return r.search(a.left,a.top,a.right,a.bottom).map(d=>e[d])},byRadius(a,c){return r.neighbors(a.x,a.y,void 0,c).map(h=>e[h])},byProperty(a,c){var d;if(!o.has(a)){const h=new Map;for(const g of e){const m=g[a];h.has(m)||h.set(m,[]),h.get(m).push(g)}o.set(a,h)}return((d=o.get(a))==null?void 0:d.get(c))||[]},resetPropertyCache(){o.clear()},count(){return e.length}}}function eu(e){const n=Object.values(e.entities.entities),r=n.filter(h=>h.type==="human"),o=n.filter(h=>h.type==="berryBush"),l=n.filter(h=>h.type==="corpse"),a=n.filter(h=>h.type==="prey"),c=n.filter(h=>h.type==="predator");return{...e,search:{human:vs(r),berryBush:vs(o),corpse:vs(l),prey:vs(a),predator:vs(c)}}}const oA="tribe-game-db",Wi="save-files",hf="tribe-game-save",zd=1;async function tu(e){try{const n={version:zd,savedAt:Date.now(),gameState:e},r=JSON.stringify(n),o=await aA(r);await uA(hf,o),console.log(`Game saved successfully. Size: ${(o.size/1024).toFixed(2)} KB`)}catch(n){throw console.error("Failed to save game:",n),n}}async function sA(){try{const e=await cA(hf);if(!e)return null;const n=await lA(e),r=JSON.parse(n);return r.version!==zd?(console.warn(`Save game version mismatch. Expected ${zd}, found ${r.version}. Discarding save.`),await Wd(),null):(console.log("Game loaded successfully."),eu(r.gameState))}catch(e){return console.error("Failed to load game:",e),await Wd(),null}}async function Wd(){try{await dA(hf),console.log("Saved game cleared.")}catch(e){console.error("Failed to clear saved game:",e)}}async function aA(e){const r=new Blob([e]).stream().pipeThrough(new CompressionStream("gzip"));return await new Response(r).blob()}async function lA(e){const n=e.stream().pipeThrough(new DecompressionStream("gzip"));return await new Response(n).text()}function pf(){return new Promise((e,n)=>{const r=indexedDB.open(oA,1);r.onupgradeneeded=o=>{const l=o.target.result;l.objectStoreNames.contains(Wi)||l.createObjectStore(Wi)},r.onsuccess=()=>e(r.result),r.onerror=()=>n(r.error)})}async function uA(e,n){const r=await pf();return new Promise((o,l)=>{const d=r.transaction(Wi,"readwrite").objectStore(Wi).put(n,e);d.onsuccess=()=>o(),d.onerror=()=>l(d.error)})}async function cA(e){const n=await pf();return new Promise((r,o)=>{const c=n.transaction(Wi,"readonly").objectStore(Wi).get(e);c.onsuccess=()=>r(c.result),c.onerror=()=>o(c.error)})}async function dA(e){const n=await pf();return new Promise((r,o)=>{const c=n.transaction(Wi,"readwrite").objectStore(Wi).delete(e);c.onsuccess=()=>r(),c.onerror=()=>o(c.error)})}const l0=Ie.createContext(void 0),fA=({initialAppState:e,children:n})=>{const[r,o]=Ie.useState(e),[l,a]=Ie.useState(void 0),[c,d]=Ie.useState(null),[h,g]=Ie.useState(!1);Ie.useEffect(()=>{sA().then(I=>{I&&d(I),g(!0)})},[]);const m=(I,T)=>{o(I),I==="gameOver"&&T?a(T):I!=="gameOver"&&a(void 0)},y=()=>{o("intro"),a(void 0),E()},S=I=>{tu(I),d(I)},E=()=>{Wd(),d(null)};return De.jsx(l0.Provider,{value:{appState:r,setAppState:m,returnToIntro:y,gameOverDetails:l,contextReady:h,savedGameState:c,setSavedGameState:d,saveCurrentGame:S,clearCurrentSave:E},children:n})},Ro=()=>{const e=Ie.useContext(l0);if(e===void 0)throw new Error("useGameContext must be used within a GameProvider");return e};var Mt=function(){return Mt=Object.assign||function(n){for(var r,o=1,l=arguments.length;o<l;o++){r=arguments[o];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(n[a]=r[a])}return n},Mt.apply(this,arguments)};function Hs(e,n,r){if(r||arguments.length===2)for(var o=0,l=n.length,a;o<l;o++)(a||!(o in n))&&(a||(a=Array.prototype.slice.call(n,0,o)),a[o]=n[o]);return e.concat(a||Array.prototype.slice.call(n))}var Ke="-ms-",Os="-moz-",$e="-webkit-",u0="comm",nu="rule",gf="decl",hA="@import",c0="@keyframes",pA="@layer",d0=Math.abs,mf=String.fromCharCode,Yd=Object.assign;function gA(e,n){return vt(e,0)^45?(((n<<2^vt(e,0))<<2^vt(e,1))<<2^vt(e,2))<<2^vt(e,3):0}function f0(e){return e.trim()}function ri(e,n){return(e=n.exec(e))?e[0]:e}function Oe(e,n,r){return e.replace(n,r)}function Ul(e,n,r){return e.indexOf(n,r)}function vt(e,n){return e.charCodeAt(n)|0}function mo(e,n,r){return e.slice(n,r)}function zn(e){return e.length}function h0(e){return e.length}function _s(e,n){return n.push(e),e}function mA(e,n){return e.map(n).join("")}function qg(e,n){return e.filter(function(r){return!ri(r,n)})}var iu=1,vo=1,p0=0,gn=0,ct=0,Po="";function ru(e,n,r,o,l,a,c,d){return{value:e,root:n,parent:r,type:o,props:l,children:a,line:iu,column:vo,length:c,return:"",siblings:d}}function Li(e,n){return Yd(ru("",null,null,"",null,null,0,e.siblings),e,{length:-e.length},n)}function Jr(e){for(;e.root;)e=Li(e.root,{children:[e]});_s(e,e.siblings)}function vA(){return ct}function yA(){return ct=gn>0?vt(Po,--gn):0,vo--,ct===10&&(vo=1,iu--),ct}function Pn(){return ct=gn<p0?vt(Po,gn++):0,vo++,ct===10&&(vo=1,iu++),ct}function mr(){return vt(Po,gn)}function Ll(){return gn}function ou(e,n){return mo(Po,e,n)}function jd(e){switch(e){case 0:case 9:case 10:case 13:case 32:return 5;case 33:case 43:case 44:case 47:case 62:case 64:case 126:case 59:case 123:case 125:return 4;case 58:return 3;case 34:case 39:case 40:case 91:return 2;case 41:case 93:return 1}return 0}function SA(e){return iu=vo=1,p0=zn(Po=e),gn=0,[]}function AA(e){return Po="",e}function fd(e){return f0(ou(gn-1,Vd(e===91?e+2:e===40?e+1:e)))}function TA(e){for(;(ct=mr())&&ct<33;)Pn();return jd(e)>2||jd(ct)>3?"":" "}function IA(e,n){for(;--n&&Pn()&&!(ct<48||ct>102||ct>57&&ct<65||ct>70&&ct<97););return ou(e,Ll()+(n<6&&mr()==32&&Pn()==32))}function Vd(e){for(;Pn();)switch(ct){case e:return gn;case 34:case 39:e!==34&&e!==39&&Vd(ct);break;case 40:e===41&&Vd(e);break;case 92:Pn();break}return gn}function EA(e,n){for(;Pn()&&e+ct!==57;)if(e+ct===84&&mr()===47)break;return"/*"+ou(n,gn-1)+"*"+mf(e===47?e:Pn())}function wA(e){for(;!jd(mr());)Pn();return ou(e,gn)}function _A(e){return AA(Hl("",null,null,null,[""],e=SA(e),0,[0],e))}function Hl(e,n,r,o,l,a,c,d,h){for(var g=0,m=0,y=c,S=0,E=0,I=0,T=1,C=1,U=1,H=0,O="",B=l,x=a,L=o,j=O;C;)switch(I=H,H=Pn()){case 40:if(I!=108&&vt(j,y-1)==58){Ul(j+=Oe(fd(H),"&","&\f"),"&\f",d0(g?d[g-1]:0))!=-1&&(U=-1);break}case 34:case 39:case 91:j+=fd(H);break;case 9:case 10:case 13:case 32:j+=TA(I);break;case 92:j+=IA(Ll()-1,7);continue;case 47:switch(mr()){case 42:case 47:_s(CA(EA(Pn(),Ll()),n,r,h),h);break;default:j+="/"}break;case 123*T:d[g++]=zn(j)*U;case 125*T:case 59:case 0:switch(H){case 0:case 125:C=0;case 59+m:U==-1&&(j=Oe(j,/\f/g,"")),E>0&&zn(j)-y&&_s(E>32?Zg(j+";",o,r,y-1,h):Zg(Oe(j," ","")+";",o,r,y-2,h),h);break;case 59:j+=";";default:if(_s(L=Qg(j,n,r,g,m,l,d,O,B=[],x=[],y,a),a),H===123)if(m===0)Hl(j,n,L,L,B,a,y,d,x);else switch(S===99&&vt(j,3)===110?100:S){case 100:case 108:case 109:case 115:Hl(e,L,L,o&&_s(Qg(e,L,L,0,0,l,d,O,l,B=[],y,x),x),l,x,y,d,o?B:x);break;default:Hl(j,L,L,L,[""],x,0,d,x)}}g=m=E=0,T=U=1,O=j="",y=c;break;case 58:y=1+zn(j),E=I;default:if(T<1){if(H==123)--T;else if(H==125&&T++==0&&yA()==125)continue}switch(j+=mf(H),H*T){case 38:U=m>0?1:(j+="\f",-1);break;case 44:d[g++]=(zn(j)-1)*U,U=1;break;case 64:mr()===45&&(j+=fd(Pn())),S=mr(),m=y=zn(O=j+=wA(Ll())),H++;break;case 45:I===45&&zn(j)==2&&(T=0)}}return a}function Qg(e,n,r,o,l,a,c,d,h,g,m,y){for(var S=l-1,E=l===0?a:[""],I=h0(E),T=0,C=0,U=0;T<o;++T)for(var H=0,O=mo(e,S+1,S=d0(C=c[T])),B=e;H<I;++H)(B=f0(C>0?E[H]+" "+O:Oe(O,/&\f/g,E[H])))&&(h[U++]=B);return ru(e,n,r,l===0?nu:d,h,g,m,y)}function CA(e,n,r,o){return ru(e,n,r,u0,mf(vA()),mo(e,2,-2),0,o)}function Zg(e,n,r,o,l){return ru(e,n,r,gf,mo(e,0,o),mo(e,o+1,-1),o,l)}function g0(e,n,r){switch(gA(e,n)){case 5103:return $e+"print-"+e+e;case 5737:case 4201:case 3177:case 3433:case 1641:case 4457:case 2921:case 5572:case 6356:case 5844:case 3191:case 6645:case 3005:case 6391:case 5879:case 5623:case 6135:case 4599:case 4855:case 4215:case 6389:case 5109:case 5365:case 5621:case 3829:return $e+e+e;case 4789:return Os+e+e;case 5349:case 4246:case 4810:case 6968:case 2756:return $e+e+Os+e+Ke+e+e;case 5936:switch(vt(e,n+11)){case 114:return $e+e+Ke+Oe(e,/[svh]\w+-[tblr]{2}/,"tb")+e;case 108:return $e+e+Ke+Oe(e,/[svh]\w+-[tblr]{2}/,"tb-rl")+e;case 45:return $e+e+Ke+Oe(e,/[svh]\w+-[tblr]{2}/,"lr")+e}case 6828:case 4268:case 2903:return $e+e+Ke+e+e;case 6165:return $e+e+Ke+"flex-"+e+e;case 5187:return $e+e+Oe(e,/(\w+).+(:[^]+)/,$e+"box-$1$2"+Ke+"flex-$1$2")+e;case 5443:return $e+e+Ke+"flex-item-"+Oe(e,/flex-|-self/g,"")+(ri(e,/flex-|baseline/)?"":Ke+"grid-row-"+Oe(e,/flex-|-self/g,""))+e;case 4675:return $e+e+Ke+"flex-line-pack"+Oe(e,/align-content|flex-|-self/g,"")+e;case 5548:return $e+e+Ke+Oe(e,"shrink","negative")+e;case 5292:return $e+e+Ke+Oe(e,"basis","preferred-size")+e;case 6060:return $e+"box-"+Oe(e,"-grow","")+$e+e+Ke+Oe(e,"grow","positive")+e;case 4554:return $e+Oe(e,/([^-])(transform)/g,"$1"+$e+"$2")+e;case 6187:return Oe(Oe(Oe(e,/(zoom-|grab)/,$e+"$1"),/(image-set)/,$e+"$1"),e,"")+e;case 5495:case 3959:return Oe(e,/(image-set\([^]*)/,$e+"$1$`$1");case 4968:return Oe(Oe(e,/(.+:)(flex-)?(.*)/,$e+"box-pack:$3"+Ke+"flex-pack:$3"),/s.+-b[^;]+/,"justify")+$e+e+e;case 4200:if(!ri(e,/flex-|baseline/))return Ke+"grid-column-align"+mo(e,n)+e;break;case 2592:case 3360:return Ke+Oe(e,"template-","")+e;case 4384:case 3616:return r&&r.some(function(o,l){return n=l,ri(o.props,/grid-\w+-end/)})?~Ul(e+(r=r[n].value),"span",0)?e:Ke+Oe(e,"-start","")+e+Ke+"grid-row-span:"+(~Ul(r,"span",0)?ri(r,/\d+/):+ri(r,/\d+/)-+ri(e,/\d+/))+";":Ke+Oe(e,"-start","")+e;case 4896:case 4128:return r&&r.some(function(o){return ri(o.props,/grid-\w+-start/)})?e:Ke+Oe(Oe(e,"-end","-span"),"span ","")+e;case 4095:case 3583:case 4068:case 2532:return Oe(e,/(.+)-inline(.+)/,$e+"$1$2")+e;case 8116:case 7059:case 5753:case 5535:case 5445:case 5701:case 4933:case 4677:case 5533:case 5789:case 5021:case 4765:if(zn(e)-1-n>6)switch(vt(e,n+1)){case 109:if(vt(e,n+4)!==45)break;case 102:return Oe(e,/(.+:)(.+)-([^]+)/,"$1"+$e+"$2-$3$1"+Os+(vt(e,n+3)==108?"$3":"$2-$3"))+e;case 115:return~Ul(e,"stretch",0)?g0(Oe(e,"stretch","fill-available"),n,r)+e:e}break;case 5152:case 5920:return Oe(e,/(.+?):(\d+)(\s*\/\s*(span)?\s*(\d+))?(.*)/,function(o,l,a,c,d,h,g){return Ke+l+":"+a+g+(c?Ke+l+"-span:"+(d?h:+h-+a)+g:"")+e});case 4949:if(vt(e,n+6)===121)return Oe(e,":",":"+$e)+e;break;case 6444:switch(vt(e,vt(e,14)===45?18:11)){case 120:return Oe(e,/(.+:)([^;\s!]+)(;|(\s+)?!.+)?/,"$1"+$e+(vt(e,14)===45?"inline-":"")+"box$3$1"+$e+"$2$3$1"+Ke+"$2box$3")+e;case 100:return Oe(e,":",":"+Ke)+e}break;case 5719:case 2647:case 2135:case 3927:case 2391:return Oe(e,"scroll-","scroll-snap-")+e}return e}function zl(e,n){for(var r="",o=0;o<e.length;o++)r+=n(e[o],o,e,n)||"";return r}function RA(e,n,r,o){switch(e.type){case pA:if(e.children.length)break;case hA:case gf:return e.return=e.return||e.value;case u0:return"";case c0:return e.return=e.value+"{"+zl(e.children,o)+"}";case nu:if(!zn(e.value=e.props.join(",")))return""}return zn(r=zl(e.children,o))?e.return=e.value+"{"+r+"}":""}function PA(e){var n=h0(e);return function(r,o,l,a){for(var c="",d=0;d<n;d++)c+=e[d](r,o,l,a)||"";return c}}function NA(e){return function(n){n.root||(n=n.return)&&e(n)}}function OA(e,n,r,o){if(e.length>-1&&!e.return)switch(e.type){case gf:e.return=g0(e.value,e.length,r);return;case c0:return zl([Li(e,{value:Oe(e.value,"@","@"+$e)})],o);case nu:if(e.length)return mA(r=e.props,function(l){switch(ri(l,o=/(::plac\w+|:read-\w+)/)){case":read-only":case":read-write":Jr(Li(e,{props:[Oe(l,/:(read-\w+)/,":"+Os+"$1")]})),Jr(Li(e,{props:[l]})),Yd(e,{props:qg(r,o)});break;case"::placeholder":Jr(Li(e,{props:[Oe(l,/:(plac\w+)/,":"+$e+"input-$1")]})),Jr(Li(e,{props:[Oe(l,/:(plac\w+)/,":"+Os+"$1")]})),Jr(Li(e,{props:[Oe(l,/:(plac\w+)/,Ke+"input-$1")]})),Jr(Li(e,{props:[l]})),Yd(e,{props:qg(r,o)});break}return""})}}var DA={animationIterationCount:1,aspectRatio:1,borderImageOutset:1,borderImageSlice:1,borderImageWidth:1,boxFlex:1,boxFlexGroup:1,boxOrdinalGroup:1,columnCount:1,columns:1,flex:1,flexGrow:1,flexPositive:1,flexShrink:1,flexNegative:1,flexOrder:1,gridRow:1,gridRowEnd:1,gridRowSpan:1,gridRowStart:1,gridColumn:1,gridColumnEnd:1,gridColumnSpan:1,gridColumnStart:1,msGridRow:1,msGridRowSpan:1,msGridColumn:1,msGridColumnSpan:1,fontWeight:1,lineHeight:1,opacity:1,order:1,orphans:1,tabSize:1,widows:1,zIndex:1,zoom:1,WebkitLineClamp:1,fillOpacity:1,floodOpacity:1,stopOpacity:1,strokeDasharray:1,strokeDashoffset:1,strokeMiterlimit:1,strokeOpacity:1,strokeWidth:1},nn={},yo=typeof process<"u"&&nn!==void 0&&(nn.REACT_APP_SC_ATTR||nn.SC_ATTR)||"data-styled",m0="active",v0="data-styled-version",su="6.1.13",vf=`/*!sc*/
`,Wl=typeof window<"u"&&"HTMLElement"in window,kA=!!(typeof SC_DISABLE_SPEEDY=="boolean"?SC_DISABLE_SPEEDY:typeof process<"u"&&nn!==void 0&&nn.REACT_APP_SC_DISABLE_SPEEDY!==void 0&&nn.REACT_APP_SC_DISABLE_SPEEDY!==""?nn.REACT_APP_SC_DISABLE_SPEEDY!=="false"&&nn.REACT_APP_SC_DISABLE_SPEEDY:typeof process<"u"&&nn!==void 0&&nn.SC_DISABLE_SPEEDY!==void 0&&nn.SC_DISABLE_SPEEDY!==""&&nn.SC_DISABLE_SPEEDY!=="false"&&nn.SC_DISABLE_SPEEDY),MA={},au=Object.freeze([]),So=Object.freeze({});function y0(e,n,r){return r===void 0&&(r=So),e.theme!==r.theme&&e.theme||n||r.theme}var S0=new Set(["a","abbr","address","area","article","aside","audio","b","base","bdi","bdo","big","blockquote","body","br","button","canvas","caption","cite","code","col","colgroup","data","datalist","dd","del","details","dfn","dialog","div","dl","dt","em","embed","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","header","hgroup","hr","html","i","iframe","img","input","ins","kbd","keygen","label","legend","li","link","main","map","mark","menu","menuitem","meta","meter","nav","noscript","object","ol","optgroup","option","output","p","param","picture","pre","progress","q","rp","rt","ruby","s","samp","script","section","select","small","source","span","strong","style","sub","summary","sup","table","tbody","td","textarea","tfoot","th","thead","time","tr","track","u","ul","use","var","video","wbr","circle","clipPath","defs","ellipse","foreignObject","g","image","line","linearGradient","marker","mask","path","pattern","polygon","polyline","radialGradient","rect","stop","svg","text","tspan"]),FA=/[!"#$%&'()*+,./:;<=>?@[\\\]^`{|}~-]+/g,UA=/(^-|-$)/g;function Jg(e){return e.replace(FA,"-").replace(UA,"")}var LA=/(a)(d)/gi,fl=52,em=function(e){return String.fromCharCode(e+(e>25?39:97))};function Xd(e){var n,r="";for(n=Math.abs(e);n>fl;n=n/fl|0)r=em(n%fl)+r;return(em(n%fl)+r).replace(LA,"$1-$2")}var hd,A0=5381,so=function(e,n){for(var r=n.length;r;)e=33*e^n.charCodeAt(--r);return e},T0=function(e){return so(A0,e)};function I0(e){return Xd(T0(e)>>>0)}function HA(e){return e.displayName||e.name||"Component"}function pd(e){return typeof e=="string"&&!0}var E0=typeof Symbol=="function"&&Symbol.for,w0=E0?Symbol.for("react.memo"):60115,BA=E0?Symbol.for("react.forward_ref"):60112,GA={childContextTypes:!0,contextType:!0,contextTypes:!0,defaultProps:!0,displayName:!0,getDefaultProps:!0,getDerivedStateFromError:!0,getDerivedStateFromProps:!0,mixins:!0,propTypes:!0,type:!0},bA={name:!0,length:!0,prototype:!0,caller:!0,callee:!0,arguments:!0,arity:!0},_0={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},xA=((hd={})[BA]={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},hd[w0]=_0,hd);function tm(e){return("type"in(n=e)&&n.type.$$typeof)===w0?_0:"$$typeof"in e?xA[e.$$typeof]:GA;var n}var $A=Object.defineProperty,zA=Object.getOwnPropertyNames,nm=Object.getOwnPropertySymbols,WA=Object.getOwnPropertyDescriptor,YA=Object.getPrototypeOf,im=Object.prototype;function C0(e,n,r){if(typeof n!="string"){if(im){var o=YA(n);o&&o!==im&&C0(e,o,r)}var l=zA(n);nm&&(l=l.concat(nm(n)));for(var a=tm(e),c=tm(n),d=0;d<l.length;++d){var h=l[d];if(!(h in bA||r&&r[h]||c&&h in c||a&&h in a)){var g=WA(n,h);try{$A(e,h,g)}catch{}}}}return e}function Ao(e){return typeof e=="function"}function yf(e){return typeof e=="object"&&"styledComponentId"in e}function pr(e,n){return e&&n?"".concat(e," ").concat(n):e||n||""}function Kd(e,n){if(e.length===0)return"";for(var r=e[0],o=1;o<e.length;o++)r+=e[o];return r}function Bs(e){return e!==null&&typeof e=="object"&&e.constructor.name===Object.name&&!("props"in e&&e.$$typeof)}function qd(e,n,r){if(r===void 0&&(r=!1),!r&&!Bs(e)&&!Array.isArray(e))return n;if(Array.isArray(n))for(var o=0;o<n.length;o++)e[o]=qd(e[o],n[o]);else if(Bs(n))for(var o in n)e[o]=qd(e[o],n[o]);return e}function Sf(e,n){Object.defineProperty(e,"toString",{value:n})}function Zs(e){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];return new Error("An error occurred. See https://github.com/styled-components/styled-components/blob/main/packages/styled-components/src/utils/errors.md#".concat(e," for more information.").concat(n.length>0?" Args: ".concat(n.join(", ")):""))}var jA=function(){function e(n){this.groupSizes=new Uint32Array(512),this.length=512,this.tag=n}return e.prototype.indexOfGroup=function(n){for(var r=0,o=0;o<n;o++)r+=this.groupSizes[o];return r},e.prototype.insertRules=function(n,r){if(n>=this.groupSizes.length){for(var o=this.groupSizes,l=o.length,a=l;n>=a;)if((a<<=1)<0)throw Zs(16,"".concat(n));this.groupSizes=new Uint32Array(a),this.groupSizes.set(o),this.length=a;for(var c=l;c<a;c++)this.groupSizes[c]=0}for(var d=this.indexOfGroup(n+1),h=(c=0,r.length);c<h;c++)this.tag.insertRule(d,r[c])&&(this.groupSizes[n]++,d++)},e.prototype.clearGroup=function(n){if(n<this.length){var r=this.groupSizes[n],o=this.indexOfGroup(n),l=o+r;this.groupSizes[n]=0;for(var a=o;a<l;a++)this.tag.deleteRule(o)}},e.prototype.getGroup=function(n){var r="";if(n>=this.length||this.groupSizes[n]===0)return r;for(var o=this.groupSizes[n],l=this.indexOfGroup(n),a=l+o,c=l;c<a;c++)r+="".concat(this.tag.getRule(c)).concat(vf);return r},e}(),Bl=new Map,Yl=new Map,Gl=1,hl=function(e){if(Bl.has(e))return Bl.get(e);for(;Yl.has(Gl);)Gl++;var n=Gl++;return Bl.set(e,n),Yl.set(n,e),n},VA=function(e,n){Gl=n+1,Bl.set(e,n),Yl.set(n,e)},XA="style[".concat(yo,"][").concat(v0,'="').concat(su,'"]'),KA=new RegExp("^".concat(yo,'\\.g(\\d+)\\[id="([\\w\\d-]+)"\\].*?"([^"]*)')),qA=function(e,n,r){for(var o,l=r.split(","),a=0,c=l.length;a<c;a++)(o=l[a])&&e.registerName(n,o)},QA=function(e,n){for(var r,o=((r=n.textContent)!==null&&r!==void 0?r:"").split(vf),l=[],a=0,c=o.length;a<c;a++){var d=o[a].trim();if(d){var h=d.match(KA);if(h){var g=0|parseInt(h[1],10),m=h[2];g!==0&&(VA(m,g),qA(e,m,h[3]),e.getTag().insertRules(g,l)),l.length=0}else l.push(d)}}},rm=function(e){for(var n=document.querySelectorAll(XA),r=0,o=n.length;r<o;r++){var l=n[r];l&&l.getAttribute(yo)!==m0&&(QA(e,l),l.parentNode&&l.parentNode.removeChild(l))}};function ZA(){return typeof __webpack_nonce__<"u"?__webpack_nonce__:null}var R0=function(e){var n=document.head,r=e||n,o=document.createElement("style"),l=function(d){var h=Array.from(d.querySelectorAll("style[".concat(yo,"]")));return h[h.length-1]}(r),a=l!==void 0?l.nextSibling:null;o.setAttribute(yo,m0),o.setAttribute(v0,su);var c=ZA();return c&&o.setAttribute("nonce",c),r.insertBefore(o,a),o},JA=function(){function e(n){this.element=R0(n),this.element.appendChild(document.createTextNode("")),this.sheet=function(r){if(r.sheet)return r.sheet;for(var o=document.styleSheets,l=0,a=o.length;l<a;l++){var c=o[l];if(c.ownerNode===r)return c}throw Zs(17)}(this.element),this.length=0}return e.prototype.insertRule=function(n,r){try{return this.sheet.insertRule(r,n),this.length++,!0}catch{return!1}},e.prototype.deleteRule=function(n){this.sheet.deleteRule(n),this.length--},e.prototype.getRule=function(n){var r=this.sheet.cssRules[n];return r&&r.cssText?r.cssText:""},e}(),eT=function(){function e(n){this.element=R0(n),this.nodes=this.element.childNodes,this.length=0}return e.prototype.insertRule=function(n,r){if(n<=this.length&&n>=0){var o=document.createTextNode(r);return this.element.insertBefore(o,this.nodes[n]||null),this.length++,!0}return!1},e.prototype.deleteRule=function(n){this.element.removeChild(this.nodes[n]),this.length--},e.prototype.getRule=function(n){return n<this.length?this.nodes[n].textContent:""},e}(),tT=function(){function e(n){this.rules=[],this.length=0}return e.prototype.insertRule=function(n,r){return n<=this.length&&(this.rules.splice(n,0,r),this.length++,!0)},e.prototype.deleteRule=function(n){this.rules.splice(n,1),this.length--},e.prototype.getRule=function(n){return n<this.length?this.rules[n]:""},e}(),om=Wl,nT={isServer:!Wl,useCSSOMInjection:!kA},jl=function(){function e(n,r,o){n===void 0&&(n=So),r===void 0&&(r={});var l=this;this.options=Mt(Mt({},nT),n),this.gs=r,this.names=new Map(o),this.server=!!n.isServer,!this.server&&Wl&&om&&(om=!1,rm(this)),Sf(this,function(){return function(a){for(var c=a.getTag(),d=c.length,h="",g=function(y){var S=function(U){return Yl.get(U)}(y);if(S===void 0)return"continue";var E=a.names.get(S),I=c.getGroup(y);if(E===void 0||!E.size||I.length===0)return"continue";var T="".concat(yo,".g").concat(y,'[id="').concat(S,'"]'),C="";E!==void 0&&E.forEach(function(U){U.length>0&&(C+="".concat(U,","))}),h+="".concat(I).concat(T,'{content:"').concat(C,'"}').concat(vf)},m=0;m<d;m++)g(m);return h}(l)})}return e.registerId=function(n){return hl(n)},e.prototype.rehydrate=function(){!this.server&&Wl&&rm(this)},e.prototype.reconstructWithOptions=function(n,r){return r===void 0&&(r=!0),new e(Mt(Mt({},this.options),n),this.gs,r&&this.names||void 0)},e.prototype.allocateGSInstance=function(n){return this.gs[n]=(this.gs[n]||0)+1},e.prototype.getTag=function(){return this.tag||(this.tag=(n=function(r){var o=r.useCSSOMInjection,l=r.target;return r.isServer?new tT(l):o?new JA(l):new eT(l)}(this.options),new jA(n)));var n},e.prototype.hasNameForId=function(n,r){return this.names.has(n)&&this.names.get(n).has(r)},e.prototype.registerName=function(n,r){if(hl(n),this.names.has(n))this.names.get(n).add(r);else{var o=new Set;o.add(r),this.names.set(n,o)}},e.prototype.insertRules=function(n,r,o){this.registerName(n,r),this.getTag().insertRules(hl(n),o)},e.prototype.clearNames=function(n){this.names.has(n)&&this.names.get(n).clear()},e.prototype.clearRules=function(n){this.getTag().clearGroup(hl(n)),this.clearNames(n)},e.prototype.clearTag=function(){this.tag=void 0},e}(),iT=/&/g,rT=/^\s*\/\/.*$/gm;function P0(e,n){return e.map(function(r){return r.type==="rule"&&(r.value="".concat(n," ").concat(r.value),r.value=r.value.replaceAll(",",",".concat(n," ")),r.props=r.props.map(function(o){return"".concat(n," ").concat(o)})),Array.isArray(r.children)&&r.type!=="@keyframes"&&(r.children=P0(r.children,n)),r})}function oT(e){var n,r,o,l=So,a=l.options,c=a===void 0?So:a,d=l.plugins,h=d===void 0?au:d,g=function(S,E,I){return I.startsWith(r)&&I.endsWith(r)&&I.replaceAll(r,"").length>0?".".concat(n):S},m=h.slice();m.push(function(S){S.type===nu&&S.value.includes("&")&&(S.props[0]=S.props[0].replace(iT,r).replace(o,g))}),c.prefix&&m.push(OA),m.push(RA);var y=function(S,E,I,T){E===void 0&&(E=""),I===void 0&&(I=""),T===void 0&&(T="&"),n=T,r=E,o=new RegExp("\\".concat(r,"\\b"),"g");var C=S.replace(rT,""),U=_A(I||E?"".concat(I," ").concat(E," { ").concat(C," }"):C);c.namespace&&(U=P0(U,c.namespace));var H=[];return zl(U,PA(m.concat(NA(function(O){return H.push(O)})))),H};return y.hash=h.length?h.reduce(function(S,E){return E.name||Zs(15),so(S,E.name)},A0).toString():"",y}var sT=new jl,Qd=oT(),N0=Wn.createContext({shouldForwardProp:void 0,styleSheet:sT,stylis:Qd});N0.Consumer;Wn.createContext(void 0);function Zd(){return Ie.useContext(N0)}var aT=function(){function e(n,r){var o=this;this.inject=function(l,a){a===void 0&&(a=Qd);var c=o.name+a.hash;l.hasNameForId(o.id,c)||l.insertRules(o.id,c,a(o.rules,c,"@keyframes"))},this.name=n,this.id="sc-keyframes-".concat(n),this.rules=r,Sf(this,function(){throw Zs(12,String(o.name))})}return e.prototype.getName=function(n){return n===void 0&&(n=Qd),this.name+n.hash},e}(),lT=function(e){return e>="A"&&e<="Z"};function sm(e){for(var n="",r=0;r<e.length;r++){var o=e[r];if(r===1&&o==="-"&&e[0]==="-")return e;lT(o)?n+="-"+o.toLowerCase():n+=o}return n.startsWith("ms-")?"-"+n:n}var O0=function(e){return e==null||e===!1||e===""},D0=function(e){var n,r,o=[];for(var l in e){var a=e[l];e.hasOwnProperty(l)&&!O0(a)&&(Array.isArray(a)&&a.isCss||Ao(a)?o.push("".concat(sm(l),":"),a,";"):Bs(a)?o.push.apply(o,Hs(Hs(["".concat(l," {")],D0(a),!1),["}"],!1)):o.push("".concat(sm(l),": ").concat((n=l,(r=a)==null||typeof r=="boolean"||r===""?"":typeof r!="number"||r===0||n in DA||n.startsWith("--")?String(r).trim():"".concat(r,"px")),";")))}return o};function $i(e,n,r,o){if(O0(e))return[];if(yf(e))return[".".concat(e.styledComponentId)];if(Ao(e)){if(!Ao(a=e)||a.prototype&&a.prototype.isReactComponent||!n)return[e];var l=e(n);return $i(l,n,r,o)}var a;return e instanceof aT?r?(e.inject(r,o),[e.getName(o)]):[e]:Bs(e)?D0(e):Array.isArray(e)?Array.prototype.concat.apply(au,e.map(function(c){return $i(c,n,r,o)})):[e.toString()]}function k0(e){for(var n=0;n<e.length;n+=1){var r=e[n];if(Ao(r)&&!yf(r))return!1}return!0}var uT=T0(su),cT=function(){function e(n,r,o){this.rules=n,this.staticRulesId="",this.isStatic=(o===void 0||o.isStatic)&&k0(n),this.componentId=r,this.baseHash=so(uT,r),this.baseStyle=o,jl.registerId(r)}return e.prototype.generateAndInjectStyles=function(n,r,o){var l=this.baseStyle?this.baseStyle.generateAndInjectStyles(n,r,o):"";if(this.isStatic&&!o.hash)if(this.staticRulesId&&r.hasNameForId(this.componentId,this.staticRulesId))l=pr(l,this.staticRulesId);else{var a=Kd($i(this.rules,n,r,o)),c=Xd(so(this.baseHash,a)>>>0);if(!r.hasNameForId(this.componentId,c)){var d=o(a,".".concat(c),void 0,this.componentId);r.insertRules(this.componentId,c,d)}l=pr(l,c),this.staticRulesId=c}else{for(var h=so(this.baseHash,o.hash),g="",m=0;m<this.rules.length;m++){var y=this.rules[m];if(typeof y=="string")g+=y;else if(y){var S=Kd($i(y,n,r,o));h=so(h,S+m),g+=S}}if(g){var E=Xd(h>>>0);r.hasNameForId(this.componentId,E)||r.insertRules(this.componentId,E,o(g,".".concat(E),void 0,this.componentId)),l=pr(l,E)}}return l},e}(),Af=Wn.createContext(void 0);Af.Consumer;var gd={};function dT(e,n,r){var o=yf(e),l=e,a=!pd(e),c=n.attrs,d=c===void 0?au:c,h=n.componentId,g=h===void 0?function(B,x){var L=typeof B!="string"?"sc":Jg(B);gd[L]=(gd[L]||0)+1;var j="".concat(L,"-").concat(I0(su+L+gd[L]));return x?"".concat(x,"-").concat(j):j}(n.displayName,n.parentComponentId):h,m=n.displayName,y=m===void 0?function(B){return pd(B)?"styled.".concat(B):"Styled(".concat(HA(B),")")}(e):m,S=n.displayName&&n.componentId?"".concat(Jg(n.displayName),"-").concat(n.componentId):n.componentId||g,E=o&&l.attrs?l.attrs.concat(d).filter(Boolean):d,I=n.shouldForwardProp;if(o&&l.shouldForwardProp){var T=l.shouldForwardProp;if(n.shouldForwardProp){var C=n.shouldForwardProp;I=function(B,x){return T(B,x)&&C(B,x)}}else I=T}var U=new cT(r,S,o?l.componentStyle:void 0);function H(B,x){return function(L,j,ie){var _e=L.attrs,Ce=L.componentStyle,xe=L.defaultProps,Me=L.foldedComponentIds,we=L.styledComponentId,ce=L.target,He=Wn.useContext(Af),ye=Zd(),ee=L.shouldForwardProp||ye.shouldForwardProp,z=y0(j,He,xe)||So,V=function(pe,se,Se){for(var ve,q=Mt(Mt({},se),{className:void 0,theme:Se}),ne=0;ne<pe.length;ne+=1){var Fe=Ao(ve=pe[ne])?ve(q):ve;for(var de in Fe)q[de]=de==="className"?pr(q[de],Fe[de]):de==="style"?Mt(Mt({},q[de]),Fe[de]):Fe[de]}return se.className&&(q.className=pr(q.className,se.className)),q}(_e,j,z),W=V.as||ce,R={};for(var F in V)V[F]===void 0||F[0]==="$"||F==="as"||F==="theme"&&V.theme===z||(F==="forwardedAs"?R.as=V.forwardedAs:ee&&!ee(F,W)||(R[F]=V[F]));var X=function(pe,se){var Se=Zd(),ve=pe.generateAndInjectStyles(se,Se.styleSheet,Se.stylis);return ve}(Ce,V),te=pr(Me,we);return X&&(te+=" "+X),V.className&&(te+=" "+V.className),R[pd(W)&&!S0.has(W)?"class":"className"]=te,R.ref=ie,Ie.createElement(W,R)}(O,B,x)}H.displayName=y;var O=Wn.forwardRef(H);return O.attrs=E,O.componentStyle=U,O.displayName=y,O.shouldForwardProp=I,O.foldedComponentIds=o?pr(l.foldedComponentIds,l.styledComponentId):"",O.styledComponentId=S,O.target=o?l.target:e,Object.defineProperty(O,"defaultProps",{get:function(){return this._foldedDefaultProps},set:function(B){this._foldedDefaultProps=o?function(x){for(var L=[],j=1;j<arguments.length;j++)L[j-1]=arguments[j];for(var ie=0,_e=L;ie<_e.length;ie++)qd(x,_e[ie],!0);return x}({},l.defaultProps,B):B}}),Sf(O,function(){return".".concat(O.styledComponentId)}),a&&C0(O,e,{attrs:!0,componentStyle:!0,displayName:!0,foldedComponentIds:!0,shouldForwardProp:!0,styledComponentId:!0,target:!0}),O}function am(e,n){for(var r=[e[0]],o=0,l=n.length;o<l;o+=1)r.push(n[o],e[o+1]);return r}var lm=function(e){return Object.assign(e,{isCss:!0})};function M0(e){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];if(Ao(e)||Bs(e))return lm($i(am(au,Hs([e],n,!0))));var o=e;return n.length===0&&o.length===1&&typeof o[0]=="string"?$i(o):lm($i(am(o,n)))}function Jd(e,n,r){if(r===void 0&&(r=So),!n)throw Zs(1,n);var o=function(l){for(var a=[],c=1;c<arguments.length;c++)a[c-1]=arguments[c];return e(n,r,M0.apply(void 0,Hs([l],a,!1)))};return o.attrs=function(l){return Jd(e,n,Mt(Mt({},r),{attrs:Array.prototype.concat(r.attrs,l).filter(Boolean)}))},o.withConfig=function(l){return Jd(e,n,Mt(Mt({},r),l))},o}var F0=function(e){return Jd(dT,e)},mn=F0;S0.forEach(function(e){mn[e]=F0(e)});var fT=function(){function e(n,r){this.rules=n,this.componentId=r,this.isStatic=k0(n),jl.registerId(this.componentId+1)}return e.prototype.createStyles=function(n,r,o,l){var a=l(Kd($i(this.rules,r,o,l)),""),c=this.componentId+n;o.insertRules(c,c,a)},e.prototype.removeStyles=function(n,r){r.clearRules(this.componentId+n)},e.prototype.renderStyles=function(n,r,o,l){n>2&&jl.registerId(this.componentId+n),this.removeStyles(n,o),this.createStyles(n,r,o,l)},e}();function hT(e){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];var o=M0.apply(void 0,Hs([e],n,!1)),l="sc-global-".concat(I0(JSON.stringify(o))),a=new fT(o,l),c=function(h){var g=Zd(),m=Wn.useContext(Af),y=Wn.useRef(g.styleSheet.allocateGSInstance(l)).current;return g.styleSheet.server&&d(y,h,g.styleSheet,m,g.stylis),Wn.useLayoutEffect(function(){if(!g.styleSheet.server)return d(y,h,g.styleSheet,m,g.stylis),function(){return a.removeStyles(y,g.styleSheet)}},[y,h,g.styleSheet,m,g.stylis]),null};function d(h,g,m,y,S){if(a.isStatic)a.renderStyles(h,MA,m,S);else{var E=Mt(Mt({},g),{theme:y0(g,y,c.defaultProps)});a.renderStyles(h,E,m,S)}}return Wn.memo(c)}function U0(e,n){var r=Ie.useRef(null),o=Ie.useRef(!1),l=Ie.useRef(e);l.current=e;var a=Ie.useCallback(function(d){o.current&&(l.current(d),r.current=requestAnimationFrame(a))},[]),c=Ie.useMemo(function(){return[function(){o.current&&(o.current=!1,r.current&&cancelAnimationFrame(r.current))},function(){o.current||(o.current=!0,r.current=requestAnimationFrame(a))},function(){return o.current}]},[]);return Ie.useEffect(function(){return c[0]},[]),c}function pT(e,n,r,o,l){var c;(c=e.onExit)==null||c.call(e,o,n);const a=l.find(({id:d})=>d===n);return a!=null&&a.onEnter?a.onEnter(o,r):{...r,enteredAt:o.updateContext.gameState.time}}function gT(e,n){return n.find(({id:r})=>r===e)}function mT(e,n){return e!==n}function vT(e){console.warn(`No handler found for state: ${e}`)}const Ds="bushGrowing",hr="bushFull",bl="bushSpreading",Gs="bushDying",wt=24,_t=10,et=3e3,tt=3e3,Tf=2,yT=15,ST=5e3,ai=100,li=20,ui=60,AT=1e3,TT=5,IT=3,ET=12,wT=940,ef=20,um=90,L0=45,H0=240,bs=5,_T=.5,cm=100,CT=300,lu=30,ci=.1,Cs=.9,Ge=1,gr=3,RT=70;function Pe(e,n,r,o,l){const a={id:e.nextVisualEffectId,type:n,position:r,startTime:e.time,duration:o,entityId:l};return e.visualEffects.push(a),e.nextVisualEffectId++,a.id}var le=(e=>(e[e.Hunger=0]="Hunger",e[e.Procreation=1]="Procreation",e[e.Pregnant=2]="Pregnant",e[e.TargetAcquired=3]="TargetAcquired",e[e.Attack=4]="Attack",e[e.Partnered=5]="Partnered",e[e.BushClaimed=6]="BushClaimed",e[e.BushClaimLost=7]="BushClaimLost",e[e.Eating=8]="Eating",e[e.ChildFed=9]="ChildFed",e[e.AttackDeflected=10]="AttackDeflected",e[e.AttackResisted=11]="AttackResisted",e[e.Hit=12]="Hit",e[e.SeizeBuildup=13]="SeizeBuildup",e[e.Seize=14]="Seize",e[e.CallToAttack=15]="CallToAttack",e[e.CallToFollow=16]="CallToFollow",e[e.AutopilotMoveTarget=17]="AutopilotMoveTarget",e))(le||{}),di=(e=>(e.Berry="berry",e.Meat="meat",e))(di||{});const B0={berry:"",meat:""},PT={id:Ds,update:(e,n)=>{const{entity:r,updateContext:o}=n,l=o.deltaTime*(wt/_t);return r.age+=l,r.age>=r.lifespan?{nextState:Gs,data:{...e,enteredAt:o.gameState.time}}:(r.ownerId&&r.claimedUntil&&o.gameState.time>r.claimedUntil&&(Pe(o.gameState,le.BushClaimLost,r.position,Ge),r.ownerId=void 0,r.claimedUntil=void 0),r.timeSinceLastBerryRegen+=l,r.timeSinceLastBerryRegen>=ET&&r.food.length<r.maxFood&&(r.food.push({type:di.Berry}),r.timeSinceLastBerryRegen=0),r.food.length>=r.maxFood?{nextState:hr,data:{...e,enteredAt:o.gameState.time,previousState:Ds}}:{nextState:Ds,data:e})},onEnter:(e,n)=>({...n,enteredAt:e.updateContext.gameState.time})},NT={id:hr,update:(e,n)=>{const{entity:r,updateContext:o}=n,l=o.deltaTime*(wt/_t);return r.age+=l,r.age>=r.lifespan?{nextState:Gs,data:{...e,enteredAt:o.gameState.time,previousState:hr}}:r.food.length<r.maxFood?{nextState:Ds,data:{...e,enteredAt:o.gameState.time,previousState:hr}}:(r.ownerId&&r.claimedUntil&&o.gameState.time>r.claimedUntil&&(Pe(o.gameState,le.BushClaimLost,r.position,Ge),r.ownerId=void 0,r.claimedUntil=void 0),r.timeSinceLastSpreadAttempt+=l,r.timeSinceLastSpreadAttempt>=um&&(r.timeSinceLastSpreadAttempt=0,o.gameState.time-r.timeSinceLastHarvest>=um&&Math.random()<o.gameState.ecosystem.berryBushSpreadChance)?{nextState:bl,data:{...e,enteredAt:o.gameState.time,previousState:hr}}:{nextState:hr,data:e})},onEnter:(e,n)=>({...n,enteredAt:e.updateContext.gameState.time})},xs=1,dm=150*.6,OT=150*.25,DT=150*.7,kT=150*.8,fm=300,MT=600,G0=100,FT=250,UT=120,LT=2,HT=400,BT=1e3,GT=150*.85,bT=100,xT=3,$T=96,zT=24,WT=600,b0=600,YT=1,jT=24,VT=1,XT=.5,KT=2,tf=24,nf=12,qT=24,hm=24,QT=1500,md=500,ZT=400,JT=10,eI=-5,tI=1.5,nI=1.5,iI=1.2,rI=10,oI=150,sI=200,aI=100,lI=100,uI=.7,cI=300,dI=100,fI=120,pm=400,x0=.15,$0=200,xl=30*.75*1.2,hI=20,uu=10,$s=80,pI=3,ys=5,Er=150,z0=Er*.8,gI=Er*.2,wr=Er*.95,Yi=30,W0=10,mI=10,vI=.5,yt=30,_r=yt*.75,Y0=50,yI=20,SI=$s*.8,AI=.7,TI=16,j0=40,II=24,If=16,EI=72/3,gm=24,wI=1.25,_I=1.5,Ef=Er*.6,wf=50,CI=1,RI=350,V0=$s*.65,PI=80,NI=50,OI=1,DI=128,X0=10,mm=100,_f=35,Yn=yt,K0=.5,cu=2.5,kI=5,Cf=.5,Rf=1.5,MI=.1,FI=.5,UI=1.5,LI=.25,HI=2.5,BI=45,GI=.05;function jn(e,n){return{x:e.x+n.x,y:e.y+n.y}}function q0(e,n){return{x:e.x-n.x,y:e.y-n.y}}function Ct(e,n){return{x:e.x*n,y:e.y*n}}function To(e){return Math.sqrt(e.x*e.x+e.y*e.y)}function nt(e){const n=To(e);return n===0?{x:0,y:0}:Ct(e,1/n)}function bI(e,n){return To(q0(e,n))}function Pf(e,n,r){return{x:e.x+(n.x-e.x)*r,y:e.y+(n.y-e.y)*r}}function Nf(e){if(e.length===0)return{x:0,y:0};const n=e.reduce((r,o)=>({x:r.x+o.x,y:r.y+o.y}),{x:0,y:0});return{x:n.x/e.length,y:n.y/e.length}}function We(e,n,r,o){let l=n.x-e.x,a=n.y-e.y;return Math.abs(l)>r/2&&(l=l-Math.sign(l)*r),Math.abs(a)>o/2&&(a=a-Math.sign(a)*o),{x:l,y:a}}function qt(e,n,r){const o=We(e,n,r.width,r.height);return nt(o)}function K(e,n,r,o){const l=We(e,n,r,o);return To(l)}function xI(e,n){return e.x*n.x+e.y*n.y}function $I(e,n){const r=xI(e,n),o=To(e),l=To(n);if(o===0||l===0)return 0;const a=Math.max(-1,Math.min(1,r/(o*l)));return Math.acos(a)}function zI(e,n,r){const o=Math.max(0,Math.min(1,r)),l={r:parseInt(e.substring(1,3),16),g:parseInt(e.substring(3,5),16),b:parseInt(e.substring(5,7),16)},a={r:parseInt(n.substring(1,3),16),g:parseInt(n.substring(3,5),16),b:parseInt(n.substring(5,7),16)},c=Math.round(l.r+(a.r-l.r)*o),d=Math.round(l.g+(a.g-l.g)*o),h=Math.round(l.b+(a.b-l.b)*o),g=m=>("00"+m.toString(16)).slice(-2);return`#${g(c)}${g(d)}${g(h)}`}var bt=(e=>(e.Friendly="Friendly",e.Hostile="Hostile",e))(bt||{}),Kt=(e=>(e[e.None=0]="None",e[e.General=1]="General",e[e.Performance=2]="Performance",e[e.Ecosystem=3]="Ecosystem",e))(Kt||{});function vm(e,n,r){return n.search.human.byRadius(e.position,r).filter(a=>{if(a.id===e.id||a.gender===e.gender||!a.isAdult||a.hunger>=wr||(a.procreationCooldown||0)>0||a.gender==="female"&&a.isPregnant)return!1;const c=a.id===e.motherId||a.id===e.fatherId,d=e.id===a.motherId||e.id===a.fatherId;return!c&&!d})}function fi(e){if(e.length===0)return;const n=e.filter(l=>l.gender==="male"),r=e.filter(l=>l.gender==="female"),o=(l,a)=>l.age!==a.age?a.age-l.age:l.id-a.id;if(n.sort(o),n.length>0)return n[0];if(r.sort(o),r.length>0)return r[0]}function Rt(e,n){const r=e,o=r.search.human.byProperty("motherId",n.id),l=r.search.human.byProperty("fatherId",n.id);return[...o,...l]}function Q0(e,n,r){var l;if(e.id===n.id||e.motherId===n.id||e.fatherId===n.id||n.motherId===e.id||n.fatherId===e.id||e.motherId&&e.motherId===n.motherId||e.fatherId&&e.fatherId===n.fatherId||(l=e.partnerIds)!=null&&l.includes(n.id))return!0;if(e.motherId){const a=r.entities.entities[e.motherId];if(a&&(a.motherId===n.id||a.fatherId===n.id))return!0}if(e.fatherId){const a=r.entities.entities[e.fatherId];if(a&&(a.motherId===n.id||a.fatherId===n.id))return!0}if(n.motherId){const a=r.entities.entities[n.motherId];if(a&&(a.motherId===e.id||a.fatherId===e.id))return!0}if(n.fatherId){const a=r.entities.entities[n.fatherId];if(a&&(a.motherId===e.id||a.fatherId===e.id))return!0}return!1}function rf(e,n){var a,c,d,h;if(e.id===n.id||e.motherId===n.id||e.fatherId===n.id||n.motherId===e.id||n.fatherId===e.id||(a=e.partnerIds)!=null&&a.includes(n.id)||(c=n.partnerIds)!=null&&c.includes(e.id))return!0;if(e.fatherId===void 0&&e.motherId===void 0||n.fatherId===void 0&&n.motherId===void 0)return!1;const r=e.motherId===n.motherId||e.fatherId===n.fatherId,o=n.motherId===e.motherId||n.fatherId===e.fatherId,l=((d=e.ancestorIds)==null?void 0:d.some(g=>n.ancestorIds.includes(g)))||((h=n.ancestorIds)==null?void 0:h.some(g=>e.ancestorIds.includes(g)));return r||o||l}function WI(e,n){const r=[];if(e.motherId){const o=n.entities.entities[e.motherId];o&&r.push(o)}if(e.fatherId){const o=n.entities.entities[e.fatherId];o&&r.push(o)}return r}function YI(e,n){if(e.gender!=="female"||!e.partnerIds||e.partnerIds.length===0)return null;for(const r of e.partnerIds){const o=n.entities.entities[r];if(o&&o.gender==="male")return o}return null}function jI(e,n){var r;if(!e.isAdult&&e.fatherId){const o=n.entities.entities[e.fatherId];if(o&&o.type==="human")return o}if(e.isAdult&&e.fatherId){const o=n.entities.entities[e.fatherId];if(o&&o.type==="human"&&((r=fi(Rt(n,o)))==null?void 0:r.id)===e.id)return o}return e.isAdult&&e.gender==="female"&&e.partnerIds&&e.partnerIds.length>0?YI(e,n):null}function Vl(e,n){var o;const r=new Set;if(e.motherId){const l=n.entities.entities[e.motherId];l&&r.add(l)}if(e.fatherId){const l=n.entities.entities[e.fatherId];l&&r.add(l)}return(o=e.partnerIds)==null||o.forEach(l=>{const a=n.entities.entities[l];a&&r.add(a)}),Rt(n,e).forEach(l=>r.add(l)),Array.from(r)}function Z0(e,n){const r=new Map;function o(l){const a=Rt(n,l);for(const c of a)r.has(c.id)||(r.set(c.id,c),o(c))}return o(e),Array.from(r.values())}function zs(e,n){return n.search.human.byProperty("leaderId",e)}function J0(e,n){var c,d;const r=new Map,o=Object.values(e.entities.entities).filter(h=>h.type==="human");for(const h of o)h.leaderId&&(r.has(h.leaderId)||r.set(h.leaderId,{leaderId:h.leaderId,tribeBadge:h.tribeBadge||"?",members:[]}),(c=r.get(h.leaderId))==null||c.members.push(h));const l=n?(d=e.entities.entities[n])==null?void 0:d.diplomacy:void 0,a=Array.from(r.values()).map(h=>{const g=e.entities.entities[h.leaderId],m=h.members.filter(S=>S.isAdult).length,y=h.members.length-m;return{leaderId:h.leaderId,tribeBadge:h.tribeBadge,adultCount:m,childCount:y,isPlayerTribe:h.leaderId===n,leaderAge:(g==null?void 0:g.age)??0,leaderGender:(g==null?void 0:g.gender)??"male",diplomacyStatus:(l==null?void 0:l[h.leaderId??-1])??bt.Friendly}});return a.sort((h,g)=>h.isPlayerTribe?-1:g.isPlayerTribe?1:g.adultCount+g.childCount-(h.adultCount+h.childCount)),a}function ke(e,n,r,o,l){const a=n,c=o,d="position"in e&&e.id?e:null,h=d?d.position:e,g=a.search[r].byRadius(h,c);let m=null,y=c;for(const S of g){if(S.id===(d==null?void 0:d.id)||l&&!l(S))continue;const E=K(h,S.position,n.mapDimensions.width,n.mapDimensions.height);E<y&&(y=E,m=S)}return m}function ev(e,n,r,o){return n.search[r].byRadius(e,o)}function tv(e,n,r,o){return ev(e,n,r,o).length}function St(e){const r=e.search.human.byProperty("isPlayer",!0);return r.length>0?r[0]:void 0}function VI(e,n){var c;const o=n.search.human.byProperty("activeAction","attacking");let l=null,a=1/0;for(const d of o){if(d.attackTargetId!==e)continue;const h=K(d.position,((c=n.entities.entities[e])==null?void 0:c.position)||{x:0,y:0},n.mapDimensions.width,n.mapDimensions.height);h<a&&(l=d,a=h)}return l}function XI(e){return Object.values(e.entities.entities).filter(n=>n.type==="human")}function KI(e,n,r){const o=Object.values(n.entities.entities).reverse();for(const l of o)if(bI(e,l.position)<l.radius)return l}function Of(e,n,r,o){const l=Math.random()*Math.PI*2,a=Math.sqrt(Math.random())*n,c={x:Math.cos(l)*a,y:Math.sin(l)*a},d=jn(e,c);return{x:(d.x%r+r)%r,y:(d.y%o+o)%o}}function Io(e,n,r,o){const l=n,a={left:e.x-r,top:e.y-r,right:e.x+r,bottom:e.y+r},c=[...l.search.human.byRect(a),...l.search.berryBush.byRect(a),...l.search.corpse.byRect(a)];for(const d of c){if(o!==void 0&&d.id===o)continue;if(K(e,d.position,n.mapDimensions.width,n.mapDimensions.height)<r+d.radius)return!0}return!1}function Df(e,n,r,o,l){const a=n.mapDimensions.width,c=n.mapDimensions.height;if(!Io(e,n,o,l))return e;const d=o;for(let h=d;h<=r;h+=d){const g=Math.ceil(2*Math.PI*h/d);for(let m=0;m<g;m++){const y=m/g*2*Math.PI,S={x:Math.cos(y)*h,y:Math.sin(y)*h},E=jn(e,S),I={x:(E.x%a+a)%a,y:(E.y%c+c)%c};if(!Io(I,n,o,l))return I}}return null}function Cr(e,n){const r=zs(e,n);if(r.length===0){const l=n.entities.entities[e];return l?l.position:{x:0,y:0}}const o=r.map(l=>l.position);return Nf(o)}function ym(e,n){const o=[...Vl(e,n),e].map(l=>l.position);return Nf(o)}function qI(e,n,r){return n.search.human.byRadius(e.position,r).filter(l=>{var a;return l.activeAction==="procreating"&&l.gender===e.gender&&typeof l.target=="number"&&((a=e.partnerIds)==null?void 0:a.includes(l.target))})[0]}function QI(e,n,r){if(!e.leaderId)return;const o=n,l=o.search.berryBush.byRadius(e.position,r).filter(a=>a.ownerId===e.id);for(const a of l)if(a.claimedUntil&&n.time<a.claimedUntil){const c=o.search.human.byRadius(a.position,yt);for(const d of c)if(!rf(d,e)&&d.activeAction==="gathering"&&d.target===a.id)return d}}function ZI(e,n,r){const o=Vl(e,n),l=n;for(const a of o){if(K(e.position,a.position,n.mapDimensions.width,n.mapDimensions.height)>r)continue;const d=l.search.human.byProperty("attackTargetId",a.id);for(const h of d)if(h.leaderId!==e.leaderId)return{familyMember:a,aggressor:h}}}function JI(e,n){const o=n.search.human.byRadius(e.position,cI);let l,a=1/0;for(const c of o){if(c.id===e.id||c.hitpoints<=0||c.hitpoints/c.maxHitpoints>uI||Q0(e,c,n))continue;const d=K(e.position,c.position,n.mapDimensions.width,n.mapDimensions.height);d<a&&(a=d,l=c)}return l}function eE(e,n){const r=ke(e,n,"berryBush",cm,l=>l.ownerId===e.id);return r?Df(r.position,n,cm,lu,r.id):null}function kf(e,n,r){return n.search.human.byRadius(e.position,r).filter(l=>Oo(e,l,n))}function tE(e,n,r){const o=r.search.human.byProperty("leaderId",e);let l=0;for(const a of o)a.attackTargetId===n&&l++;return l}function Sm(e,n,r,o){const l=r.search.berryBush.byRadius(e,n),a=r.search.human.byRadius(e,n).filter(h=>h.leaderId!==o);let c=l.length*JT;c+=a.length*eI;let d;if(a.length>0){const h={};for(const m of a)m.leaderId&&(h[m.leaderId]=(h[m.leaderId]||0)+1);let g=0;for(const m in h)h[m]>g&&(g=h[m],d=parseInt(m,10))}return{score:c,occupyingTribeId:d}}function Xl(e){return e.filter(n=>n.isAdult).reduce((n,r)=>{let o=r.hitpoints;return o+=(r.maxAge-r.age)*.5,o+=r.food.length*2,n+o},0)}function nE(e,n){if(e.id!==e.leaderId)return null;const r=n,o=Cr(e.id,n),{score:l}=Sm(o,md/2,r,e.id);let a=null,c=l;const d=ZT,h=QT;for(let g=e.position.x-h;g<e.position.x+h;g+=d)for(let m=e.position.y-h;m<e.position.y+h;m+=d){const y={x:(g%n.mapDimensions.width+n.mapDimensions.width)%n.mapDimensions.width,y:(m%n.mapDimensions.height+n.mapDimensions.height)%n.mapDimensions.height};if(K(o,y,n.mapDimensions.width,n.mapDimensions.height)<md*2)continue;const{score:E}=Sm(y,md/2,r,e.id);E>c*tI&&(c=E,a=y)}return a}const At=30,No=At*.6,Mf="#4CAF50",nv="#FF5722",iv="#9C27B0",iE="#2196F3",rv="#FFC107",rE="#FFD700",ov="#DC143C",Ff="#FFFFFF",Uf=[5,5],du=5,Eo=15,oE=20,sE=16,aE=10,lE=16,uE=16,Am=["","","","","","","","","",""],of=8,cE="#FFFFFF",pn=18,qe=15,dE="rgba(0, 0, 0, 0.7)",fE=4,Mi=150,tn=15,ni=10,ao="#555",hE="#f44336",pE="#4CAF50",gE="#2196F3",mE="#FFC107",pl=16,ar=32,gl=28,vE=10,yE=8,SE=8,AE=8,fn=28,ml=40,TE="rgba(255, 215, 0, 0.7)",IE="rgba(0, 0, 0, 0.3)",bn=10,Tm=8,vd=11,Fi=20,yd=40,Im=5,EE=10,wE="#FFA500",_E="#808080",_n=120,sv=30,CE=20,oi="#2d3748",rn="#ffffff",vl="#4a5568",av=5,Lf="#bdc9f792",lv="#272c36ff",uv="#a0aec0",Kl=300,cv="rgba(255, 255, 255, 0.5)",RE="rgba(0, 0, 0, 0.8)",PE="#FFFFFF",Em=14,wm=8,_m=-15,dv="#FFD700",fv=5,NE=60,OE=-50,DE=10,Sd=12,Cm=10,kE="rgba(0, 0, 0, 0.5)",ME="#4CAF50",FE="#F44336",UE="#FFC107",LE="rgba(255, 255, 255, 0.2)",Rm="#FFFFFF",HE="#FF6B6B",BE=5,hv=30,Ss=50,yl=8,Pm=10,GE="rgba(0, 0, 0, 0.5)",bE="#FFFFFF",xE=33,$E=400,zE=20,WE=10,YE="rgba(0, 0, 0, 0.7)",jE="#FFFFFF",Ad=20,Nm=16,VE=.5,Om=5,pv="#FFD700",XE=40,Hf=4,gv=3,KE=5,mv=20,vv=5,qE="#FFFFFF",QE="#FF6B6B",lr=80,Sl=10,Al=300,ur=15,ZE=8,JE="rgba(0, 0, 0, 0.8)",ew="#FFFFFF",Td=14,Dm=10,xn=20,tw="#FF6B6B",nw="#4CAF50",km="#FFD700",iw="rgba(255, 255, 0, 0.3)",rw=2,ow=500,sw=120,aw=45,lw="#FFD700",uw=3,cw=4;let Id=0;function sf(){const e=Am[Id];return Id=(Id+1)%Am.length,e}const Mm=40,dw=.3,fw=24,Fm=500,wo=10,yv=250,Ws=12,Sv=10;var Re=(e=>(e.Gather="Gather",e.Eat="Eat",e.Procreate="Procreate",e.Attack="Attack",e.Plant="Plant",e.CallToAttack="CallToAttack",e.TribeSplit="TribeSplit",e.FollowMe="FollowMe",e.FeedChild="FeedChild",e.HuntPrey="HuntPrey",e.DefendAgainstPredator="DefendAgainstPredator",e.AutopilotMove="AutopilotMove",e.AutopilotGather="AutopilotGather",e.AutopilotAttack="AutopilotAttack",e.AutopilotProcreate="AutopilotProcreate",e.AutopilotPlant="AutopilotPlant",e.AutopilotFeedChild="AutopilotFeedChild",e.AutopilotFollowMe="AutopilotFollowMe",e))(Re||{});const fu={Gather:"",Eat:"",Procreate:"",Attack:"",Plant:"",CallToAttack:"",TribeSplit:"",FollowMe:"",FeedChild:"",HuntPrey:"",DefendAgainstPredator:"",AutopilotMove:"",AutopilotGather:"",AutopilotAttack:"",AutopilotProcreate:"",AutopilotPlant:"",AutopilotFeedChild:"",AutopilotFollowMe:""},Av={Gather:"Gather",Eat:"Eat",Procreate:"Procreate",Attack:"Attack",Plant:"Plant",CallToAttack:"Call to Attack",TribeSplit:"Split Tribe",FollowMe:"Follow Me",FeedChild:"Feed Child",HuntPrey:"Hunt Prey",DefendAgainstPredator:"Defend",AutopilotMove:"Walk",AutopilotGather:"Gather",AutopilotAttack:"Attack",AutopilotProcreate:"Procreate",AutopilotPlant:"Plant",AutopilotFeedChild:"Feed",AutopilotFollowMe:"Follow"};var io=(e=>(e.Time="Time",e.Hunger="Hunger",e.Hitpoints="Hitpoints",e.Food="Food",e.Autopilot="Autopilot",e.Muted="Muted",e.Family="Family",e.Tribes="Tribes",e))(io||{});const As={Time:"",Hunger:"",Hitpoints:"",Food:"",Autopilot:"",Muted:"",Family:"",Tribes:""};var Te=(e=>(e.ToggleMute="ToggleMute",e.TogglePause="TogglePause",e.FastForward="FastForward",e.DismissTutorial="DismissTutorial",e.ReturnToIntro="ReturnToIntro",e.ConfirmExitYes="ConfirmExitYes",e.ConfirmExitNo="ConfirmExitNo",e.SaveGame="SaveGame",e.ToggleAutosave="ToggleAutosave",e.CommandEat="CommandEat",e.CommandPlant="CommandPlant",e.CommandCallToAttack="CommandCallToAttack",e.CommandFollowMe="CommandFollowMe",e.CommandGather="CommandGather",e.CommandTribeSplit="CommandTribeSplit",e.ToggleProcreationBehavior="ToggleProcreationBehavior",e.ToggleAttackBehavior="ToggleAttackBehavior",e.ToggleFeedChildBehavior="ToggleFeedChildBehavior",e.TogglePlantingBehavior="TogglePlantingBehavior",e.ToggleGatheringBehavior="ToggleGatheringBehavior",e.ToggleAutopilotFollowLeaderBehavior="ToggleAutopilotFollowLeaderBehavior",e.ToggleDiplomacy="ToggleDiplomacy",e))(Te||{});const hw=12,pw=24,gw=150*.9,mw=24;var Ys=(e=>(e.Hello="HELLO",e.NewTribeFormed="NEW_TRIBE_FORMED",e.NoHeir="NO_HEIR",e.ChildrenStarving="CHILDREN_STARVING",e))(Ys||{});let vw=0;function yw(){return`notification-${Date.now()}-${vw++}`}function af(e,n){if(n.identifier){const o=e.notifications.find(l=>l.identifier===n.identifier);if(o){if(o.dismissedUntil&&e.time<o.dismissedUntil)return;o.message=n.message,o.timestamp=e.time,o.creationTime=Date.now(),o.duration=n.duration,o.targetEntityIds=n.targetEntityIds,o.highlightedEntityIds=n.highlightedEntityIds,o.targetPosition=n.targetPosition,o.targetArea=n.targetArea,o.targetRadius=n.targetRadius,o.isDismissed=!1,o.dismissedUntil=void 0;return}}const r={...n,id:yw(),timestamp:e.time,creationTime:Date.now(),isDismissed:!1};e.notifications.push(r)}function Sw(e,n){const r=e.notifications.find(o=>o.id===n);r&&(r.isDismissed=!0,r.identifier&&(r.dismissedUntil=e.time+mw))}function Aw(e){const n=e.time;e.notifications=e.notifications.filter(r=>r.duration===0?!0:!(n-r.timestamp>r.duration))}const Um=600,Tw=1.5,Tv=.1,Ed=""+new URL("attack-D4MA8VWK.mp3",import.meta.url).href,Iw=""+new URL("gather-CU75596W.mp3",import.meta.url).href,Ew=""+new URL("eat-DCjHq2QD.mp3",import.meta.url).href,wd=""+new URL("procreate-CfE4r5Cp.mp3",import.meta.url).href,ww=""+new URL("birth-Cbd67GHT.mp3",import.meta.url).href,_w=""+new URL("child-fed-DzEPuMid.mp3",import.meta.url).href,Cw=""+new URL("human-death-B6HFLXES.mp3",import.meta.url).href,Rw=""+new URL("game-over-C5dqkyER.mp3",import.meta.url).href,Pw=""+new URL("button-click-DomLUeaU.mp3",import.meta.url).href,Nw=""+new URL("soundtrack-1-BdlYUGye.mp3",import.meta.url).href;var Ee=(e=>(e[e.Attack=0]="Attack",e[e.Gather=1]="Gather",e[e.Eat=2]="Eat",e[e.Procreate=3]="Procreate",e[e.Birth=4]="Birth",e[e.ChildFed=5]="ChildFed",e[e.HumanDeath=6]="HumanDeath",e[e.Seize=7]="Seize",e[e.CallToAttack=8]="CallToAttack",e[e.TribeSplit=9]="TribeSplit",e[e.CallToFollow=10]="CallToFollow",e[e.GameOver=11]="GameOver",e[e.ButtonClick=12]="ButtonClick",e[e.SoundTrack1=13]="SoundTrack1",e))(Ee||{});const Ow=new Map([[0,Ed],[1,Iw],[2,Ew],[3,wd],[4,ww],[5,_w],[6,Cw],[11,Rw],[12,Pw],[7,Ed],[8,Ed],[9,wd],[10,wd],[13,Nw]]);let Ts,js;function Dw(){if(!(typeof window>"u"))return js}function Bf(){if(!(typeof window>"u"))return!Ts&&typeof window.AudioContext=="function"&&(Ts=new window.AudioContext,js=Ts.createGain(),js.connect(Ts.destination),ks(.1,!1)),Ts}function ks(e,n){js&&(js.gain.value=n?0:e/10)}const Iv=new Map;let Tl=!1,Lm=!1;async function kw(){if(Lm||Tl)return;const e=Bf();if(!e){console.error("AudioContext not supported. Cannot load sounds.");return}e.state==="suspended"&&e.resume(),Tl=!0,console.log("Starting sound loading...");const n=[];Ow.forEach((r,o)=>{const l=fetch(r).then(a=>{if(!a.ok)throw new Error(`Failed to fetch sound: ${r}`);return a.arrayBuffer()}).then(a=>e.decodeAudioData(a)).then(a=>{Iv.set(o,a)}).catch(a=>{console.error(`Error loading sound ${Ee[o]} from ${r}:`,a)});n.push(l)});try{await Promise.all(n),Lm=!0,Tl=!1,console.log("All sounds loaded successfully.")}catch(r){Tl=!1,console.error("An error occurred while loading sounds:",r)}}const Ms=new Map;function Gf(e,n){const r=Bf(),o=Dw();if(!r||!o||o.gain.value===0&&(n==null?void 0:n.trackId)===void 0)return;r.state==="suspended"&&r.resume();const l=Iv.get(e);if(!l){console.warn(`Sound buffer not found for type: ${Ee[e]}`);return}if(n!=null&&n.trackId&&Ms.has(n.trackId))return;const a=r.createBufferSource();a.buffer=l,a.loop=(n==null?void 0:n.loop)??!1;const c=r.createGain(),d=r.createStereoPanner();let h=c;if(n!=null&&n.position&&(n!=null&&n.listenerPosition)&&(n!=null&&n.worldDimensions)){const g=We(n.listenerPosition,n.position,n.worldDimensions.width,n.worldDimensions.height),m=K(n.listenerPosition,n.position,n.worldDimensions.width,n.worldDimensions.height);if(m>Um)return;const y=1-Math.pow(m/Um,Tw);c.gain.value=Math.max(0,y);const S=Math.sin(g.x/m*(Math.PI/2));d.pan.value=isNaN(S)?0:S,c.connect(d),h=d}else{const g=e===Ee.GameOver?.4:e===Ee.SoundTrack1?1:.2;c.gain.value=g}a.connect(h),h.connect(o),a.start(0),n!=null&&n.trackId&&(Ms.set(n.trackId,{sourceNode:a,gainNode:c}),a.onended=()=>{Ms.delete(n.trackId)})}function _d(e,n=1){const r=Ms.get(e),o=Bf();if(r&&o){const{sourceNode:l,gainNode:a}=r,c=o.currentTime;a.gain.setValueAtTime(a.gain.value,c),a.gain.linearRampToValueAtTime(0,c+n),l.stop(c+n),l.onended=null,Ms.delete(e)}}function Ue(e,n,r){const o=St(e.gameState);o&&Gf(n,{position:r,listenerPosition:o.position,worldDimensions:e.gameState.mapDimensions,masterVolume:e.gameState.masterVolume,isMuted:e.gameState.isMuted})}function Mw(e,n,r){const o=r.mapDimensions.width,l=r.mapDimensions.height,a=n.radius*2;for(let c=Fm;c<o/2;c+=50)for(let d=0;d<10;d++){const h=Of(e,c,o,l);if(!(K(e,h,o,l)<Fm)&&!Io(h,r,a,n.id))return h}return null}function bf(e,n){if(!e.isAdult||e.gender!=="male"||e.leaderId===e.id||!e.leaderId)return{canSplit:!1};if(!e.leaderId)return{canSplit:!1};const r=n.entities.entities[e.leaderId];if(!r||r.type!=="human")return{canSplit:!1};const o=fi(Rt(n,r));if(o&&o.id===e.id)return{canSplit:!1};const l=zs(e.leaderId,n);if(l.length<Mm)return{canSplit:!1};const c=Z0(e,n).length+1,d=Math.min(l.length*dw,Mm);return{canSplit:c>=d,progress:c/d}}function xf(e,n){if(!bf(e,n).canSplit)return;const r=e.leaderId?n.entities.entities[e.leaderId]:void 0,o=sf(),l=Z0(e,n);e.leaderId=e.id,e.tribeBadge=o,e.diplomacy={},r&&r.diplomacy&&(r.diplomacy[e.id]=bt.Hostile);for(const c of l)c.leaderId=e.id,c.tribeBadge=o;af(n,{type:Ys.NewTribeFormed,message:`A new tribe has formed! ${o}`,duration:pw,targetEntityIds:[e.id],highlightedEntityIds:[e.id,...l.map(c=>c.id)]}),Ue({gameState:n},Ee.TribeSplit,e.position)}function $f(e,n){const r=[];if(n.food.length>0&&n.hunger>Yi&&r.push({type:Re.Eat,action:"eating",key:"f"}),n.food.length<n.maxFood){const a=ke(n,e,"berryBush",yt,h=>h.food.length>0),c=ke(n,e,"corpse",yt,h=>h.food.length>0);let d=null;a&&c?d=K(n.position,a.position,e.mapDimensions.width,e.mapDimensions.height)<=K(n.position,c.position,e.mapDimensions.width,e.mapDimensions.height)?a:c:d=a||c,d&&r.push({type:Re.Gather,action:"gathering",key:"e",targetEntity:d})}const o=ke(n,e,"human",yt,a=>Rr(n,a,e));if(o&&r.push({type:Re.Procreate,action:"procreating",key:"r",targetEntity:o}),n.food.length>0&&n.isAdult){const a=ke(n,e,"human",yt,c=>{const d=c;return!d.isAdult&&(d.motherId===n.id||d.fatherId===n.id)&&d.hunger>=Yi});a&&r.push({type:Re.FeedChild,action:"feeding",key:"h",targetEntity:a})}const l=ke(n,e,"human",Yn,a=>Oo(n,a,e))??ke(n,e,"predator",Yn)??ke(n,e,"prey",Yn);return l&&r.push({type:Re.Attack,action:"attacking",key:"q",targetEntity:l}),n.food.filter(a=>a.type===di.Berry).length>=bs&&r.push({type:Re.Plant,action:"planting",key:"b"}),n.leaderId===n.id&&!n.isCallingToAttack&&kf(n,e,yv).length>0&&r.push({type:Re.CallToAttack,action:"idle",key:"v"}),bf(n,e).canSplit&&r.push({type:Re.TribeSplit,action:"idle",key:"k"}),n.leaderId===n.id&&!n.isCallingToFollow&&r.push({type:Re.FollowMe,action:"idle",key:"c"}),r}const Oo=(e,n,r)=>{var o,l,a,c;if(e.id===n.id)return!1;if(e.leaderId&&!n.leaderId)return!0;if(e.leaderId===n.leaderId)return!1;if(e.leaderId&&n.leaderId){const d=(l=(o=r.entities.entities[e.leaderId])==null?void 0:o.diplomacy)==null?void 0:l[n.leaderId],h=(c=(a=r.entities.entities[n.leaderId])==null?void 0:a.diplomacy)==null?void 0:c[e.leaderId];return d===bt.Hostile||h===bt.Hostile}return!1},Rr=(e,n,r)=>{if(e.id===n.id||e.gender===n.gender||!e.isAdult||!n.isAdult||e.hunger>=wr||n.hunger>=wr||(e.procreationCooldown||0)>0||(n.procreationCooldown||0)>0||Oo(e,n,r))return!1;const o=e.gender==="female"?e:n;return!(o.isPregnant||o.age>j0)},Fw={id:bl,update:(e,n)=>{const{entity:r,updateContext:o}=n,{gameState:l}=o,a=o.deltaTime*(wt/_t);if(r.age+=a,r.age>=r.lifespan)return{nextState:Gs,data:{...e,enteredAt:l.time,previousState:bl}};const c=Of(r.position,r.spreadRadius,l.mapDimensions.width,l.mapDimensions.height);return Io(c,l,15)||ta(l.entities,c,l.time),{nextState:hr,data:{...e,enteredAt:l.time,previousState:bl}}},onEnter:(e,n)=>({...n,enteredAt:e.updateContext.gameState.time})},Uw={id:Gs,update:e=>({nextState:Gs,data:e}),onEnter:(e,n)=>(na(e.updateContext.gameState.entities,e.entity.id),{...n,enteredAt:e.updateContext.gameState.time})},Lw=[PT,NT,Fw,Uw],Et="humanIdle",fr="humanMoving",Rs="humanEating",hu="humanGathering",Vs="humanProcreating",ji="humanAttacking",$l="humanPlanting",Hw={id:Et,update:(e,n)=>{const{entity:r,updateContext:o}=n;return r.activeAction==="attacking"&&r.attackTargetId?{nextState:ji,data:{...e,enteredAt:o.gameState.time,previousState:Et,attackTargetId:r.attackTargetId,attackStartTime:o.gameState.time}}:(r.hunger>=z0?(r.debuffs=r.debuffs.filter(l=>l.type!=="slow"),r.debuffs.push({type:"slow",startTime:o.gameState.time,duration:.1})):r.debuffs=r.debuffs.filter(l=>l.type!=="slow"),r.activeAction==="moving"?{nextState:fr,data:{...e,enteredAt:o.gameState.time,previousState:Et,target:r.target}}:r.activeAction==="gathering"?{nextState:hu,data:{...e,enteredAt:o.gameState.time,previousState:Et,target:r.target}}:r.activeAction==="eating"?{nextState:Rs,data:{...e,enteredAt:o.gameState.time,previousState:Et}}:r.activeAction==="planting"&&r.target?{nextState:$l,data:{...e,enteredAt:o.gameState.time,previousState:Et,plantingSpot:r.target}}:{nextState:Et,data:e})},onEnter:(e,n)=>(e.entity.acceleration=0,e.entity.velocity={x:0,y:0},{...n,enteredAt:e.updateContext.gameState.time})};function Ev(e){let n=mI;return e.hunger>=z0&&(n*=vI),e.age>=SI&&(n*=AI),e.movementSlowdown&&(n*=e.movementSlowdown.modifier),n}const Cd=7.5;class Bw{constructor(){Ne(this,"id",fr)}update(n,r){var h;const{entity:o,updateContext:l}=r;if(o.activeAction==="attacking"&&o.attackTargetId)return{nextState:ji,data:{...n,enteredAt:l.gameState.time,previousState:fr,attackTargetId:o.attackTargetId,attackStartTime:l.gameState.time}};if(o.activeAction!=="moving")return{nextState:Et,data:{...n,enteredAt:l.gameState.time,previousState:fr}};let a;if(typeof o.target=="object"?a=o.target:typeof o.target=="number"&&(a=(h=r.updateContext.gameState.entities.entities[o.target])==null?void 0:h.position),!a&&(o.direction.x!==0||o.direction.y!==0)&&(a={x:o.position.x+o.direction.x*Cd*2,y:o.position.y+o.direction.y*Cd*2}),!a)return{nextState:Et,data:{...n,enteredAt:l.gameState.time,previousState:fr}};const c=We(o.position,a,r.updateContext.gameState.mapDimensions.width,r.updateContext.gameState.mapDimensions.height);return o.direction=nt(c),o.acceleration=Ev(o),K(o.position,a,l.gameState.mapDimensions.width,l.gameState.mapDimensions.height)<Cd?{nextState:Et,data:{...n,enteredAt:l.gameState.time,previousState:fr}}:{nextState:fr,data:n}}onExit(n){const{entity:r}=n;r.acceleration=0}}const Gw=new Bw,bw={id:Rs,update:(e,n)=>{const{entity:r,updateContext:o}=n;return r.activeAction!=="eating"?{nextState:Et,data:{...e,enteredAt:o.gameState.time,previousState:Rs}}:(r.food.length>0&&(!r.eatingCooldownTime||o.gameState.time>=r.eatingCooldownTime)&&r.hunger>Yi&&(r.hunger=Math.max(0,r.hunger-Yi),r.food.pop(),r.eatingCooldownTime=o.gameState.time+1,Ue(o,Ee.Eat,r.position),(!r.lastEatingEffectTime||o.gameState.time-r.lastEatingEffectTime>2)&&(Pe(o.gameState,le.Eating,r.position,Ge,r.id),r.lastEatingEffectTime=o.gameState.time)),r.hunger<=0||r.food.length<=0?{nextState:Et,data:{...e,enteredAt:o.gameState.time,previousState:Rs}}:{nextState:Rs,data:e})},onEnter:(e,n)=>(e.entity.acceleration=0,e.entity.velocity={x:0,y:0},{...n,enteredAt:e.updateContext.gameState.time})};class xw{constructor(){Ne(this,"id",hu)}update(n,r){return r.entity.activeAction!=="gathering"?{nextState:"humanIdle",data:{...n,enteredAt:r.updateContext.gameState.time,previousState:this.id}}:{nextState:this.id,data:n}}}const $w=new xw,zw=(e,n)=>(n.procreationEndTime=e.updateContext.gameState.time+(n.duration||2),n),Ww=(e,n)=>{const{entity:r,updateContext:o}=n,{gameState:l}=o;if(l.time<(e.procreationEndTime||0))return{nextState:Vs,data:e};const a=l.entities.entities[e.partnerId];if(a&&a.type==="human"&&!a.isPregnant&&r.hunger<wr&&a.hunger<wr&&!r.procreationCooldown&&!a.procreationCooldown){const c=r.gender==="female"?r:a.gender==="female"?a:void 0,d=r.gender==="male"?r:a.gender==="male"?a:void 0;c&&d&&(c.isPregnant=!0,c.gestationTime=EI,c.pregnancyFatherId=d.id,r.procreationCooldown=gm,a.procreationCooldown=gm,Ue(o,Ee.Procreate,c.position))}return r.activeAction="idle",a&&(a.activeAction="idle"),{nextState:Et,data:{...e,enteredAt:l.time,previousState:Vs}}},Yw={id:Vs,onEnter:zw,update:Ww},jw={id:ji,onEnter:(e,n)=>({...n,enteredAt:e.updateContext.gameState.time,attackStartTime:e.updateContext.gameState.time}),update:(e,n)=>{if(n.entity.activeAction!=="attacking"||!n.entity.attackTargetId)return n.entity.activeAction="idle",{nextState:Et,data:{...e}};const r=n.updateContext.gameState.entities.entities[n.entity.attackTargetId];if(!r)return n.entity.activeAction="idle",{nextState:Et,data:{...e}};const o=K(n.entity.position,r.position,n.updateContext.gameState.mapDimensions.width,n.updateContext.gameState.mapDimensions.height),l=We(n.entity.position,r.position,n.updateContext.gameState.mapDimensions.width,n.updateContext.gameState.mapDimensions.height);return n.entity.direction=nt(l),o>Yn?n.entity.acceleration=Ev(n.entity):n.entity.acceleration=0,{nextState:ji,data:e}}},Vw={id:$l,update:(e,n)=>{const{entity:r,updateContext:o}=n,{gameState:l}=o;if(l.time-e.enteredAt>=_T){if(r.food.filter(d=>d.type===di.Berry).length>=bs){for(let h=0;h<bs;h++){const g=r.food.findIndex(m=>m.type===di.Berry);g>-1&&r.food.splice(g,1)}const d=ta(l.entities,e.plantingSpot,l.time);d.ownerId=r.id,d.claimedUntil=l.time+H0}return{nextState:Et,data:{...e,enteredAt:l.time,previousState:$l}}}return{nextState:$l,data:e}},onEnter:(e,n)=>(e.entity.acceleration=0,e.entity.velocity={x:0,y:0},{...n,enteredAt:e.updateContext.gameState.time})},Xw=[Hw,Gw,bw,$w,Yw,jw,Vw],Cn="preyIdle",Gi="preyMoving",Ps="preyGrazing",Ns="preyProcreating",Kw={id:Cn,update:(e,n)=>{const{entity:r,updateContext:o}=n;return r.activeAction==="moving"?{nextState:Gi,data:{...e,enteredAt:o.gameState.time,previousState:Cn,target:r.target}}:r.activeAction==="grazing"?{nextState:Ps,data:{...e,enteredAt:o.gameState.time,previousState:Cn}}:r.activeAction==="procreating"?{nextState:Ns,data:{...e,enteredAt:o.gameState.time,previousState:Cn}}:{nextState:Cn,data:e}},onEnter:(e,n)=>(e.entity.acceleration=0,e.entity.velocity={x:0,y:0},{...n,enteredAt:e.updateContext.gameState.time})},wv=12,qw=120,Hm=50,Qw=12,_v=30,Zw=2,xt=50,Jw=150,Fs=2,Rd=8,e_=.5,t_=1,n_=80,i_=.7,Cv=20,r_=140,Bm=40,o_=12,Rv=40,s_=3,zi=60,Rn=40,ro=50,Gm=320,Pv=25,a_=60,Nv=2,l_=90,u_=.7,c_=1.5,Us=3,Pd=15,zf=80,Ov=10,pu=80,Do=40,Dv=2,ql=30,lo=10,vr=40,uo=12,yr=48,co=12,Sr=50,fo=18,Ar=60,ho=.5,bi=2.5,po=.25,xi=2;function d_(e){let n=Qw;return e.isAdult||(n*=.7),e.hunger>=n_&&(n*=i_),e.movementSlowdown&&(n*=e.movementSlowdown.modifier),n}function f_(e,n){const r=e>>16&255,o=e>>8&255,l=e&255,a=n>>16&255,c=n>>8&255,d=n&255;let h=Math.floor((r+a)/2),g=Math.floor((o+c)/2),m=Math.floor((l+d)/2);return Math.random()<.05&&(h=Math.max(0,Math.min(255,h+(Math.random()-.5)*60))),Math.random()<.05&&(g=Math.max(0,Math.min(255,g+(Math.random()-.5)*60))),Math.random()<.05&&(m=Math.max(0,Math.min(255,m+(Math.random()-.5)*60))),h<<16|g<<8|m}function Xs(){const e=Math.floor(Math.random()*100)+100,n=Math.floor(Math.random()*80)+60,r=Math.floor(Math.random()*60)+20;return e<<16|n<<8|r}const Nd=10;class h_{constructor(){Ne(this,"id",Gi)}update(n,r){var h;const{entity:o,updateContext:l}=r;if(o.activeAction!=="moving")return{nextState:Cn,data:{...n,enteredAt:l.gameState.time,previousState:Gi}};let a;if(typeof o.target=="object"?a=o.target:typeof o.target=="number"&&(a=(h=r.updateContext.gameState.entities.entities[o.target])==null?void 0:h.position),!a&&(o.direction.x!==0||o.direction.y!==0)&&(a={x:o.position.x+o.direction.x*Nd*2,y:o.position.y+o.direction.y*Nd*2}),!a)return{nextState:Cn,data:{...n,enteredAt:l.gameState.time,previousState:Gi}};const c=We(o.position,a,r.updateContext.gameState.mapDimensions.width,r.updateContext.gameState.mapDimensions.height);return o.direction=nt(c),o.acceleration=d_(o),K(o.position,a,l.gameState.mapDimensions.width,l.gameState.mapDimensions.height)<Nd?{nextState:Cn,data:{...n,enteredAt:l.gameState.time,previousState:Gi}}:{nextState:Gi,data:n}}onExit(n){const{entity:r}=n;r.acceleration=0}onEnter(n,r){return{...r,enteredAt:n.updateContext.gameState.time}}}const p_=new h_,g_={id:Ps,update:(e,n)=>{const{entity:r,updateContext:o}=n;return r.activeAction==="moving"?{nextState:Gi,data:{...e,enteredAt:o.gameState.time,previousState:Ps,target:r.target}}:r.activeAction!=="grazing"?{nextState:Cn,data:{...e,enteredAt:o.gameState.time,previousState:Ps}}:{nextState:Ps,data:e}},onEnter:(e,n)=>(e.entity.acceleration=0,e.entity.velocity={x:0,y:0},{...n,enteredAt:e.updateContext.gameState.time})},m_={id:Ns,update:(e,n)=>{const{entity:r,updateContext:o}=n;return r.activeAction==="moving"?{nextState:Gi,data:{...e,enteredAt:o.gameState.time,previousState:Ns,target:r.target}}:r.activeAction!=="procreating"?{nextState:Cn,data:{...e,enteredAt:o.gameState.time,previousState:Ns}}:{nextState:Ns,data:e}},onEnter:(e,n)=>(e.entity.acceleration=0,e.entity.velocity={x:0,y:0},{...n,enteredAt:e.updateContext.gameState.time})},v_=[Kw,p_,g_,m_],Gt="predatorIdle",Hi="predatorMoving",si="predatorAttacking",oo="predatorProcreating",Tr="predatorEating",y_={id:Gt,update:(e,n)=>{const{entity:r,updateContext:o}=n;return r.activeAction==="eating"?{nextState:Tr,data:{...e,enteredAt:o.gameState.time,previousState:Gt,preyId:r.attackTargetId,eatingStartTime:o.gameState.time}}:r.activeAction==="attacking"&&r.attackTargetId?{nextState:si,data:{...e,enteredAt:o.gameState.time,previousState:Gt,attackTargetId:r.attackTargetId,attackStartTime:o.gameState.time}}:r.activeAction==="moving"?{nextState:Hi,data:{...e,enteredAt:o.gameState.time,previousState:Gt,target:r.target}}:r.activeAction==="procreating"?{nextState:oo,data:{...e,enteredAt:o.gameState.time,previousState:Gt}}:{nextState:Gt,data:e}},onEnter:(e,n)=>(e.entity.acceleration=0,e.entity.velocity={x:0,y:0},{...n,enteredAt:e.updateContext.gameState.time})};function kv(e){let n=o_;return e.hunger>=l_&&(n*=u_),e.isAdult||(n*=.7),e.movementSlowdown&&(n*=e.movementSlowdown.modifier),n}function S_(e,n){const r=e>>16&255,o=e>>8&255,l=e&255,a=n>>16&255,c=n>>8&255,d=n&255;let h=Math.floor((r+a)/2),g=Math.floor((o+c)/2),m=Math.floor((l+d)/2);return Math.random()<.05&&(h=Math.max(0,Math.min(255,h+(Math.random()-.5)*60))),Math.random()<.05&&(g=Math.max(0,Math.min(255,g+(Math.random()-.5)*60))),Math.random()<.05&&(m=Math.max(0,Math.min(255,m+(Math.random()-.5)*60))),h<<16|g<<8|m}function Ks(){const e=Math.floor(Math.random()*60)+60,n=Math.floor(Math.random()*50)+40,r=Math.floor(Math.random()*40)+20;return e<<16|n<<8|r}const Od=12;class A_{constructor(){Ne(this,"id",Hi)}update(n,r){var h;const{entity:o,updateContext:l}=r;if(o.activeAction==="eating")return{nextState:Tr,data:{...n,enteredAt:l.gameState.time,previousState:Hi,preyId:o.attackTargetId,eatingStartTime:l.gameState.time}};if(o.activeAction==="attacking"&&o.attackTargetId)return{nextState:si,data:{...n,enteredAt:l.gameState.time,previousState:Hi,attackTargetId:o.attackTargetId,attackStartTime:l.gameState.time}};if(o.activeAction!=="moving")return{nextState:Gt,data:{...n,enteredAt:l.gameState.time,previousState:Hi}};let a;if(typeof o.target=="object"?a=o.target:typeof o.target=="number"&&(a=(h=r.updateContext.gameState.entities.entities[o.target])==null?void 0:h.position),!a&&(o.direction.x!==0||o.direction.y!==0)&&(a={x:o.position.x+o.direction.x*Od*2,y:o.position.y+o.direction.y*Od*2}),!a)return{nextState:Gt,data:{...n,enteredAt:l.gameState.time,previousState:Hi}};const c=We(o.position,a,r.updateContext.gameState.mapDimensions.width,r.updateContext.gameState.mapDimensions.height);return o.direction=nt(c),o.acceleration=kv(o),K(o.position,a,l.gameState.mapDimensions.width,l.gameState.mapDimensions.height)<Od?{nextState:Gt,data:{...n,enteredAt:l.gameState.time,previousState:Hi}}:{nextState:Hi,data:n}}onExit(n){const{entity:r}=n;r.acceleration=0}onEnter(n,r){return{...r,enteredAt:n.updateContext.gameState.time}}}const T_=new A_,I_={id:si,update:(e,n)=>{const{entity:r,updateContext:o}=n;if(r.activeAction==="eating")return{nextState:Tr,data:{...e,enteredAt:o.gameState.time,previousState:si,preyId:r.attackTargetId,eatingStartTime:o.gameState.time}};if(r.activeAction!=="attacking"||!r.attackTargetId)return r.activeAction="idle",{nextState:Gt,data:{...e,enteredAt:o.gameState.time,previousState:si}};const l=o.gameState.entities.entities[r.attackTargetId];if(!l)return r.activeAction="idle",{nextState:Gt,data:{...e,enteredAt:o.gameState.time,previousState:si}};if(l.type==="prey"&&l.hitpoints<=0||l.type==="predator"&&l.hitpoints<=0||l.type==="human"&&l.hitpoints<=0)return r.activeAction="idle",{nextState:Gt,data:{...e,enteredAt:o.gameState.time,previousState:si}};const c=K(r.position,l.position,o.gameState.mapDimensions.width,o.gameState.mapDimensions.height),d=We(r.position,l.position,o.gameState.mapDimensions.width,o.gameState.mapDimensions.height);return r.direction=nt(d),c>Rn?r.acceleration=kv(r):r.acceleration=0,{nextState:si,data:e}},onEnter:(e,n)=>({...n,enteredAt:e.updateContext.gameState.time})},E_={id:oo,update:(e,n)=>{const{entity:r,updateContext:o}=n;return r.activeAction==="eating"?{nextState:Tr,data:{...e,enteredAt:o.gameState.time,previousState:oo,preyId:r.attackTargetId,eatingStartTime:o.gameState.time}}:r.activeAction==="attacking"&&r.attackTargetId?{nextState:si,data:{...e,enteredAt:o.gameState.time,previousState:oo,attackTargetId:r.attackTargetId,attackStartTime:o.gameState.time}}:r.activeAction!=="procreating"?{nextState:Gt,data:{...e,enteredAt:o.gameState.time,previousState:oo}}:{nextState:oo,data:e}},onEnter:(e,n)=>(e.entity.acceleration=0,e.entity.velocity={x:0,y:0},{...n,enteredAt:e.updateContext.gameState.time})},w_={id:Tr,update:(e,n)=>{const{entity:r,updateContext:o}=n;return r.activeAction!=="eating"?{nextState:Gt,data:{...e,enteredAt:o.gameState.time,previousState:Tr}}:{nextState:Tr,data:e}},onEnter:(e,n)=>(e.entity.acceleration=0,e.entity.velocity={x:0,y:0},{...n,enteredAt:e.updateContext.gameState.time})},__=[y_,T_,I_,E_,w_],bm=[...Lw,...Xw,...v_,...__];function C_(e,n,r){const o=gT(e,bm);if(!o)return vT(e),[e,n];const{nextState:l,data:a}=o.update(n,r);return mT(e,l)?[l,pT(o,l,a,r,bm)]:[l,a]}function R_(e,n,r){const{gameState:o}=n,l=r*(wt/_t);if(e.isAdult=e.age>=If,e.isCallingToAttack&&e.callToAttackEndTime&&o.time>e.callToAttackEndTime&&(e.isCallingToAttack=!1,e.callToAttackEndTime=void 0),e.isCallingToFollow&&e.callToFollowEndTime&&o.time>e.callToFollowEndTime&&(e.isCallingToFollow=!1,e.callToFollowEndTime=void 0),e.movementSlowdown&&o.time>e.movementSlowdown.endTime&&(e.movementSlowdown=void 0),e.hitpoints<e.maxHitpoints){const c=1-e.hunger/100*FI,d=MI*c*l;e.hitpoints=Math.min(e.maxHitpoints,e.hitpoints+d)}if(e.hunger+=r*(ys/(wt/_t)),e.hunger>RT&&(!e.lastHungerEffectTime||o.time-e.lastHungerEffectTime>gr*2)&&(Pe(o,le.Hunger,e.position,gr,e.id),e.lastHungerEffectTime=o.time),e.age+=r/uu,e.isPlayer){const c=Rt(o,e).filter(d=>d.hunger>=gw);if(c.length>0){const d=c.map(h=>h.id);af(o,{identifier:"children_starving",type:Ys.ChildrenStarving,message:"Your children are starving!",duration:hw,targetEntityIds:d,highlightedEntityIds:d})}}if(e.gender==="female"&&e.isPregnant&&e.gestationTime&&(e.gestationTime-=l,e.hunger+=r*((ys*wI-ys)/(wt/_t)),(!e.lastPregnantEffectTime||o.time-e.lastPregnantEffectTime>gr*3)&&(Pe(o,le.Pregnant,e.position,gr,e.id),e.lastPregnantEffectTime=o.time),e.gestationTime<=0&&(UC(e,e.pregnancyFatherId,n),e.isPregnant=!1,e.gestationTime=0,e.pregnancyFatherId=void 0)),e.procreationCooldown&&(e.procreationCooldown-=l,e.procreationCooldown<0&&(e.procreationCooldown=0)),e.attackCooldown&&(e.attackCooldown-=l,e.attackCooldown<0&&(e.attackCooldown=0)),e.feedParentCooldownTime&&(e.feedParentCooldownTime-=l,e.feedParentCooldownTime<0&&(e.feedParentCooldownTime=0)),e.feedChildCooldownTime&&(e.feedChildCooldownTime-=l,e.feedChildCooldownTime<0&&(e.feedChildCooldownTime=0)),e.leaderMetaStrategyCooldown&&(e.leaderMetaStrategyCooldown-=l,e.leaderMetaStrategyCooldown<0&&(e.leaderMetaStrategyCooldown=0)),e.isAdult?e.radius===No&&(e.radius=At):e.hunger+=r*((ys*_I-ys)/(wt/_t)),e.isAdult&&e.food.length>0&&(!e.feedParentCooldownTime||e.feedParentCooldownTime<=0)){const c=[];if(e.motherId){const d=o.entities.entities[e.motherId];d&&c.push(d)}if(e.fatherId){const d=o.entities.entities[e.fatherId];d&&c.push(d)}for(const d of c)if(d.age>=V0&&d.hunger>=PI&&K(e.position,d.position,o.mapDimensions.width,o.mapDimensions.height)<=NI){e.food.pop(),d.hunger=Math.max(0,d.hunger-Yi),e.feedParentCooldownTime=OI;break}}let a;if(e.hitpoints<=0?a="killed":e.hunger>=Er?e.food.length>0&&e.isAdult?(e.food.pop(),e.hunger=Math.max(0,e.hunger-Yi)):a="hunger":e.age>=e.maxAge&&(a="oldAge"),a){if(e.leaderId===e.id){const c=fi(Rt(o,e));c?(c.leaderId=c.id,c.tribeBadge=e.tribeBadge,c.diplomacy={...e.diplomacy},Object.values(o.entities.entities).forEach(d=>{if(d.type==="human"&&d.leaderId===e.id){const h=d;h.leaderId=c.id}})):Object.values(o.entities.entities).forEach(d=>{if(d.type==="human"&&d.leaderId===e.id){const h=d;h.leaderId=void 0,h.tribeBadge=void 0}})}if(e.isPlayer){const c=fi(Rt(o,e));c?(c.isPlayer=!0,o.generationCount++):(o.gameOver=!0,o.causeOfGameOver=a,af(o,{identifier:"no_heir",type:Ys.NoHeir,message:"Your lineage has ended. You have no heir.",duration:0}))}kC(o.entities,e.position,e.gender,e.age,e.radius,e.id,o.time,e.food,e.hunger),na(o.entities,e.id);return}e.animationProgress===void 0&&(e.animationProgress=0),e.animationSpeed===void 0&&(e.animationSpeed=1),e.animationProgress+=r*e.animationSpeed,e.animationProgress>=1&&(e.animationProgress=0)}function P_(e,n){const r=n.gameState.time-e.timeOfDeath;e.decayProgress=Math.min(1,r/DI);const o=Math.floor(X0*(1-e.decayProgress));e.food.length>o&&e.food.splice(o),e.decayProgress>=1&&e.food.length<=0&&na(n.gameState.entities,e.id)}function N_(e,n,r){const o=r*(wt/_t);e.age+=r/uu,e.isAdult=e.age>=Fs;let l=n.gameState.ecosystem.preyHungerIncreasePerHour*o;if(e.isPregnant&&(l*=1.2),e.hunger+=l,e.isPregnant&&e.gestationTime!==void 0&&(e.gestationTime-=o,e.gestationTime<=0)){const c={x:e.position.x+(Math.random()-.5)*40,y:e.position.y+(Math.random()-.5)*40};c.x=Math.max(20,Math.min(n.gameState.mapDimensions.width-20,c.x)),c.y=Math.max(20,Math.min(n.gameState.mapDimensions.height-20,c.y));const d=Math.random()<.5?"male":"female",h=e,g=e.fatherId?n.gameState.entities.entities[e.fatherId]:void 0;let m;if(g)m=f_(h.geneCode,g.geneCode);else{m=h.geneCode;const y=Math.floor((Math.random()-.5)*4096);m=Math.max(0,Math.min(16777215,m+y))}_o(n.gameState.entities,c,d,0,_v*.5,m,e.id,e.fatherId),Pe(n.gameState,le.Procreation,e.position,gr,e.id),Ue(n,Ee.Birth,e.position),e.isPregnant=!1,e.gestationTime=0,e.procreationCooldown=n.gameState.ecosystem.preyProcreationCooldown,e.fatherId=void 0}e.procreationCooldown&&e.procreationCooldown>0&&(e.procreationCooldown-=o,e.procreationCooldown<0&&(e.procreationCooldown=0)),e.eatingCooldownTime&&e.eatingCooldownTime>n.gameState.time||(e.eatingCooldownTime=void 0),e.fleeCooldown&&e.fleeCooldown>0&&(e.fleeCooldown-=o,e.fleeCooldown<0&&(e.fleeCooldown=0)),e.feedChildCooldownTime&&e.feedChildCooldownTime>0&&(e.feedChildCooldownTime-=o,e.feedChildCooldownTime<0&&(e.feedChildCooldownTime=0));let a=!1;e.hunger>=qw&&(a=!0),e.hitpoints<=0&&(a=!0),e.age>=wv&&(a=!0),a&&(MC(n.gameState.entities,e.position,e.gender,e.age,e.radius,e.id,n.gameState.time,e.geneCode),na(n.gameState.entities,e.id))}function O_(e,n,r){const o=r*(wt/_t);e.age+=r/uu,e.isAdult=e.age>=Us;let l=n.gameState.ecosystem.predatorHungerIncreasePerHour*o;if(e.isPregnant&&(l*=1.3),e.hunger+=l,e.isPregnant&&e.gestationTime!==void 0&&(e.gestationTime-=o,e.gestationTime<=0)){const c={x:e.position.x+(Math.random()-.5)*50,y:e.position.y+(Math.random()-.5)*50};c.x=Math.max(25,Math.min(n.gameState.mapDimensions.width-25,c.x)),c.y=Math.max(25,Math.min(n.gameState.mapDimensions.height-25,c.y));const d=Math.random()<.5?"male":"female",h=e,g=e.pregnancyFatherId?n.gameState.entities.entities[e.pregnancyFatherId]:void 0;let m;if(g)m=S_(h.geneCode,g.geneCode);else{m=h.geneCode;const y=Math.floor((Math.random()-.5)*4096);m=Math.max(0,Math.min(16777215,m+y))}Co(n.gameState.entities,c,d,0,Rv*.6,m,e.id,e.pregnancyFatherId),Pe(n.gameState,le.Procreation,e.position,gr,e.id),Ue(n,Ee.Birth,e.position),e.isPregnant=!1,e.gestationTime=0,e.procreationCooldown=n.gameState.ecosystem.predatorProcreationCooldown,e.pregnancyFatherId=void 0}e.procreationCooldown&&e.procreationCooldown>0&&(e.procreationCooldown-=o,e.procreationCooldown<0&&(e.procreationCooldown=0)),e.attackCooldown&&e.attackCooldown>0&&(e.attackCooldown-=o,e.attackCooldown<0&&(e.attackCooldown=0)),e.huntCooldown&&e.huntCooldown>0&&(e.huntCooldown-=o,e.huntCooldown<0&&(e.huntCooldown=0)),e.feedChildCooldownTime&&e.feedChildCooldownTime>0&&(e.feedChildCooldownTime-=o,e.feedChildCooldownTime<0&&(e.feedChildCooldownTime=0));let a=!1;e.hunger>=r_&&(a=!0),e.hitpoints<=0&&(a=!0),e.age>=Cv&&(a=!0),a&&(FC(n.gameState.entities,e.position,e.gender,e.age,e.radius,e.id,n.gameState.time,e.geneCode),na(n.gameState.entities,e.id))}var Js=(e=>(e[e.BehaviorTreeBased=0]="BehaviorTreeBased",e))(Js||{}),w=(e=>(e[e.SUCCESS=0]="SUCCESS",e[e.FAILURE=1]="FAILURE",e[e.RUNNING=2]="RUNNING",e[e.NOT_EVALUATED=3]="NOT_EVALUATED",e))(w||{});class Vn{constructor(){Ne(this,"name");Ne(this,"depth");Ne(this,"children");Ne(this,"child")}getLastStatus(n){return N.get(n.aiBlackboard,`${this.name}_lastStatus`)??3}setLastStatus(n,r){N.set(n.aiBlackboard,`${this.name}_lastStatus`,r)}getRunningChildIndex(n){return N.get(n.aiBlackboard,`${this.name}_runningChildIndex`)}setRunningChildIndex(n,r){N.set(n.aiBlackboard,`${this.name}_runningChildIndex`,r)}}const N={create(){return{data:{},nodeExecutionData:{}}},set({data:e},n,r){e[n]=r},get(e,n){return e==null?void 0:e.data[n]},delete({data:e},n){delete e[n]},has({data:e},n){return n in e},recordNodeExecution({nodeExecutionData:e},n,r,o,l,a){const c=e[n]||{lastExecuted:0,status:w.FAILURE,depth:0,debugInfo:"",executionHistory:[]},d=c.executionHistory[c.executionHistory.length-1];d&&o-(d==null?void 0:d.time)>xs&&c.executionHistory.push({time:d.time+xs,status:w.NOT_EVALUATED}),c.executionHistory.push({time:o,status:r});const h=hv/_t*wt,g=o-h;c.executionHistory=c.executionHistory.filter(y=>y.time>=g);const m={...c,lastExecuted:o,status:r,depth:l,debugInfo:a};e[n]=m},getNodeExecutionData({nodeExecutionData:e}){return e},cleanupOldEntries({nodeExecutionData:e},n){const r=zT,o=[];for(const[l,a]of Object.entries(e))n-a.lastExecuted>r&&o.push(l);for(const l of o)delete e[l]}};function Wf(e,n,r){if(e.aiBlackboard){const o=N.get(e.aiBlackboard,"lastAiUpdateTime")??0;n.gameState.time-o>=xs&&(r.execute(e,n,e.aiBlackboard),N.set(e.aiBlackboard,"lastAiUpdateTime",n.gameState.time))}else console.warn(`Behavior Tree AI ticked for human ${e.id}, but the tree or blackboard was missing.`),e.activeAction="idle"}const xm="Human Behavior",D_=1;class k_{constructor(){Ne(this,"nodeData",new Map);Ne(this,"pathStack",[]);Ne(this,"startTimeStack",[])}nodeStart(n){this.pathStack.push(n),this.startTimeStack.push(performance.now())}nodeEnd(){if(this.startTimeStack.length===0||this.pathStack.length===0){console.error("BTProfiler: nodeEnd() called without a matching nodeStart().");return}const n=performance.now(),r=this.startTimeStack.pop(),o=n-r,l=this.pathStack.join(" > "),a=this.nodeData.get(l)??{path:l,totalTime:0,callCount:0,minTime:1/0,maxTime:-1/0};a.totalTime+=o,a.callCount++,a.minTime=Math.min(a.minTime,o),a.maxTime=Math.max(a.maxTime,o),this.nodeData.set(l,a),this.pathStack.pop()}report(n={}){const{showAll:r=!1}=n,o=Array.from(this.nodeData.values());if(o.length===0){console.log("--- Behavior Tree Profiler: No data collected. ---");return}let l=o,a="--- Behavior Tree Full Report ---";if(!r){const d=this.nodeData.get(xm);if(d){const h=d.totalTime*D_/100;l=o.filter(g=>g.totalTime>h&&g.path!==xm),a="--- Behavior Tree Problem Report ---"}else console.log('BTProfiler: Root node "Human Behavior" not found. Showing full report.'),a="--- Behavior Tree Full Report (Root Not Found) ---"}const c=l.sort((d,h)=>h.totalTime-d.totalTime);console.log(a),c.length>0?console.table(c.map(d=>({Path:d.path,"Total Time (ms)":d.totalTime.toFixed(3),Calls:d.callCount,"Avg Time (ms)":(d.totalTime/d.callCount).toFixed(3),"Min Time (ms)":d.minTime.toFixed(3),"Max Time (ms)":d.maxTime.toFixed(3)}))):console.log("No significant performance problems detected."),console.log("------------------------------------")}reset(){this.nodeData.clear(),this.pathStack=[],this.startTimeStack=[]}}const dt=new k_;function Nn(e){return Array.isArray(e)?e:[e,""]}class me extends Vn{constructor(r,o,l=0){super();Ne(this,"name");Ne(this,"depth");this.children=r,this.name=o,this.depth=l,this.children.forEach(a=>{a.depth=(this.depth??0)+1})}execute(r,o,l){this.name&&dt.nodeStart(this.name);try{for(const a of this.children){const[c,d]=Nn(a.execute(r,o,l));if(c!==w.SUCCESS)return this.setLastStatus(r,c),this.name&&N.recordNodeExecution(l,this.name,c,o.gameState.time,this.depth,d),c}return this.setLastStatus(r,w.SUCCESS),this.name&&N.recordNodeExecution(l,this.name,w.SUCCESS,o.gameState.time,this.depth,""),w.SUCCESS}finally{this.name&&dt.nodeEnd()}}}class On extends Vn{constructor(r,o,l=0){super();Ne(this,"name");Ne(this,"depth");this.children=r,this.name=o,this.depth=l,this.children.forEach(a=>{a.depth=(this.depth??0)+1})}execute(r,o,l){this.name&&dt.nodeStart(this.name);try{const a=this.getRunningChildIndex(r)??0;for(let c=a;c<this.children.length;c++){const d=this.children[c],[h,g]=Nn(d.execute(r,o,l));if(h!==w.FAILURE){if(h===w.SUCCESS)return this.setRunningChildIndex(r,void 0),this.setLastStatus(r,w.SUCCESS),this.name&&N.recordNodeExecution(l,this.name,w.SUCCESS,o.gameState.time,this.depth,g),w.SUCCESS;if(h===w.RUNNING)return this.setRunningChildIndex(r,c),this.setLastStatus(r,w.RUNNING),this.name&&N.recordNodeExecution(l,this.name,w.RUNNING,o.gameState.time,this.depth,g),w.RUNNING}}return this.setRunningChildIndex(r,void 0),this.setLastStatus(r,w.FAILURE),this.name&&N.recordNodeExecution(l,this.name,w.FAILURE,o.gameState.time,this.depth,""),w.FAILURE}finally{this.name&&dt.nodeEnd()}}}class ue extends Vn{constructor(r,o,l=0){super();Ne(this,"name");Ne(this,"depth");this.action=r,this.name=o,this.depth=l}execute(r,o,l){this.name&&dt.nodeStart(this.name);try{const[a,c]=Nn(this.action(r,o,l));return this.setLastStatus(r,a),this.name&&N.recordNodeExecution(l,this.name,a,o.gameState.time,this.depth,c),a}finally{this.name&&dt.nodeEnd()}}}class oe extends Vn{constructor(r,o,l=0){super();Ne(this,"name");Ne(this,"depth");this.condition=r,this.name=o,this.depth=l}execute(r,o,l){this.name&&dt.nodeStart(this.name);try{const[a,c]=Nn(this.condition(r,o,l)),d=a?w.SUCCESS:w.FAILURE;return this.setLastStatus(r,d),this.name&&N.recordNodeExecution(l,this.name,d,o.gameState.time,this.depth,c),d}finally{this.name&&dt.nodeEnd()}}}class Ql extends Vn{constructor(r,o,l,a=0){super();Ne(this,"name");Ne(this,"depth");Ne(this,"startTimeKey");this.child=r,this.timeoutDurationHours=o,this.name=l,this.depth=a,this.child.depth=(this.depth??0)+1,this.startTimeKey=`timeout_${this.name}_startTime`}execute(r,o,l){dt.nodeStart(this.name);try{const a=o.gameState.time;let c=N.get(l,this.startTimeKey);const[d,h]=Nn(this.child.execute(r,o,l));if(d===w.RUNNING){c===void 0&&(N.set(l,this.startTimeKey,a),c=a);const g=a-c;if(g>this.timeoutDurationHours){N.delete(l,this.startTimeKey),this.setLastStatus(r,w.FAILURE);const y=`Timed out after ${g.toFixed(2)}h.`;return N.recordNodeExecution(l,this.name,this.getLastStatus(r),a,this.depth,y),this.getLastStatus(r)}this.setLastStatus(r,w.RUNNING);const m=`Running for ${g.toFixed(2)}h. ${h}`;return N.recordNodeExecution(l,this.name,this.getLastStatus(r),a,this.depth,m),this.getLastStatus(r)}return c!==void 0&&N.delete(l,this.startTimeKey),this.setLastStatus(r,d),N.recordNodeExecution(l,this.name,this.getLastStatus(r),a,this.depth,h),this.getLastStatus(r)}finally{dt.nodeEnd()}}}class qs extends Vn{constructor(r,o,l,a=0,c){super();Ne(this,"name");Ne(this,"depth");Ne(this,"statusKey");Ne(this,"timestampKey");this.child=r,this.cacheDurationHours=o,this.validityCheck=c,this.name=l,this.depth=a,this.child.depth=(this.depth??0)+1,this.statusKey=`caching_${this.name}_status`,this.timestampKey=`caching_${this.name}_timestamp`}execute(r,o,l){dt.nodeStart(this.name);try{const a=o.gameState.time,c=N.get(l,this.statusKey),d=N.get(l,this.timestampKey);if(c!==void 0&&d!==void 0){const y=a-d>this.cacheDurationHours,S=this.validityCheck?this.validityCheck(r,o,l):!0;if(!y&&S){const E=(d+this.cacheDurationHours-a).toFixed(2),I=`Cache hit. Status: ${w[c]}. ${E}h left.`;return this.setLastStatus(r,c),N.recordNodeExecution(l,this.name,this.getLastStatus(r),a,this.depth,I),this.getLastStatus(r)}}const[h,g]=Nn(this.child.execute(r,o,l));(h===w.SUCCESS||h===w.FAILURE)&&(N.set(l,this.statusKey,h),N.set(l,this.timestampKey,a)),this.setLastStatus(r,h);const m=`Cache miss. Child returned ${w[h]}. ${g}`;return N.recordNodeExecution(l,this.name,this.getLastStatus(r),a,this.depth,m),this.getLastStatus(r)}finally{dt.nodeEnd()}}}class Pr extends Vn{constructor(r,o,l,a=0){super();Ne(this,"name");Ne(this,"depth");Ne(this,"cooldownKey");this.cooldownDurationHours=r,this.child=o,this.name=l,this.depth=a,this.child.depth=(this.depth??0)+1,this.cooldownKey=`cooldown_${this.name}`}execute(r,o,l){dt.nodeStart(this.name);try{const a=o.gameState.time,c=N.get(l,this.cooldownKey);if(this.child.getLastStatus(r)===w.RUNNING){const[g,m]=Nn(this.child.execute(r,o,l));if(this.setLastStatus(r,g),this.name){const y=`Continuing running child. ${m}`;N.recordNodeExecution(l,this.name,this.getLastStatus(r),a,this.depth,y)}return this.getLastStatus(r)}if(c!==void 0&&a<c){const m=`Cooldown active, ${(c-a).toFixed(2)}h left`;return this.setLastStatus(r,w.FAILURE),this.name&&N.recordNodeExecution(l,this.name,this.getLastStatus(r),a,this.depth,m),this.getLastStatus(r)}const[d,h]=Nn(this.child.execute(r,o,l));return(d===w.SUCCESS||d===w.RUNNING)&&N.set(l,this.cooldownKey,a+this.cooldownDurationHours),this.setLastStatus(r,d),this.name&&N.recordNodeExecution(l,this.name,this.getLastStatus(r),a,this.depth,h),this.getLastStatus(r)}finally{dt.nodeEnd()}}}class cr extends Vn{constructor(r,o,l,a=0){super();Ne(this,"name");Ne(this,"depth");this.child=r,this.behaviorKey=o,this.name=l,this.depth=a;const c=(d,h)=>{d.depth=h,d.children?d.children.forEach(g=>c(g,h+1)):d.child&&c(d.child,h+1)};c(this.child,(this.depth??0)+1)}execute(r,o,l){this.name&&dt.nodeStart(this.name);try{if(r.isPlayer&&!o.gameState.autopilotControls.behaviors[this.behaviorKey]){const h=`Player autopilot for '${this.behaviorKey}' is disabled.`;return this.setLastStatus(r,w.FAILURE),this.name&&N.recordNodeExecution(l,this.name,this.getLastStatus(r),o.gameState.time,this.depth,h),this.getLastStatus(r)}const[c,d]=Nn(this.child.execute(r,o,l));return this.setLastStatus(r,c),this.name&&N.recordNodeExecution(l,this.name,this.getLastStatus(r),o.gameState.time,this.depth,d),this.getLastStatus(r)}finally{this.name&&dt.nodeEnd()}}}class M_ extends Vn{constructor(r,o,l=0){super();Ne(this,"name");Ne(this,"depth");this.child=r,this.name=o,this.depth=l;const a=(c,d)=>{c.depth=d,c.children?c.children.forEach(h=>a(h,d+1)):c.child&&a(c.child,d+1)};a(this.child,(this.depth??0)+1)}execute(r,o,l){this.name&&dt.nodeStart(this.name);try{if(r.isPlayer&&o.gameState.autopilotControls.isManuallyMoving)return this.setLastStatus(r,w.FAILURE),this.name&&N.recordNodeExecution(l,this.name,this.getLastStatus(r),o.gameState.time,this.depth,"Manual movement active, AI blocked."),this.getLastStatus(r);const[a,c]=Nn(this.child.execute(r,o,l));return this.setLastStatus(r,a),this.name&&N.recordNodeExecution(l,this.name,this.getLastStatus(r),o.gameState.time,this.depth,c),this.getLastStatus(r)}finally{this.name&&dt.nodeEnd()}}}class Is extends Vn{constructor(r,o,l=0){super();Ne(this,"name");Ne(this,"depth");this.child=r,this.name=o,this.depth=l;const a=(c,d)=>{c.depth=d,c.children?c.children.forEach(h=>a(h,d+1)):c.child&&a(c.child,d+1)};a(this.child,(this.depth??0)+1)}execute(r,o,l){this.name&&dt.nodeStart(this.name);try{if(r.isPlayer)return this.setLastStatus(r,w.FAILURE),this.name&&N.recordNodeExecution(l,this.name,this.getLastStatus(r),o.gameState.time,this.depth,"Player controlled, AI blocked."),this.getLastStatus(r);const[a,c]=Nn(this.child.execute(r,o,l));return this.setLastStatus(r,a),this.name&&N.recordNodeExecution(l,this.name,this.getLastStatus(r),o.gameState.time,this.depth,c),this.getLastStatus(r)}finally{this.name&&dt.nodeEnd()}}}function F_(e){return new me([new oe((n,r)=>{const o=n.hunger>=dm,l=n.food.length>0,a=!n.eatingCooldownTime||r.gameState.time>=n.eatingCooldownTime;return[!!(n.isAdult&&o&&l&&a),`${Math.floor(n.hunger-dm)}, ${n.food.length}, ${n.eatingCooldownTime?Math.floor(n.eatingCooldownTime-r.gameState.time):""}`]},"Can Eat",e+1),new ue(n=>(n.direction={x:0,y:0},n.target=void 0,n.activeAction="eating",w.RUNNING),"Eat",e+1)],"Eating",e)}function U_(e){return new me([new oe((n,r,o)=>{if(n.isAdult&&n.hitpoints>n.maxHitpoints*x0||n.isAdult&&n.hunger>GT)return!1;const l=VI(n.id,r.gameState);return l?(N.set(o,"fleeThreat",l.id),!0):!1},"Should Flee",e+1),new ue((n,r,o)=>{const l=N.get(o,"fleeThreat"),a=l&&r.gameState.entities.entities[l];if(!a)return w.FAILURE;n.activeAction="moving";const c=We(a.position,n.position,r.gameState.mapDimensions.width,r.gameState.mapDimensions.height),d=nt(c),h=jn(n.position,Ct(d,$0));return n.target={x:(h.x%r.gameState.mapDimensions.width+r.gameState.mapDimensions.width)%r.gameState.mapDimensions.width,y:(h.y%r.gameState.mapDimensions.height+r.gameState.mapDimensions.height)%r.gameState.mapDimensions.height},n.direction=d,w.RUNNING},"Execute Flee",e+1)],"Flee",e)}const Es="foodSource";function L_(e){const n=new ue((o,l,a)=>{const c=new Map,d=ke(o,l.gameState,"berryBush",pm,m=>{if(m.food.length===0)return!1;if(!m.ownerId||!m.claimedUntil||l.gameState.time>=m.claimedUntil)return!0;const y=l.gameState.entities.entities[m.ownerId];if(!y||y.leaderId===o.leaderId)return!0;const S=c.get(y.id)??K(o.position,y.position,l.gameState.mapDimensions.width,l.gameState.mapDimensions.height);return c.set(y.id,S),S>fI}),h=ke(o,l.gameState,"corpse",pm,m=>m.food.length>0);let g=null;if(d&&h){const m=K(o.position,d.position,l.gameState.mapDimensions.width,l.gameState.mapDimensions.height),y=K(o.position,h.position,l.gameState.mapDimensions.width,l.gameState.mapDimensions.height);g=m<=y?d:h}else g=d||h;return g?(N.set(a,Es,g.id),[w.SUCCESS,`Found food: ${g.type} at ${g.position.x.toFixed(0)},${g.position.y.toFixed(0)}`]):[w.FAILURE,"No food source found"]},"Find Closest Food Source",e+4),r=new ue((o,l,a)=>{const c=N.get(a,Es),d=c&&l.gameState.entities.entities[c];return!d||d.food.length===0?(N.delete(a,Es),[w.FAILURE,"Food source is invalid or depleted"]):K(o.position,d.position,l.gameState.mapDimensions.width,l.gameState.mapDimensions.height)<_r?(o.activeAction="gathering",o.direction={x:0,y:0},o.target=d.id,N.delete(a,Es),[w.SUCCESS,`Gathering from ${d.type}`]):(o.activeAction="moving",o.target=d.id,o.direction=qt(o.position,d.position,l.gameState.mapDimensions),[w.RUNNING,`Moving to ${d.type}`])},"Move To Food and Gather",e+3);return new me([new oe((o,l)=>{const a=o.food.length<o.maxFood,c=o.hunger>OT,d=Rt(l.gameState,o).filter(h=>h.hunger>Ef);return[(o.isAdult&&a&&(c||d.length>0))??!1,`${c?"H":""}, ${d.length>0?" HC("+d.length+")":""}`]},"Should Gather Food",e+1),new On([new me([new oe((o,l,a)=>N.has(a,Es),"Has Food Source?",e+2),r],"Continue Gathering Action",e+2),new me([new qs(n,XT,"Cache Food Source Search",e+3),r],"Find New Food Source and Gather",e+2)],"Perform or Start Gathering",e+1)],"Gather Food",e)}function H_(e){return new ue((n,r,o)=>(n.activeAction="idle",n.direction={x:0,y:0},n.target=void 0,N.set(o,"wanderTarget",void 0),w.SUCCESS),"Idle",e)}const Il="procreationWanderStartTime",$m=(e,n,r)=>n.find(o=>Rr(e,o,r));function B_(e){const n=new oe((a,c,d)=>{const h=vm(a,c.gameState,_r),g=$m(a,h,c.gameState);return g?(N.set(d,"procreationPartner",g.id),!0):!1},"Find Immediate Partner"),r=new ue((a,c,d)=>{var m;const h=N.get(d,"procreationPartner"),g=h&&c.gameState.entities.entities[h];return g?(a.activeAction="procreating",a.target=void 0,N.delete(d,"procreationPartner"),N.delete(d,Il),(m=a.partnerIds)!=null&&m.includes(g.id)||(a.partnerIds=a.partnerIds?[...a.partnerIds,g.id]:[g.id]),w.SUCCESS):w.FAILURE},"Start Procreating"),o=new oe((a,c,d)=>{const h=vm(a,c.gameState,BT),g=$m(a,h,c.gameState);return g?(N.set(d,"procreationPartner",g.id),!0):!1},"Locate Distant Partner"),l=new ue((a,c,d)=>{const h=N.get(d,"procreationPartner"),g=h&&c.gameState.entities.entities[h];if(!g)return w.FAILURE;if(K(a.position,g.position,c.gameState.mapDimensions.width,c.gameState.mapDimensions.height)<_r)return w.SUCCESS;a.activeAction="moving",a.target=g.id;const y=We(a.position,g.position,c.gameState.mapDimensions.width,c.gameState.mapDimensions.height);return a.direction=nt(y),w.RUNNING},"Move Towards Partner");return new me([new oe(a=>!(!a.isAdult||a.gender==="female"&&a.isPregnant||a.age<TI||a.gender==="female"&&a.age>j0),"Is Fertile (age, not pregnant)",e+1),new oe(a=>a.hunger<wr,"Is Healthy (hunger)",e+1),new oe(a=>(a.procreationCooldown||0)<=0,"Is Ready (cooldown)",e+1),new On([new me([new oe((a,c)=>tv(a.position,c.gameState,"berryBush",HT)>=LT,"Is Environment Viable (food)",e+3),new ue((a,c,d)=>(N.delete(d,Il),w.SUCCESS),"Clear Wander Timer",e+3)],"Sufficient Food Path",e+2),new me([new oe((a,c)=>{if(a.gender==="male"){const d=Rt(c.gameState,a);return!fi(d)}return!1},"Is Male Without Heir",e+3),new ue((a,c,d)=>{const h=N.get(d,Il);if(h===void 0)return N.set(d,Il,c.gameState.time),[w.FAILURE,"Starting heirless wander timer"];const g=c.gameState.time-h;return g>=II?[w.SUCCESS,`Wandered for ${g.toFixed(1)}h, proceeding without food`]:[w.FAILURE,`Wandering for heir, ${g.toFixed(1)}h elapsed`]},"Check Wander Timer",e+3)],"Heirless Desperation Path",e+2)],"Check Environment Or Desperation",e+1),new oe((a,c,d)=>{var g;const h=N.get(d,"procreationPartner");return h&&((g=h.partnerIds)!=null&&g.length)&&!h.partnerIds.includes(a.id)&&h.partnerIds.map(m=>c.gameState.entities.entities[m]).filter(m=>!!m).some(m=>K(a.position,m.position,c.gameState.mapDimensions.width,c.gameState.mapDimensions.height)<dI)?[!1,"Partner's primary partner is too close"]:!0},"Is Partner's Primary Partner Nearby",e+1),new On([new me([n,r],"Procreate With Immediate Partner",e+2),new Pr(YT,new me([o,l],"Seek Distant Partner Action",e+3),"Seek Distant Partner Cooldown",e+2)],"Find Partner And Procreate",e+1)],"Procreate",e)}const eo="attackTarget",dr="homeCenter",Dd=150;function G_(e){return new me([new oe((n,r,o)=>{if(!n.isAdult)return[!1,"Not an adult"];const{gameState:l}=r;if(n.activeAction==="attacking"&&n.attackTargetId){const c=l.entities.entities[n.attackTargetId];if(c&&c.hitpoints>0&&K(n.position,c.position,l.mapDimensions.width,l.mapDimensions.height)<=Dd){if(N.set(o,eo,c.id),!N.get(o,dr)){const d=n.leaderId?Cr(n.leaderId,l):Vl(n,l).length>0?ym(n,l):n.position;N.set(o,dr,d)}return!0}}const a=ke(n,l,"human",Dd,c=>c.hitpoints>0&&Oo(n,c,l));if(a){N.set(o,eo,a.id);const c=n.leaderId?Cr(n.leaderId,l):Vl(n,l).length>0?ym(n,l):n.position;return N.set(o,dr,c),!0}return N.set(o,eo,void 0),N.set(o,dr,void 0),!1},"Find Attack Target",e+1),new ue((n,r,o)=>{const l=N.get(o,eo),a=l&&r.gameState.entities.entities[l],c=N.get(o,dr);if(!a||!c)return w.FAILURE;const{gameState:d}=r;return K(n.position,c,d.mapDimensions.width,d.mapDimensions.height)>b0?(n.activeAction="idle",n.attackTargetId=void 0,N.set(o,eo,void 0),N.set(o,dr,void 0),w.FAILURE):a.hitpoints<=0||K(n.position,a.position,d.mapDimensions.width,d.mapDimensions.height)>Dd?(n.activeAction==="attacking"&&(n.activeAction="idle",n.attackTargetId=void 0),N.set(o,eo,void 0),N.set(o,dr,void 0),w.SUCCESS):(n.activeAction==="attacking"&&n.attackTargetId===a.id||(n.activeAction="attacking",n.attackTargetId=a.id),w.RUNNING)},"Execute Attack",e+1)],"Attack",e)}const b_=(e,n,r)=>{const o=Rt(n.gameState,e).filter(c=>!c.isAdult);if(o.length===0)return w.FAILURE;let l=null,a=Ef;for(const c of o)c.hunger>=a&&(a=c.hunger,l=c);return l?(N.set(r,"targetChild",l.id),w.SUCCESS):w.FAILURE},x_=(e,n,r)=>{const o=N.get(r,"targetChild"),l=o&&n.gameState.entities.entities[o];return l?K(e.position,l.position,n.gameState.mapDimensions.width,n.gameState.mapDimensions.height)>wf?(e.activeAction="moving",e.target=l.id,e.direction=qt(e.position,l.position,n.gameState.mapDimensions),w.RUNNING):(e.activeAction="feeding",e.target=void 0,N.set(r,"targetChild",void 0),w.SUCCESS):w.FAILURE};function $_(e){return new me([new oe(n=>(n.isAdult&&n.food.length>0&&(!n.feedChildCooldownTime||n.feedChildCooldownTime<=0))??!1,"Can Feed Child",e+1),new ue(b_,"Find Hungriest Child",e+1),new ue(x_,"Move To Child and Feed",e+1)],"Feed Child",e)}function z_(e){return new me([new oe(n=>!n.isAdult&&n.hunger>=Ef,"Is Hungry Child",e+1),new ue((n,r,o)=>{const l=WI(n,r.gameState);if(l.length===0)return w.FAILURE;const a=ke(n,r.gameState,"human",RI,c=>l.some(d=>d.id===c.id)&&c.food.length>0);return a?(N.set(o,"targetParent",a.id),w.SUCCESS):w.FAILURE},"Find Parent With Food",e+1),new ue((n,r,o)=>{const l=N.get(o,"targetParent"),a=l&&r.gameState.entities.entities[l];if(!a)return w.FAILURE;const c=K(n.position,a.position,r.gameState.mapDimensions.width,r.gameState.mapDimensions.height);return n.activeAction="idle",c<=wf?(n.target=void 0,w.SUCCESS):(n.target=a.id,n.activeAction="moving",w.RUNNING)},"Move To Parent",e+1)],"Seek Food From Parent",e)}const El="plantingSpot";function W_(e){const n=new ue((o,l,a)=>{const c=N.get(a,El);return!c||Io(c,l.gameState,lu,o.id)?(N.delete(a,El),[w.FAILURE,"Planting spot is invalid or now occupied"]):K(o.position,c,l.gameState.mapDimensions.width,l.gameState.mapDimensions.height)>_r?(o.activeAction="moving",o.target=c,o.direction=qt(o.position,c,l.gameState.mapDimensions),[w.RUNNING,"Moving to planting spot"]):(o.activeAction="planting",o.target=c,[w.RUNNING,"Planting state initiated"])},"Move To Spot and Plant",e+3),r=new ue((o,l,a)=>{const c=eE(o,l.gameState);return c?(N.set(a,El,c),[w.SUCCESS,`Found new spot at ${c.x.toFixed(0)}, ${c.y.toFixed(0)}`]):[w.FAILURE,"No suitable planting spot found"]},"Find Optimal Planting Spot",e+3);return new me([new oe(o=>{const l=o.food.filter(c=>c.type===di.Berry).length>=bs,a=o.hunger<DT;return(o.isAdult&&l&&a)??!1},"Can Plant",e+1),new oe((o,l)=>{const a=tv(o.position,l.gameState,"berryBush",CT),c=Rt(l.gameState,o);return!(c.length===0||a>=c.length*5)},"Has Not Enough Nearby Bushes",e+1),new On([new me([new oe((o,l,a)=>N.has(a,El),"Has Planting Spot?",e+2),n],"Continue Planting Action",e+2),new Pr(VT,r,"Find Planting Spot Cooldown",e+2)],"Perform or Start Planting",e+1)],"Plant Bush",e)}const kd="enemiesNearby";function Y_(e){const n=new oe(a=>a.id===a.leaderId,"Is Leader?",e+1),r=new oe(a=>!a.isCallingToAttack,"Is Not Already Calling?",e+1),o=new ue((a,c,d)=>{const h=kf(a,c.gameState,yv);return h.length>0?(N.set(d,kd,h.map(g=>g.id)),w.SUCCESS):w.FAILURE},"Find Nearby Enemies",e+1),l=new On([new me([new oe((a,c,d)=>{const h=N.get(d,kd),g=h==null?void 0:h.map(E=>c.gameState.entities.entities[E]).filter(E=>!!E);if(!g||g.length===0)return!1;const m=zs(a.id,c.gameState),y=Xl(m),S=Xl(g);return y>S*iI},"Is Strong Enough?",e+3),new ue((a,c)=>(a.isCallingToAttack=!0,a.callToAttackEndTime=c.gameState.time+wo,Pe(c.gameState,le.CallToAttack,a.position,wo),Ue(c,Ee.CallToAttack,a.position),a.activeAction="idle",a.target=void 0,w.SUCCESS),"Issue Call to Attack",e+3)],"Attack",e+2),new ue((a,c,d)=>{const h=N.get(d,kd),g=h==null?void 0:h.map(T=>c.gameState.entities.entities[T]).filter(T=>!!T);if(!g||g.length===0)return w.FAILURE;const m=g.map(T=>T.position),y=Nf(m),S=We(y,a.position,c.gameState.mapDimensions.width,c.gameState.mapDimensions.height),E=nt(S),I=jn(a.position,Ct(E,$0*2));return a.activeAction="moving",a.target={x:(I.x%c.gameState.mapDimensions.width+c.gameState.mapDimensions.width)%c.gameState.mapDimensions.width,y:(I.y%c.gameState.mapDimensions.height+c.gameState.mapDimensions.height)%c.gameState.mapDimensions.height},a.direction=E,w.SUCCESS},"Retreat",e+2)],"Attack or Retreat",e+2);return new me([n,r,o,new Pr(rI,l,"Leader Combat Cooldown",e+1)],"Leader Combat Strategy",e)}const Md="combatTarget",Fd="homeCenter";function j_(e){const n=new oe(c=>c.isAdult&&c.leaderId?c.id!==c.leaderId:!1,"Is Tribe Follower?",e+1),r=new oe(c=>c.hunger<kT&&c.hitpoints>=c.maxHitpoints*x0,"Is Fit for Combat?",e+1),o=new oe((c,d)=>{const h=d.gameState.entities.entities[c.leaderId];return!!(h!=null&&h.isCallingToAttack)},"Is Leader Calling to Attack?",e+1),l=new ue((c,d,h)=>{const{gameState:g}=d,m=g.entities.entities[c.leaderId];if(!m)return w.FAILURE;const y=kf(m,g,bT);if(y.length===0)return w.FAILURE;y.sort((S,E)=>{const I=K(c.position,S.position,g.mapDimensions.width,g.mapDimensions.height),T=K(c.position,E.position,g.mapDimensions.width,g.mapDimensions.height);return I-T});for(const S of y)if(tE(m.id,S.id,g)<xT){N.set(h,Md,S.id);const I=Cr(m.id,g);return N.set(h,Fd,I),w.SUCCESS}return w.FAILURE},"Find Best Target",e+1),a=new ue((c,d,h)=>{const g=N.get(h,Md),m=g&&d.gameState.entities.entities[g],y=N.get(h,Fd);if(!m||!y)return w.FAILURE;const{gameState:S}=d;return K(c.position,y,S.mapDimensions.width,S.mapDimensions.height)>b0?(c.activeAction==="attacking"&&c.attackTargetId===m.id&&(c.activeAction="idle",c.attackTargetId=void 0),N.set(h,Md,void 0),N.set(h,Fd,void 0),w.FAILURE):((!c.lastTargetAcquiredEffectTime||d.gameState.time-c.lastTargetAcquiredEffectTime>Ge*5)&&(Pe(d.gameState,le.TargetAcquired,c.position,Ge,c.id),c.lastTargetAcquiredEffectTime=d.gameState.time),c.activeAction="attacking",c.attackTargetId=m.id,c.target=void 0,w.RUNNING)},"Attack Target",e+1);return new me([n,r,o,l,a],"Tribe Member Combat",e)}function V_(e){const n=new oe((m,y)=>{if(!m.isAdult||m.gender!=="male")return!1;const S=m.partnerIds&&m.partnerIds.length>0,E=Rt(y.gameState,m).length>0;return S||E},"Is Adult Male With Family?",e+1),r=new oe((m,y)=>{var T;const S=St(y.gameState);if(S){const C=fi(Rt(y.gameState,S));if((C==null?void 0:C.id)===m.id)return!1}if(!m.fatherId)return!1;const E=y.gameState.entities.entities[m.fatherId];return!E||((T=fi(Rt(y.gameState,E)))==null?void 0:T.id)===m.id?!1:K(m.position,E.position,y.gameState.mapDimensions.width,y.gameState.mapDimensions.height)<WT},"Is Too Close To Father?",e+1),o=new oe((m,y,S)=>N.get(S,"territoryMoveTarget")!==void 0,"Is Moving To Territory?",e+3),l=new ue((m,y,S)=>{const E=N.get(S,"territoryMoveTarget"),I=N.get(S,"territoryMoveStartTime");if(!E||!I)return[w.FAILURE,"Missing move data"];if(y.gameState.time-I>$T)return N.delete(S,"territoryMoveTarget"),N.delete(S,"territoryMoveStartTime"),[w.FAILURE,"Territory move timed out"];if(K(m.position,E,y.gameState.mapDimensions.width,y.gameState.mapDimensions.height)<_r)return N.delete(S,"territoryMoveTarget"),N.delete(S,"territoryMoveStartTime"),[w.SUCCESS,"Arrived at new territory"];m.activeAction="moving",m.target=E;const U=We(m.position,m.target,y.gameState.mapDimensions.width,y.gameState.mapDimensions.height);return m.direction=nt(U),[w.RUNNING,"Continuing move to territory"]},"Check Timeout & Arrival",e+3),a=new me([o,l],"Handle In-Progress Move",e+2),c=new oe((m,y,S)=>N.get(S,"territoryMoveTarget")===void 0,"Should Start New Move?",e+4),d=new ue((m,y,S)=>{const E=Of(m.position,y.gameState.mapDimensions.width/4,y.gameState.mapDimensions.width,y.gameState.mapDimensions.height);N.set(S,"territoryMoveTarget",E),N.set(S,"territoryMoveStartTime",y.gameState.time),m.activeAction="moving",m.target=E;const I=We(m.position,m.target,y.gameState.mapDimensions.width,y.gameState.mapDimensions.height);return m.direction=nt(I),[w.RUNNING,"Started moving to new territory"]},"Start New Territory Move",e+4),h=new me([c,d],"Start New Territory Move Action",e+3),g=new On([a,new Pr(jT,h,"Establish Territory Cooldown",e+2)],"Establish or Continue Move",e+1);return new me([n,r,g],"Establish Family Territory",e)}function X_(e){return new me([new ue((n,r,o)=>{const l=jI(n,r.gameState);return l?(N.set(o,"patriarchTarget",l.id),[w.SUCCESS,`Found patriarch: ${l.id}`]):(N.delete(o,"patriarchTarget"),[w.FAILURE,"No patriarch found"])},"Find Patriarch",e+1),new ue((n,r,o)=>{const l=N.get(o,"patriarchTarget"),a=l&&r.gameState.entities.entities[l];if(!a)return[w.FAILURE,"Patriarch target missing from blackboard"];const c=K(n.position,a.position,r.gameState.mapDimensions.width,r.gameState.mapDimensions.height);if(c>G0){n.activeAction="moving",n.target=a.id;const d=We(n.position,a.position,r.gameState.mapDimensions.width,r.gameState.mapDimensions.height);return n.direction=nt(d),[w.RUNNING,`Moving to patriarch at ${c.toFixed(0)}`]}return n.activeAction="idle",n.target=void 0,n.direction={x:0,y:0},[w.SUCCESS,`Arrived at patriarch at ${c.toFixed(0)}`]},"Move Towards Patriarch",e+1)],"Follow Patriarch",e)}const Ud="tribeSplitMigrationTarget";function K_(e){const n=new me([new oe((r,o)=>{const{canSplit:l,progress:a}=bf(r,o.gameState);return l?[!0,`Progress: ${(a??0)*100}%`]:[!1,"Cannot split"]},"Can Split Tribe?",e+2),new ue((r,o,l)=>{const{gameState:a}=o;let c=N.get(l,Ud);if(!c){if(!r.leaderId)return w.FAILURE;const h=Cr(r.leaderId,a),g=Mw(h,r,a);if(g)N.set(l,Ud,g),c=g;else return w.FAILURE}return K(r.position,c,a.mapDimensions.width,a.mapDimensions.height)<_r?(N.delete(l,Ud),r.activeAction="idle",r.target=void 0,w.SUCCESS):(r.activeAction="moving",r.target=c,w.RUNNING)},"Move to New Territory",e+2),new ue((r,o)=>(xf(r,o.gameState),w.SUCCESS),"Perform Tribe Split",e+2)],"Tribe Split Action",e+1);return new Pr(fw,n,"Tribe Split Cooldown",e)}const wl="jealousyAttackTarget";function q_(e){return new me([new oe((n,r,o)=>{if(!n.isAdult)return[!1,"Not an adult"];const l=qI(n,r.gameState,oI);return l?(N.set(o,wl,l.id),[!0,`Partner cheating with ${l.id}`]):(N.delete(o,wl),!1)},"Check for Infidelity",e+1),new ue((n,r,o)=>{const l=N.get(o,wl),a=l&&r.gameState.entities.entities[l];return!a||a.hitpoints<=0?(N.delete(o,wl),[w.FAILURE,"Target is invalid or dead"]):n.activeAction==="attacking"&&n.attackTargetId===a.id?w.RUNNING:(n.activeAction="attacking",n.attackTargetId=a.id,[w.RUNNING,`Attacking ${a.id}`])},"Execute Jealousy Attack",e+1)],"Jealousy Attack",e)}const _l="defendAggressor";function Q_(e){return new me([new oe((n,r,o)=>{if(!n.isAdult)return[!1,"Not an adult"];const l=ZI(n,r.gameState,sI);return l?(N.set(o,_l,l.aggressor.id),[!0,`Family member ${l.familyMember.id} attacked by ${l.aggressor.id}`]):(N.delete(o,_l),!1)},"Check Family Under Attack",e+1),new ue((n,r,o)=>{const l=N.get(o,_l),a=l&&r.gameState.entities.entities[l];return!a||a.hitpoints<=0?(N.delete(o,_l),[w.FAILURE,"Target invalid/dead"]):n.activeAction==="attacking"&&n.attackTargetId===a.id?w.RUNNING:(n.activeAction="attacking",n.attackTargetId=a.id,[w.RUNNING,`Attacking aggressor ${a.id}`])},"Execute Family Defense Attack",e+1)],"Defend Family",e)}const Cl="bushIntruder";function Z_(e){return new me([new oe((n,r,o)=>{if(!n.isAdult)return[!1,"Not an adult"];const l=QI(n,r.gameState,aI);return l?(N.set(o,Cl,l.id),[!0,`Intruder ${l.id} stealing berries`]):(N.delete(o,Cl),!1)},"Check For Intruders on Bushes",e+1),new ue((n,r,o)=>{const l=N.get(o,Cl),a=l&&r.gameState.entities.entities[l];return!a||a.hitpoints<=0?(N.delete(o,Cl),[w.FAILURE,"Intruder is invalid or dead"]):n.activeAction==="attacking"&&n.attackTargetId===a.id?w.RUNNING:(n.activeAction="attacking",n.attackTargetId=a.id,[w.RUNNING,`Attacking intruder ${a.id}`])},"Execute Bush Defense Attack",e+1)],"Defend Claimed Bush",e)}const Rl="desperateAttackTarget";function J_(e){return new me([new oe(n=>n.hunger>lI,"Is Starving",e+1),new oe((n,r)=>{if(!n.isAdult)return[!1,"Not an adult"];const o=ke(n,r.gameState,"berryBush",yt,a=>a.food.length>0),l=ke(n,r.gameState,"corpse",yt,a=>a.food.length>0);return!o&&!l},"No Other Food Available",e+1),new oe((n,r,o)=>{const l=JI(n,r.gameState);return l?(N.set(o,Rl,l.id),[!0,`Found weak target ${l.id}`]):(N.delete(o,Rl),!1)},"Find Weak Target",e+1),new ue((n,r,o)=>{const l=N.get(o,Rl),a=l&&r.gameState.entities.entities[l];return!a||a.hitpoints<=0?(N.delete(o,Rl),[w.FAILURE,"Target is invalid or dead"]):n.activeAction==="attacking"&&n.attackTargetId===a.id?w.RUNNING:(n.activeAction="attacking",n.attackTargetId=a.id,[w.RUNNING,`Desperately attacking ${a.id}`])},"Execute Desperate Attack",e+1)],"Desperate Attack",e)}function eC(e,n,r,o){const l=e.entities.entities[r.targetEntityId];return!l||!("hitpoints"in l)||l.hitpoints<=0?(e.autopilotControls.activeAutopilotAction=void 0,w.FAILURE):K(n.position,l.position,e.mapDimensions.width,e.mapDimensions.height)<=xl?(n.activeAction="attacking",n.attackTargetId=l.id,e.autopilotControls.activeAutopilotAction=void 0,w.SUCCESS):(n.activeAction="moving",n.target=l.id,n.direction=qt(n.position,l.position,e.mapDimensions),w.RUNNING)}function tC(e){return new me([new oe((n,r)=>n.isPlayer===!0&&!!r.gameState.autopilotControls.activeAutopilotAction,"Has Player Command",e+1),new ue((n,r)=>{const{gameState:o}=r,l=o.autopilotControls.activeAutopilotAction;if(!l)return w.FAILURE;switch(l.action){case Re.AutopilotMove:{const a=l.position;return K(n.position,a,o.mapDimensions.width,o.mapDimensions.height)<hI?(o.autopilotControls.activeAutopilotAction=void 0,n.activeAction==="moving"&&(n.activeAction="idle",n.target=void 0),w.SUCCESS):(n.activeAction="moving",n.target=a,n.direction=qt(n.position,a,o.mapDimensions),w.RUNNING)}case Re.AutopilotGather:{const a=o.entities.entities[l.targetEntityId];return!a||a.food.length===0?(o.autopilotControls.activeAutopilotAction=void 0,w.FAILURE):K(n.position,a.position,o.mapDimensions.width,o.mapDimensions.height)>_r?(n.activeAction="moving",n.target=a.id,n.direction=qt(n.position,a.position,o.mapDimensions),w.RUNNING):(n.activeAction="gathering",n.target=a.id,o.autopilotControls.activeAutopilotAction=void 0,w.SUCCESS)}case Re.AutopilotAttack:return eC(o,n,l);case Re.AutopilotProcreate:{const a=o.entities.entities[l.targetEntityId];return!a||a.type!=="human"||!Rr(n,a,r.gameState)?(o.autopilotControls.activeAutopilotAction=void 0,w.FAILURE):K(n.position,a.position,o.mapDimensions.width,o.mapDimensions.height)<=xl?(n.activeAction="procreating",o.autopilotControls.activeAutopilotAction=void 0,w.SUCCESS):(n.activeAction="moving",n.target=a.id,n.direction=qt(n.position,a.position,o.mapDimensions),w.RUNNING)}case Re.AutopilotPlant:{if(n.activeAction==="planting")return w.RUNNING;const a=l.position;return Io(a,o,lu,n.id)?(o.autopilotControls.activeAutopilotAction=void 0,w.FAILURE):K(n.position,a,o.mapDimensions.width,o.mapDimensions.height)<=xl?(n.activeAction="planting",n.target=a,o.autopilotControls.activeAutopilotAction=void 0,o.hasPlayerPlantedBush=!0,w.RUNNING):(n.activeAction="moving",n.target=a,n.direction=qt(n.position,a,o.mapDimensions),w.RUNNING)}case Re.AutopilotFeedChild:{const a=o.entities.entities[l.targetEntityId];return!a||a.type!=="human"||a.isAdult||n.food.length===0?(o.autopilotControls.activeAutopilotAction=void 0,w.FAILURE):K(n.position,a.position,o.mapDimensions.width,o.mapDimensions.height)<=xl?(o.autopilotControls.activeAutopilotAction=void 0,n.activeAction="feeding",w.SUCCESS):(n.activeAction="moving",n.target=a.id,n.direction=qt(n.position,a.position,o.mapDimensions),w.RUNNING)}case Re.AutopilotFollowMe:{const a=o.entities.entities[l.targetEntityId];return!a||a.type!=="human"||a.id!==a.leaderId?(o.autopilotControls.activeAutopilotAction=void 0,w.FAILURE):K(n.position,a.position,o.mapDimensions.width,o.mapDimensions.height)<=G0?(o.autopilotControls.activeAutopilotAction=void 0,n.activeAction==="moving"&&(n.activeAction="idle"),w.SUCCESS):(n.activeAction="moving",n.target=a.id,n.direction=qt(n.position,a.position,o.mapDimensions),w.RUNNING)}default:return o.autopilotControls.activeAutopilotAction=void 0,w.FAILURE}},"Execute Player Command",e+1)],"Player Command Handler",e)}function nC(e){return new me([new oe(n=>!!n.leaderId&&n.leaderId!==n.id,"Is Follower",e+1),new oe((n,r)=>{if(!n.leaderId)return!1;const o=r.gameState.entities.entities[n.leaderId];return!!o&&o.isCallingToFollow===!0},"Is Leader Calling To Follow",e+1),new oe(n=>n.hunger<UT,"Is Not Critically Hungry",e+1),new ue((n,r)=>{if(!n.leaderId)return w.FAILURE;const o=r.gameState.entities.entities[n.leaderId];return o?K(n.position,o.position,r.gameState.mapDimensions.width,r.gameState.mapDimensions.height)>FT?(n.activeAction="moving",n.target=o.id,n.direction=qt(n.position,o.position,r.gameState.mapDimensions),w.RUNNING):(n.activeAction==="moving"&&n.target===o.id&&(n.activeAction="idle",n.target=void 0),w.SUCCESS):w.FAILURE},"Execute Follow Leader",e+1)],"Follow Leader Command",e)}const zm="tribeMigrationCheckCooldown";function iC(e){const n=new me([new oe(o=>!!o.leaderId&&o.leaderId===o.id,"Is Tribe Leader",e+2),new oe((o,l)=>{const a=N.get(o.aiBlackboard,zm);return a?l.gameState.time-a>=hm:!0},"Is Migration Check Cooldown Over",e+2),new ue((o,l)=>{o.aiBlackboard&&N.set(o.aiBlackboard,zm,l.gameState.time);const a=nE(o,l.gameState);return a?(o.isCallingToFollow=!0,o.callToFollowEndTime=l.gameState.time+Ws,o.target=a,o.activeAction="moving",w.SUCCESS):w.FAILURE},"Execute Tribe Migration",e+2)],"Tribe Migration Strategy",e+1),r=new qs(n,nf,"Cache Tribe Migration",e+1);return new Pr(hm,r,"Tribe Migration Cooldown",e)}function rC(e){const n=new oe(o=>o.id===o.leaderId,"Is Leader?",e+1),r=new ue((o,l)=>{var g;const{gameState:a}=l,c=zs(o.id,a),d=Xl(c),h=J0(a).filter(m=>m.leaderId!==o.id);for(const m of h){const y=zs(m.leaderId,a),S=Xl(y),E=((g=o.diplomacy)==null?void 0:g[m.leaderId])||bt.Friendly;d>S*nI?E!==bt.Hostile&&o.diplomacy&&(o.diplomacy[m.leaderId]=bt.Hostile):E!==bt.Friendly&&o.diplomacy&&(o.diplomacy[m.leaderId]=bt.Friendly)}return w.SUCCESS},"Evaluate Diplomacy",e+2);return new me([n,new Pr(qT,r,"Diplomacy Cooldown",e+1)],"Manage Diplomacy",e)}const Pl="huntTarget";function oC(e){return new me([new qs(new oe((r,o,l)=>{var h;if(!r.isAdult)return[!1,"Not an adult"];if(!r.leaderId)return[!1,"Not in a tribe"];const a=Cr(r.leaderId,o.gameState),c=((h=ev(a,o.gameState,"berryBush",fm))==null?void 0:h.map(g=>g.id))||[],d=ke(a,o.gameState,"prey",fm,g=>typeof g.target=="number"&&c.includes(g.target));return d?(N.set(l,Pl,d.id),!0):!1},"Find Prey Target",e+2),KT,"Cache Find Prey",e+1),new Ql(new ue((r,o,l)=>{if(!r.leaderId)return w.FAILURE;const a=N.get(l,Pl);if(!a)return w.FAILURE;const c=o.gameState.entities.entities[a];if(!c||c.hitpoints<=0)return N.delete(l,Pl),r.activeAction="idle",r.attackTargetId=void 0,w.SUCCESS;const{gameState:d}=o,h=Cr(r.leaderId,d);return K(r.position,h,d.mapDimensions.width,d.mapDimensions.height)>MT?(N.delete(l,Pl),r.activeAction="idle",r.attackTargetId=void 0,w.FAILURE):(r.activeAction="attacking",r.attackTargetId=c.id,w.RUNNING)},"Hunt Prey Action",e+2),tf,"Hunt Prey Timeout",e+1)],"Human Hunt Prey Sequence",e)}const Nl="defendTarget",Ld=150;function sC(e){return new me([new oe((n,r,o)=>{if(!n.isAdult)return[!1,"Not an adult - children flee instead"];const{gameState:l}=r;if(n.activeAction==="attacking"&&n.attackTargetId){const c=l.entities.entities[n.attackTargetId];if(c&&c.type==="predator"&&c.hitpoints>0&&K(n.position,c.position,l.mapDimensions.width,l.mapDimensions.height)<=Ld)return N.set(o,Nl,c.id),[!0,"Continuing defense"]}const a=ke(n,l,"predator",Ld,c=>c.hitpoints>0&&(c.isAdult||!1));if(a){const c=K(n.position,a.position,l.mapDimensions.width,l.mapDimensions.height),d=a.attackTargetId===n.id,h=c<80;if(d||h)return N.set(o,Nl,a.id),[!0,"Predator threat detected"]}return N.set(o,Nl,void 0),[!1,"No predator threat"]},"Detect Predator Threat",e+1),new ue((n,r,o)=>{const l=N.get(o,Nl),a=l&&r.gameState.entities.entities[l];if(!a)return w.FAILURE;const{gameState:c}=r,d=K(n.position,a.position,c.mapDimensions.width,c.mapDimensions.height);return a.hitpoints<=0||d>Ld*1.5?(n.activeAction="idle",n.attackTargetId=void 0,w.SUCCESS):(n.activeAction="attacking",n.attackTargetId=a.id,w.RUNNING)},"Defend Against Predator",e+1)],"Human Defend Against Predator",e)}function aC(e){return new me([new oe((n,r,o)=>{const l=ke(n,r.gameState,"predator",xt*2,()=>!0),a=ke(n,r.gameState,"human",xt*2,()=>!0);let c=null,d=1/0;if(l){const h=K(n.position,l.position,r.gameState.mapDimensions.width,r.gameState.mapDimensions.height);h<d&&(d=h,c=l)}if(a){const h=K(n.position,a.position,r.gameState.mapDimensions.width,r.gameState.mapDimensions.height);h<d&&(d=h,c=a)}return c&&d<xt*1.5?(N.set(o,"fleeThreat",c.id),N.set(o,"fleeDistance",d),!0):!1},"Detect Threat",e+1),new ue((n,r,o)=>{const l=N.get(o,"fleeThreat"),a=l&&r.gameState.entities.entities[l];if(!a)return w.FAILURE;n.activeAction="moving";const c=We(a.position,n.position,r.gameState.mapDimensions.width,r.gameState.mapDimensions.height),d=nt(c),h=jn(n.position,Ct(d,Jw));return n.target={x:(h.x%r.gameState.mapDimensions.width+r.gameState.mapDimensions.width)%r.gameState.mapDimensions.width,y:(h.y%r.gameState.mapDimensions.height+r.gameState.mapDimensions.height)%r.gameState.mapDimensions.height},n.direction=d,n.fleeCooldown=r.gameState.time+2,w.RUNNING},"Execute Flee",e+1)],"Prey Flee",e)}function lC(e){return new me([new oe((n,r,o)=>{if(!n.isAdult)return[!1,"Not an adult"];if(n.hunger<=30||n.eatingCooldownTime&&n.eatingCooldownTime>r.gameState.time)return!1;const l=ke(n,r.gameState,"berryBush",xt*10,a=>a.food.length>0);return l?K(n.position,l.position,r.gameState.mapDimensions.width,r.gameState.mapDimensions.height)<=xt?(N.set(o,"grazingTarget",l.id),!0):(N.set(o,"grazingTarget",l.id),N.set(o,"needToMoveToTarget",!0),!0):!1},"Find Berry Bush",e+1),new ue((n,r,o)=>{const l=N.get(o,"grazingTarget"),a=l&&r.gameState.entities.entities[l],c=N.get(o,"needToMoveToTarget");if(!a)return w.FAILURE;const d=K(n.position,a.position,r.gameState.mapDimensions.width,r.gameState.mapDimensions.height);if(d<=xt)return n.activeAction="grazing",n.target=a.id,n.direction={x:0,y:0},N.delete(o,"needToMoveToTarget"),w.RUNNING;if(c||d>xt){n.activeAction="moving",n.target=a.id;const h=qt(n.position,a.position,r.gameState.mapDimensions);return n.direction=h,w.RUNNING}return w.FAILURE},"Move to Bush or Graze",e+1)],"Prey Graze",e)}function uC(e){const n=new oe((a,c,d)=>{const h=ke(a,c.gameState,"prey",xt,g=>g.id!==a.id&&g.gender!==a.gender&&!!g.isAdult&&g.age>=Fs&&g.age<=Rd&&!g.isPregnant&&(!g.procreationCooldown||g.procreationCooldown<=0)&&g.hunger<200);return h?(N.set(d,"procreationPartner",h.id),!0):!1},"Find Immediate Partner",e+2),r=new ue((a,c,d)=>{const h=N.get(d,"procreationPartner"),g=h&&c.gameState.entities.entities[h];return g?(a.activeAction="procreating",a.target=g.id,a.direction={x:0,y:0},N.delete(d,"procreationPartner"),w.SUCCESS):w.FAILURE},"Start Procreating",e+2),o=new oe((a,c,d)=>{const h=ke(a,c.gameState,"prey",xt*10,g=>g.id!==a.id&&g.gender!==a.gender&&!!g.isAdult&&g.age>=Fs&&g.age<=Rd&&!g.isPregnant&&(!g.procreationCooldown||g.procreationCooldown<=0)&&g.hunger<200);return h?(N.set(d,"procreationPartner",h.id),!0):!1},"Locate Distant Partner",e+2),l=new ue((a,c,d)=>{const h=N.get(d,"procreationPartner"),g=h&&c.gameState.entities.entities[h];if(!g)return w.FAILURE;if(K(a.position,g.position,c.gameState.mapDimensions.width,c.gameState.mapDimensions.height)<=xt)return w.SUCCESS;a.activeAction="moving",a.target=g.id;const y=We(a.position,g.position,c.gameState.mapDimensions.width,c.gameState.mapDimensions.height);return a.direction=nt(y),w.RUNNING},"Move Towards Partner",e+2);return new me([new oe(a=>!!(a.isAdult&&!a.isPregnant&&a.age>=Fs&&a.age<=Rd&&a.hunger<200&&(!a.procreationCooldown||a.procreationCooldown<=0)),"Is Fertile and Ready",e+1),new On([new me([n,r],"Procreate With Immediate Partner",e+2),new me([o,l],"Seek Distant Partner",e+2)],"Find Partner And Procreate",e+1)],"Prey Procreate",e)}const cC=(e,n,r)=>{const o=n.gameState.search.prey.byProperty("motherId",e.id).filter(c=>!c.isAdult&&c.type==="prey");if(o.length===0)return w.FAILURE;let l=null,a=pu;for(const c of o)c.hunger>=a&&(a=c.hunger,l=c);return l?(N.set(r,"targetChild",l.id),w.SUCCESS):w.FAILURE},dC=(e,n,r)=>{const o=N.get(r,"targetChild"),l=o&&n.gameState.entities.entities[o];return l?K(e.position,l.position,n.gameState.mapDimensions.width,n.gameState.mapDimensions.height)>Do?(e.activeAction="moving",e.target=l.id,e.direction=qt(e.position,l.position,n.gameState.mapDimensions),w.RUNNING):(e.activeAction="feeding",e.target=void 0,N.set(r,"targetChild",void 0),w.SUCCESS):w.FAILURE};function fC(e){return new me([new oe(n=>(n.isAdult&&n.gender==="female"&&n.hunger<80&&(!n.feedChildCooldownTime||n.feedChildCooldownTime<=0))??!1,"Can Feed Child (Female Only)",e+1),new ue(cC,"Find Hungriest Prey Child",e+1),new ue(dC,"Move To Child and Feed",e+1)],"Feed Prey Child",e)}function hC(e){return new me([new oe(n=>!n.isAdult&&n.hunger>=pu,"Is Hungry Prey Child",e+1),new ue((n,r,o)=>{if(!n.motherId)return w.FAILURE;const l=r.gameState.entities.entities[n.motherId];return l?(N.set(o,"targetParent",l.id),w.SUCCESS):w.FAILURE},"Find Female Parent",e+1),new ue((n,r,o)=>{const l=N.get(o,"targetParent"),a=l&&r.gameState.entities.entities[l];if(!a)return w.FAILURE;const c=K(n.position,a.position,r.gameState.mapDimensions.width,r.gameState.mapDimensions.height);return n.activeAction="idle",c<=Do?(n.target=void 0,w.SUCCESS):(n.target=a.id,n.activeAction="moving",w.RUNNING)},"Move To Female Parent",e+1)],"Seek Food From Female Parent",e)}function pC(e){return new me([new oe((n,r,o)=>{if(!n.isAdult)return[!1,"Not an adult"];if(n.hunger<=50||n.huntCooldown&&n.huntCooldown>0)return!1;const l=ke(n,r.gameState,"prey",ro*10,a=>a.hitpoints>0);if(l){const a=K(n.position,l.position,r.gameState.mapDimensions.width,r.gameState.mapDimensions.height);if(a<=ro)return N.set(o,"huntTarget",l.id),!0;if(a<=ro*10)return N.set(o,"huntTarget",l.id),N.set(o,"needToApproach",!0),!0}return!1},"Find Prey Target",e+1),new Ql(new ue((n,r,o)=>{const l=N.get(o,"huntTarget"),a=l&&r.gameState.entities.entities[l],c=N.get(o,"needToApproach");if(!a||a.hitpoints<=0)return w.FAILURE;const d=K(n.position,a.position,r.gameState.mapDimensions.width,r.gameState.mapDimensions.height);if(d<=ro)return n.activeAction="attacking",n.attackTargetId=a.id,n.target=a.id,n.direction={x:0,y:0},N.delete(o,"needToApproach"),w.RUNNING;if(c||d>ro){n.activeAction="moving",n.target=a.id;const h=We(n.position,a.position,r.gameState.mapDimensions.width,r.gameState.mapDimensions.height);return n.direction=nt(h),w.RUNNING}return w.FAILURE},"Hunt or Approach Prey",e+2),10,"Hunt Timeout (10 hour)",e+1)],"Predator Hunt",e)}function gC(e){return new me([new oe((n,r,o)=>{const l=n.hunger>100,a=n.hitpoints<n.maxHitpoints*.5;if(!l&&!a||n.attackCooldown&&n.attackCooldown>0)return!1;const c=ke(n,r.gameState,"human",Rn*2,d=>d.hitpoints>0);if(c){const d=K(n.position,c.position,r.gameState.mapDimensions.width,r.gameState.mapDimensions.height);if(d<=Rn)return N.set(o,"attackTarget",c.id),!0;if(l&&d<=Rn*2)return N.set(o,"attackTarget",c.id),N.set(o,"needToApproach",!0),!0}return!1},"Find Human Target",e+1),new ue((n,r,o)=>{const l=N.get(o,"attackTarget"),a=l&&r.gameState.entities.entities[l],c=N.get(o,"needToApproach");if(!a||a.hitpoints<=0)return w.FAILURE;const d=K(n.position,a.position,r.gameState.mapDimensions.width,r.gameState.mapDimensions.height);if(d<=Rn)return n.activeAction="attacking",n.attackTargetId=a.id,n.target=a.id,n.direction={x:0,y:0},N.delete(o,"needToApproach"),w.RUNNING;if(c||d>Rn){n.activeAction="moving",n.target=a.id;const h=We(n.position,a.position,r.gameState.mapDimensions.width,r.gameState.mapDimensions.height);return n.direction=nt(h),w.RUNNING}return w.FAILURE},"Attack or Approach Human",e+1)],"Predator Attack Human",e)}function mC(e){const n=new oe((a,c,d)=>{const h=ke(a,c.gameState,"predator",zi,g=>g.id!==a.id&&g.gender!==a.gender&&!!g.isAdult&&g.age>=Us&&g.age<=Pd&&!g.isPregnant&&(!g.procreationCooldown||g.procreationCooldown<=0)&&g.hunger<200);return h?(N.set(d,"procreationPartner",h.id),!0):!1},"Find Immediate Partner",e+2),r=new ue((a,c,d)=>{const h=N.get(d,"procreationPartner"),g=h&&c.gameState.entities.entities[h];return g?(a.activeAction="procreating",a.target=g.id,a.direction={x:0,y:0},N.delete(d,"procreationPartner"),w.SUCCESS):w.FAILURE},"Start Procreating",e+2),o=new oe((a,c,d)=>{const h=ke(a,c.gameState,"predator",zi*10,g=>g.id!==a.id&&g.gender!==a.gender&&!!g.isAdult&&g.age>=Us&&g.age<=Pd&&!g.isPregnant&&(!g.procreationCooldown||g.procreationCooldown<=0)&&g.hunger<200);return h?(N.set(d,"procreationPartner",h.id),!0):!1},"Locate Distant Partner",e+2),l=new ue((a,c,d)=>{const h=N.get(d,"procreationPartner"),g=h&&c.gameState.entities.entities[h];if(!g)return w.FAILURE;if(K(a.position,g.position,c.gameState.mapDimensions.width,c.gameState.mapDimensions.height)<=zi)return w.SUCCESS;a.activeAction="moving",a.target=g.id;const y=We(a.position,g.position,c.gameState.mapDimensions.width,c.gameState.mapDimensions.height);return a.direction=nt(y),w.RUNNING},"Move Towards Partner",e+2);return new me([new oe(a=>!!(a.isAdult&&!a.isPregnant&&a.age>=Us&&a.age<=Pd&&a.hunger<200&&(!a.procreationCooldown||a.procreationCooldown<=0)),"Is Fertile and Ready",e+1),new On([new me([n,r],"Procreate With Immediate Partner",e+2),new me([o,l],"Seek Distant Partner",e+2)],"Find Partner And Procreate",e+1)],"Predator Procreate",e)}const vC=(e,n,r)=>{const o=n.gameState.search.predator.byProperty("motherId",e.id).filter(c=>!c.isAdult&&c.type==="predator");if(o.length===0)return w.FAILURE;let l=null,a=pu;for(const c of o)c.hunger>=a&&(a=c.hunger,l=c);return l?(N.set(r,"targetChild",l.id),w.SUCCESS):w.FAILURE},yC=(e,n,r)=>{const o=N.get(r,"targetChild"),l=o&&n.gameState.entities.entities[o];return l?K(e.position,l.position,n.gameState.mapDimensions.width,n.gameState.mapDimensions.height)>Do?(e.activeAction="moving",e.target=l.id,e.direction=qt(e.position,l.position,n.gameState.mapDimensions),w.RUNNING):(e.activeAction="feeding",e.target=void 0,N.set(r,"targetChild",void 0),w.SUCCESS):w.FAILURE};function SC(e){return new me([new oe(n=>(n.isAdult&&n.gender==="female"&&n.hunger<90&&(!n.feedChildCooldownTime||n.feedChildCooldownTime<=0))??!1,"Can Feed Child (Female Only)",e+1),new ue(vC,"Find Hungriest Predator Child",e+1),new ue(yC,"Move To Child and Feed",e+1)],"Feed Predator Child",e)}function AC(e){return new me([new oe(n=>!n.isAdult&&n.hunger>=pu,"Is Hungry Predator Child",e+1),new ue((n,r,o)=>{if(!n.motherId)return w.FAILURE;const l=r.gameState.entities.entities[n.motherId];return l?(N.set(o,"targetParent",l.id),w.SUCCESS):w.FAILURE},"Find Female Parent",e+1),new ue((n,r,o)=>{const l=N.get(o,"targetParent"),a=l&&r.gameState.entities.entities[l];if(!a)return w.FAILURE;const c=K(n.position,a.position,r.gameState.mapDimensions.width,r.gameState.mapDimensions.height);return n.activeAction="idle",c<=Do?(n.target=void 0,w.SUCCESS):(n.target=a.id,n.activeAction="moving",w.RUNNING)},"Move To Female Parent",e+1)],"Seek Food From Female Parent",e)}function Mv(e){return new ue((n,r,o)=>{n.activeAction="idle";let l=N.get(o,"wanderTarget"),a=N.get(o,"wanderStartTime");const c=r.gameState.time;if(!l||!a||c-a>2){const d=Math.random()*2*Math.PI,h=50+Math.random()*100,g={x:Math.cos(d),y:Math.sin(d)},m=jn(n.position,Ct(g,h));l={x:(m.x%r.gameState.mapDimensions.width+r.gameState.mapDimensions.width)%r.gameState.mapDimensions.width,y:(m.y%r.gameState.mapDimensions.height+r.gameState.mapDimensions.height)%r.gameState.mapDimensions.height},N.set(o,"wanderTarget",l),N.set(o,"wanderStartTime",c)}if(l){n.target=l;let d=l.x-n.position.x,h=l.y-n.position.y;const g=r.gameState.mapDimensions.width,m=r.gameState.mapDimensions.height;Math.abs(d)>g/2&&(d=d>0?d-g:d+g),Math.abs(h)>m/2&&(h=h>0?h-m:h+m);const y=nt({x:d,y:h});n.direction=y}return w.SUCCESS},"Animal Wander",e)}function TC(e){return new me([new oe((n,r,o)=>{if(n.hunger>90||n.hitpoints<n.maxHitpoints*.3||n.activeAction==="grazing"||n.activeAction==="procreating")return!1;const l=Object.values(r.gameState.entities.entities),a=[];for(const c of l)if(c.type==="prey"&&c.id!==n.id){const d=c;d.hitpoints>0&&d.isAdult&&K(n.position,d.position,r.gameState.mapDimensions.width,r.gameState.mapDimensions.height)<=xt*5&&a.push(d)}if(a.length>=2){let c=0,d=0;for(const m of a)c+=m.position.x,d+=m.position.y;c/=a.length,d/=a.length;const h={x:c,y:d};if(K(n.position,h,r.gameState.mapDimensions.width,r.gameState.mapDimensions.height)>xt*2)return N.set(o,"herdCenter",h),N.set(o,"herdSize",a.length),!0}return!1},"Find Herd",e+1),new ue((n,r,o)=>{const l=N.get(o,"herdCenter");if(!l)return w.FAILURE;if(K(n.position,l,r.gameState.mapDimensions.width,r.gameState.mapDimensions.height)>xt*2){n.activeAction="moving",n.target=l;const c=We(n.position,l,r.gameState.mapDimensions.width,r.gameState.mapDimensions.height);return n.direction=nt(c),w.RUNNING}else return n.activeAction="idle",n.direction={x:0,y:0},w.SUCCESS},"Join Herd",e+1)],"Prey Herd Behavior",e)}function IC(e){return new me([new oe((n,r,o)=>{if(n.hunger>100||n.hitpoints<n.maxHitpoints*.4||n.activeAction==="attacking"||n.activeAction==="procreating")return!1;const l=ke(n,r.gameState,"predator",zi*4,a=>a.id!==n.id&&a.hitpoints>0&&a.isAdult&&n.fatherId!==void 0&&a.fatherId===n.fatherId&&a.age>=n.age||a.hitpoints>n.hitpoints);return l&&K(n.position,l.position,r.gameState.mapDimensions.width,r.gameState.mapDimensions.height)>zi*2?(N.set(o,"packLeader",l.id),!0):!1},"Find Pack Leader",e+1),new ue((n,r,o)=>{const l=N.get(o,"packLeader"),a=l&&r.gameState.entities.entities[l];if(!a||a.hitpoints<=0)return w.FAILURE;if(K(n.position,a.position,r.gameState.mapDimensions.width,r.gameState.mapDimensions.height)>zi*2){n.activeAction="moving",n.target=a.id;const d=We(n.position,a.position,r.gameState.mapDimensions.width,r.gameState.mapDimensions.height);return n.direction=nt(d),w.RUNNING}else return n.activeAction="idle",n.direction={x:0,y:0},w.SUCCESS},"Follow Pack Leader",e+1)],"Predator Pack Behavior",e)}function EC(e){return new me([new oe((n,r,o)=>{if(!n.isAdult||n.hitpoints<n.maxHitpoints*.6||n.hunger>120||n.attackCooldown&&n.attackCooldown>0)return!1;const l=ke(n,r.gameState,"predator",Gm,a=>!!(a.id!==n.id&&a.hitpoints>0&&a.isAdult&&n.fatherId!==a.fatherId&&n.gender===a.gender&&n.fatherId!==void 0&&a.fatherId!==void 0));if(l){const a=K(n.position,l.position,r.gameState.mapDimensions.width,r.gameState.mapDimensions.height);if(a<=Rn)return N.set(o,"territorialTarget",l.id),!0;if(a<=Gm)return N.set(o,"territorialTarget",l.id),N.set(o,"needToApproach",!0),!0}return!1},"Find Territorial Rival",e+1),new ue((n,r,o)=>{const l=N.get(o,"territorialTarget"),a=l&&r.gameState.entities.entities[l],c=N.get(o,"needToApproach");if(!a||a.hitpoints<=0)return w.FAILURE;const d=K(n.position,a.position,r.gameState.mapDimensions.width,r.gameState.mapDimensions.height);if(d<=Rn)return n.activeAction="attacking",n.attackTargetId=a.id,n.target=a.id,n.direction={x:0,y:0},N.delete(o,"needToApproach"),w.RUNNING;if(c||d>Rn){n.activeAction="moving",n.target=a.id;const h=We(n.position,a.position,r.gameState.mapDimensions.width,r.gameState.mapDimensions.height);return n.direction=nt(h),w.RUNNING}return w.FAILURE},"Territorial Fight or Approach",e+1)],"Predator Territorial Defense",e)}function wC(){const e=new On([U_(2),Q_(2),sC(2),q_(2),Z_(2),J_(2),tC(2),new Is(Y_(3),"Gated Leader Combat Strategy",2),new Is(rC(3),"Gated Diplomacy",2),j_(2),new cr(G_(3),"attack","Gated Attacking",2),F_(2),new Ql(new cr(L_(4),"gathering","Gated Gathering",3),tf,"Timeout Gathering",2),new cr($_(3),"feedChildren","Gated Feed Child",2),z_(2),new Ql(new cr(W_(4),"planting","Gated Planting",3),tf,"Timeout Planting",2),new cr(oC(3),"attack","Gated Hunt Prey",2),new cr(B_(3),"procreation","Gated Procreation",2),new qs(K_(3),nf,"Cache Tribe Split",2),new Is(iC(3),"Gated Tribe Migration",2),new qs(V_(3),nf,"Cache Establish Territory",2),new cr(nC(3),"followLeader","Gated Follow Leader",2),new Is(X_(2),"Gated Follow Patriarch",2),new Is(H_(2),"Gated Idle Wander",2)],"AI Root Selector",1);return new M_(e,"Manual Control Gate",0)}const Fv=wC();function _C(e,n){e.aiBlackboard&&N.cleanupOldEntries(e.aiBlackboard,n.gameState.time);const r=performance.now();switch(e.aiType){case Js.BehaviorTreeBased:default:Wf(e,n,Fv);break}n.gameState.performanceMetrics.currentBucket.aiUpdateTime+=performance.now()-r}function CC(){return new On([aC(1),fC(1),hC(1),lC(1),uC(1),TC(1),Mv(1)],"Prey Behavior Root",0)}function RC(){return new On([pC(1),gC(1),SC(1),AC(1),EC(1),mC(1),IC(1),Mv(1)],"Predator Behavior Root",0)}const Uv=CC();function PC(e,n){e.aiBlackboard?Wf(e,n,Uv):(console.warn(`Behavior Tree AI ticked for prey ${e.id}, but the tree or blackboard was missing.`),e.activeAction="idle")}const Lv=RC();function NC(e,n){e.aiBlackboard?Wf(e,n,Lv):(console.warn(`Behavior Tree AI ticked for predator ${e.id}, but the tree or blackboard was missing.`),e.activeAction="idle")}function OC(e,n){e.forces.push(Ct(e.velocity,-.1));const r=Ct(nt(e.direction),e.acceleration);e.forces.push(r),e.debuffs.forEach(o=>{n.gameState.time-o.startTime<o.duration&&o.type==="slow"&&(e.velocity=Ct(e.velocity,.5))}),e.debuffs=e.debuffs.filter(o=>n.gameState.time-o.startTime<o.duration),e.velocity=jn(e.velocity,e.forces.reduce(jn,{x:0,y:0})),To(e.velocity)<.001&&(e.velocity={x:0,y:0}),e.position=jn(e.position,Ct(e.velocity,n.deltaTime)),e.position.x=(e.position.x%n.gameState.mapDimensions.width+n.gameState.mapDimensions.width)%n.gameState.mapDimensions.width,e.position.y=(e.position.y%n.gameState.mapDimensions.height+n.gameState.mapDimensions.height)%n.gameState.mapDimensions.height,e.forces=[],e.type==="human"?R_(e,n,n.deltaTime):e.type==="corpse"?P_(e,n):e.type==="prey"?N_(e,n,n.deltaTime):e.type==="predator"&&O_(e,n,n.deltaTime),e.type==="human"&&_C(e,n),e.type==="prey"?PC(e,n):e.type==="predator"&&NC(e,n),e.stateMachine&&(e.stateMachine=C_(...e.stateMachine,{entity:e,updateContext:n}))}function DC(e){const n=e.gameState.entities;Object.values(n.entities).forEach(r=>{OC(r,e)})}function Hv(){return{entities:{},nextEntityId:1}}function ea(e,n,r){const o={id:e.nextEntityId++,type:n,velocity:{x:0,y:0},direction:{x:0,y:0},acceleration:0,forces:[],debuffs:[],...r};return e.entities[o.id]=o,o}function ta(e,n,r){return ea(e,"berryBush",{position:n,radius:ef,food:Array.from({length:IT},()=>({type:di.Berry})).map(l=>({...l,id:e.nextEntityId++})),maxFood:TT,lifespan:wT,age:0,spreadRadius:ef,timeSinceLastBerryRegen:0,timeSinceLastSpreadAttempt:0,timeSinceLastHarvest:0,stateMachine:[Ds,{enteredAt:r,previousState:void 0}]})}function Zl(e,n,r,o,l=!1,a=yI,c=Y0,d,h,g=[],m,y){const S=a>=If;return ea(e,"human",{position:n,radius:S?At:No,hunger:c,hitpoints:mm,maxHitpoints:mm,age:a,gender:o,isPlayer:l,food:[],maxFood:W0,maxAge:$s,isAdult:S,isPregnant:!1,gestationTime:0,procreationCooldown:0,attackCooldown:0,motherId:d,fatherId:h,ancestorIds:g,stateMachine:[Et,{enteredAt:r,previousState:void 0}],leaderId:m,tribeBadge:y,aiType:Js.BehaviorTreeBased,aiBlackboard:N.create()})}function Yf(e,n,r,o,l,a,c,d,h,g,m){let y,S;switch(c){case"human":y=X0,S=wr;break;case"prey":y=2,S=120;break;case"predator":y=4,S=140;break}return ea(e,"corpse",{position:n,radius:l,gender:r,age:o,originalEntityId:a,originalEntityType:c,timeOfDeath:d,decayProgress:0,geneCode:m,food:[...Array.from({length:Math.max(y*Math.max(S-g,0)/S,0)},()=>({type:di.Meat})),...h].map(I=>({...I,id:e.nextEntityId++})),stateMachine:void 0})}function kC(e,n,r,o,l,a,c,d,h){return Yf(e,n,r,o,l,a,"human",c,d,h)}function MC(e,n,r,o,l,a,c,d){return Yf(e,n,r,o,l,a,"prey",c,[],0,d)}function FC(e,n,r,o,l,a,c,d){return Yf(e,n,r,o,l,a,"predator",c,[],0,d)}function UC(e,n,r){const o=n?r.gameState.entities.entities[n]:void 0,l=[...e.ancestorIds||[],e.id],a=o?[...o.ancestorIds||[],o.id]:[],c=[...l,...a],d=[...new Set(c)],h=d.slice(Math.max(d.length-pI,0)),g=Math.random()<.5?"male":"female",m=jn(e.position,{x:5,y:5}),y=Zl(r.gameState.entities,m,r.gameState.time,g,!1,0,Y0/2,e.id,n,h,(o==null?void 0:o.leaderId)??e.leaderId,(o==null?void 0:o.tribeBadge)??e.tribeBadge);return Ue(r,Ee.Birth,e.position),y}function na(e,n){return e.entities[n]?(delete e.entities[n],!0):!1}function _o(e,n,r,o=Zw,l=_v,a,c,d){const h=o>=Fs,g=Date.now();return ea(e,"prey",{position:n,radius:h?At*.7:No*.7,hunger:l,hitpoints:Hm,maxHitpoints:Hm,age:o,maxAge:wv,gender:r,isAdult:h,isPregnant:!1,gestationTime:0,procreationCooldown:0,geneCode:a,motherId:c,fatherId:d,stateMachine:[Cn,{enteredAt:g,previousState:void 0}],aiType:Js.BehaviorTreeBased,aiBlackboard:N.create()})}function Co(e,n,r,o=s_,l=Rv,a,c,d){const h=o>=Us,g=Date.now();return ea(e,"predator",{position:n,radius:h?At*.9:No*.9,hunger:l,hitpoints:Bm,maxHitpoints:Bm,age:o,maxAge:Cv,gender:r,isAdult:h,isPregnant:!1,gestationTime:0,procreationCooldown:0,geneCode:a,motherId:c,fatherId:d,stateMachine:[Gt,{enteredAt:g,previousState:void 0}],aiType:Js.BehaviorTreeBased,aiBlackboard:N.create()})}var Ht=(e=>(e.MOVE="MOVE",e.HUNGER="HUNGER",e.EAT="EAT",e.FIND_BUSH="FIND_BUSH",e.GATHER="GATHER",e.PROCREATE="PROCREATE",e.PLANT_BUSH="PLANT_BUSH",e.AUTOPILOT="AUTOPILOT",e.ANIMALS_INTRODUCTION="ANIMALS_INTRODUCTION",e.HUNT_PREY="HUNT_PREY",e.DEFEND_FROM_PREDATORS="DEFEND_FROM_PREDATORS",e))(Ht||{}),Ir=(e=>(e.HUNGER_BAR="HUNGER_BAR",e.FOOD_BAR="FOOD_BAR",e.COMMAND_BUTTONS="COMMAND_BUTTONS",e))(Ir||{}),Bt=(e=>(e[e.FADING_IN=0]="FADING_IN",e[e.ACTIVE=1]="ACTIVE",e[e.FADING_OUT=2]="FADING_OUT",e[e.INACTIVE=3]="INACTIVE",e))(Bt||{});const lf={},uf={},LC=[{key:Ht.MOVE,title:"Movement",text:"Use WASD or Arrow Keys to move your character around the world.",condition:e=>e.hasPlayerMovedEver||e.hasPlayerEnabledAutopilot>2,isCompleted:!1},{key:Ht.HUNGER,title:"Hunger",text:"Your character gets hungry over time. Watch the hunger bar!",condition:(e,n)=>n.hunger>gI,isCompleted:!1,minDisplayTime:Om,highlightedUIElements:[Ir.HUNGER_BAR]},{key:Ht.FIND_BUSH,title:"Find Food",text:"Look for berry bushes. They are your primary source of food.",condition:(e,n)=>!!ke(n,e,"berryBush",yt*5,o=>o.food.length>0),getTargets:(e,n)=>{const r=[];for(const o of Object.values(e.entities.entities))o.type==="berryBush"&&o.food.length>0&&K(n.position,o.position,e.mapDimensions.width,e.mapDimensions.height)<500&&r.push(o);return r.map(o=>o.id)},isCompleted:!1,minDisplayTime:Om},{key:Ht.GATHER,title:"Gather Berries",text:"Get close to a bush and press 'E' to gather berries.",condition:(e,n)=>n.food.length>0,getTargets:(e,n)=>{const r=ke(n,e,"berryBush",yt,o=>o.food.length>0);return r?[r.id]:[]},isCompleted:!1},{key:Ht.EAT,title:"Eat",text:"When you are hungry and have food, press 'F' to eat.",condition:(e,n)=>n.activeAction==="eating",isCompleted:!1,highlightedUIElements:[Ir.FOOD_BAR]},{key:Ht.PROCREATE,title:"Procreate",text:"Find a mate and press 'R' to start a family. This is how you continue your lineage.",condition:(e,n)=>Rt(e,n).length>0,getTargets:(e,n)=>{const r=ke(n,e,"human",yt,o=>Rr(n,o,e));return r?[r.id]:[]},isCompleted:!1},{key:Ht.PLANT_BUSH,title:"Farming",text:"You can plant new berry bushes. Carry some berries and press 'B' to plant.",condition:(e,n)=>$f(e,n).some(o=>o.type===Re.Plant)||e.hasPlayerPlantedBush===!0,isCompleted:!1},{key:Ht.AUTOPILOT,title:"Autopilot!",text:"You can turn autopilot for specific actions, press Shift and click on the action button to enable it.",condition:e=>e.hasPlayerEnabledAutopilot>2,highlightedUIElements:[Ir.COMMAND_BUTTONS],isCompleted:!1},{key:Ht.ANIMALS_INTRODUCTION,title:"Wild Animals!",text:"Your world now has wild animals! Prey provide meat when hunted, but beware of predators that may attack.",condition:e=>Object.values(e.entities.entities).some(r=>r.type==="prey"||r.type==="predator"),isCompleted:!1,dependsOn:Ht.AUTOPILOT},{key:Ht.HUNT_PREY,title:"Hunt for Meat",text:"Click on prey animals to hunt them for meat. Hunting provides more food than gathering berries!",condition:(e,n)=>{const r=ke(n,e,"prey",150);return n.hunger>40&&!!r},getTargets:(e,n)=>{const r=ke(n,e,"prey",150);return r?[r.id]:[]},isCompleted:!1,dependsOn:Ht.ANIMALS_INTRODUCTION},{key:Ht.DEFEND_FROM_PREDATORS,title:"Predators",text:"Predators may attack when hungry! Click on them to fight back. Fighting together with family is more effective.",condition:(e,n)=>!!ke(n,e,"predator",120),getTargets:(e,n)=>{const r=ke(n,e,"predator",120);return r?[r.id]:[]},isCompleted:!1,dependsOn:Ht.HUNT_PREY}].map(e=>({...e,condition:e.condition?GC(e.condition):void 0,getTargets:e.getTargets?bC(e.getTargets):void 0}));function Bv(){return{steps:LC.map(e=>({...e,isCompleted:!1}))}}function Gv(){return{currentStepIndex:0,completedSteps:[],isActive:!0,transitionState:Bt.FADING_IN,transitionAlpha:0,highlightedEntityIds:[],stepStartTime:null,activeUIHighlights:[]}}function HC(e){for(let n=0;n<e.tutorial.steps.length;n++){const r=e.tutorial.steps[n];if(!r.isCompleted)if(r.dependsOn){if(e.tutorialState.completedSteps.includes(r.dependsOn))return n}else return n}return null}function BC(e,n){const r=e.tutorialState;if(!r.isActive){r.transitionState=Bt.INACTIVE,r.highlightedEntityIds=[],r.activeUIHighlights=[];return}const o=St(e);if(!o){r.isActive=!1,r.transitionState=Bt.INACTIVE,r.highlightedEntityIds=[],r.activeUIHighlights=[];return}const l=e.tutorial.steps[r.currentStepIndex];if(!l){r.isActive=!1,r.transitionState=Bt.INACTIVE,r.highlightedEntityIds=[],r.activeUIHighlights=[];return}const a=1/VE;switch(r.transitionState){case Bt.FADING_IN:r.stepStartTime===null&&(r.stepStartTime=e.time),r.transitionAlpha+=a*n,r.transitionAlpha>=1&&(r.transitionAlpha=1,r.transitionState=Bt.ACTIVE);break;case Bt.ACTIVE:{const h=e.time-(r.stepStartTime||e.time)>=(l.minDisplayTime||0),g=lf[l.condition];g&&h&&g(e,o)&&(l.isCompleted=!0,r.completedSteps.includes(l.key)||r.completedSteps.push(l.key),r.transitionState=Bt.FADING_OUT);break}case Bt.FADING_OUT:if(r.transitionAlpha-=a*n,r.transitionAlpha<=0){r.transitionAlpha=0,r.stepStartTime=null;const d=HC(e);d!==null?(r.currentStepIndex=d,r.transitionState=Bt.FADING_IN):(r.isActive=!1,r.transitionState=Bt.INACTIVE)}break}if(r.transitionState!==Bt.FADING_OUT&&r.transitionState!==Bt.INACTIVE){const d=uf[l.getTargets||""];d?r.highlightedEntityIds=[...d(e,o)]:r.highlightedEntityIds=[],l.highlightedUIElements?r.activeUIHighlights=[...l.highlightedUIElements]:r.activeUIHighlights=[]}else r.highlightedEntityIds=[],r.activeUIHighlights=[]}function GC(e){const n=`condition_${Object.keys(lf).length+1}`;return lf[n]=e,n}function bC(e){const n=`getTargets_${Object.keys(uf).length+1}`;return uf[n]=e,n}function xC(){const e=Hv(),n=0;for(let y=0;y<L0;y++){const S={x:Math.random()*et,y:Math.random()*tt};ta(e,S,n)}const r=et/2,o=tt/2,l=Zl(e,{x:r,y:o},n,"male",!0);Zl(e,{x:r+50,y:o},n,"female",!1);for(let y=0;y<Ov;y++){const S={x:r+et*(Math.random()-Math.random()),y:o+tt*(Math.random()-Math.random())};_o(e,S,"male",void 0,void 0,Xs()),_o(e,{x:S.x+20,y:S.y},"female",void 0,void 0,Xs())}const a={x:r+et*(Math.random()-Math.random()),y:o+tt*(Math.random()-Math.random())};Co(e,a,"male",void 0,void 0,Ks()),Co(e,{x:a.x+20,y:a.y},"female",void 0,void 0,Ks());const c=[{id:"muteButton",action:Te.ToggleMute,currentWidth:_n,rect:{x:0,y:0,width:0,height:0},text:"",backgroundColor:"",textColor:rn},{id:"pauseButton",action:Te.TogglePause,currentWidth:_n,rect:{x:0,y:0,width:0,height:0},text:"",backgroundColor:"",textColor:rn},{id:"returnToIntroButton",action:Te.ReturnToIntro,currentWidth:_n,rect:{x:0,y:0,width:0,height:0},text:"EXIT",backgroundColor:"",textColor:rn}],d=Bv(),h=Gv(),g={time:n,entities:e,mapDimensions:{width:et,height:tt},generationCount:1,gameOver:!1,visualEffects:[],nextVisualEffectId:0,viewportCenter:{...l.position},isPaused:!1,exitConfirmation:"inactive",autopilotControls:{behaviors:{procreation:!1,planting:!1,gathering:!1,attack:!1,feedChildren:!0,followLeader:!1},hoveredAutopilotAction:void 0,activeAutopilotAction:void 0,isManuallyMoving:!1},hasPlayerMovedEver:!1,hasPlayerPlantedBush:!1,hasPlayerEnabledAutopilot:0,masterVolume:Tv,isMuted:!1,uiButtons:c,tutorial:d,tutorialState:h,debugPanel:Kt.None,performanceMetrics:{currentBucket:{renderTime:0,worldUpdateTime:0,aiUpdateTime:0},history:[]},hoveredButtonId:void 0,mousePosition:{x:0,y:0},notifications:[{id:"welcome",type:Ys.Hello,message:"Welcome to the game!",duration:50,targetEntityIds:[l.id],highlightedEntityIds:[l.id],timestamp:0,isDismissed:!1,creationTime:Date.now()}],ecosystem:{preyGestationPeriod:vr,preyProcreationCooldown:yr,predatorGestationPeriod:Sr,predatorProcreationCooldown:Ar,preyHungerIncreasePerHour:bi,predatorHungerIncreasePerHour:xi,berryBushSpreadChance:ci},autosaveEnabled:!0,autosaveIntervalSeconds:30,lastAutosaveTime:Date.now()},m=eu(g);return console.log("Game world initialized:",m),m}function $C(){const e=Hv(),n=0;for(let c=0;c<L0;c++){const d={x:Math.random()*et,y:Math.random()*tt};ta(e,d,n)}for(let c=0;c<yT;c++){const d={x:Math.random()*et,y:Math.random()*tt},h=Math.random()<.5?"male":"female";Zl(e,d,n,h,!1)}for(let c=0;c<Ov;c++){const d={x:Math.random()*et,y:Math.random()*tt};_o(e,d,"male",void 0,void 0,Xs()),_o(e,{x:d.x+20,y:d.y},"female",void 0,void 0,Xs())}const r={x:Math.random()*et,y:Math.random()*tt};Co(e,r,"male",void 0,void 0,Ks()),Co(e,{x:r.x+20,y:r.y},"female",void 0,void 0,Ks());const o=Bv(),l=Gv(),a={time:n,entities:e,mapDimensions:{width:et,height:tt},generationCount:0,gameOver:!1,visualEffects:[],nextVisualEffectId:0,viewportCenter:{x:et/2,y:tt/2},isPaused:!1,exitConfirmation:"inactive",autopilotControls:{behaviors:{procreation:!1,planting:!1,gathering:!1,attack:!1,feedChildren:!0,followLeader:!1},hoveredAutopilotAction:void 0,activeAutopilotAction:void 0,isManuallyMoving:!1},hasPlayerMovedEver:!1,hasPlayerPlantedBush:!1,hasPlayerEnabledAutopilot:0,masterVolume:Tv,isMuted:!0,uiButtons:[],tutorial:o,tutorialState:l,debugPanel:Kt.None,performanceMetrics:{currentBucket:{renderTime:0,worldUpdateTime:0,aiUpdateTime:0},history:[]},hoveredButtonId:void 0,mousePosition:{x:0,y:0},notifications:[],ecosystem:{preyGestationPeriod:vr,preyProcreationCooldown:yr,predatorGestationPeriod:Sr,predatorProcreationCooldown:Ar,preyHungerIncreasePerHour:bi,predatorHungerIncreasePerHour:xi,berryBushSpreadChance:ci},autosaveEnabled:!1,autosaveIntervalSeconds:30,lastAutosaveTime:0};return eu(a)}const zC="humanProcreation",WC="human",YC="human",jC=yt,VC=(e,n,r)=>Rr(e,n,r.gameState)?e.gender==="male"?e.activeAction==="procreating":e.activeAction==="procreating"&&n.activeAction==="procreating":!1,XC=(e,n,r)=>{var h,g;const{gameState:o}=r,l={x:(e.position.x+n.position.x)/2,y:(e.position.y+n.position.y)/2},a=e.gender==="male"?e:n,c=e.gender==="female"?e:n,d=(a.partnerIds||[]).length===0;if(e.stateMachine=[Vs,{partnerId:n.id,previousState:(h=e.stateMachine)==null?void 0:h[0]}],n.stateMachine=[Vs,{partnerId:e.id,previousState:(g=n.stateMachine)==null?void 0:g[0]}],e.partnerIds||(e.partnerIds=[]),e.partnerIds.includes(n.id)||e.partnerIds.push(n.id),n.partnerIds||(n.partnerIds=[]),n.partnerIds.includes(e.id)||n.partnerIds.push(e.id),d&&a.leaderId&&a.leaderId!==a.id){const m=o.entities.entities[a.leaderId];if(m){const y=rf(a,m),S=rf(c,m);if(!y&&!S){const E=sf();a.leaderId=a.id,a.tribeBadge=E,a.diplomacy={},c.leaderId=a.id,c.tribeBadge=E}}}else if(!e.leaderId&&!n.leaderId&&a&&c){const m=sf();a.leaderId=a.id,a.tribeBadge=m,a.diplomacy={},c.leaderId=a.id,c.tribeBadge=m}e.activeAction=void 0,Pe(o,le.Procreation,l,gr),Pe(o,le.Partnered,e.position,Ge,e.id),Pe(o,le.Partnered,n.position,Ge,n.id),e.lastPartneredEffectTime=o.time,n.lastPartneredEffectTime=o.time,n.activeAction=void 0,Ue(r,Ee.Procreate,l)},KC={id:zC,sourceType:WC,targetType:YC,maxDistance:jC,checker:VC,perform:XC},qC={id:"humanChildFeeding",sourceType:"human",targetType:"human",maxDistance:wf,checker:(e,n)=>e.isAdult===!0&&e.food.length>0&&(!e.feedChildCooldownTime||e.feedChildCooldownTime<=0)&&n.isAdult===!1&&(n.motherId===e.id||n.fatherId===e.id)&&n.hunger>=Yi&&e.activeAction==="feeding",perform:(e,n,r)=>{e.food.pop(),n.hunger=Math.max(0,n.hunger-Yi),e.feedChildCooldownTime=CI,(!n.lastChildFedEffectTime||r.gameState.time-n.lastChildFedEffectTime>2)&&(Pe(r.gameState,le.ChildFed,n.position,Ge,n.id),n.lastChildFedEffectTime=r.gameState.time),Ue(r,Ee.ChildFed,n.position)}},QC={id:"human-attack",sourceType:"human",targetType:"human",maxDistance:Yn,checker:(e,n,r)=>{var a;if(((a=e.stateMachine)==null?void 0:a[0])!==ji||e.attackTargetId!==n.id||(e.attackCooldown||0)>0)return!1;const o=e.stateMachine[1];return r.gameState.time-o.attackStartTime>=K0},perform:(e,n,r)=>{const o=We(e.position,n.position,r.gameState.mapDimensions.width,r.gameState.mapDimensions.height),l=$I(nt(o),n.direction);if(Math.abs(l)<BI*Math.PI/180&&Math.random()<GI)Pe(r.gameState,le.AttackDeflected,n.position,Ge,n.id);else{let d=_f;e.gender==="male"&&(d*=UI),e.isAdult||(d*=LI),(!n.isAdult||n.age>=V0)&&e.isAdult&&(d*=HI),n.hitpoints-=d,n.movementSlowdown={modifier:Cf,endTime:r.gameState.time+Rf},Pe(r.gameState,le.Hit,n.position,Ge,n.id);const g=We(e.position,n.position,r.gameState.mapDimensions.width,r.gameState.mapDimensions.height),m=Ct(g,kI);n.forces.push(m),n.hitpoints<=0?Ue(r,Ee.HumanDeath,n.position):Ue(r,Ee.Attack,e.position)}e.attackCooldown=cu;const c=e.stateMachine[1];c.attackStartTime=r.gameState.time,Pe(r.gameState,le.Attack,e.position,Ge,e.id)}},ZC={id:"human-collision",sourceType:"human",targetType:"human",maxDistance:At*2,checker:(e,n,{gameState:r})=>K(e.position,n.position,r.mapDimensions.width,r.mapDimensions.height)<(e.radius+n.radius)/3,perform:(e,n,{gameState:r})=>{const o=K(e.position,n.position,r.mapDimensions.width,r.mapDimensions.height);if(o===0){e.forces.push({x:.1,y:0}),n.forces.push({x:-.1,y:0});return}const a=(e.radius+n.radius-o)*.05,c=nt(q0(e.position,n.position)),d=Ct(c,a);e.forces.push(d),n.forces.push(Ct(d,-1))}},JC={id:"humanBerryBushGather",sourceType:"human",targetType:"berryBush",maxDistance:yt,checker:(e,n,r)=>{var o;return e.isAdult&&n.food.length>0&&((o=e.stateMachine)==null?void 0:o[0])===hu&&e.food.length<e.maxFood&&(!e.gatheringCooldownTime||e.gatheringCooldownTime<r.gameState.time)||!1},perform:(e,n,r)=>{const o=n.food.pop();o&&e.food.push(o),e.gatheringCooldownTime=r.gameState.time+1,n.timeSinceLastHarvest=r.gameState.time,n.ownerId=e.id,n.claimedUntil=r.gameState.time+H0,Pe(r.gameState,le.BushClaimed,n.position,Ge),Ue(r,Ee.Gather,e.position)}},e1={id:"corpseGather",sourceType:"human",targetType:"corpse",maxDistance:yt,checker:(e,n,r)=>{var o;return e.isAdult&&n.food.length>0&&((o=e.stateMachine)==null?void 0:o[0])===hu&&e.food.length<e.maxFood&&(!e.gatheringCooldownTime||e.gatheringCooldownTime<r.gameState.time)||!1},perform:(e,n,r)=>{const o=n.food.pop();o&&e.food.push(o),e.gatheringCooldownTime=r.gameState.time+1,Ue(r,Ee.Gather,e.position)}},t1=[JC,e1],n1={id:"prey-eat-berry-bush",sourceType:"prey",targetType:"berryBush",maxDistance:xt,checker:(e,n,r)=>!!(e.isAdult&&n.food.length>0&&e.hunger>30&&(!e.eatingCooldownTime||e.eatingCooldownTime<r.gameState.time)),perform:(e,n,r)=>{n.food.pop()&&(e.hunger=Math.max(0,e.hunger-25),n.lifespan-=t_,n.timeSinceLastHarvest=r.gameState.time,e.eatingCooldownTime=r.gameState.time+e_,Pe(r.gameState,le.BushClaimed,n.position,Ge,e.id),Ue(r,Ee.Gather,e.position))}},i1={id:"predator-hunt-prey",sourceType:"predator",targetType:"prey",maxDistance:ro,checker:(e,n,r)=>!!(e.isAdult&&e.hunger>50&&(!e.huntCooldown||e.huntCooldown<=0)&&n.hitpoints>0),perform:(e,n,r)=>{n.hitpoints-=a_;const o=We(e.position,n.position,r.gameState.mapDimensions.width,r.gameState.mapDimensions.height),l=Ct(o,8);n.forces.push(l),e.huntCooldown=c_,n.hitpoints<=0?(Ue(r,Ee.HumanDeath,n.position),Pe(r.gameState,le.Hit,n.position,Ge,n.id)):(Pe(r.gameState,le.Hit,n.position,Ge,n.id),n.fleeCooldown=5,Ue(r,Ee.Attack,e.position)),Pe(r.gameState,le.Attack,e.position,Ge,e.id)}},r1={id:"human-hunt-prey",sourceType:"human",targetType:"prey",maxDistance:Yn,checker:(e,n,r)=>{var o;return!!(((o=e.stateMachine)==null?void 0:o[0])===ji&&e.attackTargetId===n.id&&(!e.attackCooldown||e.attackCooldown<=0)&&n.hitpoints>0&&e.isAdult)},perform:(e,n,r)=>{let o=_f*1.2;e.gender==="male"&&(o*=1.3),n.hitpoints-=o;const l=We(e.position,n.position,r.gameState.mapDimensions.width,r.gameState.mapDimensions.height),a=Ct(l,6);n.forces.push(a),e.attackCooldown=cu,n.hitpoints<=0?(Ue(r,Ee.HumanDeath,n.position),Pe(r.gameState,le.Hit,n.position,Ge,n.id)):(Pe(r.gameState,le.Hit,n.position,Ge,n.id),n.fleeCooldown=8,Ue(r,Ee.Attack,e.position)),Pe(r.gameState,le.Attack,e.position,Ge,e.id)}},o1={id:"predator-attack-human",sourceType:"predator",targetType:"human",maxDistance:Rn,checker:(e,n,r)=>{var o;return!!(e.isAdult&&(!e.attackCooldown||e.attackCooldown<=0)&&n.hitpoints>0&&(e.hunger>100||n.attackTargetId===e.id||n.attackTargetId&&((o=r.gameState.entities.entities[n.attackTargetId])==null?void 0:o.type)==="predator"))},perform:(e,n,r)=>{let o=Pv;e.hunger>120&&(o*=1.3),n.hitpoints-=o,n.movementSlowdown={modifier:Cf,endTime:r.gameState.time+Rf};const l=We(e.position,n.position,r.gameState.mapDimensions.width,r.gameState.mapDimensions.height),a=Ct(l,7);n.forces.push(a),e.attackCooldown=Nv,n.hitpoints<=0?(e.hunger=Math.max(0,e.hunger-zf),Ue(r,Ee.HumanDeath,n.position),Pe(r.gameState,le.Hit,n.position,Ge,n.id)):(Pe(r.gameState,le.Hit,n.position,Ge,n.id),Ue(r,Ee.Attack,e.position)),Pe(r.gameState,le.Attack,e.position,Ge,e.id)}},s1={id:"human-attack-predator",sourceType:"human",targetType:"predator",maxDistance:Yn,checker:(e,n,r)=>{var o;return!!(((o=e.stateMachine)==null?void 0:o[0])===ji&&e.attackTargetId===n.id&&(!e.attackCooldown||e.attackCooldown<=0)&&n.hitpoints>0&&e.isAdult)},perform:(e,n,r)=>{let o=_f*.8;e.gender==="male"&&(o*=1.2);const l=Object.values(r.gameState.entities.entities).filter(d=>d.type==="human"&&d.id!==e.id).filter(d=>{const h=d;return Math.sqrt(Math.pow(h.position.x-e.position.x,2)+Math.pow(h.position.y-e.position.y,2))<100&&h.activeAction==="attacking"&&h.attackTargetId===n.id}).length;l>0&&(o*=1+l*.2),n.hitpoints-=o;const a=We(e.position,n.position,r.gameState.mapDimensions.width,r.gameState.mapDimensions.height),c=Ct(a,8);n.forces.push(c),e.attackCooldown=cu,n.hitpoints<=0?(Ue(r,Ee.HumanDeath,n.position),Pe(r.gameState,le.Hit,n.position,Ge,n.id)):(Pe(r.gameState,le.Hit,n.position,Ge,n.id),n.hitpoints<n.maxHitpoints*.3&&(n.hunger+=20),Ue(r,Ee.Attack,e.position)),Pe(r.gameState,le.Attack,e.position,Ge,e.id)}},a1={id:"prey-procreation",sourceType:"prey",targetType:"prey",maxDistance:xt,checker:(e,n,r)=>!!(e.isAdult&&n.isAdult&&e.gender!==n.gender&&e.id!==n.id&&!e.isPregnant&&!n.isPregnant&&e.hunger<200&&n.hunger<200&&(!e.procreationCooldown||e.procreationCooldown<=0)&&(!n.procreationCooldown||n.procreationCooldown<=0)),perform:(e,n,r)=>{const o=e.gender==="female"?e:n;o.isPregnant=!0,o.gestationTime=r.gameState.ecosystem.preyGestationPeriod,e.procreationCooldown=r.gameState.ecosystem.preyProcreationCooldown,n.procreationCooldown=r.gameState.ecosystem.preyProcreationCooldown,Pe(r.gameState,le.Procreation,o.position,Ge,o.id),Ue(r,Ee.Procreate,o.position)}},l1={id:"predator-procreation",sourceType:"predator",targetType:"predator",maxDistance:zi,checker:(e,n,r)=>!!(e.isAdult&&n.isAdult&&e.gender!==n.gender&&e.id!==n.id&&!e.isPregnant&&!n.isPregnant&&e.hunger<200&&n.hunger<200&&(!e.procreationCooldown||e.procreationCooldown<=0)&&(!n.procreationCooldown||n.procreationCooldown<=0)),perform:(e,n,r)=>{const o=e.gender==="female"?e:n;o.isPregnant=!0,o.pregnancyFatherId=e.gender==="male"?e.id:n.id,o.gestationTime=r.gameState.ecosystem.predatorGestationPeriod,e.procreationCooldown=r.gameState.ecosystem.predatorProcreationCooldown,n.procreationCooldown=r.gameState.ecosystem.predatorProcreationCooldown,Pe(r.gameState,le.Procreation,o.position,Ge,o.id),Ue(r,Ee.Procreate,o.position)}},u1={id:"preyChildFeeding",sourceType:"prey",targetType:"prey",maxDistance:Do,checker:(e,n)=>e.isAdult===!0&&e.gender==="female"&&e.hunger<80&&(!e.feedChildCooldownTime||e.feedChildCooldownTime<=0)&&n.isAdult===!1&&(n.motherId===e.id||n.fatherId===e.id)&&n.hunger>=ql&&e.activeAction==="feeding",perform:(e,n,r)=>{e.hunger=Math.min(120,e.hunger+10),n.hunger=Math.max(0,n.hunger-ql),e.feedChildCooldownTime=Dv,(!n.lastChildFedEffectTime||r.gameState.time-n.lastChildFedEffectTime>2)&&(Pe(r.gameState,le.ChildFed,n.position,Ge,n.id),n.lastChildFedEffectTime=r.gameState.time),Ue(r,Ee.ChildFed,n.position)}},c1={id:"predatorChildFeeding",sourceType:"predator",targetType:"predator",maxDistance:Do,checker:(e,n)=>e.isAdult===!0&&e.gender==="female"&&e.hunger<90&&(!e.feedChildCooldownTime||e.feedChildCooldownTime<=0)&&n.isAdult===!1&&(n.motherId===e.id||n.fatherId===e.id)&&n.hunger>=ql&&e.activeAction==="feeding",perform:(e,n,r)=>{e.hunger=Math.min(140,e.hunger+15),n.hunger=Math.max(0,n.hunger-ql),e.feedChildCooldownTime=Dv,(!n.lastChildFedEffectTime||r.gameState.time-n.lastChildFedEffectTime>2)&&(Pe(r.gameState,le.ChildFed,n.position,Ge,n.id),n.lastChildFedEffectTime=r.gameState.time),Ue(r,Ee.ChildFed,n.position)}},d1={id:"predator-eat-corpse",sourceType:"predator",targetType:"corpse",maxDistance:zi,checker:(e,n,r)=>!!(e.isAdult&&e.hunger>30&&n.food.length>0&&(!e.eatingCooldownTime||e.eatingCooldownTime<=r.gameState.time)),perform:(e,n,r)=>{n.food.pop()&&(e.hunger=Math.max(0,e.hunger-zf),e.eatingCooldownTime=r.gameState.time+2,Pe(r.gameState,le.Eating,e.position,Ge,e.id),Ue(r,Ee.Gather,e.position))}},f1={id:"predator-attack-rival",sourceType:"predator",targetType:"predator",maxDistance:Rn,checker:(e,n,r)=>{var o;return!!(e.isAdult&&(!e.attackCooldown||e.attackCooldown<=0)&&n.hitpoints>0&&(e.hunger>100||n.attackTargetId===e.id||n.attackTargetId&&((o=r.gameState.entities.entities[n.attackTargetId])==null?void 0:o.type)==="predator"))},perform:(e,n,r)=>{let o=Pv;e.hunger>120&&(o*=1.3),n.hitpoints-=o,n.movementSlowdown={modifier:Cf,endTime:r.gameState.time+Rf};const l=We(e.position,n.position,r.gameState.mapDimensions.width,r.gameState.mapDimensions.height),a=Ct(l,7);n.forces.push(a),e.attackCooldown=Nv,n.hitpoints<=0?(e.hunger=Math.max(0,e.hunger-zf),Ue(r,Ee.HumanDeath,n.position),Pe(r.gameState,le.Hit,n.position,Ge,n.id)):(Pe(r.gameState,le.Hit,n.position,Ge,n.id),Ue(r,Ee.Attack,e.position)),Pe(r.gameState,le.Attack,e.position,Ge,e.id)}},h1=[ZC,...t1,KC,qC,QC,n1,u1,c1,d1,i1,r1,s1,o1,f1,a1,l1];function p1(e){const{gameState:n}=e,r=n,o=Object.values(n.entities.entities);for(const l of h1)for(const a of o){if(l.sourceType&&a.type!==l.sourceType)continue;const c=r.search[l.targetType].byRadius(a.position,l.maxDistance);for(const d of c){if(a.id===d.id)continue;K(a.position,d.position,n.mapDimensions.width,n.mapDimensions.height)<=l.maxDistance&&l.checker(a,d,e)&&l.perform(a,d,e)}}}function g1(e){e.visualEffects=e.visualEffects.filter(n=>e.time-n.startTime<=n.duration)}function m1(e){const n=e.search.berryBush.byProperty("type","berryBush"),r=e.search.predator.byProperty("type","predator"),o=e.search.human.byProperty("type","human");for(let l=0;l<20;l++){let a;if(n.length>0&&l<15){const h=n[Math.floor(Math.random()*n.length)],g=Math.random()*2*Math.PI,m=50+Math.random()*100;a={x:Math.max(50,Math.min(et-50,h.position.x+Math.cos(g)*m)),y:Math.max(50,Math.min(tt-50,h.position.y+Math.sin(g)*m))}}else a={x:50+Math.random()*(et-100),y:50+Math.random()*(tt-100)};let c=!0;const d=100;for(const h of r)if(Math.sqrt((a.x-h.position.x)**2+(a.y-h.position.y)**2)<d){c=!1;break}if(c){for(const h of o)if(Math.sqrt((a.x-h.position.x)**2+(a.y-h.position.y)**2)<d){c=!1;break}}if(c)return a}return{x:et*.3+Math.random()*et*.4,y:tt*.3+Math.random()*tt*.4}}function v1(e){const n=e.search.prey.byProperty("type","prey"),r=e.search.human.byProperty("type","human");for(let l=0;l<15;l++){let a;if(n.length>0&&l<10){const h=n[Math.floor(Math.random()*n.length)],g=Math.random()*2*Math.PI,m=100+Math.random()*150;a={x:Math.max(50,Math.min(et-50,h.position.x+Math.cos(g)*m)),y:Math.max(50,Math.min(tt-50,h.position.y+Math.sin(g)*m))}}else a={x:50+Math.random()*(et-100),y:50+Math.random()*(tt-100)};let c=!0;const d=150;for(const h of r)if(Math.sqrt((a.x-h.position.x)**2+(a.y-h.position.y)**2)<d){c=!1;break}if(c)return a}switch(Math.floor(Math.random()*4)){case 0:return{x:Math.random()*et,y:50+Math.random()*100};case 1:return{x:et-150+Math.random()*100,y:Math.random()*tt};case 2:return{x:Math.random()*et,y:tt-150+Math.random()*100};default:return{x:50+Math.random()*100,y:Math.random()*tt}}}function y1(e){const n=e.search.human.byProperty("type","human"),r=e.search.berryBush.byProperty("type","berryBush");for(let o=0;o<20;o++){const l={x:50+Math.random()*(et-100),y:50+Math.random()*(tt-100)};let a=!0;const c=80,d=60;for(const h of n)if(Math.sqrt((l.x-h.position.x)**2+(l.y-h.position.y)**2)<c){a=!1;break}if(a){for(const h of r)if(Math.sqrt((l.x-h.position.x)**2+(l.y-h.position.y)**2)<d){a=!1;break}}if(a)return l}return{x:Math.random()*et,y:Math.random()*tt}}function bv(e,n=4){console.log(` Respawning ${n} prey to prevent extinction`);const r=e;for(let o=0;o<n;o++){const l=m1(r),a=o%2===0?"male":"female";_o(e.entities,l,a,void 0,void 0,Xs())}}function xv(e,n=2){console.log(` Respawning ${n} predators to prevent extinction`);const r=e;for(let o=0;o<n;o++){const l=v1(r),a=o%2===0?"male":"female";Co(e.entities,l,a,void 0,void 0,Ks())}}function S1(e){const n=e,r=n.search.prey.count(),o=n.search.predator.count();let l=!1;return r===0&&(bv(e,6),l=!0),o===0&&(xv(e,3),l=!0),l}function A1(e){const n=e,r=n.search.prey.count(),o=n.search.predator.count(),l=n.search.berryBush.count();let a=!1;if(r>0&&r<5){const c=Math.max(2,Math.floor(8-r));bv(e,c),a=!0}if(o>0&&o<2){const c=Math.max(1,Math.floor(3-o));xv(e,c),a=!0}if(l<5){console.log(` Boosting bush count from ${l} to help ecosystem`);for(let c=0;c<5;c++){const d=y1(n);ta(e.entities,d,e.time)}a=!0}return a}const T1=1,I1=.3,E1=.8,Wm=.8,w1=.99,_1=.05;var $v=(e=>(e[e.INCREASE_PREY_GESTATION=0]="INCREASE_PREY_GESTATION",e[e.DECREASE_PREY_GESTATION=1]="DECREASE_PREY_GESTATION",e[e.INCREASE_PREY_PROCREATION_COOLDOWN=2]="INCREASE_PREY_PROCREATION_COOLDOWN",e[e.DECREASE_PREY_PROCREATION_COOLDOWN=3]="DECREASE_PREY_PROCREATION_COOLDOWN",e[e.INCREASE_PREY_HUNGER=4]="INCREASE_PREY_HUNGER",e[e.DECREASE_PREY_HUNGER=5]="DECREASE_PREY_HUNGER",e[e.INCREASE_PREDATOR_GESTATION=6]="INCREASE_PREDATOR_GESTATION",e[e.DECREASE_PREDATOR_GESTATION=7]="DECREASE_PREDATOR_GESTATION",e[e.INCREASE_PREDATOR_PROCREATION_COOLDOWN=8]="INCREASE_PREDATOR_PROCREATION_COOLDOWN",e[e.DECREASE_PREDATOR_PROCREATION_COOLDOWN=9]="DECREASE_PREDATOR_PROCREATION_COOLDOWN",e[e.INCREASE_PREDATOR_HUNGER=10]="INCREASE_PREDATOR_HUNGER",e[e.DECREASE_PREDATOR_HUNGER=11]="DECREASE_PREDATOR_HUNGER",e[e.INCREASE_BUSH_SPREAD=12]="INCREASE_BUSH_SPREAD",e[e.DECREASE_BUSH_SPREAD=13]="DECREASE_BUSH_SPREAD",e[e.NO_ACTION=14]="NO_ACTION",e))($v||{});const Hd=Object.keys($v).length/2;class C1{constructor(){Ne(this,"qTable",new Map);Ne(this,"epsilon",Wm);Ne(this,"lastState",null);Ne(this,"lastAction",null)}discretizeState(n,r,o){const l=Math.min(4,Math.floor(n/25)),a=Math.min(4,Math.floor(r/5)),c=Math.min(4,Math.floor(o/15));return`${l}-${a}-${c}`}getQValue(n,r){return this.qTable.has(n)||this.qTable.set(n,new Map),this.qTable.get(n).get(r)||0}setQValue(n,r,o){this.qTable.has(n)||this.qTable.set(n,new Map),this.qTable.get(n).set(r,o)}getBestAction(n){let r=0,o=this.getQValue(n,0);for(let l=1;l<Hd;l++){const a=this.getQValue(n,l);a>o&&(o=a,r=l)}return r}chooseAction(n){return Math.random()<this.epsilon?Math.floor(Math.random()*Hd):this.getBestAction(n)}applyEmergencyCorrections(n,r,o,l){n<ai*.5&&(l.ecosystem.preyGestationPeriod=Math.max(lo,l.ecosystem.preyGestationPeriod*.8),l.ecosystem.preyProcreationCooldown=Math.max(uo,l.ecosystem.preyProcreationCooldown*.8),l.ecosystem.preyHungerIncreasePerHour=Math.max(ho,l.ecosystem.preyHungerIncreasePerHour*.9)),r<li*.6&&(l.ecosystem.predatorGestationPeriod=Math.max(co,l.ecosystem.predatorGestationPeriod*.75),l.ecosystem.predatorProcreationCooldown=Math.max(fo,l.ecosystem.predatorProcreationCooldown*.75),l.ecosystem.predatorHungerIncreasePerHour=Math.max(po,l.ecosystem.predatorHungerIncreasePerHour*.85)),o<ui*.5&&(l.ecosystem.berryBushSpreadChance=Math.min(Cs,l.ecosystem.berryBushSpreadChance*1.2)),n>ai*1.4&&(l.ecosystem.preyHungerIncreasePerHour=Math.min(bi,l.ecosystem.preyHungerIncreasePerHour*1.05)),r>li*1.4&&(l.ecosystem.predatorHungerIncreasePerHour=Math.min(xi,l.ecosystem.predatorHungerIncreasePerHour*1.05)),o>ui*1.4&&(l.ecosystem.berryBushSpreadChance=Math.max(ci,l.ecosystem.berryBushSpreadChance*.95))}calculateReward(n,r,o){const l=Math.abs(n-ai),a=Math.abs(r-li),c=Math.abs(o-ui),d=l/ai,h=a/li,g=c/ui,m=d+h+g;return 100*Math.exp(-m*2)-50}applyAction(n,r){switch(n){case 0:r.ecosystem.preyGestationPeriod=Math.min(vr,r.ecosystem.preyGestationPeriod+.2*(vr-lo));break;case 1:r.ecosystem.preyGestationPeriod=Math.max(lo,r.ecosystem.preyGestationPeriod-.2*(vr-lo));break;case 2:r.ecosystem.preyProcreationCooldown=Math.min(yr,r.ecosystem.preyProcreationCooldown+.2*(yr-uo));break;case 3:r.ecosystem.preyProcreationCooldown=Math.max(uo,r.ecosystem.preyProcreationCooldown-.2*(yr-uo));break;case 4:r.ecosystem.preyHungerIncreasePerHour=Math.min(bi,r.ecosystem.preyHungerIncreasePerHour+.2*(bi-ho));break;case 5:r.ecosystem.preyHungerIncreasePerHour=Math.max(ho,r.ecosystem.preyHungerIncreasePerHour-.2*(bi-ho));break;case 6:r.ecosystem.predatorGestationPeriod=Math.min(Sr,r.ecosystem.predatorGestationPeriod+.2*(Sr-co));break;case 7:r.ecosystem.predatorGestationPeriod=Math.max(co,r.ecosystem.predatorGestationPeriod-.2*(Sr-co));break;case 8:r.ecosystem.predatorProcreationCooldown=Math.min(Ar,r.ecosystem.predatorProcreationCooldown+.2*(Ar-fo));break;case 9:r.ecosystem.predatorProcreationCooldown=Math.max(fo,r.ecosystem.predatorProcreationCooldown-.2*(Ar-fo));break;case 10:r.ecosystem.predatorHungerIncreasePerHour=Math.min(xi,r.ecosystem.predatorHungerIncreasePerHour+.2*(xi-po));break;case 11:r.ecosystem.predatorHungerIncreasePerHour=Math.max(po,r.ecosystem.predatorHungerIncreasePerHour-.2*(xi-po));break;case 12:r.ecosystem.berryBushSpreadChance=Math.min(Cs,r.ecosystem.berryBushSpreadChance+.2*(Cs-ci));break;case 13:r.ecosystem.berryBushSpreadChance=Math.max(ci,r.ecosystem.berryBushSpreadChance-.2*(Cs-ci));break}}updateQTable(n,r,o,l){const a=this.getQValue(n,r),c=Math.max(...Array.from({length:Hd},(h,g)=>this.getQValue(l,g))),d=a+I1*(o+E1*c-a);this.setQValue(n,r,d)}step(n){const r=n,o=r.search.prey.count(),l=r.search.predator.count(),a=r.search.berryBush.count();this.applyEmergencyCorrections(o,l,a,n);const c=this.discretizeState(o,l,a);if(this.lastState!==null&&this.lastAction!==null){const h=this.calculateReward(o,l,a);this.updateQTable(this.lastState,this.lastAction,h,c)}const d=this.chooseAction(c);this.applyAction(d,n),this.epsilon=Math.max(_1,this.epsilon*w1),this.lastState=c,this.lastAction=d}reset(){this.qTable.clear(),this.epsilon=Wm,this.lastState=null,this.lastAction=null}getStats(){return{qTableSize:this.qTable.size,explorationRate:this.epsilon}}}let zv=new C1;function R1(e){S1(e),A1(e),e.ecosystem.lastUpdateTime||(e.ecosystem.preyGestationPeriod=lo+(vr-lo)*.3,e.ecosystem.preyProcreationCooldown=uo+(yr-uo)*.3,e.ecosystem.preyHungerIncreasePerHour=ho+(bi-ho)*.3,e.ecosystem.predatorGestationPeriod=co+(Sr-co)*.3,e.ecosystem.predatorProcreationCooldown=fo+(Ar-fo)*.3,e.ecosystem.predatorHungerIncreasePerHour=po+(xi-po)*.3,e.ecosystem.berryBushSpreadChance=ci+(Cs-ci)*.7),zv.step(e)}function P1(e){e.ecosystem.lastUpdateTime||(e.ecosystem.lastUpdateTime=0),!(e.time-e.ecosystem.lastUpdateTime<T1)&&(e.ecosystem.lastUpdateTime=e.time,R1(e))}function N1(){return zv.getStats()}const O1=1/60;function D1(e,n){const r=St(e);r&&(e.viewportCenter=Pf(e.viewportCenter,r.position,Tf*n))}function k1(e){for(const r of Object.values(e.entities.entities))r.isHighlighted=!1;const n=e.notifications.filter(r=>!r.isDismissed);for(const r of n)if(r.highlightedEntityIds)for(const o of r.highlightedEntityIds){const l=e.entities.entities[o];l&&(l.isHighlighted=!0)}}function gu(e,n){if(e.isPaused)return e;if(e.autosaveEnabled){const r=Date.now();r-e.lastAutosaveTime>e.autosaveIntervalSeconds*1e3&&(tu(e),e.lastAutosaveTime=r)}for(;n>0;){const r=eu(e),o=Math.min(n,O1);if(r.gameOver)return r;const l=o*(wt/_t);r.time+=l,D1(r,o),Aw(r),P1(r),k1(r),DC({gameState:r,deltaTime:o}),p1({gameState:r,deltaTime:o}),g1(r),BC(r,o),e=r,n-=o}return e}function Ym(e,n,r){e.save();const{x:o,y:l,width:a,height:c}=n.rect,d=av;if(e.beginPath(),e.moveTo(o+d,l),e.lineTo(o+a-d,l),e.quadraticCurveTo(o+a,l,o+a,l+d),e.lineTo(o+a,l+c-d),e.quadraticCurveTo(o+a,l+c,o+a-d,l+c),e.lineTo(o+d,l+c),e.quadraticCurveTo(o,l+c,o,l+c-d),e.lineTo(o,l+d),e.quadraticCurveTo(o,l,o+d,l),e.closePath(),e.fillStyle=n.isDisabled?lv:n.backgroundColor,e.fill(),n.activated){e.save();const h=(Math.sin(Date.now()/1e3*fv)+1)/2;e.strokeStyle=dv,e.lineWidth=2+h*2,e.globalAlpha=.7+h*.3,e.stroke(),e.restore()}if(n.lastActivated){const h=Date.now()-n.lastActivated;if(h<Kl){const g=1-h/Kl;e.fillStyle=cv,e.globalAlpha=g,e.fill(),e.globalAlpha=1}}r&&!n.isDisabled&&(e.fillStyle=Lf,e.globalAlpha=.5,e.fill(),e.globalAlpha=1),e.fillStyle=n.isDisabled?uv:n.textColor,n.icon?(e.font=`${c*.55}px "Press Start 2P", Arial`,e.textAlign="center",e.textBaseline="middle",e.fillText(n.icon,o+a/2,l+c/2),n.text&&(e.font=`${c*.18}px "Press Start 2P", Arial`,e.textAlign="right",e.textBaseline="bottom",e.fillText(n.text,o+a-4,l+c-2))):(e.textAlign="center",e.textBaseline="middle",e.fillText(n.text,o+a/2,l+c/2)),e.restore()}function M1(e,n,r,o){e.save(),e.font=`${Em}px "Press Start 2P", Arial`,e.textAlign="center",e.textBaseline="bottom";const a=e.measureText(r).width,c=Em,d=a+wm*2,h=c+wm*2,g=o.x-d/2,m=e.canvas.height,y=n.y<m/2?n.y+n.height-_m:n.y-h+_m;e.fillStyle=RE,e.fillRect(g,y,d,h),e.fillStyle=PE,e.fillText(r,o.x,y+h/2+c/2),e.restore()}function F1(e,n,r){e.save();const o=St(n),l=[{id:"fastForwardButton",action:Te.FastForward,text:"FFWD [T]",currentWidth:_n*1.3,backgroundColor:oi,textColor:rn,tooltip:"Fast-forward time",rect:{x:0,y:0,width:0,height:0}},{id:"pauseButton",action:Te.TogglePause,text:n.isPaused?"UN[P]AUSE":"[P]AUSE",backgroundColor:n.isPaused?vl:oi,currentWidth:n.isPaused?_n*1.4:_n*1.1,tooltip:n.isPaused?"Resume Game":"Pause Game",rect:{x:0,y:0,width:0,height:0},textColor:rn},{id:"muteButton",action:Te.ToggleMute,text:n.isMuted?"UN[M]UTE":"[M]UTE",backgroundColor:n.isMuted?vl:oi,tooltip:`Toggle Sound (${n.isMuted?"Muted":"Enabled"})`,currentWidth:_n,rect:{x:0,y:0,width:0,height:0},textColor:rn},{id:"saveGameButton",action:Te.SaveGame,text:"SAVE",backgroundColor:oi,tooltip:"Save Game State",currentWidth:_n*.9,rect:{x:0,y:0,width:0,height:0},textColor:rn},{id:"toggleAutosaveButton",action:Te.ToggleAutosave,text:n.autosaveEnabled?"AUTO[ON]":"AUTO[OFF]",backgroundColor:n.autosaveEnabled?vl:oi,tooltip:`Toggle Autosave (${n.autosaveEnabled?"Enabled":"Disabled"})`,currentWidth:_n*1.1,rect:{x:0,y:0,width:0,height:0},textColor:rn},{id:"returnToIntroButton",action:Te.ReturnToIntro,text:"EXIT",backgroundColor:oi,tooltip:"Return to Main Menu [ESC]",currentWidth:_n*.9,rect:{x:0,y:0,width:0,height:0},textColor:rn}];if(n.uiButtons.push(...l),o){const g=$f(n,o),m=new Set(g.map(H=>H.type));let y=[{playerAction:Re.Gather,buttonAction:Te.CommandGather,shortcut:"E",name:"Gather",toggleKey:"gathering",condition:()=>o.isAdult===!0},{playerAction:Re.Eat,buttonAction:Te.CommandEat,shortcut:"F",name:"Eat"},{playerAction:Re.Plant,buttonAction:Te.CommandPlant,shortcut:"B",name:"Plant",toggleKey:"planting",condition:()=>o.isAdult===!0},{playerAction:Re.Procreate,buttonAction:Te.ToggleProcreationBehavior,shortcut:"R",name:"Procreation",toggleKey:"procreation",condition:()=>o.isAdult===!0},{playerAction:Re.FeedChild,buttonAction:Te.ToggleFeedChildBehavior,shortcut:"H",name:"Feed Child",toggleKey:"feedChildren",condition:()=>o.isAdult===!0},{playerAction:Re.Attack,buttonAction:Te.ToggleAttackBehavior,shortcut:"Q",name:"Attack",toggleKey:"attack",condition:()=>o.isAdult===!0},{playerAction:Re.FollowMe,buttonAction:Te.CommandFollowMe,shortcut:"C",name:"Follow Me",toggleKey:"followLeader",condition:()=>o.isAdult===!0},{playerAction:Re.CallToAttack,buttonAction:Te.CommandCallToAttack,shortcut:"V",name:"Call to Attack",condition:()=>o.isAdult===!0},{playerAction:Re.TribeSplit,buttonAction:Te.CommandTribeSplit,shortcut:"K",name:"Split Tribe",condition:()=>o.leaderId!==void 0&&o.leaderId!==o.id&&o.isAdult===!0}];y=y.filter(H=>H.condition?H.condition():!0);const S=1,E=y.length,I=E*lr+(E-1)*Sl,T=S*lr+(S-1)*Sl,C=(r-I)/2,U=e.canvas.height-T-20;y.forEach((H,O)=>{const B=O%E,x=Math.floor(O/E),L=C+B*(lr+Sl),j=U+x*(lr+Sl),ie=!!H.toggleKey,_e=ie&&n.autopilotControls.behaviors[H.toggleKey],Ce=!m.has(H.playerAction),xe=!n.hasPlayerEnabledAutopilot||n.hasPlayerEnabledAutopilot<3?" (Press Shift to toggle Auto)":"",Me=ie?`${H.name}${xe}`:H.name,we=_e?vl:oi,ce={id:`commandButton_${H.name}`,action:H.buttonAction,rect:{x:L,y:j,width:lr,height:lr},icon:fu[H.playerAction],text:H.shortcut,backgroundColor:we,textColor:rn,currentWidth:lr,tooltip:Me,isDisabled:Ce,activated:_e};n.uiButtons.push(ce)})}let a=r-qe;l.forEach(g=>{const m=qe,y=a-g.currentWidth;g.rect={x:y,y:m,width:g.currentWidth,height:sv},Ym(e,g,n.hoveredButtonId===g.id),a-=g.currentWidth+CE});let c=null;n.uiButtons.filter(g=>g.id.startsWith("commandButton_")).forEach(g=>{c||(c={x:g.rect.x,y:g.rect.y,width:g.rect.width,height:g.rect.height}),c.x=Math.min(c.x,g.rect.x),c.y=Math.min(c.y,g.rect.y),c.width=Math.max(c.width,g.rect.x+g.rect.width-c.x),c.height=Math.max(c.height,g.rect.y+g.rect.height-c.y),Ym(e,g,n.hoveredButtonId===g.id)});const h=n.hoveredButtonId?n.uiButtons.find(g=>g.id===n.hoveredButtonId):void 0;return h&&h.tooltip&&n.mousePosition&&M1(e,h.rect,h.tooltip,n.mousePosition),e.restore(),{commandButtonsRect:c}}function U1(e){e.save(),e.fillStyle=GE,e.fillRect(0,0,e.canvas.width,e.canvas.height),e.fillStyle=bE,e.font=`${xE}px "Press Start 2P", Arial`,e.textAlign="center",e.textBaseline="middle",e.fillText("PAUSED",e.canvas.width/2,e.canvas.height/2),e.restore()}function jm(e,n,r,o){const l=n.x-r.width/2,a=n.y-r.height/2,c=l+e.x,d=a+e.y,h=(c%o.width+o.width)%o.width,g=(d%o.height+o.height)%o.height;return{x:h,y:g}}function mu(e,n,r,o){let l=e.x-n.x,a=e.y-n.y;return Math.abs(l)>o.width/2&&(l=l-Math.sign(l)*o.width),Math.abs(a)>o.height/2&&(a=a-Math.sign(a)*o.height),{x:l+r.width/2,y:a+r.height/2}}function Ol(e,n,r,o){const l=mu(e.position,n,r,o),c=("radius"in e?e.radius:20)+20;return l.x>=-c&&l.x<=r.width+c&&l.y>=-c&&l.y<=r.height+c}function wn(e,n,r,o,l,...a){const c={...l.position};for(let d=-r;d<=r;d+=r)for(let h=-n;h<=n;h+=n)l.position.x=c.x+h,l.position.y=c.y+d,o(e,l,...a);l.position=c}const L1=25,H1=0,Vm=28;function Wv(e,n,r,o,l,a,c,d,h,g){e.save();const{x:m,y}=mu(n,c,{width:d,height:h},g);e.strokeStyle=o,e.lineWidth=a,e.setLineDash(l),e.beginPath(),e.arc(m,y,r+du,0,2*Math.PI),e.stroke(),e.restore()}function B1(e,n,r,o,l,a,c){if(n=n.filter(y=>y.type!==Re.FollowMe),n.length===0)return;e.save(),n.forEach(y=>{y.targetEntity&&Wv(e,y.targetEntity.position,y.targetEntity.radius,Ff,Uf,2,o,l,a,c)}),e.font=`${Eo}px "Press Start 2P", Arial`,e.fillStyle="white",e.textAlign="center",e.textBaseline="bottom",e.shadowColor="black",e.shadowBlur=5;const{x:d,y:h}=mu(r.position,o,{width:l,height:a},c);let g=0,m={};n.forEach(y=>{const S=fu[y.type];if(y.targetEntity){m[y.targetEntity.id]=(m[y.targetEntity.id]||0)+1;const E=y.targetEntity.position.x-o.x+l/2,I=y.targetEntity.position.y-o.y+a/2,T=`${S}${y.key.toUpperCase()}`,C=I-y.targetEntity.radius-du-Eo/2-(m[y.targetEntity.id]-1)*Vm;e.fillText(T,E,C)}else{e.textAlign="left";const E=`${S}${y.key.toUpperCase()}`,I=d+L1,C=h+H1+g*Vm;e.fillText(E,I,C),g++,e.textAlign="center"}}),e.restore()}const ge=(e,n,r,o,l,a,c)=>{a==="transparent"||o<=0||l<=0||(e.fillStyle=a,e.fillRect(Math.floor(n*c),Math.floor(r*c),Math.ceil(o*c),Math.ceil(l*c)))},Xm=10,Km=10,$n=6,ii=4,Dl=2,G1=5,hn=4,b1=2,kt=4,x1=2,Je=3,to=2,Bi=0,Ls=Bi+ii-1,Lt=Ls,lt=Ls+hn-1,$1="rgba(0, 0, 0, 0.4)",z1=4,W1=1,jf={name:"tribe-human-2d",referenceImage:"swos.png",description:`A 2D human character asset for the Tribe game. This includes ensuring that the unique animations for stances like 'eat' and 'procreate' do not erroneously appear in other stances, such as 'walk', which was observed in the provided rendered media. The 'idle' animation was updated to a leg sway to better match the provided video for that stance, replacing a simpler body bob.

# Visual style

Human characters in the Tribe game are inspired by classic 2D pixel art, they look like Sensible Soccer players(Sensible Soccer game visual style is IMPORTANT), with a simple and recognizable design. The characters are designed to be easily distinguishable and animated in a way that conveys their actions clearly.

Character in Tribe game look like people from stone age, they have simple clothing, no shoes, and no modern accessories. The characters are designed to be easily distinguishable and animated in a way that conveys their actions clearly.

# Technical details

The asset is rendered on a canvas using the CanvasRenderingContext2D API. The rendering function takes parameters for position, size, progress, stance, direction, gender, and age. The character can face left or right, and the rendering adapts based on the stance (e.g., idle, walk, eat, procreate).
The rendering function must be simple and efficient, it should not use complex patterns or gradients, and should focus on solid colors and basic shapes to maintain the pixel art aesthetic.

15% padding from all edges of the rendering box is required to ensure the character is not cut off during rendering.

Subtle shadow should be drawn under the character to give it a sense of depth.

# Rendering parameters

- age: The age of the character, which affects the size and proportions of the body parts. Age is a number between 1 and 60, with 20 being the average age.
- gender: 
  - The male characters should have only pants, while female cover their breasts with a top. The clothing should be simple and muted, reflecting a stone-age style.
  - Female characters should have long hair, while male should have short hair and beard.
  - Male characters should have a more robust, muscular build
  - Female characters should have thinner arms and legs, with a more pronounced waist and hips.
- isPregnant: (applicable only for females) Indicates if the character is pregnant, like very large belly. Pregnant characters should have a larger torso.
- direction: A vector indicating the character's facing direction. There should be at least 8 directions (like in Sensible Soccer): top left, top, top right, left, right, bottom left, bottom, bottom right. The character should be flipped horizontally if the direction vector's X component is negative.
             When moving up(top, top left, top right), the character back of the head should be visible, when moving down(Y > 0), the character face should be visible.
- hungryLevel: A number between 0 and 100 indicating how hungry the character is, hunger level 100 means the character is starving, 0 means the character is not hungry at all. So hungry characters should be thinner, with less body fat, and more pronounced muscles. The character's hunger level affects the size and proportions of the body parts, with hungrier characters being smaller and more gaunt.

# Rendering details

- All parts of the body must be connected
- Rendering must take into account direction vector (X and Y) to flip the character horizontally if needed
- The character's age affects the size and proportions of the body parts, with older characters being larger and more robust. Hair color should become gray for older characters.

# Stances

- 'idle': The character stands still, with a slight leg sway to indicate life.
- 'walk': The character moves forward, with legs and arms in motion.
- 'gathering': The character is gathering food from berry bushes, with arms reaching out and a slight bend at the knees.
- 'eat': The character holds food and brings it to their mouth, with a slight bend at the knees.
- 'procreate': The character performs a mating animation, with a specific pose and movement. There should be some additional visual effects to indicate this action, such as a slight glow or aura around the characters, or dust particles to indicate movement.
- 'attacking': The character performs an attack animation, with arms raised and a forward motion.
- 'defending': The character takes a defensive stance, with arms raised and a slight bend at the knees.
- 'stunned': The character is stunned and laying on the ground, with limbs relaxed and a neutral expression.
- 'dead': The character lies on the ground, with limbs relaxed and a neutral expression, slowly turns into a skeleton over time.

`,stances:["idle","walk","gathering","eat","procreate","dead","attacking","defending","stunned"],render(e,n,r,o,l,a,c,d="male",h=20,g=[1,0],m=!1,y=0){const S=["dead","stunned"].includes(c),E=S?Km+4:Xm,I=S?Xm+4:Km+Je,T=.15,C=Math.min(o*(1-2*T)/E,l*(1-2*T)/I),U=E*C,H=I*C,O=n+(o-U)/2,B=r+(l-H)/2;e.save(),g[0]<0&&!S?(e.translate(O+U,B),e.scale(-1,1)):e.translate(O,B);const L="#D09A5A",j=h>50?"#BDBDBD":"#281808",ie="#7F5C4A",_e="#6B4F3A",Ce="#E0D8C0",xe="#A0522D",Me=1-Math.max(0,Math.min(100,y))/100*.2,we=d==="male"?1.1:.9,ce=.8+(Math.max(1,Math.min(h,60))-1)/59*.2;let He=G1*Me*we*ce,ye=b1*Me*we*ce,ee=x1*Me*ce;m&&d==="female"&&(He*=1.5);const z=Math.round((E-He)/2),V=Math.round((E-$n)/2),W=z-ye,R=z+He,F=1,X=z+(He/2-F/2)-ee,te=z+(He/2+F/2),pe=g[1]<-.2&&Math.abs(g[0])<.7,se=q=>{e.fillStyle=$1,e.beginPath();const ne=E/2,Fe=q;e.ellipse(Math.floor(ne*C),Math.floor(Fe*C),Math.max(1,Math.floor(z1*C)),Math.max(1,Math.floor(W1*C)),0,0,2*Math.PI),e.fill()},Se=(q,ne)=>{d==="male"?(ge(e,z,Ls+q,He,hn-to,ne,C),ge(e,z,Ls+hn-to+q,He,to,ie,C)):ge(e,z,Ls+q,He,hn,_e,C)},ve=(q,ne)=>{pe?ge(e,V,Bi+q,$n,ii,j,C):(ge(e,V,Bi+q,$n,ii,ne,C),ge(e,V,Bi+q,$n,Dl,j,C),d==="female"?(ge(e,V-1,Bi+Dl+q,1,ii,j,C),ge(e,V+$n,Bi+Dl+q,1,ii,j,C)):ge(e,V+1,Bi+2+q,$n-2,ii-2,j,C))};switch(c){case"idle":{const q=a*Math.PI*2,ne=Math.sin(q)*.5,de=(Math.cos(q*2)+1)*.25;se(lt+Je+1),ge(e,X+ne,lt+de,ee,Je,L,C),ge(e,te-ne,lt+de,ee,Je,L,C),Se(de,L),ge(e,W,Lt+de,ye,kt,L,C),ge(e,R,Lt+de,ye,kt,L,C),ve(de,L);break}case"walk":{const q=a*Math.PI*2,ne=Math.sin(q)*2,de=Math.abs(Math.cos(q))*1;se(lt+Je+1),ge(e,X+ne,lt+de,ee,Je,L,C),ge(e,te-ne,lt+de,ee,Je,L,C),Se(de,L),ge(e,W-ne,Lt+de,ye,kt,L,C),ge(e,R+ne,Lt+de,ye,kt,L,C),ve(de,L);break}case"gathering":{const q=a*Math.PI*2,ne=1,Fe=(Math.sin(q)+1)/2*2,de=ne+Math.abs(Math.cos(q))*.5;se(lt+Je+1),ge(e,X,lt+de,ee,Je-ne,L,C),ge(e,te,lt+de,ee,Je-ne,L,C),Se(de,L),ge(e,W+1,Lt+de-Fe,ye,kt,L,C),ge(e,R-1,Lt+de-Fe,ye,kt,L,C),ve(de,L);break}case"eat":{se(lt+Je+1),ge(e,X,lt+1,ee,Je-1,L,C),ge(e,te,lt+1,ee,Je-1,L,C),Se(1,L);const Fe=(Math.sin(a*Math.PI*4)+1)/2,de=V+$n/2,Dn=Bi+ii/2,Qe=R+(de-R)*Fe,je=Lt+1+(Dn-(Lt+1))*Fe;ge(e,W,Lt+1,ye,kt,L,C),ge(e,Qe,je,ye,kt,L,C),ge(e,Qe,je-1,1,1,xe,C),ve(1,L);break}case"procreate":{const q=(Math.sin(a*Math.PI*8)+1)/4,ne=(Math.sin(a*Math.PI*6)+1)*.5,Fe=1.5,de=Fe-ne;se(lt+Je+1),ge(e,X,lt+de,ee,Je-Fe,L,C),ge(e,te,lt+de,ee,Je-Fe,L,C),Se(de,L),ge(e,W,Lt+de,ye,kt,L,C),ge(e,R,Lt+de,ye,kt,L,C),ve(de,L),e.globalAlpha=q,Se(de,"white"),e.globalAlpha=1;break}case"attacking":{const q=Math.sin(a*Math.PI)*1.5,ne=Math.abs(Math.sin(a*Math.PI));se(lt+Je+1),ge(e,X-q,lt+ne,ee,Je,L,C),ge(e,te+q*.5,lt+ne,ee,Je,L,C),Se(ne,L),ge(e,W,Lt+ne-2,ye,kt,L,C),ge(e,R,Lt+ne-2.5,ye,kt,L,C),ve(ne,L);break}case"defending":{se(lt+Je+1),ge(e,X,lt+1,ee,Je-1,L,C),ge(e,te,lt+1,ee,Je-1,L,C),Se(1,L),ge(e,W-1,Lt+1-1,ye,kt,L,C),ge(e,R+1,Lt+1-1,ye,kt,L,C),ve(1,L);break}case"stunned":case"dead":{const q=c==="dead",ne=q?Math.min(1,a):0,Fe=ne>.5?Ce:L,de=d==="male"?ie:_e,Dn=ne>.8?"transparent":j,Qe=E/2,je=I/2,kn=2;se(I-1),ge(e,Qe-ee-kn,je,ee,Je,Fe,C),ge(e,Qe+kn,je,ee,Je,Fe,C),ge(e,Qe-ye-kn,je-hn+1,ye,kt,Fe,C),ge(e,Qe+kn,je-hn+1,ye,kt,Fe,C);const $t=Qe-He/2,on=je-hn/2;d==="male"?(ne<.7&&ge(e,$t,on+hn-to,He,to,de,C),ge(e,$t,on,He,hn-to,Fe,C)):ne<.7?ge(e,$t,on,He,hn,de,C):ge(e,$t,on,He,hn,Fe,C);const Mn=Qe-$n/2,Fn=je-hn/2-ii+1;if(ge(e,Mn,Fn,$n,ii,Fe,C),Dn!=="transparent"&&ge(e,Mn,Fn,$n,Dl,Dn,C),q&&ne>.6){const hi="#B0A890";for(let Vi=0;Vi<3;Vi++)ge(e,$t+1,on+Vi*1+1,He-2,.5,hi,C)}break}default:ge(e,0,0,E,I,"magenta",C);break}e.restore()}};function Y1(e,n,r,o,l){const a=n.x,c=n.y-r-o/2;e.save(),e.fillStyle=l,e.strokeStyle=l,e.lineWidth=1.5,e.beginPath(),e.rect(a-o/2,c,o,o/2),e.fill(),e.beginPath(),e.moveTo(a-o/2,c),e.lineTo(a-o/4,c-o/3),e.lineTo(a-o/6,c),e.moveTo(a-o/6,c),e.lineTo(a,c-o/2),e.lineTo(a+o/6,c),e.moveTo(a+o/6,c),e.lineTo(a+o/4,c-o/3),e.lineTo(a+o/2,c),e.stroke(),e.restore()}function Qs(e,n,r,o,l,a=!1,c=!1,d=!1,h=!1){o<If&&(r=r*.75),jf.render(e,n.x-r/2,n.y-r/2,r,r,0,"idle",l,o,[0,0],!1,0);let g,m;a?(g=vE,m=Mf):c?(g=yE,m=rv):d?(g=SE,m=iv):h&&(g=AE,m=nv),g&&m&&Y1(e,n,r/2,g,m)}function j1(e,n,r,o,l,a){if(e.save(),o.length===0){e.restore();return}const c=o.length*l,d=4;let h;const g=c+(o.length-1)*d;o.length>1&&g>a?h=(a-c)/(o.length-1):h=d,o.length<=1&&(h=0);for(let m=0;m<o.length;m++){const{member:y,isPlayer:S,isHeir:E,isPartner:I,isParent:T}=o[m],C=n+m*(l+h)+l/2,U=r+l/4;Qs(e,{x:C,y:U},l,y.age,y.gender,S,E,I,T)}e.restore()}function V1(e,n,r,o,l){if(r.length===0)return;e.save();const a=bn,c=" 00",d=" 00";e.font=`${vd}px "Press Start 2P", Arial`;const h=e.measureText(c).width,g=e.measureText(d).width,m=bn+fn+bn+fn+bn+Fi+h+bn/2+Fi+g,y=r.length*ml+(r.length-1)*Tm,S=l-y-bn;e.fillStyle=IE,e.fillRect(a,S,m,y);for(let E=0;E<r.length;E++){const I=r[E],T=S+E*(ml+Tm),C=T+ml/2;I.isPlayerTribe&&(e.fillStyle=TE,e.fillRect(a,T,m,ml));let U=a+bn;if(e.font=`${fn}px "Press Start 2P", Arial`,e.textBaseline="middle",e.textAlign="left",e.fillText(I.tribeBadge,U,C-fn/4),U+=fn+bn,!I.isPlayerTribe){const H=I.diplomacyStatus===bt.Friendly?"":"",O=`diplomacyButton_${I.leaderId}`,B={x:U-2,y:C-fn/2-2,width:fn+4,height:fn+4},x={id:O,action:Te.ToggleDiplomacy,rect:B,text:"",icon:H,backgroundColor:"transparent",textColor:"white",currentWidth:fn,tooltip:`Toggle diplomacy with this tribe (Currently: ${I.diplomacyStatus})`,targetTribeId:I.leaderId};n.uiButtons.push(x),n.hoveredButtonId===O&&(e.fillStyle=Lf,e.globalAlpha=.5,e.fillRect(B.x,B.y,B.width,B.height),e.globalAlpha=1),e.font=`${fn*.8}px "Press Start 2P", Arial`,e.textBaseline="middle",e.textAlign="center",e.fillText(H,U+fn/2,C)}U+=fn+bn,I.adultCount>0&&(Qs(e,{x:U+Fi/2,y:C},Fi,25,"male"),U+=Fi/2,e.font=`${vd}px "Press Start 2P", Arial`,e.fillStyle="white",e.textBaseline="middle",e.textAlign="left",e.fillText(` ${I.adultCount}`,U,C),U+=e.measureText(` ${I.adultCount}`).width+bn/2),I.childCount>0&&(Qs(e,{x:U+Fi/2,y:C},Fi,1,"female"),U+=Fi/2,e.font=`${vd}px "Press Start 2P", Arial`,e.fillStyle="white",e.textBaseline="middle",e.textAlign="left",e.fillText(` ${I.childCount}`,U,C))}e.restore()}function X1(e,n,r,o,l){const a=mv,c=vv,d=n+o-a-c,h=r+c;e.save(),e.lineWidth=2,e.strokeStyle=l?QE:qE,e.beginPath();const g=5;e.moveTo(d+g,h+g),e.lineTo(d+a-g,h+a-g),e.moveTo(d+a-g,h+g),e.lineTo(d+g,h+a-g),e.stroke(),e.restore()}function K1(e,n,r,o){const{tutorialState:l,tutorial:a}=n;if(l.transitionState===Bt.INACTIVE)return;const c=a.steps[l.currentStepIndex];if(!c)return;e.save(),e.globalAlpha=l.transitionAlpha;const d=$E,h=zE,g=WE,m=`${Ad}px "Press Start 2P", Arial`,y=`${Nm}px "Press Start 2P", Arial`,S=jE,E=Nm*1.5;e.font=y;const I=c.text.split(" ");let T="";const C=[];for(let Ce=0;Ce<I.length;Ce++){const xe=T+I[Ce]+" ";e.measureText(xe).width>d-h*2&&Ce>0?(C.push(T),T=I[Ce]+" "):T=xe}C.push(T);const U=h*2+Ad+h/2+C.length*E,H=(r-d)/2,O=o-U-160;e.fillStyle=YE,e.beginPath(),e.moveTo(H+g,O),e.lineTo(H+d-g,O),e.quadraticCurveTo(H+d,O,H+d,O+g),e.lineTo(H+d,O+U-g),e.quadraticCurveTo(H+d,O+U,H+d-g,O+U),e.lineTo(H+g,O+U),e.quadraticCurveTo(H,O+U,H,O+U-g),e.lineTo(H,O+g),e.quadraticCurveTo(H,O,H+g,O),e.closePath(),e.fill(),e.fillStyle=S,e.textAlign="center",e.textBaseline="top",e.font=m,e.fillText(c.title,H+d/2,O+h),e.font=y;let B=O+h+Ad+h/2;for(const Ce of C)e.fillText(Ce,H+d/2,B),B+=E;const x=n.hoveredButtonId==="tutorial-dismiss";X1(e,H,O,d,x),e.restore();const L=mv,j=vv,ie=H+d-L-j,_e=O+j;return{x:ie,y:_e,width:L,height:L}}function Bd(e,n,r){e.save();const o=KE,l={x:n.x-o,y:n.y-o,width:n.width+o*2,height:n.height+o*2};e.strokeStyle=pv,e.lineWidth=gv+Math.sin(r*Hf)*1.5,e.setLineDash([8,8]),e.strokeRect(l.x,l.y,l.width,l.height),e.restore()}function q1(e,n){e.fillStyle="white",e.font='30px "Press Start 2P", Arial',e.textAlign="center",e.fillText("Game Over!",e.canvas.width/2,e.canvas.height/2-60),e.font='20px "Press Start 2P", Arial',e.fillText("Lineage Extinct.",e.canvas.width/2,e.canvas.height/2-20),e.fillText(`Cause: ${n.causeOfGameOver||"Unknown"}`,e.canvas.width/2,e.canvas.height/2+20)}const cf=10,Q1=3,qm=cf*.7;function Z1(e,n,r,o,l){const{position:a,food:c,maxFood:d,ownerId:h,claimedUntil:g}=n;if(e.beginPath(),e.arc(a.x,a.y,cf,0,Math.PI*2),e.fillStyle="#228B22",e.fill(),e.strokeStyle="#006400",e.lineWidth=1,e.stroke(),h&&g&&g>l&&o){const m=r.entities.entities[h];if(m){let y;m.id===o.id?y=Mf:Q0(o,m,r)?y=rE:y=ov,y&&(e.strokeStyle=y,e.lineWidth=1+Math.sin(l*2)*.5,e.beginPath(),e.arc(a.x,a.y,cf+2,0,Math.PI*2),e.stroke())}}if(c.length>0){const m=Math.PI*2/Math.min(c.length,d);for(let y=0;y<c.length;y++){const S=y*m,E=a.x+qm*Math.cos(S),I=a.y+qm*Math.sin(S);e.beginPath(),e.arc(E,I,Q1,0,Math.PI*2),e.fillStyle="#FF0000",e.fill()}}}const Qm=(e,n,r=70,o=50)=>{const l=e>>n&255;return`hsl(${Math.floor(l/255*360)}, ${r}%, ${o}%)`},J1=(e,n)=>{const r=e.match(/hsl\((\d+),\s*(\d+)%,\s*(\d+)%\)/);if(!r)return e;const[o,l,a]=[parseInt(r[1]),parseInt(r[2]),parseInt(r[3])];return`hsl(${o}, ${l}%, ${Math.max(0,a-n)}%)`},kl=(e,n,r,o,l,a,c,d=!1)=>{e.save(),e.translate(n,r),e.rotate(a),e.fillStyle=d?J1(c,15):c,e.beginPath(),e.roundRect(-o/2,0,o,l,o/2),e.fill(),e.restore()},Gd=(e,n)=>{const r=e.match(/hsl\((\d+),\s*(\d+)%,\s*(\d+)%\)/),o=75;if(!r)return`hsl(0, 0%, ${o}%)`;const[,l,a,c]=r.map(Number),d=a*(1-n),h=c+(o-c)*n;return`hsl(${l}, ${d}%, ${h}%)`},Yv={name:"tribe-prey-2d",referenceImage:"swos.png",description:`A 2D prey asset for the Tribe game, featuring various stances and animations.

Prey is an animal which can be hunted by predators or humans in the Tribe game.

Preys look like small 4 leg mammals, with a simple and recognizable design. The characters are designed to be easily distinguishable and animated in a way that conveys their actions clearly.

# Visual style

Prey characters in the Tribe game are inspired by classic 2D pixel art, they look like Sensible Soccer players(Sensible Soccer game visual style is IMPORTANT), with a simple and recognizable design. The characters are designed to be easily distinguishable and animated in a way that conveys their actions clearly.

Character in Tribe game look like creatures from stone age, they have simple clothing, no shoes, and no modern accessories. The characters are designed to be easily distinguishable and animated in away that conveys their actions clearly.

Prey walks on all fours, unlike human (two legs).

Each prey is described by a unique gene code, which is a number that defines its appearance, size, and other characteristics. The gene code is used to generate the character's appearance, including body proportions, color, and other visual features. The gene code is a 32-bit integer, with each bit representing a specific characteristic of the character.

Prey should have should have visible body parts, such as head, torso, arms, and legs. The body parts should be connected and should not overlap. The character's body parts should be simple shapes, such as circles and rectangles, with solid colors and no gradients or patterns.

Preys are supposed to be sympathetic and friendly, so the character's face should have a friendly expression, with a smile and bright eyes. The character's eyes should be large and expressive, with a simple design.

# Technical details

The asset is rendered on a canvas using the CanvasRenderingContext2D API. The rendering function takes parameters for position, size, progress, stance, direction, gender, and age. The character can face left or right, and the rendering adapts based on the stance (e.g., idle, walk, eat, procreate).
The rendering function must be simple and efficient, it should not use complex patterns or gradients, and should focus on solid colors and basic shapes to maintain the pixel art aesthetic.

15% padding from all edges of the rendering box is required to ensure the character is not cut off during rendering.

Subtle shadow should be drawn under the a character to give it a sense of depth.

IMPORTANT: The character is visible from the side, just like in Sensible Soccer.

# Rendering parameters

- age: The age of the character, which affects the size and proportions of the body parts. Age is a number between 0 and 12, with 2 being the average age.
- gender:
  - 'male': Male prey are larger and more robust, with a more pronounced musculature.
  - 'female': Female prey are smaller and more agile, with a leaner build.
- isPregnant: (applicable only for females) Indicates if the character is pregnant, like very large belly. Pregnant characters should have a larger torso.
- direction: A vector indicating the character's facing direction. There should be at least 8 directions (like in Sensible Soccer): top left, top, top right, left, right, bottom left, bottom, bottom right. The character should be flipped horizontally if the direction vector's X component is negative.
             When moving up(top, top left, top right), the character back of the head should be visible, when moving down(Y > 0), the character face should be visible.
- hungryLevel: A number between 0 and 100 indicating how hungry the character is, hunger level 100 means the character is starving, 0 means the character is not hungry at all. So hungry characters should be thinner, with less body fat, and more pronounced muscles. The character's hunger level affects the size and proportions of the body parts, with hungrier characters being smaller and more gaunt.

# Rendering details

- All parts of the body must be connected
- Rendering must take into account direction vector (X and Y) to flip the character horizontally if needed
- The character's age affects the size and proportions of the body parts, with older characters being larger and more robust. Hair color should become gray for older characters.

# Stances

- 'idle': The character stands still, with a slight leg sway to indicate life.
- 'walk': The character moves forward, with legs and arms in motion.
- 'eat': The character holds food and brings it to their mouth, with a slight bend at the knees.
- 'procreate': The character performs a mating animation, with a specific pose and movement. There should be some additional visual effects to indicate this action, such as a slight glow or aura around the characters, or a dust particles to indicate movement.
- 'dead': The character lies on the ground, with limbs relaxed and a neutral expression, slowly turns into a grey skeleton over time. The character pose and body parts should not be animated in this stance, as the character is dead so it should not move.`,stances:["idle","walk","eat","dead","procreate"],render(e,n,r,o,l,a,c,d={gender:"male",age:2,direction:[1,0],isPregnant:!1,hungryLevel:0,geneCode:8405024}){e.save(),e.imageSmoothingEnabled=!1;const h=o*.15,g=n+o/2,m=r+l/2,y=o-h*2,S=l-h*2,{gender:E,age:I,direction:T,isPregnant:C,hungryLevel:U,geneCode:H}=d,O=.8+Math.min(I,10)/10*.4,B=E==="male"?1.05:.95,x=1-U/100*.3,L=y*.5*x*O*B;let j=S*.3*O*B;const ie=y*.15*O*B,_e=L*.2,Ce=S*.3,xe=Qm(H,0,30,50);let Me=Qm(H,8,50,40);if(I>45){const se=Math.min(1,(I-45)/15);Me=Gd(Me,se)}e.translate(g,m),T[0]<0&&e.scale(-1,1);const we=Math.sin(a*Math.PI*2),ce=Math.cos(a*Math.PI*2),He=Ce+j*.2;if(c==="dead"){const se=Math.min(a,1);e.translate(0,S*.2),e.rotate(Math.PI/2);const Se=Gd(Me,se),ve=Gd(xe,se);e.globalAlpha=.5+se*.5,e.strokeStyle=Se,e.lineWidth=_e*.5,e.beginPath(),e.moveTo(-L*.4,0),e.lineTo(L*.4,0),e.stroke();for(let q=-1;q<=1;q+=1)e.beginPath(),e.arc(0,0,j*.4,Math.PI*.4*q-Math.PI*.2,Math.PI*.4*q+Math.PI*.2),e.stroke();e.fillStyle=ve,e.beginPath(),e.arc(L*.5,0,ie,0,Math.PI*2),e.fill(),e.fillStyle="black",e.beginPath(),e.arc(L*.55,0,ie*.3,0,Math.PI*2),e.fill(),e.restore();return}e.fillStyle="rgba(0, 0, 0, 0.1)",e.beginPath(),e.ellipse(0,He,L*.7,L*.25,0,0,2*Math.PI),e.fill();let ye=0,ee=0,z=0,V=0,W=0,R=0;switch(c){case"idle":ee=we*(S*.02),z=we*.05,V=-we*.05,W=-we*.05,R=we*.05;break;case"walk":ee=Math.abs(ce)*(S*-.04),z=we*.7,V=-we*.7,W=-we*.7,R=we*.7;break;case"eat":ye=S*.1,ee=S*.05,ye+=we*(S*.02);break;case"procreate":ee=S*.05;const se=(1-ce)*-y*.05;e.translate(se,0),e.shadowColor="rgba(255, 182, 193, 0.9)",e.shadowBlur=10;break}C&&E==="female"&&(j*=1.6);const F=ee,X=F-j*.2;kl(e,L*-.35,X,_e,Ce,W,Me,!0),kl(e,L*.35,X,_e,Ce,R,Me,!0),e.fillStyle=Me,e.beginPath(),e.ellipse(0,F,L/2,j/2,0,0,2*Math.PI),e.fill();const te=L*.45,pe=X+ye;e.fillStyle=xe,e.beginPath(),e.arc(te,pe,ie,0,Math.PI*2),e.fill(),T[1]>=0&&(e.fillStyle="black",e.beginPath(),e.arc(te+ie*.3,pe-ie*.2,ie*.15,0,Math.PI*2),e.fill()),kl(e,L*-.35,X,_e,Ce,z,Me),kl(e,L*.35,X,_e,Ce,V,Me),e.restore()}};function eR(e,n){let[r,o,l]=e.match(/\d+/g).map(Number);return r=Math.max(0,r-n),o=Math.max(0,o-n),l=Math.max(0,l-n),`rgb(${r}, ${o}, ${l})`}function tR(e){const n=(e&16711680)>>16,r=(e&65280)>>8,o=e&255,l=`rgb(${n}, ${r}, ${o})`,a=eR(l,40),c=(e&255)%100+50,d=(e>>8&255)%100,h=(e>>16&255)%100,g=`rgb(${c}, ${d}, ${h})`,m=(e&8388608)!==0?"#00aaff":"#ffaa00";return{furColor:l,darkerFurColor:a,skinColor:g,eyeColor:m}}const jv={name:"tribe-predator-2d",referenceImage:"swos.png",description:`A 2D predator asset for the Tribe game, featuring various stances and animations.

Predator is an animal which can hunt and attack humans in the Tribe game. It is designed to be a threat to the player, adding an element of danger and challenge to the game world.

Predator look like bears or wolves, with a simple and recognizable design. The characters are designed to be easily distinguishable and animated in a way that conveys their actions clearly.

# Visual style

Predator characters in the Tribe game are inspired by classic 2D pixel art, they look like Sensible Soccer players(Sensible Soccer game visual style is IMPORTANT), with a simple and recognizable design. The characters are designed to be easily distinguishable and animated in a way that conveys their actions clearly.

Character in Tribe game look like creatures from stone age, they have simple clothing, no shoes, and no modern accessories. The characters are designed to be easily distinguishable and animated in away that conveys their actions clearly.

Predator walks on arms and legs, unlike human (two legs).

Each predator is described by a unique gene code, which is a number that defines its appearance, size, and other characteristics. The gene code is used to generate the character's appearance, including body proportions, color, and other visual features. The gene code is a 32-bit integer, with each bit representing a specific characteristic of the character.

Predator should have visible ears, eyes, and mouth with teeth. It must have a tail. Front legs should be shorter than back legs, and they should be positioned closer to the body. The character's body should be wider at the top and narrower at the bottom, with a slight curve to the back. The character's head should be larger than the body, with a pronounced jaw and sharp teeth.

# Technical details

The asset is rendered on a canvas using the CanvasRenderingContext2D API. The rendering function takes parameters for position, size, progress, stance, direction, gender, and age. The character can face left or right, and the rendering adapts based on the stance (e.g., idle, walk, eat, procreate).
The rendering function must be simple and efficient, it should not use complex patterns or gradients, and should focus on solid colors and basic shapes to maintain the pixel art aesthetic.

15% padding from all edges of the rendering box is required to ensure the character is not cut off during rendering.

Subtle shadow should be drawn under the a character to give it a sense of depth.

IMPORTANT: The character is visible from the side, just like in Sensible Soccer.

# Rendering parameters

- age: The age of the character, which affects the size and proportions of the body parts. Age is a number between 1 and 20, with 3 being the average age.
- gender:
  - 'male': Male predators are larger and more robust, with a more pronounced musculature.
  - 'female': Female predators are smaller and more agile, with a leaner build.
- isPregnant: (applicable only for females) Indicates if the character is pregnant, like very large belly. Pregnant characters should have a larger torso.
- direction: A vector indicating the character's facing direction. There should be at least 8 directions (like in Sensible Soccer): top left, top, top right, left, right, bottom left, bottom, bottom right. The character should be flipped horizontally if the direction vector's X component is negative.
             When moving up(top, top left, top right), the character back of the head should be visible, when moving down(Y > 0), the character face should be visible.
- hungryLevel: A number between 0 and 100 indicating how hungry the character is, hunger level 100 means the character is starving, 0 means the character is not hungry at all. So hungry characters should be thinner, with less body fat, and more pronounced muscles. The character's hunger level affects the size and proportions of the body parts, with hungrier characters being smaller and more gaunt.

# Rendering details

- All parts of the body must be connected
- Rendering must take into account direction vector (X and Y) to flip the character horizontally if needed
- The character's age affects the size and proportions of the body parts, with older characters being larger and more robust. Hair color should become gray for older characters.

# Stances

- 'idle': The character stands still, with a slight leg sway to indicate life.
- 'walk': The character moves forward, with legs and arms in motion.
- 'eat': The character holds food and brings it to their mouth, with a slight bend at the knees.
- 'procreate': The character performs a mating animation, with a specific pose and movement. There should be some additional visual effects to indicate this action, such as a slight glow or aura around the characters, or a dust particles to indicate movement.
- 'attacking': The character performs an attack animation, with arms raised and a forward motion.
- 'dead': The character lies on the ground, with limbs relaxed and a neutral expression, slowly turns into a grey skeleton over time. The character pose and body parts should not be animated in this stance, as the character is dead so it should not move.`,stances:["idle","walk","eat","dead","attacking","procreate"],render(e,n,r,o,l,a,c,d={gender:"male",age:20,direction:[1,0],isPregnant:!1,hungryLevel:0,geneCode:8405024}){const{gender:h,age:g,direction:m,isPregnant:y,hungryLevel:S,geneCode:E}=d;e.save();const I=o*.15,T=Math.max(1,Math.floor((o-I*2)/10)),C=m[0]<0;e.translate(n+o/2,r+l/2),C&&e.scale(-1,1);const U=tR(E),H=.8+Math.min(g,20)/20*.4,O=h==="male"?1.05:.95,B=1-S/100*.25,x=H*O*B,L=Math.max(0,Math.min(1,(g-15)/5));e.filter=`grayscale(${L})`;const j=U.furColor,ie=U.darkerFurColor,_e=U.eyeColor,Ce="#FFFFFF",xe="#c75c5c",Me="#E0E0E0",we="#A0A0A0",ce=l/2-2*T,He=Math.sin(a*Math.PI*2),ye=Math.abs(He);if(e.fillStyle="rgba(0,0,0,0.15)",e.beginPath(),e.ellipse(0,ce,T*4,T,0,0,2*Math.PI),e.fill(),e.filter="none",c==="dead"){const Qe=Math.min(1,a*2);e.save(),e.translate(0,ce-T*3),e.rotate(-Math.PI/2);const je=(kn,$t,on,Mn,Fn=!1)=>{e.fillStyle=Fn?we:Me,e.fillRect(kn*T,$t*T,on*T,Mn*T)};Qe<1&&(e.globalAlpha=1-Qe,e.fillStyle=j,e.beginPath(),e.ellipse(0,0,T*3,T*5,0,0,Math.PI*2),e.fill(),e.globalAlpha=1),Qe>0&&(e.globalAlpha=Qe,je(-1,-4,2,2),je(1,-3.5,1,1,!0),je(-.5,-2,1,5,!0),je(-2.5,-1,5,.5),je(-2.5,0,5,.5),je(-2.5,1,5,.5),je(-3,-2,-1,2,!0),je(3,-2,1,2),je(-3,2,-1,2,!0),je(3,2,1,2),e.globalAlpha=1),e.restore(),e.restore();return}e.fillStyle=j;let ee=0,z=0,V=0,W=[0,0,0,0];switch(c){case"idle":ee=He*T*.1;break;case"walk":const Qe=Math.sin(a*Math.PI*4);ee=Math.abs(Qe)*-T*.5,W=[Qe*T,-Qe*T,-Qe*T,Qe*T];break;case"attacking":const je=Math.sin(a*Math.PI*4);z=T*2+je*T,V=T*2,ee=T;break;case"eat":V=T*3+ye*T,ee=T*1.5,e.fillStyle=xe,e.fillRect(-T,ce-T,T*2,T);break;case"procreate":ee=Math.sin(a*Math.PI*8)*T*.3,e.fillStyle="rgba(139, 69, 19, 0.5)";for(let $t=0;$t<5;$t++){const on=(Math.random()-.5)*T*8,Mn=ce+(Math.random()-.5)*T*2;ye>.5&&e.fillRect(on,Mn,T*.5,T*.5)}break}const R=T*3*x*(y?1.3:1),F=T*5*x,X=-F/1.5,te=ce-R-T*2.5+ee;e.fillStyle=j,e.beginPath(),e.moveTo(X-T*.5,te+R*.5),e.quadraticCurveTo(X-T*3,te-T,X-T*2+He*T,te+R+T),e.fill();const pe=T*1.2*x,se=T*3*x,Se=T*2.5*x,ve=X+F*.8,q=X+F*.2;e.fillStyle=ie,e.fillRect(q,ce-Se,pe,Se+W[2]),e.fillRect(ve,ce-se,pe,se+W[0]),e.fillStyle=j,e.beginPath(),e.moveTo(X,te+R),e.lineTo(X,te+T),e.quadraticCurveTo(X+F/2,te,X+F,te+T),e.lineTo(X+F,te+R),e.fill(),e.fillStyle=j,e.fillRect(q+T/2,ce-Se,pe,Se+W[3]),e.fillRect(ve+T/2,ce-se,pe,se+W[1]);const ne=T*3.5*x,Fe=X+F-ne*.3+z,de=te-ne*.3+V;e.fillStyle=j,e.beginPath(),e.arc(Fe,de,ne/2,0,Math.PI*2),e.fill(),e.beginPath(),e.ellipse(Fe+ne*.4,de+ne*.2,T*1.5,T,0,0,Math.PI*2),e.fill(),m[1]>=0&&(e.fillStyle=_e,e.fillRect(Fe+T*.5,de-T*.5,T*.5,T*.5),c==="attacking"&&(e.fillStyle=Ce,e.fillRect(Fe+ne*.5,de+ne*.4,T,T*.4))),e.fillStyle=ie,e.beginPath(),e.moveTo(Fe-ne*.4,de-ne*.3),e.lineTo(Fe,de-ne*.7),e.lineTo(Fe,de-ne*.2),e.fill(),e.restore()}},nR=9;function iR(e,n){const{position:r,gender:o,age:l,decayProgress:a,food:c,radius:d,originalEntityType:h,geneCode:g}=n;if(e.save(),e.globalAlpha=1-a,h==="human"?jf.render(e,r.x-d,r.y-d,d*2,d*2,a,"dead",o,l,[0,0],!1,0):h==="prey"?Yv.render(e,r.x-d,r.y-d,d*2,d*2,a,"dead",{gender:o,age:l,direction:[0,0],isPregnant:!1,hungryLevel:0,geneCode:g||8405024}):h==="predator"&&jv.render(e,r.x-d,r.y-d,d*2,d*2,a,"dead",{gender:o,age:l,direction:[0,0],isPregnant:!1,hungryLevel:0,geneCode:g||8405024}),e.restore(),c.length>0){e.save(),e.font=`${nR}px Arial`,e.textAlign="center",e.textBaseline="middle";const m=At*.9,y=Math.PI/W0*3;c.forEach((S,E)=>{const I=E*y,T=r.x+m*Math.cos(I)*Math.atan2(E,E),C=r.y+m*Math.sin(I)*Math.atan2(E,E),U=B0[S.type];e.fillText(U,T,C)}),e.restore()}}function go(e,n,r,o,l,a,c,d){e.save(),e.fillStyle=c,e.fillRect(n,r,o,l),e.fillStyle=d,e.fillRect(n,r,o*Math.max(0,a),l),e.restore()}function rR(e,n,r,o,l,a){if(e.save(),o.length===0){e.restore();return}const c=o.length*l;let d;c>a||c+(o.length-1)*4>a?d=(a-c)/(o.length-1):d=4,o.length===1&&(d=0);for(let h=0;h<o.length;h++){const g=B0[o[h].type];e.fillText(g,n+h*(l+d),r)}e.restore()}function oR(e,n,r,o,l){const a=n.autopilotControls.hoveredAutopilotAction;if(!a)return;let c,d=At/2;const h=fu[a.action],g=Av[a.action],m=`${h} ${g}`;if("targetEntityId"in a){const y=n.entities.entities[a.targetEntityId];y&&(c=y.position,d=y.radius)}else"position"in a&&(c=a.position);if(c){Wv(e,c,d,Ff,Uf,2,r,o,l,n.mapDimensions),e.save(),e.font=`${Eo}px "Press Start 2P", Arial`,e.fillStyle="white",e.textAlign="center",e.textBaseline="bottom",e.shadowColor="black",e.shadowBlur=5;const{x:y,y:S}=mu(c,r,{width:o,height:l},n.mapDimensions),E=S-d-du-Eo/2;e.fillText(m,y,E),e.restore()}}function sR(e,n,r,o,l){e.save();const a=(Math.sin(l*Hf)+1)/2,c=r+du+a*5;e.strokeStyle=Ff,e.lineWidth=2,e.setLineDash(Uf),e.beginPath(),e.arc(n.x,n.y,c,0,Math.PI*2),e.stroke(),e.setLineDash([]);const d=fu[o],h=Av[o];if(d){e.font=`${Eo*1.5}px "Press Start 2P", Arial`,e.textAlign="center",e.textBaseline="middle";const g=n.y-c-25;e.fillText(d,n.x,g),e.font=`${Eo*.8}px "Press Start 2P", Arial`,e.fillText(h,n.x,g+25)}e.restore()}function aR(e,n,r){e.save();const o=30,l=70,a=3,c=l/a;for(let d=0;d<a;d++){const h=d*c,g=(r*o+h)%l,m=1-g/l;e.strokeStyle=`rgba(255, 215, 0, ${m*.7})`,e.lineWidth=1+(1-m)*2,e.beginPath(),e.arc(n.x,n.y,g,0,Math.PI*2),e.stroke()}e.restore()}function lR(e,n){const{activeAutopilotAction:r,behaviors:o}=n.autopilotControls,l=St(n);if(!l)return;const a=(c,d)=>{aR(c,d.position,n.time)};if(l.isCallingToFollow&&wn(e,n.mapDimensions.width,n.mapDimensions.height,a,{position:l.position}),o.followLeader&&!r&&wn(e,n.mapDimensions.width,n.mapDimensions.height,a,{position:l.position},70),r){let c,d=15;if("position"in r)c=r.position;else if("targetEntityId"in r){const h=n.entities.entities[r.targetEntityId];h&&(c=h.position,d=h.radius||30)}if(c&&r.action!==Re.AutopilotFollowMe&&!l.isCallingToFollow){const h=(g,m)=>{sR(g,m.position,d,r.action,n.time)};wn(e,n.mapDimensions.width,n.mapDimensions.height,h,{position:{...c}},c,d+30)}}}function Zm(e,n,r,o,l,a,c=!0){const d=n.split(" ");let h="";const g=[];for(let m=0;m<d.length;m++){const y=h+d[m]+" ";e.measureText(y).width>l&&m>0?(g.push(h),h=d[m]+" "):h=y}if(g.push(h),c)for(let m=0;m<g.length;m++)e.fillText(g[m],r,o+m*a);return g.length*a}function uR(e){return 1-Math.pow(1-e,3)}function cR(e,n,r,o){n.notificationButtonRects={dismiss:{},view:{}};const l=n.notifications.filter(c=>!c.isDismissed);if(l.length===0)return;e.save();let a=o-sw;for(const c of l){const d=r-Al-ur;e.font=`${Td}px "Press Start 2P", Arial`;const h=d+ur,g=Al-ur*2,m=Zm(e,c.message,-9999,-9999,g,Td*1.2,!1),y=ur*2+m+xn,S=a-y,E=Date.now()-c.creationTime,I=Math.min(E/ow,1),T=uR(I),C=o,U=C+(S-C)*T;e.fillStyle=JE,e.beginPath(),e.roundRect(d,U,Al,y,ZE),e.fill(),e.fillStyle=ew,e.textBaseline="top",Zm(e,c.message,h,U+ur,g,Td*1.2,!0);const H=U+y-xn-ur/2,O=d+Al-xn-ur/2,B={x:O,y:H,width:xn,height:xn};n.notificationButtonRects&&(n.notificationButtonRects.dismiss[c.id]=B);const x=n.hoveredButtonId===`notification-dismiss-${c.id}`;if(e.fillStyle=x?km:tw,e.font=`${xn}px Arial`,e.textAlign="center",e.textBaseline="middle",e.fillText("",B.x+B.width/2,B.y+B.height/2),c.targetEntityIds||c.targetPosition||c.targetArea||c.targetRadius){const ie={x:O-xn-Dm,y:H,width:xn,height:xn};n.notificationButtonRects&&(n.notificationButtonRects.view[c.id]=ie);const _e=n.hoveredButtonId===`notification-view-${c.id}`;e.fillStyle=_e?km:nw,e.font=`${xn*(_e?1.5:1.2)}px Arial`,e.fillText("",ie.x+ie.width/2,ie.y+ie.height/2)}a-=y+Dm}e.restore()}function dR(e){return e.length===0?0:e.reduce((r,o)=>r+o,0)/e.length}function bd(e,n,r,o,l,a,c,d){e.save(),e.fillStyle="rgba(255, 255, 255, 0.1)",e.fillRect(o,l,a,c),e.strokeStyle="#555",e.lineWidth=1,e.strokeRect(o,l,a,c);const h=dR(r);e.fillStyle="white",e.font="11px monospace",e.textAlign="left",e.fillText(`${n}: ${h.toFixed(2)}ms`,o+qe,l+qe+8);const g=Math.max(...r,1),m=r.map(y=>y/g*c);if(e.beginPath(),e.strokeStyle=d,e.lineWidth=2,m.length>1){e.moveTo(o,l+c-m[0]);for(let y=1;y<m.length;y++){const S=o+y/(m.length-1)*a,E=l+c-m[y];e.lineTo(S,E)}}else if(m.length===1){const y=l+c-m[0];e.moveTo(o,y),e.lineTo(o+a,y)}e.stroke(),e.fillStyle="rgba(255, 255, 255, 0.7)",e.font="10px monospace",e.textAlign="right",e.fillText(`${g.toFixed(2)}ms`,o+a-qe,l+qe+8),e.restore()}function fR(e,n,r){const{performanceMetrics:o}=n;if(!o)return;const l=280,a=240,c=r-l-qe,d=qe+pn*2;e.save(),e.fillStyle="rgba(0, 0, 0, 0.8)",e.fillRect(c,d,l,a),e.strokeStyle="#444",e.lineWidth=2,e.strokeRect(c,d,l,a),e.fillStyle="white",e.font="12px monospace",e.textAlign="left";let h=d+qe+5;const g=c+qe;e.fillStyle="#66ccff",e.font="bold 14px monospace",e.fillText(" Performance Debugger",g,h),h+=25,e.fillStyle="white",e.font="12px monospace";const m=hR(n);e.fillText(`FPS: ${m.toFixed(1)}`,g,h),h+=20;const y=l-qe*2,S=45,E=10;bd(e,"Render",xd(n,"renderTime"),g,h,y,S,"#4CAF50"),h+=S+E,bd(e,"World Update",xd(n,"worldUpdateTime"),g,h,y,S,"#2196F3"),h+=S+E,bd(e,"AI Update",xd(n,"aiUpdateTime"),g,h,y,S,"#FFC107"),e.fillStyle="#888",e.font="10px monospace",e.textAlign="center",e.fillText("Press '2' to toggle this panel",c+l/2,d+a-10),e.restore()}function hR(e){const{performanceMetrics:n}=e;if(!n||n.history.length===0)return 0;const r=n.history[n.history.length-1].bucketTime/(wt/_t);return n.history.filter(a=>r-a.bucketTime/(wt/_t)<1).length}function pR(e,n){if(e.length===0)return[];const r=new Map;for(const a of e){const c=Math.floor(a.bucketTime/(wt/_t));r.set(c,(r.get(c)||0)+a[n])}return Array.from(r.keys()).sort().map(a=>r.get(a)).slice(0,-1).slice(1).reverse()}function xd(e,n){return pR(e.performanceMetrics.history,n)}function Vf(e,n,r){if(!n.aiBlackboard)return;const o=n.aiBlackboard.nodeExecutionData,l=n.type==="human"?Fv:n.type==="predator"?Lv:n.type==="prey"?Uv:null;if(!l)return;e.save(),e.font=`${DE}px Arial`,e.textAlign="left",e.textBaseline="top";const a=S=>{switch(S){case w.SUCCESS:return ME;case w.FAILURE:return FE;case w.RUNNING:return UE;case w.NOT_EVALUATED:case null:default:return LE}},c=S=>{if(!S.name||!o[S.name])return{width:0,height:0};let E=0,I=0;const T=o[S.name],C=` ${S.name}`+(T!=null&&T.debugInfo?`: ${T.debugInfo}`:""),U=e.measureText(C).width,H=(S.depth??0)*Cm+8+U+Pm+Ss+20;if(E=Math.max(E,H),I+=Sd,S.children)for(const O of S.children){const B=c(O);E=Math.max(E,B.width),I+=B.height}else if(S.child){const O=c(S.child);E=Math.max(E,O.width),I+=O.height}return{width:E,height:I}},d=(S,E,I,T)=>{if(!S.name||!o[S.name])return E;let C=E;const U=o[S.name],H=I+2+(S.depth??0)*Cm;let O=w.NOT_EVALUATED,B=Rm,x="";if(U){O=U.status,x=U.debugInfo;const ie=BE/_t*wt,_e=r-U.lastExecuted,Ce=Math.max(0,1-_e/ie);B=zI(Rm,HE,Ce),_e>xs&&(O=w.NOT_EVALUATED)}const L=a(O);e.fillStyle=L,e.fillText("",H,C),e.fillStyle=B;const j=` ${S.name}`+(x?`: ${x}`:"");if(e.fillText(j,H+8,C),U&&U.executionHistory.length>0){const{executionHistory:ie}=U,_e=hv/_t*wt,Ce=r,xe=Ce-_e,Me=I+T-Ss-Pm;let we=Me;const ce=C+(Sd-yl)/2,He=ie.filter(X=>X.time<xe);let ye=He.length>0?He[He.length-1].status:null,ee=xe;const z=ie.filter(X=>X.time>=xe&&X.time<=Ce),V=Ss/_e;e.fillStyle="rgba(255, 255, 255, 0.1)",e.fillRect(Me,ce,Ss,yl);for(const X of z){const pe=(X.time-ee)*V;pe>0&&(e.fillStyle=a(ye),e.fillRect(we,ce,pe,yl),we+=pe),ye=X.status,ee=X.time}r-ee>xs&&(ye=w.NOT_EVALUATED);const R=(Ce-ee)*V;e.fillStyle=a(ye);const F=Me+Ss-we;e.fillRect(we,ce,Math.min(R,F),yl)}if(C+=Sd,S.children)for(const ie of S.children)C=d(ie,C,I,T);else S.child&&(C=d(S.child,C,I,T));return C},{width:h,height:g}=c(l);if(g===0){e.restore();return}const m=n.position.x+NE,y=n.position.y+OE-g/2;e.fillStyle=kE,e.fillRect(m,y,h,g+4),d(l,y+2,m,h),e.restore()}const gR={moving:"walk",gathering:"gathering",eating:"eat",feeding:"eat",procreating:"procreate",idle:"idle",attacking:"attacking",planting:"gathering"};function mR(e,n){var d;const{radius:r,position:o,activeAction:l="idle"}=n,a=((d=n.stateMachine)==null?void 0:d[0])||"N/A",c=n.isAdult?At+20:At*.6+20;e.save(),e.fillStyle="white",e.font="10px Arial",e.textAlign="center",e.fillText(`Action: ${l}`,o.x,o.y-c),e.fillText(`State: ${a}`,o.x,o.y-c+10),e.fillText(`HP: ${n.hitpoints}`,o.x,o.y-c+20),e.fillText(`Cooldown: ${n.attackCooldown||"N/A"}`,o.x,o.y-c+30),e.fillText(`Tribe: ${n.leaderId||"N/A"}`,o.x,o.y-c+40),e.restore(),e.beginPath(),e.arc(o.x,o.y,r,0,Math.PI*2),e.strokeStyle="rgba(255, 0, 0, 0.5)",e.lineWidth=1,e.stroke(),e.closePath()}function vR(e,n,r,o,l){e.save(),e.font=`${of}px Arial`,e.textAlign="center",e.textBaseline="middle",e.fillText(r,n.x,n.y-(o?At:No)-of-l),e.restore()}function yR(e,n,r,o,l){const a=n.x,c=n.y-r-o/2;e.save(),e.fillStyle=l,e.strokeStyle=l,e.lineWidth=1.5,e.beginPath(),e.rect(a-o/2,c,o,o/2),e.fill(),e.beginPath(),e.moveTo(a-o/2,c),e.lineTo(a-o/4,c-o/3),e.lineTo(a-o/6,c),e.moveTo(a-o/6,c),e.lineTo(a,c-o/2),e.lineTo(a+o/6,c),e.moveTo(a+o/6,c),e.lineTo(a+o/4,c-o/3),e.lineTo(a+o/2,c),e.stroke(),e.restore()}function SR(e,n,r){var d;const{position:o,radius:l}=n,a=o.x-yd/2,c=o.y-l-EE;if(((d=n.stateMachine)==null?void 0:d[0])===ji){const h=n.stateMachine[1],g=r-h.attackStartTime,m=Math.min(g/K0,1);go(e,a,c,yd,Im,m,ao,wE)}else if(n.attackCooldown&&n.attackCooldown>0){const h=1-n.attackCooldown/cu;go(e,a,c,yd,Im,h,ao,_E)}}function AR(e,n,r){const l="";e.save(),e.font="15px Arial",e.textAlign="center",e.textBaseline="bottom",e.shadowColor="black",e.shadowBlur=3,e.fillText(l,n.x,n.y-r),e.restore()}function TR(e,n,r=!1,o=!1,l=!1,a=!1,c=!1,d=!1,h=!1,g=!1,m,y){const{position:S,activeAction:E="idle"}=n,I=n.isAdult?At:At*.6,T=gR[E]||"idle";jf.render(e,S.x-I,S.y-I,I*2,I*2,n.animationProgress||0,T,n.gender,n.age,[n.direction.x,n.direction.y],n.isPregnant??!1,n.hunger),d&&(e.save(),e.strokeStyle=ov,e.lineWidth=2,e.beginPath(),e.arc(S.x,S.y,I+3,0,2*Math.PI),e.stroke(),e.restore());let C,U;if(c?(C=sE,U=rv):r?(C=oE,U=Mf):l?(C=aE,U=iE):o?(C=lE,U=nv):a&&(C=uE,U=iv),C&&U&&yR(e,S,I,C,U),n.tribeBadge&&vR(e,S,n.tribeBadge,n.isAdult??!1,C??0),h){let O=(n.isAdult?At:No)+5;C&&(O+=C),n.tribeBadge&&(O+=of),AR(e,S,O)}const H=g&&(y===void 0||n.id===y);H&&n.aiBlackboard&&Vf(e,n,m),SR(e,n,m),H&&mR(e,n)}const IR={grazing:"eat",moving:"walk",procreating:"procreate",feeding:"eat",idle:"idle"};function ER(e,n){var d;const{radius:r,position:o,activeAction:l="idle"}=n,a=((d=n.stateMachine)==null?void 0:d[0])||"N/A",c=n.isAdult?At+20:At*.6+20;e.save(),e.fillStyle="white",e.font="10px Arial",e.textAlign="center",e.fillText(`Action: ${l}`,o.x,o.y-c),e.fillText(`State: ${a}`,o.x,o.y-c+10),e.fillText(`HP: ${n.hitpoints}`,o.x,o.y-c+20),e.fillText(`Hunger: ${Math.round(n.hunger)}`,o.x,o.y-c+30),e.fillText(`Age: ${Math.round(n.age)}`,o.x,o.y-c+40),e.restore(),e.beginPath(),e.arc(o.x,o.y,r,0,Math.PI*2),e.strokeStyle="rgba(0, 255, 0, 0.5)",e.lineWidth=1,e.stroke(),e.closePath()}function wR(e,n,r=!1,o=0,l){var m,y;const{position:a,activeAction:c="idle"}=n,d=n.isAdult?n.radius:n.radius*.6,h=IR[c]||"idle";if(Yv.render(e,a.x-d,a.y-d,d*2,d*2,n.animationProgress||0,h,{gender:n.gender,age:n.age,direction:[((m=n.direction)==null?void 0:m.x)||1,((y=n.direction)==null?void 0:y.y)||0],isPregnant:n.isPregnant??!1,hungryLevel:n.hunger,geneCode:n.geneCode}),n.hitpoints<n.maxHitpoints){const S=d*1.5,E=3,I=a.x-S/2,T=a.y-d-8;e.fillStyle="#555",e.fillRect(I,T,S,E);const C=n.hitpoints/n.maxHitpoints;e.fillStyle=C>.5?"#4CAF50":C>.25?"#FFC107":"#F44336",e.fillRect(I,T,S*C,E)}const g=r&&(l===void 0||n.id===l);g&&n.aiBlackboard&&Vf(e,n,o),g&&ER(e,n)}const _R={attacking:"attacking",eating:"eat",moving:"walk",procreating:"procreate",feeding:"eat",idle:"idle"};function CR(e,n){var d;const{radius:r,position:o,activeAction:l="idle"}=n,a=((d=n.stateMachine)==null?void 0:d[0])||"N/A",c=n.isAdult?At+20:At*.6+20;e.save(),e.fillStyle="white",e.font="10px Arial",e.textAlign="center",e.fillText(`Action: ${l}`,o.x,o.y-c),e.fillText(`State: ${a}`,o.x,o.y-c+10),e.fillText(`HP: ${n.hitpoints}`,o.x,o.y-c+20),e.fillText(`Hunger: ${Math.round(n.hunger)}`,o.x,o.y-c+30),e.fillText(`Age: ${Math.round(n.age)}`,o.x,o.y-c+40),e.restore(),e.beginPath(),e.arc(o.x,o.y,r,0,Math.PI*2),e.strokeStyle="rgba(255, 0, 0, 0.5)",e.lineWidth=1,e.stroke(),e.closePath()}function RR(e,n,r=!1,o=0,l){var m,y;const{position:a,activeAction:c="idle"}=n,d=n.isAdult?n.radius:n.radius*.6,h=_R[c]||"idle";if(jv.render(e,a.x-d,a.y-d,d*2,d*2,n.animationProgress||0,h,{gender:n.gender,age:n.age,direction:[((m=n.direction)==null?void 0:m.x)||1,((y=n.direction)==null?void 0:y.y)||0],isPregnant:n.isPregnant??!1,hungryLevel:n.hunger,geneCode:n.geneCode}),n.hitpoints<n.maxHitpoints){const S=d*1.5,E=3,I=a.x-S/2,T=a.y-d-8;e.fillStyle="#555",e.fillRect(I,T,S,E);const C=n.hitpoints/n.maxHitpoints;e.fillStyle=C>.5?"#4CAF50":C>.25?"#FFC107":"#F44336",e.fillRect(I,T,S*C,E)}(n.attackCooldown&&n.attackCooldown>0||n.huntCooldown&&n.huntCooldown>0)&&(e.strokeStyle="#FF8C00",e.lineWidth=3,e.beginPath(),e.arc(a.x,a.y,d+3,0,2*Math.PI),e.stroke());const g=r&&(l===void 0||n.id===l);g&&n.aiBlackboard&&Vf(e,n,o),g&&CR(e,n)}const Vv=15;function Jm(e,n,r,o,l=1.5){const a=r-n.startTime,c=Math.min(a/n.duration,1),d=1-c,g=1+Math.sin(c*Math.PI*2)*(l-1),m=Vv*g;e.save(),e.globalAlpha=d,e.beginPath(),e.arc(n.position.x,n.position.y,Math.max(0,m),0,Math.PI*2),e.fillStyle=o,e.fill(),e.restore()}function no(e,n,r,o,l=2){const a=r-n.startTime,c=Math.min(a/n.duration,1),d=1-c,h=Vv*2*c;e.save(),e.globalAlpha=d,e.beginPath(),e.arc(n.position.x,n.position.y,h,0,Math.PI*2),e.strokeStyle=o,e.lineWidth=l,e.stroke(),e.restore()}function Ui(e,n,r,o){const l=r-n.startTime,a=Math.min(l/n.duration,1),c=1-a,d=-20*a;e.save(),e.globalAlpha=c,e.font="20px Arial",e.textAlign="center",e.fillText(o,n.position.x,n.position.y+d),e.restore()}function PR(e,n,r){switch(n.type){case le.Hunger:Jm(e,n,r,"rgba(255, 165, 0, 0.7)",1);break;case le.Procreation:Ui(e,n,r,"");break;case le.Pregnant:Jm(e,n,r,"rgba(255, 105, 180, 0.7)",1.2);break;case le.TargetAcquired:no(e,n,r,"rgba(255, 0, 0, 0.8)",3);break;case le.Attack:Ui(e,n,r,"");break;case le.Partnered:Ui(e,n,r,"");break;case le.BushClaimed:no(e,n,r,"rgba(0, 255, 0, 0.7)",2);break;case le.BushClaimLost:no(e,n,r,"rgba(128, 128, 128, 0.7)",2);break;case le.Eating:Ui(e,n,r,"");break;case le.ChildFed:Ui(e,n,r,"");break;case le.AttackDeflected:Ui(e,n,r,"");break;case le.AttackResisted:Ui(e,n,r,"");break;case le.Hit:Ui(e,n,r,"");break;case le.SeizeBuildup:no(e,n,r,"rgba(255, 215, 0, 0.8)",4);break;case le.Seize:no(e,n,r,"rgba(148, 0, 211, 0.8)",4);break;case le.CallToAttack:no(e,n,r,"rgba(255, 255, 0, 0.8)",4);break}}function e0(e,n,r,o,l,a,c){e.save();const{position:d}=n;e.strokeStyle=o,e.lineWidth=l+Math.sin(c*a)*(l/2),e.setLineDash([8,8]),e.beginPath(),e.arc(d.x,d.y,r,0,2*Math.PI),e.stroke(),e.restore()}function NR(e,n,r,o,l){const a=St(n),c=a?Rt(n,a):[],d=fi(c),{width:h,height:g}=n.mapDimensions;Object.values(n.entities.entities).sort((I,T)=>I.position.y-T.position.y||I.id-T.id).filter(I=>Ol(I,o,l,n.mapDimensions)).forEach(I=>{var T,C;if(I.type==="berryBush")wn(e,h,g,Z1,I,n,a,n.time);else if(I.type==="human"){const U=I,H=U.id===(a==null?void 0:a.id),O=c.some(Ce=>Ce.id===U.id),B=U.id===(d==null?void 0:d.id),x=a&&(U.id===a.motherId||U.id===a.fatherId),L=a&&(((T=U.partnerIds)==null?void 0:T.includes(a.id))||((C=a.partnerIds)==null?void 0:C.includes(U.id))),j=(a==null?void 0:a.attackTargetId)===U.id,ie=U.leaderId?n.entities.entities[U.leaderId]:void 0,_e=a?U.leaderId===a.id&&U.activeAction==="moving"&&U.target===U.leaderId&&(ie==null?void 0:ie.isCallingToFollow):!1;wn(e,h,g,TR,U,H,x,O,L,B,j,_e,r,n.time,n.debugCharacterId)}else I.type==="corpse"?wn(e,h,g,iR,I):I.type==="prey"?wn(e,h,g,wR,I,r,n.time,n.debugCharacterId):I.type==="predator"&&wn(e,h,g,RR,I,r,n.time,n.debugCharacterId)}),n.visualEffects.filter(I=>Ol(I,o,l,n.mapDimensions)).forEach(I=>{wn(e,h,g,PR,I,n.time)});const E=n.notifications.filter(I=>!I.isDismissed);for(const I of E)if(I.highlightedEntityIds&&I.renderHighlights)for(const T of I.highlightedEntityIds){const C=n.entities.entities[T];C&&Ol(C,o,l,n.mapDimensions)&&wn(e,h,g,e0,C,aw,lw,cw,uw,n.time)}if(n.tutorialState.isActive&&n.tutorialState.highlightedEntityIds.length>0)for(const I of n.tutorialState.highlightedEntityIds){const T=n.entities.entities[I];T&&Ol(T,o,l,n.mapDimensions)&&wn(e,h,g,e0,T,XE,pv,gv,Hf,n.time)}}function OR(e,n,r,o,l,a){let c=null,d=null;e.textAlign="left";let h=qe+pn;const m=n.time/(wt/_t)/uu%1,y=As[io.Time],S=25,E=qe+S;e.fillText(y,qe,h+tn/2+pn/3),go(e,E,h,Mi,tn,m,ao,mE),h+=tn+ni;const I=h+ar/2,T=h+(ar-tn)/2,C=5;Qs(e,{x:qe*2,y:I},ar,5,r.gender,!1,!1,!1);const U=qe+ar+C,H=Mi+S-(ar+C)*2;go(e,U,T,H,tn,Math.floor(r.age)/$s,ao,gE),Qs(e,{x:U+H+C+ar/2,y:I},ar,$s,r.gender,!1,!1,!1),h+=tn+ni*2;const O=[],B=new Set;if(O.push({member:r,isPlayer:!0,isHeir:!1,isPartner:!1,isParent:!1}),B.add(r.id),o&&!B.has(o.id)&&(O.push({member:o,isPlayer:!1,isHeir:!0,isPartner:!1,isParent:!1}),B.add(o.id)),l.forEach(ce=>{B.has(ce.id)||(O.push({member:ce,isPlayer:!1,isHeir:!1,isPartner:!0,isParent:!1}),B.add(ce.id))}),a.forEach(ce=>{B.has(ce.id)||(O.push({member:ce,isPlayer:!1,isHeir:!1,isPartner:!1,isParent:!1}),B.add(ce.id))}),r.motherId&&!B.has(r.motherId)){const ce=n.entities.entities[r.motherId];ce&&(O.push({member:ce,isPlayer:!1,isHeir:!1,isPartner:!1,isParent:!0}),B.add(ce.id))}if(r.fatherId&&!B.has(r.fatherId)){const ce=n.entities.entities[r.fatherId];ce&&(O.push({member:ce,isPlayer:!1,isHeir:!1,isPartner:!1,isParent:!0}),B.add(ce.id))}const x=As[io.Family],L=10,j=qe+pn+L,ie=Mi+S-(pn+L),_e=h+gl/2;e.font=`${pn}px "Press Start 2P", Arial`,e.textBaseline="middle",e.fillText(x,qe,_e);const Ce=h+gl/2;j1(e,j,Ce,O,gl,ie),h+=gl+ni,e.textBaseline="alphabetic";const xe=As[io.Hitpoints];e.fillText(xe,qe,h+tn/2+pn/3),go(e,E,h,Mi,tn,r.hitpoints/r.maxHitpoints,ao,pE),h+=tn+ni;const Me=As[io.Hunger];e.fillText(Me,qe,h+tn/2+pn/3),go(e,E,h,Mi,tn,(Er-r.hunger)/Er,ao,hE),c={x:qe,y:h-ni/2,width:Mi+S,height:tn+ni},h+=tn+ni,e.textBaseline="middle";const we=As[io.Food];return e.fillText(we,qe,h+pl/2),rR(e,E,h+pl/2,r.food,pl,Mi),d={x:qe,y:h-ni/5,width:Mi+S,height:pl+ni},e.textBaseline="alphabetic",{hungerBarRect:c,foodBarRect:d}}let ws=[],t0=0;const DR=36,kR=200;function MR(e,n,r,o){const l=n.search.prey.count(),a=n.search.predator.count(),c=n.search.berryBush.count();n.time-t0>=DR&&(ws.push({time:n.time,prey:l,predators:a,bushes:c}),ws.length>kR&&(ws=ws.slice(-200)),t0=n.time);const d=et*tt,h=l/d*1e6,g=a/d*1e6,m=c/d*1e6,y=N1(),S=Math.floor(n.time/(24*365)),E=Math.floor(n.time%(24*365)/24),I=Math.floor(n.time%24),T=400,C=Math.min(o*.8,600),U=r-T-10,H=qe+pn*2;e.save(),e.fillStyle="rgba(0, 0, 0, 0.9)",e.fillRect(U,H,T,C),e.strokeStyle="#444",e.lineWidth=2,e.strokeRect(U,H,T,C),e.fillStyle="white",e.font="12px monospace",e.textAlign="left";let O=H+20;const B=14,x=U+15;e.fillStyle="#66ccff",e.font="bold 14px monospace",e.fillText(" Ecosystem Debugger",x,O),O+=25,e.fillStyle="white",e.font="12px monospace",e.fillText(`Game Time: Year ${S}, Day ${E}, Hour ${I}`,x,O),O+=B,e.fillText(`Map Size: ${et}  ${tt} pixels`,x,O),O+=20,e.fillStyle="#66ccff",e.font="bold 13px monospace",e.fillText(" Q-Learning Status",x,O),O+=18,y&&(e.fillText(`Q-Table Size: ${y.qTableSize} entries`,x,O),O+=B,e.fillText(`Exploration Rate: ${(y.explorationRate*100).toFixed(1)}%`,x,O),O+=B);const L=ws.slice(-20);L.length>1&&(e.fillStyle="#66ccff",e.font="bold 13px monospace",e.fillText(" Population Trends (Last 20 Points)",x,O),O+=30,FR(e,x,O,L),O+=50),e.fillStyle="#66ccff",e.font="bold 13px monospace",e.fillText(" Density (per 1000 px)",x,O),O+=18,e.fillStyle="white",e.font="12px monospace";const j=(ai/d*1e6).toFixed(2),ie=(li/d*1e6).toFixed(2),_e=(ui/d*1e6).toFixed(2);e.fillText(`Prey: ${h.toFixed(2)} (target: ${j})`,x,O),O+=B,e.fillText(`Predators: ${g.toFixed(2)} (target: ${ie})`,x,O),O+=B,e.fillText(`Bushes: ${m.toFixed(2)} (target: ${_e})`,x,O),O+=20,e.fillStyle="#66ccff",e.font="bold 13px monospace",e.fillText(" Current Population Status",x,O),O+=18,e.fillStyle="white",e.font="12px monospace";const Ce=Math.round(l/ai*100),xe=Math.round(a/li*100),Me=Math.round(c/ui*100),we=ce=>ce<50?"#ff4444":ce<80?"#ffaa44":ce>120?"#44aaff":"#44ff44";e.fillStyle=we(Ce),e.fillText(`Prey: ${l}/${ai} (${Ce}%)`,x,O),O+=B,e.fillStyle=we(xe),e.fillText(`Predators: ${a}/${li} (${xe}%)`,x,O),O+=B,e.fillStyle=we(Me),e.fillText(`Bushes: ${c}/${ui} (${Me}%)`,x,O),O+=20,e.fillStyle="#66ccff",e.font="bold 13px monospace",e.fillText(" Current Parameters",x,O),O+=18,e.fillStyle="white",e.font="10px monospace",e.fillText("Prey:",x,O),O+=13,e.fillText(` Gestation: ${n.ecosystem.preyGestationPeriod.toFixed(1)}h`,x,O),O+=11,e.fillText(` Procreation: ${n.ecosystem.preyProcreationCooldown.toFixed(1)}h`,x,O),O+=11,e.fillText(` Hunger: ${n.ecosystem.preyHungerIncreasePerHour.toFixed(1)}/h`,x,O),O+=13,e.fillText("Predators:",x,O),O+=13,e.fillText(` Gestation: ${n.ecosystem.predatorGestationPeriod.toFixed(1)}h`,x,O),O+=11,e.fillText(` Procreation: ${n.ecosystem.predatorProcreationCooldown.toFixed(1)}h`,x,O),O+=11,e.fillText(` Hunger: ${n.ecosystem.predatorHungerIncreasePerHour.toFixed(1)}/h`,x,O),O+=13,e.fillText("Bushes:",x,O),O+=13,e.fillText(` Spread Chance: ${(n.ecosystem.berryBushSpreadChance*100).toFixed(1)}%`,x,O),O+=15,e.fillStyle="#888",e.font="10px monospace",e.textAlign="center",e.fillText("Press '1' to toggle this debugger",U+T/2,H+C-10),e.restore()}function FR(e,n,r,o){if(o.length<2)return;const d={prey:Math.max(...o.map(g=>g.prey),ai),predators:Math.max(...o.map(g=>g.predators),li),bushes:Math.max(...o.map(g=>g.bushes),ui)};[{data:o.map(g=>g.prey),color:"#44ff44",label:"Prey",target:ai,max:d.prey},{data:o.map(g=>g.predators),color:"#ff4444",label:"Predators",target:li,max:d.predators},{data:o.map(g=>g.bushes),color:"#ffaa44",label:"Bushes",target:ui,max:d.bushes}].forEach((g,m)=>{const y=n+m*115,S=r;e.fillStyle=g.color,e.font="10px monospace",e.fillText(g.label,y,S-5),e.strokeStyle="#333",e.lineWidth=1,e.strokeRect(y,S,100,30),e.beginPath(),e.strokeStyle=g.color;for(let I=0;I<g.data.length;I++){const T=y+I/(g.data.length-1)*100,C=S+30-g.data[I]/g.max*30;I===0?e.moveTo(T,C):e.lineTo(T,C)}e.stroke(),e.beginPath(),e.strokeStyle="#888",e.setLineDash([2,2]);const E=S+30-g.target/g.max*30;e.moveTo(y,E),e.lineTo(y+100,E),e.stroke(),e.setLineDash([])})}function n0(e,n,r){e.save();const{x:o,y:l,width:a,height:c}=n.rect,d=av;if(e.beginPath(),e.moveTo(o+d,l),e.lineTo(o+a-d,l),e.quadraticCurveTo(o+a,l,o+a,l+d),e.lineTo(o+a,l+c-d),e.quadraticCurveTo(o+a,l+c,o+a-d,l+c),e.lineTo(o+d,l+c),e.quadraticCurveTo(o,l+c,o,l+c-d),e.lineTo(o,l+d),e.quadraticCurveTo(o,l,o+d,l),e.closePath(),e.fillStyle=n.isDisabled?lv:n.backgroundColor,e.fill(),n.activated){e.save();const h=(Math.sin(Date.now()/1e3*fv)+1)/2;e.strokeStyle=dv,e.lineWidth=2+h*2,e.globalAlpha=.7+h*.3,e.stroke(),e.restore()}if(n.lastActivated){const h=Date.now()-n.lastActivated;if(h<Kl){const g=1-h/Kl;e.fillStyle=cv,e.globalAlpha=g,e.fill(),e.globalAlpha=1}}r&&!n.isDisabled&&(e.fillStyle=Lf,e.globalAlpha=.5,e.fill(),e.globalAlpha=1),e.fillStyle=n.isDisabled?uv:n.textColor,n.icon?(e.font=`${c*.55}px "Press Start 2P", Arial`,e.textAlign="center",e.textBaseline="middle",e.fillText(n.icon,o+a/2,l+c/2),n.text&&(e.font=`${c*.18}px "Press Start 2P", Arial`,e.textAlign="right",e.textBaseline="bottom",e.fillText(n.text,o+a-4,l+c-2))):(e.font=`${pn*1.5}px "Press Start 2P", Arial`,e.textAlign="center",e.textBaseline="middle",e.fillText(n.text,o+a/2,l+c/2)),e.restore()}function UR(e,n,r,o){e.save(),e.fillStyle="rgba(0, 0, 0, 0.6)",e.fillRect(0,0,r,o);const l=500,a=150,c=(r-l)/2,d=(o-a)/2;e.fillStyle=rn,e.font=`${pn*1.1}px "Press Start 2P", Arial`,e.textAlign="center",e.textBaseline="middle",e.fillText("Are you sure you want to exit",r/2,d+a/3-10),e.fillText("to the main menu?",r/2,d+a/3+10);const h=_n*1.5,g=sv,m=d+a-g-qe*2,y=20,S=h*2+y,E=c+(l-S)/2,I={id:"confirmExitYes",action:Te.ConfirmExitYes,rect:{x:E,y:m,width:h,height:g},text:"Yes",backgroundColor:oi,textColor:rn,currentWidth:h},T=E+h+y,C={id:"confirmExitNo",action:Te.ConfirmExitNo,rect:{x:T,y:m,width:h,height:g},text:"No",backgroundColor:oi,textColor:rn,currentWidth:h};n.uiButtons.push(I,C),n0(e,I,n.hoveredButtonId===I.id),n0(e,C,n.hoveredButtonId===C.id),e.restore()}function Jl(e,n,r,o,l,a=!1){var d;if(e.save(),e.clearRect(0,0,e.canvas.width,e.canvas.height),e.fillStyle="#2c5234",e.fillRect(0,0,e.canvas.width,e.canvas.height),e.translate(e.canvas.width/2-r.x,e.canvas.height/2-r.y),!a&&n.gameOver){e.restore(),q1(e,n);return}NR(e,n,n.debugPanel===Kt.General,r,l);const c=n.notifications.filter(h=>!h.isDismissed);for(const h of c){const g=(Math.sin(n.time*rw)+1)/2;e.globalAlpha=g*.5+.25,e.fillStyle=iw,h.targetArea&&e.fillRect(h.targetArea.x,h.targetArea.y,h.targetArea.width,h.targetArea.height),h.targetRadius&&(e.beginPath(),e.arc(h.targetRadius.x,h.targetRadius.y,h.targetRadius.radius,0,Math.PI*2),e.fill())}if(e.globalAlpha=1,lR(e,n),e.restore(),!a){e.fillStyle=cE,e.font=`${pn}px "Press Start 2P", Arial`,e.shadowColor=dE,e.shadowBlur=fE,n.uiButtons=[];const h=St(n);let g=null,m=null;if(h){const E=Rt(n,h),I=fi(E),T=((d=h.partnerIds)==null?void 0:d.map(U=>n.entities.entities[U]).filter(U=>U!==void 0))||[],C=OR(e,n,h,I,T,E);g=C.hungerBarRect,m=C.foodBarRect}const y=J0(n,h==null?void 0:h.leaderId);V1(e,n,y,e.canvas.width,e.canvas.height);const{commandButtonsRect:S}=F1(e,n,e.canvas.width);if(e.shadowColor="transparent",e.shadowBlur=0,h&&(oR(e,n,r,e.canvas.width,e.canvas.height),o.length>0&&B1(e,o,h,r,e.canvas.width,e.canvas.height,n.mapDimensions)),n.tutorialState.activeUIHighlights.length>0){const{activeUIHighlights:E}=n.tutorialState;E.includes(Ir.HUNGER_BAR)&&g&&Bd(e,g,n.time),E.includes(Ir.FOOD_BAR)&&m&&Bd(e,m,n.time),E.includes(Ir.COMMAND_BUTTONS)&&S&&Bd(e,S,n.time)}if(n.tutorialState.isActive){const E=K1(e,n,e.canvas.width,e.canvas.height);E&&n.uiButtons.push({id:"tutorial-dismiss",action:Te.DismissTutorial,rect:E,text:"",currentWidth:E.width,backgroundColor:"transparent",textColor:"transparent"})}switch(cR(e,n,e.canvas.width,e.canvas.height),n.debugPanel){case Kt.Ecosystem:MR(e,n,e.canvas.width,e.canvas.height);break;case Kt.Performance:fR(e,n,l.width);break}n.isPaused&&n.exitConfirmation!=="pending"&&U1(e),n.exitConfirmation==="pending"&&UR(e,n,e.canvas.width,e.canvas.height)}}const LR=mn.div`
  position: relative;
  width: 100vw;
  height: 100vh;
  overflow: hidden;
`,HR=mn.canvas`
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background-color: #2c5234;
`,BR=mn.div`
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  text-align: center;
  z-index: 1;
  background: linear-gradient(to bottom, rgba(0, 0, 0, 0.7) 0%, rgba(0, 0, 0, 0) 50%, rgba(0, 0, 0, 0.7) 100%);
`,GR=mn.h1`
  font-family: 'Press Start 2P', cursive;
  font-size: 4rem;
  color: #fff;
  text-shadow: 4px 4px 0px #ff0000;
  margin-bottom: 2rem;
`,i0=mn.button`
  font-family: 'Press Start 2P', cursive;
  font-size: 1.5rem;
  padding: 1rem 2rem;
  color: #fff;
  background-color: #ff0000;
  border: 2px solid #fff;
  box-shadow: 4px 4px 0px #fff;
  cursor: pointer;
  transition: all 0.2s ease-in-out;

  &:hover {
    background-color: #fff;
    color: #ff0000;
    box-shadow: 4px 4px 0px #ff0000;
  }
`,bR=mn.div`
  display: flex;
  flex-direction: column;
  gap: 1.5rem;
  align-items: center;
`,xR=mn.div`
  position: absolute;
  bottom: 1rem;
  font-family: 'Press Start 2P', cursive;
  font-size: 0.8rem;
  color: #fff;
  text-shadow: 2px 2px 0px #000;
  a {
    color: #fff;
    text-decoration: none;
    &:hover {
      text-decoration: underline;
    }
  }
`,Ml="intro-soundtrack",r0=()=>{const{setAppState:e,savedGameState:n,clearCurrentSave:r}=Ro(),o=Ie.useRef(null),l=Ie.useRef(null),a=Ie.useRef($C()),c=Ie.useRef(),d=Ie.useRef(a.current.viewportCenter),h=Ie.useRef(),g=Ie.useCallback(()=>{_d(Ml,2),r(),e("game")},[e,r]),m=Ie.useCallback(()=>{n&&(_d(Ml,2),e("game"))},[e,n]);Ie.useEffect(()=>{const E=I=>{(I.key==="Enter"||I.key===" ")&&(n?m():g())};return window.addEventListener("keydown",E),()=>{window.removeEventListener("keydown",E)}},[g,m,n]),Ie.useEffect(()=>(Gf(Ee.SoundTrack1,{loop:!0,trackId:Ml}),()=>{_d(Ml,2)}),[]),Ie.useEffect(()=>{const E=o.current;if(!E)return;l.current=E.getContext("2d");const I=()=>{E&&l.current&&(E.width=window.innerWidth,E.height=window.innerHeight,Jl(l.current,a.current,d.current,[],{width:E.width,height:E.height},!0))};return I(),window.addEventListener("resize",I),()=>window.removeEventListener("resize",I)},[]),Ie.useEffect(()=>{const E=()=>{const T=XI(a.current);if(T.length>0){const C=Math.floor(Math.random()*T.length);h.current=T[C].id}};E();const I=setInterval(E,ST);return()=>clearInterval(I)},[]);const[y,S]=U0(E=>{var C,U;if(!l.current)return;if(c.current===void 0){c.current=E;return}const I=Math.min((E-c.current)/1e3,1);a.current=gu(a.current,I);const T=h.current?a.current.entities.entities[h.current]:void 0;if(T){const{mapDimensions:H}=a.current,{width:O,height:B}=H;let x={...T.position};const L=x.x-d.current.x;Math.abs(L)>O/2&&(L>0?x.x-=O:x.x+=O);const j=x.y-d.current.y;Math.abs(j)>B/2&&(j>0?x.y-=B:x.y+=B);let ie=Pf(d.current,x,Tf*I);ie={x:(ie.x%O+O)%O,y:(ie.y%B+B)%B},d.current=ie}Jl(l.current,a.current,d.current,[],{width:((C=o.current)==null?void 0:C.width)||800,height:((U=o.current)==null?void 0:U.height)||600},!0),c.current=E});return Ie.useEffect(()=>(S(),y),[S,y]),De.jsxs(LR,{children:[De.jsx(HR,{ref:o}),De.jsxs(BR,{children:[De.jsx(GR,{children:"Tribe2"}),De.jsxs(bR,{children:[De.jsx(i0,{onClick:g,children:"New Game"}),n&&De.jsx(i0,{onClick:m,children:"Load Game"})]}),De.jsxs(xR,{children:["by"," ",De.jsx("a",{href:"https://github.com/gtanczyk",target:"_blank",rel:"noopener noreferrer",children:"gtanczyk"})]})]})]})};function $R(){console.log("Tribe game initialized with detailed 2D world state.");const e=xC();return e.ecosystem={preyGestationPeriod:vr,preyProcreationCooldown:yr,predatorGestationPeriod:Sr,predatorProcreationCooldown:Ar,preyHungerIncreasePerHour:bi,predatorHungerIncreasePerHour:xi,berryBushSpreadChance:ci},e.debugPanel=Kt.None,e.performanceMetrics={currentBucket:{renderTime:0,worldUpdateTime:0,aiUpdateTime:0},history:[]},e}const zR=({canvasRef:e,ctxRef:n,gameStateRef:r,viewportCenterRef:o,playerActionHintsRef:l})=>(Ie.useEffect(()=>{const a=e.current;if(!a)return;n.current=a.getContext("2d");const c=()=>{a&&n.current&&r.current&&(a.width=window.innerWidth,a.height=window.innerHeight,Jl(n.current,r.current,o.current,l.current,{width:a.width,height:a.height},!1))};return c(),window.addEventListener("resize",c),()=>window.removeEventListener("resize",c)},[]),De.jsx("canvas",{ref:e,style:{display:"block",background:"#2c5234"}})),WR=(e,n,r)=>{let o;const l=KI(e,r);if(l)if(n.isAdult&&l.type==="berryBush"&&l.food.length>0)o={action:Re.AutopilotGather,targetEntityId:l.id};else if(n.isAdult&&l.type==="corpse"&&l.food.length>0)o={action:Re.AutopilotGather,targetEntityId:l.id};else if(l.type==="human"){const a=l;n.isAdult&&Oo(n,a,r)?o={action:Re.AutopilotAttack,targetEntityId:a.id}:Rr(n,a,r)?o={action:Re.AutopilotProcreate,targetEntityId:a.id}:n.food.length>0&&!a.isAdult&&(a.motherId===n.id||a.fatherId===n.id)&&(o={action:Re.AutopilotFeedChild,targetEntityId:a.id})}else l.type==="prey"?o={action:Re.AutopilotAttack,targetEntityId:l.id}:l.type==="predator"&&(o={action:Re.AutopilotAttack,targetEntityId:l.id});else r.autopilotControls.isManuallyPlanting&&n.food.filter(a=>a.type===di.Berry).length>=bs&&Df(e,r,1,lu,n.id)?o={action:Re.AutopilotPlant,position:e}:o={action:Re.AutopilotMove,position:e};return o},YR=(e,n)=>{if(e.isPaused||!St(e))return;const o=e.autopilotControls.hoveredAutopilotAction;e.autopilotControls.activeAutopilotAction=void 0,o?(e.autopilotControls.activeAutopilotAction=o,(o.action===Re.AutopilotMove||o.action===Re.AutopilotGather)&&(e.hasPlayerMovedEver=!0),o.action===Re.AutopilotPlant&&(e.hasPlayerPlantedBush=!0)):e.autopilotControls.activeAutopilotAction={action:Re.AutopilotMove,position:n},e.autopilotControls.isManuallyMoving=!1,e.autopilotControls.isManuallyPlanting=!1},jR=(e,n)=>{var c,d,h,g;const r=e.key.toLowerCase(),o=e.ctrlKey||e.metaKey;let l=!0,a=n;if(o){switch(r){case"s":tu(n);break;case"a":n.autosaveEnabled=!n.autosaveEnabled;break;default:l=!1;break}return{newState:a,handled:l}}switch(r){case"escape":const{autopilotControls:m}=n;m.activeAutopilotAction||m.isManuallyMoving||m.isManuallyPlanting?(m.activeAutopilotAction=void 0,m.isManuallyMoving=!1,m.isManuallyPlanting=!1):a.exitConfirmation==="pending"?(a.exitConfirmation="inactive",a.isPaused=!1):(a.exitConfirmation="pending",a.isPaused=!0);break;case"m":n.isMuted=!n.isMuted,ks(n.masterVolume,n.isMuted);break;case"=":case"+":const y=Math.min(1,n.masterVolume+.1);n.masterVolume=parseFloat(y.toFixed(1)),ks(n.masterVolume,n.isMuted);break;case"-":const S=Math.max(0,n.masterVolume-.1);n.masterVolume=parseFloat(S.toFixed(1)),ks(n.masterVolume,n.isMuted);break;case"t":a=gu(n,Sv);break;case" ":case"p":n.isPaused=!n.isPaused;break;case"":case"`":a.debugPanel===Kt.General?(a.debugPanel=Kt.None,a.debugCharacterId=void 0):(a.debugPanel=Kt.General,a.debugCharacterId||(a.debugCharacterId=((c=St(a))==null?void 0:c.id)??((d=Object.values(a.entities.entities).find(I=>I.type==="human"||I.type==="prey"||I.type==="predator"))==null?void 0:d.id)));break;case"1":a.debugPanel=Kt.Ecosystem,a.debugCharacterId||(a.debugCharacterId=((h=St(a))==null?void 0:h.id)??((g=Object.values(a.entities.entities).find(I=>I.type==="human"||I.type==="prey"||I.type==="predator"))==null?void 0:g.id));break;case"2":a.debugPanel=Kt.Performance;break;case"3":a.debugPanel=Kt.Ecosystem;break;case"tab":a.debugPanel=Kt.General;const E=Object.values(a.entities.entities).filter(I=>I.type==="human"||I.type==="prey"||I.type==="predator");if(E.length>0){const I=E.sort((H,O)=>{if(H.type==="human"&&H.isPlayer)return-1;if(O.type==="human"&&O.isPlayer)return 1;if(H.type!==O.type){const B={human:0,prey:1,predator:2},x=B[H.type]??999,L=B[O.type]??999;return x-L}return H.id-O.id}),T=a.debugCharacterId,U=((T?I.findIndex(H=>H.id===T):-1)+1)%I.length;a.debugCharacterId=I[U].id}else a.debugCharacterId=void 0;break;default:l=!1;break}return{newState:a,handled:l}},VR=(e,n,r,o,l)=>{const a={gameState:r};if(n&&["e","b","r","h"].includes(e)&&r.hasPlayerEnabledAutopilot++,e==="e"){if(n){r.autopilotControls.behaviors.gathering=!r.autopilotControls.behaviors.gathering;return}const c=ke(o,r,"berryBush",yt,g=>g.food.length>0&&o.food.length<o.maxFood),d=ke(o,r,"corpse",yt,g=>g.food.length>0&&o.food.length<o.maxFood);let h=null;c&&d?h=K(o.position,c.position,r.mapDimensions.width,r.mapDimensions.height)<=K(o.position,d.position,r.mapDimensions.width,r.mapDimensions.height)?c:d:h=c||d,h&&(o.activeAction="gathering",Ue(a,Ee.Gather,o.position))}else if(e==="r"){if(n){r.autopilotControls.behaviors.procreation=!r.autopilotControls.behaviors.procreation;return}ke(o,r,"human",yt,d=>Rr(o,d,r))&&(o.activeAction="procreating",Ue(a,Ee.Procreate,o.position))}else if(e==="f")o.food.length>0&&(o.activeAction="eating",Ue(a,Ee.Eat,o.position));else if(e==="h"){if(n){r.autopilotControls.behaviors.feedChildren=!r.autopilotControls.behaviors.feedChildren;return}const c=l.find(d=>d.type===Re.FeedChild);c&&c.targetEntity&&(o.activeAction="feeding",o.target=c.targetEntity.id)}else if(e==="arrowup"||e==="w")o.direction.y=-1,o.activeAction="moving",o.target=void 0,r.hasPlayerMovedEver=!0,r.autopilotControls.isManuallyMoving=!0,r.autopilotControls.activeAutopilotAction=void 0;else if(e==="arrowdown"||e==="s")o.direction.y=1,o.activeAction="moving",o.target=void 0,r.hasPlayerMovedEver=!0,r.autopilotControls.isManuallyMoving=!0,r.autopilotControls.activeAutopilotAction=void 0;else if(e==="arrowleft"||e==="a")o.direction.x=-1,o.activeAction="moving",o.target=void 0,r.hasPlayerMovedEver=!0,r.autopilotControls.isManuallyMoving=!0,r.autopilotControls.activeAutopilotAction=void 0;else if(e==="arrowright"||e==="d")o.direction.x=1,o.activeAction="moving",o.target=void 0,r.hasPlayerMovedEver=!0,r.autopilotControls.isManuallyMoving=!0,r.autopilotControls.activeAutopilotAction=void 0;else if(e==="q"){if(n){r.autopilotControls.behaviors.attack=!r.autopilotControls.behaviors.attack;return}const c=ke(o,r,"human",Yn,d=>Oo(o,d,r))??ke(o,r,"predator",Yn)??ke(o,r,"prey",Yn);c&&(o.activeAction="attacking",o.attackTargetId=c.id)}else if(e==="b"){if(n){r.autopilotControls.behaviors.planting=!r.autopilotControls.behaviors.planting;return}if(l.find(d=>d.type===Re.Plant)){const d=Df(o.position,r,50,ef);d&&(o.activeAction="planting",o.target=d,r.hasPlayerPlantedBush=!0)}}else e==="v"?(o.isCallingToAttack=!0,o.callToAttackEndTime=r.time+wo,Pe(r,le.CallToAttack,o.position,wo),Ue(a,Ee.CallToAttack,o.position)):e==="c"?(o.isCallingToFollow=!0,o.callToFollowEndTime=r.time+Ws,Pe(r,le.CallToFollow,o.position,Ws),Ue(a,Ee.CallToFollow,o.position)):e==="k"&&xf(o,r)},XR=(e,n,r,o)=>{e==="arrowup"||e==="w"||e==="arrowdown"||e==="s"?n.direction.y=0:(e==="arrowleft"||e==="a"||e==="arrowright"||e==="d")&&(n.direction.x=0),!o.current.has("arrowup")&&!o.current.has("arrowdown")&&!o.current.has("arrowleft")&&!o.current.has("arrowright")&&!o.current.has("w")&&!o.current.has("a")&&!o.current.has("s")&&!o.current.has("d")&&(n.activeAction==="moving"&&(n.activeAction="idle"),r.autopilotControls.isManuallyMoving=!1),!o.current.has("e")&&n.activeAction==="gathering"&&(n.activeAction="idle"),!o.current.has("f")&&n.activeAction==="eating"&&(n.activeAction="idle"),!o.current.has("r")&&n.activeAction==="procreating"&&(n.activeAction="idle"),!o.current.has("h")&&n.activeAction==="feeding"&&(n.activeAction="idle")},KR=(e,n,r)=>{let l=St(e);if(e.debugCharacterId){const a=e.entities.entities[e.debugCharacterId];a&&"position"in a&&(l=a)}if(l){const{mapDimensions:a}=e,{width:c,height:d}=a;let h={...l.position};const g=h.x-n.x;Math.abs(g)>c/2&&(g>0?h.x-=c:h.x+=c);const m=h.y-n.y;Math.abs(m)>d/2&&(m>0?h.y-=d:h.y+=d);let y=Pf(n,h,Tf*r);return y={x:(y.x%c+c)%c,y:(y.y%d+d)%d},y}return e.viewportCenter};function qR(e,n){const{width:r,height:o}=e.mapDimensions;e.viewportCenter={x:(n.x%r+r)%r,y:(n.y%o+o)%o}}const QR=(e,n,r,o)=>{const l={gameState:r},a=St(r);a&&Ue(l,Ee.ButtonClick,a.position);const c=r.uiButtons.find(h=>h.id===e.id);c&&(c.lastActivated=Date.now()),n&&[Te.CommandGather,Te.CommandPlant,Te.ToggleProcreationBehavior].includes(e.action)&&r.hasPlayerEnabledAutopilot++;const{behaviors:d}=r.autopilotControls;switch(e.action){case Te.ReturnToIntro:r.exitConfirmation="pending",r.isPaused=!0;break;case Te.ConfirmExitYes:o(),r.exitConfirmation="inactive";break;case Te.ConfirmExitNo:r.exitConfirmation="inactive",r.isPaused=!1;break;case Te.ToggleMute:r.isMuted=!r.isMuted,ks(r.masterVolume,r.isMuted);break;case Te.TogglePause:r.isPaused=!r.isPaused;break;case Te.FastForward:return gu(r,Sv);case Te.DismissTutorial:r.tutorialState.isActive=!1;break;case Te.SaveGame:tu(r);break;case Te.ToggleAutosave:r.autosaveEnabled=!r.autosaveEnabled;break;case Te.CommandEat:a&&a.food.length>0&&(a.activeAction="eating");break;case Te.CommandGather:n?d.gathering=!d.gathering:a&&(a.activeAction="gathering");break;case Te.CommandPlant:n?d.planting=!d.planting:a&&(r.autopilotControls.isManuallyPlanting=!0);break;case Te.ToggleProcreationBehavior:d.procreation=!d.procreation;break;case Te.ToggleAttackBehavior:d.attack=!d.attack;break;case Te.ToggleFeedChildBehavior:d.feedChildren=!d.feedChildren;break;case Te.ToggleAutopilotFollowLeaderBehavior:d.followLeader=!d.followLeader;break;case Te.CommandCallToAttack:a&&a.leaderId===a.id&&(a.isCallingToAttack=!0,a.callToAttackEndTime=r.time+wo,Pe(r,le.CallToAttack,a.position,wo),Ue(l,Ee.CallToAttack,a.position));break;case Te.CommandFollowMe:n?d.followLeader=!d.followLeader:a&&a.leaderId===a.id&&(a.isCallingToFollow=!0,a.callToFollowEndTime=r.time+Ws,Pe(r,le.CallToFollow,a.position,Ws),Ue(l,Ee.CallToFollow,a.position));break;case Te.CommandTribeSplit:a&&xf(a,r);break;case Te.ToggleDiplomacy:if(a&&a.leaderId&&e.targetTribeId){const h=a.leaderId,g=e.targetTribeId,m=r.entities.entities[g],y=a.diplomacy,S=m==null?void 0:m.diplomacy;if(y&&S){const I=(y[g]||bt.Friendly)===bt.Friendly?bt.Hostile:bt.Friendly;y[g]=I,S[h]=I}}break}return r};function ZR(e,n,r){if(!e.notificationButtonRects)return!1;const o=St(e);for(const[l,a]of Object.entries(e.notificationButtonRects.dismiss))if(n>=a.x&&n<=a.x+a.width&&r>=a.y&&r<=a.y+a.height)return Sw(e,l),o&&Ue({gameState:e},Ee.ButtonClick,o.position),!0;for(const[l,a]of Object.entries(e.notificationButtonRects.view))if(n>=a.x&&n<=a.x+a.width&&r>=a.y&&r<=a.y+a.height){const c=e.notifications.find(d=>d.id===l);if(c){let d=c.targetPosition;if(!d&&c.targetEntityIds&&c.targetEntityIds.length>0){const h=e.entities.entities[c.targetEntityIds[0]];h&&(d=h.position)}return d&&qR(e,d),o&&Ue({gameState:e},Ee.ButtonClick,o.position),c.highlightedEntityIds&&(c.renderHighlights=!c.renderHighlights),!0}}return!1}const JR=({isActive:e,gameStateRef:n,canvasRef:r,viewportCenterRef:o,playerActionHintsRef:l,keysPressed:a,returnToIntro:c})=>(Ie.useEffect(()=>{const d=h=>{if(!e()||n.current.gameOver||!r.current||!h.target||h.target!==r.current)return;const g=r.current.getBoundingClientRect(),m=h.clientX-g.left,y=h.clientY-g.top;if(ZR(n.current,m,y))return;const E=n.current.uiButtons.find(T=>m>=T.rect.x&&m<=T.rect.x+T.rect.width&&y>=T.rect.y&&y<=T.rect.y+T.rect.height);if(E){n.current=QR(E,h.shiftKey,n.current,c);return}const I=jm({x:m,y},o.current,{width:r.current.width,height:r.current.height},n.current.mapDimensions);YR(n.current,I)};return window.addEventListener("mousedown",d),()=>{window.removeEventListener("mousedown",d)}},[e,r,n,o,c]),Ie.useEffect(()=>{const d=h=>{if(!e()||!r.current)return;const g=r.current.getBoundingClientRect(),m=h.clientX-g.left,y=h.clientY-g.top;n.current.mousePosition={x:m,y};let S;if(n.current.notificationButtonRects){for(const[I,T]of Object.entries(n.current.notificationButtonRects.dismiss))if(m>=T.x&&m<=T.x+T.width&&y>=T.y&&y<=T.y+T.height){S=`notification-dismiss-${I}`;break}if(!S){for(const[I,T]of Object.entries(n.current.notificationButtonRects.view))if(m>=T.x&&m<=T.x+T.width&&y>=T.y&&y<=T.y+T.height){S=`notification-view-${I}`;break}}}if(!S)for(let I=n.current.uiButtons.length-1;I>=0;I--){const T=n.current.uiButtons[I];if(m>=T.rect.x&&m<=T.rect.x+T.rect.width&&y>=T.rect.y&&y<=T.rect.y+T.rect.height){S=T.id;break}}if(n.current.hoveredButtonId=S,S){n.current.autopilotControls.hoveredAutopilotAction=void 0;return}const E=St(n.current);if(E){const I=jm({x:m,y},o.current,{width:r.current.width,height:r.current.height},n.current.mapDimensions);n.current.autopilotControls.hoveredAutopilotAction=WR(I,E,n.current)}else n.current.autopilotControls.hoveredAutopilotAction=void 0};return window.addEventListener("mousemove",d),()=>{window.removeEventListener("mousemove",d)}},[e,r,n,o]),Ie.useEffect(()=>{const d=g=>{if(!e()||n.current.gameOver)return;const m=g.key.toLowerCase();(m===" "||m==="p"||m==="tab"||(g.ctrlKey||g.metaKey)&&(m==="s"||m==="a"))&&g.preventDefault();const y=jR(g,n.current);if(n.current=y.newState,y.handled)return;const S=St(n.current);S&&(a.current.add(m),VR(m,g.shiftKey,n.current,S,l.current))},h=g=>{if(!e()||n.current.gameOver)return;const m=g.key.toLowerCase();a.current.delete(m);const y=St(n.current);y&&XR(m,y,n.current,a)};return window.addEventListener("keydown",d),window.addEventListener("keyup",h),()=>{window.removeEventListener("keydown",d),window.removeEventListener("keyup",h)}},[e,n,l,a,c]),null),eP=({gameStateRef:e,ctxRef:n,debugPanelTypeRef:r,viewportCenterRef:o,playerActionHintsRef:l,keysPressed:a,canvasRef:c,setAppState:d,appState:h})=>{const g=Ie.useRef(),{returnToIntro:m}=Ro(),[y,S,E]=U0(I=>{var B,x;if(!n.current||!g.current){g.current=I;return}const T=Math.min(I-g.current,1e3)/1e3,{performanceMetrics:C}=e.current;C.currentBucket={renderTime:0,worldUpdateTime:0,aiUpdateTime:0};const U=performance.now();e.current=gu(e.current,T),C.currentBucket.worldUpdateTime=performance.now()-U;const H=St(e.current);H?l.current=$f(e.current,H):l.current=[],o.current=KR(e.current,o.current,T);const O=performance.now();Jl(n.current,e.current,o.current,l.current,{width:((B=c.current)==null?void 0:B.width)||800,height:((x=c.current)==null?void 0:x.height)||600},!1),C.currentBucket.renderTime=performance.now()-O,C.history.push({bucketTime:e.current.time,...C.currentBucket}),C.history.length>AT&&C.history.shift(),g.current=I,e.current.gameOver&&h!=="gameOver"&&(Gf(Ee.GameOver,{masterVolume:e.current.masterVolume,isMuted:e.current.isMuted}),d("gameOver",{generations:e.current.generationCount,cause:e.current.causeOfGameOver||"Unknown"}))});return Ie.useEffect(()=>(S(),y),[S,y]),De.jsx(JR,{isActive:E,gameStateRef:e,canvasRef:c,viewportCenterRef:o,playerActionHintsRef:l,debugPanelTypeRef:r,keysPressed:a,returnToIntro:m})},o0=()=>{const{savedGameState:e,contextReady:n}=Ro(),[r,o]=Ie.useState(null);return Ie.useEffect(()=>{n&&(e?(console.log("Loading saved game state..."),o(e)):(console.log("Initializing new game state..."),o($R())))},[n,e]),!n||!r?De.jsx("div",{children:"Loading..."}):De.jsx(tP,{initialState:r})},tP=({initialState:e})=>{const n=Ie.useRef(null),r=Ie.useRef(null),o=Ie.useRef(e),l=Ie.useRef(new Set),a=Ie.useRef(e.debugPanel),c=Ie.useRef(e.viewportCenter),d=Ie.useRef([]),{appState:h,setAppState:g}=Ro();return De.jsxs(De.Fragment,{children:[De.jsx(zR,{canvasRef:n,ctxRef:r,gameStateRef:o,debugPanelTypeRef:a,viewportCenterRef:c,playerActionHintsRef:d}),De.jsx(eP,{gameStateRef:o,ctxRef:r,debugPanelTypeRef:a,viewportCenterRef:c,playerActionHintsRef:d,keysPressed:l,canvasRef:n,setAppState:g,appState:h})]})},nP=mn.div`
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  text-align: center;
  background-color: rgba(0, 0, 0, 0.75); // Semi-transparent overlay
  color: #fff;
  padding: 20px;
  z-index: 10; // Ensure it's on top
`,iP=mn.h1`
  font-family: 'Press Start 2P', cursive;
  font-size: 4rem;
  color: #ff4136; // Red for emphasis
  text-shadow: 4px 4px 0px #000;
  margin-bottom: 1.5rem;
`,Fl=mn.p`
  font-family: 'Press Start 2P', cursive;
  font-size: 1.2rem;
  margin: 0.5em 0;
  color: #fff;
  text-shadow: 2px 2px 0px #000;
`,rP=mn.button`
  font-family: 'Press Start 2P', cursive;
  font-size: 1rem;
  padding: 1rem 2rem;
  margin-top: 2em;
  color: #fff;
  background-color: #ff4136; // Red button
  border: 2px solid #fff;
  box-shadow: 4px 4px 0px #fff;
  cursor: pointer;
  transition: all 0.2s ease-in-out;
  text-transform: uppercase;

  &:hover {
    background-color: #fff;
    color: #ff4136;
    box-shadow: 4px 4px 0px #ff4136;
  }
`,oP=()=>{const{setAppState:e,gameOverDetails:n}=Ro(),r=()=>{e("intro")};return De.jsxs(nP,{children:[De.jsx(iP,{children:"Game Over"}),De.jsx(Fl,{children:"Your tribe's lineage has ended."}),n&&De.jsxs(De.Fragment,{children:[De.jsxs(Fl,{children:["Generations Survived: ",n.generations]}),De.jsxs(Fl,{children:["Cause of Extinction: ",n.cause]})]}),!n&&De.jsx(Fl,{children:"Game details are unavailable."}),De.jsx(rP,{onClick:r,children:"Return to Menu"})]})},sP=hT`
  /* CSS Reset */
  *, *::before, *::after {
    box-sizing: border-box;
  }

  body {
    margin: 0;
    padding: 0;
    font-family: 'Press Start 2P', 'Arial', sans-serif;
    background-color: #121212;
    color: #f0f0f0;
    line-height: 1.6;
  }

  /* Additional global styles */
  h1, h2, h3, h4, h5, h6 {
    margin-top: 0;
  }

  button {
    cursor: pointer;
    font-family: inherit;
  }

  /* Prevent overflow issues */
  html, body {
    height: 100%;
    overflow-x: hidden;
  }

  /* Root element for React app */
  #root {
    height: 100%;
  }
`;function aP(e,n){Ie.useEffect(()=>{const r=()=>{const o=document.location.hash==="#game"?"game":"intro";n(o)};return window.addEventListener("hashchange",r),r(),()=>{window.removeEventListener("hashchange",r)}},[]),Ie.useEffect(()=>{e==="game"?document.location.hash="#game":e==="intro"&&(document.location.hash="")},[e])}const lP=()=>{const{appState:e,setAppState:n}=Ro();aP(e,n);const r=()=>{switch(e){case"intro":return De.jsx(r0,{});case"game":return De.jsx(o0,{});case"gameOver":return De.jsxs(De.Fragment,{children:[De.jsx(o0,{}),De.jsx(oP,{})]});default:return De.jsx(r0,{})}};return De.jsxs(De.Fragment,{children:[De.jsx(sP,{}),r()]})},s0=document.getElementById("root");s0?kw().then(()=>{tA.createRoot(s0).render(De.jsx(Wn.StrictMode,{children:De.jsx(fA,{initialAppState:document.location.hash==="#game"?"game":"intro",children:De.jsx(lP,{})})}))}):console.error("Failed to find the root element");
