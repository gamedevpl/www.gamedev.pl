var GT=Object.defineProperty;var xT=(e,t,i)=>t in e?GT(e,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[t]=i;var Pe=(e,t,i)=>xT(e,typeof t!="symbol"?t+"":t,i);(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))o(a);new MutationObserver(a=>{for(const s of a)if(s.type==="childList")for(const u of s.addedNodes)u.tagName==="LINK"&&u.rel==="modulepreload"&&o(u)}).observe(document,{childList:!0,subtree:!0});function i(a){const s={};return a.integrity&&(s.integrity=a.integrity),a.referrerPolicy&&(s.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?s.credentials="include":a.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function o(a){if(a.ep)return;a.ep=!0;const s=i(a);fetch(a.href,s)}})();function Z0(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var kd={exports:{}},Ws={},Fd={exports:{}},Be={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var gm;function $T(){if(gm)return Be;gm=1;var e=Symbol.for("react.element"),t=Symbol.for("react.portal"),i=Symbol.for("react.fragment"),o=Symbol.for("react.strict_mode"),a=Symbol.for("react.profiler"),s=Symbol.for("react.provider"),u=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),f=Symbol.for("react.suspense"),g=Symbol.for("react.memo"),m=Symbol.for("react.lazy"),v=Symbol.iterator;function y(P){return P===null||typeof P!="object"?null:(P=v&&P[v]||P["@@iterator"],typeof P=="function"?P:null)}var I={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},E=Object.assign,T={};function w(P,B,K){this.props=P,this.context=B,this.refs=T,this.updater=K||I}w.prototype.isReactComponent={},w.prototype.setState=function(P,B){if(typeof P!="object"&&typeof P!="function"&&P!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,P,B,"setState")},w.prototype.forceUpdate=function(P){this.updater.enqueueForceUpdate(this,P,"forceUpdate")};function O(){}O.prototype=w.prototype;function L(P,B,K){this.props=P,this.context=B,this.refs=T,this.updater=K||I}var N=L.prototype=new O;N.constructor=L,E(N,w.prototype),N.isPureReactComponent=!0;var H=Array.isArray,b=Object.prototype.hasOwnProperty,U={current:null},G={key:!0,ref:!0,__self:!0,__source:!0};function Q(P,B,K){var J,pe={},oe=null,_e=null;if(B!=null)for(J in B.ref!==void 0&&(_e=B.ref),B.key!==void 0&&(oe=""+B.key),B)b.call(B,J)&&!G.hasOwnProperty(J)&&(pe[J]=B[J]);var Ce=arguments.length-2;if(Ce===1)pe.children=K;else if(1<Ce){for(var Z=Array(Ce),se=0;se<Ce;se++)Z[se]=arguments[se+2];pe.children=Z}if(P&&P.defaultProps)for(J in Ce=P.defaultProps,Ce)pe[J]===void 0&&(pe[J]=Ce[J]);return{$$typeof:e,type:P,key:oe,ref:_e,props:pe,_owner:U.current}}function ee(P,B){return{$$typeof:e,type:P.type,key:B,ref:P.ref,props:P.props,_owner:P._owner}}function me(P){return typeof P=="object"&&P!==null&&P.$$typeof===e}function be(P){var B={"=":"=0",":":"=2"};return"$"+P.replace(/[=:]/g,function(K){return B[K]})}var Ne=/\/+/g;function Ie(P,B){return typeof P=="object"&&P!==null&&P.key!=null?be(""+P.key):B.toString(36)}function he(P,B,K,J,pe){var oe=typeof P;(oe==="undefined"||oe==="boolean")&&(P=null);var _e=!1;if(P===null)_e=!0;else switch(oe){case"string":case"number":_e=!0;break;case"object":switch(P.$$typeof){case e:case t:_e=!0}}if(_e)return _e=P,pe=pe(_e),P=J===""?"."+Ie(_e,0):J,H(pe)?(K="",P!=null&&(K=P.replace(Ne,"$&/")+"/"),he(pe,B,K,"",function(se){return se})):pe!=null&&(me(pe)&&(pe=ee(pe,K+(!pe.key||_e&&_e.key===pe.key?"":(""+pe.key).replace(Ne,"$&/")+"/")+P)),B.push(pe)),1;if(_e=0,J=J===""?".":J+":",H(P))for(var Ce=0;Ce<P.length;Ce++){oe=P[Ce];var Z=J+Ie(oe,Ce);_e+=he(oe,B,K,Z,pe)}else if(Z=y(P),typeof Z=="function")for(P=Z.call(P),Ce=0;!(oe=P.next()).done;)oe=oe.value,Z=J+Ie(oe,Ce++),_e+=he(oe,B,K,Z,pe);else if(oe==="object")throw B=String(P),Error("Objects are not valid as a React child (found: "+(B==="[object Object]"?"object with keys {"+Object.keys(P).join(", ")+"}":B)+"). If you meant to render a collection of children, use an array instead.");return _e}function ke(P,B,K){if(P==null)return P;var J=[],pe=0;return he(P,J,"","",function(oe){return B.call(K,oe,pe++)}),J}function ve(P){if(P._status===-1){var B=P._result;B=B(),B.then(function(K){(P._status===0||P._status===-1)&&(P._status=1,P._result=K)},function(K){(P._status===0||P._status===-1)&&(P._status=2,P._result=K)}),P._status===-1&&(P._status=0,P._result=B)}if(P._status===1)return P._result.default;throw P._result}var te={current:null},z={transition:null},X={ReactCurrentDispatcher:te,ReactCurrentBatchConfig:z,ReactCurrentOwner:U};function Y(){throw Error("act(...) is not supported in production builds of React.")}return Be.Children={map:ke,forEach:function(P,B,K){ke(P,function(){B.apply(this,arguments)},K)},count:function(P){var B=0;return ke(P,function(){B++}),B},toArray:function(P){return ke(P,function(B){return B})||[]},only:function(P){if(!me(P))throw Error("React.Children.only expected to receive a single React element child.");return P}},Be.Component=w,Be.Fragment=i,Be.Profiler=a,Be.PureComponent=L,Be.StrictMode=o,Be.Suspense=f,Be.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=X,Be.act=Y,Be.cloneElement=function(P,B,K){if(P==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+P+".");var J=E({},P.props),pe=P.key,oe=P.ref,_e=P._owner;if(B!=null){if(B.ref!==void 0&&(oe=B.ref,_e=U.current),B.key!==void 0&&(pe=""+B.key),P.type&&P.type.defaultProps)var Ce=P.type.defaultProps;for(Z in B)b.call(B,Z)&&!G.hasOwnProperty(Z)&&(J[Z]=B[Z]===void 0&&Ce!==void 0?Ce[Z]:B[Z])}var Z=arguments.length-2;if(Z===1)J.children=K;else if(1<Z){Ce=Array(Z);for(var se=0;se<Z;se++)Ce[se]=arguments[se+2];J.children=Ce}return{$$typeof:e,type:P.type,key:pe,ref:oe,props:J,_owner:_e}},Be.createContext=function(P){return P={$$typeof:u,_currentValue:P,_currentValue2:P,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},P.Provider={$$typeof:s,_context:P},P.Consumer=P},Be.createElement=Q,Be.createFactory=function(P){var B=Q.bind(null,P);return B.type=P,B},Be.createRef=function(){return{current:null}},Be.forwardRef=function(P){return{$$typeof:c,render:P}},Be.isValidElement=me,Be.lazy=function(P){return{$$typeof:m,_payload:{_status:-1,_result:P},_init:ve}},Be.memo=function(P,B){return{$$typeof:g,type:P,compare:B===void 0?null:B}},Be.startTransition=function(P){var B=z.transition;z.transition={};try{P()}finally{z.transition=B}},Be.unstable_act=Y,Be.useCallback=function(P,B){return te.current.useCallback(P,B)},Be.useContext=function(P){return te.current.useContext(P)},Be.useDebugValue=function(){},Be.useDeferredValue=function(P){return te.current.useDeferredValue(P)},Be.useEffect=function(P,B){return te.current.useEffect(P,B)},Be.useId=function(){return te.current.useId()},Be.useImperativeHandle=function(P,B,K){return te.current.useImperativeHandle(P,B,K)},Be.useInsertionEffect=function(P,B){return te.current.useInsertionEffect(P,B)},Be.useLayoutEffect=function(P,B){return te.current.useLayoutEffect(P,B)},Be.useMemo=function(P,B){return te.current.useMemo(P,B)},Be.useReducer=function(P,B,K){return te.current.useReducer(P,B,K)},Be.useRef=function(P){return te.current.useRef(P)},Be.useState=function(P){return te.current.useState(P)},Be.useSyncExternalStore=function(P,B,K){return te.current.useSyncExternalStore(P,B,K)},Be.useTransition=function(){return te.current.useTransition()},Be.version="18.3.1",Be}var pm;function Gf(){return pm||(pm=1,Fd.exports=$T()),Fd.exports}/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var mm;function WT(){if(mm)return Ws;mm=1;var e=Gf(),t=Symbol.for("react.element"),i=Symbol.for("react.fragment"),o=Object.prototype.hasOwnProperty,a=e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,s={key:!0,ref:!0,__self:!0,__source:!0};function u(c,f,g){var m,v={},y=null,I=null;g!==void 0&&(y=""+g),f.key!==void 0&&(y=""+f.key),f.ref!==void 0&&(I=f.ref);for(m in f)o.call(f,m)&&!s.hasOwnProperty(m)&&(v[m]=f[m]);if(c&&c.defaultProps)for(m in f=c.defaultProps,f)v[m]===void 0&&(v[m]=f[m]);return{$$typeof:t,type:c,key:y,ref:I,props:v,_owner:a.current}}return Ws.Fragment=i,Ws.jsx=u,Ws.jsxs=u,Ws}var vm;function zT(){return vm||(vm=1,kd.exports=WT()),kd.exports}var Le=zT(),De=Gf();const ii=Z0(De);var xl={},Ld={exports:{}},en={},Ud={exports:{}},Bd={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Sm;function YT(){return Sm||(Sm=1,function(e){function t(z,X){var Y=z.length;z.push(X);e:for(;0<Y;){var P=Y-1>>>1,B=z[P];if(0<a(B,X))z[P]=X,z[Y]=B,Y=P;else break e}}function i(z){return z.length===0?null:z[0]}function o(z){if(z.length===0)return null;var X=z[0],Y=z.pop();if(Y!==X){z[0]=Y;e:for(var P=0,B=z.length,K=B>>>1;P<K;){var J=2*(P+1)-1,pe=z[J],oe=J+1,_e=z[oe];if(0>a(pe,Y))oe<B&&0>a(_e,pe)?(z[P]=_e,z[oe]=Y,P=oe):(z[P]=pe,z[J]=Y,P=J);else if(oe<B&&0>a(_e,Y))z[P]=_e,z[oe]=Y,P=oe;else break e}}return X}function a(z,X){var Y=z.sortIndex-X.sortIndex;return Y!==0?Y:z.id-X.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;e.unstable_now=function(){return s.now()}}else{var u=Date,c=u.now();e.unstable_now=function(){return u.now()-c}}var f=[],g=[],m=1,v=null,y=3,I=!1,E=!1,T=!1,w=typeof setTimeout=="function"?setTimeout:null,O=typeof clearTimeout=="function"?clearTimeout:null,L=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function N(z){for(var X=i(g);X!==null;){if(X.callback===null)o(g);else if(X.startTime<=z)o(g),X.sortIndex=X.expirationTime,t(f,X);else break;X=i(g)}}function H(z){if(T=!1,N(z),!E)if(i(f)!==null)E=!0,ve(b);else{var X=i(g);X!==null&&te(H,X.startTime-z)}}function b(z,X){E=!1,T&&(T=!1,O(Q),Q=-1),I=!0;var Y=y;try{for(N(X),v=i(f);v!==null&&(!(v.expirationTime>X)||z&&!be());){var P=v.callback;if(typeof P=="function"){v.callback=null,y=v.priorityLevel;var B=P(v.expirationTime<=X);X=e.unstable_now(),typeof B=="function"?v.callback=B:v===i(f)&&o(f),N(X)}else o(f);v=i(f)}if(v!==null)var K=!0;else{var J=i(g);J!==null&&te(H,J.startTime-X),K=!1}return K}finally{v=null,y=Y,I=!1}}var U=!1,G=null,Q=-1,ee=5,me=-1;function be(){return!(e.unstable_now()-me<ee)}function Ne(){if(G!==null){var z=e.unstable_now();me=z;var X=!0;try{X=G(!0,z)}finally{X?Ie():(U=!1,G=null)}}else U=!1}var Ie;if(typeof L=="function")Ie=function(){L(Ne)};else if(typeof MessageChannel<"u"){var he=new MessageChannel,ke=he.port2;he.port1.onmessage=Ne,Ie=function(){ke.postMessage(null)}}else Ie=function(){w(Ne,0)};function ve(z){G=z,U||(U=!0,Ie())}function te(z,X){Q=w(function(){z(e.unstable_now())},X)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(z){z.callback=null},e.unstable_continueExecution=function(){E||I||(E=!0,ve(b))},e.unstable_forceFrameRate=function(z){0>z||125<z?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):ee=0<z?Math.floor(1e3/z):5},e.unstable_getCurrentPriorityLevel=function(){return y},e.unstable_getFirstCallbackNode=function(){return i(f)},e.unstable_next=function(z){switch(y){case 1:case 2:case 3:var X=3;break;default:X=y}var Y=y;y=X;try{return z()}finally{y=Y}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(z,X){switch(z){case 1:case 2:case 3:case 4:case 5:break;default:z=3}var Y=y;y=z;try{return X()}finally{y=Y}},e.unstable_scheduleCallback=function(z,X,Y){var P=e.unstable_now();switch(typeof Y=="object"&&Y!==null?(Y=Y.delay,Y=typeof Y=="number"&&0<Y?P+Y:P):Y=P,z){case 1:var B=-1;break;case 2:B=250;break;case 5:B=1073741823;break;case 4:B=1e4;break;default:B=5e3}return B=Y+B,z={id:m++,callback:X,priorityLevel:z,startTime:Y,expirationTime:B,sortIndex:-1},Y>P?(z.sortIndex=Y,t(g,z),i(f)===null&&z===i(g)&&(T?(O(Q),Q=-1):T=!0,te(H,Y-P))):(z.sortIndex=B,t(f,z),E||I||(E=!0,ve(b))),z},e.unstable_shouldYield=be,e.unstable_wrapCallback=function(z){var X=y;return function(){var Y=y;y=X;try{return z.apply(this,arguments)}finally{y=Y}}}}(Bd)),Bd}var ym;function jT(){return ym||(ym=1,Ud.exports=YT()),Ud.exports}/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Tm;function VT(){if(Tm)return en;Tm=1;var e=Gf(),t=jT();function i(n){for(var r="https://reactjs.org/docs/error-decoder.html?invariant="+n,l=1;l<arguments.length;l++)r+="&args[]="+encodeURIComponent(arguments[l]);return"Minified React error #"+n+"; visit "+r+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var o=new Set,a={};function s(n,r){u(n,r),u(n+"Capture",r)}function u(n,r){for(a[n]=r,n=0;n<r.length;n++)o.add(r[n])}var c=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),f=Object.prototype.hasOwnProperty,g=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,m={},v={};function y(n){return f.call(v,n)?!0:f.call(m,n)?!1:g.test(n)?v[n]=!0:(m[n]=!0,!1)}function I(n,r,l,d){if(l!==null&&l.type===0)return!1;switch(typeof r){case"function":case"symbol":return!0;case"boolean":return d?!1:l!==null?!l.acceptsBooleans:(n=n.toLowerCase().slice(0,5),n!=="data-"&&n!=="aria-");default:return!1}}function E(n,r,l,d){if(r===null||typeof r>"u"||I(n,r,l,d))return!0;if(d)return!1;if(l!==null)switch(l.type){case 3:return!r;case 4:return r===!1;case 5:return isNaN(r);case 6:return isNaN(r)||1>r}return!1}function T(n,r,l,d,h,p,S){this.acceptsBooleans=r===2||r===3||r===4,this.attributeName=d,this.attributeNamespace=h,this.mustUseProperty=l,this.propertyName=n,this.type=r,this.sanitizeURL=p,this.removeEmptyString=S}var w={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(n){w[n]=new T(n,0,!1,n,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(n){var r=n[0];w[r]=new T(r,1,!1,n[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(n){w[n]=new T(n,2,!1,n.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(n){w[n]=new T(n,2,!1,n,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(n){w[n]=new T(n,3,!1,n.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(n){w[n]=new T(n,3,!0,n,null,!1,!1)}),["capture","download"].forEach(function(n){w[n]=new T(n,4,!1,n,null,!1,!1)}),["cols","rows","size","span"].forEach(function(n){w[n]=new T(n,6,!1,n,null,!1,!1)}),["rowSpan","start"].forEach(function(n){w[n]=new T(n,5,!1,n.toLowerCase(),null,!1,!1)});var O=/[\-:]([a-z])/g;function L(n){return n[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(n){var r=n.replace(O,L);w[r]=new T(r,1,!1,n,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(n){var r=n.replace(O,L);w[r]=new T(r,1,!1,n,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(n){var r=n.replace(O,L);w[r]=new T(r,1,!1,n,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(n){w[n]=new T(n,1,!1,n.toLowerCase(),null,!1,!1)}),w.xlinkHref=new T("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(n){w[n]=new T(n,1,!1,n.toLowerCase(),null,!0,!0)});function N(n,r,l,d){var h=w.hasOwnProperty(r)?w[r]:null;(h!==null?h.type!==0:d||!(2<r.length)||r[0]!=="o"&&r[0]!=="O"||r[1]!=="n"&&r[1]!=="N")&&(E(r,l,h,d)&&(l=null),d||h===null?y(r)&&(l===null?n.removeAttribute(r):n.setAttribute(r,""+l)):h.mustUseProperty?n[h.propertyName]=l===null?h.type===3?!1:"":l:(r=h.attributeName,d=h.attributeNamespace,l===null?n.removeAttribute(r):(h=h.type,l=h===3||h===4&&l===!0?"":""+l,d?n.setAttributeNS(d,r,l):n.setAttribute(r,l))))}var H=e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,b=Symbol.for("react.element"),U=Symbol.for("react.portal"),G=Symbol.for("react.fragment"),Q=Symbol.for("react.strict_mode"),ee=Symbol.for("react.profiler"),me=Symbol.for("react.provider"),be=Symbol.for("react.context"),Ne=Symbol.for("react.forward_ref"),Ie=Symbol.for("react.suspense"),he=Symbol.for("react.suspense_list"),ke=Symbol.for("react.memo"),ve=Symbol.for("react.lazy"),te=Symbol.for("react.offscreen"),z=Symbol.iterator;function X(n){return n===null||typeof n!="object"?null:(n=z&&n[z]||n["@@iterator"],typeof n=="function"?n:null)}var Y=Object.assign,P;function B(n){if(P===void 0)try{throw Error()}catch(l){var r=l.stack.trim().match(/\n( *(at )?)/);P=r&&r[1]||""}return`
`+P+n}var K=!1;function J(n,r){if(!n||K)return"";K=!0;var l=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(r)if(r=function(){throw Error()},Object.defineProperty(r.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(r,[])}catch(F){var d=F}Reflect.construct(n,[],r)}else{try{r.call()}catch(F){d=F}n.call(r.prototype)}else{try{throw Error()}catch(F){d=F}n()}}catch(F){if(F&&d&&typeof F.stack=="string"){for(var h=F.stack.split(`
`),p=d.stack.split(`
`),S=h.length-1,C=p.length-1;1<=S&&0<=C&&h[S]!==p[C];)C--;for(;1<=S&&0<=C;S--,C--)if(h[S]!==p[C]){if(S!==1||C!==1)do if(S--,C--,0>C||h[S]!==p[C]){var R=`
`+h[S].replace(" at new "," at ");return n.displayName&&R.includes("<anonymous>")&&(R=R.replace("<anonymous>",n.displayName)),R}while(1<=S&&0<=C);break}}}finally{K=!1,Error.prepareStackTrace=l}return(n=n?n.displayName||n.name:"")?B(n):""}function pe(n){switch(n.tag){case 5:return B(n.type);case 16:return B("Lazy");case 13:return B("Suspense");case 19:return B("SuspenseList");case 0:case 2:case 15:return n=J(n.type,!1),n;case 11:return n=J(n.type.render,!1),n;case 1:return n=J(n.type,!0),n;default:return""}}function oe(n){if(n==null)return null;if(typeof n=="function")return n.displayName||n.name||null;if(typeof n=="string")return n;switch(n){case G:return"Fragment";case U:return"Portal";case ee:return"Profiler";case Q:return"StrictMode";case Ie:return"Suspense";case he:return"SuspenseList"}if(typeof n=="object")switch(n.$$typeof){case be:return(n.displayName||"Context")+".Consumer";case me:return(n._context.displayName||"Context")+".Provider";case Ne:var r=n.render;return n=n.displayName,n||(n=r.displayName||r.name||"",n=n!==""?"ForwardRef("+n+")":"ForwardRef"),n;case ke:return r=n.displayName||null,r!==null?r:oe(n.type)||"Memo";case ve:r=n._payload,n=n._init;try{return oe(n(r))}catch{}}return null}function _e(n){var r=n.type;switch(n.tag){case 24:return"Cache";case 9:return(r.displayName||"Context")+".Consumer";case 10:return(r._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return n=r.render,n=n.displayName||n.name||"",r.displayName||(n!==""?"ForwardRef("+n+")":"ForwardRef");case 7:return"Fragment";case 5:return r;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return oe(r);case 8:return r===Q?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof r=="function")return r.displayName||r.name||null;if(typeof r=="string")return r}return null}function Ce(n){switch(typeof n){case"boolean":case"number":case"string":case"undefined":return n;case"object":return n;default:return""}}function Z(n){var r=n.type;return(n=n.nodeName)&&n.toLowerCase()==="input"&&(r==="checkbox"||r==="radio")}function se(n){var r=Z(n)?"checked":"value",l=Object.getOwnPropertyDescriptor(n.constructor.prototype,r),d=""+n[r];if(!n.hasOwnProperty(r)&&typeof l<"u"&&typeof l.get=="function"&&typeof l.set=="function"){var h=l.get,p=l.set;return Object.defineProperty(n,r,{configurable:!0,get:function(){return h.call(this)},set:function(S){d=""+S,p.call(this,S)}}),Object.defineProperty(n,r,{enumerable:l.enumerable}),{getValue:function(){return d},setValue:function(S){d=""+S},stopTracking:function(){n._valueTracker=null,delete n[r]}}}}function Ue(n){n._valueTracker||(n._valueTracker=se(n))}function Se(n){if(!n)return!1;var r=n._valueTracker;if(!r)return!0;var l=r.getValue(),d="";return n&&(d=Z(n)?n.checked?"true":"false":n.value),n=d,n!==l?(r.setValue(n),!0):!1}function $n(n){if(n=n||(typeof document<"u"?document:void 0),typeof n>"u")return null;try{return n.activeElement||n.body}catch{return n.body}}function tt(n,r){var l=r.checked;return Y({},r,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:l??n._wrapperState.initialChecked})}function Ze(n,r){var l=r.defaultValue==null?"":r.defaultValue,d=r.checked!=null?r.checked:r.defaultChecked;l=Ce(r.value!=null?r.value:l),n._wrapperState={initialChecked:d,initialValue:l,controlled:r.type==="checkbox"||r.type==="radio"?r.checked!=null:r.value!=null}}function Wn(n,r){r=r.checked,r!=null&&N(n,"checked",r,!1)}function Xt(n,r){Wn(n,r);var l=Ce(r.value),d=r.type;if(l!=null)d==="number"?(l===0&&n.value===""||n.value!=l)&&(n.value=""+l):n.value!==""+l&&(n.value=""+l);else if(d==="submit"||d==="reset"){n.removeAttribute("value");return}r.hasOwnProperty("value")?zn(n,r.type,l):r.hasOwnProperty("defaultValue")&&zn(n,r.type,Ce(r.defaultValue)),r.checked==null&&r.defaultChecked!=null&&(n.defaultChecked=!!r.defaultChecked)}function gn(n,r,l){if(r.hasOwnProperty("value")||r.hasOwnProperty("defaultValue")){var d=r.type;if(!(d!=="submit"&&d!=="reset"||r.value!==void 0&&r.value!==null))return;r=""+n._wrapperState.initialValue,l||r===n.value||(n.value=r),n.defaultValue=r}l=n.name,l!==""&&(n.name=""),n.defaultChecked=!!n._wrapperState.initialChecked,l!==""&&(n.name=l)}function zn(n,r,l){(r!=="number"||$n(n.ownerDocument)!==n)&&(l==null?n.defaultValue=""+n._wrapperState.initialValue:n.defaultValue!==""+l&&(n.defaultValue=""+l))}var Yn=Array.isArray;function Ii(n,r,l,d){if(n=n.options,r){r={};for(var h=0;h<l.length;h++)r["$"+l[h]]=!0;for(l=0;l<n.length;l++)h=r.hasOwnProperty("$"+n[l].value),n[l].selected!==h&&(n[l].selected=h),h&&d&&(n[l].defaultSelected=!0)}else{for(l=""+Ce(l),r=null,h=0;h<n.length;h++){if(n[h].value===l){n[h].selected=!0,d&&(n[h].defaultSelected=!0);return}r!==null||n[h].disabled||(r=n[h])}r!==null&&(r.selected=!0)}}function cr(n,r){if(r.dangerouslySetInnerHTML!=null)throw Error(i(91));return Y({},r,{value:void 0,defaultValue:void 0,children:""+n._wrapperState.initialValue})}function Ch(n,r){var l=r.value;if(l==null){if(l=r.children,r=r.defaultValue,l!=null){if(r!=null)throw Error(i(92));if(Yn(l)){if(1<l.length)throw Error(i(93));l=l[0]}r=l}r==null&&(r=""),l=r}n._wrapperState={initialValue:Ce(l)}}function wh(n,r){var l=Ce(r.value),d=Ce(r.defaultValue);l!=null&&(l=""+l,l!==n.value&&(n.value=l),r.defaultValue==null&&n.defaultValue!==l&&(n.defaultValue=l)),d!=null&&(n.defaultValue=""+d)}function _h(n){var r=n.textContent;r===n._wrapperState.initialValue&&r!==""&&r!==null&&(n.value=r)}function Rh(n){switch(n){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function zu(n,r){return n==null||n==="http://www.w3.org/1999/xhtml"?Rh(r):n==="http://www.w3.org/2000/svg"&&r==="foreignObject"?"http://www.w3.org/1999/xhtml":n}var ka,Ph=function(n){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(r,l,d,h){MSApp.execUnsafeLocalFunction(function(){return n(r,l,d,h)})}:n}(function(n,r){if(n.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in n)n.innerHTML=r;else{for(ka=ka||document.createElement("div"),ka.innerHTML="<svg>"+r.valueOf().toString()+"</svg>",r=ka.firstChild;n.firstChild;)n.removeChild(n.firstChild);for(;r.firstChild;)n.appendChild(r.firstChild)}});function os(n,r){if(r){var l=n.firstChild;if(l&&l===n.lastChild&&l.nodeType===3){l.nodeValue=r;return}}n.textContent=r}var ss={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},zS=["Webkit","ms","Moz","O"];Object.keys(ss).forEach(function(n){zS.forEach(function(r){r=r+n.charAt(0).toUpperCase()+n.substring(1),ss[r]=ss[n]})});function Nh(n,r,l){return r==null||typeof r=="boolean"||r===""?"":l||typeof r!="number"||r===0||ss.hasOwnProperty(n)&&ss[n]?(""+r).trim():r+"px"}function Dh(n,r){n=n.style;for(var l in r)if(r.hasOwnProperty(l)){var d=l.indexOf("--")===0,h=Nh(l,r[l],d);l==="float"&&(l="cssFloat"),d?n.setProperty(l,h):n[l]=h}}var YS=Y({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Yu(n,r){if(r){if(YS[n]&&(r.children!=null||r.dangerouslySetInnerHTML!=null))throw Error(i(137,n));if(r.dangerouslySetInnerHTML!=null){if(r.children!=null)throw Error(i(60));if(typeof r.dangerouslySetInnerHTML!="object"||!("__html"in r.dangerouslySetInnerHTML))throw Error(i(61))}if(r.style!=null&&typeof r.style!="object")throw Error(i(62))}}function ju(n,r){if(n.indexOf("-")===-1)return typeof r.is=="string";switch(n){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Vu=null;function Xu(n){return n=n.target||n.srcElement||window,n.correspondingUseElement&&(n=n.correspondingUseElement),n.nodeType===3?n.parentNode:n}var Ku=null,Vr=null,Xr=null;function Oh(n){if(n=Ps(n)){if(typeof Ku!="function")throw Error(i(280));var r=n.stateNode;r&&(r=nl(r),Ku(n.stateNode,n.type,r))}}function Mh(n){Vr?Xr?Xr.push(n):Xr=[n]:Vr=n}function kh(){if(Vr){var n=Vr,r=Xr;if(Xr=Vr=null,Oh(n),r)for(n=0;n<r.length;n++)Oh(r[n])}}function Fh(n,r){return n(r)}function Lh(){}var Zu=!1;function Uh(n,r,l){if(Zu)return n(r,l);Zu=!0;try{return Fh(n,r,l)}finally{Zu=!1,(Vr!==null||Xr!==null)&&(Lh(),kh())}}function as(n,r){var l=n.stateNode;if(l===null)return null;var d=nl(l);if(d===null)return null;l=d[r];e:switch(r){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(d=!d.disabled)||(n=n.type,d=!(n==="button"||n==="input"||n==="select"||n==="textarea")),n=!d;break e;default:n=!1}if(n)return null;if(l&&typeof l!="function")throw Error(i(231,r,typeof l));return l}var qu=!1;if(c)try{var ls={};Object.defineProperty(ls,"passive",{get:function(){qu=!0}}),window.addEventListener("test",ls,ls),window.removeEventListener("test",ls,ls)}catch{qu=!1}function jS(n,r,l,d,h,p,S,C,R){var F=Array.prototype.slice.call(arguments,3);try{r.apply(l,F)}catch($){this.onError($)}}var us=!1,Fa=null,La=!1,Qu=null,VS={onError:function(n){us=!0,Fa=n}};function XS(n,r,l,d,h,p,S,C,R){us=!1,Fa=null,jS.apply(VS,arguments)}function KS(n,r,l,d,h,p,S,C,R){if(XS.apply(this,arguments),us){if(us){var F=Fa;us=!1,Fa=null}else throw Error(i(198));La||(La=!0,Qu=F)}}function dr(n){var r=n,l=n;if(n.alternate)for(;r.return;)r=r.return;else{n=r;do r=n,(r.flags&4098)!==0&&(l=r.return),n=r.return;while(n)}return r.tag===3?l:null}function Bh(n){if(n.tag===13){var r=n.memoizedState;if(r===null&&(n=n.alternate,n!==null&&(r=n.memoizedState)),r!==null)return r.dehydrated}return null}function Hh(n){if(dr(n)!==n)throw Error(i(188))}function ZS(n){var r=n.alternate;if(!r){if(r=dr(n),r===null)throw Error(i(188));return r!==n?null:n}for(var l=n,d=r;;){var h=l.return;if(h===null)break;var p=h.alternate;if(p===null){if(d=h.return,d!==null){l=d;continue}break}if(h.child===p.child){for(p=h.child;p;){if(p===l)return Hh(h),n;if(p===d)return Hh(h),r;p=p.sibling}throw Error(i(188))}if(l.return!==d.return)l=h,d=p;else{for(var S=!1,C=h.child;C;){if(C===l){S=!0,l=h,d=p;break}if(C===d){S=!0,d=h,l=p;break}C=C.sibling}if(!S){for(C=p.child;C;){if(C===l){S=!0,l=p,d=h;break}if(C===d){S=!0,d=p,l=h;break}C=C.sibling}if(!S)throw Error(i(189))}}if(l.alternate!==d)throw Error(i(190))}if(l.tag!==3)throw Error(i(188));return l.stateNode.current===l?n:r}function bh(n){return n=ZS(n),n!==null?Gh(n):null}function Gh(n){if(n.tag===5||n.tag===6)return n;for(n=n.child;n!==null;){var r=Gh(n);if(r!==null)return r;n=n.sibling}return null}var xh=t.unstable_scheduleCallback,$h=t.unstable_cancelCallback,qS=t.unstable_shouldYield,QS=t.unstable_requestPaint,lt=t.unstable_now,JS=t.unstable_getCurrentPriorityLevel,Ju=t.unstable_ImmediatePriority,Wh=t.unstable_UserBlockingPriority,Ua=t.unstable_NormalPriority,ey=t.unstable_LowPriority,zh=t.unstable_IdlePriority,Ba=null,jn=null;function ty(n){if(jn&&typeof jn.onCommitFiberRoot=="function")try{jn.onCommitFiberRoot(Ba,n,void 0,(n.current.flags&128)===128)}catch{}}var Pn=Math.clz32?Math.clz32:ry,ny=Math.log,iy=Math.LN2;function ry(n){return n>>>=0,n===0?32:31-(ny(n)/iy|0)|0}var Ha=64,ba=4194304;function cs(n){switch(n&-n){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return n&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return n&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return n}}function Ga(n,r){var l=n.pendingLanes;if(l===0)return 0;var d=0,h=n.suspendedLanes,p=n.pingedLanes,S=l&268435455;if(S!==0){var C=S&~h;C!==0?d=cs(C):(p&=S,p!==0&&(d=cs(p)))}else S=l&~h,S!==0?d=cs(S):p!==0&&(d=cs(p));if(d===0)return 0;if(r!==0&&r!==d&&(r&h)===0&&(h=d&-d,p=r&-r,h>=p||h===16&&(p&4194240)!==0))return r;if((d&4)!==0&&(d|=l&16),r=n.entangledLanes,r!==0)for(n=n.entanglements,r&=d;0<r;)l=31-Pn(r),h=1<<l,d|=n[l],r&=~h;return d}function oy(n,r){switch(n){case 1:case 2:case 4:return r+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return r+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function sy(n,r){for(var l=n.suspendedLanes,d=n.pingedLanes,h=n.expirationTimes,p=n.pendingLanes;0<p;){var S=31-Pn(p),C=1<<S,R=h[S];R===-1?((C&l)===0||(C&d)!==0)&&(h[S]=oy(C,r)):R<=r&&(n.expiredLanes|=C),p&=~C}}function ec(n){return n=n.pendingLanes&-1073741825,n!==0?n:n&1073741824?1073741824:0}function Yh(){var n=Ha;return Ha<<=1,(Ha&4194240)===0&&(Ha=64),n}function tc(n){for(var r=[],l=0;31>l;l++)r.push(n);return r}function ds(n,r,l){n.pendingLanes|=r,r!==536870912&&(n.suspendedLanes=0,n.pingedLanes=0),n=n.eventTimes,r=31-Pn(r),n[r]=l}function ay(n,r){var l=n.pendingLanes&~r;n.pendingLanes=r,n.suspendedLanes=0,n.pingedLanes=0,n.expiredLanes&=r,n.mutableReadLanes&=r,n.entangledLanes&=r,r=n.entanglements;var d=n.eventTimes;for(n=n.expirationTimes;0<l;){var h=31-Pn(l),p=1<<h;r[h]=0,d[h]=-1,n[h]=-1,l&=~p}}function nc(n,r){var l=n.entangledLanes|=r;for(n=n.entanglements;l;){var d=31-Pn(l),h=1<<d;h&r|n[d]&r&&(n[d]|=r),l&=~h}}var ze=0;function jh(n){return n&=-n,1<n?4<n?(n&268435455)!==0?16:536870912:4:1}var Vh,ic,Xh,Kh,Zh,rc=!1,xa=[],Ei=null,Ci=null,wi=null,fs=new Map,hs=new Map,_i=[],ly="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function qh(n,r){switch(n){case"focusin":case"focusout":Ei=null;break;case"dragenter":case"dragleave":Ci=null;break;case"mouseover":case"mouseout":wi=null;break;case"pointerover":case"pointerout":fs.delete(r.pointerId);break;case"gotpointercapture":case"lostpointercapture":hs.delete(r.pointerId)}}function gs(n,r,l,d,h,p){return n===null||n.nativeEvent!==p?(n={blockedOn:r,domEventName:l,eventSystemFlags:d,nativeEvent:p,targetContainers:[h]},r!==null&&(r=Ps(r),r!==null&&ic(r)),n):(n.eventSystemFlags|=d,r=n.targetContainers,h!==null&&r.indexOf(h)===-1&&r.push(h),n)}function uy(n,r,l,d,h){switch(r){case"focusin":return Ei=gs(Ei,n,r,l,d,h),!0;case"dragenter":return Ci=gs(Ci,n,r,l,d,h),!0;case"mouseover":return wi=gs(wi,n,r,l,d,h),!0;case"pointerover":var p=h.pointerId;return fs.set(p,gs(fs.get(p)||null,n,r,l,d,h)),!0;case"gotpointercapture":return p=h.pointerId,hs.set(p,gs(hs.get(p)||null,n,r,l,d,h)),!0}return!1}function Qh(n){var r=fr(n.target);if(r!==null){var l=dr(r);if(l!==null){if(r=l.tag,r===13){if(r=Bh(l),r!==null){n.blockedOn=r,Zh(n.priority,function(){Xh(l)});return}}else if(r===3&&l.stateNode.current.memoizedState.isDehydrated){n.blockedOn=l.tag===3?l.stateNode.containerInfo:null;return}}}n.blockedOn=null}function $a(n){if(n.blockedOn!==null)return!1;for(var r=n.targetContainers;0<r.length;){var l=sc(n.domEventName,n.eventSystemFlags,r[0],n.nativeEvent);if(l===null){l=n.nativeEvent;var d=new l.constructor(l.type,l);Vu=d,l.target.dispatchEvent(d),Vu=null}else return r=Ps(l),r!==null&&ic(r),n.blockedOn=l,!1;r.shift()}return!0}function Jh(n,r,l){$a(n)&&l.delete(r)}function cy(){rc=!1,Ei!==null&&$a(Ei)&&(Ei=null),Ci!==null&&$a(Ci)&&(Ci=null),wi!==null&&$a(wi)&&(wi=null),fs.forEach(Jh),hs.forEach(Jh)}function ps(n,r){n.blockedOn===r&&(n.blockedOn=null,rc||(rc=!0,t.unstable_scheduleCallback(t.unstable_NormalPriority,cy)))}function ms(n){function r(h){return ps(h,n)}if(0<xa.length){ps(xa[0],n);for(var l=1;l<xa.length;l++){var d=xa[l];d.blockedOn===n&&(d.blockedOn=null)}}for(Ei!==null&&ps(Ei,n),Ci!==null&&ps(Ci,n),wi!==null&&ps(wi,n),fs.forEach(r),hs.forEach(r),l=0;l<_i.length;l++)d=_i[l],d.blockedOn===n&&(d.blockedOn=null);for(;0<_i.length&&(l=_i[0],l.blockedOn===null);)Qh(l),l.blockedOn===null&&_i.shift()}var Kr=H.ReactCurrentBatchConfig,Wa=!0;function dy(n,r,l,d){var h=ze,p=Kr.transition;Kr.transition=null;try{ze=1,oc(n,r,l,d)}finally{ze=h,Kr.transition=p}}function fy(n,r,l,d){var h=ze,p=Kr.transition;Kr.transition=null;try{ze=4,oc(n,r,l,d)}finally{ze=h,Kr.transition=p}}function oc(n,r,l,d){if(Wa){var h=sc(n,r,l,d);if(h===null)Ec(n,r,d,za,l),qh(n,d);else if(uy(h,n,r,l,d))d.stopPropagation();else if(qh(n,d),r&4&&-1<ly.indexOf(n)){for(;h!==null;){var p=Ps(h);if(p!==null&&Vh(p),p=sc(n,r,l,d),p===null&&Ec(n,r,d,za,l),p===h)break;h=p}h!==null&&d.stopPropagation()}else Ec(n,r,d,null,l)}}var za=null;function sc(n,r,l,d){if(za=null,n=Xu(d),n=fr(n),n!==null)if(r=dr(n),r===null)n=null;else if(l=r.tag,l===13){if(n=Bh(r),n!==null)return n;n=null}else if(l===3){if(r.stateNode.current.memoizedState.isDehydrated)return r.tag===3?r.stateNode.containerInfo:null;n=null}else r!==n&&(n=null);return za=n,null}function eg(n){switch(n){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(JS()){case Ju:return 1;case Wh:return 4;case Ua:case ey:return 16;case zh:return 536870912;default:return 16}default:return 16}}var Ri=null,ac=null,Ya=null;function tg(){if(Ya)return Ya;var n,r=ac,l=r.length,d,h="value"in Ri?Ri.value:Ri.textContent,p=h.length;for(n=0;n<l&&r[n]===h[n];n++);var S=l-n;for(d=1;d<=S&&r[l-d]===h[p-d];d++);return Ya=h.slice(n,1<d?1-d:void 0)}function ja(n){var r=n.keyCode;return"charCode"in n?(n=n.charCode,n===0&&r===13&&(n=13)):n=r,n===10&&(n=13),32<=n||n===13?n:0}function Va(){return!0}function ng(){return!1}function on(n){function r(l,d,h,p,S){this._reactName=l,this._targetInst=h,this.type=d,this.nativeEvent=p,this.target=S,this.currentTarget=null;for(var C in n)n.hasOwnProperty(C)&&(l=n[C],this[C]=l?l(p):p[C]);return this.isDefaultPrevented=(p.defaultPrevented!=null?p.defaultPrevented:p.returnValue===!1)?Va:ng,this.isPropagationStopped=ng,this}return Y(r.prototype,{preventDefault:function(){this.defaultPrevented=!0;var l=this.nativeEvent;l&&(l.preventDefault?l.preventDefault():typeof l.returnValue!="unknown"&&(l.returnValue=!1),this.isDefaultPrevented=Va)},stopPropagation:function(){var l=this.nativeEvent;l&&(l.stopPropagation?l.stopPropagation():typeof l.cancelBubble!="unknown"&&(l.cancelBubble=!0),this.isPropagationStopped=Va)},persist:function(){},isPersistent:Va}),r}var Zr={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(n){return n.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},lc=on(Zr),vs=Y({},Zr,{view:0,detail:0}),hy=on(vs),uc,cc,Ss,Xa=Y({},vs,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:fc,button:0,buttons:0,relatedTarget:function(n){return n.relatedTarget===void 0?n.fromElement===n.srcElement?n.toElement:n.fromElement:n.relatedTarget},movementX:function(n){return"movementX"in n?n.movementX:(n!==Ss&&(Ss&&n.type==="mousemove"?(uc=n.screenX-Ss.screenX,cc=n.screenY-Ss.screenY):cc=uc=0,Ss=n),uc)},movementY:function(n){return"movementY"in n?n.movementY:cc}}),ig=on(Xa),gy=Y({},Xa,{dataTransfer:0}),py=on(gy),my=Y({},vs,{relatedTarget:0}),dc=on(my),vy=Y({},Zr,{animationName:0,elapsedTime:0,pseudoElement:0}),Sy=on(vy),yy=Y({},Zr,{clipboardData:function(n){return"clipboardData"in n?n.clipboardData:window.clipboardData}}),Ty=on(yy),Ay=Y({},Zr,{data:0}),rg=on(Ay),Iy={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Ey={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Cy={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function wy(n){var r=this.nativeEvent;return r.getModifierState?r.getModifierState(n):(n=Cy[n])?!!r[n]:!1}function fc(){return wy}var _y=Y({},vs,{key:function(n){if(n.key){var r=Iy[n.key]||n.key;if(r!=="Unidentified")return r}return n.type==="keypress"?(n=ja(n),n===13?"Enter":String.fromCharCode(n)):n.type==="keydown"||n.type==="keyup"?Ey[n.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:fc,charCode:function(n){return n.type==="keypress"?ja(n):0},keyCode:function(n){return n.type==="keydown"||n.type==="keyup"?n.keyCode:0},which:function(n){return n.type==="keypress"?ja(n):n.type==="keydown"||n.type==="keyup"?n.keyCode:0}}),Ry=on(_y),Py=Y({},Xa,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),og=on(Py),Ny=Y({},vs,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:fc}),Dy=on(Ny),Oy=Y({},Zr,{propertyName:0,elapsedTime:0,pseudoElement:0}),My=on(Oy),ky=Y({},Xa,{deltaX:function(n){return"deltaX"in n?n.deltaX:"wheelDeltaX"in n?-n.wheelDeltaX:0},deltaY:function(n){return"deltaY"in n?n.deltaY:"wheelDeltaY"in n?-n.wheelDeltaY:"wheelDelta"in n?-n.wheelDelta:0},deltaZ:0,deltaMode:0}),Fy=on(ky),Ly=[9,13,27,32],hc=c&&"CompositionEvent"in window,ys=null;c&&"documentMode"in document&&(ys=document.documentMode);var Uy=c&&"TextEvent"in window&&!ys,sg=c&&(!hc||ys&&8<ys&&11>=ys),ag=" ",lg=!1;function ug(n,r){switch(n){case"keyup":return Ly.indexOf(r.keyCode)!==-1;case"keydown":return r.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function cg(n){return n=n.detail,typeof n=="object"&&"data"in n?n.data:null}var qr=!1;function By(n,r){switch(n){case"compositionend":return cg(r);case"keypress":return r.which!==32?null:(lg=!0,ag);case"textInput":return n=r.data,n===ag&&lg?null:n;default:return null}}function Hy(n,r){if(qr)return n==="compositionend"||!hc&&ug(n,r)?(n=tg(),Ya=ac=Ri=null,qr=!1,n):null;switch(n){case"paste":return null;case"keypress":if(!(r.ctrlKey||r.altKey||r.metaKey)||r.ctrlKey&&r.altKey){if(r.char&&1<r.char.length)return r.char;if(r.which)return String.fromCharCode(r.which)}return null;case"compositionend":return sg&&r.locale!=="ko"?null:r.data;default:return null}}var by={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function dg(n){var r=n&&n.nodeName&&n.nodeName.toLowerCase();return r==="input"?!!by[n.type]:r==="textarea"}function fg(n,r,l,d){Mh(d),r=Ja(r,"onChange"),0<r.length&&(l=new lc("onChange","change",null,l,d),n.push({event:l,listeners:r}))}var Ts=null,As=null;function Gy(n){Dg(n,0)}function Ka(n){var r=no(n);if(Se(r))return n}function xy(n,r){if(n==="change")return r}var hg=!1;if(c){var gc;if(c){var pc="oninput"in document;if(!pc){var gg=document.createElement("div");gg.setAttribute("oninput","return;"),pc=typeof gg.oninput=="function"}gc=pc}else gc=!1;hg=gc&&(!document.documentMode||9<document.documentMode)}function pg(){Ts&&(Ts.detachEvent("onpropertychange",mg),As=Ts=null)}function mg(n){if(n.propertyName==="value"&&Ka(As)){var r=[];fg(r,As,n,Xu(n)),Uh(Gy,r)}}function $y(n,r,l){n==="focusin"?(pg(),Ts=r,As=l,Ts.attachEvent("onpropertychange",mg)):n==="focusout"&&pg()}function Wy(n){if(n==="selectionchange"||n==="keyup"||n==="keydown")return Ka(As)}function zy(n,r){if(n==="click")return Ka(r)}function Yy(n,r){if(n==="input"||n==="change")return Ka(r)}function jy(n,r){return n===r&&(n!==0||1/n===1/r)||n!==n&&r!==r}var Nn=typeof Object.is=="function"?Object.is:jy;function Is(n,r){if(Nn(n,r))return!0;if(typeof n!="object"||n===null||typeof r!="object"||r===null)return!1;var l=Object.keys(n),d=Object.keys(r);if(l.length!==d.length)return!1;for(d=0;d<l.length;d++){var h=l[d];if(!f.call(r,h)||!Nn(n[h],r[h]))return!1}return!0}function vg(n){for(;n&&n.firstChild;)n=n.firstChild;return n}function Sg(n,r){var l=vg(n);n=0;for(var d;l;){if(l.nodeType===3){if(d=n+l.textContent.length,n<=r&&d>=r)return{node:l,offset:r-n};n=d}e:{for(;l;){if(l.nextSibling){l=l.nextSibling;break e}l=l.parentNode}l=void 0}l=vg(l)}}function yg(n,r){return n&&r?n===r?!0:n&&n.nodeType===3?!1:r&&r.nodeType===3?yg(n,r.parentNode):"contains"in n?n.contains(r):n.compareDocumentPosition?!!(n.compareDocumentPosition(r)&16):!1:!1}function Tg(){for(var n=window,r=$n();r instanceof n.HTMLIFrameElement;){try{var l=typeof r.contentWindow.location.href=="string"}catch{l=!1}if(l)n=r.contentWindow;else break;r=$n(n.document)}return r}function mc(n){var r=n&&n.nodeName&&n.nodeName.toLowerCase();return r&&(r==="input"&&(n.type==="text"||n.type==="search"||n.type==="tel"||n.type==="url"||n.type==="password")||r==="textarea"||n.contentEditable==="true")}function Vy(n){var r=Tg(),l=n.focusedElem,d=n.selectionRange;if(r!==l&&l&&l.ownerDocument&&yg(l.ownerDocument.documentElement,l)){if(d!==null&&mc(l)){if(r=d.start,n=d.end,n===void 0&&(n=r),"selectionStart"in l)l.selectionStart=r,l.selectionEnd=Math.min(n,l.value.length);else if(n=(r=l.ownerDocument||document)&&r.defaultView||window,n.getSelection){n=n.getSelection();var h=l.textContent.length,p=Math.min(d.start,h);d=d.end===void 0?p:Math.min(d.end,h),!n.extend&&p>d&&(h=d,d=p,p=h),h=Sg(l,p);var S=Sg(l,d);h&&S&&(n.rangeCount!==1||n.anchorNode!==h.node||n.anchorOffset!==h.offset||n.focusNode!==S.node||n.focusOffset!==S.offset)&&(r=r.createRange(),r.setStart(h.node,h.offset),n.removeAllRanges(),p>d?(n.addRange(r),n.extend(S.node,S.offset)):(r.setEnd(S.node,S.offset),n.addRange(r)))}}for(r=[],n=l;n=n.parentNode;)n.nodeType===1&&r.push({element:n,left:n.scrollLeft,top:n.scrollTop});for(typeof l.focus=="function"&&l.focus(),l=0;l<r.length;l++)n=r[l],n.element.scrollLeft=n.left,n.element.scrollTop=n.top}}var Xy=c&&"documentMode"in document&&11>=document.documentMode,Qr=null,vc=null,Es=null,Sc=!1;function Ag(n,r,l){var d=l.window===l?l.document:l.nodeType===9?l:l.ownerDocument;Sc||Qr==null||Qr!==$n(d)||(d=Qr,"selectionStart"in d&&mc(d)?d={start:d.selectionStart,end:d.selectionEnd}:(d=(d.ownerDocument&&d.ownerDocument.defaultView||window).getSelection(),d={anchorNode:d.anchorNode,anchorOffset:d.anchorOffset,focusNode:d.focusNode,focusOffset:d.focusOffset}),Es&&Is(Es,d)||(Es=d,d=Ja(vc,"onSelect"),0<d.length&&(r=new lc("onSelect","select",null,r,l),n.push({event:r,listeners:d}),r.target=Qr)))}function Za(n,r){var l={};return l[n.toLowerCase()]=r.toLowerCase(),l["Webkit"+n]="webkit"+r,l["Moz"+n]="moz"+r,l}var Jr={animationend:Za("Animation","AnimationEnd"),animationiteration:Za("Animation","AnimationIteration"),animationstart:Za("Animation","AnimationStart"),transitionend:Za("Transition","TransitionEnd")},yc={},Ig={};c&&(Ig=document.createElement("div").style,"AnimationEvent"in window||(delete Jr.animationend.animation,delete Jr.animationiteration.animation,delete Jr.animationstart.animation),"TransitionEvent"in window||delete Jr.transitionend.transition);function qa(n){if(yc[n])return yc[n];if(!Jr[n])return n;var r=Jr[n],l;for(l in r)if(r.hasOwnProperty(l)&&l in Ig)return yc[n]=r[l];return n}var Eg=qa("animationend"),Cg=qa("animationiteration"),wg=qa("animationstart"),_g=qa("transitionend"),Rg=new Map,Pg="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Pi(n,r){Rg.set(n,r),s(r,[n])}for(var Tc=0;Tc<Pg.length;Tc++){var Ac=Pg[Tc],Ky=Ac.toLowerCase(),Zy=Ac[0].toUpperCase()+Ac.slice(1);Pi(Ky,"on"+Zy)}Pi(Eg,"onAnimationEnd"),Pi(Cg,"onAnimationIteration"),Pi(wg,"onAnimationStart"),Pi("dblclick","onDoubleClick"),Pi("focusin","onFocus"),Pi("focusout","onBlur"),Pi(_g,"onTransitionEnd"),u("onMouseEnter",["mouseout","mouseover"]),u("onMouseLeave",["mouseout","mouseover"]),u("onPointerEnter",["pointerout","pointerover"]),u("onPointerLeave",["pointerout","pointerover"]),s("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),s("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),s("onBeforeInput",["compositionend","keypress","textInput","paste"]),s("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),s("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),s("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Cs="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),qy=new Set("cancel close invalid load scroll toggle".split(" ").concat(Cs));function Ng(n,r,l){var d=n.type||"unknown-event";n.currentTarget=l,KS(d,r,void 0,n),n.currentTarget=null}function Dg(n,r){r=(r&4)!==0;for(var l=0;l<n.length;l++){var d=n[l],h=d.event;d=d.listeners;e:{var p=void 0;if(r)for(var S=d.length-1;0<=S;S--){var C=d[S],R=C.instance,F=C.currentTarget;if(C=C.listener,R!==p&&h.isPropagationStopped())break e;Ng(h,C,F),p=R}else for(S=0;S<d.length;S++){if(C=d[S],R=C.instance,F=C.currentTarget,C=C.listener,R!==p&&h.isPropagationStopped())break e;Ng(h,C,F),p=R}}}if(La)throw n=Qu,La=!1,Qu=null,n}function qe(n,r){var l=r[Nc];l===void 0&&(l=r[Nc]=new Set);var d=n+"__bubble";l.has(d)||(Og(r,n,2,!1),l.add(d))}function Ic(n,r,l){var d=0;r&&(d|=4),Og(l,n,d,r)}var Qa="_reactListening"+Math.random().toString(36).slice(2);function ws(n){if(!n[Qa]){n[Qa]=!0,o.forEach(function(l){l!=="selectionchange"&&(qy.has(l)||Ic(l,!1,n),Ic(l,!0,n))});var r=n.nodeType===9?n:n.ownerDocument;r===null||r[Qa]||(r[Qa]=!0,Ic("selectionchange",!1,r))}}function Og(n,r,l,d){switch(eg(r)){case 1:var h=dy;break;case 4:h=fy;break;default:h=oc}l=h.bind(null,r,l,n),h=void 0,!qu||r!=="touchstart"&&r!=="touchmove"&&r!=="wheel"||(h=!0),d?h!==void 0?n.addEventListener(r,l,{capture:!0,passive:h}):n.addEventListener(r,l,!0):h!==void 0?n.addEventListener(r,l,{passive:h}):n.addEventListener(r,l,!1)}function Ec(n,r,l,d,h){var p=d;if((r&1)===0&&(r&2)===0&&d!==null)e:for(;;){if(d===null)return;var S=d.tag;if(S===3||S===4){var C=d.stateNode.containerInfo;if(C===h||C.nodeType===8&&C.parentNode===h)break;if(S===4)for(S=d.return;S!==null;){var R=S.tag;if((R===3||R===4)&&(R=S.stateNode.containerInfo,R===h||R.nodeType===8&&R.parentNode===h))return;S=S.return}for(;C!==null;){if(S=fr(C),S===null)return;if(R=S.tag,R===5||R===6){d=p=S;continue e}C=C.parentNode}}d=d.return}Uh(function(){var F=p,$=Xu(l),W=[];e:{var x=Rg.get(n);if(x!==void 0){var q=lc,re=n;switch(n){case"keypress":if(ja(l)===0)break e;case"keydown":case"keyup":q=Ry;break;case"focusin":re="focus",q=dc;break;case"focusout":re="blur",q=dc;break;case"beforeblur":case"afterblur":q=dc;break;case"click":if(l.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":q=ig;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":q=py;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":q=Dy;break;case Eg:case Cg:case wg:q=Sy;break;case _g:q=My;break;case"scroll":q=hy;break;case"wheel":q=Fy;break;case"copy":case"cut":case"paste":q=Ty;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":q=og}var le=(r&4)!==0,ut=!le&&n==="scroll",M=le?x!==null?x+"Capture":null:x;le=[];for(var D=F,k;D!==null;){k=D;var V=k.stateNode;if(k.tag===5&&V!==null&&(k=V,M!==null&&(V=as(D,M),V!=null&&le.push(_s(D,V,k)))),ut)break;D=D.return}0<le.length&&(x=new q(x,re,null,l,$),W.push({event:x,listeners:le}))}}if((r&7)===0){e:{if(x=n==="mouseover"||n==="pointerover",q=n==="mouseout"||n==="pointerout",x&&l!==Vu&&(re=l.relatedTarget||l.fromElement)&&(fr(re)||re[oi]))break e;if((q||x)&&(x=$.window===$?$:(x=$.ownerDocument)?x.defaultView||x.parentWindow:window,q?(re=l.relatedTarget||l.toElement,q=F,re=re?fr(re):null,re!==null&&(ut=dr(re),re!==ut||re.tag!==5&&re.tag!==6)&&(re=null)):(q=null,re=F),q!==re)){if(le=ig,V="onMouseLeave",M="onMouseEnter",D="mouse",(n==="pointerout"||n==="pointerover")&&(le=og,V="onPointerLeave",M="onPointerEnter",D="pointer"),ut=q==null?x:no(q),k=re==null?x:no(re),x=new le(V,D+"leave",q,l,$),x.target=ut,x.relatedTarget=k,V=null,fr($)===F&&(le=new le(M,D+"enter",re,l,$),le.target=k,le.relatedTarget=ut,V=le),ut=V,q&&re)t:{for(le=q,M=re,D=0,k=le;k;k=eo(k))D++;for(k=0,V=M;V;V=eo(V))k++;for(;0<D-k;)le=eo(le),D--;for(;0<k-D;)M=eo(M),k--;for(;D--;){if(le===M||M!==null&&le===M.alternate)break t;le=eo(le),M=eo(M)}le=null}else le=null;q!==null&&Mg(W,x,q,le,!1),re!==null&&ut!==null&&Mg(W,ut,re,le,!0)}}e:{if(x=F?no(F):window,q=x.nodeName&&x.nodeName.toLowerCase(),q==="select"||q==="input"&&x.type==="file")var de=xy;else if(dg(x))if(hg)de=Yy;else{de=Wy;var ye=$y}else(q=x.nodeName)&&q.toLowerCase()==="input"&&(x.type==="checkbox"||x.type==="radio")&&(de=zy);if(de&&(de=de(n,F))){fg(W,de,l,$);break e}ye&&ye(n,x,F),n==="focusout"&&(ye=x._wrapperState)&&ye.controlled&&x.type==="number"&&zn(x,"number",x.value)}switch(ye=F?no(F):window,n){case"focusin":(dg(ye)||ye.contentEditable==="true")&&(Qr=ye,vc=F,Es=null);break;case"focusout":Es=vc=Qr=null;break;case"mousedown":Sc=!0;break;case"contextmenu":case"mouseup":case"dragend":Sc=!1,Ag(W,l,$);break;case"selectionchange":if(Xy)break;case"keydown":case"keyup":Ag(W,l,$)}var Te;if(hc)e:{switch(n){case"compositionstart":var Re="onCompositionStart";break e;case"compositionend":Re="onCompositionEnd";break e;case"compositionupdate":Re="onCompositionUpdate";break e}Re=void 0}else qr?ug(n,l)&&(Re="onCompositionEnd"):n==="keydown"&&l.keyCode===229&&(Re="onCompositionStart");Re&&(sg&&l.locale!=="ko"&&(qr||Re!=="onCompositionStart"?Re==="onCompositionEnd"&&qr&&(Te=tg()):(Ri=$,ac="value"in Ri?Ri.value:Ri.textContent,qr=!0)),ye=Ja(F,Re),0<ye.length&&(Re=new rg(Re,n,null,l,$),W.push({event:Re,listeners:ye}),Te?Re.data=Te:(Te=cg(l),Te!==null&&(Re.data=Te)))),(Te=Uy?By(n,l):Hy(n,l))&&(F=Ja(F,"onBeforeInput"),0<F.length&&($=new rg("onBeforeInput","beforeinput",null,l,$),W.push({event:$,listeners:F}),$.data=Te))}Dg(W,r)})}function _s(n,r,l){return{instance:n,listener:r,currentTarget:l}}function Ja(n,r){for(var l=r+"Capture",d=[];n!==null;){var h=n,p=h.stateNode;h.tag===5&&p!==null&&(h=p,p=as(n,l),p!=null&&d.unshift(_s(n,p,h)),p=as(n,r),p!=null&&d.push(_s(n,p,h))),n=n.return}return d}function eo(n){if(n===null)return null;do n=n.return;while(n&&n.tag!==5);return n||null}function Mg(n,r,l,d,h){for(var p=r._reactName,S=[];l!==null&&l!==d;){var C=l,R=C.alternate,F=C.stateNode;if(R!==null&&R===d)break;C.tag===5&&F!==null&&(C=F,h?(R=as(l,p),R!=null&&S.unshift(_s(l,R,C))):h||(R=as(l,p),R!=null&&S.push(_s(l,R,C)))),l=l.return}S.length!==0&&n.push({event:r,listeners:S})}var Qy=/\r\n?/g,Jy=/\u0000|\uFFFD/g;function kg(n){return(typeof n=="string"?n:""+n).replace(Qy,`
`).replace(Jy,"")}function el(n,r,l){if(r=kg(r),kg(n)!==r&&l)throw Error(i(425))}function tl(){}var Cc=null,wc=null;function _c(n,r){return n==="textarea"||n==="noscript"||typeof r.children=="string"||typeof r.children=="number"||typeof r.dangerouslySetInnerHTML=="object"&&r.dangerouslySetInnerHTML!==null&&r.dangerouslySetInnerHTML.__html!=null}var Rc=typeof setTimeout=="function"?setTimeout:void 0,eT=typeof clearTimeout=="function"?clearTimeout:void 0,Fg=typeof Promise=="function"?Promise:void 0,tT=typeof queueMicrotask=="function"?queueMicrotask:typeof Fg<"u"?function(n){return Fg.resolve(null).then(n).catch(nT)}:Rc;function nT(n){setTimeout(function(){throw n})}function Pc(n,r){var l=r,d=0;do{var h=l.nextSibling;if(n.removeChild(l),h&&h.nodeType===8)if(l=h.data,l==="/$"){if(d===0){n.removeChild(h),ms(r);return}d--}else l!=="$"&&l!=="$?"&&l!=="$!"||d++;l=h}while(l);ms(r)}function Ni(n){for(;n!=null;n=n.nextSibling){var r=n.nodeType;if(r===1||r===3)break;if(r===8){if(r=n.data,r==="$"||r==="$!"||r==="$?")break;if(r==="/$")return null}}return n}function Lg(n){n=n.previousSibling;for(var r=0;n;){if(n.nodeType===8){var l=n.data;if(l==="$"||l==="$!"||l==="$?"){if(r===0)return n;r--}else l==="/$"&&r++}n=n.previousSibling}return null}var to=Math.random().toString(36).slice(2),Vn="__reactFiber$"+to,Rs="__reactProps$"+to,oi="__reactContainer$"+to,Nc="__reactEvents$"+to,iT="__reactListeners$"+to,rT="__reactHandles$"+to;function fr(n){var r=n[Vn];if(r)return r;for(var l=n.parentNode;l;){if(r=l[oi]||l[Vn]){if(l=r.alternate,r.child!==null||l!==null&&l.child!==null)for(n=Lg(n);n!==null;){if(l=n[Vn])return l;n=Lg(n)}return r}n=l,l=n.parentNode}return null}function Ps(n){return n=n[Vn]||n[oi],!n||n.tag!==5&&n.tag!==6&&n.tag!==13&&n.tag!==3?null:n}function no(n){if(n.tag===5||n.tag===6)return n.stateNode;throw Error(i(33))}function nl(n){return n[Rs]||null}var Dc=[],io=-1;function Di(n){return{current:n}}function Qe(n){0>io||(n.current=Dc[io],Dc[io]=null,io--)}function je(n,r){io++,Dc[io]=n.current,n.current=r}var Oi={},Mt=Di(Oi),Kt=Di(!1),hr=Oi;function ro(n,r){var l=n.type.contextTypes;if(!l)return Oi;var d=n.stateNode;if(d&&d.__reactInternalMemoizedUnmaskedChildContext===r)return d.__reactInternalMemoizedMaskedChildContext;var h={},p;for(p in l)h[p]=r[p];return d&&(n=n.stateNode,n.__reactInternalMemoizedUnmaskedChildContext=r,n.__reactInternalMemoizedMaskedChildContext=h),h}function Zt(n){return n=n.childContextTypes,n!=null}function il(){Qe(Kt),Qe(Mt)}function Ug(n,r,l){if(Mt.current!==Oi)throw Error(i(168));je(Mt,r),je(Kt,l)}function Bg(n,r,l){var d=n.stateNode;if(r=r.childContextTypes,typeof d.getChildContext!="function")return l;d=d.getChildContext();for(var h in d)if(!(h in r))throw Error(i(108,_e(n)||"Unknown",h));return Y({},l,d)}function rl(n){return n=(n=n.stateNode)&&n.__reactInternalMemoizedMergedChildContext||Oi,hr=Mt.current,je(Mt,n),je(Kt,Kt.current),!0}function Hg(n,r,l){var d=n.stateNode;if(!d)throw Error(i(169));l?(n=Bg(n,r,hr),d.__reactInternalMemoizedMergedChildContext=n,Qe(Kt),Qe(Mt),je(Mt,n)):Qe(Kt),je(Kt,l)}var si=null,ol=!1,Oc=!1;function bg(n){si===null?si=[n]:si.push(n)}function oT(n){ol=!0,bg(n)}function Mi(){if(!Oc&&si!==null){Oc=!0;var n=0,r=ze;try{var l=si;for(ze=1;n<l.length;n++){var d=l[n];do d=d(!0);while(d!==null)}si=null,ol=!1}catch(h){throw si!==null&&(si=si.slice(n+1)),xh(Ju,Mi),h}finally{ze=r,Oc=!1}}return null}var oo=[],so=0,sl=null,al=0,pn=[],mn=0,gr=null,ai=1,li="";function pr(n,r){oo[so++]=al,oo[so++]=sl,sl=n,al=r}function Gg(n,r,l){pn[mn++]=ai,pn[mn++]=li,pn[mn++]=gr,gr=n;var d=ai;n=li;var h=32-Pn(d)-1;d&=~(1<<h),l+=1;var p=32-Pn(r)+h;if(30<p){var S=h-h%5;p=(d&(1<<S)-1).toString(32),d>>=S,h-=S,ai=1<<32-Pn(r)+h|l<<h|d,li=p+n}else ai=1<<p|l<<h|d,li=n}function Mc(n){n.return!==null&&(pr(n,1),Gg(n,1,0))}function kc(n){for(;n===sl;)sl=oo[--so],oo[so]=null,al=oo[--so],oo[so]=null;for(;n===gr;)gr=pn[--mn],pn[mn]=null,li=pn[--mn],pn[mn]=null,ai=pn[--mn],pn[mn]=null}var sn=null,an=null,nt=!1,Dn=null;function xg(n,r){var l=Tn(5,null,null,0);l.elementType="DELETED",l.stateNode=r,l.return=n,r=n.deletions,r===null?(n.deletions=[l],n.flags|=16):r.push(l)}function $g(n,r){switch(n.tag){case 5:var l=n.type;return r=r.nodeType!==1||l.toLowerCase()!==r.nodeName.toLowerCase()?null:r,r!==null?(n.stateNode=r,sn=n,an=Ni(r.firstChild),!0):!1;case 6:return r=n.pendingProps===""||r.nodeType!==3?null:r,r!==null?(n.stateNode=r,sn=n,an=null,!0):!1;case 13:return r=r.nodeType!==8?null:r,r!==null?(l=gr!==null?{id:ai,overflow:li}:null,n.memoizedState={dehydrated:r,treeContext:l,retryLane:1073741824},l=Tn(18,null,null,0),l.stateNode=r,l.return=n,n.child=l,sn=n,an=null,!0):!1;default:return!1}}function Fc(n){return(n.mode&1)!==0&&(n.flags&128)===0}function Lc(n){if(nt){var r=an;if(r){var l=r;if(!$g(n,r)){if(Fc(n))throw Error(i(418));r=Ni(l.nextSibling);var d=sn;r&&$g(n,r)?xg(d,l):(n.flags=n.flags&-4097|2,nt=!1,sn=n)}}else{if(Fc(n))throw Error(i(418));n.flags=n.flags&-4097|2,nt=!1,sn=n}}}function Wg(n){for(n=n.return;n!==null&&n.tag!==5&&n.tag!==3&&n.tag!==13;)n=n.return;sn=n}function ll(n){if(n!==sn)return!1;if(!nt)return Wg(n),nt=!0,!1;var r;if((r=n.tag!==3)&&!(r=n.tag!==5)&&(r=n.type,r=r!=="head"&&r!=="body"&&!_c(n.type,n.memoizedProps)),r&&(r=an)){if(Fc(n))throw zg(),Error(i(418));for(;r;)xg(n,r),r=Ni(r.nextSibling)}if(Wg(n),n.tag===13){if(n=n.memoizedState,n=n!==null?n.dehydrated:null,!n)throw Error(i(317));e:{for(n=n.nextSibling,r=0;n;){if(n.nodeType===8){var l=n.data;if(l==="/$"){if(r===0){an=Ni(n.nextSibling);break e}r--}else l!=="$"&&l!=="$!"&&l!=="$?"||r++}n=n.nextSibling}an=null}}else an=sn?Ni(n.stateNode.nextSibling):null;return!0}function zg(){for(var n=an;n;)n=Ni(n.nextSibling)}function ao(){an=sn=null,nt=!1}function Uc(n){Dn===null?Dn=[n]:Dn.push(n)}var sT=H.ReactCurrentBatchConfig;function Ns(n,r,l){if(n=l.ref,n!==null&&typeof n!="function"&&typeof n!="object"){if(l._owner){if(l=l._owner,l){if(l.tag!==1)throw Error(i(309));var d=l.stateNode}if(!d)throw Error(i(147,n));var h=d,p=""+n;return r!==null&&r.ref!==null&&typeof r.ref=="function"&&r.ref._stringRef===p?r.ref:(r=function(S){var C=h.refs;S===null?delete C[p]:C[p]=S},r._stringRef=p,r)}if(typeof n!="string")throw Error(i(284));if(!l._owner)throw Error(i(290,n))}return n}function ul(n,r){throw n=Object.prototype.toString.call(r),Error(i(31,n==="[object Object]"?"object with keys {"+Object.keys(r).join(", ")+"}":n))}function Yg(n){var r=n._init;return r(n._payload)}function jg(n){function r(M,D){if(n){var k=M.deletions;k===null?(M.deletions=[D],M.flags|=16):k.push(D)}}function l(M,D){if(!n)return null;for(;D!==null;)r(M,D),D=D.sibling;return null}function d(M,D){for(M=new Map;D!==null;)D.key!==null?M.set(D.key,D):M.set(D.index,D),D=D.sibling;return M}function h(M,D){return M=Gi(M,D),M.index=0,M.sibling=null,M}function p(M,D,k){return M.index=k,n?(k=M.alternate,k!==null?(k=k.index,k<D?(M.flags|=2,D):k):(M.flags|=2,D)):(M.flags|=1048576,D)}function S(M){return n&&M.alternate===null&&(M.flags|=2),M}function C(M,D,k,V){return D===null||D.tag!==6?(D=Rd(k,M.mode,V),D.return=M,D):(D=h(D,k),D.return=M,D)}function R(M,D,k,V){var de=k.type;return de===G?$(M,D,k.props.children,V,k.key):D!==null&&(D.elementType===de||typeof de=="object"&&de!==null&&de.$$typeof===ve&&Yg(de)===D.type)?(V=h(D,k.props),V.ref=Ns(M,D,k),V.return=M,V):(V=kl(k.type,k.key,k.props,null,M.mode,V),V.ref=Ns(M,D,k),V.return=M,V)}function F(M,D,k,V){return D===null||D.tag!==4||D.stateNode.containerInfo!==k.containerInfo||D.stateNode.implementation!==k.implementation?(D=Pd(k,M.mode,V),D.return=M,D):(D=h(D,k.children||[]),D.return=M,D)}function $(M,D,k,V,de){return D===null||D.tag!==7?(D=Er(k,M.mode,V,de),D.return=M,D):(D=h(D,k),D.return=M,D)}function W(M,D,k){if(typeof D=="string"&&D!==""||typeof D=="number")return D=Rd(""+D,M.mode,k),D.return=M,D;if(typeof D=="object"&&D!==null){switch(D.$$typeof){case b:return k=kl(D.type,D.key,D.props,null,M.mode,k),k.ref=Ns(M,null,D),k.return=M,k;case U:return D=Pd(D,M.mode,k),D.return=M,D;case ve:var V=D._init;return W(M,V(D._payload),k)}if(Yn(D)||X(D))return D=Er(D,M.mode,k,null),D.return=M,D;ul(M,D)}return null}function x(M,D,k,V){var de=D!==null?D.key:null;if(typeof k=="string"&&k!==""||typeof k=="number")return de!==null?null:C(M,D,""+k,V);if(typeof k=="object"&&k!==null){switch(k.$$typeof){case b:return k.key===de?R(M,D,k,V):null;case U:return k.key===de?F(M,D,k,V):null;case ve:return de=k._init,x(M,D,de(k._payload),V)}if(Yn(k)||X(k))return de!==null?null:$(M,D,k,V,null);ul(M,k)}return null}function q(M,D,k,V,de){if(typeof V=="string"&&V!==""||typeof V=="number")return M=M.get(k)||null,C(D,M,""+V,de);if(typeof V=="object"&&V!==null){switch(V.$$typeof){case b:return M=M.get(V.key===null?k:V.key)||null,R(D,M,V,de);case U:return M=M.get(V.key===null?k:V.key)||null,F(D,M,V,de);case ve:var ye=V._init;return q(M,D,k,ye(V._payload),de)}if(Yn(V)||X(V))return M=M.get(k)||null,$(D,M,V,de,null);ul(D,V)}return null}function re(M,D,k,V){for(var de=null,ye=null,Te=D,Re=D=0,It=null;Te!==null&&Re<k.length;Re++){Te.index>Re?(It=Te,Te=null):It=Te.sibling;var xe=x(M,Te,k[Re],V);if(xe===null){Te===null&&(Te=It);break}n&&Te&&xe.alternate===null&&r(M,Te),D=p(xe,D,Re),ye===null?de=xe:ye.sibling=xe,ye=xe,Te=It}if(Re===k.length)return l(M,Te),nt&&pr(M,Re),de;if(Te===null){for(;Re<k.length;Re++)Te=W(M,k[Re],V),Te!==null&&(D=p(Te,D,Re),ye===null?de=Te:ye.sibling=Te,ye=Te);return nt&&pr(M,Re),de}for(Te=d(M,Te);Re<k.length;Re++)It=q(Te,M,Re,k[Re],V),It!==null&&(n&&It.alternate!==null&&Te.delete(It.key===null?Re:It.key),D=p(It,D,Re),ye===null?de=It:ye.sibling=It,ye=It);return n&&Te.forEach(function(xi){return r(M,xi)}),nt&&pr(M,Re),de}function le(M,D,k,V){var de=X(k);if(typeof de!="function")throw Error(i(150));if(k=de.call(k),k==null)throw Error(i(151));for(var ye=de=null,Te=D,Re=D=0,It=null,xe=k.next();Te!==null&&!xe.done;Re++,xe=k.next()){Te.index>Re?(It=Te,Te=null):It=Te.sibling;var xi=x(M,Te,xe.value,V);if(xi===null){Te===null&&(Te=It);break}n&&Te&&xi.alternate===null&&r(M,Te),D=p(xi,D,Re),ye===null?de=xi:ye.sibling=xi,ye=xi,Te=It}if(xe.done)return l(M,Te),nt&&pr(M,Re),de;if(Te===null){for(;!xe.done;Re++,xe=k.next())xe=W(M,xe.value,V),xe!==null&&(D=p(xe,D,Re),ye===null?de=xe:ye.sibling=xe,ye=xe);return nt&&pr(M,Re),de}for(Te=d(M,Te);!xe.done;Re++,xe=k.next())xe=q(Te,M,Re,xe.value,V),xe!==null&&(n&&xe.alternate!==null&&Te.delete(xe.key===null?Re:xe.key),D=p(xe,D,Re),ye===null?de=xe:ye.sibling=xe,ye=xe);return n&&Te.forEach(function(bT){return r(M,bT)}),nt&&pr(M,Re),de}function ut(M,D,k,V){if(typeof k=="object"&&k!==null&&k.type===G&&k.key===null&&(k=k.props.children),typeof k=="object"&&k!==null){switch(k.$$typeof){case b:e:{for(var de=k.key,ye=D;ye!==null;){if(ye.key===de){if(de=k.type,de===G){if(ye.tag===7){l(M,ye.sibling),D=h(ye,k.props.children),D.return=M,M=D;break e}}else if(ye.elementType===de||typeof de=="object"&&de!==null&&de.$$typeof===ve&&Yg(de)===ye.type){l(M,ye.sibling),D=h(ye,k.props),D.ref=Ns(M,ye,k),D.return=M,M=D;break e}l(M,ye);break}else r(M,ye);ye=ye.sibling}k.type===G?(D=Er(k.props.children,M.mode,V,k.key),D.return=M,M=D):(V=kl(k.type,k.key,k.props,null,M.mode,V),V.ref=Ns(M,D,k),V.return=M,M=V)}return S(M);case U:e:{for(ye=k.key;D!==null;){if(D.key===ye)if(D.tag===4&&D.stateNode.containerInfo===k.containerInfo&&D.stateNode.implementation===k.implementation){l(M,D.sibling),D=h(D,k.children||[]),D.return=M,M=D;break e}else{l(M,D);break}else r(M,D);D=D.sibling}D=Pd(k,M.mode,V),D.return=M,M=D}return S(M);case ve:return ye=k._init,ut(M,D,ye(k._payload),V)}if(Yn(k))return re(M,D,k,V);if(X(k))return le(M,D,k,V);ul(M,k)}return typeof k=="string"&&k!==""||typeof k=="number"?(k=""+k,D!==null&&D.tag===6?(l(M,D.sibling),D=h(D,k),D.return=M,M=D):(l(M,D),D=Rd(k,M.mode,V),D.return=M,M=D),S(M)):l(M,D)}return ut}var lo=jg(!0),Vg=jg(!1),cl=Di(null),dl=null,uo=null,Bc=null;function Hc(){Bc=uo=dl=null}function bc(n){var r=cl.current;Qe(cl),n._currentValue=r}function Gc(n,r,l){for(;n!==null;){var d=n.alternate;if((n.childLanes&r)!==r?(n.childLanes|=r,d!==null&&(d.childLanes|=r)):d!==null&&(d.childLanes&r)!==r&&(d.childLanes|=r),n===l)break;n=n.return}}function co(n,r){dl=n,Bc=uo=null,n=n.dependencies,n!==null&&n.firstContext!==null&&((n.lanes&r)!==0&&(qt=!0),n.firstContext=null)}function vn(n){var r=n._currentValue;if(Bc!==n)if(n={context:n,memoizedValue:r,next:null},uo===null){if(dl===null)throw Error(i(308));uo=n,dl.dependencies={lanes:0,firstContext:n}}else uo=uo.next=n;return r}var mr=null;function xc(n){mr===null?mr=[n]:mr.push(n)}function Xg(n,r,l,d){var h=r.interleaved;return h===null?(l.next=l,xc(r)):(l.next=h.next,h.next=l),r.interleaved=l,ui(n,d)}function ui(n,r){n.lanes|=r;var l=n.alternate;for(l!==null&&(l.lanes|=r),l=n,n=n.return;n!==null;)n.childLanes|=r,l=n.alternate,l!==null&&(l.childLanes|=r),l=n,n=n.return;return l.tag===3?l.stateNode:null}var ki=!1;function $c(n){n.updateQueue={baseState:n.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Kg(n,r){n=n.updateQueue,r.updateQueue===n&&(r.updateQueue={baseState:n.baseState,firstBaseUpdate:n.firstBaseUpdate,lastBaseUpdate:n.lastBaseUpdate,shared:n.shared,effects:n.effects})}function ci(n,r){return{eventTime:n,lane:r,tag:0,payload:null,callback:null,next:null}}function Fi(n,r,l){var d=n.updateQueue;if(d===null)return null;if(d=d.shared,(Ge&2)!==0){var h=d.pending;return h===null?r.next=r:(r.next=h.next,h.next=r),d.pending=r,ui(n,l)}return h=d.interleaved,h===null?(r.next=r,xc(d)):(r.next=h.next,h.next=r),d.interleaved=r,ui(n,l)}function fl(n,r,l){if(r=r.updateQueue,r!==null&&(r=r.shared,(l&4194240)!==0)){var d=r.lanes;d&=n.pendingLanes,l|=d,r.lanes=l,nc(n,l)}}function Zg(n,r){var l=n.updateQueue,d=n.alternate;if(d!==null&&(d=d.updateQueue,l===d)){var h=null,p=null;if(l=l.firstBaseUpdate,l!==null){do{var S={eventTime:l.eventTime,lane:l.lane,tag:l.tag,payload:l.payload,callback:l.callback,next:null};p===null?h=p=S:p=p.next=S,l=l.next}while(l!==null);p===null?h=p=r:p=p.next=r}else h=p=r;l={baseState:d.baseState,firstBaseUpdate:h,lastBaseUpdate:p,shared:d.shared,effects:d.effects},n.updateQueue=l;return}n=l.lastBaseUpdate,n===null?l.firstBaseUpdate=r:n.next=r,l.lastBaseUpdate=r}function hl(n,r,l,d){var h=n.updateQueue;ki=!1;var p=h.firstBaseUpdate,S=h.lastBaseUpdate,C=h.shared.pending;if(C!==null){h.shared.pending=null;var R=C,F=R.next;R.next=null,S===null?p=F:S.next=F,S=R;var $=n.alternate;$!==null&&($=$.updateQueue,C=$.lastBaseUpdate,C!==S&&(C===null?$.firstBaseUpdate=F:C.next=F,$.lastBaseUpdate=R))}if(p!==null){var W=h.baseState;S=0,$=F=R=null,C=p;do{var x=C.lane,q=C.eventTime;if((d&x)===x){$!==null&&($=$.next={eventTime:q,lane:0,tag:C.tag,payload:C.payload,callback:C.callback,next:null});e:{var re=n,le=C;switch(x=r,q=l,le.tag){case 1:if(re=le.payload,typeof re=="function"){W=re.call(q,W,x);break e}W=re;break e;case 3:re.flags=re.flags&-65537|128;case 0:if(re=le.payload,x=typeof re=="function"?re.call(q,W,x):re,x==null)break e;W=Y({},W,x);break e;case 2:ki=!0}}C.callback!==null&&C.lane!==0&&(n.flags|=64,x=h.effects,x===null?h.effects=[C]:x.push(C))}else q={eventTime:q,lane:x,tag:C.tag,payload:C.payload,callback:C.callback,next:null},$===null?(F=$=q,R=W):$=$.next=q,S|=x;if(C=C.next,C===null){if(C=h.shared.pending,C===null)break;x=C,C=x.next,x.next=null,h.lastBaseUpdate=x,h.shared.pending=null}}while(!0);if($===null&&(R=W),h.baseState=R,h.firstBaseUpdate=F,h.lastBaseUpdate=$,r=h.shared.interleaved,r!==null){h=r;do S|=h.lane,h=h.next;while(h!==r)}else p===null&&(h.shared.lanes=0);yr|=S,n.lanes=S,n.memoizedState=W}}function qg(n,r,l){if(n=r.effects,r.effects=null,n!==null)for(r=0;r<n.length;r++){var d=n[r],h=d.callback;if(h!==null){if(d.callback=null,d=l,typeof h!="function")throw Error(i(191,h));h.call(d)}}}var Ds={},Xn=Di(Ds),Os=Di(Ds),Ms=Di(Ds);function vr(n){if(n===Ds)throw Error(i(174));return n}function Wc(n,r){switch(je(Ms,r),je(Os,n),je(Xn,Ds),n=r.nodeType,n){case 9:case 11:r=(r=r.documentElement)?r.namespaceURI:zu(null,"");break;default:n=n===8?r.parentNode:r,r=n.namespaceURI||null,n=n.tagName,r=zu(r,n)}Qe(Xn),je(Xn,r)}function fo(){Qe(Xn),Qe(Os),Qe(Ms)}function Qg(n){vr(Ms.current);var r=vr(Xn.current),l=zu(r,n.type);r!==l&&(je(Os,n),je(Xn,l))}function zc(n){Os.current===n&&(Qe(Xn),Qe(Os))}var rt=Di(0);function gl(n){for(var r=n;r!==null;){if(r.tag===13){var l=r.memoizedState;if(l!==null&&(l=l.dehydrated,l===null||l.data==="$?"||l.data==="$!"))return r}else if(r.tag===19&&r.memoizedProps.revealOrder!==void 0){if((r.flags&128)!==0)return r}else if(r.child!==null){r.child.return=r,r=r.child;continue}if(r===n)break;for(;r.sibling===null;){if(r.return===null||r.return===n)return null;r=r.return}r.sibling.return=r.return,r=r.sibling}return null}var Yc=[];function jc(){for(var n=0;n<Yc.length;n++)Yc[n]._workInProgressVersionPrimary=null;Yc.length=0}var pl=H.ReactCurrentDispatcher,Vc=H.ReactCurrentBatchConfig,Sr=0,ot=null,mt=null,Tt=null,ml=!1,ks=!1,Fs=0,aT=0;function kt(){throw Error(i(321))}function Xc(n,r){if(r===null)return!1;for(var l=0;l<r.length&&l<n.length;l++)if(!Nn(n[l],r[l]))return!1;return!0}function Kc(n,r,l,d,h,p){if(Sr=p,ot=r,r.memoizedState=null,r.updateQueue=null,r.lanes=0,pl.current=n===null||n.memoizedState===null?dT:fT,n=l(d,h),ks){p=0;do{if(ks=!1,Fs=0,25<=p)throw Error(i(301));p+=1,Tt=mt=null,r.updateQueue=null,pl.current=hT,n=l(d,h)}while(ks)}if(pl.current=yl,r=mt!==null&&mt.next!==null,Sr=0,Tt=mt=ot=null,ml=!1,r)throw Error(i(300));return n}function Zc(){var n=Fs!==0;return Fs=0,n}function Kn(){var n={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Tt===null?ot.memoizedState=Tt=n:Tt=Tt.next=n,Tt}function Sn(){if(mt===null){var n=ot.alternate;n=n!==null?n.memoizedState:null}else n=mt.next;var r=Tt===null?ot.memoizedState:Tt.next;if(r!==null)Tt=r,mt=n;else{if(n===null)throw Error(i(310));mt=n,n={memoizedState:mt.memoizedState,baseState:mt.baseState,baseQueue:mt.baseQueue,queue:mt.queue,next:null},Tt===null?ot.memoizedState=Tt=n:Tt=Tt.next=n}return Tt}function Ls(n,r){return typeof r=="function"?r(n):r}function qc(n){var r=Sn(),l=r.queue;if(l===null)throw Error(i(311));l.lastRenderedReducer=n;var d=mt,h=d.baseQueue,p=l.pending;if(p!==null){if(h!==null){var S=h.next;h.next=p.next,p.next=S}d.baseQueue=h=p,l.pending=null}if(h!==null){p=h.next,d=d.baseState;var C=S=null,R=null,F=p;do{var $=F.lane;if((Sr&$)===$)R!==null&&(R=R.next={lane:0,action:F.action,hasEagerState:F.hasEagerState,eagerState:F.eagerState,next:null}),d=F.hasEagerState?F.eagerState:n(d,F.action);else{var W={lane:$,action:F.action,hasEagerState:F.hasEagerState,eagerState:F.eagerState,next:null};R===null?(C=R=W,S=d):R=R.next=W,ot.lanes|=$,yr|=$}F=F.next}while(F!==null&&F!==p);R===null?S=d:R.next=C,Nn(d,r.memoizedState)||(qt=!0),r.memoizedState=d,r.baseState=S,r.baseQueue=R,l.lastRenderedState=d}if(n=l.interleaved,n!==null){h=n;do p=h.lane,ot.lanes|=p,yr|=p,h=h.next;while(h!==n)}else h===null&&(l.lanes=0);return[r.memoizedState,l.dispatch]}function Qc(n){var r=Sn(),l=r.queue;if(l===null)throw Error(i(311));l.lastRenderedReducer=n;var d=l.dispatch,h=l.pending,p=r.memoizedState;if(h!==null){l.pending=null;var S=h=h.next;do p=n(p,S.action),S=S.next;while(S!==h);Nn(p,r.memoizedState)||(qt=!0),r.memoizedState=p,r.baseQueue===null&&(r.baseState=p),l.lastRenderedState=p}return[p,d]}function Jg(){}function ep(n,r){var l=ot,d=Sn(),h=r(),p=!Nn(d.memoizedState,h);if(p&&(d.memoizedState=h,qt=!0),d=d.queue,Jc(ip.bind(null,l,d,n),[n]),d.getSnapshot!==r||p||Tt!==null&&Tt.memoizedState.tag&1){if(l.flags|=2048,Us(9,np.bind(null,l,d,h,r),void 0,null),At===null)throw Error(i(349));(Sr&30)!==0||tp(l,r,h)}return h}function tp(n,r,l){n.flags|=16384,n={getSnapshot:r,value:l},r=ot.updateQueue,r===null?(r={lastEffect:null,stores:null},ot.updateQueue=r,r.stores=[n]):(l=r.stores,l===null?r.stores=[n]:l.push(n))}function np(n,r,l,d){r.value=l,r.getSnapshot=d,rp(r)&&op(n)}function ip(n,r,l){return l(function(){rp(r)&&op(n)})}function rp(n){var r=n.getSnapshot;n=n.value;try{var l=r();return!Nn(n,l)}catch{return!0}}function op(n){var r=ui(n,1);r!==null&&Fn(r,n,1,-1)}function sp(n){var r=Kn();return typeof n=="function"&&(n=n()),r.memoizedState=r.baseState=n,n={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Ls,lastRenderedState:n},r.queue=n,n=n.dispatch=cT.bind(null,ot,n),[r.memoizedState,n]}function Us(n,r,l,d){return n={tag:n,create:r,destroy:l,deps:d,next:null},r=ot.updateQueue,r===null?(r={lastEffect:null,stores:null},ot.updateQueue=r,r.lastEffect=n.next=n):(l=r.lastEffect,l===null?r.lastEffect=n.next=n:(d=l.next,l.next=n,n.next=d,r.lastEffect=n)),n}function ap(){return Sn().memoizedState}function vl(n,r,l,d){var h=Kn();ot.flags|=n,h.memoizedState=Us(1|r,l,void 0,d===void 0?null:d)}function Sl(n,r,l,d){var h=Sn();d=d===void 0?null:d;var p=void 0;if(mt!==null){var S=mt.memoizedState;if(p=S.destroy,d!==null&&Xc(d,S.deps)){h.memoizedState=Us(r,l,p,d);return}}ot.flags|=n,h.memoizedState=Us(1|r,l,p,d)}function lp(n,r){return vl(8390656,8,n,r)}function Jc(n,r){return Sl(2048,8,n,r)}function up(n,r){return Sl(4,2,n,r)}function cp(n,r){return Sl(4,4,n,r)}function dp(n,r){if(typeof r=="function")return n=n(),r(n),function(){r(null)};if(r!=null)return n=n(),r.current=n,function(){r.current=null}}function fp(n,r,l){return l=l!=null?l.concat([n]):null,Sl(4,4,dp.bind(null,r,n),l)}function ed(){}function hp(n,r){var l=Sn();r=r===void 0?null:r;var d=l.memoizedState;return d!==null&&r!==null&&Xc(r,d[1])?d[0]:(l.memoizedState=[n,r],n)}function gp(n,r){var l=Sn();r=r===void 0?null:r;var d=l.memoizedState;return d!==null&&r!==null&&Xc(r,d[1])?d[0]:(n=n(),l.memoizedState=[n,r],n)}function pp(n,r,l){return(Sr&21)===0?(n.baseState&&(n.baseState=!1,qt=!0),n.memoizedState=l):(Nn(l,r)||(l=Yh(),ot.lanes|=l,yr|=l,n.baseState=!0),r)}function lT(n,r){var l=ze;ze=l!==0&&4>l?l:4,n(!0);var d=Vc.transition;Vc.transition={};try{n(!1),r()}finally{ze=l,Vc.transition=d}}function mp(){return Sn().memoizedState}function uT(n,r,l){var d=Hi(n);if(l={lane:d,action:l,hasEagerState:!1,eagerState:null,next:null},vp(n))Sp(r,l);else if(l=Xg(n,r,l,d),l!==null){var h=xt();Fn(l,n,d,h),yp(l,r,d)}}function cT(n,r,l){var d=Hi(n),h={lane:d,action:l,hasEagerState:!1,eagerState:null,next:null};if(vp(n))Sp(r,h);else{var p=n.alternate;if(n.lanes===0&&(p===null||p.lanes===0)&&(p=r.lastRenderedReducer,p!==null))try{var S=r.lastRenderedState,C=p(S,l);if(h.hasEagerState=!0,h.eagerState=C,Nn(C,S)){var R=r.interleaved;R===null?(h.next=h,xc(r)):(h.next=R.next,R.next=h),r.interleaved=h;return}}catch{}finally{}l=Xg(n,r,h,d),l!==null&&(h=xt(),Fn(l,n,d,h),yp(l,r,d))}}function vp(n){var r=n.alternate;return n===ot||r!==null&&r===ot}function Sp(n,r){ks=ml=!0;var l=n.pending;l===null?r.next=r:(r.next=l.next,l.next=r),n.pending=r}function yp(n,r,l){if((l&4194240)!==0){var d=r.lanes;d&=n.pendingLanes,l|=d,r.lanes=l,nc(n,l)}}var yl={readContext:vn,useCallback:kt,useContext:kt,useEffect:kt,useImperativeHandle:kt,useInsertionEffect:kt,useLayoutEffect:kt,useMemo:kt,useReducer:kt,useRef:kt,useState:kt,useDebugValue:kt,useDeferredValue:kt,useTransition:kt,useMutableSource:kt,useSyncExternalStore:kt,useId:kt,unstable_isNewReconciler:!1},dT={readContext:vn,useCallback:function(n,r){return Kn().memoizedState=[n,r===void 0?null:r],n},useContext:vn,useEffect:lp,useImperativeHandle:function(n,r,l){return l=l!=null?l.concat([n]):null,vl(4194308,4,dp.bind(null,r,n),l)},useLayoutEffect:function(n,r){return vl(4194308,4,n,r)},useInsertionEffect:function(n,r){return vl(4,2,n,r)},useMemo:function(n,r){var l=Kn();return r=r===void 0?null:r,n=n(),l.memoizedState=[n,r],n},useReducer:function(n,r,l){var d=Kn();return r=l!==void 0?l(r):r,d.memoizedState=d.baseState=r,n={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:n,lastRenderedState:r},d.queue=n,n=n.dispatch=uT.bind(null,ot,n),[d.memoizedState,n]},useRef:function(n){var r=Kn();return n={current:n},r.memoizedState=n},useState:sp,useDebugValue:ed,useDeferredValue:function(n){return Kn().memoizedState=n},useTransition:function(){var n=sp(!1),r=n[0];return n=lT.bind(null,n[1]),Kn().memoizedState=n,[r,n]},useMutableSource:function(){},useSyncExternalStore:function(n,r,l){var d=ot,h=Kn();if(nt){if(l===void 0)throw Error(i(407));l=l()}else{if(l=r(),At===null)throw Error(i(349));(Sr&30)!==0||tp(d,r,l)}h.memoizedState=l;var p={value:l,getSnapshot:r};return h.queue=p,lp(ip.bind(null,d,p,n),[n]),d.flags|=2048,Us(9,np.bind(null,d,p,l,r),void 0,null),l},useId:function(){var n=Kn(),r=At.identifierPrefix;if(nt){var l=li,d=ai;l=(d&~(1<<32-Pn(d)-1)).toString(32)+l,r=":"+r+"R"+l,l=Fs++,0<l&&(r+="H"+l.toString(32)),r+=":"}else l=aT++,r=":"+r+"r"+l.toString(32)+":";return n.memoizedState=r},unstable_isNewReconciler:!1},fT={readContext:vn,useCallback:hp,useContext:vn,useEffect:Jc,useImperativeHandle:fp,useInsertionEffect:up,useLayoutEffect:cp,useMemo:gp,useReducer:qc,useRef:ap,useState:function(){return qc(Ls)},useDebugValue:ed,useDeferredValue:function(n){var r=Sn();return pp(r,mt.memoizedState,n)},useTransition:function(){var n=qc(Ls)[0],r=Sn().memoizedState;return[n,r]},useMutableSource:Jg,useSyncExternalStore:ep,useId:mp,unstable_isNewReconciler:!1},hT={readContext:vn,useCallback:hp,useContext:vn,useEffect:Jc,useImperativeHandle:fp,useInsertionEffect:up,useLayoutEffect:cp,useMemo:gp,useReducer:Qc,useRef:ap,useState:function(){return Qc(Ls)},useDebugValue:ed,useDeferredValue:function(n){var r=Sn();return mt===null?r.memoizedState=n:pp(r,mt.memoizedState,n)},useTransition:function(){var n=Qc(Ls)[0],r=Sn().memoizedState;return[n,r]},useMutableSource:Jg,useSyncExternalStore:ep,useId:mp,unstable_isNewReconciler:!1};function On(n,r){if(n&&n.defaultProps){r=Y({},r),n=n.defaultProps;for(var l in n)r[l]===void 0&&(r[l]=n[l]);return r}return r}function td(n,r,l,d){r=n.memoizedState,l=l(d,r),l=l==null?r:Y({},r,l),n.memoizedState=l,n.lanes===0&&(n.updateQueue.baseState=l)}var Tl={isMounted:function(n){return(n=n._reactInternals)?dr(n)===n:!1},enqueueSetState:function(n,r,l){n=n._reactInternals;var d=xt(),h=Hi(n),p=ci(d,h);p.payload=r,l!=null&&(p.callback=l),r=Fi(n,p,h),r!==null&&(Fn(r,n,h,d),fl(r,n,h))},enqueueReplaceState:function(n,r,l){n=n._reactInternals;var d=xt(),h=Hi(n),p=ci(d,h);p.tag=1,p.payload=r,l!=null&&(p.callback=l),r=Fi(n,p,h),r!==null&&(Fn(r,n,h,d),fl(r,n,h))},enqueueForceUpdate:function(n,r){n=n._reactInternals;var l=xt(),d=Hi(n),h=ci(l,d);h.tag=2,r!=null&&(h.callback=r),r=Fi(n,h,d),r!==null&&(Fn(r,n,d,l),fl(r,n,d))}};function Tp(n,r,l,d,h,p,S){return n=n.stateNode,typeof n.shouldComponentUpdate=="function"?n.shouldComponentUpdate(d,p,S):r.prototype&&r.prototype.isPureReactComponent?!Is(l,d)||!Is(h,p):!0}function Ap(n,r,l){var d=!1,h=Oi,p=r.contextType;return typeof p=="object"&&p!==null?p=vn(p):(h=Zt(r)?hr:Mt.current,d=r.contextTypes,p=(d=d!=null)?ro(n,h):Oi),r=new r(l,p),n.memoizedState=r.state!==null&&r.state!==void 0?r.state:null,r.updater=Tl,n.stateNode=r,r._reactInternals=n,d&&(n=n.stateNode,n.__reactInternalMemoizedUnmaskedChildContext=h,n.__reactInternalMemoizedMaskedChildContext=p),r}function Ip(n,r,l,d){n=r.state,typeof r.componentWillReceiveProps=="function"&&r.componentWillReceiveProps(l,d),typeof r.UNSAFE_componentWillReceiveProps=="function"&&r.UNSAFE_componentWillReceiveProps(l,d),r.state!==n&&Tl.enqueueReplaceState(r,r.state,null)}function nd(n,r,l,d){var h=n.stateNode;h.props=l,h.state=n.memoizedState,h.refs={},$c(n);var p=r.contextType;typeof p=="object"&&p!==null?h.context=vn(p):(p=Zt(r)?hr:Mt.current,h.context=ro(n,p)),h.state=n.memoizedState,p=r.getDerivedStateFromProps,typeof p=="function"&&(td(n,r,p,l),h.state=n.memoizedState),typeof r.getDerivedStateFromProps=="function"||typeof h.getSnapshotBeforeUpdate=="function"||typeof h.UNSAFE_componentWillMount!="function"&&typeof h.componentWillMount!="function"||(r=h.state,typeof h.componentWillMount=="function"&&h.componentWillMount(),typeof h.UNSAFE_componentWillMount=="function"&&h.UNSAFE_componentWillMount(),r!==h.state&&Tl.enqueueReplaceState(h,h.state,null),hl(n,l,h,d),h.state=n.memoizedState),typeof h.componentDidMount=="function"&&(n.flags|=4194308)}function ho(n,r){try{var l="",d=r;do l+=pe(d),d=d.return;while(d);var h=l}catch(p){h=`
Error generating stack: `+p.message+`
`+p.stack}return{value:n,source:r,stack:h,digest:null}}function id(n,r,l){return{value:n,source:null,stack:l??null,digest:r??null}}function rd(n,r){try{console.error(r.value)}catch(l){setTimeout(function(){throw l})}}var gT=typeof WeakMap=="function"?WeakMap:Map;function Ep(n,r,l){l=ci(-1,l),l.tag=3,l.payload={element:null};var d=r.value;return l.callback=function(){Rl||(Rl=!0,yd=d),rd(n,r)},l}function Cp(n,r,l){l=ci(-1,l),l.tag=3;var d=n.type.getDerivedStateFromError;if(typeof d=="function"){var h=r.value;l.payload=function(){return d(h)},l.callback=function(){rd(n,r)}}var p=n.stateNode;return p!==null&&typeof p.componentDidCatch=="function"&&(l.callback=function(){rd(n,r),typeof d!="function"&&(Ui===null?Ui=new Set([this]):Ui.add(this));var S=r.stack;this.componentDidCatch(r.value,{componentStack:S!==null?S:""})}),l}function wp(n,r,l){var d=n.pingCache;if(d===null){d=n.pingCache=new gT;var h=new Set;d.set(r,h)}else h=d.get(r),h===void 0&&(h=new Set,d.set(r,h));h.has(l)||(h.add(l),n=PT.bind(null,n,r,l),r.then(n,n))}function _p(n){do{var r;if((r=n.tag===13)&&(r=n.memoizedState,r=r!==null?r.dehydrated!==null:!0),r)return n;n=n.return}while(n!==null);return null}function Rp(n,r,l,d,h){return(n.mode&1)===0?(n===r?n.flags|=65536:(n.flags|=128,l.flags|=131072,l.flags&=-52805,l.tag===1&&(l.alternate===null?l.tag=17:(r=ci(-1,1),r.tag=2,Fi(l,r,1))),l.lanes|=1),n):(n.flags|=65536,n.lanes=h,n)}var pT=H.ReactCurrentOwner,qt=!1;function Gt(n,r,l,d){r.child=n===null?Vg(r,null,l,d):lo(r,n.child,l,d)}function Pp(n,r,l,d,h){l=l.render;var p=r.ref;return co(r,h),d=Kc(n,r,l,d,p,h),l=Zc(),n!==null&&!qt?(r.updateQueue=n.updateQueue,r.flags&=-2053,n.lanes&=~h,di(n,r,h)):(nt&&l&&Mc(r),r.flags|=1,Gt(n,r,d,h),r.child)}function Np(n,r,l,d,h){if(n===null){var p=l.type;return typeof p=="function"&&!_d(p)&&p.defaultProps===void 0&&l.compare===null&&l.defaultProps===void 0?(r.tag=15,r.type=p,Dp(n,r,p,d,h)):(n=kl(l.type,null,d,r,r.mode,h),n.ref=r.ref,n.return=r,r.child=n)}if(p=n.child,(n.lanes&h)===0){var S=p.memoizedProps;if(l=l.compare,l=l!==null?l:Is,l(S,d)&&n.ref===r.ref)return di(n,r,h)}return r.flags|=1,n=Gi(p,d),n.ref=r.ref,n.return=r,r.child=n}function Dp(n,r,l,d,h){if(n!==null){var p=n.memoizedProps;if(Is(p,d)&&n.ref===r.ref)if(qt=!1,r.pendingProps=d=p,(n.lanes&h)!==0)(n.flags&131072)!==0&&(qt=!0);else return r.lanes=n.lanes,di(n,r,h)}return od(n,r,l,d,h)}function Op(n,r,l){var d=r.pendingProps,h=d.children,p=n!==null?n.memoizedState:null;if(d.mode==="hidden")if((r.mode&1)===0)r.memoizedState={baseLanes:0,cachePool:null,transitions:null},je(po,ln),ln|=l;else{if((l&1073741824)===0)return n=p!==null?p.baseLanes|l:l,r.lanes=r.childLanes=1073741824,r.memoizedState={baseLanes:n,cachePool:null,transitions:null},r.updateQueue=null,je(po,ln),ln|=n,null;r.memoizedState={baseLanes:0,cachePool:null,transitions:null},d=p!==null?p.baseLanes:l,je(po,ln),ln|=d}else p!==null?(d=p.baseLanes|l,r.memoizedState=null):d=l,je(po,ln),ln|=d;return Gt(n,r,h,l),r.child}function Mp(n,r){var l=r.ref;(n===null&&l!==null||n!==null&&n.ref!==l)&&(r.flags|=512,r.flags|=2097152)}function od(n,r,l,d,h){var p=Zt(l)?hr:Mt.current;return p=ro(r,p),co(r,h),l=Kc(n,r,l,d,p,h),d=Zc(),n!==null&&!qt?(r.updateQueue=n.updateQueue,r.flags&=-2053,n.lanes&=~h,di(n,r,h)):(nt&&d&&Mc(r),r.flags|=1,Gt(n,r,l,h),r.child)}function kp(n,r,l,d,h){if(Zt(l)){var p=!0;rl(r)}else p=!1;if(co(r,h),r.stateNode===null)Il(n,r),Ap(r,l,d),nd(r,l,d,h),d=!0;else if(n===null){var S=r.stateNode,C=r.memoizedProps;S.props=C;var R=S.context,F=l.contextType;typeof F=="object"&&F!==null?F=vn(F):(F=Zt(l)?hr:Mt.current,F=ro(r,F));var $=l.getDerivedStateFromProps,W=typeof $=="function"||typeof S.getSnapshotBeforeUpdate=="function";W||typeof S.UNSAFE_componentWillReceiveProps!="function"&&typeof S.componentWillReceiveProps!="function"||(C!==d||R!==F)&&Ip(r,S,d,F),ki=!1;var x=r.memoizedState;S.state=x,hl(r,d,S,h),R=r.memoizedState,C!==d||x!==R||Kt.current||ki?(typeof $=="function"&&(td(r,l,$,d),R=r.memoizedState),(C=ki||Tp(r,l,C,d,x,R,F))?(W||typeof S.UNSAFE_componentWillMount!="function"&&typeof S.componentWillMount!="function"||(typeof S.componentWillMount=="function"&&S.componentWillMount(),typeof S.UNSAFE_componentWillMount=="function"&&S.UNSAFE_componentWillMount()),typeof S.componentDidMount=="function"&&(r.flags|=4194308)):(typeof S.componentDidMount=="function"&&(r.flags|=4194308),r.memoizedProps=d,r.memoizedState=R),S.props=d,S.state=R,S.context=F,d=C):(typeof S.componentDidMount=="function"&&(r.flags|=4194308),d=!1)}else{S=r.stateNode,Kg(n,r),C=r.memoizedProps,F=r.type===r.elementType?C:On(r.type,C),S.props=F,W=r.pendingProps,x=S.context,R=l.contextType,typeof R=="object"&&R!==null?R=vn(R):(R=Zt(l)?hr:Mt.current,R=ro(r,R));var q=l.getDerivedStateFromProps;($=typeof q=="function"||typeof S.getSnapshotBeforeUpdate=="function")||typeof S.UNSAFE_componentWillReceiveProps!="function"&&typeof S.componentWillReceiveProps!="function"||(C!==W||x!==R)&&Ip(r,S,d,R),ki=!1,x=r.memoizedState,S.state=x,hl(r,d,S,h);var re=r.memoizedState;C!==W||x!==re||Kt.current||ki?(typeof q=="function"&&(td(r,l,q,d),re=r.memoizedState),(F=ki||Tp(r,l,F,d,x,re,R)||!1)?($||typeof S.UNSAFE_componentWillUpdate!="function"&&typeof S.componentWillUpdate!="function"||(typeof S.componentWillUpdate=="function"&&S.componentWillUpdate(d,re,R),typeof S.UNSAFE_componentWillUpdate=="function"&&S.UNSAFE_componentWillUpdate(d,re,R)),typeof S.componentDidUpdate=="function"&&(r.flags|=4),typeof S.getSnapshotBeforeUpdate=="function"&&(r.flags|=1024)):(typeof S.componentDidUpdate!="function"||C===n.memoizedProps&&x===n.memoizedState||(r.flags|=4),typeof S.getSnapshotBeforeUpdate!="function"||C===n.memoizedProps&&x===n.memoizedState||(r.flags|=1024),r.memoizedProps=d,r.memoizedState=re),S.props=d,S.state=re,S.context=R,d=F):(typeof S.componentDidUpdate!="function"||C===n.memoizedProps&&x===n.memoizedState||(r.flags|=4),typeof S.getSnapshotBeforeUpdate!="function"||C===n.memoizedProps&&x===n.memoizedState||(r.flags|=1024),d=!1)}return sd(n,r,l,d,p,h)}function sd(n,r,l,d,h,p){Mp(n,r);var S=(r.flags&128)!==0;if(!d&&!S)return h&&Hg(r,l,!1),di(n,r,p);d=r.stateNode,pT.current=r;var C=S&&typeof l.getDerivedStateFromError!="function"?null:d.render();return r.flags|=1,n!==null&&S?(r.child=lo(r,n.child,null,p),r.child=lo(r,null,C,p)):Gt(n,r,C,p),r.memoizedState=d.state,h&&Hg(r,l,!0),r.child}function Fp(n){var r=n.stateNode;r.pendingContext?Ug(n,r.pendingContext,r.pendingContext!==r.context):r.context&&Ug(n,r.context,!1),Wc(n,r.containerInfo)}function Lp(n,r,l,d,h){return ao(),Uc(h),r.flags|=256,Gt(n,r,l,d),r.child}var ad={dehydrated:null,treeContext:null,retryLane:0};function ld(n){return{baseLanes:n,cachePool:null,transitions:null}}function Up(n,r,l){var d=r.pendingProps,h=rt.current,p=!1,S=(r.flags&128)!==0,C;if((C=S)||(C=n!==null&&n.memoizedState===null?!1:(h&2)!==0),C?(p=!0,r.flags&=-129):(n===null||n.memoizedState!==null)&&(h|=1),je(rt,h&1),n===null)return Lc(r),n=r.memoizedState,n!==null&&(n=n.dehydrated,n!==null)?((r.mode&1)===0?r.lanes=1:n.data==="$!"?r.lanes=8:r.lanes=1073741824,null):(S=d.children,n=d.fallback,p?(d=r.mode,p=r.child,S={mode:"hidden",children:S},(d&1)===0&&p!==null?(p.childLanes=0,p.pendingProps=S):p=Fl(S,d,0,null),n=Er(n,d,l,null),p.return=r,n.return=r,p.sibling=n,r.child=p,r.child.memoizedState=ld(l),r.memoizedState=ad,n):ud(r,S));if(h=n.memoizedState,h!==null&&(C=h.dehydrated,C!==null))return mT(n,r,S,d,C,h,l);if(p){p=d.fallback,S=r.mode,h=n.child,C=h.sibling;var R={mode:"hidden",children:d.children};return(S&1)===0&&r.child!==h?(d=r.child,d.childLanes=0,d.pendingProps=R,r.deletions=null):(d=Gi(h,R),d.subtreeFlags=h.subtreeFlags&14680064),C!==null?p=Gi(C,p):(p=Er(p,S,l,null),p.flags|=2),p.return=r,d.return=r,d.sibling=p,r.child=d,d=p,p=r.child,S=n.child.memoizedState,S=S===null?ld(l):{baseLanes:S.baseLanes|l,cachePool:null,transitions:S.transitions},p.memoizedState=S,p.childLanes=n.childLanes&~l,r.memoizedState=ad,d}return p=n.child,n=p.sibling,d=Gi(p,{mode:"visible",children:d.children}),(r.mode&1)===0&&(d.lanes=l),d.return=r,d.sibling=null,n!==null&&(l=r.deletions,l===null?(r.deletions=[n],r.flags|=16):l.push(n)),r.child=d,r.memoizedState=null,d}function ud(n,r){return r=Fl({mode:"visible",children:r},n.mode,0,null),r.return=n,n.child=r}function Al(n,r,l,d){return d!==null&&Uc(d),lo(r,n.child,null,l),n=ud(r,r.pendingProps.children),n.flags|=2,r.memoizedState=null,n}function mT(n,r,l,d,h,p,S){if(l)return r.flags&256?(r.flags&=-257,d=id(Error(i(422))),Al(n,r,S,d)):r.memoizedState!==null?(r.child=n.child,r.flags|=128,null):(p=d.fallback,h=r.mode,d=Fl({mode:"visible",children:d.children},h,0,null),p=Er(p,h,S,null),p.flags|=2,d.return=r,p.return=r,d.sibling=p,r.child=d,(r.mode&1)!==0&&lo(r,n.child,null,S),r.child.memoizedState=ld(S),r.memoizedState=ad,p);if((r.mode&1)===0)return Al(n,r,S,null);if(h.data==="$!"){if(d=h.nextSibling&&h.nextSibling.dataset,d)var C=d.dgst;return d=C,p=Error(i(419)),d=id(p,d,void 0),Al(n,r,S,d)}if(C=(S&n.childLanes)!==0,qt||C){if(d=At,d!==null){switch(S&-S){case 4:h=2;break;case 16:h=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:h=32;break;case 536870912:h=268435456;break;default:h=0}h=(h&(d.suspendedLanes|S))!==0?0:h,h!==0&&h!==p.retryLane&&(p.retryLane=h,ui(n,h),Fn(d,n,h,-1))}return wd(),d=id(Error(i(421))),Al(n,r,S,d)}return h.data==="$?"?(r.flags|=128,r.child=n.child,r=NT.bind(null,n),h._reactRetry=r,null):(n=p.treeContext,an=Ni(h.nextSibling),sn=r,nt=!0,Dn=null,n!==null&&(pn[mn++]=ai,pn[mn++]=li,pn[mn++]=gr,ai=n.id,li=n.overflow,gr=r),r=ud(r,d.children),r.flags|=4096,r)}function Bp(n,r,l){n.lanes|=r;var d=n.alternate;d!==null&&(d.lanes|=r),Gc(n.return,r,l)}function cd(n,r,l,d,h){var p=n.memoizedState;p===null?n.memoizedState={isBackwards:r,rendering:null,renderingStartTime:0,last:d,tail:l,tailMode:h}:(p.isBackwards=r,p.rendering=null,p.renderingStartTime=0,p.last=d,p.tail=l,p.tailMode=h)}function Hp(n,r,l){var d=r.pendingProps,h=d.revealOrder,p=d.tail;if(Gt(n,r,d.children,l),d=rt.current,(d&2)!==0)d=d&1|2,r.flags|=128;else{if(n!==null&&(n.flags&128)!==0)e:for(n=r.child;n!==null;){if(n.tag===13)n.memoizedState!==null&&Bp(n,l,r);else if(n.tag===19)Bp(n,l,r);else if(n.child!==null){n.child.return=n,n=n.child;continue}if(n===r)break e;for(;n.sibling===null;){if(n.return===null||n.return===r)break e;n=n.return}n.sibling.return=n.return,n=n.sibling}d&=1}if(je(rt,d),(r.mode&1)===0)r.memoizedState=null;else switch(h){case"forwards":for(l=r.child,h=null;l!==null;)n=l.alternate,n!==null&&gl(n)===null&&(h=l),l=l.sibling;l=h,l===null?(h=r.child,r.child=null):(h=l.sibling,l.sibling=null),cd(r,!1,h,l,p);break;case"backwards":for(l=null,h=r.child,r.child=null;h!==null;){if(n=h.alternate,n!==null&&gl(n)===null){r.child=h;break}n=h.sibling,h.sibling=l,l=h,h=n}cd(r,!0,l,null,p);break;case"together":cd(r,!1,null,null,void 0);break;default:r.memoizedState=null}return r.child}function Il(n,r){(r.mode&1)===0&&n!==null&&(n.alternate=null,r.alternate=null,r.flags|=2)}function di(n,r,l){if(n!==null&&(r.dependencies=n.dependencies),yr|=r.lanes,(l&r.childLanes)===0)return null;if(n!==null&&r.child!==n.child)throw Error(i(153));if(r.child!==null){for(n=r.child,l=Gi(n,n.pendingProps),r.child=l,l.return=r;n.sibling!==null;)n=n.sibling,l=l.sibling=Gi(n,n.pendingProps),l.return=r;l.sibling=null}return r.child}function vT(n,r,l){switch(r.tag){case 3:Fp(r),ao();break;case 5:Qg(r);break;case 1:Zt(r.type)&&rl(r);break;case 4:Wc(r,r.stateNode.containerInfo);break;case 10:var d=r.type._context,h=r.memoizedProps.value;je(cl,d._currentValue),d._currentValue=h;break;case 13:if(d=r.memoizedState,d!==null)return d.dehydrated!==null?(je(rt,rt.current&1),r.flags|=128,null):(l&r.child.childLanes)!==0?Up(n,r,l):(je(rt,rt.current&1),n=di(n,r,l),n!==null?n.sibling:null);je(rt,rt.current&1);break;case 19:if(d=(l&r.childLanes)!==0,(n.flags&128)!==0){if(d)return Hp(n,r,l);r.flags|=128}if(h=r.memoizedState,h!==null&&(h.rendering=null,h.tail=null,h.lastEffect=null),je(rt,rt.current),d)break;return null;case 22:case 23:return r.lanes=0,Op(n,r,l)}return di(n,r,l)}var bp,dd,Gp,xp;bp=function(n,r){for(var l=r.child;l!==null;){if(l.tag===5||l.tag===6)n.appendChild(l.stateNode);else if(l.tag!==4&&l.child!==null){l.child.return=l,l=l.child;continue}if(l===r)break;for(;l.sibling===null;){if(l.return===null||l.return===r)return;l=l.return}l.sibling.return=l.return,l=l.sibling}},dd=function(){},Gp=function(n,r,l,d){var h=n.memoizedProps;if(h!==d){n=r.stateNode,vr(Xn.current);var p=null;switch(l){case"input":h=tt(n,h),d=tt(n,d),p=[];break;case"select":h=Y({},h,{value:void 0}),d=Y({},d,{value:void 0}),p=[];break;case"textarea":h=cr(n,h),d=cr(n,d),p=[];break;default:typeof h.onClick!="function"&&typeof d.onClick=="function"&&(n.onclick=tl)}Yu(l,d);var S;l=null;for(F in h)if(!d.hasOwnProperty(F)&&h.hasOwnProperty(F)&&h[F]!=null)if(F==="style"){var C=h[F];for(S in C)C.hasOwnProperty(S)&&(l||(l={}),l[S]="")}else F!=="dangerouslySetInnerHTML"&&F!=="children"&&F!=="suppressContentEditableWarning"&&F!=="suppressHydrationWarning"&&F!=="autoFocus"&&(a.hasOwnProperty(F)?p||(p=[]):(p=p||[]).push(F,null));for(F in d){var R=d[F];if(C=h!=null?h[F]:void 0,d.hasOwnProperty(F)&&R!==C&&(R!=null||C!=null))if(F==="style")if(C){for(S in C)!C.hasOwnProperty(S)||R&&R.hasOwnProperty(S)||(l||(l={}),l[S]="");for(S in R)R.hasOwnProperty(S)&&C[S]!==R[S]&&(l||(l={}),l[S]=R[S])}else l||(p||(p=[]),p.push(F,l)),l=R;else F==="dangerouslySetInnerHTML"?(R=R?R.__html:void 0,C=C?C.__html:void 0,R!=null&&C!==R&&(p=p||[]).push(F,R)):F==="children"?typeof R!="string"&&typeof R!="number"||(p=p||[]).push(F,""+R):F!=="suppressContentEditableWarning"&&F!=="suppressHydrationWarning"&&(a.hasOwnProperty(F)?(R!=null&&F==="onScroll"&&qe("scroll",n),p||C===R||(p=[])):(p=p||[]).push(F,R))}l&&(p=p||[]).push("style",l);var F=p;(r.updateQueue=F)&&(r.flags|=4)}},xp=function(n,r,l,d){l!==d&&(r.flags|=4)};function Bs(n,r){if(!nt)switch(n.tailMode){case"hidden":r=n.tail;for(var l=null;r!==null;)r.alternate!==null&&(l=r),r=r.sibling;l===null?n.tail=null:l.sibling=null;break;case"collapsed":l=n.tail;for(var d=null;l!==null;)l.alternate!==null&&(d=l),l=l.sibling;d===null?r||n.tail===null?n.tail=null:n.tail.sibling=null:d.sibling=null}}function Ft(n){var r=n.alternate!==null&&n.alternate.child===n.child,l=0,d=0;if(r)for(var h=n.child;h!==null;)l|=h.lanes|h.childLanes,d|=h.subtreeFlags&14680064,d|=h.flags&14680064,h.return=n,h=h.sibling;else for(h=n.child;h!==null;)l|=h.lanes|h.childLanes,d|=h.subtreeFlags,d|=h.flags,h.return=n,h=h.sibling;return n.subtreeFlags|=d,n.childLanes=l,r}function ST(n,r,l){var d=r.pendingProps;switch(kc(r),r.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Ft(r),null;case 1:return Zt(r.type)&&il(),Ft(r),null;case 3:return d=r.stateNode,fo(),Qe(Kt),Qe(Mt),jc(),d.pendingContext&&(d.context=d.pendingContext,d.pendingContext=null),(n===null||n.child===null)&&(ll(r)?r.flags|=4:n===null||n.memoizedState.isDehydrated&&(r.flags&256)===0||(r.flags|=1024,Dn!==null&&(Id(Dn),Dn=null))),dd(n,r),Ft(r),null;case 5:zc(r);var h=vr(Ms.current);if(l=r.type,n!==null&&r.stateNode!=null)Gp(n,r,l,d,h),n.ref!==r.ref&&(r.flags|=512,r.flags|=2097152);else{if(!d){if(r.stateNode===null)throw Error(i(166));return Ft(r),null}if(n=vr(Xn.current),ll(r)){d=r.stateNode,l=r.type;var p=r.memoizedProps;switch(d[Vn]=r,d[Rs]=p,n=(r.mode&1)!==0,l){case"dialog":qe("cancel",d),qe("close",d);break;case"iframe":case"object":case"embed":qe("load",d);break;case"video":case"audio":for(h=0;h<Cs.length;h++)qe(Cs[h],d);break;case"source":qe("error",d);break;case"img":case"image":case"link":qe("error",d),qe("load",d);break;case"details":qe("toggle",d);break;case"input":Ze(d,p),qe("invalid",d);break;case"select":d._wrapperState={wasMultiple:!!p.multiple},qe("invalid",d);break;case"textarea":Ch(d,p),qe("invalid",d)}Yu(l,p),h=null;for(var S in p)if(p.hasOwnProperty(S)){var C=p[S];S==="children"?typeof C=="string"?d.textContent!==C&&(p.suppressHydrationWarning!==!0&&el(d.textContent,C,n),h=["children",C]):typeof C=="number"&&d.textContent!==""+C&&(p.suppressHydrationWarning!==!0&&el(d.textContent,C,n),h=["children",""+C]):a.hasOwnProperty(S)&&C!=null&&S==="onScroll"&&qe("scroll",d)}switch(l){case"input":Ue(d),gn(d,p,!0);break;case"textarea":Ue(d),_h(d);break;case"select":case"option":break;default:typeof p.onClick=="function"&&(d.onclick=tl)}d=h,r.updateQueue=d,d!==null&&(r.flags|=4)}else{S=h.nodeType===9?h:h.ownerDocument,n==="http://www.w3.org/1999/xhtml"&&(n=Rh(l)),n==="http://www.w3.org/1999/xhtml"?l==="script"?(n=S.createElement("div"),n.innerHTML="<script><\/script>",n=n.removeChild(n.firstChild)):typeof d.is=="string"?n=S.createElement(l,{is:d.is}):(n=S.createElement(l),l==="select"&&(S=n,d.multiple?S.multiple=!0:d.size&&(S.size=d.size))):n=S.createElementNS(n,l),n[Vn]=r,n[Rs]=d,bp(n,r,!1,!1),r.stateNode=n;e:{switch(S=ju(l,d),l){case"dialog":qe("cancel",n),qe("close",n),h=d;break;case"iframe":case"object":case"embed":qe("load",n),h=d;break;case"video":case"audio":for(h=0;h<Cs.length;h++)qe(Cs[h],n);h=d;break;case"source":qe("error",n),h=d;break;case"img":case"image":case"link":qe("error",n),qe("load",n),h=d;break;case"details":qe("toggle",n),h=d;break;case"input":Ze(n,d),h=tt(n,d),qe("invalid",n);break;case"option":h=d;break;case"select":n._wrapperState={wasMultiple:!!d.multiple},h=Y({},d,{value:void 0}),qe("invalid",n);break;case"textarea":Ch(n,d),h=cr(n,d),qe("invalid",n);break;default:h=d}Yu(l,h),C=h;for(p in C)if(C.hasOwnProperty(p)){var R=C[p];p==="style"?Dh(n,R):p==="dangerouslySetInnerHTML"?(R=R?R.__html:void 0,R!=null&&Ph(n,R)):p==="children"?typeof R=="string"?(l!=="textarea"||R!=="")&&os(n,R):typeof R=="number"&&os(n,""+R):p!=="suppressContentEditableWarning"&&p!=="suppressHydrationWarning"&&p!=="autoFocus"&&(a.hasOwnProperty(p)?R!=null&&p==="onScroll"&&qe("scroll",n):R!=null&&N(n,p,R,S))}switch(l){case"input":Ue(n),gn(n,d,!1);break;case"textarea":Ue(n),_h(n);break;case"option":d.value!=null&&n.setAttribute("value",""+Ce(d.value));break;case"select":n.multiple=!!d.multiple,p=d.value,p!=null?Ii(n,!!d.multiple,p,!1):d.defaultValue!=null&&Ii(n,!!d.multiple,d.defaultValue,!0);break;default:typeof h.onClick=="function"&&(n.onclick=tl)}switch(l){case"button":case"input":case"select":case"textarea":d=!!d.autoFocus;break e;case"img":d=!0;break e;default:d=!1}}d&&(r.flags|=4)}r.ref!==null&&(r.flags|=512,r.flags|=2097152)}return Ft(r),null;case 6:if(n&&r.stateNode!=null)xp(n,r,n.memoizedProps,d);else{if(typeof d!="string"&&r.stateNode===null)throw Error(i(166));if(l=vr(Ms.current),vr(Xn.current),ll(r)){if(d=r.stateNode,l=r.memoizedProps,d[Vn]=r,(p=d.nodeValue!==l)&&(n=sn,n!==null))switch(n.tag){case 3:el(d.nodeValue,l,(n.mode&1)!==0);break;case 5:n.memoizedProps.suppressHydrationWarning!==!0&&el(d.nodeValue,l,(n.mode&1)!==0)}p&&(r.flags|=4)}else d=(l.nodeType===9?l:l.ownerDocument).createTextNode(d),d[Vn]=r,r.stateNode=d}return Ft(r),null;case 13:if(Qe(rt),d=r.memoizedState,n===null||n.memoizedState!==null&&n.memoizedState.dehydrated!==null){if(nt&&an!==null&&(r.mode&1)!==0&&(r.flags&128)===0)zg(),ao(),r.flags|=98560,p=!1;else if(p=ll(r),d!==null&&d.dehydrated!==null){if(n===null){if(!p)throw Error(i(318));if(p=r.memoizedState,p=p!==null?p.dehydrated:null,!p)throw Error(i(317));p[Vn]=r}else ao(),(r.flags&128)===0&&(r.memoizedState=null),r.flags|=4;Ft(r),p=!1}else Dn!==null&&(Id(Dn),Dn=null),p=!0;if(!p)return r.flags&65536?r:null}return(r.flags&128)!==0?(r.lanes=l,r):(d=d!==null,d!==(n!==null&&n.memoizedState!==null)&&d&&(r.child.flags|=8192,(r.mode&1)!==0&&(n===null||(rt.current&1)!==0?vt===0&&(vt=3):wd())),r.updateQueue!==null&&(r.flags|=4),Ft(r),null);case 4:return fo(),dd(n,r),n===null&&ws(r.stateNode.containerInfo),Ft(r),null;case 10:return bc(r.type._context),Ft(r),null;case 17:return Zt(r.type)&&il(),Ft(r),null;case 19:if(Qe(rt),p=r.memoizedState,p===null)return Ft(r),null;if(d=(r.flags&128)!==0,S=p.rendering,S===null)if(d)Bs(p,!1);else{if(vt!==0||n!==null&&(n.flags&128)!==0)for(n=r.child;n!==null;){if(S=gl(n),S!==null){for(r.flags|=128,Bs(p,!1),d=S.updateQueue,d!==null&&(r.updateQueue=d,r.flags|=4),r.subtreeFlags=0,d=l,l=r.child;l!==null;)p=l,n=d,p.flags&=14680066,S=p.alternate,S===null?(p.childLanes=0,p.lanes=n,p.child=null,p.subtreeFlags=0,p.memoizedProps=null,p.memoizedState=null,p.updateQueue=null,p.dependencies=null,p.stateNode=null):(p.childLanes=S.childLanes,p.lanes=S.lanes,p.child=S.child,p.subtreeFlags=0,p.deletions=null,p.memoizedProps=S.memoizedProps,p.memoizedState=S.memoizedState,p.updateQueue=S.updateQueue,p.type=S.type,n=S.dependencies,p.dependencies=n===null?null:{lanes:n.lanes,firstContext:n.firstContext}),l=l.sibling;return je(rt,rt.current&1|2),r.child}n=n.sibling}p.tail!==null&&lt()>mo&&(r.flags|=128,d=!0,Bs(p,!1),r.lanes=4194304)}else{if(!d)if(n=gl(S),n!==null){if(r.flags|=128,d=!0,l=n.updateQueue,l!==null&&(r.updateQueue=l,r.flags|=4),Bs(p,!0),p.tail===null&&p.tailMode==="hidden"&&!S.alternate&&!nt)return Ft(r),null}else 2*lt()-p.renderingStartTime>mo&&l!==1073741824&&(r.flags|=128,d=!0,Bs(p,!1),r.lanes=4194304);p.isBackwards?(S.sibling=r.child,r.child=S):(l=p.last,l!==null?l.sibling=S:r.child=S,p.last=S)}return p.tail!==null?(r=p.tail,p.rendering=r,p.tail=r.sibling,p.renderingStartTime=lt(),r.sibling=null,l=rt.current,je(rt,d?l&1|2:l&1),r):(Ft(r),null);case 22:case 23:return Cd(),d=r.memoizedState!==null,n!==null&&n.memoizedState!==null!==d&&(r.flags|=8192),d&&(r.mode&1)!==0?(ln&1073741824)!==0&&(Ft(r),r.subtreeFlags&6&&(r.flags|=8192)):Ft(r),null;case 24:return null;case 25:return null}throw Error(i(156,r.tag))}function yT(n,r){switch(kc(r),r.tag){case 1:return Zt(r.type)&&il(),n=r.flags,n&65536?(r.flags=n&-65537|128,r):null;case 3:return fo(),Qe(Kt),Qe(Mt),jc(),n=r.flags,(n&65536)!==0&&(n&128)===0?(r.flags=n&-65537|128,r):null;case 5:return zc(r),null;case 13:if(Qe(rt),n=r.memoizedState,n!==null&&n.dehydrated!==null){if(r.alternate===null)throw Error(i(340));ao()}return n=r.flags,n&65536?(r.flags=n&-65537|128,r):null;case 19:return Qe(rt),null;case 4:return fo(),null;case 10:return bc(r.type._context),null;case 22:case 23:return Cd(),null;case 24:return null;default:return null}}var El=!1,Lt=!1,TT=typeof WeakSet=="function"?WeakSet:Set,ne=null;function go(n,r){var l=n.ref;if(l!==null)if(typeof l=="function")try{l(null)}catch(d){st(n,r,d)}else l.current=null}function fd(n,r,l){try{l()}catch(d){st(n,r,d)}}var $p=!1;function AT(n,r){if(Cc=Wa,n=Tg(),mc(n)){if("selectionStart"in n)var l={start:n.selectionStart,end:n.selectionEnd};else e:{l=(l=n.ownerDocument)&&l.defaultView||window;var d=l.getSelection&&l.getSelection();if(d&&d.rangeCount!==0){l=d.anchorNode;var h=d.anchorOffset,p=d.focusNode;d=d.focusOffset;try{l.nodeType,p.nodeType}catch{l=null;break e}var S=0,C=-1,R=-1,F=0,$=0,W=n,x=null;t:for(;;){for(var q;W!==l||h!==0&&W.nodeType!==3||(C=S+h),W!==p||d!==0&&W.nodeType!==3||(R=S+d),W.nodeType===3&&(S+=W.nodeValue.length),(q=W.firstChild)!==null;)x=W,W=q;for(;;){if(W===n)break t;if(x===l&&++F===h&&(C=S),x===p&&++$===d&&(R=S),(q=W.nextSibling)!==null)break;W=x,x=W.parentNode}W=q}l=C===-1||R===-1?null:{start:C,end:R}}else l=null}l=l||{start:0,end:0}}else l=null;for(wc={focusedElem:n,selectionRange:l},Wa=!1,ne=r;ne!==null;)if(r=ne,n=r.child,(r.subtreeFlags&1028)!==0&&n!==null)n.return=r,ne=n;else for(;ne!==null;){r=ne;try{var re=r.alternate;if((r.flags&1024)!==0)switch(r.tag){case 0:case 11:case 15:break;case 1:if(re!==null){var le=re.memoizedProps,ut=re.memoizedState,M=r.stateNode,D=M.getSnapshotBeforeUpdate(r.elementType===r.type?le:On(r.type,le),ut);M.__reactInternalSnapshotBeforeUpdate=D}break;case 3:var k=r.stateNode.containerInfo;k.nodeType===1?k.textContent="":k.nodeType===9&&k.documentElement&&k.removeChild(k.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(i(163))}}catch(V){st(r,r.return,V)}if(n=r.sibling,n!==null){n.return=r.return,ne=n;break}ne=r.return}return re=$p,$p=!1,re}function Hs(n,r,l){var d=r.updateQueue;if(d=d!==null?d.lastEffect:null,d!==null){var h=d=d.next;do{if((h.tag&n)===n){var p=h.destroy;h.destroy=void 0,p!==void 0&&fd(r,l,p)}h=h.next}while(h!==d)}}function Cl(n,r){if(r=r.updateQueue,r=r!==null?r.lastEffect:null,r!==null){var l=r=r.next;do{if((l.tag&n)===n){var d=l.create;l.destroy=d()}l=l.next}while(l!==r)}}function hd(n){var r=n.ref;if(r!==null){var l=n.stateNode;switch(n.tag){case 5:n=l;break;default:n=l}typeof r=="function"?r(n):r.current=n}}function Wp(n){var r=n.alternate;r!==null&&(n.alternate=null,Wp(r)),n.child=null,n.deletions=null,n.sibling=null,n.tag===5&&(r=n.stateNode,r!==null&&(delete r[Vn],delete r[Rs],delete r[Nc],delete r[iT],delete r[rT])),n.stateNode=null,n.return=null,n.dependencies=null,n.memoizedProps=null,n.memoizedState=null,n.pendingProps=null,n.stateNode=null,n.updateQueue=null}function zp(n){return n.tag===5||n.tag===3||n.tag===4}function Yp(n){e:for(;;){for(;n.sibling===null;){if(n.return===null||zp(n.return))return null;n=n.return}for(n.sibling.return=n.return,n=n.sibling;n.tag!==5&&n.tag!==6&&n.tag!==18;){if(n.flags&2||n.child===null||n.tag===4)continue e;n.child.return=n,n=n.child}if(!(n.flags&2))return n.stateNode}}function gd(n,r,l){var d=n.tag;if(d===5||d===6)n=n.stateNode,r?l.nodeType===8?l.parentNode.insertBefore(n,r):l.insertBefore(n,r):(l.nodeType===8?(r=l.parentNode,r.insertBefore(n,l)):(r=l,r.appendChild(n)),l=l._reactRootContainer,l!=null||r.onclick!==null||(r.onclick=tl));else if(d!==4&&(n=n.child,n!==null))for(gd(n,r,l),n=n.sibling;n!==null;)gd(n,r,l),n=n.sibling}function pd(n,r,l){var d=n.tag;if(d===5||d===6)n=n.stateNode,r?l.insertBefore(n,r):l.appendChild(n);else if(d!==4&&(n=n.child,n!==null))for(pd(n,r,l),n=n.sibling;n!==null;)pd(n,r,l),n=n.sibling}var Pt=null,Mn=!1;function Li(n,r,l){for(l=l.child;l!==null;)jp(n,r,l),l=l.sibling}function jp(n,r,l){if(jn&&typeof jn.onCommitFiberUnmount=="function")try{jn.onCommitFiberUnmount(Ba,l)}catch{}switch(l.tag){case 5:Lt||go(l,r);case 6:var d=Pt,h=Mn;Pt=null,Li(n,r,l),Pt=d,Mn=h,Pt!==null&&(Mn?(n=Pt,l=l.stateNode,n.nodeType===8?n.parentNode.removeChild(l):n.removeChild(l)):Pt.removeChild(l.stateNode));break;case 18:Pt!==null&&(Mn?(n=Pt,l=l.stateNode,n.nodeType===8?Pc(n.parentNode,l):n.nodeType===1&&Pc(n,l),ms(n)):Pc(Pt,l.stateNode));break;case 4:d=Pt,h=Mn,Pt=l.stateNode.containerInfo,Mn=!0,Li(n,r,l),Pt=d,Mn=h;break;case 0:case 11:case 14:case 15:if(!Lt&&(d=l.updateQueue,d!==null&&(d=d.lastEffect,d!==null))){h=d=d.next;do{var p=h,S=p.destroy;p=p.tag,S!==void 0&&((p&2)!==0||(p&4)!==0)&&fd(l,r,S),h=h.next}while(h!==d)}Li(n,r,l);break;case 1:if(!Lt&&(go(l,r),d=l.stateNode,typeof d.componentWillUnmount=="function"))try{d.props=l.memoizedProps,d.state=l.memoizedState,d.componentWillUnmount()}catch(C){st(l,r,C)}Li(n,r,l);break;case 21:Li(n,r,l);break;case 22:l.mode&1?(Lt=(d=Lt)||l.memoizedState!==null,Li(n,r,l),Lt=d):Li(n,r,l);break;default:Li(n,r,l)}}function Vp(n){var r=n.updateQueue;if(r!==null){n.updateQueue=null;var l=n.stateNode;l===null&&(l=n.stateNode=new TT),r.forEach(function(d){var h=DT.bind(null,n,d);l.has(d)||(l.add(d),d.then(h,h))})}}function kn(n,r){var l=r.deletions;if(l!==null)for(var d=0;d<l.length;d++){var h=l[d];try{var p=n,S=r,C=S;e:for(;C!==null;){switch(C.tag){case 5:Pt=C.stateNode,Mn=!1;break e;case 3:Pt=C.stateNode.containerInfo,Mn=!0;break e;case 4:Pt=C.stateNode.containerInfo,Mn=!0;break e}C=C.return}if(Pt===null)throw Error(i(160));jp(p,S,h),Pt=null,Mn=!1;var R=h.alternate;R!==null&&(R.return=null),h.return=null}catch(F){st(h,r,F)}}if(r.subtreeFlags&12854)for(r=r.child;r!==null;)Xp(r,n),r=r.sibling}function Xp(n,r){var l=n.alternate,d=n.flags;switch(n.tag){case 0:case 11:case 14:case 15:if(kn(r,n),Zn(n),d&4){try{Hs(3,n,n.return),Cl(3,n)}catch(le){st(n,n.return,le)}try{Hs(5,n,n.return)}catch(le){st(n,n.return,le)}}break;case 1:kn(r,n),Zn(n),d&512&&l!==null&&go(l,l.return);break;case 5:if(kn(r,n),Zn(n),d&512&&l!==null&&go(l,l.return),n.flags&32){var h=n.stateNode;try{os(h,"")}catch(le){st(n,n.return,le)}}if(d&4&&(h=n.stateNode,h!=null)){var p=n.memoizedProps,S=l!==null?l.memoizedProps:p,C=n.type,R=n.updateQueue;if(n.updateQueue=null,R!==null)try{C==="input"&&p.type==="radio"&&p.name!=null&&Wn(h,p),ju(C,S);var F=ju(C,p);for(S=0;S<R.length;S+=2){var $=R[S],W=R[S+1];$==="style"?Dh(h,W):$==="dangerouslySetInnerHTML"?Ph(h,W):$==="children"?os(h,W):N(h,$,W,F)}switch(C){case"input":Xt(h,p);break;case"textarea":wh(h,p);break;case"select":var x=h._wrapperState.wasMultiple;h._wrapperState.wasMultiple=!!p.multiple;var q=p.value;q!=null?Ii(h,!!p.multiple,q,!1):x!==!!p.multiple&&(p.defaultValue!=null?Ii(h,!!p.multiple,p.defaultValue,!0):Ii(h,!!p.multiple,p.multiple?[]:"",!1))}h[Rs]=p}catch(le){st(n,n.return,le)}}break;case 6:if(kn(r,n),Zn(n),d&4){if(n.stateNode===null)throw Error(i(162));h=n.stateNode,p=n.memoizedProps;try{h.nodeValue=p}catch(le){st(n,n.return,le)}}break;case 3:if(kn(r,n),Zn(n),d&4&&l!==null&&l.memoizedState.isDehydrated)try{ms(r.containerInfo)}catch(le){st(n,n.return,le)}break;case 4:kn(r,n),Zn(n);break;case 13:kn(r,n),Zn(n),h=n.child,h.flags&8192&&(p=h.memoizedState!==null,h.stateNode.isHidden=p,!p||h.alternate!==null&&h.alternate.memoizedState!==null||(Sd=lt())),d&4&&Vp(n);break;case 22:if($=l!==null&&l.memoizedState!==null,n.mode&1?(Lt=(F=Lt)||$,kn(r,n),Lt=F):kn(r,n),Zn(n),d&8192){if(F=n.memoizedState!==null,(n.stateNode.isHidden=F)&&!$&&(n.mode&1)!==0)for(ne=n,$=n.child;$!==null;){for(W=ne=$;ne!==null;){switch(x=ne,q=x.child,x.tag){case 0:case 11:case 14:case 15:Hs(4,x,x.return);break;case 1:go(x,x.return);var re=x.stateNode;if(typeof re.componentWillUnmount=="function"){d=x,l=x.return;try{r=d,re.props=r.memoizedProps,re.state=r.memoizedState,re.componentWillUnmount()}catch(le){st(d,l,le)}}break;case 5:go(x,x.return);break;case 22:if(x.memoizedState!==null){qp(W);continue}}q!==null?(q.return=x,ne=q):qp(W)}$=$.sibling}e:for($=null,W=n;;){if(W.tag===5){if($===null){$=W;try{h=W.stateNode,F?(p=h.style,typeof p.setProperty=="function"?p.setProperty("display","none","important"):p.display="none"):(C=W.stateNode,R=W.memoizedProps.style,S=R!=null&&R.hasOwnProperty("display")?R.display:null,C.style.display=Nh("display",S))}catch(le){st(n,n.return,le)}}}else if(W.tag===6){if($===null)try{W.stateNode.nodeValue=F?"":W.memoizedProps}catch(le){st(n,n.return,le)}}else if((W.tag!==22&&W.tag!==23||W.memoizedState===null||W===n)&&W.child!==null){W.child.return=W,W=W.child;continue}if(W===n)break e;for(;W.sibling===null;){if(W.return===null||W.return===n)break e;$===W&&($=null),W=W.return}$===W&&($=null),W.sibling.return=W.return,W=W.sibling}}break;case 19:kn(r,n),Zn(n),d&4&&Vp(n);break;case 21:break;default:kn(r,n),Zn(n)}}function Zn(n){var r=n.flags;if(r&2){try{e:{for(var l=n.return;l!==null;){if(zp(l)){var d=l;break e}l=l.return}throw Error(i(160))}switch(d.tag){case 5:var h=d.stateNode;d.flags&32&&(os(h,""),d.flags&=-33);var p=Yp(n);pd(n,p,h);break;case 3:case 4:var S=d.stateNode.containerInfo,C=Yp(n);gd(n,C,S);break;default:throw Error(i(161))}}catch(R){st(n,n.return,R)}n.flags&=-3}r&4096&&(n.flags&=-4097)}function IT(n,r,l){ne=n,Kp(n)}function Kp(n,r,l){for(var d=(n.mode&1)!==0;ne!==null;){var h=ne,p=h.child;if(h.tag===22&&d){var S=h.memoizedState!==null||El;if(!S){var C=h.alternate,R=C!==null&&C.memoizedState!==null||Lt;C=El;var F=Lt;if(El=S,(Lt=R)&&!F)for(ne=h;ne!==null;)S=ne,R=S.child,S.tag===22&&S.memoizedState!==null?Qp(h):R!==null?(R.return=S,ne=R):Qp(h);for(;p!==null;)ne=p,Kp(p),p=p.sibling;ne=h,El=C,Lt=F}Zp(n)}else(h.subtreeFlags&8772)!==0&&p!==null?(p.return=h,ne=p):Zp(n)}}function Zp(n){for(;ne!==null;){var r=ne;if((r.flags&8772)!==0){var l=r.alternate;try{if((r.flags&8772)!==0)switch(r.tag){case 0:case 11:case 15:Lt||Cl(5,r);break;case 1:var d=r.stateNode;if(r.flags&4&&!Lt)if(l===null)d.componentDidMount();else{var h=r.elementType===r.type?l.memoizedProps:On(r.type,l.memoizedProps);d.componentDidUpdate(h,l.memoizedState,d.__reactInternalSnapshotBeforeUpdate)}var p=r.updateQueue;p!==null&&qg(r,p,d);break;case 3:var S=r.updateQueue;if(S!==null){if(l=null,r.child!==null)switch(r.child.tag){case 5:l=r.child.stateNode;break;case 1:l=r.child.stateNode}qg(r,S,l)}break;case 5:var C=r.stateNode;if(l===null&&r.flags&4){l=C;var R=r.memoizedProps;switch(r.type){case"button":case"input":case"select":case"textarea":R.autoFocus&&l.focus();break;case"img":R.src&&(l.src=R.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(r.memoizedState===null){var F=r.alternate;if(F!==null){var $=F.memoizedState;if($!==null){var W=$.dehydrated;W!==null&&ms(W)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(i(163))}Lt||r.flags&512&&hd(r)}catch(x){st(r,r.return,x)}}if(r===n){ne=null;break}if(l=r.sibling,l!==null){l.return=r.return,ne=l;break}ne=r.return}}function qp(n){for(;ne!==null;){var r=ne;if(r===n){ne=null;break}var l=r.sibling;if(l!==null){l.return=r.return,ne=l;break}ne=r.return}}function Qp(n){for(;ne!==null;){var r=ne;try{switch(r.tag){case 0:case 11:case 15:var l=r.return;try{Cl(4,r)}catch(R){st(r,l,R)}break;case 1:var d=r.stateNode;if(typeof d.componentDidMount=="function"){var h=r.return;try{d.componentDidMount()}catch(R){st(r,h,R)}}var p=r.return;try{hd(r)}catch(R){st(r,p,R)}break;case 5:var S=r.return;try{hd(r)}catch(R){st(r,S,R)}}}catch(R){st(r,r.return,R)}if(r===n){ne=null;break}var C=r.sibling;if(C!==null){C.return=r.return,ne=C;break}ne=r.return}}var ET=Math.ceil,wl=H.ReactCurrentDispatcher,md=H.ReactCurrentOwner,yn=H.ReactCurrentBatchConfig,Ge=0,At=null,ht=null,Nt=0,ln=0,po=Di(0),vt=0,bs=null,yr=0,_l=0,vd=0,Gs=null,Qt=null,Sd=0,mo=1/0,fi=null,Rl=!1,yd=null,Ui=null,Pl=!1,Bi=null,Nl=0,xs=0,Td=null,Dl=-1,Ol=0;function xt(){return(Ge&6)!==0?lt():Dl!==-1?Dl:Dl=lt()}function Hi(n){return(n.mode&1)===0?1:(Ge&2)!==0&&Nt!==0?Nt&-Nt:sT.transition!==null?(Ol===0&&(Ol=Yh()),Ol):(n=ze,n!==0||(n=window.event,n=n===void 0?16:eg(n.type)),n)}function Fn(n,r,l,d){if(50<xs)throw xs=0,Td=null,Error(i(185));ds(n,l,d),((Ge&2)===0||n!==At)&&(n===At&&((Ge&2)===0&&(_l|=l),vt===4&&bi(n,Nt)),Jt(n,d),l===1&&Ge===0&&(r.mode&1)===0&&(mo=lt()+500,ol&&Mi()))}function Jt(n,r){var l=n.callbackNode;sy(n,r);var d=Ga(n,n===At?Nt:0);if(d===0)l!==null&&$h(l),n.callbackNode=null,n.callbackPriority=0;else if(r=d&-d,n.callbackPriority!==r){if(l!=null&&$h(l),r===1)n.tag===0?oT(em.bind(null,n)):bg(em.bind(null,n)),tT(function(){(Ge&6)===0&&Mi()}),l=null;else{switch(jh(d)){case 1:l=Ju;break;case 4:l=Wh;break;case 16:l=Ua;break;case 536870912:l=zh;break;default:l=Ua}l=lm(l,Jp.bind(null,n))}n.callbackPriority=r,n.callbackNode=l}}function Jp(n,r){if(Dl=-1,Ol=0,(Ge&6)!==0)throw Error(i(327));var l=n.callbackNode;if(vo()&&n.callbackNode!==l)return null;var d=Ga(n,n===At?Nt:0);if(d===0)return null;if((d&30)!==0||(d&n.expiredLanes)!==0||r)r=Ml(n,d);else{r=d;var h=Ge;Ge|=2;var p=nm();(At!==n||Nt!==r)&&(fi=null,mo=lt()+500,Ar(n,r));do try{_T();break}catch(C){tm(n,C)}while(!0);Hc(),wl.current=p,Ge=h,ht!==null?r=0:(At=null,Nt=0,r=vt)}if(r!==0){if(r===2&&(h=ec(n),h!==0&&(d=h,r=Ad(n,h))),r===1)throw l=bs,Ar(n,0),bi(n,d),Jt(n,lt()),l;if(r===6)bi(n,d);else{if(h=n.current.alternate,(d&30)===0&&!CT(h)&&(r=Ml(n,d),r===2&&(p=ec(n),p!==0&&(d=p,r=Ad(n,p))),r===1))throw l=bs,Ar(n,0),bi(n,d),Jt(n,lt()),l;switch(n.finishedWork=h,n.finishedLanes=d,r){case 0:case 1:throw Error(i(345));case 2:Ir(n,Qt,fi);break;case 3:if(bi(n,d),(d&130023424)===d&&(r=Sd+500-lt(),10<r)){if(Ga(n,0)!==0)break;if(h=n.suspendedLanes,(h&d)!==d){xt(),n.pingedLanes|=n.suspendedLanes&h;break}n.timeoutHandle=Rc(Ir.bind(null,n,Qt,fi),r);break}Ir(n,Qt,fi);break;case 4:if(bi(n,d),(d&4194240)===d)break;for(r=n.eventTimes,h=-1;0<d;){var S=31-Pn(d);p=1<<S,S=r[S],S>h&&(h=S),d&=~p}if(d=h,d=lt()-d,d=(120>d?120:480>d?480:1080>d?1080:1920>d?1920:3e3>d?3e3:4320>d?4320:1960*ET(d/1960))-d,10<d){n.timeoutHandle=Rc(Ir.bind(null,n,Qt,fi),d);break}Ir(n,Qt,fi);break;case 5:Ir(n,Qt,fi);break;default:throw Error(i(329))}}}return Jt(n,lt()),n.callbackNode===l?Jp.bind(null,n):null}function Ad(n,r){var l=Gs;return n.current.memoizedState.isDehydrated&&(Ar(n,r).flags|=256),n=Ml(n,r),n!==2&&(r=Qt,Qt=l,r!==null&&Id(r)),n}function Id(n){Qt===null?Qt=n:Qt.push.apply(Qt,n)}function CT(n){for(var r=n;;){if(r.flags&16384){var l=r.updateQueue;if(l!==null&&(l=l.stores,l!==null))for(var d=0;d<l.length;d++){var h=l[d],p=h.getSnapshot;h=h.value;try{if(!Nn(p(),h))return!1}catch{return!1}}}if(l=r.child,r.subtreeFlags&16384&&l!==null)l.return=r,r=l;else{if(r===n)break;for(;r.sibling===null;){if(r.return===null||r.return===n)return!0;r=r.return}r.sibling.return=r.return,r=r.sibling}}return!0}function bi(n,r){for(r&=~vd,r&=~_l,n.suspendedLanes|=r,n.pingedLanes&=~r,n=n.expirationTimes;0<r;){var l=31-Pn(r),d=1<<l;n[l]=-1,r&=~d}}function em(n){if((Ge&6)!==0)throw Error(i(327));vo();var r=Ga(n,0);if((r&1)===0)return Jt(n,lt()),null;var l=Ml(n,r);if(n.tag!==0&&l===2){var d=ec(n);d!==0&&(r=d,l=Ad(n,d))}if(l===1)throw l=bs,Ar(n,0),bi(n,r),Jt(n,lt()),l;if(l===6)throw Error(i(345));return n.finishedWork=n.current.alternate,n.finishedLanes=r,Ir(n,Qt,fi),Jt(n,lt()),null}function Ed(n,r){var l=Ge;Ge|=1;try{return n(r)}finally{Ge=l,Ge===0&&(mo=lt()+500,ol&&Mi())}}function Tr(n){Bi!==null&&Bi.tag===0&&(Ge&6)===0&&vo();var r=Ge;Ge|=1;var l=yn.transition,d=ze;try{if(yn.transition=null,ze=1,n)return n()}finally{ze=d,yn.transition=l,Ge=r,(Ge&6)===0&&Mi()}}function Cd(){ln=po.current,Qe(po)}function Ar(n,r){n.finishedWork=null,n.finishedLanes=0;var l=n.timeoutHandle;if(l!==-1&&(n.timeoutHandle=-1,eT(l)),ht!==null)for(l=ht.return;l!==null;){var d=l;switch(kc(d),d.tag){case 1:d=d.type.childContextTypes,d!=null&&il();break;case 3:fo(),Qe(Kt),Qe(Mt),jc();break;case 5:zc(d);break;case 4:fo();break;case 13:Qe(rt);break;case 19:Qe(rt);break;case 10:bc(d.type._context);break;case 22:case 23:Cd()}l=l.return}if(At=n,ht=n=Gi(n.current,null),Nt=ln=r,vt=0,bs=null,vd=_l=yr=0,Qt=Gs=null,mr!==null){for(r=0;r<mr.length;r++)if(l=mr[r],d=l.interleaved,d!==null){l.interleaved=null;var h=d.next,p=l.pending;if(p!==null){var S=p.next;p.next=h,d.next=S}l.pending=d}mr=null}return n}function tm(n,r){do{var l=ht;try{if(Hc(),pl.current=yl,ml){for(var d=ot.memoizedState;d!==null;){var h=d.queue;h!==null&&(h.pending=null),d=d.next}ml=!1}if(Sr=0,Tt=mt=ot=null,ks=!1,Fs=0,md.current=null,l===null||l.return===null){vt=1,bs=r,ht=null;break}e:{var p=n,S=l.return,C=l,R=r;if(r=Nt,C.flags|=32768,R!==null&&typeof R=="object"&&typeof R.then=="function"){var F=R,$=C,W=$.tag;if(($.mode&1)===0&&(W===0||W===11||W===15)){var x=$.alternate;x?($.updateQueue=x.updateQueue,$.memoizedState=x.memoizedState,$.lanes=x.lanes):($.updateQueue=null,$.memoizedState=null)}var q=_p(S);if(q!==null){q.flags&=-257,Rp(q,S,C,p,r),q.mode&1&&wp(p,F,r),r=q,R=F;var re=r.updateQueue;if(re===null){var le=new Set;le.add(R),r.updateQueue=le}else re.add(R);break e}else{if((r&1)===0){wp(p,F,r),wd();break e}R=Error(i(426))}}else if(nt&&C.mode&1){var ut=_p(S);if(ut!==null){(ut.flags&65536)===0&&(ut.flags|=256),Rp(ut,S,C,p,r),Uc(ho(R,C));break e}}p=R=ho(R,C),vt!==4&&(vt=2),Gs===null?Gs=[p]:Gs.push(p),p=S;do{switch(p.tag){case 3:p.flags|=65536,r&=-r,p.lanes|=r;var M=Ep(p,R,r);Zg(p,M);break e;case 1:C=R;var D=p.type,k=p.stateNode;if((p.flags&128)===0&&(typeof D.getDerivedStateFromError=="function"||k!==null&&typeof k.componentDidCatch=="function"&&(Ui===null||!Ui.has(k)))){p.flags|=65536,r&=-r,p.lanes|=r;var V=Cp(p,C,r);Zg(p,V);break e}}p=p.return}while(p!==null)}rm(l)}catch(de){r=de,ht===l&&l!==null&&(ht=l=l.return);continue}break}while(!0)}function nm(){var n=wl.current;return wl.current=yl,n===null?yl:n}function wd(){(vt===0||vt===3||vt===2)&&(vt=4),At===null||(yr&268435455)===0&&(_l&268435455)===0||bi(At,Nt)}function Ml(n,r){var l=Ge;Ge|=2;var d=nm();(At!==n||Nt!==r)&&(fi=null,Ar(n,r));do try{wT();break}catch(h){tm(n,h)}while(!0);if(Hc(),Ge=l,wl.current=d,ht!==null)throw Error(i(261));return At=null,Nt=0,vt}function wT(){for(;ht!==null;)im(ht)}function _T(){for(;ht!==null&&!qS();)im(ht)}function im(n){var r=am(n.alternate,n,ln);n.memoizedProps=n.pendingProps,r===null?rm(n):ht=r,md.current=null}function rm(n){var r=n;do{var l=r.alternate;if(n=r.return,(r.flags&32768)===0){if(l=ST(l,r,ln),l!==null){ht=l;return}}else{if(l=yT(l,r),l!==null){l.flags&=32767,ht=l;return}if(n!==null)n.flags|=32768,n.subtreeFlags=0,n.deletions=null;else{vt=6,ht=null;return}}if(r=r.sibling,r!==null){ht=r;return}ht=r=n}while(r!==null);vt===0&&(vt=5)}function Ir(n,r,l){var d=ze,h=yn.transition;try{yn.transition=null,ze=1,RT(n,r,l,d)}finally{yn.transition=h,ze=d}return null}function RT(n,r,l,d){do vo();while(Bi!==null);if((Ge&6)!==0)throw Error(i(327));l=n.finishedWork;var h=n.finishedLanes;if(l===null)return null;if(n.finishedWork=null,n.finishedLanes=0,l===n.current)throw Error(i(177));n.callbackNode=null,n.callbackPriority=0;var p=l.lanes|l.childLanes;if(ay(n,p),n===At&&(ht=At=null,Nt=0),(l.subtreeFlags&2064)===0&&(l.flags&2064)===0||Pl||(Pl=!0,lm(Ua,function(){return vo(),null})),p=(l.flags&15990)!==0,(l.subtreeFlags&15990)!==0||p){p=yn.transition,yn.transition=null;var S=ze;ze=1;var C=Ge;Ge|=4,md.current=null,AT(n,l),Xp(l,n),Vy(wc),Wa=!!Cc,wc=Cc=null,n.current=l,IT(l),QS(),Ge=C,ze=S,yn.transition=p}else n.current=l;if(Pl&&(Pl=!1,Bi=n,Nl=h),p=n.pendingLanes,p===0&&(Ui=null),ty(l.stateNode),Jt(n,lt()),r!==null)for(d=n.onRecoverableError,l=0;l<r.length;l++)h=r[l],d(h.value,{componentStack:h.stack,digest:h.digest});if(Rl)throw Rl=!1,n=yd,yd=null,n;return(Nl&1)!==0&&n.tag!==0&&vo(),p=n.pendingLanes,(p&1)!==0?n===Td?xs++:(xs=0,Td=n):xs=0,Mi(),null}function vo(){if(Bi!==null){var n=jh(Nl),r=yn.transition,l=ze;try{if(yn.transition=null,ze=16>n?16:n,Bi===null)var d=!1;else{if(n=Bi,Bi=null,Nl=0,(Ge&6)!==0)throw Error(i(331));var h=Ge;for(Ge|=4,ne=n.current;ne!==null;){var p=ne,S=p.child;if((ne.flags&16)!==0){var C=p.deletions;if(C!==null){for(var R=0;R<C.length;R++){var F=C[R];for(ne=F;ne!==null;){var $=ne;switch($.tag){case 0:case 11:case 15:Hs(8,$,p)}var W=$.child;if(W!==null)W.return=$,ne=W;else for(;ne!==null;){$=ne;var x=$.sibling,q=$.return;if(Wp($),$===F){ne=null;break}if(x!==null){x.return=q,ne=x;break}ne=q}}}var re=p.alternate;if(re!==null){var le=re.child;if(le!==null){re.child=null;do{var ut=le.sibling;le.sibling=null,le=ut}while(le!==null)}}ne=p}}if((p.subtreeFlags&2064)!==0&&S!==null)S.return=p,ne=S;else e:for(;ne!==null;){if(p=ne,(p.flags&2048)!==0)switch(p.tag){case 0:case 11:case 15:Hs(9,p,p.return)}var M=p.sibling;if(M!==null){M.return=p.return,ne=M;break e}ne=p.return}}var D=n.current;for(ne=D;ne!==null;){S=ne;var k=S.child;if((S.subtreeFlags&2064)!==0&&k!==null)k.return=S,ne=k;else e:for(S=D;ne!==null;){if(C=ne,(C.flags&2048)!==0)try{switch(C.tag){case 0:case 11:case 15:Cl(9,C)}}catch(de){st(C,C.return,de)}if(C===S){ne=null;break e}var V=C.sibling;if(V!==null){V.return=C.return,ne=V;break e}ne=C.return}}if(Ge=h,Mi(),jn&&typeof jn.onPostCommitFiberRoot=="function")try{jn.onPostCommitFiberRoot(Ba,n)}catch{}d=!0}return d}finally{ze=l,yn.transition=r}}return!1}function om(n,r,l){r=ho(l,r),r=Ep(n,r,1),n=Fi(n,r,1),r=xt(),n!==null&&(ds(n,1,r),Jt(n,r))}function st(n,r,l){if(n.tag===3)om(n,n,l);else for(;r!==null;){if(r.tag===3){om(r,n,l);break}else if(r.tag===1){var d=r.stateNode;if(typeof r.type.getDerivedStateFromError=="function"||typeof d.componentDidCatch=="function"&&(Ui===null||!Ui.has(d))){n=ho(l,n),n=Cp(r,n,1),r=Fi(r,n,1),n=xt(),r!==null&&(ds(r,1,n),Jt(r,n));break}}r=r.return}}function PT(n,r,l){var d=n.pingCache;d!==null&&d.delete(r),r=xt(),n.pingedLanes|=n.suspendedLanes&l,At===n&&(Nt&l)===l&&(vt===4||vt===3&&(Nt&130023424)===Nt&&500>lt()-Sd?Ar(n,0):vd|=l),Jt(n,r)}function sm(n,r){r===0&&((n.mode&1)===0?r=1:(r=ba,ba<<=1,(ba&130023424)===0&&(ba=4194304)));var l=xt();n=ui(n,r),n!==null&&(ds(n,r,l),Jt(n,l))}function NT(n){var r=n.memoizedState,l=0;r!==null&&(l=r.retryLane),sm(n,l)}function DT(n,r){var l=0;switch(n.tag){case 13:var d=n.stateNode,h=n.memoizedState;h!==null&&(l=h.retryLane);break;case 19:d=n.stateNode;break;default:throw Error(i(314))}d!==null&&d.delete(r),sm(n,l)}var am;am=function(n,r,l){if(n!==null)if(n.memoizedProps!==r.pendingProps||Kt.current)qt=!0;else{if((n.lanes&l)===0&&(r.flags&128)===0)return qt=!1,vT(n,r,l);qt=(n.flags&131072)!==0}else qt=!1,nt&&(r.flags&1048576)!==0&&Gg(r,al,r.index);switch(r.lanes=0,r.tag){case 2:var d=r.type;Il(n,r),n=r.pendingProps;var h=ro(r,Mt.current);co(r,l),h=Kc(null,r,d,n,h,l);var p=Zc();return r.flags|=1,typeof h=="object"&&h!==null&&typeof h.render=="function"&&h.$$typeof===void 0?(r.tag=1,r.memoizedState=null,r.updateQueue=null,Zt(d)?(p=!0,rl(r)):p=!1,r.memoizedState=h.state!==null&&h.state!==void 0?h.state:null,$c(r),h.updater=Tl,r.stateNode=h,h._reactInternals=r,nd(r,d,n,l),r=sd(null,r,d,!0,p,l)):(r.tag=0,nt&&p&&Mc(r),Gt(null,r,h,l),r=r.child),r;case 16:d=r.elementType;e:{switch(Il(n,r),n=r.pendingProps,h=d._init,d=h(d._payload),r.type=d,h=r.tag=MT(d),n=On(d,n),h){case 0:r=od(null,r,d,n,l);break e;case 1:r=kp(null,r,d,n,l);break e;case 11:r=Pp(null,r,d,n,l);break e;case 14:r=Np(null,r,d,On(d.type,n),l);break e}throw Error(i(306,d,""))}return r;case 0:return d=r.type,h=r.pendingProps,h=r.elementType===d?h:On(d,h),od(n,r,d,h,l);case 1:return d=r.type,h=r.pendingProps,h=r.elementType===d?h:On(d,h),kp(n,r,d,h,l);case 3:e:{if(Fp(r),n===null)throw Error(i(387));d=r.pendingProps,p=r.memoizedState,h=p.element,Kg(n,r),hl(r,d,null,l);var S=r.memoizedState;if(d=S.element,p.isDehydrated)if(p={element:d,isDehydrated:!1,cache:S.cache,pendingSuspenseBoundaries:S.pendingSuspenseBoundaries,transitions:S.transitions},r.updateQueue.baseState=p,r.memoizedState=p,r.flags&256){h=ho(Error(i(423)),r),r=Lp(n,r,d,l,h);break e}else if(d!==h){h=ho(Error(i(424)),r),r=Lp(n,r,d,l,h);break e}else for(an=Ni(r.stateNode.containerInfo.firstChild),sn=r,nt=!0,Dn=null,l=Vg(r,null,d,l),r.child=l;l;)l.flags=l.flags&-3|4096,l=l.sibling;else{if(ao(),d===h){r=di(n,r,l);break e}Gt(n,r,d,l)}r=r.child}return r;case 5:return Qg(r),n===null&&Lc(r),d=r.type,h=r.pendingProps,p=n!==null?n.memoizedProps:null,S=h.children,_c(d,h)?S=null:p!==null&&_c(d,p)&&(r.flags|=32),Mp(n,r),Gt(n,r,S,l),r.child;case 6:return n===null&&Lc(r),null;case 13:return Up(n,r,l);case 4:return Wc(r,r.stateNode.containerInfo),d=r.pendingProps,n===null?r.child=lo(r,null,d,l):Gt(n,r,d,l),r.child;case 11:return d=r.type,h=r.pendingProps,h=r.elementType===d?h:On(d,h),Pp(n,r,d,h,l);case 7:return Gt(n,r,r.pendingProps,l),r.child;case 8:return Gt(n,r,r.pendingProps.children,l),r.child;case 12:return Gt(n,r,r.pendingProps.children,l),r.child;case 10:e:{if(d=r.type._context,h=r.pendingProps,p=r.memoizedProps,S=h.value,je(cl,d._currentValue),d._currentValue=S,p!==null)if(Nn(p.value,S)){if(p.children===h.children&&!Kt.current){r=di(n,r,l);break e}}else for(p=r.child,p!==null&&(p.return=r);p!==null;){var C=p.dependencies;if(C!==null){S=p.child;for(var R=C.firstContext;R!==null;){if(R.context===d){if(p.tag===1){R=ci(-1,l&-l),R.tag=2;var F=p.updateQueue;if(F!==null){F=F.shared;var $=F.pending;$===null?R.next=R:(R.next=$.next,$.next=R),F.pending=R}}p.lanes|=l,R=p.alternate,R!==null&&(R.lanes|=l),Gc(p.return,l,r),C.lanes|=l;break}R=R.next}}else if(p.tag===10)S=p.type===r.type?null:p.child;else if(p.tag===18){if(S=p.return,S===null)throw Error(i(341));S.lanes|=l,C=S.alternate,C!==null&&(C.lanes|=l),Gc(S,l,r),S=p.sibling}else S=p.child;if(S!==null)S.return=p;else for(S=p;S!==null;){if(S===r){S=null;break}if(p=S.sibling,p!==null){p.return=S.return,S=p;break}S=S.return}p=S}Gt(n,r,h.children,l),r=r.child}return r;case 9:return h=r.type,d=r.pendingProps.children,co(r,l),h=vn(h),d=d(h),r.flags|=1,Gt(n,r,d,l),r.child;case 14:return d=r.type,h=On(d,r.pendingProps),h=On(d.type,h),Np(n,r,d,h,l);case 15:return Dp(n,r,r.type,r.pendingProps,l);case 17:return d=r.type,h=r.pendingProps,h=r.elementType===d?h:On(d,h),Il(n,r),r.tag=1,Zt(d)?(n=!0,rl(r)):n=!1,co(r,l),Ap(r,d,h),nd(r,d,h,l),sd(null,r,d,!0,n,l);case 19:return Hp(n,r,l);case 22:return Op(n,r,l)}throw Error(i(156,r.tag))};function lm(n,r){return xh(n,r)}function OT(n,r,l,d){this.tag=n,this.key=l,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=r,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=d,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Tn(n,r,l,d){return new OT(n,r,l,d)}function _d(n){return n=n.prototype,!(!n||!n.isReactComponent)}function MT(n){if(typeof n=="function")return _d(n)?1:0;if(n!=null){if(n=n.$$typeof,n===Ne)return 11;if(n===ke)return 14}return 2}function Gi(n,r){var l=n.alternate;return l===null?(l=Tn(n.tag,r,n.key,n.mode),l.elementType=n.elementType,l.type=n.type,l.stateNode=n.stateNode,l.alternate=n,n.alternate=l):(l.pendingProps=r,l.type=n.type,l.flags=0,l.subtreeFlags=0,l.deletions=null),l.flags=n.flags&14680064,l.childLanes=n.childLanes,l.lanes=n.lanes,l.child=n.child,l.memoizedProps=n.memoizedProps,l.memoizedState=n.memoizedState,l.updateQueue=n.updateQueue,r=n.dependencies,l.dependencies=r===null?null:{lanes:r.lanes,firstContext:r.firstContext},l.sibling=n.sibling,l.index=n.index,l.ref=n.ref,l}function kl(n,r,l,d,h,p){var S=2;if(d=n,typeof n=="function")_d(n)&&(S=1);else if(typeof n=="string")S=5;else e:switch(n){case G:return Er(l.children,h,p,r);case Q:S=8,h|=8;break;case ee:return n=Tn(12,l,r,h|2),n.elementType=ee,n.lanes=p,n;case Ie:return n=Tn(13,l,r,h),n.elementType=Ie,n.lanes=p,n;case he:return n=Tn(19,l,r,h),n.elementType=he,n.lanes=p,n;case te:return Fl(l,h,p,r);default:if(typeof n=="object"&&n!==null)switch(n.$$typeof){case me:S=10;break e;case be:S=9;break e;case Ne:S=11;break e;case ke:S=14;break e;case ve:S=16,d=null;break e}throw Error(i(130,n==null?n:typeof n,""))}return r=Tn(S,l,r,h),r.elementType=n,r.type=d,r.lanes=p,r}function Er(n,r,l,d){return n=Tn(7,n,d,r),n.lanes=l,n}function Fl(n,r,l,d){return n=Tn(22,n,d,r),n.elementType=te,n.lanes=l,n.stateNode={isHidden:!1},n}function Rd(n,r,l){return n=Tn(6,n,null,r),n.lanes=l,n}function Pd(n,r,l){return r=Tn(4,n.children!==null?n.children:[],n.key,r),r.lanes=l,r.stateNode={containerInfo:n.containerInfo,pendingChildren:null,implementation:n.implementation},r}function kT(n,r,l,d,h){this.tag=r,this.containerInfo=n,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=tc(0),this.expirationTimes=tc(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=tc(0),this.identifierPrefix=d,this.onRecoverableError=h,this.mutableSourceEagerHydrationData=null}function Nd(n,r,l,d,h,p,S,C,R){return n=new kT(n,r,l,C,R),r===1?(r=1,p===!0&&(r|=8)):r=0,p=Tn(3,null,null,r),n.current=p,p.stateNode=n,p.memoizedState={element:d,isDehydrated:l,cache:null,transitions:null,pendingSuspenseBoundaries:null},$c(p),n}function FT(n,r,l){var d=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:U,key:d==null?null:""+d,children:n,containerInfo:r,implementation:l}}function um(n){if(!n)return Oi;n=n._reactInternals;e:{if(dr(n)!==n||n.tag!==1)throw Error(i(170));var r=n;do{switch(r.tag){case 3:r=r.stateNode.context;break e;case 1:if(Zt(r.type)){r=r.stateNode.__reactInternalMemoizedMergedChildContext;break e}}r=r.return}while(r!==null);throw Error(i(171))}if(n.tag===1){var l=n.type;if(Zt(l))return Bg(n,l,r)}return r}function cm(n,r,l,d,h,p,S,C,R){return n=Nd(l,d,!0,n,h,p,S,C,R),n.context=um(null),l=n.current,d=xt(),h=Hi(l),p=ci(d,h),p.callback=r??null,Fi(l,p,h),n.current.lanes=h,ds(n,h,d),Jt(n,d),n}function Ll(n,r,l,d){var h=r.current,p=xt(),S=Hi(h);return l=um(l),r.context===null?r.context=l:r.pendingContext=l,r=ci(p,S),r.payload={element:n},d=d===void 0?null:d,d!==null&&(r.callback=d),n=Fi(h,r,S),n!==null&&(Fn(n,h,S,p),fl(n,h,S)),S}function Ul(n){if(n=n.current,!n.child)return null;switch(n.child.tag){case 5:return n.child.stateNode;default:return n.child.stateNode}}function dm(n,r){if(n=n.memoizedState,n!==null&&n.dehydrated!==null){var l=n.retryLane;n.retryLane=l!==0&&l<r?l:r}}function Dd(n,r){dm(n,r),(n=n.alternate)&&dm(n,r)}function LT(){return null}var fm=typeof reportError=="function"?reportError:function(n){console.error(n)};function Od(n){this._internalRoot=n}Bl.prototype.render=Od.prototype.render=function(n){var r=this._internalRoot;if(r===null)throw Error(i(409));Ll(n,r,null,null)},Bl.prototype.unmount=Od.prototype.unmount=function(){var n=this._internalRoot;if(n!==null){this._internalRoot=null;var r=n.containerInfo;Tr(function(){Ll(null,n,null,null)}),r[oi]=null}};function Bl(n){this._internalRoot=n}Bl.prototype.unstable_scheduleHydration=function(n){if(n){var r=Kh();n={blockedOn:null,target:n,priority:r};for(var l=0;l<_i.length&&r!==0&&r<_i[l].priority;l++);_i.splice(l,0,n),l===0&&Qh(n)}};function Md(n){return!(!n||n.nodeType!==1&&n.nodeType!==9&&n.nodeType!==11)}function Hl(n){return!(!n||n.nodeType!==1&&n.nodeType!==9&&n.nodeType!==11&&(n.nodeType!==8||n.nodeValue!==" react-mount-point-unstable "))}function hm(){}function UT(n,r,l,d,h){if(h){if(typeof d=="function"){var p=d;d=function(){var F=Ul(S);p.call(F)}}var S=cm(r,d,n,0,null,!1,!1,"",hm);return n._reactRootContainer=S,n[oi]=S.current,ws(n.nodeType===8?n.parentNode:n),Tr(),S}for(;h=n.lastChild;)n.removeChild(h);if(typeof d=="function"){var C=d;d=function(){var F=Ul(R);C.call(F)}}var R=Nd(n,0,!1,null,null,!1,!1,"",hm);return n._reactRootContainer=R,n[oi]=R.current,ws(n.nodeType===8?n.parentNode:n),Tr(function(){Ll(r,R,l,d)}),R}function bl(n,r,l,d,h){var p=l._reactRootContainer;if(p){var S=p;if(typeof h=="function"){var C=h;h=function(){var R=Ul(S);C.call(R)}}Ll(r,S,n,h)}else S=UT(l,r,n,h,d);return Ul(S)}Vh=function(n){switch(n.tag){case 3:var r=n.stateNode;if(r.current.memoizedState.isDehydrated){var l=cs(r.pendingLanes);l!==0&&(nc(r,l|1),Jt(r,lt()),(Ge&6)===0&&(mo=lt()+500,Mi()))}break;case 13:Tr(function(){var d=ui(n,1);if(d!==null){var h=xt();Fn(d,n,1,h)}}),Dd(n,1)}},ic=function(n){if(n.tag===13){var r=ui(n,134217728);if(r!==null){var l=xt();Fn(r,n,134217728,l)}Dd(n,134217728)}},Xh=function(n){if(n.tag===13){var r=Hi(n),l=ui(n,r);if(l!==null){var d=xt();Fn(l,n,r,d)}Dd(n,r)}},Kh=function(){return ze},Zh=function(n,r){var l=ze;try{return ze=n,r()}finally{ze=l}},Ku=function(n,r,l){switch(r){case"input":if(Xt(n,l),r=l.name,l.type==="radio"&&r!=null){for(l=n;l.parentNode;)l=l.parentNode;for(l=l.querySelectorAll("input[name="+JSON.stringify(""+r)+'][type="radio"]'),r=0;r<l.length;r++){var d=l[r];if(d!==n&&d.form===n.form){var h=nl(d);if(!h)throw Error(i(90));Se(d),Xt(d,h)}}}break;case"textarea":wh(n,l);break;case"select":r=l.value,r!=null&&Ii(n,!!l.multiple,r,!1)}},Fh=Ed,Lh=Tr;var BT={usingClientEntryPoint:!1,Events:[Ps,no,nl,Mh,kh,Ed]},$s={findFiberByHostInstance:fr,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},HT={bundleType:$s.bundleType,version:$s.version,rendererPackageName:$s.rendererPackageName,rendererConfig:$s.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:H.ReactCurrentDispatcher,findHostInstanceByFiber:function(n){return n=bh(n),n===null?null:n.stateNode},findFiberByHostInstance:$s.findFiberByHostInstance||LT,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Gl=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Gl.isDisabled&&Gl.supportsFiber)try{Ba=Gl.inject(HT),jn=Gl}catch{}}return en.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=BT,en.createPortal=function(n,r){var l=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Md(r))throw Error(i(200));return FT(n,r,null,l)},en.createRoot=function(n,r){if(!Md(n))throw Error(i(299));var l=!1,d="",h=fm;return r!=null&&(r.unstable_strictMode===!0&&(l=!0),r.identifierPrefix!==void 0&&(d=r.identifierPrefix),r.onRecoverableError!==void 0&&(h=r.onRecoverableError)),r=Nd(n,1,!1,null,null,l,!1,d,h),n[oi]=r.current,ws(n.nodeType===8?n.parentNode:n),new Od(r)},en.findDOMNode=function(n){if(n==null)return null;if(n.nodeType===1)return n;var r=n._reactInternals;if(r===void 0)throw typeof n.render=="function"?Error(i(188)):(n=Object.keys(n).join(","),Error(i(268,n)));return n=bh(r),n=n===null?null:n.stateNode,n},en.flushSync=function(n){return Tr(n)},en.hydrate=function(n,r,l){if(!Hl(r))throw Error(i(200));return bl(null,n,r,!0,l)},en.hydrateRoot=function(n,r,l){if(!Md(n))throw Error(i(405));var d=l!=null&&l.hydratedSources||null,h=!1,p="",S=fm;if(l!=null&&(l.unstable_strictMode===!0&&(h=!0),l.identifierPrefix!==void 0&&(p=l.identifierPrefix),l.onRecoverableError!==void 0&&(S=l.onRecoverableError)),r=cm(r,null,n,1,l??null,h,!1,p,S),n[oi]=r.current,ws(n),d)for(n=0;n<d.length;n++)l=d[n],h=l._getVersion,h=h(l._source),r.mutableSourceEagerHydrationData==null?r.mutableSourceEagerHydrationData=[l,h]:r.mutableSourceEagerHydrationData.push(l,h);return new Bl(r)},en.render=function(n,r,l){if(!Hl(r))throw Error(i(200));return bl(null,n,r,!1,l)},en.unmountComponentAtNode=function(n){if(!Hl(n))throw Error(i(40));return n._reactRootContainer?(Tr(function(){bl(null,null,n,!1,function(){n._reactRootContainer=null,n[oi]=null})}),!0):!1},en.unstable_batchedUpdates=Ed,en.unstable_renderSubtreeIntoContainer=function(n,r,l,d){if(!Hl(l))throw Error(i(200));if(n==null||n._reactInternals===void 0)throw Error(i(38));return bl(n,r,l,!1,d)},en.version="18.3.1-next-f1338f8080-20240426",en}var Am;function XT(){if(Am)return Ld.exports;Am=1;function e(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}return e(),Ld.exports=VT(),Ld.exports}var Im;function KT(){if(Im)return xl;Im=1;var e=XT();return xl.createRoot=e.createRoot,xl.hydrateRoot=e.hydrateRoot,xl}var ZT=KT();const qT=Z0(ZT);class QT{constructor(){this.ids=[],this.values=[],this.length=0}clear(){this.length=0}push(t,i){let o=this.length++;for(;o>0;){const a=o-1>>1,s=this.values[a];if(i>=s)break;this.ids[o]=this.ids[a],this.values[o]=s,o=a}this.ids[o]=t,this.values[o]=i}pop(){if(this.length===0)return;const t=this.ids[0];if(this.length--,this.length>0){const i=this.ids[0]=this.ids[this.length],o=this.values[0]=this.values[this.length],a=this.length>>1;let s=0;for(;s<a;){let u=(s<<1)+1;const c=u+1;let f=this.ids[u],g=this.values[u];const m=this.values[c];if(c<this.length&&m<g&&(u=c,f=this.ids[c],g=m),g>=o)break;this.ids[s]=f,this.values[s]=g,s=u}this.ids[s]=i,this.values[s]=o}return t}peek(){if(this.length!==0)return this.ids[0]}peekValue(){if(this.length!==0)return this.values[0]}shrink(){this.ids.length=this.values.length=this.length}}const Em=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array],Hd=3;class xf{static from(t,i=0){if(i%8!==0)throw new Error("byteOffset must be 8-byte aligned.");if(!t||t.byteLength===void 0||t.buffer)throw new Error("Data must be an instance of ArrayBuffer or SharedArrayBuffer.");const[o,a]=new Uint8Array(t,i+0,2);if(o!==251)throw new Error("Data does not appear to be in a Flatbush format.");const s=a>>4;if(s!==Hd)throw new Error(`Got v${s} data when expected v${Hd}.`);const u=Em[a&15];if(!u)throw new Error("Unrecognized array type.");const[c]=new Uint16Array(t,i+2,1),[f]=new Uint32Array(t,i+4,1);return new xf(f,c,u,void 0,t,i)}constructor(t,i=16,o=Float64Array,a=ArrayBuffer,s,u=0){if(t===void 0)throw new Error("Missing required argument: numItems.");if(isNaN(t)||t<=0)throw new Error(`Unexpected numItems value: ${t}.`);this.numItems=+t,this.nodeSize=Math.min(Math.max(+i,2),65535),this.byteOffset=u;let c=t,f=c;this._levelBounds=[c*4];do c=Math.ceil(c/this.nodeSize),f+=c,this._levelBounds.push(f*4);while(c!==1);this.ArrayType=o,this.IndexArrayType=f<16384?Uint16Array:Uint32Array;const g=Em.indexOf(this.ArrayType),m=f*4*this.ArrayType.BYTES_PER_ELEMENT;if(g<0)throw new Error(`Unexpected typed array class: ${o}.`);s&&s.byteLength!==void 0&&!s.buffer?(this.data=s,this._boxes=new this.ArrayType(this.data,u+8,f*4),this._indices=new this.IndexArrayType(this.data,u+8+m,f),this._pos=f*4,this.minX=this._boxes[this._pos-4],this.minY=this._boxes[this._pos-3],this.maxX=this._boxes[this._pos-2],this.maxY=this._boxes[this._pos-1]):(this.data=new a(8+m+f*this.IndexArrayType.BYTES_PER_ELEMENT),this._boxes=new this.ArrayType(this.data,8,f*4),this._indices=new this.IndexArrayType(this.data,8+m,f),this._pos=0,this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0,new Uint8Array(this.data,0,2).set([251,(Hd<<4)+g]),new Uint16Array(this.data,2,1)[0]=i,new Uint32Array(this.data,4,1)[0]=t),this._queue=new QT}add(t,i,o=t,a=i){const s=this._pos>>2,u=this._boxes;return this._indices[s]=s,u[this._pos++]=t,u[this._pos++]=i,u[this._pos++]=o,u[this._pos++]=a,t<this.minX&&(this.minX=t),i<this.minY&&(this.minY=i),o>this.maxX&&(this.maxX=o),a>this.maxY&&(this.maxY=a),s}finish(){if(this._pos>>2!==this.numItems)throw new Error(`Added ${this._pos>>2} items when expected ${this.numItems}.`);const t=this._boxes;if(this.numItems<=this.nodeSize){t[this._pos++]=this.minX,t[this._pos++]=this.minY,t[this._pos++]=this.maxX,t[this._pos++]=this.maxY;return}const i=this.maxX-this.minX||1,o=this.maxY-this.minY||1,a=new Uint32Array(this.numItems),s=65535;for(let u=0,c=0;u<this.numItems;u++){const f=t[c++],g=t[c++],m=t[c++],v=t[c++],y=Math.floor(s*((f+m)/2-this.minX)/i),I=Math.floor(s*((g+v)/2-this.minY)/o);a[u]=eA(y,I)}vf(a,t,this._indices,0,this.numItems-1,this.nodeSize);for(let u=0,c=0;u<this._levelBounds.length-1;u++){const f=this._levelBounds[u];for(;c<f;){const g=c;let m=t[c++],v=t[c++],y=t[c++],I=t[c++];for(let E=1;E<this.nodeSize&&c<f;E++)m=Math.min(m,t[c++]),v=Math.min(v,t[c++]),y=Math.max(y,t[c++]),I=Math.max(I,t[c++]);this._indices[this._pos>>2]=g,t[this._pos++]=m,t[this._pos++]=v,t[this._pos++]=y,t[this._pos++]=I}}}search(t,i,o,a,s){if(this._pos!==this._boxes.length)throw new Error("Data not yet indexed - call index.finish().");let u=this._boxes.length-4;const c=[],f=[];for(;u!==void 0;){const g=Math.min(u+this.nodeSize*4,wm(u,this._levelBounds));for(let m=u;m<g;m+=4){if(o<this._boxes[m]||a<this._boxes[m+1]||t>this._boxes[m+2]||i>this._boxes[m+3])continue;const v=this._indices[m>>2]|0;u>=this.numItems*4?c.push(v):(s===void 0||s(v))&&f.push(v)}u=c.pop()}return f}neighbors(t,i,o=1/0,a=1/0,s){if(this._pos!==this._boxes.length)throw new Error("Data not yet indexed - call index.finish().");let u=this._boxes.length-4;const c=this._queue,f=[],g=a*a;e:for(;u!==void 0;){const m=Math.min(u+this.nodeSize*4,wm(u,this._levelBounds));for(let v=u;v<m;v+=4){const y=this._indices[v>>2]|0,I=Cm(t,this._boxes[v],this._boxes[v+2]),E=Cm(i,this._boxes[v+1],this._boxes[v+3]),T=I*I+E*E;T>g||(u>=this.numItems*4?c.push(y<<1,T):(s===void 0||s(y))&&c.push((y<<1)+1,T))}for(;c.length&&c.peek()&1;)if(c.peekValue()>g||(f.push(c.pop()>>1),f.length===o))break e;u=c.length?c.pop()>>1:void 0}return c.clear(),f}}function Cm(e,t,i){return e<t?t-e:e<=i?0:e-i}function wm(e,t){let i=0,o=t.length-1;for(;i<o;){const a=i+o>>1;t[a]>e?o=a:i=a+1}return t[i]}function vf(e,t,i,o,a,s){if(Math.floor(o/s)>=Math.floor(a/s))return;const u=e[o+a>>1];let c=o-1,f=a+1;for(;;){do c++;while(e[c]<u);do f--;while(e[f]>u);if(c>=f)break;JT(e,t,i,c,f)}vf(e,t,i,o,f,s),vf(e,t,i,f+1,a,s)}function JT(e,t,i,o,a){const s=e[o];e[o]=e[a],e[a]=s;const u=4*o,c=4*a,f=t[u],g=t[u+1],m=t[u+2],v=t[u+3];t[u]=t[c],t[u+1]=t[c+1],t[u+2]=t[c+2],t[u+3]=t[c+3],t[c]=f,t[c+1]=g,t[c+2]=m,t[c+3]=v;const y=i[o];i[o]=i[a],i[a]=y}function eA(e,t){let i=e^t,o=65535^i,a=65535^(e|t),s=e&(t^65535),u=i|o>>1,c=i>>1^i,f=a>>1^o&s>>1^a,g=i&a>>1^s>>1^s;i=u,o=c,a=f,s=g,u=i&i>>2^o&o>>2,c=i&o>>2^o&(i^o)>>2,f^=i&a>>2^o&s>>2,g^=o&a>>2^(i^o)&s>>2,i=u,o=c,a=f,s=g,u=i&i>>4^o&o>>4,c=i&o>>4^o&(i^o)>>4,f^=i&a>>4^o&s>>4,g^=o&a>>4^(i^o)&s>>4,i=u,o=c,a=f,s=g,f^=i&a>>8^o&s>>8,g^=o&a>>8^(i^o)&s>>8,i=f^f>>1,o=g^g>>1;let m=e^t,v=o|65535^(m|i);return m=(m|m<<8)&16711935,m=(m|m<<4)&252645135,m=(m|m<<2)&858993459,m=(m|m<<1)&1431655765,v=(v|v<<8)&16711935,v=(v|v<<4)&252645135,v=(v|v<<2)&858993459,v=(v|v<<1)&1431655765,(v<<1|m)>>>0}function So(e,t){if(e.length===0)return{all:()=>[],byRect:()=>[],byRadius:()=>[],byProperty:()=>[],resetPropertyCache:()=>{},count:()=>0};const i=new xf(e.length),o=new Map;for(const s of e)i.add(s.position.x,s.position.y,s.position.x,s.position.y);return i.finish(),{all(){return e},byRect(s){return i.search(s.left,s.top,s.right,s.bottom).map(c=>e[c])},byRadius(s,u){return i.neighbors(s.x,s.y,void 0,u).map(f=>e[f])},byProperty(s,u){var c;if(!o.has(s)){const f=new Map;for(const g of e){const m=g[s];f.has(m)||f.set(m,[]),f.get(m).push(g)}o.set(s,f)}return((c=o.get(s))==null?void 0:c.get(u))||[]},resetPropertyCache(){o.clear()},count(){return e.length}}}function Nu(e){const t=Object.values(e.entities.entities),i=t.filter(g=>g.type==="human"),o=t.filter(g=>g.type==="berryBush"),a=t.filter(g=>g.type==="corpse"),s=t.filter(g=>g.type==="prey"),u=t.filter(g=>g.type==="predator"),c=t.filter(g=>g.type==="building");return{...e,search:{human:So(i),berryBush:So(o),corpse:So(a),prey:So(s),predator:So(u),building:So(c)}}}const tA="tribe-game-db",or="save-files",$f="tribe-game-save",Sf=1;async function Wf(e){try{const t={version:Sf,savedAt:Date.now(),gameState:e},i=JSON.stringify(t),o=await iA(i);await oA($f,o),console.log(`Game saved successfully. Size: ${(o.size/1024).toFixed(2)} KB`)}catch(t){throw console.error("Failed to save game:",t),t}}async function nA(){try{const e=await sA($f);if(!e)return null;const t=await rA(e),i=JSON.parse(t);return i.version!==Sf?(console.warn(`Save game version mismatch. Expected ${Sf}, found ${i.version}. Discarding save.`),await yf(),null):(console.log("Game loaded successfully."),Nu(i.gameState))}catch(e){return console.error("Failed to load game:",e),await yf(),null}}async function yf(){try{await aA($f),console.log("Saved game cleared.")}catch(e){console.error("Failed to clear saved game:",e)}}async function iA(e){const i=new Blob([e]).stream().pipeThrough(new CompressionStream("gzip"));return await new Response(i).blob()}async function rA(e){const t=e.stream().pipeThrough(new DecompressionStream("gzip"));return await new Response(t).text()}function zf(){return new Promise((e,t)=>{const i=indexedDB.open(tA,1);i.onupgradeneeded=o=>{const a=o.target.result;a.objectStoreNames.contains(or)||a.createObjectStore(or)},i.onsuccess=()=>e(i.result),i.onerror=()=>t(i.error)})}async function oA(e,t){const i=await zf();return new Promise((o,a)=>{const c=i.transaction(or,"readwrite").objectStore(or).put(t,e);c.onsuccess=()=>o(),c.onerror=()=>a(c.error)})}async function sA(e){const t=await zf();return new Promise((i,o)=>{const u=t.transaction(or,"readonly").objectStore(or).get(e);u.onsuccess=()=>i(u.result),u.onerror=()=>o(u.error)})}async function aA(e){const t=await zf();return new Promise((i,o)=>{const u=t.transaction(or,"readwrite").objectStore(or).delete(e);u.onsuccess=()=>i(),u.onerror=()=>o(u.error)})}const q0=De.createContext(void 0),lA=({initialAppState:e,children:t})=>{const[i,o]=De.useState(e),[a,s]=De.useState(void 0),[u,c]=De.useState(null),[f,g]=De.useState(!1);De.useEffect(()=>{nA().then(E=>{E&&c(E),g(!0)})},[]);const m=(E,T)=>{o(E),E==="gameOver"&&T?s(T):E!=="gameOver"&&s(void 0)},v=()=>{o("intro"),s(void 0),I()},y=E=>{Wf(E),c(E)},I=()=>{yf(),c(null)};return Le.jsx(q0.Provider,{value:{appState:i,setAppState:m,returnToIntro:v,gameOverDetails:a,contextReady:f,savedGameState:u,setSavedGameState:c,saveCurrentGame:y,clearCurrentSave:I},children:t})},Qo=()=>{const e=De.useContext(q0);if(e===void 0)throw new Error("useGameContext must be used within a GameProvider");return e};var Ht=function(){return Ht=Object.assign||function(t){for(var i,o=1,a=arguments.length;o<a;o++){i=arguments[o];for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&(t[s]=i[s])}return t},Ht.apply(this,arguments)};function ga(e,t,i){if(i||arguments.length===2)for(var o=0,a=t.length,s;o<a;o++)(s||!(o in t))&&(s||(s=Array.prototype.slice.call(t,0,o)),s[o]=t[o]);return e.concat(s||Array.prototype.slice.call(t))}var Je="-ms-",ra="-moz-",We="-webkit-",Q0="comm",Du="rule",Yf="decl",uA="@import",J0="@keyframes",cA="@layer",ev=Math.abs,jf=String.fromCharCode,Tf=Object.assign;function dA(e,t){return Et(e,0)^45?(((t<<2^Et(e,0))<<2^Et(e,1))<<2^Et(e,2))<<2^Et(e,3):0}function tv(e){return e.trim()}function pi(e,t){return(e=t.exec(e))?e[0]:e}function Fe(e,t,i){return e.replace(t,i)}function cu(e,t,i){return e.indexOf(t,i)}function Et(e,t){return e.charCodeAt(t)|0}function bo(e,t,i){return e.slice(t,i)}function ni(e){return e.length}function nv(e){return e.length}function Js(e,t){return t.push(e),e}function fA(e,t){return e.map(t).join("")}function _m(e,t){return e.filter(function(i){return!pi(i,t)})}var Ou=1,Go=1,iv=0,Cn=0,gt=0,Jo="";function Mu(e,t,i,o,a,s,u,c){return{value:e,root:t,parent:i,type:o,props:a,children:s,line:Ou,column:Go,length:u,return:"",siblings:c}}function Vi(e,t){return Tf(Mu("",null,null,"",null,null,0,e.siblings),e,{length:-e.length},t)}function yo(e){for(;e.root;)e=Vi(e.root,{children:[e]});Js(e,e.siblings)}function hA(){return gt}function gA(){return gt=Cn>0?Et(Jo,--Cn):0,Go--,gt===10&&(Go=1,Ou--),gt}function Hn(){return gt=Cn<iv?Et(Jo,Cn++):0,Go++,gt===10&&(Go=1,Ou++),gt}function kr(){return Et(Jo,Cn)}function du(){return Cn}function ku(e,t){return bo(Jo,e,t)}function Af(e){switch(e){case 0:case 9:case 10:case 13:case 32:return 5;case 33:case 43:case 44:case 47:case 62:case 64:case 126:case 59:case 123:case 125:return 4;case 58:return 3;case 34:case 39:case 40:case 91:return 2;case 41:case 93:return 1}return 0}function pA(e){return Ou=Go=1,iv=ni(Jo=e),Cn=0,[]}function mA(e){return Jo="",e}function bd(e){return tv(ku(Cn-1,If(e===91?e+2:e===40?e+1:e)))}function vA(e){for(;(gt=kr())&&gt<33;)Hn();return Af(e)>2||Af(gt)>3?"":" "}function SA(e,t){for(;--t&&Hn()&&!(gt<48||gt>102||gt>57&&gt<65||gt>70&&gt<97););return ku(e,du()+(t<6&&kr()==32&&Hn()==32))}function If(e){for(;Hn();)switch(gt){case e:return Cn;case 34:case 39:e!==34&&e!==39&&If(gt);break;case 40:e===41&&If(e);break;case 92:Hn();break}return Cn}function yA(e,t){for(;Hn()&&e+gt!==57;)if(e+gt===84&&kr()===47)break;return"/*"+ku(t,Cn-1)+"*"+jf(e===47?e:Hn())}function TA(e){for(;!Af(kr());)Hn();return ku(e,Cn)}function AA(e){return mA(fu("",null,null,null,[""],e=pA(e),0,[0],e))}function fu(e,t,i,o,a,s,u,c,f){for(var g=0,m=0,v=u,y=0,I=0,E=0,T=1,w=1,O=1,L=0,N="",H=a,b=s,U=o,G=N;w;)switch(E=L,L=Hn()){case 40:if(E!=108&&Et(G,v-1)==58){cu(G+=Fe(bd(L),"&","&\f"),"&\f",ev(g?c[g-1]:0))!=-1&&(O=-1);break}case 34:case 39:case 91:G+=bd(L);break;case 9:case 10:case 13:case 32:G+=vA(E);break;case 92:G+=SA(du()-1,7);continue;case 47:switch(kr()){case 42:case 47:Js(IA(yA(Hn(),du()),t,i,f),f);break;default:G+="/"}break;case 123*T:c[g++]=ni(G)*O;case 125*T:case 59:case 0:switch(L){case 0:case 125:w=0;case 59+m:O==-1&&(G=Fe(G,/\f/g,"")),I>0&&ni(G)-v&&Js(I>32?Pm(G+";",o,i,v-1,f):Pm(Fe(G," ","")+";",o,i,v-2,f),f);break;case 59:G+=";";default:if(Js(U=Rm(G,t,i,g,m,a,c,N,H=[],b=[],v,s),s),L===123)if(m===0)fu(G,t,U,U,H,s,v,c,b);else switch(y===99&&Et(G,3)===110?100:y){case 100:case 108:case 109:case 115:fu(e,U,U,o&&Js(Rm(e,U,U,0,0,a,c,N,a,H=[],v,b),b),a,b,v,c,o?H:b);break;default:fu(G,U,U,U,[""],b,0,c,b)}}g=m=I=0,T=O=1,N=G="",v=u;break;case 58:v=1+ni(G),I=E;default:if(T<1){if(L==123)--T;else if(L==125&&T++==0&&gA()==125)continue}switch(G+=jf(L),L*T){case 38:O=m>0?1:(G+="\f",-1);break;case 44:c[g++]=(ni(G)-1)*O,O=1;break;case 64:kr()===45&&(G+=bd(Hn())),y=kr(),m=v=ni(N=G+=TA(du())),L++;break;case 45:E===45&&ni(G)==2&&(T=0)}}return s}function Rm(e,t,i,o,a,s,u,c,f,g,m,v){for(var y=a-1,I=a===0?s:[""],E=nv(I),T=0,w=0,O=0;T<o;++T)for(var L=0,N=bo(e,y+1,y=ev(w=u[T])),H=e;L<E;++L)(H=tv(w>0?I[L]+" "+N:Fe(N,/&\f/g,I[L])))&&(f[O++]=H);return Mu(e,t,i,a===0?Du:c,f,g,m,v)}function IA(e,t,i,o){return Mu(e,t,i,Q0,jf(hA()),bo(e,2,-2),0,o)}function Pm(e,t,i,o,a){return Mu(e,t,i,Yf,bo(e,0,o),bo(e,o+1,-1),o,a)}function rv(e,t,i){switch(dA(e,t)){case 5103:return We+"print-"+e+e;case 5737:case 4201:case 3177:case 3433:case 1641:case 4457:case 2921:case 5572:case 6356:case 5844:case 3191:case 6645:case 3005:case 6391:case 5879:case 5623:case 6135:case 4599:case 4855:case 4215:case 6389:case 5109:case 5365:case 5621:case 3829:return We+e+e;case 4789:return ra+e+e;case 5349:case 4246:case 4810:case 6968:case 2756:return We+e+ra+e+Je+e+e;case 5936:switch(Et(e,t+11)){case 114:return We+e+Je+Fe(e,/[svh]\w+-[tblr]{2}/,"tb")+e;case 108:return We+e+Je+Fe(e,/[svh]\w+-[tblr]{2}/,"tb-rl")+e;case 45:return We+e+Je+Fe(e,/[svh]\w+-[tblr]{2}/,"lr")+e}case 6828:case 4268:case 2903:return We+e+Je+e+e;case 6165:return We+e+Je+"flex-"+e+e;case 5187:return We+e+Fe(e,/(\w+).+(:[^]+)/,We+"box-$1$2"+Je+"flex-$1$2")+e;case 5443:return We+e+Je+"flex-item-"+Fe(e,/flex-|-self/g,"")+(pi(e,/flex-|baseline/)?"":Je+"grid-row-"+Fe(e,/flex-|-self/g,""))+e;case 4675:return We+e+Je+"flex-line-pack"+Fe(e,/align-content|flex-|-self/g,"")+e;case 5548:return We+e+Je+Fe(e,"shrink","negative")+e;case 5292:return We+e+Je+Fe(e,"basis","preferred-size")+e;case 6060:return We+"box-"+Fe(e,"-grow","")+We+e+Je+Fe(e,"grow","positive")+e;case 4554:return We+Fe(e,/([^-])(transform)/g,"$1"+We+"$2")+e;case 6187:return Fe(Fe(Fe(e,/(zoom-|grab)/,We+"$1"),/(image-set)/,We+"$1"),e,"")+e;case 5495:case 3959:return Fe(e,/(image-set\([^]*)/,We+"$1$`$1");case 4968:return Fe(Fe(e,/(.+:)(flex-)?(.*)/,We+"box-pack:$3"+Je+"flex-pack:$3"),/s.+-b[^;]+/,"justify")+We+e+e;case 4200:if(!pi(e,/flex-|baseline/))return Je+"grid-column-align"+bo(e,t)+e;break;case 2592:case 3360:return Je+Fe(e,"template-","")+e;case 4384:case 3616:return i&&i.some(function(o,a){return t=a,pi(o.props,/grid-\w+-end/)})?~cu(e+(i=i[t].value),"span",0)?e:Je+Fe(e,"-start","")+e+Je+"grid-row-span:"+(~cu(i,"span",0)?pi(i,/\d+/):+pi(i,/\d+/)-+pi(e,/\d+/))+";":Je+Fe(e,"-start","")+e;case 4896:case 4128:return i&&i.some(function(o){return pi(o.props,/grid-\w+-start/)})?e:Je+Fe(Fe(e,"-end","-span"),"span ","")+e;case 4095:case 3583:case 4068:case 2532:return Fe(e,/(.+)-inline(.+)/,We+"$1$2")+e;case 8116:case 7059:case 5753:case 5535:case 5445:case 5701:case 4933:case 4677:case 5533:case 5789:case 5021:case 4765:if(ni(e)-1-t>6)switch(Et(e,t+1)){case 109:if(Et(e,t+4)!==45)break;case 102:return Fe(e,/(.+:)(.+)-([^]+)/,"$1"+We+"$2-$3$1"+ra+(Et(e,t+3)==108?"$3":"$2-$3"))+e;case 115:return~cu(e,"stretch",0)?rv(Fe(e,"stretch","fill-available"),t,i)+e:e}break;case 5152:case 5920:return Fe(e,/(.+?):(\d+)(\s*\/\s*(span)?\s*(\d+))?(.*)/,function(o,a,s,u,c,f,g){return Je+a+":"+s+g+(u?Je+a+"-span:"+(c?f:+f-+s)+g:"")+e});case 4949:if(Et(e,t+6)===121)return Fe(e,":",":"+We)+e;break;case 6444:switch(Et(e,Et(e,14)===45?18:11)){case 120:return Fe(e,/(.+:)([^;\s!]+)(;|(\s+)?!.+)?/,"$1"+We+(Et(e,14)===45?"inline-":"")+"box$3$1"+We+"$2$3$1"+Je+"$2box$3")+e;case 100:return Fe(e,":",":"+Je)+e}break;case 5719:case 2647:case 2135:case 3927:case 2391:return Fe(e,"scroll-","scroll-snap-")+e}return e}function Su(e,t){for(var i="",o=0;o<e.length;o++)i+=t(e[o],o,e,t)||"";return i}function EA(e,t,i,o){switch(e.type){case cA:if(e.children.length)break;case uA:case Yf:return e.return=e.return||e.value;case Q0:return"";case J0:return e.return=e.value+"{"+Su(e.children,o)+"}";case Du:if(!ni(e.value=e.props.join(",")))return""}return ni(i=Su(e.children,o))?e.return=e.value+"{"+i+"}":""}function CA(e){var t=nv(e);return function(i,o,a,s){for(var u="",c=0;c<t;c++)u+=e[c](i,o,a,s)||"";return u}}function wA(e){return function(t){t.root||(t=t.return)&&e(t)}}function _A(e,t,i,o){if(e.length>-1&&!e.return)switch(e.type){case Yf:e.return=rv(e.value,e.length,i);return;case J0:return Su([Vi(e,{value:Fe(e.value,"@","@"+We)})],o);case Du:if(e.length)return fA(i=e.props,function(a){switch(pi(a,o=/(::plac\w+|:read-\w+)/)){case":read-only":case":read-write":yo(Vi(e,{props:[Fe(a,/:(read-\w+)/,":"+ra+"$1")]})),yo(Vi(e,{props:[a]})),Tf(e,{props:_m(i,o)});break;case"::placeholder":yo(Vi(e,{props:[Fe(a,/:(plac\w+)/,":"+We+"input-$1")]})),yo(Vi(e,{props:[Fe(a,/:(plac\w+)/,":"+ra+"$1")]})),yo(Vi(e,{props:[Fe(a,/:(plac\w+)/,Je+"input-$1")]})),yo(Vi(e,{props:[a]})),Tf(e,{props:_m(i,o)});break}return""})}}var RA={animationIterationCount:1,aspectRatio:1,borderImageOutset:1,borderImageSlice:1,borderImageWidth:1,boxFlex:1,boxFlexGroup:1,boxOrdinalGroup:1,columnCount:1,columns:1,flex:1,flexGrow:1,flexPositive:1,flexShrink:1,flexNegative:1,flexOrder:1,gridRow:1,gridRowEnd:1,gridRowSpan:1,gridRowStart:1,gridColumn:1,gridColumnEnd:1,gridColumnSpan:1,gridColumnStart:1,msGridRow:1,msGridRowSpan:1,msGridColumn:1,msGridColumnSpan:1,fontWeight:1,lineHeight:1,opacity:1,order:1,orphans:1,tabSize:1,widows:1,zIndex:1,zoom:1,WebkitLineClamp:1,fillOpacity:1,floodOpacity:1,stopOpacity:1,strokeDasharray:1,strokeDashoffset:1,strokeMiterlimit:1,strokeOpacity:1,strokeWidth:1},dn={},xo=typeof process<"u"&&dn!==void 0&&(dn.REACT_APP_SC_ATTR||dn.SC_ATTR)||"data-styled",ov="active",sv="data-styled-version",Fu="6.1.13",Vf=`/*!sc*/
`,yu=typeof window<"u"&&"HTMLElement"in window,PA=!!(typeof SC_DISABLE_SPEEDY=="boolean"?SC_DISABLE_SPEEDY:typeof process<"u"&&dn!==void 0&&dn.REACT_APP_SC_DISABLE_SPEEDY!==void 0&&dn.REACT_APP_SC_DISABLE_SPEEDY!==""?dn.REACT_APP_SC_DISABLE_SPEEDY!=="false"&&dn.REACT_APP_SC_DISABLE_SPEEDY:typeof process<"u"&&dn!==void 0&&dn.SC_DISABLE_SPEEDY!==void 0&&dn.SC_DISABLE_SPEEDY!==""&&dn.SC_DISABLE_SPEEDY!=="false"&&dn.SC_DISABLE_SPEEDY),NA={},Lu=Object.freeze([]),$o=Object.freeze({});function av(e,t,i){return i===void 0&&(i=$o),e.theme!==i.theme&&e.theme||t||i.theme}var lv=new Set(["a","abbr","address","area","article","aside","audio","b","base","bdi","bdo","big","blockquote","body","br","button","canvas","caption","cite","code","col","colgroup","data","datalist","dd","del","details","dfn","dialog","div","dl","dt","em","embed","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","header","hgroup","hr","html","i","iframe","img","input","ins","kbd","keygen","label","legend","li","link","main","map","mark","menu","menuitem","meta","meter","nav","noscript","object","ol","optgroup","option","output","p","param","picture","pre","progress","q","rp","rt","ruby","s","samp","script","section","select","small","source","span","strong","style","sub","summary","sup","table","tbody","td","textarea","tfoot","th","thead","time","tr","track","u","ul","use","var","video","wbr","circle","clipPath","defs","ellipse","foreignObject","g","image","line","linearGradient","marker","mask","path","pattern","polygon","polyline","radialGradient","rect","stop","svg","text","tspan"]),DA=/[!"#$%&'()*+,./:;<=>?@[\\\]^`{|}~-]+/g,OA=/(^-|-$)/g;function Nm(e){return e.replace(DA,"-").replace(OA,"")}var MA=/(a)(d)/gi,$l=52,Dm=function(e){return String.fromCharCode(e+(e>25?39:97))};function Ef(e){var t,i="";for(t=Math.abs(e);t>$l;t=t/$l|0)i=Dm(t%$l)+i;return(Dm(t%$l)+i).replace(MA,"$1-$2")}var Gd,uv=5381,Oo=function(e,t){for(var i=t.length;i;)e=33*e^t.charCodeAt(--i);return e},cv=function(e){return Oo(uv,e)};function dv(e){return Ef(cv(e)>>>0)}function kA(e){return e.displayName||e.name||"Component"}function xd(e){return typeof e=="string"&&!0}var fv=typeof Symbol=="function"&&Symbol.for,hv=fv?Symbol.for("react.memo"):60115,FA=fv?Symbol.for("react.forward_ref"):60112,LA={childContextTypes:!0,contextType:!0,contextTypes:!0,defaultProps:!0,displayName:!0,getDefaultProps:!0,getDerivedStateFromError:!0,getDerivedStateFromProps:!0,mixins:!0,propTypes:!0,type:!0},UA={name:!0,length:!0,prototype:!0,caller:!0,callee:!0,arguments:!0,arity:!0},gv={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},BA=((Gd={})[FA]={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},Gd[hv]=gv,Gd);function Om(e){return("type"in(t=e)&&t.type.$$typeof)===hv?gv:"$$typeof"in e?BA[e.$$typeof]:LA;var t}var HA=Object.defineProperty,bA=Object.getOwnPropertyNames,Mm=Object.getOwnPropertySymbols,GA=Object.getOwnPropertyDescriptor,xA=Object.getPrototypeOf,km=Object.prototype;function pv(e,t,i){if(typeof t!="string"){if(km){var o=xA(t);o&&o!==km&&pv(e,o,i)}var a=bA(t);Mm&&(a=a.concat(Mm(t)));for(var s=Om(e),u=Om(t),c=0;c<a.length;++c){var f=a[c];if(!(f in UA||i&&i[f]||u&&f in u||s&&f in s)){var g=GA(t,f);try{HA(e,f,g)}catch{}}}}return e}function Wo(e){return typeof e=="function"}function Xf(e){return typeof e=="object"&&"styledComponentId"in e}function Or(e,t){return e&&t?"".concat(e," ").concat(t):e||t||""}function Cf(e,t){if(e.length===0)return"";for(var i=e[0],o=1;o<e.length;o++)i+=e[o];return i}function pa(e){return e!==null&&typeof e=="object"&&e.constructor.name===Object.name&&!("props"in e&&e.$$typeof)}function wf(e,t,i){if(i===void 0&&(i=!1),!i&&!pa(e)&&!Array.isArray(e))return t;if(Array.isArray(t))for(var o=0;o<t.length;o++)e[o]=wf(e[o],t[o]);else if(pa(t))for(var o in t)e[o]=wf(e[o],t[o]);return e}function Kf(e,t){Object.defineProperty(e,"toString",{value:t})}function Ra(e){for(var t=[],i=1;i<arguments.length;i++)t[i-1]=arguments[i];return new Error("An error occurred. See https://github.com/styled-components/styled-components/blob/main/packages/styled-components/src/utils/errors.md#".concat(e," for more information.").concat(t.length>0?" Args: ".concat(t.join(", ")):""))}var $A=function(){function e(t){this.groupSizes=new Uint32Array(512),this.length=512,this.tag=t}return e.prototype.indexOfGroup=function(t){for(var i=0,o=0;o<t;o++)i+=this.groupSizes[o];return i},e.prototype.insertRules=function(t,i){if(t>=this.groupSizes.length){for(var o=this.groupSizes,a=o.length,s=a;t>=s;)if((s<<=1)<0)throw Ra(16,"".concat(t));this.groupSizes=new Uint32Array(s),this.groupSizes.set(o),this.length=s;for(var u=a;u<s;u++)this.groupSizes[u]=0}for(var c=this.indexOfGroup(t+1),f=(u=0,i.length);u<f;u++)this.tag.insertRule(c,i[u])&&(this.groupSizes[t]++,c++)},e.prototype.clearGroup=function(t){if(t<this.length){var i=this.groupSizes[t],o=this.indexOfGroup(t),a=o+i;this.groupSizes[t]=0;for(var s=o;s<a;s++)this.tag.deleteRule(o)}},e.prototype.getGroup=function(t){var i="";if(t>=this.length||this.groupSizes[t]===0)return i;for(var o=this.groupSizes[t],a=this.indexOfGroup(t),s=a+o,u=a;u<s;u++)i+="".concat(this.tag.getRule(u)).concat(Vf);return i},e}(),hu=new Map,Tu=new Map,gu=1,Wl=function(e){if(hu.has(e))return hu.get(e);for(;Tu.has(gu);)gu++;var t=gu++;return hu.set(e,t),Tu.set(t,e),t},WA=function(e,t){gu=t+1,hu.set(e,t),Tu.set(t,e)},zA="style[".concat(xo,"][").concat(sv,'="').concat(Fu,'"]'),YA=new RegExp("^".concat(xo,'\\.g(\\d+)\\[id="([\\w\\d-]+)"\\].*?"([^"]*)')),jA=function(e,t,i){for(var o,a=i.split(","),s=0,u=a.length;s<u;s++)(o=a[s])&&e.registerName(t,o)},VA=function(e,t){for(var i,o=((i=t.textContent)!==null&&i!==void 0?i:"").split(Vf),a=[],s=0,u=o.length;s<u;s++){var c=o[s].trim();if(c){var f=c.match(YA);if(f){var g=0|parseInt(f[1],10),m=f[2];g!==0&&(WA(m,g),jA(e,m,f[3]),e.getTag().insertRules(g,a)),a.length=0}else a.push(c)}}},Fm=function(e){for(var t=document.querySelectorAll(zA),i=0,o=t.length;i<o;i++){var a=t[i];a&&a.getAttribute(xo)!==ov&&(VA(e,a),a.parentNode&&a.parentNode.removeChild(a))}};function XA(){return typeof __webpack_nonce__<"u"?__webpack_nonce__:null}var mv=function(e){var t=document.head,i=e||t,o=document.createElement("style"),a=function(c){var f=Array.from(c.querySelectorAll("style[".concat(xo,"]")));return f[f.length-1]}(i),s=a!==void 0?a.nextSibling:null;o.setAttribute(xo,ov),o.setAttribute(sv,Fu);var u=XA();return u&&o.setAttribute("nonce",u),i.insertBefore(o,s),o},KA=function(){function e(t){this.element=mv(t),this.element.appendChild(document.createTextNode("")),this.sheet=function(i){if(i.sheet)return i.sheet;for(var o=document.styleSheets,a=0,s=o.length;a<s;a++){var u=o[a];if(u.ownerNode===i)return u}throw Ra(17)}(this.element),this.length=0}return e.prototype.insertRule=function(t,i){try{return this.sheet.insertRule(i,t),this.length++,!0}catch{return!1}},e.prototype.deleteRule=function(t){this.sheet.deleteRule(t),this.length--},e.prototype.getRule=function(t){var i=this.sheet.cssRules[t];return i&&i.cssText?i.cssText:""},e}(),ZA=function(){function e(t){this.element=mv(t),this.nodes=this.element.childNodes,this.length=0}return e.prototype.insertRule=function(t,i){if(t<=this.length&&t>=0){var o=document.createTextNode(i);return this.element.insertBefore(o,this.nodes[t]||null),this.length++,!0}return!1},e.prototype.deleteRule=function(t){this.element.removeChild(this.nodes[t]),this.length--},e.prototype.getRule=function(t){return t<this.length?this.nodes[t].textContent:""},e}(),qA=function(){function e(t){this.rules=[],this.length=0}return e.prototype.insertRule=function(t,i){return t<=this.length&&(this.rules.splice(t,0,i),this.length++,!0)},e.prototype.deleteRule=function(t){this.rules.splice(t,1),this.length--},e.prototype.getRule=function(t){return t<this.length?this.rules[t]:""},e}(),Lm=yu,QA={isServer:!yu,useCSSOMInjection:!PA},Au=function(){function e(t,i,o){t===void 0&&(t=$o),i===void 0&&(i={});var a=this;this.options=Ht(Ht({},QA),t),this.gs=i,this.names=new Map(o),this.server=!!t.isServer,!this.server&&yu&&Lm&&(Lm=!1,Fm(this)),Kf(this,function(){return function(s){for(var u=s.getTag(),c=u.length,f="",g=function(v){var y=function(O){return Tu.get(O)}(v);if(y===void 0)return"continue";var I=s.names.get(y),E=u.getGroup(v);if(I===void 0||!I.size||E.length===0)return"continue";var T="".concat(xo,".g").concat(v,'[id="').concat(y,'"]'),w="";I!==void 0&&I.forEach(function(O){O.length>0&&(w+="".concat(O,","))}),f+="".concat(E).concat(T,'{content:"').concat(w,'"}').concat(Vf)},m=0;m<c;m++)g(m);return f}(a)})}return e.registerId=function(t){return Wl(t)},e.prototype.rehydrate=function(){!this.server&&yu&&Fm(this)},e.prototype.reconstructWithOptions=function(t,i){return i===void 0&&(i=!0),new e(Ht(Ht({},this.options),t),this.gs,i&&this.names||void 0)},e.prototype.allocateGSInstance=function(t){return this.gs[t]=(this.gs[t]||0)+1},e.prototype.getTag=function(){return this.tag||(this.tag=(t=function(i){var o=i.useCSSOMInjection,a=i.target;return i.isServer?new qA(a):o?new KA(a):new ZA(a)}(this.options),new $A(t)));var t},e.prototype.hasNameForId=function(t,i){return this.names.has(t)&&this.names.get(t).has(i)},e.prototype.registerName=function(t,i){if(Wl(t),this.names.has(t))this.names.get(t).add(i);else{var o=new Set;o.add(i),this.names.set(t,o)}},e.prototype.insertRules=function(t,i,o){this.registerName(t,i),this.getTag().insertRules(Wl(t),o)},e.prototype.clearNames=function(t){this.names.has(t)&&this.names.get(t).clear()},e.prototype.clearRules=function(t){this.getTag().clearGroup(Wl(t)),this.clearNames(t)},e.prototype.clearTag=function(){this.tag=void 0},e}(),JA=/&/g,eI=/^\s*\/\/.*$/gm;function vv(e,t){return e.map(function(i){return i.type==="rule"&&(i.value="".concat(t," ").concat(i.value),i.value=i.value.replaceAll(",",",".concat(t," ")),i.props=i.props.map(function(o){return"".concat(t," ").concat(o)})),Array.isArray(i.children)&&i.type!=="@keyframes"&&(i.children=vv(i.children,t)),i})}function tI(e){var t,i,o,a=$o,s=a.options,u=s===void 0?$o:s,c=a.plugins,f=c===void 0?Lu:c,g=function(y,I,E){return E.startsWith(i)&&E.endsWith(i)&&E.replaceAll(i,"").length>0?".".concat(t):y},m=f.slice();m.push(function(y){y.type===Du&&y.value.includes("&")&&(y.props[0]=y.props[0].replace(JA,i).replace(o,g))}),u.prefix&&m.push(_A),m.push(EA);var v=function(y,I,E,T){I===void 0&&(I=""),E===void 0&&(E=""),T===void 0&&(T="&"),t=T,i=I,o=new RegExp("\\".concat(i,"\\b"),"g");var w=y.replace(eI,""),O=AA(E||I?"".concat(E," ").concat(I," { ").concat(w," }"):w);u.namespace&&(O=vv(O,u.namespace));var L=[];return Su(O,CA(m.concat(wA(function(N){return L.push(N)})))),L};return v.hash=f.length?f.reduce(function(y,I){return I.name||Ra(15),Oo(y,I.name)},uv).toString():"",v}var nI=new Au,_f=tI(),Sv=ii.createContext({shouldForwardProp:void 0,styleSheet:nI,stylis:_f});Sv.Consumer;ii.createContext(void 0);function Rf(){return De.useContext(Sv)}var iI=function(){function e(t,i){var o=this;this.inject=function(a,s){s===void 0&&(s=_f);var u=o.name+s.hash;a.hasNameForId(o.id,u)||a.insertRules(o.id,u,s(o.rules,u,"@keyframes"))},this.name=t,this.id="sc-keyframes-".concat(t),this.rules=i,Kf(this,function(){throw Ra(12,String(o.name))})}return e.prototype.getName=function(t){return t===void 0&&(t=_f),this.name+t.hash},e}(),rI=function(e){return e>="A"&&e<="Z"};function Um(e){for(var t="",i=0;i<e.length;i++){var o=e[i];if(i===1&&o==="-"&&e[0]==="-")return e;rI(o)?t+="-"+o.toLowerCase():t+=o}return t.startsWith("ms-")?"-"+t:t}var yv=function(e){return e==null||e===!1||e===""},Tv=function(e){var t,i,o=[];for(var a in e){var s=e[a];e.hasOwnProperty(a)&&!yv(s)&&(Array.isArray(s)&&s.isCss||Wo(s)?o.push("".concat(Um(a),":"),s,";"):pa(s)?o.push.apply(o,ga(ga(["".concat(a," {")],Tv(s),!1),["}"],!1)):o.push("".concat(Um(a),": ").concat((t=a,(i=s)==null||typeof i=="boolean"||i===""?"":typeof i!="number"||i===0||t in RA||t.startsWith("--")?String(i).trim():"".concat(i,"px")),";")))}return o};function ir(e,t,i,o){if(yv(e))return[];if(Xf(e))return[".".concat(e.styledComponentId)];if(Wo(e)){if(!Wo(s=e)||s.prototype&&s.prototype.isReactComponent||!t)return[e];var a=e(t);return ir(a,t,i,o)}var s;return e instanceof iI?i?(e.inject(i,o),[e.getName(o)]):[e]:pa(e)?Tv(e):Array.isArray(e)?Array.prototype.concat.apply(Lu,e.map(function(u){return ir(u,t,i,o)})):[e.toString()]}function Av(e){for(var t=0;t<e.length;t+=1){var i=e[t];if(Wo(i)&&!Xf(i))return!1}return!0}var oI=cv(Fu),sI=function(){function e(t,i,o){this.rules=t,this.staticRulesId="",this.isStatic=(o===void 0||o.isStatic)&&Av(t),this.componentId=i,this.baseHash=Oo(oI,i),this.baseStyle=o,Au.registerId(i)}return e.prototype.generateAndInjectStyles=function(t,i,o){var a=this.baseStyle?this.baseStyle.generateAndInjectStyles(t,i,o):"";if(this.isStatic&&!o.hash)if(this.staticRulesId&&i.hasNameForId(this.componentId,this.staticRulesId))a=Or(a,this.staticRulesId);else{var s=Cf(ir(this.rules,t,i,o)),u=Ef(Oo(this.baseHash,s)>>>0);if(!i.hasNameForId(this.componentId,u)){var c=o(s,".".concat(u),void 0,this.componentId);i.insertRules(this.componentId,u,c)}a=Or(a,u),this.staticRulesId=u}else{for(var f=Oo(this.baseHash,o.hash),g="",m=0;m<this.rules.length;m++){var v=this.rules[m];if(typeof v=="string")g+=v;else if(v){var y=Cf(ir(v,t,i,o));f=Oo(f,y+m),g+=y}}if(g){var I=Ef(f>>>0);i.hasNameForId(this.componentId,I)||i.insertRules(this.componentId,I,o(g,".".concat(I),void 0,this.componentId)),a=Or(a,I)}}return a},e}(),Zf=ii.createContext(void 0);Zf.Consumer;var $d={};function aI(e,t,i){var o=Xf(e),a=e,s=!xd(e),u=t.attrs,c=u===void 0?Lu:u,f=t.componentId,g=f===void 0?function(H,b){var U=typeof H!="string"?"sc":Nm(H);$d[U]=($d[U]||0)+1;var G="".concat(U,"-").concat(dv(Fu+U+$d[U]));return b?"".concat(b,"-").concat(G):G}(t.displayName,t.parentComponentId):f,m=t.displayName,v=m===void 0?function(H){return xd(H)?"styled.".concat(H):"Styled(".concat(kA(H),")")}(e):m,y=t.displayName&&t.componentId?"".concat(Nm(t.displayName),"-").concat(t.componentId):t.componentId||g,I=o&&a.attrs?a.attrs.concat(c).filter(Boolean):c,E=t.shouldForwardProp;if(o&&a.shouldForwardProp){var T=a.shouldForwardProp;if(t.shouldForwardProp){var w=t.shouldForwardProp;E=function(H,b){return T(H,b)&&w(H,b)}}else E=T}var O=new sI(i,y,o?a.componentStyle:void 0);function L(H,b){return function(U,G,Q){var ee=U.attrs,me=U.componentStyle,be=U.defaultProps,Ne=U.foldedComponentIds,Ie=U.styledComponentId,he=U.target,ke=ii.useContext(Zf),ve=Rf(),te=U.shouldForwardProp||ve.shouldForwardProp,z=av(G,ke,be)||$o,X=function(pe,oe,_e){for(var Ce,Z=Ht(Ht({},oe),{className:void 0,theme:_e}),se=0;se<pe.length;se+=1){var Ue=Wo(Ce=pe[se])?Ce(Z):Ce;for(var Se in Ue)Z[Se]=Se==="className"?Or(Z[Se],Ue[Se]):Se==="style"?Ht(Ht({},Z[Se]),Ue[Se]):Ue[Se]}return oe.className&&(Z.className=Or(Z.className,oe.className)),Z}(ee,G,z),Y=X.as||he,P={};for(var B in X)X[B]===void 0||B[0]==="$"||B==="as"||B==="theme"&&X.theme===z||(B==="forwardedAs"?P.as=X.forwardedAs:te&&!te(B,Y)||(P[B]=X[B]));var K=function(pe,oe){var _e=Rf(),Ce=pe.generateAndInjectStyles(oe,_e.styleSheet,_e.stylis);return Ce}(me,X),J=Or(Ne,Ie);return K&&(J+=" "+K),X.className&&(J+=" "+X.className),P[xd(Y)&&!lv.has(Y)?"class":"className"]=J,P.ref=Q,De.createElement(Y,P)}(N,H,b)}L.displayName=v;var N=ii.forwardRef(L);return N.attrs=I,N.componentStyle=O,N.displayName=v,N.shouldForwardProp=E,N.foldedComponentIds=o?Or(a.foldedComponentIds,a.styledComponentId):"",N.styledComponentId=y,N.target=o?a.target:e,Object.defineProperty(N,"defaultProps",{get:function(){return this._foldedDefaultProps},set:function(H){this._foldedDefaultProps=o?function(b){for(var U=[],G=1;G<arguments.length;G++)U[G-1]=arguments[G];for(var Q=0,ee=U;Q<ee.length;Q++)wf(b,ee[Q],!0);return b}({},a.defaultProps,H):H}}),Kf(N,function(){return".".concat(N.styledComponentId)}),s&&pv(N,e,{attrs:!0,componentStyle:!0,displayName:!0,foldedComponentIds:!0,shouldForwardProp:!0,styledComponentId:!0,target:!0}),N}function Bm(e,t){for(var i=[e[0]],o=0,a=t.length;o<a;o+=1)i.push(t[o],e[o+1]);return i}var Hm=function(e){return Object.assign(e,{isCss:!0})};function Iv(e){for(var t=[],i=1;i<arguments.length;i++)t[i-1]=arguments[i];if(Wo(e)||pa(e))return Hm(ir(Bm(Lu,ga([e],t,!0))));var o=e;return t.length===0&&o.length===1&&typeof o[0]=="string"?ir(o):Hm(ir(Bm(o,t)))}function Pf(e,t,i){if(i===void 0&&(i=$o),!t)throw Ra(1,t);var o=function(a){for(var s=[],u=1;u<arguments.length;u++)s[u-1]=arguments[u];return e(t,i,Iv.apply(void 0,ga([a],s,!1)))};return o.attrs=function(a){return Pf(e,t,Ht(Ht({},i),{attrs:Array.prototype.concat(i.attrs,a).filter(Boolean)}))},o.withConfig=function(a){return Pf(e,t,Ht(Ht({},i),a))},o}var Ev=function(e){return Pf(aI,e)},Rn=Ev;lv.forEach(function(e){Rn[e]=Ev(e)});var lI=function(){function e(t,i){this.rules=t,this.componentId=i,this.isStatic=Av(t),Au.registerId(this.componentId+1)}return e.prototype.createStyles=function(t,i,o,a){var s=a(Cf(ir(this.rules,i,o,a)),""),u=this.componentId+t;o.insertRules(u,u,s)},e.prototype.removeStyles=function(t,i){i.clearRules(this.componentId+t)},e.prototype.renderStyles=function(t,i,o,a){t>2&&Au.registerId(this.componentId+t),this.removeStyles(t,o),this.createStyles(t,i,o,a)},e}();function uI(e){for(var t=[],i=1;i<arguments.length;i++)t[i-1]=arguments[i];var o=Iv.apply(void 0,ga([e],t,!1)),a="sc-global-".concat(dv(JSON.stringify(o))),s=new lI(o,a),u=function(f){var g=Rf(),m=ii.useContext(Zf),v=ii.useRef(g.styleSheet.allocateGSInstance(a)).current;return g.styleSheet.server&&c(v,f,g.styleSheet,m,g.stylis),ii.useLayoutEffect(function(){if(!g.styleSheet.server)return c(v,f,g.styleSheet,m,g.stylis),function(){return s.removeStyles(v,g.styleSheet)}},[v,f,g.styleSheet,m,g.stylis]),null};function c(f,g,m,v,y){if(s.isStatic)s.renderStyles(f,NA,m,y);else{var I=Ht(Ht({},g),{theme:av(g,v,u.defaultProps)});s.renderStyles(f,I,m,y)}}return ii.memo(u)}function Cv(e,t){var i=De.useRef(null),o=De.useRef(!1),a=De.useRef(e);a.current=e;var s=De.useCallback(function(c){o.current&&(a.current(c),i.current=requestAnimationFrame(s))},[]),u=De.useMemo(function(){return[function(){o.current&&(o.current=!1,i.current&&cancelAnimationFrame(i.current))},function(){o.current||(o.current=!0,i.current=requestAnimationFrame(s))},function(){return o.current}]},[]);return De.useEffect(function(){return u[0]},[]),u}function cI(e,t,i,o,a){var u;(u=e.onExit)==null||u.call(e,o,t);const s=a.find(({id:c})=>c===t);return s!=null&&s.onEnter?s.onEnter(o,i):{...i,enteredAt:o.updateContext.gameState.time}}function dI(e,t){return t.find(({id:i})=>i===e)}function fI(e,t){return e!==t}function hI(e){console.warn(`No handler found for state: ${e}`)}const oa="bushGrowing",Dr="bushFull",pu="bushSpreading",ma="bushDying",wt=24,_t=10,Xe=4e3,et=4e3,qf=2,gI=15,pI=5e3,Si=100,yi=20,Ti=60,mI=1e3,vI=5,SI=3,yI=12,TI=940,Nf=20,bm=90,wv=45,Gr=5,AI=.5,xr=30,Ai=.1,ea=.9;var Gn=(e=>(e.Berry="berry",e.Meat="meat",e))(Gn||{});const Qf={berry:"",meat:""},II={id:oa,update:(e,t)=>{const{entity:i,updateContext:o}=t,a=o.deltaTime*(wt/_t);return i.age+=a,i.age>=i.lifespan?{nextState:ma,data:{...e,enteredAt:o.gameState.time}}:(i.timeSinceLastBerryRegen+=a,i.timeSinceLastBerryRegen>=yI&&i.food.length<i.maxFood&&(i.food.push({type:Gn.Berry}),i.timeSinceLastBerryRegen=0),i.food.length>=i.maxFood?{nextState:Dr,data:{...e,enteredAt:o.gameState.time,previousState:oa}}:{nextState:oa,data:e})},onEnter:(e,t)=>({...t,enteredAt:e.updateContext.gameState.time})},EI={id:Dr,update:(e,t)=>{const{entity:i,updateContext:o}=t,a=o.deltaTime*(wt/_t);return i.age+=a,i.age>=i.lifespan?{nextState:ma,data:{...e,enteredAt:o.gameState.time,previousState:Dr}}:i.food.length<i.maxFood?{nextState:oa,data:{...e,enteredAt:o.gameState.time,previousState:Dr}}:(i.timeSinceLastSpreadAttempt+=a,i.timeSinceLastSpreadAttempt>=bm&&(i.timeSinceLastSpreadAttempt=0,o.gameState.time-i.timeSinceLastHarvest>=bm&&Math.random()<o.gameState.ecosystem.berryBushSpreadChance)?{nextState:pu,data:{...e,enteredAt:o.gameState.time,previousState:Dr}}:{nextState:Dr,data:e})},onEnter:(e,t)=>({...t,enteredAt:e.updateContext.gameState.time})},va=1,Df=150*.6,CI=150*.25,wI=150*.7,_I=150*.8,RI=400,PI=800,_v=300,NI=350,DI=120,OI=2,Gm=400,MI=1e3,kI=150*.85,FI=100,LI=3,UI=24,Rv=600,BI=1,HI=1,bI=.5,GI=2,Of=24,sa=12,xI=24,xm=24,$I=1500,Wd=500,WI=400,zI=10,YI=-5,jI=1.5,VI=1.5,XI=1.2,KI=10,ZI=150,qI=200,QI=100,JI=.7,eE=300,tE=100,nE=120,$m=600,Pv=.15,Nv=200,mu=30*.75*1.2,iE=20,rE=.3,oE=.6,sE=.8,aE=1,lE=3,uE=5,cE=6,Wm=.5,dE=.4,fE=.6,hE=.8,gE=2,zm=Xe/2,pE=60,Ym=2,jm=.7,Vm=.2,Xm=5,Km=50,mE=.1,vE=400,SE=800,Dv=5,Ov=600,Uu=10,Sa=80,yE=3,zs=5,$r=150,Mv=$r*.8,TE=$r*.2,Wr=$r*.95,sr=30,kv=10,AE=10,IE=.5,yt=30,zo=yt*.75,Fv=50,EE=20,CE=Sa*.8,wE=.7,_E=16,Lv=40,RE=24,Jf=16,PE=72/3,Zm=24,NE=1.25,DE=1.5,eh=$r*.6,th=50,OE=1,ME=350,nh=Sa*.65,kE=80,FE=50,LE=1,UE=128,Uv=10,qm=100,ih=35,ri=yt,Bv=.5,Bu=2.5,BE=5,rh=.5,oh=1.5,HE=.1,bE=.5,GE=1.5,xE=.25,$E=2.5,WE=45,zE=.05;function bn(e,t){return{x:e.x+t.x,y:e.y+t.y}}function Hv(e,t){return{x:e.x-t.x,y:e.y-t.y}}function Ot(e,t){return{x:e.x*t,y:e.y*t}}function Yo(e){return Math.sqrt(e.x*e.x+e.y*e.y)}function at(e){const t=Yo(e);return t===0?{x:0,y:0}:Ot(e,1/t)}function YE(e,t){return Yo(Hv(e,t))}function sh(e,t,i){return{x:e.x+(t.x-e.x)*i,y:e.y+(t.y-e.y)*i}}function Iu(e){if(e.length===0)return{x:0,y:0};const t=e.reduce((i,o)=>({x:i.x+o.x,y:i.y+o.y}),{x:0,y:0});return{x:t.x/e.length,y:t.y/e.length}}function Ye(e,t,i,o){let a=t.x-e.x,s=t.y-e.y;return Math.abs(a)>i/2&&(a=a-Math.sign(a)*i),Math.abs(s)>o/2&&(s=s-Math.sign(s)*o),{x:a,y:s}}function Bt(e,t,i){const o=Ye(e,t,i.width,i.height);return at(o)}function j(e,t,i,o){const a=Ye(e,t,i,o);return Yo(a)}function jE(e,t){return e.x*t.x+e.y*t.y}function VE(e,t){const i=jE(e,t),o=Yo(e),a=Yo(t);if(o===0||a===0)return 0;const s=Math.max(-1,Math.min(1,i/(o*a)));return Math.acos(s)}function XE(e,t,i){const o=Math.max(0,Math.min(1,i)),a={r:parseInt(e.substring(1,3),16),g:parseInt(e.substring(3,5),16),b:parseInt(e.substring(5,7),16)},s={r:parseInt(t.substring(1,3),16),g:parseInt(t.substring(3,5),16),b:parseInt(t.substring(5,7),16)},u=Math.round(a.r+(s.r-a.r)*o),c=Math.round(a.g+(s.g-a.g)*o),f=Math.round(a.b+(s.b-a.b)*o),g=m=>("00"+m.toString(16)).slice(-2);return`#${g(u)}${g(c)}${g(f)}`}var St=(e=>(e.Friendly="Friendly",e.Hostile="Hostile",e))(St||{}),dt=(e=>(e[e.None=0]="None",e[e.General=1]="General",e[e.Performance=2]="Performance",e[e.Ecosystem=3]="Ecosystem",e[e.Tribe=4]="Tribe",e))(dt||{});function Qm(e,t,i){return t.search.human.byRadius(e.position,i).filter(s=>{if(s.id===e.id||s.gender===e.gender||!s.isAdult||s.hunger>=Wr||(s.procreationCooldown||0)>0||s.gender==="female"&&s.isPregnant)return!1;const u=s.id===e.motherId||s.id===e.fatherId,c=e.id===s.motherId||e.id===s.fatherId;return!u&&!c})}function zr(e){if(e.length===0)return;const t=e.filter(a=>a.gender==="male"),i=e.filter(a=>a.gender==="female"),o=(a,s)=>a.age!==s.age?s.age-a.age:a.id-s.id;if(t.sort(o),t.length>0)return t[0];if(i.sort(o),i.length>0)return i[0]}function hn(e,t){const i=e,o=i.search.human.byProperty("motherId",t.id),a=i.search.human.byProperty("fatherId",t.id);return[...o,...a]}function KE(e,t,i){var a;if(e.id===t.id||e.motherId===t.id||e.fatherId===t.id||t.motherId===e.id||t.fatherId===e.id||e.motherId&&e.motherId===t.motherId||e.fatherId&&e.fatherId===t.fatherId||(a=e.partnerIds)!=null&&a.includes(t.id))return!0;if(e.motherId){const s=i.entities.entities[e.motherId];if(s&&(s.motherId===t.id||s.fatherId===t.id))return!0}if(e.fatherId){const s=i.entities.entities[e.fatherId];if(s&&(s.motherId===t.id||s.fatherId===t.id))return!0}if(t.motherId){const s=i.entities.entities[t.motherId];if(s&&(s.motherId===e.id||s.fatherId===e.id))return!0}if(t.fatherId){const s=i.entities.entities[t.fatherId];if(s&&(s.motherId===e.id||s.fatherId===e.id))return!0}return!1}function Jm(e,t){var s,u,c,f;if(e.id===t.id||e.motherId===t.id||e.fatherId===t.id||t.motherId===e.id||t.fatherId===e.id||(s=e.partnerIds)!=null&&s.includes(t.id)||(u=t.partnerIds)!=null&&u.includes(e.id))return!0;if(e.fatherId===void 0&&e.motherId===void 0||t.fatherId===void 0&&t.motherId===void 0)return!1;const i=e.motherId===t.motherId||e.fatherId===t.fatherId,o=t.motherId===e.motherId||t.fatherId===e.fatherId,a=((c=e.ancestorIds)==null?void 0:c.some(g=>t.ancestorIds.includes(g)))||((f=t.ancestorIds)==null?void 0:f.some(g=>e.ancestorIds.includes(g)));return i||o||a}function ZE(e,t){const i=[];if(e.motherId){const o=t.entities.entities[e.motherId];o&&i.push(o)}if(e.fatherId){const o=t.entities.entities[e.fatherId];o&&i.push(o)}return i}function qE(e,t){if(e.gender!=="female"||!e.partnerIds||e.partnerIds.length===0)return null;for(const i of e.partnerIds){const o=t.entities.entities[i];if(o&&o.gender==="male")return o}return null}function QE(e,t){var i;if(!e.isAdult&&e.fatherId){const o=t.entities.entities[e.fatherId];if(o&&o.type==="human")return o}if(e.isAdult&&e.fatherId){const o=t.entities.entities[e.fatherId];if(o&&o.type==="human"&&((i=zr(hn(t,o)))==null?void 0:i.id)===e.id)return o}return e.isAdult&&e.gender==="female"&&e.partnerIds&&e.partnerIds.length>0?qE(e,t):null}function Eu(e,t){var o;const i=new Set;if(e.motherId){const a=t.entities.entities[e.motherId];a&&i.add(a)}if(e.fatherId){const a=t.entities.entities[e.fatherId];a&&i.add(a)}return(o=e.partnerIds)==null||o.forEach(a=>{const s=t.entities.entities[a];s&&i.add(s)}),hn(t,e).forEach(a=>i.add(a)),Array.from(i)}function bv(e,t){const i=new Map;function o(a){const s=hn(t,a);for(const u of s)i.has(u.id)||(i.set(u.id,u),o(u))}return o(e),Array.from(i.values())}function jo(e,t){return t.search.human.byProperty("leaderId",e)}function Gv(e,t){var u,c,f;const i=new Map,o=Object.values(e.entities.entities).filter(g=>g.type==="human");for(const g of o)g.leaderId&&(i.has(g.leaderId)||i.set(g.leaderId,{leaderId:g.leaderId,tribeBadge:g.tribeBadge||"?",members:[]}),(u=i.get(g.leaderId))==null||u.members.push(g));const a=t?(f=(c=e.entities.entities[t])==null?void 0:c.tribeControl)==null?void 0:f.diplomacy:void 0,s=Array.from(i.values()).map(g=>{const m=e.entities.entities[g.leaderId],v=g.members.filter(I=>I.isAdult).length,y=g.members.length-v;return{leaderId:g.leaderId,tribeBadge:g.tribeBadge,adultCount:v,childCount:y,isPlayerTribe:g.leaderId===t,leaderAge:(m==null?void 0:m.age)??0,leaderGender:(m==null?void 0:m.gender)??"male",diplomacyStatus:(a==null?void 0:a[g.leaderId??-1])??St.Friendly}});return s.sort((g,m)=>g.isPlayerTribe?-1:m.isPlayerTribe?1:m.adultCount+m.childCount-(g.adultCount+g.childCount)),s}function wn(e,t){return e.leaderId?t.search.human.byProperty("leaderId",e.leaderId):[]}function xv(e,t,i,o){const a=Math.random()*Math.PI*2,s=Math.sqrt(Math.random())*t,u={x:Math.cos(a)*s,y:Math.sin(a)*s},c=bn(e,u);return{x:(c.x%i+i)%i,y:(c.y%o+o)%o}}function xn(e,t,i,o){const a=t,s={left:e.x-i,top:e.y-i,right:e.x+i,bottom:e.y+i},u=[...a.search.human.byRect(s),...a.search.berryBush.byRect(s),...a.search.corpse.byRect(s)];for(const c of u){if(o!==void 0&&c.id===o)continue;if(j(e,c.position,t.mapDimensions.width,t.mapDimensions.height)<i+c.radius)return!0}return!1}function JE(e,t,i,o,a){const s=t.mapDimensions.width,u=t.mapDimensions.height;if(!xn(e,t,o,a))return e;const c=o;for(let f=c;f<=i;f+=c){const g=Math.ceil(2*Math.PI*f/c);for(let m=0;m<g;m++){const v=m/g*2*Math.PI,y={x:Math.cos(v)*f,y:Math.sin(v)*f},I=bn(e,y),E={x:(I.x%s+s)%s,y:(I.y%u+u)%u};if(!xn(E,t,o,a))return E}}return null}function Yr(e,t){const i=t.search.building.byProperty("ownerId",e);if(i.length>0){const s=i.map(u=>u.position);return Iu(s)}const o=jo(e,t);if(o.length===0){const s=t.entities.entities[e];return s?s.position:{x:0,y:0}}const a=o.map(s=>s.position);return Iu(a)}function e0(e,t){const o=[...Eu(e,t),e].map(a=>a.position);return Iu(o)}function eC(e,t,i){const o=i.mapDimensions.width,a=i.mapDimensions.height;let s=e.x-t.position.x,u=e.y-t.position.y;return Math.abs(s)>o/2&&(s-=Math.sign(s)*o),Math.abs(u)>a/2&&(u-=Math.sign(u)*a),Math.abs(s)<=t.width/2&&Math.abs(u)<=t.height/2}function tC(e,t,i){return t.search.human.byRadius(e.position,i).filter(a=>{var s;return a.activeAction==="procreating"&&a.gender===e.gender&&typeof a.target=="number"&&((s=e.partnerIds)==null?void 0:s.includes(a.target))})[0]}function nC(e,t,i){const o=Eu(e,t),a=t;for(const s of o){if(j(e.position,s.position,t.mapDimensions.width,t.mapDimensions.height)>i)continue;const c=a.search.human.byProperty("attackTargetId",s.id);for(const f of c)if(f.leaderId!==e.leaderId)return{familyMember:s,aggressor:f}}}function iC(e,t){const o=t.search.human.byRadius(e.position,eE);let a,s=1/0;for(const u of o){if(u.id===e.id||u.hitpoints<=0||u.hitpoints/u.maxHitpoints>JI||KE(e,u,t))continue;const c=j(e.position,u.position,t.mapDimensions.width,t.mapDimensions.height);c<s&&(s=c,a=u)}return a}function ah(e,t,i){return t.search.human.byRadius(e.position,i).filter(a=>ts(e,a,t))}function rC(e,t,i){const o=i.search.human.byProperty("leaderId",e);let a=0;for(const s of o)s.attackTargetId===t&&a++;return a}function t0(e,t,i,o){const a=i.search.berryBush.byRadius(e,t),s=i.search.human.byRadius(e,t).filter(f=>f.leaderId!==o);let u=a.length*zI;u+=s.length*YI;let c;if(s.length>0){const f={};for(const m of s)m.leaderId&&(f[m.leaderId]=(f[m.leaderId]||0)+1);let g=0;for(const m in f)f[m]>g&&(g=f[m],c=parseInt(m,10))}return{score:u,occupyingTribeId:c}}function Cu(e){return e.filter(t=>t.isAdult).reduce((t,i)=>{let o=i.hitpoints;return o+=(i.maxAge-i.age)*.5,o+=i.food.length*2,t+o},0)}function oC(e,t){if(e.id!==e.leaderId)return null;const i=t,o=Yr(e.id,t),{score:a}=t0(o,Wd/2,i,e.id);let s=null,u=a;const c=WI,f=$I;for(let g=e.position.x-f;g<e.position.x+f;g+=c)for(let m=e.position.y-f;m<e.position.y+f;m+=c){const v={x:(g%t.mapDimensions.width+t.mapDimensions.width)%t.mapDimensions.width,y:(m%t.mapDimensions.height+t.mapDimensions.height)%t.mapDimensions.height};if(j(o,v,t.mapDimensions.width,t.mapDimensions.height)<Wd*2)continue;const{score:I}=t0(v,Wd/2,i,e.id);I>u*jI&&(u=I,s=v)}return s}function Oe(e,t,i,o,a){const s=t,u=o,c="position"in e&&e.id?e:null,f=c?c.position:e,g=s.search[i].byRadius(f,u);let m=null,v=u;for(const y of g){if(y.id===(c==null?void 0:c.id)||a&&!a(y))continue;const I=j(f,y.position,t.mapDimensions.width,t.mapDimensions.height);I<v&&(v=I,m=y)}return m}function sC(e,t,i,o){return t.search[i].byRadius(e,o)}function n0(e,t,i,o){return sC(e,t,i,o).length}function pt(e){const i=e.search.human.byProperty("isPlayer",!0);return i.length>0?i[0]:void 0}function aC(e,t){var u;const o=t.search.human.byProperty("activeAction","attacking");let a=null,s=1/0;for(const c of o){if(c.attackTargetId!==e)continue;const f=j(c.position,((u=t.entities.entities[e])==null?void 0:u.position)||{x:0,y:0},t.mapDimensions.width,t.mapDimensions.height);f<s&&(a=c,s=f)}return a}function $v(e){return Object.values(e.entities.entities).filter(t=>t.type==="human")}function lC(e,t,i){const o=Object.values(t.entities.entities).reverse();for(const a of o)if(YE(e,a.position)<a.radius)return a}function uC(e,t,i,o){const a=$v(o),s={};for(const u of a)!u.leaderId||u.leaderId===t||(s[u.leaderId]||(s[u.leaderId]={sumX:0,sumY:0,count:0}),s[u.leaderId].sumX+=u.position.x,s[u.leaderId].sumY+=u.position.y,s[u.leaderId].count++);for(const u in s){const c=s[u],f={x:c.sumX/c.count,y:c.sumY/c.count};if(j(e,f,o.mapDimensions.width,o.mapDimensions.height)<i)return!0}return!1}const Rt=30,es=Rt*.6,Wv="#4CAF50",zv="#FF5722",Yv="#9C27B0",cC="#2196F3",jv="#FFC107",dC="#DC143C",lh="#FFFFFF",uh=[5,5],Hu=5,Vo=15,fC=20,hC=16,gC=10,pC=16,mC=16,i0=["","","","","","","","","",""],Mf=8,vC="#FFFFFF",Ct=18,Ve=15,SC="rgba(0, 0, 0, 0.7)",yC=4,$i=150,un=15,hi=10,Qi="#555",TC="#f44336",AC="#4CAF50",IC="#2196F3",EC="#FFC107",zl=16,Cr=32,Yl=28,CC=10,wC=8,_C=8,RC=8,An=28,jl=40,PC="rgba(255, 215, 0, 0.7)",NC="rgba(0, 0, 0, 0.3)",qn=10,r0=8,zd=11,Wi=20,Yd=40,o0=5,DC=10,OC="#FFA500",MC="#808080",vi=120,Vv=30,kC=20,Zi="#2d3748",Yt="#ffffff",Vl="#4a5568",Xv=5,ch="#bdc9f792",Kv="#272c36ff",Zv="#a0aec0",wu=300,qv="rgba(255, 255, 255, 0.5)",FC="rgba(0, 0, 0, 0.8)",LC="#FFFFFF",s0=14,a0=8,l0=-15,Qv="#FFD700",Jv=5,UC=60,BC=-50,HC=10,jd=12,u0=10,bC="rgba(0, 0, 0, 0.5)",GC="#4CAF50",xC="#F44336",$C="#FFC107",WC="rgba(255, 255, 255, 0.2)",c0="#FFFFFF",zC="#FF6B6B",YC=5,eS=30,Ys=50,Xl=8,d0=10,jC="rgba(0, 0, 0, 0.5)",VC="#FFFFFF",XC=33,KC=400,ZC=20,qC=10,QC="rgba(0, 0, 0, 0.7)",JC="#FFFFFF",Vd=20,f0=16,ew=.5,h0=5,tS="#FFD700",tw=40,dh=4,nS=3,nw=5,iS=20,rS=5,iw="#FFFFFF",rw="#FF6B6B",cn=80,wr=10,Kl=300,_r=15,ow=8,sw="rgba(0, 0, 0, 0.8)",aw="#FFFFFF",Xd=14,g0=10,Qn=20,lw="#FF6B6B",uw="#4CAF50",p0="#FFD700",cw="rgba(255, 255, 0, 0.3)",dw=2,fw=500,hw=120,gw=45,pw="#FFD700",mw=3,vw=4;let Kd=0;function kf(){const e=i0[Kd];return Kd=(Kd+1)%i0.length,e}const m0=20,Sw=.3,yw=24,v0=250,Xo=10,oS=250,ya=12,sS=10;var He=(e=>(e.Leader="leader",e.Gatherer="gatherer",e.Hunter="hunter",e.Mover="mover",e.Warrior="warrior",e))(He||{}),ue=(e=>(e.Gather="Gather",e.Eat="Eat",e.Procreate="Procreate",e.Attack="Attack",e.Plant="Plant",e.CallToAttack="CallToAttack",e.TribeSplit="TribeSplit",e.FollowMe="FollowMe",e.FeedChild="FeedChild",e.HuntPrey="HuntPrey",e.DefendAgainstPredator="DefendAgainstPredator",e.Build="Build",e.Removal="Removal",e.Deposit="Deposit",e.Retrieve="Retrieve",e.TakeOverBuilding="TakeOverBuilding",e.RemoveEnemyBuilding="RemoveEnemyBuilding",e.AutopilotMove="AutopilotMove",e.AutopilotGather="AutopilotGather",e.AutopilotAttack="AutopilotAttack",e.AutopilotProcreate="AutopilotProcreate",e.AutopilotPlant="AutopilotPlant",e.AutopilotFeedChild="AutopilotFeedChild",e.AutopilotFollowMe="AutopilotFollowMe",e.AutopilotDeposit="AutopilotDeposit",e.AutopilotRetrieve="AutopilotRetrieve",e))(ue||{});const bu={Gather:"",Eat:"",Procreate:"",Attack:"",Plant:"",CallToAttack:"",TribeSplit:"",FollowMe:"",FeedChild:"",HuntPrey:"",DefendAgainstPredator:"",Build:"",Removal:"",Deposit:"",Retrieve:"",TakeOverBuilding:"",RemoveEnemyBuilding:"",AutopilotMove:"",AutopilotGather:"",AutopilotAttack:"",AutopilotProcreate:"",AutopilotPlant:"",AutopilotFeedChild:"",AutopilotFollowMe:"",AutopilotDeposit:"",AutopilotRetrieve:""},aS={Gather:"Gather",Eat:"Eat",Procreate:"Procreate",Attack:"Attack",Plant:"Plant",CallToAttack:"Call to Attack",TribeSplit:"Split Tribe",FollowMe:"Follow Me",FeedChild:"Feed Child",HuntPrey:"Hunt Prey",DefendAgainstPredator:"Defend",Build:"Build",Removal:"Remove",Deposit:"Deposit",Retrieve:"Retrieve",TakeOverBuilding:"Take Over",RemoveEnemyBuilding:"Destroy Enemy Building",AutopilotMove:"Walk",AutopilotGather:"Gather",AutopilotAttack:"Attack",AutopilotProcreate:"Procreate",AutopilotPlant:"Plant",AutopilotFeedChild:"Feed",AutopilotFollowMe:"Follow",AutopilotDeposit:"Deposit",AutopilotRetrieve:"Retrieve"};He.Leader+"",He.Gatherer+"",He.Hunter+"",He.Mover+"",He.Warrior+"";He.Leader+"",He.Gatherer+"",He.Hunter+"",He.Mover+"",He.Warrior+"";var Po=(e=>(e.Time="Time",e.Hunger="Hunger",e.Hitpoints="Hitpoints",e.Food="Food",e.Autopilot="Autopilot",e.Muted="Muted",e.Family="Family",e.Tribes="Tribes",e))(Po||{});const js={Time:"",Hunger:"",Hitpoints:"",Food:"",Autopilot:"",Muted:"",Family:"",Tribes:""};var ie=(e=>(e.ToggleMute="ToggleMute",e.TogglePause="TogglePause",e.FastForward="FastForward",e.DismissTutorial="DismissTutorial",e.ReturnToIntro="ReturnToIntro",e.ConfirmExitYes="ConfirmExitYes",e.ConfirmExitNo="ConfirmExitNo",e.CommandEat="CommandEat",e.CommandPlant="CommandPlant",e.CommandCallToAttack="CommandCallToAttack",e.CommandFollowMe="CommandFollowMe",e.CommandGather="CommandGather",e.CommandTribeSplit="CommandTribeSplit",e.CommandBuild="CommandBuild",e.SelectStorageSpot="SelectStorageSpot",e.SelectPlantingZone="SelectPlantingZone",e.SelectRemovalTool="SelectRemovalTool",e.ToggleProcreationBehavior="ToggleProcreationBehavior",e.ToggleAttackBehavior="ToggleAttackBehavior",e.ToggleFeedChildBehavior="ToggleFeedChildBehavior",e.TogglePlantingBehavior="TogglePlantingBehavior",e.ToggleGatheringBehavior="ToggleGatheringBehavior",e.ToggleAutopilotFollowLeaderBehavior="ToggleAutopilotFollowLeaderBehavior",e.ToggleDiplomacy="ToggleDiplomacy",e.OpenRoleManager="OpenRoleManager",e.CloseRoleManager="CloseRoleManager",e.IncreaseRoleWeight="IncreaseRoleWeight",e.DecreaseRoleWeight="DecreaseRoleWeight",e))(ie||{});const Tw=12,Aw=24,Iw=150*.9,Ew=24;var Ta=(e=>(e.Hello="HELLO",e.NewTribeFormed="NEW_TRIBE_FORMED",e.NoHeir="NO_HEIR",e.ChildrenStarving="CHILDREN_STARVING",e))(Ta||{});let Cw=0;function ww(){return`notification-${Date.now()}-${Cw++}`}function Ff(e,t){if(t.identifier){const o=e.notifications.find(a=>a.identifier===t.identifier);if(o){if(o.dismissedUntil&&e.time<o.dismissedUntil)return;o.message=t.message,o.timestamp=e.time,o.creationTime=Date.now(),o.duration=t.duration,o.targetEntityIds=t.targetEntityIds,o.highlightedEntityIds=t.highlightedEntityIds,o.targetPosition=t.targetPosition,o.targetArea=t.targetArea,o.targetRadius=t.targetRadius,o.isDismissed=!1,o.dismissedUntil=void 0;return}}const i={...t,id:ww(),timestamp:e.time,creationTime:Date.now(),isDismissed:!1};e.notifications.push(i)}function _w(e,t){const i=e.notifications.find(o=>o.id===t);i&&(i.isDismissed=!0,i.identifier&&(i.dismissedUntil=e.time+Ew))}function Rw(e){const t=e.time;e.notifications=e.notifications.filter(i=>i.duration===0?!0:!(t-i.timestamp>i.duration))}function Pw(e){for(const i of Object.values(e.entities.entities))i.isHighlighted=!1;const t=e.notifications.filter(i=>!i.isDismissed);for(const i of t)if(i.highlightedEntityIds)for(const o of i.highlightedEntityIds){const a=e.entities.entities[o];a&&(a.isHighlighted=!0)}}const S0=600,Nw=1.5,lS=.1,Zl=""+new URL("attack-D4MA8VWK.mp3",import.meta.url).href,Zd=""+new URL("gather-CU75596W.mp3",import.meta.url).href,Dw=""+new URL("eat-DCjHq2QD.mp3",import.meta.url).href,qd=""+new URL("procreate-CfE4r5Cp.mp3",import.meta.url).href,Ow=""+new URL("birth-Cbd67GHT.mp3",import.meta.url).href,Mw=""+new URL("child-fed-DzEPuMid.mp3",import.meta.url).href,kw=""+new URL("human-death-B6HFLXES.mp3",import.meta.url).href,Fw=""+new URL("game-over-C5dqkyER.mp3",import.meta.url).href,Lw=""+new URL("button-click-DomLUeaU.mp3",import.meta.url).href,Uw=""+new URL("soundtrack-1-BdlYUGye.mp3",import.meta.url).href;var ge=(e=>(e[e.Attack=0]="Attack",e[e.Gather=1]="Gather",e[e.Eat=2]="Eat",e[e.Procreate=3]="Procreate",e[e.Birth=4]="Birth",e[e.ChildFed=5]="ChildFed",e[e.HumanDeath=6]="HumanDeath",e[e.Seize=7]="Seize",e[e.CallToAttack=8]="CallToAttack",e[e.TribeSplit=9]="TribeSplit",e[e.CallToFollow=10]="CallToFollow",e[e.StorageDeposit=11]="StorageDeposit",e[e.StorageRetrieve=12]="StorageRetrieve",e[e.StorageSteal=13]="StorageSteal",e[e.GameOver=14]="GameOver",e[e.ButtonClick=15]="ButtonClick",e[e.SoundTrack1=16]="SoundTrack1",e))(ge||{});const Bw=new Map([[0,Zl],[1,Zd],[2,Dw],[3,qd],[4,Ow],[5,Mw],[6,kw],[14,Fw],[15,Lw],[7,Zl],[8,Zl],[9,qd],[10,qd],[11,Zd],[12,Zd],[13,Zl],[16,Uw]]);let Vs,Aa;function Hw(){if(!(typeof window>"u"))return Aa}function fh(){if(!(typeof window>"u"))return!Vs&&typeof window.AudioContext=="function"&&(Vs=new window.AudioContext,Aa=Vs.createGain(),Aa.connect(Vs.destination),aa(.1,!1)),Vs}function aa(e,t){Aa&&(Aa.gain.value=t?0:e/10)}const uS=new Map;let ql=!1,y0=!1;async function bw(){if(y0||ql)return;const e=fh();if(!e){console.error("AudioContext not supported. Cannot load sounds.");return}e.state==="suspended"&&e.resume(),ql=!0,console.log("Starting sound loading...");const t=[];Bw.forEach((i,o)=>{const a=fetch(i).then(s=>{if(!s.ok)throw new Error(`Failed to fetch sound: ${i}`);return s.arrayBuffer()}).then(s=>e.decodeAudioData(s)).then(s=>{uS.set(o,s)}).catch(s=>{console.error(`Error loading sound ${ge[o]} from ${i}:`,s)});t.push(a)});try{await Promise.all(t),y0=!0,ql=!1,console.log("All sounds loaded successfully.")}catch(i){ql=!1,console.error("An error occurred while loading sounds:",i)}}const la=new Map;function hh(e,t){const i=fh(),o=Hw();if(!i||!o||o.gain.value===0&&(t==null?void 0:t.trackId)===void 0)return;i.state==="suspended"&&i.resume();const a=uS.get(e);if(!a){console.warn(`Sound buffer not found for type: ${ge[e]}`);return}if(t!=null&&t.trackId&&la.has(t.trackId))return;const s=i.createBufferSource();s.buffer=a,s.loop=(t==null?void 0:t.loop)??!1;const u=i.createGain(),c=i.createStereoPanner();let f=u;if(t!=null&&t.position&&(t!=null&&t.listenerPosition)&&(t!=null&&t.worldDimensions)){const g=Ye(t.listenerPosition,t.position,t.worldDimensions.width,t.worldDimensions.height),m=j(t.listenerPosition,t.position,t.worldDimensions.width,t.worldDimensions.height);if(m>S0)return;const v=1-Math.pow(m/S0,Nw);u.gain.value=Math.max(0,v);const y=Math.sin(g.x/m*(Math.PI/2));c.pan.value=isNaN(y)?0:y,u.connect(c),f=c}else{const g=e===ge.GameOver?.4:e===ge.SoundTrack1?1:.2;u.gain.value=g}s.connect(f),f.connect(o),s.start(0),t!=null&&t.trackId&&(la.set(t.trackId,{sourceNode:s,gainNode:u}),s.onended=()=>{la.delete(t.trackId)})}function Qd(e,t=1){const i=la.get(e),o=fh();if(i&&o){const{sourceNode:a,gainNode:s}=i,u=o.currentTime;s.gain.setValueAtTime(s.gain.value,u),s.gain.linearRampToValueAtTime(0,u+t),a.stop(u+t),a.onended=null,la.delete(e)}}function we(e,t,i){const o=pt(e.gameState);o&&hh(t,{position:i,listenerPosition:o.position,worldDimensions:e.gameState.mapDimensions,masterVolume:e.gameState.masterVolume,isMuted:e.gameState.isMuted})}function Gw(e,t,i){const o=i.mapDimensions.width,a=i.mapDimensions.height,s=t.radius*2;for(let u=v0;u<o/2;u+=50)for(let c=0;c<10;c++){const f=xv(e,u,o,a);if(!(j(e,f,o,a)<v0)&&!xn(f,i,s,t.id))return f}return null}function Gu(e,t){if(!e.isAdult||e.gender!=="male"||e.leaderId===e.id||!e.leaderId)return{canSplit:!1};if(!e.leaderId)return{canSplit:!1};const i=t.entities.entities[e.leaderId];if(!i||i.type!=="human")return{canSplit:!1};const o=zr(hn(t,i));if(o&&o.id===e.id)return{canSplit:!1};const a=jo(e.leaderId,t).filter(f=>f.isAdult);if(a.length<m0)return{canSplit:!1};const u=bv(e,t).filter(f=>f.isAdult).length+1,c=Math.min(a.length*Sw,m0);return{canSplit:u>=c,progress:u/c}}function gh(e,t){var u;if(!Gu(e,t).canSplit)return;const i=e.leaderId?t.entities.entities[e.leaderId]:void 0,o=kf(),a=bv(e,t);e.leaderId=e.id,e.tribeBadge=o,e.tribeRole=He.Leader,e.tribeControl={roleWeights:{gatherer:1,hunter:1,mover:1,warrior:1,leader:0},diplomacy:{}},i&&((u=i.tribeControl)!=null&&u.diplomacy)&&(i.tribeControl.diplomacy[e.id]=St.Hostile);for(const c of a)c.leaderId=e.id,c.tribeBadge=o;Ff(t,{type:Ta.NewTribeFormed,message:`A new tribe has formed! ${o}`,duration:Aw,targetEntityIds:[e.id],highlightedEntityIds:[e.id,...a.map(c=>c.id)]}),we({gameState:t},ge.TribeSplit,e.position)}const ts=(e,t,i)=>{var o,a;return e.id===t.id?!1:e.leaderId&&!t.leaderId?!0:e.leaderId===t.leaderId?!1:e.leaderId&&t.leaderId?((a=(o=i.entities.entities[e.leaderId])==null?void 0:o.tribeControl)==null?void 0:a.diplomacy[t.leaderId])===St.Hostile:!1},Bn=(e,t,i)=>{var a,s;return!e.leaderId||!t.ownerId||t.ownerId===e.leaderId?!1:((s=(a=i.entities.entities[e.leaderId])==null?void 0:a.tribeControl)==null?void 0:s.diplomacy[t.ownerId])===St.Hostile},jr=(e,t,i)=>{if(e.id===t.id||e.gender===t.gender||!e.isAdult||!t.isAdult||e.hunger>=Wr||t.hunger>=Wr||(e.procreationCooldown||0)>0||(t.procreationCooldown||0)>0||ts(e,t,i))return!1;const o=e.gender==="female"?e:t;return!(o.isPregnant||o.age>Lv)},xw=20,_n=30,$w=.5,Ww=.3,zw=2,Lf=50;function ph(e,t){const i=[];if(t.food.length>0&&t.hunger>sr&&i.push({type:ue.Eat,action:"eating",key:"f"}),t.food.length<t.maxFood){const s=Oe(t,e,"berryBush",yt,f=>f.food.length>0),u=Oe(t,e,"corpse",yt,f=>f.food.length>0);let c=null;s&&u?c=j(t.position,s.position,e.mapDimensions.width,e.mapDimensions.height)<=j(t.position,u.position,e.mapDimensions.width,e.mapDimensions.height)?s:u:c=s||u,c&&i.push({type:ue.Gather,action:"gathering",key:"e",targetEntity:c})}const o=Oe(t,e,"human",yt,s=>jr(t,s,e));if(o&&i.push({type:ue.Procreate,action:"procreating",key:"r",targetEntity:o}),t.food.length>0&&t.isAdult){const s=Oe(t,e,"human",yt,u=>{const c=u;return!c.isAdult&&(c.motherId===t.id||c.fatherId===t.id)&&c.hunger>=sr});s&&i.push({type:ue.FeedChild,action:"feeding",key:"h",targetEntity:s})}const a=Oe(t,e,"human",ri,s=>ts(t,s,e))??Oe(t,e,"predator",ri)??Oe(t,e,"prey",ri);if(a&&i.push({type:ue.Attack,action:"attacking",key:"q",targetEntity:a}),t.food.filter(s=>s.type===Gn.Berry).length>=Gr&&i.push({type:ue.Plant,action:"planting",key:"b"}),t.food.length>0&&t.isAdult){const s=Oe(t,e,"building",_n,u=>{const c=u;return c.buildingType==="storageSpot"&&c.ownerId===t.leaderId&&c.isConstructed&&c.storedFood!==void 0&&c.storageCapacity!==void 0&&c.storedFood.length<c.storageCapacity});s&&i.push({type:ue.Deposit,action:"idle",key:"x",targetEntity:s})}if(t.food.length<t.maxFood&&t.isAdult){const s=Oe(t,e,"building",_n,u=>{const c=u;return c.buildingType==="storageSpot"&&c.ownerId===t.leaderId&&c.isConstructed&&c.storedFood!==void 0&&c.storedFood.length>0});s&&i.push({type:ue.Retrieve,action:"idle",key:"z",targetEntity:s})}return t.leaderId===t.id&&!t.isCallingToAttack&&ah(t,e,oS).length>0&&i.push({type:ue.CallToAttack,action:"idle",key:"v"}),Gu(t,e).canSplit&&i.push({type:ue.TribeSplit,action:"idle",key:"k"}),t.leaderId===t.id&&!t.isCallingToFollow&&i.push({type:ue.FollowMe,action:"idle",key:"c"}),i}const En={StorageSpot:"storageSpot",PlantingZone:"plantingZone"},Pa={[En.StorageSpot]:{name:"Storage Spot",description:"A designated area for storing excess food.",icon:"",dimensions:{width:40,height:40},constructionTimeHours:.1,destructionTimeHours:.1,cost:{}},[En.PlantingZone]:{name:"Planting Zone",description:"An area marked for agricultural use.",icon:"",dimensions:{width:60,height:60},constructionTimeHours:.1,destructionTimeHours:.1,cost:{}}},Yw=.5,jw="#FFA500",Vw="#FF4500",T0=4,Xw=10;function cS(e){return Pa[e].dimensions}function Kw(e){return Pa[e].constructionTimeHours}function Zw(e){return Pa[e].destructionTimeHours}function mh(e,t,i,o){if(i===void 0)return!1;const a=cS(t),s=Math.sqrt(a.width*a.width+a.height*a.height)/2;if(xn(e,o,s*.8))return!1;const c=o.search.building.byRadius(e,s*2);for(const f of c){const g=j(e,f.position,o.mapDimensions.width,o.mapDimensions.height),m=(Math.max(a.width,a.height)+Math.max(f.width,f.height))/2;if(g<m*.9)return!1}return!0}function dS(e,t,i,o){return LR(o.entities,e,t,i)}function qw(e,t){const i=t.entities.entities[e];i&&i.type==="building"&&!i.isBeingDestroyed&&(i.isBeingDestroyed=!0,i.destructionProgress=0)}function Qw(e,t){const a=t.search.building.byRadius(e,100);for(const s of a){let u=e.x-s.position.x,c=e.y-s.position.y;const f=t.mapDimensions.width,g=t.mapDimensions.height;if(Math.abs(u)>f/2&&(u-=Math.sign(u)*f),Math.abs(c)>g/2&&(c-=Math.sign(c)*g),Math.abs(u)<=s.width/2&&Math.abs(c)<=s.height/2)return s}}const Jw=500,e_=500;function t_(e,t){if(!e.leaderId)return 0;const i=n_(e.leaderId,t),o=i_(e.leaderId,t);return o===0?0:Math.min(1,i/o)}function n_(e,t){const i=wn({leaderId:e},t),o=Na(e,t),a=i.reduce((u,c)=>u+c.food.length,0),s=o.reduce((u,c)=>{var f;return u+(((f=c.storedFood)==null?void 0:f.length)||0)},0);return a+s}function i_(e,t){const i=wn({leaderId:e},t),o=Na(e,t),a=i.reduce((u,c)=>u+c.maxFood,0),s=o.reduce((u,c)=>u+(c.storageCapacity||0),0);return a+s}function fS(e,t){const i=Na(e,t);if(i.length===0)return 0;const o=i.reduce((s,u)=>{var c;return s+(((c=u.storedFood)==null?void 0:c.length)||0)},0),a=i.reduce((s,u)=>s+(u.storageCapacity||0),0);return a===0?0:Math.min(1,o/a)}function hS(e,t){const i=wn({leaderId:e},t);return i.length===0?0:r_(e,t)/i.length}function r_(e,t){const i=t,o=Yr(e,t);return i.search.berryBush.byRadius(o,Jw).filter(u=>{const c=u.stateMachine&&u.stateMachine[0]==="bushDying",f=u.food.length>0;return!c&&f}).length}function vh(e,t){return e.leaderId?t.search.building.all().filter(a=>{if(a.buildingType!==En.PlantingZone||!a.isConstructed)return!1;if(a.ownerId){const s=t.entities.entities[a.ownerId];return s&&s.leaderId===e.leaderId}return!1}):[]}function o_(e){const t=xr*2,i=Math.floor(e.width/t),o=Math.floor(e.height/t);return i*o}function s_(e,t){const i=t,o=Math.max(e.width,e.height);return i.search.berryBush.byRadius(e.position,o).filter(u=>{const c=Math.abs(u.position.x-e.position.x),f=Math.abs(u.position.y-e.position.y);return c<=e.width/2&&f<=e.height/2}).length}function a_(e,t){if(!e.leaderId)return[];const i=Na(e.leaderId,t),o=wn(e,t);return i.map(a=>{var g;const s=a.storageCapacity||0,u=((g=a.storedFood)==null?void 0:g.length)||0,c=o.filter(m=>{if(m.activeAction!=="depositing")return!1;if(typeof m.target=="object"&&"x"in m.target){const v=m.target;return j(v,a.position,t.mapDimensions.width,t.mapDimensions.height)<=50}return!1}).length,f=j(e.position,a.position,t.mapDimensions.width,t.mapDimensions.height);return{storage:a,capacity:s,currentFood:u,assignedDepositors:c,distance:f}})}function l_(e,t){const i=a_(e,t);if(i.length===0)return null;const o=i.filter(a=>{const s=a.currentFood<a.capacity,u=a.distance<=e_;return s&&u});return o.length===0?null:(o.sort((a,s)=>{const u=a.currentFood/a.capacity,c=s.currentFood/s.capacity;return Math.abs(u-c)>.1?u-c:a.assignedDepositors!==s.assignedDepositors?a.assignedDepositors-s.assignedDepositors:a.distance-s.distance}),o[0].storage)}function gS(e,t,i){return wn({leaderId:e},t).filter(a=>a.activeAction===i).length}function Na(e,t){return t.search.building.all().filter(a=>{if(a.buildingType!==En.StorageSpot||!a.isConstructed)return!1;if(a.ownerId){const s=t.entities.entities[a.ownerId];return s&&s.leaderId===e}return!1})}function u_(e,t){const i=vh(e,t);if(i.length===0)return null;const o=t.mapDimensions.width,a=t.mapDimensions.height;for(const s of i){const u=o_(s);if(s_(s,t)>=u)continue;const f=20;for(let g=0;g<f;g++){const m=s.position.x+(Math.random()-.5)*s.width,v=s.position.y+(Math.random()-.5)*s.height,y={x:(m%o+o)%o,y:(v%a+a)%a};if(!xn(y,t,xr))return{position:y,zoneId:s.id}}}return null}function c_(e,t,i){return vh(t,i).some(s=>eC(e,s,i))?!xn(e,i,xr):!1}const d_={id:pu,update:(e,t)=>{const{entity:i,updateContext:o}=t,{gameState:a}=o,s=o.deltaTime*(wt/_t);if(i.age+=s,i.age>=i.lifespan)return{nextState:ma,data:{...e,enteredAt:a.time,previousState:pu}};const u=xv(i.position,i.spreadRadius,a.mapDimensions.width,a.mapDimensions.height);return xn(u,a,15)||Ma(a.entities,u,a.time),{nextState:Dr,data:{...e,enteredAt:a.time,previousState:pu}}},onEnter:(e,t)=>({...t,enteredAt:e.updateContext.gameState.time})},f_={id:ma,update:e=>({nextState:ma,data:e}),onEnter:(e,t)=>(rs(e.updateContext.gameState.entities,e.entity.id),{...t,enteredAt:e.updateContext.gameState.time})},h_=[II,EI,d_,f_],ft="humanIdle",Nr="humanMoving",ta="humanEating",Da="humanGathering",ua="humanDepositing",ca="humanRetrieving",Ia="humanProcreating",ar="humanAttacking",vu="humanPlanting",g_={id:ft,update:(e,t)=>{const{entity:i,updateContext:o}=t;return i.activeAction==="attacking"&&i.attackTargetId?{nextState:ar,data:{...e,enteredAt:o.gameState.time,previousState:ft,attackTargetId:i.attackTargetId,attackStartTime:o.gameState.time}}:(i.hunger>=Mv?(i.debuffs=i.debuffs.filter(a=>a.type!=="slow"),i.debuffs.push({type:"slow",startTime:o.gameState.time,duration:.1})):i.debuffs=i.debuffs.filter(a=>a.type!=="slow"),i.activeAction==="moving"?{nextState:Nr,data:{...e,enteredAt:o.gameState.time,previousState:ft,target:i.target}}:i.activeAction==="gathering"?{nextState:Da,data:{...e,enteredAt:o.gameState.time,previousState:ft,target:i.target}}:i.activeAction==="eating"?{nextState:ta,data:{...e,enteredAt:o.gameState.time,previousState:ft}}:i.activeAction==="planting"&&i.target?{nextState:vu,data:{...e,enteredAt:o.gameState.time,previousState:ft,plantingSpot:i.target}}:i.activeAction==="depositing"?{nextState:ua,data:{...e,enteredAt:o.gameState.time,previousState:ft}}:i.activeAction==="retrieving"?{nextState:ca,data:{...e,enteredAt:o.gameState.time,previousState:ft}}:{nextState:ft,data:e})},onEnter:(e,t)=>(e.entity.acceleration=0,e.entity.velocity={x:0,y:0},{...t,enteredAt:e.updateContext.gameState.time})};function pS(e){let t=AE;return e.hunger>=Mv&&(t*=IE),e.age>=CE&&(t*=wE),e.movementSlowdown&&(t*=e.movementSlowdown.modifier),t}const Jd=7.5;class p_{constructor(){Pe(this,"id",Nr)}update(t,i){var f;const{entity:o,updateContext:a}=i;if(o.activeAction==="attacking"&&o.attackTargetId)return{nextState:ar,data:{...t,enteredAt:a.gameState.time,previousState:Nr,attackTargetId:o.attackTargetId,attackStartTime:a.gameState.time}};if(o.activeAction!=="moving")return{nextState:ft,data:{...t,enteredAt:a.gameState.time,previousState:Nr}};let s;if(typeof o.target=="object"?s=o.target:typeof o.target=="number"&&(s=(f=i.updateContext.gameState.entities.entities[o.target])==null?void 0:f.position),!s&&(o.direction.x!==0||o.direction.y!==0)&&(s={x:o.position.x+o.direction.x*Jd*2,y:o.position.y+o.direction.y*Jd*2}),!s)return{nextState:ft,data:{...t,enteredAt:a.gameState.time,previousState:Nr}};const u=Ye(o.position,s,i.updateContext.gameState.mapDimensions.width,i.updateContext.gameState.mapDimensions.height);return o.direction=at(u),o.acceleration=pS(o),j(o.position,s,a.gameState.mapDimensions.width,a.gameState.mapDimensions.height)<Jd?{nextState:ft,data:{...t,enteredAt:a.gameState.time,previousState:Nr}}:{nextState:Nr,data:t}}onExit(t){const{entity:i}=t;i.acceleration=0}}const m_=new p_,$e=1,Mr=3,v_=70;function Me(e,t,i,o,a){const s={id:e.nextVisualEffectId,type:t,position:i,startTime:e.time,duration:o,entityId:a};return e.visualEffects.push(s),e.nextVisualEffectId++,s.id}var fe=(e=>(e[e.Hunger=0]="Hunger",e[e.Procreation=1]="Procreation",e[e.Pregnant=2]="Pregnant",e[e.TargetAcquired=3]="TargetAcquired",e[e.Attack=4]="Attack",e[e.Partnered=5]="Partnered",e[e.BushClaimed=6]="BushClaimed",e[e.BushClaimLost=7]="BushClaimLost",e[e.Eating=8]="Eating",e[e.ChildFed=9]="ChildFed",e[e.AttackDeflected=10]="AttackDeflected",e[e.AttackResisted=11]="AttackResisted",e[e.Hit=12]="Hit",e[e.SeizeBuildup=13]="SeizeBuildup",e[e.Seize=14]="Seize",e[e.CallToAttack=15]="CallToAttack",e[e.CallToFollow=16]="CallToFollow",e[e.AutopilotMoveTarget=17]="AutopilotMoveTarget",e))(fe||{});const S_={id:ta,update:(e,t)=>{const{entity:i,updateContext:o}=t;return i.activeAction!=="eating"?{nextState:ft,data:{...e,enteredAt:o.gameState.time,previousState:ta}}:(i.food.length>0&&(!i.eatingCooldownTime||o.gameState.time>=i.eatingCooldownTime)&&i.hunger>sr&&(i.hunger=Math.max(0,i.hunger-sr),i.food.pop(),i.eatingCooldownTime=o.gameState.time+1,we(o,ge.Eat,i.position),(!i.lastEatingEffectTime||o.gameState.time-i.lastEatingEffectTime>2)&&(Me(o.gameState,fe.Eating,i.position,$e,i.id),i.lastEatingEffectTime=o.gameState.time)),i.hunger<=0||i.food.length<=0?{nextState:ft,data:{...e,enteredAt:o.gameState.time,previousState:ta}}:{nextState:ta,data:e})},onEnter:(e,t)=>(e.entity.acceleration=0,e.entity.velocity={x:0,y:0},{...t,enteredAt:e.updateContext.gameState.time})};class y_{constructor(){Pe(this,"id",Da)}update(t,i){return i.entity.activeAction!=="gathering"?{nextState:"humanIdle",data:{...t,enteredAt:i.updateContext.gameState.time,previousState:this.id}}:{nextState:this.id,data:t}}}const T_=new y_,A_={id:ua,update:(e,t)=>{const{entity:i}=t;return i.activeAction!=="depositing"?{nextState:ft,data:{...e,enteredAt:t.updateContext.gameState.time,previousState:ua}}:{nextState:ua,data:e}},onEnter:(e,t)=>{const{entity:i}=e;return i.activeAction="depositing",t},onExit:e=>{const{entity:t}=e;t.activeAction==="depositing"&&(t.activeAction="idle")}},I_={id:ca,update:(e,t)=>{const{entity:i}=t;return i.activeAction!=="retrieving"?{nextState:ft,data:{...e,enteredAt:t.updateContext.gameState.time,previousState:ca}}:{nextState:ca,data:e}},onEnter:(e,t)=>{const{entity:i}=e;return i.activeAction="retrieving",t},onExit:e=>{const{entity:t}=e;t.activeAction==="retrieving"&&(t.activeAction="idle")}},E_=(e,t)=>(t.procreationEndTime=e.updateContext.gameState.time+(t.duration||2),t),C_=(e,t)=>{const{entity:i,updateContext:o}=t,{gameState:a}=o;if(a.time<(e.procreationEndTime||0))return{nextState:Ia,data:e};const s=a.entities.entities[e.partnerId];if(s&&s.type==="human"&&!s.isPregnant&&i.hunger<Wr&&s.hunger<Wr&&!i.procreationCooldown&&!s.procreationCooldown){const u=i.gender==="female"?i:s.gender==="female"?s:void 0,c=i.gender==="male"?i:s.gender==="male"?s:void 0;u&&c&&(u.isPregnant=!0,u.gestationTime=PE,u.pregnancyFatherId=c.id,i.procreationCooldown=Zm,s.procreationCooldown=Zm,we(o,ge.Procreate,u.position))}return i.activeAction="idle",s&&(s.activeAction="idle"),{nextState:ft,data:{...e,enteredAt:a.time,previousState:Ia}}},w_={id:Ia,onEnter:E_,update:C_},__={id:ar,onEnter:(e,t)=>({...t,enteredAt:e.updateContext.gameState.time,attackStartTime:e.updateContext.gameState.time}),update:(e,t)=>{if(t.entity.activeAction!=="attacking"||!t.entity.attackTargetId)return t.entity.activeAction="idle",{nextState:ft,data:{...e}};const i=t.updateContext.gameState.entities.entities[t.entity.attackTargetId];if(!i)return t.entity.activeAction="idle",{nextState:ft,data:{...e}};const o=j(t.entity.position,i.position,t.updateContext.gameState.mapDimensions.width,t.updateContext.gameState.mapDimensions.height),a=Ye(t.entity.position,i.position,t.updateContext.gameState.mapDimensions.width,t.updateContext.gameState.mapDimensions.height);return t.entity.direction=at(a),o>ri?t.entity.acceleration=pS(t.entity):t.entity.acceleration=0,{nextState:ar,data:e}}},R_={id:vu,update:(e,t)=>{const{entity:i,updateContext:o}=t,{gameState:a}=o;if(a.time-e.enteredAt>=AI){if(i.food.filter(c=>c.type===Gn.Berry).length>=Gr){for(let c=0;c<Gr;c++){const f=i.food.findIndex(g=>g.type===Gn.Berry);f>-1&&i.food.splice(f,1)}Ma(a.entities,e.plantingSpot,a.time)}return{nextState:ft,data:{...e,enteredAt:a.time,previousState:vu}}}return{nextState:vu,data:e}},onEnter:(e,t)=>(e.entity.acceleration=0,e.entity.velocity={x:0,y:0},{...t,enteredAt:e.updateContext.gameState.time})},P_=[g_,m_,S_,T_,A_,I_,w_,__,R_],Ln="preyIdle",qi="preyMoving",na="preyGrazing",ia="preyProcreating",N_={id:Ln,update:(e,t)=>{const{entity:i,updateContext:o}=t;return i.activeAction==="moving"?{nextState:qi,data:{...e,enteredAt:o.gameState.time,previousState:Ln,target:i.target}}:i.activeAction==="grazing"?{nextState:na,data:{...e,enteredAt:o.gameState.time,previousState:Ln}}:i.activeAction==="procreating"?{nextState:ia,data:{...e,enteredAt:o.gameState.time,previousState:Ln}}:{nextState:Ln,data:e}},onEnter:(e,t)=>(e.entity.acceleration=0,e.entity.velocity={x:0,y:0},{...t,enteredAt:e.updateContext.gameState.time})},mS=12,D_=120,A0=50,O_=12,vS=30,M_=2,Vt=50,k_=100,da=2,ef=3,F_=.9,L_=1,U_=50,B_=.5,SS=20,H_=140,I0=40,b_=12,yS=40,G_=3,rr=60,Un=40,No=50,E0=320,TS=25,x_=60,AS=2,$_=90,W_=.7,z_=1,fa=3,tf=15,Sh=80,IS=10,xu=80,ns=40,ES=2,_u=30,Mo=20,Fr=40,ko=24,Lr=48,Fo=12,Ur=40,Lo=20,Br=60,Uo=.75,Ji=2.5,Bo=.25,er=2;function Y_(e){let t=O_;return e.isAdult||(t*=.7),e.hunger>=U_&&(t*=B_),e.movementSlowdown&&(t*=e.movementSlowdown.modifier),t}function j_(e,t){const i=e>>16&255,o=e>>8&255,a=e&255,s=t>>16&255,u=t>>8&255,c=t&255;let f=Math.floor((i+s)/2),g=Math.floor((o+u)/2),m=Math.floor((a+c)/2);return Math.random()<.05&&(f=Math.max(0,Math.min(255,f+(Math.random()-.5)*60))),Math.random()<.05&&(g=Math.max(0,Math.min(255,g+(Math.random()-.5)*60))),Math.random()<.05&&(m=Math.max(0,Math.min(255,m+(Math.random()-.5)*60))),f<<16|g<<8|m}function Ea(){const e=Math.floor(Math.random()*100)+100,t=Math.floor(Math.random()*80)+60,i=Math.floor(Math.random()*60)+20;return e<<16|t<<8|i}const nf=10;class V_{constructor(){Pe(this,"id",qi)}update(t,i){var f;const{entity:o,updateContext:a}=i;if(o.activeAction!=="moving")return{nextState:Ln,data:{...t,enteredAt:a.gameState.time,previousState:qi}};let s;if(typeof o.target=="object"?s=o.target:typeof o.target=="number"&&(s=(f=i.updateContext.gameState.entities.entities[o.target])==null?void 0:f.position),!s&&(o.direction.x!==0||o.direction.y!==0)&&(s={x:o.position.x+o.direction.x*nf*2,y:o.position.y+o.direction.y*nf*2}),!s)return{nextState:Ln,data:{...t,enteredAt:a.gameState.time,previousState:qi}};const u=Ye(o.position,s,i.updateContext.gameState.mapDimensions.width,i.updateContext.gameState.mapDimensions.height);return o.direction=at(u),o.acceleration=Y_(o),j(o.position,s,a.gameState.mapDimensions.width,a.gameState.mapDimensions.height)<nf?{nextState:Ln,data:{...t,enteredAt:a.gameState.time,previousState:qi}}:{nextState:qi,data:t}}onExit(t){const{entity:i}=t;i.acceleration=0}onEnter(t,i){return{...i,enteredAt:t.updateContext.gameState.time}}}const X_=new V_,K_={id:na,update:(e,t)=>{const{entity:i,updateContext:o}=t;return i.activeAction==="moving"?{nextState:qi,data:{...e,enteredAt:o.gameState.time,previousState:na,target:i.target}}:i.activeAction!=="grazing"?{nextState:Ln,data:{...e,enteredAt:o.gameState.time,previousState:na}}:{nextState:na,data:e}},onEnter:(e,t)=>(e.entity.acceleration=0,e.entity.velocity={x:0,y:0},{...t,enteredAt:e.updateContext.gameState.time})},Z_={id:ia,update:(e,t)=>{const{entity:i,updateContext:o}=t;return i.activeAction==="moving"?{nextState:qi,data:{...e,enteredAt:o.gameState.time,previousState:ia,target:i.target}}:i.activeAction!=="procreating"?{nextState:Ln,data:{...e,enteredAt:o.gameState.time,previousState:ia}}:{nextState:ia,data:e}},onEnter:(e,t)=>(e.entity.acceleration=0,e.entity.velocity={x:0,y:0},{...t,enteredAt:e.updateContext.gameState.time})},q_=[N_,X_,K_,Z_],jt="predatorIdle",Xi="predatorMoving",mi="predatorAttacking",Do="predatorProcreating",Hr="predatorEating",Q_={id:jt,update:(e,t)=>{const{entity:i,updateContext:o}=t;return i.activeAction==="eating"?{nextState:Hr,data:{...e,enteredAt:o.gameState.time,previousState:jt,preyId:i.attackTargetId,eatingStartTime:o.gameState.time}}:i.activeAction==="attacking"&&i.attackTargetId?{nextState:mi,data:{...e,enteredAt:o.gameState.time,previousState:jt,attackTargetId:i.attackTargetId,attackStartTime:o.gameState.time}}:i.activeAction==="moving"?{nextState:Xi,data:{...e,enteredAt:o.gameState.time,previousState:jt,target:i.target}}:i.activeAction==="procreating"?{nextState:Do,data:{...e,enteredAt:o.gameState.time,previousState:jt}}:{nextState:jt,data:e}},onEnter:(e,t)=>(e.entity.acceleration=0,e.entity.velocity={x:0,y:0},{...t,enteredAt:e.updateContext.gameState.time})};function CS(e){let t=b_;return e.hunger>=$_&&(t*=W_),e.isAdult||(t*=.7),e.movementSlowdown&&(t*=e.movementSlowdown.modifier),t}function J_(e,t){const i=e>>16&255,o=e>>8&255,a=e&255,s=t>>16&255,u=t>>8&255,c=t&255;let f=Math.floor((i+s)/2),g=Math.floor((o+u)/2),m=Math.floor((a+c)/2);return Math.random()<.05&&(f=Math.max(0,Math.min(255,f+(Math.random()-.5)*60))),Math.random()<.05&&(g=Math.max(0,Math.min(255,g+(Math.random()-.5)*60))),Math.random()<.05&&(m=Math.max(0,Math.min(255,m+(Math.random()-.5)*60))),f<<16|g<<8|m}function Ca(){const e=Math.floor(Math.random()*60)+60,t=Math.floor(Math.random()*50)+40,i=Math.floor(Math.random()*40)+20;return e<<16|t<<8|i}const rf=12;class e1{constructor(){Pe(this,"id",Xi)}update(t,i){var f;const{entity:o,updateContext:a}=i;if(o.activeAction==="eating")return{nextState:Hr,data:{...t,enteredAt:a.gameState.time,previousState:Xi,preyId:o.attackTargetId,eatingStartTime:a.gameState.time}};if(o.activeAction==="attacking"&&o.attackTargetId)return{nextState:mi,data:{...t,enteredAt:a.gameState.time,previousState:Xi,attackTargetId:o.attackTargetId,attackStartTime:a.gameState.time}};if(o.activeAction!=="moving")return{nextState:jt,data:{...t,enteredAt:a.gameState.time,previousState:Xi}};let s;if(typeof o.target=="object"?s=o.target:typeof o.target=="number"&&(s=(f=i.updateContext.gameState.entities.entities[o.target])==null?void 0:f.position),!s&&(o.direction.x!==0||o.direction.y!==0)&&(s={x:o.position.x+o.direction.x*rf*2,y:o.position.y+o.direction.y*rf*2}),!s)return{nextState:jt,data:{...t,enteredAt:a.gameState.time,previousState:Xi}};const u=Ye(o.position,s,i.updateContext.gameState.mapDimensions.width,i.updateContext.gameState.mapDimensions.height);return o.direction=at(u),o.acceleration=CS(o),j(o.position,s,a.gameState.mapDimensions.width,a.gameState.mapDimensions.height)<rf?{nextState:jt,data:{...t,enteredAt:a.gameState.time,previousState:Xi}}:{nextState:Xi,data:t}}onExit(t){const{entity:i}=t;i.acceleration=0}onEnter(t,i){return{...i,enteredAt:t.updateContext.gameState.time}}}const t1=new e1,n1={id:mi,update:(e,t)=>{const{entity:i,updateContext:o}=t;if(i.activeAction==="eating")return{nextState:Hr,data:{...e,enteredAt:o.gameState.time,previousState:mi,preyId:i.attackTargetId,eatingStartTime:o.gameState.time}};if(i.activeAction!=="attacking"||!i.attackTargetId)return i.activeAction="idle",{nextState:jt,data:{...e,enteredAt:o.gameState.time,previousState:mi}};const a=o.gameState.entities.entities[i.attackTargetId];if(!a)return i.activeAction="idle",{nextState:jt,data:{...e,enteredAt:o.gameState.time,previousState:mi}};if(a.type==="prey"&&a.hitpoints<=0||a.type==="predator"&&a.hitpoints<=0||a.type==="human"&&a.hitpoints<=0)return i.activeAction="idle",{nextState:jt,data:{...e,enteredAt:o.gameState.time,previousState:mi}};const u=j(i.position,a.position,o.gameState.mapDimensions.width,o.gameState.mapDimensions.height),c=Ye(i.position,a.position,o.gameState.mapDimensions.width,o.gameState.mapDimensions.height);return i.direction=at(c),u>Un?i.acceleration=CS(i):i.acceleration=0,{nextState:mi,data:e}},onEnter:(e,t)=>({...t,enteredAt:e.updateContext.gameState.time})},i1={id:Do,update:(e,t)=>{const{entity:i,updateContext:o}=t;return i.activeAction==="eating"?{nextState:Hr,data:{...e,enteredAt:o.gameState.time,previousState:Do,preyId:i.attackTargetId,eatingStartTime:o.gameState.time}}:i.activeAction==="attacking"&&i.attackTargetId?{nextState:mi,data:{...e,enteredAt:o.gameState.time,previousState:Do,attackTargetId:i.attackTargetId,attackStartTime:o.gameState.time}}:i.activeAction!=="procreating"?{nextState:jt,data:{...e,enteredAt:o.gameState.time,previousState:Do}}:{nextState:Do,data:e}},onEnter:(e,t)=>(e.entity.acceleration=0,e.entity.velocity={x:0,y:0},{...t,enteredAt:e.updateContext.gameState.time})},r1={id:Hr,update:(e,t)=>{const{entity:i,updateContext:o}=t;return i.activeAction!=="eating"?{nextState:jt,data:{...e,enteredAt:o.gameState.time,previousState:Hr}}:{nextState:Hr,data:e}},onEnter:(e,t)=>(e.entity.acceleration=0,e.entity.velocity={x:0,y:0},{...t,enteredAt:e.updateContext.gameState.time})},o1=[Q_,t1,n1,i1,r1],C0=[...h_,...P_,...q_,...o1];function s1(e,t,i){const o=dI(e,C0);if(!o)return hI(e),[e,t];const{nextState:a,data:s}=o.update(t,i);return fI(e,a)?[a,cI(o,a,s,i,C0)]:[a,s]}function a1(e,t,i){const{gameState:o}=t,a=i*(wt/_t);if(e.isAdult=e.age>=Jf,e.isCallingToAttack&&e.callToAttackEndTime&&o.time>e.callToAttackEndTime&&(e.isCallingToAttack=!1,e.callToAttackEndTime=void 0),e.isCallingToFollow&&e.callToFollowEndTime&&o.time>e.callToFollowEndTime&&(e.isCallingToFollow=!1,e.callToFollowEndTime=void 0),e.movementSlowdown&&o.time>e.movementSlowdown.endTime&&(e.movementSlowdown=void 0),e.hitpoints<e.maxHitpoints){const u=1-e.hunger/100*bE,c=HE*u*a;e.hitpoints=Math.min(e.maxHitpoints,e.hitpoints+c)}if(e.hunger+=i*(zs/(wt/_t)),e.hunger>v_&&(!e.lastHungerEffectTime||o.time-e.lastHungerEffectTime>Mr*2)&&(Me(o,fe.Hunger,e.position,Mr,e.id),e.lastHungerEffectTime=o.time),e.age+=i/Uu,e.isPlayer){const u=hn(o,e).filter(c=>c.hunger>=Iw);if(u.length>0){const c=u.map(f=>f.id);Ff(o,{identifier:"children_starving",type:Ta.ChildrenStarving,message:"Your children are starving!",duration:Tw,targetEntityIds:c,highlightedEntityIds:c})}}if(e.gender==="female"&&e.isPregnant&&e.gestationTime&&(e.gestationTime-=a,e.hunger+=i*((zs*NE-zs)/(wt/_t)),(!e.lastPregnantEffectTime||o.time-e.lastPregnantEffectTime>Mr*3)&&(Me(o,fe.Pregnant,e.position,Mr,e.id),e.lastPregnantEffectTime=o.time),e.gestationTime<=0&&(FR(e,e.pregnancyFatherId,t),e.isPregnant=!1,e.gestationTime=0,e.pregnancyFatherId=void 0)),e.procreationCooldown&&(e.procreationCooldown-=a,e.procreationCooldown<0&&(e.procreationCooldown=0)),e.attackCooldown&&(e.attackCooldown-=a,e.attackCooldown<0&&(e.attackCooldown=0)),e.feedParentCooldownTime&&(e.feedParentCooldownTime-=a,e.feedParentCooldownTime<0&&(e.feedParentCooldownTime=0)),e.feedChildCooldownTime&&(e.feedChildCooldownTime-=a,e.feedChildCooldownTime<0&&(e.feedChildCooldownTime=0)),e.leaderMetaStrategyCooldown&&(e.leaderMetaStrategyCooldown-=a,e.leaderMetaStrategyCooldown<0&&(e.leaderMetaStrategyCooldown=0)),e.isAdult?e.radius===es&&(e.radius=Rt):e.hunger+=i*((zs*DE-zs)/(wt/_t)),e.isAdult&&e.food.length>0&&(!e.feedParentCooldownTime||e.feedParentCooldownTime<=0)){const u=[];if(e.motherId){const c=o.entities.entities[e.motherId];c&&u.push(c)}if(e.fatherId){const c=o.entities.entities[e.fatherId];c&&u.push(c)}for(const c of u)if(c.age>=nh&&c.hunger>=kE&&j(e.position,c.position,o.mapDimensions.width,o.mapDimensions.height)<=FE){e.food.pop(),c.hunger=Math.max(0,c.hunger-sr),e.feedParentCooldownTime=LE;break}}let s;if(e.hitpoints<=0?s="killed":e.hunger>=$r?e.food.length>0&&e.isAdult?(e.food.pop(),e.hunger=Math.max(0,e.hunger-sr)):s="hunger":e.age>=e.maxAge&&(s="oldAge"),s){if(e.leaderId===e.id){const u=zr(hn(o,e));u?(u.leaderId=u.id,u.tribeBadge=e.tribeBadge,u.tribeRole=He.Leader,u.tribeControl=e.tribeControl??{roleWeights:{[He.Leader]:0,[He.Gatherer]:3,[He.Hunter]:2,[He.Mover]:2,[He.Warrior]:2},diplomacy:{}},Object.values(o.entities.entities).forEach(c=>{if(c.type==="human"&&c.leaderId===e.id){const f=c;f.leaderId=u.id}if(c.type==="building"&&c.ownerId===e.id){const f=c;f.ownerId=u.id}})):Object.values(o.entities.entities).forEach(c=>{if(c.type==="human"&&c.leaderId===e.id){const f=c;f.leaderId=void 0,f.tribeBadge=void 0}if(c.type==="building"&&c.ownerId===e.id){const f=c;f.ownerId=void 0}})}if(e.isPlayer){const u=zr(hn(o,e));u?(u.isPlayer=!0,o.generationCount++):(o.gameOver=!0,o.causeOfGameOver=s,Ff(o,{identifier:"no_heir",type:Ta.NoHeir,message:"Your lineage has ended. You have no heir.",duration:0}))}OR(o.entities,e.position,e.gender,e.age,e.radius,e.id,o.time,e.food,e.hunger),rs(o.entities,e.id);return}e.animationProgress===void 0&&(e.animationProgress=0),e.animationSpeed===void 0&&(e.animationSpeed=1),e.animationProgress+=i*e.animationSpeed,e.animationProgress>=1&&(e.animationProgress=0)}function l1(e,t){const i=t.gameState.time-e.timeOfDeath;e.decayProgress=Math.min(1,i/UE);const o=Math.floor(Uv*(1-e.decayProgress));e.food.length>o&&e.food.splice(o),e.decayProgress>=1&&e.food.length<=0&&rs(t.gameState.entities,e.id)}function u1(e,t,i){const o=i*(wt/_t);e.age+=i/Uu,e.isAdult=e.age>=da;let a=t.gameState.ecosystem.preyHungerIncreasePerHour*o;if(e.isPregnant&&(a*=1.2),e.hunger+=a,e.isPregnant&&e.gestationTime!==void 0&&(e.gestationTime-=o,e.gestationTime<=0)){const u={x:e.position.x+(Math.random()-.5)*40,y:e.position.y+(Math.random()-.5)*40};u.x=Math.max(20,Math.min(t.gameState.mapDimensions.width-20,u.x)),u.y=Math.max(20,Math.min(t.gameState.mapDimensions.height-20,u.y));const c=Math.random()<.5?"male":"female",f=e,g=e.fatherId?t.gameState.entities.entities[e.fatherId]:void 0;let m;if(g)m=j_(f.geneCode,g.geneCode);else{m=f.geneCode;const v=Math.floor((Math.random()-.5)*4096);m=Math.max(0,Math.min(16777215,m+v))}Zo(t.gameState.entities,u,c,0,vS*.5,m,e.id,e.fatherId),Me(t.gameState,fe.Procreation,e.position,Mr,e.id),we(t,ge.Birth,e.position),e.isPregnant=!1,e.gestationTime=0,e.procreationCooldown=t.gameState.ecosystem.preyProcreationCooldown,e.fatherId=void 0}e.procreationCooldown&&e.procreationCooldown>0&&(e.procreationCooldown-=o,e.procreationCooldown<0&&(e.procreationCooldown=0)),e.eatingCooldownTime&&e.eatingCooldownTime>t.gameState.time||(e.eatingCooldownTime=void 0),e.fleeCooldown&&e.fleeCooldown>0&&(e.fleeCooldown-=o,e.fleeCooldown<0&&(e.fleeCooldown=0)),e.feedChildCooldownTime&&e.feedChildCooldownTime>0&&(e.feedChildCooldownTime-=o,e.feedChildCooldownTime<0&&(e.feedChildCooldownTime=0));let s=!1;e.hunger>=D_&&(s=!0),e.hitpoints<=0&&(s=!0),e.age>=mS&&(s=!0),s&&(MR(t.gameState.entities,e.position,e.gender,e.age,e.radius,e.id,t.gameState.time,e.geneCode),rs(t.gameState.entities,e.id))}function c1(e,t,i){const o=i*(wt/_t);e.age+=i/Uu,e.isAdult=e.age>=fa;let a=t.gameState.ecosystem.predatorHungerIncreasePerHour*o;if(e.isPregnant&&(a*=1.3),e.hunger+=a,e.isPregnant&&e.gestationTime!==void 0&&(e.gestationTime-=o,e.gestationTime<=0)){const u={x:e.position.x+(Math.random()-.5)*50,y:e.position.y+(Math.random()-.5)*50};u.x=Math.max(25,Math.min(t.gameState.mapDimensions.width-25,u.x)),u.y=Math.max(25,Math.min(t.gameState.mapDimensions.height-25,u.y));const c=Math.random()<.5?"male":"female",f=e,g=e.pregnancyFatherId?t.gameState.entities.entities[e.pregnancyFatherId]:void 0;let m;if(g)m=J_(f.geneCode,g.geneCode);else{m=f.geneCode;const v=Math.floor((Math.random()-.5)*4096);m=Math.max(0,Math.min(16777215,m+v))}qo(t.gameState.entities,u,c,0,yS*.6,m,e.id,e.pregnancyFatherId),Me(t.gameState,fe.Procreation,e.position,Mr,e.id),we(t,ge.Birth,e.position),e.isPregnant=!1,e.gestationTime=0,e.procreationCooldown=t.gameState.ecosystem.predatorProcreationCooldown,e.pregnancyFatherId=void 0}e.procreationCooldown&&e.procreationCooldown>0&&(e.procreationCooldown-=o,e.procreationCooldown<0&&(e.procreationCooldown=0)),e.attackCooldown&&e.attackCooldown>0&&(e.attackCooldown-=o,e.attackCooldown<0&&(e.attackCooldown=0)),e.huntCooldown&&e.huntCooldown>0&&(e.huntCooldown-=o,e.huntCooldown<0&&(e.huntCooldown=0)),e.feedChildCooldownTime&&e.feedChildCooldownTime>0&&(e.feedChildCooldownTime-=o,e.feedChildCooldownTime<0&&(e.feedChildCooldownTime=0));let s=!1;e.hunger>=H_&&(s=!0),e.hitpoints<=0&&(s=!0),e.age>=SS&&(s=!0),s&&(kR(t.gameState.entities,e.position,e.gender,e.age,e.radius,e.id,t.gameState.time,e.geneCode),rs(t.gameState.entities,e.id))}var Oa=(e=>(e[e.BehaviorTreeBased=0]="BehaviorTreeBased",e))(Oa||{}),A=(e=>(e[e.SUCCESS=0]="SUCCESS",e[e.FAILURE=1]="FAILURE",e[e.RUNNING=2]="RUNNING",e[e.NOT_EVALUATED=3]="NOT_EVALUATED",e))(A||{});class rn{constructor(){Pe(this,"name");Pe(this,"depth");Pe(this,"children");Pe(this,"child")}getLastStatus(t){return _.get(t.aiBlackboard,`${this.name}_lastStatus`)??3}setLastStatus(t,i){_.set(t.aiBlackboard,`${this.name}_lastStatus`,i)}getRunningChildIndex(t){return _.get(t.aiBlackboard,`${this.name}_runningChildIndex`)}setRunningChildIndex(t,i){_.set(t.aiBlackboard,`${this.name}_runningChildIndex`,i)}}const _={create(){return{data:{},nodeExecutionData:{}}},set({data:e},t,i){e[t]=i},get(e,t){return e==null?void 0:e.data[t]},delete({data:e},t){delete e[t]},has({data:e},t){return t in e},recordNodeExecution({nodeExecutionData:e},t,i,o,a,s){const u=e[t]||{lastExecuted:0,status:A.FAILURE,depth:0,debugInfo:"",executionHistory:[]},c=u.executionHistory[u.executionHistory.length-1];c&&o-(c==null?void 0:c.time)>va&&u.executionHistory.push({time:c.time+va,status:A.NOT_EVALUATED}),u.executionHistory.push({time:o,status:i});const f=eS/_t*wt,g=o-f;u.executionHistory=u.executionHistory.filter(v=>v.time>=g);const m={...u,lastExecuted:o,status:i,depth:a,debugInfo:s};e[t]=m},getNodeExecutionData({nodeExecutionData:e}){return e},cleanupOldEntries({nodeExecutionData:e},t){const i=UI,o=[];for(const[a,s]of Object.entries(e))t-s.lastExecuted>i&&o.push(a);for(const a of o)delete e[a]}};function yh(e,t,i){if(e.aiBlackboard){const o=_.get(e.aiBlackboard,"lastAiUpdateTime")??0;t.gameState.time-o>=va&&(i.execute(e,t,e.aiBlackboard),_.set(e.aiBlackboard,"lastAiUpdateTime",t.gameState.time))}else console.warn(`Behavior Tree AI ticked for human ${e.id}, but the tree or blackboard was missing.`),e.activeAction="idle"}const w0="Human Behavior",d1=1;class f1{constructor(){Pe(this,"nodeData",new Map);Pe(this,"pathStack",[]);Pe(this,"startTimeStack",[])}nodeStart(t){this.pathStack.push(t),this.startTimeStack.push(performance.now())}nodeEnd(){if(this.startTimeStack.length===0||this.pathStack.length===0){console.error("BTProfiler: nodeEnd() called without a matching nodeStart().");return}const t=performance.now(),i=this.startTimeStack.pop(),o=t-i,a=this.pathStack.join(" > "),s=this.nodeData.get(a)??{path:a,totalTime:0,callCount:0,minTime:1/0,maxTime:-1/0};s.totalTime+=o,s.callCount++,s.minTime=Math.min(s.minTime,o),s.maxTime=Math.max(s.maxTime,o),this.nodeData.set(a,s),this.pathStack.pop()}report(t={}){const{showAll:i=!1}=t,o=Array.from(this.nodeData.values());if(o.length===0){console.log("--- Behavior Tree Profiler: No data collected. ---");return}let a=o,s="--- Behavior Tree Full Report ---";if(!i){const c=this.nodeData.get(w0);if(c){const f=c.totalTime*d1/100;a=o.filter(g=>g.totalTime>f&&g.path!==w0),s="--- Behavior Tree Problem Report ---"}else console.log('BTProfiler: Root node "Human Behavior" not found. Showing full report.'),s="--- Behavior Tree Full Report (Root Not Found) ---"}const u=a.sort((c,f)=>f.totalTime-c.totalTime);console.log(s),u.length>0?console.table(u.map(c=>({Path:c.path,"Total Time (ms)":c.totalTime.toFixed(3),Calls:c.callCount,"Avg Time (ms)":(c.totalTime/c.callCount).toFixed(3),"Min Time (ms)":c.minTime.toFixed(3),"Max Time (ms)":c.maxTime.toFixed(3)}))):console.log("No significant performance problems detected."),console.log("------------------------------------")}reset(){this.nodeData.clear(),this.pathStack=[],this.startTimeStack=[]}}const Ke=new f1;function bt(e){return Array.isArray(e)?e:[e,""]}class Ae extends rn{constructor(i,o,a=0){super();Pe(this,"name");Pe(this,"depth");this.children=i,this.name=o,this.depth=a,this.children.forEach(s=>{s.depth=(this.depth??0)+1})}execute(i,o,a){this.name&&Ke.nodeStart(this.name);try{for(const s of this.children){const[u,c]=bt(s.execute(i,o,a));if(u!==A.SUCCESS)return this.setLastStatus(i,u),this.name&&_.recordNodeExecution(a,this.name,u,o.gameState.time,this.depth,c),u}return this.setLastStatus(i,A.SUCCESS),this.name&&_.recordNodeExecution(a,this.name,A.SUCCESS,o.gameState.time,this.depth,""),A.SUCCESS}finally{this.name&&Ke.nodeEnd()}}}class nn extends rn{constructor(i,o,a=0){super();Pe(this,"name");Pe(this,"depth");this.children=i,this.name=o,this.depth=a,this.children.forEach(s=>{s.depth=(this.depth??0)+1})}execute(i,o,a){this.name&&Ke.nodeStart(this.name);try{const s=this.getRunningChildIndex(i)??0;for(let u=s;u<this.children.length;u++){const c=this.children[u],[f,g]=bt(c.execute(i,o,a));if(f!==A.FAILURE){if(f===A.SUCCESS)return this.setRunningChildIndex(i,void 0),this.setLastStatus(i,A.SUCCESS),this.name&&_.recordNodeExecution(a,this.name,A.SUCCESS,o.gameState.time,this.depth,g),A.SUCCESS;if(f===A.RUNNING)return this.setRunningChildIndex(i,u),this.setLastStatus(i,A.RUNNING),this.name&&_.recordNodeExecution(a,this.name,A.RUNNING,o.gameState.time,this.depth,g),A.RUNNING}}return this.setRunningChildIndex(i,void 0),this.setLastStatus(i,A.FAILURE),this.name&&_.recordNodeExecution(a,this.name,A.FAILURE,o.gameState.time,this.depth,""),A.FAILURE}finally{this.name&&Ke.nodeEnd()}}}class ce extends rn{constructor(i,o,a=0){super();Pe(this,"name");Pe(this,"depth");this.action=i,this.name=o,this.depth=a}execute(i,o,a){this.name&&Ke.nodeStart(this.name);try{const[s,u]=bt(this.action(i,o,a));return this.setLastStatus(i,s),this.name&&_.recordNodeExecution(a,this.name,s,o.gameState.time,this.depth,u),s}finally{this.name&&Ke.nodeEnd()}}}class ae extends rn{constructor(i,o,a=0){super();Pe(this,"name");Pe(this,"depth");this.condition=i,this.name=o,this.depth=a}execute(i,o,a){this.name&&Ke.nodeStart(this.name);try{const[s,u]=bt(this.condition(i,o,a)),c=s?A.SUCCESS:A.FAILURE;return this.setLastStatus(i,c),this.name&&_.recordNodeExecution(a,this.name,c,o.gameState.time,this.depth,u),c}finally{this.name&&Ke.nodeEnd()}}}class h1 extends rn{constructor(i,o,a=0){super();Pe(this,"name");Pe(this,"depth");this.child=i,this.name=o,this.depth=a,this.child.depth=(this.depth??0)+1}execute(i,o,a){this.name&&Ke.nodeStart(this.name);try{const[s,u]=bt(this.child.execute(i,o,a));let c;switch(s){case A.SUCCESS:c=A.FAILURE;break;case A.FAILURE:c=A.SUCCESS;break;case A.RUNNING:default:c=s;break}return this.setLastStatus(i,c),this.name&&_.recordNodeExecution(a,this.name,c,o.gameState.time,this.depth,u),c}finally{this.name&&Ke.nodeEnd()}}}class g1 extends rn{constructor(i,o,a=0){super();Pe(this,"name");Pe(this,"depth");this.child=i,this.name=o,this.depth=a,this.child.depth=(this.depth??0)+1}execute(i,o,a){this.name&&Ke.nodeStart(this.name);try{const[,s]=bt(this.child.execute(i,o,a)),u=A.SUCCESS;return this.setLastStatus(i,u),this.name&&_.recordNodeExecution(a,this.name,u,o.gameState.time,this.depth,s),u}finally{this.name&&Ke.nodeEnd()}}}class Ru extends rn{constructor(i,o,a,s=0){super();Pe(this,"name");Pe(this,"depth");Pe(this,"startTimeKey");this.child=i,this.timeoutDurationHours=o,this.name=a,this.depth=s,this.child.depth=(this.depth??0)+1,this.startTimeKey=`timeout_${this.name}_startTime`}execute(i,o,a){Ke.nodeStart(this.name);try{const s=o.gameState.time;let u=_.get(a,this.startTimeKey);const[c,f]=bt(this.child.execute(i,o,a));if(c===A.RUNNING){u===void 0&&(_.set(a,this.startTimeKey,s),u=s);const g=s-u;if(g>this.timeoutDurationHours){_.delete(a,this.startTimeKey),this.setLastStatus(i,A.FAILURE);const v=`Timed out after ${g.toFixed(2)}h.`;return _.recordNodeExecution(a,this.name,this.getLastStatus(i),s,this.depth,v),this.getLastStatus(i)}this.setLastStatus(i,A.RUNNING);const m=`Running for ${g.toFixed(2)}h. ${f}`;return _.recordNodeExecution(a,this.name,this.getLastStatus(i),s,this.depth,m),this.getLastStatus(i)}return u!==void 0&&_.delete(a,this.startTimeKey),this.setLastStatus(i,c),_.recordNodeExecution(a,this.name,this.getLastStatus(i),s,this.depth,f),this.getLastStatus(i)}finally{Ke.nodeEnd()}}}class tr extends rn{constructor(i,o,a,s=0,u){super();Pe(this,"name");Pe(this,"depth");Pe(this,"statusKey");Pe(this,"timestampKey");this.child=i,this.cacheDurationHours=o,this.validityCheck=u,this.name=a,this.depth=s,this.child.depth=(this.depth??0)+1,this.statusKey=`caching_${this.name}_status`,this.timestampKey=`caching_${this.name}_timestamp`}execute(i,o,a){Ke.nodeStart(this.name);try{const s=o.gameState.time,u=_.get(a,this.statusKey),c=_.get(a,this.timestampKey);if(u!==void 0&&c!==void 0){const v=s-c>this.cacheDurationHours,y=this.validityCheck?this.validityCheck(i,o,a):!0;if(!v&&y){const I=(c+this.cacheDurationHours-s).toFixed(2),E=`Cache hit. Status: ${A[u]}. ${I}h left.`;return this.setLastStatus(i,u),_.recordNodeExecution(a,this.name,this.getLastStatus(i),s,this.depth,E),this.getLastStatus(i)}}const[f,g]=bt(this.child.execute(i,o,a));(f===A.SUCCESS||f===A.FAILURE)&&(_.set(a,this.statusKey,f),_.set(a,this.timestampKey,s)),this.setLastStatus(i,f);const m=`Cache miss. Child returned ${A[f]}. ${g}`;return _.recordNodeExecution(a,this.name,this.getLastStatus(i),s,this.depth,m),this.getLastStatus(i)}finally{Ke.nodeEnd()}}}class ur extends rn{constructor(i,o,a,s=0){super();Pe(this,"name");Pe(this,"depth");Pe(this,"cooldownKey");this.cooldownDurationHours=i,this.child=o,this.name=a,this.depth=s,this.child.depth=(this.depth??0)+1,this.cooldownKey=`cooldown_${this.name}`}execute(i,o,a){Ke.nodeStart(this.name);try{const s=o.gameState.time,u=_.get(a,this.cooldownKey);if(this.child.getLastStatus(i)===A.RUNNING){const[g,m]=bt(this.child.execute(i,o,a));if(this.setLastStatus(i,g),this.name){const v=`Continuing running child. ${m}`;_.recordNodeExecution(a,this.name,this.getLastStatus(i),s,this.depth,v)}return this.getLastStatus(i)}if(u!==void 0&&s<u){const m=`Cooldown active, ${(u-s).toFixed(2)}h left`;return this.setLastStatus(i,A.FAILURE),this.name&&_.recordNodeExecution(a,this.name,this.getLastStatus(i),s,this.depth,m),this.getLastStatus(i)}const[c,f]=bt(this.child.execute(i,o,a));return c===A.SUCCESS&&_.set(a,this.cooldownKey,s+this.cooldownDurationHours),this.setLastStatus(i,c),this.name&&_.recordNodeExecution(a,this.name,this.getLastStatus(i),s,this.depth,f),this.getLastStatus(i)}finally{Ke.nodeEnd()}}}class tn extends rn{constructor(i,o,a,s=0){super();Pe(this,"name");Pe(this,"depth");this.child=i,this.behaviorKey=o,this.name=a,this.depth=s;const u=(c,f)=>{c.depth=f,c.children?c.children.forEach(g=>u(g,f+1)):c.child&&u(c.child,f+1)};u(this.child,(this.depth??0)+1)}execute(i,o,a){this.name&&Ke.nodeStart(this.name);try{if(i.isPlayer&&!o.gameState.autopilotControls.behaviors[this.behaviorKey]){const f=`Player autopilot for '${this.behaviorKey}' is disabled.`;return this.setLastStatus(i,A.FAILURE),this.name&&_.recordNodeExecution(a,this.name,this.getLastStatus(i),o.gameState.time,this.depth,f),this.getLastStatus(i)}const[u,c]=bt(this.child.execute(i,o,a));return this.setLastStatus(i,u),this.name&&_.recordNodeExecution(a,this.name,this.getLastStatus(i),o.gameState.time,this.depth,c),this.getLastStatus(i)}finally{this.name&&Ke.nodeEnd()}}}class p1 extends rn{constructor(i,o,a=0){super();Pe(this,"name");Pe(this,"depth");this.child=i,this.name=o,this.depth=a;const s=(u,c)=>{u.depth=c,u.children?u.children.forEach(f=>s(f,c+1)):u.child&&s(u.child,c+1)};s(this.child,(this.depth??0)+1)}execute(i,o,a){this.name&&Ke.nodeStart(this.name);try{if(i.isPlayer&&o.gameState.autopilotControls.isManuallyMoving)return this.setLastStatus(i,A.FAILURE),this.name&&_.recordNodeExecution(a,this.name,this.getLastStatus(i),o.gameState.time,this.depth,"Manual movement active, AI blocked."),this.getLastStatus(i);const[s,u]=bt(this.child.execute(i,o,a));return this.setLastStatus(i,s),this.name&&_.recordNodeExecution(a,this.name,this.getLastStatus(i),o.gameState.time,this.depth,u),this.getLastStatus(i)}finally{this.name&&Ke.nodeEnd()}}}class To extends rn{constructor(i,o,a=0){super();Pe(this,"name");Pe(this,"depth");this.child=i,this.name=o,this.depth=a;const s=(u,c)=>{u.depth=c,u.children?u.children.forEach(f=>s(f,c+1)):u.child&&s(u.child,c+1)};s(this.child,(this.depth??0)+1)}execute(i,o,a){this.name&&Ke.nodeStart(this.name);try{if(i.isPlayer)return this.setLastStatus(i,A.FAILURE),this.name&&_.recordNodeExecution(a,this.name,this.getLastStatus(i),o.gameState.time,this.depth,"Player controlled, AI blocked."),this.getLastStatus(i);const[s,u]=bt(this.child.execute(i,o,a));return this.setLastStatus(i,s),this.name&&_.recordNodeExecution(a,this.name,this.getLastStatus(i),o.gameState.time,this.depth,u),this.getLastStatus(i)}finally{this.name&&Ke.nodeEnd()}}}const Ko=24,Th=2,wS=2;function wa(e,t){if(e.leaderId){const i=t.entities.entities[e.leaderId];if(i&&i.aiBlackboard)return i}if(e.isAdult&&e.aiBlackboard)return e;if(!e.isAdult&&e.fatherId){const i=t.entities.entities[e.fatherId];if(i&&i.aiBlackboard)return i}return null}function m1(e,t){if(!e.aiBlackboard)return;const i=e.aiBlackboard.data,o=[];for(const a in i)if(a.startsWith("tribal_")){const s=i[a];s&&typeof s=="object"&&"startTime"in s&&t-s.startTime>Ko&&o.push(a)}for(const a of o)_.delete(e.aiBlackboard,a)}class lr extends rn{constructor(i,o,a,s=0){super();Pe(this,"name");Pe(this,"depth");Pe(this,"registeredKey");this.child=i,this.config=o,this.name=a,this.depth=s,this.child.depth=(this.depth??0)+1,this.registeredKey=`${this.name}_registered`}execute(i,o,a){Ke.nodeStart(this.name);try{const s=wa(i,o.gameState);if(!s||!s.aiBlackboard){const[E,T]=bt(this.child.execute(i,o,a));return this.setLastStatus(i,E),_.recordNodeExecution(a,this.name,E,o.gameState.time,this.depth,`No coordination: ${T}`),E}const u=o.gameState.time,c=_.get(a,this.registeredKey)??!1,f=this.getTaskTarget(i,o,a);if(!f)return this.setLastStatus(i,A.FAILURE),_.recordNodeExecution(a,this.name,A.FAILURE,u,this.depth,"No task target found"),A.FAILURE;const g=this.getTaskKey(f);if(c){const[E,T]=bt(this.child.execute(i,o,a));return E===A.RUNNING?(this.refreshTaskTimestamp(s.aiBlackboard,g,i.id,u),this.setLastStatus(i,E),_.recordNodeExecution(a,this.name,E,u,this.depth,`Continuing: ${T}`),E):(this.removeFromTask(s.aiBlackboard,g,i.id),_.delete(a,this.registeredKey),this.setLastStatus(i,E),_.recordNodeExecution(a,this.name,E,u,this.depth,`Completed: ${T}`),E)}if(!this.canJoinTask(s.aiBlackboard,g,i.id,u)){this.setLastStatus(i,A.FAILURE);const E=_.get(s.aiBlackboard,g),T=(E==null?void 0:E.memberIds.length)??0,w=this.config.maxCapacity??1;return _.recordNodeExecution(a,this.name,A.FAILURE,u,this.depth,`Task full: ${T}/${w}`),A.FAILURE}if(!this.registerTask(s.aiBlackboard,g,i.id,u))return this.setLastStatus(i,A.FAILURE),_.recordNodeExecution(a,this.name,A.FAILURE,u,this.depth,"Failed to register task"),A.FAILURE;_.set(a,this.registeredKey,!0);const[y,I]=bt(this.child.execute(i,o,a));if(y===A.RUNNING){this.setLastStatus(i,y);const E=_.get(s.aiBlackboard,g),T=(E==null?void 0:E.memberIds.length)??0,w=this.config.maxCapacity??1;return _.recordNodeExecution(a,this.name,y,u,this.depth,`Started (${T}/${w}): ${I}`),y}else return this.removeFromTask(s.aiBlackboard,g,i.id),_.delete(a,this.registeredKey),this.setLastStatus(i,y),_.recordNodeExecution(a,this.name,y,u,this.depth,`Immediate result: ${I}`),y}finally{Ke.nodeEnd()}}getTaskTarget(i,o,a){var u,c,f,g;if(this.config.taskType==="procreation")return((c=(u=this.config).getTargetId)==null?void 0:c.call(u,i,o,a))??null;const s=(g=(f=this.config).getTargetId)==null?void 0:g.call(f,i,o,a);return s??null}getTaskKey(i){return this.config.generateTaskKey?this.config.generateTaskKey(this.config.taskType,i):`tribal_${this.config.taskType}_${i}`}canJoinTask(i,o,a,s){const u=_.get(i,o);if(!u||s-u.startTime>Ko||u.memberIds.includes(a))return!0;const c=this.config.maxCapacity??1;return u.memberIds.length<c}registerTask(i,o,a,s){let u=_.get(i,o);return u?s-u.startTime>Ko?(u={memberIds:[a],startTime:s,maxCapacity:this.config.maxCapacity??1},_.set(i,o,u),!0):u.memberIds.length>=(this.config.maxCapacity??1)?!!u.memberIds.includes(a):(u.memberIds.includes(a)||(u.memberIds.push(a),_.set(i,o,u)),!0):(u={memberIds:[a],startTime:s,maxCapacity:this.config.maxCapacity??1},_.set(i,o,u),!0)}refreshTaskTimestamp(i,o,a,s){const u=_.get(i,o);u&&u.memberIds.includes(a)&&(u.startTime=s,_.set(i,o,u))}removeFromTask(i,o,a){const s=_.get(i,o);s&&(s.memberIds=s.memberIds.filter(u=>u!==a),s.memberIds.length===0?_.delete(i,o):_.set(i,o,s))}}function v1(e){return new Ae([new ae((t,i)=>{const o=t.hunger>=Df,a=t.food.length>0,s=!t.eatingCooldownTime||i.gameState.time>=t.eatingCooldownTime;return[!!(o&&a&&s),`${Math.floor(t.hunger-Df)}, ${t.food.length}, ${t.eatingCooldownTime?Math.floor(t.eatingCooldownTime-i.gameState.time):""}`]},"Can Eat",e+1),new ce(t=>(t.direction={x:0,y:0},t.target=void 0,t.activeAction="eating",A.RUNNING),"Eat",e+1)],"Eating",e)}function S1(e){return new Ae([new ae((t,i,o)=>{if(t.isAdult&&t.hitpoints>t.maxHitpoints*Pv||!(t.hitpoints<t.maxHitpoints*.1)&&t.isAdult&&t.hunger>kI)return!1;const s=aC(t.id,i.gameState);return s?(_.set(o,"fleeThreat",s.id),!0):!1},"Should Flee",e+1),new ce((t,i,o)=>{const a=_.get(o,"fleeThreat"),s=a&&i.gameState.entities.entities[a];if(!s)return A.FAILURE;t.activeAction="moving";const u=Ye(s.position,t.position,i.gameState.mapDimensions.width,i.gameState.mapDimensions.height),c=at(u),f=bn(t.position,Ot(c,Nv));return t.target={x:(f.x%i.gameState.mapDimensions.width+i.gameState.mapDimensions.width)%i.gameState.mapDimensions.width,y:(f.y%i.gameState.mapDimensions.height+i.gameState.mapDimensions.height)%i.gameState.mapDimensions.height},t.direction=c,A.RUNNING},"Execute Flee",e+1)],"Flee",e)}const _S=100,y1=25;function _0(e){const t=Math.sin(e)*1e4;return t-Math.floor(t)}function T1(e,t,i=_S){return t.search.building.byRadius(e.position,i).some(s=>{const u=s;return u.buildingType==="storageSpot"&&u.ownerId===e.leaderId&&u.isConstructed&&u.storedFood&&u.storageCapacity&&u.storedFood.length<u.storageCapacity})}function A1(e,t,i=_S){return t.search.building.byRadius(e.position,i).filter(s=>{const u=s;return u.buildingType==="storageSpot"&&u.ownerId===e.leaderId&&u.isConstructed&&u.storedFood&&u.storedFood.length>0})}function I1(e,t,i){if(t.length===0)return null;let o=null,a=1/0;for(const s of t){const u=j(e.position,s.position,i.mapDimensions.width,i.mapDimensions.height);u<a&&(a=u,o=s)}return o?{storage:o,distance:a}:null}function RS(e){const t=e.storedFood?e.storedFood.length:0,i=_0(t+e.id)*2*Math.PI,o=_0(t+e.id+1)*y1;return{x:Math.cos(i)*o,y:Math.sin(i)*o}}const Ao="foodSource";function E1(e){const t=new ce((o,a,s)=>{const u=wa(o,a.gameState),c=new Map,f=Oe(o,a.gameState,"berryBush",$m,v=>{var T;if(v.food.length===0)return!1;if(u&&u.aiBlackboard){const w=`tribal_gather_${v.id}`,O=_.get(u.aiBlackboard,w);if(O&&a.gameState.time-O.startTime<=Ko&&!O.memberIds.includes(o.id))return!1}const y=(T=a.gameState.search.building.byRadius(v.position,v.radius)[0])==null?void 0:T.ownerId,I=a.gameState.entities.entities[y];if(!I||I.leaderId===o.leaderId)return!0;const E=c.get(I.id)??j(o.position,I.position,a.gameState.mapDimensions.width,a.gameState.mapDimensions.height);return c.set(I.id,E),E>nE}),g=Oe(o,a.gameState,"corpse",$m,v=>{if(v.food.length===0)return!1;if(u&&u.aiBlackboard){const y=`tribal_gather_${v.id}`,I=_.get(u.aiBlackboard,y);if(I&&a.gameState.time-I.startTime<=Ko&&!I.memberIds.includes(o.id))return!1}return!0});let m=null;if(f&&g){const v=j(o.position,f.position,a.gameState.mapDimensions.width,a.gameState.mapDimensions.height),y=j(o.position,g.position,a.gameState.mapDimensions.width,a.gameState.mapDimensions.height);m=v<=y?f:g}else m=f||g;return m?(_.set(s,Ao,m.id),[A.SUCCESS,`Found food: ${m.type} at ${m.position.x.toFixed(0)},${m.position.y.toFixed(0)}`]):[A.FAILURE,"No food source found"]},"Find Closest Food Source",e+4),i=new lr(new ce((o,a,s)=>{const u=_.get(s,Ao);if(!u)return[A.FAILURE,"No target in blackboard"];const c=a.gameState.entities.entities[u];return!c||c.food.length===0?(_.delete(s,Ao),[A.FAILURE,"Food source is invalid or depleted"]):j(o.position,c.position,a.gameState.mapDimensions.width,a.gameState.mapDimensions.height)<zo?(o.activeAction="gathering",o.direction={x:0,y:0},o.target=c.id,_.delete(s,Ao),[A.SUCCESS,`Gathering from ${c.type}`]):(o.activeAction="moving",o.target=c.id,o.direction=Bt(o.position,c.position,a.gameState.mapDimensions),[A.RUNNING,`Moving to ${c.type}`])},"Move To Food and Gather",e+3),{taskType:"gather",maxCapacity:2,getTargetId:(o,a,s)=>_.get(s,Ao)??null},"Tribal Gather Task",e+3);return new Ae([new ae((o,a)=>{const s=o.food.length<o.maxFood,u=o.hunger>CI,c=hn(a.gameState,o).filter(g=>g.hunger>eh),f=T1(o,a.gameState);return[(o.isAdult&&s&&(u||c.length>0||f))??!1,`${u?"H":""}${c.length>0?" HC("+c.length+")":""}${f?" S":""}`]},"Should Gather Food",e+1),new nn([new Ae([new ae((o,a,s)=>_.has(s,Ao),"Has Food Source?",e+2),i],"Continue Gathering Action",e+2),new Ae([new tr(t,bI,"Cache Food Source Search",e+3),i],"Find New Food Source and Gather",e+2)],"Perform or Start Gathering",e+1)],"Gather Food",e)}function C1(e){return new ce((t,i,o)=>(t.activeAction="idle",t.direction={x:0,y:0},t.target=void 0,_.set(o,"wanderTarget",void 0),A.SUCCESS),"Idle",e)}const Ql="procreationWanderStartTime",R0=(e,t,i)=>t.find(o=>jr(e,o,i)),P0={taskType:"procreation",maxCapacity:2,getTargetId:(e,t,i)=>_.get(i,"procreationPartner")??null};function w1(e){const t=new ae((s,u,c)=>{const f=Qm(s,u.gameState,zo),g=R0(s,f,u.gameState);return g?(_.set(c,"procreationPartner",g.id),!0):!1},"Find Immediate Partner"),i=new lr(new ce((s,u,c)=>{var m;const f=_.get(c,"procreationPartner"),g=f&&u.gameState.entities.entities[f];return g?(s.activeAction="procreating",s.target=void 0,_.delete(c,"procreationPartner"),_.delete(c,Ql),(m=s.partnerIds)!=null&&m.includes(g.id)||(s.partnerIds=s.partnerIds?[...s.partnerIds,g.id]:[g.id]),A.SUCCESS):A.FAILURE},"Start Procreating"),P0,"Tribal Start Procreating",e+2),o=new ae((s,u,c)=>{const f=Qm(s,u.gameState,MI),g=R0(s,f,u.gameState);return g?(_.set(c,"procreationPartner",g.id),!0):!1},"Locate Distant Partner"),a=new lr(new ce((s,u,c)=>{const f=_.get(c,"procreationPartner"),g=f&&u.gameState.entities.entities[f];if(!g||g.isPregnant)return A.FAILURE;if(j(s.position,g.position,u.gameState.mapDimensions.width,u.gameState.mapDimensions.height)<zo)return A.SUCCESS;s.activeAction="moving",s.target=g.id;const v=Ye(s.position,g.position,u.gameState.mapDimensions.width,u.gameState.mapDimensions.height);return s.direction=at(v),A.RUNNING},"Move Towards Partner"),P0,"Tribal Move To Partner",e+3);return new Ae([new ae(s=>!(!s.isAdult||s.gender==="female"&&s.isPregnant||s.age<_E||s.gender==="female"&&s.age>Lv),"Is Fertile (age, not pregnant)",e+1),new ae(s=>s.hunger<Wr,"Is Healthy (hunger)",e+1),new ae(s=>(s.procreationCooldown||0)<=0,"Is Ready (cooldown)",e+1),new nn([new Ae([new ae((s,u)=>n0(s.position,u.gameState,"berryBush",Gm)>=OI,"Is Environment Viable (food)",e+3),new ce((s,u,c)=>(_.delete(c,Ql),A.SUCCESS),"Clear Wander Timer",e+3)],"Sufficient Food Path",e+2),new Ae([new ae((s,u)=>{if(s.gender==="male"){const c=hn(u.gameState,s);return!zr(c)}return!1},"Is Male Without Heir",e+3),new ce((s,u,c)=>{const f=_.get(c,Ql);if(f===void 0)return _.set(c,Ql,u.gameState.time),[A.FAILURE,"Starting heirless wander timer"];const g=u.gameState.time-f;return g>=RE?n0(s.position,u.gameState,"berryBush",Gm)>=1?[A.SUCCESS,`Wandered for ${g.toFixed(1)}h, minimum food found`]:[A.FAILURE,"Desperate but no food sources nearby"]:[A.FAILURE,`Wandering for heir, ${g.toFixed(1)}h elapsed`]},"Check Wander Timer",e+3)],"Heirless Desperation Path",e+2)],"Check Environment Or Desperation",e+1),new ae((s,u,c)=>{var g;const f=_.get(c,"procreationPartner");return f&&((g=f.partnerIds)!=null&&g.length)&&!f.partnerIds.includes(s.id)&&f.partnerIds.map(m=>u.gameState.entities.entities[m]).filter(m=>!!m).some(m=>j(s.position,m.position,u.gameState.mapDimensions.width,u.gameState.mapDimensions.height)<tE)?[!1,"Partner's primary partner is too close"]:!0},"Is Partner's Primary Partner Nearby",e+1),new nn([new Ae([t,i],"Procreate With Immediate Partner",e+2),new ur(BI,new Ae([o,a],"Seek Distant Partner Action",e+3),"Seek Distant Partner Cooldown",e+2)],"Find Partner And Procreate",e+1)],"Procreate",e)}const Io="attackTarget",Rr="homeCenter",of=150;function _1(e){return new Ae([new ae((t,i,o)=>{if(!t.isAdult)return[!1,"Not an adult"];const{gameState:a}=i;if(t.activeAction==="attacking"&&t.attackTargetId){const u=a.entities.entities[t.attackTargetId];if(u&&u.hitpoints>0&&j(t.position,u.position,a.mapDimensions.width,a.mapDimensions.height)<=of){if(_.set(o,Io,u.id),!_.get(o,Rr)){const c=t.leaderId?Yr(t.leaderId,a):Eu(t,a).length>0?e0(t,a):t.position;_.set(o,Rr,c)}return!0}}const s=Oe(t,a,"human",of,u=>u.hitpoints>0&&ts(t,u,a));if(s){_.set(o,Io,s.id);const u=t.leaderId?Yr(t.leaderId,a):Eu(t,a).length>0?e0(t,a):t.position;return _.set(o,Rr,u),!0}return _.set(o,Io,void 0),_.set(o,Rr,void 0),!1},"Find Attack Target",e+1),new ce((t,i,o)=>{const a=_.get(o,Io),s=a&&i.gameState.entities.entities[a],u=_.get(o,Rr);if(!s||!u)return A.FAILURE;const{gameState:c}=i;return j(t.position,u,c.mapDimensions.width,c.mapDimensions.height)>Rv?(t.activeAction="idle",t.attackTargetId=void 0,_.set(o,Io,void 0),_.set(o,Rr,void 0),A.FAILURE):s.hitpoints<=0||j(t.position,s.position,c.mapDimensions.width,c.mapDimensions.height)>of?(t.activeAction==="attacking"&&(t.activeAction="idle",t.attackTargetId=void 0),_.set(o,Io,void 0),_.set(o,Rr,void 0),A.SUCCESS):(t.activeAction==="attacking"&&t.attackTargetId===s.id||(t.activeAction="attacking",t.attackTargetId=s.id),A.RUNNING)},"Execute Attack",e+1)],"Attack",e)}const R1=(e,t,i)=>{const o=hn(t.gameState,e).filter(u=>!u.isAdult);if(o.length===0)return A.FAILURE;let a=null,s=eh;for(const u of o)u.hunger>=s&&(s=u.hunger,a=u);return a?(_.set(i,"targetChild",a.id),A.SUCCESS):A.FAILURE},P1=(e,t,i)=>{const o=_.get(i,"targetChild"),a=o&&t.gameState.entities.entities[o];return a?j(e.position,a.position,t.gameState.mapDimensions.width,t.gameState.mapDimensions.height)>th?(e.activeAction="moving",e.target=a.id,e.direction=Bt(e.position,a.position,t.gameState.mapDimensions),A.RUNNING):(e.activeAction="feeding",e.target=void 0,_.set(i,"targetChild",void 0),A.SUCCESS):A.FAILURE};function N1(e){return new Ae([new ae(t=>(t.isAdult&&t.food.length>0&&(!t.feedChildCooldownTime||t.feedChildCooldownTime<=0))??!1,"Can Feed Child",e+1),new ce(R1,"Find Hungriest Child",e+1),new ce(P1,"Move To Child and Feed",e+1)],"Feed Child",e)}function D1(e){return new Ae([new ae(t=>!t.isAdult&&t.hunger>=eh,"Is Hungry Child",e+1),new ce((t,i,o)=>{const a=ZE(t,i.gameState);if(a.length===0)return A.FAILURE;const s=Oe(t,i.gameState,"human",ME,u=>a.some(c=>c.id===u.id)&&u.food.length>0);return s?(_.set(o,"targetParent",s.id),A.SUCCESS):A.FAILURE},"Find Parent With Food",e+1),new ce((t,i,o)=>{const a=_.get(o,"targetParent"),s=a&&i.gameState.entities.entities[a];if(!s)return A.FAILURE;const u=j(t.position,s.position,i.gameState.mapDimensions.width,i.gameState.mapDimensions.height);return t.activeAction="idle",u<=th?(t.target=void 0,A.SUCCESS):(t.target=s.id,t.activeAction="moving",A.RUNNING)},"Move To Parent",e+1)],"Seek Food From Parent",e)}const Eo="plantingSpot",Xs="plantingZoneId",O1=50;function M1(e,t,i,o){const a=Ye(e,t,i,o);return bn(e,a)}function k1(e){const t=new ce((a,s,u)=>{const c=_.get(u,Eo);if(!c)return _.delete(u,Eo),_.delete(u,Xs),[A.FAILURE,"Planting spot is missing"];if(xn(c,s.gameState,xr,a.id))return _.delete(u,Eo),_.delete(u,Xs),[A.FAILURE,"Planting spot is occupied"];const f=M1(a.position,c,s.gameState.mapDimensions.width,s.gameState.mapDimensions.height),g=j(a.position,f,s.gameState.mapDimensions.width,s.gameState.mapDimensions.height);return g>zo?(a.activeAction="moving",a.target=f,a.direction=Bt(a.position,f,s.gameState.mapDimensions),[A.RUNNING,"Moving to planting spot: "+g.toFixed(2)+" units away"]):xn(c,s.gameState,xr,a.id)?(_.delete(u,Eo),_.delete(u,Xs),[A.FAILURE,"Planting spot is now occupied"]):(a.activeAction="planting",a.target=c,[A.RUNNING,"Planting state initiated"])},"Move To Spot and Plant",e+4),i=new lr(t,{taskType:"plant",maxCapacity:2,proximityRadius:O1,getTargetId:(a,s,u)=>_.get(u,Xs)??null},"Coordinated Planting",e+3),o=new ce((a,s,u)=>{const c=u_(a,s.gameState);return c?(_.set(u,Eo,c.position),_.set(u,Xs,c.zoneId),[A.SUCCESS,`Found new spot at ${c.position.x.toFixed(0)}, ${c.position.y.toFixed(0)} (Zone ${c.zoneId})`]):[A.FAILURE,"No suitable planting spot found"]},"Find Optimal Planting Spot",e+3);return new Ae([new ae(a=>{const s=a.food.filter(f=>f.type===Gn.Berry).length>=Gr,u=a.hunger<wI,c=(a.isAdult&&s&&u)??!1;return[c,c?"Can plant":`Cannot plant: adult=${a.isAdult}, berries=${a.food.filter(f=>f.type===Gn.Berry).length}/${Gr}, hunger=${a.hunger.toFixed(0)}`]},"Can Plant",e+1),new ae((a,s)=>{if(!a.leaderId)return[!1,"No tribe"];const u=t_(a,s.gameState),c=hS(a.leaderId,s.gameState);let f;return u<rE?f=aE:u<oE?f=lE:u<sE?f=uE:f=cE,[c<f,`Food security: ${(u*100).toFixed(0)}%, Bush density: ${c.toFixed(1)}/${f}`]},"Needs More Bushes (Adaptive)",e+1),new ae((a,s)=>{if(!a.leaderId)return[!0,"No tribe coordination needed"];const u=wn(a,s.gameState),c=gS(a.leaderId,s.gameState,"planting"),f=Math.max(1,Math.ceil(u.length*.3));return[c<f,`Active planters: ${c}/${f}`]},"Not Too Many Planters",e+1),new nn([new Ae([new ae((a,s,u)=>_.has(u,Eo),"Has Planting Spot?",e+2),i],"Continue Planting Action",e+2),new ur(HI,o,"Find Planting Spot Cooldown",e+2)],"Perform or Start Planting",e+1)],"Plant Bush",e)}const N0="lastDepositTime",Co="assignedStorageSpot";function F1(e){return new nn([new Ae([new ae((t,i,o)=>{const a=_.get(o,N0)||0,s=i.gameState.time-a;if(s<Wm)return[!1,`Cooldown: ${(Wm-s).toFixed(1)}h remaining`];if(!t.isAdult)return[!1,"Not an adult"];if(!t.leaderId)return[!1,"No tribe"];const u=fS(t.leaderId,i.gameState);let c;u<.3?c=dE:u<.7?c=fE:c=hE;const f=t.food.length/t.maxFood;if(f<=c)return[!1,`Food ${(f*100).toFixed(0)}% < threshold ${(c*100).toFixed(0)}%`];const g=l_(t,i.gameState);return g?(_.set(o,Co,g.id),[!0,`Storage util: ${(u*100).toFixed(0)}%, Personal: ${(f*100).toFixed(0)}%`]):[!1,"No available tribe storage nearby"]},"Check for Excess Food and Storage",e+1),new ae((t,i)=>{if(!t.leaderId)return[!0,"No tribe coordination needed"];const o=gS(t.leaderId,i.gameState,"depositing"),a=wn(t,i.gameState),s=Math.max(1,Math.ceil(a.length*.4));return[o<s,`Active depositors: ${o}/${s}`]},"Not Too Many Depositors",e+1),new lr(new ce((t,i,o)=>{var c;const a=_.get(o,Co);if(!a)return[A.FAILURE,"No storage assigned"];const s=i.gameState.entities.entities[a];if(!s)return _.delete(o,Co),[A.FAILURE,"Storage entity missing"];if((((c=s.storedFood)==null?void 0:c.length)??0)>=(s.storageCapacity??0))return _.delete(o,Co),[A.FAILURE,"Storage full"];const u=j(t.position,s.position,i.gameState.mapDimensions.width,i.gameState.mapDimensions.height);return u<=_n?(t.activeAction="depositing",t.target=void 0,_.set(o,N0,i.gameState.time),_.delete(o,Co),[A.SUCCESS,"Depositing food"]):(t.activeAction="moving",t.target=s.position,[A.RUNNING,`Moving to storage (${u.toFixed(1)}px away)`])},"Navigate to Storage and Deposit",e+2),{taskType:"storage",maxCapacity:wS,storageAction:"deposit",getTargetId:(t,i,o)=>_.get(o,Co)??null},"Tribal Storage Deposit Task",e+1)],"Deposit Sequence",e)],"Storage Deposit Behavior",e)}const Jl="retrievalStorageId";function L1(e){return new nn([new Ae([new ae((t,i,o)=>{if(t.hunger<=Df)return[!1,"Not hungry enough"];if(t.food.length>=t.maxFood)return[!1,"Inventory full"];const a=A1(t,i.gameState),s=I1(t,a,i.gameState),u=s==null?void 0:s.storage;return u?(_.set(o,Jl,u.id),[!0,`Storage with food found at distance ${s.distance.toFixed(1)}`]):[!1,"No tribe storage with food nearby"]},"Check for Hunger and Storage Food",e+1),new lr(new ce((t,i,o)=>{const a=_.get(o,Jl);if(!a)return[A.FAILURE,"No storage target"];const s=i.gameState.entities.entities[a];if(!s)return _.delete(o,Jl),[A.FAILURE,"Storage not found"];const u=j(t.position,s.position,i.gameState.mapDimensions.width,i.gameState.mapDimensions.height);return u<=_n?(t.activeAction="retrieving",t.target=void 0,[A.SUCCESS,"Retrieving food"]):(t.activeAction="moving",t.target=s.position,[A.RUNNING,`Moving to storage (${u.toFixed(1)}px away)`])},"Navigate to Storage and Retrieve",e+2),{taskType:"storage",maxCapacity:wS,storageAction:"retrieve",getTargetId:(t,i,o)=>_.get(o,Jl)??null},"Coordinated Storage Retrieve",e+1)],"Retrieve Sequence",e)],"Storage Retrieve Behavior",e)}function U1(e){return new nn([new Ae([new ae((t,i,o)=>{var f;if(!t.isAdult)return[!1,"Not an adult"];if(t.food.length>=t.maxFood)return[!1,"Inventory full"];if(!t.leaderId)return[!1,"No tribe leader"];const a=i.gameState.entities.entities[t.leaderId];if(!a||!((f=a.tribeControl)!=null&&f.diplomacy))return[!1,"No diplomacy info"];const c=i.gameState.search.building.byRadius(t.position,150).find(g=>{var I;const m=g;if(m.buildingType!=="storageSpot"||!m.isConstructed||!m.storedFood||m.storedFood.length===0||m.ownerId===t.leaderId||((I=a.tribeControl)==null?void 0:I.diplomacy[m.ownerId])!==St.Hostile)return!1;const y=wn({leaderId:m.ownerId},i.gameState);for(const E of y)if(j(t.position,E.position,i.gameState.mapDimensions.width,i.gameState.mapDimensions.height)<=Lf)return!1;return!0});return c?[!0,`Undefended enemy storage found at distance ${j(t.position,c.position,i.gameState.mapDimensions.width,i.gameState.mapDimensions.height).toFixed(1)}`]:[!1,"No undefended enemy storage nearby"]},"Check for Undefended Enemy Storage",e+1),new ce((t,i,o)=>{var m;if(!t.leaderId)return[A.FAILURE,"No tribe leader"];const a=i.gameState.entities.entities[t.leaderId];if(!a||!((m=a.tribeControl)!=null&&m.diplomacy))return[A.FAILURE,"No diplomacy info"];const c=i.gameState.search.building.byRadius(t.position,150).filter(v=>{var T;const y=v;if(y.buildingType!=="storageSpot"||!y.isConstructed||!y.storedFood||y.storedFood.length===0||y.ownerId===t.leaderId||((T=a.tribeControl)==null?void 0:T.diplomacy[y.ownerId])!==St.Hostile)return!1;const E=wn({leaderId:y.ownerId},i.gameState);for(const w of E)if(j(t.position,w.position,i.gameState.mapDimensions.width,i.gameState.mapDimensions.height)<=Lf)return!1;return!0});if(c.length===0)return[A.FAILURE,"No undefended storage available"];let f=null,g=1/0;for(const v of c){const y=j(t.position,v.position,i.gameState.mapDimensions.width,i.gameState.mapDimensions.height);y<g&&(g=y,f=v)}return f?g<=_n?(t.activeAction="idle",t.target=void 0,[A.SUCCESS,"Stealing food"]):(t.activeAction="moving",t.target=f.position,[A.RUNNING,`Moving to enemy storage (${g.toFixed(1)}px away)`]):[A.FAILURE,"No storage found"]},"Navigate to Enemy Storage and Steal",e+1)],"Steal Sequence",e)],"Storage Steal Behavior",e)}const sf="enemiesNearby";function B1(e){const t=new ae(s=>s.id===s.leaderId,"Is Leader?",e+1),i=new ae(s=>!s.isCallingToAttack,"Is Not Already Calling?",e+1),o=new ce((s,u,c)=>{const f=ah(s,u.gameState,oS);return f.length>0?(_.set(c,sf,f.map(g=>g.id)),A.SUCCESS):A.FAILURE},"Find Nearby Enemies",e+1),a=new nn([new Ae([new ae((s,u,c)=>{const f=_.get(c,sf),g=f==null?void 0:f.map(I=>u.gameState.entities.entities[I]).filter(I=>!!I);if(!g||g.length===0)return!1;const m=jo(s.id,u.gameState),v=Cu(m),y=Cu(g);return v>y*XI},"Is Strong Enough?",e+3),new ce((s,u)=>(s.isCallingToAttack=!0,s.callToAttackEndTime=u.gameState.time+Xo,Me(u.gameState,fe.CallToAttack,s.position,Xo),we(u,ge.CallToAttack,s.position),s.activeAction="idle",s.target=void 0,A.SUCCESS),"Issue Call to Attack",e+3)],"Attack",e+2),new ce((s,u,c)=>{const f=_.get(c,sf),g=f==null?void 0:f.map(T=>u.gameState.entities.entities[T]).filter(T=>!!T);if(!g||g.length===0)return A.FAILURE;const m=g.map(T=>T.position),v=Iu(m),y=Ye(v,s.position,u.gameState.mapDimensions.width,u.gameState.mapDimensions.height),I=at(y),E=bn(s.position,Ot(I,Nv*2));return s.activeAction="moving",s.target={x:(E.x%u.gameState.mapDimensions.width+u.gameState.mapDimensions.width)%u.gameState.mapDimensions.width,y:(E.y%u.gameState.mapDimensions.height+u.gameState.mapDimensions.height)%u.gameState.mapDimensions.height},s.direction=I,A.SUCCESS},"Retreat",e+2)],"Attack or Retreat",e+2);return new Ae([t,i,o,new ur(KI,a,"Leader Combat Cooldown",e+1)],"Leader Combat Strategy",e)}const af="combatTarget",lf="homeCenter";function H1(e){const t=new ae(u=>u.isAdult&&u.leaderId?u.id!==u.leaderId:!1,"Is Tribe Follower?",e+1),i=new ae(u=>u.hunger<_I&&u.hitpoints>=u.maxHitpoints*Pv,"Is Fit for Combat?",e+1),o=new ae((u,c)=>{const f=c.gameState.entities.entities[u.leaderId];return!!(f!=null&&f.isCallingToAttack)},"Is Leader Calling to Attack?",e+1),a=new ce((u,c,f)=>{const{gameState:g}=c,m=g.entities.entities[u.leaderId];if(!m)return A.FAILURE;const v=ah(m,g,FI);if(v.length===0)return A.FAILURE;v.sort((y,I)=>{const E=j(u.position,y.position,g.mapDimensions.width,g.mapDimensions.height),T=j(u.position,I.position,g.mapDimensions.width,g.mapDimensions.height);return E-T});for(const y of v)if(rC(m.id,y.id,g)<LI){_.set(f,af,y.id);const E=Yr(m.id,g);return _.set(f,lf,E),A.SUCCESS}return A.FAILURE},"Find Best Target",e+1),s=new ce((u,c,f)=>{const g=_.get(f,af),m=g&&c.gameState.entities.entities[g],v=_.get(f,lf);if(!m||!v)return A.FAILURE;const{gameState:y}=c;return j(u.position,v,y.mapDimensions.width,y.mapDimensions.height)>Rv?(u.activeAction==="attacking"&&u.attackTargetId===m.id&&(u.activeAction="idle",u.attackTargetId=void 0),_.set(f,af,void 0),_.set(f,lf,void 0),A.FAILURE):((!u.lastTargetAcquiredEffectTime||c.gameState.time-u.lastTargetAcquiredEffectTime>$e*5)&&(Me(c.gameState,fe.TargetAcquired,u.position,$e,u.id),u.lastTargetAcquiredEffectTime=c.gameState.time),u.activeAction="attacking",u.attackTargetId=m.id,u.target=void 0,A.RUNNING)},"Attack Target",e+1);return new Ae([t,i,o,a,s],"Tribe Member Combat",e)}function b1(e,t,i,o,a,s,u){const c=u.mapDimensions.width,f=u.mapDimensions.height,g=Math.PI/8,v=i*2/(2*Math.PI);let y=0,I=0;for(;I<=t;){const E=e.x+I*Math.cos(y),T=e.y+I*Math.sin(y),w={x:(E%c+c)%c,y:(T%f+f)%f};if(mh(w,a,s,u)&&!uC(w,void 0,o,u))return w;y+=g,I=v*y}}class G1 extends rn{constructor(t){super(),this.name="Leader Building Placement",this.depth=t}execute(t,i,o){if(!t.leaderId||t.leaderId!==t.id)return[A.FAILURE,"Not a tribe leader"];const s=wn(t,i.gameState).filter(H=>H.isAdult);if(s.length<Ym)return[A.FAILURE,`Tribe too small: ${s.length}/${Ym} adults`];const u=Na(t.leaderId,i.gameState),c=vh(t,i.gameState),f=fS(t.leaderId,i.gameState),g=hS(t.leaderId,i.gameState),m=Math.ceil(s.length*(1+mE)),v=u.length===0,y=u.length<Xm&&(v||f>jm||f*(m/s.length)>jm),I=g*(s.length/m),E=c.length<Km&&(g<Vm||I<Vm);let T=null,w="";if(y&&E?v?(T=En.StorageSpot,w="Bootstrap: First storage spot for tribe"):f>.85?(T=En.StorageSpot,w=`High storage utilization: ${(f*100).toFixed(0)}% (projected: ${m} adults)`):(T=En.PlantingZone,w=`Low bush density: ${g.toFixed(1)} bushes/member (projected: ${I.toFixed(1)})`):y?v?(T=En.StorageSpot,w="Bootstrap: First storage spot for tribe"):(T=En.StorageSpot,w=`Storage utilization: ${(f*100).toFixed(0)}% (projected: ${m} adults)`):E&&(T=En.PlantingZone,w=`Bush density: ${g.toFixed(1)} bushes/member (projected: ${I.toFixed(1)} for ${m} adults)`),!T)return[A.FAILURE,`No building needed. Storage: ${u.length}/${Xm} (${(f*100).toFixed(0)}%), Planting: ${c.length}/${Km} (${g.toFixed(1)} bushes/member)`];const O=v?SE:vE,L=Yr(t.leaderId,i.gameState),N=b1(L,zm,pE,O,T,t.id,i.gameState);return N?(dS(N,T,t.id,i.gameState),[A.SUCCESS,`Placed ${T} at (${N.x.toFixed(0)}, ${N.y.toFixed(0)}). Reason: ${w}`]):[A.FAILURE,`No valid location found for ${T} within ${zm}px of tribe center`]}}function x1(e){return new G1(e)}const zi="takeOverBuildingTarget";function $1(e){const t=new Ae([new ae((i,o,a)=>{if(!i.leaderId||i.leaderId!==i.id)return[!1,"Not a tribe leader"];const s=_.get(a,zi);if(s){const c=o.gameState.entities.entities[s];if(c&&c.type==="building"&&Bn(i,c,o.gameState))return[!0,`Continuing to target building ${s}`];_.delete(a,zi)}const u=Oe(i,o.gameState,"building",Ov,c=>Bn(i,c,o.gameState)&&c.isConstructed);return u?(_.set(a,zi,u.id),[!0,`Found enemy building at distance ${j(i.position,u.position,o.gameState.mapDimensions.width,o.gameState.mapDimensions.height).toFixed(0)}px`]):[!1,"No enemy buildings found within range"]},"Find Enemy Building to Take Over",e+2),new ce((i,o,a)=>{const s=_.get(a,zi);if(!s)return A.FAILURE;const u=o.gameState.entities.entities[s];return!u||u.type!=="building"||!Bn(i,u,o.gameState)?(_.delete(a,zi),i.activeAction="idle",i.target=void 0,A.FAILURE):j(i.position,u.position,o.gameState.mapDimensions.width,o.gameState.mapDimensions.height)<yt?(i.activeAction="idle",i.target=void 0,A.SUCCESS):(i.activeAction="moving",i.target=u.id,A.RUNNING)},"Move to Enemy Building",e+2),new ce((i,o,a)=>{const s=_.get(a,zi);if(!s)return A.FAILURE;const u=o.gameState.entities.entities[s];return!u||u.type!=="building"||!Bn(i,u,o.gameState)?(_.delete(a,zi),A.FAILURE):(i.activeAction="takingOverBuilding",i.target=u.id,_.delete(a,zi),A.SUCCESS)},"Initiate Building Takeover",e+2)],"Take Over Building Action",e+1);return new ur(Dv,t,"Take Over Building Cooldown",e)}const Yi="removeEnemyBuildingTarget";function W1(e){const t=new Ae([new ae((i,o,a)=>{if(!i.leaderId||i.leaderId!==i.id)return[!1,"Not a tribe leader"];const s=_.get(a,Yi);if(s){const c=o.gameState.entities.entities[s];if(c&&c.type==="building"&&Bn(i,c,o.gameState))return[!0,`Continuing to target building ${s}`];_.delete(a,Yi)}const u=Oe(i,o.gameState,"building",Ov,c=>Bn(i,c,o.gameState)&&c.isConstructed);return u?(_.set(a,Yi,u.id),[!0,`Found enemy building at distance ${j(i.position,u.position,o.gameState.mapDimensions.width,o.gameState.mapDimensions.height).toFixed(0)}px`]):[!1,"No enemy buildings found within range"]},"Find Enemy Building to Destroy",e+2),new ce((i,o,a)=>{const s=_.get(a,Yi);if(!s)return A.FAILURE;const u=o.gameState.entities.entities[s];return!u||u.type!=="building"||!Bn(i,u,o.gameState)?(_.delete(a,Yi),i.activeAction="idle",i.target=void 0,A.FAILURE):j(i.position,u.position,o.gameState.mapDimensions.width,o.gameState.mapDimensions.height)<yt?(i.activeAction="idle",i.target=void 0,A.SUCCESS):(i.activeAction="moving",i.target=u.id,A.RUNNING)},"Move to Enemy Building",e+2),new ce((i,o,a)=>{const s=_.get(a,Yi);if(!s)return A.FAILURE;const u=o.gameState.entities.entities[s];return!u||u.type!=="building"||!Bn(i,u,o.gameState)?(_.delete(a,Yi),A.FAILURE):(i.activeAction="destroyingBuilding",i.target=u.id,_.delete(a,Yi),A.SUCCESS)},"Initiate Building Destruction",e+2)],"Remove Enemy Building Action",e+1);return new ur(Dv,t,"Remove Enemy Building Cooldown",e)}function z1(e){return new Ae([new ce((t,i,o)=>{const a=QE(t,i.gameState);return a?(_.set(o,"patriarchTarget",a.id),[A.SUCCESS,`Found patriarch: ${a.id}`]):(_.delete(o,"patriarchTarget"),[A.FAILURE,"No patriarch found"])},"Find Patriarch",e+1),new ce((t,i,o)=>{const a=_.get(o,"patriarchTarget"),s=a&&i.gameState.entities.entities[a];if(!s)return[A.FAILURE,"Patriarch target missing from blackboard"];const u=j(t.position,s.position,i.gameState.mapDimensions.width,i.gameState.mapDimensions.height);if(u>_v){t.activeAction="moving",t.target=s.id;const c=Ye(t.position,s.position,i.gameState.mapDimensions.width,i.gameState.mapDimensions.height);return t.direction=at(c),[A.RUNNING,`Moving to patriarch at ${u.toFixed(0)}`]}return t.activeAction="idle",t.target=void 0,t.direction={x:0,y:0},[A.SUCCESS,`Arrived at patriarch at ${u.toFixed(0)}`]},"Move Towards Patriarch",e+1)],"Follow Patriarch",e)}const eu="tribeSplitMigrationTarget";function Y1(e){const t=new Ae([new ae((i,o,a)=>{if(_.get(a,eu))return[!0,"Already migrating"];const{canSplit:u,progress:c}=Gu(i,o.gameState);return u?[!0,`Progress: ${(c??0)*100}%`]:[!1,"Cannot split"]},"Can Split Tribe?",e+2),new ce((i,o,a)=>{const{gameState:s}=o;let u=_.get(a,eu);if(!u){if(!i.leaderId)return A.FAILURE;const f=s.entities.entities[i.leaderId];if(!f)return A.FAILURE;const g=Gw(f.position,i,s);if(g)_.set(a,eu,g),u=g;else return A.FAILURE}return j(i.position,u,s.mapDimensions.width,s.mapDimensions.height)<zo?(_.delete(a,eu),i.activeAction="idle",i.target=void 0,A.SUCCESS):(i.activeAction="moving",i.target=u,A.RUNNING)},"Move to New Territory",e+2),new ce((i,o)=>(gh(i,o.gameState),A.SUCCESS),"Perform Tribe Split",e+2)],"Tribe Split Action",e+1);return new ur(yw,t,"Tribe Split Cooldown",e)}const tu="jealousyAttackTarget";function j1(e){return new Ae([new ae((t,i,o)=>{if(!t.isAdult)return[!1,"Not an adult"];const a=tC(t,i.gameState,ZI);return a?t.leaderId&&a.id===t.leaderId?[!1,"Stranger is in same tribe - no attack"]:(_.set(o,tu,a.id),[!0,`Partner cheating with ${a.id}`]):(_.delete(o,tu),!1)},"Check for Infidelity",e+1),new ce((t,i,o)=>{const a=_.get(o,tu),s=a&&i.gameState.entities.entities[a];return!s||s.hitpoints<=0?(_.delete(o,tu),[A.FAILURE,"Target is invalid or dead"]):t.activeAction==="attacking"&&t.attackTargetId===s.id?A.RUNNING:(t.activeAction="attacking",t.attackTargetId=s.id,[A.RUNNING,`Attacking ${s.id}`])},"Execute Jealousy Attack",e+1)],"Jealousy Attack",e)}const nu="defendAggressor";function V1(e){return new Ae([new ae((t,i,o)=>{if(!t.isAdult)return[!1,"Not an adult"];const a=nC(t,i.gameState,qI);return a?(_.set(o,nu,a.aggressor.id),[!0,`Family member ${a.familyMember.id} attacked by ${a.aggressor.id}`]):(_.delete(o,nu),!1)},"Check Family Under Attack",e+1),new ce((t,i,o)=>{const a=_.get(o,nu),s=a&&i.gameState.entities.entities[a];return!s||s.hitpoints<=0?(_.delete(o,nu),[A.FAILURE,"Target invalid/dead"]):t.activeAction==="attacking"&&t.attackTargetId===s.id?A.RUNNING:(t.activeAction="attacking",t.attackTargetId=s.id,[A.RUNNING,`Attacking aggressor ${s.id}`])},"Execute Family Defense Attack",e+1)],"Defend Family",e)}const iu="desperateAttackTarget";function X1(e){return new Ae([new ae(t=>t.hunger>QI,"Is Starving",e+1),new ae((t,i)=>{if(!t.isAdult)return[!1,"Not an adult"];const o=Oe(t,i.gameState,"berryBush",yt,s=>s.food.length>0),a=Oe(t,i.gameState,"corpse",yt,s=>s.food.length>0);return!o&&!a},"No Other Food Available",e+1),new ae((t,i,o)=>{const a=iC(t,i.gameState);return a?(_.set(o,iu,a.id),[!0,`Found weak target ${a.id}`]):(_.delete(o,iu),!1)},"Find Weak Target",e+1),new ce((t,i,o)=>{const a=_.get(o,iu),s=a&&i.gameState.entities.entities[a];return!s||s.hitpoints<=0?(_.delete(o,iu),[A.FAILURE,"Target is invalid or dead"]):t.activeAction==="attacking"&&t.attackTargetId===s.id?A.RUNNING:(t.activeAction="attacking",t.attackTargetId=s.id,[A.RUNNING,`Desperately attacking ${s.id}`])},"Execute Desperate Attack",e+1)],"Desperate Attack",e)}function K1(e,t,i,o){const a=e.entities.entities[i.targetEntityId];return!a||!("hitpoints"in a)||a.hitpoints<=0?(e.autopilotControls.activeAutopilotAction=void 0,A.FAILURE):j(t.position,a.position,e.mapDimensions.width,e.mapDimensions.height)<=mu?(t.activeAction="attacking",t.attackTargetId=a.id,e.autopilotControls.activeAutopilotAction=void 0,A.SUCCESS):(t.activeAction="moving",t.target=a.id,t.direction=Bt(t.position,a.position,e.mapDimensions),A.RUNNING)}function Z1(e){return new Ae([new ae((t,i)=>t.isPlayer===!0&&!!i.gameState.autopilotControls.activeAutopilotAction,"Has Player Command",e+1),new ce((t,i)=>{var s;const{gameState:o}=i,a=o.autopilotControls.activeAutopilotAction;if(!a)return A.FAILURE;switch(a.action){case ue.AutopilotMove:{const u=a.position;return j(t.position,u,o.mapDimensions.width,o.mapDimensions.height)<iE?(o.autopilotControls.activeAutopilotAction=void 0,t.activeAction==="moving"&&(t.activeAction="idle",t.target=void 0),A.SUCCESS):(t.activeAction="moving",t.target=u,t.direction=Bt(t.position,u,o.mapDimensions),A.RUNNING)}case ue.AutopilotGather:{const u=o.entities.entities[a.targetEntityId];return!u||u.food.length===0?(o.autopilotControls.activeAutopilotAction=void 0,A.FAILURE):j(t.position,u.position,o.mapDimensions.width,o.mapDimensions.height)>zo?(t.activeAction="moving",t.target=u.id,t.direction=Bt(t.position,u.position,o.mapDimensions),A.RUNNING):(t.activeAction="gathering",t.target=u.id,o.autopilotControls.activeAutopilotAction=void 0,A.SUCCESS)}case ue.AutopilotAttack:return K1(o,t,a);case ue.AutopilotProcreate:{const u=o.entities.entities[a.targetEntityId];return!u||u.type!=="human"||!jr(t,u,i.gameState)?(o.autopilotControls.activeAutopilotAction=void 0,A.FAILURE):j(t.position,u.position,o.mapDimensions.width,o.mapDimensions.height)<=mu?(t.activeAction="procreating",o.autopilotControls.activeAutopilotAction=void 0,A.SUCCESS):(t.activeAction="moving",t.target=u.id,t.direction=Bt(t.position,u.position,o.mapDimensions),A.RUNNING)}case ue.AutopilotPlant:{if(t.activeAction==="planting")return A.RUNNING;const u=a.position;return xn(u,o,xr,t.id)?(o.autopilotControls.activeAutopilotAction=void 0,A.FAILURE):j(t.position,u,o.mapDimensions.width,o.mapDimensions.height)<=mu?(t.activeAction="planting",t.target=u,o.autopilotControls.activeAutopilotAction=void 0,o.hasPlayerPlantedBush=!0,A.RUNNING):(t.activeAction="moving",t.target=u,t.direction=Bt(t.position,u,o.mapDimensions),A.RUNNING)}case ue.AutopilotFeedChild:{const u=o.entities.entities[a.targetEntityId];return!u||u.type!=="human"||u.isAdult||t.food.length===0?(o.autopilotControls.activeAutopilotAction=void 0,A.FAILURE):j(t.position,u.position,o.mapDimensions.width,o.mapDimensions.height)<=mu?(o.autopilotControls.activeAutopilotAction=void 0,t.activeAction="feeding",A.SUCCESS):(t.activeAction="moving",t.target=u.id,t.direction=Bt(t.position,u.position,o.mapDimensions),A.RUNNING)}case ue.AutopilotDeposit:{const u=o.entities.entities[a.targetEntityId];if(!u||u.buildingType!=="storageSpot"||!u.isConstructed)return o.autopilotControls.activeAutopilotAction=void 0,A.FAILURE;const c=u.storageCapacity??0;return(((s=u.storedFood)==null?void 0:s.length)??0)>=c||t.leaderId!==u.ownerId||t.food.length===0?(o.autopilotControls.activeAutopilotAction=void 0,A.FAILURE):j(t.position,u.position,o.mapDimensions.width,o.mapDimensions.height)<=_n?(t.activeAction="depositing",t.target=void 0,o.autopilotControls.activeAutopilotAction=void 0,A.SUCCESS):(t.activeAction="moving",t.target=u.id,t.direction=Bt(t.position,u.position,o.mapDimensions),A.RUNNING)}case ue.AutopilotRetrieve:{const u=o.entities.entities[a.targetEntityId];return!u||u.buildingType!=="storageSpot"||!u.isConstructed||!u.storedFood||u.storedFood.length===0||t.leaderId!==u.ownerId||t.food.length>=t.maxFood?(o.autopilotControls.activeAutopilotAction=void 0,A.FAILURE):j(t.position,u.position,o.mapDimensions.width,o.mapDimensions.height)<=_n?(t.activeAction="retrieving",t.target=void 0,o.autopilotControls.activeAutopilotAction=void 0,A.SUCCESS):(t.activeAction="moving",t.target=u.id,t.direction=Bt(t.position,u.position,o.mapDimensions),A.RUNNING)}case ue.AutopilotFollowMe:{const u=o.entities.entities[a.targetEntityId];return!u||u.type!=="human"||u.id!==u.leaderId?(o.autopilotControls.activeAutopilotAction=void 0,A.FAILURE):j(t.position,u.position,o.mapDimensions.width,o.mapDimensions.height)<=_v?(o.autopilotControls.activeAutopilotAction=void 0,t.activeAction==="moving"&&(t.activeAction="idle"),A.SUCCESS):(t.activeAction="moving",t.target=u.id,t.direction=Bt(t.position,u.position,o.mapDimensions),A.RUNNING)}default:return o.autopilotControls.activeAutopilotAction=void 0,A.FAILURE}},"Execute Player Command",e+1)],"Player Command Handler",e)}function q1(e){return new Ae([new ae(t=>!!t.leaderId&&t.leaderId!==t.id,"Is Follower",e+1),new ae((t,i)=>{if(!t.leaderId)return!1;const o=i.gameState.entities.entities[t.leaderId];return!!o&&o.isCallingToFollow===!0},"Is Leader Calling To Follow",e+1),new ae(t=>t.hunger<DI,"Is Not Critically Hungry",e+1),new ce((t,i)=>{if(!t.leaderId)return A.FAILURE;const o=i.gameState.entities.entities[t.leaderId];return o?j(t.position,o.position,i.gameState.mapDimensions.width,i.gameState.mapDimensions.height)>NI?(t.activeAction="moving",t.target=o.id,t.direction=Bt(t.position,o.position,i.gameState.mapDimensions),A.RUNNING):(t.activeAction==="moving"&&t.target===o.id&&(t.activeAction="idle",t.target=void 0),A.SUCCESS):A.FAILURE},"Execute Follow Leader",e+1)],"Follow Leader Command",e)}const D0="tribeMigrationCheckCooldown";function Q1(e){const t=new Ae([new ae(o=>!!o.leaderId&&o.leaderId===o.id,"Is Tribe Leader",e+2),new ae((o,a)=>{const s=_.get(o.aiBlackboard,D0);return s?a.gameState.time-s>=xm:!0},"Is Migration Check Cooldown Over",e+2),new ce((o,a)=>{o.aiBlackboard&&_.set(o.aiBlackboard,D0,a.gameState.time);const s=oC(o,a.gameState);return s?(o.isCallingToFollow=!0,o.callToFollowEndTime=a.gameState.time+ya,o.target=s,o.activeAction="moving",A.SUCCESS):A.FAILURE},"Execute Tribe Migration",e+2)],"Tribe Migration Strategy",e+1),i=new tr(t,sa,"Cache Tribe Migration",e+1);return new ur(xm,i,"Tribe Migration Cooldown",e)}function J1(e){const t=new ae(o=>o.id===o.leaderId,"Is Leader?",e+1),i=new ce((o,a)=>{var g,m,v,y;const{gameState:s}=a,u=jo(o.id,s),c=Cu(u),f=Gv(s).filter(I=>I.leaderId!==o.id);for(const I of f){const E=jo(I.leaderId,s),T=Cu(E),w=((m=(g=o.tribeControl)==null?void 0:g.diplomacy)==null?void 0:m[I.leaderId])||St.Friendly;c>T*VI?w!==St.Hostile&&((v=o.tribeControl)!=null&&v.diplomacy)&&(o.tribeControl.diplomacy[I.leaderId]=St.Hostile):w!==St.Friendly&&((y=o.tribeControl)!=null&&y.diplomacy)&&(o.tribeControl.diplomacy[I.leaderId]=St.Friendly)}return A.SUCCESS},"Evaluate Diplomacy",e+2);return new Ae([t,new ur(xI,i,"Diplomacy Cooldown",e+1)],"Manage Diplomacy",e)}const Ks="huntTarget";function eR(e){return new Ae([new tr(new ae((i,o,a)=>{if(!i.isAdult)return[!1,"Not an adult"];if(!i.leaderId)return[!1,"Not in a tribe"];const s=Oe(i.position,o.gameState,"prey",RI,()=>!0);return s?(_.set(a,Ks,s.id),[!0,"Found prey"]):[!1,"No suitable prey found"]},"Find Prey Target",e+2),GI,"Cache Find Prey",e+1),new lr(new Ru(new ce((i,o,a)=>{if(!i.leaderId)return A.FAILURE;const s=_.get(a,Ks);if(!s)return A.FAILURE;const u=o.gameState.entities.entities[s];if(!u||u.hitpoints<=0)return _.delete(a,Ks),i.activeAction="idle",i.attackTargetId=void 0,A.SUCCESS;const{gameState:c}=o,f=Yr(i.leaderId,c);return j(i.position,f,c.mapDimensions.width,c.mapDimensions.height)>PI?(_.delete(a,Ks),i.activeAction="idle",i.attackTargetId=void 0,A.FAILURE):(i.activeAction="attacking",i.attackTargetId=u.id,A.RUNNING)},"Hunt Prey Action",e+3),Of,"Hunt Prey Timeout",e+2),{taskType:"hunt",maxCapacity:Th,getTargetId:(i,o,a)=>_.get(a,Ks)??null},"Tribal Hunt Task",e+1)],"Human Hunt Prey Sequence",e)}const ru="defendTarget",uf=150;function tR(e){return new Ae([new ae((t,i,o)=>{if(!t.isAdult)return[!1,"Not an adult - children flee instead"];if(t.hitpoints<=t.maxHitpoints*.3)return[!1,"Too injured to defend"];const{gameState:a}=i;if(t.activeAction==="attacking"&&t.attackTargetId){const u=a.entities.entities[t.attackTargetId];if(u&&u.type==="predator"&&u.hitpoints>0&&j(t.position,u.position,a.mapDimensions.width,a.mapDimensions.height)<=uf)return _.set(o,ru,u.id),[!0,"Continuing defense"]}const s=Oe(t,a,"predator",uf,u=>u.hitpoints>0&&(u.isAdult||!1));if(s){const u=j(t.position,s.position,a.mapDimensions.width,a.mapDimensions.height),c=s.attackTargetId===t.id,f=u<80;if(c||f)return _.set(o,ru,s.id),[!0,"Predator threat detected"]}return _.set(o,ru,void 0),[!1,"No predator threat"]},"Detect Predator Threat",e+1),new ce((t,i,o)=>{const a=_.get(o,ru),s=a&&i.gameState.entities.entities[a];if(!s)return A.FAILURE;const{gameState:u}=i,c=j(t.position,s.position,u.mapDimensions.width,u.mapDimensions.height);return t.hitpoints<t.maxHitpoints*.3?A.FAILURE:s.hitpoints<=0||c>uf*1.5?(t.activeAction="idle",t.attackTargetId=void 0,A.SUCCESS):(t.activeAction="attacking",t.attackTargetId=s.id,A.RUNNING)},"Defend Against Predator",e+1)],"Human Defend Against Predator",e)}function nR(e){const t=new ce((i,o)=>{if(!i.leaderId)return A.FAILURE;const a=o.gameState.entities.entities[i.leaderId];if(!a||!a.tribeControl)return A.FAILURE;if(i.id===a.id)return i.tribeRole!==He.Leader&&(i.tribeRole=He.Leader),A.SUCCESS;const u=wn(a,o.gameState).filter(T=>T.id!==a.id),c=u.length;if(c===0)return A.SUCCESS;const f=a.tribeControl.roleWeights;let g=0;const m=[];for(const T of Object.values(He))T!==He.Leader&&(g+=f[T]||0,m.push(T));if(g===0)return i.tribeRole||(i.tribeRole=He.Gatherer),A.SUCCESS;const v={},y={},I={};for(const T of m)v[T]=0,y[T]=f[T]/g*c;for(const T of u)T.tribeRole&&T.tribeRole!==He.Leader&&(v[T.tribeRole]=(v[T.tribeRole]||0)+1);for(const T of m)I[T]=y[T]-v[T];let E=!1;if((!i.tribeRole||i.tribeRole===He.Leader||I[i.tribeRole]<-.5&&m.some(O=>I[O]>.5))&&(E=!0),E){let T=null,w=-1/0;const O=[...m].sort(()=>Math.random()-.5);for(const L of O){const N=I[L];N>w&&(w=N,T=L)}if(T)i.tribeRole=T;else{const L=Math.random()*g;let N=0;for(const H of m)if(N+=f[H],L<=N){i.tribeRole=H;break}}}return A.SUCCESS},"Assign Tribe Role",e+1);return new tr(t,sa,"Cache Tribe Role Assignment",e)}function iR(e){return new Ae([new ae((t,i,o)=>{const a=Oe(t,i.gameState,"predator",Vt*2,()=>!0),s=Oe(t,i.gameState,"human",Vt*2,()=>!0);let u=null,c=1/0;if(a){const f=j(t.position,a.position,i.gameState.mapDimensions.width,i.gameState.mapDimensions.height);f<c&&(c=f,u=a)}if(s){const f=j(t.position,s.position,i.gameState.mapDimensions.width,i.gameState.mapDimensions.height);f<c&&(c=f,u=s)}return u&&c<Vt*1.5?(_.set(o,"fleeThreat",u.id),_.set(o,"fleeDistance",c),!0):!1},"Detect Threat",e+1),new ce((t,i,o)=>{const a=_.get(o,"fleeThreat"),s=a&&i.gameState.entities.entities[a];if(!s)return A.FAILURE;t.activeAction="moving";const u=Ye(s.position,t.position,i.gameState.mapDimensions.width,i.gameState.mapDimensions.height),c=at(u),f=bn(t.position,Ot(c,k_));return t.target={x:(f.x%i.gameState.mapDimensions.width+i.gameState.mapDimensions.width)%i.gameState.mapDimensions.width,y:(f.y%i.gameState.mapDimensions.height+i.gameState.mapDimensions.height)%i.gameState.mapDimensions.height},t.direction=c,t.fleeCooldown=i.gameState.time+2,A.RUNNING},"Execute Flee",e+1)],"Prey Flee",e)}function rR(e){return new Ae([new ae((t,i,o)=>{if(!t.isAdult)return[!1,"Not an adult"];if(t.hunger<=30||t.eatingCooldownTime&&t.eatingCooldownTime>i.gameState.time)return!1;const a=Oe(t,i.gameState,"berryBush",Vt*10,s=>s.food.length>0);return a?j(t.position,a.position,i.gameState.mapDimensions.width,i.gameState.mapDimensions.height)<=Vt?(_.set(o,"grazingTarget",a.id),!0):(_.set(o,"grazingTarget",a.id),_.set(o,"needToMoveToTarget",!0),!0):!1},"Find Berry Bush",e+1),new ce((t,i,o)=>{const a=_.get(o,"grazingTarget"),s=a&&i.gameState.entities.entities[a],u=_.get(o,"needToMoveToTarget");if(!s)return A.FAILURE;const c=j(t.position,s.position,i.gameState.mapDimensions.width,i.gameState.mapDimensions.height);if(c<=Vt)return t.activeAction="grazing",t.target=s.id,t.direction={x:0,y:0},_.delete(o,"needToMoveToTarget"),A.RUNNING;if(u||c>Vt){t.activeAction="moving",t.target=s.id;const f=Bt(t.position,s.position,i.gameState.mapDimensions);return t.direction=f,A.RUNNING}return A.FAILURE},"Move to Bush or Graze",e+1)],"Prey Graze",e)}function oR(e){const t=new ae((s,u,c)=>{const f=Oe(s,u.gameState,"prey",Vt,g=>g.id!==s.id&&g.gender!==s.gender&&!!g.isAdult&&g.age>=da&&g.age<=ef&&!g.isPregnant&&(!g.procreationCooldown||g.procreationCooldown<=0)&&g.hunger<200);return f?(_.set(c,"procreationPartner",f.id),!0):!1},"Find Immediate Partner",e+2),i=new ce((s,u,c)=>{const f=_.get(c,"procreationPartner"),g=f&&u.gameState.entities.entities[f];return g?(s.activeAction="procreating",s.target=g.id,s.direction={x:0,y:0},_.delete(c,"procreationPartner"),A.SUCCESS):A.FAILURE},"Start Procreating",e+2),o=new ae((s,u,c)=>{const f=Oe(s,u.gameState,"prey",Vt*10,g=>g.id!==s.id&&g.gender!==s.gender&&!!g.isAdult&&g.age>=da&&g.age<=ef&&!g.isPregnant&&(!g.procreationCooldown||g.procreationCooldown<=0)&&g.hunger<200);return f?(_.set(c,"procreationPartner",f.id),!0):!1},"Locate Distant Partner",e+2),a=new ce((s,u,c)=>{const f=_.get(c,"procreationPartner"),g=f&&u.gameState.entities.entities[f];if(!g)return A.FAILURE;if(j(s.position,g.position,u.gameState.mapDimensions.width,u.gameState.mapDimensions.height)<=Vt)return A.SUCCESS;s.activeAction="moving",s.target=g.id;const v=Ye(s.position,g.position,u.gameState.mapDimensions.width,u.gameState.mapDimensions.height);return s.direction=at(v),A.RUNNING},"Move Towards Partner",e+2);return new Ae([new ae(s=>!!(s.isAdult&&!s.isPregnant&&s.age>=da&&s.age<=ef&&s.hunger<200&&(!s.procreationCooldown||s.procreationCooldown<=0)),"Is Fertile and Ready",e+1),new nn([new Ae([t,i],"Procreate With Immediate Partner",e+2),new Ae([o,a],"Seek Distant Partner",e+2)],"Find Partner And Procreate",e+1)],"Prey Procreate",e)}const sR=(e,t,i)=>{const o=t.gameState.search.prey.byProperty("motherId",e.id).filter(u=>!u.isAdult&&u.type==="prey");if(o.length===0)return A.FAILURE;let a=null,s=xu;for(const u of o)u.hunger>=s&&(s=u.hunger,a=u);return a?(_.set(i,"targetChild",a.id),A.SUCCESS):A.FAILURE},aR=(e,t,i)=>{const o=_.get(i,"targetChild"),a=o&&t.gameState.entities.entities[o];return a?j(e.position,a.position,t.gameState.mapDimensions.width,t.gameState.mapDimensions.height)>ns?(e.activeAction="moving",e.target=a.id,e.direction=Bt(e.position,a.position,t.gameState.mapDimensions),A.RUNNING):(e.activeAction="feeding",e.target=void 0,_.set(i,"targetChild",void 0),A.SUCCESS):A.FAILURE};function lR(e){return new Ae([new ae(t=>(t.isAdult&&t.gender==="female"&&t.hunger<80&&(!t.feedChildCooldownTime||t.feedChildCooldownTime<=0))??!1,"Can Feed Child (Female Only)",e+1),new ce(sR,"Find Hungriest Prey Child",e+1),new ce(aR,"Move To Child and Feed",e+1)],"Feed Prey Child",e)}function uR(e){return new Ae([new ae(t=>!t.isAdult&&t.hunger>=xu,"Is Hungry Prey Child",e+1),new ce((t,i,o)=>{if(!t.motherId)return A.FAILURE;const a=i.gameState.entities.entities[t.motherId];return a?(_.set(o,"targetParent",a.id),A.SUCCESS):A.FAILURE},"Find Female Parent",e+1),new ce((t,i,o)=>{const a=_.get(o,"targetParent"),s=a&&i.gameState.entities.entities[a];if(!s)return A.FAILURE;const u=j(t.position,s.position,i.gameState.mapDimensions.width,i.gameState.mapDimensions.height);return t.activeAction="idle",u<=ns?(t.target=void 0,A.SUCCESS):(t.target=s.id,t.activeAction="moving",A.RUNNING)},"Move To Female Parent",e+1)],"Seek Food From Female Parent",e)}const Zs="huntTarget";function cR(e,t,i){if(!(e!=null&&e.aiBlackboard))return!0;const o=`tribal_hunt_${t}`,a=_.get(e.aiBlackboard,o);return!a||i-a.startTime>Ko?!0:a.memberIds.length<(a.maxCapacity||Th)}function dR(e,t){if(!(e!=null&&e.aiBlackboard))return 0;const i=`tribal_hunt_${t}`,o=_.get(e.aiBlackboard,i);return(o==null?void 0:o.memberIds.length)??0}function fR(e){return new Ae([new ae((t,i,o)=>{if(!t.isAdult)return[!1,"Not an adult"];if(t.hunger<=50||t.huntCooldown&&t.huntCooldown>0)return!1;const a=Oe(t,i.gameState,"prey",No*10,s=>{if(s.hitpoints<=0)return!1;const u=wa(t,i.gameState);return!(u&&!cR(u,s.id,i.gameState.time))});if(a){const s=j(t.position,a.position,i.gameState.mapDimensions.width,i.gameState.mapDimensions.height),u=wa(t,i.gameState),c=u?dR(u,a.id):0;if(s<=No)return _.set(o,Zs,a.id),[!0,`Prey in range (${c} hunters)`];if(s<=No*10)return _.set(o,Zs,a.id),_.set(o,"needToApproach",!0),[!0,`Approaching prey (${c} hunters)`]}return!1},"Find Prey Target",e+1),new lr(new Ru(new ce((t,i,o)=>{const a=_.get(o,Zs),s=a&&i.gameState.entities.entities[a],u=_.get(o,"needToApproach");if(!s||s.hitpoints<=0)return _.delete(o,Zs),_.delete(o,"needToApproach"),A.SUCCESS;const c=j(t.position,s.position,i.gameState.mapDimensions.width,i.gameState.mapDimensions.height);if(c<=No)return t.activeAction="attacking",t.attackTargetId=s.id,t.target=s.id,t.direction={x:0,y:0},_.delete(o,"needToApproach"),A.RUNNING;if(u||c>No){t.activeAction="moving",t.target=s.id;const f=Ye(t.position,s.position,i.gameState.mapDimensions.width,i.gameState.mapDimensions.height);return t.direction=at(f),A.RUNNING}return A.FAILURE},"Hunt or Approach Prey",e+3),10,"Hunt Timeout (10 hour)",e+2),{taskType:"hunt",maxCapacity:Th,getTargetId:(t,i,o)=>_.get(o,Zs)},"Tribal Hunt Decorator",e+1)],"Predator Hunt",e)}function hR(e){return new Ae([new ae((t,i,o)=>{const a=t.hunger>100,s=t.hitpoints<t.maxHitpoints*.5;if(!a&&!s||t.attackCooldown&&t.attackCooldown>0)return!1;const u=Oe(t,i.gameState,"human",Un*2,c=>c.hitpoints>0);if(u){const c=j(t.position,u.position,i.gameState.mapDimensions.width,i.gameState.mapDimensions.height);if(c<=Un)return _.set(o,"attackTarget",u.id),!0;if(a&&c<=Un*2)return _.set(o,"attackTarget",u.id),_.set(o,"needToApproach",!0),!0}return!1},"Find Human Target",e+1),new ce((t,i,o)=>{const a=_.get(o,"attackTarget"),s=a&&i.gameState.entities.entities[a],u=_.get(o,"needToApproach");if(!s||s.hitpoints<=0)return A.FAILURE;const c=j(t.position,s.position,i.gameState.mapDimensions.width,i.gameState.mapDimensions.height);if(c<=Un)return t.activeAction="attacking",t.attackTargetId=s.id,t.target=s.id,t.direction={x:0,y:0},_.delete(o,"needToApproach"),A.RUNNING;if(u||c>Un){t.activeAction="moving",t.target=s.id;const f=Ye(t.position,s.position,i.gameState.mapDimensions.width,i.gameState.mapDimensions.height);return t.direction=at(f),A.RUNNING}return A.FAILURE},"Attack or Approach Human",e+1)],"Predator Attack Human",e)}function gR(e){const t=new ae((s,u,c)=>{const f=Oe(s,u.gameState,"predator",rr,g=>g.id!==s.id&&g.gender!==s.gender&&!!g.isAdult&&g.age>=fa&&g.age<=tf&&!g.isPregnant&&(!g.procreationCooldown||g.procreationCooldown<=0)&&g.hunger<200);return f?(_.set(c,"procreationPartner",f.id),!0):!1},"Find Immediate Partner",e+2),i=new ce((s,u,c)=>{const f=_.get(c,"procreationPartner"),g=f&&u.gameState.entities.entities[f];return g?(s.activeAction="procreating",s.target=g.id,s.direction={x:0,y:0},_.delete(c,"procreationPartner"),A.SUCCESS):A.FAILURE},"Start Procreating",e+2),o=new ae((s,u,c)=>{const f=Oe(s,u.gameState,"predator",rr*10,g=>g.id!==s.id&&g.gender!==s.gender&&!!g.isAdult&&g.age>=fa&&g.age<=tf&&!g.isPregnant&&(!g.procreationCooldown||g.procreationCooldown<=0)&&g.hunger<200);return f?(_.set(c,"procreationPartner",f.id),!0):!1},"Locate Distant Partner",e+2),a=new ce((s,u,c)=>{const f=_.get(c,"procreationPartner"),g=f&&u.gameState.entities.entities[f];if(!g)return A.FAILURE;if(j(s.position,g.position,u.gameState.mapDimensions.width,u.gameState.mapDimensions.height)<=rr)return A.SUCCESS;s.activeAction="moving",s.target=g.id;const v=Ye(s.position,g.position,u.gameState.mapDimensions.width,u.gameState.mapDimensions.height);return s.direction=at(v),A.RUNNING},"Move Towards Partner",e+2);return new Ae([new ae(s=>!!(s.isAdult&&!s.isPregnant&&s.age>=fa&&s.age<=tf&&s.hunger<200&&(!s.procreationCooldown||s.procreationCooldown<=0)),"Is Fertile and Ready",e+1),new nn([new Ae([t,i],"Procreate With Immediate Partner",e+2),new Ae([o,a],"Seek Distant Partner",e+2)],"Find Partner And Procreate",e+1)],"Predator Procreate",e)}const pR=(e,t,i)=>{const o=t.gameState.search.predator.byProperty("motherId",e.id).filter(u=>!u.isAdult&&u.type==="predator");if(o.length===0)return A.FAILURE;let a=null,s=xu;for(const u of o)u.hunger>=s&&(s=u.hunger,a=u);return a?(_.set(i,"targetChild",a.id),A.SUCCESS):A.FAILURE},mR=(e,t,i)=>{const o=_.get(i,"targetChild"),a=o&&t.gameState.entities.entities[o];return a?j(e.position,a.position,t.gameState.mapDimensions.width,t.gameState.mapDimensions.height)>ns?(e.activeAction="moving",e.target=a.id,e.direction=Bt(e.position,a.position,t.gameState.mapDimensions),A.RUNNING):(e.activeAction="feeding",e.target=void 0,_.set(i,"targetChild",void 0),A.SUCCESS):A.FAILURE};function vR(e){return new Ae([new ae(t=>(t.isAdult&&t.gender==="female"&&t.hunger<90&&(!t.feedChildCooldownTime||t.feedChildCooldownTime<=0))??!1,"Can Feed Child (Female Only)",e+1),new ce(pR,"Find Hungriest Predator Child",e+1),new ce(mR,"Move To Child and Feed",e+1)],"Feed Predator Child",e)}function SR(e){return new Ae([new ae(t=>!t.isAdult&&t.hunger>=xu,"Is Hungry Predator Child",e+1),new ce((t,i,o)=>{if(!t.motherId)return A.FAILURE;const a=i.gameState.entities.entities[t.motherId];return a?(_.set(o,"targetParent",a.id),A.SUCCESS):A.FAILURE},"Find Female Parent",e+1),new ce((t,i,o)=>{const a=_.get(o,"targetParent"),s=a&&i.gameState.entities.entities[a];if(!s)return A.FAILURE;const u=j(t.position,s.position,i.gameState.mapDimensions.width,i.gameState.mapDimensions.height);return t.activeAction="idle",u<=ns?(t.target=void 0,A.SUCCESS):(t.target=s.id,t.activeAction="moving",A.RUNNING)},"Move To Female Parent",e+1)],"Seek Food From Female Parent",e)}function PS(e){return new ce((t,i,o)=>{t.activeAction="idle";let a=_.get(o,"wanderTarget"),s=_.get(o,"wanderStartTime");const u=i.gameState.time;if(!a||!s||u-s>2){const c=Math.random()*2*Math.PI,f=50+Math.random()*100,g={x:Math.cos(c),y:Math.sin(c)},m=bn(t.position,Ot(g,f));a={x:(m.x%i.gameState.mapDimensions.width+i.gameState.mapDimensions.width)%i.gameState.mapDimensions.width,y:(m.y%i.gameState.mapDimensions.height+i.gameState.mapDimensions.height)%i.gameState.mapDimensions.height},_.set(o,"wanderTarget",a),_.set(o,"wanderStartTime",u)}if(a){t.target=a;let c=a.x-t.position.x,f=a.y-t.position.y;const g=i.gameState.mapDimensions.width,m=i.gameState.mapDimensions.height;Math.abs(c)>g/2&&(c=c>0?c-g:c+g),Math.abs(f)>m/2&&(f=f>0?f-m:f+m);const v=at({x:c,y:f});t.direction=v}return A.SUCCESS},"Animal Wander",e)}function yR(e){return new Ae([new ae((t,i,o)=>{if(t.hunger>90||t.hitpoints<t.maxHitpoints*.3||t.activeAction==="grazing"||t.activeAction==="procreating")return!1;const a=Object.values(i.gameState.entities.entities),s=[];for(const u of a)if(u.type==="prey"&&u.id!==t.id){const c=u;c.hitpoints>0&&c.isAdult&&j(t.position,c.position,i.gameState.mapDimensions.width,i.gameState.mapDimensions.height)<=Vt*5&&s.push(c)}if(s.length>=2){let u=0,c=0;for(const m of s)u+=m.position.x,c+=m.position.y;u/=s.length,c/=s.length;const f={x:u,y:c};if(j(t.position,f,i.gameState.mapDimensions.width,i.gameState.mapDimensions.height)>Vt*2)return _.set(o,"herdCenter",f),_.set(o,"herdSize",s.length),!0}return!1},"Find Herd",e+1),new ce((t,i,o)=>{const a=_.get(o,"herdCenter");if(!a)return A.FAILURE;if(j(t.position,a,i.gameState.mapDimensions.width,i.gameState.mapDimensions.height)>Vt*2){t.activeAction="moving",t.target=a;const u=Ye(t.position,a,i.gameState.mapDimensions.width,i.gameState.mapDimensions.height);return t.direction=at(u),A.RUNNING}else return t.activeAction="idle",t.direction={x:0,y:0},A.SUCCESS},"Join Herd",e+1)],"Prey Herd Behavior",e)}function TR(e){return new Ae([new ae((t,i,o)=>{if(t.hunger>100||t.hitpoints<t.maxHitpoints*.4||t.activeAction==="attacking"||t.activeAction==="procreating")return!1;const a=Oe(t,i.gameState,"predator",rr*4,s=>s.id!==t.id&&s.hitpoints>0&&s.isAdult&&t.fatherId!==void 0&&s.fatherId===t.fatherId&&s.age>=t.age||s.hitpoints>t.hitpoints);return a&&j(t.position,a.position,i.gameState.mapDimensions.width,i.gameState.mapDimensions.height)>rr*2?(_.set(o,"packLeader",a.id),!0):!1},"Find Pack Leader",e+1),new ce((t,i,o)=>{const a=_.get(o,"packLeader"),s=a&&i.gameState.entities.entities[a];if(!s||s.hitpoints<=0)return A.FAILURE;if(j(t.position,s.position,i.gameState.mapDimensions.width,i.gameState.mapDimensions.height)>rr*2){t.activeAction="moving",t.target=s.id;const c=Ye(t.position,s.position,i.gameState.mapDimensions.width,i.gameState.mapDimensions.height);return t.direction=at(c),A.RUNNING}else return t.activeAction="idle",t.direction={x:0,y:0},A.SUCCESS},"Follow Pack Leader",e+1)],"Predator Pack Behavior",e)}function AR(e){return new Ae([new ae((t,i,o)=>{if(!t.isAdult||t.hitpoints<t.maxHitpoints*.6||t.hunger>120||t.attackCooldown&&t.attackCooldown>0)return!1;const a=Oe(t,i.gameState,"predator",E0,s=>!!(s.id!==t.id&&s.hitpoints>0&&s.isAdult&&t.fatherId!==s.fatherId&&t.gender===s.gender&&t.fatherId!==void 0&&s.fatherId!==void 0));if(a){const s=j(t.position,a.position,i.gameState.mapDimensions.width,i.gameState.mapDimensions.height);if(s<=Un)return _.set(o,"territorialTarget",a.id),!0;if(s<=E0)return _.set(o,"territorialTarget",a.id),_.set(o,"needToApproach",!0),!0}return!1},"Find Territorial Rival",e+1),new ce((t,i,o)=>{const a=_.get(o,"territorialTarget"),s=a&&i.gameState.entities.entities[a],u=_.get(o,"needToApproach");if(!s||s.hitpoints<=0)return A.FAILURE;const c=j(t.position,s.position,i.gameState.mapDimensions.width,i.gameState.mapDimensions.height);if(c<=Un)return t.activeAction="attacking",t.attackTargetId=s.id,t.target=s.id,t.direction={x:0,y:0},_.delete(o,"needToApproach"),A.RUNNING;if(u||c>Un){t.activeAction="moving",t.target=s.id;const f=Ye(t.position,s.position,i.gameState.mapDimensions.width,i.gameState.mapDimensions.height);return t.direction=at(f),A.RUNNING}return A.FAILURE},"Territorial Fight or Approach",e+1)],"Predator Territorial Defense",e)}function IR(){const e=new nn([S1(2),V1(2),new tn(tR(2),"attack","Gated Defend Against Predator",2),new tn(j1(2),"attack","Gated Jealousy Attack",2),new tn(X1(2),"attack","Gated Desperate Attack",2),Z1(2),new h1(new g1(nR(4),"Role Assignment Success",3),"Role Assignment Gate",2),new To(B1(3),"Gated Leader Combat Strategy",2),new To(J1(3),"Gated Diplomacy",2),new To(new nn([new tr($1(5),sa,"Cache Take Over Building",4),new tr(W1(5),sa,"Cache Remove Enemy Building",4)],"Building Interaction Selector",3),"Gated Leader Building Interactions",2),new tn(new tr(x1(4),gE,"Cache Building Placement",3),"build","Gated Leader Building Placement",2),H1(2),new tn(U1(3),"attack","Gated Storage Steal",2),new tn(_1(3),"attack","Gated Attacking",2),v1(2),new tn(L1(3),"gathering","Gated Storage Retrieve",2),new Ru(new tn(E1(4),"gathering","Gated Gathering",3),Of,"Timeout Gathering",2),new tn(F1(3),"gathering","Gated Storage Deposit",2),new tn(N1(3),"feedChildren","Gated Feed Child",2),D1(2),new tn(w1(3),"procreation","Gated Procreation",2),new Ru(new tn(k1(4),"planting","Gated Planting",3),Of,"Timeout Planting",2),new tn(eR(3),"attack","Gated Hunt Prey",2),new tr(Y1(3),sa,"Cache Tribe Split",2),new To(Q1(3),"Gated Tribe Migration",2),new tn(q1(3),"followLeader","Gated Follow Leader",2),new To(z1(2),"Gated Follow Patriarch",2),new To(C1(2),"Gated Idle Wander",2)],"AI Root Selector",1);return new p1(e,"Manual Control Gate",0)}const NS=IR();function ER(e,t){e.aiBlackboard&&_.cleanupOldEntries(e.aiBlackboard,t.gameState.time);const i=wa(e,t.gameState);i&&i.id===e.id&&i.aiBlackboard&&m1(i,t.gameState.time);const o=performance.now();switch(e.aiType){case Oa.BehaviorTreeBased:default:yh(e,t,NS);break}t.gameState.performanceMetrics.currentBucket.aiUpdateTime+=performance.now()-o}function CR(){return new nn([iR(1),lR(1),uR(1),rR(1),oR(1),yR(1),PS(1)],"Prey Behavior Root",0)}function wR(){return new nn([fR(1),hR(1),vR(1),SR(1),AR(1),gR(1),TR(1),PS(1)],"Predator Behavior Root",0)}const DS=CR();function _R(e,t){e.aiBlackboard?yh(e,t,DS):(console.warn(`Behavior Tree AI ticked for prey ${e.id}, but the tree or blackboard was missing.`),e.activeAction="idle")}const OS=wR();function RR(e,t){e.aiBlackboard?yh(e,t,OS):(console.warn(`Behavior Tree AI ticked for predator ${e.id}, but the tree or blackboard was missing.`),e.activeAction="idle")}function PR(e,t){const{gameState:i,deltaTime:o}=t,a=o*(wt/_t);if(e.isBeingDestroyed){const s=Zw(e.buildingType);if(s>0?e.destructionProgress+=a/s:e.destructionProgress=1,e.destructionProgress>=1){rs(i.entities,e.id);return}}if(!e.isConstructed&&!e.isBeingDestroyed){const s=Kw(e.buildingType);s>0?e.constructionProgress+=a/s:e.constructionProgress=1,e.constructionProgress>=1&&(e.constructionProgress=1,e.isConstructed=!0)}}function NR(e,t){e.forces.push(Ot(e.velocity,-.1));const i=Ot(at(e.direction),e.acceleration);e.forces.push(i),e.debuffs.forEach(o=>{t.gameState.time-o.startTime<o.duration&&o.type==="slow"&&(e.velocity=Ot(e.velocity,.5))}),e.debuffs=e.debuffs.filter(o=>t.gameState.time-o.startTime<o.duration),e.velocity=bn(e.velocity,e.forces.reduce(bn,{x:0,y:0})),Yo(e.velocity)<.001&&(e.velocity={x:0,y:0}),e.position=bn(e.position,Ot(e.velocity,t.deltaTime)),e.position.x=(e.position.x%t.gameState.mapDimensions.width+t.gameState.mapDimensions.width)%t.gameState.mapDimensions.width,e.position.y=(e.position.y%t.gameState.mapDimensions.height+t.gameState.mapDimensions.height)%t.gameState.mapDimensions.height,e.forces=[],e.type==="human"?a1(e,t,t.deltaTime):e.type==="corpse"?l1(e,t):e.type==="prey"?u1(e,t,t.deltaTime):e.type==="predator"?c1(e,t,t.deltaTime):e.type==="building"&&PR(e,t),e.type==="human"&&ER(e,t),e.type==="prey"?_R(e,t):e.type==="predator"&&RR(e,t),e.stateMachine&&(e.stateMachine=s1(...e.stateMachine,{entity:e,updateContext:t}))}function DR(e){const t=e.gameState.entities;Object.values(t.entities).forEach(i=>{NR(i,e)})}function MS(){return{entities:{},nextEntityId:1}}function is(e,t,i){const o={id:e.nextEntityId++,type:t,velocity:{x:0,y:0},direction:{x:0,y:0},acceleration:0,forces:[],debuffs:[],...i};return e.entities[o.id]=o,o}function Ma(e,t,i){return is(e,"berryBush",{position:t,radius:Nf,food:Array.from({length:SI},()=>({type:Gn.Berry})).map(a=>({...a,id:e.nextEntityId++})),maxFood:vI,lifespan:TI,age:0,spreadRadius:Nf,timeSinceLastBerryRegen:0,timeSinceLastSpreadAttempt:0,timeSinceLastHarvest:0,stateMachine:[oa,{enteredAt:i,previousState:void 0}]})}function Ho(e,t,i,o,a=!1,s=EE,u=Fv,c,f,g=[],m,v){const y=s>=Jf;return is(e,"human",{position:t,radius:y?Rt:es,hunger:u,hitpoints:qm,maxHitpoints:qm,age:s,gender:o,isPlayer:a,food:[],maxFood:kv,maxAge:Sa,isAdult:y,isPregnant:!1,gestationTime:0,procreationCooldown:0,attackCooldown:0,motherId:c,fatherId:f,ancestorIds:g,stateMachine:[ft,{enteredAt:i,previousState:void 0}],leaderId:m,tribeBadge:v,aiType:Oa.BehaviorTreeBased,aiBlackboard:_.create()})}function Ah(e,t,i,o,a,s,u,c,f,g,m){let v,y;switch(u){case"human":v=Uv,y=Wr;break;case"prey":v=2,y=120;break;case"predator":v=4,y=140;break}return is(e,"corpse",{position:t,radius:a,gender:i,age:o,originalEntityId:s,originalEntityType:u,timeOfDeath:c,decayProgress:0,geneCode:m,food:[...Array.from({length:Math.max(v*Math.max(y-g,0)/y,0)},()=>({type:Gn.Meat})),...f].map(E=>({...E,id:e.nextEntityId++})),stateMachine:void 0})}function OR(e,t,i,o,a,s,u,c,f){return Ah(e,t,i,o,a,s,"human",u,c,f)}function MR(e,t,i,o,a,s,u,c){return Ah(e,t,i,o,a,s,"prey",u,[],0,c)}function kR(e,t,i,o,a,s,u,c){return Ah(e,t,i,o,a,s,"predator",u,[],0,c)}function FR(e,t,i){const o=t?i.gameState.entities.entities[t]:void 0,a=[...e.ancestorIds||[],e.id],s=o?[...o.ancestorIds||[],o.id]:[],u=[...a,...s],c=[...new Set(u)],f=c.slice(Math.max(c.length-yE,0)),g=Math.random()<.5?"male":"female",m=bn(e.position,{x:5,y:5}),v=Ho(i.gameState.entities,m,i.gameState.time,g,!1,0,Fv/2,e.id,t,f,(o==null?void 0:o.leaderId)??e.leaderId,(o==null?void 0:o.tribeBadge)??e.tribeBadge);return we(i,ge.Birth,e.position),v}function rs(e,t){return e.entities[t]?(delete e.entities[t],!0):!1}function Zo(e,t,i,o=M_,a=vS,s,u,c){const f=o>=da,g=Date.now();return is(e,"prey",{position:t,radius:f?Rt*.7:es*.7,hunger:a,hitpoints:A0,maxHitpoints:A0,age:o,maxAge:mS,gender:i,isAdult:f,isPregnant:!1,gestationTime:0,procreationCooldown:0,geneCode:s,motherId:u,fatherId:c,stateMachine:[Ln,{enteredAt:g,previousState:void 0}],aiType:Oa.BehaviorTreeBased,aiBlackboard:_.create()})}function qo(e,t,i,o=G_,a=yS,s,u,c){const f=o>=fa,g=Date.now();return is(e,"predator",{position:t,radius:f?Rt*.9:es*.9,hunger:a,hitpoints:I0,maxHitpoints:I0,age:o,maxAge:SS,gender:i,isAdult:f,isPregnant:!1,gestationTime:0,procreationCooldown:0,geneCode:s,motherId:u,fatherId:c,stateMachine:[jt,{enteredAt:g,previousState:void 0}],aiType:Oa.BehaviorTreeBased,aiBlackboard:_.create()})}function LR(e,t,i,o){const a=cS(i),s={position:t,radius:Math.max(a.width,a.height)/2,buildingType:i,ownerId:o,width:a.width,height:a.height,constructionProgress:0,destructionProgress:0,isConstructed:!1,isBeingDestroyed:!1};return is(e,"building",{...s,...i===En.StorageSpot&&{storedFood:[],storageCapacity:xw,lastDepositTime:0,lastRetrieveTime:0,lastStealTime:0}})}var Wt=(e=>(e.MOVE="MOVE",e.HUNGER="HUNGER",e.EAT="EAT",e.FIND_BUSH="FIND_BUSH",e.GATHER="GATHER",e.PROCREATE="PROCREATE",e.PLANT_BUSH="PLANT_BUSH",e.AUTOPILOT="AUTOPILOT",e.ANIMALS_INTRODUCTION="ANIMALS_INTRODUCTION",e.HUNT_PREY="HUNT_PREY",e.DEFEND_FROM_PREDATORS="DEFEND_FROM_PREDATORS",e))(Wt||{}),br=(e=>(e.HUNGER_BAR="HUNGER_BAR",e.FOOD_BAR="FOOD_BAR",e.COMMAND_BUTTONS="COMMAND_BUTTONS",e))(br||{}),zt=(e=>(e[e.FADING_IN=0]="FADING_IN",e[e.ACTIVE=1]="ACTIVE",e[e.FADING_OUT=2]="FADING_OUT",e[e.INACTIVE=3]="INACTIVE",e))(zt||{});const Uf={},Bf={},UR=[{key:Wt.MOVE,title:"Movement",text:"Use WASD or Arrow Keys to move your character around the world.",condition:e=>e.hasPlayerMovedEver||e.hasPlayerEnabledAutopilot>2,isCompleted:!1},{key:Wt.HUNGER,title:"Hunger",text:"Your character gets hungry over time. Watch the hunger bar!",condition:(e,t)=>t.hunger>TE,isCompleted:!1,minDisplayTime:h0,highlightedUIElements:[br.HUNGER_BAR]},{key:Wt.FIND_BUSH,title:"Find Food",text:"Look for berry bushes. They are your primary source of food.",condition:(e,t)=>!!Oe(t,e,"berryBush",yt*5,o=>o.food.length>0),getTargets:(e,t)=>{const i=[];for(const o of Object.values(e.entities.entities))o.type==="berryBush"&&o.food.length>0&&j(t.position,o.position,e.mapDimensions.width,e.mapDimensions.height)<500&&i.push(o);return i.map(o=>o.id)},isCompleted:!1,minDisplayTime:h0},{key:Wt.GATHER,title:"Gather Berries",text:"Get close to a bush and press 'E' to gather berries.",condition:(e,t)=>t.food.length>0,getTargets:(e,t)=>{const i=Oe(t,e,"berryBush",yt,o=>o.food.length>0);return i?[i.id]:[]},isCompleted:!1},{key:Wt.EAT,title:"Eat",text:"When you are hungry and have food, press 'F' to eat.",condition:(e,t)=>t.activeAction==="eating",isCompleted:!1,highlightedUIElements:[br.FOOD_BAR]},{key:Wt.PROCREATE,title:"Procreate",text:"Find a mate and press 'R' to start a family. This is how you continue your lineage.",condition:(e,t)=>hn(e,t).length>0,getTargets:(e,t)=>{const i=Oe(t,e,"human",yt,o=>jr(t,o,e));return i?[i.id]:[]},isCompleted:!1},{key:Wt.PLANT_BUSH,title:"Farming",text:"You can plant new berry bushes. Carry some berries and press 'B' to plant.",condition:(e,t)=>ph(e,t).some(o=>o.type===ue.Plant)||e.hasPlayerPlantedBush===!0,isCompleted:!1},{key:Wt.AUTOPILOT,title:"Autopilot!",text:"You can turn autopilot for specific actions, press Shift and click on the action button to enable it.",condition:e=>e.hasPlayerEnabledAutopilot>2,highlightedUIElements:[br.COMMAND_BUTTONS],isCompleted:!1},{key:Wt.ANIMALS_INTRODUCTION,title:"Wild Animals!",text:"Your world now has wild animals! Prey provide meat when hunted, but beware of predators that may attack.",condition:e=>Object.values(e.entities.entities).some(i=>i.type==="prey"||i.type==="predator"),isCompleted:!1,dependsOn:Wt.AUTOPILOT},{key:Wt.HUNT_PREY,title:"Hunt for Meat",text:"Click on prey animals to hunt them for meat. Hunting provides more food than gathering berries!",condition:(e,t)=>{const i=Oe(t,e,"prey",150);return t.hunger>40&&!!i},getTargets:(e,t)=>{const i=Oe(t,e,"prey",150);return i?[i.id]:[]},isCompleted:!1,dependsOn:Wt.ANIMALS_INTRODUCTION},{key:Wt.DEFEND_FROM_PREDATORS,title:"Predators",text:"Predators may attack when hungry! Click on them to fight back. Fighting together with family is more effective.",condition:(e,t)=>!!Oe(t,e,"predator",120),getTargets:(e,t)=>{const i=Oe(t,e,"predator",120);return i?[i.id]:[]},isCompleted:!1,dependsOn:Wt.HUNT_PREY}].map(e=>({...e,condition:e.condition?bR(e.condition):void 0,getTargets:e.getTargets?GR(e.getTargets):void 0}));function kS(){return{steps:UR.map(e=>({...e,isCompleted:!1}))}}function FS(){return{currentStepIndex:0,completedSteps:[],isActive:!0,transitionState:zt.FADING_IN,transitionAlpha:0,highlightedEntityIds:[],stepStartTime:null,activeUIHighlights:[]}}function BR(e){for(let t=0;t<e.tutorial.steps.length;t++){const i=e.tutorial.steps[t];if(!i.isCompleted)if(i.dependsOn){if(e.tutorialState.completedSteps.includes(i.dependsOn))return t}else return t}return null}function HR(e,t){const i=e.tutorialState;if(!i.isActive){i.transitionState=zt.INACTIVE,i.highlightedEntityIds=[],i.activeUIHighlights=[];return}const o=pt(e);if(!o){i.isActive=!1,i.transitionState=zt.INACTIVE,i.highlightedEntityIds=[],i.activeUIHighlights=[];return}const a=e.tutorial.steps[i.currentStepIndex];if(!a){i.isActive=!1,i.transitionState=zt.INACTIVE,i.highlightedEntityIds=[],i.activeUIHighlights=[];return}const s=1/ew;switch(i.transitionState){case zt.FADING_IN:i.stepStartTime===null&&(i.stepStartTime=e.time),i.transitionAlpha+=s*t,i.transitionAlpha>=1&&(i.transitionAlpha=1,i.transitionState=zt.ACTIVE);break;case zt.ACTIVE:{const f=e.time-(i.stepStartTime||e.time)>=(a.minDisplayTime||0),g=Uf[a.condition];g&&f&&g(e,o)&&(a.isCompleted=!0,i.completedSteps.includes(a.key)||i.completedSteps.push(a.key),i.transitionState=zt.FADING_OUT);break}case zt.FADING_OUT:if(i.transitionAlpha-=s*t,i.transitionAlpha<=0){i.transitionAlpha=0,i.stepStartTime=null;const c=BR(e);c!==null?(i.currentStepIndex=c,i.transitionState=zt.FADING_IN):(i.isActive=!1,i.transitionState=zt.INACTIVE)}break}if(i.transitionState!==zt.FADING_OUT&&i.transitionState!==zt.INACTIVE){const c=Bf[a.getTargets||""];c?i.highlightedEntityIds=[...c(e,o)]:i.highlightedEntityIds=[],a.highlightedUIElements?i.activeUIHighlights=[...a.highlightedUIElements]:i.activeUIHighlights=[]}else i.highlightedEntityIds=[],i.activeUIHighlights=[]}function bR(e){const t=`condition_${Object.keys(Uf).length+1}`;return Uf[t]=e,t}function GR(e){const t=`getTargets_${Object.keys(Bf).length+1}`;return Bf[t]=e,t}function xR(){const e=MS(),t=0;for(let v=0;v<wv;v++){const y={x:Math.random()*Xe,y:Math.random()*et};Ma(e,y,t)}const i=Xe/2,o=et/2,a=Ho(e,{x:i-25,y:o},t,"male",!0);Ho(e,{x:i+25,y:o},t,"female",!1);for(let v=0;v<5;v++){const y=v/5*Math.PI*2,I=Xe/2,E=et/2,T={x:i+Math.cos(y)*I,y:o+Math.sin(y)*E};Ho(e,{x:T.x,y:T.y},t,"male",!1),Ho(e,{x:T.x+50,y:T.y},t,"female",!1)}for(let v=0;v<IS;v++){const y={x:i+Xe*(Math.random()-Math.random()),y:o+et*(Math.random()-Math.random())};Zo(e,y,"male",void 0,void 0,Ea()),Zo(e,{x:y.x+20,y:y.y},"female",void 0,void 0,Ea())}const s={x:i+Xe*(Math.random()-Math.random()),y:o+et*(Math.random()-Math.random())};qo(e,s,"male",void 0,void 0,Ca()),qo(e,{x:s.x+20,y:s.y},"female",void 0,void 0,Ca());const u=[{id:"muteButton",action:ie.ToggleMute,currentWidth:vi,rect:{x:0,y:0,width:0,height:0},text:"",backgroundColor:"",textColor:Yt},{id:"pauseButton",action:ie.TogglePause,currentWidth:vi,rect:{x:0,y:0,width:0,height:0},text:"",backgroundColor:"",textColor:Yt},{id:"returnToIntroButton",action:ie.ReturnToIntro,currentWidth:vi,rect:{x:0,y:0,width:0,height:0},text:"EXIT",backgroundColor:"",textColor:Yt}],c=kS(),f=FS(),g={time:t,entities:e,mapDimensions:{width:Xe,height:et},generationCount:1,gameOver:!1,visualEffects:[],nextVisualEffectId:0,viewportCenter:{...a.position},isPaused:!1,exitConfirmation:"inactive",autopilotControls:{behaviors:{procreation:!1,planting:!1,gathering:!1,attack:!1,feedChildren:!0,followLeader:!1,build:!1},hoveredAutopilotAction:void 0,activeAutopilotAction:void 0,isManuallyMoving:!1},buildMenuOpen:!1,roleManagerOpen:!1,selectedBuildingType:null,selectedBuildingForRemoval:null,hasPlayerMovedEver:!1,hasPlayerPlantedBush:!1,hasPlayerEnabledAutopilot:0,masterVolume:lS,isMuted:!1,uiButtons:u,tutorial:c,tutorialState:f,debugPanel:dt.None,performanceMetrics:{currentBucket:{renderTime:0,worldUpdateTime:0,aiUpdateTime:0},history:[]},hoveredButtonId:void 0,mousePosition:{x:0,y:0},notifications:[{id:"welcome",type:Ta.Hello,message:"Welcome to the game!",duration:50,targetEntityIds:[a.id],highlightedEntityIds:[a.id],timestamp:0,isDismissed:!1,creationTime:Date.now()}],ecosystem:{preyGestationPeriod:Fr,preyProcreationCooldown:Lr,predatorGestationPeriod:Ur,predatorProcreationCooldown:Br,preyHungerIncreasePerHour:Ji,predatorHungerIncreasePerHour:er,berryBushSpreadChance:Ai},autosaveIntervalSeconds:5,lastAutosaveTime:Date.now()},m=Nu(g);return console.log("Game world initialized:",m),m}function $R(){const e=MS(),t=0;for(let u=0;u<wv;u++){const c={x:Math.random()*Xe,y:Math.random()*et};Ma(e,c,t)}for(let u=0;u<gI;u++){const c={x:Math.random()*Xe,y:Math.random()*et},f=Math.random()<.5?"male":"female";Ho(e,c,t,f,!1)}for(let u=0;u<IS;u++){const c={x:Math.random()*Xe,y:Math.random()*et};Zo(e,c,"male",void 0,void 0,Ea()),Zo(e,{x:c.x+20,y:c.y},"female",void 0,void 0,Ea())}const i={x:Math.random()*Xe,y:Math.random()*et};qo(e,i,"male",void 0,void 0,Ca()),qo(e,{x:i.x+20,y:i.y},"female",void 0,void 0,Ca());const o=kS(),a=FS(),s={time:t,entities:e,mapDimensions:{width:Xe,height:et},generationCount:0,gameOver:!1,visualEffects:[],nextVisualEffectId:0,viewportCenter:{x:Xe/2,y:et/2},isPaused:!1,exitConfirmation:"inactive",autopilotControls:{behaviors:{procreation:!1,planting:!1,gathering:!1,attack:!1,feedChildren:!0,followLeader:!1,build:!1},hoveredAutopilotAction:void 0,activeAutopilotAction:void 0,isManuallyMoving:!1},buildMenuOpen:!1,roleManagerOpen:!1,selectedBuildingType:null,selectedBuildingForRemoval:null,hasPlayerMovedEver:!1,hasPlayerPlantedBush:!1,hasPlayerEnabledAutopilot:0,masterVolume:lS,isMuted:!0,uiButtons:[],tutorial:o,tutorialState:a,debugPanel:dt.None,performanceMetrics:{currentBucket:{renderTime:0,worldUpdateTime:0,aiUpdateTime:0},history:[]},hoveredButtonId:void 0,mousePosition:{x:0,y:0},notifications:[],ecosystem:{preyGestationPeriod:Fr,preyProcreationCooldown:Lr,predatorGestationPeriod:Ur,predatorProcreationCooldown:Br,preyHungerIncreasePerHour:Ji,predatorHungerIncreasePerHour:er,berryBushSpreadChance:Ai},lastAutosaveTime:0};return Nu(s)}const WR="humanProcreation",zR="human",YR="human",jR=yt,VR=(e,t,i)=>jr(e,t,i.gameState)?e.gender==="male"?e.activeAction==="procreating":e.activeAction==="procreating"&&t.activeAction==="procreating":!1,XR=(e,t,i)=>{var f,g;const{gameState:o}=i,a={x:(e.position.x+t.position.x)/2,y:(e.position.y+t.position.y)/2},s=e.gender==="male"?e:t,u=e.gender==="female"?e:t,c=(s.partnerIds||[]).length===0;if(e.stateMachine=[Ia,{partnerId:t.id,previousState:(f=e.stateMachine)==null?void 0:f[0]}],t.stateMachine=[Ia,{partnerId:e.id,previousState:(g=t.stateMachine)==null?void 0:g[0]}],e.partnerIds||(e.partnerIds=[]),e.partnerIds.includes(t.id)||e.partnerIds.push(t.id),t.partnerIds||(t.partnerIds=[]),t.partnerIds.includes(e.id)||t.partnerIds.push(e.id),c&&s.leaderId&&s.leaderId!==s.id){const m=o.entities.entities[s.leaderId];if(m){const v=Jm(s,m),y=Jm(u,m);if(!v&&!y){const I=kf();s.leaderId=s.id,s.tribeBadge=I,s.tribeRole=He.Leader,s.tribeControl={roleWeights:{gatherer:1,hunter:1,mover:1,warrior:1,leader:0},diplomacy:{}},u.leaderId=s.id,u.tribeBadge=I}}}else if(!e.leaderId&&!t.leaderId&&s&&u){const m=kf();s.leaderId=s.id,s.tribeBadge=m,s.tribeRole=He.Leader,s.tribeControl={roleWeights:{gatherer:1,hunter:1,mover:1,warrior:1,leader:0},diplomacy:{}},u.leaderId=s.id,u.tribeBadge=m}e.activeAction=void 0,Me(o,fe.Procreation,a,Mr),Me(o,fe.Partnered,e.position,$e,e.id),Me(o,fe.Partnered,t.position,$e,t.id),e.lastPartneredEffectTime=o.time,t.lastPartneredEffectTime=o.time,t.activeAction=void 0,we(i,ge.Procreate,a)},KR={id:WR,sourceType:zR,targetType:YR,maxDistance:jR,checker:VR,perform:XR},ZR={id:"humanChildFeeding",sourceType:"human",targetType:"human",maxDistance:th,checker:(e,t)=>e.isAdult===!0&&e.food.length>0&&(!e.feedChildCooldownTime||e.feedChildCooldownTime<=0)&&t.isAdult===!1&&(t.motherId===e.id||t.fatherId===e.id)&&t.hunger>=sr&&e.activeAction==="feeding",perform:(e,t,i)=>{e.food.pop(),t.hunger=Math.max(0,t.hunger-sr),e.feedChildCooldownTime=OE,(!t.lastChildFedEffectTime||i.gameState.time-t.lastChildFedEffectTime>2)&&(Me(i.gameState,fe.ChildFed,t.position,$e,t.id),t.lastChildFedEffectTime=i.gameState.time),we(i,ge.ChildFed,t.position)}},qR={id:"human-attack",sourceType:"human",targetType:"human",maxDistance:ri,checker:(e,t,i)=>{var s;if(((s=e.stateMachine)==null?void 0:s[0])!==ar||e.attackTargetId!==t.id||(e.attackCooldown||0)>0)return!1;const o=e.stateMachine[1];return i.gameState.time-o.attackStartTime>=Bv},perform:(e,t,i)=>{const o=Ye(e.position,t.position,i.gameState.mapDimensions.width,i.gameState.mapDimensions.height),a=VE(at(o),t.direction);if(Math.abs(a)<WE*Math.PI/180&&Math.random()<zE)Me(i.gameState,fe.AttackDeflected,t.position,$e,t.id);else{let c=ih;e.gender==="male"&&(c*=GE),e.isAdult||(c*=xE),(!t.isAdult||t.age>=nh)&&e.isAdult&&(c*=$E),t.hitpoints-=c,t.movementSlowdown={modifier:rh,endTime:i.gameState.time+oh},Me(i.gameState,fe.Hit,t.position,$e,t.id);const g=Ye(e.position,t.position,i.gameState.mapDimensions.width,i.gameState.mapDimensions.height),m=Ot(g,BE);t.forces.push(m),t.hitpoints<=0?we(i,ge.HumanDeath,t.position):we(i,ge.Attack,e.position)}e.attackCooldown=Bu;const u=e.stateMachine[1];u.attackStartTime=i.gameState.time,Me(i.gameState,fe.Attack,e.position,$e,e.id)}},QR={id:"human-collision",sourceType:"human",targetType:"human",maxDistance:Rt*2,checker:(e,t,{gameState:i})=>j(e.position,t.position,i.mapDimensions.width,i.mapDimensions.height)<(e.radius+t.radius)/3,perform:(e,t,{gameState:i})=>{const o=j(e.position,t.position,i.mapDimensions.width,i.mapDimensions.height);if(o===0){e.forces.push({x:.1,y:0}),t.forces.push({x:-.1,y:0});return}const s=(e.radius+t.radius-o)*.05,u=at(Hv(e.position,t.position)),c=Ot(u,s);e.forces.push(c),t.forces.push(Ot(c,-1))}},JR={id:"humanBerryBushGather",sourceType:"human",targetType:"berryBush",maxDistance:yt,checker:(e,t,i)=>{var o;return e.isAdult&&t.food.length>0&&((o=e.stateMachine)==null?void 0:o[0])===Da&&e.food.length<e.maxFood&&(!e.gatheringCooldownTime||e.gatheringCooldownTime<i.gameState.time)||!1},perform:(e,t,i)=>{const o=t.food.pop();o&&e.food.push(o),e.gatheringCooldownTime=i.gameState.time+1,t.timeSinceLastHarvest=i.gameState.time,Me(i.gameState,fe.BushClaimed,t.position,$e),we(i,ge.Gather,e.position)}},eP={id:"corpseGather",sourceType:"human",targetType:"corpse",maxDistance:yt,checker:(e,t,i)=>{var o;return e.isAdult&&t.food.length>0&&((o=e.stateMachine)==null?void 0:o[0])===Da&&e.food.length<e.maxFood&&(!e.gatheringCooldownTime||e.gatheringCooldownTime<i.gameState.time)||!1},perform:(e,t,i)=>{const o=t.food.pop();o&&e.food.push(o),e.gatheringCooldownTime=i.gameState.time+1,we(i,ge.Gather,e.position)}},tP=[JR,eP],nP={id:"prey-eat-berry-bush",sourceType:"prey",targetType:"berryBush",maxDistance:Vt,checker:(e,t,i)=>!!(e.isAdult&&t.food.length>0&&e.hunger>30&&(!e.eatingCooldownTime||e.eatingCooldownTime<i.gameState.time)),perform:(e,t,i)=>{t.food.pop()&&(e.hunger=Math.max(0,e.hunger-25),t.lifespan-=L_,t.timeSinceLastHarvest=i.gameState.time,e.eatingCooldownTime=i.gameState.time+F_,Me(i.gameState,fe.BushClaimed,t.position,$e,e.id),we(i,ge.Gather,e.position))}},iP={id:"predator-hunt-prey",sourceType:"predator",targetType:"prey",maxDistance:No,checker:(e,t,i)=>!!(e.isAdult&&e.hunger>50&&(!e.huntCooldown||e.huntCooldown<=0)&&t.hitpoints>0),perform:(e,t,i)=>{t.hitpoints-=x_;const o=Ye(e.position,t.position,i.gameState.mapDimensions.width,i.gameState.mapDimensions.height),a=Ot(o,8);t.forces.push(a),e.huntCooldown=z_,t.hitpoints<=0?(we(i,ge.HumanDeath,t.position),Me(i.gameState,fe.Hit,t.position,$e,t.id)):(Me(i.gameState,fe.Hit,t.position,$e,t.id),t.fleeCooldown=5,we(i,ge.Attack,e.position)),Me(i.gameState,fe.Attack,e.position,$e,e.id)}},rP={id:"human-hunt-prey",sourceType:"human",targetType:"prey",maxDistance:ri,checker:(e,t,i)=>{var o;return!!(((o=e.stateMachine)==null?void 0:o[0])===ar&&e.attackTargetId===t.id&&(!e.attackCooldown||e.attackCooldown<=0)&&t.hitpoints>0&&e.isAdult)},perform:(e,t,i)=>{let o=ih*1.2;e.gender==="male"&&(o*=1.3),t.hitpoints-=o;const a=Ye(e.position,t.position,i.gameState.mapDimensions.width,i.gameState.mapDimensions.height),s=Ot(a,6);t.forces.push(s),e.attackCooldown=Bu,t.hitpoints<=0?(we(i,ge.HumanDeath,t.position),Me(i.gameState,fe.Hit,t.position,$e,t.id)):(Me(i.gameState,fe.Hit,t.position,$e,t.id),t.fleeCooldown=8,we(i,ge.Attack,e.position)),Me(i.gameState,fe.Attack,e.position,$e,e.id)}},oP={id:"predator-attack-human",sourceType:"predator",targetType:"human",maxDistance:Un,checker:(e,t,i)=>{var o;return!!(e.isAdult&&(!e.attackCooldown||e.attackCooldown<=0)&&t.hitpoints>0&&(e.hunger>100||t.attackTargetId===e.id||t.attackTargetId&&((o=i.gameState.entities.entities[t.attackTargetId])==null?void 0:o.type)==="predator"))},perform:(e,t,i)=>{let o=TS;e.hunger>120&&(o*=1.3),t.hitpoints-=o,t.movementSlowdown={modifier:rh,endTime:i.gameState.time+oh};const a=Ye(e.position,t.position,i.gameState.mapDimensions.width,i.gameState.mapDimensions.height),s=Ot(a,7);t.forces.push(s),e.attackCooldown=AS,t.hitpoints<=0?(e.hunger=Math.max(0,e.hunger-Sh),we(i,ge.HumanDeath,t.position),Me(i.gameState,fe.Hit,t.position,$e,t.id)):(Me(i.gameState,fe.Hit,t.position,$e,t.id),we(i,ge.Attack,e.position)),Me(i.gameState,fe.Attack,e.position,$e,e.id)}},sP={id:"human-attack-predator",sourceType:"human",targetType:"predator",maxDistance:ri,checker:(e,t,i)=>{var o;return!!(((o=e.stateMachine)==null?void 0:o[0])===ar&&e.attackTargetId===t.id&&(!e.attackCooldown||e.attackCooldown<=0)&&t.hitpoints>0&&e.isAdult)},perform:(e,t,i)=>{let o=ih*.8;e.gender==="male"&&(o*=1.2);const a=Object.values(i.gameState.entities.entities).filter(c=>c.type==="human"&&c.id!==e.id).filter(c=>{const f=c;return Math.sqrt(Math.pow(f.position.x-e.position.x,2)+Math.pow(f.position.y-e.position.y,2))<100&&f.activeAction==="attacking"&&f.attackTargetId===t.id}).length;a>0&&(o*=1+a*.2),t.hitpoints-=o;const s=Ye(e.position,t.position,i.gameState.mapDimensions.width,i.gameState.mapDimensions.height),u=Ot(s,8);t.forces.push(u),e.attackCooldown=Bu,t.hitpoints<=0?(we(i,ge.HumanDeath,t.position),Me(i.gameState,fe.Hit,t.position,$e,t.id)):(Me(i.gameState,fe.Hit,t.position,$e,t.id),t.hitpoints<t.maxHitpoints*.3&&(t.hunger+=20),we(i,ge.Attack,e.position)),Me(i.gameState,fe.Attack,e.position,$e,e.id)}},aP={id:"prey-procreation",sourceType:"prey",targetType:"prey",maxDistance:Vt,checker:(e,t,i)=>!!(e.isAdult&&t.isAdult&&e.gender!==t.gender&&e.id!==t.id&&!e.isPregnant&&!t.isPregnant&&e.hunger<200&&t.hunger<200&&(!e.procreationCooldown||e.procreationCooldown<=0)&&(!t.procreationCooldown||t.procreationCooldown<=0)),perform:(e,t,i)=>{const o=e.gender==="female"?e:t;o.isPregnant=!0,o.gestationTime=i.gameState.ecosystem.preyGestationPeriod,e.procreationCooldown=i.gameState.ecosystem.preyProcreationCooldown,t.procreationCooldown=i.gameState.ecosystem.preyProcreationCooldown,Me(i.gameState,fe.Procreation,o.position,$e,o.id),we(i,ge.Procreate,o.position)}},lP={id:"predator-procreation",sourceType:"predator",targetType:"predator",maxDistance:rr,checker:(e,t,i)=>!!(e.isAdult&&t.isAdult&&e.gender!==t.gender&&e.id!==t.id&&!e.isPregnant&&!t.isPregnant&&e.hunger<200&&t.hunger<200&&(!e.procreationCooldown||e.procreationCooldown<=0)&&(!t.procreationCooldown||t.procreationCooldown<=0)),perform:(e,t,i)=>{const o=e.gender==="female"?e:t;o.isPregnant=!0,o.pregnancyFatherId=e.gender==="male"?e.id:t.id,o.gestationTime=i.gameState.ecosystem.predatorGestationPeriod,e.procreationCooldown=i.gameState.ecosystem.predatorProcreationCooldown,t.procreationCooldown=i.gameState.ecosystem.predatorProcreationCooldown,Me(i.gameState,fe.Procreation,o.position,$e,o.id),we(i,ge.Procreate,o.position)}},uP={id:"preyChildFeeding",sourceType:"prey",targetType:"prey",maxDistance:ns,checker:(e,t)=>e.isAdult===!0&&e.gender==="female"&&e.hunger<80&&(!e.feedChildCooldownTime||e.feedChildCooldownTime<=0)&&t.isAdult===!1&&(t.motherId===e.id||t.fatherId===e.id)&&t.hunger>=_u&&e.activeAction==="feeding",perform:(e,t,i)=>{e.hunger=Math.min(120,e.hunger+10),t.hunger=Math.max(0,t.hunger-_u),e.feedChildCooldownTime=ES,(!t.lastChildFedEffectTime||i.gameState.time-t.lastChildFedEffectTime>2)&&(Me(i.gameState,fe.ChildFed,t.position,$e,t.id),t.lastChildFedEffectTime=i.gameState.time),we(i,ge.ChildFed,t.position)}},cP={id:"predatorChildFeeding",sourceType:"predator",targetType:"predator",maxDistance:ns,checker:(e,t)=>e.isAdult===!0&&e.gender==="female"&&e.hunger<90&&(!e.feedChildCooldownTime||e.feedChildCooldownTime<=0)&&t.isAdult===!1&&(t.motherId===e.id||t.fatherId===e.id)&&t.hunger>=_u&&e.activeAction==="feeding",perform:(e,t,i)=>{e.hunger=Math.min(140,e.hunger+15),t.hunger=Math.max(0,t.hunger-_u),e.feedChildCooldownTime=ES,(!t.lastChildFedEffectTime||i.gameState.time-t.lastChildFedEffectTime>2)&&(Me(i.gameState,fe.ChildFed,t.position,$e,t.id),t.lastChildFedEffectTime=i.gameState.time),we(i,ge.ChildFed,t.position)}},dP={id:"predator-eat-corpse",sourceType:"predator",targetType:"corpse",maxDistance:rr,checker:(e,t,i)=>!!(e.isAdult&&e.hunger>30&&t.food.length>0&&(!e.eatingCooldownTime||e.eatingCooldownTime<=i.gameState.time)),perform:(e,t,i)=>{t.food.pop()&&(e.hunger=Math.max(0,e.hunger-Sh),e.eatingCooldownTime=i.gameState.time+2,Me(i.gameState,fe.Eating,e.position,$e,e.id),we(i,ge.Gather,e.position))}},fP={id:"predator-attack-rival",sourceType:"predator",targetType:"predator",maxDistance:Un,checker:(e,t,i)=>{var o;return!!(e.isAdult&&(!e.attackCooldown||e.attackCooldown<=0)&&t.hitpoints>0&&(e.hunger>100||t.attackTargetId===e.id||t.attackTargetId&&((o=i.gameState.entities.entities[t.attackTargetId])==null?void 0:o.type)==="predator"))},perform:(e,t,i)=>{let o=TS;e.hunger>120&&(o*=1.3),t.hitpoints-=o,t.movementSlowdown={modifier:rh,endTime:i.gameState.time+oh};const a=Ye(e.position,t.position,i.gameState.mapDimensions.width,i.gameState.mapDimensions.height),s=Ot(a,7);t.forces.push(s),e.attackCooldown=AS,t.hitpoints<=0?(e.hunger=Math.max(0,e.hunger-Sh),we(i,ge.HumanDeath,t.position),Me(i.gameState,fe.Hit,t.position,$e,t.id)):(Me(i.gameState,fe.Hit,t.position,$e,t.id),we(i,ge.Attack,e.position)),Me(i.gameState,fe.Attack,e.position,$e,e.id)}},hP={id:"storageDeposit",sourceType:"human",targetType:"building",maxDistance:_n,checker:(e,t,i)=>{var s;if(t.buildingType!=="storageSpot"||((s=e.stateMachine)==null?void 0:s[0])!==ua||!t.isConstructed||e.food.length===0)return!1;t.storedFood||(t.storedFood=[]);const o=t.storageCapacity??0;return!(t.storedFood.length>=o||e.leaderId!==t.ownerId||i.gameState.time-(t.lastDepositTime??0)<$w)},perform:(e,t,i)=>{t.storedFood||(t.storedFood=[]);const o=e.food.pop();o&&t.storedFood.push({item:o,positionOffset:RS(t)}),t.lastDepositTime=i.gameState.time,we(i,ge.StorageDeposit,t.position)}},gP={id:"storageRetrieve",sourceType:"human",targetType:"building",maxDistance:_n,checker:(e,t,i)=>{var a;return!(t.buildingType!=="storageSpot"||((a=e.stateMachine)==null?void 0:a[0])!==ca||!t.isConstructed||!t.storedFood||t.storedFood.length===0||e.food.length>=e.maxFood||e.leaderId!==t.ownerId||i.gameState.time-(t.lastRetrieveTime??0)<Ww)},perform:(e,t,i)=>{if(!t.storedFood||t.storedFood.length===0)return;const o=t.storedFood.pop();o&&(e.food.push(o.item),RS(t)),t.lastRetrieveTime=i.gameState.time,we(i,ge.StorageRetrieve,t.position)}},pP={id:"storageSteal",sourceType:"human",targetType:"building",maxDistance:_n,checker:(e,t,i)=>{var c,f;if(t.buildingType!=="storageSpot"||((c=e.stateMachine)==null?void 0:c[0])!==Da||!t.isConstructed||!t.storedFood||t.storedFood.length===0||e.food.length>=e.maxFood||e.leaderId===t.ownerId)return!1;const o=e.leaderId?i.gameState.entities.entities[e.leaderId]:void 0;if(!o||!((f=o.tribeControl)!=null&&f.diplomacy)||o.tribeControl.diplomacy[t.ownerId]!==St.Hostile||i.gameState.time-(t.lastStealTime??0)<zw)return!1;const u=wn({leaderId:t.ownerId},i.gameState);for(const g of u)if(j(e.position,g.position,i.gameState.mapDimensions.width,i.gameState.mapDimensions.height)<=Lf)return!1;return!0},perform:(e,t,i)=>{if(!t.storedFood||t.storedFood.length===0)return;const o=t.storedFood.pop();o&&e.food.push(o.item),t.lastStealTime=i.gameState.time,we(i,ge.StorageSteal,t.position),Me(i.gameState,fe.Attack,t.position,.5)}},mP={id:"human-takeover-building",sourceType:"human",targetType:"building",maxDistance:20,checker:(e,t,i)=>e.leaderId!==e.id||e.activeAction!=="takingOverBuilding"?!1:Bn(e,t,i.gameState),perform:(e,t,i)=>{t.ownerId=e.id,t.constructionProgress=1,t.isConstructed=!0,t.isBeingDestroyed=!1,t.destructionProgress=0,e.activeAction="idle",Me(i.gameState,fe.BushClaimed,t.position,2,t.id)}},vP={id:"human-remove-enemy-building",sourceType:"human",targetType:"building",maxDistance:20,checker:(e,t,i)=>!(e.leaderId!==e.id||e.activeAction!=="destroyingBuilding"||!Bn(e,t,i.gameState)||t.isBeingDestroyed),perform:(e,t,i)=>{t.isBeingDestroyed=!0,e.activeAction="idle",Me(i.gameState,fe.Hit,t.position,1,t.id)}},SP=[QR,...tP,KR,ZR,qR,hP,gP,pP,mP,vP,nP,uP,cP,dP,iP,rP,sP,oP,fP,aP,lP];function yP(e){const{gameState:t}=e,i=t,o=Object.values(t.entities.entities);for(const a of SP)for(const s of o){if(a.sourceType&&s.type!==a.sourceType)continue;const u=i.search[a.targetType].byRadius(s.position,a.maxDistance);for(const c of u){if(s.id===c.id)continue;j(s.position,c.position,t.mapDimensions.width,t.mapDimensions.height)<=a.maxDistance&&a.checker(s,c,e)&&a.perform(s,c,e)}}}function TP(e){e.visualEffects=e.visualEffects.filter(t=>e.time-t.startTime<=t.duration)}function AP(e){const t=e.search.berryBush.byProperty("type","berryBush"),i=e.search.predator.byProperty("type","predator"),o=e.search.human.byProperty("type","human");for(let a=0;a<20;a++){let s;if(t.length>0&&a<15){const f=t[Math.floor(Math.random()*t.length)],g=Math.random()*2*Math.PI,m=50+Math.random()*100;s={x:Math.max(50,Math.min(Xe-50,f.position.x+Math.cos(g)*m)),y:Math.max(50,Math.min(et-50,f.position.y+Math.sin(g)*m))}}else s={x:50+Math.random()*(Xe-100),y:50+Math.random()*(et-100)};let u=!0;const c=100;for(const f of i)if(Math.sqrt((s.x-f.position.x)**2+(s.y-f.position.y)**2)<c){u=!1;break}if(u){for(const f of o)if(Math.sqrt((s.x-f.position.x)**2+(s.y-f.position.y)**2)<c){u=!1;break}}if(u)return s}return{x:Xe*.3+Math.random()*Xe*.4,y:et*.3+Math.random()*et*.4}}function IP(e){const t=e.search.prey.byProperty("type","prey"),i=e.search.human.byProperty("type","human");for(let a=0;a<15;a++){let s;if(t.length>0&&a<10){const f=t[Math.floor(Math.random()*t.length)],g=Math.random()*2*Math.PI,m=100+Math.random()*150;s={x:Math.max(50,Math.min(Xe-50,f.position.x+Math.cos(g)*m)),y:Math.max(50,Math.min(et-50,f.position.y+Math.sin(g)*m))}}else s={x:50+Math.random()*(Xe-100),y:50+Math.random()*(et-100)};let u=!0;const c=150;for(const f of i)if(Math.sqrt((s.x-f.position.x)**2+(s.y-f.position.y)**2)<c){u=!1;break}if(u)return s}switch(Math.floor(Math.random()*4)){case 0:return{x:Math.random()*Xe,y:50+Math.random()*100};case 1:return{x:Xe-150+Math.random()*100,y:Math.random()*et};case 2:return{x:Math.random()*Xe,y:et-150+Math.random()*100};default:return{x:50+Math.random()*100,y:Math.random()*et}}}function EP(e){const t=e.search.human.byProperty("type","human"),i=e.search.berryBush.byProperty("type","berryBush");for(let o=0;o<20;o++){const a={x:50+Math.random()*(Xe-100),y:50+Math.random()*(et-100)};let s=!0;const u=80,c=60;for(const f of t)if(Math.sqrt((a.x-f.position.x)**2+(a.y-f.position.y)**2)<u){s=!1;break}if(s){for(const f of i)if(Math.sqrt((a.x-f.position.x)**2+(a.y-f.position.y)**2)<c){s=!1;break}}if(s)return a}return{x:Math.random()*Xe,y:Math.random()*et}}function LS(e,t=4){console.log(` Respawning ${t} prey to prevent extinction`);const i=e;for(let o=0;o<t;o++){const a=AP(i),s=o%2===0?"male":"female";Zo(e.entities,a,s,void 0,void 0,Ea())}}function US(e,t=2){console.log(` Respawning ${t} predators to prevent extinction`);const i=e;for(let o=0;o<t;o++){const a=IP(i),s=o%2===0?"male":"female";qo(e.entities,a,s,void 0,void 0,Ca())}}function CP(e){const t=e,i=t.search.prey.count(),o=t.search.predator.count();let a=!1;return i===0&&(LS(e,6),a=!0),o===0&&(US(e,3),a=!0),a}function wP(e){const t=e,i=t.search.prey.count(),o=t.search.predator.count(),a=t.search.berryBush.count();let s=!1;if(i>0&&i<5){const u=Math.max(2,Math.floor(8-i));LS(e,u),s=!0}if(o>0&&o<2){const u=Math.max(1,Math.floor(3-o));US(e,u),s=!0}if(a<5){console.log(` Boosting bush count from ${a} to help ecosystem`);for(let u=0;u<5;u++){const c=EP(t);Ma(e.entities,c,e.time)}s=!0}return s}const _P=1,RP=.3,PP=.8,O0=.8,NP=.99,DP=.05;var BS=(e=>(e[e.INCREASE_PREY_GESTATION=0]="INCREASE_PREY_GESTATION",e[e.DECREASE_PREY_GESTATION=1]="DECREASE_PREY_GESTATION",e[e.INCREASE_PREY_PROCREATION_COOLDOWN=2]="INCREASE_PREY_PROCREATION_COOLDOWN",e[e.DECREASE_PREY_PROCREATION_COOLDOWN=3]="DECREASE_PREY_PROCREATION_COOLDOWN",e[e.INCREASE_PREY_HUNGER=4]="INCREASE_PREY_HUNGER",e[e.DECREASE_PREY_HUNGER=5]="DECREASE_PREY_HUNGER",e[e.INCREASE_PREDATOR_GESTATION=6]="INCREASE_PREDATOR_GESTATION",e[e.DECREASE_PREDATOR_GESTATION=7]="DECREASE_PREDATOR_GESTATION",e[e.INCREASE_PREDATOR_PROCREATION_COOLDOWN=8]="INCREASE_PREDATOR_PROCREATION_COOLDOWN",e[e.DECREASE_PREDATOR_PROCREATION_COOLDOWN=9]="DECREASE_PREDATOR_PROCREATION_COOLDOWN",e[e.INCREASE_PREDATOR_HUNGER=10]="INCREASE_PREDATOR_HUNGER",e[e.DECREASE_PREDATOR_HUNGER=11]="DECREASE_PREDATOR_HUNGER",e[e.INCREASE_BUSH_SPREAD=12]="INCREASE_BUSH_SPREAD",e[e.DECREASE_BUSH_SPREAD=13]="DECREASE_BUSH_SPREAD",e[e.NO_ACTION=14]="NO_ACTION",e))(BS||{});const cf=Object.keys(BS).length/2;class OP{constructor(){Pe(this,"qTable",new Map);Pe(this,"epsilon",O0);Pe(this,"lastState",null);Pe(this,"lastAction",null)}discretizeState(t,i,o){const a=Math.min(4,Math.floor(t/25)),s=Math.min(4,Math.floor(i/5)),u=Math.min(4,Math.floor(o/15));return`${a}-${s}-${u}`}getQValue(t,i){return this.qTable.has(t)||this.qTable.set(t,new Map),this.qTable.get(t).get(i)||0}setQValue(t,i,o){this.qTable.has(t)||this.qTable.set(t,new Map),this.qTable.get(t).set(i,o)}getBestAction(t){let i=0,o=this.getQValue(t,0);for(let a=1;a<cf;a++){const s=this.getQValue(t,a);s>o&&(o=s,i=a)}return i}chooseAction(t){return Math.random()<this.epsilon?Math.floor(Math.random()*cf):this.getBestAction(t)}applyEmergencyCorrections(t,i,o,a){t<Si*.5&&(a.ecosystem.preyGestationPeriod=Math.max(Mo,a.ecosystem.preyGestationPeriod*.8),a.ecosystem.preyProcreationCooldown=Math.max(ko,a.ecosystem.preyProcreationCooldown*.8),a.ecosystem.preyHungerIncreasePerHour=Math.max(Uo,a.ecosystem.preyHungerIncreasePerHour*.9)),i<yi*.6&&(a.ecosystem.predatorGestationPeriod=Math.max(Fo,a.ecosystem.predatorGestationPeriod*.75),a.ecosystem.predatorProcreationCooldown=Math.max(Lo,a.ecosystem.predatorProcreationCooldown*.75),a.ecosystem.predatorHungerIncreasePerHour=Math.max(Bo,a.ecosystem.predatorHungerIncreasePerHour*.85)),o<Ti*.5&&(a.ecosystem.berryBushSpreadChance=Math.min(ea,a.ecosystem.berryBushSpreadChance*1.2)),t>Si*1.4&&(a.ecosystem.preyHungerIncreasePerHour=Math.min(Ji,a.ecosystem.preyHungerIncreasePerHour*1.05)),i>yi*1.4&&(a.ecosystem.predatorHungerIncreasePerHour=Math.min(er,a.ecosystem.predatorHungerIncreasePerHour*1.05)),o>Ti*1.4&&(a.ecosystem.berryBushSpreadChance=Math.max(Ai,a.ecosystem.berryBushSpreadChance*.95))}calculateReward(t,i,o){const a=Math.abs(t-Si),s=Math.abs(i-yi),u=Math.abs(o-Ti),c=a/Si,f=s/yi,g=u/Ti,m=c+f+g;return 100*Math.exp(-m*2)-50}applyAction(t,i){switch(t){case 0:i.ecosystem.preyGestationPeriod=Math.min(Fr,i.ecosystem.preyGestationPeriod+.2*(Fr-Mo));break;case 1:i.ecosystem.preyGestationPeriod=Math.max(Mo,i.ecosystem.preyGestationPeriod-.2*(Fr-Mo));break;case 2:i.ecosystem.preyProcreationCooldown=Math.min(Lr,i.ecosystem.preyProcreationCooldown+.2*(Lr-ko));break;case 3:i.ecosystem.preyProcreationCooldown=Math.max(ko,i.ecosystem.preyProcreationCooldown-.2*(Lr-ko));break;case 4:i.ecosystem.preyHungerIncreasePerHour=Math.min(Ji,i.ecosystem.preyHungerIncreasePerHour+.2*(Ji-Uo));break;case 5:i.ecosystem.preyHungerIncreasePerHour=Math.max(Uo,i.ecosystem.preyHungerIncreasePerHour-.2*(Ji-Uo));break;case 6:i.ecosystem.predatorGestationPeriod=Math.min(Ur,i.ecosystem.predatorGestationPeriod+.2*(Ur-Fo));break;case 7:i.ecosystem.predatorGestationPeriod=Math.max(Fo,i.ecosystem.predatorGestationPeriod-.2*(Ur-Fo));break;case 8:i.ecosystem.predatorProcreationCooldown=Math.min(Br,i.ecosystem.predatorProcreationCooldown+.2*(Br-Lo));break;case 9:i.ecosystem.predatorProcreationCooldown=Math.max(Lo,i.ecosystem.predatorProcreationCooldown-.2*(Br-Lo));break;case 10:i.ecosystem.predatorHungerIncreasePerHour=Math.min(er,i.ecosystem.predatorHungerIncreasePerHour+.2*(er-Bo));break;case 11:i.ecosystem.predatorHungerIncreasePerHour=Math.max(Bo,i.ecosystem.predatorHungerIncreasePerHour-.2*(er-Bo));break;case 12:i.ecosystem.berryBushSpreadChance=Math.min(ea,i.ecosystem.berryBushSpreadChance+.2*(ea-Ai));break;case 13:i.ecosystem.berryBushSpreadChance=Math.max(Ai,i.ecosystem.berryBushSpreadChance-.2*(ea-Ai));break}}updateQTable(t,i,o,a){const s=this.getQValue(t,i),u=Math.max(...Array.from({length:cf},(f,g)=>this.getQValue(a,g))),c=s+RP*(o+PP*u-s);this.setQValue(t,i,c)}step(t){const i=t,o=i.search.prey.count(),a=i.search.predator.count(),s=i.search.berryBush.count();this.applyEmergencyCorrections(o,a,s,t);const u=this.discretizeState(o,a,s);if(this.lastState!==null&&this.lastAction!==null){const f=this.calculateReward(o,a,s);this.updateQTable(this.lastState,this.lastAction,f,u)}const c=this.chooseAction(u);this.applyAction(c,t),this.epsilon=Math.max(DP,this.epsilon*NP),this.lastState=u,this.lastAction=c}reset(){this.qTable.clear(),this.epsilon=O0,this.lastState=null,this.lastAction=null}getStats(){return{qTableSize:this.qTable.size,explorationRate:this.epsilon}}}let HS=new OP;function MP(e){CP(e),wP(e),e.ecosystem.lastUpdateTime||(e.ecosystem.preyGestationPeriod=Mo+(Fr-Mo)*.3,e.ecosystem.preyProcreationCooldown=ko+(Lr-ko)*.3,e.ecosystem.preyHungerIncreasePerHour=Uo+(Ji-Uo)*.3,e.ecosystem.predatorGestationPeriod=Fo+(Ur-Fo)*.3,e.ecosystem.predatorProcreationCooldown=Lo+(Br-Lo)*.3,e.ecosystem.predatorHungerIncreasePerHour=Bo+(er-Bo)*.3,e.ecosystem.berryBushSpreadChance=Ai+(ea-Ai)*.7),HS.step(e)}function kP(e){e.ecosystem.lastUpdateTime||(e.ecosystem.lastUpdateTime=0),!(e.time-e.ecosystem.lastUpdateTime<_P)&&(e.ecosystem.lastUpdateTime=e.time,MP(e))}function FP(){return HS.getStats()}function LP(e,t){e.selectedBuildingType&&e.selectedBuildingType!=="removal"&&(e.autopilotControls.activeAutopilotAction=void 0,e.autopilotControls.hoveredAutopilotAction=void 0)}const UP=1/60;function BP(e,t){const i=pt(e);i&&(e.viewportCenter=sh(e.viewportCenter,i.position,qf*t))}function $u(e,t){if(e.isPaused)return e;if(e.autosaveIntervalSeconds){const i=Date.now();i-e.lastAutosaveTime>e.autosaveIntervalSeconds*1e3&&(Wf(e),e.lastAutosaveTime=i)}for(;t>0;){const i=Nu(e),o=Math.min(t,UP),a=o*(wt/_t);i.time+=a,BP(i,o),Rw(i),kP(i),Pw(i),DR({gameState:i,deltaTime:o}),yP({gameState:i,deltaTime:o}),TP(i),HR(i,o),LP(i),e=i,t-=o}return e}function df(e,t,i){e.save();const{x:o,y:a,width:s,height:u}=t.rect,c=Xv;if(e.beginPath(),e.moveTo(o+c,a),e.lineTo(o+s-c,a),e.quadraticCurveTo(o+s,a,o+s,a+c),e.lineTo(o+s,a+u-c),e.quadraticCurveTo(o+s,a+u,o+s-c,a+u),e.lineTo(o+c,a+u),e.quadraticCurveTo(o,a+u,o,a+u-c),e.lineTo(o,a+c),e.quadraticCurveTo(o,a,o+c,a),e.closePath(),e.fillStyle=t.isDisabled?Kv:t.backgroundColor,e.fill(),t.activated){e.save();const f=(Math.sin(Date.now()/1e3*Jv)+1)/2;e.strokeStyle=Qv,e.lineWidth=2+f*2,e.globalAlpha=.7+f*.3,e.stroke(),e.restore()}if(t.lastActivated){const f=Date.now()-t.lastActivated;if(f<wu){const g=1-f/wu;e.fillStyle=qv,e.globalAlpha=g,e.fill(),e.globalAlpha=1}}i&&!t.isDisabled&&(e.fillStyle=ch,e.globalAlpha=.5,e.fill(),e.globalAlpha=1),e.fillStyle=t.isDisabled?Zv:t.textColor,t.icon?(e.font=`${u*.55}px "Press Start 2P", Arial`,e.textAlign="center",e.textBaseline="middle",e.fillText(t.icon,o+s/2,a+u/2),t.text&&(e.font=`${u*.18}px "Press Start 2P", Arial`,e.textAlign="right",e.textBaseline="bottom",e.fillText(t.text,o+s-4,a+u-2))):(e.textAlign="center",e.textBaseline="middle",e.fillText(t.text,o+s/2,a+u/2)),e.restore()}function HP(e,t,i,o){e.save(),e.font=`${s0}px "Press Start 2P", Arial`,e.textAlign="center",e.textBaseline="bottom";const s=e.measureText(i).width,u=s0,c=s+a0*2,f=u+a0*2,g=o.x-c/2,m=e.canvas.height,v=t.y<m/2?t.y+t.height-l0:t.y-f+l0;e.fillStyle=FC,e.fillRect(g,v,c,f),e.fillStyle=LC,e.fillText(i,o.x,v+f/2+u/2),e.restore()}function bP(e,t,i){e.save();const o=pt(t),a=[{id:"fastForwardButton",action:ie.FastForward,text:"FFWD [T]",currentWidth:vi*1.3,backgroundColor:Zi,textColor:Yt,tooltip:"Fast-forward time",rect:{x:0,y:0,width:0,height:0}},{id:"pauseButton",action:ie.TogglePause,text:t.isPaused?"UN[P]AUSE":"[P]AUSE",backgroundColor:t.isPaused?Vl:Zi,currentWidth:t.isPaused?vi*1.4:vi*1.1,tooltip:t.isPaused?"Resume Game":"Pause Game",rect:{x:0,y:0,width:0,height:0},textColor:Yt},{id:"muteButton",action:ie.ToggleMute,text:t.isMuted?"UN[M]UTE":"[M]UTE",backgroundColor:t.isMuted?Vl:Zi,tooltip:`Toggle Sound (${t.isMuted?"Muted":"Enabled"})`,currentWidth:vi,rect:{x:0,y:0,width:0,height:0},textColor:Yt},{id:"returnToIntroButton",action:ie.ReturnToIntro,text:"EXIT",backgroundColor:Zi,tooltip:"Return to Main Menu [ESC]",currentWidth:vi*.9,rect:{x:0,y:0,width:0,height:0},textColor:Yt}];if(t.uiButtons.push(...a),o){const g=ph(t,o),m=new Set(g.map(L=>L.type));let v=[{playerAction:ue.Gather,buttonAction:ie.CommandGather,shortcut:"E",name:"Gather",toggleKey:"gathering",condition:()=>o.isAdult===!0},{playerAction:ue.Eat,buttonAction:ie.CommandEat,shortcut:"F",name:"Eat"},{playerAction:ue.Plant,buttonAction:ie.CommandPlant,shortcut:"B",name:"Plant",toggleKey:"planting",condition:()=>o.isAdult===!0},{playerAction:ue.Procreate,buttonAction:ie.ToggleProcreationBehavior,shortcut:"R",name:"Procreation",toggleKey:"procreation",condition:()=>o.isAdult===!0},{playerAction:ue.FeedChild,buttonAction:ie.ToggleFeedChildBehavior,shortcut:"H",name:"Feed Child",toggleKey:"feedChildren",condition:()=>o.isAdult===!0},{playerAction:ue.Attack,buttonAction:ie.ToggleAttackBehavior,shortcut:"Q",name:"Attack",toggleKey:"attack",condition:()=>o.isAdult===!0&&o.leaderId===o.id},{playerAction:ue.FollowMe,buttonAction:ie.CommandFollowMe,shortcut:"C",name:"Follow Me",toggleKey:"followLeader",condition:()=>o.isAdult===!0&&o.leaderId===o.id},{playerAction:ue.CallToAttack,buttonAction:ie.CommandCallToAttack,shortcut:"V",name:"Call to Attack",condition:()=>o.isAdult===!0&&o.leaderId===o.id},{playerAction:ue.TribeSplit,buttonAction:ie.CommandTribeSplit,shortcut:"K",name:"Split Tribe",condition:()=>o.leaderId!==void 0&&o.leaderId!==o.id&&o.isAdult===!0},{playerAction:ue.Build,buttonAction:ie.CommandBuild,shortcut:"L",name:"Build",toggleKey:"build",condition:()=>o.isAdult===!0&&o.leaderId===o.id},{playerAction:ue.Build,buttonAction:ie.OpenRoleManager,shortcut:"U",name:"Roles",condition:()=>o.isAdult===!0&&o.leaderId===o.id}];v=v.filter(L=>L.condition?L.condition():!0);const y=1,I=v.length,E=I*cn+(I-1)*wr,T=y*cn+(y-1)*wr,w=(i-E)/2,O=e.canvas.height-T-20;if(v.forEach((L,N)=>{const H=N%I,b=Math.floor(N/I),U=w+H*(cn+wr),G=O+b*(cn+wr),Q=!!L.toggleKey,ee=Q&&t.autopilotControls.behaviors[L.toggleKey],me=!m.has(L.playerAction),Ne=L.playerAction===ue.Build&&t.buildMenuOpen,Ie=!t.hasPlayerEnabledAutopilot||t.hasPlayerEnabledAutopilot<4?" (Press Shift to toggle Auto)":"",he=Q?`${L.name}${Ie}`:L.name,ke=ee||Ne||L.buttonAction===ie.OpenRoleManager&&t.roleManagerOpen?Vl:Zi,ve={id:`commandButton_${L.name}`,action:L.buttonAction,rect:{x:U,y:G,width:cn,height:cn},icon:L.buttonAction===ie.OpenRoleManager?"":bu[L.playerAction],text:L.shortcut,backgroundColor:ke,textColor:Yt,currentWidth:cn,tooltip:he,isDisabled:me,activated:ee||Ne||L.buttonAction===ie.OpenRoleManager&&t.roleManagerOpen};t.uiButtons.push(ve)}),t.buildMenuOpen){const L=[{id:"buildMenu_storageSpot",action:ie.SelectStorageSpot,icon:"",shortcut:"1",name:"Storage Spot"},{id:"buildMenu_plantingZone",action:ie.SelectPlantingZone,icon:"",shortcut:"2",name:"Planting Zone"},{id:"buildMenu_removal",action:ie.SelectRemovalTool,icon:"",shortcut:"3",name:"Remove Building"}],N=L.length,H=N*cn+(N-1)*wr,b=(i-H)/2,U=O-cn-wr;L.forEach((G,Q)=>{const ee=b+Q*(cn+wr),me=U,be=G.action===ie.SelectStorageSpot&&t.selectedBuildingType==="storageSpot"||G.action===ie.SelectPlantingZone&&t.selectedBuildingType==="plantingZone"||G.action===ie.SelectRemovalTool&&t.selectedBuildingType==="removal",Ne={id:G.id,action:G.action,rect:{x:ee,y:me,width:cn,height:cn},icon:G.icon,text:G.shortcut,backgroundColor:be?Vl:Zi,textColor:Yt,currentWidth:cn,tooltip:G.name,activated:be};t.uiButtons.push(Ne),df(e,Ne,t.hoveredButtonId===Ne.id)})}}let s=i-Ve;a.forEach(g=>{const m=Ve,v=s-g.currentWidth;g.rect={x:v,y:m,width:g.currentWidth,height:Vv},df(e,g,t.hoveredButtonId===g.id),s-=g.currentWidth+kC});let u=null;t.uiButtons.filter(g=>g.id.startsWith("commandButton_")||g.id.startsWith("buildMenu_")).forEach(g=>{u||(u={x:g.rect.x,y:g.rect.y,width:g.rect.width,height:g.rect.height}),u.x=Math.min(u.x,g.rect.x),u.y=Math.min(u.y,g.rect.y),u.width=Math.max(u.width,g.rect.x+g.rect.width-u.x),u.height=Math.max(u.height,g.rect.y+g.rect.height-u.y),g.id.startsWith("commandButton_")&&df(e,g,t.hoveredButtonId===g.id)});const f=t.hoveredButtonId?t.uiButtons.find(g=>g.id===t.hoveredButtonId):void 0;return f&&f.tooltip&&t.mousePosition&&HP(e,f.rect,f.tooltip,t.mousePosition),e.restore(),{commandButtonsRect:u}}function GP(e){e.save(),e.fillStyle=jC,e.fillRect(0,0,e.canvas.width,e.canvas.height),e.fillStyle=VC,e.font=`${XC}px "Press Start 2P", Arial`,e.textAlign="center",e.textBaseline="middle",e.fillText("PAUSED",e.canvas.width/2,e.canvas.height/2),e.restore()}function Hf(e,t,i,o){const a=t.x-i.width/2,s=t.y-i.height/2,u=a+e.x,c=s+e.y,f=(u%o.width+o.width)%o.width,g=(c%o.height+o.height)%o.height;return{x:f,y:g}}function Wu(e,t,i,o){let a=e.x-t.x,s=e.y-t.y;return Math.abs(a)>o.width/2&&(a=a-Math.sign(a)*o.width),Math.abs(s)>o.height/2&&(s=s-Math.sign(s)*o.height),{x:a+i.width/2,y:s+i.height/2}}function ou(e,t,i,o){const a=Wu(e.position,t,i,o),u=("radius"in e?e.radius:20)+20;return a.x>=-u&&a.x<=i.width+u&&a.y>=-u&&a.y<=i.height+u}function fn(e,t,i,o,a,...s){const u={...a.position};for(let c=-i;c<=i;c+=i)for(let f=-t;f<=t;f+=t)a.position.x=u.x+f,a.position.y=u.y+c,o(e,a,...s);a.position=u}const xP=25,$P=0,M0=28;function bS(e,t,i,o,a,s,u,c,f,g){e.save();const{x:m,y:v}=Wu(t,u,{width:c,height:f},g);e.strokeStyle=o,e.lineWidth=s,e.setLineDash(a),e.beginPath(),e.arc(m,v,i+Hu,0,2*Math.PI),e.stroke(),e.restore()}function WP(e,t,i,o,a,s,u){if(t=t.filter(v=>v.type!==ue.FollowMe),t.length===0)return;e.save(),t.forEach(v=>{v.targetEntity&&bS(e,v.targetEntity.position,v.targetEntity.radius,lh,uh,2,o,a,s,u)}),e.font=`${Vo}px "Press Start 2P", Arial`,e.fillStyle="white",e.textAlign="center",e.textBaseline="bottom",e.shadowColor="black",e.shadowBlur=5;const{x:c,y:f}=Wu(i.position,o,{width:a,height:s},u);let g=0,m={};t.forEach(v=>{const y=bu[v.type];if(v.targetEntity){m[v.targetEntity.id]=(m[v.targetEntity.id]||0)+1;const I=v.targetEntity.position.x-o.x+a/2,E=v.targetEntity.position.y-o.y+s/2,T=`${y}${v.key.toUpperCase()}`,w=E-v.targetEntity.radius-Hu-Vo/2-(m[v.targetEntity.id]-1)*M0;e.fillText(T,I,w)}else{e.textAlign="left";const I=`${y}${v.key.toUpperCase()}`,E=c+xP,w=f+$P+g*M0;e.fillText(I,E,w),g++,e.textAlign="center"}}),e.restore()}const Ee=(e,t,i,o,a,s,u)=>{s==="transparent"||o<=0||a<=0||(e.fillStyle=s,e.fillRect(Math.floor(t*u),Math.floor(i*u),Math.ceil(o*u),Math.ceil(a*u)))},k0=10,F0=10,Jn=6,gi=4,su=2,zP=5,In=4,YP=2,Ut=4,jP=2,it=3,wo=2,Ki=0,ha=Ki+gi-1,$t=ha,ct=ha+In-1,VP="rgba(0, 0, 0, 0.4)",XP=4,KP=1,Ih={name:"tribe-human-2d",referenceImage:"swos.png",description:`A 2D human character asset for the Tribe game. This includes ensuring that the unique animations for stances like 'eat' and 'procreate' do not erroneously appear in other stances, such as 'walk', which was observed in the provided rendered media. The 'idle' animation was updated to a leg sway to better match the provided video for that stance, replacing a simpler body bob.

# Visual style

Human characters in the Tribe game are inspired by classic 2D pixel art, they look like Sensible Soccer players(Sensible Soccer game visual style is IMPORTANT), with a simple and recognizable design. The characters are designed to be easily distinguishable and animated in a way that conveys their actions clearly.

Character in Tribe game look like people from stone age, they have simple clothing, no shoes, and no modern accessories. The characters are designed to be easily distinguishable and animated in a way that conveys their actions clearly.

# Technical details

The asset is rendered on a canvas using the CanvasRenderingContext2D API. The rendering function takes parameters for position, size, progress, stance, direction, gender, and age. The character can face left or right, and the rendering adapts based on the stance (e.g., idle, walk, eat, procreate).
The rendering function must be simple and efficient, it should not use complex patterns or gradients, and should focus on solid colors and basic shapes to maintain the pixel art aesthetic.

15% padding from all edges of the rendering box is required to ensure the character is not cut off during rendering.

Subtle shadow should be drawn under the character to give it a sense of depth.

# Rendering parameters

- age: The age of the character, which affects the size and proportions of the body parts. Age is a number between 1 and 60, with 20 being the average age.
- gender: 
  - The male characters should have only pants, while female cover their breasts with a top. The clothing should be simple and muted, reflecting a stone-age style.
  - Female characters should have long hair, while male should have short hair and beard.
  - Male characters should have a more robust, muscular build
  - Female characters should have thinner arms and legs, with a more pronounced waist and hips.
- isPregnant: (applicable only for females) Indicates if the character is pregnant, like very large belly. Pregnant characters should have a larger torso.
- direction: A vector indicating the character's facing direction. There should be at least 8 directions (like in Sensible Soccer): top left, top, top right, left, right, bottom left, bottom, bottom right. The character should be flipped horizontally if the direction vector's X component is negative.
             When moving up(top, top left, top right), the character back of the head should be visible, when moving down(Y > 0), the character face should be visible.
- hungryLevel: A number between 0 and 100 indicating how hungry the character is, hunger level 100 means the character is starving, 0 means the character is not hungry at all. So hungry characters should be thinner, with less body fat, and more pronounced muscles. The character's hunger level affects the size and proportions of the body parts, with hungrier characters being smaller and more gaunt.

# Rendering details

- All parts of the body must be connected
- Rendering must take into account direction vector (X and Y) to flip the character horizontally if needed
- The character's age affects the size and proportions of the body parts, with older characters being larger and more robust. Hair color should become gray for older characters.

# Stances

- 'idle': The character stands still, with a slight leg sway to indicate life.
- 'walk': The character moves forward, with legs and arms in motion.
- 'gathering': The character is gathering food from berry bushes, with arms reaching out and a slight bend at the knees.
- 'eat': The character holds food and brings it to their mouth, with a slight bend at the knees.
- 'procreate': The character performs a mating animation, with a specific pose and movement. There should be some additional visual effects to indicate this action, such as a slight glow or aura around the characters, or dust particles to indicate movement.
- 'attacking': The character performs an attack animation, with arms raised and a forward motion.
- 'defending': The character takes a defensive stance, with arms raised and a slight bend at the knees.
- 'stunned': The character is stunned and laying on the ground, with limbs relaxed and a neutral expression.
- 'dead': The character lies on the ground, with limbs relaxed and a neutral expression, slowly turns into a skeleton over time.

`,stances:["idle","walk","gathering","eat","procreate","dead","attacking","defending","stunned"],render(e,t,i,o,a,s,u,c="male",f=20,g=[1,0],m=!1,v=0){const y=["dead","stunned"].includes(u),I=y?F0+4:k0,E=y?k0+4:F0+it,T=.15,w=Math.min(o*(1-2*T)/I,a*(1-2*T)/E),O=I*w,L=E*w,N=t+(o-O)/2,H=i+(a-L)/2;e.save(),g[0]<0&&!y?(e.translate(N+O,H),e.scale(-1,1)):e.translate(N,H);const U="#D09A5A",G=f>50?"#BDBDBD":"#281808",Q="#7F5C4A",ee="#6B4F3A",me="#E0D8C0",be="#A0522D",Ne=1-Math.max(0,Math.min(100,v))/100*.2,Ie=c==="male"?1.1:.9,he=.8+(Math.max(1,Math.min(f,60))-1)/59*.2;let ke=zP*Ne*Ie*he,ve=YP*Ne*Ie*he,te=jP*Ne*he;m&&c==="female"&&(ke*=1.5);const z=Math.round((I-ke)/2),X=Math.round((I-Jn)/2),Y=z-ve,P=z+ke,B=1,K=z+(ke/2-B/2)-te,J=z+(ke/2+B/2),pe=g[1]<-.2&&Math.abs(g[0])<.7,oe=Z=>{e.fillStyle=VP,e.beginPath();const se=I/2,Ue=Z;e.ellipse(Math.floor(se*w),Math.floor(Ue*w),Math.max(1,Math.floor(XP*w)),Math.max(1,Math.floor(KP*w)),0,0,2*Math.PI),e.fill()},_e=(Z,se)=>{c==="male"?(Ee(e,z,ha+Z,ke,In-wo,se,w),Ee(e,z,ha+In-wo+Z,ke,wo,Q,w)):Ee(e,z,ha+Z,ke,In,ee,w)},Ce=(Z,se)=>{pe?Ee(e,X,Ki+Z,Jn,gi,G,w):(Ee(e,X,Ki+Z,Jn,gi,se,w),Ee(e,X,Ki+Z,Jn,su,G,w),c==="female"?(Ee(e,X-1,Ki+su+Z,1,gi,G,w),Ee(e,X+Jn,Ki+su+Z,1,gi,G,w)):Ee(e,X+1,Ki+2+Z,Jn-2,gi-2,G,w))};switch(u){case"idle":{const Z=s*Math.PI*2,se=Math.sin(Z)*.5,Se=(Math.cos(Z*2)+1)*.25;oe(ct+it+1),Ee(e,K+se,ct+Se,te,it,U,w),Ee(e,J-se,ct+Se,te,it,U,w),_e(Se,U),Ee(e,Y,$t+Se,ve,Ut,U,w),Ee(e,P,$t+Se,ve,Ut,U,w),Ce(Se,U);break}case"walk":{const Z=s*Math.PI*2,se=Math.sin(Z)*2,Se=Math.abs(Math.cos(Z))*1;oe(ct+it+1),Ee(e,K+se,ct+Se,te,it,U,w),Ee(e,J-se,ct+Se,te,it,U,w),_e(Se,U),Ee(e,Y-se,$t+Se,ve,Ut,U,w),Ee(e,P+se,$t+Se,ve,Ut,U,w),Ce(Se,U);break}case"gathering":{const Z=s*Math.PI*2,se=1,Ue=(Math.sin(Z)+1)/2*2,Se=se+Math.abs(Math.cos(Z))*.5;oe(ct+it+1),Ee(e,K,ct+Se,te,it-se,U,w),Ee(e,J,ct+Se,te,it-se,U,w),_e(Se,U),Ee(e,Y+1,$t+Se-Ue,ve,Ut,U,w),Ee(e,P-1,$t+Se-Ue,ve,Ut,U,w),Ce(Se,U);break}case"eat":{oe(ct+it+1),Ee(e,K,ct+1,te,it-1,U,w),Ee(e,J,ct+1,te,it-1,U,w),_e(1,U);const Ue=(Math.sin(s*Math.PI*4)+1)/2,Se=X+Jn/2,$n=Ki+gi/2,tt=P+(Se-P)*Ue,Ze=$t+1+($n-($t+1))*Ue;Ee(e,Y,$t+1,ve,Ut,U,w),Ee(e,tt,Ze,ve,Ut,U,w),Ee(e,tt,Ze-1,1,1,be,w),Ce(1,U);break}case"procreate":{const Z=(Math.sin(s*Math.PI*8)+1)/4,se=(Math.sin(s*Math.PI*6)+1)*.5,Ue=1.5,Se=Ue-se;oe(ct+it+1),Ee(e,K,ct+Se,te,it-Ue,U,w),Ee(e,J,ct+Se,te,it-Ue,U,w),_e(Se,U),Ee(e,Y,$t+Se,ve,Ut,U,w),Ee(e,P,$t+Se,ve,Ut,U,w),Ce(Se,U),e.globalAlpha=Z,_e(Se,"white"),e.globalAlpha=1;break}case"attacking":{const Z=Math.sin(s*Math.PI)*1.5,se=Math.abs(Math.sin(s*Math.PI));oe(ct+it+1),Ee(e,K-Z,ct+se,te,it,U,w),Ee(e,J+Z*.5,ct+se,te,it,U,w),_e(se,U),Ee(e,Y,$t+se-2,ve,Ut,U,w),Ee(e,P,$t+se-2.5,ve,Ut,U,w),Ce(se,U);break}case"defending":{oe(ct+it+1),Ee(e,K,ct+1,te,it-1,U,w),Ee(e,J,ct+1,te,it-1,U,w),_e(1,U),Ee(e,Y-1,$t+1-1,ve,Ut,U,w),Ee(e,P+1,$t+1-1,ve,Ut,U,w),Ce(1,U);break}case"stunned":case"dead":{const Z=u==="dead",se=Z?Math.min(1,s):0,Ue=se>.5?me:U,Se=c==="male"?Q:ee,$n=se>.8?"transparent":G,tt=I/2,Ze=E/2,Wn=2;oe(E-1),Ee(e,tt-te-Wn,Ze,te,it,Ue,w),Ee(e,tt+Wn,Ze,te,it,Ue,w),Ee(e,tt-ve-Wn,Ze-In+1,ve,Ut,Ue,w),Ee(e,tt+Wn,Ze-In+1,ve,Ut,Ue,w);const Xt=tt-ke/2,gn=Ze-In/2;c==="male"?(se<.7&&Ee(e,Xt,gn+In-wo,ke,wo,Se,w),Ee(e,Xt,gn,ke,In-wo,Ue,w)):se<.7?Ee(e,Xt,gn,ke,In,Se,w):Ee(e,Xt,gn,ke,In,Ue,w);const zn=tt-Jn/2,Yn=Ze-In/2-gi+1;if(Ee(e,zn,Yn,Jn,gi,Ue,w),$n!=="transparent"&&Ee(e,zn,Yn,Jn,su,$n,w),Z&&se>.6){const Ii="#B0A890";for(let cr=0;cr<3;cr++)Ee(e,Xt+1,gn+cr*1+1,ke-2,.5,Ii,w)}break}default:Ee(e,0,0,I,E,"magenta",w);break}e.restore()}};function ZP(e,t,i,o,a){const s=t.x,u=t.y-i-o/2;e.save(),e.fillStyle=a,e.strokeStyle=a,e.lineWidth=1.5,e.beginPath(),e.rect(s-o/2,u,o,o/2),e.fill(),e.beginPath(),e.moveTo(s-o/2,u),e.lineTo(s-o/4,u-o/3),e.lineTo(s-o/6,u),e.moveTo(s-o/6,u),e.lineTo(s,u-o/2),e.lineTo(s+o/6,u),e.moveTo(s+o/6,u),e.lineTo(s+o/4,u-o/3),e.lineTo(s+o/2,u),e.stroke(),e.restore()}function _a(e,t,i,o,a,s=!1,u=!1,c=!1,f=!1){o<Jf&&(i=i*.75),Ih.render(e,t.x-i/2,t.y-i/2,i,i,0,"idle",a,o,[0,0],!1,0);let g,m;s?(g=CC,m=Wv):u?(g=wC,m=jv):c?(g=_C,m=Yv):f&&(g=RC,m=zv),g&&m&&ZP(e,t,i/2,g,m)}function qP(e,t,i,o,a,s){if(e.save(),o.length===0){e.restore();return}const u=o.length*a,c=4;let f;const g=u+(o.length-1)*c;o.length>1&&g>s?f=(s-u)/(o.length-1):f=c,o.length<=1&&(f=0);for(let m=0;m<o.length;m++){const{member:v,isPlayer:y,isHeir:I,isPartner:E,isParent:T}=o[m],w=t+m*(a+f)+a/2,O=i+a/4;_a(e,{x:w,y:O},a,v.age,v.gender,y,I,E,T)}e.restore()}function QP(e,t,i,o,a){if(i.length===0)return;e.save();const s=qn,u=" 00",c=" 00";e.font=`${zd}px "Press Start 2P", Arial`;const f=e.measureText(u).width,g=e.measureText(c).width,m=qn+An+qn+An+qn+Wi+f+qn/2+Wi+g,v=i.length*jl+(i.length-1)*r0,y=a-v-qn;e.fillStyle=NC,e.fillRect(s,y,m,v);for(let I=0;I<i.length;I++){const E=i[I],T=y+I*(jl+r0),w=T+jl/2;E.isPlayerTribe&&(e.fillStyle=PC,e.fillRect(s,T,m,jl));let O=s+qn;if(e.font=`${An}px "Press Start 2P", Arial`,e.textBaseline="middle",e.textAlign="left",e.fillText(E.tribeBadge,O,w-An/4),O+=An+qn,!E.isPlayerTribe){const L=E.diplomacyStatus===St.Friendly?"":"",N=`diplomacyButton_${E.leaderId}`,H={x:O-2,y:w-An/2-2,width:An+4,height:An+4},b={id:N,action:ie.ToggleDiplomacy,rect:H,text:"",icon:L,backgroundColor:"transparent",textColor:"white",currentWidth:An,tooltip:`Toggle diplomacy with this tribe (Currently: ${E.diplomacyStatus})`,targetTribeId:E.leaderId};t.uiButtons.push(b),t.hoveredButtonId===N&&(e.fillStyle=ch,e.globalAlpha=.5,e.fillRect(H.x,H.y,H.width,H.height),e.globalAlpha=1),e.font=`${An*.8}px "Press Start 2P", Arial`,e.textBaseline="middle",e.textAlign="center",e.fillText(L,O+An/2,w)}O+=An+qn,E.adultCount>0&&(_a(e,{x:O+Wi/2,y:w},Wi,25,"male"),O+=Wi/2,e.font=`${zd}px "Press Start 2P", Arial`,e.fillStyle="white",e.textBaseline="middle",e.textAlign="left",e.fillText(` ${E.adultCount}`,O,w),O+=e.measureText(` ${E.adultCount}`).width+qn/2),E.childCount>0&&(_a(e,{x:O+Wi/2,y:w},Wi,1,"female"),O+=Wi/2,e.font=`${zd}px "Press Start 2P", Arial`,e.fillStyle="white",e.textBaseline="middle",e.textAlign="left",e.fillText(` ${E.childCount}`,O,w))}e.restore()}function JP(e,t,i,o,a){const s=iS,u=rS,c=t+o-s-u,f=i+u;e.save(),e.lineWidth=2,e.strokeStyle=a?rw:iw,e.beginPath();const g=5;e.moveTo(c+g,f+g),e.lineTo(c+s-g,f+s-g),e.moveTo(c+s-g,f+g),e.lineTo(c+g,f+s-g),e.stroke(),e.restore()}function eN(e,t,i,o){const{tutorialState:a,tutorial:s}=t;if(a.transitionState===zt.INACTIVE)return;const u=s.steps[a.currentStepIndex];if(!u)return;e.save(),e.globalAlpha=a.transitionAlpha;const c=KC,f=ZC,g=qC,m=`${Vd}px "Press Start 2P", Arial`,v=`${f0}px "Press Start 2P", Arial`,y=JC,I=f0*1.5;e.font=v;const E=u.text.split(" ");let T="";const w=[];for(let me=0;me<E.length;me++){const be=T+E[me]+" ";e.measureText(be).width>c-f*2&&me>0?(w.push(T),T=E[me]+" "):T=be}w.push(T);const O=f*2+Vd+f/2+w.length*I,L=(i-c)/2,N=o-O-160;e.fillStyle=QC,e.beginPath(),e.moveTo(L+g,N),e.lineTo(L+c-g,N),e.quadraticCurveTo(L+c,N,L+c,N+g),e.lineTo(L+c,N+O-g),e.quadraticCurveTo(L+c,N+O,L+c-g,N+O),e.lineTo(L+g,N+O),e.quadraticCurveTo(L,N+O,L,N+O-g),e.lineTo(L,N+g),e.quadraticCurveTo(L,N,L+g,N),e.closePath(),e.fill(),e.fillStyle=y,e.textAlign="center",e.textBaseline="top",e.font=m,e.fillText(u.title,L+c/2,N+f),e.font=v;let H=N+f+Vd+f/2;for(const me of w)e.fillText(me,L+c/2,H),H+=I;const b=t.hoveredButtonId==="tutorial-dismiss";JP(e,L,N,c,b),e.restore();const U=iS,G=rS,Q=L+c-U-G,ee=N+G;return{x:Q,y:ee,width:U,height:U}}function ff(e,t,i){e.save();const o=nw,a={x:t.x-o,y:t.y-o,width:t.width+o*2,height:t.height+o*2};e.strokeStyle=tS,e.lineWidth=nS+Math.sin(i*dh)*1.5,e.setLineDash([8,8]),e.strokeRect(a.x,a.y,a.width,a.height),e.restore()}function tN(e,t){e.fillStyle="white",e.font='30px "Press Start 2P", Arial',e.textAlign="center",e.fillText("Game Over!",e.canvas.width/2,e.canvas.height/2-60),e.font='20px "Press Start 2P", Arial',e.fillText("Lineage Extinct.",e.canvas.width/2,e.canvas.height/2-20),e.fillText(`Cause: ${t.causeOfGameOver||"Unknown"}`,e.canvas.width/2,e.canvas.height/2+20)}const GS=10,nN=3,L0=GS*.7;function iN(e,t){const{position:i,food:o,maxFood:a}=t;if(e.beginPath(),e.arc(i.x,i.y,GS,0,Math.PI*2),e.fillStyle="#228B22",e.fill(),e.strokeStyle="#006400",e.lineWidth=1,e.stroke(),o.length>0){const s=Math.PI*2/Math.min(o.length,a);for(let u=0;u<o.length;u++){const c=u*s,f=i.x+L0*Math.cos(c),g=i.y+L0*Math.sin(c);e.beginPath(),e.arc(f,g,nN,0,Math.PI*2),e.fillStyle="#FF0000",e.fill()}}}const U0=(e,t,i=70,o=50)=>{const a=e>>t&255;return`hsl(${Math.floor(a/255*360)}, ${i}%, ${o}%)`},rN=(e,t)=>{const i=e.match(/hsl\((\d+),\s*(\d+)%,\s*(\d+)%\)/);if(!i)return e;const[o,a,s]=[parseInt(i[1]),parseInt(i[2]),parseInt(i[3])];return`hsl(${o}, ${a}%, ${Math.max(0,s-t)}%)`},au=(e,t,i,o,a,s,u,c=!1)=>{e.save(),e.translate(t,i),e.rotate(s),e.fillStyle=c?rN(u,15):u,e.beginPath(),e.roundRect(-o/2,0,o,a,o/2),e.fill(),e.restore()},hf=(e,t)=>{const i=e.match(/hsl\((\d+),\s*(\d+)%,\s*(\d+)%\)/),o=75;if(!i)return`hsl(0, 0%, ${o}%)`;const[,a,s,u]=i.map(Number),c=s*(1-t),f=u+(o-u)*t;return`hsl(${a}, ${c}%, ${f}%)`},xS={name:"tribe-prey-2d",referenceImage:"swos.png",description:`A 2D prey asset for the Tribe game, featuring various stances and animations.

Prey is an animal which can be hunted by predators or humans in the Tribe game.

Preys look like small 4 leg mammals, with a simple and recognizable design. The characters are designed to be easily distinguishable and animated in a way that conveys their actions clearly.

# Visual style

Prey characters in the Tribe game are inspired by classic 2D pixel art, they look like Sensible Soccer players(Sensible Soccer game visual style is IMPORTANT), with a simple and recognizable design. The characters are designed to be easily distinguishable and animated in a way that conveys their actions clearly.

Character in Tribe game look like creatures from stone age, they have simple clothing, no shoes, and no modern accessories. The characters are designed to be easily distinguishable and animated in away that conveys their actions clearly.

Prey walks on all fours, unlike human (two legs).

Each prey is described by a unique gene code, which is a number that defines its appearance, size, and other characteristics. The gene code is used to generate the character's appearance, including body proportions, color, and other visual features. The gene code is a 32-bit integer, with each bit representing a specific characteristic of the character.

Prey should have should have visible body parts, such as head, torso, arms, and legs. The body parts should be connected and should not overlap. The character's body parts should be simple shapes, such as circles and rectangles, with solid colors and no gradients or patterns.

Preys are supposed to be sympathetic and friendly, so the character's face should have a friendly expression, with a smile and bright eyes. The character's eyes should be large and expressive, with a simple design.

# Technical details

The asset is rendered on a canvas using the CanvasRenderingContext2D API. The rendering function takes parameters for position, size, progress, stance, direction, gender, and age. The character can face left or right, and the rendering adapts based on the stance (e.g., idle, walk, eat, procreate).
The rendering function must be simple and efficient, it should not use complex patterns or gradients, and should focus on solid colors and basic shapes to maintain the pixel art aesthetic.

15% padding from all edges of the rendering box is required to ensure the character is not cut off during rendering.

Subtle shadow should be drawn under the a character to give it a sense of depth.

IMPORTANT: The character is visible from the side, just like in Sensible Soccer.

# Rendering parameters

- age: The age of the character, which affects the size and proportions of the body parts. Age is a number between 0 and 12, with 2 being the average age.
- gender:
  - 'male': Male prey are larger and more robust, with a more pronounced musculature.
  - 'female': Female prey are smaller and more agile, with a leaner build.
- isPregnant: (applicable only for females) Indicates if the character is pregnant, like very large belly. Pregnant characters should have a larger torso.
- direction: A vector indicating the character's facing direction. There should be at least 8 directions (like in Sensible Soccer): top left, top, top right, left, right, bottom left, bottom, bottom right. The character should be flipped horizontally if the direction vector's X component is negative.
             When moving up(top, top left, top right), the character back of the head should be visible, when moving down(Y > 0), the character face should be visible.
- hungryLevel: A number between 0 and 100 indicating how hungry the character is, hunger level 100 means the character is starving, 0 means the character is not hungry at all. So hungry characters should be thinner, with less body fat, and more pronounced muscles. The character's hunger level affects the size and proportions of the body parts, with hungrier characters being smaller and more gaunt.

# Rendering details

- All parts of the body must be connected
- Rendering must take into account direction vector (X and Y) to flip the character horizontally if needed
- The character's age affects the size and proportions of the body parts, with older characters being larger and more robust. Hair color should become gray for older characters.

# Stances

- 'idle': The character stands still, with a slight leg sway to indicate life.
- 'walk': The character moves forward, with legs and arms in motion.
- 'eat': The character holds food and brings it to their mouth, with a slight bend at the knees.
- 'procreate': The character performs a mating animation, with a specific pose and movement. There should be some additional visual effects to indicate this action, such as a slight glow or aura around the characters, or a dust particles to indicate movement.
- 'dead': The character lies on the ground, with limbs relaxed and a neutral expression, slowly turns into a grey skeleton over time. The character pose and body parts should not be animated in this stance, as the character is dead so it should not move.`,stances:["idle","walk","eat","dead","procreate"],render(e,t,i,o,a,s,u,c={gender:"male",age:2,direction:[1,0],isPregnant:!1,hungryLevel:0,geneCode:8405024}){e.save(),e.imageSmoothingEnabled=!1;const f=o*.15,g=t+o/2,m=i+a/2,v=o-f*2,y=a-f*2,{gender:I,age:E,direction:T,isPregnant:w,hungryLevel:O,geneCode:L}=c,N=.8+Math.min(E,10)/10*.4,H=I==="male"?1.05:.95,b=1-O/100*.3,U=v*.5*b*N*H;let G=y*.3*N*H;const Q=v*.15*N*H,ee=U*.2,me=y*.3,be=U0(L,0,30,50);let Ne=U0(L,8,50,40);if(E>45){const oe=Math.min(1,(E-45)/15);Ne=hf(Ne,oe)}e.translate(g,m),T[0]<0&&e.scale(-1,1);const Ie=Math.sin(s*Math.PI*2),he=Math.cos(s*Math.PI*2),ke=me+G*.2;if(u==="dead"){const oe=Math.min(s,1);e.translate(0,y*.2),e.rotate(Math.PI/2);const _e=hf(Ne,oe),Ce=hf(be,oe);e.globalAlpha=.5+oe*.5,e.strokeStyle=_e,e.lineWidth=ee*.5,e.beginPath(),e.moveTo(-U*.4,0),e.lineTo(U*.4,0),e.stroke();for(let Z=-1;Z<=1;Z+=1)e.beginPath(),e.arc(0,0,G*.4,Math.PI*.4*Z-Math.PI*.2,Math.PI*.4*Z+Math.PI*.2),e.stroke();e.fillStyle=Ce,e.beginPath(),e.arc(U*.5,0,Q,0,Math.PI*2),e.fill(),e.fillStyle="black",e.beginPath(),e.arc(U*.55,0,Q*.3,0,Math.PI*2),e.fill(),e.restore();return}e.fillStyle="rgba(0, 0, 0, 0.1)",e.beginPath(),e.ellipse(0,ke,U*.7,U*.25,0,0,2*Math.PI),e.fill();let ve=0,te=0,z=0,X=0,Y=0,P=0;switch(u){case"idle":te=Ie*(y*.02),z=Ie*.05,X=-Ie*.05,Y=-Ie*.05,P=Ie*.05;break;case"walk":te=Math.abs(he)*(y*-.04),z=Ie*.7,X=-Ie*.7,Y=-Ie*.7,P=Ie*.7;break;case"eat":ve=y*.1,te=y*.05,ve+=Ie*(y*.02);break;case"procreate":te=y*.05;const oe=(1-he)*-v*.05;e.translate(oe,0),e.shadowColor="rgba(255, 182, 193, 0.9)",e.shadowBlur=10;break}w&&I==="female"&&(G*=1.6);const B=te,K=B-G*.2;au(e,U*-.35,K,ee,me,Y,Ne,!0),au(e,U*.35,K,ee,me,P,Ne,!0),e.fillStyle=Ne,e.beginPath(),e.ellipse(0,B,U/2,G/2,0,0,2*Math.PI),e.fill();const J=U*.45,pe=K+ve;e.fillStyle=be,e.beginPath(),e.arc(J,pe,Q,0,Math.PI*2),e.fill(),T[1]>=0&&(e.fillStyle="black",e.beginPath(),e.arc(J+Q*.3,pe-Q*.2,Q*.15,0,Math.PI*2),e.fill()),au(e,U*-.35,K,ee,me,z,Ne),au(e,U*.35,K,ee,me,X,Ne),e.restore()}};function oN(e,t){let[i,o,a]=e.match(/\d+/g).map(Number);return i=Math.max(0,i-t),o=Math.max(0,o-t),a=Math.max(0,a-t),`rgb(${i}, ${o}, ${a})`}function sN(e){const t=(e&16711680)>>16,i=(e&65280)>>8,o=e&255,a=`rgb(${t}, ${i}, ${o})`,s=oN(a,40),u=(e&255)%100+50,c=(e>>8&255)%100,f=(e>>16&255)%100,g=`rgb(${u}, ${c}, ${f})`,m=(e&8388608)!==0?"#00aaff":"#ffaa00";return{furColor:a,darkerFurColor:s,skinColor:g,eyeColor:m}}const $S={name:"tribe-predator-2d",referenceImage:"swos.png",description:`A 2D predator asset for the Tribe game, featuring various stances and animations.

Predator is an animal which can hunt and attack humans in the Tribe game. It is designed to be a threat to the player, adding an element of danger and challenge to the game world.

Predator look like bears or wolves, with a simple and recognizable design. The characters are designed to be easily distinguishable and animated in a way that conveys their actions clearly.

# Visual style

Predator characters in the Tribe game are inspired by classic 2D pixel art, they look like Sensible Soccer players(Sensible Soccer game visual style is IMPORTANT), with a simple and recognizable design. The characters are designed to be easily distinguishable and animated in a way that conveys their actions clearly.

Character in Tribe game look like creatures from stone age, they have simple clothing, no shoes, and no modern accessories. The characters are designed to be easily distinguishable and animated in away that conveys their actions clearly.

Predator walks on arms and legs, unlike human (two legs).

Each predator is described by a unique gene code, which is a number that defines its appearance, size, and other characteristics. The gene code is used to generate the character's appearance, including body proportions, color, and other visual features. The gene code is a 32-bit integer, with each bit representing a specific characteristic of the character.

Predator should have visible ears, eyes, and mouth with teeth. It must have a tail. Front legs should be shorter than back legs, and they should be positioned closer to the body. The character's body should be wider at the top and narrower at the bottom, with a slight curve to the back. The character's head should be larger than the body, with a pronounced jaw and sharp teeth.

# Technical details

The asset is rendered on a canvas using the CanvasRenderingContext2D API. The rendering function takes parameters for position, size, progress, stance, direction, gender, and age. The character can face left or right, and the rendering adapts based on the stance (e.g., idle, walk, eat, procreate).
The rendering function must be simple and efficient, it should not use complex patterns or gradients, and should focus on solid colors and basic shapes to maintain the pixel art aesthetic.

15% padding from all edges of the rendering box is required to ensure the character is not cut off during rendering.

Subtle shadow should be drawn under the a character to give it a sense of depth.

IMPORTANT: The character is visible from the side, just like in Sensible Soccer.

# Rendering parameters

- age: The age of the character, which affects the size and proportions of the body parts. Age is a number between 1 and 20, with 3 being the average age.
- gender:
  - 'male': Male predators are larger and more robust, with a more pronounced musculature.
  - 'female': Female predators are smaller and more agile, with a leaner build.
- isPregnant: (applicable only for females) Indicates if the character is pregnant, like very large belly. Pregnant characters should have a larger torso.
- direction: A vector indicating the character's facing direction. There should be at least 8 directions (like in Sensible Soccer): top left, top, top right, left, right, bottom left, bottom, bottom right. The character should be flipped horizontally if the direction vector's X component is negative.
             When moving up(top, top left, top right), the character back of the head should be visible, when moving down(Y > 0), the character face should be visible.
- hungryLevel: A number between 0 and 100 indicating how hungry the character is, hunger level 100 means the character is starving, 0 means the character is not hungry at all. So hungry characters should be thinner, with less body fat, and more pronounced muscles. The character's hunger level affects the size and proportions of the body parts, with hungrier characters being smaller and more gaunt.

# Rendering details

- All parts of the body must be connected
- Rendering must take into account direction vector (X and Y) to flip the character horizontally if needed
- The character's age affects the size and proportions of the body parts, with older characters being larger and more robust. Hair color should become gray for older characters.

# Stances

- 'idle': The character stands still, with a slight leg sway to indicate life.
- 'walk': The character moves forward, with legs and arms in motion.
- 'eat': The character holds food and brings it to their mouth, with a slight bend at the knees.
- 'procreate': The character performs a mating animation, with a specific pose and movement. There should be some additional visual effects to indicate this action, such as a slight glow or aura around the characters, or a dust particles to indicate movement.
- 'attacking': The character performs an attack animation, with arms raised and a forward motion.
- 'dead': The character lies on the ground, with limbs relaxed and a neutral expression, slowly turns into a grey skeleton over time. The character pose and body parts should not be animated in this stance, as the character is dead so it should not move.`,stances:["idle","walk","eat","dead","attacking","procreate"],render(e,t,i,o,a,s,u,c={gender:"male",age:20,direction:[1,0],isPregnant:!1,hungryLevel:0,geneCode:8405024}){const{gender:f,age:g,direction:m,isPregnant:v,hungryLevel:y,geneCode:I}=c;e.save();const E=o*.15,T=Math.max(1,Math.floor((o-E*2)/10)),w=m[0]<0;e.translate(t+o/2,i+a/2),w&&e.scale(-1,1);const O=sN(I),L=.8+Math.min(g,20)/20*.4,N=f==="male"?1.05:.95,H=1-y/100*.25,b=L*N*H,U=Math.max(0,Math.min(1,(g-15)/5));e.filter=`grayscale(${U})`;const G=O.furColor,Q=O.darkerFurColor,ee=O.eyeColor,me="#FFFFFF",be="#c75c5c",Ne="#E0E0E0",Ie="#A0A0A0",he=a/2-2*T,ke=Math.sin(s*Math.PI*2),ve=Math.abs(ke);if(e.fillStyle="rgba(0,0,0,0.15)",e.beginPath(),e.ellipse(0,he,T*4,T,0,0,2*Math.PI),e.fill(),e.filter="none",u==="dead"){const tt=Math.min(1,s*2);e.save(),e.translate(0,he-T*3),e.rotate(-Math.PI/2);const Ze=(Wn,Xt,gn,zn,Yn=!1)=>{e.fillStyle=Yn?Ie:Ne,e.fillRect(Wn*T,Xt*T,gn*T,zn*T)};tt<1&&(e.globalAlpha=1-tt,e.fillStyle=G,e.beginPath(),e.ellipse(0,0,T*3,T*5,0,0,Math.PI*2),e.fill(),e.globalAlpha=1),tt>0&&(e.globalAlpha=tt,Ze(-1,-4,2,2),Ze(1,-3.5,1,1,!0),Ze(-.5,-2,1,5,!0),Ze(-2.5,-1,5,.5),Ze(-2.5,0,5,.5),Ze(-2.5,1,5,.5),Ze(-3,-2,-1,2,!0),Ze(3,-2,1,2),Ze(-3,2,-1,2,!0),Ze(3,2,1,2),e.globalAlpha=1),e.restore(),e.restore();return}e.fillStyle=G;let te=0,z=0,X=0,Y=[0,0,0,0];switch(u){case"idle":te=ke*T*.1;break;case"walk":const tt=Math.sin(s*Math.PI*4);te=Math.abs(tt)*-T*.5,Y=[tt*T,-tt*T,-tt*T,tt*T];break;case"attacking":const Ze=Math.sin(s*Math.PI*4);z=T*2+Ze*T,X=T*2,te=T;break;case"eat":X=T*3+ve*T,te=T*1.5,e.fillStyle=be,e.fillRect(-T,he-T,T*2,T);break;case"procreate":te=Math.sin(s*Math.PI*8)*T*.3,e.fillStyle="rgba(139, 69, 19, 0.5)";for(let Xt=0;Xt<5;Xt++){const gn=(Math.random()-.5)*T*8,zn=he+(Math.random()-.5)*T*2;ve>.5&&e.fillRect(gn,zn,T*.5,T*.5)}break}const P=T*3*b*(v?1.3:1),B=T*5*b,K=-B/1.5,J=he-P-T*2.5+te;e.fillStyle=G,e.beginPath(),e.moveTo(K-T*.5,J+P*.5),e.quadraticCurveTo(K-T*3,J-T,K-T*2+ke*T,J+P+T),e.fill();const pe=T*1.2*b,oe=T*3*b,_e=T*2.5*b,Ce=K+B*.8,Z=K+B*.2;e.fillStyle=Q,e.fillRect(Z,he-_e,pe,_e+Y[2]),e.fillRect(Ce,he-oe,pe,oe+Y[0]),e.fillStyle=G,e.beginPath(),e.moveTo(K,J+P),e.lineTo(K,J+T),e.quadraticCurveTo(K+B/2,J,K+B,J+T),e.lineTo(K+B,J+P),e.fill(),e.fillStyle=G,e.fillRect(Z+T/2,he-_e,pe,_e+Y[3]),e.fillRect(Ce+T/2,he-oe,pe,oe+Y[1]);const se=T*3.5*b,Ue=K+B-se*.3+z,Se=J-se*.3+X;e.fillStyle=G,e.beginPath(),e.arc(Ue,Se,se/2,0,Math.PI*2),e.fill(),e.beginPath(),e.ellipse(Ue+se*.4,Se+se*.2,T*1.5,T,0,0,Math.PI*2),e.fill(),m[1]>=0&&(e.fillStyle=ee,e.fillRect(Ue+T*.5,Se-T*.5,T*.5,T*.5),u==="attacking"&&(e.fillStyle=me,e.fillRect(Ue+se*.5,Se+se*.4,T,T*.4))),e.fillStyle=Q,e.beginPath(),e.moveTo(Ue-se*.4,Se-se*.3),e.lineTo(Ue,Se-se*.7),e.lineTo(Ue,Se-se*.2),e.fill(),e.restore()}},aN=9;function lN(e,t){const{position:i,gender:o,age:a,decayProgress:s,food:u,radius:c,originalEntityType:f,geneCode:g}=t;if(e.save(),e.globalAlpha=1-s,f==="human"?Ih.render(e,i.x-c,i.y-c,c*2,c*2,s,"dead",o,a,[0,0],!1,0):f==="prey"?xS.render(e,i.x-c,i.y-c,c*2,c*2,s,"dead",{gender:o,age:a,direction:[0,0],isPregnant:!1,hungryLevel:0,geneCode:g||8405024}):f==="predator"&&$S.render(e,i.x-c,i.y-c,c*2,c*2,s,"dead",{gender:o,age:a,direction:[0,0],isPregnant:!1,hungryLevel:0,geneCode:g||8405024}),e.restore(),u.length>0){e.save(),e.font=`${aN}px Arial`,e.textAlign="center",e.textBaseline="middle";const m=Rt*.9,v=Math.PI/kv*3;u.forEach((y,I)=>{const E=I*v,T=i.x+m*Math.cos(E)*Math.atan2(I,I),w=i.y+m*Math.sin(E)*Math.atan2(I,I),O=Qf[y.type];e.fillText(O,T,w)}),e.restore()}}function nr(e,t,i,o,a,s,u,c){e.save(),e.fillStyle=u,e.fillRect(t,i,o,a),e.fillStyle=c,e.fillRect(t,i,o*Math.max(0,s),a),e.restore()}function uN(e,t,i,o,a,s){if(e.save(),o.length===0){e.restore();return}const u=o.length*a;let c;u>s||u+(o.length-1)*4>s?c=(s-u)/(o.length-1):c=4,o.length===1&&(c=0);for(let f=0;f<o.length;f++){const g=Qf[o[f].type];e.fillText(g,t+f*(a+c),i)}e.restore()}function cN(e,t,i,o,a){const s=t.autopilotControls.hoveredAutopilotAction;if(!s)return;let u,c=Rt/2;const f=bu[s.action],g=aS[s.action],m=`${f} ${g}`;if("targetEntityId"in s){const v=t.entities.entities[s.targetEntityId];v&&(u=v.position,c=v.radius)}else"position"in s&&(u=s.position);if(u){bS(e,u,c,lh,uh,2,i,o,a,t.mapDimensions),e.save(),e.font=`${Vo}px "Press Start 2P", Arial`,e.fillStyle="white",e.textAlign="center",e.textBaseline="bottom",e.shadowColor="black",e.shadowBlur=5;const{x:v,y}=Wu(u,i,{width:o,height:a},t.mapDimensions),I=y-c-Hu-Vo/2;e.fillText(m,v,I),e.restore()}}function dN(e,t,i,o,a){e.save();const s=(Math.sin(a*dh)+1)/2,u=i+Hu+s*5;e.strokeStyle=lh,e.lineWidth=2,e.setLineDash(uh),e.beginPath(),e.arc(t.x,t.y,u,0,Math.PI*2),e.stroke(),e.setLineDash([]);const c=bu[o],f=aS[o];if(c){e.font=`${Vo*1.5}px "Press Start 2P", Arial`,e.textAlign="center",e.textBaseline="middle";const g=t.y-u-25;e.fillText(c,t.x,g),e.font=`${Vo*.8}px "Press Start 2P", Arial`,e.fillText(f,t.x,g+25)}e.restore()}function fN(e,t,i){e.save();const o=30,a=70,s=3,u=a/s;for(let c=0;c<s;c++){const f=c*u,g=(i*o+f)%a,m=1-g/a;e.strokeStyle=`rgba(255, 215, 0, ${m*.7})`,e.lineWidth=1+(1-m)*2,e.beginPath(),e.arc(t.x,t.y,g,0,Math.PI*2),e.stroke()}e.restore()}function hN(e,t){const{activeAutopilotAction:i,behaviors:o}=t.autopilotControls,a=pt(t);if(!a)return;const s=(u,c)=>{fN(u,c.position,t.time)};if(a.isCallingToFollow&&fn(e,t.mapDimensions.width,t.mapDimensions.height,s,{position:a.position}),o.followLeader&&!i&&fn(e,t.mapDimensions.width,t.mapDimensions.height,s,{position:a.position},70),i){let u,c=15;if("position"in i)u=i.position;else if("targetEntityId"in i){const f=t.entities.entities[i.targetEntityId];f&&(u=f.position,c=f.radius||30)}if(u&&i.action!==ue.AutopilotFollowMe&&!a.isCallingToFollow){const f=(g,m)=>{dN(g,m.position,c,i.action,t.time)};fn(e,t.mapDimensions.width,t.mapDimensions.height,f,{position:{...u}},u,c+30)}}}function B0(e,t,i,o,a,s,u=!0){const c=t.split(" ");let f="";const g=[];for(let m=0;m<c.length;m++){const v=f+c[m]+" ";e.measureText(v).width>a&&m>0?(g.push(f),f=c[m]+" "):f=v}if(g.push(f),u)for(let m=0;m<g.length;m++)e.fillText(g[m],i,o+m*s);return g.length*s}function gN(e){return 1-Math.pow(1-e,3)}function pN(e,t,i,o){t.notificationButtonRects={dismiss:{},view:{}};const a=t.notifications.filter(u=>!u.isDismissed);if(a.length===0)return;e.save();let s=o-hw;for(const u of a){const c=i-Kl-_r;e.font=`${Xd}px "Press Start 2P", Arial`;const f=c+_r,g=Kl-_r*2,m=B0(e,u.message,-9999,-9999,g,Xd*1.2,!1),v=_r*2+m+Qn,y=s-v,I=Date.now()-u.creationTime,E=Math.min(I/fw,1),T=gN(E),w=o,O=w+(y-w)*T;e.fillStyle=sw,e.beginPath(),e.roundRect(c,O,Kl,v,ow),e.fill(),e.fillStyle=aw,e.textBaseline="top",B0(e,u.message,f,O+_r,g,Xd*1.2,!0);const L=O+v-Qn-_r/2,N=c+Kl-Qn-_r/2,H={x:N,y:L,width:Qn,height:Qn};t.notificationButtonRects&&(t.notificationButtonRects.dismiss[u.id]=H);const b=t.hoveredButtonId===`notification-dismiss-${u.id}`;if(e.fillStyle=b?p0:lw,e.font=`${Qn}px Arial`,e.textAlign="center",e.textBaseline="middle",e.fillText("",H.x+H.width/2,H.y+H.height/2),u.targetEntityIds||u.targetPosition||u.targetArea||u.targetRadius){const Q={x:N-Qn-g0,y:L,width:Qn,height:Qn};t.notificationButtonRects&&(t.notificationButtonRects.view[u.id]=Q);const ee=t.hoveredButtonId===`notification-view-${u.id}`;e.fillStyle=ee?p0:uw,e.font=`${Qn*(ee?1.5:1.2)}px Arial`,e.fillText("",Q.x+Q.width/2,Q.y+Q.height/2)}s-=v+g0}e.restore()}function mN(e){return e.length===0?0:e.reduce((i,o)=>i+o,0)/e.length}function gf(e,t,i,o,a,s,u,c){e.save(),e.fillStyle="rgba(255, 255, 255, 0.1)",e.fillRect(o,a,s,u),e.strokeStyle="#555",e.lineWidth=1,e.strokeRect(o,a,s,u);const f=mN(i);e.fillStyle="white",e.font="11px monospace",e.textAlign="left",e.fillText(`${t}: ${f.toFixed(2)}ms`,o+Ve,a+Ve+8);const g=Math.max(...i,1),m=i.map(v=>v/g*u);if(e.beginPath(),e.strokeStyle=c,e.lineWidth=2,m.length>1){e.moveTo(o,a+u-m[0]);for(let v=1;v<m.length;v++){const y=o+v/(m.length-1)*s,I=a+u-m[v];e.lineTo(y,I)}}else if(m.length===1){const v=a+u-m[0];e.moveTo(o,v),e.lineTo(o+s,v)}e.stroke(),e.fillStyle="rgba(255, 255, 255, 0.7)",e.font="10px monospace",e.textAlign="right",e.fillText(`${g.toFixed(2)}ms`,o+s-Ve,a+Ve+8),e.restore()}function vN(e,t,i){const{performanceMetrics:o}=t;if(!o)return;const a=280,s=240,u=i-a-Ve,c=Ve+Ct*2;e.save(),e.fillStyle="rgba(0, 0, 0, 0.8)",e.fillRect(u,c,a,s),e.strokeStyle="#444",e.lineWidth=2,e.strokeRect(u,c,a,s),e.fillStyle="white",e.font="12px monospace",e.textAlign="left";let f=c+Ve+5;const g=u+Ve;e.fillStyle="#66ccff",e.font="bold 14px monospace",e.fillText(" Performance Debugger",g,f),f+=25,e.fillStyle="white",e.font="12px monospace";const m=SN(t);e.fillText(`FPS: ${m.toFixed(1)}`,g,f),f+=20;const v=a-Ve*2,y=45,I=10;gf(e,"Render",pf(t,"renderTime"),g,f,v,y,"#4CAF50"),f+=y+I,gf(e,"World Update",pf(t,"worldUpdateTime"),g,f,v,y,"#2196F3"),f+=y+I,gf(e,"AI Update",pf(t,"aiUpdateTime"),g,f,v,y,"#FFC107"),e.fillStyle="#888",e.font="10px monospace",e.textAlign="center",e.fillText("Press '2' to toggle this panel",u+a/2,c+s-10),e.restore()}function SN(e){const{performanceMetrics:t}=e;if(!t||t.history.length===0)return 0;const i=t.history[t.history.length-1].bucketTime/(wt/_t);return t.history.filter(s=>i-s.bucketTime/(wt/_t)<1).length}function yN(e,t){if(e.length===0)return[];const i=new Map;for(const s of e){const u=Math.floor(s.bucketTime/(wt/_t));i.set(u,(i.get(u)||0)+s[t])}return Array.from(i.keys()).sort().map(s=>i.get(s)).slice(0,-1).slice(1).reverse()}function pf(e,t){return yN(e.performanceMetrics.history,t)}function Eh(e,t,i){if(!t.aiBlackboard)return;const o=t.aiBlackboard.nodeExecutionData,a=t.type==="human"?NS:t.type==="predator"?OS:t.type==="prey"?DS:null;if(!a)return;e.save(),e.font=`${HC}px Arial`,e.textAlign="left",e.textBaseline="top";const s=y=>{switch(y){case A.SUCCESS:return GC;case A.FAILURE:return xC;case A.RUNNING:return $C;case A.NOT_EVALUATED:case null:default:return WC}},u=y=>{if(!y.name||!o[y.name])return{width:0,height:0};let I=0,E=0;const T=o[y.name],w=` ${y.name}`+(T!=null&&T.debugInfo?`: ${T.debugInfo}`:""),O=e.measureText(w).width,L=(y.depth??0)*u0+8+O+d0+Ys+20;if(I=Math.max(I,L),E+=jd,y.children)for(const N of y.children){const H=u(N);I=Math.max(I,H.width),E+=H.height}else if(y.child){const N=u(y.child);I=Math.max(I,N.width),E+=N.height}return{width:I,height:E}},c=(y,I,E,T)=>{if(!y.name||!o[y.name])return I;let w=I;const O=o[y.name],L=E+2+(y.depth??0)*u0;let N=A.NOT_EVALUATED,H=c0,b="";if(O){N=O.status,b=O.debugInfo;const Q=YC/_t*wt,ee=i-O.lastExecuted,me=Math.max(0,1-ee/Q);H=XE(c0,zC,me),ee>va&&(N=A.NOT_EVALUATED)}const U=s(N);e.fillStyle=U,e.fillText("",L,w),e.fillStyle=H;const G=` ${y.name}`+(b?`: ${b}`:"");if(e.fillText(G,L+8,w),O&&O.executionHistory.length>0){const{executionHistory:Q}=O,ee=eS/_t*wt,me=i,be=me-ee,Ne=E+T-Ys-d0;let Ie=Ne;const he=w+(jd-Xl)/2,ke=Q.filter(K=>K.time<be);let ve=ke.length>0?ke[ke.length-1].status:null,te=be;const z=Q.filter(K=>K.time>=be&&K.time<=me),X=Ys/ee;e.fillStyle="rgba(255, 255, 255, 0.1)",e.fillRect(Ne,he,Ys,Xl);for(const K of z){const pe=(K.time-te)*X;pe>0&&(e.fillStyle=s(ve),e.fillRect(Ie,he,pe,Xl),Ie+=pe),ve=K.status,te=K.time}i-te>va&&(ve=A.NOT_EVALUATED);const P=(me-te)*X;e.fillStyle=s(ve);const B=Ne+Ys-Ie;e.fillRect(Ie,he,Math.min(P,B),Xl)}if(w+=jd,y.children)for(const Q of y.children)w=c(Q,w,E,T);else y.child&&(w=c(y.child,w,E,T));return w},{width:f,height:g}=u(a);if(g===0){e.restore();return}const m=t.position.x+UC,v=t.position.y+BC-g/2;e.fillStyle=bC,e.fillRect(m,v,f,g+4),c(a,v+2,m,f),e.restore()}const TN={moving:"walk",gathering:"gathering",eating:"eat",feeding:"eat",procreating:"procreate",idle:"idle",attacking:"attacking",planting:"gathering",depositing:"gathering",retrieving:"gathering",takingOverBuilding:"attacking",destroyingBuilding:"attacking"};function AN(e,t){var c;const{radius:i,position:o,activeAction:a="idle"}=t,s=((c=t.stateMachine)==null?void 0:c[0])||"N/A",u=t.isAdult?Rt+20:Rt*.6+20;e.save(),e.fillStyle="white",e.font="10px Arial",e.textAlign="center",e.fillText(`Action: ${a}`,o.x,o.y-u),e.fillText(`State: ${s}`,o.x,o.y-u+10),e.fillText(`HP: ${t.hitpoints}`,o.x,o.y-u+20),e.fillText(`Cooldown: ${t.attackCooldown||"N/A"}`,o.x,o.y-u+30),e.fillText(`Tribe: ${t.leaderId||"N/A"}`,o.x,o.y-u+40),e.restore(),e.beginPath(),e.arc(o.x,o.y,i,0,Math.PI*2),e.strokeStyle="rgba(255, 0, 0, 0.5)",e.lineWidth=1,e.stroke(),e.closePath()}function IN(e,t,i,o,a){e.save(),e.font=`${Mf}px Arial`,e.textAlign="center",e.textBaseline="middle",e.fillText(i,t.x,t.y-(o?Rt:es)-Mf-a),e.restore()}function EN(e,t,i,o,a){const s=t.x,u=t.y-i-o/2;e.save(),e.fillStyle=a,e.strokeStyle=a,e.lineWidth=1.5,e.beginPath(),e.rect(s-o/2,u,o,o/2),e.fill(),e.beginPath(),e.moveTo(s-o/2,u),e.lineTo(s-o/4,u-o/3),e.lineTo(s-o/6,u),e.moveTo(s-o/6,u),e.lineTo(s,u-o/2),e.lineTo(s+o/6,u),e.moveTo(s+o/6,u),e.lineTo(s+o/4,u-o/3),e.lineTo(s+o/2,u),e.stroke(),e.restore()}function CN(e,t,i){var c;const{position:o,radius:a}=t,s=o.x-Yd/2,u=o.y-a-DC;if(((c=t.stateMachine)==null?void 0:c[0])===ar){const f=t.stateMachine[1],g=i-f.attackStartTime,m=Math.min(g/Bv,1);nr(e,s,u,Yd,o0,m,Qi,OC)}else if(t.attackCooldown&&t.attackCooldown>0){const f=1-t.attackCooldown/Bu;nr(e,s,u,Yd,o0,f,Qi,MC)}}function wN(e,t,i){const a="";e.save(),e.font="15px Arial",e.textAlign="center",e.textBaseline="bottom",e.shadowColor="black",e.shadowBlur=3,e.fillText(a,t.x,t.y-i),e.restore()}function _N(e,t,i=!1,o=!1,a=!1,s=!1,u=!1,c=!1,f=!1,g=!1,m,v){const{position:y,activeAction:I="idle"}=t,E=t.isAdult?Rt:Rt*.6,T=TN[I]||"idle";Ih.render(e,y.x-E,y.y-E,E*2,E*2,t.animationProgress||0,T,t.gender,t.age,[t.direction.x,t.direction.y],t.isPregnant??!1,t.hunger),c&&(e.save(),e.strokeStyle=dC,e.lineWidth=2,e.beginPath(),e.arc(y.x,y.y,E+3,0,2*Math.PI),e.stroke(),e.restore());let w,O;if(u?(w=hC,O=jv):i?(w=fC,O=Wv):a?(w=gC,O=cC):o?(w=pC,O=zv):s&&(w=mC,O=Yv),w&&O&&EN(e,y,E,w,O),t.tribeBadge&&IN(e,y,t.tribeBadge,t.isAdult??!1,w??0),f){let N=(t.isAdult?Rt:es)+5;w&&(N+=w),t.tribeBadge&&(N+=Mf),wN(e,y,N)}const L=g&&(v===void 0||t.id===v);L&&t.aiBlackboard&&Eh(e,t,m),CN(e,t,m),L&&AN(e,t)}const RN={grazing:"eat",moving:"walk",procreating:"procreate",feeding:"eat",idle:"idle"};function PN(e,t){var c;const{radius:i,position:o,activeAction:a="idle"}=t,s=((c=t.stateMachine)==null?void 0:c[0])||"N/A",u=t.isAdult?Rt+20:Rt*.6+20;e.save(),e.fillStyle="white",e.font="10px Arial",e.textAlign="center",e.fillText(`Action: ${a}`,o.x,o.y-u),e.fillText(`State: ${s}`,o.x,o.y-u+10),e.fillText(`HP: ${t.hitpoints}`,o.x,o.y-u+20),e.fillText(`Hunger: ${Math.round(t.hunger)}`,o.x,o.y-u+30),e.fillText(`Age: ${Math.round(t.age)}`,o.x,o.y-u+40),e.restore(),e.beginPath(),e.arc(o.x,o.y,i,0,Math.PI*2),e.strokeStyle="rgba(0, 255, 0, 0.5)",e.lineWidth=1,e.stroke(),e.closePath()}function NN(e,t,i=!1,o=0,a){var m,v;const{position:s,activeAction:u="idle"}=t,c=t.isAdult?t.radius:t.radius*.6,f=RN[u]||"idle";if(xS.render(e,s.x-c,s.y-c,c*2,c*2,t.animationProgress||0,f,{gender:t.gender,age:t.age,direction:[((m=t.direction)==null?void 0:m.x)||1,((v=t.direction)==null?void 0:v.y)||0],isPregnant:t.isPregnant??!1,hungryLevel:t.hunger,geneCode:t.geneCode}),t.hitpoints<t.maxHitpoints){const y=c*1.5,I=3,E=s.x-y/2,T=s.y-c-8;e.fillStyle="#555",e.fillRect(E,T,y,I);const w=t.hitpoints/t.maxHitpoints;e.fillStyle=w>.5?"#4CAF50":w>.25?"#FFC107":"#F44336",e.fillRect(E,T,y*w,I)}const g=i&&(a===void 0||t.id===a);g&&t.aiBlackboard&&Eh(e,t,o),g&&PN(e,t)}const DN={attacking:"attacking",eating:"eat",moving:"walk",procreating:"procreate",feeding:"eat",idle:"idle"};function ON(e,t){var c;const{radius:i,position:o,activeAction:a="idle"}=t,s=((c=t.stateMachine)==null?void 0:c[0])||"N/A",u=t.isAdult?Rt+20:Rt*.6+20;e.save(),e.fillStyle="white",e.font="10px Arial",e.textAlign="center",e.fillText(`Action: ${a}`,o.x,o.y-u),e.fillText(`State: ${s}`,o.x,o.y-u+10),e.fillText(`HP: ${t.hitpoints}`,o.x,o.y-u+20),e.fillText(`Hunger: ${Math.round(t.hunger)}`,o.x,o.y-u+30),e.fillText(`Age: ${Math.round(t.age)}`,o.x,o.y-u+40),e.restore(),e.beginPath(),e.arc(o.x,o.y,i,0,Math.PI*2),e.strokeStyle="rgba(255, 0, 0, 0.5)",e.lineWidth=1,e.stroke(),e.closePath()}function MN(e,t,i=!1,o=0,a){var m,v;const{position:s,activeAction:u="idle"}=t,c=t.isAdult?t.radius:t.radius*.6,f=DN[u]||"idle";if($S.render(e,s.x-c,s.y-c,c*2,c*2,t.animationProgress||0,f,{gender:t.gender,age:t.age,direction:[((m=t.direction)==null?void 0:m.x)||1,((v=t.direction)==null?void 0:v.y)||0],isPregnant:t.isPregnant??!1,hungryLevel:t.hunger,geneCode:t.geneCode}),t.hitpoints<t.maxHitpoints){const y=c*1.5,I=3,E=s.x-y/2,T=s.y-c-8;e.fillStyle="#555",e.fillRect(E,T,y,I);const w=t.hitpoints/t.maxHitpoints;e.fillStyle=w>.5?"#4CAF50":w>.25?"#FFC107":"#F44336",e.fillRect(E,T,y*w,I)}(t.attackCooldown&&t.attackCooldown>0||t.huntCooldown&&t.huntCooldown>0)&&(e.strokeStyle="#FF8C00",e.lineWidth=3,e.beginPath(),e.arc(s.x,s.y,c+3,0,2*Math.PI),e.stroke());const g=i&&(a===void 0||t.id===a);g&&t.aiBlackboard&&Eh(e,t,o),g&&ON(e,t)}const WS=15;function H0(e,t,i,o,a=1.5){const s=i-t.startTime,u=Math.min(s/t.duration,1),c=1-u,g=1+Math.sin(u*Math.PI*2)*(a-1),m=WS*g;e.save(),e.globalAlpha=c,e.beginPath(),e.arc(t.position.x,t.position.y,Math.max(0,m),0,Math.PI*2),e.fillStyle=o,e.fill(),e.restore()}function _o(e,t,i,o,a=2){const s=i-t.startTime,u=Math.min(s/t.duration,1),c=1-u,f=WS*2*u;e.save(),e.globalAlpha=c,e.beginPath(),e.arc(t.position.x,t.position.y,f,0,Math.PI*2),e.strokeStyle=o,e.lineWidth=a,e.stroke(),e.restore()}function ji(e,t,i,o){const a=i-t.startTime,s=Math.min(a/t.duration,1),u=1-s,c=-20*s;e.save(),e.globalAlpha=u,e.font="20px Arial",e.textAlign="center",e.fillText(o,t.position.x,t.position.y+c),e.restore()}function kN(e,t,i){switch(t.type){case fe.Hunger:H0(e,t,i,"rgba(255, 165, 0, 0.7)",1);break;case fe.Procreation:ji(e,t,i,"");break;case fe.Pregnant:H0(e,t,i,"rgba(255, 105, 180, 0.7)",1.2);break;case fe.TargetAcquired:_o(e,t,i,"rgba(255, 0, 0, 0.8)",3);break;case fe.Attack:ji(e,t,i,"");break;case fe.Partnered:ji(e,t,i,"");break;case fe.BushClaimed:_o(e,t,i,"rgba(0, 255, 0, 0.7)",2);break;case fe.BushClaimLost:_o(e,t,i,"rgba(128, 128, 128, 0.7)",2);break;case fe.Eating:ji(e,t,i,"");break;case fe.ChildFed:ji(e,t,i,"");break;case fe.AttackDeflected:ji(e,t,i,"");break;case fe.AttackResisted:ji(e,t,i,"");break;case fe.Hit:ji(e,t,i,"");break;case fe.SeizeBuildup:_o(e,t,i,"rgba(255, 215, 0, 0.8)",4);break;case fe.Seize:_o(e,t,i,"rgba(148, 0, 211, 0.8)",4);break;case fe.CallToAttack:_o(e,t,i,"rgba(255, 255, 0, 0.8)",4);break}}function b0(e,t,i,o,a,s,u){e.save();const{position:c}=t;e.strokeStyle=o,e.lineWidth=a+Math.sin(u*s)*(a/2),e.setLineDash([8,8]),e.beginPath(),e.arc(c.x,c.y,i,0,2*Math.PI),e.stroke(),e.restore()}const G0=8,FN=1.5,LN=.5,x0=2,UN="#5a5a5a",BN="#7e7e7e",HN="#8B0000",bN="#FF4444",GN=6;function mf(e){const t=Math.sin(e)*1e4;return t-Math.floor(t)}function bf(e,t,i,o,a,s){const u=(t+i)*2,c=Math.floor(u/G0),f=-t/2,g=t/2,m=-i/2,v=i/2;for(let y=0;y<c;y++){const I=o+y*13,E=mf(I),T=mf(I+1);let w=y*G0,O=0,L=0;w<t?(O=f+w,L=m):w<t+i?(O=g,L=m+(w-t)):w<t*2+i?(O=g-(w-(t+i)),L=v):(O=f,L=v-(w-(t*2+i)));const N=(T-.5)*x0,H=(mf(I+2)-.5)*x0;e.beginPath();const b=FN+E*LN;a?e.fillStyle=a:e.fillStyle=E>.5?s||BN:a||UN,e.ellipse(O+N,L+H,b,b*.85,T*Math.PI,0,Math.PI*2),e.fill(),a||(e.strokeStyle="#2b2b2b",e.lineWidth=1,e.stroke())}}function xN(e,t){if(!t.storedFood||t.storedFood.length===0)return;const{position:i,storedFood:o}=t;e.save(),e.font=`${GN}px Arial`,e.textAlign="center",e.textBaseline="middle",e.shadowColor="rgba(0,0,0,0.5)",e.shadowBlur=2,o.forEach(a=>{const s=Qf[a.item.type],u={x:i.x+a.positionOffset.x,y:i.y+a.positionOffset.y};e.fillText(s,u.x,u.y)}),e.shadowBlur=0,e.shadowColor="transparent",e.restore()}function $N(e,t,i){const{position:o,width:a,height:s,constructionProgress:u,destructionProgress:c,isConstructed:f,isBeingDestroyed:g,id:m}=t,v=Pa[t.buildingType],y=pt(i),I=y&&Bn(y,t,i);e.save(),e.translate(o.x,o.y),f||(e.globalAlpha=.3+u*.7),I?bf(e,a,s,m,HN,bN):bf(e,a,s,m),e.globalAlpha=.5,e.font=`${Math.min(a,s,30)*.5}px Arial`,e.textAlign="center",e.textBaseline="middle",e.shadowColor="rgba(0,0,0,0.5)",e.shadowBlur=4,e.fillStyle="#FFFFFF",e.fillText(v.icon,0,0),e.shadowBlur=0,e.restore();const E=a,T=o.x-E/2,w=o.y+s/2+Xw;f?g&&nr(e,T,w,E,T0,1-c,Qi,Vw):nr(e,T,w,E,T0,u,Qi,jw),t.buildingType==="storageSpot"&&f&&xN(e,t)}function WN(e,t,i,o,a){const s=Pa[i],{width:u,height:c}=s.dimensions,f=(m,v)=>{m.save(),m.translate(v.x,v.y),m.globalAlpha=Yw;const y=o?"#4CAF50":"#F44336";bf(m,u,c,9999,y),m.font=`${Math.min(u,c)*.5}px Arial`,m.textAlign="center",m.textBaseline="middle",m.fillStyle=y,m.fillText(s.icon,0,0),m.restore()},g={position:{...t},radius:Math.max(u,c)/2,id:0,type:"building",direction:{x:0,y:0},acceleration:0,forces:[],velocity:{x:0,y:0},debuffs:[]};fn(e,a.width,a.height,(m,v)=>f(m,v.position),g)}function zN(e,t,i,o,a){const s=pt(t),u=s?hn(t,s):[],c=zr(u),{width:f,height:g}=t.mapDimensions;Object.values(t.entities.entities).sort((E,T)=>i&&E.id===t.debugCharacterId&&E.id!==T.id||E.type==="building"&&T.type!=="building"?-1:E.position.y-T.position.y||E.id-T.id).filter(E=>ou(E,o,a,t.mapDimensions)).forEach(E=>{var T,w;if(E.type==="building")fn(e,f,g,$N,E,t,s,t.time);else if(E.type==="berryBush")fn(e,f,g,iN,E,t,s,t.time);else if(E.type==="human"){const O=E,L=O.id===(s==null?void 0:s.id),N=u.some(me=>me.id===O.id),H=O.id===(c==null?void 0:c.id),b=s&&(O.id===s.motherId||O.id===s.fatherId),U=s&&(((T=O.partnerIds)==null?void 0:T.includes(s.id))||((w=s.partnerIds)==null?void 0:w.includes(O.id))),G=(s==null?void 0:s.attackTargetId)===O.id,Q=O.leaderId?t.entities.entities[O.leaderId]:void 0,ee=s?O.leaderId===s.id&&O.activeAction==="moving"&&O.target===O.leaderId&&(Q==null?void 0:Q.isCallingToFollow):!1;fn(e,f,g,_N,O,L,b,N,U,H,G,ee,i,t.time,t.debugCharacterId)}else E.type==="corpse"?fn(e,f,g,lN,E):E.type==="prey"?fn(e,f,g,NN,E,i,t.time,t.debugCharacterId):E.type==="predator"&&fn(e,f,g,MN,E,i,t.time,t.debugCharacterId)}),t.visualEffects.filter(E=>ou(E,o,a,t.mapDimensions)).forEach(E=>{fn(e,f,g,kN,E,t.time)});const I=t.notifications.filter(E=>!E.isDismissed);for(const E of I)if(E.highlightedEntityIds&&E.renderHighlights)for(const T of E.highlightedEntityIds){const w=t.entities.entities[T];w&&ou(w,o,a,t.mapDimensions)&&fn(e,f,g,b0,w,gw,pw,vw,mw,t.time)}if(t.tutorialState.isActive&&t.tutorialState.highlightedEntityIds.length>0)for(const E of t.tutorialState.highlightedEntityIds){const T=t.entities.entities[E];T&&ou(T,o,a,t.mapDimensions)&&fn(e,f,g,b0,T,tw,tS,nS,dh,t.time)}}function YN(e,t,i,o,a,s){let u=null,c=null;e.textAlign="left";let f=Ve+Ct;const m=t.time/(wt/_t)/Uu%1,v=js[Po.Time],y=25,I=Ve+y;e.fillText(v,Ve,f+un/2+Ct/3),nr(e,I,f,$i,un,m,Qi,EC),f+=un+hi;const E=f+Cr/2,T=f+(Cr-un)/2,w=5;_a(e,{x:Ve*2,y:E},Cr,5,i.gender,!1,!1,!1);const O=Ve+Cr+w,L=$i+y-(Cr+w)*2;nr(e,O,T,L,un,Math.floor(i.age)/Sa,Qi,IC),_a(e,{x:O+L+w+Cr/2,y:E},Cr,Sa,i.gender,!1,!1,!1),f+=un+hi*2;const N=[],H=new Set;if(N.push({member:i,isPlayer:!0,isHeir:!1,isPartner:!1,isParent:!1}),H.add(i.id),o&&!H.has(o.id)&&(N.push({member:o,isPlayer:!1,isHeir:!0,isPartner:!1,isParent:!1}),H.add(o.id)),a.forEach(he=>{H.has(he.id)||(N.push({member:he,isPlayer:!1,isHeir:!1,isPartner:!0,isParent:!1}),H.add(he.id))}),s.forEach(he=>{H.has(he.id)||(N.push({member:he,isPlayer:!1,isHeir:!1,isPartner:!1,isParent:!1}),H.add(he.id))}),i.motherId&&!H.has(i.motherId)){const he=t.entities.entities[i.motherId];he&&(N.push({member:he,isPlayer:!1,isHeir:!1,isPartner:!1,isParent:!0}),H.add(he.id))}if(i.fatherId&&!H.has(i.fatherId)){const he=t.entities.entities[i.fatherId];he&&(N.push({member:he,isPlayer:!1,isHeir:!1,isPartner:!1,isParent:!0}),H.add(he.id))}const b=js[Po.Family],U=10,G=Ve+Ct+U,Q=$i+y-(Ct+U),ee=f+Yl/2;e.font=`${Ct}px "Press Start 2P", Arial`,e.textBaseline="middle",e.fillText(b,Ve,ee);const me=f+Yl/2;qP(e,G,me,N,Yl,Q),f+=Yl+hi,e.textBaseline="alphabetic";const be=js[Po.Hitpoints];e.fillText(be,Ve,f+un/2+Ct/3),nr(e,I,f,$i,un,i.hitpoints/i.maxHitpoints,Qi,AC),f+=un+hi;const Ne=js[Po.Hunger];e.fillText(Ne,Ve,f+un/2+Ct/3),nr(e,I,f,$i,un,($r-i.hunger)/$r,Qi,TC),u={x:Ve,y:f-hi/2,width:$i+y,height:un+hi},f+=un+hi,e.textBaseline="middle";const Ie=js[Po.Food];return e.fillText(Ie,Ve,f+zl/2),uN(e,I,f+zl/2,i.food,zl,$i),c={x:Ve,y:f-hi/5,width:$i+y,height:zl+hi},e.textBaseline="alphabetic",{hungerBarRect:u,foodBarRect:c}}let qs=[],$0=0;const jN=36,VN=200;function XN(e,t,i,o){const a=t.search.prey.count(),s=t.search.predator.count(),u=t.search.berryBush.count();t.time-$0>=jN&&(qs.push({time:t.time,prey:a,predators:s,bushes:u}),qs.length>VN&&(qs=qs.slice(-200)),$0=t.time);const c=Xe*et,f=a/c*1e6,g=s/c*1e6,m=u/c*1e6,v=FP(),y=Math.floor(t.time/(24*365)),I=Math.floor(t.time%(24*365)/24),E=Math.floor(t.time%24),T=400,w=Math.min(o*.8,600),O=i-T-10,L=Ve+Ct*2;e.save(),e.fillStyle="rgba(0, 0, 0, 0.9)",e.fillRect(O,L,T,w),e.strokeStyle="#444",e.lineWidth=2,e.strokeRect(O,L,T,w),e.fillStyle="white",e.font="12px monospace",e.textAlign="left";let N=L+20;const H=14,b=O+15;e.fillStyle="#66ccff",e.font="bold 14px monospace",e.fillText(" Ecosystem Debugger",b,N),N+=25,e.fillStyle="white",e.font="12px monospace",e.fillText(`Game Time: Year ${y}, Day ${I}, Hour ${E}`,b,N),N+=H,e.fillText(`Map Size: ${Xe}  ${et} pixels`,b,N),N+=20,e.fillStyle="#66ccff",e.font="bold 13px monospace",e.fillText(" Q-Learning Status",b,N),N+=18,v&&(e.fillText(`Q-Table Size: ${v.qTableSize} entries`,b,N),N+=H,e.fillText(`Exploration Rate: ${(v.explorationRate*100).toFixed(1)}%`,b,N),N+=H);const U=qs.slice(-20);U.length>1&&(e.fillStyle="#66ccff",e.font="bold 13px monospace",e.fillText(" Population Trends (Last 20 Points)",b,N),N+=30,KN(e,b,N,U),N+=50),e.fillStyle="#66ccff",e.font="bold 13px monospace",e.fillText(" Density (per 1000 px)",b,N),N+=18,e.fillStyle="white",e.font="12px monospace";const G=(Si/c*1e6).toFixed(2),Q=(yi/c*1e6).toFixed(2),ee=(Ti/c*1e6).toFixed(2);e.fillText(`Prey: ${f.toFixed(2)} (target: ${G})`,b,N),N+=H,e.fillText(`Predators: ${g.toFixed(2)} (target: ${Q})`,b,N),N+=H,e.fillText(`Bushes: ${m.toFixed(2)} (target: ${ee})`,b,N),N+=20,e.fillStyle="#66ccff",e.font="bold 13px monospace",e.fillText(" Current Population Status",b,N),N+=18,e.fillStyle="white",e.font="12px monospace";const me=Math.round(a/Si*100),be=Math.round(s/yi*100),Ne=Math.round(u/Ti*100),Ie=he=>he<50?"#ff4444":he<80?"#ffaa44":he>120?"#44aaff":"#44ff44";e.fillStyle=Ie(me),e.fillText(`Prey: ${a}/${Si} (${me}%)`,b,N),N+=H,e.fillStyle=Ie(be),e.fillText(`Predators: ${s}/${yi} (${be}%)`,b,N),N+=H,e.fillStyle=Ie(Ne),e.fillText(`Bushes: ${u}/${Ti} (${Ne}%)`,b,N),N+=20,e.fillStyle="#66ccff",e.font="bold 13px monospace",e.fillText(" Current Parameters",b,N),N+=18,e.fillStyle="white",e.font="10px monospace",e.fillText("Prey:",b,N),N+=13,e.fillText(` Gestation: ${t.ecosystem.preyGestationPeriod.toFixed(1)}h`,b,N),N+=11,e.fillText(` Procreation: ${t.ecosystem.preyProcreationCooldown.toFixed(1)}h`,b,N),N+=11,e.fillText(` Hunger: ${t.ecosystem.preyHungerIncreasePerHour.toFixed(1)}/h`,b,N),N+=13,e.fillText("Predators:",b,N),N+=13,e.fillText(` Gestation: ${t.ecosystem.predatorGestationPeriod.toFixed(1)}h`,b,N),N+=11,e.fillText(` Procreation: ${t.ecosystem.predatorProcreationCooldown.toFixed(1)}h`,b,N),N+=11,e.fillText(` Hunger: ${t.ecosystem.predatorHungerIncreasePerHour.toFixed(1)}/h`,b,N),N+=13,e.fillText("Bushes:",b,N),N+=13,e.fillText(` Spread Chance: ${(t.ecosystem.berryBushSpreadChance*100).toFixed(1)}%`,b,N),N+=15,e.fillStyle="#888",e.font="10px monospace",e.textAlign="center",e.fillText("Press '1' to toggle this debugger",O+T/2,L+w-10),e.restore()}function KN(e,t,i,o){if(o.length<2)return;const c={prey:Math.max(...o.map(g=>g.prey),Si),predators:Math.max(...o.map(g=>g.predators),yi),bushes:Math.max(...o.map(g=>g.bushes),Ti)};[{data:o.map(g=>g.prey),color:"#44ff44",label:"Prey",target:Si,max:c.prey},{data:o.map(g=>g.predators),color:"#ff4444",label:"Predators",target:yi,max:c.predators},{data:o.map(g=>g.bushes),color:"#ffaa44",label:"Bushes",target:Ti,max:c.bushes}].forEach((g,m)=>{const v=t+m*115,y=i;e.fillStyle=g.color,e.font="10px monospace",e.fillText(g.label,v,y-5),e.strokeStyle="#333",e.lineWidth=1,e.strokeRect(v,y,100,30),e.beginPath(),e.strokeStyle=g.color;for(let E=0;E<g.data.length;E++){const T=v+E/(g.data.length-1)*100,w=y+30-g.data[E]/g.max*30;E===0?e.moveTo(T,w):e.lineTo(T,w)}e.stroke(),e.beginPath(),e.strokeStyle="#888",e.setLineDash([2,2]);const I=y+30-g.target/g.max*30;e.moveTo(v,I),e.lineTo(v+100,I),e.stroke(),e.setLineDash([])})}function ZN(e){const t=Object.values(e.entities.entities).filter(o=>o.type==="human"),i={total:t.length,children:0,males:0,females:0,old:0};for(const o of t)o.isAdult||i.children++,o.gender==="male"?i.males++:o.gender==="female"&&i.females++,o.age>=nh&&i.old++;return i}function qN(e){const t=Object.values(e.entities.entities),o=t.filter(c=>c.type==="berryBush").reduce((c,f)=>c+f.food.length,0),u=t.filter(c=>c.type==="building").filter(c=>c.buildingType===En.StorageSpot).reduce((c,f)=>{var g;return c+(((g=f.storedFood)==null?void 0:g.length)||0)},0);return{totalBushFood:o,totalStorageFood:u,consumptionRate:0}}function QN(e,t){const o=e.search.human.all(),a=e.entities.entities,s=new Map,u=(g,m=new Set)=>{if(s.has(g))return s.get(g);if(m.has(g))return g;m.add(g);const v=a[g];if(!v)return g;if(v.fatherId&&a[v.fatherId]){const y=u(v.fatherId,m);return s.set(g,y),y}return s.set(g,g),g},c=new Map;for(const g of o){const m=u(g.id);c.has(m)||c.set(m,[]),c.get(m).push(g)}const f=[];for(const[g,m]of c.entries()){const v=a[g];v&&f.push({patriarch:v,memberCount:m.length,members:m.map(y=>y.id)})}return f.sort((g,m)=>m.memberCount-g.memberCount),f.slice(0,t)}let Qs=[],ei=[],W0=0;const JN=36,z0=200;function eD(e,t,i,o){const a=ZN(t),s=qN(t);if(t.time-W0>=JN){Qs.push({time:t.time,total:a.total,children:a.children,males:a.males,females:a.females,old:a.old});const L=s.totalBushFood+s.totalStorageFood;ei.push({time:t.time,bushFood:s.totalBushFood,storageFood:s.totalStorageFood,totalFood:L}),Qs.length>z0&&(Qs=Qs.slice(-200)),ei.length>z0&&(ei=ei.slice(-200)),W0=t.time}let u=0;if(ei.length>=2){const L=ei[ei.length-1],N=ei[ei.length-2],H=L.time-N.time;H>0&&(u=(N.totalFood-L.totalFood)/H)}const c=400,f=Math.min(o*.9,700),g=i-c-10,m=Ve+Ct*2;e.save(),e.fillStyle="rgba(0, 0, 0, 0.9)",e.fillRect(g,m,c,f),e.strokeStyle="#444",e.lineWidth=2,e.strokeRect(g,m,c,f),e.fillStyle="white",e.font="12px monospace",e.textAlign="left";let v=m+20;const y=13,I=g+15;e.fillStyle="#66ccff",e.font="bold 14px monospace",e.fillText(" Tribe Debugger",I,v),v+=25,e.fillStyle="#66ccff",e.font="bold 13px monospace",e.fillText(" Population Over Time",I,v),v+=18,e.fillStyle="white",e.font="11px monospace",e.fillText(`Total: ${a.total}`,I,v),v+=y,e.fillStyle="#00ffff",e.fillText(`Children: ${a.children}`,I,v),v+=y,e.fillStyle="#4488ff",e.fillText(`Males: ${a.males}`,I,v),v+=y,e.fillStyle="#ff88ff",e.fillText(`Females: ${a.females}`,I,v),v+=y,e.fillStyle="#888888",e.fillText(`Old (${a.old})`,I,v),v+=20;const E=Qs.slice(-50);E.length>1&&(tD(e,I,v,E),v+=100),e.fillStyle="#66ccff",e.font="bold 13px monospace",e.fillText(" Food Metrics",I,v),v+=18;const T=s.totalBushFood+s.totalStorageFood;e.fillStyle="#ffff00",e.font="11px monospace",e.fillText(`Total Food: ${T}`,I,v),v+=y,e.fillStyle="#44ff44",e.fillText(`Bush Food: ${s.totalBushFood}`,I,v),v+=y,e.fillStyle="#ffaa44",e.fillText(`Storage Food: ${s.totalStorageFood}`,I,v),v+=y,e.fillStyle="#ff4444",e.fillText(`Consumption: ${u.toFixed(2)}/hour`,I,v),v+=20;const w=ei.slice(-50);w.length>1&&(nD(e,I,v,w),v+=100),e.fillStyle="#66ccff",e.font="bold 13px monospace",e.fillText(" Top 5 Families",I,v),v+=18;const O=QN(t,5);e.fillStyle="white",e.font="11px monospace",O.length===0?(e.fillText("No families found",I,v),v+=y):O.forEach((L,N)=>{const b=`${N+1}. ${L.patriarch.isPlayer?"Player":"#"+L.patriarch.id} (${L.memberCount} members, can split: ${Gu(L.patriarch,t).canSplit})`;e.fillText(b,I,v),v+=y}),v+=10,e.fillStyle="#888",e.font="10px monospace",e.textAlign="center",e.fillText("Press 'Shift+3' to toggle this debugger",g+c/2,m+f-10),e.restore()}function tD(e,t,i,o){if(o.length<2)return;const u=Math.max(...o.map(f=>Math.max(f.total,f.children,f.males,f.females,f.old)),10);e.strokeStyle="#333",e.lineWidth=1,e.strokeRect(t,i,350,80),[{data:o.map(f=>f.total),color:"#ffffff",label:"Total"},{data:o.map(f=>f.children),color:"#00ffff",label:"Children"},{data:o.map(f=>f.males),color:"#4488ff",label:"Males"},{data:o.map(f=>f.females),color:"#ff88ff",label:"Females"},{data:o.map(f=>f.old),color:"#888888",label:"Old"}].forEach(f=>{e.beginPath(),e.strokeStyle=f.color,e.lineWidth=2;for(let g=0;g<f.data.length;g++){const m=t+g/(f.data.length-1)*350,v=i+80-f.data[g]/u*80;g===0?e.moveTo(m,v):e.lineTo(m,v)}e.stroke()})}function nD(e,t,i,o){if(o.length<2)return;const u=Math.max(...o.map(f=>Math.max(f.totalFood,f.bushFood,f.storageFood)),10);e.strokeStyle="#333",e.lineWidth=1,e.strokeRect(t,i,350,80),[{data:o.map(f=>f.totalFood),color:"#ffff00",label:"Total"},{data:o.map(f=>f.bushFood),color:"#44ff44",label:"Bush"},{data:o.map(f=>f.storageFood),color:"#ffaa44",label:"Storage"}].forEach(f=>{e.beginPath(),e.strokeStyle=f.color,e.lineWidth=2;for(let g=0;g<f.data.length;g++){const m=t+g/(f.data.length-1)*350,v=i+80-f.data[g]/u*80;g===0?e.moveTo(m,v):e.lineTo(m,v)}e.stroke()})}function Y0(e,t,i){e.save();const{x:o,y:a,width:s,height:u}=t.rect,c=Xv;if(e.beginPath(),e.moveTo(o+c,a),e.lineTo(o+s-c,a),e.quadraticCurveTo(o+s,a,o+s,a+c),e.lineTo(o+s,a+u-c),e.quadraticCurveTo(o+s,a+u,o+s-c,a+u),e.lineTo(o+c,a+u),e.quadraticCurveTo(o,a+u,o,a+u-c),e.lineTo(o,a+c),e.quadraticCurveTo(o,a,o+c,a),e.closePath(),e.fillStyle=t.isDisabled?Kv:t.backgroundColor,e.fill(),t.activated){e.save();const f=(Math.sin(Date.now()/1e3*Jv)+1)/2;e.strokeStyle=Qv,e.lineWidth=2+f*2,e.globalAlpha=.7+f*.3,e.stroke(),e.restore()}if(t.lastActivated){const f=Date.now()-t.lastActivated;if(f<wu){const g=1-f/wu;e.fillStyle=qv,e.globalAlpha=g,e.fill(),e.globalAlpha=1}}i&&!t.isDisabled&&(e.fillStyle=ch,e.globalAlpha=.5,e.fill(),e.globalAlpha=1),e.fillStyle=t.isDisabled?Zv:t.textColor,t.icon?(e.font=`${u*.55}px "Press Start 2P", Arial`,e.textAlign="center",e.textBaseline="middle",e.fillText(t.icon,o+s/2,a+u/2),t.text&&(e.font=`${u*.18}px "Press Start 2P", Arial`,e.textAlign="right",e.textBaseline="bottom",e.fillText(t.text,o+s-4,a+u-2))):(e.font=`${Ct*1.5}px "Press Start 2P", Arial`,e.textAlign="center",e.textBaseline="middle",e.fillText(t.text,o+s/2,a+u/2)),e.restore()}function iD(e,t,i,o){e.save(),e.fillStyle="rgba(0, 0, 0, 0.6)",e.fillRect(0,0,i,o);const a=500,s=150,u=(i-a)/2,c=(o-s)/2;e.fillStyle=Yt,e.font=`${Ct*1.1}px "Press Start 2P", Arial`,e.textAlign="center",e.textBaseline="middle",e.fillText("Are you sure you want to exit",i/2,c+s/3-10),e.fillText("to the main menu?",i/2,c+s/3+10);const f=vi*1.5,g=Vv,m=c+s-g-Ve*2,v=20,y=f*2+v,I=u+(a-y)/2,E={id:"confirmExitYes",action:ie.ConfirmExitYes,rect:{x:I,y:m,width:f,height:g},text:"Yes",backgroundColor:Zi,textColor:Yt,currentWidth:f},T=I+f+v,w={id:"confirmExitNo",action:ie.ConfirmExitNo,rect:{x:T,y:m,width:f,height:g},text:"No",backgroundColor:Zi,textColor:Yt,currentWidth:f};t.uiButtons.push(E,w),Y0(e,E,t.hoveredButtonId===E.id),Y0(e,w,t.hoveredButtonId===w.id),e.restore()}const Pr=600,Ro=30,ti=60,Dt=30,rD="";function oD(e,t,i){const o=[];if(!i.tribeControl||!i.leaderId)return o;const{width:a,height:s}=e.canvas,u=(a-Pr)/2,c=450,f=(s-c)/2;e.save(),e.fillStyle="rgba(0, 0, 0, 0.9)",e.beginPath(),e.roundRect(u,f,Pr,c,10),e.fill(),e.strokeStyle="#444",e.lineWidth=2,e.stroke(),e.fillStyle=Yt,e.font=`${Ct*1.2}px "Press Start 2P", Arial`,e.textAlign="center",e.textBaseline="top",e.fillText("Tribe Roles",u+Pr/2,f+Ro);const g=30,m=u+Pr-Ro-g,v=f+Ro,y=t.hoveredButtonId==="roleManager_close";e.fillStyle=y?"#ff7777":"#ff5555",e.fillRect(m,v,g,g),e.fillStyle="#ffffff",e.font="20px Arial",e.textAlign="center",e.textBaseline="middle",e.fillText("X",m+g/2,v+g/2),o.push({id:"roleManager_close",action:ie.CloseRoleManager,rect:{x:m,y:v,width:g,height:g},text:"X",currentWidth:g,backgroundColor:"#ff5555",textColor:"#ffffff"});const E=jo(i.leaderId,t).filter(ee=>ee.isAdult),T={[He.Leader]:0,[He.Gatherer]:0,[He.Hunter]:0,[He.Mover]:0,[He.Warrior]:0};E.forEach(ee=>{ee.tribeRole&&T[ee.tribeRole]++});const w=i.tribeControl.roleWeights,O=[{role:He.Gatherer,emoji:"",name:"Gatherer"},{role:He.Hunter,emoji:"",name:"Hunter"},{role:He.Mover,emoji:"",name:"Mover"},{role:He.Warrior,emoji:"",name:"Warrior"}];let L=0;O.forEach(ee=>{L+=w[ee.role]||0});let N=f+Ro+70;const H=u+Ro,b=u+Pr-Ro;O.forEach(ee=>{const me=w[ee.role]||0,be=L>0?Math.round(me/L*100):0,Ne=T[ee.role]||0;e.textAlign="left",e.textBaseline="middle",e.font=`${Ct*.8}px "Press Start 2P", Arial`,e.fillStyle=Yt,e.fillText(`${ee.emoji} ${Ne} ${ee.name}`,H,N+ti/2);const Ie=u+220,he=Ie+Dt+15,ve=he+200+15,te=`role_minus_${ee.role}`,z=t.hoveredButtonId===te,X=me<=0,Y=X?"#555":z?"#dd6666":"#cc4444";e.fillStyle=Y,e.fillRect(Ie,N+(ti-Dt)/2,Dt,Dt),e.fillStyle=X?"#888":"#fff",e.textAlign="center",e.fillText("-",Ie+Dt/2,N+ti/2+2),o.push({id:te,action:ie.DecreaseRoleWeight,targetRole:ee.role,rect:{x:Ie,y:N+(ti-Dt)/2,width:Dt,height:Dt},text:"-",currentWidth:Dt,backgroundColor:Y,textColor:"#fff",isDisabled:X}),e.textAlign="left",e.font="16px Arial",e.fillStyle="#fff";let P=he;for(let oe=0;oe<me;oe++)e.fillText(rD,P,N+ti/2+2),P+=18;const B=`role_plus_${ee.role}`,K=t.hoveredButtonId===B,J=me>=10,pe=J?"#555":K?"#66dd66":"#44cc44";e.fillStyle=pe,e.fillRect(ve,N+(ti-Dt)/2,Dt,Dt),e.fillStyle=J?"#888":"#fff",e.textAlign="center",e.font=`${Ct*.8}px "Press Start 2P", Arial`,e.fillText("+",ve+Dt/2,N+ti/2+4),o.push({id:B,action:ie.IncreaseRoleWeight,targetRole:ee.role,rect:{x:ve,y:N+(ti-Dt)/2,width:Dt,height:Dt},text:"+",currentWidth:Dt,backgroundColor:pe,textColor:"#fff",isDisabled:J}),e.textAlign="right",e.font=`${Ct*.8}px "Press Start 2P", Arial`,e.fillStyle=Yt,e.fillText(`${be}%`,b,N+ti/2),N+=ti});const U=T[He.Leader],G=Object.values(T).reduce((ee,me)=>ee+me,0),Q=E.length-G;return e.textAlign="center",e.fillStyle="#aaa",e.font=`${Ct*.6}px "Press Start 2P", Arial`,e.fillText(`Adults: ${E.length} | Leader: ${U} | Assigned: ${G} | Unassigned: ${Q}`,u+Pr/2,N+10),e.fillText("(Adjust weights to control role distribution)",u+Pr/2,N+30),e.restore(),o}function Pu(e,t,i,o,a,s=!1){var f;if(e.save(),e.clearRect(0,0,e.canvas.width,e.canvas.height),e.fillStyle="#2c5234",e.fillRect(0,0,e.canvas.width,e.canvas.height),e.translate(e.canvas.width/2-i.x,e.canvas.height/2-i.y),!s&&t.gameOver){e.restore(),tN(e,t);return}zN(e,t,t.debugPanel===dt.General,i,a);const u=pt(t);if(u&&t.selectedBuildingType&&t.selectedBuildingType!=="removal"&&t.mousePosition){const g=Hf(t.mousePosition,i,a,t.mapDimensions),m=mh(g,t.selectedBuildingType,u.leaderId,t);WN(e,g,t.selectedBuildingType,m,t.mapDimensions)}const c=t.notifications.filter(g=>!g.isDismissed);for(const g of c){const m=(Math.sin(t.time*dw)+1)/2;e.globalAlpha=m*.5+.25,e.fillStyle=cw,g.targetArea&&e.fillRect(g.targetArea.x,g.targetArea.y,g.targetArea.width,g.targetArea.height),g.targetRadius&&(e.beginPath(),e.arc(g.targetRadius.x,g.targetRadius.y,g.targetRadius.radius,0,Math.PI*2),e.fill())}if(e.globalAlpha=1,hN(e,t),e.restore(),!s){e.fillStyle=vC,e.font=`${Ct}px "Press Start 2P", Arial`,e.shadowColor=SC,e.shadowBlur=yC,t.uiButtons=[];let g=null,m=null;if(u){const I=hn(t,u),E=zr(I),T=((f=u.partnerIds)==null?void 0:f.map(O=>t.entities.entities[O]).filter(O=>O!==void 0))||[],w=YN(e,t,u,E,T,I);g=w.hungerBarRect,m=w.foodBarRect}const v=Gv(t,u==null?void 0:u.leaderId);QP(e,t,v,e.canvas.width,e.canvas.height);const{commandButtonsRect:y}=bP(e,t,e.canvas.width);if(e.shadowColor="transparent",e.shadowBlur=0,u&&(cN(e,t,i,e.canvas.width,e.canvas.height),o.length>0&&WP(e,o,u,i,e.canvas.width,e.canvas.height,t.mapDimensions)),t.tutorialState.activeUIHighlights.length>0){const{activeUIHighlights:I}=t.tutorialState;I.includes(br.HUNGER_BAR)&&g&&ff(e,g,t.time),I.includes(br.FOOD_BAR)&&m&&ff(e,m,t.time),I.includes(br.COMMAND_BUTTONS)&&y&&ff(e,y,t.time)}if(t.tutorialState.isActive){const I=eN(e,t,e.canvas.width,e.canvas.height);I&&t.uiButtons.push({id:"tutorial-dismiss",action:ie.DismissTutorial,rect:I,text:"",currentWidth:I.width,backgroundColor:"transparent",textColor:"transparent"})}switch(pN(e,t,e.canvas.width,e.canvas.height),t.debugPanel){case dt.Ecosystem:XN(e,t,e.canvas.width,e.canvas.height);break;case dt.Tribe:eD(e,t,e.canvas.width,e.canvas.height);break;case dt.Performance:vN(e,t,a.width);break}if(t.roleManagerOpen&&u&&u.leaderId===u.id){const I=oD(e,t,u);t.uiButtons.push(...I)}t.isPaused&&t.exitConfirmation!=="pending"&&GP(e),t.exitConfirmation==="pending"&&iD(e,t,e.canvas.width,e.canvas.height)}}const sD=Rn.div`
  position: relative;
  width: 100vw;
  height: 100vh;
  overflow: hidden;
`,aD=Rn.canvas`
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background-color: #2c5234;
`,lD=Rn.div`
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  text-align: center;
  z-index: 1;
  background: linear-gradient(to bottom, rgba(0, 0, 0, 0.7) 0%, rgba(0, 0, 0, 0) 50%, rgba(0, 0, 0, 0.7) 100%);
`,uD=Rn.h1`
  font-family: 'Press Start 2P', cursive;
  font-size: 4rem;
  color: #fff;
  text-shadow: 4px 4px 0px #ff0000;
  margin-bottom: 2rem;
`,j0=Rn.button`
  font-family: 'Press Start 2P', cursive;
  font-size: 1.5rem;
  padding: 1rem 2rem;
  color: #fff;
  background-color: #ff0000;
  border: 2px solid #fff;
  box-shadow: 4px 4px 0px #fff;
  cursor: pointer;
  transition: all 0.2s ease-in-out;

  &:hover {
    background-color: #fff;
    color: #ff0000;
    box-shadow: 4px 4px 0px #ff0000;
  }
`,cD=Rn.div`
  display: flex;
  flex-direction: column;
  gap: 1.5rem;
  align-items: center;
`,dD=Rn.div`
  position: absolute;
  bottom: 1rem;
  font-family: 'Press Start 2P', cursive;
  font-size: 0.8rem;
  color: #fff;
  text-shadow: 2px 2px 0px #000;
  a {
    color: #fff;
    text-decoration: none;
    &:hover {
      text-decoration: underline;
    }
  }
`,lu="intro-soundtrack",V0=()=>{const{setAppState:e,savedGameState:t,clearCurrentSave:i}=Qo(),o=De.useRef(null),a=De.useRef(null),s=De.useRef($R()),u=De.useRef(),c=De.useRef(s.current.viewportCenter),f=De.useRef(),g=De.useCallback(()=>{Qd(lu,2),i(),e("game")},[e,i]),m=De.useCallback(()=>{t&&(Qd(lu,2),e("game"))},[e,t]);De.useEffect(()=>{const I=E=>{(E.key==="Enter"||E.key===" ")&&(t?m():g())};return window.addEventListener("keydown",I),()=>{window.removeEventListener("keydown",I)}},[g,m,t]),De.useEffect(()=>(hh(ge.SoundTrack1,{loop:!0,trackId:lu}),()=>{Qd(lu,2)}),[]),De.useEffect(()=>{const I=o.current;if(!I)return;a.current=I.getContext("2d");const E=()=>{I&&a.current&&(I.width=window.innerWidth,I.height=window.innerHeight,Pu(a.current,s.current,c.current,[],{width:I.width,height:I.height},!0))};return E(),window.addEventListener("resize",E),()=>window.removeEventListener("resize",E)},[]),De.useEffect(()=>{const I=()=>{const T=$v(s.current);if(T.length>0){const w=Math.floor(Math.random()*T.length);f.current=T[w].id}};I();const E=setInterval(I,pI);return()=>clearInterval(E)},[]);const[v,y]=Cv(I=>{var w,O;if(!a.current)return;if(u.current===void 0){u.current=I;return}const E=Math.min((I-u.current)/1e3,1);s.current=$u(s.current,E);const T=f.current?s.current.entities.entities[f.current]:void 0;if(T){const{mapDimensions:L}=s.current,{width:N,height:H}=L;let b={...T.position};const U=b.x-c.current.x;Math.abs(U)>N/2&&(U>0?b.x-=N:b.x+=N);const G=b.y-c.current.y;Math.abs(G)>H/2&&(G>0?b.y-=H:b.y+=H);let Q=sh(c.current,b,qf*E);Q={x:(Q.x%N+N)%N,y:(Q.y%H+H)%H},c.current=Q}Pu(a.current,s.current,c.current,[],{width:((w=o.current)==null?void 0:w.width)||800,height:((O=o.current)==null?void 0:O.height)||600},!0),u.current=I});return De.useEffect(()=>(y(),v),[y,v]),Le.jsxs(sD,{children:[Le.jsx(aD,{ref:o}),Le.jsxs(lD,{children:[Le.jsx(uD,{children:"Tribe2"}),Le.jsxs(cD,{children:[Le.jsx(j0,{onClick:g,children:"New Game"}),t&&Le.jsx(j0,{onClick:m,children:"Load Game"})]}),Le.jsxs(dD,{children:["by"," ",Le.jsx("a",{href:"https://github.com/gtanczyk",target:"_blank",rel:"noopener noreferrer",children:"gtanczyk"})]})]})]})};function fD(){console.log("Tribe game initialized with detailed 2D world state.");const e=xR();return e.ecosystem={preyGestationPeriod:Fr,preyProcreationCooldown:Lr,predatorGestationPeriod:Ur,predatorProcreationCooldown:Br,preyHungerIncreasePerHour:Ji,predatorHungerIncreasePerHour:er,berryBushSpreadChance:Ai},e.debugPanel=dt.None,e.performanceMetrics={currentBucket:{renderTime:0,worldUpdateTime:0,aiUpdateTime:0},history:[]},e}const hD=({canvasRef:e,ctxRef:t,gameStateRef:i,viewportCenterRef:o,playerActionHintsRef:a})=>(De.useEffect(()=>{const s=e.current;if(!s)return;t.current=s.getContext("2d");const u=()=>{s&&t.current&&i.current&&(s.width=window.innerWidth,s.height=window.innerHeight,Pu(t.current,i.current,o.current,a.current,{width:s.width,height:s.height},!1))};return u(),window.addEventListener("resize",u),()=>window.removeEventListener("resize",u)},[]),Le.jsx("canvas",{ref:e,style:{display:"block",background:"#2c5234"}})),gD=(e,t,i,o=!1)=>{var u;let a;const s=lC(e,i);if(s){if(t.isAdult&&s.type==="berryBush"&&s.food.length>0)a={action:ue.AutopilotGather,targetEntityId:s.id};else if(t.isAdult&&s.type==="corpse"&&s.food.length>0)a={action:ue.AutopilotGather,targetEntityId:s.id};else if(s.type==="human"){const c=s;t.isAdult&&ts(t,c,i)?a={action:ue.AutopilotAttack,targetEntityId:c.id}:jr(t,c,i)?a={action:ue.AutopilotProcreate,targetEntityId:c.id}:t.food.length>0&&!c.isAdult&&(c.motherId===t.id||c.fatherId===t.id)&&(a={action:ue.AutopilotFeedChild,targetEntityId:c.id})}else if(s.type==="prey")a={action:ue.AutopilotAttack,targetEntityId:s.id};else if(s.type==="predator")a={action:ue.AutopilotAttack,targetEntityId:s.id};else if(s.type==="building"){const c=s;if(i.selectedBuildingType==="removal")a={action:ue.Removal,position:s.position};else if(c.buildingType==="storageSpot"){const f=c.ownerId===t.leaderId,g=c.storedFood!==void 0&&c.storedFood.length>0,m=c.storedFood!==void 0&&c.storageCapacity!==void 0&&c.storedFood.length<c.storageCapacity;if(o&&c.isConstructed&&g&&t.food.length<t.maxFood)if(f)a={action:ue.AutopilotRetrieve,targetEntityId:s.id};else{const v=t.leaderId?i.entities.entities[t.leaderId]:void 0;v&&((u=v.tribeControl)!=null&&u.diplomacy)?v.tribeControl.diplomacy[c.ownerId]===St.Hostile?a={action:ue.AutopilotGather,targetEntityId:s.id}:a={action:ue.AutopilotMove,position:e}:a={action:ue.AutopilotMove,position:e}}else f&&c.isConstructed?t.food.length>0&&m?a={action:ue.AutopilotDeposit,targetEntityId:s.id}:t.food.length<t.maxFood&&g?a={action:ue.AutopilotRetrieve,targetEntityId:s.id}:a={action:ue.AutopilotMove,position:e}:a={action:ue.AutopilotMove,position:e}}else c.buildingType==="plantingZone"&&t.food.filter(f=>f.type===Gn.Berry).length>=Gr&&!xn(e,i,xr)?a={action:ue.AutopilotPlant,position:e}:a={action:ue.AutopilotMove,position:e}}}else t.food.filter(c=>c.type===Gn.Berry).length>=Gr&&(i.autopilotControls.isManuallyPlanting||c_(e,t,i))?a={action:ue.AutopilotPlant,position:e}:a={action:ue.AutopilotMove,position:e};return a},pD=(e,t)=>{if(e.isPaused)return;const i=pt(e);if(!i)return;if(e.selectedBuildingType&&e.selectedBuildingType!=="removal"){mh(t,e.selectedBuildingType,i.leaderId,e)&&(dS(t,e.selectedBuildingType,i.leaderId,e),e.selectedBuildingType=null);return}if(e.selectedBuildingType==="removal"){const a=Qw(t,e);a&&qw(a.id,e);return}const o=e.autopilotControls.hoveredAutopilotAction;e.autopilotControls.activeAutopilotAction=void 0,o?(e.autopilotControls.activeAutopilotAction=o,(o.action===ue.AutopilotMove||o.action===ue.AutopilotGather)&&(e.hasPlayerMovedEver=!0),o.action===ue.AutopilotPlant&&(e.hasPlayerPlantedBush=!0)):e.autopilotControls.activeAutopilotAction={action:ue.AutopilotMove,position:t},e.autopilotControls.isManuallyMoving=!1,e.autopilotControls.isManuallyPlanting=!1},mD=(e,t)=>{var u,c,f,g,m,v;const i=e.key.toLowerCase(),o=e.ctrlKey||e.metaKey;let a=!0,s=t;if(o){switch(i){case"s":Wf(t);break;default:a=!1;break}return{newState:s,handled:a}}switch(i){case"escape":const{autopilotControls:y}=t;y.activeAutopilotAction||y.isManuallyMoving||y.isManuallyPlanting||t.buildMenuOpen||t.selectedBuildingType?(y.activeAutopilotAction=void 0,y.isManuallyMoving=!1,y.isManuallyPlanting=!1,t.buildMenuOpen=!1,t.selectedBuildingType=null):s.exitConfirmation==="pending"?(s.exitConfirmation="inactive",s.isPaused=!1):(s.exitConfirmation="pending",s.isPaused=!0);break;case"u":const I=pt(t);I&&I.isAdult&&I.leaderId===I.id&&(t.roleManagerOpen=!t.roleManagerOpen);break;case"m":t.isMuted=!t.isMuted,aa(t.masterVolume,t.isMuted);break;case"=":case"+":const E=Math.min(1,t.masterVolume+.1);t.masterVolume=parseFloat(E.toFixed(1)),aa(t.masterVolume,t.isMuted);break;case"-":const T=Math.max(0,t.masterVolume-.1);t.masterVolume=parseFloat(T.toFixed(1)),aa(t.masterVolume,t.isMuted);break;case"t":s=$u(t,sS);break;case" ":case"p":t.isPaused=!t.isPaused;break;case"":case"`":s.debugPanel===dt.General?(s.debugPanel=dt.None,s.debugCharacterId=void 0):(s.debugPanel=dt.General,s.debugCharacterId||(s.debugCharacterId=((u=pt(s))==null?void 0:u.id)??((c=Object.values(s.entities.entities).find(O=>O.type==="human"||O.type==="prey"||O.type==="predator"))==null?void 0:c.id)));break;case"!":if(e.shiftKey){if(s.debugPanel===dt.Ecosystem){s.debugPanel=dt.None;break}s.debugPanel=dt.Ecosystem,s.debugCharacterId||(s.debugCharacterId=((f=pt(s))==null?void 0:f.id)??((g=Object.values(s.entities.entities).find(O=>O.type==="human"||O.type==="prey"||O.type==="predator"))==null?void 0:g.id))}else a=!1;break;case"#":if(e.shiftKey&&s.debugPanel===dt.Tribe){s.debugPanel=dt.None;break}s.debugPanel=dt.Tribe,s.debugCharacterId?a=!1:s.debugCharacterId=((m=pt(s))==null?void 0:m.id)??((v=Object.values(s.entities.entities).find(O=>O.type==="human"||O.type==="prey"||O.type==="predator"))==null?void 0:v.id);break;case"@":if(e.shiftKey){if(s.debugPanel===dt.Performance){s.debugPanel=dt.None;break}s.debugPanel=dt.Performance}else a=!1;break;case"tab":s.debugPanel=dt.General;const w=Object.values(s.entities.entities).filter(O=>O.type==="human"||O.type==="prey"||O.type==="predator");if(w.length>0){const O=w.sort((b,U)=>{if(b.type==="human"&&b.isPlayer)return-1;if(U.type==="human"&&U.isPlayer)return 1;if(b.type!==U.type){const G={human:0,prey:1,predator:2},Q=G[b.type]??999,ee=G[U.type]??999;return Q-ee}return b.id-U.id}),L=s.debugCharacterId,H=((L?O.findIndex(b=>b.id===L):-1)+1)%O.length;s.debugCharacterId=O[H].id}else s.debugCharacterId=void 0;break;default:a=!1;break}return{newState:s,handled:a}},vD=(e,t,i,o,a)=>{const s={gameState:i};if(t&&["e","b","r","h"].includes(e)&&i.hasPlayerEnabledAutopilot++,i.buildMenuOpen){if(e==="1"){i.selectedBuildingType="storageSpot",we(s,ge.ButtonClick,o.position);return}else if(e==="2"){i.selectedBuildingType="plantingZone",we(s,ge.ButtonClick,o.position);return}else if(e==="3"){i.selectedBuildingType="removal",we(s,ge.ButtonClick,o.position);return}}if(e==="escape"&&i.selectedBuildingType){i.selectedBuildingType=null;return}if(e==="e"){if(t){i.autopilotControls.behaviors.gathering=!i.autopilotControls.behaviors.gathering;return}const u=Oe(o,i,"berryBush",yt,g=>g.food.length>0&&o.food.length<o.maxFood),c=Oe(o,i,"corpse",yt,g=>g.food.length>0&&o.food.length<o.maxFood);let f=null;u&&c?f=j(o.position,u.position,i.mapDimensions.width,i.mapDimensions.height)<=j(o.position,c.position,i.mapDimensions.width,i.mapDimensions.height)?u:c:f=u||c,f&&(o.activeAction="gathering",we(s,ge.Gather,o.position))}else if(e==="r"){if(t){i.autopilotControls.behaviors.procreation=!i.autopilotControls.behaviors.procreation;return}Oe(o,i,"human",yt,c=>jr(o,c,i))&&(o.activeAction="procreating",we(s,ge.Procreate,o.position))}else if(e==="f")o.food.length>0&&(o.activeAction="eating",we(s,ge.Eat,o.position));else if(e==="h"){if(t){i.autopilotControls.behaviors.feedChildren=!i.autopilotControls.behaviors.feedChildren;return}const u=a.find(c=>c.type===ue.FeedChild);u&&u.targetEntity&&(o.activeAction="feeding",o.target=u.targetEntity.id)}else if(e==="arrowup"||e==="w")o.direction.y=-1,o.activeAction="moving",o.target=void 0,i.hasPlayerMovedEver=!0,i.autopilotControls.isManuallyMoving=!0,i.autopilotControls.activeAutopilotAction=void 0;else if(e==="arrowdown"||e==="s")o.direction.y=1,o.activeAction="moving",o.target=void 0,i.hasPlayerMovedEver=!0,i.autopilotControls.isManuallyMoving=!0,i.autopilotControls.activeAutopilotAction=void 0;else if(e==="arrowleft"||e==="a")o.direction.x=-1,o.activeAction="moving",o.target=void 0,i.hasPlayerMovedEver=!0,i.autopilotControls.isManuallyMoving=!0,i.autopilotControls.activeAutopilotAction=void 0;else if(e==="arrowright"||e==="d")o.direction.x=1,o.activeAction="moving",o.target=void 0,i.hasPlayerMovedEver=!0,i.autopilotControls.isManuallyMoving=!0,i.autopilotControls.activeAutopilotAction=void 0;else if(e==="q"){if(t){i.autopilotControls.behaviors.attack=!i.autopilotControls.behaviors.attack;return}const u=Oe(o,i,"human",ri,c=>ts(o,c,i))??Oe(o,i,"predator",ri)??Oe(o,i,"prey",ri);u&&(o.activeAction="attacking",o.attackTargetId=u.id)}else if(e==="b"){if(t){i.autopilotControls.behaviors.planting=!i.autopilotControls.behaviors.planting;return}if(a.find(c=>c.type===ue.Plant)){const c=JE(o.position,i,50,Nf);c&&(o.activeAction="planting",o.target=c,i.hasPlayerPlantedBush=!0)}}else if(e==="x"){if(t){i.autopilotControls.behaviors.gathering=!i.autopilotControls.behaviors.gathering;return}const u=Oe(o,i,"building",_n,c=>{const f=c;return f.buildingType==="storageSpot"&&f.ownerId===o.leaderId&&f.isConstructed&&f.storedFood!==void 0&&f.storageCapacity!==void 0&&f.storedFood.length<f.storageCapacity});u&&(o.activeAction="idle",o.target=u.id,we(s,ge.StorageDeposit,o.position))}else if(e==="z"){if(t){i.autopilotControls.behaviors.feedChildren=!i.autopilotControls.behaviors.feedChildren;return}const u=Oe(o,i,"building",_n,c=>{const f=c;return f.buildingType==="storageSpot"&&f.ownerId===o.leaderId&&f.isConstructed&&f.storedFood!==void 0&&f.storedFood.length>0});u&&(o.activeAction="idle",o.target=u.id,we(s,ge.StorageRetrieve,o.position))}else e==="v"?(o.isCallingToAttack=!0,o.callToAttackEndTime=i.time+Xo,Me(i,fe.CallToAttack,o.position,Xo),we(s,ge.CallToAttack,o.position)):e==="c"?(o.isCallingToFollow=!0,o.callToFollowEndTime=i.time+ya,Me(i,fe.CallToFollow,o.position,ya),we(s,ge.CallToFollow,o.position)):e==="k"?gh(o,i):e==="l"&&(i.buildMenuOpen=!i.buildMenuOpen,we(s,ge.ButtonClick,o.position))},SD=(e,t,i,o)=>{e==="arrowup"||e==="w"||e==="arrowdown"||e==="s"?t.direction.y=0:(e==="arrowleft"||e==="a"||e==="arrowright"||e==="d")&&(t.direction.x=0),!o.current.has("arrowup")&&!o.current.has("arrowdown")&&!o.current.has("arrowleft")&&!o.current.has("arrowright")&&!o.current.has("w")&&!o.current.has("a")&&!o.current.has("s")&&!o.current.has("d")&&(t.activeAction==="moving"&&(t.activeAction="idle"),i.autopilotControls.isManuallyMoving=!1),!o.current.has("e")&&t.activeAction==="gathering"&&(t.activeAction="idle"),!o.current.has("f")&&t.activeAction==="eating"&&(t.activeAction="idle"),!o.current.has("r")&&t.activeAction==="procreating"&&(t.activeAction="idle"),!o.current.has("h")&&t.activeAction==="feeding"&&(t.activeAction="idle")},yD=(e,t,i)=>{let a=pt(e);if(e.debugCharacterId){const s=e.entities.entities[e.debugCharacterId];s&&"position"in s&&(a=s)}if(a){const{mapDimensions:s}=e,{width:u,height:c}=s;let f={...a.position};const g=f.x-t.x;Math.abs(g)>u/2&&(g>0?f.x-=u:f.x+=u);const m=f.y-t.y;Math.abs(m)>c/2&&(m>0?f.y-=c:f.y+=c);let v=sh(t,f,qf*i);return v={x:(v.x%u+u)%u,y:(v.y%c+c)%c},v}return e.viewportCenter};function TD(e,t){const{width:i,height:o}=e.mapDimensions;e.viewportCenter={x:(t.x%i+i)%i,y:(t.y%o+o)%o}}const AD=(e,t,i,o)=>{var f,g;const a={gameState:i},s=pt(i);s&&we(a,ge.ButtonClick,s.position);const u=i.uiButtons.find(m=>m.id===e.id);u&&(u.lastActivated=Date.now()),t&&[ie.CommandGather,ie.CommandPlant,ie.ToggleProcreationBehavior,ie.CommandBuild].includes(e.action)&&i.hasPlayerEnabledAutopilot++;const{behaviors:c}=i.autopilotControls;switch(e.action){case ie.ReturnToIntro:i.exitConfirmation="pending",i.isPaused=!0;break;case ie.ConfirmExitYes:o(),i.exitConfirmation="inactive";break;case ie.ConfirmExitNo:i.exitConfirmation="inactive",i.isPaused=!1;break;case ie.ToggleMute:i.isMuted=!i.isMuted,aa(i.masterVolume,i.isMuted);break;case ie.TogglePause:i.isPaused=!i.isPaused;break;case ie.FastForward:return $u(i,sS);case ie.DismissTutorial:i.tutorialState.isActive=!1;break;case ie.CommandEat:s&&s.food.length>0&&(s.activeAction="eating");break;case ie.CommandGather:t?c.gathering=!c.gathering:s&&(s.activeAction="gathering");break;case ie.CommandPlant:t?c.planting=!c.planting:s&&(i.autopilotControls.isManuallyPlanting=!0);break;case ie.ToggleProcreationBehavior:c.procreation=!c.procreation;break;case ie.ToggleAttackBehavior:c.attack=!c.attack;break;case ie.ToggleFeedChildBehavior:c.feedChildren=!c.feedChildren;break;case ie.ToggleAutopilotFollowLeaderBehavior:c.followLeader=!c.followLeader;break;case ie.CommandCallToAttack:s&&s.leaderId===s.id&&(s.isCallingToAttack=!0,s.callToAttackEndTime=i.time+Xo,Me(i,fe.CallToAttack,s.position,Xo),we(a,ge.CallToAttack,s.position));break;case ie.CommandFollowMe:t?c.followLeader=!c.followLeader:s&&s.leaderId===s.id&&(s.isCallingToFollow=!0,s.callToFollowEndTime=i.time+ya,Me(i,fe.CallToFollow,s.position,ya),we(a,ge.CallToFollow,s.position));break;case ie.CommandTribeSplit:s&&gh(s,i);break;case ie.CommandBuild:t?c.build=!c.build:i.buildMenuOpen=!i.buildMenuOpen;break;case ie.SelectStorageSpot:i.selectedBuildingType="storageSpot";break;case ie.SelectPlantingZone:i.selectedBuildingType="plantingZone";break;case ie.SelectRemovalTool:i.selectedBuildingType="removal";break;case ie.ToggleDiplomacy:if(s&&s.leaderId&&e.targetTribeId){const m=s.leaderId,v=e.targetTribeId,y=i.entities.entities[v],I=(f=s.tribeControl)==null?void 0:f.diplomacy,E=(g=y==null?void 0:y.tribeControl)==null?void 0:g.diplomacy;if(I&&E){const w=(I[v]||St.Friendly)===St.Friendly?St.Hostile:St.Friendly;I[v]=w,E[m]=w}}break;case ie.OpenRoleManager:i.roleManagerOpen=!0;break;case ie.CloseRoleManager:i.roleManagerOpen=!1;break;case ie.IncreaseRoleWeight:if(s&&s.tribeControl&&e.targetRole){const m=s.tribeControl.roleWeights[e.targetRole]||0;m<10&&(s.tribeControl.roleWeights[e.targetRole]=m+1)}break;case ie.DecreaseRoleWeight:if(s&&s.tribeControl&&e.targetRole){const m=s.tribeControl.roleWeights[e.targetRole]||0;m>0&&(s.tribeControl.roleWeights[e.targetRole]=m-1)}break}return i};function ID(e,t,i){if(!e.notificationButtonRects)return!1;const o=pt(e);for(const[a,s]of Object.entries(e.notificationButtonRects.dismiss))if(t>=s.x&&t<=s.x+s.width&&i>=s.y&&i<=s.y+s.height)return _w(e,a),o&&we({gameState:e},ge.ButtonClick,o.position),!0;for(const[a,s]of Object.entries(e.notificationButtonRects.view))if(t>=s.x&&t<=s.x+s.width&&i>=s.y&&i<=s.y+s.height){const u=e.notifications.find(c=>c.id===a);if(u){let c=u.targetPosition;if(!c&&u.targetEntityIds&&u.targetEntityIds.length>0){const f=e.entities.entities[u.targetEntityIds[0]];f&&(c=f.position)}return c&&TD(e,c),o&&we({gameState:e},ge.ButtonClick,o.position),u.highlightedEntityIds&&(u.renderHighlights=!u.renderHighlights),!0}}return!1}const ED=({isActive:e,gameStateRef:t,canvasRef:i,viewportCenterRef:o,playerActionHintsRef:a,keysPressed:s,returnToIntro:u})=>(De.useEffect(()=>{const c=f=>{if(!e()||t.current.gameOver||!i.current||!f.target||f.target!==i.current)return;const g=i.current.getBoundingClientRect(),m=f.clientX-g.left,v=f.clientY-g.top;if(ID(t.current,m,v))return;const I=t.current.uiButtons.find(T=>m>=T.rect.x&&m<=T.rect.x+T.rect.width&&v>=T.rect.y&&v<=T.rect.y+T.rect.height);if(I){t.current=AD(I,f.shiftKey,t.current,u);return}const E=Hf({x:m,y:v},o.current,{width:i.current.width,height:i.current.height},t.current.mapDimensions);pD(t.current,E)};return window.addEventListener("mousedown",c),()=>{window.removeEventListener("mousedown",c)}},[e,i,t,o,u]),De.useEffect(()=>{const c=f=>{if(!e()||!i.current)return;const g=i.current.getBoundingClientRect(),m=f.clientX-g.left,v=f.clientY-g.top;t.current.mousePosition={x:m,y:v};let y;if(t.current.notificationButtonRects){for(const[E,T]of Object.entries(t.current.notificationButtonRects.dismiss))if(m>=T.x&&m<=T.x+T.width&&v>=T.y&&v<=T.y+T.height){y=`notification-dismiss-${E}`;break}if(!y){for(const[E,T]of Object.entries(t.current.notificationButtonRects.view))if(m>=T.x&&m<=T.x+T.width&&v>=T.y&&v<=T.y+T.height){y=`notification-view-${E}`;break}}}if(!y)for(let E=t.current.uiButtons.length-1;E>=0;E--){const T=t.current.uiButtons[E];if(m>=T.rect.x&&m<=T.rect.x+T.rect.width&&v>=T.rect.y&&v<=T.rect.y+T.rect.height){y=T.id;break}}if(t.current.hoveredButtonId=y,y){t.current.autopilotControls.hoveredAutopilotAction=void 0;return}const I=pt(t.current);if(I){const E=Hf({x:m,y:v},o.current,{width:i.current.width,height:i.current.height},t.current.mapDimensions);t.current.autopilotControls.hoveredAutopilotAction=gD(E,I,t.current,f.shiftKey)}else t.current.autopilotControls.hoveredAutopilotAction=void 0};return window.addEventListener("mousemove",c),()=>{window.removeEventListener("mousemove",c)}},[e,i,t,o]),De.useEffect(()=>{const c=g=>{if(!e()||t.current.gameOver)return;const m=g.key.toLowerCase();(m===" "||m==="p"||m==="tab"||(g.ctrlKey||g.metaKey)&&(m==="s"||m==="a"))&&g.preventDefault();const v=mD(g,t.current);if(t.current=v.newState,v.handled)return;const y=pt(t.current);y&&(s.current.add(m),vD(m,g.shiftKey,t.current,y,a.current))},f=g=>{if(!e()||t.current.gameOver)return;const m=g.key.toLowerCase();s.current.delete(m);const v=pt(t.current);v&&SD(m,v,t.current,s)};return window.addEventListener("keydown",c),window.addEventListener("keyup",f),()=>{window.removeEventListener("keydown",c),window.removeEventListener("keyup",f)}},[e,t,a,s,u]),null),CD=({gameStateRef:e,ctxRef:t,debugPanelTypeRef:i,viewportCenterRef:o,playerActionHintsRef:a,keysPressed:s,canvasRef:u,setAppState:c,appState:f})=>{const g=De.useRef(),{returnToIntro:m}=Qo(),[v,y,I]=Cv(E=>{var H,b;if(!t.current||!g.current){g.current=E;return}const T=Math.min(E-g.current,1e3)/1e3,{performanceMetrics:w}=e.current;w.currentBucket={renderTime:0,worldUpdateTime:0,aiUpdateTime:0};const O=performance.now();e.current=$u(e.current,T),w.currentBucket.worldUpdateTime=performance.now()-O;const L=pt(e.current);L?a.current=ph(e.current,L):a.current=[],o.current=yD(e.current,o.current,T);const N=performance.now();Pu(t.current,e.current,o.current,a.current,{width:((H=u.current)==null?void 0:H.width)||800,height:((b=u.current)==null?void 0:b.height)||600},!1),w.currentBucket.renderTime=performance.now()-N,w.history.push({bucketTime:e.current.time,...w.currentBucket}),w.history.length>mI&&w.history.shift(),g.current=E,e.current.gameOver&&f!=="gameOver"&&(hh(ge.GameOver,{masterVolume:e.current.masterVolume,isMuted:e.current.isMuted}),c("gameOver",{generations:e.current.generationCount,cause:e.current.causeOfGameOver||"Unknown"}))});return De.useEffect(()=>(y(),v),[y,v]),Le.jsx(ED,{isActive:I,gameStateRef:e,canvasRef:u,viewportCenterRef:o,playerActionHintsRef:a,debugPanelTypeRef:i,keysPressed:s,returnToIntro:m})},X0=()=>{const{savedGameState:e,contextReady:t}=Qo(),[i,o]=De.useState(null);return De.useEffect(()=>{t&&(e?(console.log("Loading saved game state..."),o(e)):(console.log("Initializing new game state..."),o(fD())))},[t,e]),!t||!i?Le.jsx("div",{children:"Loading..."}):Le.jsx(wD,{initialState:i})},wD=({initialState:e})=>{const t=De.useRef(null),i=De.useRef(null),o=De.useRef(e),a=De.useRef(new Set),s=De.useRef(e.debugPanel),u=De.useRef(e.viewportCenter),c=De.useRef([]),{appState:f,setAppState:g}=Qo();return Le.jsxs(Le.Fragment,{children:[Le.jsx(hD,{canvasRef:t,ctxRef:i,gameStateRef:o,debugPanelTypeRef:s,viewportCenterRef:u,playerActionHintsRef:c}),Le.jsx(CD,{gameStateRef:o,ctxRef:i,debugPanelTypeRef:s,viewportCenterRef:u,playerActionHintsRef:c,keysPressed:a,canvasRef:t,setAppState:g,appState:f})]})},_D=Rn.div`
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  text-align: center;
  background-color: rgba(0, 0, 0, 0.75); // Semi-transparent overlay
  color: #fff;
  padding: 20px;
  z-index: 10; // Ensure it's on top
`,RD=Rn.h1`
  font-family: 'Press Start 2P', cursive;
  font-size: 4rem;
  color: #ff4136; // Red for emphasis
  text-shadow: 4px 4px 0px #000;
  margin-bottom: 1.5rem;
`,uu=Rn.p`
  font-family: 'Press Start 2P', cursive;
  font-size: 1.2rem;
  margin: 0.5em 0;
  color: #fff;
  text-shadow: 2px 2px 0px #000;
`,PD=Rn.button`
  font-family: 'Press Start 2P', cursive;
  font-size: 1rem;
  padding: 1rem 2rem;
  margin-top: 2em;
  color: #fff;
  background-color: #ff4136; // Red button
  border: 2px solid #fff;
  box-shadow: 4px 4px 0px #fff;
  cursor: pointer;
  transition: all 0.2s ease-in-out;
  text-transform: uppercase;

  &:hover {
    background-color: #fff;
    color: #ff4136;
    box-shadow: 4px 4px 0px #ff4136;
  }
`,ND=()=>{const{setAppState:e,gameOverDetails:t}=Qo(),i=()=>{e("intro")};return Le.jsxs(_D,{children:[Le.jsx(RD,{children:"Game Over"}),Le.jsx(uu,{children:"Your tribe's lineage has ended."}),t&&Le.jsxs(Le.Fragment,{children:[Le.jsxs(uu,{children:["Generations Survived: ",t.generations]}),Le.jsxs(uu,{children:["Cause of Extinction: ",t.cause]})]}),!t&&Le.jsx(uu,{children:"Game details are unavailable."}),Le.jsx(PD,{onClick:i,children:"Return to Menu"})]})},DD=uI`
  /* CSS Reset */
  *, *::before, *::after {
    box-sizing: border-box;
  }

  body {
    margin: 0;
    padding: 0;
    font-family: 'Press Start 2P', 'Arial', sans-serif;
    background-color: #121212;
    color: #f0f0f0;
    line-height: 1.6;
  }

  /* Additional global styles */
  h1, h2, h3, h4, h5, h6 {
    margin-top: 0;
  }

  button {
    cursor: pointer;
    font-family: inherit;
  }

  /* Prevent overflow issues */
  html, body {
    height: 100%;
    overflow-x: hidden;
  }

  /* Root element for React app */
  #root {
    height: 100%;
  }
`;function OD(e,t){De.useEffect(()=>{const i=()=>{const o=document.location.hash==="#game"?"game":"intro";t(o)};return window.addEventListener("hashchange",i),i(),()=>{window.removeEventListener("hashchange",i)}},[]),De.useEffect(()=>{e==="game"?document.location.hash="#game":e==="intro"&&(document.location.hash="")},[e])}const MD=()=>{const{appState:e,setAppState:t}=Qo();OD(e,t);const i=()=>{switch(e){case"intro":return Le.jsx(V0,{});case"game":return Le.jsx(X0,{});case"gameOver":return Le.jsxs(Le.Fragment,{children:[Le.jsx(X0,{}),Le.jsx(ND,{})]});default:return Le.jsx(V0,{})}};return Le.jsxs(Le.Fragment,{children:[Le.jsx(DD,{}),i()]})},K0=document.getElementById("root");K0?bw().then(()=>{qT.createRoot(K0).render(Le.jsx(ii.StrictMode,{children:Le.jsx(lA,{initialAppState:document.location.hash==="#game"?"game":"intro",children:Le.jsx(MD,{})})}))}):console.error("Failed to find the root element");
