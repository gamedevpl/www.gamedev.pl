var kS=Object.defineProperty;var OS=(e,n,r)=>n in e?kS(e,n,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[n]=r;var me=(e,n,r)=>OS(e,typeof n!="symbol"?n+"":n,r);(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const l of document.querySelectorAll('link[rel="modulepreload"]'))o(l);new MutationObserver(l=>{for(const a of l)if(a.type==="childList")for(const c of a.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&o(c)}).observe(document,{childList:!0,subtree:!0});function r(l){const a={};return l.integrity&&(a.integrity=l.integrity),l.referrerPolicy&&(a.referrerPolicy=l.referrerPolicy),l.crossOrigin==="use-credentials"?a.credentials="include":l.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function o(l){if(l.ep)return;l.ep=!0;const a=r(l);fetch(l.href,a)}})();function Qm(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var Jc={exports:{}},fs={},ed={exports:{}},Fe={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Pg;function MS(){if(Pg)return Fe;Pg=1;var e=Symbol.for("react.element"),n=Symbol.for("react.portal"),r=Symbol.for("react.fragment"),o=Symbol.for("react.strict_mode"),l=Symbol.for("react.profiler"),a=Symbol.for("react.provider"),c=Symbol.for("react.context"),d=Symbol.for("react.forward_ref"),h=Symbol.for("react.suspense"),g=Symbol.for("react.memo"),m=Symbol.for("react.lazy"),y=Symbol.iterator;function S(R){return R===null||typeof R!="object"?null:(R=y&&R[y]||R["@@iterator"],typeof R=="function"?R:null)}var _={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},C=Object.assign,T={};function E(R,F,V){this.props=R,this.context=F,this.refs=T,this.updater=V||_}E.prototype.isReactComponent={},E.prototype.setState=function(R,F){if(typeof R!="object"&&typeof R!="function"&&R!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,R,F,"setState")},E.prototype.forceUpdate=function(R){this.updater.enqueueForceUpdate(this,R,"forceUpdate")};function M(){}M.prototype=E.prototype;function H(R,F,V){this.props=R,this.context=F,this.refs=T,this.updater=V||_}var D=H.prototype=new M;D.constructor=H,C(D,E.prototype),D.isPureReactComponent=!0;var B=Array.isArray,x=Object.prototype.hasOwnProperty,U={current:null},Y={key:!0,ref:!0,__self:!0,__source:!0};function ae(R,F,V){var ee,he={},re=null,Se=null;if(F!=null)for(ee in F.ref!==void 0&&(Se=F.ref),F.key!==void 0&&(re=""+F.key),F)x.call(F,ee)&&!Y.hasOwnProperty(ee)&&(he[ee]=F[ee]);var ve=arguments.length-2;if(ve===1)he.children=V;else if(1<ve){for(var K=Array(ve),te=0;te<ve;te++)K[te]=arguments[te+2];he.children=K}if(R&&R.defaultProps)for(ee in ve=R.defaultProps,ve)he[ee]===void 0&&(he[ee]=ve[ee]);return{$$typeof:e,type:R,key:re,ref:Se,props:he,_owner:U.current}}function Ee(R,F){return{$$typeof:e,type:R.type,key:F,ref:R.ref,props:R.props,_owner:R._owner}}function we(R){return typeof R=="object"&&R!==null&&R.$$typeof===e}function be(R){var F={"=":"=0",":":"=2"};return"$"+R.replace(/[=:]/g,function(V){return F[V]})}var ke=/\/+/g;function Ie(R,F){return typeof R=="object"&&R!==null&&R.key!=null?be(""+R.key):F.toString(36)}function ue(R,F,V,ee,he){var re=typeof R;(re==="undefined"||re==="boolean")&&(R=null);var Se=!1;if(R===null)Se=!0;else switch(re){case"string":case"number":Se=!0;break;case"object":switch(R.$$typeof){case e:case n:Se=!0}}if(Se)return Se=R,he=he(Se),R=ee===""?"."+Ie(Se,0):ee,B(he)?(V="",R!=null&&(V=R.replace(ke,"$&/")+"/"),ue(he,F,V,"",function(te){return te})):he!=null&&(we(he)&&(he=Ee(he,V+(!he.key||Se&&Se.key===he.key?"":(""+he.key).replace(ke,"$&/")+"/")+R)),F.push(he)),1;if(Se=0,ee=ee===""?".":ee+":",B(R))for(var ve=0;ve<R.length;ve++){re=R[ve];var K=ee+Ie(re,ve);Se+=ue(re,F,V,K,he)}else if(K=S(R),typeof K=="function")for(R=K.call(R),ve=0;!(re=R.next()).done;)re=re.value,K=ee+Ie(re,ve++),Se+=ue(re,F,V,K,he);else if(re==="object")throw F=String(R),Error("Objects are not valid as a React child (found: "+(F==="[object Object]"?"object with keys {"+Object.keys(R).join(", ")+"}":F)+"). If you meant to render a collection of children, use an array instead.");return Se}function Ue(R,F,V){if(R==null)return R;var ee=[],he=0;return ue(R,ee,"","",function(re){return F.call(V,re,he++)}),ee}function ye(R){if(R._status===-1){var F=R._result;F=F(),F.then(function(V){(R._status===0||R._status===-1)&&(R._status=1,R._result=V)},function(V){(R._status===0||R._status===-1)&&(R._status=2,R._result=V)}),R._status===-1&&(R._status=0,R._result=F)}if(R._status===1)return R._result.default;throw R._result}var J={current:null},z={transition:null},j={ReactCurrentDispatcher:J,ReactCurrentBatchConfig:z,ReactCurrentOwner:U};function $(){throw Error("act(...) is not supported in production builds of React.")}return Fe.Children={map:Ue,forEach:function(R,F,V){Ue(R,function(){F.apply(this,arguments)},V)},count:function(R){var F=0;return Ue(R,function(){F++}),F},toArray:function(R){return Ue(R,function(F){return F})||[]},only:function(R){if(!we(R))throw Error("React.Children.only expected to receive a single React element child.");return R}},Fe.Component=E,Fe.Fragment=r,Fe.Profiler=l,Fe.PureComponent=H,Fe.StrictMode=o,Fe.Suspense=h,Fe.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=j,Fe.act=$,Fe.cloneElement=function(R,F,V){if(R==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+R+".");var ee=C({},R.props),he=R.key,re=R.ref,Se=R._owner;if(F!=null){if(F.ref!==void 0&&(re=F.ref,Se=U.current),F.key!==void 0&&(he=""+F.key),R.type&&R.type.defaultProps)var ve=R.type.defaultProps;for(K in F)x.call(F,K)&&!Y.hasOwnProperty(K)&&(ee[K]=F[K]===void 0&&ve!==void 0?ve[K]:F[K])}var K=arguments.length-2;if(K===1)ee.children=V;else if(1<K){ve=Array(K);for(var te=0;te<K;te++)ve[te]=arguments[te+2];ee.children=ve}return{$$typeof:e,type:R.type,key:he,ref:re,props:ee,_owner:Se}},Fe.createContext=function(R){return R={$$typeof:c,_currentValue:R,_currentValue2:R,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},R.Provider={$$typeof:a,_context:R},R.Consumer=R},Fe.createElement=ae,Fe.createFactory=function(R){var F=ae.bind(null,R);return F.type=R,F},Fe.createRef=function(){return{current:null}},Fe.forwardRef=function(R){return{$$typeof:d,render:R}},Fe.isValidElement=we,Fe.lazy=function(R){return{$$typeof:m,_payload:{_status:-1,_result:R},_init:ye}},Fe.memo=function(R,F){return{$$typeof:g,type:R,compare:F===void 0?null:F}},Fe.startTransition=function(R){var F=z.transition;z.transition={};try{R()}finally{z.transition=F}},Fe.unstable_act=$,Fe.useCallback=function(R,F){return J.current.useCallback(R,F)},Fe.useContext=function(R){return J.current.useContext(R)},Fe.useDebugValue=function(){},Fe.useDeferredValue=function(R){return J.current.useDeferredValue(R)},Fe.useEffect=function(R,F){return J.current.useEffect(R,F)},Fe.useId=function(){return J.current.useId()},Fe.useImperativeHandle=function(R,F,V){return J.current.useImperativeHandle(R,F,V)},Fe.useInsertionEffect=function(R,F){return J.current.useInsertionEffect(R,F)},Fe.useLayoutEffect=function(R,F){return J.current.useLayoutEffect(R,F)},Fe.useMemo=function(R,F){return J.current.useMemo(R,F)},Fe.useReducer=function(R,F,V){return J.current.useReducer(R,F,V)},Fe.useRef=function(R){return J.current.useRef(R)},Fe.useState=function(R){return J.current.useState(R)},Fe.useSyncExternalStore=function(R,F,V){return J.current.useSyncExternalStore(R,F,V)},Fe.useTransition=function(){return J.current.useTransition()},Fe.version="18.3.1",Fe}var Ng;function ef(){return Ng||(Ng=1,ed.exports=MS()),ed.exports}/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Dg;function FS(){if(Dg)return fs;Dg=1;var e=ef(),n=Symbol.for("react.element"),r=Symbol.for("react.fragment"),o=Object.prototype.hasOwnProperty,l=e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,a={key:!0,ref:!0,__self:!0,__source:!0};function c(d,h,g){var m,y={},S=null,_=null;g!==void 0&&(S=""+g),h.key!==void 0&&(S=""+h.key),h.ref!==void 0&&(_=h.ref);for(m in h)o.call(h,m)&&!a.hasOwnProperty(m)&&(y[m]=h[m]);if(d&&d.defaultProps)for(m in h=d.defaultProps,h)y[m]===void 0&&(y[m]=h[m]);return{$$typeof:n,type:d,key:S,ref:_,props:y,_owner:l.current}}return fs.Fragment=r,fs.jsx=c,fs.jsxs=c,fs}var kg;function US(){return kg||(kg=1,Jc.exports=FS()),Jc.exports}var He=US(),Pe=ef();const zn=Qm(Pe);var ll={},td={exports:{}},Vt={},nd={exports:{}},id={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Og;function HS(){return Og||(Og=1,function(e){function n(z,j){var $=z.length;z.push(j);e:for(;0<$;){var R=$-1>>>1,F=z[R];if(0<l(F,j))z[R]=j,z[$]=F,$=R;else break e}}function r(z){return z.length===0?null:z[0]}function o(z){if(z.length===0)return null;var j=z[0],$=z.pop();if($!==j){z[0]=$;e:for(var R=0,F=z.length,V=F>>>1;R<V;){var ee=2*(R+1)-1,he=z[ee],re=ee+1,Se=z[re];if(0>l(he,$))re<F&&0>l(Se,he)?(z[R]=Se,z[re]=$,R=re):(z[R]=he,z[ee]=$,R=ee);else if(re<F&&0>l(Se,$))z[R]=Se,z[re]=$,R=re;else break e}}return j}function l(z,j){var $=z.sortIndex-j.sortIndex;return $!==0?$:z.id-j.id}if(typeof performance=="object"&&typeof performance.now=="function"){var a=performance;e.unstable_now=function(){return a.now()}}else{var c=Date,d=c.now();e.unstable_now=function(){return c.now()-d}}var h=[],g=[],m=1,y=null,S=3,_=!1,C=!1,T=!1,E=typeof setTimeout=="function"?setTimeout:null,M=typeof clearTimeout=="function"?clearTimeout:null,H=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function D(z){for(var j=r(g);j!==null;){if(j.callback===null)o(g);else if(j.startTime<=z)o(g),j.sortIndex=j.expirationTime,n(h,j);else break;j=r(g)}}function B(z){if(T=!1,D(z),!C)if(r(h)!==null)C=!0,ye(x);else{var j=r(g);j!==null&&J(B,j.startTime-z)}}function x(z,j){C=!1,T&&(T=!1,M(ae),ae=-1),_=!0;var $=S;try{for(D(j),y=r(h);y!==null&&(!(y.expirationTime>j)||z&&!be());){var R=y.callback;if(typeof R=="function"){y.callback=null,S=y.priorityLevel;var F=R(y.expirationTime<=j);j=e.unstable_now(),typeof F=="function"?y.callback=F:y===r(h)&&o(h),D(j)}else o(h);y=r(h)}if(y!==null)var V=!0;else{var ee=r(g);ee!==null&&J(B,ee.startTime-j),V=!1}return V}finally{y=null,S=$,_=!1}}var U=!1,Y=null,ae=-1,Ee=5,we=-1;function be(){return!(e.unstable_now()-we<Ee)}function ke(){if(Y!==null){var z=e.unstable_now();we=z;var j=!0;try{j=Y(!0,z)}finally{j?Ie():(U=!1,Y=null)}}else U=!1}var Ie;if(typeof H=="function")Ie=function(){H(ke)};else if(typeof MessageChannel<"u"){var ue=new MessageChannel,Ue=ue.port2;ue.port1.onmessage=ke,Ie=function(){Ue.postMessage(null)}}else Ie=function(){E(ke,0)};function ye(z){Y=z,U||(U=!0,Ie())}function J(z,j){ae=E(function(){z(e.unstable_now())},j)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(z){z.callback=null},e.unstable_continueExecution=function(){C||_||(C=!0,ye(x))},e.unstable_forceFrameRate=function(z){0>z||125<z?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):Ee=0<z?Math.floor(1e3/z):5},e.unstable_getCurrentPriorityLevel=function(){return S},e.unstable_getFirstCallbackNode=function(){return r(h)},e.unstable_next=function(z){switch(S){case 1:case 2:case 3:var j=3;break;default:j=S}var $=S;S=j;try{return z()}finally{S=$}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(z,j){switch(z){case 1:case 2:case 3:case 4:case 5:break;default:z=3}var $=S;S=z;try{return j()}finally{S=$}},e.unstable_scheduleCallback=function(z,j,$){var R=e.unstable_now();switch(typeof $=="object"&&$!==null?($=$.delay,$=typeof $=="number"&&0<$?R+$:R):$=R,z){case 1:var F=-1;break;case 2:F=250;break;case 5:F=1073741823;break;case 4:F=1e4;break;default:F=5e3}return F=$+F,z={id:m++,callback:j,priorityLevel:z,startTime:$,expirationTime:F,sortIndex:-1},$>R?(z.sortIndex=$,n(g,z),r(h)===null&&z===r(g)&&(T?(M(ae),ae=-1):T=!0,J(B,$-R))):(z.sortIndex=F,n(h,z),C||_||(C=!0,ye(x))),z},e.unstable_shouldYield=be,e.unstable_wrapCallback=function(z){var j=S;return function(){var $=S;S=j;try{return z.apply(this,arguments)}finally{S=$}}}}(id)),id}var Mg;function LS(){return Mg||(Mg=1,nd.exports=HS()),nd.exports}/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Fg;function BS(){if(Fg)return Vt;Fg=1;var e=ef(),n=LS();function r(t){for(var i="https://reactjs.org/docs/error-decoder.html?invariant="+t,s=1;s<arguments.length;s++)i+="&args[]="+encodeURIComponent(arguments[s]);return"Minified React error #"+t+"; visit "+i+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var o=new Set,l={};function a(t,i){c(t,i),c(t+"Capture",i)}function c(t,i){for(l[t]=i,t=0;t<i.length;t++)o.add(i[t])}var d=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),h=Object.prototype.hasOwnProperty,g=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,m={},y={};function S(t){return h.call(y,t)?!0:h.call(m,t)?!1:g.test(t)?y[t]=!0:(m[t]=!0,!1)}function _(t,i,s,u){if(s!==null&&s.type===0)return!1;switch(typeof i){case"function":case"symbol":return!0;case"boolean":return u?!1:s!==null?!s.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function C(t,i,s,u){if(i===null||typeof i>"u"||_(t,i,s,u))return!0;if(u)return!1;if(s!==null)switch(s.type){case 3:return!i;case 4:return i===!1;case 5:return isNaN(i);case 6:return isNaN(i)||1>i}return!1}function T(t,i,s,u,f,p,v){this.acceptsBooleans=i===2||i===3||i===4,this.attributeName=u,this.attributeNamespace=f,this.mustUseProperty=s,this.propertyName=t,this.type=i,this.sanitizeURL=p,this.removeEmptyString=v}var E={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){E[t]=new T(t,0,!1,t,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var i=t[0];E[i]=new T(i,1,!1,t[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(t){E[t]=new T(t,2,!1,t.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){E[t]=new T(t,2,!1,t,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){E[t]=new T(t,3,!1,t.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(t){E[t]=new T(t,3,!0,t,null,!1,!1)}),["capture","download"].forEach(function(t){E[t]=new T(t,4,!1,t,null,!1,!1)}),["cols","rows","size","span"].forEach(function(t){E[t]=new T(t,6,!1,t,null,!1,!1)}),["rowSpan","start"].forEach(function(t){E[t]=new T(t,5,!1,t.toLowerCase(),null,!1,!1)});var M=/[\-:]([a-z])/g;function H(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var i=t.replace(M,H);E[i]=new T(i,1,!1,t,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var i=t.replace(M,H);E[i]=new T(i,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(t){var i=t.replace(M,H);E[i]=new T(i,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(t){E[t]=new T(t,1,!1,t.toLowerCase(),null,!1,!1)}),E.xlinkHref=new T("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(t){E[t]=new T(t,1,!1,t.toLowerCase(),null,!0,!0)});function D(t,i,s,u){var f=E.hasOwnProperty(i)?E[i]:null;(f!==null?f.type!==0:u||!(2<i.length)||i[0]!=="o"&&i[0]!=="O"||i[1]!=="n"&&i[1]!=="N")&&(C(i,s,f,u)&&(s=null),u||f===null?S(i)&&(s===null?t.removeAttribute(i):t.setAttribute(i,""+s)):f.mustUseProperty?t[f.propertyName]=s===null?f.type===3?!1:"":s:(i=f.attributeName,u=f.attributeNamespace,s===null?t.removeAttribute(i):(f=f.type,s=f===3||f===4&&s===!0?"":""+s,u?t.setAttributeNS(u,i,s):t.setAttribute(i,s))))}var B=e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,x=Symbol.for("react.element"),U=Symbol.for("react.portal"),Y=Symbol.for("react.fragment"),ae=Symbol.for("react.strict_mode"),Ee=Symbol.for("react.profiler"),we=Symbol.for("react.provider"),be=Symbol.for("react.context"),ke=Symbol.for("react.forward_ref"),Ie=Symbol.for("react.suspense"),ue=Symbol.for("react.suspense_list"),Ue=Symbol.for("react.memo"),ye=Symbol.for("react.lazy"),J=Symbol.for("react.offscreen"),z=Symbol.iterator;function j(t){return t===null||typeof t!="object"?null:(t=z&&t[z]||t["@@iterator"],typeof t=="function"?t:null)}var $=Object.assign,R;function F(t){if(R===void 0)try{throw Error()}catch(s){var i=s.stack.trim().match(/\n( *(at )?)/);R=i&&i[1]||""}return`
`+R+t}var V=!1;function ee(t,i){if(!t||V)return"";V=!0;var s=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(i)if(i=function(){throw Error()},Object.defineProperty(i.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(i,[])}catch(O){var u=O}Reflect.construct(t,[],i)}else{try{i.call()}catch(O){u=O}t.call(i.prototype)}else{try{throw Error()}catch(O){u=O}t()}}catch(O){if(O&&u&&typeof O.stack=="string"){for(var f=O.stack.split(`
`),p=u.stack.split(`
`),v=f.length-1,A=p.length-1;1<=v&&0<=A&&f[v]!==p[A];)A--;for(;1<=v&&0<=A;v--,A--)if(f[v]!==p[A]){if(v!==1||A!==1)do if(v--,A--,0>A||f[v]!==p[A]){var w=`
`+f[v].replace(" at new "," at ");return t.displayName&&w.includes("<anonymous>")&&(w=w.replace("<anonymous>",t.displayName)),w}while(1<=v&&0<=A);break}}}finally{V=!1,Error.prepareStackTrace=s}return(t=t?t.displayName||t.name:"")?F(t):""}function he(t){switch(t.tag){case 5:return F(t.type);case 16:return F("Lazy");case 13:return F("Suspense");case 19:return F("SuspenseList");case 0:case 2:case 15:return t=ee(t.type,!1),t;case 11:return t=ee(t.type.render,!1),t;case 1:return t=ee(t.type,!0),t;default:return""}}function re(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case Y:return"Fragment";case U:return"Portal";case Ee:return"Profiler";case ae:return"StrictMode";case Ie:return"Suspense";case ue:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case be:return(t.displayName||"Context")+".Consumer";case we:return(t._context.displayName||"Context")+".Provider";case ke:var i=t.render;return t=t.displayName,t||(t=i.displayName||i.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case Ue:return i=t.displayName||null,i!==null?i:re(t.type)||"Memo";case ye:i=t._payload,t=t._init;try{return re(t(i))}catch{}}return null}function Se(t){var i=t.type;switch(t.tag){case 24:return"Cache";case 9:return(i.displayName||"Context")+".Consumer";case 10:return(i._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=i.render,t=t.displayName||t.name||"",i.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return i;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return re(i);case 8:return i===ae?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof i=="function")return i.displayName||i.name||null;if(typeof i=="string")return i}return null}function ve(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function K(t){var i=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(i==="checkbox"||i==="radio")}function te(t){var i=K(t)?"checked":"value",s=Object.getOwnPropertyDescriptor(t.constructor.prototype,i),u=""+t[i];if(!t.hasOwnProperty(i)&&typeof s<"u"&&typeof s.get=="function"&&typeof s.set=="function"){var f=s.get,p=s.set;return Object.defineProperty(t,i,{configurable:!0,get:function(){return f.call(this)},set:function(v){u=""+v,p.call(this,v)}}),Object.defineProperty(t,i,{enumerable:s.enumerable}),{getValue:function(){return u},setValue:function(v){u=""+v},stopTracking:function(){t._valueTracker=null,delete t[i]}}}}function Oe(t){t._valueTracker||(t._valueTracker=te(t))}function ce(t){if(!t)return!1;var i=t._valueTracker;if(!i)return!0;var s=i.getValue(),u="";return t&&(u=K(t)?t.checked?"true":"false":t.value),t=u,t!==s?(i.setValue(t),!0):!1}function Nn(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function qe(t,i){var s=i.checked;return $({},i,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:s??t._wrapperState.initialChecked})}function Ye(t,i){var s=i.defaultValue==null?"":i.defaultValue,u=i.checked!=null?i.checked:i.defaultChecked;s=ve(i.value!=null?i.value:s),t._wrapperState={initialChecked:u,initialValue:s,controlled:i.type==="checkbox"||i.type==="radio"?i.checked!=null:i.value!=null}}function Dn(t,i){i=i.checked,i!=null&&D(t,"checked",i,!1)}function xt(t,i){Dn(t,i);var s=ve(i.value),u=i.type;if(s!=null)u==="number"?(s===0&&t.value===""||t.value!=s)&&(t.value=""+s):t.value!==""+s&&(t.value=""+s);else if(u==="submit"||u==="reset"){t.removeAttribute("value");return}i.hasOwnProperty("value")?kn(t,i.type,s):i.hasOwnProperty("defaultValue")&&kn(t,i.type,ve(i.defaultValue)),i.checked==null&&i.defaultChecked!=null&&(t.defaultChecked=!!i.defaultChecked)}function nn(t,i,s){if(i.hasOwnProperty("value")||i.hasOwnProperty("defaultValue")){var u=i.type;if(!(u!=="submit"&&u!=="reset"||i.value!==void 0&&i.value!==null))return;i=""+t._wrapperState.initialValue,s||i===t.value||(t.value=i),t.defaultValue=i}s=t.name,s!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,s!==""&&(t.name=s)}function kn(t,i,s){(i!=="number"||Nn(t.ownerDocument)!==t)&&(s==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+s&&(t.defaultValue=""+s))}var On=Array.isArray;function ci(t,i,s,u){if(t=t.options,i){i={};for(var f=0;f<s.length;f++)i["$"+s[f]]=!0;for(s=0;s<t.length;s++)f=i.hasOwnProperty("$"+t[s].value),t[s].selected!==f&&(t[s].selected=f),f&&u&&(t[s].defaultSelected=!0)}else{for(s=""+ve(s),i=null,f=0;f<t.length;f++){if(t[f].value===s){t[f].selected=!0,u&&(t[f].defaultSelected=!0);return}i!==null||t[f].disabled||(i=t[f])}i!==null&&(i.selected=!0)}}function $i(t,i){if(i.dangerouslySetInnerHTML!=null)throw Error(r(91));return $({},i,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function Bf(t,i){var s=i.value;if(s==null){if(s=i.children,i=i.defaultValue,s!=null){if(i!=null)throw Error(r(92));if(On(s)){if(1<s.length)throw Error(r(93));s=s[0]}i=s}i==null&&(i=""),s=i}t._wrapperState={initialValue:ve(s)}}function Gf(t,i){var s=ve(i.value),u=ve(i.defaultValue);s!=null&&(s=""+s,s!==t.value&&(t.value=s),i.defaultValue==null&&t.defaultValue!==s&&(t.defaultValue=s)),u!=null&&(t.defaultValue=""+u)}function bf(t){var i=t.textContent;i===t._wrapperState.initialValue&&i!==""&&i!==null&&(t.value=i)}function xf(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function cu(t,i){return t==null||t==="http://www.w3.org/1999/xhtml"?xf(i):t==="http://www.w3.org/2000/svg"&&i==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var ea,zf=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(i,s,u,f){MSApp.execUnsafeLocalFunction(function(){return t(i,s,u,f)})}:t}(function(t,i){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=i;else{for(ea=ea||document.createElement("div"),ea.innerHTML="<svg>"+i.valueOf().toString()+"</svg>",i=ea.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;i.firstChild;)t.appendChild(i.firstChild)}});function Po(t,i){if(i){var s=t.firstChild;if(s&&s===t.lastChild&&s.nodeType===3){s.nodeValue=i;return}}t.textContent=i}var No={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Uv=["Webkit","ms","Moz","O"];Object.keys(No).forEach(function(t){Uv.forEach(function(i){i=i+t.charAt(0).toUpperCase()+t.substring(1),No[i]=No[t]})});function $f(t,i,s){return i==null||typeof i=="boolean"||i===""?"":s||typeof i!="number"||i===0||No.hasOwnProperty(t)&&No[t]?(""+i).trim():i+"px"}function Wf(t,i){t=t.style;for(var s in i)if(i.hasOwnProperty(s)){var u=s.indexOf("--")===0,f=$f(s,i[s],u);s==="float"&&(s="cssFloat"),u?t.setProperty(s,f):t[s]=f}}var Hv=$({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function du(t,i){if(i){if(Hv[t]&&(i.children!=null||i.dangerouslySetInnerHTML!=null))throw Error(r(137,t));if(i.dangerouslySetInnerHTML!=null){if(i.children!=null)throw Error(r(60));if(typeof i.dangerouslySetInnerHTML!="object"||!("__html"in i.dangerouslySetInnerHTML))throw Error(r(61))}if(i.style!=null&&typeof i.style!="object")throw Error(r(62))}}function fu(t,i){if(t.indexOf("-")===-1)return typeof i.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var hu=null;function pu(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var gu=null,Cr=null,Rr=null;function Yf(t){if(t=Qo(t)){if(typeof gu!="function")throw Error(r(280));var i=t.stateNode;i&&(i=Ea(i),gu(t.stateNode,t.type,i))}}function jf(t){Cr?Rr?Rr.push(t):Rr=[t]:Cr=t}function Vf(){if(Cr){var t=Cr,i=Rr;if(Rr=Cr=null,Yf(t),i)for(t=0;t<i.length;t++)Yf(i[t])}}function Xf(t,i){return t(i)}function Kf(){}var mu=!1;function qf(t,i,s){if(mu)return t(i,s);mu=!0;try{return Xf(t,i,s)}finally{mu=!1,(Cr!==null||Rr!==null)&&(Kf(),Vf())}}function Do(t,i){var s=t.stateNode;if(s===null)return null;var u=Ea(s);if(u===null)return null;s=u[i];e:switch(i){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(u=!u.disabled)||(t=t.type,u=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!u;break e;default:t=!1}if(t)return null;if(s&&typeof s!="function")throw Error(r(231,i,typeof s));return s}var vu=!1;if(d)try{var ko={};Object.defineProperty(ko,"passive",{get:function(){vu=!0}}),window.addEventListener("test",ko,ko),window.removeEventListener("test",ko,ko)}catch{vu=!1}function Lv(t,i,s,u,f,p,v,A,w){var O=Array.prototype.slice.call(arguments,3);try{i.apply(s,O)}catch(G){this.onError(G)}}var Oo=!1,ta=null,na=!1,yu=null,Bv={onError:function(t){Oo=!0,ta=t}};function Gv(t,i,s,u,f,p,v,A,w){Oo=!1,ta=null,Lv.apply(Bv,arguments)}function bv(t,i,s,u,f,p,v,A,w){if(Gv.apply(this,arguments),Oo){if(Oo){var O=ta;Oo=!1,ta=null}else throw Error(r(198));na||(na=!0,yu=O)}}function Wi(t){var i=t,s=t;if(t.alternate)for(;i.return;)i=i.return;else{t=i;do i=t,(i.flags&4098)!==0&&(s=i.return),t=i.return;while(t)}return i.tag===3?s:null}function Qf(t){if(t.tag===13){var i=t.memoizedState;if(i===null&&(t=t.alternate,t!==null&&(i=t.memoizedState)),i!==null)return i.dehydrated}return null}function Zf(t){if(Wi(t)!==t)throw Error(r(188))}function xv(t){var i=t.alternate;if(!i){if(i=Wi(t),i===null)throw Error(r(188));return i!==t?null:t}for(var s=t,u=i;;){var f=s.return;if(f===null)break;var p=f.alternate;if(p===null){if(u=f.return,u!==null){s=u;continue}break}if(f.child===p.child){for(p=f.child;p;){if(p===s)return Zf(f),t;if(p===u)return Zf(f),i;p=p.sibling}throw Error(r(188))}if(s.return!==u.return)s=f,u=p;else{for(var v=!1,A=f.child;A;){if(A===s){v=!0,s=f,u=p;break}if(A===u){v=!0,u=f,s=p;break}A=A.sibling}if(!v){for(A=p.child;A;){if(A===s){v=!0,s=p,u=f;break}if(A===u){v=!0,u=p,s=f;break}A=A.sibling}if(!v)throw Error(r(189))}}if(s.alternate!==u)throw Error(r(190))}if(s.tag!==3)throw Error(r(188));return s.stateNode.current===s?t:i}function Jf(t){return t=xv(t),t!==null?eh(t):null}function eh(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var i=eh(t);if(i!==null)return i;t=t.sibling}return null}var th=n.unstable_scheduleCallback,nh=n.unstable_cancelCallback,zv=n.unstable_shouldYield,$v=n.unstable_requestPaint,ot=n.unstable_now,Wv=n.unstable_getCurrentPriorityLevel,Su=n.unstable_ImmediatePriority,ih=n.unstable_UserBlockingPriority,ia=n.unstable_NormalPriority,Yv=n.unstable_LowPriority,rh=n.unstable_IdlePriority,ra=null,Mn=null;function jv(t){if(Mn&&typeof Mn.onCommitFiberRoot=="function")try{Mn.onCommitFiberRoot(ra,t,void 0,(t.current.flags&128)===128)}catch{}}var pn=Math.clz32?Math.clz32:Kv,Vv=Math.log,Xv=Math.LN2;function Kv(t){return t>>>=0,t===0?32:31-(Vv(t)/Xv|0)|0}var oa=64,sa=4194304;function Mo(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function aa(t,i){var s=t.pendingLanes;if(s===0)return 0;var u=0,f=t.suspendedLanes,p=t.pingedLanes,v=s&268435455;if(v!==0){var A=v&~f;A!==0?u=Mo(A):(p&=v,p!==0&&(u=Mo(p)))}else v=s&~f,v!==0?u=Mo(v):p!==0&&(u=Mo(p));if(u===0)return 0;if(i!==0&&i!==u&&(i&f)===0&&(f=u&-u,p=i&-i,f>=p||f===16&&(p&4194240)!==0))return i;if((u&4)!==0&&(u|=s&16),i=t.entangledLanes,i!==0)for(t=t.entanglements,i&=u;0<i;)s=31-pn(i),f=1<<s,u|=t[s],i&=~f;return u}function qv(t,i){switch(t){case 1:case 2:case 4:return i+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return i+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Qv(t,i){for(var s=t.suspendedLanes,u=t.pingedLanes,f=t.expirationTimes,p=t.pendingLanes;0<p;){var v=31-pn(p),A=1<<v,w=f[v];w===-1?((A&s)===0||(A&u)!==0)&&(f[v]=qv(A,i)):w<=i&&(t.expiredLanes|=A),p&=~A}}function Au(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function oh(){var t=oa;return oa<<=1,(oa&4194240)===0&&(oa=64),t}function Tu(t){for(var i=[],s=0;31>s;s++)i.push(t);return i}function Fo(t,i,s){t.pendingLanes|=i,i!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,i=31-pn(i),t[i]=s}function Zv(t,i){var s=t.pendingLanes&~i;t.pendingLanes=i,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=i,t.mutableReadLanes&=i,t.entangledLanes&=i,i=t.entanglements;var u=t.eventTimes;for(t=t.expirationTimes;0<s;){var f=31-pn(s),p=1<<f;i[f]=0,u[f]=-1,t[f]=-1,s&=~p}}function Iu(t,i){var s=t.entangledLanes|=i;for(t=t.entanglements;s;){var u=31-pn(s),f=1<<u;f&i|t[u]&i&&(t[u]|=i),s&=~f}}var ze=0;function sh(t){return t&=-t,1<t?4<t?(t&268435455)!==0?16:536870912:4:1}var ah,Eu,lh,uh,ch,wu=!1,la=[],di=null,fi=null,hi=null,Uo=new Map,Ho=new Map,pi=[],Jv="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function dh(t,i){switch(t){case"focusin":case"focusout":di=null;break;case"dragenter":case"dragleave":fi=null;break;case"mouseover":case"mouseout":hi=null;break;case"pointerover":case"pointerout":Uo.delete(i.pointerId);break;case"gotpointercapture":case"lostpointercapture":Ho.delete(i.pointerId)}}function Lo(t,i,s,u,f,p){return t===null||t.nativeEvent!==p?(t={blockedOn:i,domEventName:s,eventSystemFlags:u,nativeEvent:p,targetContainers:[f]},i!==null&&(i=Qo(i),i!==null&&Eu(i)),t):(t.eventSystemFlags|=u,i=t.targetContainers,f!==null&&i.indexOf(f)===-1&&i.push(f),t)}function ey(t,i,s,u,f){switch(i){case"focusin":return di=Lo(di,t,i,s,u,f),!0;case"dragenter":return fi=Lo(fi,t,i,s,u,f),!0;case"mouseover":return hi=Lo(hi,t,i,s,u,f),!0;case"pointerover":var p=f.pointerId;return Uo.set(p,Lo(Uo.get(p)||null,t,i,s,u,f)),!0;case"gotpointercapture":return p=f.pointerId,Ho.set(p,Lo(Ho.get(p)||null,t,i,s,u,f)),!0}return!1}function fh(t){var i=Yi(t.target);if(i!==null){var s=Wi(i);if(s!==null){if(i=s.tag,i===13){if(i=Qf(s),i!==null){t.blockedOn=i,ch(t.priority,function(){lh(s)});return}}else if(i===3&&s.stateNode.current.memoizedState.isDehydrated){t.blockedOn=s.tag===3?s.stateNode.containerInfo:null;return}}}t.blockedOn=null}function ua(t){if(t.blockedOn!==null)return!1;for(var i=t.targetContainers;0<i.length;){var s=Cu(t.domEventName,t.eventSystemFlags,i[0],t.nativeEvent);if(s===null){s=t.nativeEvent;var u=new s.constructor(s.type,s);hu=u,s.target.dispatchEvent(u),hu=null}else return i=Qo(s),i!==null&&Eu(i),t.blockedOn=s,!1;i.shift()}return!0}function hh(t,i,s){ua(t)&&s.delete(i)}function ty(){wu=!1,di!==null&&ua(di)&&(di=null),fi!==null&&ua(fi)&&(fi=null),hi!==null&&ua(hi)&&(hi=null),Uo.forEach(hh),Ho.forEach(hh)}function Bo(t,i){t.blockedOn===i&&(t.blockedOn=null,wu||(wu=!0,n.unstable_scheduleCallback(n.unstable_NormalPriority,ty)))}function Go(t){function i(f){return Bo(f,t)}if(0<la.length){Bo(la[0],t);for(var s=1;s<la.length;s++){var u=la[s];u.blockedOn===t&&(u.blockedOn=null)}}for(di!==null&&Bo(di,t),fi!==null&&Bo(fi,t),hi!==null&&Bo(hi,t),Uo.forEach(i),Ho.forEach(i),s=0;s<pi.length;s++)u=pi[s],u.blockedOn===t&&(u.blockedOn=null);for(;0<pi.length&&(s=pi[0],s.blockedOn===null);)fh(s),s.blockedOn===null&&pi.shift()}var Pr=B.ReactCurrentBatchConfig,ca=!0;function ny(t,i,s,u){var f=ze,p=Pr.transition;Pr.transition=null;try{ze=1,_u(t,i,s,u)}finally{ze=f,Pr.transition=p}}function iy(t,i,s,u){var f=ze,p=Pr.transition;Pr.transition=null;try{ze=4,_u(t,i,s,u)}finally{ze=f,Pr.transition=p}}function _u(t,i,s,u){if(ca){var f=Cu(t,i,s,u);if(f===null)$u(t,i,u,da,s),dh(t,u);else if(ey(f,t,i,s,u))u.stopPropagation();else if(dh(t,u),i&4&&-1<Jv.indexOf(t)){for(;f!==null;){var p=Qo(f);if(p!==null&&ah(p),p=Cu(t,i,s,u),p===null&&$u(t,i,u,da,s),p===f)break;f=p}f!==null&&u.stopPropagation()}else $u(t,i,u,null,s)}}var da=null;function Cu(t,i,s,u){if(da=null,t=pu(u),t=Yi(t),t!==null)if(i=Wi(t),i===null)t=null;else if(s=i.tag,s===13){if(t=Qf(i),t!==null)return t;t=null}else if(s===3){if(i.stateNode.current.memoizedState.isDehydrated)return i.tag===3?i.stateNode.containerInfo:null;t=null}else i!==t&&(t=null);return da=t,null}function ph(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Wv()){case Su:return 1;case ih:return 4;case ia:case Yv:return 16;case rh:return 536870912;default:return 16}default:return 16}}var gi=null,Ru=null,fa=null;function gh(){if(fa)return fa;var t,i=Ru,s=i.length,u,f="value"in gi?gi.value:gi.textContent,p=f.length;for(t=0;t<s&&i[t]===f[t];t++);var v=s-t;for(u=1;u<=v&&i[s-u]===f[p-u];u++);return fa=f.slice(t,1<u?1-u:void 0)}function ha(t){var i=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&i===13&&(t=13)):t=i,t===10&&(t=13),32<=t||t===13?t:0}function pa(){return!0}function mh(){return!1}function qt(t){function i(s,u,f,p,v){this._reactName=s,this._targetInst=f,this.type=u,this.nativeEvent=p,this.target=v,this.currentTarget=null;for(var A in t)t.hasOwnProperty(A)&&(s=t[A],this[A]=s?s(p):p[A]);return this.isDefaultPrevented=(p.defaultPrevented!=null?p.defaultPrevented:p.returnValue===!1)?pa:mh,this.isPropagationStopped=mh,this}return $(i.prototype,{preventDefault:function(){this.defaultPrevented=!0;var s=this.nativeEvent;s&&(s.preventDefault?s.preventDefault():typeof s.returnValue!="unknown"&&(s.returnValue=!1),this.isDefaultPrevented=pa)},stopPropagation:function(){var s=this.nativeEvent;s&&(s.stopPropagation?s.stopPropagation():typeof s.cancelBubble!="unknown"&&(s.cancelBubble=!0),this.isPropagationStopped=pa)},persist:function(){},isPersistent:pa}),i}var Nr={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Pu=qt(Nr),bo=$({},Nr,{view:0,detail:0}),ry=qt(bo),Nu,Du,xo,ga=$({},bo,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Ou,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==xo&&(xo&&t.type==="mousemove"?(Nu=t.screenX-xo.screenX,Du=t.screenY-xo.screenY):Du=Nu=0,xo=t),Nu)},movementY:function(t){return"movementY"in t?t.movementY:Du}}),vh=qt(ga),oy=$({},ga,{dataTransfer:0}),sy=qt(oy),ay=$({},bo,{relatedTarget:0}),ku=qt(ay),ly=$({},Nr,{animationName:0,elapsedTime:0,pseudoElement:0}),uy=qt(ly),cy=$({},Nr,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),dy=qt(cy),fy=$({},Nr,{data:0}),yh=qt(fy),hy={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},py={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},gy={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function my(t){var i=this.nativeEvent;return i.getModifierState?i.getModifierState(t):(t=gy[t])?!!i[t]:!1}function Ou(){return my}var vy=$({},bo,{key:function(t){if(t.key){var i=hy[t.key]||t.key;if(i!=="Unidentified")return i}return t.type==="keypress"?(t=ha(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?py[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Ou,charCode:function(t){return t.type==="keypress"?ha(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?ha(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),yy=qt(vy),Sy=$({},ga,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Sh=qt(Sy),Ay=$({},bo,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Ou}),Ty=qt(Ay),Iy=$({},Nr,{propertyName:0,elapsedTime:0,pseudoElement:0}),Ey=qt(Iy),wy=$({},ga,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),_y=qt(wy),Cy=[9,13,27,32],Mu=d&&"CompositionEvent"in window,zo=null;d&&"documentMode"in document&&(zo=document.documentMode);var Ry=d&&"TextEvent"in window&&!zo,Ah=d&&(!Mu||zo&&8<zo&&11>=zo),Th=" ",Ih=!1;function Eh(t,i){switch(t){case"keyup":return Cy.indexOf(i.keyCode)!==-1;case"keydown":return i.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function wh(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var Dr=!1;function Py(t,i){switch(t){case"compositionend":return wh(i);case"keypress":return i.which!==32?null:(Ih=!0,Th);case"textInput":return t=i.data,t===Th&&Ih?null:t;default:return null}}function Ny(t,i){if(Dr)return t==="compositionend"||!Mu&&Eh(t,i)?(t=gh(),fa=Ru=gi=null,Dr=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(i.ctrlKey||i.altKey||i.metaKey)||i.ctrlKey&&i.altKey){if(i.char&&1<i.char.length)return i.char;if(i.which)return String.fromCharCode(i.which)}return null;case"compositionend":return Ah&&i.locale!=="ko"?null:i.data;default:return null}}var Dy={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function _h(t){var i=t&&t.nodeName&&t.nodeName.toLowerCase();return i==="input"?!!Dy[t.type]:i==="textarea"}function Ch(t,i,s,u){jf(u),i=Aa(i,"onChange"),0<i.length&&(s=new Pu("onChange","change",null,s,u),t.push({event:s,listeners:i}))}var $o=null,Wo=null;function ky(t){Wh(t,0)}function ma(t){var i=Ur(t);if(ce(i))return t}function Oy(t,i){if(t==="change")return i}var Rh=!1;if(d){var Fu;if(d){var Uu="oninput"in document;if(!Uu){var Ph=document.createElement("div");Ph.setAttribute("oninput","return;"),Uu=typeof Ph.oninput=="function"}Fu=Uu}else Fu=!1;Rh=Fu&&(!document.documentMode||9<document.documentMode)}function Nh(){$o&&($o.detachEvent("onpropertychange",Dh),Wo=$o=null)}function Dh(t){if(t.propertyName==="value"&&ma(Wo)){var i=[];Ch(i,Wo,t,pu(t)),qf(ky,i)}}function My(t,i,s){t==="focusin"?(Nh(),$o=i,Wo=s,$o.attachEvent("onpropertychange",Dh)):t==="focusout"&&Nh()}function Fy(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return ma(Wo)}function Uy(t,i){if(t==="click")return ma(i)}function Hy(t,i){if(t==="input"||t==="change")return ma(i)}function Ly(t,i){return t===i&&(t!==0||1/t===1/i)||t!==t&&i!==i}var gn=typeof Object.is=="function"?Object.is:Ly;function Yo(t,i){if(gn(t,i))return!0;if(typeof t!="object"||t===null||typeof i!="object"||i===null)return!1;var s=Object.keys(t),u=Object.keys(i);if(s.length!==u.length)return!1;for(u=0;u<s.length;u++){var f=s[u];if(!h.call(i,f)||!gn(t[f],i[f]))return!1}return!0}function kh(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function Oh(t,i){var s=kh(t);t=0;for(var u;s;){if(s.nodeType===3){if(u=t+s.textContent.length,t<=i&&u>=i)return{node:s,offset:i-t};t=u}e:{for(;s;){if(s.nextSibling){s=s.nextSibling;break e}s=s.parentNode}s=void 0}s=kh(s)}}function Mh(t,i){return t&&i?t===i?!0:t&&t.nodeType===3?!1:i&&i.nodeType===3?Mh(t,i.parentNode):"contains"in t?t.contains(i):t.compareDocumentPosition?!!(t.compareDocumentPosition(i)&16):!1:!1}function Fh(){for(var t=window,i=Nn();i instanceof t.HTMLIFrameElement;){try{var s=typeof i.contentWindow.location.href=="string"}catch{s=!1}if(s)t=i.contentWindow;else break;i=Nn(t.document)}return i}function Hu(t){var i=t&&t.nodeName&&t.nodeName.toLowerCase();return i&&(i==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||i==="textarea"||t.contentEditable==="true")}function By(t){var i=Fh(),s=t.focusedElem,u=t.selectionRange;if(i!==s&&s&&s.ownerDocument&&Mh(s.ownerDocument.documentElement,s)){if(u!==null&&Hu(s)){if(i=u.start,t=u.end,t===void 0&&(t=i),"selectionStart"in s)s.selectionStart=i,s.selectionEnd=Math.min(t,s.value.length);else if(t=(i=s.ownerDocument||document)&&i.defaultView||window,t.getSelection){t=t.getSelection();var f=s.textContent.length,p=Math.min(u.start,f);u=u.end===void 0?p:Math.min(u.end,f),!t.extend&&p>u&&(f=u,u=p,p=f),f=Oh(s,p);var v=Oh(s,u);f&&v&&(t.rangeCount!==1||t.anchorNode!==f.node||t.anchorOffset!==f.offset||t.focusNode!==v.node||t.focusOffset!==v.offset)&&(i=i.createRange(),i.setStart(f.node,f.offset),t.removeAllRanges(),p>u?(t.addRange(i),t.extend(v.node,v.offset)):(i.setEnd(v.node,v.offset),t.addRange(i)))}}for(i=[],t=s;t=t.parentNode;)t.nodeType===1&&i.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof s.focus=="function"&&s.focus(),s=0;s<i.length;s++)t=i[s],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var Gy=d&&"documentMode"in document&&11>=document.documentMode,kr=null,Lu=null,jo=null,Bu=!1;function Uh(t,i,s){var u=s.window===s?s.document:s.nodeType===9?s:s.ownerDocument;Bu||kr==null||kr!==Nn(u)||(u=kr,"selectionStart"in u&&Hu(u)?u={start:u.selectionStart,end:u.selectionEnd}:(u=(u.ownerDocument&&u.ownerDocument.defaultView||window).getSelection(),u={anchorNode:u.anchorNode,anchorOffset:u.anchorOffset,focusNode:u.focusNode,focusOffset:u.focusOffset}),jo&&Yo(jo,u)||(jo=u,u=Aa(Lu,"onSelect"),0<u.length&&(i=new Pu("onSelect","select",null,i,s),t.push({event:i,listeners:u}),i.target=kr)))}function va(t,i){var s={};return s[t.toLowerCase()]=i.toLowerCase(),s["Webkit"+t]="webkit"+i,s["Moz"+t]="moz"+i,s}var Or={animationend:va("Animation","AnimationEnd"),animationiteration:va("Animation","AnimationIteration"),animationstart:va("Animation","AnimationStart"),transitionend:va("Transition","TransitionEnd")},Gu={},Hh={};d&&(Hh=document.createElement("div").style,"AnimationEvent"in window||(delete Or.animationend.animation,delete Or.animationiteration.animation,delete Or.animationstart.animation),"TransitionEvent"in window||delete Or.transitionend.transition);function ya(t){if(Gu[t])return Gu[t];if(!Or[t])return t;var i=Or[t],s;for(s in i)if(i.hasOwnProperty(s)&&s in Hh)return Gu[t]=i[s];return t}var Lh=ya("animationend"),Bh=ya("animationiteration"),Gh=ya("animationstart"),bh=ya("transitionend"),xh=new Map,zh="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function mi(t,i){xh.set(t,i),a(i,[t])}for(var bu=0;bu<zh.length;bu++){var xu=zh[bu],by=xu.toLowerCase(),xy=xu[0].toUpperCase()+xu.slice(1);mi(by,"on"+xy)}mi(Lh,"onAnimationEnd"),mi(Bh,"onAnimationIteration"),mi(Gh,"onAnimationStart"),mi("dblclick","onDoubleClick"),mi("focusin","onFocus"),mi("focusout","onBlur"),mi(bh,"onTransitionEnd"),c("onMouseEnter",["mouseout","mouseover"]),c("onMouseLeave",["mouseout","mouseover"]),c("onPointerEnter",["pointerout","pointerover"]),c("onPointerLeave",["pointerout","pointerover"]),a("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),a("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),a("onBeforeInput",["compositionend","keypress","textInput","paste"]),a("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),a("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),a("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Vo="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),zy=new Set("cancel close invalid load scroll toggle".split(" ").concat(Vo));function $h(t,i,s){var u=t.type||"unknown-event";t.currentTarget=s,bv(u,i,void 0,t),t.currentTarget=null}function Wh(t,i){i=(i&4)!==0;for(var s=0;s<t.length;s++){var u=t[s],f=u.event;u=u.listeners;e:{var p=void 0;if(i)for(var v=u.length-1;0<=v;v--){var A=u[v],w=A.instance,O=A.currentTarget;if(A=A.listener,w!==p&&f.isPropagationStopped())break e;$h(f,A,O),p=w}else for(v=0;v<u.length;v++){if(A=u[v],w=A.instance,O=A.currentTarget,A=A.listener,w!==p&&f.isPropagationStopped())break e;$h(f,A,O),p=w}}}if(na)throw t=yu,na=!1,yu=null,t}function je(t,i){var s=i[Ku];s===void 0&&(s=i[Ku]=new Set);var u=t+"__bubble";s.has(u)||(Yh(i,t,2,!1),s.add(u))}function zu(t,i,s){var u=0;i&&(u|=4),Yh(s,t,u,i)}var Sa="_reactListening"+Math.random().toString(36).slice(2);function Xo(t){if(!t[Sa]){t[Sa]=!0,o.forEach(function(s){s!=="selectionchange"&&(zy.has(s)||zu(s,!1,t),zu(s,!0,t))});var i=t.nodeType===9?t:t.ownerDocument;i===null||i[Sa]||(i[Sa]=!0,zu("selectionchange",!1,i))}}function Yh(t,i,s,u){switch(ph(i)){case 1:var f=ny;break;case 4:f=iy;break;default:f=_u}s=f.bind(null,i,s,t),f=void 0,!vu||i!=="touchstart"&&i!=="touchmove"&&i!=="wheel"||(f=!0),u?f!==void 0?t.addEventListener(i,s,{capture:!0,passive:f}):t.addEventListener(i,s,!0):f!==void 0?t.addEventListener(i,s,{passive:f}):t.addEventListener(i,s,!1)}function $u(t,i,s,u,f){var p=u;if((i&1)===0&&(i&2)===0&&u!==null)e:for(;;){if(u===null)return;var v=u.tag;if(v===3||v===4){var A=u.stateNode.containerInfo;if(A===f||A.nodeType===8&&A.parentNode===f)break;if(v===4)for(v=u.return;v!==null;){var w=v.tag;if((w===3||w===4)&&(w=v.stateNode.containerInfo,w===f||w.nodeType===8&&w.parentNode===f))return;v=v.return}for(;A!==null;){if(v=Yi(A),v===null)return;if(w=v.tag,w===5||w===6){u=p=v;continue e}A=A.parentNode}}u=u.return}qf(function(){var O=p,G=pu(s),b=[];e:{var L=xh.get(t);if(L!==void 0){var q=Pu,Z=t;switch(t){case"keypress":if(ha(s)===0)break e;case"keydown":case"keyup":q=yy;break;case"focusin":Z="focus",q=ku;break;case"focusout":Z="blur",q=ku;break;case"beforeblur":case"afterblur":q=ku;break;case"click":if(s.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":q=vh;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":q=sy;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":q=Ty;break;case Lh:case Bh:case Gh:q=uy;break;case bh:q=Ey;break;case"scroll":q=ry;break;case"wheel":q=_y;break;case"copy":case"cut":case"paste":q=dy;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":q=Sh}var ne=(i&4)!==0,st=!ne&&t==="scroll",N=ne?L!==null?L+"Capture":null:L;ne=[];for(var P=O,k;P!==null;){k=P;var W=k.stateNode;if(k.tag===5&&W!==null&&(k=W,N!==null&&(W=Do(P,N),W!=null&&ne.push(Ko(P,W,k)))),st)break;P=P.return}0<ne.length&&(L=new q(L,Z,null,s,G),b.push({event:L,listeners:ne}))}}if((i&7)===0){e:{if(L=t==="mouseover"||t==="pointerover",q=t==="mouseout"||t==="pointerout",L&&s!==hu&&(Z=s.relatedTarget||s.fromElement)&&(Yi(Z)||Z[Yn]))break e;if((q||L)&&(L=G.window===G?G:(L=G.ownerDocument)?L.defaultView||L.parentWindow:window,q?(Z=s.relatedTarget||s.toElement,q=O,Z=Z?Yi(Z):null,Z!==null&&(st=Wi(Z),Z!==st||Z.tag!==5&&Z.tag!==6)&&(Z=null)):(q=null,Z=O),q!==Z)){if(ne=vh,W="onMouseLeave",N="onMouseEnter",P="mouse",(t==="pointerout"||t==="pointerover")&&(ne=Sh,W="onPointerLeave",N="onPointerEnter",P="pointer"),st=q==null?L:Ur(q),k=Z==null?L:Ur(Z),L=new ne(W,P+"leave",q,s,G),L.target=st,L.relatedTarget=k,W=null,Yi(G)===O&&(ne=new ne(N,P+"enter",Z,s,G),ne.target=k,ne.relatedTarget=st,W=ne),st=W,q&&Z)t:{for(ne=q,N=Z,P=0,k=ne;k;k=Mr(k))P++;for(k=0,W=N;W;W=Mr(W))k++;for(;0<P-k;)ne=Mr(ne),P--;for(;0<k-P;)N=Mr(N),k--;for(;P--;){if(ne===N||N!==null&&ne===N.alternate)break t;ne=Mr(ne),N=Mr(N)}ne=null}else ne=null;q!==null&&jh(b,L,q,ne,!1),Z!==null&&st!==null&&jh(b,st,Z,ne,!0)}}e:{if(L=O?Ur(O):window,q=L.nodeName&&L.nodeName.toLowerCase(),q==="select"||q==="input"&&L.type==="file")var oe=Oy;else if(_h(L))if(Rh)oe=Hy;else{oe=Fy;var de=My}else(q=L.nodeName)&&q.toLowerCase()==="input"&&(L.type==="checkbox"||L.type==="radio")&&(oe=Uy);if(oe&&(oe=oe(t,O))){Ch(b,oe,s,G);break e}de&&de(t,L,O),t==="focusout"&&(de=L._wrapperState)&&de.controlled&&L.type==="number"&&kn(L,"number",L.value)}switch(de=O?Ur(O):window,t){case"focusin":(_h(de)||de.contentEditable==="true")&&(kr=de,Lu=O,jo=null);break;case"focusout":jo=Lu=kr=null;break;case"mousedown":Bu=!0;break;case"contextmenu":case"mouseup":case"dragend":Bu=!1,Uh(b,s,G);break;case"selectionchange":if(Gy)break;case"keydown":case"keyup":Uh(b,s,G)}var fe;if(Mu)e:{switch(t){case"compositionstart":var Ae="onCompositionStart";break e;case"compositionend":Ae="onCompositionEnd";break e;case"compositionupdate":Ae="onCompositionUpdate";break e}Ae=void 0}else Dr?Eh(t,s)&&(Ae="onCompositionEnd"):t==="keydown"&&s.keyCode===229&&(Ae="onCompositionStart");Ae&&(Ah&&s.locale!=="ko"&&(Dr||Ae!=="onCompositionStart"?Ae==="onCompositionEnd"&&Dr&&(fe=gh()):(gi=G,Ru="value"in gi?gi.value:gi.textContent,Dr=!0)),de=Aa(O,Ae),0<de.length&&(Ae=new yh(Ae,t,null,s,G),b.push({event:Ae,listeners:de}),fe?Ae.data=fe:(fe=wh(s),fe!==null&&(Ae.data=fe)))),(fe=Ry?Py(t,s):Ny(t,s))&&(O=Aa(O,"onBeforeInput"),0<O.length&&(G=new yh("onBeforeInput","beforeinput",null,s,G),b.push({event:G,listeners:O}),G.data=fe))}Wh(b,i)})}function Ko(t,i,s){return{instance:t,listener:i,currentTarget:s}}function Aa(t,i){for(var s=i+"Capture",u=[];t!==null;){var f=t,p=f.stateNode;f.tag===5&&p!==null&&(f=p,p=Do(t,s),p!=null&&u.unshift(Ko(t,p,f)),p=Do(t,i),p!=null&&u.push(Ko(t,p,f))),t=t.return}return u}function Mr(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function jh(t,i,s,u,f){for(var p=i._reactName,v=[];s!==null&&s!==u;){var A=s,w=A.alternate,O=A.stateNode;if(w!==null&&w===u)break;A.tag===5&&O!==null&&(A=O,f?(w=Do(s,p),w!=null&&v.unshift(Ko(s,w,A))):f||(w=Do(s,p),w!=null&&v.push(Ko(s,w,A)))),s=s.return}v.length!==0&&t.push({event:i,listeners:v})}var $y=/\r\n?/g,Wy=/\u0000|\uFFFD/g;function Vh(t){return(typeof t=="string"?t:""+t).replace($y,`
`).replace(Wy,"")}function Ta(t,i,s){if(i=Vh(i),Vh(t)!==i&&s)throw Error(r(425))}function Ia(){}var Wu=null,Yu=null;function ju(t,i){return t==="textarea"||t==="noscript"||typeof i.children=="string"||typeof i.children=="number"||typeof i.dangerouslySetInnerHTML=="object"&&i.dangerouslySetInnerHTML!==null&&i.dangerouslySetInnerHTML.__html!=null}var Vu=typeof setTimeout=="function"?setTimeout:void 0,Yy=typeof clearTimeout=="function"?clearTimeout:void 0,Xh=typeof Promise=="function"?Promise:void 0,jy=typeof queueMicrotask=="function"?queueMicrotask:typeof Xh<"u"?function(t){return Xh.resolve(null).then(t).catch(Vy)}:Vu;function Vy(t){setTimeout(function(){throw t})}function Xu(t,i){var s=i,u=0;do{var f=s.nextSibling;if(t.removeChild(s),f&&f.nodeType===8)if(s=f.data,s==="/$"){if(u===0){t.removeChild(f),Go(i);return}u--}else s!=="$"&&s!=="$?"&&s!=="$!"||u++;s=f}while(s);Go(i)}function vi(t){for(;t!=null;t=t.nextSibling){var i=t.nodeType;if(i===1||i===3)break;if(i===8){if(i=t.data,i==="$"||i==="$!"||i==="$?")break;if(i==="/$")return null}}return t}function Kh(t){t=t.previousSibling;for(var i=0;t;){if(t.nodeType===8){var s=t.data;if(s==="$"||s==="$!"||s==="$?"){if(i===0)return t;i--}else s==="/$"&&i++}t=t.previousSibling}return null}var Fr=Math.random().toString(36).slice(2),Fn="__reactFiber$"+Fr,qo="__reactProps$"+Fr,Yn="__reactContainer$"+Fr,Ku="__reactEvents$"+Fr,Xy="__reactListeners$"+Fr,Ky="__reactHandles$"+Fr;function Yi(t){var i=t[Fn];if(i)return i;for(var s=t.parentNode;s;){if(i=s[Yn]||s[Fn]){if(s=i.alternate,i.child!==null||s!==null&&s.child!==null)for(t=Kh(t);t!==null;){if(s=t[Fn])return s;t=Kh(t)}return i}t=s,s=t.parentNode}return null}function Qo(t){return t=t[Fn]||t[Yn],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function Ur(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(r(33))}function Ea(t){return t[qo]||null}var qu=[],Hr=-1;function yi(t){return{current:t}}function Ve(t){0>Hr||(t.current=qu[Hr],qu[Hr]=null,Hr--)}function We(t,i){Hr++,qu[Hr]=t.current,t.current=i}var Si={},Rt=yi(Si),zt=yi(!1),ji=Si;function Lr(t,i){var s=t.type.contextTypes;if(!s)return Si;var u=t.stateNode;if(u&&u.__reactInternalMemoizedUnmaskedChildContext===i)return u.__reactInternalMemoizedMaskedChildContext;var f={},p;for(p in s)f[p]=i[p];return u&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=i,t.__reactInternalMemoizedMaskedChildContext=f),f}function $t(t){return t=t.childContextTypes,t!=null}function wa(){Ve(zt),Ve(Rt)}function qh(t,i,s){if(Rt.current!==Si)throw Error(r(168));We(Rt,i),We(zt,s)}function Qh(t,i,s){var u=t.stateNode;if(i=i.childContextTypes,typeof u.getChildContext!="function")return s;u=u.getChildContext();for(var f in u)if(!(f in i))throw Error(r(108,Se(t)||"Unknown",f));return $({},s,u)}function _a(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||Si,ji=Rt.current,We(Rt,t),We(zt,zt.current),!0}function Zh(t,i,s){var u=t.stateNode;if(!u)throw Error(r(169));s?(t=Qh(t,i,ji),u.__reactInternalMemoizedMergedChildContext=t,Ve(zt),Ve(Rt),We(Rt,t)):Ve(zt),We(zt,s)}var jn=null,Ca=!1,Qu=!1;function Jh(t){jn===null?jn=[t]:jn.push(t)}function qy(t){Ca=!0,Jh(t)}function Ai(){if(!Qu&&jn!==null){Qu=!0;var t=0,i=ze;try{var s=jn;for(ze=1;t<s.length;t++){var u=s[t];do u=u(!0);while(u!==null)}jn=null,Ca=!1}catch(f){throw jn!==null&&(jn=jn.slice(t+1)),th(Su,Ai),f}finally{ze=i,Qu=!1}}return null}var Br=[],Gr=0,Ra=null,Pa=0,rn=[],on=0,Vi=null,Vn=1,Xn="";function Xi(t,i){Br[Gr++]=Pa,Br[Gr++]=Ra,Ra=t,Pa=i}function ep(t,i,s){rn[on++]=Vn,rn[on++]=Xn,rn[on++]=Vi,Vi=t;var u=Vn;t=Xn;var f=32-pn(u)-1;u&=~(1<<f),s+=1;var p=32-pn(i)+f;if(30<p){var v=f-f%5;p=(u&(1<<v)-1).toString(32),u>>=v,f-=v,Vn=1<<32-pn(i)+f|s<<f|u,Xn=p+t}else Vn=1<<p|s<<f|u,Xn=t}function Zu(t){t.return!==null&&(Xi(t,1),ep(t,1,0))}function Ju(t){for(;t===Ra;)Ra=Br[--Gr],Br[Gr]=null,Pa=Br[--Gr],Br[Gr]=null;for(;t===Vi;)Vi=rn[--on],rn[on]=null,Xn=rn[--on],rn[on]=null,Vn=rn[--on],rn[on]=null}var Qt=null,Zt=null,Qe=!1,mn=null;function tp(t,i){var s=un(5,null,null,0);s.elementType="DELETED",s.stateNode=i,s.return=t,i=t.deletions,i===null?(t.deletions=[s],t.flags|=16):i.push(s)}function np(t,i){switch(t.tag){case 5:var s=t.type;return i=i.nodeType!==1||s.toLowerCase()!==i.nodeName.toLowerCase()?null:i,i!==null?(t.stateNode=i,Qt=t,Zt=vi(i.firstChild),!0):!1;case 6:return i=t.pendingProps===""||i.nodeType!==3?null:i,i!==null?(t.stateNode=i,Qt=t,Zt=null,!0):!1;case 13:return i=i.nodeType!==8?null:i,i!==null?(s=Vi!==null?{id:Vn,overflow:Xn}:null,t.memoizedState={dehydrated:i,treeContext:s,retryLane:1073741824},s=un(18,null,null,0),s.stateNode=i,s.return=t,t.child=s,Qt=t,Zt=null,!0):!1;default:return!1}}function ec(t){return(t.mode&1)!==0&&(t.flags&128)===0}function tc(t){if(Qe){var i=Zt;if(i){var s=i;if(!np(t,i)){if(ec(t))throw Error(r(418));i=vi(s.nextSibling);var u=Qt;i&&np(t,i)?tp(u,s):(t.flags=t.flags&-4097|2,Qe=!1,Qt=t)}}else{if(ec(t))throw Error(r(418));t.flags=t.flags&-4097|2,Qe=!1,Qt=t}}}function ip(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;Qt=t}function Na(t){if(t!==Qt)return!1;if(!Qe)return ip(t),Qe=!0,!1;var i;if((i=t.tag!==3)&&!(i=t.tag!==5)&&(i=t.type,i=i!=="head"&&i!=="body"&&!ju(t.type,t.memoizedProps)),i&&(i=Zt)){if(ec(t))throw rp(),Error(r(418));for(;i;)tp(t,i),i=vi(i.nextSibling)}if(ip(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(r(317));e:{for(t=t.nextSibling,i=0;t;){if(t.nodeType===8){var s=t.data;if(s==="/$"){if(i===0){Zt=vi(t.nextSibling);break e}i--}else s!=="$"&&s!=="$!"&&s!=="$?"||i++}t=t.nextSibling}Zt=null}}else Zt=Qt?vi(t.stateNode.nextSibling):null;return!0}function rp(){for(var t=Zt;t;)t=vi(t.nextSibling)}function br(){Zt=Qt=null,Qe=!1}function nc(t){mn===null?mn=[t]:mn.push(t)}var Qy=B.ReactCurrentBatchConfig;function Zo(t,i,s){if(t=s.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(s._owner){if(s=s._owner,s){if(s.tag!==1)throw Error(r(309));var u=s.stateNode}if(!u)throw Error(r(147,t));var f=u,p=""+t;return i!==null&&i.ref!==null&&typeof i.ref=="function"&&i.ref._stringRef===p?i.ref:(i=function(v){var A=f.refs;v===null?delete A[p]:A[p]=v},i._stringRef=p,i)}if(typeof t!="string")throw Error(r(284));if(!s._owner)throw Error(r(290,t))}return t}function Da(t,i){throw t=Object.prototype.toString.call(i),Error(r(31,t==="[object Object]"?"object with keys {"+Object.keys(i).join(", ")+"}":t))}function op(t){var i=t._init;return i(t._payload)}function sp(t){function i(N,P){if(t){var k=N.deletions;k===null?(N.deletions=[P],N.flags|=16):k.push(P)}}function s(N,P){if(!t)return null;for(;P!==null;)i(N,P),P=P.sibling;return null}function u(N,P){for(N=new Map;P!==null;)P.key!==null?N.set(P.key,P):N.set(P.index,P),P=P.sibling;return N}function f(N,P){return N=Pi(N,P),N.index=0,N.sibling=null,N}function p(N,P,k){return N.index=k,t?(k=N.alternate,k!==null?(k=k.index,k<P?(N.flags|=2,P):k):(N.flags|=2,P)):(N.flags|=1048576,P)}function v(N){return t&&N.alternate===null&&(N.flags|=2),N}function A(N,P,k,W){return P===null||P.tag!==6?(P=Vc(k,N.mode,W),P.return=N,P):(P=f(P,k),P.return=N,P)}function w(N,P,k,W){var oe=k.type;return oe===Y?G(N,P,k.props.children,W,k.key):P!==null&&(P.elementType===oe||typeof oe=="object"&&oe!==null&&oe.$$typeof===ye&&op(oe)===P.type)?(W=f(P,k.props),W.ref=Zo(N,P,k),W.return=N,W):(W=el(k.type,k.key,k.props,null,N.mode,W),W.ref=Zo(N,P,k),W.return=N,W)}function O(N,P,k,W){return P===null||P.tag!==4||P.stateNode.containerInfo!==k.containerInfo||P.stateNode.implementation!==k.implementation?(P=Xc(k,N.mode,W),P.return=N,P):(P=f(P,k.children||[]),P.return=N,P)}function G(N,P,k,W,oe){return P===null||P.tag!==7?(P=nr(k,N.mode,W,oe),P.return=N,P):(P=f(P,k),P.return=N,P)}function b(N,P,k){if(typeof P=="string"&&P!==""||typeof P=="number")return P=Vc(""+P,N.mode,k),P.return=N,P;if(typeof P=="object"&&P!==null){switch(P.$$typeof){case x:return k=el(P.type,P.key,P.props,null,N.mode,k),k.ref=Zo(N,null,P),k.return=N,k;case U:return P=Xc(P,N.mode,k),P.return=N,P;case ye:var W=P._init;return b(N,W(P._payload),k)}if(On(P)||j(P))return P=nr(P,N.mode,k,null),P.return=N,P;Da(N,P)}return null}function L(N,P,k,W){var oe=P!==null?P.key:null;if(typeof k=="string"&&k!==""||typeof k=="number")return oe!==null?null:A(N,P,""+k,W);if(typeof k=="object"&&k!==null){switch(k.$$typeof){case x:return k.key===oe?w(N,P,k,W):null;case U:return k.key===oe?O(N,P,k,W):null;case ye:return oe=k._init,L(N,P,oe(k._payload),W)}if(On(k)||j(k))return oe!==null?null:G(N,P,k,W,null);Da(N,k)}return null}function q(N,P,k,W,oe){if(typeof W=="string"&&W!==""||typeof W=="number")return N=N.get(k)||null,A(P,N,""+W,oe);if(typeof W=="object"&&W!==null){switch(W.$$typeof){case x:return N=N.get(W.key===null?k:W.key)||null,w(P,N,W,oe);case U:return N=N.get(W.key===null?k:W.key)||null,O(P,N,W,oe);case ye:var de=W._init;return q(N,P,k,de(W._payload),oe)}if(On(W)||j(W))return N=N.get(k)||null,G(P,N,W,oe,null);Da(P,W)}return null}function Z(N,P,k,W){for(var oe=null,de=null,fe=P,Ae=P=0,gt=null;fe!==null&&Ae<k.length;Ae++){fe.index>Ae?(gt=fe,fe=null):gt=fe.sibling;var Ge=L(N,fe,k[Ae],W);if(Ge===null){fe===null&&(fe=gt);break}t&&fe&&Ge.alternate===null&&i(N,fe),P=p(Ge,P,Ae),de===null?oe=Ge:de.sibling=Ge,de=Ge,fe=gt}if(Ae===k.length)return s(N,fe),Qe&&Xi(N,Ae),oe;if(fe===null){for(;Ae<k.length;Ae++)fe=b(N,k[Ae],W),fe!==null&&(P=p(fe,P,Ae),de===null?oe=fe:de.sibling=fe,de=fe);return Qe&&Xi(N,Ae),oe}for(fe=u(N,fe);Ae<k.length;Ae++)gt=q(fe,N,Ae,k[Ae],W),gt!==null&&(t&&gt.alternate!==null&&fe.delete(gt.key===null?Ae:gt.key),P=p(gt,P,Ae),de===null?oe=gt:de.sibling=gt,de=gt);return t&&fe.forEach(function(Ni){return i(N,Ni)}),Qe&&Xi(N,Ae),oe}function ne(N,P,k,W){var oe=j(k);if(typeof oe!="function")throw Error(r(150));if(k=oe.call(k),k==null)throw Error(r(151));for(var de=oe=null,fe=P,Ae=P=0,gt=null,Ge=k.next();fe!==null&&!Ge.done;Ae++,Ge=k.next()){fe.index>Ae?(gt=fe,fe=null):gt=fe.sibling;var Ni=L(N,fe,Ge.value,W);if(Ni===null){fe===null&&(fe=gt);break}t&&fe&&Ni.alternate===null&&i(N,fe),P=p(Ni,P,Ae),de===null?oe=Ni:de.sibling=Ni,de=Ni,fe=gt}if(Ge.done)return s(N,fe),Qe&&Xi(N,Ae),oe;if(fe===null){for(;!Ge.done;Ae++,Ge=k.next())Ge=b(N,Ge.value,W),Ge!==null&&(P=p(Ge,P,Ae),de===null?oe=Ge:de.sibling=Ge,de=Ge);return Qe&&Xi(N,Ae),oe}for(fe=u(N,fe);!Ge.done;Ae++,Ge=k.next())Ge=q(fe,N,Ae,Ge.value,W),Ge!==null&&(t&&Ge.alternate!==null&&fe.delete(Ge.key===null?Ae:Ge.key),P=p(Ge,P,Ae),de===null?oe=Ge:de.sibling=Ge,de=Ge);return t&&fe.forEach(function(DS){return i(N,DS)}),Qe&&Xi(N,Ae),oe}function st(N,P,k,W){if(typeof k=="object"&&k!==null&&k.type===Y&&k.key===null&&(k=k.props.children),typeof k=="object"&&k!==null){switch(k.$$typeof){case x:e:{for(var oe=k.key,de=P;de!==null;){if(de.key===oe){if(oe=k.type,oe===Y){if(de.tag===7){s(N,de.sibling),P=f(de,k.props.children),P.return=N,N=P;break e}}else if(de.elementType===oe||typeof oe=="object"&&oe!==null&&oe.$$typeof===ye&&op(oe)===de.type){s(N,de.sibling),P=f(de,k.props),P.ref=Zo(N,de,k),P.return=N,N=P;break e}s(N,de);break}else i(N,de);de=de.sibling}k.type===Y?(P=nr(k.props.children,N.mode,W,k.key),P.return=N,N=P):(W=el(k.type,k.key,k.props,null,N.mode,W),W.ref=Zo(N,P,k),W.return=N,N=W)}return v(N);case U:e:{for(de=k.key;P!==null;){if(P.key===de)if(P.tag===4&&P.stateNode.containerInfo===k.containerInfo&&P.stateNode.implementation===k.implementation){s(N,P.sibling),P=f(P,k.children||[]),P.return=N,N=P;break e}else{s(N,P);break}else i(N,P);P=P.sibling}P=Xc(k,N.mode,W),P.return=N,N=P}return v(N);case ye:return de=k._init,st(N,P,de(k._payload),W)}if(On(k))return Z(N,P,k,W);if(j(k))return ne(N,P,k,W);Da(N,k)}return typeof k=="string"&&k!==""||typeof k=="number"?(k=""+k,P!==null&&P.tag===6?(s(N,P.sibling),P=f(P,k),P.return=N,N=P):(s(N,P),P=Vc(k,N.mode,W),P.return=N,N=P),v(N)):s(N,P)}return st}var xr=sp(!0),ap=sp(!1),ka=yi(null),Oa=null,zr=null,ic=null;function rc(){ic=zr=Oa=null}function oc(t){var i=ka.current;Ve(ka),t._currentValue=i}function sc(t,i,s){for(;t!==null;){var u=t.alternate;if((t.childLanes&i)!==i?(t.childLanes|=i,u!==null&&(u.childLanes|=i)):u!==null&&(u.childLanes&i)!==i&&(u.childLanes|=i),t===s)break;t=t.return}}function $r(t,i){Oa=t,ic=zr=null,t=t.dependencies,t!==null&&t.firstContext!==null&&((t.lanes&i)!==0&&(Wt=!0),t.firstContext=null)}function sn(t){var i=t._currentValue;if(ic!==t)if(t={context:t,memoizedValue:i,next:null},zr===null){if(Oa===null)throw Error(r(308));zr=t,Oa.dependencies={lanes:0,firstContext:t}}else zr=zr.next=t;return i}var Ki=null;function ac(t){Ki===null?Ki=[t]:Ki.push(t)}function lp(t,i,s,u){var f=i.interleaved;return f===null?(s.next=s,ac(i)):(s.next=f.next,f.next=s),i.interleaved=s,Kn(t,u)}function Kn(t,i){t.lanes|=i;var s=t.alternate;for(s!==null&&(s.lanes|=i),s=t,t=t.return;t!==null;)t.childLanes|=i,s=t.alternate,s!==null&&(s.childLanes|=i),s=t,t=t.return;return s.tag===3?s.stateNode:null}var Ti=!1;function lc(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function up(t,i){t=t.updateQueue,i.updateQueue===t&&(i.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function qn(t,i){return{eventTime:t,lane:i,tag:0,payload:null,callback:null,next:null}}function Ii(t,i,s){var u=t.updateQueue;if(u===null)return null;if(u=u.shared,(Le&2)!==0){var f=u.pending;return f===null?i.next=i:(i.next=f.next,f.next=i),u.pending=i,Kn(t,s)}return f=u.interleaved,f===null?(i.next=i,ac(u)):(i.next=f.next,f.next=i),u.interleaved=i,Kn(t,s)}function Ma(t,i,s){if(i=i.updateQueue,i!==null&&(i=i.shared,(s&4194240)!==0)){var u=i.lanes;u&=t.pendingLanes,s|=u,i.lanes=s,Iu(t,s)}}function cp(t,i){var s=t.updateQueue,u=t.alternate;if(u!==null&&(u=u.updateQueue,s===u)){var f=null,p=null;if(s=s.firstBaseUpdate,s!==null){do{var v={eventTime:s.eventTime,lane:s.lane,tag:s.tag,payload:s.payload,callback:s.callback,next:null};p===null?f=p=v:p=p.next=v,s=s.next}while(s!==null);p===null?f=p=i:p=p.next=i}else f=p=i;s={baseState:u.baseState,firstBaseUpdate:f,lastBaseUpdate:p,shared:u.shared,effects:u.effects},t.updateQueue=s;return}t=s.lastBaseUpdate,t===null?s.firstBaseUpdate=i:t.next=i,s.lastBaseUpdate=i}function Fa(t,i,s,u){var f=t.updateQueue;Ti=!1;var p=f.firstBaseUpdate,v=f.lastBaseUpdate,A=f.shared.pending;if(A!==null){f.shared.pending=null;var w=A,O=w.next;w.next=null,v===null?p=O:v.next=O,v=w;var G=t.alternate;G!==null&&(G=G.updateQueue,A=G.lastBaseUpdate,A!==v&&(A===null?G.firstBaseUpdate=O:A.next=O,G.lastBaseUpdate=w))}if(p!==null){var b=f.baseState;v=0,G=O=w=null,A=p;do{var L=A.lane,q=A.eventTime;if((u&L)===L){G!==null&&(G=G.next={eventTime:q,lane:0,tag:A.tag,payload:A.payload,callback:A.callback,next:null});e:{var Z=t,ne=A;switch(L=i,q=s,ne.tag){case 1:if(Z=ne.payload,typeof Z=="function"){b=Z.call(q,b,L);break e}b=Z;break e;case 3:Z.flags=Z.flags&-65537|128;case 0:if(Z=ne.payload,L=typeof Z=="function"?Z.call(q,b,L):Z,L==null)break e;b=$({},b,L);break e;case 2:Ti=!0}}A.callback!==null&&A.lane!==0&&(t.flags|=64,L=f.effects,L===null?f.effects=[A]:L.push(A))}else q={eventTime:q,lane:L,tag:A.tag,payload:A.payload,callback:A.callback,next:null},G===null?(O=G=q,w=b):G=G.next=q,v|=L;if(A=A.next,A===null){if(A=f.shared.pending,A===null)break;L=A,A=L.next,L.next=null,f.lastBaseUpdate=L,f.shared.pending=null}}while(!0);if(G===null&&(w=b),f.baseState=w,f.firstBaseUpdate=O,f.lastBaseUpdate=G,i=f.shared.interleaved,i!==null){f=i;do v|=f.lane,f=f.next;while(f!==i)}else p===null&&(f.shared.lanes=0);Zi|=v,t.lanes=v,t.memoizedState=b}}function dp(t,i,s){if(t=i.effects,i.effects=null,t!==null)for(i=0;i<t.length;i++){var u=t[i],f=u.callback;if(f!==null){if(u.callback=null,u=s,typeof f!="function")throw Error(r(191,f));f.call(u)}}}var Jo={},Un=yi(Jo),es=yi(Jo),ts=yi(Jo);function qi(t){if(t===Jo)throw Error(r(174));return t}function uc(t,i){switch(We(ts,i),We(es,t),We(Un,Jo),t=i.nodeType,t){case 9:case 11:i=(i=i.documentElement)?i.namespaceURI:cu(null,"");break;default:t=t===8?i.parentNode:i,i=t.namespaceURI||null,t=t.tagName,i=cu(i,t)}Ve(Un),We(Un,i)}function Wr(){Ve(Un),Ve(es),Ve(ts)}function fp(t){qi(ts.current);var i=qi(Un.current),s=cu(i,t.type);i!==s&&(We(es,t),We(Un,s))}function cc(t){es.current===t&&(Ve(Un),Ve(es))}var nt=yi(0);function Ua(t){for(var i=t;i!==null;){if(i.tag===13){var s=i.memoizedState;if(s!==null&&(s=s.dehydrated,s===null||s.data==="$?"||s.data==="$!"))return i}else if(i.tag===19&&i.memoizedProps.revealOrder!==void 0){if((i.flags&128)!==0)return i}else if(i.child!==null){i.child.return=i,i=i.child;continue}if(i===t)break;for(;i.sibling===null;){if(i.return===null||i.return===t)return null;i=i.return}i.sibling.return=i.return,i=i.sibling}return null}var dc=[];function fc(){for(var t=0;t<dc.length;t++)dc[t]._workInProgressVersionPrimary=null;dc.length=0}var Ha=B.ReactCurrentDispatcher,hc=B.ReactCurrentBatchConfig,Qi=0,it=null,dt=null,ht=null,La=!1,ns=!1,is=0,Zy=0;function Pt(){throw Error(r(321))}function pc(t,i){if(i===null)return!1;for(var s=0;s<i.length&&s<t.length;s++)if(!gn(t[s],i[s]))return!1;return!0}function gc(t,i,s,u,f,p){if(Qi=p,it=i,i.memoizedState=null,i.updateQueue=null,i.lanes=0,Ha.current=t===null||t.memoizedState===null?nS:iS,t=s(u,f),ns){p=0;do{if(ns=!1,is=0,25<=p)throw Error(r(301));p+=1,ht=dt=null,i.updateQueue=null,Ha.current=rS,t=s(u,f)}while(ns)}if(Ha.current=ba,i=dt!==null&&dt.next!==null,Qi=0,ht=dt=it=null,La=!1,i)throw Error(r(300));return t}function mc(){var t=is!==0;return is=0,t}function Hn(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return ht===null?it.memoizedState=ht=t:ht=ht.next=t,ht}function an(){if(dt===null){var t=it.alternate;t=t!==null?t.memoizedState:null}else t=dt.next;var i=ht===null?it.memoizedState:ht.next;if(i!==null)ht=i,dt=t;else{if(t===null)throw Error(r(310));dt=t,t={memoizedState:dt.memoizedState,baseState:dt.baseState,baseQueue:dt.baseQueue,queue:dt.queue,next:null},ht===null?it.memoizedState=ht=t:ht=ht.next=t}return ht}function rs(t,i){return typeof i=="function"?i(t):i}function vc(t){var i=an(),s=i.queue;if(s===null)throw Error(r(311));s.lastRenderedReducer=t;var u=dt,f=u.baseQueue,p=s.pending;if(p!==null){if(f!==null){var v=f.next;f.next=p.next,p.next=v}u.baseQueue=f=p,s.pending=null}if(f!==null){p=f.next,u=u.baseState;var A=v=null,w=null,O=p;do{var G=O.lane;if((Qi&G)===G)w!==null&&(w=w.next={lane:0,action:O.action,hasEagerState:O.hasEagerState,eagerState:O.eagerState,next:null}),u=O.hasEagerState?O.eagerState:t(u,O.action);else{var b={lane:G,action:O.action,hasEagerState:O.hasEagerState,eagerState:O.eagerState,next:null};w===null?(A=w=b,v=u):w=w.next=b,it.lanes|=G,Zi|=G}O=O.next}while(O!==null&&O!==p);w===null?v=u:w.next=A,gn(u,i.memoizedState)||(Wt=!0),i.memoizedState=u,i.baseState=v,i.baseQueue=w,s.lastRenderedState=u}if(t=s.interleaved,t!==null){f=t;do p=f.lane,it.lanes|=p,Zi|=p,f=f.next;while(f!==t)}else f===null&&(s.lanes=0);return[i.memoizedState,s.dispatch]}function yc(t){var i=an(),s=i.queue;if(s===null)throw Error(r(311));s.lastRenderedReducer=t;var u=s.dispatch,f=s.pending,p=i.memoizedState;if(f!==null){s.pending=null;var v=f=f.next;do p=t(p,v.action),v=v.next;while(v!==f);gn(p,i.memoizedState)||(Wt=!0),i.memoizedState=p,i.baseQueue===null&&(i.baseState=p),s.lastRenderedState=p}return[p,u]}function hp(){}function pp(t,i){var s=it,u=an(),f=i(),p=!gn(u.memoizedState,f);if(p&&(u.memoizedState=f,Wt=!0),u=u.queue,Sc(vp.bind(null,s,u,t),[t]),u.getSnapshot!==i||p||ht!==null&&ht.memoizedState.tag&1){if(s.flags|=2048,os(9,mp.bind(null,s,u,f,i),void 0,null),pt===null)throw Error(r(349));(Qi&30)!==0||gp(s,i,f)}return f}function gp(t,i,s){t.flags|=16384,t={getSnapshot:i,value:s},i=it.updateQueue,i===null?(i={lastEffect:null,stores:null},it.updateQueue=i,i.stores=[t]):(s=i.stores,s===null?i.stores=[t]:s.push(t))}function mp(t,i,s,u){i.value=s,i.getSnapshot=u,yp(i)&&Sp(t)}function vp(t,i,s){return s(function(){yp(i)&&Sp(t)})}function yp(t){var i=t.getSnapshot;t=t.value;try{var s=i();return!gn(t,s)}catch{return!0}}function Sp(t){var i=Kn(t,1);i!==null&&An(i,t,1,-1)}function Ap(t){var i=Hn();return typeof t=="function"&&(t=t()),i.memoizedState=i.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:rs,lastRenderedState:t},i.queue=t,t=t.dispatch=tS.bind(null,it,t),[i.memoizedState,t]}function os(t,i,s,u){return t={tag:t,create:i,destroy:s,deps:u,next:null},i=it.updateQueue,i===null?(i={lastEffect:null,stores:null},it.updateQueue=i,i.lastEffect=t.next=t):(s=i.lastEffect,s===null?i.lastEffect=t.next=t:(u=s.next,s.next=t,t.next=u,i.lastEffect=t)),t}function Tp(){return an().memoizedState}function Ba(t,i,s,u){var f=Hn();it.flags|=t,f.memoizedState=os(1|i,s,void 0,u===void 0?null:u)}function Ga(t,i,s,u){var f=an();u=u===void 0?null:u;var p=void 0;if(dt!==null){var v=dt.memoizedState;if(p=v.destroy,u!==null&&pc(u,v.deps)){f.memoizedState=os(i,s,p,u);return}}it.flags|=t,f.memoizedState=os(1|i,s,p,u)}function Ip(t,i){return Ba(8390656,8,t,i)}function Sc(t,i){return Ga(2048,8,t,i)}function Ep(t,i){return Ga(4,2,t,i)}function wp(t,i){return Ga(4,4,t,i)}function _p(t,i){if(typeof i=="function")return t=t(),i(t),function(){i(null)};if(i!=null)return t=t(),i.current=t,function(){i.current=null}}function Cp(t,i,s){return s=s!=null?s.concat([t]):null,Ga(4,4,_p.bind(null,i,t),s)}function Ac(){}function Rp(t,i){var s=an();i=i===void 0?null:i;var u=s.memoizedState;return u!==null&&i!==null&&pc(i,u[1])?u[0]:(s.memoizedState=[t,i],t)}function Pp(t,i){var s=an();i=i===void 0?null:i;var u=s.memoizedState;return u!==null&&i!==null&&pc(i,u[1])?u[0]:(t=t(),s.memoizedState=[t,i],t)}function Np(t,i,s){return(Qi&21)===0?(t.baseState&&(t.baseState=!1,Wt=!0),t.memoizedState=s):(gn(s,i)||(s=oh(),it.lanes|=s,Zi|=s,t.baseState=!0),i)}function Jy(t,i){var s=ze;ze=s!==0&&4>s?s:4,t(!0);var u=hc.transition;hc.transition={};try{t(!1),i()}finally{ze=s,hc.transition=u}}function Dp(){return an().memoizedState}function eS(t,i,s){var u=Ci(t);if(s={lane:u,action:s,hasEagerState:!1,eagerState:null,next:null},kp(t))Op(i,s);else if(s=lp(t,i,s,u),s!==null){var f=Ft();An(s,t,u,f),Mp(s,i,u)}}function tS(t,i,s){var u=Ci(t),f={lane:u,action:s,hasEagerState:!1,eagerState:null,next:null};if(kp(t))Op(i,f);else{var p=t.alternate;if(t.lanes===0&&(p===null||p.lanes===0)&&(p=i.lastRenderedReducer,p!==null))try{var v=i.lastRenderedState,A=p(v,s);if(f.hasEagerState=!0,f.eagerState=A,gn(A,v)){var w=i.interleaved;w===null?(f.next=f,ac(i)):(f.next=w.next,w.next=f),i.interleaved=f;return}}catch{}finally{}s=lp(t,i,f,u),s!==null&&(f=Ft(),An(s,t,u,f),Mp(s,i,u))}}function kp(t){var i=t.alternate;return t===it||i!==null&&i===it}function Op(t,i){ns=La=!0;var s=t.pending;s===null?i.next=i:(i.next=s.next,s.next=i),t.pending=i}function Mp(t,i,s){if((s&4194240)!==0){var u=i.lanes;u&=t.pendingLanes,s|=u,i.lanes=s,Iu(t,s)}}var ba={readContext:sn,useCallback:Pt,useContext:Pt,useEffect:Pt,useImperativeHandle:Pt,useInsertionEffect:Pt,useLayoutEffect:Pt,useMemo:Pt,useReducer:Pt,useRef:Pt,useState:Pt,useDebugValue:Pt,useDeferredValue:Pt,useTransition:Pt,useMutableSource:Pt,useSyncExternalStore:Pt,useId:Pt,unstable_isNewReconciler:!1},nS={readContext:sn,useCallback:function(t,i){return Hn().memoizedState=[t,i===void 0?null:i],t},useContext:sn,useEffect:Ip,useImperativeHandle:function(t,i,s){return s=s!=null?s.concat([t]):null,Ba(4194308,4,_p.bind(null,i,t),s)},useLayoutEffect:function(t,i){return Ba(4194308,4,t,i)},useInsertionEffect:function(t,i){return Ba(4,2,t,i)},useMemo:function(t,i){var s=Hn();return i=i===void 0?null:i,t=t(),s.memoizedState=[t,i],t},useReducer:function(t,i,s){var u=Hn();return i=s!==void 0?s(i):i,u.memoizedState=u.baseState=i,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:i},u.queue=t,t=t.dispatch=eS.bind(null,it,t),[u.memoizedState,t]},useRef:function(t){var i=Hn();return t={current:t},i.memoizedState=t},useState:Ap,useDebugValue:Ac,useDeferredValue:function(t){return Hn().memoizedState=t},useTransition:function(){var t=Ap(!1),i=t[0];return t=Jy.bind(null,t[1]),Hn().memoizedState=t,[i,t]},useMutableSource:function(){},useSyncExternalStore:function(t,i,s){var u=it,f=Hn();if(Qe){if(s===void 0)throw Error(r(407));s=s()}else{if(s=i(),pt===null)throw Error(r(349));(Qi&30)!==0||gp(u,i,s)}f.memoizedState=s;var p={value:s,getSnapshot:i};return f.queue=p,Ip(vp.bind(null,u,p,t),[t]),u.flags|=2048,os(9,mp.bind(null,u,p,s,i),void 0,null),s},useId:function(){var t=Hn(),i=pt.identifierPrefix;if(Qe){var s=Xn,u=Vn;s=(u&~(1<<32-pn(u)-1)).toString(32)+s,i=":"+i+"R"+s,s=is++,0<s&&(i+="H"+s.toString(32)),i+=":"}else s=Zy++,i=":"+i+"r"+s.toString(32)+":";return t.memoizedState=i},unstable_isNewReconciler:!1},iS={readContext:sn,useCallback:Rp,useContext:sn,useEffect:Sc,useImperativeHandle:Cp,useInsertionEffect:Ep,useLayoutEffect:wp,useMemo:Pp,useReducer:vc,useRef:Tp,useState:function(){return vc(rs)},useDebugValue:Ac,useDeferredValue:function(t){var i=an();return Np(i,dt.memoizedState,t)},useTransition:function(){var t=vc(rs)[0],i=an().memoizedState;return[t,i]},useMutableSource:hp,useSyncExternalStore:pp,useId:Dp,unstable_isNewReconciler:!1},rS={readContext:sn,useCallback:Rp,useContext:sn,useEffect:Sc,useImperativeHandle:Cp,useInsertionEffect:Ep,useLayoutEffect:wp,useMemo:Pp,useReducer:yc,useRef:Tp,useState:function(){return yc(rs)},useDebugValue:Ac,useDeferredValue:function(t){var i=an();return dt===null?i.memoizedState=t:Np(i,dt.memoizedState,t)},useTransition:function(){var t=yc(rs)[0],i=an().memoizedState;return[t,i]},useMutableSource:hp,useSyncExternalStore:pp,useId:Dp,unstable_isNewReconciler:!1};function vn(t,i){if(t&&t.defaultProps){i=$({},i),t=t.defaultProps;for(var s in t)i[s]===void 0&&(i[s]=t[s]);return i}return i}function Tc(t,i,s,u){i=t.memoizedState,s=s(u,i),s=s==null?i:$({},i,s),t.memoizedState=s,t.lanes===0&&(t.updateQueue.baseState=s)}var xa={isMounted:function(t){return(t=t._reactInternals)?Wi(t)===t:!1},enqueueSetState:function(t,i,s){t=t._reactInternals;var u=Ft(),f=Ci(t),p=qn(u,f);p.payload=i,s!=null&&(p.callback=s),i=Ii(t,p,f),i!==null&&(An(i,t,f,u),Ma(i,t,f))},enqueueReplaceState:function(t,i,s){t=t._reactInternals;var u=Ft(),f=Ci(t),p=qn(u,f);p.tag=1,p.payload=i,s!=null&&(p.callback=s),i=Ii(t,p,f),i!==null&&(An(i,t,f,u),Ma(i,t,f))},enqueueForceUpdate:function(t,i){t=t._reactInternals;var s=Ft(),u=Ci(t),f=qn(s,u);f.tag=2,i!=null&&(f.callback=i),i=Ii(t,f,u),i!==null&&(An(i,t,u,s),Ma(i,t,u))}};function Fp(t,i,s,u,f,p,v){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(u,p,v):i.prototype&&i.prototype.isPureReactComponent?!Yo(s,u)||!Yo(f,p):!0}function Up(t,i,s){var u=!1,f=Si,p=i.contextType;return typeof p=="object"&&p!==null?p=sn(p):(f=$t(i)?ji:Rt.current,u=i.contextTypes,p=(u=u!=null)?Lr(t,f):Si),i=new i(s,p),t.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,i.updater=xa,t.stateNode=i,i._reactInternals=t,u&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=f,t.__reactInternalMemoizedMaskedChildContext=p),i}function Hp(t,i,s,u){t=i.state,typeof i.componentWillReceiveProps=="function"&&i.componentWillReceiveProps(s,u),typeof i.UNSAFE_componentWillReceiveProps=="function"&&i.UNSAFE_componentWillReceiveProps(s,u),i.state!==t&&xa.enqueueReplaceState(i,i.state,null)}function Ic(t,i,s,u){var f=t.stateNode;f.props=s,f.state=t.memoizedState,f.refs={},lc(t);var p=i.contextType;typeof p=="object"&&p!==null?f.context=sn(p):(p=$t(i)?ji:Rt.current,f.context=Lr(t,p)),f.state=t.memoizedState,p=i.getDerivedStateFromProps,typeof p=="function"&&(Tc(t,i,p,s),f.state=t.memoizedState),typeof i.getDerivedStateFromProps=="function"||typeof f.getSnapshotBeforeUpdate=="function"||typeof f.UNSAFE_componentWillMount!="function"&&typeof f.componentWillMount!="function"||(i=f.state,typeof f.componentWillMount=="function"&&f.componentWillMount(),typeof f.UNSAFE_componentWillMount=="function"&&f.UNSAFE_componentWillMount(),i!==f.state&&xa.enqueueReplaceState(f,f.state,null),Fa(t,s,f,u),f.state=t.memoizedState),typeof f.componentDidMount=="function"&&(t.flags|=4194308)}function Yr(t,i){try{var s="",u=i;do s+=he(u),u=u.return;while(u);var f=s}catch(p){f=`
Error generating stack: `+p.message+`
`+p.stack}return{value:t,source:i,stack:f,digest:null}}function Ec(t,i,s){return{value:t,source:null,stack:s??null,digest:i??null}}function wc(t,i){try{console.error(i.value)}catch(s){setTimeout(function(){throw s})}}var oS=typeof WeakMap=="function"?WeakMap:Map;function Lp(t,i,s){s=qn(-1,s),s.tag=3,s.payload={element:null};var u=i.value;return s.callback=function(){Xa||(Xa=!0,Gc=u),wc(t,i)},s}function Bp(t,i,s){s=qn(-1,s),s.tag=3;var u=t.type.getDerivedStateFromError;if(typeof u=="function"){var f=i.value;s.payload=function(){return u(f)},s.callback=function(){wc(t,i)}}var p=t.stateNode;return p!==null&&typeof p.componentDidCatch=="function"&&(s.callback=function(){wc(t,i),typeof u!="function"&&(wi===null?wi=new Set([this]):wi.add(this));var v=i.stack;this.componentDidCatch(i.value,{componentStack:v!==null?v:""})}),s}function Gp(t,i,s){var u=t.pingCache;if(u===null){u=t.pingCache=new oS;var f=new Set;u.set(i,f)}else f=u.get(i),f===void 0&&(f=new Set,u.set(i,f));f.has(s)||(f.add(s),t=SS.bind(null,t,i,s),i.then(t,t))}function bp(t){do{var i;if((i=t.tag===13)&&(i=t.memoizedState,i=i!==null?i.dehydrated!==null:!0),i)return t;t=t.return}while(t!==null);return null}function xp(t,i,s,u,f){return(t.mode&1)===0?(t===i?t.flags|=65536:(t.flags|=128,s.flags|=131072,s.flags&=-52805,s.tag===1&&(s.alternate===null?s.tag=17:(i=qn(-1,1),i.tag=2,Ii(s,i,1))),s.lanes|=1),t):(t.flags|=65536,t.lanes=f,t)}var sS=B.ReactCurrentOwner,Wt=!1;function Mt(t,i,s,u){i.child=t===null?ap(i,null,s,u):xr(i,t.child,s,u)}function zp(t,i,s,u,f){s=s.render;var p=i.ref;return $r(i,f),u=gc(t,i,s,u,p,f),s=mc(),t!==null&&!Wt?(i.updateQueue=t.updateQueue,i.flags&=-2053,t.lanes&=~f,Qn(t,i,f)):(Qe&&s&&Zu(i),i.flags|=1,Mt(t,i,u,f),i.child)}function $p(t,i,s,u,f){if(t===null){var p=s.type;return typeof p=="function"&&!jc(p)&&p.defaultProps===void 0&&s.compare===null&&s.defaultProps===void 0?(i.tag=15,i.type=p,Wp(t,i,p,u,f)):(t=el(s.type,null,u,i,i.mode,f),t.ref=i.ref,t.return=i,i.child=t)}if(p=t.child,(t.lanes&f)===0){var v=p.memoizedProps;if(s=s.compare,s=s!==null?s:Yo,s(v,u)&&t.ref===i.ref)return Qn(t,i,f)}return i.flags|=1,t=Pi(p,u),t.ref=i.ref,t.return=i,i.child=t}function Wp(t,i,s,u,f){if(t!==null){var p=t.memoizedProps;if(Yo(p,u)&&t.ref===i.ref)if(Wt=!1,i.pendingProps=u=p,(t.lanes&f)!==0)(t.flags&131072)!==0&&(Wt=!0);else return i.lanes=t.lanes,Qn(t,i,f)}return _c(t,i,s,u,f)}function Yp(t,i,s){var u=i.pendingProps,f=u.children,p=t!==null?t.memoizedState:null;if(u.mode==="hidden")if((i.mode&1)===0)i.memoizedState={baseLanes:0,cachePool:null,transitions:null},We(Vr,Jt),Jt|=s;else{if((s&1073741824)===0)return t=p!==null?p.baseLanes|s:s,i.lanes=i.childLanes=1073741824,i.memoizedState={baseLanes:t,cachePool:null,transitions:null},i.updateQueue=null,We(Vr,Jt),Jt|=t,null;i.memoizedState={baseLanes:0,cachePool:null,transitions:null},u=p!==null?p.baseLanes:s,We(Vr,Jt),Jt|=u}else p!==null?(u=p.baseLanes|s,i.memoizedState=null):u=s,We(Vr,Jt),Jt|=u;return Mt(t,i,f,s),i.child}function jp(t,i){var s=i.ref;(t===null&&s!==null||t!==null&&t.ref!==s)&&(i.flags|=512,i.flags|=2097152)}function _c(t,i,s,u,f){var p=$t(s)?ji:Rt.current;return p=Lr(i,p),$r(i,f),s=gc(t,i,s,u,p,f),u=mc(),t!==null&&!Wt?(i.updateQueue=t.updateQueue,i.flags&=-2053,t.lanes&=~f,Qn(t,i,f)):(Qe&&u&&Zu(i),i.flags|=1,Mt(t,i,s,f),i.child)}function Vp(t,i,s,u,f){if($t(s)){var p=!0;_a(i)}else p=!1;if($r(i,f),i.stateNode===null)$a(t,i),Up(i,s,u),Ic(i,s,u,f),u=!0;else if(t===null){var v=i.stateNode,A=i.memoizedProps;v.props=A;var w=v.context,O=s.contextType;typeof O=="object"&&O!==null?O=sn(O):(O=$t(s)?ji:Rt.current,O=Lr(i,O));var G=s.getDerivedStateFromProps,b=typeof G=="function"||typeof v.getSnapshotBeforeUpdate=="function";b||typeof v.UNSAFE_componentWillReceiveProps!="function"&&typeof v.componentWillReceiveProps!="function"||(A!==u||w!==O)&&Hp(i,v,u,O),Ti=!1;var L=i.memoizedState;v.state=L,Fa(i,u,v,f),w=i.memoizedState,A!==u||L!==w||zt.current||Ti?(typeof G=="function"&&(Tc(i,s,G,u),w=i.memoizedState),(A=Ti||Fp(i,s,A,u,L,w,O))?(b||typeof v.UNSAFE_componentWillMount!="function"&&typeof v.componentWillMount!="function"||(typeof v.componentWillMount=="function"&&v.componentWillMount(),typeof v.UNSAFE_componentWillMount=="function"&&v.UNSAFE_componentWillMount()),typeof v.componentDidMount=="function"&&(i.flags|=4194308)):(typeof v.componentDidMount=="function"&&(i.flags|=4194308),i.memoizedProps=u,i.memoizedState=w),v.props=u,v.state=w,v.context=O,u=A):(typeof v.componentDidMount=="function"&&(i.flags|=4194308),u=!1)}else{v=i.stateNode,up(t,i),A=i.memoizedProps,O=i.type===i.elementType?A:vn(i.type,A),v.props=O,b=i.pendingProps,L=v.context,w=s.contextType,typeof w=="object"&&w!==null?w=sn(w):(w=$t(s)?ji:Rt.current,w=Lr(i,w));var q=s.getDerivedStateFromProps;(G=typeof q=="function"||typeof v.getSnapshotBeforeUpdate=="function")||typeof v.UNSAFE_componentWillReceiveProps!="function"&&typeof v.componentWillReceiveProps!="function"||(A!==b||L!==w)&&Hp(i,v,u,w),Ti=!1,L=i.memoizedState,v.state=L,Fa(i,u,v,f);var Z=i.memoizedState;A!==b||L!==Z||zt.current||Ti?(typeof q=="function"&&(Tc(i,s,q,u),Z=i.memoizedState),(O=Ti||Fp(i,s,O,u,L,Z,w)||!1)?(G||typeof v.UNSAFE_componentWillUpdate!="function"&&typeof v.componentWillUpdate!="function"||(typeof v.componentWillUpdate=="function"&&v.componentWillUpdate(u,Z,w),typeof v.UNSAFE_componentWillUpdate=="function"&&v.UNSAFE_componentWillUpdate(u,Z,w)),typeof v.componentDidUpdate=="function"&&(i.flags|=4),typeof v.getSnapshotBeforeUpdate=="function"&&(i.flags|=1024)):(typeof v.componentDidUpdate!="function"||A===t.memoizedProps&&L===t.memoizedState||(i.flags|=4),typeof v.getSnapshotBeforeUpdate!="function"||A===t.memoizedProps&&L===t.memoizedState||(i.flags|=1024),i.memoizedProps=u,i.memoizedState=Z),v.props=u,v.state=Z,v.context=w,u=O):(typeof v.componentDidUpdate!="function"||A===t.memoizedProps&&L===t.memoizedState||(i.flags|=4),typeof v.getSnapshotBeforeUpdate!="function"||A===t.memoizedProps&&L===t.memoizedState||(i.flags|=1024),u=!1)}return Cc(t,i,s,u,p,f)}function Cc(t,i,s,u,f,p){jp(t,i);var v=(i.flags&128)!==0;if(!u&&!v)return f&&Zh(i,s,!1),Qn(t,i,p);u=i.stateNode,sS.current=i;var A=v&&typeof s.getDerivedStateFromError!="function"?null:u.render();return i.flags|=1,t!==null&&v?(i.child=xr(i,t.child,null,p),i.child=xr(i,null,A,p)):Mt(t,i,A,p),i.memoizedState=u.state,f&&Zh(i,s,!0),i.child}function Xp(t){var i=t.stateNode;i.pendingContext?qh(t,i.pendingContext,i.pendingContext!==i.context):i.context&&qh(t,i.context,!1),uc(t,i.containerInfo)}function Kp(t,i,s,u,f){return br(),nc(f),i.flags|=256,Mt(t,i,s,u),i.child}var Rc={dehydrated:null,treeContext:null,retryLane:0};function Pc(t){return{baseLanes:t,cachePool:null,transitions:null}}function qp(t,i,s){var u=i.pendingProps,f=nt.current,p=!1,v=(i.flags&128)!==0,A;if((A=v)||(A=t!==null&&t.memoizedState===null?!1:(f&2)!==0),A?(p=!0,i.flags&=-129):(t===null||t.memoizedState!==null)&&(f|=1),We(nt,f&1),t===null)return tc(i),t=i.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?((i.mode&1)===0?i.lanes=1:t.data==="$!"?i.lanes=8:i.lanes=1073741824,null):(v=u.children,t=u.fallback,p?(u=i.mode,p=i.child,v={mode:"hidden",children:v},(u&1)===0&&p!==null?(p.childLanes=0,p.pendingProps=v):p=tl(v,u,0,null),t=nr(t,u,s,null),p.return=i,t.return=i,p.sibling=t,i.child=p,i.child.memoizedState=Pc(s),i.memoizedState=Rc,t):Nc(i,v));if(f=t.memoizedState,f!==null&&(A=f.dehydrated,A!==null))return aS(t,i,v,u,A,f,s);if(p){p=u.fallback,v=i.mode,f=t.child,A=f.sibling;var w={mode:"hidden",children:u.children};return(v&1)===0&&i.child!==f?(u=i.child,u.childLanes=0,u.pendingProps=w,i.deletions=null):(u=Pi(f,w),u.subtreeFlags=f.subtreeFlags&14680064),A!==null?p=Pi(A,p):(p=nr(p,v,s,null),p.flags|=2),p.return=i,u.return=i,u.sibling=p,i.child=u,u=p,p=i.child,v=t.child.memoizedState,v=v===null?Pc(s):{baseLanes:v.baseLanes|s,cachePool:null,transitions:v.transitions},p.memoizedState=v,p.childLanes=t.childLanes&~s,i.memoizedState=Rc,u}return p=t.child,t=p.sibling,u=Pi(p,{mode:"visible",children:u.children}),(i.mode&1)===0&&(u.lanes=s),u.return=i,u.sibling=null,t!==null&&(s=i.deletions,s===null?(i.deletions=[t],i.flags|=16):s.push(t)),i.child=u,i.memoizedState=null,u}function Nc(t,i){return i=tl({mode:"visible",children:i},t.mode,0,null),i.return=t,t.child=i}function za(t,i,s,u){return u!==null&&nc(u),xr(i,t.child,null,s),t=Nc(i,i.pendingProps.children),t.flags|=2,i.memoizedState=null,t}function aS(t,i,s,u,f,p,v){if(s)return i.flags&256?(i.flags&=-257,u=Ec(Error(r(422))),za(t,i,v,u)):i.memoizedState!==null?(i.child=t.child,i.flags|=128,null):(p=u.fallback,f=i.mode,u=tl({mode:"visible",children:u.children},f,0,null),p=nr(p,f,v,null),p.flags|=2,u.return=i,p.return=i,u.sibling=p,i.child=u,(i.mode&1)!==0&&xr(i,t.child,null,v),i.child.memoizedState=Pc(v),i.memoizedState=Rc,p);if((i.mode&1)===0)return za(t,i,v,null);if(f.data==="$!"){if(u=f.nextSibling&&f.nextSibling.dataset,u)var A=u.dgst;return u=A,p=Error(r(419)),u=Ec(p,u,void 0),za(t,i,v,u)}if(A=(v&t.childLanes)!==0,Wt||A){if(u=pt,u!==null){switch(v&-v){case 4:f=2;break;case 16:f=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:f=32;break;case 536870912:f=268435456;break;default:f=0}f=(f&(u.suspendedLanes|v))!==0?0:f,f!==0&&f!==p.retryLane&&(p.retryLane=f,Kn(t,f),An(u,t,f,-1))}return Yc(),u=Ec(Error(r(421))),za(t,i,v,u)}return f.data==="$?"?(i.flags|=128,i.child=t.child,i=AS.bind(null,t),f._reactRetry=i,null):(t=p.treeContext,Zt=vi(f.nextSibling),Qt=i,Qe=!0,mn=null,t!==null&&(rn[on++]=Vn,rn[on++]=Xn,rn[on++]=Vi,Vn=t.id,Xn=t.overflow,Vi=i),i=Nc(i,u.children),i.flags|=4096,i)}function Qp(t,i,s){t.lanes|=i;var u=t.alternate;u!==null&&(u.lanes|=i),sc(t.return,i,s)}function Dc(t,i,s,u,f){var p=t.memoizedState;p===null?t.memoizedState={isBackwards:i,rendering:null,renderingStartTime:0,last:u,tail:s,tailMode:f}:(p.isBackwards=i,p.rendering=null,p.renderingStartTime=0,p.last=u,p.tail=s,p.tailMode=f)}function Zp(t,i,s){var u=i.pendingProps,f=u.revealOrder,p=u.tail;if(Mt(t,i,u.children,s),u=nt.current,(u&2)!==0)u=u&1|2,i.flags|=128;else{if(t!==null&&(t.flags&128)!==0)e:for(t=i.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&Qp(t,s,i);else if(t.tag===19)Qp(t,s,i);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===i)break e;for(;t.sibling===null;){if(t.return===null||t.return===i)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}u&=1}if(We(nt,u),(i.mode&1)===0)i.memoizedState=null;else switch(f){case"forwards":for(s=i.child,f=null;s!==null;)t=s.alternate,t!==null&&Ua(t)===null&&(f=s),s=s.sibling;s=f,s===null?(f=i.child,i.child=null):(f=s.sibling,s.sibling=null),Dc(i,!1,f,s,p);break;case"backwards":for(s=null,f=i.child,i.child=null;f!==null;){if(t=f.alternate,t!==null&&Ua(t)===null){i.child=f;break}t=f.sibling,f.sibling=s,s=f,f=t}Dc(i,!0,s,null,p);break;case"together":Dc(i,!1,null,null,void 0);break;default:i.memoizedState=null}return i.child}function $a(t,i){(i.mode&1)===0&&t!==null&&(t.alternate=null,i.alternate=null,i.flags|=2)}function Qn(t,i,s){if(t!==null&&(i.dependencies=t.dependencies),Zi|=i.lanes,(s&i.childLanes)===0)return null;if(t!==null&&i.child!==t.child)throw Error(r(153));if(i.child!==null){for(t=i.child,s=Pi(t,t.pendingProps),i.child=s,s.return=i;t.sibling!==null;)t=t.sibling,s=s.sibling=Pi(t,t.pendingProps),s.return=i;s.sibling=null}return i.child}function lS(t,i,s){switch(i.tag){case 3:Xp(i),br();break;case 5:fp(i);break;case 1:$t(i.type)&&_a(i);break;case 4:uc(i,i.stateNode.containerInfo);break;case 10:var u=i.type._context,f=i.memoizedProps.value;We(ka,u._currentValue),u._currentValue=f;break;case 13:if(u=i.memoizedState,u!==null)return u.dehydrated!==null?(We(nt,nt.current&1),i.flags|=128,null):(s&i.child.childLanes)!==0?qp(t,i,s):(We(nt,nt.current&1),t=Qn(t,i,s),t!==null?t.sibling:null);We(nt,nt.current&1);break;case 19:if(u=(s&i.childLanes)!==0,(t.flags&128)!==0){if(u)return Zp(t,i,s);i.flags|=128}if(f=i.memoizedState,f!==null&&(f.rendering=null,f.tail=null,f.lastEffect=null),We(nt,nt.current),u)break;return null;case 22:case 23:return i.lanes=0,Yp(t,i,s)}return Qn(t,i,s)}var Jp,kc,eg,tg;Jp=function(t,i){for(var s=i.child;s!==null;){if(s.tag===5||s.tag===6)t.appendChild(s.stateNode);else if(s.tag!==4&&s.child!==null){s.child.return=s,s=s.child;continue}if(s===i)break;for(;s.sibling===null;){if(s.return===null||s.return===i)return;s=s.return}s.sibling.return=s.return,s=s.sibling}},kc=function(){},eg=function(t,i,s,u){var f=t.memoizedProps;if(f!==u){t=i.stateNode,qi(Un.current);var p=null;switch(s){case"input":f=qe(t,f),u=qe(t,u),p=[];break;case"select":f=$({},f,{value:void 0}),u=$({},u,{value:void 0}),p=[];break;case"textarea":f=$i(t,f),u=$i(t,u),p=[];break;default:typeof f.onClick!="function"&&typeof u.onClick=="function"&&(t.onclick=Ia)}du(s,u);var v;s=null;for(O in f)if(!u.hasOwnProperty(O)&&f.hasOwnProperty(O)&&f[O]!=null)if(O==="style"){var A=f[O];for(v in A)A.hasOwnProperty(v)&&(s||(s={}),s[v]="")}else O!=="dangerouslySetInnerHTML"&&O!=="children"&&O!=="suppressContentEditableWarning"&&O!=="suppressHydrationWarning"&&O!=="autoFocus"&&(l.hasOwnProperty(O)?p||(p=[]):(p=p||[]).push(O,null));for(O in u){var w=u[O];if(A=f!=null?f[O]:void 0,u.hasOwnProperty(O)&&w!==A&&(w!=null||A!=null))if(O==="style")if(A){for(v in A)!A.hasOwnProperty(v)||w&&w.hasOwnProperty(v)||(s||(s={}),s[v]="");for(v in w)w.hasOwnProperty(v)&&A[v]!==w[v]&&(s||(s={}),s[v]=w[v])}else s||(p||(p=[]),p.push(O,s)),s=w;else O==="dangerouslySetInnerHTML"?(w=w?w.__html:void 0,A=A?A.__html:void 0,w!=null&&A!==w&&(p=p||[]).push(O,w)):O==="children"?typeof w!="string"&&typeof w!="number"||(p=p||[]).push(O,""+w):O!=="suppressContentEditableWarning"&&O!=="suppressHydrationWarning"&&(l.hasOwnProperty(O)?(w!=null&&O==="onScroll"&&je("scroll",t),p||A===w||(p=[])):(p=p||[]).push(O,w))}s&&(p=p||[]).push("style",s);var O=p;(i.updateQueue=O)&&(i.flags|=4)}},tg=function(t,i,s,u){s!==u&&(i.flags|=4)};function ss(t,i){if(!Qe)switch(t.tailMode){case"hidden":i=t.tail;for(var s=null;i!==null;)i.alternate!==null&&(s=i),i=i.sibling;s===null?t.tail=null:s.sibling=null;break;case"collapsed":s=t.tail;for(var u=null;s!==null;)s.alternate!==null&&(u=s),s=s.sibling;u===null?i||t.tail===null?t.tail=null:t.tail.sibling=null:u.sibling=null}}function Nt(t){var i=t.alternate!==null&&t.alternate.child===t.child,s=0,u=0;if(i)for(var f=t.child;f!==null;)s|=f.lanes|f.childLanes,u|=f.subtreeFlags&14680064,u|=f.flags&14680064,f.return=t,f=f.sibling;else for(f=t.child;f!==null;)s|=f.lanes|f.childLanes,u|=f.subtreeFlags,u|=f.flags,f.return=t,f=f.sibling;return t.subtreeFlags|=u,t.childLanes=s,i}function uS(t,i,s){var u=i.pendingProps;switch(Ju(i),i.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Nt(i),null;case 1:return $t(i.type)&&wa(),Nt(i),null;case 3:return u=i.stateNode,Wr(),Ve(zt),Ve(Rt),fc(),u.pendingContext&&(u.context=u.pendingContext,u.pendingContext=null),(t===null||t.child===null)&&(Na(i)?i.flags|=4:t===null||t.memoizedState.isDehydrated&&(i.flags&256)===0||(i.flags|=1024,mn!==null&&(zc(mn),mn=null))),kc(t,i),Nt(i),null;case 5:cc(i);var f=qi(ts.current);if(s=i.type,t!==null&&i.stateNode!=null)eg(t,i,s,u,f),t.ref!==i.ref&&(i.flags|=512,i.flags|=2097152);else{if(!u){if(i.stateNode===null)throw Error(r(166));return Nt(i),null}if(t=qi(Un.current),Na(i)){u=i.stateNode,s=i.type;var p=i.memoizedProps;switch(u[Fn]=i,u[qo]=p,t=(i.mode&1)!==0,s){case"dialog":je("cancel",u),je("close",u);break;case"iframe":case"object":case"embed":je("load",u);break;case"video":case"audio":for(f=0;f<Vo.length;f++)je(Vo[f],u);break;case"source":je("error",u);break;case"img":case"image":case"link":je("error",u),je("load",u);break;case"details":je("toggle",u);break;case"input":Ye(u,p),je("invalid",u);break;case"select":u._wrapperState={wasMultiple:!!p.multiple},je("invalid",u);break;case"textarea":Bf(u,p),je("invalid",u)}du(s,p),f=null;for(var v in p)if(p.hasOwnProperty(v)){var A=p[v];v==="children"?typeof A=="string"?u.textContent!==A&&(p.suppressHydrationWarning!==!0&&Ta(u.textContent,A,t),f=["children",A]):typeof A=="number"&&u.textContent!==""+A&&(p.suppressHydrationWarning!==!0&&Ta(u.textContent,A,t),f=["children",""+A]):l.hasOwnProperty(v)&&A!=null&&v==="onScroll"&&je("scroll",u)}switch(s){case"input":Oe(u),nn(u,p,!0);break;case"textarea":Oe(u),bf(u);break;case"select":case"option":break;default:typeof p.onClick=="function"&&(u.onclick=Ia)}u=f,i.updateQueue=u,u!==null&&(i.flags|=4)}else{v=f.nodeType===9?f:f.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=xf(s)),t==="http://www.w3.org/1999/xhtml"?s==="script"?(t=v.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof u.is=="string"?t=v.createElement(s,{is:u.is}):(t=v.createElement(s),s==="select"&&(v=t,u.multiple?v.multiple=!0:u.size&&(v.size=u.size))):t=v.createElementNS(t,s),t[Fn]=i,t[qo]=u,Jp(t,i,!1,!1),i.stateNode=t;e:{switch(v=fu(s,u),s){case"dialog":je("cancel",t),je("close",t),f=u;break;case"iframe":case"object":case"embed":je("load",t),f=u;break;case"video":case"audio":for(f=0;f<Vo.length;f++)je(Vo[f],t);f=u;break;case"source":je("error",t),f=u;break;case"img":case"image":case"link":je("error",t),je("load",t),f=u;break;case"details":je("toggle",t),f=u;break;case"input":Ye(t,u),f=qe(t,u),je("invalid",t);break;case"option":f=u;break;case"select":t._wrapperState={wasMultiple:!!u.multiple},f=$({},u,{value:void 0}),je("invalid",t);break;case"textarea":Bf(t,u),f=$i(t,u),je("invalid",t);break;default:f=u}du(s,f),A=f;for(p in A)if(A.hasOwnProperty(p)){var w=A[p];p==="style"?Wf(t,w):p==="dangerouslySetInnerHTML"?(w=w?w.__html:void 0,w!=null&&zf(t,w)):p==="children"?typeof w=="string"?(s!=="textarea"||w!=="")&&Po(t,w):typeof w=="number"&&Po(t,""+w):p!=="suppressContentEditableWarning"&&p!=="suppressHydrationWarning"&&p!=="autoFocus"&&(l.hasOwnProperty(p)?w!=null&&p==="onScroll"&&je("scroll",t):w!=null&&D(t,p,w,v))}switch(s){case"input":Oe(t),nn(t,u,!1);break;case"textarea":Oe(t),bf(t);break;case"option":u.value!=null&&t.setAttribute("value",""+ve(u.value));break;case"select":t.multiple=!!u.multiple,p=u.value,p!=null?ci(t,!!u.multiple,p,!1):u.defaultValue!=null&&ci(t,!!u.multiple,u.defaultValue,!0);break;default:typeof f.onClick=="function"&&(t.onclick=Ia)}switch(s){case"button":case"input":case"select":case"textarea":u=!!u.autoFocus;break e;case"img":u=!0;break e;default:u=!1}}u&&(i.flags|=4)}i.ref!==null&&(i.flags|=512,i.flags|=2097152)}return Nt(i),null;case 6:if(t&&i.stateNode!=null)tg(t,i,t.memoizedProps,u);else{if(typeof u!="string"&&i.stateNode===null)throw Error(r(166));if(s=qi(ts.current),qi(Un.current),Na(i)){if(u=i.stateNode,s=i.memoizedProps,u[Fn]=i,(p=u.nodeValue!==s)&&(t=Qt,t!==null))switch(t.tag){case 3:Ta(u.nodeValue,s,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&Ta(u.nodeValue,s,(t.mode&1)!==0)}p&&(i.flags|=4)}else u=(s.nodeType===9?s:s.ownerDocument).createTextNode(u),u[Fn]=i,i.stateNode=u}return Nt(i),null;case 13:if(Ve(nt),u=i.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(Qe&&Zt!==null&&(i.mode&1)!==0&&(i.flags&128)===0)rp(),br(),i.flags|=98560,p=!1;else if(p=Na(i),u!==null&&u.dehydrated!==null){if(t===null){if(!p)throw Error(r(318));if(p=i.memoizedState,p=p!==null?p.dehydrated:null,!p)throw Error(r(317));p[Fn]=i}else br(),(i.flags&128)===0&&(i.memoizedState=null),i.flags|=4;Nt(i),p=!1}else mn!==null&&(zc(mn),mn=null),p=!0;if(!p)return i.flags&65536?i:null}return(i.flags&128)!==0?(i.lanes=s,i):(u=u!==null,u!==(t!==null&&t.memoizedState!==null)&&u&&(i.child.flags|=8192,(i.mode&1)!==0&&(t===null||(nt.current&1)!==0?ft===0&&(ft=3):Yc())),i.updateQueue!==null&&(i.flags|=4),Nt(i),null);case 4:return Wr(),kc(t,i),t===null&&Xo(i.stateNode.containerInfo),Nt(i),null;case 10:return oc(i.type._context),Nt(i),null;case 17:return $t(i.type)&&wa(),Nt(i),null;case 19:if(Ve(nt),p=i.memoizedState,p===null)return Nt(i),null;if(u=(i.flags&128)!==0,v=p.rendering,v===null)if(u)ss(p,!1);else{if(ft!==0||t!==null&&(t.flags&128)!==0)for(t=i.child;t!==null;){if(v=Ua(t),v!==null){for(i.flags|=128,ss(p,!1),u=v.updateQueue,u!==null&&(i.updateQueue=u,i.flags|=4),i.subtreeFlags=0,u=s,s=i.child;s!==null;)p=s,t=u,p.flags&=14680066,v=p.alternate,v===null?(p.childLanes=0,p.lanes=t,p.child=null,p.subtreeFlags=0,p.memoizedProps=null,p.memoizedState=null,p.updateQueue=null,p.dependencies=null,p.stateNode=null):(p.childLanes=v.childLanes,p.lanes=v.lanes,p.child=v.child,p.subtreeFlags=0,p.deletions=null,p.memoizedProps=v.memoizedProps,p.memoizedState=v.memoizedState,p.updateQueue=v.updateQueue,p.type=v.type,t=v.dependencies,p.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),s=s.sibling;return We(nt,nt.current&1|2),i.child}t=t.sibling}p.tail!==null&&ot()>Xr&&(i.flags|=128,u=!0,ss(p,!1),i.lanes=4194304)}else{if(!u)if(t=Ua(v),t!==null){if(i.flags|=128,u=!0,s=t.updateQueue,s!==null&&(i.updateQueue=s,i.flags|=4),ss(p,!0),p.tail===null&&p.tailMode==="hidden"&&!v.alternate&&!Qe)return Nt(i),null}else 2*ot()-p.renderingStartTime>Xr&&s!==1073741824&&(i.flags|=128,u=!0,ss(p,!1),i.lanes=4194304);p.isBackwards?(v.sibling=i.child,i.child=v):(s=p.last,s!==null?s.sibling=v:i.child=v,p.last=v)}return p.tail!==null?(i=p.tail,p.rendering=i,p.tail=i.sibling,p.renderingStartTime=ot(),i.sibling=null,s=nt.current,We(nt,u?s&1|2:s&1),i):(Nt(i),null);case 22:case 23:return Wc(),u=i.memoizedState!==null,t!==null&&t.memoizedState!==null!==u&&(i.flags|=8192),u&&(i.mode&1)!==0?(Jt&1073741824)!==0&&(Nt(i),i.subtreeFlags&6&&(i.flags|=8192)):Nt(i),null;case 24:return null;case 25:return null}throw Error(r(156,i.tag))}function cS(t,i){switch(Ju(i),i.tag){case 1:return $t(i.type)&&wa(),t=i.flags,t&65536?(i.flags=t&-65537|128,i):null;case 3:return Wr(),Ve(zt),Ve(Rt),fc(),t=i.flags,(t&65536)!==0&&(t&128)===0?(i.flags=t&-65537|128,i):null;case 5:return cc(i),null;case 13:if(Ve(nt),t=i.memoizedState,t!==null&&t.dehydrated!==null){if(i.alternate===null)throw Error(r(340));br()}return t=i.flags,t&65536?(i.flags=t&-65537|128,i):null;case 19:return Ve(nt),null;case 4:return Wr(),null;case 10:return oc(i.type._context),null;case 22:case 23:return Wc(),null;case 24:return null;default:return null}}var Wa=!1,Dt=!1,dS=typeof WeakSet=="function"?WeakSet:Set,Q=null;function jr(t,i){var s=t.ref;if(s!==null)if(typeof s=="function")try{s(null)}catch(u){rt(t,i,u)}else s.current=null}function Oc(t,i,s){try{s()}catch(u){rt(t,i,u)}}var ng=!1;function fS(t,i){if(Wu=ca,t=Fh(),Hu(t)){if("selectionStart"in t)var s={start:t.selectionStart,end:t.selectionEnd};else e:{s=(s=t.ownerDocument)&&s.defaultView||window;var u=s.getSelection&&s.getSelection();if(u&&u.rangeCount!==0){s=u.anchorNode;var f=u.anchorOffset,p=u.focusNode;u=u.focusOffset;try{s.nodeType,p.nodeType}catch{s=null;break e}var v=0,A=-1,w=-1,O=0,G=0,b=t,L=null;t:for(;;){for(var q;b!==s||f!==0&&b.nodeType!==3||(A=v+f),b!==p||u!==0&&b.nodeType!==3||(w=v+u),b.nodeType===3&&(v+=b.nodeValue.length),(q=b.firstChild)!==null;)L=b,b=q;for(;;){if(b===t)break t;if(L===s&&++O===f&&(A=v),L===p&&++G===u&&(w=v),(q=b.nextSibling)!==null)break;b=L,L=b.parentNode}b=q}s=A===-1||w===-1?null:{start:A,end:w}}else s=null}s=s||{start:0,end:0}}else s=null;for(Yu={focusedElem:t,selectionRange:s},ca=!1,Q=i;Q!==null;)if(i=Q,t=i.child,(i.subtreeFlags&1028)!==0&&t!==null)t.return=i,Q=t;else for(;Q!==null;){i=Q;try{var Z=i.alternate;if((i.flags&1024)!==0)switch(i.tag){case 0:case 11:case 15:break;case 1:if(Z!==null){var ne=Z.memoizedProps,st=Z.memoizedState,N=i.stateNode,P=N.getSnapshotBeforeUpdate(i.elementType===i.type?ne:vn(i.type,ne),st);N.__reactInternalSnapshotBeforeUpdate=P}break;case 3:var k=i.stateNode.containerInfo;k.nodeType===1?k.textContent="":k.nodeType===9&&k.documentElement&&k.removeChild(k.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(r(163))}}catch(W){rt(i,i.return,W)}if(t=i.sibling,t!==null){t.return=i.return,Q=t;break}Q=i.return}return Z=ng,ng=!1,Z}function as(t,i,s){var u=i.updateQueue;if(u=u!==null?u.lastEffect:null,u!==null){var f=u=u.next;do{if((f.tag&t)===t){var p=f.destroy;f.destroy=void 0,p!==void 0&&Oc(i,s,p)}f=f.next}while(f!==u)}}function Ya(t,i){if(i=i.updateQueue,i=i!==null?i.lastEffect:null,i!==null){var s=i=i.next;do{if((s.tag&t)===t){var u=s.create;s.destroy=u()}s=s.next}while(s!==i)}}function Mc(t){var i=t.ref;if(i!==null){var s=t.stateNode;switch(t.tag){case 5:t=s;break;default:t=s}typeof i=="function"?i(t):i.current=t}}function ig(t){var i=t.alternate;i!==null&&(t.alternate=null,ig(i)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(i=t.stateNode,i!==null&&(delete i[Fn],delete i[qo],delete i[Ku],delete i[Xy],delete i[Ky])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function rg(t){return t.tag===5||t.tag===3||t.tag===4}function og(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||rg(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function Fc(t,i,s){var u=t.tag;if(u===5||u===6)t=t.stateNode,i?s.nodeType===8?s.parentNode.insertBefore(t,i):s.insertBefore(t,i):(s.nodeType===8?(i=s.parentNode,i.insertBefore(t,s)):(i=s,i.appendChild(t)),s=s._reactRootContainer,s!=null||i.onclick!==null||(i.onclick=Ia));else if(u!==4&&(t=t.child,t!==null))for(Fc(t,i,s),t=t.sibling;t!==null;)Fc(t,i,s),t=t.sibling}function Uc(t,i,s){var u=t.tag;if(u===5||u===6)t=t.stateNode,i?s.insertBefore(t,i):s.appendChild(t);else if(u!==4&&(t=t.child,t!==null))for(Uc(t,i,s),t=t.sibling;t!==null;)Uc(t,i,s),t=t.sibling}var At=null,yn=!1;function Ei(t,i,s){for(s=s.child;s!==null;)sg(t,i,s),s=s.sibling}function sg(t,i,s){if(Mn&&typeof Mn.onCommitFiberUnmount=="function")try{Mn.onCommitFiberUnmount(ra,s)}catch{}switch(s.tag){case 5:Dt||jr(s,i);case 6:var u=At,f=yn;At=null,Ei(t,i,s),At=u,yn=f,At!==null&&(yn?(t=At,s=s.stateNode,t.nodeType===8?t.parentNode.removeChild(s):t.removeChild(s)):At.removeChild(s.stateNode));break;case 18:At!==null&&(yn?(t=At,s=s.stateNode,t.nodeType===8?Xu(t.parentNode,s):t.nodeType===1&&Xu(t,s),Go(t)):Xu(At,s.stateNode));break;case 4:u=At,f=yn,At=s.stateNode.containerInfo,yn=!0,Ei(t,i,s),At=u,yn=f;break;case 0:case 11:case 14:case 15:if(!Dt&&(u=s.updateQueue,u!==null&&(u=u.lastEffect,u!==null))){f=u=u.next;do{var p=f,v=p.destroy;p=p.tag,v!==void 0&&((p&2)!==0||(p&4)!==0)&&Oc(s,i,v),f=f.next}while(f!==u)}Ei(t,i,s);break;case 1:if(!Dt&&(jr(s,i),u=s.stateNode,typeof u.componentWillUnmount=="function"))try{u.props=s.memoizedProps,u.state=s.memoizedState,u.componentWillUnmount()}catch(A){rt(s,i,A)}Ei(t,i,s);break;case 21:Ei(t,i,s);break;case 22:s.mode&1?(Dt=(u=Dt)||s.memoizedState!==null,Ei(t,i,s),Dt=u):Ei(t,i,s);break;default:Ei(t,i,s)}}function ag(t){var i=t.updateQueue;if(i!==null){t.updateQueue=null;var s=t.stateNode;s===null&&(s=t.stateNode=new dS),i.forEach(function(u){var f=TS.bind(null,t,u);s.has(u)||(s.add(u),u.then(f,f))})}}function Sn(t,i){var s=i.deletions;if(s!==null)for(var u=0;u<s.length;u++){var f=s[u];try{var p=t,v=i,A=v;e:for(;A!==null;){switch(A.tag){case 5:At=A.stateNode,yn=!1;break e;case 3:At=A.stateNode.containerInfo,yn=!0;break e;case 4:At=A.stateNode.containerInfo,yn=!0;break e}A=A.return}if(At===null)throw Error(r(160));sg(p,v,f),At=null,yn=!1;var w=f.alternate;w!==null&&(w.return=null),f.return=null}catch(O){rt(f,i,O)}}if(i.subtreeFlags&12854)for(i=i.child;i!==null;)lg(i,t),i=i.sibling}function lg(t,i){var s=t.alternate,u=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(Sn(i,t),Ln(t),u&4){try{as(3,t,t.return),Ya(3,t)}catch(ne){rt(t,t.return,ne)}try{as(5,t,t.return)}catch(ne){rt(t,t.return,ne)}}break;case 1:Sn(i,t),Ln(t),u&512&&s!==null&&jr(s,s.return);break;case 5:if(Sn(i,t),Ln(t),u&512&&s!==null&&jr(s,s.return),t.flags&32){var f=t.stateNode;try{Po(f,"")}catch(ne){rt(t,t.return,ne)}}if(u&4&&(f=t.stateNode,f!=null)){var p=t.memoizedProps,v=s!==null?s.memoizedProps:p,A=t.type,w=t.updateQueue;if(t.updateQueue=null,w!==null)try{A==="input"&&p.type==="radio"&&p.name!=null&&Dn(f,p),fu(A,v);var O=fu(A,p);for(v=0;v<w.length;v+=2){var G=w[v],b=w[v+1];G==="style"?Wf(f,b):G==="dangerouslySetInnerHTML"?zf(f,b):G==="children"?Po(f,b):D(f,G,b,O)}switch(A){case"input":xt(f,p);break;case"textarea":Gf(f,p);break;case"select":var L=f._wrapperState.wasMultiple;f._wrapperState.wasMultiple=!!p.multiple;var q=p.value;q!=null?ci(f,!!p.multiple,q,!1):L!==!!p.multiple&&(p.defaultValue!=null?ci(f,!!p.multiple,p.defaultValue,!0):ci(f,!!p.multiple,p.multiple?[]:"",!1))}f[qo]=p}catch(ne){rt(t,t.return,ne)}}break;case 6:if(Sn(i,t),Ln(t),u&4){if(t.stateNode===null)throw Error(r(162));f=t.stateNode,p=t.memoizedProps;try{f.nodeValue=p}catch(ne){rt(t,t.return,ne)}}break;case 3:if(Sn(i,t),Ln(t),u&4&&s!==null&&s.memoizedState.isDehydrated)try{Go(i.containerInfo)}catch(ne){rt(t,t.return,ne)}break;case 4:Sn(i,t),Ln(t);break;case 13:Sn(i,t),Ln(t),f=t.child,f.flags&8192&&(p=f.memoizedState!==null,f.stateNode.isHidden=p,!p||f.alternate!==null&&f.alternate.memoizedState!==null||(Bc=ot())),u&4&&ag(t);break;case 22:if(G=s!==null&&s.memoizedState!==null,t.mode&1?(Dt=(O=Dt)||G,Sn(i,t),Dt=O):Sn(i,t),Ln(t),u&8192){if(O=t.memoizedState!==null,(t.stateNode.isHidden=O)&&!G&&(t.mode&1)!==0)for(Q=t,G=t.child;G!==null;){for(b=Q=G;Q!==null;){switch(L=Q,q=L.child,L.tag){case 0:case 11:case 14:case 15:as(4,L,L.return);break;case 1:jr(L,L.return);var Z=L.stateNode;if(typeof Z.componentWillUnmount=="function"){u=L,s=L.return;try{i=u,Z.props=i.memoizedProps,Z.state=i.memoizedState,Z.componentWillUnmount()}catch(ne){rt(u,s,ne)}}break;case 5:jr(L,L.return);break;case 22:if(L.memoizedState!==null){dg(b);continue}}q!==null?(q.return=L,Q=q):dg(b)}G=G.sibling}e:for(G=null,b=t;;){if(b.tag===5){if(G===null){G=b;try{f=b.stateNode,O?(p=f.style,typeof p.setProperty=="function"?p.setProperty("display","none","important"):p.display="none"):(A=b.stateNode,w=b.memoizedProps.style,v=w!=null&&w.hasOwnProperty("display")?w.display:null,A.style.display=$f("display",v))}catch(ne){rt(t,t.return,ne)}}}else if(b.tag===6){if(G===null)try{b.stateNode.nodeValue=O?"":b.memoizedProps}catch(ne){rt(t,t.return,ne)}}else if((b.tag!==22&&b.tag!==23||b.memoizedState===null||b===t)&&b.child!==null){b.child.return=b,b=b.child;continue}if(b===t)break e;for(;b.sibling===null;){if(b.return===null||b.return===t)break e;G===b&&(G=null),b=b.return}G===b&&(G=null),b.sibling.return=b.return,b=b.sibling}}break;case 19:Sn(i,t),Ln(t),u&4&&ag(t);break;case 21:break;default:Sn(i,t),Ln(t)}}function Ln(t){var i=t.flags;if(i&2){try{e:{for(var s=t.return;s!==null;){if(rg(s)){var u=s;break e}s=s.return}throw Error(r(160))}switch(u.tag){case 5:var f=u.stateNode;u.flags&32&&(Po(f,""),u.flags&=-33);var p=og(t);Uc(t,p,f);break;case 3:case 4:var v=u.stateNode.containerInfo,A=og(t);Fc(t,A,v);break;default:throw Error(r(161))}}catch(w){rt(t,t.return,w)}t.flags&=-3}i&4096&&(t.flags&=-4097)}function hS(t,i,s){Q=t,ug(t)}function ug(t,i,s){for(var u=(t.mode&1)!==0;Q!==null;){var f=Q,p=f.child;if(f.tag===22&&u){var v=f.memoizedState!==null||Wa;if(!v){var A=f.alternate,w=A!==null&&A.memoizedState!==null||Dt;A=Wa;var O=Dt;if(Wa=v,(Dt=w)&&!O)for(Q=f;Q!==null;)v=Q,w=v.child,v.tag===22&&v.memoizedState!==null?fg(f):w!==null?(w.return=v,Q=w):fg(f);for(;p!==null;)Q=p,ug(p),p=p.sibling;Q=f,Wa=A,Dt=O}cg(t)}else(f.subtreeFlags&8772)!==0&&p!==null?(p.return=f,Q=p):cg(t)}}function cg(t){for(;Q!==null;){var i=Q;if((i.flags&8772)!==0){var s=i.alternate;try{if((i.flags&8772)!==0)switch(i.tag){case 0:case 11:case 15:Dt||Ya(5,i);break;case 1:var u=i.stateNode;if(i.flags&4&&!Dt)if(s===null)u.componentDidMount();else{var f=i.elementType===i.type?s.memoizedProps:vn(i.type,s.memoizedProps);u.componentDidUpdate(f,s.memoizedState,u.__reactInternalSnapshotBeforeUpdate)}var p=i.updateQueue;p!==null&&dp(i,p,u);break;case 3:var v=i.updateQueue;if(v!==null){if(s=null,i.child!==null)switch(i.child.tag){case 5:s=i.child.stateNode;break;case 1:s=i.child.stateNode}dp(i,v,s)}break;case 5:var A=i.stateNode;if(s===null&&i.flags&4){s=A;var w=i.memoizedProps;switch(i.type){case"button":case"input":case"select":case"textarea":w.autoFocus&&s.focus();break;case"img":w.src&&(s.src=w.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(i.memoizedState===null){var O=i.alternate;if(O!==null){var G=O.memoizedState;if(G!==null){var b=G.dehydrated;b!==null&&Go(b)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(r(163))}Dt||i.flags&512&&Mc(i)}catch(L){rt(i,i.return,L)}}if(i===t){Q=null;break}if(s=i.sibling,s!==null){s.return=i.return,Q=s;break}Q=i.return}}function dg(t){for(;Q!==null;){var i=Q;if(i===t){Q=null;break}var s=i.sibling;if(s!==null){s.return=i.return,Q=s;break}Q=i.return}}function fg(t){for(;Q!==null;){var i=Q;try{switch(i.tag){case 0:case 11:case 15:var s=i.return;try{Ya(4,i)}catch(w){rt(i,s,w)}break;case 1:var u=i.stateNode;if(typeof u.componentDidMount=="function"){var f=i.return;try{u.componentDidMount()}catch(w){rt(i,f,w)}}var p=i.return;try{Mc(i)}catch(w){rt(i,p,w)}break;case 5:var v=i.return;try{Mc(i)}catch(w){rt(i,v,w)}}}catch(w){rt(i,i.return,w)}if(i===t){Q=null;break}var A=i.sibling;if(A!==null){A.return=i.return,Q=A;break}Q=i.return}}var pS=Math.ceil,ja=B.ReactCurrentDispatcher,Hc=B.ReactCurrentOwner,ln=B.ReactCurrentBatchConfig,Le=0,pt=null,lt=null,Tt=0,Jt=0,Vr=yi(0),ft=0,ls=null,Zi=0,Va=0,Lc=0,us=null,Yt=null,Bc=0,Xr=1/0,Zn=null,Xa=!1,Gc=null,wi=null,Ka=!1,_i=null,qa=0,cs=0,bc=null,Qa=-1,Za=0;function Ft(){return(Le&6)!==0?ot():Qa!==-1?Qa:Qa=ot()}function Ci(t){return(t.mode&1)===0?1:(Le&2)!==0&&Tt!==0?Tt&-Tt:Qy.transition!==null?(Za===0&&(Za=oh()),Za):(t=ze,t!==0||(t=window.event,t=t===void 0?16:ph(t.type)),t)}function An(t,i,s,u){if(50<cs)throw cs=0,bc=null,Error(r(185));Fo(t,s,u),((Le&2)===0||t!==pt)&&(t===pt&&((Le&2)===0&&(Va|=s),ft===4&&Ri(t,Tt)),jt(t,u),s===1&&Le===0&&(i.mode&1)===0&&(Xr=ot()+500,Ca&&Ai()))}function jt(t,i){var s=t.callbackNode;Qv(t,i);var u=aa(t,t===pt?Tt:0);if(u===0)s!==null&&nh(s),t.callbackNode=null,t.callbackPriority=0;else if(i=u&-u,t.callbackPriority!==i){if(s!=null&&nh(s),i===1)t.tag===0?qy(pg.bind(null,t)):Jh(pg.bind(null,t)),jy(function(){(Le&6)===0&&Ai()}),s=null;else{switch(sh(u)){case 1:s=Su;break;case 4:s=ih;break;case 16:s=ia;break;case 536870912:s=rh;break;default:s=ia}s=Ig(s,hg.bind(null,t))}t.callbackPriority=i,t.callbackNode=s}}function hg(t,i){if(Qa=-1,Za=0,(Le&6)!==0)throw Error(r(327));var s=t.callbackNode;if(Kr()&&t.callbackNode!==s)return null;var u=aa(t,t===pt?Tt:0);if(u===0)return null;if((u&30)!==0||(u&t.expiredLanes)!==0||i)i=Ja(t,u);else{i=u;var f=Le;Le|=2;var p=mg();(pt!==t||Tt!==i)&&(Zn=null,Xr=ot()+500,er(t,i));do try{vS();break}catch(A){gg(t,A)}while(!0);rc(),ja.current=p,Le=f,lt!==null?i=0:(pt=null,Tt=0,i=ft)}if(i!==0){if(i===2&&(f=Au(t),f!==0&&(u=f,i=xc(t,f))),i===1)throw s=ls,er(t,0),Ri(t,u),jt(t,ot()),s;if(i===6)Ri(t,u);else{if(f=t.current.alternate,(u&30)===0&&!gS(f)&&(i=Ja(t,u),i===2&&(p=Au(t),p!==0&&(u=p,i=xc(t,p))),i===1))throw s=ls,er(t,0),Ri(t,u),jt(t,ot()),s;switch(t.finishedWork=f,t.finishedLanes=u,i){case 0:case 1:throw Error(r(345));case 2:tr(t,Yt,Zn);break;case 3:if(Ri(t,u),(u&130023424)===u&&(i=Bc+500-ot(),10<i)){if(aa(t,0)!==0)break;if(f=t.suspendedLanes,(f&u)!==u){Ft(),t.pingedLanes|=t.suspendedLanes&f;break}t.timeoutHandle=Vu(tr.bind(null,t,Yt,Zn),i);break}tr(t,Yt,Zn);break;case 4:if(Ri(t,u),(u&4194240)===u)break;for(i=t.eventTimes,f=-1;0<u;){var v=31-pn(u);p=1<<v,v=i[v],v>f&&(f=v),u&=~p}if(u=f,u=ot()-u,u=(120>u?120:480>u?480:1080>u?1080:1920>u?1920:3e3>u?3e3:4320>u?4320:1960*pS(u/1960))-u,10<u){t.timeoutHandle=Vu(tr.bind(null,t,Yt,Zn),u);break}tr(t,Yt,Zn);break;case 5:tr(t,Yt,Zn);break;default:throw Error(r(329))}}}return jt(t,ot()),t.callbackNode===s?hg.bind(null,t):null}function xc(t,i){var s=us;return t.current.memoizedState.isDehydrated&&(er(t,i).flags|=256),t=Ja(t,i),t!==2&&(i=Yt,Yt=s,i!==null&&zc(i)),t}function zc(t){Yt===null?Yt=t:Yt.push.apply(Yt,t)}function gS(t){for(var i=t;;){if(i.flags&16384){var s=i.updateQueue;if(s!==null&&(s=s.stores,s!==null))for(var u=0;u<s.length;u++){var f=s[u],p=f.getSnapshot;f=f.value;try{if(!gn(p(),f))return!1}catch{return!1}}}if(s=i.child,i.subtreeFlags&16384&&s!==null)s.return=i,i=s;else{if(i===t)break;for(;i.sibling===null;){if(i.return===null||i.return===t)return!0;i=i.return}i.sibling.return=i.return,i=i.sibling}}return!0}function Ri(t,i){for(i&=~Lc,i&=~Va,t.suspendedLanes|=i,t.pingedLanes&=~i,t=t.expirationTimes;0<i;){var s=31-pn(i),u=1<<s;t[s]=-1,i&=~u}}function pg(t){if((Le&6)!==0)throw Error(r(327));Kr();var i=aa(t,0);if((i&1)===0)return jt(t,ot()),null;var s=Ja(t,i);if(t.tag!==0&&s===2){var u=Au(t);u!==0&&(i=u,s=xc(t,u))}if(s===1)throw s=ls,er(t,0),Ri(t,i),jt(t,ot()),s;if(s===6)throw Error(r(345));return t.finishedWork=t.current.alternate,t.finishedLanes=i,tr(t,Yt,Zn),jt(t,ot()),null}function $c(t,i){var s=Le;Le|=1;try{return t(i)}finally{Le=s,Le===0&&(Xr=ot()+500,Ca&&Ai())}}function Ji(t){_i!==null&&_i.tag===0&&(Le&6)===0&&Kr();var i=Le;Le|=1;var s=ln.transition,u=ze;try{if(ln.transition=null,ze=1,t)return t()}finally{ze=u,ln.transition=s,Le=i,(Le&6)===0&&Ai()}}function Wc(){Jt=Vr.current,Ve(Vr)}function er(t,i){t.finishedWork=null,t.finishedLanes=0;var s=t.timeoutHandle;if(s!==-1&&(t.timeoutHandle=-1,Yy(s)),lt!==null)for(s=lt.return;s!==null;){var u=s;switch(Ju(u),u.tag){case 1:u=u.type.childContextTypes,u!=null&&wa();break;case 3:Wr(),Ve(zt),Ve(Rt),fc();break;case 5:cc(u);break;case 4:Wr();break;case 13:Ve(nt);break;case 19:Ve(nt);break;case 10:oc(u.type._context);break;case 22:case 23:Wc()}s=s.return}if(pt=t,lt=t=Pi(t.current,null),Tt=Jt=i,ft=0,ls=null,Lc=Va=Zi=0,Yt=us=null,Ki!==null){for(i=0;i<Ki.length;i++)if(s=Ki[i],u=s.interleaved,u!==null){s.interleaved=null;var f=u.next,p=s.pending;if(p!==null){var v=p.next;p.next=f,u.next=v}s.pending=u}Ki=null}return t}function gg(t,i){do{var s=lt;try{if(rc(),Ha.current=ba,La){for(var u=it.memoizedState;u!==null;){var f=u.queue;f!==null&&(f.pending=null),u=u.next}La=!1}if(Qi=0,ht=dt=it=null,ns=!1,is=0,Hc.current=null,s===null||s.return===null){ft=1,ls=i,lt=null;break}e:{var p=t,v=s.return,A=s,w=i;if(i=Tt,A.flags|=32768,w!==null&&typeof w=="object"&&typeof w.then=="function"){var O=w,G=A,b=G.tag;if((G.mode&1)===0&&(b===0||b===11||b===15)){var L=G.alternate;L?(G.updateQueue=L.updateQueue,G.memoizedState=L.memoizedState,G.lanes=L.lanes):(G.updateQueue=null,G.memoizedState=null)}var q=bp(v);if(q!==null){q.flags&=-257,xp(q,v,A,p,i),q.mode&1&&Gp(p,O,i),i=q,w=O;var Z=i.updateQueue;if(Z===null){var ne=new Set;ne.add(w),i.updateQueue=ne}else Z.add(w);break e}else{if((i&1)===0){Gp(p,O,i),Yc();break e}w=Error(r(426))}}else if(Qe&&A.mode&1){var st=bp(v);if(st!==null){(st.flags&65536)===0&&(st.flags|=256),xp(st,v,A,p,i),nc(Yr(w,A));break e}}p=w=Yr(w,A),ft!==4&&(ft=2),us===null?us=[p]:us.push(p),p=v;do{switch(p.tag){case 3:p.flags|=65536,i&=-i,p.lanes|=i;var N=Lp(p,w,i);cp(p,N);break e;case 1:A=w;var P=p.type,k=p.stateNode;if((p.flags&128)===0&&(typeof P.getDerivedStateFromError=="function"||k!==null&&typeof k.componentDidCatch=="function"&&(wi===null||!wi.has(k)))){p.flags|=65536,i&=-i,p.lanes|=i;var W=Bp(p,A,i);cp(p,W);break e}}p=p.return}while(p!==null)}yg(s)}catch(oe){i=oe,lt===s&&s!==null&&(lt=s=s.return);continue}break}while(!0)}function mg(){var t=ja.current;return ja.current=ba,t===null?ba:t}function Yc(){(ft===0||ft===3||ft===2)&&(ft=4),pt===null||(Zi&268435455)===0&&(Va&268435455)===0||Ri(pt,Tt)}function Ja(t,i){var s=Le;Le|=2;var u=mg();(pt!==t||Tt!==i)&&(Zn=null,er(t,i));do try{mS();break}catch(f){gg(t,f)}while(!0);if(rc(),Le=s,ja.current=u,lt!==null)throw Error(r(261));return pt=null,Tt=0,ft}function mS(){for(;lt!==null;)vg(lt)}function vS(){for(;lt!==null&&!zv();)vg(lt)}function vg(t){var i=Tg(t.alternate,t,Jt);t.memoizedProps=t.pendingProps,i===null?yg(t):lt=i,Hc.current=null}function yg(t){var i=t;do{var s=i.alternate;if(t=i.return,(i.flags&32768)===0){if(s=uS(s,i,Jt),s!==null){lt=s;return}}else{if(s=cS(s,i),s!==null){s.flags&=32767,lt=s;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{ft=6,lt=null;return}}if(i=i.sibling,i!==null){lt=i;return}lt=i=t}while(i!==null);ft===0&&(ft=5)}function tr(t,i,s){var u=ze,f=ln.transition;try{ln.transition=null,ze=1,yS(t,i,s,u)}finally{ln.transition=f,ze=u}return null}function yS(t,i,s,u){do Kr();while(_i!==null);if((Le&6)!==0)throw Error(r(327));s=t.finishedWork;var f=t.finishedLanes;if(s===null)return null;if(t.finishedWork=null,t.finishedLanes=0,s===t.current)throw Error(r(177));t.callbackNode=null,t.callbackPriority=0;var p=s.lanes|s.childLanes;if(Zv(t,p),t===pt&&(lt=pt=null,Tt=0),(s.subtreeFlags&2064)===0&&(s.flags&2064)===0||Ka||(Ka=!0,Ig(ia,function(){return Kr(),null})),p=(s.flags&15990)!==0,(s.subtreeFlags&15990)!==0||p){p=ln.transition,ln.transition=null;var v=ze;ze=1;var A=Le;Le|=4,Hc.current=null,fS(t,s),lg(s,t),By(Yu),ca=!!Wu,Yu=Wu=null,t.current=s,hS(s),$v(),Le=A,ze=v,ln.transition=p}else t.current=s;if(Ka&&(Ka=!1,_i=t,qa=f),p=t.pendingLanes,p===0&&(wi=null),jv(s.stateNode),jt(t,ot()),i!==null)for(u=t.onRecoverableError,s=0;s<i.length;s++)f=i[s],u(f.value,{componentStack:f.stack,digest:f.digest});if(Xa)throw Xa=!1,t=Gc,Gc=null,t;return(qa&1)!==0&&t.tag!==0&&Kr(),p=t.pendingLanes,(p&1)!==0?t===bc?cs++:(cs=0,bc=t):cs=0,Ai(),null}function Kr(){if(_i!==null){var t=sh(qa),i=ln.transition,s=ze;try{if(ln.transition=null,ze=16>t?16:t,_i===null)var u=!1;else{if(t=_i,_i=null,qa=0,(Le&6)!==0)throw Error(r(331));var f=Le;for(Le|=4,Q=t.current;Q!==null;){var p=Q,v=p.child;if((Q.flags&16)!==0){var A=p.deletions;if(A!==null){for(var w=0;w<A.length;w++){var O=A[w];for(Q=O;Q!==null;){var G=Q;switch(G.tag){case 0:case 11:case 15:as(8,G,p)}var b=G.child;if(b!==null)b.return=G,Q=b;else for(;Q!==null;){G=Q;var L=G.sibling,q=G.return;if(ig(G),G===O){Q=null;break}if(L!==null){L.return=q,Q=L;break}Q=q}}}var Z=p.alternate;if(Z!==null){var ne=Z.child;if(ne!==null){Z.child=null;do{var st=ne.sibling;ne.sibling=null,ne=st}while(ne!==null)}}Q=p}}if((p.subtreeFlags&2064)!==0&&v!==null)v.return=p,Q=v;else e:for(;Q!==null;){if(p=Q,(p.flags&2048)!==0)switch(p.tag){case 0:case 11:case 15:as(9,p,p.return)}var N=p.sibling;if(N!==null){N.return=p.return,Q=N;break e}Q=p.return}}var P=t.current;for(Q=P;Q!==null;){v=Q;var k=v.child;if((v.subtreeFlags&2064)!==0&&k!==null)k.return=v,Q=k;else e:for(v=P;Q!==null;){if(A=Q,(A.flags&2048)!==0)try{switch(A.tag){case 0:case 11:case 15:Ya(9,A)}}catch(oe){rt(A,A.return,oe)}if(A===v){Q=null;break e}var W=A.sibling;if(W!==null){W.return=A.return,Q=W;break e}Q=A.return}}if(Le=f,Ai(),Mn&&typeof Mn.onPostCommitFiberRoot=="function")try{Mn.onPostCommitFiberRoot(ra,t)}catch{}u=!0}return u}finally{ze=s,ln.transition=i}}return!1}function Sg(t,i,s){i=Yr(s,i),i=Lp(t,i,1),t=Ii(t,i,1),i=Ft(),t!==null&&(Fo(t,1,i),jt(t,i))}function rt(t,i,s){if(t.tag===3)Sg(t,t,s);else for(;i!==null;){if(i.tag===3){Sg(i,t,s);break}else if(i.tag===1){var u=i.stateNode;if(typeof i.type.getDerivedStateFromError=="function"||typeof u.componentDidCatch=="function"&&(wi===null||!wi.has(u))){t=Yr(s,t),t=Bp(i,t,1),i=Ii(i,t,1),t=Ft(),i!==null&&(Fo(i,1,t),jt(i,t));break}}i=i.return}}function SS(t,i,s){var u=t.pingCache;u!==null&&u.delete(i),i=Ft(),t.pingedLanes|=t.suspendedLanes&s,pt===t&&(Tt&s)===s&&(ft===4||ft===3&&(Tt&130023424)===Tt&&500>ot()-Bc?er(t,0):Lc|=s),jt(t,i)}function Ag(t,i){i===0&&((t.mode&1)===0?i=1:(i=sa,sa<<=1,(sa&130023424)===0&&(sa=4194304)));var s=Ft();t=Kn(t,i),t!==null&&(Fo(t,i,s),jt(t,s))}function AS(t){var i=t.memoizedState,s=0;i!==null&&(s=i.retryLane),Ag(t,s)}function TS(t,i){var s=0;switch(t.tag){case 13:var u=t.stateNode,f=t.memoizedState;f!==null&&(s=f.retryLane);break;case 19:u=t.stateNode;break;default:throw Error(r(314))}u!==null&&u.delete(i),Ag(t,s)}var Tg;Tg=function(t,i,s){if(t!==null)if(t.memoizedProps!==i.pendingProps||zt.current)Wt=!0;else{if((t.lanes&s)===0&&(i.flags&128)===0)return Wt=!1,lS(t,i,s);Wt=(t.flags&131072)!==0}else Wt=!1,Qe&&(i.flags&1048576)!==0&&ep(i,Pa,i.index);switch(i.lanes=0,i.tag){case 2:var u=i.type;$a(t,i),t=i.pendingProps;var f=Lr(i,Rt.current);$r(i,s),f=gc(null,i,u,t,f,s);var p=mc();return i.flags|=1,typeof f=="object"&&f!==null&&typeof f.render=="function"&&f.$$typeof===void 0?(i.tag=1,i.memoizedState=null,i.updateQueue=null,$t(u)?(p=!0,_a(i)):p=!1,i.memoizedState=f.state!==null&&f.state!==void 0?f.state:null,lc(i),f.updater=xa,i.stateNode=f,f._reactInternals=i,Ic(i,u,t,s),i=Cc(null,i,u,!0,p,s)):(i.tag=0,Qe&&p&&Zu(i),Mt(null,i,f,s),i=i.child),i;case 16:u=i.elementType;e:{switch($a(t,i),t=i.pendingProps,f=u._init,u=f(u._payload),i.type=u,f=i.tag=ES(u),t=vn(u,t),f){case 0:i=_c(null,i,u,t,s);break e;case 1:i=Vp(null,i,u,t,s);break e;case 11:i=zp(null,i,u,t,s);break e;case 14:i=$p(null,i,u,vn(u.type,t),s);break e}throw Error(r(306,u,""))}return i;case 0:return u=i.type,f=i.pendingProps,f=i.elementType===u?f:vn(u,f),_c(t,i,u,f,s);case 1:return u=i.type,f=i.pendingProps,f=i.elementType===u?f:vn(u,f),Vp(t,i,u,f,s);case 3:e:{if(Xp(i),t===null)throw Error(r(387));u=i.pendingProps,p=i.memoizedState,f=p.element,up(t,i),Fa(i,u,null,s);var v=i.memoizedState;if(u=v.element,p.isDehydrated)if(p={element:u,isDehydrated:!1,cache:v.cache,pendingSuspenseBoundaries:v.pendingSuspenseBoundaries,transitions:v.transitions},i.updateQueue.baseState=p,i.memoizedState=p,i.flags&256){f=Yr(Error(r(423)),i),i=Kp(t,i,u,s,f);break e}else if(u!==f){f=Yr(Error(r(424)),i),i=Kp(t,i,u,s,f);break e}else for(Zt=vi(i.stateNode.containerInfo.firstChild),Qt=i,Qe=!0,mn=null,s=ap(i,null,u,s),i.child=s;s;)s.flags=s.flags&-3|4096,s=s.sibling;else{if(br(),u===f){i=Qn(t,i,s);break e}Mt(t,i,u,s)}i=i.child}return i;case 5:return fp(i),t===null&&tc(i),u=i.type,f=i.pendingProps,p=t!==null?t.memoizedProps:null,v=f.children,ju(u,f)?v=null:p!==null&&ju(u,p)&&(i.flags|=32),jp(t,i),Mt(t,i,v,s),i.child;case 6:return t===null&&tc(i),null;case 13:return qp(t,i,s);case 4:return uc(i,i.stateNode.containerInfo),u=i.pendingProps,t===null?i.child=xr(i,null,u,s):Mt(t,i,u,s),i.child;case 11:return u=i.type,f=i.pendingProps,f=i.elementType===u?f:vn(u,f),zp(t,i,u,f,s);case 7:return Mt(t,i,i.pendingProps,s),i.child;case 8:return Mt(t,i,i.pendingProps.children,s),i.child;case 12:return Mt(t,i,i.pendingProps.children,s),i.child;case 10:e:{if(u=i.type._context,f=i.pendingProps,p=i.memoizedProps,v=f.value,We(ka,u._currentValue),u._currentValue=v,p!==null)if(gn(p.value,v)){if(p.children===f.children&&!zt.current){i=Qn(t,i,s);break e}}else for(p=i.child,p!==null&&(p.return=i);p!==null;){var A=p.dependencies;if(A!==null){v=p.child;for(var w=A.firstContext;w!==null;){if(w.context===u){if(p.tag===1){w=qn(-1,s&-s),w.tag=2;var O=p.updateQueue;if(O!==null){O=O.shared;var G=O.pending;G===null?w.next=w:(w.next=G.next,G.next=w),O.pending=w}}p.lanes|=s,w=p.alternate,w!==null&&(w.lanes|=s),sc(p.return,s,i),A.lanes|=s;break}w=w.next}}else if(p.tag===10)v=p.type===i.type?null:p.child;else if(p.tag===18){if(v=p.return,v===null)throw Error(r(341));v.lanes|=s,A=v.alternate,A!==null&&(A.lanes|=s),sc(v,s,i),v=p.sibling}else v=p.child;if(v!==null)v.return=p;else for(v=p;v!==null;){if(v===i){v=null;break}if(p=v.sibling,p!==null){p.return=v.return,v=p;break}v=v.return}p=v}Mt(t,i,f.children,s),i=i.child}return i;case 9:return f=i.type,u=i.pendingProps.children,$r(i,s),f=sn(f),u=u(f),i.flags|=1,Mt(t,i,u,s),i.child;case 14:return u=i.type,f=vn(u,i.pendingProps),f=vn(u.type,f),$p(t,i,u,f,s);case 15:return Wp(t,i,i.type,i.pendingProps,s);case 17:return u=i.type,f=i.pendingProps,f=i.elementType===u?f:vn(u,f),$a(t,i),i.tag=1,$t(u)?(t=!0,_a(i)):t=!1,$r(i,s),Up(i,u,f),Ic(i,u,f,s),Cc(null,i,u,!0,t,s);case 19:return Zp(t,i,s);case 22:return Yp(t,i,s)}throw Error(r(156,i.tag))};function Ig(t,i){return th(t,i)}function IS(t,i,s,u){this.tag=t,this.key=s,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=i,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=u,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function un(t,i,s,u){return new IS(t,i,s,u)}function jc(t){return t=t.prototype,!(!t||!t.isReactComponent)}function ES(t){if(typeof t=="function")return jc(t)?1:0;if(t!=null){if(t=t.$$typeof,t===ke)return 11;if(t===Ue)return 14}return 2}function Pi(t,i){var s=t.alternate;return s===null?(s=un(t.tag,i,t.key,t.mode),s.elementType=t.elementType,s.type=t.type,s.stateNode=t.stateNode,s.alternate=t,t.alternate=s):(s.pendingProps=i,s.type=t.type,s.flags=0,s.subtreeFlags=0,s.deletions=null),s.flags=t.flags&14680064,s.childLanes=t.childLanes,s.lanes=t.lanes,s.child=t.child,s.memoizedProps=t.memoizedProps,s.memoizedState=t.memoizedState,s.updateQueue=t.updateQueue,i=t.dependencies,s.dependencies=i===null?null:{lanes:i.lanes,firstContext:i.firstContext},s.sibling=t.sibling,s.index=t.index,s.ref=t.ref,s}function el(t,i,s,u,f,p){var v=2;if(u=t,typeof t=="function")jc(t)&&(v=1);else if(typeof t=="string")v=5;else e:switch(t){case Y:return nr(s.children,f,p,i);case ae:v=8,f|=8;break;case Ee:return t=un(12,s,i,f|2),t.elementType=Ee,t.lanes=p,t;case Ie:return t=un(13,s,i,f),t.elementType=Ie,t.lanes=p,t;case ue:return t=un(19,s,i,f),t.elementType=ue,t.lanes=p,t;case J:return tl(s,f,p,i);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case we:v=10;break e;case be:v=9;break e;case ke:v=11;break e;case Ue:v=14;break e;case ye:v=16,u=null;break e}throw Error(r(130,t==null?t:typeof t,""))}return i=un(v,s,i,f),i.elementType=t,i.type=u,i.lanes=p,i}function nr(t,i,s,u){return t=un(7,t,u,i),t.lanes=s,t}function tl(t,i,s,u){return t=un(22,t,u,i),t.elementType=J,t.lanes=s,t.stateNode={isHidden:!1},t}function Vc(t,i,s){return t=un(6,t,null,i),t.lanes=s,t}function Xc(t,i,s){return i=un(4,t.children!==null?t.children:[],t.key,i),i.lanes=s,i.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},i}function wS(t,i,s,u,f){this.tag=i,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Tu(0),this.expirationTimes=Tu(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Tu(0),this.identifierPrefix=u,this.onRecoverableError=f,this.mutableSourceEagerHydrationData=null}function Kc(t,i,s,u,f,p,v,A,w){return t=new wS(t,i,s,A,w),i===1?(i=1,p===!0&&(i|=8)):i=0,p=un(3,null,null,i),t.current=p,p.stateNode=t,p.memoizedState={element:u,isDehydrated:s,cache:null,transitions:null,pendingSuspenseBoundaries:null},lc(p),t}function _S(t,i,s){var u=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:U,key:u==null?null:""+u,children:t,containerInfo:i,implementation:s}}function Eg(t){if(!t)return Si;t=t._reactInternals;e:{if(Wi(t)!==t||t.tag!==1)throw Error(r(170));var i=t;do{switch(i.tag){case 3:i=i.stateNode.context;break e;case 1:if($t(i.type)){i=i.stateNode.__reactInternalMemoizedMergedChildContext;break e}}i=i.return}while(i!==null);throw Error(r(171))}if(t.tag===1){var s=t.type;if($t(s))return Qh(t,s,i)}return i}function wg(t,i,s,u,f,p,v,A,w){return t=Kc(s,u,!0,t,f,p,v,A,w),t.context=Eg(null),s=t.current,u=Ft(),f=Ci(s),p=qn(u,f),p.callback=i??null,Ii(s,p,f),t.current.lanes=f,Fo(t,f,u),jt(t,u),t}function nl(t,i,s,u){var f=i.current,p=Ft(),v=Ci(f);return s=Eg(s),i.context===null?i.context=s:i.pendingContext=s,i=qn(p,v),i.payload={element:t},u=u===void 0?null:u,u!==null&&(i.callback=u),t=Ii(f,i,v),t!==null&&(An(t,f,v,p),Ma(t,f,v)),v}function il(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function _g(t,i){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var s=t.retryLane;t.retryLane=s!==0&&s<i?s:i}}function qc(t,i){_g(t,i),(t=t.alternate)&&_g(t,i)}function CS(){return null}var Cg=typeof reportError=="function"?reportError:function(t){console.error(t)};function Qc(t){this._internalRoot=t}rl.prototype.render=Qc.prototype.render=function(t){var i=this._internalRoot;if(i===null)throw Error(r(409));nl(t,i,null,null)},rl.prototype.unmount=Qc.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var i=t.containerInfo;Ji(function(){nl(null,t,null,null)}),i[Yn]=null}};function rl(t){this._internalRoot=t}rl.prototype.unstable_scheduleHydration=function(t){if(t){var i=uh();t={blockedOn:null,target:t,priority:i};for(var s=0;s<pi.length&&i!==0&&i<pi[s].priority;s++);pi.splice(s,0,t),s===0&&fh(t)}};function Zc(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function ol(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function Rg(){}function RS(t,i,s,u,f){if(f){if(typeof u=="function"){var p=u;u=function(){var O=il(v);p.call(O)}}var v=wg(i,u,t,0,null,!1,!1,"",Rg);return t._reactRootContainer=v,t[Yn]=v.current,Xo(t.nodeType===8?t.parentNode:t),Ji(),v}for(;f=t.lastChild;)t.removeChild(f);if(typeof u=="function"){var A=u;u=function(){var O=il(w);A.call(O)}}var w=Kc(t,0,!1,null,null,!1,!1,"",Rg);return t._reactRootContainer=w,t[Yn]=w.current,Xo(t.nodeType===8?t.parentNode:t),Ji(function(){nl(i,w,s,u)}),w}function sl(t,i,s,u,f){var p=s._reactRootContainer;if(p){var v=p;if(typeof f=="function"){var A=f;f=function(){var w=il(v);A.call(w)}}nl(i,v,t,f)}else v=RS(s,i,t,f,u);return il(v)}ah=function(t){switch(t.tag){case 3:var i=t.stateNode;if(i.current.memoizedState.isDehydrated){var s=Mo(i.pendingLanes);s!==0&&(Iu(i,s|1),jt(i,ot()),(Le&6)===0&&(Xr=ot()+500,Ai()))}break;case 13:Ji(function(){var u=Kn(t,1);if(u!==null){var f=Ft();An(u,t,1,f)}}),qc(t,1)}},Eu=function(t){if(t.tag===13){var i=Kn(t,134217728);if(i!==null){var s=Ft();An(i,t,134217728,s)}qc(t,134217728)}},lh=function(t){if(t.tag===13){var i=Ci(t),s=Kn(t,i);if(s!==null){var u=Ft();An(s,t,i,u)}qc(t,i)}},uh=function(){return ze},ch=function(t,i){var s=ze;try{return ze=t,i()}finally{ze=s}},gu=function(t,i,s){switch(i){case"input":if(xt(t,s),i=s.name,s.type==="radio"&&i!=null){for(s=t;s.parentNode;)s=s.parentNode;for(s=s.querySelectorAll("input[name="+JSON.stringify(""+i)+'][type="radio"]'),i=0;i<s.length;i++){var u=s[i];if(u!==t&&u.form===t.form){var f=Ea(u);if(!f)throw Error(r(90));ce(u),xt(u,f)}}}break;case"textarea":Gf(t,s);break;case"select":i=s.value,i!=null&&ci(t,!!s.multiple,i,!1)}},Xf=$c,Kf=Ji;var PS={usingClientEntryPoint:!1,Events:[Qo,Ur,Ea,jf,Vf,$c]},ds={findFiberByHostInstance:Yi,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},NS={bundleType:ds.bundleType,version:ds.version,rendererPackageName:ds.rendererPackageName,rendererConfig:ds.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:B.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=Jf(t),t===null?null:t.stateNode},findFiberByHostInstance:ds.findFiberByHostInstance||CS,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var al=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!al.isDisabled&&al.supportsFiber)try{ra=al.inject(NS),Mn=al}catch{}}return Vt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=PS,Vt.createPortal=function(t,i){var s=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Zc(i))throw Error(r(200));return _S(t,i,null,s)},Vt.createRoot=function(t,i){if(!Zc(t))throw Error(r(299));var s=!1,u="",f=Cg;return i!=null&&(i.unstable_strictMode===!0&&(s=!0),i.identifierPrefix!==void 0&&(u=i.identifierPrefix),i.onRecoverableError!==void 0&&(f=i.onRecoverableError)),i=Kc(t,1,!1,null,null,s,!1,u,f),t[Yn]=i.current,Xo(t.nodeType===8?t.parentNode:t),new Qc(i)},Vt.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var i=t._reactInternals;if(i===void 0)throw typeof t.render=="function"?Error(r(188)):(t=Object.keys(t).join(","),Error(r(268,t)));return t=Jf(i),t=t===null?null:t.stateNode,t},Vt.flushSync=function(t){return Ji(t)},Vt.hydrate=function(t,i,s){if(!ol(i))throw Error(r(200));return sl(null,t,i,!0,s)},Vt.hydrateRoot=function(t,i,s){if(!Zc(t))throw Error(r(405));var u=s!=null&&s.hydratedSources||null,f=!1,p="",v=Cg;if(s!=null&&(s.unstable_strictMode===!0&&(f=!0),s.identifierPrefix!==void 0&&(p=s.identifierPrefix),s.onRecoverableError!==void 0&&(v=s.onRecoverableError)),i=wg(i,null,t,1,s??null,f,!1,p,v),t[Yn]=i.current,Xo(t),u)for(t=0;t<u.length;t++)s=u[t],f=s._getVersion,f=f(s._source),i.mutableSourceEagerHydrationData==null?i.mutableSourceEagerHydrationData=[s,f]:i.mutableSourceEagerHydrationData.push(s,f);return new rl(i)},Vt.render=function(t,i,s){if(!ol(i))throw Error(r(200));return sl(null,t,i,!1,s)},Vt.unmountComponentAtNode=function(t){if(!ol(t))throw Error(r(40));return t._reactRootContainer?(Ji(function(){sl(null,null,t,!1,function(){t._reactRootContainer=null,t[Yn]=null})}),!0):!1},Vt.unstable_batchedUpdates=$c,Vt.unstable_renderSubtreeIntoContainer=function(t,i,s,u){if(!ol(s))throw Error(r(200));if(t==null||t._reactInternals===void 0)throw Error(r(38));return sl(t,i,s,!1,u)},Vt.version="18.3.1-next-f1338f8080-20240426",Vt}var Ug;function GS(){if(Ug)return td.exports;Ug=1;function e(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(n){console.error(n)}}return e(),td.exports=BS(),td.exports}var Hg;function bS(){if(Hg)return ll;Hg=1;var e=GS();return ll.createRoot=e.createRoot,ll.hydrateRoot=e.hydrateRoot,ll}var xS=bS();const zS=Qm(xS),Zm=Pe.createContext(void 0),$S=({initialAppState:e,children:n})=>{const[r,o]=Pe.useState(e),[l,a]=Pe.useState(void 0),c=(h,g)=>{o(h),h==="gameOver"&&g?a(g):h!=="gameOver"&&a(void 0)},d=()=>{o("intro"),a(void 0)};return He.jsx(Zm.Provider,{value:{appState:r,setAppState:c,returnToIntro:d,gameOverDetails:l},children:n})},Xs=()=>{const e=Pe.useContext(Zm);if(e===void 0)throw new Error("useGameContext must be used within a GameProvider");return e};var Ot=function(){return Ot=Object.assign||function(n){for(var r,o=1,l=arguments.length;o<l;o++){r=arguments[o];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(n[a]=r[a])}return n},Ot.apply(this,arguments)};function Ms(e,n,r){if(r||arguments.length===2)for(var o=0,l=n.length,a;o<l;o++)(a||!(o in n))&&(a||(a=Array.prototype.slice.call(n,0,o)),a[o]=n[o]);return e.concat(a||Array.prototype.slice.call(n))}var Xe="-ms-",Cs="-moz-",xe="-webkit-",Jm="comm",Kl="rule",tf="decl",WS="@import",e0="@keyframes",YS="@layer",t0=Math.abs,nf=String.fromCharCode,Hd=Object.assign;function jS(e,n){return mt(e,0)^45?(((n<<2^mt(e,0))<<2^mt(e,1))<<2^mt(e,2))<<2^mt(e,3):0}function n0(e){return e.trim()}function ti(e,n){return(e=n.exec(e))?e[0]:e}function Ne(e,n,r){return e.replace(n,r)}function Dl(e,n,r){return e.indexOf(n,r)}function mt(e,n){return e.charCodeAt(n)|0}function ho(e,n,r){return e.slice(n,r)}function xn(e){return e.length}function i0(e){return e.length}function Ts(e,n){return n.push(e),e}function VS(e,n){return e.map(n).join("")}function Lg(e,n){return e.filter(function(r){return!ti(r,n)})}var ql=1,po=1,r0=0,hn=0,ut=0,wo="";function Ql(e,n,r,o,l,a,c,d){return{value:e,root:n,parent:r,type:o,props:l,children:a,line:ql,column:po,length:c,return:"",siblings:d}}function Mi(e,n){return Hd(Ql("",null,null,"",null,null,0,e.siblings),e,{length:-e.length},n)}function qr(e){for(;e.root;)e=Mi(e.root,{children:[e]});Ts(e,e.siblings)}function XS(){return ut}function KS(){return ut=hn>0?mt(wo,--hn):0,po--,ut===10&&(po=1,ql--),ut}function _n(){return ut=hn<r0?mt(wo,hn++):0,po++,ut===10&&(po=1,ql++),ut}function hr(){return mt(wo,hn)}function kl(){return hn}function Zl(e,n){return ho(wo,e,n)}function Ld(e){switch(e){case 0:case 9:case 10:case 13:case 32:return 5;case 33:case 43:case 44:case 47:case 62:case 64:case 126:case 59:case 123:case 125:return 4;case 58:return 3;case 34:case 39:case 40:case 91:return 2;case 41:case 93:return 1}return 0}function qS(e){return ql=po=1,r0=xn(wo=e),hn=0,[]}function QS(e){return wo="",e}function rd(e){return n0(Zl(hn-1,Bd(e===91?e+2:e===40?e+1:e)))}function ZS(e){for(;(ut=hr())&&ut<33;)_n();return Ld(e)>2||Ld(ut)>3?"":" "}function JS(e,n){for(;--n&&_n()&&!(ut<48||ut>102||ut>57&&ut<65||ut>70&&ut<97););return Zl(e,kl()+(n<6&&hr()==32&&_n()==32))}function Bd(e){for(;_n();)switch(ut){case e:return hn;case 34:case 39:e!==34&&e!==39&&Bd(ut);break;case 40:e===41&&Bd(e);break;case 92:_n();break}return hn}function eA(e,n){for(;_n()&&e+ut!==57;)if(e+ut===84&&hr()===47)break;return"/*"+Zl(n,hn-1)+"*"+nf(e===47?e:_n())}function tA(e){for(;!Ld(hr());)_n();return Zl(e,hn)}function nA(e){return QS(Ol("",null,null,null,[""],e=qS(e),0,[0],e))}function Ol(e,n,r,o,l,a,c,d,h){for(var g=0,m=0,y=c,S=0,_=0,C=0,T=1,E=1,M=1,H=0,D="",B=l,x=a,U=o,Y=D;E;)switch(C=H,H=_n()){case 40:if(C!=108&&mt(Y,y-1)==58){Dl(Y+=Ne(rd(H),"&","&\f"),"&\f",t0(g?d[g-1]:0))!=-1&&(M=-1);break}case 34:case 39:case 91:Y+=rd(H);break;case 9:case 10:case 13:case 32:Y+=ZS(C);break;case 92:Y+=JS(kl()-1,7);continue;case 47:switch(hr()){case 42:case 47:Ts(iA(eA(_n(),kl()),n,r,h),h);break;default:Y+="/"}break;case 123*T:d[g++]=xn(Y)*M;case 125*T:case 59:case 0:switch(H){case 0:case 125:E=0;case 59+m:M==-1&&(Y=Ne(Y,/\f/g,"")),_>0&&xn(Y)-y&&Ts(_>32?Gg(Y+";",o,r,y-1,h):Gg(Ne(Y," ","")+";",o,r,y-2,h),h);break;case 59:Y+=";";default:if(Ts(U=Bg(Y,n,r,g,m,l,d,D,B=[],x=[],y,a),a),H===123)if(m===0)Ol(Y,n,U,U,B,a,y,d,x);else switch(S===99&&mt(Y,3)===110?100:S){case 100:case 108:case 109:case 115:Ol(e,U,U,o&&Ts(Bg(e,U,U,0,0,l,d,D,l,B=[],y,x),x),l,x,y,d,o?B:x);break;default:Ol(Y,U,U,U,[""],x,0,d,x)}}g=m=_=0,T=M=1,D=Y="",y=c;break;case 58:y=1+xn(Y),_=C;default:if(T<1){if(H==123)--T;else if(H==125&&T++==0&&KS()==125)continue}switch(Y+=nf(H),H*T){case 38:M=m>0?1:(Y+="\f",-1);break;case 44:d[g++]=(xn(Y)-1)*M,M=1;break;case 64:hr()===45&&(Y+=rd(_n())),S=hr(),m=y=xn(D=Y+=tA(kl())),H++;break;case 45:C===45&&xn(Y)==2&&(T=0)}}return a}function Bg(e,n,r,o,l,a,c,d,h,g,m,y){for(var S=l-1,_=l===0?a:[""],C=i0(_),T=0,E=0,M=0;T<o;++T)for(var H=0,D=ho(e,S+1,S=t0(E=c[T])),B=e;H<C;++H)(B=n0(E>0?_[H]+" "+D:Ne(D,/&\f/g,_[H])))&&(h[M++]=B);return Ql(e,n,r,l===0?Kl:d,h,g,m,y)}function iA(e,n,r,o){return Ql(e,n,r,Jm,nf(XS()),ho(e,2,-2),0,o)}function Gg(e,n,r,o,l){return Ql(e,n,r,tf,ho(e,0,o),ho(e,o+1,-1),o,l)}function o0(e,n,r){switch(jS(e,n)){case 5103:return xe+"print-"+e+e;case 5737:case 4201:case 3177:case 3433:case 1641:case 4457:case 2921:case 5572:case 6356:case 5844:case 3191:case 6645:case 3005:case 6391:case 5879:case 5623:case 6135:case 4599:case 4855:case 4215:case 6389:case 5109:case 5365:case 5621:case 3829:return xe+e+e;case 4789:return Cs+e+e;case 5349:case 4246:case 4810:case 6968:case 2756:return xe+e+Cs+e+Xe+e+e;case 5936:switch(mt(e,n+11)){case 114:return xe+e+Xe+Ne(e,/[svh]\w+-[tblr]{2}/,"tb")+e;case 108:return xe+e+Xe+Ne(e,/[svh]\w+-[tblr]{2}/,"tb-rl")+e;case 45:return xe+e+Xe+Ne(e,/[svh]\w+-[tblr]{2}/,"lr")+e}case 6828:case 4268:case 2903:return xe+e+Xe+e+e;case 6165:return xe+e+Xe+"flex-"+e+e;case 5187:return xe+e+Ne(e,/(\w+).+(:[^]+)/,xe+"box-$1$2"+Xe+"flex-$1$2")+e;case 5443:return xe+e+Xe+"flex-item-"+Ne(e,/flex-|-self/g,"")+(ti(e,/flex-|baseline/)?"":Xe+"grid-row-"+Ne(e,/flex-|-self/g,""))+e;case 4675:return xe+e+Xe+"flex-line-pack"+Ne(e,/align-content|flex-|-self/g,"")+e;case 5548:return xe+e+Xe+Ne(e,"shrink","negative")+e;case 5292:return xe+e+Xe+Ne(e,"basis","preferred-size")+e;case 6060:return xe+"box-"+Ne(e,"-grow","")+xe+e+Xe+Ne(e,"grow","positive")+e;case 4554:return xe+Ne(e,/([^-])(transform)/g,"$1"+xe+"$2")+e;case 6187:return Ne(Ne(Ne(e,/(zoom-|grab)/,xe+"$1"),/(image-set)/,xe+"$1"),e,"")+e;case 5495:case 3959:return Ne(e,/(image-set\([^]*)/,xe+"$1$`$1");case 4968:return Ne(Ne(e,/(.+:)(flex-)?(.*)/,xe+"box-pack:$3"+Xe+"flex-pack:$3"),/s.+-b[^;]+/,"justify")+xe+e+e;case 4200:if(!ti(e,/flex-|baseline/))return Xe+"grid-column-align"+ho(e,n)+e;break;case 2592:case 3360:return Xe+Ne(e,"template-","")+e;case 4384:case 3616:return r&&r.some(function(o,l){return n=l,ti(o.props,/grid-\w+-end/)})?~Dl(e+(r=r[n].value),"span",0)?e:Xe+Ne(e,"-start","")+e+Xe+"grid-row-span:"+(~Dl(r,"span",0)?ti(r,/\d+/):+ti(r,/\d+/)-+ti(e,/\d+/))+";":Xe+Ne(e,"-start","")+e;case 4896:case 4128:return r&&r.some(function(o){return ti(o.props,/grid-\w+-start/)})?e:Xe+Ne(Ne(e,"-end","-span"),"span ","")+e;case 4095:case 3583:case 4068:case 2532:return Ne(e,/(.+)-inline(.+)/,xe+"$1$2")+e;case 8116:case 7059:case 5753:case 5535:case 5445:case 5701:case 4933:case 4677:case 5533:case 5789:case 5021:case 4765:if(xn(e)-1-n>6)switch(mt(e,n+1)){case 109:if(mt(e,n+4)!==45)break;case 102:return Ne(e,/(.+:)(.+)-([^]+)/,"$1"+xe+"$2-$3$1"+Cs+(mt(e,n+3)==108?"$3":"$2-$3"))+e;case 115:return~Dl(e,"stretch",0)?o0(Ne(e,"stretch","fill-available"),n,r)+e:e}break;case 5152:case 5920:return Ne(e,/(.+?):(\d+)(\s*\/\s*(span)?\s*(\d+))?(.*)/,function(o,l,a,c,d,h,g){return Xe+l+":"+a+g+(c?Xe+l+"-span:"+(d?h:+h-+a)+g:"")+e});case 4949:if(mt(e,n+6)===121)return Ne(e,":",":"+xe)+e;break;case 6444:switch(mt(e,mt(e,14)===45?18:11)){case 120:return Ne(e,/(.+:)([^;\s!]+)(;|(\s+)?!.+)?/,"$1"+xe+(mt(e,14)===45?"inline-":"")+"box$3$1"+xe+"$2$3$1"+Xe+"$2box$3")+e;case 100:return Ne(e,":",":"+Xe)+e}break;case 5719:case 2647:case 2135:case 3927:case 2391:return Ne(e,"scroll-","scroll-snap-")+e}return e}function Bl(e,n){for(var r="",o=0;o<e.length;o++)r+=n(e[o],o,e,n)||"";return r}function rA(e,n,r,o){switch(e.type){case YS:if(e.children.length)break;case WS:case tf:return e.return=e.return||e.value;case Jm:return"";case e0:return e.return=e.value+"{"+Bl(e.children,o)+"}";case Kl:if(!xn(e.value=e.props.join(",")))return""}return xn(r=Bl(e.children,o))?e.return=e.value+"{"+r+"}":""}function oA(e){var n=i0(e);return function(r,o,l,a){for(var c="",d=0;d<n;d++)c+=e[d](r,o,l,a)||"";return c}}function sA(e){return function(n){n.root||(n=n.return)&&e(n)}}function aA(e,n,r,o){if(e.length>-1&&!e.return)switch(e.type){case tf:e.return=o0(e.value,e.length,r);return;case e0:return Bl([Mi(e,{value:Ne(e.value,"@","@"+xe)})],o);case Kl:if(e.length)return VS(r=e.props,function(l){switch(ti(l,o=/(::plac\w+|:read-\w+)/)){case":read-only":case":read-write":qr(Mi(e,{props:[Ne(l,/:(read-\w+)/,":"+Cs+"$1")]})),qr(Mi(e,{props:[l]})),Hd(e,{props:Lg(r,o)});break;case"::placeholder":qr(Mi(e,{props:[Ne(l,/:(plac\w+)/,":"+xe+"input-$1")]})),qr(Mi(e,{props:[Ne(l,/:(plac\w+)/,":"+Cs+"$1")]})),qr(Mi(e,{props:[Ne(l,/:(plac\w+)/,Xe+"input-$1")]})),qr(Mi(e,{props:[l]})),Hd(e,{props:Lg(r,o)});break}return""})}}var lA={animationIterationCount:1,aspectRatio:1,borderImageOutset:1,borderImageSlice:1,borderImageWidth:1,boxFlex:1,boxFlexGroup:1,boxOrdinalGroup:1,columnCount:1,columns:1,flex:1,flexGrow:1,flexPositive:1,flexShrink:1,flexNegative:1,flexOrder:1,gridRow:1,gridRowEnd:1,gridRowSpan:1,gridRowStart:1,gridColumn:1,gridColumnEnd:1,gridColumnSpan:1,gridColumnStart:1,msGridRow:1,msGridRowSpan:1,msGridColumn:1,msGridColumnSpan:1,fontWeight:1,lineHeight:1,opacity:1,order:1,orphans:1,tabSize:1,widows:1,zIndex:1,zoom:1,WebkitLineClamp:1,fillOpacity:1,floodOpacity:1,stopOpacity:1,strokeDasharray:1,strokeDashoffset:1,strokeMiterlimit:1,strokeOpacity:1,strokeWidth:1},tn={},go=typeof process<"u"&&tn!==void 0&&(tn.REACT_APP_SC_ATTR||tn.SC_ATTR)||"data-styled",s0="active",a0="data-styled-version",Jl="6.1.13",rf=`/*!sc*/
`,Gl=typeof window<"u"&&"HTMLElement"in window,uA=!!(typeof SC_DISABLE_SPEEDY=="boolean"?SC_DISABLE_SPEEDY:typeof process<"u"&&tn!==void 0&&tn.REACT_APP_SC_DISABLE_SPEEDY!==void 0&&tn.REACT_APP_SC_DISABLE_SPEEDY!==""?tn.REACT_APP_SC_DISABLE_SPEEDY!=="false"&&tn.REACT_APP_SC_DISABLE_SPEEDY:typeof process<"u"&&tn!==void 0&&tn.SC_DISABLE_SPEEDY!==void 0&&tn.SC_DISABLE_SPEEDY!==""&&tn.SC_DISABLE_SPEEDY!=="false"&&tn.SC_DISABLE_SPEEDY),cA={},eu=Object.freeze([]),mo=Object.freeze({});function l0(e,n,r){return r===void 0&&(r=mo),e.theme!==r.theme&&e.theme||n||r.theme}var u0=new Set(["a","abbr","address","area","article","aside","audio","b","base","bdi","bdo","big","blockquote","body","br","button","canvas","caption","cite","code","col","colgroup","data","datalist","dd","del","details","dfn","dialog","div","dl","dt","em","embed","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","header","hgroup","hr","html","i","iframe","img","input","ins","kbd","keygen","label","legend","li","link","main","map","mark","menu","menuitem","meta","meter","nav","noscript","object","ol","optgroup","option","output","p","param","picture","pre","progress","q","rp","rt","ruby","s","samp","script","section","select","small","source","span","strong","style","sub","summary","sup","table","tbody","td","textarea","tfoot","th","thead","time","tr","track","u","ul","use","var","video","wbr","circle","clipPath","defs","ellipse","foreignObject","g","image","line","linearGradient","marker","mask","path","pattern","polygon","polyline","radialGradient","rect","stop","svg","text","tspan"]),dA=/[!"#$%&'()*+,./:;<=>?@[\\\]^`{|}~-]+/g,fA=/(^-|-$)/g;function bg(e){return e.replace(dA,"-").replace(fA,"")}var hA=/(a)(d)/gi,ul=52,xg=function(e){return String.fromCharCode(e+(e>25?39:97))};function Gd(e){var n,r="";for(n=Math.abs(e);n>ul;n=n/ul|0)r=xg(n%ul)+r;return(xg(n%ul)+r).replace(hA,"$1-$2")}var od,c0=5381,io=function(e,n){for(var r=n.length;r;)e=33*e^n.charCodeAt(--r);return e},d0=function(e){return io(c0,e)};function f0(e){return Gd(d0(e)>>>0)}function pA(e){return e.displayName||e.name||"Component"}function sd(e){return typeof e=="string"&&!0}var h0=typeof Symbol=="function"&&Symbol.for,p0=h0?Symbol.for("react.memo"):60115,gA=h0?Symbol.for("react.forward_ref"):60112,mA={childContextTypes:!0,contextType:!0,contextTypes:!0,defaultProps:!0,displayName:!0,getDefaultProps:!0,getDerivedStateFromError:!0,getDerivedStateFromProps:!0,mixins:!0,propTypes:!0,type:!0},vA={name:!0,length:!0,prototype:!0,caller:!0,callee:!0,arguments:!0,arity:!0},g0={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},yA=((od={})[gA]={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},od[p0]=g0,od);function zg(e){return("type"in(n=e)&&n.type.$$typeof)===p0?g0:"$$typeof"in e?yA[e.$$typeof]:mA;var n}var SA=Object.defineProperty,AA=Object.getOwnPropertyNames,$g=Object.getOwnPropertySymbols,TA=Object.getOwnPropertyDescriptor,IA=Object.getPrototypeOf,Wg=Object.prototype;function m0(e,n,r){if(typeof n!="string"){if(Wg){var o=IA(n);o&&o!==Wg&&m0(e,o,r)}var l=AA(n);$g&&(l=l.concat($g(n)));for(var a=zg(e),c=zg(n),d=0;d<l.length;++d){var h=l[d];if(!(h in vA||r&&r[h]||c&&h in c||a&&h in a)){var g=TA(n,h);try{SA(e,h,g)}catch{}}}}return e}function vo(e){return typeof e=="function"}function of(e){return typeof e=="object"&&"styledComponentId"in e}function dr(e,n){return e&&n?"".concat(e," ").concat(n):e||n||""}function bd(e,n){if(e.length===0)return"";for(var r=e[0],o=1;o<e.length;o++)r+=e[o];return r}function Fs(e){return e!==null&&typeof e=="object"&&e.constructor.name===Object.name&&!("props"in e&&e.$$typeof)}function xd(e,n,r){if(r===void 0&&(r=!1),!r&&!Fs(e)&&!Array.isArray(e))return n;if(Array.isArray(n))for(var o=0;o<n.length;o++)e[o]=xd(e[o],n[o]);else if(Fs(n))for(var o in n)e[o]=xd(e[o],n[o]);return e}function sf(e,n){Object.defineProperty(e,"toString",{value:n})}function Ks(e){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];return new Error("An error occurred. See https://github.com/styled-components/styled-components/blob/main/packages/styled-components/src/utils/errors.md#".concat(e," for more information.").concat(n.length>0?" Args: ".concat(n.join(", ")):""))}var EA=function(){function e(n){this.groupSizes=new Uint32Array(512),this.length=512,this.tag=n}return e.prototype.indexOfGroup=function(n){for(var r=0,o=0;o<n;o++)r+=this.groupSizes[o];return r},e.prototype.insertRules=function(n,r){if(n>=this.groupSizes.length){for(var o=this.groupSizes,l=o.length,a=l;n>=a;)if((a<<=1)<0)throw Ks(16,"".concat(n));this.groupSizes=new Uint32Array(a),this.groupSizes.set(o),this.length=a;for(var c=l;c<a;c++)this.groupSizes[c]=0}for(var d=this.indexOfGroup(n+1),h=(c=0,r.length);c<h;c++)this.tag.insertRule(d,r[c])&&(this.groupSizes[n]++,d++)},e.prototype.clearGroup=function(n){if(n<this.length){var r=this.groupSizes[n],o=this.indexOfGroup(n),l=o+r;this.groupSizes[n]=0;for(var a=o;a<l;a++)this.tag.deleteRule(o)}},e.prototype.getGroup=function(n){var r="";if(n>=this.length||this.groupSizes[n]===0)return r;for(var o=this.groupSizes[n],l=this.indexOfGroup(n),a=l+o,c=l;c<a;c++)r+="".concat(this.tag.getRule(c)).concat(rf);return r},e}(),Ml=new Map,bl=new Map,Fl=1,cl=function(e){if(Ml.has(e))return Ml.get(e);for(;bl.has(Fl);)Fl++;var n=Fl++;return Ml.set(e,n),bl.set(n,e),n},wA=function(e,n){Fl=n+1,Ml.set(e,n),bl.set(n,e)},_A="style[".concat(go,"][").concat(a0,'="').concat(Jl,'"]'),CA=new RegExp("^".concat(go,'\\.g(\\d+)\\[id="([\\w\\d-]+)"\\].*?"([^"]*)')),RA=function(e,n,r){for(var o,l=r.split(","),a=0,c=l.length;a<c;a++)(o=l[a])&&e.registerName(n,o)},PA=function(e,n){for(var r,o=((r=n.textContent)!==null&&r!==void 0?r:"").split(rf),l=[],a=0,c=o.length;a<c;a++){var d=o[a].trim();if(d){var h=d.match(CA);if(h){var g=0|parseInt(h[1],10),m=h[2];g!==0&&(wA(m,g),RA(e,m,h[3]),e.getTag().insertRules(g,l)),l.length=0}else l.push(d)}}},Yg=function(e){for(var n=document.querySelectorAll(_A),r=0,o=n.length;r<o;r++){var l=n[r];l&&l.getAttribute(go)!==s0&&(PA(e,l),l.parentNode&&l.parentNode.removeChild(l))}};function NA(){return typeof __webpack_nonce__<"u"?__webpack_nonce__:null}var v0=function(e){var n=document.head,r=e||n,o=document.createElement("style"),l=function(d){var h=Array.from(d.querySelectorAll("style[".concat(go,"]")));return h[h.length-1]}(r),a=l!==void 0?l.nextSibling:null;o.setAttribute(go,s0),o.setAttribute(a0,Jl);var c=NA();return c&&o.setAttribute("nonce",c),r.insertBefore(o,a),o},DA=function(){function e(n){this.element=v0(n),this.element.appendChild(document.createTextNode("")),this.sheet=function(r){if(r.sheet)return r.sheet;for(var o=document.styleSheets,l=0,a=o.length;l<a;l++){var c=o[l];if(c.ownerNode===r)return c}throw Ks(17)}(this.element),this.length=0}return e.prototype.insertRule=function(n,r){try{return this.sheet.insertRule(r,n),this.length++,!0}catch{return!1}},e.prototype.deleteRule=function(n){this.sheet.deleteRule(n),this.length--},e.prototype.getRule=function(n){var r=this.sheet.cssRules[n];return r&&r.cssText?r.cssText:""},e}(),kA=function(){function e(n){this.element=v0(n),this.nodes=this.element.childNodes,this.length=0}return e.prototype.insertRule=function(n,r){if(n<=this.length&&n>=0){var o=document.createTextNode(r);return this.element.insertBefore(o,this.nodes[n]||null),this.length++,!0}return!1},e.prototype.deleteRule=function(n){this.element.removeChild(this.nodes[n]),this.length--},e.prototype.getRule=function(n){return n<this.length?this.nodes[n].textContent:""},e}(),OA=function(){function e(n){this.rules=[],this.length=0}return e.prototype.insertRule=function(n,r){return n<=this.length&&(this.rules.splice(n,0,r),this.length++,!0)},e.prototype.deleteRule=function(n){this.rules.splice(n,1),this.length--},e.prototype.getRule=function(n){return n<this.length?this.rules[n]:""},e}(),jg=Gl,MA={isServer:!Gl,useCSSOMInjection:!uA},xl=function(){function e(n,r,o){n===void 0&&(n=mo),r===void 0&&(r={});var l=this;this.options=Ot(Ot({},MA),n),this.gs=r,this.names=new Map(o),this.server=!!n.isServer,!this.server&&Gl&&jg&&(jg=!1,Yg(this)),sf(this,function(){return function(a){for(var c=a.getTag(),d=c.length,h="",g=function(y){var S=function(M){return bl.get(M)}(y);if(S===void 0)return"continue";var _=a.names.get(S),C=c.getGroup(y);if(_===void 0||!_.size||C.length===0)return"continue";var T="".concat(go,".g").concat(y,'[id="').concat(S,'"]'),E="";_!==void 0&&_.forEach(function(M){M.length>0&&(E+="".concat(M,","))}),h+="".concat(C).concat(T,'{content:"').concat(E,'"}').concat(rf)},m=0;m<d;m++)g(m);return h}(l)})}return e.registerId=function(n){return cl(n)},e.prototype.rehydrate=function(){!this.server&&Gl&&Yg(this)},e.prototype.reconstructWithOptions=function(n,r){return r===void 0&&(r=!0),new e(Ot(Ot({},this.options),n),this.gs,r&&this.names||void 0)},e.prototype.allocateGSInstance=function(n){return this.gs[n]=(this.gs[n]||0)+1},e.prototype.getTag=function(){return this.tag||(this.tag=(n=function(r){var o=r.useCSSOMInjection,l=r.target;return r.isServer?new OA(l):o?new DA(l):new kA(l)}(this.options),new EA(n)));var n},e.prototype.hasNameForId=function(n,r){return this.names.has(n)&&this.names.get(n).has(r)},e.prototype.registerName=function(n,r){if(cl(n),this.names.has(n))this.names.get(n).add(r);else{var o=new Set;o.add(r),this.names.set(n,o)}},e.prototype.insertRules=function(n,r,o){this.registerName(n,r),this.getTag().insertRules(cl(n),o)},e.prototype.clearNames=function(n){this.names.has(n)&&this.names.get(n).clear()},e.prototype.clearRules=function(n){this.getTag().clearGroup(cl(n)),this.clearNames(n)},e.prototype.clearTag=function(){this.tag=void 0},e}(),FA=/&/g,UA=/^\s*\/\/.*$/gm;function y0(e,n){return e.map(function(r){return r.type==="rule"&&(r.value="".concat(n," ").concat(r.value),r.value=r.value.replaceAll(",",",".concat(n," ")),r.props=r.props.map(function(o){return"".concat(n," ").concat(o)})),Array.isArray(r.children)&&r.type!=="@keyframes"&&(r.children=y0(r.children,n)),r})}function HA(e){var n,r,o,l=mo,a=l.options,c=a===void 0?mo:a,d=l.plugins,h=d===void 0?eu:d,g=function(S,_,C){return C.startsWith(r)&&C.endsWith(r)&&C.replaceAll(r,"").length>0?".".concat(n):S},m=h.slice();m.push(function(S){S.type===Kl&&S.value.includes("&")&&(S.props[0]=S.props[0].replace(FA,r).replace(o,g))}),c.prefix&&m.push(aA),m.push(rA);var y=function(S,_,C,T){_===void 0&&(_=""),C===void 0&&(C=""),T===void 0&&(T="&"),n=T,r=_,o=new RegExp("\\".concat(r,"\\b"),"g");var E=S.replace(UA,""),M=nA(C||_?"".concat(C," ").concat(_," { ").concat(E," }"):E);c.namespace&&(M=y0(M,c.namespace));var H=[];return Bl(M,oA(m.concat(sA(function(D){return H.push(D)})))),H};return y.hash=h.length?h.reduce(function(S,_){return _.name||Ks(15),io(S,_.name)},c0).toString():"",y}var LA=new xl,zd=HA(),S0=zn.createContext({shouldForwardProp:void 0,styleSheet:LA,stylis:zd});S0.Consumer;zn.createContext(void 0);function $d(){return Pe.useContext(S0)}var BA=function(){function e(n,r){var o=this;this.inject=function(l,a){a===void 0&&(a=zd);var c=o.name+a.hash;l.hasNameForId(o.id,c)||l.insertRules(o.id,c,a(o.rules,c,"@keyframes"))},this.name=n,this.id="sc-keyframes-".concat(n),this.rules=r,sf(this,function(){throw Ks(12,String(o.name))})}return e.prototype.getName=function(n){return n===void 0&&(n=zd),this.name+n.hash},e}(),GA=function(e){return e>="A"&&e<="Z"};function Vg(e){for(var n="",r=0;r<e.length;r++){var o=e[r];if(r===1&&o==="-"&&e[0]==="-")return e;GA(o)?n+="-"+o.toLowerCase():n+=o}return n.startsWith("ms-")?"-"+n:n}var A0=function(e){return e==null||e===!1||e===""},T0=function(e){var n,r,o=[];for(var l in e){var a=e[l];e.hasOwnProperty(l)&&!A0(a)&&(Array.isArray(a)&&a.isCss||vo(a)?o.push("".concat(Vg(l),":"),a,";"):Fs(a)?o.push.apply(o,Ms(Ms(["".concat(l," {")],T0(a),!1),["}"],!1)):o.push("".concat(Vg(l),": ").concat((n=l,(r=a)==null||typeof r=="boolean"||r===""?"":typeof r!="number"||r===0||n in lA||n.startsWith("--")?String(r).trim():"".concat(r,"px")),";")))}return o};function Gi(e,n,r,o){if(A0(e))return[];if(of(e))return[".".concat(e.styledComponentId)];if(vo(e)){if(!vo(a=e)||a.prototype&&a.prototype.isReactComponent||!n)return[e];var l=e(n);return Gi(l,n,r,o)}var a;return e instanceof BA?r?(e.inject(r,o),[e.getName(o)]):[e]:Fs(e)?T0(e):Array.isArray(e)?Array.prototype.concat.apply(eu,e.map(function(c){return Gi(c,n,r,o)})):[e.toString()]}function I0(e){for(var n=0;n<e.length;n+=1){var r=e[n];if(vo(r)&&!of(r))return!1}return!0}var bA=d0(Jl),xA=function(){function e(n,r,o){this.rules=n,this.staticRulesId="",this.isStatic=(o===void 0||o.isStatic)&&I0(n),this.componentId=r,this.baseHash=io(bA,r),this.baseStyle=o,xl.registerId(r)}return e.prototype.generateAndInjectStyles=function(n,r,o){var l=this.baseStyle?this.baseStyle.generateAndInjectStyles(n,r,o):"";if(this.isStatic&&!o.hash)if(this.staticRulesId&&r.hasNameForId(this.componentId,this.staticRulesId))l=dr(l,this.staticRulesId);else{var a=bd(Gi(this.rules,n,r,o)),c=Gd(io(this.baseHash,a)>>>0);if(!r.hasNameForId(this.componentId,c)){var d=o(a,".".concat(c),void 0,this.componentId);r.insertRules(this.componentId,c,d)}l=dr(l,c),this.staticRulesId=c}else{for(var h=io(this.baseHash,o.hash),g="",m=0;m<this.rules.length;m++){var y=this.rules[m];if(typeof y=="string")g+=y;else if(y){var S=bd(Gi(y,n,r,o));h=io(h,S+m),g+=S}}if(g){var _=Gd(h>>>0);r.hasNameForId(this.componentId,_)||r.insertRules(this.componentId,_,o(g,".".concat(_),void 0,this.componentId)),l=dr(l,_)}}return l},e}(),af=zn.createContext(void 0);af.Consumer;var ad={};function zA(e,n,r){var o=of(e),l=e,a=!sd(e),c=n.attrs,d=c===void 0?eu:c,h=n.componentId,g=h===void 0?function(B,x){var U=typeof B!="string"?"sc":bg(B);ad[U]=(ad[U]||0)+1;var Y="".concat(U,"-").concat(f0(Jl+U+ad[U]));return x?"".concat(x,"-").concat(Y):Y}(n.displayName,n.parentComponentId):h,m=n.displayName,y=m===void 0?function(B){return sd(B)?"styled.".concat(B):"Styled(".concat(pA(B),")")}(e):m,S=n.displayName&&n.componentId?"".concat(bg(n.displayName),"-").concat(n.componentId):n.componentId||g,_=o&&l.attrs?l.attrs.concat(d).filter(Boolean):d,C=n.shouldForwardProp;if(o&&l.shouldForwardProp){var T=l.shouldForwardProp;if(n.shouldForwardProp){var E=n.shouldForwardProp;C=function(B,x){return T(B,x)&&E(B,x)}}else C=T}var M=new xA(r,S,o?l.componentStyle:void 0);function H(B,x){return function(U,Y,ae){var Ee=U.attrs,we=U.componentStyle,be=U.defaultProps,ke=U.foldedComponentIds,Ie=U.styledComponentId,ue=U.target,Ue=zn.useContext(af),ye=$d(),J=U.shouldForwardProp||ye.shouldForwardProp,z=l0(Y,Ue,be)||mo,j=function(he,re,Se){for(var ve,K=Ot(Ot({},re),{className:void 0,theme:Se}),te=0;te<he.length;te+=1){var Oe=vo(ve=he[te])?ve(K):ve;for(var ce in Oe)K[ce]=ce==="className"?dr(K[ce],Oe[ce]):ce==="style"?Ot(Ot({},K[ce]),Oe[ce]):Oe[ce]}return re.className&&(K.className=dr(K.className,re.className)),K}(Ee,Y,z),$=j.as||ue,R={};for(var F in j)j[F]===void 0||F[0]==="$"||F==="as"||F==="theme"&&j.theme===z||(F==="forwardedAs"?R.as=j.forwardedAs:J&&!J(F,$)||(R[F]=j[F]));var V=function(he,re){var Se=$d(),ve=he.generateAndInjectStyles(re,Se.styleSheet,Se.stylis);return ve}(we,j),ee=dr(ke,Ie);return V&&(ee+=" "+V),j.className&&(ee+=" "+j.className),R[sd($)&&!u0.has($)?"class":"className"]=ee,R.ref=ae,Pe.createElement($,R)}(D,B,x)}H.displayName=y;var D=zn.forwardRef(H);return D.attrs=_,D.componentStyle=M,D.displayName=y,D.shouldForwardProp=C,D.foldedComponentIds=o?dr(l.foldedComponentIds,l.styledComponentId):"",D.styledComponentId=S,D.target=o?l.target:e,Object.defineProperty(D,"defaultProps",{get:function(){return this._foldedDefaultProps},set:function(B){this._foldedDefaultProps=o?function(x){for(var U=[],Y=1;Y<arguments.length;Y++)U[Y-1]=arguments[Y];for(var ae=0,Ee=U;ae<Ee.length;ae++)xd(x,Ee[ae],!0);return x}({},l.defaultProps,B):B}}),sf(D,function(){return".".concat(D.styledComponentId)}),a&&m0(D,e,{attrs:!0,componentStyle:!0,displayName:!0,foldedComponentIds:!0,shouldForwardProp:!0,styledComponentId:!0,target:!0}),D}function Xg(e,n){for(var r=[e[0]],o=0,l=n.length;o<l;o+=1)r.push(n[o],e[o+1]);return r}var Kg=function(e){return Object.assign(e,{isCss:!0})};function E0(e){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];if(vo(e)||Fs(e))return Kg(Gi(Xg(eu,Ms([e],n,!0))));var o=e;return n.length===0&&o.length===1&&typeof o[0]=="string"?Gi(o):Kg(Gi(Xg(o,n)))}function Wd(e,n,r){if(r===void 0&&(r=mo),!n)throw Ks(1,n);var o=function(l){for(var a=[],c=1;c<arguments.length;c++)a[c-1]=arguments[c];return e(n,r,E0.apply(void 0,Ms([l],a,!1)))};return o.attrs=function(l){return Wd(e,n,Ot(Ot({},r),{attrs:Array.prototype.concat(r.attrs,l).filter(Boolean)}))},o.withConfig=function(l){return Wd(e,n,Ot(Ot({},r),l))},o}var w0=function(e){return Wd(zA,e)},Pn=w0;u0.forEach(function(e){Pn[e]=w0(e)});var $A=function(){function e(n,r){this.rules=n,this.componentId=r,this.isStatic=I0(n),xl.registerId(this.componentId+1)}return e.prototype.createStyles=function(n,r,o,l){var a=l(bd(Gi(this.rules,r,o,l)),""),c=this.componentId+n;o.insertRules(c,c,a)},e.prototype.removeStyles=function(n,r){r.clearRules(this.componentId+n)},e.prototype.renderStyles=function(n,r,o,l){n>2&&xl.registerId(this.componentId+n),this.removeStyles(n,o),this.createStyles(n,r,o,l)},e}();function WA(e){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];var o=E0.apply(void 0,Ms([e],n,!1)),l="sc-global-".concat(f0(JSON.stringify(o))),a=new $A(o,l),c=function(h){var g=$d(),m=zn.useContext(af),y=zn.useRef(g.styleSheet.allocateGSInstance(l)).current;return g.styleSheet.server&&d(y,h,g.styleSheet,m,g.stylis),zn.useLayoutEffect(function(){if(!g.styleSheet.server)return d(y,h,g.styleSheet,m,g.stylis),function(){return a.removeStyles(y,g.styleSheet)}},[y,h,g.styleSheet,m,g.stylis]),null};function d(h,g,m,y,S){if(a.isStatic)a.renderStyles(h,cA,m,S);else{var _=Ot(Ot({},g),{theme:l0(g,y,c.defaultProps)});a.renderStyles(h,_,m,S)}}return zn.memo(c)}function _0(e,n){var r=Pe.useRef(null),o=Pe.useRef(!1),l=Pe.useRef(e);l.current=e;var a=Pe.useCallback(function(d){o.current&&(l.current(d),r.current=requestAnimationFrame(a))},[]),c=Pe.useMemo(function(){return[function(){o.current&&(o.current=!1,r.current&&cancelAnimationFrame(r.current))},function(){o.current||(o.current=!0,r.current=requestAnimationFrame(a))},function(){return o.current}]},[]);return Pe.useEffect(function(){return c[0]},[]),c}function YA(e,n,r,o,l){var c;(c=e.onExit)==null||c.call(e,o,n);const a=l.find(({id:d})=>d===n);return a!=null&&a.onEnter?a.onEnter(o,r):{...r,enteredAt:o.updateContext.gameState.time}}function jA(e,n){return n.find(({id:r})=>r===e)}function VA(e,n){return e!==n}function XA(e){console.warn(`No handler found for state: ${e}`)}const Rs="bushGrowing",ur="bushFull",Ul="bushSpreading",Us="bushDying",Et=24,wt=10,Je=3e3,et=3e3,lf=2,KA=15,qA=5e3,ri=100,oi=20,si=60,QA=1e3,ZA=5,JA=3,eT=12,tT=940,Yd=20,qg=90,C0=45,R0=240,Hs=5,nT=.5,Qg=100,iT=300,tu=30,ai=.1,Is=.9,Be=1,fr=3,rT=70;function Re(e,n,r,o,l){const a={id:e.nextVisualEffectId,type:n,position:r,startTime:e.time,duration:o,entityId:l};return e.visualEffects.push(a),e.nextVisualEffectId++,a.id}var se=(e=>(e[e.Hunger=0]="Hunger",e[e.Procreation=1]="Procreation",e[e.Pregnant=2]="Pregnant",e[e.TargetAcquired=3]="TargetAcquired",e[e.Attack=4]="Attack",e[e.Partnered=5]="Partnered",e[e.BushClaimed=6]="BushClaimed",e[e.BushClaimLost=7]="BushClaimLost",e[e.Eating=8]="Eating",e[e.ChildFed=9]="ChildFed",e[e.AttackDeflected=10]="AttackDeflected",e[e.AttackResisted=11]="AttackResisted",e[e.Hit=12]="Hit",e[e.SeizeBuildup=13]="SeizeBuildup",e[e.Seize=14]="Seize",e[e.CallToAttack=15]="CallToAttack",e[e.CallToFollow=16]="CallToFollow",e[e.AutopilotMoveTarget=17]="AutopilotMoveTarget",e))(se||{}),li=(e=>(e.Berry="berry",e.Meat="meat",e))(li||{});const P0={berry:"",meat:""},oT={id:Rs,update:(e,n)=>{const{entity:r,updateContext:o}=n,l=o.deltaTime*(Et/wt);return r.age+=l,r.age>=r.lifespan?{nextState:Us,data:{...e,enteredAt:o.gameState.time}}:(r.ownerId&&r.claimedUntil&&o.gameState.time>r.claimedUntil&&(Re(o.gameState,se.BushClaimLost,r.position,Be),r.ownerId=void 0,r.claimedUntil=void 0),r.timeSinceLastBerryRegen+=l,r.timeSinceLastBerryRegen>=eT&&r.food.length<r.maxFood&&(r.food.push({type:li.Berry}),r.timeSinceLastBerryRegen=0),r.food.length>=r.maxFood?{nextState:ur,data:{...e,enteredAt:o.gameState.time,previousState:Rs}}:{nextState:Rs,data:e})},onEnter:(e,n)=>({...n,enteredAt:e.updateContext.gameState.time})},sT={id:ur,update:(e,n)=>{const{entity:r,updateContext:o}=n,l=o.deltaTime*(Et/wt);return r.age+=l,r.age>=r.lifespan?{nextState:Us,data:{...e,enteredAt:o.gameState.time,previousState:ur}}:r.food.length<r.maxFood?{nextState:Rs,data:{...e,enteredAt:o.gameState.time,previousState:ur}}:(r.ownerId&&r.claimedUntil&&o.gameState.time>r.claimedUntil&&(Re(o.gameState,se.BushClaimLost,r.position,Be),r.ownerId=void 0,r.claimedUntil=void 0),r.timeSinceLastSpreadAttempt+=l,r.timeSinceLastSpreadAttempt>=qg&&(r.timeSinceLastSpreadAttempt=0,o.gameState.time-r.timeSinceLastHarvest>=qg&&Math.random()<o.gameState.ecosystem.berryBushSpreadChance)?{nextState:Ul,data:{...e,enteredAt:o.gameState.time,previousState:ur}}:{nextState:ur,data:e})},onEnter:(e,n)=>({...n,enteredAt:e.updateContext.gameState.time})},Ls=1,Zg=150*.6,aT=150*.25,lT=150*.7,uT=150*.8,Jg=300,cT=600,N0=100,dT=250,fT=120,hT=2,pT=400,gT=1e3,mT=150*.85,vT=100,yT=3,ST=96,AT=24,TT=600,D0=600,IT=1,ET=24,wT=1,_T=.5,CT=2,jd=24,Vd=12,RT=24,em=24,PT=1500,ld=500,NT=400,DT=10,kT=-5,OT=1.5,MT=1.5,FT=1.2,UT=10,HT=150,LT=200,BT=100,GT=100,bT=.7,xT=300,zT=100,$T=120,tm=400,k0=.15,O0=200,Hl=30*.75*1.2,WT=20,nu=10,Bs=80,YT=3,hs=5,Ar=150,M0=Ar*.8,jT=Ar*.2,Tr=Ar*.95,xi=30,F0=10,VT=10,XT=.5,vt=30,Ir=vt*.75,U0=50,KT=20,qT=Bs*.8,QT=.7,ZT=16,H0=40,JT=24,uf=16,eI=72/3,nm=24,tI=1.25,nI=1.5,cf=Ar*.6,df=50,iI=1,rI=350,L0=Bs*.65,oI=80,sI=50,aI=1,lI=128,B0=10,im=100,ff=35,$n=vt,G0=.5,iu=2.5,uI=5,hf=.5,pf=1.5,cI=.1,dI=.5,fI=1.5,hI=.25,pI=2.5,gI=45,mI=.05;function Wn(e,n){return{x:e.x+n.x,y:e.y+n.y}}function b0(e,n){return{x:e.x-n.x,y:e.y-n.y}}function _t(e,n){return{x:e.x*n,y:e.y*n}}function yo(e){return Math.sqrt(e.x*e.x+e.y*e.y)}function tt(e){const n=yo(e);return n===0?{x:0,y:0}:_t(e,1/n)}function vI(e,n){return yo(b0(e,n))}function gf(e,n,r){return{x:e.x+(n.x-e.x)*r,y:e.y+(n.y-e.y)*r}}function mf(e){if(e.length===0)return{x:0,y:0};const n=e.reduce((r,o)=>({x:r.x+o.x,y:r.y+o.y}),{x:0,y:0});return{x:n.x/e.length,y:n.y/e.length}}function $e(e,n,r,o){let l=n.x-e.x,a=n.y-e.y;return Math.abs(l)>r/2&&(l=l-Math.sign(l)*r),Math.abs(a)>o/2&&(a=a-Math.sign(a)*o),{x:l,y:a}}function Kt(e,n,r){const o=$e(e,n,r.width,r.height);return tt(o)}function X(e,n,r,o){const l=$e(e,n,r,o);return yo(l)}function yI(e,n){return e.x*n.x+e.y*n.y}function SI(e,n){const r=yI(e,n),o=yo(e),l=yo(n);if(o===0||l===0)return 0;const a=Math.max(-1,Math.min(1,r/(o*l)));return Math.acos(a)}function AI(e,n,r){const o=Math.max(0,Math.min(1,r)),l={r:parseInt(e.substring(1,3),16),g:parseInt(e.substring(3,5),16),b:parseInt(e.substring(5,7),16)},a={r:parseInt(n.substring(1,3),16),g:parseInt(n.substring(3,5),16),b:parseInt(n.substring(5,7),16)},c=Math.round(l.r+(a.r-l.r)*o),d=Math.round(l.g+(a.g-l.g)*o),h=Math.round(l.b+(a.b-l.b)*o),g=m=>("00"+m.toString(16)).slice(-2);return`#${g(c)}${g(d)}${g(h)}`}var Gt=(e=>(e.Friendly="Friendly",e.Hostile="Hostile",e))(Gt||{}),Xt=(e=>(e[e.None=0]="None",e[e.General=1]="General",e[e.Performance=2]="Performance",e[e.Ecosystem=3]="Ecosystem",e))(Xt||{});function rm(e,n,r){return n.search.human.byRadius(e.position,r).filter(a=>{if(a.id===e.id||a.gender===e.gender||!a.isAdult||a.hunger>=Tr||(a.procreationCooldown||0)>0||a.gender==="female"&&a.isPregnant)return!1;const c=a.id===e.motherId||a.id===e.fatherId,d=e.id===a.motherId||e.id===a.fatherId;return!c&&!d})}function ui(e){if(e.length===0)return;const n=e.filter(l=>l.gender==="male"),r=e.filter(l=>l.gender==="female"),o=(l,a)=>l.age!==a.age?a.age-l.age:l.id-a.id;if(n.sort(o),n.length>0)return n[0];if(r.sort(o),r.length>0)return r[0]}function Ct(e,n){const r=e,o=r.search.human.byProperty("motherId",n.id),l=r.search.human.byProperty("fatherId",n.id);return[...o,...l]}function x0(e,n,r){var l;if(e.id===n.id||e.motherId===n.id||e.fatherId===n.id||n.motherId===e.id||n.fatherId===e.id||e.motherId&&e.motherId===n.motherId||e.fatherId&&e.fatherId===n.fatherId||(l=e.partnerIds)!=null&&l.includes(n.id))return!0;if(e.motherId){const a=r.entities.entities.get(e.motherId);if(a&&(a.motherId===n.id||a.fatherId===n.id))return!0}if(e.fatherId){const a=r.entities.entities.get(e.fatherId);if(a&&(a.motherId===n.id||a.fatherId===n.id))return!0}if(n.motherId){const a=r.entities.entities.get(n.motherId);if(a&&(a.motherId===e.id||a.fatherId===e.id))return!0}if(n.fatherId){const a=r.entities.entities.get(n.fatherId);if(a&&(a.motherId===e.id||a.fatherId===e.id))return!0}return!1}function Xd(e,n){var a,c,d,h;if(e.id===n.id||e.motherId===n.id||e.fatherId===n.id||n.motherId===e.id||n.fatherId===e.id||(a=e.partnerIds)!=null&&a.includes(n.id)||(c=n.partnerIds)!=null&&c.includes(e.id))return!0;if(e.fatherId===void 0&&e.motherId===void 0||n.fatherId===void 0&&n.motherId===void 0)return!1;const r=e.motherId===n.motherId||e.fatherId===n.fatherId,o=n.motherId===e.motherId||n.fatherId===e.fatherId,l=((d=e.ancestorIds)==null?void 0:d.some(g=>n.ancestorIds.includes(g)))||((h=n.ancestorIds)==null?void 0:h.some(g=>e.ancestorIds.includes(g)));return r||o||l}function TI(e,n){const r=[];if(e.motherId){const o=n.entities.entities.get(e.motherId);o&&r.push(o)}if(e.fatherId){const o=n.entities.entities.get(e.fatherId);o&&r.push(o)}return r}function II(e,n){if(e.gender!=="female"||!e.partnerIds||e.partnerIds.length===0)return null;for(const r of e.partnerIds){const o=n.entities.entities.get(r);if(o&&o.gender==="male")return o}return null}function EI(e,n){var r;if(!e.isAdult&&e.fatherId){const o=n.entities.entities.get(e.fatherId);if(o&&o.type==="human")return o}if(e.isAdult&&e.fatherId){const o=n.entities.entities.get(e.fatherId);if(o&&o.type==="human"&&((r=ui(Ct(n,o)))==null?void 0:r.id)===e.id)return o}return e.isAdult&&e.gender==="female"&&e.partnerIds&&e.partnerIds.length>0?II(e,n):null}function zl(e,n){var o;const r=new Set;if(e.motherId){const l=n.entities.entities.get(e.motherId);l&&r.add(l)}if(e.fatherId){const l=n.entities.entities.get(e.fatherId);l&&r.add(l)}return(o=e.partnerIds)==null||o.forEach(l=>{const a=n.entities.entities.get(l);a&&r.add(a)}),Ct(n,e).forEach(l=>r.add(l)),Array.from(r)}function z0(e,n){const r=new Map;function o(l){const a=Ct(n,l);for(const c of a)r.has(c.id)||(r.set(c.id,c),o(c))}return o(e),Array.from(r.values())}function Gs(e,n){return n.search.human.byProperty("leaderId",e)}function $0(e,n){var c,d;const r=new Map,o=Array.from(e.entities.entities.values()).filter(h=>h.type==="human");for(const h of o)h.leaderId&&(r.has(h.leaderId)||r.set(h.leaderId,{leaderId:h.leaderId,tribeBadge:h.tribeBadge||"?",members:[]}),(c=r.get(h.leaderId))==null||c.members.push(h));const l=n?(d=e.entities.entities.get(n))==null?void 0:d.diplomacy:void 0,a=Array.from(r.values()).map(h=>{const g=e.entities.entities.get(h.leaderId),m=h.members.filter(S=>S.isAdult).length,y=h.members.length-m;return{leaderId:h.leaderId,tribeBadge:h.tribeBadge,adultCount:m,childCount:y,isPlayerTribe:h.leaderId===n,leaderAge:(g==null?void 0:g.age)??0,leaderGender:(g==null?void 0:g.gender)??"male",diplomacyStatus:(l==null?void 0:l.get(h.leaderId??-1))??Gt.Friendly}});return a.sort((h,g)=>h.isPlayerTribe?-1:g.isPlayerTribe?1:g.adultCount+g.childCount-(h.adultCount+h.childCount)),a}function De(e,n,r,o,l){const a=n,c=o,d="position"in e&&e.id?e:null,h=d?d.position:e,g=a.search[r].byRadius(h,c);let m=null,y=c;for(const S of g){if(S.id===(d==null?void 0:d.id)||l&&!l(S))continue;const _=X(h,S.position,n.mapDimensions.width,n.mapDimensions.height);_<y&&(y=_,m=S)}return m}function W0(e,n,r,o){return n.search[r].byRadius(e,o)}function Y0(e,n,r,o){return W0(e,n,r,o).length}function yt(e){const r=e.search.human.byProperty("isPlayer",!0);return r.length>0?r[0]:void 0}function wI(e,n){var c;const o=n.search.human.byProperty("activeAction","attacking");let l=null,a=1/0;for(const d of o){if(d.attackTargetId!==e)continue;const h=X(d.position,((c=n.entities.entities.get(e))==null?void 0:c.position)||{x:0,y:0},n.mapDimensions.width,n.mapDimensions.height);h<a&&(l=d,a=h)}return l}function _I(e){return Array.from(e.entities.entities.values()).filter(n=>n.type==="human")}function CI(e,n,r){const o=Array.from(n.entities.entities.values()).reverse();for(const l of o)if(vI(e,l.position)<l.radius)return l}function vf(e,n,r,o){const l=Math.random()*Math.PI*2,a=Math.sqrt(Math.random())*n,c={x:Math.cos(l)*a,y:Math.sin(l)*a},d=Wn(e,c);return{x:(d.x%r+r)%r,y:(d.y%o+o)%o}}function So(e,n,r,o){const l=n,a={left:e.x-r,top:e.y-r,right:e.x+r,bottom:e.y+r},c=[...l.search.human.byRect(a),...l.search.berryBush.byRect(a),...l.search.corpse.byRect(a)];for(const d of c){if(o!==void 0&&d.id===o)continue;if(X(e,d.position,n.mapDimensions.width,n.mapDimensions.height)<r+d.radius)return!0}return!1}function yf(e,n,r,o,l){const a=n.mapDimensions.width,c=n.mapDimensions.height;if(!So(e,n,o,l))return e;const d=o;for(let h=d;h<=r;h+=d){const g=Math.ceil(2*Math.PI*h/d);for(let m=0;m<g;m++){const y=m/g*2*Math.PI,S={x:Math.cos(y)*h,y:Math.sin(y)*h},_=Wn(e,S),C={x:(_.x%a+a)%a,y:(_.y%c+c)%c};if(!So(C,n,o,l))return C}}return null}function Er(e,n){const r=Gs(e,n);if(r.length===0){const l=n.entities.entities.get(e);return l?l.position:{x:0,y:0}}const o=r.map(l=>l.position);return mf(o)}function om(e,n){const o=[...zl(e,n),e].map(l=>l.position);return mf(o)}function RI(e,n,r){return n.search.human.byRadius(e.position,r).filter(l=>{var a;return l.activeAction==="procreating"&&l.gender===e.gender&&typeof l.target=="number"&&((a=e.partnerIds)==null?void 0:a.includes(l.target))})[0]}function PI(e,n,r){if(!e.leaderId)return;const o=n,l=o.search.berryBush.byRadius(e.position,r).filter(a=>a.ownerId===e.id);for(const a of l)if(a.claimedUntil&&n.time<a.claimedUntil){const c=o.search.human.byRadius(a.position,vt);for(const d of c)if(!Xd(d,e)&&d.activeAction==="gathering"&&d.target===a.id)return d}}function NI(e,n,r){const o=zl(e,n),l=n;for(const a of o){if(X(e.position,a.position,n.mapDimensions.width,n.mapDimensions.height)>r)continue;const d=l.search.human.byProperty("attackTargetId",a.id);for(const h of d)if(h.leaderId!==e.leaderId)return{familyMember:a,aggressor:h}}}function DI(e,n){const o=n.search.human.byRadius(e.position,xT);let l,a=1/0;for(const c of o){if(c.id===e.id||c.hitpoints<=0||c.hitpoints/c.maxHitpoints>bT||x0(e,c,n))continue;const d=X(e.position,c.position,n.mapDimensions.width,n.mapDimensions.height);d<a&&(a=d,l=c)}return l}function kI(e,n){const r=De(e,n,"berryBush",Qg,l=>l.ownerId===e.id);return r?yf(r.position,n,Qg,tu,r.id):null}function Sf(e,n,r){return n.search.human.byRadius(e.position,r).filter(l=>Co(e,l,n))}function OI(e,n,r){const o=r.search.human.byProperty("leaderId",e);let l=0;for(const a of o)a.attackTargetId===n&&l++;return l}function sm(e,n,r,o){const l=r.search.berryBush.byRadius(e,n),a=r.search.human.byRadius(e,n).filter(h=>h.leaderId!==o);let c=l.length*DT;c+=a.length*kT;let d;if(a.length>0){const h={};for(const m of a)m.leaderId&&(h[m.leaderId]=(h[m.leaderId]||0)+1);let g=0;for(const m in h)h[m]>g&&(g=h[m],d=parseInt(m,10))}return{score:c,occupyingTribeId:d}}function $l(e){return e.filter(n=>n.isAdult).reduce((n,r)=>{let o=r.hitpoints;return o+=(r.maxAge-r.age)*.5,o+=r.food.length*2,n+o},0)}function MI(e,n){if(e.id!==e.leaderId)return null;const r=n,o=Er(e.id,n),{score:l}=sm(o,ld/2,r,e.id);let a=null,c=l;const d=NT,h=PT;for(let g=e.position.x-h;g<e.position.x+h;g+=d)for(let m=e.position.y-h;m<e.position.y+h;m+=d){const y={x:(g%n.mapDimensions.width+n.mapDimensions.width)%n.mapDimensions.width,y:(m%n.mapDimensions.height+n.mapDimensions.height)%n.mapDimensions.height};if(X(o,y,n.mapDimensions.width,n.mapDimensions.height)<ld*2)continue;const{score:_}=sm(y,ld/2,r,e.id);_>c*OT&&(c=_,a=y)}return a}const St=30,_o=St*.6,Af="#4CAF50",j0="#FF5722",V0="#9C27B0",FI="#2196F3",X0="#FFC107",UI="#FFD700",K0="#DC143C",Tf="#FFFFFF",If=[5,5],ru=5,Ao=15,HI=20,LI=16,BI=10,GI=16,bI=16,am=["","","","","","","","","",""],Kd=8,xI="#FFFFFF",fn=18,Ke=15,zI="rgba(0, 0, 0, 0.7)",$I=4,Di=150,en=15,Jn=10,ro="#555",WI="#f44336",YI="#4CAF50",jI="#2196F3",VI="#FFC107",dl=16,ir=32,fl=28,XI=10,KI=8,qI=8,QI=8,cn=28,hl=40,ZI="rgba(255, 215, 0, 0.7)",JI="rgba(0, 0, 0, 0.3)",Bn=10,lm=8,ud=11,ki=20,cd=40,um=5,eE=10,tE="#FFA500",nE="#808080",ii=120,q0=30,iE=20,cr="#2d3748",In="#ffffff",dd="#4a5568",Q0=5,Ef="#bdc9f792",Z0="#272c36ff",J0="#a0aec0",Wl=300,ev="rgba(255, 255, 255, 0.5)",rE="rgba(0, 0, 0, 0.8)",oE="#FFFFFF",cm=14,dm=8,fm=-15,tv="#FFD700",nv=5,sE=60,aE=-50,lE=10,fd=12,hm=10,uE="rgba(0, 0, 0, 0.5)",cE="#4CAF50",dE="#F44336",fE="#FFC107",hE="rgba(255, 255, 255, 0.2)",pm="#FFFFFF",pE="#FF6B6B",gE=5,iv=30,ps=50,pl=8,gm=10,mE="rgba(0, 0, 0, 0.5)",vE="#FFFFFF",yE=33,SE=400,AE=20,TE=10,IE="rgba(0, 0, 0, 0.7)",EE="#FFFFFF",hd=20,mm=16,wE=.5,vm=5,rv="#FFD700",_E=40,wf=4,ov=3,CE=5,sv=20,av=5,RE="#FFFFFF",PE="#FF6B6B",rr=80,gl=10,ml=300,or=15,NE=8,DE="rgba(0, 0, 0, 0.8)",kE="#FFFFFF",pd=14,ym=10,Gn=20,OE="#FF6B6B",ME="#4CAF50",Sm="#FFD700",FE="rgba(255, 255, 0, 0.3)",UE=2,HE=500,LE=120,BE=45,GE="#FFD700",bE=3,xE=4;let gd=0;function qd(){const e=am[gd];return gd=(gd+1)%am.length,e}const Am=40,zE=.3,$E=24,Tm=500,To=10,lv=250,bs=12,uv=10;var _e=(e=>(e.Gather="Gather",e.Eat="Eat",e.Procreate="Procreate",e.Attack="Attack",e.Plant="Plant",e.CallToAttack="CallToAttack",e.TribeSplit="TribeSplit",e.FollowMe="FollowMe",e.FeedChild="FeedChild",e.HuntPrey="HuntPrey",e.DefendAgainstPredator="DefendAgainstPredator",e.AutopilotMove="AutopilotMove",e.AutopilotGather="AutopilotGather",e.AutopilotAttack="AutopilotAttack",e.AutopilotProcreate="AutopilotProcreate",e.AutopilotPlant="AutopilotPlant",e.AutopilotFeedChild="AutopilotFeedChild",e.AutopilotFollowMe="AutopilotFollowMe",e))(_e||{});const ou={Gather:"",Eat:"",Procreate:"",Attack:"",Plant:"",CallToAttack:"",TribeSplit:"",FollowMe:"",FeedChild:"",HuntPrey:"",DefendAgainstPredator:"",AutopilotMove:"",AutopilotGather:"",AutopilotAttack:"",AutopilotProcreate:"",AutopilotPlant:"",AutopilotFeedChild:"",AutopilotFollowMe:""},cv={Gather:"Gather",Eat:"Eat",Procreate:"Procreate",Attack:"Attack",Plant:"Plant",CallToAttack:"Call to Attack",TribeSplit:"Split Tribe",FollowMe:"Follow Me",FeedChild:"Feed Child",HuntPrey:"Hunt Prey",DefendAgainstPredator:"Defend",AutopilotMove:"Walk",AutopilotGather:"Gather",AutopilotAttack:"Attack",AutopilotProcreate:"Procreate",AutopilotPlant:"Plant",AutopilotFeedChild:"Feed",AutopilotFollowMe:"Follow"};var eo=(e=>(e.Time="Time",e.Hunger="Hunger",e.Hitpoints="Hitpoints",e.Food="Food",e.Autopilot="Autopilot",e.Muted="Muted",e.Family="Family",e.Tribes="Tribes",e))(eo||{});const gs={Time:"",Hunger:"",Hitpoints:"",Food:"",Autopilot:"",Muted:"",Family:"",Tribes:""};var Ce=(e=>(e.ToggleMute="ToggleMute",e.TogglePause="TogglePause",e.FastForward="FastForward",e.DismissTutorial="DismissTutorial",e.ReturnToIntro="ReturnToIntro",e.ConfirmExitYes="ConfirmExitYes",e.ConfirmExitNo="ConfirmExitNo",e.CommandEat="CommandEat",e.CommandPlant="CommandPlant",e.CommandCallToAttack="CommandCallToAttack",e.CommandFollowMe="CommandFollowMe",e.CommandGather="CommandGather",e.CommandTribeSplit="CommandTribeSplit",e.ToggleProcreationBehavior="ToggleProcreationBehavior",e.ToggleAttackBehavior="ToggleAttackBehavior",e.ToggleFeedChildBehavior="ToggleFeedChildBehavior",e.TogglePlantingBehavior="TogglePlantingBehavior",e.ToggleGatheringBehavior="ToggleGatheringBehavior",e.ToggleAutopilotFollowLeaderBehavior="ToggleAutopilotFollowLeaderBehavior",e.ToggleDiplomacy="ToggleDiplomacy",e))(Ce||{});const WE=12,YE=24,jE=150*.9,VE=24;var xs=(e=>(e.Hello="HELLO",e.NewTribeFormed="NEW_TRIBE_FORMED",e.NoHeir="NO_HEIR",e.ChildrenStarving="CHILDREN_STARVING",e))(xs||{});let XE=0;function KE(){return`notification-${Date.now()}-${XE++}`}function Qd(e,n){if(n.identifier){const o=e.notifications.find(l=>l.identifier===n.identifier);if(o){if(o.dismissedUntil&&e.time<o.dismissedUntil)return;o.message=n.message,o.timestamp=e.time,o.creationTime=Date.now(),o.duration=n.duration,o.targetEntityIds=n.targetEntityIds,o.highlightedEntityIds=n.highlightedEntityIds,o.targetPosition=n.targetPosition,o.targetArea=n.targetArea,o.targetRadius=n.targetRadius,o.isDismissed=!1,o.dismissedUntil=void 0;return}}const r={...n,id:KE(),timestamp:e.time,creationTime:Date.now(),isDismissed:!1};e.notifications.push(r)}function qE(e,n){const r=e.notifications.find(o=>o.id===n);r&&(r.isDismissed=!0,r.identifier&&(r.dismissedUntil=e.time+VE))}function QE(e){const n=e.time;e.notifications=e.notifications.filter(r=>r.duration===0?!0:!(n-r.timestamp>r.duration))}const Im=600,ZE=1.5,dv=.1,md=""+new URL("attack-D4MA8VWK.mp3",import.meta.url).href,JE=""+new URL("gather-CU75596W.mp3",import.meta.url).href,ew=""+new URL("eat-DCjHq2QD.mp3",import.meta.url).href,vd=""+new URL("procreate-CfE4r5Cp.mp3",import.meta.url).href,tw=""+new URL("birth-Cbd67GHT.mp3",import.meta.url).href,nw=""+new URL("child-fed-DzEPuMid.mp3",import.meta.url).href,iw=""+new URL("human-death-B6HFLXES.mp3",import.meta.url).href,rw=""+new URL("game-over-C5dqkyER.mp3",import.meta.url).href,ow=""+new URL("button-click-DomLUeaU.mp3",import.meta.url).href,sw=""+new URL("soundtrack-1-BdlYUGye.mp3",import.meta.url).href;var Te=(e=>(e[e.Attack=0]="Attack",e[e.Gather=1]="Gather",e[e.Eat=2]="Eat",e[e.Procreate=3]="Procreate",e[e.Birth=4]="Birth",e[e.ChildFed=5]="ChildFed",e[e.HumanDeath=6]="HumanDeath",e[e.Seize=7]="Seize",e[e.CallToAttack=8]="CallToAttack",e[e.TribeSplit=9]="TribeSplit",e[e.CallToFollow=10]="CallToFollow",e[e.GameOver=11]="GameOver",e[e.ButtonClick=12]="ButtonClick",e[e.SoundTrack1=13]="SoundTrack1",e))(Te||{});const aw=new Map([[0,md],[1,JE],[2,ew],[3,vd],[4,tw],[5,nw],[6,iw],[11,rw],[12,ow],[7,md],[8,md],[9,vd],[10,vd],[13,sw]]);let ms,zs;function lw(){if(!(typeof window>"u"))return zs}function _f(){if(!(typeof window>"u"))return!ms&&typeof window.AudioContext=="function"&&(ms=new window.AudioContext,zs=ms.createGain(),zs.connect(ms.destination),Ps(.1,!1)),ms}function Ps(e,n){zs&&(zs.gain.value=n?0:e/10)}const fv=new Map;let vl=!1,Em=!1;async function uw(){if(Em||vl)return;const e=_f();if(!e){console.error("AudioContext not supported. Cannot load sounds.");return}e.state==="suspended"&&e.resume(),vl=!0,console.log("Starting sound loading...");const n=[];aw.forEach((r,o)=>{const l=fetch(r).then(a=>{if(!a.ok)throw new Error(`Failed to fetch sound: ${r}`);return a.arrayBuffer()}).then(a=>e.decodeAudioData(a)).then(a=>{fv.set(o,a)}).catch(a=>{console.error(`Error loading sound ${Te[o]} from ${r}:`,a)});n.push(l)});try{await Promise.all(n),Em=!0,vl=!1,console.log("All sounds loaded successfully.")}catch(r){vl=!1,console.error("An error occurred while loading sounds:",r)}}const Ns=new Map;function Cf(e,n){const r=_f(),o=lw();if(!r||!o||o.gain.value===0&&(n==null?void 0:n.trackId)===void 0)return;r.state==="suspended"&&r.resume();const l=fv.get(e);if(!l){console.warn(`Sound buffer not found for type: ${Te[e]}`);return}if(n!=null&&n.trackId&&Ns.has(n.trackId))return;const a=r.createBufferSource();a.buffer=l,a.loop=(n==null?void 0:n.loop)??!1;const c=r.createGain(),d=r.createStereoPanner();let h=c;if(n!=null&&n.position&&(n!=null&&n.listenerPosition)&&(n!=null&&n.worldDimensions)){const g=$e(n.listenerPosition,n.position,n.worldDimensions.width,n.worldDimensions.height),m=X(n.listenerPosition,n.position,n.worldDimensions.width,n.worldDimensions.height);if(m>Im)return;const y=1-Math.pow(m/Im,ZE);c.gain.value=Math.max(0,y);const S=Math.sin(g.x/m*(Math.PI/2));d.pan.value=isNaN(S)?0:S,c.connect(d),h=d}else{const g=e===Te.GameOver?.4:e===Te.SoundTrack1?1:.2;c.gain.value=g}a.connect(h),h.connect(o),a.start(0),n!=null&&n.trackId&&(Ns.set(n.trackId,{sourceNode:a,gainNode:c}),a.onended=()=>{Ns.delete(n.trackId)})}function wm(e,n=1){const r=Ns.get(e),o=_f();if(r&&o){const{sourceNode:l,gainNode:a}=r,c=o.currentTime;a.gain.setValueAtTime(a.gain.value,c),a.gain.linearRampToValueAtTime(0,c+n),l.stop(c+n),l.onended=null,Ns.delete(e)}}function Me(e,n,r){const o=yt(e.gameState);o&&Cf(n,{position:r,listenerPosition:o.position,worldDimensions:e.gameState.mapDimensions,masterVolume:e.gameState.masterVolume,isMuted:e.gameState.isMuted})}function cw(e,n,r){const o=r.mapDimensions.width,l=r.mapDimensions.height,a=n.radius*2;for(let c=Tm;c<o/2;c+=50)for(let d=0;d<10;d++){const h=vf(e,c,o,l);if(!(X(e,h,o,l)<Tm)&&!So(h,r,a,n.id))return h}return null}function Rf(e,n){if(!e.isAdult||e.gender!=="male"||e.leaderId===e.id||!e.leaderId)return{canSplit:!1};if(!e.leaderId)return{canSplit:!1};const r=n.entities.entities.get(e.leaderId);if(!r||r.type!=="human")return{canSplit:!1};const o=ui(Ct(n,r));if(o&&o.id===e.id)return{canSplit:!1};const l=Gs(e.leaderId,n);if(l.length<Am)return{canSplit:!1};const c=z0(e,n).length+1,d=Math.min(l.length*zE,Am);return{canSplit:c>=d,progress:c/d}}function Pf(e,n){var c;if(!Rf(e,n).canSplit)return;const r=e.leaderId?n.entities.entities.get(e.leaderId):void 0,o=qd(),l=z0(e,n);e.leaderId=e.id,e.tribeBadge=o,e.diplomacy=new Map,r&&((c=r.diplomacy)==null||c.set(e.id,Gt.Hostile));for(const d of l)d.leaderId=e.id,d.tribeBadge=o;Qd(n,{type:xs.NewTribeFormed,message:`A new tribe has formed! ${o}`,duration:YE,targetEntityIds:[e.id],highlightedEntityIds:[e.id,...l.map(d=>d.id)]}),Me({gameState:n},Te.TribeSplit,e.position)}function Nf(e,n){const r=[];if(n.food.length>0&&n.hunger>xi&&r.push({type:_e.Eat,action:"eating",key:"f"}),n.food.length<n.maxFood){const a=De(n,e,"berryBush",vt,h=>h.food.length>0),c=De(n,e,"corpse",vt,h=>h.food.length>0);let d=null;a&&c?d=X(n.position,a.position,e.mapDimensions.width,e.mapDimensions.height)<=X(n.position,c.position,e.mapDimensions.width,e.mapDimensions.height)?a:c:d=a||c,d&&r.push({type:_e.Gather,action:"gathering",key:"e",targetEntity:d})}const o=De(n,e,"human",vt,a=>wr(n,a,e));if(o&&r.push({type:_e.Procreate,action:"procreating",key:"r",targetEntity:o}),n.food.length>0&&n.isAdult){const a=De(n,e,"human",vt,c=>{const d=c;return!d.isAdult&&(d.motherId===n.id||d.fatherId===n.id)&&d.hunger>=xi});a&&r.push({type:_e.FeedChild,action:"feeding",key:"h",targetEntity:a})}const l=De(n,e,"human",$n,a=>Co(n,a,e))??De(n,e,"predator",$n)??De(n,e,"prey",$n);return l&&r.push({type:_e.Attack,action:"attacking",key:"q",targetEntity:l}),n.food.filter(a=>a.type===li.Berry).length>=Hs&&r.push({type:_e.Plant,action:"planting",key:"b"}),n.leaderId===n.id&&!n.isCallingToAttack&&Sf(n,e,lv).length>0&&r.push({type:_e.CallToAttack,action:"idle",key:"v"}),Rf(n,e).canSplit&&r.push({type:_e.TribeSplit,action:"idle",key:"k"}),n.leaderId===n.id&&!n.isCallingToFollow&&r.push({type:_e.FollowMe,action:"idle",key:"c"}),r}const Co=(e,n,r)=>{var o,l,a,c;if(e.id===n.id)return!1;if(e.leaderId&&!n.leaderId)return!0;if(e.leaderId===n.leaderId)return!1;if(e.leaderId&&n.leaderId){const d=(l=(o=r.entities.entities.get(e.leaderId))==null?void 0:o.diplomacy)==null?void 0:l.get(n.leaderId),h=(c=(a=r.entities.entities.get(n.leaderId))==null?void 0:a.diplomacy)==null?void 0:c.get(e.leaderId);return d===Gt.Hostile||h===Gt.Hostile}return!1},wr=(e,n,r)=>{if(e.id===n.id||e.gender===n.gender||!e.isAdult||!n.isAdult||e.hunger>=Tr||n.hunger>=Tr||(e.procreationCooldown||0)>0||(n.procreationCooldown||0)>0||Co(e,n,r))return!1;const o=e.gender==="female"?e:n;return!(o.isPregnant||o.age>H0)},dw={id:Ul,update:(e,n)=>{const{entity:r,updateContext:o}=n,{gameState:l}=o,a=o.deltaTime*(Et/wt);if(r.age+=a,r.age>=r.lifespan)return{nextState:Us,data:{...e,enteredAt:l.time,previousState:Ul}};const c=vf(r.position,r.spreadRadius,l.mapDimensions.width,l.mapDimensions.height);return So(c,l,15)||Zs(l.entities,c,l.time),{nextState:ur,data:{...e,enteredAt:l.time,previousState:Ul}}},onEnter:(e,n)=>({...n,enteredAt:e.updateContext.gameState.time})},fw={id:Us,update:e=>({nextState:Us,data:e}),onEnter:(e,n)=>(Js(e.updateContext.gameState.entities,e.entity.id),{...n,enteredAt:e.updateContext.gameState.time})},hw=[oT,sT,dw,fw],It="humanIdle",lr="humanMoving",Es="humanEating",su="humanGathering",$s="humanProcreating",zi="humanAttacking",Ll="humanPlanting",pw={id:It,update:(e,n)=>{const{entity:r,updateContext:o}=n;return r.activeAction==="attacking"&&r.attackTargetId?{nextState:zi,data:{...e,enteredAt:o.gameState.time,previousState:It,attackTargetId:r.attackTargetId,attackStartTime:o.gameState.time}}:(r.hunger>=M0?(r.debuffs=r.debuffs.filter(l=>l.type!=="slow"),r.debuffs.push({type:"slow",startTime:o.gameState.time,duration:.1})):r.debuffs=r.debuffs.filter(l=>l.type!=="slow"),r.activeAction==="moving"?{nextState:lr,data:{...e,enteredAt:o.gameState.time,previousState:It,target:r.target}}:r.activeAction==="gathering"?{nextState:su,data:{...e,enteredAt:o.gameState.time,previousState:It,target:r.target}}:r.activeAction==="eating"?{nextState:Es,data:{...e,enteredAt:o.gameState.time,previousState:It}}:r.activeAction==="planting"&&r.target?{nextState:Ll,data:{...e,enteredAt:o.gameState.time,previousState:It,plantingSpot:r.target}}:{nextState:It,data:e})},onEnter:(e,n)=>(e.entity.acceleration=0,e.entity.velocity={x:0,y:0},{...n,enteredAt:e.updateContext.gameState.time})};function hv(e){let n=VT;return e.hunger>=M0&&(n*=XT),e.age>=qT&&(n*=QT),e.movementSlowdown&&(n*=e.movementSlowdown.modifier),n}const yd=7.5;class gw{constructor(){me(this,"id",lr)}update(n,r){var h;const{entity:o,updateContext:l}=r;if(o.activeAction==="attacking"&&o.attackTargetId)return{nextState:zi,data:{...n,enteredAt:l.gameState.time,previousState:lr,attackTargetId:o.attackTargetId,attackStartTime:l.gameState.time}};if(o.activeAction!=="moving")return{nextState:It,data:{...n,enteredAt:l.gameState.time,previousState:lr}};let a;if(typeof o.target=="object"?a=o.target:typeof o.target=="number"&&(a=(h=r.updateContext.gameState.entities.entities.get(o.target))==null?void 0:h.position),!a&&(o.direction.x!==0||o.direction.y!==0)&&(a={x:o.position.x+o.direction.x*yd*2,y:o.position.y+o.direction.y*yd*2}),!a)return{nextState:It,data:{...n,enteredAt:l.gameState.time,previousState:lr}};const c=$e(o.position,a,r.updateContext.gameState.mapDimensions.width,r.updateContext.gameState.mapDimensions.height);return o.direction=tt(c),o.acceleration=hv(o),X(o.position,a,l.gameState.mapDimensions.width,l.gameState.mapDimensions.height)<yd?{nextState:It,data:{...n,enteredAt:l.gameState.time,previousState:lr}}:{nextState:lr,data:n}}onExit(n){const{entity:r}=n;r.acceleration=0}}const mw=new gw,vw={id:Es,update:(e,n)=>{const{entity:r,updateContext:o}=n;return r.activeAction!=="eating"?{nextState:It,data:{...e,enteredAt:o.gameState.time,previousState:Es}}:(r.food.length>0&&(!r.eatingCooldownTime||o.gameState.time>=r.eatingCooldownTime)&&r.hunger>xi&&(r.hunger=Math.max(0,r.hunger-xi),r.food.pop(),r.eatingCooldownTime=o.gameState.time+1,Me(o,Te.Eat,r.position),(!r.lastEatingEffectTime||o.gameState.time-r.lastEatingEffectTime>2)&&(Re(o.gameState,se.Eating,r.position,Be,r.id),r.lastEatingEffectTime=o.gameState.time)),r.hunger<=0||r.food.length<=0?{nextState:It,data:{...e,enteredAt:o.gameState.time,previousState:Es}}:{nextState:Es,data:e})},onEnter:(e,n)=>(e.entity.acceleration=0,e.entity.velocity={x:0,y:0},{...n,enteredAt:e.updateContext.gameState.time})};class yw{constructor(){me(this,"id",su)}update(n,r){return r.entity.activeAction!=="gathering"?{nextState:"humanIdle",data:{...n,enteredAt:r.updateContext.gameState.time,previousState:this.id}}:{nextState:this.id,data:n}}}const Sw=new yw,Aw=(e,n)=>(n.procreationEndTime=e.updateContext.gameState.time+(n.duration||2),n),Tw=(e,n)=>{const{entity:r,updateContext:o}=n,{gameState:l}=o;if(l.time<(e.procreationEndTime||0))return{nextState:$s,data:e};const a=l.entities.entities.get(e.partnerId);if(a&&a.type==="human"&&!a.isPregnant&&r.hunger<Tr&&a.hunger<Tr&&!r.procreationCooldown&&!a.procreationCooldown){const c=r.gender==="female"?r:a.gender==="female"?a:void 0,d=r.gender==="male"?r:a.gender==="male"?a:void 0;c&&d&&(c.isPregnant=!0,c.gestationTime=eI,c.pregnancyFatherId=d.id,r.procreationCooldown=nm,a.procreationCooldown=nm,Me(o,Te.Procreate,c.position))}return r.activeAction="idle",a&&(a.activeAction="idle"),{nextState:It,data:{...e,enteredAt:l.time,previousState:$s}}},Iw={id:$s,onEnter:Aw,update:Tw},Ew={id:zi,onEnter:(e,n)=>({...n,enteredAt:e.updateContext.gameState.time,attackStartTime:e.updateContext.gameState.time}),update:(e,n)=>{if(n.entity.activeAction!=="attacking"||!n.entity.attackTargetId)return n.entity.activeAction="idle",{nextState:It,data:{...e}};const r=n.updateContext.gameState.entities.entities.get(n.entity.attackTargetId);if(!r)return n.entity.activeAction="idle",{nextState:It,data:{...e}};const o=X(n.entity.position,r.position,n.updateContext.gameState.mapDimensions.width,n.updateContext.gameState.mapDimensions.height),l=$e(n.entity.position,r.position,n.updateContext.gameState.mapDimensions.width,n.updateContext.gameState.mapDimensions.height);return n.entity.direction=tt(l),o>$n?n.entity.acceleration=hv(n.entity):n.entity.acceleration=0,{nextState:zi,data:e}}},ww={id:Ll,update:(e,n)=>{const{entity:r,updateContext:o}=n,{gameState:l}=o;if(l.time-e.enteredAt>=nT){if(r.food.filter(d=>d.type===li.Berry).length>=Hs){for(let h=0;h<Hs;h++){const g=r.food.findIndex(m=>m.type===li.Berry);g>-1&&r.food.splice(g,1)}const d=Zs(l.entities,e.plantingSpot,l.time);d.ownerId=r.id,d.claimedUntil=l.time+R0}return{nextState:It,data:{...e,enteredAt:l.time,previousState:Ll}}}return{nextState:Ll,data:e}},onEnter:(e,n)=>(e.entity.acceleration=0,e.entity.velocity={x:0,y:0},{...n,enteredAt:e.updateContext.gameState.time})},_w=[pw,mw,vw,Sw,Iw,Ew,ww],En="preyIdle",Hi="preyMoving",ws="preyGrazing",_s="preyProcreating",Cw={id:En,update:(e,n)=>{const{entity:r,updateContext:o}=n;return r.activeAction==="moving"?{nextState:Hi,data:{...e,enteredAt:o.gameState.time,previousState:En,target:r.target}}:r.activeAction==="grazing"?{nextState:ws,data:{...e,enteredAt:o.gameState.time,previousState:En}}:r.activeAction==="procreating"?{nextState:_s,data:{...e,enteredAt:o.gameState.time,previousState:En}}:{nextState:En,data:e}},onEnter:(e,n)=>(e.entity.acceleration=0,e.entity.velocity={x:0,y:0},{...n,enteredAt:e.updateContext.gameState.time})},pv=12,Rw=120,_m=50,Pw=12,gv=30,Nw=2,bt=50,Dw=150,Ds=2,Sd=8,kw=.5,Ow=1,Mw=80,Fw=.7,mv=20,Uw=140,Cm=40,Hw=12,vv=40,Lw=3,bi=60,wn=40,to=50,Rm=320,yv=25,Bw=60,Sv=2,Gw=90,bw=.7,xw=1.5,ks=3,Ad=15,Df=80,Av=10,au=80,Ro=40,Tv=2,Yl=30,oo=10,pr=40,so=12,gr=48,ao=12,mr=50,lo=18,vr=60,uo=.5,Li=2.5,co=.25,Bi=2;function zw(e){let n=Pw;return e.isAdult||(n*=.7),e.hunger>=Mw&&(n*=Fw),e.movementSlowdown&&(n*=e.movementSlowdown.modifier),n}function $w(e,n){const r=e>>16&255,o=e>>8&255,l=e&255,a=n>>16&255,c=n>>8&255,d=n&255;let h=Math.floor((r+a)/2),g=Math.floor((o+c)/2),m=Math.floor((l+d)/2);return Math.random()<.05&&(h=Math.max(0,Math.min(255,h+(Math.random()-.5)*60))),Math.random()<.05&&(g=Math.max(0,Math.min(255,g+(Math.random()-.5)*60))),Math.random()<.05&&(m=Math.max(0,Math.min(255,m+(Math.random()-.5)*60))),h<<16|g<<8|m}function Ws(){const e=Math.floor(Math.random()*100)+100,n=Math.floor(Math.random()*80)+60,r=Math.floor(Math.random()*60)+20;return e<<16|n<<8|r}const Td=10;class Ww{constructor(){me(this,"id",Hi)}update(n,r){var h;const{entity:o,updateContext:l}=r;if(o.activeAction!=="moving")return{nextState:En,data:{...n,enteredAt:l.gameState.time,previousState:Hi}};let a;if(typeof o.target=="object"?a=o.target:typeof o.target=="number"&&(a=(h=r.updateContext.gameState.entities.entities.get(o.target))==null?void 0:h.position),!a&&(o.direction.x!==0||o.direction.y!==0)&&(a={x:o.position.x+o.direction.x*Td*2,y:o.position.y+o.direction.y*Td*2}),!a)return{nextState:En,data:{...n,enteredAt:l.gameState.time,previousState:Hi}};const c=$e(o.position,a,r.updateContext.gameState.mapDimensions.width,r.updateContext.gameState.mapDimensions.height);return o.direction=tt(c),o.acceleration=zw(o),X(o.position,a,l.gameState.mapDimensions.width,l.gameState.mapDimensions.height)<Td?{nextState:En,data:{...n,enteredAt:l.gameState.time,previousState:Hi}}:{nextState:Hi,data:n}}onExit(n){const{entity:r}=n;r.acceleration=0}onEnter(n,r){return{...r,enteredAt:n.updateContext.gameState.time}}}const Yw=new Ww,jw={id:ws,update:(e,n)=>{const{entity:r,updateContext:o}=n;return r.activeAction==="moving"?{nextState:Hi,data:{...e,enteredAt:o.gameState.time,previousState:ws,target:r.target}}:r.activeAction!=="grazing"?{nextState:En,data:{...e,enteredAt:o.gameState.time,previousState:ws}}:{nextState:ws,data:e}},onEnter:(e,n)=>(e.entity.acceleration=0,e.entity.velocity={x:0,y:0},{...n,enteredAt:e.updateContext.gameState.time})},Vw={id:_s,update:(e,n)=>{const{entity:r,updateContext:o}=n;return r.activeAction==="moving"?{nextState:Hi,data:{...e,enteredAt:o.gameState.time,previousState:_s,target:r.target}}:r.activeAction!=="procreating"?{nextState:En,data:{...e,enteredAt:o.gameState.time,previousState:_s}}:{nextState:_s,data:e}},onEnter:(e,n)=>(e.entity.acceleration=0,e.entity.velocity={x:0,y:0},{...n,enteredAt:e.updateContext.gameState.time})},Xw=[Cw,Yw,jw,Vw],Bt="predatorIdle",Fi="predatorMoving",ni="predatorAttacking",no="predatorProcreating",yr="predatorEating",Kw={id:Bt,update:(e,n)=>{const{entity:r,updateContext:o}=n;return r.activeAction==="eating"?{nextState:yr,data:{...e,enteredAt:o.gameState.time,previousState:Bt,preyId:r.attackTargetId,eatingStartTime:o.gameState.time}}:r.activeAction==="attacking"&&r.attackTargetId?{nextState:ni,data:{...e,enteredAt:o.gameState.time,previousState:Bt,attackTargetId:r.attackTargetId,attackStartTime:o.gameState.time}}:r.activeAction==="moving"?{nextState:Fi,data:{...e,enteredAt:o.gameState.time,previousState:Bt,target:r.target}}:r.activeAction==="procreating"?{nextState:no,data:{...e,enteredAt:o.gameState.time,previousState:Bt}}:{nextState:Bt,data:e}},onEnter:(e,n)=>(e.entity.acceleration=0,e.entity.velocity={x:0,y:0},{...n,enteredAt:e.updateContext.gameState.time})};function Iv(e){let n=Hw;return e.hunger>=Gw&&(n*=bw),e.isAdult||(n*=.7),e.movementSlowdown&&(n*=e.movementSlowdown.modifier),n}function qw(e,n){const r=e>>16&255,o=e>>8&255,l=e&255,a=n>>16&255,c=n>>8&255,d=n&255;let h=Math.floor((r+a)/2),g=Math.floor((o+c)/2),m=Math.floor((l+d)/2);return Math.random()<.05&&(h=Math.max(0,Math.min(255,h+(Math.random()-.5)*60))),Math.random()<.05&&(g=Math.max(0,Math.min(255,g+(Math.random()-.5)*60))),Math.random()<.05&&(m=Math.max(0,Math.min(255,m+(Math.random()-.5)*60))),h<<16|g<<8|m}function Ys(){const e=Math.floor(Math.random()*60)+60,n=Math.floor(Math.random()*50)+40,r=Math.floor(Math.random()*40)+20;return e<<16|n<<8|r}const Id=12;class Qw{constructor(){me(this,"id",Fi)}update(n,r){var h;const{entity:o,updateContext:l}=r;if(o.activeAction==="eating")return{nextState:yr,data:{...n,enteredAt:l.gameState.time,previousState:Fi,preyId:o.attackTargetId,eatingStartTime:l.gameState.time}};if(o.activeAction==="attacking"&&o.attackTargetId)return{nextState:ni,data:{...n,enteredAt:l.gameState.time,previousState:Fi,attackTargetId:o.attackTargetId,attackStartTime:l.gameState.time}};if(o.activeAction!=="moving")return{nextState:Bt,data:{...n,enteredAt:l.gameState.time,previousState:Fi}};let a;if(typeof o.target=="object"?a=o.target:typeof o.target=="number"&&(a=(h=r.updateContext.gameState.entities.entities.get(o.target))==null?void 0:h.position),!a&&(o.direction.x!==0||o.direction.y!==0)&&(a={x:o.position.x+o.direction.x*Id*2,y:o.position.y+o.direction.y*Id*2}),!a)return{nextState:Bt,data:{...n,enteredAt:l.gameState.time,previousState:Fi}};const c=$e(o.position,a,r.updateContext.gameState.mapDimensions.width,r.updateContext.gameState.mapDimensions.height);return o.direction=tt(c),o.acceleration=Iv(o),X(o.position,a,l.gameState.mapDimensions.width,l.gameState.mapDimensions.height)<Id?{nextState:Bt,data:{...n,enteredAt:l.gameState.time,previousState:Fi}}:{nextState:Fi,data:n}}onExit(n){const{entity:r}=n;r.acceleration=0}onEnter(n,r){return{...r,enteredAt:n.updateContext.gameState.time}}}const Zw=new Qw,Jw={id:ni,update:(e,n)=>{const{entity:r,updateContext:o}=n;if(r.activeAction==="eating")return{nextState:yr,data:{...e,enteredAt:o.gameState.time,previousState:ni,preyId:r.attackTargetId,eatingStartTime:o.gameState.time}};if(r.activeAction!=="attacking"||!r.attackTargetId)return r.activeAction="idle",{nextState:Bt,data:{...e,enteredAt:o.gameState.time,previousState:ni}};const l=o.gameState.entities.entities.get(r.attackTargetId);if(!l)return r.activeAction="idle",{nextState:Bt,data:{...e,enteredAt:o.gameState.time,previousState:ni}};if(l.type==="prey"&&l.hitpoints<=0||l.type==="predator"&&l.hitpoints<=0||l.type==="human"&&l.hitpoints<=0)return r.activeAction="idle",{nextState:Bt,data:{...e,enteredAt:o.gameState.time,previousState:ni}};const c=X(r.position,l.position,o.gameState.mapDimensions.width,o.gameState.mapDimensions.height),d=$e(r.position,l.position,o.gameState.mapDimensions.width,o.gameState.mapDimensions.height);return r.direction=tt(d),c>wn?r.acceleration=Iv(r):r.acceleration=0,{nextState:ni,data:e}},onEnter:(e,n)=>({...n,enteredAt:e.updateContext.gameState.time})},e_={id:no,update:(e,n)=>{const{entity:r,updateContext:o}=n;return r.activeAction==="eating"?{nextState:yr,data:{...e,enteredAt:o.gameState.time,previousState:no,preyId:r.attackTargetId,eatingStartTime:o.gameState.time}}:r.activeAction==="attacking"&&r.attackTargetId?{nextState:ni,data:{...e,enteredAt:o.gameState.time,previousState:no,attackTargetId:r.attackTargetId,attackStartTime:o.gameState.time}}:r.activeAction!=="procreating"?{nextState:Bt,data:{...e,enteredAt:o.gameState.time,previousState:no}}:{nextState:no,data:e}},onEnter:(e,n)=>(e.entity.acceleration=0,e.entity.velocity={x:0,y:0},{...n,enteredAt:e.updateContext.gameState.time})},t_={id:yr,update:(e,n)=>{const{entity:r,updateContext:o}=n;return r.activeAction!=="eating"?{nextState:Bt,data:{...e,enteredAt:o.gameState.time,previousState:yr}}:{nextState:yr,data:e}},onEnter:(e,n)=>(e.entity.acceleration=0,e.entity.velocity={x:0,y:0},{...n,enteredAt:e.updateContext.gameState.time})},n_=[Kw,Zw,Jw,e_,t_],Pm=[...hw,..._w,...Xw,...n_];function i_(e,n,r){const o=jA(e,Pm);if(!o)return XA(e),[e,n];const{nextState:l,data:a}=o.update(n,r);return VA(e,l)?[l,YA(o,l,a,r,Pm)]:[l,a]}function r_(e,n,r){const{gameState:o}=n,l=r*(Et/wt);if(e.isAdult=e.age>=uf,e.isCallingToAttack&&e.callToAttackEndTime&&o.time>e.callToAttackEndTime&&(e.isCallingToAttack=!1,e.callToAttackEndTime=void 0),e.isCallingToFollow&&e.callToFollowEndTime&&o.time>e.callToFollowEndTime&&(e.isCallingToFollow=!1,e.callToFollowEndTime=void 0),e.movementSlowdown&&o.time>e.movementSlowdown.endTime&&(e.movementSlowdown=void 0),e.hitpoints<e.maxHitpoints){const c=1-e.hunger/100*dI,d=cI*c*l;e.hitpoints=Math.min(e.maxHitpoints,e.hitpoints+d)}if(e.hunger+=r*(hs/(Et/wt)),e.hunger>rT&&(!e.lastHungerEffectTime||o.time-e.lastHungerEffectTime>fr*2)&&(Re(o,se.Hunger,e.position,fr,e.id),e.lastHungerEffectTime=o.time),e.age+=r/nu,e.isPlayer){const c=Ct(o,e).filter(d=>d.hunger>=jE);if(c.length>0){const d=c.map(h=>h.id);Qd(o,{identifier:"children_starving",type:xs.ChildrenStarving,message:"Your children are starving!",duration:WE,targetEntityIds:d,highlightedEntityIds:d})}}if(e.gender==="female"&&e.isPregnant&&e.gestationTime&&(e.gestationTime-=l,e.hunger+=r*((hs*tI-hs)/(Et/wt)),(!e.lastPregnantEffectTime||o.time-e.lastPregnantEffectTime>fr*3)&&(Re(o,se.Pregnant,e.position,fr,e.id),e.lastPregnantEffectTime=o.time),e.gestationTime<=0&&(fC(e,e.pregnancyFatherId,n),e.isPregnant=!1,e.gestationTime=0,e.pregnancyFatherId=void 0)),e.procreationCooldown&&(e.procreationCooldown-=l,e.procreationCooldown<0&&(e.procreationCooldown=0)),e.attackCooldown&&(e.attackCooldown-=l,e.attackCooldown<0&&(e.attackCooldown=0)),e.feedParentCooldownTime&&(e.feedParentCooldownTime-=l,e.feedParentCooldownTime<0&&(e.feedParentCooldownTime=0)),e.feedChildCooldownTime&&(e.feedChildCooldownTime-=l,e.feedChildCooldownTime<0&&(e.feedChildCooldownTime=0)),e.leaderMetaStrategyCooldown&&(e.leaderMetaStrategyCooldown-=l,e.leaderMetaStrategyCooldown<0&&(e.leaderMetaStrategyCooldown=0)),e.isAdult?e.radius===_o&&(e.radius=St):e.hunger+=r*((hs*nI-hs)/(Et/wt)),e.isAdult&&e.food.length>0&&(!e.feedParentCooldownTime||e.feedParentCooldownTime<=0)){const c=[];if(e.motherId){const d=o.entities.entities.get(e.motherId);d&&c.push(d)}if(e.fatherId){const d=o.entities.entities.get(e.fatherId);d&&c.push(d)}for(const d of c)if(d.age>=L0&&d.hunger>=oI&&X(e.position,d.position,o.mapDimensions.width,o.mapDimensions.height)<=sI){e.food.pop(),d.hunger=Math.max(0,d.hunger-xi),e.feedParentCooldownTime=aI;break}}let a;if(e.hitpoints<=0?a="killed":e.hunger>=Ar?e.food.length>0&&e.isAdult?(e.food.pop(),e.hunger=Math.max(0,e.hunger-xi)):a="hunger":e.age>=e.maxAge&&(a="oldAge"),a){if(e.leaderId===e.id){const c=ui(Ct(o,e));c?(c.leaderId=c.id,c.tribeBadge=e.tribeBadge,c.diplomacy=new Map(e.diplomacy),o.entities.entities.forEach(d=>{if(d.type==="human"&&d.leaderId===e.id){const h=d;h.leaderId=c.id}})):o.entities.entities.forEach(d=>{if(d.type==="human"&&d.leaderId===e.id){const h=d;h.leaderId=void 0,h.tribeBadge=void 0}})}if(e.isPlayer){const c=ui(Ct(o,e));c?(c.isPlayer=!0,o.generationCount++):(o.gameOver=!0,o.causeOfGameOver=a,Qd(o,{identifier:"no_heir",type:xs.NoHeir,message:"Your lineage has ended. You have no heir.",duration:0}))}uC(o.entities,e.position,e.gender,e.age,e.radius,e.id,o.time,e.food,e.hunger),Js(o.entities,e.id);return}e.animationProgress===void 0&&(e.animationProgress=0),e.animationSpeed===void 0&&(e.animationSpeed=1),e.animationProgress+=r*e.animationSpeed,e.animationProgress>=1&&(e.animationProgress=0)}function o_(e,n){const r=n.gameState.time-e.timeOfDeath;e.decayProgress=Math.min(1,r/lI);const o=Math.floor(B0*(1-e.decayProgress));e.food.length>o&&e.food.splice(o),e.decayProgress>=1&&e.food.length<=0&&Js(n.gameState.entities,e.id)}function s_(e,n,r){const o=r*(Et/wt);e.age+=r/nu,e.isAdult=e.age>=Ds;let l=n.gameState.ecosystem.preyHungerIncreasePerHour*o;if(e.isPregnant&&(l*=1.2),e.hunger+=l,e.isPregnant&&e.gestationTime!==void 0&&(e.gestationTime-=o,e.gestationTime<=0)){const c={x:e.position.x+(Math.random()-.5)*40,y:e.position.y+(Math.random()-.5)*40};c.x=Math.max(20,Math.min(n.gameState.mapDimensions.width-20,c.x)),c.y=Math.max(20,Math.min(n.gameState.mapDimensions.height-20,c.y));const d=Math.random()<.5?"male":"female",h=e,g=e.fatherId?n.gameState.entities.entities.get(e.fatherId):void 0;let m;if(g)m=$w(h.geneCode,g.geneCode);else{m=h.geneCode;const y=Math.floor((Math.random()-.5)*4096);m=Math.max(0,Math.min(16777215,m+y))}Io(n.gameState.entities,c,d,0,gv*.5,m,e.id,e.fatherId),Re(n.gameState,se.Procreation,e.position,fr,e.id),Me(n,Te.Birth,e.position),e.isPregnant=!1,e.gestationTime=0,e.procreationCooldown=n.gameState.ecosystem.preyProcreationCooldown,e.fatherId=void 0}e.procreationCooldown&&e.procreationCooldown>0&&(e.procreationCooldown-=o,e.procreationCooldown<0&&(e.procreationCooldown=0)),e.eatingCooldownTime&&e.eatingCooldownTime>n.gameState.time||(e.eatingCooldownTime=void 0),e.fleeCooldown&&e.fleeCooldown>0&&(e.fleeCooldown-=o,e.fleeCooldown<0&&(e.fleeCooldown=0)),e.feedChildCooldownTime&&e.feedChildCooldownTime>0&&(e.feedChildCooldownTime-=o,e.feedChildCooldownTime<0&&(e.feedChildCooldownTime=0));let a=!1;e.hunger>=Rw&&(a=!0),e.hitpoints<=0&&(a=!0),e.age>=pv&&(a=!0),a&&(cC(n.gameState.entities,e.position,e.gender,e.age,e.radius,e.id,n.gameState.time,e.geneCode),Js(n.gameState.entities,e.id))}function a_(e,n,r){const o=r*(Et/wt);e.age+=r/nu,e.isAdult=e.age>=ks;let l=n.gameState.ecosystem.predatorHungerIncreasePerHour*o;if(e.isPregnant&&(l*=1.3),e.hunger+=l,e.isPregnant&&e.gestationTime!==void 0&&(e.gestationTime-=o,e.gestationTime<=0)){const c={x:e.position.x+(Math.random()-.5)*50,y:e.position.y+(Math.random()-.5)*50};c.x=Math.max(25,Math.min(n.gameState.mapDimensions.width-25,c.x)),c.y=Math.max(25,Math.min(n.gameState.mapDimensions.height-25,c.y));const d=Math.random()<.5?"male":"female",h=e,g=e.pregnancyFatherId?n.gameState.entities.entities.get(e.pregnancyFatherId):void 0;let m;if(g)m=qw(h.geneCode,g.geneCode);else{m=h.geneCode;const y=Math.floor((Math.random()-.5)*4096);m=Math.max(0,Math.min(16777215,m+y))}Eo(n.gameState.entities,c,d,0,vv*.6,m,e.id,e.pregnancyFatherId),Re(n.gameState,se.Procreation,e.position,fr,e.id),Me(n,Te.Birth,e.position),e.isPregnant=!1,e.gestationTime=0,e.procreationCooldown=n.gameState.ecosystem.predatorProcreationCooldown,e.pregnancyFatherId=void 0}e.procreationCooldown&&e.procreationCooldown>0&&(e.procreationCooldown-=o,e.procreationCooldown<0&&(e.procreationCooldown=0)),e.attackCooldown&&e.attackCooldown>0&&(e.attackCooldown-=o,e.attackCooldown<0&&(e.attackCooldown=0)),e.huntCooldown&&e.huntCooldown>0&&(e.huntCooldown-=o,e.huntCooldown<0&&(e.huntCooldown=0)),e.feedChildCooldownTime&&e.feedChildCooldownTime>0&&(e.feedChildCooldownTime-=o,e.feedChildCooldownTime<0&&(e.feedChildCooldownTime=0));let a=!1;e.hunger>=Uw&&(a=!0),e.hitpoints<=0&&(a=!0),e.age>=mv&&(a=!0),a&&(dC(n.gameState.entities,e.position,e.gender,e.age,e.radius,e.id,n.gameState.time,e.geneCode),Js(n.gameState.entities,e.id))}var qs=(e=>(e[e.BehaviorTreeBased=0]="BehaviorTreeBased",e))(qs||{});function kf(e,n){if(e.aiBehaviorTree&&e.aiBlackboard){const r=e.aiBlackboard.get("lastAiUpdateTime")??0;n.gameState.time-r>=Ls&&(e.aiBehaviorTree.execute(e,n,e.aiBlackboard),e.aiBlackboard.set("lastAiUpdateTime",n.gameState.time))}else console.warn(`Behavior Tree AI ticked for human ${e.id}, but the tree or blackboard was missing.`),e.activeAction="idle"}function l_(e,n){e.aiBlackboard&&e.aiBlackboard.cleanupOldEntries(n.gameState.time);const r=performance.now();switch(e.aiType){case qs.BehaviorTreeBased:default:kf(e,n);break}n.gameState.performanceMetrics.currentBucket.aiUpdateTime+=performance.now()-r}function u_(e,n){e.aiBehaviorTree&&e.aiBlackboard?kf(e,n):(console.warn(`Behavior Tree AI ticked for prey ${e.id}, but the tree or blackboard was missing.`),e.activeAction="idle")}function c_(e,n){e.aiBehaviorTree&&e.aiBlackboard?kf(e,n):(console.warn(`Behavior Tree AI ticked for predator ${e.id}, but the tree or blackboard was missing.`),e.activeAction="idle")}function d_(e,n){e.forces.push(_t(e.velocity,-.1));const r=_t(tt(e.direction),e.acceleration);e.forces.push(r),e.debuffs.forEach(o=>{n.gameState.time-o.startTime<o.duration&&o.type==="slow"&&(e.velocity=_t(e.velocity,.5))}),e.debuffs=e.debuffs.filter(o=>n.gameState.time-o.startTime<o.duration),e.velocity=Wn(e.velocity,e.forces.reduce(Wn,{x:0,y:0})),yo(e.velocity)<.001&&(e.velocity={x:0,y:0}),e.position=Wn(e.position,_t(e.velocity,n.deltaTime)),e.position.x=(e.position.x%n.gameState.mapDimensions.width+n.gameState.mapDimensions.width)%n.gameState.mapDimensions.width,e.position.y=(e.position.y%n.gameState.mapDimensions.height+n.gameState.mapDimensions.height)%n.gameState.mapDimensions.height,e.forces=[],e.type==="human"?r_(e,n,n.deltaTime):e.type==="corpse"?o_(e,n):e.type==="prey"?s_(e,n,n.deltaTime):e.type==="predator"&&a_(e,n,n.deltaTime),e.type==="human"&&l_(e,n),e.type==="prey"?u_(e,n):e.type==="predator"&&c_(e,n),e.stateMachine&&(e.stateMachine=i_(...e.stateMachine,{entity:e,updateContext:n}))}var I=(e=>(e[e.SUCCESS=0]="SUCCESS",e[e.FAILURE=1]="FAILURE",e[e.RUNNING=2]="RUNNING",e[e.NOT_EVALUATED=3]="NOT_EVALUATED",e))(I||{});const Nm="Human Behavior",f_=1;class h_{constructor(){me(this,"nodeData",new Map);me(this,"pathStack",[]);me(this,"startTimeStack",[])}nodeStart(n){this.pathStack.push(n),this.startTimeStack.push(performance.now())}nodeEnd(){if(this.startTimeStack.length===0||this.pathStack.length===0){console.error("BTProfiler: nodeEnd() called without a matching nodeStart().");return}const n=performance.now(),r=this.startTimeStack.pop(),o=n-r,l=this.pathStack.join(" > "),a=this.nodeData.get(l)??{path:l,totalTime:0,callCount:0,minTime:1/0,maxTime:-1/0};a.totalTime+=o,a.callCount++,a.minTime=Math.min(a.minTime,o),a.maxTime=Math.max(a.maxTime,o),this.nodeData.set(l,a),this.pathStack.pop()}report(n={}){const{showAll:r=!1}=n,o=Array.from(this.nodeData.values());if(o.length===0){console.log("--- Behavior Tree Profiler: No data collected. ---");return}let l=o,a="--- Behavior Tree Full Report ---";if(!r){const d=this.nodeData.get(Nm);if(d){const h=d.totalTime*f_/100;l=o.filter(g=>g.totalTime>h&&g.path!==Nm),a="--- Behavior Tree Problem Report ---"}else console.log('BTProfiler: Root node "Human Behavior" not found. Showing full report.'),a="--- Behavior Tree Full Report (Root Not Found) ---"}const c=l.sort((d,h)=>h.totalTime-d.totalTime);console.log(a),c.length>0?console.table(c.map(d=>({Path:d.path,"Total Time (ms)":d.totalTime.toFixed(3),Calls:d.callCount,"Avg Time (ms)":(d.totalTime/d.callCount).toFixed(3),"Min Time (ms)":d.minTime.toFixed(3),"Max Time (ms)":d.maxTime.toFixed(3)}))):console.log("No significant performance problems detected."),console.log("------------------------------------")}reset(){this.nodeData.clear(),this.pathStack=[],this.startTimeStack=[]}}const ct=new h_;function Cn(e){return Array.isArray(e)?e:[e,""]}class ge{constructor(n,r,o=0){me(this,"name");me(this,"lastStatus");me(this,"depth");this.children=n,this.name=r,this.depth=o,this.children.forEach(l=>{l.depth=(this.depth??0)+1})}execute(n,r,o){this.name&&ct.nodeStart(this.name);try{for(const l of this.children){const[a,c]=Cn(l.execute(n,r,o));if(a!==I.SUCCESS)return this.lastStatus=a,this.name&&o.recordNodeExecution(this.name,a,r.gameState.time,this.depth,c),a}return this.lastStatus=I.SUCCESS,this.name&&o.recordNodeExecution(this.name,I.SUCCESS,r.gameState.time,this.depth,""),I.SUCCESS}finally{this.name&&ct.nodeEnd()}}}class Rn{constructor(n,r,o=0){me(this,"name");me(this,"lastStatus");me(this,"depth");me(this,"runningChildIndex");this.children=n,this.name=r,this.depth=o,this.children.forEach(l=>{l.depth=(this.depth??0)+1})}execute(n,r,o){this.name&&ct.nodeStart(this.name);try{const l=this.runningChildIndex??0;for(let a=l;a<this.children.length;a++){const c=this.children[a],[d,h]=Cn(c.execute(n,r,o));if(d!==I.FAILURE){if(d===I.SUCCESS)return delete this.runningChildIndex,this.lastStatus=I.SUCCESS,this.name&&o.recordNodeExecution(this.name,I.SUCCESS,r.gameState.time,this.depth,h),I.SUCCESS;if(d===I.RUNNING)return this.runningChildIndex=a,this.lastStatus=I.RUNNING,this.name&&o.recordNodeExecution(this.name,I.RUNNING,r.gameState.time,this.depth,h),I.RUNNING}}return delete this.runningChildIndex,this.lastStatus=I.FAILURE,this.name&&o.recordNodeExecution(this.name,I.FAILURE,r.gameState.time,this.depth,""),I.FAILURE}finally{this.name&&ct.nodeEnd()}}}class le{constructor(n,r,o=0){me(this,"name");me(this,"lastStatus");me(this,"depth");this.action=n,this.name=r,this.depth=o}execute(n,r,o){this.name&&ct.nodeStart(this.name);try{const[l,a]=Cn(this.action(n,r,o));return this.lastStatus=l,this.name&&o.recordNodeExecution(this.name,l,r.gameState.time,this.depth,a),l}finally{this.name&&ct.nodeEnd()}}}class ie{constructor(n,r,o=0){me(this,"name");me(this,"lastStatus");me(this,"depth");this.condition=n,this.name=r,this.depth=o}execute(n,r,o){this.name&&ct.nodeStart(this.name);try{const[l,a]=Cn(this.condition(n,r,o)),c=l?I.SUCCESS:I.FAILURE;return this.lastStatus=c,this.name&&o.recordNodeExecution(this.name,c,r.gameState.time,this.depth,a),c}finally{this.name&&ct.nodeEnd()}}}class jl{constructor(n,r,o,l=0){me(this,"name");me(this,"lastStatus");me(this,"depth");me(this,"startTimeKey");this.child=n,this.timeoutDurationHours=r,this.name=o,this.depth=l,this.child.depth=(this.depth??0)+1,this.startTimeKey=`timeout_${this.name}_startTime`}execute(n,r,o){ct.nodeStart(this.name);try{const l=r.gameState.time;let a=o.get(this.startTimeKey);const[c,d]=Cn(this.child.execute(n,r,o));if(c===I.RUNNING){a===void 0&&(o.set(this.startTimeKey,l),a=l);const h=l-a;if(h>this.timeoutDurationHours){o.delete(this.startTimeKey),this.lastStatus=I.FAILURE;const m=`Timed out after ${h.toFixed(2)}h.`;return o.recordNodeExecution(this.name,this.lastStatus,l,this.depth,m),this.lastStatus}this.lastStatus=I.RUNNING;const g=`Running for ${h.toFixed(2)}h. ${d}`;return o.recordNodeExecution(this.name,this.lastStatus,l,this.depth,g),this.lastStatus}return a!==void 0&&o.delete(this.startTimeKey),this.lastStatus=c,o.recordNodeExecution(this.name,this.lastStatus,l,this.depth,d),this.lastStatus}finally{ct.nodeEnd()}}}class js{constructor(n,r,o,l=0,a){me(this,"name");me(this,"lastStatus");me(this,"depth");me(this,"statusKey");me(this,"timestampKey");this.child=n,this.cacheDurationHours=r,this.validityCheck=a,this.name=o,this.depth=l,this.child.depth=(this.depth??0)+1,this.statusKey=`caching_${this.name}_status`,this.timestampKey=`caching_${this.name}_timestamp`}execute(n,r,o){ct.nodeStart(this.name);try{const l=r.gameState.time,a=o.get(this.statusKey),c=o.get(this.timestampKey);if(a!==void 0&&c!==void 0){const m=l-c>this.cacheDurationHours,y=this.validityCheck?this.validityCheck(n,r,o):!0;if(!m&&y){const S=(c+this.cacheDurationHours-l).toFixed(2),_=`Cache hit. Status: ${I[a]}. ${S}h left.`;return this.lastStatus=a,o.recordNodeExecution(this.name,this.lastStatus,l,this.depth,_),this.lastStatus}}const[d,h]=Cn(this.child.execute(n,r,o));(d===I.SUCCESS||d===I.FAILURE)&&(o.set(this.statusKey,d),o.set(this.timestampKey,l)),this.lastStatus=d;const g=`Cache miss. Child returned ${I[d]}. ${h}`;return o.recordNodeExecution(this.name,this.lastStatus,l,this.depth,g),this.lastStatus}finally{ct.nodeEnd()}}}class _r{constructor(n,r,o,l=0){me(this,"name");me(this,"lastStatus");me(this,"depth");me(this,"cooldownKey");this.cooldownDurationHours=n,this.child=r,this.name=o,this.depth=l,this.child.depth=(this.depth??0)+1,this.cooldownKey=`cooldown_${this.name}`}execute(n,r,o){ct.nodeStart(this.name);try{const l=r.gameState.time,a=o.get(this.cooldownKey);if(this.child.lastStatus===I.RUNNING){const[h,g]=Cn(this.child.execute(n,r,o));if(this.lastStatus=h,this.name){const m=`Continuing running child. ${g}`;o.recordNodeExecution(this.name,this.lastStatus,l,this.depth,m)}return this.lastStatus}if(a!==void 0&&l<a){const g=`Cooldown active, ${(a-l).toFixed(2)}h left`;return this.lastStatus=I.FAILURE,this.name&&o.recordNodeExecution(this.name,this.lastStatus,l,this.depth,g),this.lastStatus}const[c,d]=Cn(this.child.execute(n,r,o));return(c===I.SUCCESS||c===I.RUNNING)&&o.set(this.cooldownKey,l+this.cooldownDurationHours),this.lastStatus=c,this.name&&o.recordNodeExecution(this.name,this.lastStatus,l,this.depth,d),this.lastStatus}finally{ct.nodeEnd()}}}class sr{constructor(n,r,o,l=0){me(this,"name");me(this,"lastStatus");me(this,"depth");this.child=n,this.behaviorKey=r,this.name=o,this.depth=l;const a=(c,d)=>{c.depth=d,c.children?c.children.forEach(h=>a(h,d+1)):c.child&&a(c.child,d+1)};a(this.child,(this.depth??0)+1)}execute(n,r,o){this.name&&ct.nodeStart(this.name);try{if(n.isPlayer&&!r.gameState.autopilotControls.behaviors[this.behaviorKey]){const d=`Player autopilot for '${this.behaviorKey}' is disabled.`;return this.lastStatus=I.FAILURE,this.name&&o.recordNodeExecution(this.name,this.lastStatus,r.gameState.time,this.depth,d),this.lastStatus}const[a,c]=Cn(this.child.execute(n,r,o));return this.lastStatus=a,this.name&&o.recordNodeExecution(this.name,this.lastStatus,r.gameState.time,this.depth,c),this.lastStatus}finally{this.name&&ct.nodeEnd()}}}class p_{constructor(n,r,o=0){me(this,"name");me(this,"lastStatus");me(this,"depth");this.child=n,this.name=r,this.depth=o;const l=(a,c)=>{a.depth=c,a.children?a.children.forEach(d=>l(d,c+1)):a.child&&l(a.child,c+1)};l(this.child,(this.depth??0)+1)}execute(n,r,o){this.name&&ct.nodeStart(this.name);try{if(n.isPlayer&&r.gameState.autopilotControls.isManuallyMoving)return this.lastStatus=I.FAILURE,this.name&&o.recordNodeExecution(this.name,this.lastStatus,r.gameState.time,this.depth,"Manual movement active, AI blocked."),this.lastStatus;const[l,a]=Cn(this.child.execute(n,r,o));return this.lastStatus=l,this.name&&o.recordNodeExecution(this.name,this.lastStatus,r.gameState.time,this.depth,a),this.lastStatus}finally{this.name&&ct.nodeEnd()}}}class vs{constructor(n,r,o=0){me(this,"name");me(this,"lastStatus");me(this,"depth");this.child=n,this.name=r,this.depth=o;const l=(a,c)=>{a.depth=c,a.children?a.children.forEach(d=>l(d,c+1)):a.child&&l(a.child,c+1)};l(this.child,(this.depth??0)+1)}execute(n,r,o){this.name&&ct.nodeStart(this.name);try{if(n.isPlayer)return this.lastStatus=I.FAILURE,this.name&&o.recordNodeExecution(this.name,this.lastStatus,r.gameState.time,this.depth,"Player controlled, AI blocked."),this.lastStatus;const[l,a]=Cn(this.child.execute(n,r,o));return this.lastStatus=l,this.name&&o.recordNodeExecution(this.name,this.lastStatus,r.gameState.time,this.depth,a),this.lastStatus}finally{this.name&&ct.nodeEnd()}}}function g_(e){return new ge([new ie((n,r)=>{const o=n.hunger>=Zg,l=n.food.length>0,a=!n.eatingCooldownTime||r.gameState.time>=n.eatingCooldownTime;return[!!(n.isAdult&&o&&l&&a),`${Math.floor(n.hunger-Zg)}, ${n.food.length}, ${n.eatingCooldownTime?Math.floor(n.eatingCooldownTime-r.gameState.time):""}`]},"Can Eat",e+1),new le(n=>(n.direction={x:0,y:0},n.target=void 0,n.activeAction="eating",I.RUNNING),"Eat",e+1)],"Eating",e)}function m_(e){return new ge([new ie((n,r,o)=>{if(n.isAdult&&n.hitpoints>n.maxHitpoints*k0||n.isAdult&&n.hunger>mT)return!1;const l=wI(n.id,r.gameState);return l?(o.set("fleeThreat",l),!0):!1},"Should Flee",e+1),new le((n,r,o)=>{const l=o.get("fleeThreat");if(!l)return I.FAILURE;n.activeAction="moving";const a=$e(l.position,n.position,r.gameState.mapDimensions.width,r.gameState.mapDimensions.height),c=tt(a),d=Wn(n.position,_t(c,O0));return n.target={x:(d.x%r.gameState.mapDimensions.width+r.gameState.mapDimensions.width)%r.gameState.mapDimensions.width,y:(d.y%r.gameState.mapDimensions.height+r.gameState.mapDimensions.height)%r.gameState.mapDimensions.height},n.direction=c,I.RUNNING},"Execute Flee",e+1)],"Flee",e)}const ys="foodSource";function v_(e){const n=new le((o,l,a)=>{const c=new Map,d=De(o,l.gameState,"berryBush",tm,m=>{if(m.food.length===0)return!1;if(!m.ownerId||!m.claimedUntil||l.gameState.time>=m.claimedUntil)return!0;const y=l.gameState.entities.entities.get(m.ownerId);if(!y||y.leaderId===o.leaderId)return!0;const S=c.get(y.id)??X(o.position,y.position,l.gameState.mapDimensions.width,l.gameState.mapDimensions.height);return c.set(y.id,S),S>$T}),h=De(o,l.gameState,"corpse",tm,m=>m.food.length>0);let g=null;if(d&&h){const m=X(o.position,d.position,l.gameState.mapDimensions.width,l.gameState.mapDimensions.height),y=X(o.position,h.position,l.gameState.mapDimensions.width,l.gameState.mapDimensions.height);g=m<=y?d:h}else g=d||h;return g?(a.set(ys,g),[I.SUCCESS,`Found food: ${g.type} at ${g.position.x.toFixed(0)},${g.position.y.toFixed(0)}`]):[I.FAILURE,"No food source found"]},"Find Closest Food Source",e+4),r=new le((o,l,a)=>{const c=a.get(ys);return!c||c.food.length===0?(a.delete(ys),[I.FAILURE,"Food source is invalid or depleted"]):X(o.position,c.position,l.gameState.mapDimensions.width,l.gameState.mapDimensions.height)<Ir?(o.activeAction="gathering",o.direction={x:0,y:0},o.target=c.id,a.delete(ys),[I.SUCCESS,`Gathering from ${c.type}`]):(o.activeAction="moving",o.target=c.id,o.direction=Kt(o.position,c.position,l.gameState.mapDimensions),[I.RUNNING,`Moving to ${c.type}`])},"Move To Food and Gather",e+3);return new ge([new ie((o,l)=>{const a=o.food.length<o.maxFood,c=o.hunger>aT,d=Ct(l.gameState,o).filter(h=>h.hunger>cf);return[(o.isAdult&&a&&(c||d.length>0))??!1,`${c?"H":""}, ${d.length>0?" HC("+d.length+")":""}`]},"Should Gather Food",e+1),new Rn([new ge([new ie((o,l,a)=>a.has(ys),"Has Food Source?",e+2),r],"Continue Gathering Action",e+2),new ge([new js(n,_T,"Cache Food Source Search",e+3),r],"Find New Food Source and Gather",e+2)],"Perform or Start Gathering",e+1)],"Gather Food",e)}function y_(e){return new le((n,r,o)=>(n.activeAction="idle",n.direction={x:0,y:0},n.target=void 0,o.set("wanderTarget",void 0),I.SUCCESS),"Idle",e)}const yl="procreationWanderStartTime",Dm=(e,n,r)=>n.find(o=>wr(e,o,r));function S_(e){const n=new ie((a,c,d)=>{const h=rm(a,c.gameState,Ir),g=Dm(a,h,c.gameState);return g?(d.set("procreationPartner",g),!0):!1},"Find Immediate Partner"),r=new le((a,c,d)=>{var g;const h=d.get("procreationPartner");return h?(a.activeAction="procreating",a.target=void 0,d.delete("procreationPartner"),d.delete(yl),(g=a.partnerIds)!=null&&g.includes(h.id)||(a.partnerIds=a.partnerIds?[...a.partnerIds,h.id]:[h.id]),I.SUCCESS):I.FAILURE},"Start Procreating"),o=new ie((a,c,d)=>{const h=rm(a,c.gameState,gT),g=Dm(a,h,c.gameState);return g?(d.set("procreationPartner",g),!0):!1},"Locate Distant Partner"),l=new le((a,c,d)=>{const h=d.get("procreationPartner");if(!h)return I.FAILURE;if(X(a.position,h.position,c.gameState.mapDimensions.width,c.gameState.mapDimensions.height)<Ir)return I.SUCCESS;a.activeAction="moving",a.target=h.id;const m=$e(a.position,h.position,c.gameState.mapDimensions.width,c.gameState.mapDimensions.height);return a.direction=tt(m),I.RUNNING},"Move Towards Partner");return new ge([new ie(a=>!(!a.isAdult||a.gender==="female"&&a.isPregnant||a.age<ZT||a.gender==="female"&&a.age>H0),"Is Fertile (age, not pregnant)",e+1),new ie(a=>a.hunger<Tr,"Is Healthy (hunger)",e+1),new ie(a=>(a.procreationCooldown||0)<=0,"Is Ready (cooldown)",e+1),new Rn([new ge([new ie((a,c)=>Y0(a.position,c.gameState,"berryBush",pT)>=hT,"Is Environment Viable (food)",e+3),new le((a,c,d)=>(d.delete(yl),I.SUCCESS),"Clear Wander Timer",e+3)],"Sufficient Food Path",e+2),new ge([new ie((a,c)=>{if(a.gender==="male"){const d=Ct(c.gameState,a);return!ui(d)}return!1},"Is Male Without Heir",e+3),new le((a,c,d)=>{const h=d.get(yl);if(h===void 0)return d.set(yl,c.gameState.time),[I.FAILURE,"Starting heirless wander timer"];const g=c.gameState.time-h;return g>=JT?[I.SUCCESS,`Wandered for ${g.toFixed(1)}h, proceeding without food`]:[I.FAILURE,`Wandering for heir, ${g.toFixed(1)}h elapsed`]},"Check Wander Timer",e+3)],"Heirless Desperation Path",e+2)],"Check Environment Or Desperation",e+1),new ie((a,c,d)=>{var g;const h=d.get("procreationPartner");return h&&((g=h.partnerIds)!=null&&g.length)&&!h.partnerIds.includes(a.id)&&h.partnerIds.map(m=>c.gameState.entities.entities.get(m)).filter(m=>!!m).some(m=>X(a.position,m.position,c.gameState.mapDimensions.width,c.gameState.mapDimensions.height)<zT)?[!1,"Partner's primary partner is too close"]:!0},"Is Partner's Primary Partner Nearby",e+1),new Rn([new ge([n,r],"Procreate With Immediate Partner",e+2),new _r(IT,new ge([o,l],"Seek Distant Partner Action",e+3),"Seek Distant Partner Cooldown",e+2)],"Find Partner And Procreate",e+1)],"Procreate",e)}const Qr="attackTarget",ar="homeCenter",Ed=150;function A_(e){return new ge([new ie((n,r,o)=>{if(!n.isAdult)return[!1,"Not an adult"];const{gameState:l}=r;if(n.activeAction==="attacking"&&n.attackTargetId){const c=l.entities.entities.get(n.attackTargetId);if(c&&c.hitpoints>0&&X(n.position,c.position,l.mapDimensions.width,l.mapDimensions.height)<=Ed){if(o.set(Qr,c),!o.get(ar)){const d=n.leaderId?Er(n.leaderId,l):zl(n,l).length>0?om(n,l):n.position;o.set(ar,d)}return!0}}const a=De(n,l,"human",Ed,c=>c.hitpoints>0&&Co(n,c,l));if(a){o.set(Qr,a);const c=n.leaderId?Er(n.leaderId,l):zl(n,l).length>0?om(n,l):n.position;return o.set(ar,c),!0}return o.set(Qr,void 0),o.set(ar,void 0),!1},"Find Attack Target",e+1),new le((n,r,o)=>{const l=o.get(Qr),a=o.get(ar);if(!l||!a)return I.FAILURE;const{gameState:c}=r;return X(n.position,a,c.mapDimensions.width,c.mapDimensions.height)>D0?(n.activeAction="idle",n.attackTargetId=void 0,o.set(Qr,void 0),o.set(ar,void 0),I.FAILURE):l.hitpoints<=0||X(n.position,l.position,c.mapDimensions.width,c.mapDimensions.height)>Ed?(n.activeAction==="attacking"&&(n.activeAction="idle",n.attackTargetId=void 0),o.set(Qr,void 0),o.set(ar,void 0),I.SUCCESS):(n.activeAction==="attacking"&&n.attackTargetId===l.id||(n.activeAction="attacking",n.attackTargetId=l.id),I.RUNNING)},"Execute Attack",e+1)],"Attack",e)}const T_=(e,n,r)=>{const o=Ct(n.gameState,e).filter(c=>!c.isAdult);if(o.length===0)return I.FAILURE;let l=null,a=cf;for(const c of o)c.hunger>=a&&(a=c.hunger,l=c);return l?(r.set("targetChild",l),I.SUCCESS):I.FAILURE},I_=(e,n,r)=>{const o=r.get("targetChild");return o?X(e.position,o.position,n.gameState.mapDimensions.width,n.gameState.mapDimensions.height)>df?(e.activeAction="moving",e.target=o.id,e.direction=Kt(e.position,o.position,n.gameState.mapDimensions),I.RUNNING):(e.activeAction="feeding",e.target=void 0,r.set("targetChild",void 0),I.SUCCESS):I.FAILURE};function E_(e){return new ge([new ie(n=>(n.isAdult&&n.food.length>0&&(!n.feedChildCooldownTime||n.feedChildCooldownTime<=0))??!1,"Can Feed Child",e+1),new le(T_,"Find Hungriest Child",e+1),new le(I_,"Move To Child and Feed",e+1)],"Feed Child",e)}function w_(e){return new ge([new ie(n=>!n.isAdult&&n.hunger>=cf,"Is Hungry Child",e+1),new le((n,r,o)=>{const l=TI(n,r.gameState);if(l.length===0)return I.FAILURE;const a=De(n,r.gameState,"human",rI,c=>l.some(d=>d.id===c.id)&&c.food.length>0);return a?(o.set("targetParent",a),I.SUCCESS):I.FAILURE},"Find Parent With Food",e+1),new le((n,r,o)=>{const l=o.get("targetParent");if(!l)return I.FAILURE;const a=X(n.position,l.position,r.gameState.mapDimensions.width,r.gameState.mapDimensions.height);return n.activeAction="idle",a<=df?(n.target=void 0,I.SUCCESS):(n.target=l.id,n.activeAction="moving",I.RUNNING)},"Move To Parent",e+1)],"Seek Food From Parent",e)}const Sl="plantingSpot";function __(e){const n=new le((o,l,a)=>{const c=a.get(Sl);return!c||So(c,l.gameState,tu,o.id)?(a.delete(Sl),[I.FAILURE,"Planting spot is invalid or now occupied"]):X(o.position,c,l.gameState.mapDimensions.width,l.gameState.mapDimensions.height)>Ir?(o.activeAction="moving",o.target=c,o.direction=Kt(o.position,c,l.gameState.mapDimensions),[I.RUNNING,"Moving to planting spot"]):(o.activeAction="planting",o.target=c,[I.RUNNING,"Planting state initiated"])},"Move To Spot and Plant",e+3),r=new le((o,l,a)=>{const c=kI(o,l.gameState);return c?(a.set(Sl,c),[I.SUCCESS,`Found new spot at ${c.x.toFixed(0)}, ${c.y.toFixed(0)}`]):[I.FAILURE,"No suitable planting spot found"]},"Find Optimal Planting Spot",e+3);return new ge([new ie(o=>{const l=o.food.filter(c=>c.type===li.Berry).length>=Hs,a=o.hunger<lT;return(o.isAdult&&l&&a)??!1},"Can Plant",e+1),new ie((o,l)=>{const a=Y0(o.position,l.gameState,"berryBush",iT),c=Ct(l.gameState,o);return!(c.length===0||a>=c.length*5)},"Has Not Enough Nearby Bushes",e+1),new Rn([new ge([new ie((o,l,a)=>a.has(Sl),"Has Planting Spot?",e+2),n],"Continue Planting Action",e+2),new _r(wT,r,"Find Planting Spot Cooldown",e+2)],"Perform or Start Planting",e+1)],"Plant Bush",e)}const wd="enemiesNearby";function C_(e){const n=new ie(a=>a.id===a.leaderId,"Is Leader?",e+1),r=new ie(a=>!a.isCallingToAttack,"Is Not Already Calling?",e+1),o=new le((a,c,d)=>{const h=Sf(a,c.gameState,lv);return h.length>0?(d.set(wd,h),I.SUCCESS):I.FAILURE},"Find Nearby Enemies",e+1),l=new Rn([new ge([new ie((a,c,d)=>{const h=d.get(wd);if(!h||h.length===0)return!1;const g=Gs(a.id,c.gameState),m=$l(g),y=$l(h);return m>y*FT},"Is Strong Enough?",e+3),new le((a,c)=>(a.isCallingToAttack=!0,a.callToAttackEndTime=c.gameState.time+To,Re(c.gameState,se.CallToAttack,a.position,To),Me(c,Te.CallToAttack,a.position),a.activeAction="idle",a.target=void 0,I.SUCCESS),"Issue Call to Attack",e+3)],"Attack",e+2),new le((a,c,d)=>{const h=d.get(wd);if(!h||h.length===0)return I.FAILURE;const g=h.map(C=>C.position),m=mf(g),y=$e(m,a.position,c.gameState.mapDimensions.width,c.gameState.mapDimensions.height),S=tt(y),_=Wn(a.position,_t(S,O0*2));return a.activeAction="moving",a.target={x:(_.x%c.gameState.mapDimensions.width+c.gameState.mapDimensions.width)%c.gameState.mapDimensions.width,y:(_.y%c.gameState.mapDimensions.height+c.gameState.mapDimensions.height)%c.gameState.mapDimensions.height},a.direction=S,I.SUCCESS},"Retreat",e+2)],"Attack or Retreat",e+2);return new ge([n,r,o,new _r(UT,l,"Leader Combat Cooldown",e+1)],"Leader Combat Strategy",e)}const _d="combatTarget",Cd="homeCenter";function R_(e){const n=new ie(c=>c.isAdult&&c.leaderId?c.id!==c.leaderId:!1,"Is Tribe Follower?",e+1),r=new ie(c=>c.hunger<uT&&c.hitpoints>=c.maxHitpoints*k0,"Is Fit for Combat?",e+1),o=new ie((c,d)=>{const h=d.gameState.entities.entities.get(c.leaderId);return!!(h!=null&&h.isCallingToAttack)},"Is Leader Calling to Attack?",e+1),l=new le((c,d,h)=>{const{gameState:g}=d,m=g.entities.entities.get(c.leaderId);if(!m)return I.FAILURE;const y=Sf(m,g,vT);if(y.length===0)return I.FAILURE;y.sort((S,_)=>{const C=X(c.position,S.position,g.mapDimensions.width,g.mapDimensions.height),T=X(c.position,_.position,g.mapDimensions.width,g.mapDimensions.height);return C-T});for(const S of y)if(OI(m.id,S.id,g)<yT){h.set(_d,S);const C=Er(m.id,g);return h.set(Cd,C),I.SUCCESS}return I.FAILURE},"Find Best Target",e+1),a=new le((c,d,h)=>{const g=h.get(_d),m=h.get(Cd);if(!g||!m)return I.FAILURE;const{gameState:y}=d;return X(c.position,m,y.mapDimensions.width,y.mapDimensions.height)>D0?(c.activeAction==="attacking"&&c.attackTargetId===g.id&&(c.activeAction="idle",c.attackTargetId=void 0),h.set(_d,void 0),h.set(Cd,void 0),I.FAILURE):((!c.lastTargetAcquiredEffectTime||d.gameState.time-c.lastTargetAcquiredEffectTime>Be*5)&&(Re(d.gameState,se.TargetAcquired,c.position,Be,c.id),c.lastTargetAcquiredEffectTime=d.gameState.time),c.activeAction="attacking",c.attackTargetId=g.id,c.target=void 0,I.RUNNING)},"Attack Target",e+1);return new ge([n,r,o,l,a],"Tribe Member Combat",e)}function P_(e){const n=new ie((m,y)=>{if(!m.isAdult||m.gender!=="male")return!1;const S=m.partnerIds&&m.partnerIds.length>0,_=Ct(y.gameState,m).length>0;return S||_},"Is Adult Male With Family?",e+1),r=new ie((m,y)=>{var T;const S=yt(y.gameState);if(S){const E=ui(Ct(y.gameState,S));if((E==null?void 0:E.id)===m.id)return!1}if(!m.fatherId)return!1;const _=y.gameState.entities.entities.get(m.fatherId);return!_||((T=ui(Ct(y.gameState,_)))==null?void 0:T.id)===m.id?!1:X(m.position,_.position,y.gameState.mapDimensions.width,y.gameState.mapDimensions.height)<TT},"Is Too Close To Father?",e+1),o=new ie((m,y,S)=>S.get("territoryMoveTarget")!==void 0,"Is Moving To Territory?",e+3),l=new le((m,y,S)=>{const _=S.get("territoryMoveTarget"),C=S.get("territoryMoveStartTime");if(!_||!C)return[I.FAILURE,"Missing move data"];if(y.gameState.time-C>ST)return S.delete("territoryMoveTarget"),S.delete("territoryMoveStartTime"),[I.FAILURE,"Territory move timed out"];if(X(m.position,_,y.gameState.mapDimensions.width,y.gameState.mapDimensions.height)<Ir)return S.delete("territoryMoveTarget"),S.delete("territoryMoveStartTime"),[I.SUCCESS,"Arrived at new territory"];m.activeAction="moving",m.target=_;const M=$e(m.position,m.target,y.gameState.mapDimensions.width,y.gameState.mapDimensions.height);return m.direction=tt(M),[I.RUNNING,"Continuing move to territory"]},"Check Timeout & Arrival",e+3),a=new ge([o,l],"Handle In-Progress Move",e+2),c=new ie((m,y,S)=>S.get("territoryMoveTarget")===void 0,"Should Start New Move?",e+4),d=new le((m,y,S)=>{const _=vf(m.position,y.gameState.mapDimensions.width/4,y.gameState.mapDimensions.width,y.gameState.mapDimensions.height);S.set("territoryMoveTarget",_),S.set("territoryMoveStartTime",y.gameState.time),m.activeAction="moving",m.target=_;const C=$e(m.position,m.target,y.gameState.mapDimensions.width,y.gameState.mapDimensions.height);return m.direction=tt(C),[I.RUNNING,"Started moving to new territory"]},"Start New Territory Move",e+4),h=new ge([c,d],"Start New Territory Move Action",e+3),g=new Rn([a,new _r(ET,h,"Establish Territory Cooldown",e+2)],"Establish or Continue Move",e+1);return new ge([n,r,g],"Establish Family Territory",e)}function N_(e){return new ge([new le((n,r,o)=>{const l=EI(n,r.gameState);return l?(o.set("patriarchTarget",l),[I.SUCCESS,`Found patriarch: ${l.id}`]):(o.delete("patriarchTarget"),[I.FAILURE,"No patriarch found"])},"Find Patriarch",e+1),new le((n,r,o)=>{const l=o.get("patriarchTarget");if(!l)return[I.FAILURE,"Patriarch target missing from blackboard"];const a=X(n.position,l.position,r.gameState.mapDimensions.width,r.gameState.mapDimensions.height);if(a>N0){n.activeAction="moving",n.target=l.id;const c=$e(n.position,l.position,r.gameState.mapDimensions.width,r.gameState.mapDimensions.height);return n.direction=tt(c),[I.RUNNING,`Moving to patriarch at ${a.toFixed(0)}`]}return n.activeAction="idle",n.target=void 0,n.direction={x:0,y:0},[I.SUCCESS,`Arrived at patriarch at ${a.toFixed(0)}`]},"Move Towards Patriarch",e+1)],"Follow Patriarch",e)}const Rd="tribeSplitMigrationTarget";function D_(e){const n=new ge([new ie((r,o)=>{const{canSplit:l,progress:a}=Rf(r,o.gameState);return l?[!0,`Progress: ${(a??0)*100}%`]:[!1,"Cannot split"]},"Can Split Tribe?",e+2),new le((r,o,l)=>{const{gameState:a}=o;let c=l.get(Rd);if(!c){if(!r.leaderId)return I.FAILURE;const h=Er(r.leaderId,a),g=cw(h,r,a);if(g)l.set(Rd,g),c=g;else return I.FAILURE}return X(r.position,c,a.mapDimensions.width,a.mapDimensions.height)<Ir?(l.delete(Rd),r.activeAction="idle",r.target=void 0,I.SUCCESS):(r.activeAction="moving",r.target=c,I.RUNNING)},"Move to New Territory",e+2),new le((r,o)=>(Pf(r,o.gameState),I.SUCCESS),"Perform Tribe Split",e+2)],"Tribe Split Action",e+1);return new _r($E,n,"Tribe Split Cooldown",e)}const Al="jealousyAttackTarget";function k_(e){return new ge([new ie((n,r,o)=>{if(!n.isAdult)return[!1,"Not an adult"];const l=RI(n,r.gameState,HT);return l?(o.set(Al,l),[!0,`Partner cheating with ${l.id}`]):(o.delete(Al),!1)},"Check for Infidelity",e+1),new le((n,r,o)=>{const l=o.get(Al);return!l||l.hitpoints<=0?(o.delete(Al),[I.FAILURE,"Target is invalid or dead"]):n.activeAction==="attacking"&&n.attackTargetId===l.id?I.RUNNING:(n.activeAction="attacking",n.attackTargetId=l.id,[I.RUNNING,`Attacking ${l.id}`])},"Execute Jealousy Attack",e+1)],"Jealousy Attack",e)}const Tl="defendAggressor";function O_(e){return new ge([new ie((n,r,o)=>{if(!n.isAdult)return[!1,"Not an adult"];const l=NI(n,r.gameState,LT);return l?(o.set(Tl,l),[!0,`Family member ${l.familyMember.id} attacked by ${l.aggressor.id}`]):(o.delete(Tl),!1)},"Check Family Under Attack",e+1),new le((n,r,o)=>{const l=o.get(Tl);return!l||l.hitpoints<=0?(o.delete(Tl),[I.FAILURE,"Target invalid/dead"]):n.activeAction==="attacking"&&n.attackTargetId===l.id?I.RUNNING:(n.activeAction="attacking",n.attackTargetId=l.id,[I.RUNNING,`Attacking aggressor ${l.id}`])},"Execute Family Defense Attack",e+1)],"Defend Family",e)}const Il="bushIntruder";function M_(e){return new ge([new ie((n,r,o)=>{if(!n.isAdult)return[!1,"Not an adult"];const l=PI(n,r.gameState,BT);return l?(o.set(Il,l),[!0,`Intruder ${l.id} stealing berries`]):(o.delete(Il),!1)},"Check For Intruders on Bushes",e+1),new le((n,r,o)=>{const l=o.get(Il);return!l||l.hitpoints<=0?(o.delete(Il),[I.FAILURE,"Intruder is invalid or dead"]):n.activeAction==="attacking"&&n.attackTargetId===l.id?I.RUNNING:(n.activeAction="attacking",n.attackTargetId=l.id,[I.RUNNING,`Attacking intruder ${l.id}`])},"Execute Bush Defense Attack",e+1)],"Defend Claimed Bush",e)}const El="desperateAttackTarget";function F_(e){return new ge([new ie(n=>n.hunger>GT,"Is Starving",e+1),new ie((n,r)=>{if(!n.isAdult)return[!1,"Not an adult"];const o=De(n,r.gameState,"berryBush",vt,a=>a.food.length>0),l=De(n,r.gameState,"corpse",vt,a=>a.food.length>0);return!o&&!l},"No Other Food Available",e+1),new ie((n,r,o)=>{const l=DI(n,r.gameState);return l?(o.set(El,l),[!0,`Found weak target ${l.id}`]):(o.delete(El),!1)},"Find Weak Target",e+1),new le((n,r,o)=>{const l=o.get(El);return!l||l.hitpoints<=0?(o.delete(El),[I.FAILURE,"Target is invalid or dead"]):n.activeAction==="attacking"&&n.attackTargetId===l.id?I.RUNNING:(n.activeAction="attacking",n.attackTargetId=l.id,[I.RUNNING,`Desperately attacking ${l.id}`])},"Execute Desperate Attack",e+1)],"Desperate Attack",e)}function U_(e,n,r,o){const l=e.entities.entities.get(r.targetEntityId);return!l||!("hitpoints"in l)||l.hitpoints<=0?(e.autopilotControls.activeAutopilotAction=void 0,I.FAILURE):X(n.position,l.position,e.mapDimensions.width,e.mapDimensions.height)<=Hl?(n.activeAction="attacking",n.attackTargetId=l.id,e.autopilotControls.activeAutopilotAction=void 0,I.SUCCESS):(n.activeAction="moving",n.target=l.id,n.direction=Kt(n.position,l.position,e.mapDimensions),I.RUNNING)}function H_(e){return new ge([new ie((n,r)=>n.isPlayer===!0&&!!r.gameState.autopilotControls.activeAutopilotAction,"Has Player Command",e+1),new le((n,r)=>{const{gameState:o}=r,l=o.autopilotControls.activeAutopilotAction;if(!l)return I.FAILURE;switch(l.action){case _e.AutopilotMove:{const a=l.position;return X(n.position,a,o.mapDimensions.width,o.mapDimensions.height)<WT?(o.autopilotControls.activeAutopilotAction=void 0,n.activeAction==="moving"&&(n.activeAction="idle",n.target=void 0),I.SUCCESS):(n.activeAction="moving",n.target=a,n.direction=Kt(n.position,a,o.mapDimensions),I.RUNNING)}case _e.AutopilotGather:{const a=o.entities.entities.get(l.targetEntityId);return!a||a.food.length===0?(o.autopilotControls.activeAutopilotAction=void 0,I.FAILURE):X(n.position,a.position,o.mapDimensions.width,o.mapDimensions.height)>Ir?(n.activeAction="moving",n.target=a.id,n.direction=Kt(n.position,a.position,o.mapDimensions),I.RUNNING):(n.activeAction="gathering",n.target=a.id,o.autopilotControls.activeAutopilotAction=void 0,I.SUCCESS)}case _e.AutopilotAttack:return U_(o,n,l);case _e.AutopilotProcreate:{const a=o.entities.entities.get(l.targetEntityId);return!a||a.type!=="human"||!wr(n,a,r.gameState)?(o.autopilotControls.activeAutopilotAction=void 0,I.FAILURE):X(n.position,a.position,o.mapDimensions.width,o.mapDimensions.height)<=Hl?(n.activeAction="procreating",o.autopilotControls.activeAutopilotAction=void 0,I.SUCCESS):(n.activeAction="moving",n.target=a.id,n.direction=Kt(n.position,a.position,o.mapDimensions),I.RUNNING)}case _e.AutopilotPlant:{if(n.activeAction==="planting")return I.RUNNING;const a=l.position;return So(a,o,tu,n.id)?(o.autopilotControls.activeAutopilotAction=void 0,I.FAILURE):X(n.position,a,o.mapDimensions.width,o.mapDimensions.height)<=Hl?(n.activeAction="planting",n.target=a,o.autopilotControls.activeAutopilotAction=void 0,o.hasPlayerPlantedBush=!0,I.RUNNING):(n.activeAction="moving",n.target=a,n.direction=Kt(n.position,a,o.mapDimensions),I.RUNNING)}case _e.AutopilotFeedChild:{const a=o.entities.entities.get(l.targetEntityId);return!a||a.type!=="human"||a.isAdult||n.food.length===0?(o.autopilotControls.activeAutopilotAction=void 0,I.FAILURE):X(n.position,a.position,o.mapDimensions.width,o.mapDimensions.height)<=Hl?(o.autopilotControls.activeAutopilotAction=void 0,n.activeAction="feeding",I.SUCCESS):(n.activeAction="moving",n.target=a.id,n.direction=Kt(n.position,a.position,o.mapDimensions),I.RUNNING)}case _e.AutopilotFollowMe:{const a=o.entities.entities.get(l.targetEntityId);return!a||a.type!=="human"||a.id!==a.leaderId?(o.autopilotControls.activeAutopilotAction=void 0,I.FAILURE):X(n.position,a.position,o.mapDimensions.width,o.mapDimensions.height)<=N0?(o.autopilotControls.activeAutopilotAction=void 0,n.activeAction==="moving"&&(n.activeAction="idle"),I.SUCCESS):(n.activeAction="moving",n.target=a.id,n.direction=Kt(n.position,a.position,o.mapDimensions),I.RUNNING)}default:return o.autopilotControls.activeAutopilotAction=void 0,I.FAILURE}},"Execute Player Command",e+1)],"Player Command Handler",e)}function L_(e){return new ge([new ie(n=>!!n.leaderId&&n.leaderId!==n.id,"Is Follower",e+1),new ie((n,r)=>{if(!n.leaderId)return!1;const o=r.gameState.entities.entities.get(n.leaderId);return!!o&&o.isCallingToFollow===!0},"Is Leader Calling To Follow",e+1),new ie(n=>n.hunger<fT,"Is Not Critically Hungry",e+1),new le((n,r)=>{if(!n.leaderId)return I.FAILURE;const o=r.gameState.entities.entities.get(n.leaderId);return o?X(n.position,o.position,r.gameState.mapDimensions.width,r.gameState.mapDimensions.height)>dT?(n.activeAction="moving",n.target=o.id,n.direction=Kt(n.position,o.position,r.gameState.mapDimensions),I.RUNNING):(n.activeAction==="moving"&&n.target===o.id&&(n.activeAction="idle",n.target=void 0),I.SUCCESS):I.FAILURE},"Execute Follow Leader",e+1)],"Follow Leader Command",e)}const km="tribeMigrationCheckCooldown";function B_(e){const n=new ge([new ie(o=>!!o.leaderId&&o.leaderId===o.id,"Is Tribe Leader",e+2),new ie((o,l)=>{var c;const a=(c=o.aiBlackboard)==null?void 0:c.get(km);return a?l.gameState.time-a>=em:!0},"Is Migration Check Cooldown Over",e+2),new le((o,l)=>{var c;(c=o.aiBlackboard)==null||c.set(km,l.gameState.time);const a=MI(o,l.gameState);return a?(o.isCallingToFollow=!0,o.callToFollowEndTime=l.gameState.time+bs,o.target=a,o.activeAction="moving",I.SUCCESS):I.FAILURE},"Execute Tribe Migration",e+2)],"Tribe Migration Strategy",e+1),r=new js(n,Vd,"Cache Tribe Migration",e+1);return new _r(em,r,"Tribe Migration Cooldown",e)}function G_(e){const n=new ie(o=>o.id===o.leaderId,"Is Leader?",e+1),r=new le((o,l)=>{var g,m,y;const{gameState:a}=l,c=Gs(o.id,a),d=$l(c),h=$0(a).filter(S=>S.leaderId!==o.id);for(const S of h){const _=Gs(S.leaderId,a),C=$l(_),T=((g=o.diplomacy)==null?void 0:g.get(S.leaderId))||Gt.Friendly;d>C*MT?T!==Gt.Hostile&&((m=o.diplomacy)==null||m.set(S.leaderId,Gt.Hostile)):T!==Gt.Friendly&&((y=o.diplomacy)==null||y.set(S.leaderId,Gt.Friendly))}return I.SUCCESS},"Evaluate Diplomacy",e+2);return new ge([n,new _r(RT,r,"Diplomacy Cooldown",e+1)],"Manage Diplomacy",e)}const wl="huntTarget";function b_(e){return new ge([new js(new ie((r,o,l)=>{var h;if(!r.isAdult)return[!1,"Not an adult"];if(!r.leaderId)return[!1,"Not in a tribe"];const a=Er(r.leaderId,o.gameState),c=((h=W0(a,o.gameState,"berryBush",Jg))==null?void 0:h.map(g=>g.id))||[],d=De(a,o.gameState,"prey",Jg,g=>typeof g.target=="number"&&c.includes(g.target));return d?(l.set(wl,d.id),!0):!1},"Find Prey Target",e+2),CT,"Cache Find Prey",e+1),new jl(new le((r,o,l)=>{if(!r.leaderId)return I.FAILURE;const a=l.get(wl);if(!a)return I.FAILURE;const c=o.gameState.entities.entities.get(a);if(!c||c.hitpoints<=0)return l.delete(wl),r.activeAction="idle",r.attackTargetId=void 0,I.SUCCESS;const{gameState:d}=o,h=Er(r.leaderId,d);return X(r.position,h,d.mapDimensions.width,d.mapDimensions.height)>cT?(l.delete(wl),r.activeAction="idle",r.attackTargetId=void 0,I.FAILURE):(r.activeAction="attacking",r.attackTargetId=c.id,I.RUNNING)},"Hunt Prey Action",e+2),jd,"Hunt Prey Timeout",e+1)],"Human Hunt Prey Sequence",e)}const _l="defendTarget",Pd=150;function x_(e){return new ge([new ie((n,r,o)=>{if(!n.isAdult)return[!1,"Not an adult - children flee instead"];const{gameState:l}=r;if(n.activeAction==="attacking"&&n.attackTargetId){const c=l.entities.entities.get(n.attackTargetId);if(c&&c.type==="predator"&&c.hitpoints>0&&X(n.position,c.position,l.mapDimensions.width,l.mapDimensions.height)<=Pd)return o.set(_l,c),[!0,"Continuing defense"]}const a=De(n,l,"predator",Pd,c=>c.hitpoints>0&&(c.isAdult||!1));if(a){const c=X(n.position,a.position,l.mapDimensions.width,l.mapDimensions.height),d=a.attackTargetId===n.id,h=c<80;if(d||h)return o.set(_l,a),[!0,"Predator threat detected"]}return o.set(_l,void 0),[!1,"No predator threat"]},"Detect Predator Threat",e+1),new le((n,r,o)=>{const l=o.get(_l);if(!l)return I.FAILURE;const{gameState:a}=r,c=X(n.position,l.position,a.mapDimensions.width,a.mapDimensions.height);return l.hitpoints<=0||c>Pd*1.5?(n.activeAction="idle",n.attackTargetId=void 0,I.SUCCESS):(n.activeAction="attacking",n.attackTargetId=l.id,I.RUNNING)},"Defend Against Predator",e+1)],"Human Defend Against Predator",e)}function z_(e){return new ge([new ie((n,r,o)=>{const l=De(n,r.gameState,"predator",bt*2,()=>!0),a=De(n,r.gameState,"human",bt*2,()=>!0);let c=null,d=1/0;if(l){const h=X(n.position,l.position,r.gameState.mapDimensions.width,r.gameState.mapDimensions.height);h<d&&(d=h,c=l)}if(a){const h=X(n.position,a.position,r.gameState.mapDimensions.width,r.gameState.mapDimensions.height);h<d&&(d=h,c=a)}return c&&d<bt*1.5?(o.set("fleeThreat",c),o.set("fleeDistance",d),!0):!1},"Detect Threat",e+1),new le((n,r,o)=>{const l=o.get("fleeThreat");if(!l)return I.FAILURE;n.activeAction="moving";const a=$e(l.position,n.position,r.gameState.mapDimensions.width,r.gameState.mapDimensions.height),c=tt(a),d=Wn(n.position,_t(c,Dw));return n.target={x:(d.x%r.gameState.mapDimensions.width+r.gameState.mapDimensions.width)%r.gameState.mapDimensions.width,y:(d.y%r.gameState.mapDimensions.height+r.gameState.mapDimensions.height)%r.gameState.mapDimensions.height},n.direction=c,n.fleeCooldown=r.gameState.time+2,I.RUNNING},"Execute Flee",e+1)],"Prey Flee",e)}function $_(e){return new ge([new ie((n,r,o)=>{if(!n.isAdult)return[!1,"Not an adult"];if(n.hunger<=30||n.eatingCooldownTime&&n.eatingCooldownTime>r.gameState.time)return!1;const l=De(n,r.gameState,"berryBush",bt*10,a=>a.food.length>0);return l?X(n.position,l.position,r.gameState.mapDimensions.width,r.gameState.mapDimensions.height)<=bt?(o.set("grazingTarget",l),!0):(o.set("grazingTarget",l),o.set("needToMoveToTarget",!0),!0):!1},"Find Berry Bush",e+1),new le((n,r,o)=>{const l=o.get("grazingTarget"),a=o.get("needToMoveToTarget");if(!l)return I.FAILURE;const c=X(n.position,l.position,r.gameState.mapDimensions.width,r.gameState.mapDimensions.height);if(c<=bt)return n.activeAction="grazing",n.target=l.id,n.direction={x:0,y:0},o.delete("needToMoveToTarget"),I.RUNNING;if(a||c>bt){n.activeAction="moving",n.target=l.id;const d=Kt(n.position,l.position,r.gameState.mapDimensions);return n.direction=d,I.RUNNING}return I.FAILURE},"Move to Bush or Graze",e+1)],"Prey Graze",e)}function W_(e){const n=new ie((a,c,d)=>{const h=De(a,c.gameState,"prey",bt,g=>g.id!==a.id&&g.gender!==a.gender&&!!g.isAdult&&g.age>=Ds&&g.age<=Sd&&!g.isPregnant&&(!g.procreationCooldown||g.procreationCooldown<=0)&&g.hunger<200);return h?(d.set("procreationPartner",h),!0):!1},"Find Immediate Partner",e+2),r=new le((a,c,d)=>{const h=d.get("procreationPartner");return h?(a.activeAction="procreating",a.target=h.id,a.direction={x:0,y:0},d.delete("procreationPartner"),I.SUCCESS):I.FAILURE},"Start Procreating",e+2),o=new ie((a,c,d)=>{const h=De(a,c.gameState,"prey",bt*10,g=>g.id!==a.id&&g.gender!==a.gender&&!!g.isAdult&&g.age>=Ds&&g.age<=Sd&&!g.isPregnant&&(!g.procreationCooldown||g.procreationCooldown<=0)&&g.hunger<200);return h?(d.set("procreationPartner",h),!0):!1},"Locate Distant Partner",e+2),l=new le((a,c,d)=>{const h=d.get("procreationPartner");if(!h)return I.FAILURE;if(X(a.position,h.position,c.gameState.mapDimensions.width,c.gameState.mapDimensions.height)<=bt)return I.SUCCESS;a.activeAction="moving",a.target=h.id;const m=$e(a.position,h.position,c.gameState.mapDimensions.width,c.gameState.mapDimensions.height);return a.direction=tt(m),I.RUNNING},"Move Towards Partner",e+2);return new ge([new ie(a=>!!(a.isAdult&&!a.isPregnant&&a.age>=Ds&&a.age<=Sd&&a.hunger<200&&(!a.procreationCooldown||a.procreationCooldown<=0)),"Is Fertile and Ready",e+1),new Rn([new ge([n,r],"Procreate With Immediate Partner",e+2),new ge([o,l],"Seek Distant Partner",e+2)],"Find Partner And Procreate",e+1)],"Prey Procreate",e)}const Y_=(e,n,r)=>{const o=n.gameState.search.prey.byProperty("motherId",e.id).filter(c=>!c.isAdult&&c.type==="prey");if(o.length===0)return I.FAILURE;let l=null,a=au;for(const c of o)c.hunger>=a&&(a=c.hunger,l=c);return l?(r.set("targetChild",l),I.SUCCESS):I.FAILURE},j_=(e,n,r)=>{const o=r.get("targetChild");return o?X(e.position,o.position,n.gameState.mapDimensions.width,n.gameState.mapDimensions.height)>Ro?(e.activeAction="moving",e.target=o.id,e.direction=Kt(e.position,o.position,n.gameState.mapDimensions),I.RUNNING):(e.activeAction="feeding",e.target=void 0,r.set("targetChild",void 0),I.SUCCESS):I.FAILURE};function V_(e){return new ge([new ie(n=>(n.isAdult&&n.gender==="female"&&n.hunger<80&&(!n.feedChildCooldownTime||n.feedChildCooldownTime<=0))??!1,"Can Feed Child (Female Only)",e+1),new le(Y_,"Find Hungriest Prey Child",e+1),new le(j_,"Move To Child and Feed",e+1)],"Feed Prey Child",e)}function X_(e){return new ge([new ie(n=>!n.isAdult&&n.hunger>=au,"Is Hungry Prey Child",e+1),new le((n,r,o)=>{if(!n.motherId)return I.FAILURE;const l=r.gameState.entities.entities.get(n.motherId);return l?(o.set("targetParent",l),I.SUCCESS):I.FAILURE},"Find Female Parent",e+1),new le((n,r,o)=>{const l=o.get("targetParent");if(!l)return I.FAILURE;const a=X(n.position,l.position,r.gameState.mapDimensions.width,r.gameState.mapDimensions.height);return n.activeAction="idle",a<=Ro?(n.target=void 0,I.SUCCESS):(n.target=l.id,n.activeAction="moving",I.RUNNING)},"Move To Female Parent",e+1)],"Seek Food From Female Parent",e)}function K_(e){return new ge([new ie((n,r,o)=>{if(!n.isAdult)return[!1,"Not an adult"];if(n.hunger<=50||n.huntCooldown&&n.huntCooldown>0)return!1;const l=De(n,r.gameState,"prey",to*10,a=>a.hitpoints>0);if(l){const a=X(n.position,l.position,r.gameState.mapDimensions.width,r.gameState.mapDimensions.height);if(a<=to)return o.set("huntTarget",l),!0;if(a<=to*10)return o.set("huntTarget",l),o.set("needToApproach",!0),!0}return!1},"Find Prey Target",e+1),new jl(new le((n,r,o)=>{const l=o.get("huntTarget"),a=o.get("needToApproach");if(!l||l.hitpoints<=0)return I.FAILURE;const c=X(n.position,l.position,r.gameState.mapDimensions.width,r.gameState.mapDimensions.height);if(c<=to)return n.activeAction="attacking",n.attackTargetId=l.id,n.target=l.id,n.direction={x:0,y:0},o.delete("needToApproach"),I.RUNNING;if(a||c>to){n.activeAction="moving",n.target=l.id;const d=$e(n.position,l.position,r.gameState.mapDimensions.width,r.gameState.mapDimensions.height);return n.direction=tt(d),I.RUNNING}return I.FAILURE},"Hunt or Approach Prey",e+2),10,"Hunt Timeout (10 hour)",e+1)],"Predator Hunt",e)}function q_(e){return new ge([new ie((n,r,o)=>{const l=n.hunger>100,a=n.hitpoints<n.maxHitpoints*.5;if(!l&&!a||n.attackCooldown&&n.attackCooldown>0)return!1;const c=De(n,r.gameState,"human",wn*2,d=>d.hitpoints>0);if(c){const d=X(n.position,c.position,r.gameState.mapDimensions.width,r.gameState.mapDimensions.height);if(d<=wn)return o.set("attackTarget",c),!0;if(l&&d<=wn*2)return o.set("attackTarget",c),o.set("needToApproach",!0),!0}return!1},"Find Human Target",e+1),new le((n,r,o)=>{const l=o.get("attackTarget"),a=o.get("needToApproach");if(!l||l.hitpoints<=0)return I.FAILURE;const c=X(n.position,l.position,r.gameState.mapDimensions.width,r.gameState.mapDimensions.height);if(c<=wn)return n.activeAction="attacking",n.attackTargetId=l.id,n.target=l.id,n.direction={x:0,y:0},o.delete("needToApproach"),I.RUNNING;if(a||c>wn){n.activeAction="moving",n.target=l.id;const d=$e(n.position,l.position,r.gameState.mapDimensions.width,r.gameState.mapDimensions.height);return n.direction=tt(d),I.RUNNING}return I.FAILURE},"Attack or Approach Human",e+1)],"Predator Attack Human",e)}function Q_(e){const n=new ie((a,c,d)=>{const h=De(a,c.gameState,"predator",bi,g=>g.id!==a.id&&g.gender!==a.gender&&!!g.isAdult&&g.age>=ks&&g.age<=Ad&&!g.isPregnant&&(!g.procreationCooldown||g.procreationCooldown<=0)&&g.hunger<200);return h?(d.set("procreationPartner",h),!0):!1},"Find Immediate Partner",e+2),r=new le((a,c,d)=>{const h=d.get("procreationPartner");return h?(a.activeAction="procreating",a.target=h.id,a.direction={x:0,y:0},d.delete("procreationPartner"),I.SUCCESS):I.FAILURE},"Start Procreating",e+2),o=new ie((a,c,d)=>{const h=De(a,c.gameState,"predator",bi*10,g=>g.id!==a.id&&g.gender!==a.gender&&!!g.isAdult&&g.age>=ks&&g.age<=Ad&&!g.isPregnant&&(!g.procreationCooldown||g.procreationCooldown<=0)&&g.hunger<200);return h?(d.set("procreationPartner",h),!0):!1},"Locate Distant Partner",e+2),l=new le((a,c,d)=>{const h=d.get("procreationPartner");if(!h)return I.FAILURE;if(X(a.position,h.position,c.gameState.mapDimensions.width,c.gameState.mapDimensions.height)<=bi)return I.SUCCESS;a.activeAction="moving",a.target=h.id;const m=$e(a.position,h.position,c.gameState.mapDimensions.width,c.gameState.mapDimensions.height);return a.direction=tt(m),I.RUNNING},"Move Towards Partner",e+2);return new ge([new ie(a=>!!(a.isAdult&&!a.isPregnant&&a.age>=ks&&a.age<=Ad&&a.hunger<200&&(!a.procreationCooldown||a.procreationCooldown<=0)),"Is Fertile and Ready",e+1),new Rn([new ge([n,r],"Procreate With Immediate Partner",e+2),new ge([o,l],"Seek Distant Partner",e+2)],"Find Partner And Procreate",e+1)],"Predator Procreate",e)}const Z_=(e,n,r)=>{const o=n.gameState.search.predator.byProperty("motherId",e.id).filter(c=>!c.isAdult&&c.type==="predator");if(o.length===0)return I.FAILURE;let l=null,a=au;for(const c of o)c.hunger>=a&&(a=c.hunger,l=c);return l?(r.set("targetChild",l),I.SUCCESS):I.FAILURE},J_=(e,n,r)=>{const o=r.get("targetChild");return o?X(e.position,o.position,n.gameState.mapDimensions.width,n.gameState.mapDimensions.height)>Ro?(e.activeAction="moving",e.target=o.id,e.direction=Kt(e.position,o.position,n.gameState.mapDimensions),I.RUNNING):(e.activeAction="feeding",e.target=void 0,r.set("targetChild",void 0),I.SUCCESS):I.FAILURE};function eC(e){return new ge([new ie(n=>(n.isAdult&&n.gender==="female"&&n.hunger<90&&(!n.feedChildCooldownTime||n.feedChildCooldownTime<=0))??!1,"Can Feed Child (Female Only)",e+1),new le(Z_,"Find Hungriest Predator Child",e+1),new le(J_,"Move To Child and Feed",e+1)],"Feed Predator Child",e)}function tC(e){return new ge([new ie(n=>!n.isAdult&&n.hunger>=au,"Is Hungry Predator Child",e+1),new le((n,r,o)=>{if(!n.motherId)return I.FAILURE;const l=r.gameState.entities.entities.get(n.motherId);return l?(o.set("targetParent",l),I.SUCCESS):I.FAILURE},"Find Female Parent",e+1),new le((n,r,o)=>{const l=o.get("targetParent");if(!l)return I.FAILURE;const a=X(n.position,l.position,r.gameState.mapDimensions.width,r.gameState.mapDimensions.height);return n.activeAction="idle",a<=Ro?(n.target=void 0,I.SUCCESS):(n.target=l.id,n.activeAction="moving",I.RUNNING)},"Move To Female Parent",e+1)],"Seek Food From Female Parent",e)}function Ev(e){return new le((n,r,o)=>{n.activeAction="idle";let l=o.get("wanderTarget"),a=o.get("wanderStartTime");const c=r.gameState.time;if(!l||!a||c-a>2){const d=Math.random()*2*Math.PI,h=50+Math.random()*100,g={x:Math.cos(d),y:Math.sin(d)},m=Wn(n.position,_t(g,h));l={x:(m.x%r.gameState.mapDimensions.width+r.gameState.mapDimensions.width)%r.gameState.mapDimensions.width,y:(m.y%r.gameState.mapDimensions.height+r.gameState.mapDimensions.height)%r.gameState.mapDimensions.height},o.set("wanderTarget",l),o.set("wanderStartTime",c)}if(l){n.target=l;let d=l.x-n.position.x,h=l.y-n.position.y;const g=r.gameState.mapDimensions.width,m=r.gameState.mapDimensions.height;Math.abs(d)>g/2&&(d=d>0?d-g:d+g),Math.abs(h)>m/2&&(h=h>0?h-m:h+m);const y=tt({x:d,y:h});n.direction=y}return I.SUCCESS},"Animal Wander",e)}function nC(e){return new ge([new ie((n,r,o)=>{if(n.hunger>90||n.hitpoints<n.maxHitpoints*.3||n.activeAction==="grazing"||n.activeAction==="procreating")return!1;const l=r.gameState.entities.entities.values(),a=[];for(const c of l)if(c.type==="prey"&&c.id!==n.id){const d=c;d.hitpoints>0&&d.isAdult&&X(n.position,d.position,r.gameState.mapDimensions.width,r.gameState.mapDimensions.height)<=bt*5&&a.push(d)}if(a.length>=2){let c=0,d=0;for(const m of a)c+=m.position.x,d+=m.position.y;c/=a.length,d/=a.length;const h={x:c,y:d};if(X(n.position,h,r.gameState.mapDimensions.width,r.gameState.mapDimensions.height)>bt*2)return o.set("herdCenter",h),o.set("herdSize",a.length),!0}return!1},"Find Herd",e+1),new le((n,r,o)=>{const l=o.get("herdCenter");if(!l)return I.FAILURE;if(X(n.position,l,r.gameState.mapDimensions.width,r.gameState.mapDimensions.height)>bt*2){n.activeAction="moving",n.target=l;const c=$e(n.position,l,r.gameState.mapDimensions.width,r.gameState.mapDimensions.height);return n.direction=tt(c),I.RUNNING}else return n.activeAction="idle",n.direction={x:0,y:0},I.SUCCESS},"Join Herd",e+1)],"Prey Herd Behavior",e)}function iC(e){return new ge([new ie((n,r,o)=>{if(n.hunger>100||n.hitpoints<n.maxHitpoints*.4||n.activeAction==="attacking"||n.activeAction==="procreating")return!1;const l=De(n,r.gameState,"predator",bi*4,a=>a.id!==n.id&&a.hitpoints>0&&a.isAdult&&n.fatherId!==void 0&&a.fatherId===n.fatherId&&a.age>=n.age||a.hitpoints>n.hitpoints);return l&&X(n.position,l.position,r.gameState.mapDimensions.width,r.gameState.mapDimensions.height)>bi*2?(o.set("packLeader",l),!0):!1},"Find Pack Leader",e+1),new le((n,r,o)=>{const l=o.get("packLeader");if(!l||l.hitpoints<=0)return I.FAILURE;if(X(n.position,l.position,r.gameState.mapDimensions.width,r.gameState.mapDimensions.height)>bi*2){n.activeAction="moving",n.target=l.id;const c=$e(n.position,l.position,r.gameState.mapDimensions.width,r.gameState.mapDimensions.height);return n.direction=tt(c),I.RUNNING}else return n.activeAction="idle",n.direction={x:0,y:0},I.SUCCESS},"Follow Pack Leader",e+1)],"Predator Pack Behavior",e)}function rC(e){return new ge([new ie((n,r,o)=>{if(!n.isAdult||n.hitpoints<n.maxHitpoints*.6||n.hunger>120||n.attackCooldown&&n.attackCooldown>0)return!1;const l=De(n,r.gameState,"predator",Rm,a=>!!(a.id!==n.id&&a.hitpoints>0&&a.isAdult&&n.fatherId!==a.fatherId&&n.gender===a.gender&&n.fatherId!==void 0&&a.fatherId!==void 0));if(l){const a=X(n.position,l.position,r.gameState.mapDimensions.width,r.gameState.mapDimensions.height);if(a<=wn)return o.set("territorialTarget",l),!0;if(a<=Rm)return o.set("territorialTarget",l),o.set("needToApproach",!0),!0}return!1},"Find Territorial Rival",e+1),new le((n,r,o)=>{const l=o.get("territorialTarget"),a=o.get("needToApproach");if(!l||l.hitpoints<=0)return I.FAILURE;const c=X(n.position,l.position,r.gameState.mapDimensions.width,r.gameState.mapDimensions.height);if(c<=wn)return n.activeAction="attacking",n.attackTargetId=l.id,n.target=l.id,n.direction={x:0,y:0},o.delete("needToApproach"),I.RUNNING;if(a||c>wn){n.activeAction="moving",n.target=l.id;const d=$e(n.position,l.position,r.gameState.mapDimensions.width,r.gameState.mapDimensions.height);return n.direction=tt(d),I.RUNNING}return I.FAILURE},"Territorial Fight or Approach",e+1)],"Predator Territorial Defense",e)}function oC(){const e=new Rn([m_(2),O_(2),x_(2),k_(2),M_(2),F_(2),H_(2),new vs(C_(3),"Gated Leader Combat Strategy",2),new vs(G_(3),"Gated Diplomacy",2),R_(2),new sr(A_(3),"attack","Gated Attacking",2),g_(2),new jl(new sr(v_(4),"gathering","Gated Gathering",3),jd,"Timeout Gathering",2),new sr(E_(3),"feedChildren","Gated Feed Child",2),w_(2),new jl(new sr(__(4),"planting","Gated Planting",3),jd,"Timeout Planting",2),new sr(b_(3),"attack","Gated Hunt Prey",2),new sr(S_(3),"procreation","Gated Procreation",2),new js(D_(3),Vd,"Cache Tribe Split",2),new vs(B_(3),"Gated Tribe Migration",2),new js(P_(3),Vd,"Cache Establish Territory",2),new sr(L_(3),"followLeader","Gated Follow Leader",2),new vs(N_(2),"Gated Follow Patriarch",2),new vs(y_(2),"Gated Idle Wander",2)],"AI Root Selector",1);return new p_(e,"Manual Control Gate",0)}function sC(){return new Rn([z_(1),V_(1),X_(1),$_(1),W_(1),nC(1),Ev(1)],"Prey Behavior Root",0)}function aC(){return new Rn([K_(1),q_(1),eC(1),tC(1),rC(1),Q_(1),iC(1),Ev(1)],"Predator Behavior Root",0)}class Of{constructor(){me(this,"data",new Map);me(this,"nodeExecutionData",new Map)}set(n,r){this.data.set(n,r)}get(n){return this.data.get(n)}delete(n){this.data.delete(n)}has(n){return this.data.has(n)}recordNodeExecution(n,r,o,l,a){const c=this.nodeExecutionData.get(n)||{lastExecuted:0,status:I.FAILURE,depth:0,debugInfo:"",executionHistory:[]},d=c.executionHistory[c.executionHistory.length-1];d&&o-(d==null?void 0:d.time)>Ls&&c.executionHistory.push({time:d.time+Ls,status:I.NOT_EVALUATED}),c.executionHistory.push({time:o,status:r});const h=iv/wt*Et,g=o-h;c.executionHistory=c.executionHistory.filter(y=>y.time>=g);const m={...c,lastExecuted:o,status:r,depth:l,debugInfo:a};this.nodeExecutionData.set(n,m)}getNodeExecutionData(){return this.nodeExecutionData}cleanupOldEntries(n){const r=AT,o=[];for(const[l,a]of this.nodeExecutionData.entries())n-a.lastExecuted>r&&o.push(l);for(const l of o)this.nodeExecutionData.delete(l)}}function lC(e){e.gameState.entities.entities.forEach(r=>{d_(r,e)})}function wv(){return{entities:new Map,nextEntityId:1}}function Qs(e,n,r){const o={id:e.nextEntityId++,type:n,velocity:{x:0,y:0},direction:{x:0,y:0},acceleration:0,forces:[],debuffs:[],...r};return e.entities.set(o.id,o),o}function Zs(e,n,r){return Qs(e,"berryBush",{position:n,radius:Yd,food:Array.from({length:JA},()=>({type:li.Berry})).map(l=>({...l,id:e.nextEntityId++})),maxFood:ZA,lifespan:tT,age:0,spreadRadius:Yd,timeSinceLastBerryRegen:0,timeSinceLastSpreadAttempt:0,timeSinceLastHarvest:0,stateMachine:[Rs,{enteredAt:r,previousState:void 0}]})}function Vl(e,n,r,o,l=!1,a=KT,c=U0,d,h,g=[],m,y){const S=a>=uf;return Qs(e,"human",{position:n,radius:S?St:_o,hunger:c,hitpoints:im,maxHitpoints:im,age:a,gender:o,isPlayer:l,food:[],maxFood:F0,maxAge:Bs,isAdult:S,isPregnant:!1,gestationTime:0,procreationCooldown:0,attackCooldown:0,motherId:d,fatherId:h,ancestorIds:g,stateMachine:[It,{enteredAt:r,previousState:void 0}],leaderId:m,tribeBadge:y,aiType:qs.BehaviorTreeBased,aiBehaviorTree:oC(),aiBlackboard:new Of})}function Mf(e,n,r,o,l,a,c,d,h,g,m){let y,S;switch(c){case"human":y=B0,S=Tr;break;case"prey":y=2,S=120;break;case"predator":y=4,S=140;break}return Qs(e,"corpse",{position:n,radius:l,gender:r,age:o,originalEntityId:a,originalEntityType:c,timeOfDeath:d,decayProgress:0,geneCode:m,food:[...Array.from({length:Math.max(y*Math.max(S-g,0)/S,0)},()=>({type:li.Meat})),...h].map(C=>({...C,id:e.nextEntityId++})),stateMachine:void 0})}function uC(e,n,r,o,l,a,c,d,h){return Mf(e,n,r,o,l,a,"human",c,d,h)}function cC(e,n,r,o,l,a,c,d){return Mf(e,n,r,o,l,a,"prey",c,[],0,d)}function dC(e,n,r,o,l,a,c,d){return Mf(e,n,r,o,l,a,"predator",c,[],0,d)}function fC(e,n,r){const o=n?r.gameState.entities.entities.get(n):void 0,l=[...e.ancestorIds||[],e.id],a=o?[...o.ancestorIds||[],o.id]:[],c=[...l,...a],d=[...new Set(c)],h=d.slice(Math.max(d.length-YT,0)),g=Math.random()<.5?"male":"female",m=Wn(e.position,{x:5,y:5}),y=Vl(r.gameState.entities,m,r.gameState.time,g,!1,0,U0/2,e.id,n,h,(o==null?void 0:o.leaderId)??e.leaderId,(o==null?void 0:o.tribeBadge)??e.tribeBadge);return Me(r,Te.Birth,e.position),y}function Js(e,n){return e.entities.get(n)?(e.entities.delete(n),!0):!1}function Io(e,n,r,o=Nw,l=gv,a,c,d){const h=o>=Ds,g=Date.now();return Qs(e,"prey",{position:n,radius:h?St*.7:_o*.7,hunger:l,hitpoints:_m,maxHitpoints:_m,age:o,maxAge:pv,gender:r,isAdult:h,isPregnant:!1,gestationTime:0,procreationCooldown:0,geneCode:a,motherId:c,fatherId:d,stateMachine:[En,{enteredAt:g,previousState:void 0}],aiType:qs.BehaviorTreeBased,aiBehaviorTree:sC(),aiBlackboard:new Of})}function Eo(e,n,r,o=Lw,l=vv,a,c,d){const h=o>=ks,g=Date.now();return Qs(e,"predator",{position:n,radius:h?St*.9:_o*.9,hunger:l,hitpoints:Cm,maxHitpoints:Cm,age:o,maxAge:mv,gender:r,isAdult:h,isPregnant:!1,gestationTime:0,procreationCooldown:0,geneCode:a,motherId:c,fatherId:d,stateMachine:[Bt,{enteredAt:g,previousState:void 0}],aiType:qs.BehaviorTreeBased,aiBehaviorTree:aC(),aiBlackboard:new Of})}class hC{constructor(){this.ids=[],this.values=[],this.length=0}clear(){this.length=0}push(n,r){let o=this.length++;for(;o>0;){const l=o-1>>1,a=this.values[l];if(r>=a)break;this.ids[o]=this.ids[l],this.values[o]=a,o=l}this.ids[o]=n,this.values[o]=r}pop(){if(this.length===0)return;const n=this.ids[0];if(this.length--,this.length>0){const r=this.ids[0]=this.ids[this.length],o=this.values[0]=this.values[this.length],l=this.length>>1;let a=0;for(;a<l;){let c=(a<<1)+1;const d=c+1;let h=this.ids[c],g=this.values[c];const m=this.values[d];if(d<this.length&&m<g&&(c=d,h=this.ids[d],g=m),g>=o)break;this.ids[a]=h,this.values[a]=g,a=c}this.ids[a]=r,this.values[a]=o}return n}peek(){if(this.length!==0)return this.ids[0]}peekValue(){if(this.length!==0)return this.values[0]}shrink(){this.ids.length=this.values.length=this.length}}const Om=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array],Nd=3;class Ff{static from(n,r=0){if(r%8!==0)throw new Error("byteOffset must be 8-byte aligned.");if(!n||n.byteLength===void 0||n.buffer)throw new Error("Data must be an instance of ArrayBuffer or SharedArrayBuffer.");const[o,l]=new Uint8Array(n,r+0,2);if(o!==251)throw new Error("Data does not appear to be in a Flatbush format.");const a=l>>4;if(a!==Nd)throw new Error(`Got v${a} data when expected v${Nd}.`);const c=Om[l&15];if(!c)throw new Error("Unrecognized array type.");const[d]=new Uint16Array(n,r+2,1),[h]=new Uint32Array(n,r+4,1);return new Ff(h,d,c,void 0,n,r)}constructor(n,r=16,o=Float64Array,l=ArrayBuffer,a,c=0){if(n===void 0)throw new Error("Missing required argument: numItems.");if(isNaN(n)||n<=0)throw new Error(`Unexpected numItems value: ${n}.`);this.numItems=+n,this.nodeSize=Math.min(Math.max(+r,2),65535),this.byteOffset=c;let d=n,h=d;this._levelBounds=[d*4];do d=Math.ceil(d/this.nodeSize),h+=d,this._levelBounds.push(h*4);while(d!==1);this.ArrayType=o,this.IndexArrayType=h<16384?Uint16Array:Uint32Array;const g=Om.indexOf(this.ArrayType),m=h*4*this.ArrayType.BYTES_PER_ELEMENT;if(g<0)throw new Error(`Unexpected typed array class: ${o}.`);a&&a.byteLength!==void 0&&!a.buffer?(this.data=a,this._boxes=new this.ArrayType(this.data,c+8,h*4),this._indices=new this.IndexArrayType(this.data,c+8+m,h),this._pos=h*4,this.minX=this._boxes[this._pos-4],this.minY=this._boxes[this._pos-3],this.maxX=this._boxes[this._pos-2],this.maxY=this._boxes[this._pos-1]):(this.data=new l(8+m+h*this.IndexArrayType.BYTES_PER_ELEMENT),this._boxes=new this.ArrayType(this.data,8,h*4),this._indices=new this.IndexArrayType(this.data,8+m,h),this._pos=0,this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0,new Uint8Array(this.data,0,2).set([251,(Nd<<4)+g]),new Uint16Array(this.data,2,1)[0]=r,new Uint32Array(this.data,4,1)[0]=n),this._queue=new hC}add(n,r,o=n,l=r){const a=this._pos>>2,c=this._boxes;return this._indices[a]=a,c[this._pos++]=n,c[this._pos++]=r,c[this._pos++]=o,c[this._pos++]=l,n<this.minX&&(this.minX=n),r<this.minY&&(this.minY=r),o>this.maxX&&(this.maxX=o),l>this.maxY&&(this.maxY=l),a}finish(){if(this._pos>>2!==this.numItems)throw new Error(`Added ${this._pos>>2} items when expected ${this.numItems}.`);const n=this._boxes;if(this.numItems<=this.nodeSize){n[this._pos++]=this.minX,n[this._pos++]=this.minY,n[this._pos++]=this.maxX,n[this._pos++]=this.maxY;return}const r=this.maxX-this.minX||1,o=this.maxY-this.minY||1,l=new Uint32Array(this.numItems),a=65535;for(let c=0,d=0;c<this.numItems;c++){const h=n[d++],g=n[d++],m=n[d++],y=n[d++],S=Math.floor(a*((h+m)/2-this.minX)/r),_=Math.floor(a*((g+y)/2-this.minY)/o);l[c]=gC(S,_)}Zd(l,n,this._indices,0,this.numItems-1,this.nodeSize);for(let c=0,d=0;c<this._levelBounds.length-1;c++){const h=this._levelBounds[c];for(;d<h;){const g=d;let m=n[d++],y=n[d++],S=n[d++],_=n[d++];for(let C=1;C<this.nodeSize&&d<h;C++)m=Math.min(m,n[d++]),y=Math.min(y,n[d++]),S=Math.max(S,n[d++]),_=Math.max(_,n[d++]);this._indices[this._pos>>2]=g,n[this._pos++]=m,n[this._pos++]=y,n[this._pos++]=S,n[this._pos++]=_}}}search(n,r,o,l,a){if(this._pos!==this._boxes.length)throw new Error("Data not yet indexed - call index.finish().");let c=this._boxes.length-4;const d=[],h=[];for(;c!==void 0;){const g=Math.min(c+this.nodeSize*4,Fm(c,this._levelBounds));for(let m=c;m<g;m+=4){if(o<this._boxes[m]||l<this._boxes[m+1]||n>this._boxes[m+2]||r>this._boxes[m+3])continue;const y=this._indices[m>>2]|0;c>=this.numItems*4?d.push(y):(a===void 0||a(y))&&h.push(y)}c=d.pop()}return h}neighbors(n,r,o=1/0,l=1/0,a){if(this._pos!==this._boxes.length)throw new Error("Data not yet indexed - call index.finish().");let c=this._boxes.length-4;const d=this._queue,h=[],g=l*l;e:for(;c!==void 0;){const m=Math.min(c+this.nodeSize*4,Fm(c,this._levelBounds));for(let y=c;y<m;y+=4){const S=this._indices[y>>2]|0,_=Mm(n,this._boxes[y],this._boxes[y+2]),C=Mm(r,this._boxes[y+1],this._boxes[y+3]),T=_*_+C*C;T>g||(c>=this.numItems*4?d.push(S<<1,T):(a===void 0||a(S))&&d.push((S<<1)+1,T))}for(;d.length&&d.peek()&1;)if(d.peekValue()>g||(h.push(d.pop()>>1),h.length===o))break e;c=d.length?d.pop()>>1:void 0}return d.clear(),h}}function Mm(e,n,r){return e<n?n-e:e<=r?0:e-r}function Fm(e,n){let r=0,o=n.length-1;for(;r<o;){const l=r+o>>1;n[l]>e?o=l:r=l+1}return n[r]}function Zd(e,n,r,o,l,a){if(Math.floor(o/a)>=Math.floor(l/a))return;const c=e[o+l>>1];let d=o-1,h=l+1;for(;;){do d++;while(e[d]<c);do h--;while(e[h]>c);if(d>=h)break;pC(e,n,r,d,h)}Zd(e,n,r,o,h,a),Zd(e,n,r,h+1,l,a)}function pC(e,n,r,o,l){const a=e[o];e[o]=e[l],e[l]=a;const c=4*o,d=4*l,h=n[c],g=n[c+1],m=n[c+2],y=n[c+3];n[c]=n[d],n[c+1]=n[d+1],n[c+2]=n[d+2],n[c+3]=n[d+3],n[d]=h,n[d+1]=g,n[d+2]=m,n[d+3]=y;const S=r[o];r[o]=r[l],r[l]=S}function gC(e,n){let r=e^n,o=65535^r,l=65535^(e|n),a=e&(n^65535),c=r|o>>1,d=r>>1^r,h=l>>1^o&a>>1^l,g=r&l>>1^a>>1^a;r=c,o=d,l=h,a=g,c=r&r>>2^o&o>>2,d=r&o>>2^o&(r^o)>>2,h^=r&l>>2^o&a>>2,g^=o&l>>2^(r^o)&a>>2,r=c,o=d,l=h,a=g,c=r&r>>4^o&o>>4,d=r&o>>4^o&(r^o)>>4,h^=r&l>>4^o&a>>4,g^=o&l>>4^(r^o)&a>>4,r=c,o=d,l=h,a=g,h^=r&l>>8^o&a>>8,g^=o&l>>8^(r^o)&a>>8,r=h^h>>1,o=g^g>>1;let m=e^n,y=o|65535^(m|r);return m=(m|m<<8)&16711935,m=(m|m<<4)&252645135,m=(m|m<<2)&858993459,m=(m|m<<1)&1431655765,y=(y|y<<8)&16711935,y=(y|y<<4)&252645135,y=(y|y<<2)&858993459,y=(y|y<<1)&1431655765,(y<<1|m)>>>0}function Ss(e,n){if(e.length===0)return{byRect:()=>[],byRadius:()=>[],byProperty:()=>[],resetPropertyCache:()=>{},count:()=>0};const r=new Ff(e.length),o=new Map;for(const a of e)r.add(a.position.x,a.position.y,a.position.x,a.position.y);return r.finish(),{byRect(a){return r.search(a.left,a.top,a.right,a.bottom).map(d=>e[d])},byRadius(a,c){return r.neighbors(a.x,a.y,void 0,c).map(h=>e[h])},byProperty(a,c){var d;if(!o.has(a)){const h=new Map;for(const g of e){const m=g[a];h.has(m)||h.set(m,[]),h.get(m).push(g)}o.set(a,h)}return((d=o.get(a))==null?void 0:d.get(c))||[]},resetPropertyCache(){o.clear()},count(){return e.length}}}function Uf(e){const n=Array.from(e.entities.entities.values()),r=n.filter(h=>h.type==="human"),o=n.filter(h=>h.type==="berryBush"),l=n.filter(h=>h.type==="corpse"),a=n.filter(h=>h.type==="prey"),c=n.filter(h=>h.type==="predator");return{...e,search:{human:Ss(r),berryBush:Ss(o),corpse:Ss(l),prey:Ss(a),predator:Ss(c)}}}var Ht=(e=>(e.MOVE="MOVE",e.HUNGER="HUNGER",e.EAT="EAT",e.FIND_BUSH="FIND_BUSH",e.GATHER="GATHER",e.PROCREATE="PROCREATE",e.PLANT_BUSH="PLANT_BUSH",e.AUTOPILOT="AUTOPILOT",e.ANIMALS_INTRODUCTION="ANIMALS_INTRODUCTION",e.HUNT_PREY="HUNT_PREY",e.DEFEND_FROM_PREDATORS="DEFEND_FROM_PREDATORS",e))(Ht||{}),Sr=(e=>(e.HUNGER_BAR="HUNGER_BAR",e.FOOD_BAR="FOOD_BAR",e.COMMAND_BUTTONS="COMMAND_BUTTONS",e))(Sr||{}),Lt=(e=>(e[e.FADING_IN=0]="FADING_IN",e[e.ACTIVE=1]="ACTIVE",e[e.FADING_OUT=2]="FADING_OUT",e[e.INACTIVE=3]="INACTIVE",e))(Lt||{});const mC=[{key:Ht.MOVE,title:"Movement",text:"Use WASD or Arrow Keys to move your character around the world.",condition:e=>e.hasPlayerMovedEver||e.hasPlayerEnabledAutopilot>2,isCompleted:!1},{key:Ht.HUNGER,title:"Hunger",text:"Your character gets hungry over time. Watch the hunger bar!",condition:(e,n)=>n.hunger>jT,isCompleted:!1,minDisplayTime:vm,highlightedUIElements:[Sr.HUNGER_BAR]},{key:Ht.FIND_BUSH,title:"Find Food",text:"Look for berry bushes. They are your primary source of food.",condition:(e,n)=>!!De(n,e,"berryBush",vt*5,o=>o.food.length>0),getTargets:(e,n)=>{const r=[];for(const o of e.entities.entities.values())o.type==="berryBush"&&o.food.length>0&&X(n.position,o.position,e.mapDimensions.width,e.mapDimensions.height)<500&&r.push(o);return r.map(o=>o.id)},isCompleted:!1,minDisplayTime:vm},{key:Ht.GATHER,title:"Gather Berries",text:"Get close to a bush and press 'E' to gather berries.",condition:(e,n)=>n.food.length>0,getTargets:(e,n)=>{const r=De(n,e,"berryBush",vt,o=>o.food.length>0);return r?[r.id]:[]},isCompleted:!1},{key:Ht.EAT,title:"Eat",text:"When you are hungry and have food, press 'F' to eat.",condition:(e,n)=>n.activeAction==="eating",isCompleted:!1,highlightedUIElements:[Sr.FOOD_BAR]},{key:Ht.PROCREATE,title:"Procreate",text:"Find a mate and press 'R' to start a family. This is how you continue your lineage.",condition:(e,n)=>Ct(e,n).length>0,getTargets:(e,n)=>{const r=De(n,e,"human",vt,o=>wr(n,o,e));return r?[r.id]:[]},isCompleted:!1},{key:Ht.PLANT_BUSH,title:"Farming",text:"You can plant new berry bushes. Carry some berries and press 'B' to plant.",condition:(e,n)=>Nf(e,n).some(o=>o.type===_e.Plant)||e.hasPlayerPlantedBush===!0,isCompleted:!1},{key:Ht.AUTOPILOT,title:"Autopilot!",text:"You can turn autopilot for specific actions, press Shift and click on the action button to enable it.",condition:e=>e.hasPlayerEnabledAutopilot>2,highlightedUIElements:[Sr.COMMAND_BUTTONS],isCompleted:!1},{key:Ht.ANIMALS_INTRODUCTION,title:"Wild Animals!",text:"Your world now has wild animals! Prey provide meat when hunted, but beware of predators that may attack.",condition:e=>Array.from(e.entities.entities.values()).some(r=>r.type==="prey"||r.type==="predator"),isCompleted:!1,dependsOn:Ht.AUTOPILOT},{key:Ht.HUNT_PREY,title:"Hunt for Meat",text:"Click on prey animals to hunt them for meat. Hunting provides more food than gathering berries!",condition:(e,n)=>{const r=De(n,e,"prey",150);return n.hunger>40&&!!r},getTargets:(e,n)=>{const r=De(n,e,"prey",150);return r?[r.id]:[]},isCompleted:!1,dependsOn:Ht.ANIMALS_INTRODUCTION},{key:Ht.DEFEND_FROM_PREDATORS,title:"Predators",text:"Predators may attack when hungry! Click on them to fight back. Fighting together with family is more effective.",condition:(e,n)=>!!De(n,e,"predator",120),getTargets:(e,n)=>{const r=De(n,e,"predator",120);return r?[r.id]:[]},isCompleted:!1,dependsOn:Ht.HUNT_PREY}];function _v(){return{steps:mC.map(e=>({...e,isCompleted:!1}))}}function Cv(){return{currentStepIndex:0,completedSteps:new Set,isActive:!0,transitionState:Lt.FADING_IN,transitionAlpha:0,highlightedEntityIds:new Set,stepStartTime:null,activeUIHighlights:new Set}}function vC(e){for(let n=0;n<e.tutorial.steps.length;n++){const r=e.tutorial.steps[n];if(!r.isCompleted)if(r.dependsOn){if(e.tutorialState.completedSteps.has(r.dependsOn))return n}else return n}return null}function yC(e,n){const r=e.tutorialState;if(!r.isActive){r.transitionState=Lt.INACTIVE,r.highlightedEntityIds.clear(),r.activeUIHighlights.clear();return}const o=yt(e);if(!o){r.isActive=!1,r.transitionState=Lt.INACTIVE,r.highlightedEntityIds.clear(),r.activeUIHighlights.clear();return}const l=e.tutorial.steps[r.currentStepIndex];if(!l){r.isActive=!1,r.transitionState=Lt.INACTIVE,r.highlightedEntityIds.clear(),r.activeUIHighlights.clear();return}const a=1/wE;switch(r.transitionState){case Lt.FADING_IN:r.stepStartTime===null&&(r.stepStartTime=e.time),r.transitionAlpha+=a*n,r.transitionAlpha>=1&&(r.transitionAlpha=1,r.transitionState=Lt.ACTIVE);break;case Lt.ACTIVE:{e.time-(r.stepStartTime||e.time)>=(l.minDisplayTime||0)&&l.condition(e,o)&&(l.isCompleted=!0,r.completedSteps.add(l.key),r.transitionState=Lt.FADING_OUT);break}case Lt.FADING_OUT:if(r.transitionAlpha-=a*n,r.transitionAlpha<=0){r.transitionAlpha=0,r.stepStartTime=null;const d=vC(e);d!==null?(r.currentStepIndex=d,r.transitionState=Lt.FADING_IN):(r.isActive=!1,r.transitionState=Lt.INACTIVE)}break}r.transitionState!==Lt.FADING_OUT&&r.transitionState!==Lt.INACTIVE?(l.getTargets?r.highlightedEntityIds=new Set(l.getTargets(e,o)):r.highlightedEntityIds.clear(),l.highlightedUIElements?r.activeUIHighlights=new Set(l.highlightedUIElements):r.activeUIHighlights.clear()):(r.highlightedEntityIds.clear(),r.activeUIHighlights.clear())}function SC(){const e=wv(),n=0;for(let y=0;y<C0;y++){const S={x:Math.random()*Je,y:Math.random()*et};Zs(e,S,n)}const r=Je/2,o=et/2,l=Vl(e,{x:r,y:o},n,"male",!0);Vl(e,{x:r+50,y:o},n,"female",!1);for(let y=0;y<Av;y++){const S={x:r+Je*(Math.random()-Math.random()),y:o+et*(Math.random()-Math.random())};Io(e,S,"male",void 0,void 0,Ws()),Io(e,{x:S.x+20,y:S.y},"female",void 0,void 0,Ws())}const a={x:r+Je*(Math.random()-Math.random()),y:o+et*(Math.random()-Math.random())};Eo(e,a,"male",void 0,void 0,Ys()),Eo(e,{x:a.x+20,y:a.y},"female",void 0,void 0,Ys());const c=[{id:"muteButton",action:Ce.ToggleMute,currentWidth:ii,rect:{x:0,y:0,width:0,height:0},text:"",backgroundColor:"",textColor:In},{id:"pauseButton",action:Ce.TogglePause,currentWidth:ii,rect:{x:0,y:0,width:0,height:0},text:"",backgroundColor:"",textColor:In},{id:"returnToIntroButton",action:Ce.ReturnToIntro,currentWidth:ii,rect:{x:0,y:0,width:0,height:0},text:"EXIT",backgroundColor:"",textColor:In}],d=_v(),h=Cv(),g={time:n,entities:e,mapDimensions:{width:Je,height:et},generationCount:1,gameOver:!1,visualEffects:[],nextVisualEffectId:0,viewportCenter:{...l.position},isPaused:!1,exitConfirmation:"inactive",autopilotControls:{behaviors:{procreation:!1,planting:!1,gathering:!1,attack:!1,feedChildren:!0,followLeader:!1},hoveredAutopilotAction:void 0,activeAutopilotAction:void 0,isManuallyMoving:!1},hasPlayerMovedEver:!1,hasPlayerPlantedBush:!1,hasPlayerEnabledAutopilot:0,masterVolume:dv,isMuted:!1,uiButtons:c,tutorial:d,tutorialState:h,debugPanel:Xt.None,performanceMetrics:{currentBucket:{renderTime:0,worldUpdateTime:0,aiUpdateTime:0},history:[]},hoveredButtonId:void 0,mousePosition:{x:0,y:0},notifications:[{id:"welcome",type:xs.Hello,message:"Welcome to the game!",duration:50,targetEntityIds:[l.id],highlightedEntityIds:[l.id],timestamp:0,isDismissed:!1,creationTime:Date.now()}],ecosystem:{preyGestationPeriod:pr,preyProcreationCooldown:gr,predatorGestationPeriod:mr,predatorProcreationCooldown:vr,preyHungerIncreasePerHour:Li,predatorHungerIncreasePerHour:Bi,berryBushSpreadChance:ai}},m=Uf(g);return console.log("Game world initialized:",m),m}function AC(){const e=wv(),n=0;for(let c=0;c<C0;c++){const d={x:Math.random()*Je,y:Math.random()*et};Zs(e,d,n)}for(let c=0;c<KA;c++){const d={x:Math.random()*Je,y:Math.random()*et},h=Math.random()<.5?"male":"female";Vl(e,d,n,h,!1)}for(let c=0;c<Av;c++){const d={x:Math.random()*Je,y:Math.random()*et};Io(e,d,"male",void 0,void 0,Ws()),Io(e,{x:d.x+20,y:d.y},"female",void 0,void 0,Ws())}const r={x:Math.random()*Je,y:Math.random()*et};Eo(e,r,"male",void 0,void 0,Ys()),Eo(e,{x:r.x+20,y:r.y},"female",void 0,void 0,Ys());const o=_v(),l=Cv(),a={time:n,entities:e,mapDimensions:{width:Je,height:et},generationCount:0,gameOver:!1,visualEffects:[],nextVisualEffectId:0,viewportCenter:{x:Je/2,y:et/2},isPaused:!1,exitConfirmation:"inactive",autopilotControls:{behaviors:{procreation:!1,planting:!1,gathering:!1,attack:!1,feedChildren:!0,followLeader:!1},hoveredAutopilotAction:void 0,activeAutopilotAction:void 0,isManuallyMoving:!1},hasPlayerMovedEver:!1,hasPlayerPlantedBush:!1,hasPlayerEnabledAutopilot:0,masterVolume:dv,isMuted:!0,uiButtons:[],tutorial:o,tutorialState:l,debugPanel:Xt.None,performanceMetrics:{currentBucket:{renderTime:0,worldUpdateTime:0,aiUpdateTime:0},history:[]},hoveredButtonId:void 0,mousePosition:{x:0,y:0},notifications:[],ecosystem:{preyGestationPeriod:pr,preyProcreationCooldown:gr,predatorGestationPeriod:mr,predatorProcreationCooldown:vr,preyHungerIncreasePerHour:Li,predatorHungerIncreasePerHour:Bi,berryBushSpreadChance:ai}};return Uf(a)}const TC="humanProcreation",IC="human",EC="human",wC=vt,_C=(e,n,r)=>wr(e,n,r.gameState)?e.gender==="male"?e.activeAction==="procreating":e.activeAction==="procreating"&&n.activeAction==="procreating":!1,CC=(e,n,r)=>{var h,g;const{gameState:o}=r,l={x:(e.position.x+n.position.x)/2,y:(e.position.y+n.position.y)/2},a=e.gender==="male"?e:n,c=e.gender==="female"?e:n,d=(a.partnerIds||[]).length===0;if(e.stateMachine=[$s,{partnerId:n.id,previousState:(h=e.stateMachine)==null?void 0:h[0]}],n.stateMachine=[$s,{partnerId:e.id,previousState:(g=n.stateMachine)==null?void 0:g[0]}],e.partnerIds||(e.partnerIds=[]),e.partnerIds.includes(n.id)||e.partnerIds.push(n.id),n.partnerIds||(n.partnerIds=[]),n.partnerIds.includes(e.id)||n.partnerIds.push(e.id),d&&a.leaderId&&a.leaderId!==a.id){const m=o.entities.entities.get(a.leaderId);if(m){const y=Xd(a,m),S=Xd(c,m);if(!y&&!S){const _=qd();a.leaderId=a.id,a.tribeBadge=_,a.diplomacy=new Map,c.leaderId=a.id,c.tribeBadge=_}}}else if(!e.leaderId&&!n.leaderId&&a&&c){const m=qd();a.leaderId=a.id,a.tribeBadge=m,a.diplomacy=new Map,c.leaderId=a.id,c.tribeBadge=m}e.activeAction=void 0,Re(o,se.Procreation,l,fr),Re(o,se.Partnered,e.position,Be,e.id),Re(o,se.Partnered,n.position,Be,n.id),e.lastPartneredEffectTime=o.time,n.lastPartneredEffectTime=o.time,n.activeAction=void 0,Me(r,Te.Procreate,l)},RC={id:TC,sourceType:IC,targetType:EC,maxDistance:wC,checker:_C,perform:CC},PC={id:"humanChildFeeding",sourceType:"human",targetType:"human",maxDistance:df,checker:(e,n)=>e.isAdult===!0&&e.food.length>0&&(!e.feedChildCooldownTime||e.feedChildCooldownTime<=0)&&n.isAdult===!1&&(n.motherId===e.id||n.fatherId===e.id)&&n.hunger>=xi&&e.activeAction==="feeding",perform:(e,n,r)=>{e.food.pop(),n.hunger=Math.max(0,n.hunger-xi),e.feedChildCooldownTime=iI,(!n.lastChildFedEffectTime||r.gameState.time-n.lastChildFedEffectTime>2)&&(Re(r.gameState,se.ChildFed,n.position,Be,n.id),n.lastChildFedEffectTime=r.gameState.time),Me(r,Te.ChildFed,n.position)}},NC={id:"human-attack",sourceType:"human",targetType:"human",maxDistance:$n,checker:(e,n,r)=>{var a;if(((a=e.stateMachine)==null?void 0:a[0])!==zi||e.attackTargetId!==n.id||(e.attackCooldown||0)>0)return!1;const o=e.stateMachine[1];return r.gameState.time-o.attackStartTime>=G0},perform:(e,n,r)=>{const o=$e(e.position,n.position,r.gameState.mapDimensions.width,r.gameState.mapDimensions.height),l=SI(tt(o),n.direction);if(Math.abs(l)<gI*Math.PI/180&&Math.random()<mI)Re(r.gameState,se.AttackDeflected,n.position,Be,n.id);else{let d=ff;e.gender==="male"&&(d*=fI),e.isAdult||(d*=hI),(!n.isAdult||n.age>=L0)&&e.isAdult&&(d*=pI),n.hitpoints-=d,n.movementSlowdown={modifier:hf,endTime:r.gameState.time+pf},Re(r.gameState,se.Hit,n.position,Be,n.id);const g=$e(e.position,n.position,r.gameState.mapDimensions.width,r.gameState.mapDimensions.height),m=_t(g,uI);n.forces.push(m),n.hitpoints<=0?Me(r,Te.HumanDeath,n.position):Me(r,Te.Attack,e.position)}e.attackCooldown=iu;const c=e.stateMachine[1];c.attackStartTime=r.gameState.time,Re(r.gameState,se.Attack,e.position,Be,e.id)}},DC={id:"human-collision",sourceType:"human",targetType:"human",maxDistance:St*2,checker:(e,n,{gameState:r})=>X(e.position,n.position,r.mapDimensions.width,r.mapDimensions.height)<(e.radius+n.radius)/3,perform:(e,n,{gameState:r})=>{const o=X(e.position,n.position,r.mapDimensions.width,r.mapDimensions.height);if(o===0){e.forces.push({x:.1,y:0}),n.forces.push({x:-.1,y:0});return}const a=(e.radius+n.radius-o)*.05,c=tt(b0(e.position,n.position)),d=_t(c,a);e.forces.push(d),n.forces.push(_t(d,-1))}},kC={id:"humanBerryBushGather",sourceType:"human",targetType:"berryBush",maxDistance:vt,checker:(e,n,r)=>{var o;return e.isAdult&&n.food.length>0&&((o=e.stateMachine)==null?void 0:o[0])===su&&e.food.length<e.maxFood&&(!e.gatheringCooldownTime||e.gatheringCooldownTime<r.gameState.time)||!1},perform:(e,n,r)=>{const o=n.food.pop();o&&e.food.push(o),e.gatheringCooldownTime=r.gameState.time+1,n.timeSinceLastHarvest=r.gameState.time,n.ownerId=e.id,n.claimedUntil=r.gameState.time+R0,Re(r.gameState,se.BushClaimed,n.position,Be),Me(r,Te.Gather,e.position)}},OC={id:"corpseGather",sourceType:"human",targetType:"corpse",maxDistance:vt,checker:(e,n,r)=>{var o;return e.isAdult&&n.food.length>0&&((o=e.stateMachine)==null?void 0:o[0])===su&&e.food.length<e.maxFood&&(!e.gatheringCooldownTime||e.gatheringCooldownTime<r.gameState.time)||!1},perform:(e,n,r)=>{const o=n.food.pop();o&&e.food.push(o),e.gatheringCooldownTime=r.gameState.time+1,Me(r,Te.Gather,e.position)}},MC=[kC,OC],FC={id:"prey-eat-berry-bush",sourceType:"prey",targetType:"berryBush",maxDistance:bt,checker:(e,n,r)=>!!(e.isAdult&&n.food.length>0&&e.hunger>30&&(!e.eatingCooldownTime||e.eatingCooldownTime<r.gameState.time)),perform:(e,n,r)=>{n.food.pop()&&(e.hunger=Math.max(0,e.hunger-25),n.lifespan-=Ow,n.timeSinceLastHarvest=r.gameState.time,e.eatingCooldownTime=r.gameState.time+kw,Re(r.gameState,se.BushClaimed,n.position,Be,e.id),Me(r,Te.Gather,e.position))}},UC={id:"predator-hunt-prey",sourceType:"predator",targetType:"prey",maxDistance:to,checker:(e,n,r)=>!!(e.isAdult&&e.hunger>50&&(!e.huntCooldown||e.huntCooldown<=0)&&n.hitpoints>0),perform:(e,n,r)=>{n.hitpoints-=Bw;const o=$e(e.position,n.position,r.gameState.mapDimensions.width,r.gameState.mapDimensions.height),l=_t(o,8);n.forces.push(l),e.huntCooldown=xw,n.hitpoints<=0?(Me(r,Te.HumanDeath,n.position),Re(r.gameState,se.Hit,n.position,Be,n.id)):(Re(r.gameState,se.Hit,n.position,Be,n.id),n.fleeCooldown=5,Me(r,Te.Attack,e.position)),Re(r.gameState,se.Attack,e.position,Be,e.id)}},HC={id:"human-hunt-prey",sourceType:"human",targetType:"prey",maxDistance:$n,checker:(e,n,r)=>{var o;return!!(((o=e.stateMachine)==null?void 0:o[0])===zi&&e.attackTargetId===n.id&&(!e.attackCooldown||e.attackCooldown<=0)&&n.hitpoints>0&&e.isAdult)},perform:(e,n,r)=>{let o=ff*1.2;e.gender==="male"&&(o*=1.3),n.hitpoints-=o;const l=$e(e.position,n.position,r.gameState.mapDimensions.width,r.gameState.mapDimensions.height),a=_t(l,6);n.forces.push(a),e.attackCooldown=iu,n.hitpoints<=0?(Me(r,Te.HumanDeath,n.position),Re(r.gameState,se.Hit,n.position,Be,n.id)):(Re(r.gameState,se.Hit,n.position,Be,n.id),n.fleeCooldown=8,Me(r,Te.Attack,e.position)),Re(r.gameState,se.Attack,e.position,Be,e.id)}},LC={id:"predator-attack-human",sourceType:"predator",targetType:"human",maxDistance:wn,checker:(e,n,r)=>{var o;return!!(e.isAdult&&(!e.attackCooldown||e.attackCooldown<=0)&&n.hitpoints>0&&(e.hunger>100||n.attackTargetId===e.id||n.attackTargetId&&((o=r.gameState.entities.entities.get(n.attackTargetId))==null?void 0:o.type)==="predator"))},perform:(e,n,r)=>{let o=yv;e.hunger>120&&(o*=1.3),n.hitpoints-=o,n.movementSlowdown={modifier:hf,endTime:r.gameState.time+pf};const l=$e(e.position,n.position,r.gameState.mapDimensions.width,r.gameState.mapDimensions.height),a=_t(l,7);n.forces.push(a),e.attackCooldown=Sv,n.hitpoints<=0?(e.hunger=Math.max(0,e.hunger-Df),Me(r,Te.HumanDeath,n.position),Re(r.gameState,se.Hit,n.position,Be,n.id)):(Re(r.gameState,se.Hit,n.position,Be,n.id),Me(r,Te.Attack,e.position)),Re(r.gameState,se.Attack,e.position,Be,e.id)}},BC={id:"human-attack-predator",sourceType:"human",targetType:"predator",maxDistance:$n,checker:(e,n,r)=>{var o;return!!(((o=e.stateMachine)==null?void 0:o[0])===zi&&e.attackTargetId===n.id&&(!e.attackCooldown||e.attackCooldown<=0)&&n.hitpoints>0&&e.isAdult)},perform:(e,n,r)=>{let o=ff*.8;e.gender==="male"&&(o*=1.2);const l=Array.from(r.gameState.entities.entities.values()).filter(d=>d.type==="human"&&d.id!==e.id).filter(d=>{const h=d;return Math.sqrt(Math.pow(h.position.x-e.position.x,2)+Math.pow(h.position.y-e.position.y,2))<100&&h.activeAction==="attacking"&&h.attackTargetId===n.id}).length;l>0&&(o*=1+l*.2),n.hitpoints-=o;const a=$e(e.position,n.position,r.gameState.mapDimensions.width,r.gameState.mapDimensions.height),c=_t(a,8);n.forces.push(c),e.attackCooldown=iu,n.hitpoints<=0?(Me(r,Te.HumanDeath,n.position),Re(r.gameState,se.Hit,n.position,Be,n.id)):(Re(r.gameState,se.Hit,n.position,Be,n.id),n.hitpoints<n.maxHitpoints*.3&&(n.hunger+=20),Me(r,Te.Attack,e.position)),Re(r.gameState,se.Attack,e.position,Be,e.id)}},GC={id:"prey-procreation",sourceType:"prey",targetType:"prey",maxDistance:bt,checker:(e,n,r)=>!!(e.isAdult&&n.isAdult&&e.gender!==n.gender&&e.id!==n.id&&!e.isPregnant&&!n.isPregnant&&e.hunger<200&&n.hunger<200&&(!e.procreationCooldown||e.procreationCooldown<=0)&&(!n.procreationCooldown||n.procreationCooldown<=0)),perform:(e,n,r)=>{const o=e.gender==="female"?e:n;o.isPregnant=!0,o.gestationTime=r.gameState.ecosystem.preyGestationPeriod,e.procreationCooldown=r.gameState.ecosystem.preyProcreationCooldown,n.procreationCooldown=r.gameState.ecosystem.preyProcreationCooldown,Re(r.gameState,se.Procreation,o.position,Be,o.id),Me(r,Te.Procreate,o.position)}},bC={id:"predator-procreation",sourceType:"predator",targetType:"predator",maxDistance:bi,checker:(e,n,r)=>!!(e.isAdult&&n.isAdult&&e.gender!==n.gender&&e.id!==n.id&&!e.isPregnant&&!n.isPregnant&&e.hunger<200&&n.hunger<200&&(!e.procreationCooldown||e.procreationCooldown<=0)&&(!n.procreationCooldown||n.procreationCooldown<=0)),perform:(e,n,r)=>{const o=e.gender==="female"?e:n;o.isPregnant=!0,o.pregnancyFatherId=e.gender==="male"?e.id:n.id,o.gestationTime=r.gameState.ecosystem.predatorGestationPeriod,e.procreationCooldown=r.gameState.ecosystem.predatorProcreationCooldown,n.procreationCooldown=r.gameState.ecosystem.predatorProcreationCooldown,Re(r.gameState,se.Procreation,o.position,Be,o.id),Me(r,Te.Procreate,o.position)}},xC={id:"preyChildFeeding",sourceType:"prey",targetType:"prey",maxDistance:Ro,checker:(e,n)=>e.isAdult===!0&&e.gender==="female"&&e.hunger<80&&(!e.feedChildCooldownTime||e.feedChildCooldownTime<=0)&&n.isAdult===!1&&(n.motherId===e.id||n.fatherId===e.id)&&n.hunger>=Yl&&e.activeAction==="feeding",perform:(e,n,r)=>{e.hunger=Math.min(120,e.hunger+10),n.hunger=Math.max(0,n.hunger-Yl),e.feedChildCooldownTime=Tv,(!n.lastChildFedEffectTime||r.gameState.time-n.lastChildFedEffectTime>2)&&(Re(r.gameState,se.ChildFed,n.position,Be,n.id),n.lastChildFedEffectTime=r.gameState.time),Me(r,Te.ChildFed,n.position)}},zC={id:"predatorChildFeeding",sourceType:"predator",targetType:"predator",maxDistance:Ro,checker:(e,n)=>e.isAdult===!0&&e.gender==="female"&&e.hunger<90&&(!e.feedChildCooldownTime||e.feedChildCooldownTime<=0)&&n.isAdult===!1&&(n.motherId===e.id||n.fatherId===e.id)&&n.hunger>=Yl&&e.activeAction==="feeding",perform:(e,n,r)=>{e.hunger=Math.min(140,e.hunger+15),n.hunger=Math.max(0,n.hunger-Yl),e.feedChildCooldownTime=Tv,(!n.lastChildFedEffectTime||r.gameState.time-n.lastChildFedEffectTime>2)&&(Re(r.gameState,se.ChildFed,n.position,Be,n.id),n.lastChildFedEffectTime=r.gameState.time),Me(r,Te.ChildFed,n.position)}},$C={id:"predator-eat-corpse",sourceType:"predator",targetType:"corpse",maxDistance:bi,checker:(e,n,r)=>!!(e.isAdult&&e.hunger>30&&n.food.length>0&&(!e.eatingCooldownTime||e.eatingCooldownTime<=r.gameState.time)),perform:(e,n,r)=>{n.food.pop()&&(e.hunger=Math.max(0,e.hunger-Df),e.eatingCooldownTime=r.gameState.time+2,Re(r.gameState,se.Eating,e.position,Be,e.id),Me(r,Te.Gather,e.position))}},WC={id:"predator-attack-rival",sourceType:"predator",targetType:"predator",maxDistance:wn,checker:(e,n,r)=>{var o;return!!(e.isAdult&&(!e.attackCooldown||e.attackCooldown<=0)&&n.hitpoints>0&&(e.hunger>100||n.attackTargetId===e.id||n.attackTargetId&&((o=r.gameState.entities.entities.get(n.attackTargetId))==null?void 0:o.type)==="predator"))},perform:(e,n,r)=>{let o=yv;e.hunger>120&&(o*=1.3),n.hitpoints-=o,n.movementSlowdown={modifier:hf,endTime:r.gameState.time+pf};const l=$e(e.position,n.position,r.gameState.mapDimensions.width,r.gameState.mapDimensions.height),a=_t(l,7);n.forces.push(a),e.attackCooldown=Sv,n.hitpoints<=0?(e.hunger=Math.max(0,e.hunger-Df),Me(r,Te.HumanDeath,n.position),Re(r.gameState,se.Hit,n.position,Be,n.id)):(Re(r.gameState,se.Hit,n.position,Be,n.id),Me(r,Te.Attack,e.position)),Re(r.gameState,se.Attack,e.position,Be,e.id)}},YC=[DC,...MC,RC,PC,NC,FC,xC,zC,$C,UC,HC,BC,LC,WC,GC,bC];function jC(e){const{gameState:n}=e,r=n,o=Array.from(n.entities.entities.values());for(const l of YC)for(const a of o){if(l.sourceType&&a.type!==l.sourceType)continue;const c=r.search[l.targetType].byRadius(a.position,l.maxDistance);for(const d of c){if(a.id===d.id)continue;X(a.position,d.position,n.mapDimensions.width,n.mapDimensions.height)<=l.maxDistance&&l.checker(a,d,e)&&l.perform(a,d,e)}}}function VC(e){e.visualEffects=e.visualEffects.filter(n=>e.time-n.startTime<=n.duration)}function XC(e){const n=e.search.berryBush.byProperty("type","berryBush"),r=e.search.predator.byProperty("type","predator"),o=e.search.human.byProperty("type","human");for(let l=0;l<20;l++){let a;if(n.length>0&&l<15){const h=n[Math.floor(Math.random()*n.length)],g=Math.random()*2*Math.PI,m=50+Math.random()*100;a={x:Math.max(50,Math.min(Je-50,h.position.x+Math.cos(g)*m)),y:Math.max(50,Math.min(et-50,h.position.y+Math.sin(g)*m))}}else a={x:50+Math.random()*(Je-100),y:50+Math.random()*(et-100)};let c=!0;const d=100;for(const h of r)if(Math.sqrt((a.x-h.position.x)**2+(a.y-h.position.y)**2)<d){c=!1;break}if(c){for(const h of o)if(Math.sqrt((a.x-h.position.x)**2+(a.y-h.position.y)**2)<d){c=!1;break}}if(c)return a}return{x:Je*.3+Math.random()*Je*.4,y:et*.3+Math.random()*et*.4}}function KC(e){const n=e.search.prey.byProperty("type","prey"),r=e.search.human.byProperty("type","human");for(let l=0;l<15;l++){let a;if(n.length>0&&l<10){const h=n[Math.floor(Math.random()*n.length)],g=Math.random()*2*Math.PI,m=100+Math.random()*150;a={x:Math.max(50,Math.min(Je-50,h.position.x+Math.cos(g)*m)),y:Math.max(50,Math.min(et-50,h.position.y+Math.sin(g)*m))}}else a={x:50+Math.random()*(Je-100),y:50+Math.random()*(et-100)};let c=!0;const d=150;for(const h of r)if(Math.sqrt((a.x-h.position.x)**2+(a.y-h.position.y)**2)<d){c=!1;break}if(c)return a}switch(Math.floor(Math.random()*4)){case 0:return{x:Math.random()*Je,y:50+Math.random()*100};case 1:return{x:Je-150+Math.random()*100,y:Math.random()*et};case 2:return{x:Math.random()*Je,y:et-150+Math.random()*100};default:return{x:50+Math.random()*100,y:Math.random()*et}}}function qC(e){const n=e.search.human.byProperty("type","human"),r=e.search.berryBush.byProperty("type","berryBush");for(let o=0;o<20;o++){const l={x:50+Math.random()*(Je-100),y:50+Math.random()*(et-100)};let a=!0;const c=80,d=60;for(const h of n)if(Math.sqrt((l.x-h.position.x)**2+(l.y-h.position.y)**2)<c){a=!1;break}if(a){for(const h of r)if(Math.sqrt((l.x-h.position.x)**2+(l.y-h.position.y)**2)<d){a=!1;break}}if(a)return l}return{x:Math.random()*Je,y:Math.random()*et}}function Rv(e,n=4){console.log(` Respawning ${n} prey to prevent extinction`);const r=e;for(let o=0;o<n;o++){const l=XC(r),a=o%2===0?"male":"female";Io(e.entities,l,a,void 0,void 0,Ws())}}function Pv(e,n=2){console.log(` Respawning ${n} predators to prevent extinction`);const r=e;for(let o=0;o<n;o++){const l=KC(r),a=o%2===0?"male":"female";Eo(e.entities,l,a,void 0,void 0,Ys())}}function QC(e){const n=e,r=n.search.prey.count(),o=n.search.predator.count();let l=!1;return r===0&&(Rv(e,6),l=!0),o===0&&(Pv(e,3),l=!0),l}function ZC(e){const n=e,r=n.search.prey.count(),o=n.search.predator.count(),l=n.search.berryBush.count();let a=!1;if(r>0&&r<5){const c=Math.max(2,Math.floor(8-r));Rv(e,c),a=!0}if(o>0&&o<2){const c=Math.max(1,Math.floor(3-o));Pv(e,c),a=!0}if(l<5){console.log(` Boosting bush count from ${l} to help ecosystem`);for(let c=0;c<5;c++){const d=qC(n);Zs(e.entities,d,e.time)}a=!0}return a}const JC=1,e1=.3,t1=.8,Um=.8,n1=.99,i1=.05;var Nv=(e=>(e[e.INCREASE_PREY_GESTATION=0]="INCREASE_PREY_GESTATION",e[e.DECREASE_PREY_GESTATION=1]="DECREASE_PREY_GESTATION",e[e.INCREASE_PREY_PROCREATION_COOLDOWN=2]="INCREASE_PREY_PROCREATION_COOLDOWN",e[e.DECREASE_PREY_PROCREATION_COOLDOWN=3]="DECREASE_PREY_PROCREATION_COOLDOWN",e[e.INCREASE_PREY_HUNGER=4]="INCREASE_PREY_HUNGER",e[e.DECREASE_PREY_HUNGER=5]="DECREASE_PREY_HUNGER",e[e.INCREASE_PREDATOR_GESTATION=6]="INCREASE_PREDATOR_GESTATION",e[e.DECREASE_PREDATOR_GESTATION=7]="DECREASE_PREDATOR_GESTATION",e[e.INCREASE_PREDATOR_PROCREATION_COOLDOWN=8]="INCREASE_PREDATOR_PROCREATION_COOLDOWN",e[e.DECREASE_PREDATOR_PROCREATION_COOLDOWN=9]="DECREASE_PREDATOR_PROCREATION_COOLDOWN",e[e.INCREASE_PREDATOR_HUNGER=10]="INCREASE_PREDATOR_HUNGER",e[e.DECREASE_PREDATOR_HUNGER=11]="DECREASE_PREDATOR_HUNGER",e[e.INCREASE_BUSH_SPREAD=12]="INCREASE_BUSH_SPREAD",e[e.DECREASE_BUSH_SPREAD=13]="DECREASE_BUSH_SPREAD",e[e.NO_ACTION=14]="NO_ACTION",e))(Nv||{});const Dd=Object.keys(Nv).length/2;class r1{constructor(){me(this,"qTable",new Map);me(this,"epsilon",Um);me(this,"lastState",null);me(this,"lastAction",null)}discretizeState(n,r,o){const l=Math.min(4,Math.floor(n/25)),a=Math.min(4,Math.floor(r/5)),c=Math.min(4,Math.floor(o/15));return`${l}-${a}-${c}`}getQValue(n,r){return this.qTable.has(n)||this.qTable.set(n,new Map),this.qTable.get(n).get(r)||0}setQValue(n,r,o){this.qTable.has(n)||this.qTable.set(n,new Map),this.qTable.get(n).set(r,o)}getBestAction(n){let r=0,o=this.getQValue(n,0);for(let l=1;l<Dd;l++){const a=this.getQValue(n,l);a>o&&(o=a,r=l)}return r}chooseAction(n){return Math.random()<this.epsilon?Math.floor(Math.random()*Dd):this.getBestAction(n)}applyEmergencyCorrections(n,r,o,l){n<ri*.5&&(l.ecosystem.preyGestationPeriod=Math.max(oo,l.ecosystem.preyGestationPeriod*.8),l.ecosystem.preyProcreationCooldown=Math.max(so,l.ecosystem.preyProcreationCooldown*.8),l.ecosystem.preyHungerIncreasePerHour=Math.max(uo,l.ecosystem.preyHungerIncreasePerHour*.9)),r<oi*.6&&(l.ecosystem.predatorGestationPeriod=Math.max(ao,l.ecosystem.predatorGestationPeriod*.75),l.ecosystem.predatorProcreationCooldown=Math.max(lo,l.ecosystem.predatorProcreationCooldown*.75),l.ecosystem.predatorHungerIncreasePerHour=Math.max(co,l.ecosystem.predatorHungerIncreasePerHour*.85)),o<si*.5&&(l.ecosystem.berryBushSpreadChance=Math.min(Is,l.ecosystem.berryBushSpreadChance*1.2)),n>ri*1.4&&(l.ecosystem.preyHungerIncreasePerHour=Math.min(Li,l.ecosystem.preyHungerIncreasePerHour*1.05)),r>oi*1.4&&(l.ecosystem.predatorHungerIncreasePerHour=Math.min(Bi,l.ecosystem.predatorHungerIncreasePerHour*1.05)),o>si*1.4&&(l.ecosystem.berryBushSpreadChance=Math.max(ai,l.ecosystem.berryBushSpreadChance*.95))}calculateReward(n,r,o){const l=Math.abs(n-ri),a=Math.abs(r-oi),c=Math.abs(o-si),d=l/ri,h=a/oi,g=c/si,m=d+h+g;return 100*Math.exp(-m*2)-50}applyAction(n,r){switch(n){case 0:r.ecosystem.preyGestationPeriod=Math.min(pr,r.ecosystem.preyGestationPeriod+.2*(pr-oo));break;case 1:r.ecosystem.preyGestationPeriod=Math.max(oo,r.ecosystem.preyGestationPeriod-.2*(pr-oo));break;case 2:r.ecosystem.preyProcreationCooldown=Math.min(gr,r.ecosystem.preyProcreationCooldown+.2*(gr-so));break;case 3:r.ecosystem.preyProcreationCooldown=Math.max(so,r.ecosystem.preyProcreationCooldown-.2*(gr-so));break;case 4:r.ecosystem.preyHungerIncreasePerHour=Math.min(Li,r.ecosystem.preyHungerIncreasePerHour+.2*(Li-uo));break;case 5:r.ecosystem.preyHungerIncreasePerHour=Math.max(uo,r.ecosystem.preyHungerIncreasePerHour-.2*(Li-uo));break;case 6:r.ecosystem.predatorGestationPeriod=Math.min(mr,r.ecosystem.predatorGestationPeriod+.2*(mr-ao));break;case 7:r.ecosystem.predatorGestationPeriod=Math.max(ao,r.ecosystem.predatorGestationPeriod-.2*(mr-ao));break;case 8:r.ecosystem.predatorProcreationCooldown=Math.min(vr,r.ecosystem.predatorProcreationCooldown+.2*(vr-lo));break;case 9:r.ecosystem.predatorProcreationCooldown=Math.max(lo,r.ecosystem.predatorProcreationCooldown-.2*(vr-lo));break;case 10:r.ecosystem.predatorHungerIncreasePerHour=Math.min(Bi,r.ecosystem.predatorHungerIncreasePerHour+.2*(Bi-co));break;case 11:r.ecosystem.predatorHungerIncreasePerHour=Math.max(co,r.ecosystem.predatorHungerIncreasePerHour-.2*(Bi-co));break;case 12:r.ecosystem.berryBushSpreadChance=Math.min(Is,r.ecosystem.berryBushSpreadChance+.2*(Is-ai));break;case 13:r.ecosystem.berryBushSpreadChance=Math.max(ai,r.ecosystem.berryBushSpreadChance-.2*(Is-ai));break}}updateQTable(n,r,o,l){const a=this.getQValue(n,r),c=Math.max(...Array.from({length:Dd},(h,g)=>this.getQValue(l,g))),d=a+e1*(o+t1*c-a);this.setQValue(n,r,d)}step(n){const r=n,o=r.search.prey.count(),l=r.search.predator.count(),a=r.search.berryBush.count();this.applyEmergencyCorrections(o,l,a,n);const c=this.discretizeState(o,l,a);if(this.lastState!==null&&this.lastAction!==null){const h=this.calculateReward(o,l,a);this.updateQTable(this.lastState,this.lastAction,h,c)}const d=this.chooseAction(c);this.applyAction(d,n),this.epsilon=Math.max(i1,this.epsilon*n1),this.lastState=c,this.lastAction=d}reset(){this.qTable.clear(),this.epsilon=Um,this.lastState=null,this.lastAction=null}getStats(){return{qTableSize:this.qTable.size,explorationRate:this.epsilon}}}let Dv=new r1;function o1(e){QC(e),ZC(e),e.ecosystem.lastUpdateTime||(e.ecosystem.preyGestationPeriod=oo+(pr-oo)*.3,e.ecosystem.preyProcreationCooldown=so+(gr-so)*.3,e.ecosystem.preyHungerIncreasePerHour=uo+(Li-uo)*.3,e.ecosystem.predatorGestationPeriod=ao+(mr-ao)*.3,e.ecosystem.predatorProcreationCooldown=lo+(vr-lo)*.3,e.ecosystem.predatorHungerIncreasePerHour=co+(Bi-co)*.3,e.ecosystem.berryBushSpreadChance=ai+(Is-ai)*.7),Dv.step(e)}function s1(e){e.ecosystem.lastUpdateTime||(e.ecosystem.lastUpdateTime=0),!(e.time-e.ecosystem.lastUpdateTime<JC)&&(e.ecosystem.lastUpdateTime=e.time,o1(e))}function a1(){return Dv.getStats()}const l1=1/60;function u1(e,n){const r=yt(e);r&&(e.viewportCenter=gf(e.viewportCenter,r.position,lf*n))}function c1(e){for(const r of e.entities.entities.values())r.isHighlighted=!1;const n=e.notifications.filter(r=>!r.isDismissed);for(const r of n)if(r.highlightedEntityIds)for(const o of r.highlightedEntityIds){const l=e.entities.entities.get(o);l&&(l.isHighlighted=!0)}}function lu(e,n){if(e.isPaused)return e;for(;n>0;){const r=Uf(e),o=Math.min(n,l1);if(r.gameOver)return r;const l=o*(Et/wt);r.time+=l,u1(r,o),QE(r),s1(r),c1(r),lC({gameState:r,deltaTime:o}),jC({gameState:r,deltaTime:o}),VC(r),yC(r,o),e=r,n-=o}return e}function Hm(e,n,r){e.save();const{x:o,y:l,width:a,height:c}=n.rect,d=Q0;if(e.beginPath(),e.moveTo(o+d,l),e.lineTo(o+a-d,l),e.quadraticCurveTo(o+a,l,o+a,l+d),e.lineTo(o+a,l+c-d),e.quadraticCurveTo(o+a,l+c,o+a-d,l+c),e.lineTo(o+d,l+c),e.quadraticCurveTo(o,l+c,o,l+c-d),e.lineTo(o,l+d),e.quadraticCurveTo(o,l,o+d,l),e.closePath(),e.fillStyle=n.isDisabled?Z0:n.backgroundColor,e.fill(),n.activated){e.save();const h=(Math.sin(Date.now()/1e3*nv)+1)/2;e.strokeStyle=tv,e.lineWidth=2+h*2,e.globalAlpha=.7+h*.3,e.stroke(),e.restore()}if(n.lastActivated){const h=Date.now()-n.lastActivated;if(h<Wl){const g=1-h/Wl;e.fillStyle=ev,e.globalAlpha=g,e.fill(),e.globalAlpha=1}}r&&!n.isDisabled&&(e.fillStyle=Ef,e.globalAlpha=.5,e.fill(),e.globalAlpha=1),e.fillStyle=n.isDisabled?J0:n.textColor,n.icon?(e.font=`${c*.55}px "Press Start 2P", Arial`,e.textAlign="center",e.textBaseline="middle",e.fillText(n.icon,o+a/2,l+c/2),n.text&&(e.font=`${c*.18}px "Press Start 2P", Arial`,e.textAlign="right",e.textBaseline="bottom",e.fillText(n.text,o+a-4,l+c-2))):(e.textAlign="center",e.textBaseline="middle",e.fillText(n.text,o+a/2,l+c/2)),e.restore()}function d1(e,n,r,o){e.save(),e.font=`${cm}px "Press Start 2P", Arial`,e.textAlign="center",e.textBaseline="bottom";const a=e.measureText(r).width,c=cm,d=a+dm*2,h=c+dm*2,g=o.x-d/2,m=e.canvas.height,y=n.y<m/2?n.y+n.height-fm:n.y-h+fm;e.fillStyle=rE,e.fillRect(g,y,d,h),e.fillStyle=oE,e.fillText(r,o.x,y+h/2+c/2),e.restore()}function f1(e,n,r){e.save();const o=yt(n);n.uiButtons=[];const l=[{id:"fastForwardButton",action:Ce.FastForward,text:"FFWD [T]",currentWidth:ii*1.3,backgroundColor:cr,textColor:In,tooltip:"Fast-forward time",rect:{x:0,y:0,width:0,height:0}},{id:"pauseButton",action:Ce.TogglePause,text:n.isPaused?"UN[P]AUSE":"[P]AUSE",backgroundColor:n.isPaused?dd:cr,currentWidth:n.isPaused?ii*1.4:ii*1.1,tooltip:n.isPaused?"Resume Game":"Pause Game",rect:{x:0,y:0,width:0,height:0},textColor:In},{id:"muteButton",action:Ce.ToggleMute,text:n.isMuted?"UN[M]UTE":"[M]UTE",backgroundColor:n.isMuted?dd:cr,tooltip:`Toggle Sound (${n.isMuted?"Muted":"Enabled"})`,currentWidth:ii,rect:{x:0,y:0,width:0,height:0},textColor:In},{id:"returnToIntroButton",action:Ce.ReturnToIntro,text:"EXIT",backgroundColor:cr,tooltip:"Return to Main Menu [ESC]",currentWidth:ii*.9,rect:{x:0,y:0,width:0,height:0},textColor:In}];if(n.uiButtons.push(...l),o){const g=Nf(n,o),m=new Set(g.map(H=>H.type));let y=[{playerAction:_e.Gather,buttonAction:Ce.CommandGather,shortcut:"E",name:"Gather",toggleKey:"gathering",condition:()=>o.isAdult===!0},{playerAction:_e.Eat,buttonAction:Ce.CommandEat,shortcut:"F",name:"Eat"},{playerAction:_e.Plant,buttonAction:Ce.CommandPlant,shortcut:"B",name:"Plant",toggleKey:"planting",condition:()=>o.isAdult===!0},{playerAction:_e.Procreate,buttonAction:Ce.ToggleProcreationBehavior,shortcut:"R",name:"Procreation",toggleKey:"procreation",condition:()=>o.isAdult===!0},{playerAction:_e.FeedChild,buttonAction:Ce.ToggleFeedChildBehavior,shortcut:"H",name:"Feed Child",toggleKey:"feedChildren",condition:()=>o.isAdult===!0},{playerAction:_e.Attack,buttonAction:Ce.ToggleAttackBehavior,shortcut:"Q",name:"Attack",toggleKey:"attack",condition:()=>o.isAdult===!0},{playerAction:_e.FollowMe,buttonAction:Ce.CommandFollowMe,shortcut:"C",name:"Follow Me",toggleKey:"followLeader",condition:()=>o.isAdult===!0},{playerAction:_e.CallToAttack,buttonAction:Ce.CommandCallToAttack,shortcut:"V",name:"Call to Attack",condition:()=>o.isAdult===!0},{playerAction:_e.TribeSplit,buttonAction:Ce.CommandTribeSplit,shortcut:"K",name:"Split Tribe",condition:()=>o.leaderId!==void 0&&o.leaderId!==o.id&&o.isAdult===!0}];y=y.filter(H=>H.condition?H.condition():!0);const S=1,_=y.length,C=_*rr+(_-1)*gl,T=S*rr+(S-1)*gl,E=(r-C)/2,M=e.canvas.height-T-20;y.forEach((H,D)=>{const B=D%_,x=Math.floor(D/_),U=E+B*(rr+gl),Y=M+x*(rr+gl),ae=!!H.toggleKey,Ee=ae&&n.autopilotControls.behaviors[H.toggleKey],we=!m.has(H.playerAction),be=!n.hasPlayerEnabledAutopilot||n.hasPlayerEnabledAutopilot<3?" (Press Shift to toggle Auto)":"",ke=ae?`${H.name}${be}`:H.name,Ie=Ee?dd:cr,ue={id:`commandButton_${H.name}`,action:H.buttonAction,rect:{x:U,y:Y,width:rr,height:rr},icon:ou[H.playerAction],text:H.shortcut,backgroundColor:Ie,textColor:In,currentWidth:rr,tooltip:ke,isDisabled:we,activated:Ee};n.uiButtons.push(ue)})}let a=r-Ke;l.forEach(g=>{const m=Ke,y=a-g.currentWidth;g.rect={x:y,y:m,width:g.currentWidth,height:q0},Hm(e,g,n.hoveredButtonId===g.id),a-=g.currentWidth+iE});let c=null;n.uiButtons.filter(g=>g.id.startsWith("commandButton_")).forEach(g=>{c||(c={x:g.rect.x,y:g.rect.y,width:g.rect.width,height:g.rect.height}),c.x=Math.min(c.x,g.rect.x),c.y=Math.min(c.y,g.rect.y),c.width=Math.max(c.width,g.rect.x+g.rect.width-c.x),c.height=Math.max(c.height,g.rect.y+g.rect.height-c.y),Hm(e,g,n.hoveredButtonId===g.id)});const h=n.hoveredButtonId?n.uiButtons.find(g=>g.id===n.hoveredButtonId):void 0;return h&&h.tooltip&&n.mousePosition&&d1(e,h.rect,h.tooltip,n.mousePosition),e.restore(),{commandButtonsRect:c}}function h1(e){e.save(),e.fillStyle=mE,e.fillRect(0,0,e.canvas.width,e.canvas.height),e.fillStyle=vE,e.font=`${yE}px "Press Start 2P", Arial`,e.textAlign="center",e.textBaseline="middle",e.fillText("PAUSED",e.canvas.width/2,e.canvas.height/2),e.restore()}function Lm(e,n,r,o){const l=n.x-r.width/2,a=n.y-r.height/2,c=l+e.x,d=a+e.y,h=(c%o.width+o.width)%o.width,g=(d%o.height+o.height)%o.height;return{x:h,y:g}}function uu(e,n,r,o){let l=e.x-n.x,a=e.y-n.y;return Math.abs(l)>o.width/2&&(l=l-Math.sign(l)*o.width),Math.abs(a)>o.height/2&&(a=a-Math.sign(a)*o.height),{x:l+r.width/2,y:a+r.height/2}}function Cl(e,n,r,o){const l=uu(e.position,n,r,o),c=("radius"in e?e.radius:20)+20;return l.x>=-c&&l.x<=r.width+c&&l.y>=-c&&l.y<=r.height+c}function Tn(e,n,r,o,l,...a){const c={...l.position};for(let d=-r;d<=r;d+=r)for(let h=-n;h<=n;h+=n)l.position.x=c.x+h,l.position.y=c.y+d,o(e,l,...a);l.position=c}const p1=25,g1=0,Bm=28;function kv(e,n,r,o,l,a,c,d,h,g){e.save();const{x:m,y}=uu(n,c,{width:d,height:h},g);e.strokeStyle=o,e.lineWidth=a,e.setLineDash(l),e.beginPath(),e.arc(m,y,r+ru,0,2*Math.PI),e.stroke(),e.restore()}function m1(e,n,r,o,l,a,c){if(n=n.filter(y=>y.type!==_e.FollowMe),n.length===0)return;e.save(),n.forEach(y=>{y.targetEntity&&kv(e,y.targetEntity.position,y.targetEntity.radius,Tf,If,2,o,l,a,c)}),e.font=`${Ao}px "Press Start 2P", Arial`,e.fillStyle="white",e.textAlign="center",e.textBaseline="bottom",e.shadowColor="black",e.shadowBlur=5;const{x:d,y:h}=uu(r.position,o,{width:l,height:a},c);let g=0,m={};n.forEach(y=>{const S=ou[y.type];if(y.targetEntity){m[y.targetEntity.id]=(m[y.targetEntity.id]||0)+1;const _=y.targetEntity.position.x-o.x+l/2,C=y.targetEntity.position.y-o.y+a/2,T=`${S}${y.key.toUpperCase()}`,E=C-y.targetEntity.radius-ru-Ao/2-(m[y.targetEntity.id]-1)*Bm;e.fillText(T,_,E)}else{e.textAlign="left";const _=`${S}${y.key.toUpperCase()}`,C=d+p1,E=h+g1+g*Bm;e.fillText(_,C,E),g++,e.textAlign="center"}}),e.restore()}const pe=(e,n,r,o,l,a,c)=>{a==="transparent"||o<=0||l<=0||(e.fillStyle=a,e.fillRect(Math.floor(n*c),Math.floor(r*c),Math.ceil(o*c),Math.ceil(l*c)))},Gm=10,bm=10,bn=6,ei=4,Rl=2,v1=5,dn=4,y1=2,kt=4,S1=2,Ze=3,Zr=2,Ui=0,Os=Ui+ei-1,Ut=Os,at=Os+dn-1,A1="rgba(0, 0, 0, 0.4)",T1=4,I1=1,Hf={name:"tribe-human-2d",referenceImage:"swos.png",description:`A 2D human character asset for the Tribe game. This includes ensuring that the unique animations for stances like 'eat' and 'procreate' do not erroneously appear in other stances, such as 'walk', which was observed in the provided rendered media. The 'idle' animation was updated to a leg sway to better match the provided video for that stance, replacing a simpler body bob.

# Visual style

Human characters in the Tribe game are inspired by classic 2D pixel art, they look like Sensible Soccer players(Sensible Soccer game visual style is IMPORTANT), with a simple and recognizable design. The characters are designed to be easily distinguishable and animated in a way that conveys their actions clearly.

Character in Tribe game look like people from stone age, they have simple clothing, no shoes, and no modern accessories. The characters are designed to be easily distinguishable and animated in a way that conveys their actions clearly.

# Technical details

The asset is rendered on a canvas using the CanvasRenderingContext2D API. The rendering function takes parameters for position, size, progress, stance, direction, gender, and age. The character can face left or right, and the rendering adapts based on the stance (e.g., idle, walk, eat, procreate).
The rendering function must be simple and efficient, it should not use complex patterns or gradients, and should focus on solid colors and basic shapes to maintain the pixel art aesthetic.

15% padding from all edges of the rendering box is required to ensure the character is not cut off during rendering.

Subtle shadow should be drawn under the character to give it a sense of depth.

# Rendering parameters

- age: The age of the character, which affects the size and proportions of the body parts. Age is a number between 1 and 60, with 20 being the average age.
- gender: 
  - The male characters should have only pants, while female cover their breasts with a top. The clothing should be simple and muted, reflecting a stone-age style.
  - Female characters should have long hair, while male should have short hair and beard.
  - Male characters should have a more robust, muscular build
  - Female characters should have thinner arms and legs, with a more pronounced waist and hips.
- isPregnant: (applicable only for females) Indicates if the character is pregnant, like very large belly. Pregnant characters should have a larger torso.
- direction: A vector indicating the character's facing direction. There should be at least 8 directions (like in Sensible Soccer): top left, top, top right, left, right, bottom left, bottom, bottom right. The character should be flipped horizontally if the direction vector's X component is negative.
             When moving up(top, top left, top right), the character back of the head should be visible, when moving down(Y > 0), the character face should be visible.
- hungryLevel: A number between 0 and 100 indicating how hungry the character is, hunger level 100 means the character is starving, 0 means the character is not hungry at all. So hungry characters should be thinner, with less body fat, and more pronounced muscles. The character's hunger level affects the size and proportions of the body parts, with hungrier characters being smaller and more gaunt.

# Rendering details

- All parts of the body must be connected
- Rendering must take into account direction vector (X and Y) to flip the character horizontally if needed
- The character's age affects the size and proportions of the body parts, with older characters being larger and more robust. Hair color should become gray for older characters.

# Stances

- 'idle': The character stands still, with a slight leg sway to indicate life.
- 'walk': The character moves forward, with legs and arms in motion.
- 'gathering': The character is gathering food from berry bushes, with arms reaching out and a slight bend at the knees.
- 'eat': The character holds food and brings it to their mouth, with a slight bend at the knees.
- 'procreate': The character performs a mating animation, with a specific pose and movement. There should be some additional visual effects to indicate this action, such as a slight glow or aura around the characters, or dust particles to indicate movement.
- 'attacking': The character performs an attack animation, with arms raised and a forward motion.
- 'defending': The character takes a defensive stance, with arms raised and a slight bend at the knees.
- 'stunned': The character is stunned and laying on the ground, with limbs relaxed and a neutral expression.
- 'dead': The character lies on the ground, with limbs relaxed and a neutral expression, slowly turns into a skeleton over time.

`,stances:["idle","walk","gathering","eat","procreate","dead","attacking","defending","stunned"],render(e,n,r,o,l,a,c,d="male",h=20,g=[1,0],m=!1,y=0){const S=["dead","stunned"].includes(c),_=S?bm+4:Gm,C=S?Gm+4:bm+Ze,T=.15,E=Math.min(o*(1-2*T)/_,l*(1-2*T)/C),M=_*E,H=C*E,D=n+(o-M)/2,B=r+(l-H)/2;e.save(),g[0]<0&&!S?(e.translate(D+M,B),e.scale(-1,1)):e.translate(D,B);const U="#D09A5A",Y=h>50?"#BDBDBD":"#281808",ae="#7F5C4A",Ee="#6B4F3A",we="#E0D8C0",be="#A0522D",ke=1-Math.max(0,Math.min(100,y))/100*.2,Ie=d==="male"?1.1:.9,ue=.8+(Math.max(1,Math.min(h,60))-1)/59*.2;let Ue=v1*ke*Ie*ue,ye=y1*ke*Ie*ue,J=S1*ke*ue;m&&d==="female"&&(Ue*=1.5);const z=Math.round((_-Ue)/2),j=Math.round((_-bn)/2),$=z-ye,R=z+Ue,F=1,V=z+(Ue/2-F/2)-J,ee=z+(Ue/2+F/2),he=g[1]<-.2&&Math.abs(g[0])<.7,re=K=>{e.fillStyle=A1,e.beginPath();const te=_/2,Oe=K;e.ellipse(Math.floor(te*E),Math.floor(Oe*E),Math.max(1,Math.floor(T1*E)),Math.max(1,Math.floor(I1*E)),0,0,2*Math.PI),e.fill()},Se=(K,te)=>{d==="male"?(pe(e,z,Os+K,Ue,dn-Zr,te,E),pe(e,z,Os+dn-Zr+K,Ue,Zr,ae,E)):pe(e,z,Os+K,Ue,dn,Ee,E)},ve=(K,te)=>{he?pe(e,j,Ui+K,bn,ei,Y,E):(pe(e,j,Ui+K,bn,ei,te,E),pe(e,j,Ui+K,bn,Rl,Y,E),d==="female"?(pe(e,j-1,Ui+Rl+K,1,ei,Y,E),pe(e,j+bn,Ui+Rl+K,1,ei,Y,E)):pe(e,j+1,Ui+2+K,bn-2,ei-2,Y,E))};switch(c){case"idle":{const K=a*Math.PI*2,te=Math.sin(K)*.5,ce=(Math.cos(K*2)+1)*.25;re(at+Ze+1),pe(e,V+te,at+ce,J,Ze,U,E),pe(e,ee-te,at+ce,J,Ze,U,E),Se(ce,U),pe(e,$,Ut+ce,ye,kt,U,E),pe(e,R,Ut+ce,ye,kt,U,E),ve(ce,U);break}case"walk":{const K=a*Math.PI*2,te=Math.sin(K)*2,ce=Math.abs(Math.cos(K))*1;re(at+Ze+1),pe(e,V+te,at+ce,J,Ze,U,E),pe(e,ee-te,at+ce,J,Ze,U,E),Se(ce,U),pe(e,$-te,Ut+ce,ye,kt,U,E),pe(e,R+te,Ut+ce,ye,kt,U,E),ve(ce,U);break}case"gathering":{const K=a*Math.PI*2,te=1,Oe=(Math.sin(K)+1)/2*2,ce=te+Math.abs(Math.cos(K))*.5;re(at+Ze+1),pe(e,V,at+ce,J,Ze-te,U,E),pe(e,ee,at+ce,J,Ze-te,U,E),Se(ce,U),pe(e,$+1,Ut+ce-Oe,ye,kt,U,E),pe(e,R-1,Ut+ce-Oe,ye,kt,U,E),ve(ce,U);break}case"eat":{re(at+Ze+1),pe(e,V,at+1,J,Ze-1,U,E),pe(e,ee,at+1,J,Ze-1,U,E),Se(1,U);const Oe=(Math.sin(a*Math.PI*4)+1)/2,ce=j+bn/2,Nn=Ui+ei/2,qe=R+(ce-R)*Oe,Ye=Ut+1+(Nn-(Ut+1))*Oe;pe(e,$,Ut+1,ye,kt,U,E),pe(e,qe,Ye,ye,kt,U,E),pe(e,qe,Ye-1,1,1,be,E),ve(1,U);break}case"procreate":{const K=(Math.sin(a*Math.PI*8)+1)/4,te=(Math.sin(a*Math.PI*6)+1)*.5,Oe=1.5,ce=Oe-te;re(at+Ze+1),pe(e,V,at+ce,J,Ze-Oe,U,E),pe(e,ee,at+ce,J,Ze-Oe,U,E),Se(ce,U),pe(e,$,Ut+ce,ye,kt,U,E),pe(e,R,Ut+ce,ye,kt,U,E),ve(ce,U),e.globalAlpha=K,Se(ce,"white"),e.globalAlpha=1;break}case"attacking":{const K=Math.sin(a*Math.PI)*1.5,te=Math.abs(Math.sin(a*Math.PI));re(at+Ze+1),pe(e,V-K,at+te,J,Ze,U,E),pe(e,ee+K*.5,at+te,J,Ze,U,E),Se(te,U),pe(e,$,Ut+te-2,ye,kt,U,E),pe(e,R,Ut+te-2.5,ye,kt,U,E),ve(te,U);break}case"defending":{re(at+Ze+1),pe(e,V,at+1,J,Ze-1,U,E),pe(e,ee,at+1,J,Ze-1,U,E),Se(1,U),pe(e,$-1,Ut+1-1,ye,kt,U,E),pe(e,R+1,Ut+1-1,ye,kt,U,E),ve(1,U);break}case"stunned":case"dead":{const K=c==="dead",te=K?Math.min(1,a):0,Oe=te>.5?we:U,ce=d==="male"?ae:Ee,Nn=te>.8?"transparent":Y,qe=_/2,Ye=C/2,Dn=2;re(C-1),pe(e,qe-J-Dn,Ye,J,Ze,Oe,E),pe(e,qe+Dn,Ye,J,Ze,Oe,E),pe(e,qe-ye-Dn,Ye-dn+1,ye,kt,Oe,E),pe(e,qe+Dn,Ye-dn+1,ye,kt,Oe,E);const xt=qe-Ue/2,nn=Ye-dn/2;d==="male"?(te<.7&&pe(e,xt,nn+dn-Zr,Ue,Zr,ce,E),pe(e,xt,nn,Ue,dn-Zr,Oe,E)):te<.7?pe(e,xt,nn,Ue,dn,ce,E):pe(e,xt,nn,Ue,dn,Oe,E);const kn=qe-bn/2,On=Ye-dn/2-ei+1;if(pe(e,kn,On,bn,ei,Oe,E),Nn!=="transparent"&&pe(e,kn,On,bn,Rl,Nn,E),K&&te>.6){const ci="#B0A890";for(let $i=0;$i<3;$i++)pe(e,xt+1,nn+$i*1+1,Ue-2,.5,ci,E)}break}default:pe(e,0,0,_,C,"magenta",E);break}e.restore()}};function E1(e,n,r,o,l){const a=n.x,c=n.y-r-o/2;e.save(),e.fillStyle=l,e.strokeStyle=l,e.lineWidth=1.5,e.beginPath(),e.rect(a-o/2,c,o,o/2),e.fill(),e.beginPath(),e.moveTo(a-o/2,c),e.lineTo(a-o/4,c-o/3),e.lineTo(a-o/6,c),e.moveTo(a-o/6,c),e.lineTo(a,c-o/2),e.lineTo(a+o/6,c),e.moveTo(a+o/6,c),e.lineTo(a+o/4,c-o/3),e.lineTo(a+o/2,c),e.stroke(),e.restore()}function Vs(e,n,r,o,l,a=!1,c=!1,d=!1,h=!1){o<uf&&(r=r*.75),Hf.render(e,n.x-r/2,n.y-r/2,r,r,0,"idle",l,o,[0,0],!1,0);let g,m;a?(g=XI,m=Af):c?(g=KI,m=X0):d?(g=qI,m=V0):h&&(g=QI,m=j0),g&&m&&E1(e,n,r/2,g,m)}function w1(e,n,r,o,l,a){if(e.save(),o.length===0){e.restore();return}const c=o.length*l,d=4;let h;const g=c+(o.length-1)*d;o.length>1&&g>a?h=(a-c)/(o.length-1):h=d,o.length<=1&&(h=0);for(let m=0;m<o.length;m++){const{member:y,isPlayer:S,isHeir:_,isPartner:C,isParent:T}=o[m],E=n+m*(l+h)+l/2,M=r+l/4;Vs(e,{x:E,y:M},l,y.age,y.gender,S,_,C,T)}e.restore()}function _1(e,n,r,o,l){if(r.length===0)return;e.save();const a=Bn,c=" 00",d=" 00";e.font=`${ud}px "Press Start 2P", Arial`;const h=e.measureText(c).width,g=e.measureText(d).width,m=Bn+cn+Bn+cn+Bn+ki+h+Bn/2+ki+g,y=r.length*hl+(r.length-1)*lm,S=l-y-Bn;e.fillStyle=JI,e.fillRect(a,S,m,y);for(let _=0;_<r.length;_++){const C=r[_],T=S+_*(hl+lm),E=T+hl/2;C.isPlayerTribe&&(e.fillStyle=ZI,e.fillRect(a,T,m,hl));let M=a+Bn;if(e.font=`${cn}px "Press Start 2P", Arial`,e.textBaseline="middle",e.textAlign="left",e.fillText(C.tribeBadge,M,E-cn/4),M+=cn+Bn,!C.isPlayerTribe){const H=C.diplomacyStatus===Gt.Friendly?"":"",D=`diplomacyButton_${C.leaderId}`,B={x:M,y:E-cn/2,width:cn,height:cn},x={id:D,action:Ce.ToggleDiplomacy,rect:B,text:"",icon:H,backgroundColor:"transparent",textColor:"white",currentWidth:cn,tooltip:`Toggle diplomacy with this tribe (Currently: ${C.diplomacyStatus})`,targetTribeId:C.leaderId};n.uiButtons.push(x),n.hoveredButtonId===D&&(e.fillStyle=Ef,e.globalAlpha=.5,e.fillRect(B.x,B.y,B.width,B.height),e.globalAlpha=1),e.font=`${cn*.8}px "Press Start 2P", Arial`,e.textBaseline="middle",e.textAlign="center",e.fillText(H,M+cn/2,E)}M+=cn+Bn,C.adultCount>0&&(Vs(e,{x:M+ki/2,y:E},ki,25,"male"),M+=ki/2,e.font=`${ud}px "Press Start 2P", Arial`,e.fillStyle="white",e.textBaseline="middle",e.textAlign="left",e.fillText(` ${C.adultCount}`,M,E),M+=e.measureText(` ${C.adultCount}`).width+Bn/2),C.childCount>0&&(Vs(e,{x:M+ki/2,y:E},ki,1,"female"),M+=ki/2,e.font=`${ud}px "Press Start 2P", Arial`,e.fillStyle="white",e.textBaseline="middle",e.textAlign="left",e.fillText(` ${C.childCount}`,M,E))}e.restore()}function C1(e,n,r,o,l){const a=sv,c=av,d=n+o-a-c,h=r+c;e.save(),e.lineWidth=2,e.strokeStyle=l?PE:RE,e.beginPath();const g=5;e.moveTo(d+g,h+g),e.lineTo(d+a-g,h+a-g),e.moveTo(d+a-g,h+g),e.lineTo(d+g,h+a-g),e.stroke(),e.restore()}function R1(e,n,r,o){const{tutorialState:l,tutorial:a}=n;if(l.transitionState===Lt.INACTIVE)return;const c=a.steps[l.currentStepIndex];if(!c)return;e.save(),e.globalAlpha=l.transitionAlpha;const d=SE,h=AE,g=TE,m=`${hd}px "Press Start 2P", Arial`,y=`${mm}px "Press Start 2P", Arial`,S=EE,_=mm*1.5;e.font=y;const C=c.text.split(" ");let T="";const E=[];for(let we=0;we<C.length;we++){const be=T+C[we]+" ";e.measureText(be).width>d-h*2&&we>0?(E.push(T),T=C[we]+" "):T=be}E.push(T);const M=h*2+hd+h/2+E.length*_,H=(r-d)/2,D=o-M-160;e.fillStyle=IE,e.beginPath(),e.moveTo(H+g,D),e.lineTo(H+d-g,D),e.quadraticCurveTo(H+d,D,H+d,D+g),e.lineTo(H+d,D+M-g),e.quadraticCurveTo(H+d,D+M,H+d-g,D+M),e.lineTo(H+g,D+M),e.quadraticCurveTo(H,D+M,H,D+M-g),e.lineTo(H,D+g),e.quadraticCurveTo(H,D,H+g,D),e.closePath(),e.fill(),e.fillStyle=S,e.textAlign="center",e.textBaseline="top",e.font=m,e.fillText(c.title,H+d/2,D+h),e.font=y;let B=D+h+hd+h/2;for(const we of E)e.fillText(we,H+d/2,B),B+=_;const x=n.hoveredButtonId==="tutorial-dismiss";C1(e,H,D,d,x),e.restore();const U=sv,Y=av,ae=H+d-U-Y,Ee=D+Y;return{x:ae,y:Ee,width:U,height:U}}function kd(e,n,r){e.save();const o=CE,l={x:n.x-o,y:n.y-o,width:n.width+o*2,height:n.height+o*2};e.strokeStyle=rv,e.lineWidth=ov+Math.sin(r*wf)*1.5,e.setLineDash([8,8]),e.strokeRect(l.x,l.y,l.width,l.height),e.restore()}function P1(e,n){e.fillStyle="white",e.font='30px "Press Start 2P", Arial',e.textAlign="center",e.fillText("Game Over!",e.canvas.width/2,e.canvas.height/2-60),e.font='20px "Press Start 2P", Arial',e.fillText("Lineage Extinct.",e.canvas.width/2,e.canvas.height/2-20),e.fillText(`Cause: ${n.causeOfGameOver||"Unknown"}`,e.canvas.width/2,e.canvas.height/2+20)}const Jd=10,N1=3,xm=Jd*.7;function D1(e,n,r,o,l){const{position:a,food:c,maxFood:d,ownerId:h,claimedUntil:g}=n;if(e.beginPath(),e.arc(a.x,a.y,Jd,0,Math.PI*2),e.fillStyle="#228B22",e.fill(),e.strokeStyle="#006400",e.lineWidth=1,e.stroke(),h&&g&&g>l&&o){const m=r.entities.entities.get(h);if(m){let y;m.id===o.id?y=Af:x0(o,m,r)?y=UI:y=K0,y&&(e.strokeStyle=y,e.lineWidth=1+Math.sin(l*2)*.5,e.beginPath(),e.arc(a.x,a.y,Jd+2,0,Math.PI*2),e.stroke())}}if(c.length>0){const m=Math.PI*2/Math.min(c.length,d);for(let y=0;y<c.length;y++){const S=y*m,_=a.x+xm*Math.cos(S),C=a.y+xm*Math.sin(S);e.beginPath(),e.arc(_,C,N1,0,Math.PI*2),e.fillStyle="#FF0000",e.fill()}}}const zm=(e,n,r=70,o=50)=>{const l=e>>n&255;return`hsl(${Math.floor(l/255*360)}, ${r}%, ${o}%)`},k1=(e,n)=>{const r=e.match(/hsl\((\d+),\s*(\d+)%,\s*(\d+)%\)/);if(!r)return e;const[o,l,a]=[parseInt(r[1]),parseInt(r[2]),parseInt(r[3])];return`hsl(${o}, ${l}%, ${Math.max(0,a-n)}%)`},Pl=(e,n,r,o,l,a,c,d=!1)=>{e.save(),e.translate(n,r),e.rotate(a),e.fillStyle=d?k1(c,15):c,e.beginPath(),e.roundRect(-o/2,0,o,l,o/2),e.fill(),e.restore()},Od=(e,n)=>{const r=e.match(/hsl\((\d+),\s*(\d+)%,\s*(\d+)%\)/),o=75;if(!r)return`hsl(0, 0%, ${o}%)`;const[,l,a,c]=r.map(Number),d=a*(1-n),h=c+(o-c)*n;return`hsl(${l}, ${d}%, ${h}%)`},Ov={name:"tribe-prey-2d",referenceImage:"swos.png",description:`A 2D prey asset for the Tribe game, featuring various stances and animations.

Prey is an animal which can be hunted by predators or humans in the Tribe game.

Preys look like small 4 leg mammals, with a simple and recognizable design. The characters are designed to be easily distinguishable and animated in a way that conveys their actions clearly.

# Visual style

Prey characters in the Tribe game are inspired by classic 2D pixel art, they look like Sensible Soccer players(Sensible Soccer game visual style is IMPORTANT), with a simple and recognizable design. The characters are designed to be easily distinguishable and animated in a way that conveys their actions clearly.

Character in Tribe game look like creatures from stone age, they have simple clothing, no shoes, and no modern accessories. The characters are designed to be easily distinguishable and animated in away that conveys their actions clearly.

Prey walks on all fours, unlike human (two legs).

Each prey is described by a unique gene code, which is a number that defines its appearance, size, and other characteristics. The gene code is used to generate the character's appearance, including body proportions, color, and other visual features. The gene code is a 32-bit integer, with each bit representing a specific characteristic of the character.

Prey should have should have visible body parts, such as head, torso, arms, and legs. The body parts should be connected and should not overlap. The character's body parts should be simple shapes, such as circles and rectangles, with solid colors and no gradients or patterns.

Preys are supposed to be sympathetic and friendly, so the character's face should have a friendly expression, with a smile and bright eyes. The character's eyes should be large and expressive, with a simple design.

# Technical details

The asset is rendered on a canvas using the CanvasRenderingContext2D API. The rendering function takes parameters for position, size, progress, stance, direction, gender, and age. The character can face left or right, and the rendering adapts based on the stance (e.g., idle, walk, eat, procreate).
The rendering function must be simple and efficient, it should not use complex patterns or gradients, and should focus on solid colors and basic shapes to maintain the pixel art aesthetic.

15% padding from all edges of the rendering box is required to ensure the character is not cut off during rendering.

Subtle shadow should be drawn under the a character to give it a sense of depth.

IMPORTANT: The character is visible from the side, just like in Sensible Soccer.

# Rendering parameters

- age: The age of the character, which affects the size and proportions of the body parts. Age is a number between 0 and 12, with 2 being the average age.
- gender:
  - 'male': Male prey are larger and more robust, with a more pronounced musculature.
  - 'female': Female prey are smaller and more agile, with a leaner build.
- isPregnant: (applicable only for females) Indicates if the character is pregnant, like very large belly. Pregnant characters should have a larger torso.
- direction: A vector indicating the character's facing direction. There should be at least 8 directions (like in Sensible Soccer): top left, top, top right, left, right, bottom left, bottom, bottom right. The character should be flipped horizontally if the direction vector's X component is negative.
             When moving up(top, top left, top right), the character back of the head should be visible, when moving down(Y > 0), the character face should be visible.
- hungryLevel: A number between 0 and 100 indicating how hungry the character is, hunger level 100 means the character is starving, 0 means the character is not hungry at all. So hungry characters should be thinner, with less body fat, and more pronounced muscles. The character's hunger level affects the size and proportions of the body parts, with hungrier characters being smaller and more gaunt.

# Rendering details

- All parts of the body must be connected
- Rendering must take into account direction vector (X and Y) to flip the character horizontally if needed
- The character's age affects the size and proportions of the body parts, with older characters being larger and more robust. Hair color should become gray for older characters.

# Stances

- 'idle': The character stands still, with a slight leg sway to indicate life.
- 'walk': The character moves forward, with legs and arms in motion.
- 'eat': The character holds food and brings it to their mouth, with a slight bend at the knees.
- 'procreate': The character performs a mating animation, with a specific pose and movement. There should be some additional visual effects to indicate this action, such as a slight glow or aura around the characters, or a dust particles to indicate movement.
- 'dead': The character lies on the ground, with limbs relaxed and a neutral expression, slowly turns into a grey skeleton over time. The character pose and body parts should not be animated in this stance, as the character is dead so it should not move.`,stances:["idle","walk","eat","dead","procreate"],render(e,n,r,o,l,a,c,d={gender:"male",age:2,direction:[1,0],isPregnant:!1,hungryLevel:0,geneCode:8405024}){e.save(),e.imageSmoothingEnabled=!1;const h=o*.15,g=n+o/2,m=r+l/2,y=o-h*2,S=l-h*2,{gender:_,age:C,direction:T,isPregnant:E,hungryLevel:M,geneCode:H}=d,D=.8+Math.min(C,10)/10*.4,B=_==="male"?1.05:.95,x=1-M/100*.3,U=y*.5*x*D*B;let Y=S*.3*D*B;const ae=y*.15*D*B,Ee=U*.2,we=S*.3,be=zm(H,0,30,50);let ke=zm(H,8,50,40);if(C>45){const re=Math.min(1,(C-45)/15);ke=Od(ke,re)}e.translate(g,m),T[0]<0&&e.scale(-1,1);const Ie=Math.sin(a*Math.PI*2),ue=Math.cos(a*Math.PI*2),Ue=we+Y*.2;if(c==="dead"){const re=Math.min(a,1);e.translate(0,S*.2),e.rotate(Math.PI/2);const Se=Od(ke,re),ve=Od(be,re);e.globalAlpha=.5+re*.5,e.strokeStyle=Se,e.lineWidth=Ee*.5,e.beginPath(),e.moveTo(-U*.4,0),e.lineTo(U*.4,0),e.stroke();for(let K=-1;K<=1;K+=1)e.beginPath(),e.arc(0,0,Y*.4,Math.PI*.4*K-Math.PI*.2,Math.PI*.4*K+Math.PI*.2),e.stroke();e.fillStyle=ve,e.beginPath(),e.arc(U*.5,0,ae,0,Math.PI*2),e.fill(),e.fillStyle="black",e.beginPath(),e.arc(U*.55,0,ae*.3,0,Math.PI*2),e.fill(),e.restore();return}e.fillStyle="rgba(0, 0, 0, 0.1)",e.beginPath(),e.ellipse(0,Ue,U*.7,U*.25,0,0,2*Math.PI),e.fill();let ye=0,J=0,z=0,j=0,$=0,R=0;switch(c){case"idle":J=Ie*(S*.02),z=Ie*.05,j=-Ie*.05,$=-Ie*.05,R=Ie*.05;break;case"walk":J=Math.abs(ue)*(S*-.04),z=Ie*.7,j=-Ie*.7,$=-Ie*.7,R=Ie*.7;break;case"eat":ye=S*.1,J=S*.05,ye+=Ie*(S*.02);break;case"procreate":J=S*.05;const re=(1-ue)*-y*.05;e.translate(re,0),e.shadowColor="rgba(255, 182, 193, 0.9)",e.shadowBlur=10;break}E&&_==="female"&&(Y*=1.6);const F=J,V=F-Y*.2;Pl(e,U*-.35,V,Ee,we,$,ke,!0),Pl(e,U*.35,V,Ee,we,R,ke,!0),e.fillStyle=ke,e.beginPath(),e.ellipse(0,F,U/2,Y/2,0,0,2*Math.PI),e.fill();const ee=U*.45,he=V+ye;e.fillStyle=be,e.beginPath(),e.arc(ee,he,ae,0,Math.PI*2),e.fill(),T[1]>=0&&(e.fillStyle="black",e.beginPath(),e.arc(ee+ae*.3,he-ae*.2,ae*.15,0,Math.PI*2),e.fill()),Pl(e,U*-.35,V,Ee,we,z,ke),Pl(e,U*.35,V,Ee,we,j,ke),e.restore()}};function O1(e,n){let[r,o,l]=e.match(/\d+/g).map(Number);return r=Math.max(0,r-n),o=Math.max(0,o-n),l=Math.max(0,l-n),`rgb(${r}, ${o}, ${l})`}function M1(e){const n=(e&16711680)>>16,r=(e&65280)>>8,o=e&255,l=`rgb(${n}, ${r}, ${o})`,a=O1(l,40),c=(e&255)%100+50,d=(e>>8&255)%100,h=(e>>16&255)%100,g=`rgb(${c}, ${d}, ${h})`,m=(e&8388608)!==0?"#00aaff":"#ffaa00";return{furColor:l,darkerFurColor:a,skinColor:g,eyeColor:m}}const Mv={name:"tribe-predator-2d",referenceImage:"swos.png",description:`A 2D predator asset for the Tribe game, featuring various stances and animations.

Predator is an animal which can hunt and attack humans in the Tribe game. It is designed to be a threat to the player, adding an element of danger and challenge to the game world.

Predator look like bears or wolves, with a simple and recognizable design. The characters are designed to be easily distinguishable and animated in a way that conveys their actions clearly.

# Visual style

Predator characters in the Tribe game are inspired by classic 2D pixel art, they look like Sensible Soccer players(Sensible Soccer game visual style is IMPORTANT), with a simple and recognizable design. The characters are designed to be easily distinguishable and animated in a way that conveys their actions clearly.

Character in Tribe game look like creatures from stone age, they have simple clothing, no shoes, and no modern accessories. The characters are designed to be easily distinguishable and animated in away that conveys their actions clearly.

Predator walks on arms and legs, unlike human (two legs).

Each predator is described by a unique gene code, which is a number that defines its appearance, size, and other characteristics. The gene code is used to generate the character's appearance, including body proportions, color, and other visual features. The gene code is a 32-bit integer, with each bit representing a specific characteristic of the character.

Predator should have visible ears, eyes, and mouth with teeth. It must have a tail. Front legs should be shorter than back legs, and they should be positioned closer to the body. The character's body should be wider at the top and narrower at the bottom, with a slight curve to the back. The character's head should be larger than the body, with a pronounced jaw and sharp teeth.

# Technical details

The asset is rendered on a canvas using the CanvasRenderingContext2D API. The rendering function takes parameters for position, size, progress, stance, direction, gender, and age. The character can face left or right, and the rendering adapts based on the stance (e.g., idle, walk, eat, procreate).
The rendering function must be simple and efficient, it should not use complex patterns or gradients, and should focus on solid colors and basic shapes to maintain the pixel art aesthetic.

15% padding from all edges of the rendering box is required to ensure the character is not cut off during rendering.

Subtle shadow should be drawn under the a character to give it a sense of depth.

IMPORTANT: The character is visible from the side, just like in Sensible Soccer.

# Rendering parameters

- age: The age of the character, which affects the size and proportions of the body parts. Age is a number between 1 and 20, with 3 being the average age.
- gender:
  - 'male': Male predators are larger and more robust, with a more pronounced musculature.
  - 'female': Female predators are smaller and more agile, with a leaner build.
- isPregnant: (applicable only for females) Indicates if the character is pregnant, like very large belly. Pregnant characters should have a larger torso.
- direction: A vector indicating the character's facing direction. There should be at least 8 directions (like in Sensible Soccer): top left, top, top right, left, right, bottom left, bottom, bottom right. The character should be flipped horizontally if the direction vector's X component is negative.
             When moving up(top, top left, top right), the character back of the head should be visible, when moving down(Y > 0), the character face should be visible.
- hungryLevel: A number between 0 and 100 indicating how hungry the character is, hunger level 100 means the character is starving, 0 means the character is not hungry at all. So hungry characters should be thinner, with less body fat, and more pronounced muscles. The character's hunger level affects the size and proportions of the body parts, with hungrier characters being smaller and more gaunt.

# Rendering details

- All parts of the body must be connected
- Rendering must take into account direction vector (X and Y) to flip the character horizontally if needed
- The character's age affects the size and proportions of the body parts, with older characters being larger and more robust. Hair color should become gray for older characters.

# Stances

- 'idle': The character stands still, with a slight leg sway to indicate life.
- 'walk': The character moves forward, with legs and arms in motion.
- 'eat': The character holds food and brings it to their mouth, with a slight bend at the knees.
- 'procreate': The character performs a mating animation, with a specific pose and movement. There should be some additional visual effects to indicate this action, such as a slight glow or aura around the characters, or a dust particles to indicate movement.
- 'attacking': The character performs an attack animation, with arms raised and a forward motion.
- 'dead': The character lies on the ground, with limbs relaxed and a neutral expression, slowly turns into a grey skeleton over time. The character pose and body parts should not be animated in this stance, as the character is dead so it should not move.`,stances:["idle","walk","eat","dead","attacking","procreate"],render(e,n,r,o,l,a,c,d={gender:"male",age:20,direction:[1,0],isPregnant:!1,hungryLevel:0,geneCode:8405024}){const{gender:h,age:g,direction:m,isPregnant:y,hungryLevel:S,geneCode:_}=d;e.save();const C=o*.15,T=Math.max(1,Math.floor((o-C*2)/10)),E=m[0]<0;e.translate(n+o/2,r+l/2),E&&e.scale(-1,1);const M=M1(_),H=.8+Math.min(g,20)/20*.4,D=h==="male"?1.05:.95,B=1-S/100*.25,x=H*D*B,U=Math.max(0,Math.min(1,(g-15)/5));e.filter=`grayscale(${U})`;const Y=M.furColor,ae=M.darkerFurColor,Ee=M.eyeColor,we="#FFFFFF",be="#c75c5c",ke="#E0E0E0",Ie="#A0A0A0",ue=l/2-2*T,Ue=Math.sin(a*Math.PI*2),ye=Math.abs(Ue);if(e.fillStyle="rgba(0,0,0,0.15)",e.beginPath(),e.ellipse(0,ue,T*4,T,0,0,2*Math.PI),e.fill(),e.filter="none",c==="dead"){const qe=Math.min(1,a*2);e.save(),e.translate(0,ue-T*3),e.rotate(-Math.PI/2);const Ye=(Dn,xt,nn,kn,On=!1)=>{e.fillStyle=On?Ie:ke,e.fillRect(Dn*T,xt*T,nn*T,kn*T)};qe<1&&(e.globalAlpha=1-qe,e.fillStyle=Y,e.beginPath(),e.ellipse(0,0,T*3,T*5,0,0,Math.PI*2),e.fill(),e.globalAlpha=1),qe>0&&(e.globalAlpha=qe,Ye(-1,-4,2,2),Ye(1,-3.5,1,1,!0),Ye(-.5,-2,1,5,!0),Ye(-2.5,-1,5,.5),Ye(-2.5,0,5,.5),Ye(-2.5,1,5,.5),Ye(-3,-2,-1,2,!0),Ye(3,-2,1,2),Ye(-3,2,-1,2,!0),Ye(3,2,1,2),e.globalAlpha=1),e.restore(),e.restore();return}e.fillStyle=Y;let J=0,z=0,j=0,$=[0,0,0,0];switch(c){case"idle":J=Ue*T*.1;break;case"walk":const qe=Math.sin(a*Math.PI*4);J=Math.abs(qe)*-T*.5,$=[qe*T,-qe*T,-qe*T,qe*T];break;case"attacking":const Ye=Math.sin(a*Math.PI*4);z=T*2+Ye*T,j=T*2,J=T;break;case"eat":j=T*3+ye*T,J=T*1.5,e.fillStyle=be,e.fillRect(-T,ue-T,T*2,T);break;case"procreate":J=Math.sin(a*Math.PI*8)*T*.3,e.fillStyle="rgba(139, 69, 19, 0.5)";for(let xt=0;xt<5;xt++){const nn=(Math.random()-.5)*T*8,kn=ue+(Math.random()-.5)*T*2;ye>.5&&e.fillRect(nn,kn,T*.5,T*.5)}break}const R=T*3*x*(y?1.3:1),F=T*5*x,V=-F/1.5,ee=ue-R-T*2.5+J;e.fillStyle=Y,e.beginPath(),e.moveTo(V-T*.5,ee+R*.5),e.quadraticCurveTo(V-T*3,ee-T,V-T*2+Ue*T,ee+R+T),e.fill();const he=T*1.2*x,re=T*3*x,Se=T*2.5*x,ve=V+F*.8,K=V+F*.2;e.fillStyle=ae,e.fillRect(K,ue-Se,he,Se+$[2]),e.fillRect(ve,ue-re,he,re+$[0]),e.fillStyle=Y,e.beginPath(),e.moveTo(V,ee+R),e.lineTo(V,ee+T),e.quadraticCurveTo(V+F/2,ee,V+F,ee+T),e.lineTo(V+F,ee+R),e.fill(),e.fillStyle=Y,e.fillRect(K+T/2,ue-Se,he,Se+$[3]),e.fillRect(ve+T/2,ue-re,he,re+$[1]);const te=T*3.5*x,Oe=V+F-te*.3+z,ce=ee-te*.3+j;e.fillStyle=Y,e.beginPath(),e.arc(Oe,ce,te/2,0,Math.PI*2),e.fill(),e.beginPath(),e.ellipse(Oe+te*.4,ce+te*.2,T*1.5,T,0,0,Math.PI*2),e.fill(),m[1]>=0&&(e.fillStyle=Ee,e.fillRect(Oe+T*.5,ce-T*.5,T*.5,T*.5),c==="attacking"&&(e.fillStyle=we,e.fillRect(Oe+te*.5,ce+te*.4,T,T*.4))),e.fillStyle=ae,e.beginPath(),e.moveTo(Oe-te*.4,ce-te*.3),e.lineTo(Oe,ce-te*.7),e.lineTo(Oe,ce-te*.2),e.fill(),e.restore()}},F1=9;function U1(e,n){const{position:r,gender:o,age:l,decayProgress:a,food:c,radius:d,originalEntityType:h,geneCode:g}=n;if(e.save(),e.globalAlpha=1-a,h==="human"?Hf.render(e,r.x-d,r.y-d,d*2,d*2,a,"dead",o,l,[0,0],!1,0):h==="prey"?Ov.render(e,r.x-d,r.y-d,d*2,d*2,a,"dead",{gender:o,age:l,direction:[0,0],isPregnant:!1,hungryLevel:0,geneCode:g||8405024}):h==="predator"&&Mv.render(e,r.x-d,r.y-d,d*2,d*2,a,"dead",{gender:o,age:l,direction:[0,0],isPregnant:!1,hungryLevel:0,geneCode:g||8405024}),e.restore(),c.length>0){e.save(),e.font=`${F1}px Arial`,e.textAlign="center",e.textBaseline="middle";const m=St*.9,y=Math.PI/F0*3;c.forEach((S,_)=>{const C=_*y,T=r.x+m*Math.cos(C)*Math.atan2(_,_),E=r.y+m*Math.sin(C)*Math.atan2(_,_),M=P0[S.type];e.fillText(M,T,E)}),e.restore()}}function fo(e,n,r,o,l,a,c,d){e.save(),e.fillStyle=c,e.fillRect(n,r,o,l),e.fillStyle=d,e.fillRect(n,r,o*Math.max(0,a),l),e.restore()}function H1(e,n,r,o,l,a){if(e.save(),o.length===0){e.restore();return}const c=o.length*l;let d;c>a||c+(o.length-1)*4>a?d=(a-c)/(o.length-1):d=4,o.length===1&&(d=0);for(let h=0;h<o.length;h++){const g=P0[o[h].type];e.fillText(g,n+h*(l+d),r)}e.restore()}function L1(e,n,r,o,l){const a=n.autopilotControls.hoveredAutopilotAction;if(!a)return;let c,d=St/2;const h=ou[a.action],g=cv[a.action],m=`${h} ${g}`;if("targetEntityId"in a){const y=n.entities.entities.get(a.targetEntityId);y&&(c=y.position,d=y.radius)}else"position"in a&&(c=a.position);if(c){kv(e,c,d,Tf,If,2,r,o,l,n.mapDimensions),e.save(),e.font=`${Ao}px "Press Start 2P", Arial`,e.fillStyle="white",e.textAlign="center",e.textBaseline="bottom",e.shadowColor="black",e.shadowBlur=5;const{x:y,y:S}=uu(c,r,{width:o,height:l},n.mapDimensions),_=S-d-ru-Ao/2;e.fillText(m,y,_),e.restore()}}function B1(e,n,r,o,l){e.save();const a=(Math.sin(l*wf)+1)/2,c=r+ru+a*5;e.strokeStyle=Tf,e.lineWidth=2,e.setLineDash(If),e.beginPath(),e.arc(n.x,n.y,c,0,Math.PI*2),e.stroke(),e.setLineDash([]);const d=ou[o],h=cv[o];if(d){e.font=`${Ao*1.5}px "Press Start 2P", Arial`,e.textAlign="center",e.textBaseline="middle";const g=n.y-c-25;e.fillText(d,n.x,g),e.font=`${Ao*.8}px "Press Start 2P", Arial`,e.fillText(h,n.x,g+25)}e.restore()}function G1(e,n,r){e.save();const o=30,l=70,a=3,c=l/a;for(let d=0;d<a;d++){const h=d*c,g=(r*o+h)%l,m=1-g/l;e.strokeStyle=`rgba(255, 215, 0, ${m*.7})`,e.lineWidth=1+(1-m)*2,e.beginPath(),e.arc(n.x,n.y,g,0,Math.PI*2),e.stroke()}e.restore()}function b1(e,n){const{activeAutopilotAction:r,behaviors:o}=n.autopilotControls,l=yt(n);if(!l)return;const a=(c,d)=>{G1(c,d.position,n.time)};if(l.isCallingToFollow&&Tn(e,n.mapDimensions.width,n.mapDimensions.height,a,{position:l.position}),o.followLeader&&!r&&Tn(e,n.mapDimensions.width,n.mapDimensions.height,a,{position:l.position},70),r){let c,d=15;if("position"in r)c=r.position;else if("targetEntityId"in r){const h=n.entities.entities.get(r.targetEntityId);h&&(c=h.position,d=h.radius||30)}if(c&&r.action!==_e.AutopilotFollowMe&&!l.isCallingToFollow){const h=(g,m)=>{B1(g,m.position,d,r.action,n.time)};Tn(e,n.mapDimensions.width,n.mapDimensions.height,h,{position:{...c}},c,d+30)}}}function $m(e,n,r,o,l,a,c=!0){const d=n.split(" ");let h="";const g=[];for(let m=0;m<d.length;m++){const y=h+d[m]+" ";e.measureText(y).width>l&&m>0?(g.push(h),h=d[m]+" "):h=y}if(g.push(h),c)for(let m=0;m<g.length;m++)e.fillText(g[m],r,o+m*a);return g.length*a}function x1(e){return 1-Math.pow(1-e,3)}function z1(e,n,r,o){n.notificationButtonRects={dismiss:new Map,view:new Map};const l=n.notifications.filter(c=>!c.isDismissed);if(l.length===0)return;e.save();let a=o-LE;for(const c of l){const d=r-ml-or;e.font=`${pd}px "Press Start 2P", Arial`;const h=d+or,g=ml-or*2,m=$m(e,c.message,-9999,-9999,g,pd*1.2,!1),y=or*2+m+Gn,S=a-y,_=Date.now()-c.creationTime,C=Math.min(_/HE,1),T=x1(C),E=o,M=E+(S-E)*T;e.fillStyle=DE,e.beginPath(),e.roundRect(d,M,ml,y,NE),e.fill(),e.fillStyle=kE,e.textBaseline="top",$m(e,c.message,h,M+or,g,pd*1.2,!0);const H=M+y-Gn-or/2,D=d+ml-Gn-or/2,B={x:D,y:H,width:Gn,height:Gn};n.notificationButtonRects.dismiss.set(c.id,B);const x=n.hoveredButtonId===`notification-dismiss-${c.id}`;if(e.fillStyle=x?Sm:OE,e.font=`${Gn}px Arial`,e.textAlign="center",e.textBaseline="middle",e.fillText("",B.x+B.width/2,B.y+B.height/2),c.targetEntityIds||c.targetPosition||c.targetArea||c.targetRadius){const ae={x:D-Gn-ym,y:H,width:Gn,height:Gn};n.notificationButtonRects.view.set(c.id,ae);const Ee=n.hoveredButtonId===`notification-view-${c.id}`;e.fillStyle=Ee?Sm:ME,e.font=`${Gn*(Ee?1.5:1.2)}px Arial`,e.fillText("",ae.x+ae.width/2,ae.y+ae.height/2)}a-=y+ym}e.restore()}function $1(e){return e.length===0?0:e.reduce((r,o)=>r+o,0)/e.length}function Md(e,n,r,o,l,a,c,d){e.save(),e.fillStyle="rgba(255, 255, 255, 0.1)",e.fillRect(o,l,a,c),e.strokeStyle="#555",e.lineWidth=1,e.strokeRect(o,l,a,c);const h=$1(r);e.fillStyle="white",e.font="11px monospace",e.textAlign="left",e.fillText(`${n}: ${h.toFixed(2)}ms`,o+Ke,l+Ke+8);const g=Math.max(...r,1),m=r.map(y=>y/g*c);if(e.beginPath(),e.strokeStyle=d,e.lineWidth=2,m.length>1){e.moveTo(o,l+c-m[0]);for(let y=1;y<m.length;y++){const S=o+y/(m.length-1)*a,_=l+c-m[y];e.lineTo(S,_)}}else if(m.length===1){const y=l+c-m[0];e.moveTo(o,y),e.lineTo(o+a,y)}e.stroke(),e.fillStyle="rgba(255, 255, 255, 0.7)",e.font="10px monospace",e.textAlign="right",e.fillText(`${g.toFixed(2)}ms`,o+a-Ke,l+Ke+8),e.restore()}function W1(e,n,r){const{performanceMetrics:o}=n;if(!o)return;const l=280,a=240,c=r-l-Ke,d=Ke+fn*2;e.save(),e.fillStyle="rgba(0, 0, 0, 0.8)",e.fillRect(c,d,l,a),e.strokeStyle="#444",e.lineWidth=2,e.strokeRect(c,d,l,a),e.fillStyle="white",e.font="12px monospace",e.textAlign="left";let h=d+Ke+5;const g=c+Ke;e.fillStyle="#66ccff",e.font="bold 14px monospace",e.fillText(" Performance Debugger",g,h),h+=25,e.fillStyle="white",e.font="12px monospace";const m=Y1(n);e.fillText(`FPS: ${m.toFixed(1)}`,g,h),h+=20;const y=l-Ke*2,S=45,_=10;Md(e,"Render",Fd(n,"renderTime"),g,h,y,S,"#4CAF50"),h+=S+_,Md(e,"World Update",Fd(n,"worldUpdateTime"),g,h,y,S,"#2196F3"),h+=S+_,Md(e,"AI Update",Fd(n,"aiUpdateTime"),g,h,y,S,"#FFC107"),e.fillStyle="#888",e.font="10px monospace",e.textAlign="center",e.fillText("Press '2' to toggle this panel",c+l/2,d+a-10),e.restore()}function Y1(e){const{performanceMetrics:n}=e;if(!n||n.history.length===0)return 0;const r=n.history[n.history.length-1].bucketTime/(Et/wt);return n.history.filter(a=>r-a.bucketTime/(Et/wt)<1).length}function j1(e,n){if(e.length===0)return[];const r=new Map;for(const a of e){const c=Math.floor(a.bucketTime/(Et/wt));r.set(c,(r.get(c)||0)+a[n])}return Array.from(r.keys()).sort().map(a=>r.get(a)).slice(0,-1).slice(1).reverse()}function Fd(e,n){return j1(e.performanceMetrics.history,n)}function Lf(e,n,r){if(!n.aiBehaviorTree||!n.aiBlackboard)return;const o=n.aiBlackboard.getNodeExecutionData(),l=n.aiBehaviorTree;e.save(),e.font=`${lE}px Arial`,e.textAlign="left",e.textBaseline="top";const a=S=>{switch(S){case I.SUCCESS:return cE;case I.FAILURE:return dE;case I.RUNNING:return fE;case I.NOT_EVALUATED:case null:default:return hE}},c=S=>{if(!S.name||!o.has(S.name))return{width:0,height:0};let _=0,C=0;const T=o.get(S.name),E=` ${S.name}`+(T!=null&&T.debugInfo?`: ${T.debugInfo}`:""),M=e.measureText(E).width,H=(S.depth??0)*hm+8+M+gm+ps+20;if(_=Math.max(_,H),C+=fd,S.children)for(const D of S.children){const B=c(D);_=Math.max(_,B.width),C+=B.height}else if(S.child){const D=c(S.child);_=Math.max(_,D.width),C+=D.height}return{width:_,height:C}},d=(S,_,C,T)=>{if(!S.name||!o.has(S.name))return _;let E=_;const M=o.get(S.name),H=C+2+(S.depth??0)*hm;let D=I.NOT_EVALUATED,B=pm,x="";if(M){D=M.status,x=M.debugInfo;const ae=gE/wt*Et,Ee=r-M.lastExecuted,we=Math.max(0,1-Ee/ae);B=AI(pm,pE,we),Ee>Ls&&(D=I.NOT_EVALUATED)}const U=a(D);e.fillStyle=U,e.fillText("",H,E),e.fillStyle=B;const Y=` ${S.name}`+(x?`: ${x}`:"");if(e.fillText(Y,H+8,E),M&&M.executionHistory.length>0){const{executionHistory:ae}=M,Ee=iv/wt*Et,we=r,be=we-Ee,ke=C+T-ps-gm;let Ie=ke;const ue=E+(fd-pl)/2,Ue=ae.filter(V=>V.time<be);let ye=Ue.length>0?Ue[Ue.length-1].status:null,J=be;const z=ae.filter(V=>V.time>=be&&V.time<=we),j=ps/Ee;e.fillStyle="rgba(255, 255, 255, 0.1)",e.fillRect(ke,ue,ps,pl);for(const V of z){const he=(V.time-J)*j;he>0&&(e.fillStyle=a(ye),e.fillRect(Ie,ue,he,pl),Ie+=he),ye=V.status,J=V.time}r-J>Ls&&(ye=I.NOT_EVALUATED);const R=(we-J)*j;e.fillStyle=a(ye);const F=ke+ps-Ie;e.fillRect(Ie,ue,Math.min(R,F),pl)}if(E+=fd,S.children)for(const ae of S.children)E=d(ae,E,C,T);else S.child&&(E=d(S.child,E,C,T));return E},{width:h,height:g}=c(l);if(g===0){e.restore();return}const m=n.position.x+sE,y=n.position.y+aE-g/2;e.fillStyle=uE,e.fillRect(m,y,h,g+4),d(l,y+2,m,h),e.restore()}const V1={moving:"walk",gathering:"gathering",eating:"eat",feeding:"eat",procreating:"procreate",idle:"idle",attacking:"attacking",planting:"gathering"};function X1(e,n){var d;const{radius:r,position:o,activeAction:l="idle"}=n,a=((d=n.stateMachine)==null?void 0:d[0])||"N/A",c=n.isAdult?St+20:St*.6+20;e.save(),e.fillStyle="white",e.font="10px Arial",e.textAlign="center",e.fillText(`Action: ${l}`,o.x,o.y-c),e.fillText(`State: ${a}`,o.x,o.y-c+10),e.fillText(`HP: ${n.hitpoints}`,o.x,o.y-c+20),e.fillText(`Cooldown: ${n.attackCooldown||"N/A"}`,o.x,o.y-c+30),e.fillText(`Tribe: ${n.leaderId||"N/A"}`,o.x,o.y-c+40),e.restore(),e.beginPath(),e.arc(o.x,o.y,r,0,Math.PI*2),e.strokeStyle="rgba(255, 0, 0, 0.5)",e.lineWidth=1,e.stroke(),e.closePath()}function K1(e,n,r,o,l){e.save(),e.font=`${Kd}px Arial`,e.textAlign="center",e.textBaseline="middle",e.fillText(r,n.x,n.y-(o?St:_o)-Kd-l),e.restore()}function q1(e,n,r,o,l){const a=n.x,c=n.y-r-o/2;e.save(),e.fillStyle=l,e.strokeStyle=l,e.lineWidth=1.5,e.beginPath(),e.rect(a-o/2,c,o,o/2),e.fill(),e.beginPath(),e.moveTo(a-o/2,c),e.lineTo(a-o/4,c-o/3),e.lineTo(a-o/6,c),e.moveTo(a-o/6,c),e.lineTo(a,c-o/2),e.lineTo(a+o/6,c),e.moveTo(a+o/6,c),e.lineTo(a+o/4,c-o/3),e.lineTo(a+o/2,c),e.stroke(),e.restore()}function Q1(e,n,r){var d;const{position:o,radius:l}=n,a=o.x-cd/2,c=o.y-l-eE;if(((d=n.stateMachine)==null?void 0:d[0])===zi){const h=n.stateMachine[1],g=r-h.attackStartTime,m=Math.min(g/G0,1);fo(e,a,c,cd,um,m,ro,tE)}else if(n.attackCooldown&&n.attackCooldown>0){const h=1-n.attackCooldown/iu;fo(e,a,c,cd,um,h,ro,nE)}}function Z1(e,n,r){const l="";e.save(),e.font="15px Arial",e.textAlign="center",e.textBaseline="bottom",e.shadowColor="black",e.shadowBlur=3,e.fillText(l,n.x,n.y-r),e.restore()}function J1(e,n,r=!1,o=!1,l=!1,a=!1,c=!1,d=!1,h=!1,g=!1,m,y){const{position:S,activeAction:_="idle"}=n,C=n.isAdult?St:St*.6,T=V1[_]||"idle";Hf.render(e,S.x-C,S.y-C,C*2,C*2,n.animationProgress||0,T,n.gender,n.age,[n.direction.x,n.direction.y],n.isPregnant??!1,n.hunger),d&&(e.save(),e.strokeStyle=K0,e.lineWidth=2,e.beginPath(),e.arc(S.x,S.y,C+3,0,2*Math.PI),e.stroke(),e.restore());let E,M;if(c?(E=LI,M=X0):r?(E=HI,M=Af):l?(E=BI,M=FI):o?(E=GI,M=j0):a&&(E=bI,M=V0),E&&M&&q1(e,S,C,E,M),n.tribeBadge&&K1(e,S,n.tribeBadge,n.isAdult??!1,E??0),h){let D=(n.isAdult?St:_o)+5;E&&(D+=E),n.tribeBadge&&(D+=Kd),Z1(e,S,D)}const H=g&&(y===void 0||n.id===y);H&&n.aiBlackboard&&Lf(e,n,m),Q1(e,n,m),H&&X1(e,n)}const eR={grazing:"eat",moving:"walk",procreating:"procreate",feeding:"eat",idle:"idle"};function tR(e,n){var d;const{radius:r,position:o,activeAction:l="idle"}=n,a=((d=n.stateMachine)==null?void 0:d[0])||"N/A",c=n.isAdult?St+20:St*.6+20;e.save(),e.fillStyle="white",e.font="10px Arial",e.textAlign="center",e.fillText(`Action: ${l}`,o.x,o.y-c),e.fillText(`State: ${a}`,o.x,o.y-c+10),e.fillText(`HP: ${n.hitpoints}`,o.x,o.y-c+20),e.fillText(`Hunger: ${Math.round(n.hunger)}`,o.x,o.y-c+30),e.fillText(`Age: ${Math.round(n.age)}`,o.x,o.y-c+40),e.restore(),e.beginPath(),e.arc(o.x,o.y,r,0,Math.PI*2),e.strokeStyle="rgba(0, 255, 0, 0.5)",e.lineWidth=1,e.stroke(),e.closePath()}function nR(e,n,r=!1,o=0,l){var m,y;const{position:a,activeAction:c="idle"}=n,d=n.isAdult?n.radius:n.radius*.6,h=eR[c]||"idle";if(Ov.render(e,a.x-d,a.y-d,d*2,d*2,n.animationProgress||0,h,{gender:n.gender,age:n.age,direction:[((m=n.direction)==null?void 0:m.x)||1,((y=n.direction)==null?void 0:y.y)||0],isPregnant:n.isPregnant??!1,hungryLevel:n.hunger,geneCode:n.geneCode}),n.hitpoints<n.maxHitpoints){const S=d*1.5,_=3,C=a.x-S/2,T=a.y-d-8;e.fillStyle="#555",e.fillRect(C,T,S,_);const E=n.hitpoints/n.maxHitpoints;e.fillStyle=E>.5?"#4CAF50":E>.25?"#FFC107":"#F44336",e.fillRect(C,T,S*E,_)}const g=r&&(l===void 0||n.id===l);g&&n.aiBlackboard&&Lf(e,n,o),g&&tR(e,n)}const iR={attacking:"attacking",eating:"eat",moving:"walk",procreating:"procreate",feeding:"eat",idle:"idle"};function rR(e,n){var d;const{radius:r,position:o,activeAction:l="idle"}=n,a=((d=n.stateMachine)==null?void 0:d[0])||"N/A",c=n.isAdult?St+20:St*.6+20;e.save(),e.fillStyle="white",e.font="10px Arial",e.textAlign="center",e.fillText(`Action: ${l}`,o.x,o.y-c),e.fillText(`State: ${a}`,o.x,o.y-c+10),e.fillText(`HP: ${n.hitpoints}`,o.x,o.y-c+20),e.fillText(`Hunger: ${Math.round(n.hunger)}`,o.x,o.y-c+30),e.fillText(`Age: ${Math.round(n.age)}`,o.x,o.y-c+40),e.restore(),e.beginPath(),e.arc(o.x,o.y,r,0,Math.PI*2),e.strokeStyle="rgba(255, 0, 0, 0.5)",e.lineWidth=1,e.stroke(),e.closePath()}function oR(e,n,r=!1,o=0,l){var m,y;const{position:a,activeAction:c="idle"}=n,d=n.isAdult?n.radius:n.radius*.6,h=iR[c]||"idle";if(Mv.render(e,a.x-d,a.y-d,d*2,d*2,n.animationProgress||0,h,{gender:n.gender,age:n.age,direction:[((m=n.direction)==null?void 0:m.x)||1,((y=n.direction)==null?void 0:y.y)||0],isPregnant:n.isPregnant??!1,hungryLevel:n.hunger,geneCode:n.geneCode}),n.hitpoints<n.maxHitpoints){const S=d*1.5,_=3,C=a.x-S/2,T=a.y-d-8;e.fillStyle="#555",e.fillRect(C,T,S,_);const E=n.hitpoints/n.maxHitpoints;e.fillStyle=E>.5?"#4CAF50":E>.25?"#FFC107":"#F44336",e.fillRect(C,T,S*E,_)}(n.attackCooldown&&n.attackCooldown>0||n.huntCooldown&&n.huntCooldown>0)&&(e.strokeStyle="#FF8C00",e.lineWidth=3,e.beginPath(),e.arc(a.x,a.y,d+3,0,2*Math.PI),e.stroke());const g=r&&(l===void 0||n.id===l);g&&n.aiBlackboard&&Lf(e,n,o),g&&rR(e,n)}const Fv=15;function Wm(e,n,r,o,l=1.5){const a=r-n.startTime,c=Math.min(a/n.duration,1),d=1-c,g=1+Math.sin(c*Math.PI*2)*(l-1),m=Fv*g;e.save(),e.globalAlpha=d,e.beginPath(),e.arc(n.position.x,n.position.y,Math.max(0,m),0,Math.PI*2),e.fillStyle=o,e.fill(),e.restore()}function Jr(e,n,r,o,l=2){const a=r-n.startTime,c=Math.min(a/n.duration,1),d=1-c,h=Fv*2*c;e.save(),e.globalAlpha=d,e.beginPath(),e.arc(n.position.x,n.position.y,h,0,Math.PI*2),e.strokeStyle=o,e.lineWidth=l,e.stroke(),e.restore()}function Oi(e,n,r,o){const l=r-n.startTime,a=Math.min(l/n.duration,1),c=1-a,d=-20*a;e.save(),e.globalAlpha=c,e.font="20px Arial",e.textAlign="center",e.fillText(o,n.position.x,n.position.y+d),e.restore()}function sR(e,n,r){switch(n.type){case se.Hunger:Wm(e,n,r,"rgba(255, 165, 0, 0.7)",1);break;case se.Procreation:Oi(e,n,r,"");break;case se.Pregnant:Wm(e,n,r,"rgba(255, 105, 180, 0.7)",1.2);break;case se.TargetAcquired:Jr(e,n,r,"rgba(255, 0, 0, 0.8)",3);break;case se.Attack:Oi(e,n,r,"");break;case se.Partnered:Oi(e,n,r,"");break;case se.BushClaimed:Jr(e,n,r,"rgba(0, 255, 0, 0.7)",2);break;case se.BushClaimLost:Jr(e,n,r,"rgba(128, 128, 128, 0.7)",2);break;case se.Eating:Oi(e,n,r,"");break;case se.ChildFed:Oi(e,n,r,"");break;case se.AttackDeflected:Oi(e,n,r,"");break;case se.AttackResisted:Oi(e,n,r,"");break;case se.Hit:Oi(e,n,r,"");break;case se.SeizeBuildup:Jr(e,n,r,"rgba(255, 215, 0, 0.8)",4);break;case se.Seize:Jr(e,n,r,"rgba(148, 0, 211, 0.8)",4);break;case se.CallToAttack:Jr(e,n,r,"rgba(255, 255, 0, 0.8)",4);break}}function Ym(e,n,r,o,l,a,c){e.save();const{position:d}=n;e.strokeStyle=o,e.lineWidth=l+Math.sin(c*a)*(l/2),e.setLineDash([8,8]),e.beginPath(),e.arc(d.x,d.y,r,0,2*Math.PI),e.stroke(),e.restore()}function aR(e,n,r,o,l){const a=yt(n),c=a?Ct(n,a):[],d=ui(c),{width:h,height:g}=n.mapDimensions;Array.from(n.entities.entities.values()).sort((C,T)=>C.position.y-T.position.y||C.id-T.id).filter(C=>Cl(C,o,l,n.mapDimensions)).forEach(C=>{var T,E;if(C.type==="berryBush")Tn(e,h,g,D1,C,n,a,n.time);else if(C.type==="human"){const M=C,H=M.id===(a==null?void 0:a.id),D=c.some(we=>we.id===M.id),B=M.id===(d==null?void 0:d.id),x=a&&(M.id===a.motherId||M.id===a.fatherId),U=a&&(((T=M.partnerIds)==null?void 0:T.includes(a.id))||((E=a.partnerIds)==null?void 0:E.includes(M.id))),Y=(a==null?void 0:a.attackTargetId)===M.id,ae=M.leaderId?n.entities.entities.get(M.leaderId):void 0,Ee=a?M.leaderId===a.id&&M.activeAction==="moving"&&M.target===M.leaderId&&(ae==null?void 0:ae.isCallingToFollow):!1;Tn(e,h,g,J1,M,H,x,D,U,B,Y,Ee,r,n.time,n.debugCharacterId)}else C.type==="corpse"?Tn(e,h,g,U1,C):C.type==="prey"?Tn(e,h,g,nR,C,r,n.time,n.debugCharacterId):C.type==="predator"&&Tn(e,h,g,oR,C,r,n.time,n.debugCharacterId)}),n.visualEffects.filter(C=>Cl(C,o,l,n.mapDimensions)).forEach(C=>{Tn(e,h,g,sR,C,n.time)});const _=n.notifications.filter(C=>!C.isDismissed);for(const C of _)if(C.highlightedEntityIds&&C.renderHighlights)for(const T of C.highlightedEntityIds){const E=n.entities.entities.get(T);E&&Cl(E,o,l,n.mapDimensions)&&Tn(e,h,g,Ym,E,BE,GE,xE,bE,n.time)}if(n.tutorialState.isActive&&n.tutorialState.highlightedEntityIds.size>0)for(const C of n.tutorialState.highlightedEntityIds){const T=n.entities.entities.get(C);T&&Cl(T,o,l,n.mapDimensions)&&Tn(e,h,g,Ym,T,_E,rv,ov,wf,n.time)}}function lR(e,n,r,o,l,a){let c=null,d=null;e.textAlign="left";let h=Ke+fn;const m=n.time/(Et/wt)/nu%1,y=gs[eo.Time],S=25,_=Ke+S;e.fillText(y,Ke,h+en/2+fn/3),fo(e,_,h,Di,en,m,ro,VI),h+=en+Jn;const C=h+ir/2,T=h+(ir-en)/2,E=5;Vs(e,{x:Ke*2,y:C},ir,5,r.gender,!1,!1,!1);const M=Ke+ir+E,H=Di+S-(ir+E)*2;fo(e,M,T,H,en,Math.floor(r.age)/Bs,ro,jI),Vs(e,{x:M+H+E+ir/2,y:C},ir,Bs,r.gender,!1,!1,!1),h+=en+Jn*2;const D=[],B=new Set;if(D.push({member:r,isPlayer:!0,isHeir:!1,isPartner:!1,isParent:!1}),B.add(r.id),o&&!B.has(o.id)&&(D.push({member:o,isPlayer:!1,isHeir:!0,isPartner:!1,isParent:!1}),B.add(o.id)),l.forEach(ue=>{B.has(ue.id)||(D.push({member:ue,isPlayer:!1,isHeir:!1,isPartner:!0,isParent:!1}),B.add(ue.id))}),a.forEach(ue=>{B.has(ue.id)||(D.push({member:ue,isPlayer:!1,isHeir:!1,isPartner:!1,isParent:!1}),B.add(ue.id))}),r.motherId&&!B.has(r.motherId)){const ue=n.entities.entities.get(r.motherId);ue&&(D.push({member:ue,isPlayer:!1,isHeir:!1,isPartner:!1,isParent:!0}),B.add(ue.id))}if(r.fatherId&&!B.has(r.fatherId)){const ue=n.entities.entities.get(r.fatherId);ue&&(D.push({member:ue,isPlayer:!1,isHeir:!1,isPartner:!1,isParent:!0}),B.add(ue.id))}const x=gs[eo.Family],U=10,Y=Ke+fn+U,ae=Di+S-(fn+U),Ee=h+fl/2;e.font=`${fn}px "Press Start 2P", Arial`,e.textBaseline="middle",e.fillText(x,Ke,Ee);const we=h+fl/2;w1(e,Y,we,D,fl,ae),h+=fl+Jn,e.textBaseline="alphabetic";const be=gs[eo.Hitpoints];e.fillText(be,Ke,h+en/2+fn/3),fo(e,_,h,Di,en,r.hitpoints/r.maxHitpoints,ro,YI),h+=en+Jn;const ke=gs[eo.Hunger];e.fillText(ke,Ke,h+en/2+fn/3),fo(e,_,h,Di,en,(Ar-r.hunger)/Ar,ro,WI),c={x:Ke,y:h-Jn/2,width:Di+S,height:en+Jn},h+=en+Jn,e.textBaseline="middle";const Ie=gs[eo.Food];return e.fillText(Ie,Ke,h+dl/2),H1(e,_,h+dl/2,r.food,dl,Di),d={x:Ke,y:h-Jn/5,width:Di+S,height:dl+Jn},e.textBaseline="alphabetic",{hungerBarRect:c,foodBarRect:d}}let As=[],jm=0;const uR=36,cR=200;function dR(e,n,r,o){const l=n.search.prey.count(),a=n.search.predator.count(),c=n.search.berryBush.count();n.time-jm>=uR&&(As.push({time:n.time,prey:l,predators:a,bushes:c}),As.length>cR&&(As=As.slice(-200)),jm=n.time);const d=Je*et,h=l/d*1e6,g=a/d*1e6,m=c/d*1e6,y=a1(),S=Math.floor(n.time/(24*365)),_=Math.floor(n.time%(24*365)/24),C=Math.floor(n.time%24),T=400,E=Math.min(o*.8,600),M=r-T-10,H=Ke+fn*2;e.save(),e.fillStyle="rgba(0, 0, 0, 0.9)",e.fillRect(M,H,T,E),e.strokeStyle="#444",e.lineWidth=2,e.strokeRect(M,H,T,E),e.fillStyle="white",e.font="12px monospace",e.textAlign="left";let D=H+20;const B=14,x=M+15;e.fillStyle="#66ccff",e.font="bold 14px monospace",e.fillText(" Ecosystem Debugger",x,D),D+=25,e.fillStyle="white",e.font="12px monospace",e.fillText(`Game Time: Year ${S}, Day ${_}, Hour ${C}`,x,D),D+=B,e.fillText(`Map Size: ${Je}  ${et} pixels`,x,D),D+=20,e.fillStyle="#66ccff",e.font="bold 13px monospace",e.fillText(" Q-Learning Status",x,D),D+=18,y&&(e.fillText(`Q-Table Size: ${y.qTableSize} entries`,x,D),D+=B,e.fillText(`Exploration Rate: ${(y.explorationRate*100).toFixed(1)}%`,x,D),D+=B);const U=As.slice(-20);U.length>1&&(e.fillStyle="#66ccff",e.font="bold 13px monospace",e.fillText(" Population Trends (Last 20 Points)",x,D),D+=30,fR(e,x,D,U),D+=50),e.fillStyle="#66ccff",e.font="bold 13px monospace",e.fillText(" Density (per 1000 px)",x,D),D+=18,e.fillStyle="white",e.font="12px monospace";const Y=(ri/d*1e6).toFixed(2),ae=(oi/d*1e6).toFixed(2),Ee=(si/d*1e6).toFixed(2);e.fillText(`Prey: ${h.toFixed(2)} (target: ${Y})`,x,D),D+=B,e.fillText(`Predators: ${g.toFixed(2)} (target: ${ae})`,x,D),D+=B,e.fillText(`Bushes: ${m.toFixed(2)} (target: ${Ee})`,x,D),D+=20,e.fillStyle="#66ccff",e.font="bold 13px monospace",e.fillText(" Current Population Status",x,D),D+=18,e.fillStyle="white",e.font="12px monospace";const we=Math.round(l/ri*100),be=Math.round(a/oi*100),ke=Math.round(c/si*100),Ie=ue=>ue<50?"#ff4444":ue<80?"#ffaa44":ue>120?"#44aaff":"#44ff44";e.fillStyle=Ie(we),e.fillText(`Prey: ${l}/${ri} (${we}%)`,x,D),D+=B,e.fillStyle=Ie(be),e.fillText(`Predators: ${a}/${oi} (${be}%)`,x,D),D+=B,e.fillStyle=Ie(ke),e.fillText(`Bushes: ${c}/${si} (${ke}%)`,x,D),D+=20,e.fillStyle="#66ccff",e.font="bold 13px monospace",e.fillText(" Current Parameters",x,D),D+=18,e.fillStyle="white",e.font="10px monospace",e.fillText("Prey:",x,D),D+=13,e.fillText(` Gestation: ${n.ecosystem.preyGestationPeriod.toFixed(1)}h`,x,D),D+=11,e.fillText(` Procreation: ${n.ecosystem.preyProcreationCooldown.toFixed(1)}h`,x,D),D+=11,e.fillText(` Hunger: ${n.ecosystem.preyHungerIncreasePerHour.toFixed(1)}/h`,x,D),D+=13,e.fillText("Predators:",x,D),D+=13,e.fillText(` Gestation: ${n.ecosystem.predatorGestationPeriod.toFixed(1)}h`,x,D),D+=11,e.fillText(` Procreation: ${n.ecosystem.predatorProcreationCooldown.toFixed(1)}h`,x,D),D+=11,e.fillText(` Hunger: ${n.ecosystem.predatorHungerIncreasePerHour.toFixed(1)}/h`,x,D),D+=13,e.fillText("Bushes:",x,D),D+=13,e.fillText(` Spread Chance: ${(n.ecosystem.berryBushSpreadChance*100).toFixed(1)}%`,x,D),D+=15,e.fillStyle="#888",e.font="10px monospace",e.textAlign="center",e.fillText("Press '1' to toggle this debugger",M+T/2,H+E-10),e.restore()}function fR(e,n,r,o){if(o.length<2)return;const d={prey:Math.max(...o.map(g=>g.prey),ri),predators:Math.max(...o.map(g=>g.predators),oi),bushes:Math.max(...o.map(g=>g.bushes),si)};[{data:o.map(g=>g.prey),color:"#44ff44",label:"Prey",target:ri,max:d.prey},{data:o.map(g=>g.predators),color:"#ff4444",label:"Predators",target:oi,max:d.predators},{data:o.map(g=>g.bushes),color:"#ffaa44",label:"Bushes",target:si,max:d.bushes}].forEach((g,m)=>{const y=n+m*115,S=r;e.fillStyle=g.color,e.font="10px monospace",e.fillText(g.label,y,S-5),e.strokeStyle="#333",e.lineWidth=1,e.strokeRect(y,S,100,30),e.beginPath(),e.strokeStyle=g.color;for(let C=0;C<g.data.length;C++){const T=y+C/(g.data.length-1)*100,E=S+30-g.data[C]/g.max*30;C===0?e.moveTo(T,E):e.lineTo(T,E)}e.stroke(),e.beginPath(),e.strokeStyle="#888",e.setLineDash([2,2]);const _=S+30-g.target/g.max*30;e.moveTo(y,_),e.lineTo(y+100,_),e.stroke(),e.setLineDash([])})}function Vm(e,n,r){e.save();const{x:o,y:l,width:a,height:c}=n.rect,d=Q0;if(e.beginPath(),e.moveTo(o+d,l),e.lineTo(o+a-d,l),e.quadraticCurveTo(o+a,l,o+a,l+d),e.lineTo(o+a,l+c-d),e.quadraticCurveTo(o+a,l+c,o+a-d,l+c),e.lineTo(o+d,l+c),e.quadraticCurveTo(o,l+c,o,l+c-d),e.lineTo(o,l+d),e.quadraticCurveTo(o,l,o+d,l),e.closePath(),e.fillStyle=n.isDisabled?Z0:n.backgroundColor,e.fill(),n.activated){e.save();const h=(Math.sin(Date.now()/1e3*nv)+1)/2;e.strokeStyle=tv,e.lineWidth=2+h*2,e.globalAlpha=.7+h*.3,e.stroke(),e.restore()}if(n.lastActivated){const h=Date.now()-n.lastActivated;if(h<Wl){const g=1-h/Wl;e.fillStyle=ev,e.globalAlpha=g,e.fill(),e.globalAlpha=1}}r&&!n.isDisabled&&(e.fillStyle=Ef,e.globalAlpha=.5,e.fill(),e.globalAlpha=1),e.fillStyle=n.isDisabled?J0:n.textColor,n.icon?(e.font=`${c*.55}px "Press Start 2P", Arial`,e.textAlign="center",e.textBaseline="middle",e.fillText(n.icon,o+a/2,l+c/2),n.text&&(e.font=`${c*.18}px "Press Start 2P", Arial`,e.textAlign="right",e.textBaseline="bottom",e.fillText(n.text,o+a-4,l+c-2))):(e.font=`${fn*1.5}px "Press Start 2P", Arial`,e.textAlign="center",e.textBaseline="middle",e.fillText(n.text,o+a/2,l+c/2)),e.restore()}function hR(e,n,r,o){e.save(),e.fillStyle="rgba(0, 0, 0, 0.6)",e.fillRect(0,0,r,o);const l=500,a=150,c=(r-l)/2,d=(o-a)/2;e.fillStyle=In,e.font=`${fn*1.1}px "Press Start 2P", Arial`,e.textAlign="center",e.textBaseline="middle",e.fillText("Are you sure you want to exit",r/2,d+a/3-10),e.fillText("to the main menu?",r/2,d+a/3+10);const h=ii*1.5,g=q0,m=d+a-g-Ke*2,y=20,S=h*2+y,_=c+(l-S)/2,C={id:"confirmExitYes",action:Ce.ConfirmExitYes,rect:{x:_,y:m,width:h,height:g},text:"Yes",backgroundColor:cr,textColor:In,currentWidth:h},T=_+h+y,E={id:"confirmExitNo",action:Ce.ConfirmExitNo,rect:{x:T,y:m,width:h,height:g},text:"No",backgroundColor:cr,textColor:In,currentWidth:h};n.uiButtons.push(C,E),Vm(e,C,n.hoveredButtonId===C.id),Vm(e,E,n.hoveredButtonId===E.id),e.restore()}function Xl(e,n,r,o,l,a=!1){var d;if(e.save(),e.clearRect(0,0,e.canvas.width,e.canvas.height),e.fillStyle="#2c5234",e.fillRect(0,0,e.canvas.width,e.canvas.height),e.translate(e.canvas.width/2-r.x,e.canvas.height/2-r.y),!a&&n.gameOver){e.restore(),P1(e,n);return}aR(e,n,n.debugPanel===Xt.General,r,l);const c=n.notifications.filter(h=>!h.isDismissed);for(const h of c){const g=(Math.sin(n.time*UE)+1)/2;e.globalAlpha=g*.5+.25,e.fillStyle=FE,h.targetArea&&e.fillRect(h.targetArea.x,h.targetArea.y,h.targetArea.width,h.targetArea.height),h.targetRadius&&(e.beginPath(),e.arc(h.targetRadius.x,h.targetRadius.y,h.targetRadius.radius,0,Math.PI*2),e.fill())}if(e.globalAlpha=1,b1(e,n),e.restore(),!a){e.fillStyle=xI,e.font=`${fn}px "Press Start 2P", Arial`,e.shadowColor=zI,e.shadowBlur=$I,n.uiButtons=[];const h=yt(n);let g=null,m=null;if(h){const _=Ct(n,h),C=ui(_),T=((d=h.partnerIds)==null?void 0:d.map(M=>n.entities.entities.get(M)).filter(M=>M!==void 0))||[],E=lR(e,n,h,C,T,_);g=E.hungerBarRect,m=E.foodBarRect}const y=$0(n,h==null?void 0:h.leaderId);_1(e,n,y,e.canvas.width,e.canvas.height);const{commandButtonsRect:S}=f1(e,n,e.canvas.width);if(e.shadowColor="transparent",e.shadowBlur=0,h&&(L1(e,n,r,e.canvas.width,e.canvas.height),o.length>0&&m1(e,o,h,r,e.canvas.width,e.canvas.height,n.mapDimensions)),n.tutorialState.activeUIHighlights.size>0){const{activeUIHighlights:_}=n.tutorialState;_.has(Sr.HUNGER_BAR)&&g&&kd(e,g,n.time),_.has(Sr.FOOD_BAR)&&m&&kd(e,m,n.time),_.has(Sr.COMMAND_BUTTONS)&&S&&kd(e,S,n.time)}if(n.tutorialState.isActive){const _=R1(e,n,e.canvas.width,e.canvas.height);_&&n.uiButtons.push({id:"tutorial-dismiss",action:Ce.DismissTutorial,rect:_,text:"",currentWidth:_.width,backgroundColor:"transparent",textColor:"transparent"})}switch(z1(e,n,e.canvas.width,e.canvas.height),n.debugPanel){case Xt.Ecosystem:dR(e,n,e.canvas.width,e.canvas.height);break;case Xt.Performance:W1(e,n,l.width);break}n.isPaused&&n.exitConfirmation!=="pending"&&h1(e),n.exitConfirmation==="pending"&&hR(e,n,e.canvas.width,e.canvas.height)}}const pR=Pn.div`
  position: relative;
  width: 100vw;
  height: 100vh;
  overflow: hidden;
`,gR=Pn.canvas`
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background-color: #2c5234;
`,mR=Pn.div`
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  text-align: center;
  z-index: 1;
  background: linear-gradient(to bottom, rgba(0, 0, 0, 0.7) 0%, rgba(0, 0, 0, 0) 50%, rgba(0, 0, 0, 0.7) 100%);
`,vR=Pn.h1`
  font-family: 'Press Start 2P', cursive;
  font-size: 4rem;
  color: #fff;
  text-shadow: 4px 4px 0px #ff0000;
  margin-bottom: 2rem;
`,yR=Pn.button`
  font-family: 'Press Start 2P', cursive;
  font-size: 1.5rem;
  padding: 1rem 2rem;
  color: #fff;
  background-color: #ff0000;
  border: 2px solid #fff;
  box-shadow: 4px 4px 0px #fff;
  cursor: pointer;
  transition: all 0.2s ease-in-out;

  &:hover {
    background-color: #fff;
    color: #ff0000;
    box-shadow: 4px 4px 0px #ff0000;
  }
`,SR=Pn.div`
  position: absolute;
  bottom: 1rem;
  font-family: 'Press Start 2P', cursive;
  font-size: 0.8rem;
  color: #fff;
  text-shadow: 2px 2px 0px #000;
  a {
    color: #fff;
    text-decoration: none;
    &:hover {
      text-decoration: underline;
    }
  }
`,Ud="intro-soundtrack",Xm=()=>{const{setAppState:e}=Xs(),n=Pe.useRef(null),r=Pe.useRef(null),o=Pe.useRef(AC()),l=Pe.useRef(),a=Pe.useRef(o.current.viewportCenter),c=Pe.useRef(),d=Pe.useCallback(()=>{wm(Ud,2),e("game")},[e]);Pe.useEffect(()=>{const m=y=>{(y.key==="Enter"||y.key===" ")&&d()};return window.addEventListener("keydown",m),()=>{window.removeEventListener("keydown",m)}},[d]),Pe.useEffect(()=>(Cf(Te.SoundTrack1,{loop:!0,trackId:Ud}),()=>{wm(Ud,2)}),[]),Pe.useEffect(()=>{const m=n.current;if(!m)return;r.current=m.getContext("2d");const y=()=>{m&&r.current&&(m.width=window.innerWidth,m.height=window.innerHeight,Xl(r.current,o.current,a.current,[],{width:m.width,height:m.height},!0))};return y(),window.addEventListener("resize",y),()=>window.removeEventListener("resize",y)},[]),Pe.useEffect(()=>{const m=()=>{const S=_I(o.current);if(S.length>0){const _=Math.floor(Math.random()*S.length);c.current=S[_].id}};m();const y=setInterval(m,qA);return()=>clearInterval(y)},[]);const[h,g]=_0(m=>{var _,C;if(!r.current)return;if(l.current===void 0){l.current=m;return}const y=Math.min((m-l.current)/1e3,1);o.current=lu(o.current,y);const S=c.current?o.current.entities.entities.get(c.current):void 0;if(S){const{mapDimensions:T}=o.current,{width:E,height:M}=T;let H={...S.position};const D=H.x-a.current.x;Math.abs(D)>E/2&&(D>0?H.x-=E:H.x+=E);const B=H.y-a.current.y;Math.abs(B)>M/2&&(B>0?H.y-=M:H.y+=M);let x=gf(a.current,H,lf*y);x={x:(x.x%E+E)%E,y:(x.y%M+M)%M},a.current=x}Xl(r.current,o.current,a.current,[],{width:((_=n.current)==null?void 0:_.width)||800,height:((C=n.current)==null?void 0:C.height)||600},!0),l.current=m});return Pe.useEffect(()=>(g(),h),[g,h]),He.jsxs(pR,{children:[He.jsx(gR,{ref:n}),He.jsxs(mR,{children:[He.jsx(vR,{children:"Tribe2"}),He.jsx(yR,{onClick:d,children:"Start Game"}),He.jsxs(SR,{children:["by"," ",He.jsx("a",{href:"https://github.com/gtanczyk",target:"_blank",rel:"noopener noreferrer",children:"gtanczyk"})]})]})]})};function AR(){console.log("Tribe game initialized with detailed 2D world state.");const e=SC();return e.ecosystem={preyGestationPeriod:pr,preyProcreationCooldown:gr,predatorGestationPeriod:mr,predatorProcreationCooldown:vr,preyHungerIncreasePerHour:Li,predatorHungerIncreasePerHour:Bi,berryBushSpreadChance:ai},e.debugPanel=Xt.None,e.performanceMetrics={currentBucket:{renderTime:0,worldUpdateTime:0,aiUpdateTime:0},history:[]},e}const TR=({canvasRef:e,ctxRef:n,gameStateRef:r,viewportCenterRef:o,playerActionHintsRef:l})=>(Pe.useEffect(()=>{const a=e.current;if(!a)return;n.current=a.getContext("2d");const c=()=>{a&&n.current&&r.current&&(a.width=window.innerWidth,a.height=window.innerHeight,Xl(n.current,r.current,o.current,l.current,{width:a.width,height:a.height},!1))};return c(),window.addEventListener("resize",c),()=>window.removeEventListener("resize",c)},[]),He.jsx("canvas",{ref:e,style:{display:"block",background:"#2c5234"}})),IR=(e,n,r)=>{let o;const l=CI(e,r);if(l)if(n.isAdult&&l.type==="berryBush"&&l.food.length>0)o={action:_e.AutopilotGather,targetEntityId:l.id};else if(n.isAdult&&l.type==="corpse"&&l.food.length>0)o={action:_e.AutopilotGather,targetEntityId:l.id};else if(l.type==="human"){const a=l;n.isAdult&&Co(n,a,r)?o={action:_e.AutopilotAttack,targetEntityId:a.id}:wr(n,a,r)?o={action:_e.AutopilotProcreate,targetEntityId:a.id}:n.food.length>0&&!a.isAdult&&(a.motherId===n.id||a.fatherId===n.id)&&(o={action:_e.AutopilotFeedChild,targetEntityId:a.id})}else l.type==="prey"?o={action:_e.AutopilotAttack,targetEntityId:l.id}:l.type==="predator"&&(o={action:_e.AutopilotAttack,targetEntityId:l.id});else r.autopilotControls.isManuallyPlanting&&n.food.filter(a=>a.type===li.Berry).length>=Hs&&yf(e,r,1,tu,n.id)?o={action:_e.AutopilotPlant,position:e}:o={action:_e.AutopilotMove,position:e};return o},ER=(e,n)=>{if(e.isPaused||!yt(e))return;const o=e.autopilotControls.hoveredAutopilotAction;e.autopilotControls.activeAutopilotAction=void 0,o?(e.autopilotControls.activeAutopilotAction=o,(o.action===_e.AutopilotMove||o.action===_e.AutopilotGather)&&(e.hasPlayerMovedEver=!0),o.action===_e.AutopilotPlant&&(e.hasPlayerPlantedBush=!0)):e.autopilotControls.activeAutopilotAction={action:_e.AutopilotMove,position:n},e.autopilotControls.isManuallyMoving=!1,e.autopilotControls.isManuallyPlanting=!1},wR=(e,n)=>{var l,a,c,d;let r=!0,o=n;switch(e){case"escape":const{autopilotControls:h}=n;h.activeAutopilotAction||h.isManuallyMoving||h.isManuallyPlanting?(h.activeAutopilotAction=void 0,h.isManuallyMoving=!1,h.isManuallyPlanting=!1):o.exitConfirmation==="pending"?(o.exitConfirmation="inactive",o.isPaused=!1):(o.exitConfirmation="pending",o.isPaused=!0);break;case"m":n.isMuted=!n.isMuted,Ps(n.masterVolume,n.isMuted);break;case"=":case"+":const g=Math.min(1,n.masterVolume+.1);n.masterVolume=parseFloat(g.toFixed(1)),Ps(n.masterVolume,n.isMuted);break;case"-":const m=Math.max(0,n.masterVolume-.1);n.masterVolume=parseFloat(m.toFixed(1)),Ps(n.masterVolume,n.isMuted);break;case"t":o=lu(n,uv);break;case" ":case"p":n.isPaused=!n.isPaused;break;case"":case"`":o.debugPanel===Xt.General?(o.debugPanel=Xt.None,o.debugCharacterId=void 0):(o.debugPanel=Xt.General,o.debugCharacterId||(o.debugCharacterId=((l=yt(o))==null?void 0:l.id)??((a=Array.from(o.entities.entities.values()).find(S=>S.type==="human"||S.type==="prey"||S.type==="predator"))==null?void 0:a.id)));break;case"1":o.debugPanel=Xt.Ecosystem,o.debugCharacterId||(o.debugCharacterId=((c=yt(o))==null?void 0:c.id)??((d=Array.from(o.entities.entities.values()).find(S=>S.type==="human"||S.type==="prey"||S.type==="predator"))==null?void 0:d.id));break;case"2":o.debugPanel=Xt.Performance;break;case"3":o.debugPanel=Xt.Ecosystem;break;case"tab":o.debugPanel=Xt.General;const y=Array.from(o.entities.entities.values()).filter(S=>S.type==="human"||S.type==="prey"||S.type==="predator");if(y.length>0){const S=y.sort((E,M)=>{if(E.type==="human"&&E.isPlayer)return-1;if(M.type==="human"&&M.isPlayer)return 1;if(E.type!==M.type){const H={human:0,prey:1,predator:2},D=H[E.type]??999,B=H[M.type]??999;return D-B}return E.id-M.id}),_=o.debugCharacterId,T=((_?S.findIndex(E=>E.id===_):-1)+1)%S.length;o.debugCharacterId=S[T].id}else o.debugCharacterId=void 0;break;default:r=!1;break}return{newState:o,handled:r}},_R=(e,n,r,o,l)=>{const a={gameState:r};if(n&&["e","b","r","h"].includes(e)&&r.hasPlayerEnabledAutopilot++,e==="e"){if(n){r.autopilotControls.behaviors.gathering=!r.autopilotControls.behaviors.gathering;return}const c=De(o,r,"berryBush",vt,g=>g.food.length>0&&o.food.length<o.maxFood),d=De(o,r,"corpse",vt,g=>g.food.length>0&&o.food.length<o.maxFood);let h=null;c&&d?h=X(o.position,c.position,r.mapDimensions.width,r.mapDimensions.height)<=X(o.position,d.position,r.mapDimensions.width,r.mapDimensions.height)?c:d:h=c||d,h&&(o.activeAction="gathering",Me(a,Te.Gather,o.position))}else if(e==="r"){if(n){r.autopilotControls.behaviors.procreation=!r.autopilotControls.behaviors.procreation;return}De(o,r,"human",vt,d=>wr(o,d,r))&&(o.activeAction="procreating",Me(a,Te.Procreate,o.position))}else if(e==="f")o.food.length>0&&(o.activeAction="eating",Me(a,Te.Eat,o.position));else if(e==="h"){if(n){r.autopilotControls.behaviors.feedChildren=!r.autopilotControls.behaviors.feedChildren;return}const c=l.find(d=>d.type===_e.FeedChild);c&&c.targetEntity&&(o.activeAction="feeding",o.target=c.targetEntity.id)}else if(e==="arrowup"||e==="w")o.direction.y=-1,o.activeAction="moving",o.target=void 0,r.hasPlayerMovedEver=!0,r.autopilotControls.isManuallyMoving=!0,r.autopilotControls.activeAutopilotAction=void 0;else if(e==="arrowdown"||e==="s")o.direction.y=1,o.activeAction="moving",o.target=void 0,r.hasPlayerMovedEver=!0,r.autopilotControls.isManuallyMoving=!0,r.autopilotControls.activeAutopilotAction=void 0;else if(e==="arrowleft"||e==="a")o.direction.x=-1,o.activeAction="moving",o.target=void 0,r.hasPlayerMovedEver=!0,r.autopilotControls.isManuallyMoving=!0,r.autopilotControls.activeAutopilotAction=void 0;else if(e==="arrowright"||e==="d")o.direction.x=1,o.activeAction="moving",o.target=void 0,r.hasPlayerMovedEver=!0,r.autopilotControls.isManuallyMoving=!0,r.autopilotControls.activeAutopilotAction=void 0;else if(e==="q"){if(n){r.autopilotControls.behaviors.attack=!r.autopilotControls.behaviors.attack;return}const c=De(o,r,"human",$n,d=>Co(o,d,r))??De(o,r,"predator",$n)??De(o,r,"prey",$n);c&&(o.activeAction="attacking",o.attackTargetId=c.id)}else if(e==="b"){if(n){r.autopilotControls.behaviors.planting=!r.autopilotControls.behaviors.planting;return}if(l.find(d=>d.type===_e.Plant)){const d=yf(o.position,r,50,Yd);d&&(o.activeAction="planting",o.target=d,r.hasPlayerPlantedBush=!0)}}else e==="v"?(o.isCallingToAttack=!0,o.callToAttackEndTime=r.time+To,Re(r,se.CallToAttack,o.position,To),Me(a,Te.CallToAttack,o.position)):e==="c"?(o.isCallingToFollow=!0,o.callToFollowEndTime=r.time+bs,Re(r,se.CallToFollow,o.position,bs),Me(a,Te.CallToFollow,o.position)):e==="k"&&Pf(o,r)},CR=(e,n,r,o)=>{e==="arrowup"||e==="w"||e==="arrowdown"||e==="s"?n.direction.y=0:(e==="arrowleft"||e==="a"||e==="arrowright"||e==="d")&&(n.direction.x=0),!o.current.has("arrowup")&&!o.current.has("arrowdown")&&!o.current.has("arrowleft")&&!o.current.has("arrowright")&&!o.current.has("w")&&!o.current.has("a")&&!o.current.has("s")&&!o.current.has("d")&&(n.activeAction==="moving"&&(n.activeAction="idle"),r.autopilotControls.isManuallyMoving=!1),!o.current.has("e")&&n.activeAction==="gathering"&&(n.activeAction="idle"),!o.current.has("f")&&n.activeAction==="eating"&&(n.activeAction="idle"),!o.current.has("r")&&n.activeAction==="procreating"&&(n.activeAction="idle"),!o.current.has("h")&&n.activeAction==="feeding"&&(n.activeAction="idle")},RR=(e,n,r)=>{let l=yt(e);if(e.debugCharacterId){const a=e.entities.entities.get(e.debugCharacterId);a&&"position"in a&&(l=a)}if(l){const{mapDimensions:a}=e,{width:c,height:d}=a;let h={...l.position};const g=h.x-n.x;Math.abs(g)>c/2&&(g>0?h.x-=c:h.x+=c);const m=h.y-n.y;Math.abs(m)>d/2&&(m>0?h.y-=d:h.y+=d);let y=gf(n,h,lf*r);return y={x:(y.x%c+c)%c,y:(y.y%d+d)%d},y}return e.viewportCenter};function PR(e,n){const{width:r,height:o}=e.mapDimensions;e.viewportCenter={x:(n.x%r+r)%r,y:(n.y%o+o)%o}}const NR=(e,n,r,o)=>{const l={gameState:r},a=yt(r);a&&Me(l,Te.ButtonClick,a.position);const c=r.uiButtons.find(h=>h.id===e.id);c&&(c.lastActivated=Date.now()),n&&[Ce.CommandGather,Ce.CommandPlant,Ce.ToggleProcreationBehavior].includes(e.action)&&r.hasPlayerEnabledAutopilot++;const{behaviors:d}=r.autopilotControls;switch(e.action){case Ce.ReturnToIntro:r.exitConfirmation="pending",r.isPaused=!0;break;case Ce.ConfirmExitYes:o(),r.exitConfirmation="inactive";break;case Ce.ConfirmExitNo:r.exitConfirmation="inactive",r.isPaused=!1;break;case Ce.ToggleMute:r.isMuted=!r.isMuted,Ps(r.masterVolume,r.isMuted);break;case Ce.TogglePause:r.isPaused=!r.isPaused;break;case Ce.FastForward:return lu(r,uv);case Ce.DismissTutorial:r.tutorialState.isActive=!1;break;case Ce.CommandEat:a&&a.food.length>0&&(a.activeAction="eating");break;case Ce.CommandGather:n?d.gathering=!d.gathering:a&&(a.activeAction="gathering");break;case Ce.CommandPlant:n?d.planting=!d.planting:a&&(r.autopilotControls.isManuallyPlanting=!0);break;case Ce.ToggleProcreationBehavior:d.procreation=!d.procreation;break;case Ce.ToggleAttackBehavior:d.attack=!d.attack;break;case Ce.ToggleFeedChildBehavior:d.feedChildren=!d.feedChildren;break;case Ce.ToggleAutopilotFollowLeaderBehavior:d.followLeader=!d.followLeader;break;case Ce.CommandCallToAttack:a&&a.leaderId===a.id&&(a.isCallingToAttack=!0,a.callToAttackEndTime=r.time+To,Re(r,se.CallToAttack,a.position,To),Me(l,Te.CallToAttack,a.position));break;case Ce.CommandFollowMe:n?d.followLeader=!d.followLeader:a&&a.leaderId===a.id&&(a.isCallingToFollow=!0,a.callToFollowEndTime=r.time+bs,Re(r,se.CallToFollow,a.position,bs),Me(l,Te.CallToFollow,a.position));break;case Ce.CommandTribeSplit:a&&Pf(a,r);break;case Ce.ToggleDiplomacy:if(a&&a.leaderId&&e.targetTribeId){const h=a.leaderId,g=e.targetTribeId,m=r.entities.entities.get(g),y=a.diplomacy,S=m==null?void 0:m.diplomacy;if(y&&S){const C=(y.get(g)||Gt.Friendly)===Gt.Friendly?Gt.Hostile:Gt.Friendly;y.set(g,C),S.set(h,C)}}break}return r};function DR(e,n,r){if(!e.notificationButtonRects)return!1;const o=yt(e);for(const[l,a]of e.notificationButtonRects.dismiss.entries())if(n>=a.x&&n<=a.x+a.width&&r>=a.y&&r<=a.y+a.height)return qE(e,l),o&&Me({gameState:e},Te.ButtonClick,o.position),!0;for(const[l,a]of e.notificationButtonRects.view.entries())if(n>=a.x&&n<=a.x+a.width&&r>=a.y&&r<=a.y+a.height){const c=e.notifications.find(d=>d.id===l);if(c){let d=c.targetPosition;if(!d&&c.targetEntityIds&&c.targetEntityIds.length>0){const h=e.entities.entities.get(c.targetEntityIds[0]);h&&(d=h.position)}return d&&PR(e,d),o&&Me({gameState:e},Te.ButtonClick,o.position),c.highlightedEntityIds&&(c.renderHighlights=!c.renderHighlights),!0}}return!1}const kR=({isActive:e,gameStateRef:n,canvasRef:r,viewportCenterRef:o,playerActionHintsRef:l,keysPressed:a,returnToIntro:c})=>(Pe.useEffect(()=>{const d=h=>{if(!e()||n.current.gameOver||!r.current||!h.target||h.target!==r.current)return;const g=r.current.getBoundingClientRect(),m=h.clientX-g.left,y=h.clientY-g.top;if(DR(n.current,m,y))return;const _=n.current.uiButtons.find(T=>m>=T.rect.x&&m<=T.rect.x+T.rect.width&&y>=T.rect.y&&y<=T.rect.y+T.rect.height);if(_){n.current=NR(_,h.shiftKey,n.current,c);return}const C=Lm({x:m,y},o.current,{width:r.current.width,height:r.current.height},n.current.mapDimensions);ER(n.current,C)};return window.addEventListener("mousedown",d),()=>{window.removeEventListener("mousedown",d)}},[e,r,n,o,c]),Pe.useEffect(()=>{const d=h=>{if(!e()||!r.current)return;const g=r.current.getBoundingClientRect(),m=h.clientX-g.left,y=h.clientY-g.top;n.current.mousePosition={x:m,y};let S;if(n.current.notificationButtonRects){for(const[C,T]of n.current.notificationButtonRects.dismiss.entries())if(m>=T.x&&m<=T.x+T.width&&y>=T.y&&y<=T.y+T.height){S=`notification-dismiss-${C}`;break}if(!S){for(const[C,T]of n.current.notificationButtonRects.view.entries())if(m>=T.x&&m<=T.x+T.width&&y>=T.y&&y<=T.y+T.height){S=`notification-view-${C}`;break}}}if(!S)for(let C=n.current.uiButtons.length-1;C>=0;C--){const T=n.current.uiButtons[C];if(m>=T.rect.x&&m<=T.rect.x+T.rect.width&&y>=T.rect.y&&y<=T.rect.y+T.rect.height){S=T.id;break}}if(n.current.hoveredButtonId=S,S){n.current.autopilotControls.hoveredAutopilotAction=void 0;return}const _=yt(n.current);if(_){const C=Lm({x:m,y},o.current,{width:r.current.width,height:r.current.height},n.current.mapDimensions);n.current.autopilotControls.hoveredAutopilotAction=IR(C,_,n.current)}else n.current.autopilotControls.hoveredAutopilotAction=void 0};return window.addEventListener("mousemove",d),()=>{window.removeEventListener("mousemove",d)}},[e,r,n,o]),Pe.useEffect(()=>{const d=g=>{if(!e()||n.current.gameOver)return;const m=g.key.toLowerCase();(m===" "||m==="p"||m==="tab")&&g.preventDefault();const y=wR(m,n.current);if(n.current=y.newState,y.handled)return;const S=yt(n.current);S&&(a.current.add(m),_R(m,g.shiftKey,n.current,S,l.current))},h=g=>{if(!e()||n.current.gameOver)return;const m=g.key.toLowerCase();a.current.delete(m);const y=yt(n.current);y&&CR(m,y,n.current,a)};return window.addEventListener("keydown",d),window.addEventListener("keyup",h),()=>{window.removeEventListener("keydown",d),window.removeEventListener("keyup",h)}},[e,n,l,a,c]),null),OR=({gameStateRef:e,ctxRef:n,debugPanelTypeRef:r,viewportCenterRef:o,playerActionHintsRef:l,keysPressed:a,canvasRef:c,setAppState:d,appState:h})=>{const g=Pe.useRef(),{returnToIntro:m}=Xs(),[y,S,_]=_0(C=>{var B,x;if(!n.current||!g.current){g.current=C;return}const T=Math.min(C-g.current,1e3)/1e3,{performanceMetrics:E}=e.current;E.currentBucket={renderTime:0,worldUpdateTime:0,aiUpdateTime:0};const M=performance.now();e.current=lu(e.current,T),E.currentBucket.worldUpdateTime=performance.now()-M;const H=yt(e.current);H?l.current=Nf(e.current,H):l.current=[],o.current=RR(e.current,o.current,T);const D=performance.now();Xl(n.current,e.current,o.current,l.current,{width:((B=c.current)==null?void 0:B.width)||800,height:((x=c.current)==null?void 0:x.height)||600},!1),E.currentBucket.renderTime=performance.now()-D,E.history.push({bucketTime:e.current.time,...E.currentBucket}),E.history.length>QA&&E.history.shift(),g.current=C,e.current.gameOver&&h!=="gameOver"&&(Cf(Te.GameOver,{masterVolume:e.current.masterVolume,isMuted:e.current.isMuted}),d("gameOver",{generations:e.current.generationCount,cause:e.current.causeOfGameOver||"Unknown"}))});return Pe.useEffect(()=>(S(),y),[S,y]),He.jsx(kR,{isActive:_,gameStateRef:e,canvasRef:c,viewportCenterRef:o,playerActionHintsRef:l,debugPanelTypeRef:r,keysPressed:a,returnToIntro:m})},Km=()=>{const[e]=Pe.useState(()=>AR());return He.jsx(MR,{initialState:e})},MR=({initialState:e})=>{const n=Pe.useRef(null),r=Pe.useRef(null),o=Pe.useRef(e),l=Pe.useRef(new Set),a=Pe.useRef(e.debugPanel),c=Pe.useRef(e.viewportCenter),d=Pe.useRef([]),{appState:h,setAppState:g}=Xs();return He.jsxs(He.Fragment,{children:[He.jsx(TR,{canvasRef:n,ctxRef:r,gameStateRef:o,debugPanelTypeRef:a,viewportCenterRef:c,playerActionHintsRef:d}),He.jsx(OR,{gameStateRef:o,ctxRef:r,debugPanelTypeRef:a,viewportCenterRef:c,playerActionHintsRef:d,keysPressed:l,canvasRef:n,setAppState:g,appState:h})]})},FR=Pn.div`
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  text-align: center;
  background-color: rgba(0, 0, 0, 0.75); // Semi-transparent overlay
  color: #fff;
  padding: 20px;
  z-index: 10; // Ensure it's on top
`,UR=Pn.h1`
  font-family: 'Press Start 2P', cursive;
  font-size: 4rem;
  color: #ff4136; // Red for emphasis
  text-shadow: 4px 4px 0px #000;
  margin-bottom: 1.5rem;
`,Nl=Pn.p`
  font-family: 'Press Start 2P', cursive;
  font-size: 1.2rem;
  margin: 0.5em 0;
  color: #fff;
  text-shadow: 2px 2px 0px #000;
`,HR=Pn.button`
  font-family: 'Press Start 2P', cursive;
  font-size: 1rem;
  padding: 1rem 2rem;
  margin-top: 2em;
  color: #fff;
  background-color: #ff4136; // Red button
  border: 2px solid #fff;
  box-shadow: 4px 4px 0px #fff;
  cursor: pointer;
  transition: all 0.2s ease-in-out;
  text-transform: uppercase;

  &:hover {
    background-color: #fff;
    color: #ff4136;
    box-shadow: 4px 4px 0px #ff4136;
  }
`,LR=()=>{const{setAppState:e,gameOverDetails:n}=Xs(),r=()=>{e("intro")};return He.jsxs(FR,{children:[He.jsx(UR,{children:"Game Over"}),He.jsx(Nl,{children:"Your tribe's lineage has ended."}),n&&He.jsxs(He.Fragment,{children:[He.jsxs(Nl,{children:["Generations Survived: ",n.generations]}),He.jsxs(Nl,{children:["Cause of Extinction: ",n.cause]})]}),!n&&He.jsx(Nl,{children:"Game details are unavailable."}),He.jsx(HR,{onClick:r,children:"Return to Menu"})]})},BR=WA`
  /* CSS Reset */
  *, *::before, *::after {
    box-sizing: border-box;
  }

  body {
    margin: 0;
    padding: 0;
    font-family: 'Press Start 2P', 'Arial', sans-serif;
    background-color: #121212;
    color: #f0f0f0;
    line-height: 1.6;
  }

  /* Additional global styles */
  h1, h2, h3, h4, h5, h6 {
    margin-top: 0;
  }

  button {
    cursor: pointer;
    font-family: inherit;
  }

  /* Prevent overflow issues */
  html, body {
    height: 100%;
    overflow-x: hidden;
  }

  /* Root element for React app */
  #root {
    height: 100%;
  }
`;function GR(e,n){Pe.useEffect(()=>{const r=()=>{const o=document.location.hash==="#game"?"game":"intro";n(o)};return window.addEventListener("hashchange",r),r(),()=>{window.removeEventListener("hashchange",r)}},[]),Pe.useEffect(()=>{e==="game"?document.location.hash="#game":e==="intro"&&(document.location.hash="")},[e])}const bR=()=>{const{appState:e,setAppState:n}=Xs();GR(e,n);const r=()=>{switch(e){case"intro":return He.jsx(Xm,{});case"game":return He.jsx(Km,{});case"gameOver":return He.jsxs(He.Fragment,{children:[He.jsx(Km,{}),He.jsx(LR,{})]});default:return He.jsx(Xm,{})}};return He.jsxs(He.Fragment,{children:[He.jsx(BR,{}),r()]})},qm=document.getElementById("root");qm?uw().then(()=>{zS.createRoot(qm).render(He.jsx(zn.StrictMode,{children:He.jsx($S,{initialAppState:document.location.hash==="#game"?"game":"intro",children:He.jsx(bR,{})})}))}):console.error("Failed to find the root element");
