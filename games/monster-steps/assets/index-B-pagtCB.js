var to=Object.defineProperty;var oo=(e,t,o)=>t in e?to(e,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):e[t]=o;var Ae=(e,t,o)=>oo(e,typeof t!="symbol"?t+"":t,o);(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))n(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const r of i.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&n(r)}).observe(document,{childList:!0,subtree:!0});function o(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function n(s){if(s.ep)return;s.ep=!0;const i=o(s);fetch(s.href,i)}})();var ke,P,Ct,z,Je,Pt,Ne,Ve,Fe,Re,he={},kt=[],no=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|itera/i,De=Array.isArray;function J(e,t){for(var o in t)e[o]=t[o];return e}function Dt(e){var t=e.parentNode;t&&t.removeChild(e)}function $e(e,t,o){var n,s,i,r={};for(i in t)i=="key"?n=t[i]:i=="ref"?s=t[i]:r[i]=t[i];if(arguments.length>2&&(r.children=arguments.length>3?ke.call(arguments,2):o),typeof e=="function"&&e.defaultProps!=null)for(i in e.defaultProps)r[i]===void 0&&(r[i]=e.defaultProps[i]);return be(e,r,n,s,null)}function be(e,t,o,n,s){var i={type:e,props:t,key:o,ref:n,__k:null,__:null,__b:0,__e:null,__d:void 0,__c:null,constructor:void 0,__v:s??++Ct,__i:-1,__u:0};return s==null&&P.vnode!=null&&P.vnode(i),i}function le(e){return e.children}function Z(e,t){this.props=e,this.context=t}function ee(e,t){if(t==null)return e.__?ee(e.__,e.__i+1):null;for(var o;t<e.__k.length;t++)if((o=e.__k[t])!=null&&o.__e!=null)return o.__e;return typeof e.type=="function"?ee(e):null}function It(e){var t,o;if((e=e.__)!=null&&e.__c!=null){for(e.__e=e.__c.base=null,t=0;t<e.__k.length;t++)if((o=e.__k[t])!=null&&o.__e!=null){e.__e=e.__c.base=o.__e;break}return It(e)}}function ze(e){(!e.__d&&(e.__d=!0)&&z.push(e)&&!Te.__r++||Je!==P.debounceRendering)&&((Je=P.debounceRendering)||Pt)(Te)}function Te(){var e,t,o,n,s,i,r,c;for(z.sort(Ne);e=z.shift();)e.__d&&(t=z.length,n=void 0,i=(s=(o=e).__v).__e,r=[],c=[],o.__P&&((n=J({},s)).__v=s.__v+1,P.vnode&&P.vnode(n),Ye(o.__P,n,s,o.__n,o.__P.namespaceURI,32&s.__u?[i]:null,r,i??ee(s),!!(32&s.__u),c),n.__v=s.__v,n.__.__k[n.__i]=n,Lt(r,n,c),n.__e!=i&&It(n)),z.length>t&&z.sort(Ne));Te.__r=0}function Et(e,t,o,n,s,i,r,c,a,u,h){var l,d,_,b,y,v=n&&n.__k||kt,g=t.length;for(o.__d=a,so(o,t,v),a=o.__d,l=0;l<g;l++)(_=o.__k[l])!=null&&typeof _!="boolean"&&typeof _!="function"&&(d=_.__i===-1?he:v[_.__i]||he,_.__i=l,Ye(e,_,d,s,i,r,c,a,u,h),b=_.__e,_.ref&&d.ref!=_.ref&&(d.ref&&qe(d.ref,null,_),h.push(_.ref,_.__c||b,_)),y==null&&b!=null&&(y=b),65536&_.__u||d.__k===_.__k?a=At(_,a,e):typeof _.type=="function"&&_.__d!==void 0?a=_.__d:b&&(a=b.nextSibling),_.__d=void 0,_.__u&=-196609);o.__d=a,o.__e=y}function so(e,t,o){var n,s,i,r,c,a=t.length,u=o.length,h=u,l=0;for(e.__k=[],n=0;n<a;n++)r=n+l,(s=e.__k[n]=(s=t[n])==null||typeof s=="boolean"||typeof s=="function"?null:typeof s=="string"||typeof s=="number"||typeof s=="bigint"||s.constructor==String?be(null,s,null,null,null):De(s)?be(le,{children:s},null,null,null):s.constructor===void 0&&s.__b>0?be(s.type,s.props,s.key,s.ref?s.ref:null,s.__v):s)!=null?(s.__=e,s.__b=e.__b+1,c=io(s,o,r,h),s.__i=c,i=null,c!==-1&&(h--,(i=o[c])&&(i.__u|=131072)),i==null||i.__v===null?(c==-1&&l--,typeof s.type!="function"&&(s.__u|=65536)):c!==r&&(c==r-1?l--:c==r+1?l++:c>r?h>a-r?l+=c-r:l--:c<r&&(c==r-l?l-=c-r:l++),c!==n+l&&(s.__u|=65536))):(i=o[r])&&i.key==null&&i.__e&&(131072&i.__u)==0&&(i.__e==e.__d&&(e.__d=ee(i)),Ue(i,i,!1),o[r]=null,h--);if(h)for(n=0;n<u;n++)(i=o[n])!=null&&(131072&i.__u)==0&&(i.__e==e.__d&&(e.__d=ee(i)),Ue(i,i))}function At(e,t,o){var n,s;if(typeof e.type=="function"){for(n=e.__k,s=0;n&&s<n.length;s++)n[s]&&(n[s].__=e,t=At(n[s],t,o));return t}e.__e!=t&&(t&&e.type&&!o.contains(t)&&(t=ee(e)),o.insertBefore(e.__e,t||null),t=e.__e);do t=t&&t.nextSibling;while(t!=null&&t.nodeType===8);return t}function Me(e,t){return t=t||[],e==null||typeof e=="boolean"||(De(e)?e.some(function(o){Me(o,t)}):t.push(e)),t}function io(e,t,o,n){var s=e.key,i=e.type,r=o-1,c=o+1,a=t[o];if(a===null||a&&s==a.key&&i===a.type&&(131072&a.__u)==0)return o;if(n>(a!=null&&(131072&a.__u)==0?1:0))for(;r>=0||c<t.length;){if(r>=0){if((a=t[r])&&(131072&a.__u)==0&&s==a.key&&i===a.type)return r;r--}if(c<t.length){if((a=t[c])&&(131072&a.__u)==0&&s==a.key&&i===a.type)return c;c++}}return-1}function xe(e,t,o){t[0]==="-"?e.setProperty(t,o??""):e[t]=o==null?"":typeof o!="number"||no.test(t)?o:o+"px"}function de(e,t,o,n,s){var i;e:if(t==="style")if(typeof o=="string")e.style.cssText=o;else{if(typeof n=="string"&&(e.style.cssText=n=""),n)for(t in n)o&&t in o||xe(e.style,t,"");if(o)for(t in o)n&&o[t]===n[t]||xe(e.style,t,o[t])}else if(t[0]==="o"&&t[1]==="n")i=t!==(t=t.replace(/(PointerCapture)$|Capture$/i,"$1")),t=t.toLowerCase()in e||t==="onFocusOut"||t==="onFocusIn"?t.toLowerCase().slice(2):t.slice(2),e.l||(e.l={}),e.l[t+i]=o,o?n?o.u=n.u:(o.u=Ve,e.addEventListener(t,i?Re:Fe,i)):e.removeEventListener(t,i?Re:Fe,i);else{if(s=="http://www.w3.org/2000/svg")t=t.replace(/xlink(H|:h)/,"h").replace(/sName$/,"s");else if(t!="width"&&t!="height"&&t!="href"&&t!="list"&&t!="form"&&t!="tabIndex"&&t!="download"&&t!="rowSpan"&&t!="colSpan"&&t!="role"&&t!="popover"&&t in e)try{e[t]=o??"";break e}catch{}typeof o=="function"||(o==null||o===!1&&t[4]!=="-"?e.removeAttribute(t):e.setAttribute(t,t=="popover"&&o==1?"":o))}}function et(e){return function(t){if(this.l){var o=this.l[t.type+e];if(t.t==null)t.t=Ve++;else if(t.t<o.u)return;return o(P.event?P.event(t):t)}}}function Ye(e,t,o,n,s,i,r,c,a,u){var h,l,d,_,b,y,v,g,w,D,E,U,G,K,j,Q,$=t.type;if(t.constructor!==void 0)return null;128&o.__u&&(a=!!(32&o.__u),i=[c=t.__e=o.__e]),(h=P.__b)&&h(t);e:if(typeof $=="function")try{if(g=t.props,w="prototype"in $&&$.prototype.render,D=(h=$.contextType)&&n[h.__c],E=h?D?D.props.value:h.__:n,o.__c?v=(l=t.__c=o.__c).__=l.__E:(w?t.__c=l=new $(g,E):(t.__c=l=new Z(g,E),l.constructor=$,l.render=ao),D&&D.sub(l),l.props=g,l.state||(l.state={}),l.context=E,l.__n=n,d=l.__d=!0,l.__h=[],l._sb=[]),w&&l.__s==null&&(l.__s=l.state),w&&$.getDerivedStateFromProps!=null&&(l.__s==l.state&&(l.__s=J({},l.__s)),J(l.__s,$.getDerivedStateFromProps(g,l.__s))),_=l.props,b=l.state,l.__v=t,d)w&&$.getDerivedStateFromProps==null&&l.componentWillMount!=null&&l.componentWillMount(),w&&l.componentDidMount!=null&&l.__h.push(l.componentDidMount);else{if(w&&$.getDerivedStateFromProps==null&&g!==_&&l.componentWillReceiveProps!=null&&l.componentWillReceiveProps(g,E),!l.__e&&(l.shouldComponentUpdate!=null&&l.shouldComponentUpdate(g,l.__s,E)===!1||t.__v===o.__v)){for(t.__v!==o.__v&&(l.props=g,l.state=l.__s,l.__d=!1),t.__e=o.__e,t.__k=o.__k,t.__k.forEach(function(te){te&&(te.__=t)}),U=0;U<l._sb.length;U++)l.__h.push(l._sb[U]);l._sb=[],l.__h.length&&r.push(l);break e}l.componentWillUpdate!=null&&l.componentWillUpdate(g,l.__s,E),w&&l.componentDidUpdate!=null&&l.__h.push(function(){l.componentDidUpdate(_,b,y)})}if(l.context=E,l.props=g,l.__P=e,l.__e=!1,G=P.__r,K=0,w){for(l.state=l.__s,l.__d=!1,G&&G(t),h=l.render(l.props,l.state,l.context),j=0;j<l._sb.length;j++)l.__h.push(l._sb[j]);l._sb=[]}else do l.__d=!1,G&&G(t),h=l.render(l.props,l.state,l.context),l.state=l.__s;while(l.__d&&++K<25);l.state=l.__s,l.getChildContext!=null&&(n=J(J({},n),l.getChildContext())),w&&!d&&l.getSnapshotBeforeUpdate!=null&&(y=l.getSnapshotBeforeUpdate(_,b)),Et(e,De(Q=h!=null&&h.type===le&&h.key==null?h.props.children:h)?Q:[Q],t,o,n,s,i,r,c,a,u),l.base=t.__e,t.__u&=-161,l.__h.length&&r.push(l),v&&(l.__E=l.__=null)}catch(te){if(t.__v=null,a||i!=null){for(t.__u|=a?160:32;c&&c.nodeType===8&&c.nextSibling;)c=c.nextSibling;i[i.indexOf(c)]=null,t.__e=c}else t.__e=o.__e,t.__k=o.__k;P.__e(te,t,o)}else i==null&&t.__v===o.__v?(t.__k=o.__k,t.__e=o.__e):t.__e=ro(o.__e,t,o,n,s,i,r,a,u);(h=P.diffed)&&h(t)}function Lt(e,t,o){t.__d=void 0;for(var n=0;n<o.length;n++)qe(o[n],o[++n],o[++n]);P.__c&&P.__c(t,e),e.some(function(s){try{e=s.__h,s.__h=[],e.some(function(i){i.call(s)})}catch(i){P.__e(i,s.__v)}})}function ro(e,t,o,n,s,i,r,c,a){var u,h,l,d,_,b,y,v=o.props,g=t.props,w=t.type;if(w==="svg"?s="http://www.w3.org/2000/svg":w==="math"?s="http://www.w3.org/1998/Math/MathML":s||(s="http://www.w3.org/1999/xhtml"),i!=null){for(u=0;u<i.length;u++)if((_=i[u])&&"setAttribute"in _==!!w&&(w?_.localName===w:_.nodeType===3)){e=_,i[u]=null;break}}if(e==null){if(w===null)return document.createTextNode(g);e=document.createElementNS(s,w,g.is&&g),i=null,c=!1}if(w===null)v===g||c&&e.data===g||(e.data=g);else{if(i=i&&ke.call(e.childNodes),v=o.props||he,!c&&i!=null)for(v={},u=0;u<e.attributes.length;u++)v[(_=e.attributes[u]).name]=_.value;for(u in v)if(_=v[u],u!="children"){if(u=="dangerouslySetInnerHTML")l=_;else if(u!=="key"&&!(u in g)){if(u=="value"&&"defaultValue"in g||u=="checked"&&"defaultChecked"in g)continue;de(e,u,null,_,s)}}for(u in g)_=g[u],u=="children"?d=_:u=="dangerouslySetInnerHTML"?h=_:u=="value"?b=_:u=="checked"?y=_:u==="key"||c&&typeof _!="function"||v[u]===_||de(e,u,_,v[u],s);if(h)c||l&&(h.__html===l.__html||h.__html===e.innerHTML)||(e.innerHTML=h.__html),t.__k=[];else if(l&&(e.innerHTML=""),Et(e,De(d)?d:[d],t,o,n,w==="foreignObject"?"http://www.w3.org/1999/xhtml":s,i,r,i?i[0]:o.__k&&ee(o,0),c,a),i!=null)for(u=i.length;u--;)i[u]!=null&&Dt(i[u]);c||(u="value",b!==void 0&&(b!==e[u]||w==="progress"&&!b||w==="option"&&b!==v[u])&&de(e,u,b,v[u],s),u="checked",y!==void 0&&y!==e[u]&&de(e,u,y,v[u],s))}return e}function qe(e,t,o){try{if(typeof e=="function"){var n=typeof e.__u=="function";n&&e.__u(),n&&t==null||(e.__u=e(t))}else e.current=t}catch(s){P.__e(s,o)}}function Ue(e,t,o){var n,s;if(P.unmount&&P.unmount(e),(n=e.ref)&&(n.current&&n.current!==e.__e||qe(n,null,t)),(n=e.__c)!=null){if(n.componentWillUnmount)try{n.componentWillUnmount()}catch(i){P.__e(i,t)}n.base=n.__P=null}if(n=e.__k)for(s=0;s<n.length;s++)n[s]&&Ue(n[s],t,o||typeof e.type!="function");o||e.__e==null||Dt(e.__e),e.__c=e.__=e.__e=e.__d=void 0}function ao(e,t,o){return this.constructor(e,o)}function lo(e,t,o){var n,s,i,r;P.__&&P.__(e,t),s=(n=!1)?null:t.__k,i=[],r=[],Ye(t,e=t.__k=$e(le,null,[e]),s||he,he,t.namespaceURI,s?null:t.firstChild?ke.call(t.childNodes):null,i,s?s.__e:t.firstChild,n,r),Lt(i,e,r)}ke=kt.slice,P={__e:function(e,t,o,n){for(var s,i,r;t=t.__;)if((s=t.__c)&&!s.__)try{if((i=s.constructor)&&i.getDerivedStateFromError!=null&&(s.setState(i.getDerivedStateFromError(e)),r=s.__d),s.componentDidCatch!=null&&(s.componentDidCatch(e,n||{}),r=s.__d),r)return s.__E=s}catch(c){e=c}throw e}},Ct=0,Z.prototype.setState=function(e,t){var o;o=this.__s!=null&&this.__s!==this.state?this.__s:this.__s=J({},this.state),typeof e=="function"&&(e=e(J({},o),this.props)),e&&J(o,e),e!=null&&this.__v&&(t&&this._sb.push(t),ze(this))},Z.prototype.forceUpdate=function(e){this.__v&&(this.__e=!0,e&&this.__h.push(e),ze(this))},Z.prototype.render=le,z=[],Pt=typeof Promise=="function"?Promise.prototype.then.bind(Promise.resolve()):setTimeout,Ne=function(e,t){return e.__v.__b-t.__v.__b},Te.__r=0,Ve=0,Fe=et(!1),Re=et(!0);var co=0;function p(e,t,o,n,s,i){t||(t={});var r,c,a=t;if("ref"in a)for(c in a={},t)c=="ref"?r=t[c]:a[c]=t[c];var u={type:e,props:a,key:o,ref:r,__k:null,__:null,__b:0,__e:null,__d:void 0,__c:null,constructor:void 0,__v:--co,__i:-1,__u:0,__source:s,__self:i};if(typeof e=="function"&&(r=e.defaultProps))for(c in r)a[c]===void 0&&(a[c]=r[c]);return P.vnode&&P.vnode(u),u}var pe,S,Le,tt,fe=0,St=[],O=P,ot=O.__b,nt=O.__r,st=O.diffed,it=O.__c,rt=O.unmount,at=O.__;function Xe(e,t){O.__h&&O.__h(S,e,fe||t),fe=0;var o=S.__H||(S.__H={__:[],__h:[]});return e>=o.__.length&&o.__.push({}),o.__[e]}function ie(e){return fe=1,uo(Nt,e)}function uo(e,t,o){var n=Xe(pe++,2);if(n.t=e,!n.__c&&(n.__=[o?o(t):Nt(void 0,t),function(c){var a=n.__N?n.__N[0]:n.__[0],u=n.t(a,c);a!==u&&(n.__N=[u,n.__[1]],n.__c.setState({}))}],n.__c=S,!S.u)){var s=function(c,a,u){if(!n.__c.__H)return!0;var h=n.__c.__H.__.filter(function(d){return!!d.__c});if(h.every(function(d){return!d.__N}))return!i||i.call(this,c,a,u);var l=!1;return h.forEach(function(d){if(d.__N){var _=d.__[0];d.__=d.__N,d.__N=void 0,_!==d.__[0]&&(l=!0)}}),!(!l&&n.__c.props===c)&&(!i||i.call(this,c,a,u))};S.u=!0;var i=S.shouldComponentUpdate,r=S.componentWillUpdate;S.componentWillUpdate=function(c,a,u){if(this.__e){var h=i;i=void 0,s(c,a,u),i=h}r&&r.call(this,c,a,u)},S.shouldComponentUpdate=s}return n.__N||n.__}function x(e,t){var o=Xe(pe++,3);!O.__s&&Bt(o.__H,t)&&(o.__=e,o.i=t,S.__H.__h.push(o))}function Ge(e){return fe=5,Ot(function(){return{current:e}},[])}function Ot(e,t){var o=Xe(pe++,7);return Bt(o.__H,t)&&(o.__=e(),o.__H=t,o.__h=e),o.__}function lt(e,t){return fe=8,Ot(function(){return e},t)}function ho(){for(var e;e=St.shift();)if(e.__P&&e.__H)try{e.__H.__h.forEach(ve),e.__H.__h.forEach(He),e.__H.__h=[]}catch(t){e.__H.__h=[],O.__e(t,e.__v)}}O.__b=function(e){S=null,ot&&ot(e)},O.__=function(e,t){e&&t.__k&&t.__k.__m&&(e.__m=t.__k.__m),at&&at(e,t)},O.__r=function(e){nt&&nt(e),pe=0;var t=(S=e.__c).__H;t&&(Le===S?(t.__h=[],S.__h=[],t.__.forEach(function(o){o.__N&&(o.__=o.__N),o.i=o.__N=void 0})):(t.__h.forEach(ve),t.__h.forEach(He),t.__h=[],pe=0)),Le=S},O.diffed=function(e){st&&st(e);var t=e.__c;t&&t.__H&&(t.__H.__h.length&&(St.push(t)!==1&&tt===O.requestAnimationFrame||((tt=O.requestAnimationFrame)||po)(ho)),t.__H.__.forEach(function(o){o.i&&(o.__H=o.i),o.i=void 0})),Le=S=null},O.__c=function(e,t){t.some(function(o){try{o.__h.forEach(ve),o.__h=o.__h.filter(function(n){return!n.__||He(n)})}catch(n){t.some(function(s){s.__h&&(s.__h=[])}),t=[],O.__e(n,o.__v)}}),it&&it(e,t)},O.unmount=function(e){rt&&rt(e);var t,o=e.__c;o&&o.__H&&(o.__H.__.forEach(function(n){try{ve(n)}catch(s){t=s}}),o.__H=void 0,t&&O.__e(t,o.__v))};var ct=typeof requestAnimationFrame=="function";function po(e){var t,o=function(){clearTimeout(n),ct&&cancelAnimationFrame(t),setTimeout(e)},n=setTimeout(o,100);ct&&(t=requestAnimationFrame(o))}function ve(e){var t=S,o=e.__c;typeof o=="function"&&(e.__c=void 0,o()),S=t}function He(e){var t=S;e.__c=e.__(),S=t}function Bt(e,t){return!e||e.length!==t.length||t.some(function(o,n){return o!==e[n]})}function Nt(e,t){return typeof t=="function"?t(e):t}function fo(e,t){for(var o in t)e[o]=t[o];return e}function ut(e,t){for(var o in e)if(o!=="__source"&&!(o in t))return!0;for(var n in t)if(n!=="__source"&&e[n]!==t[n])return!0;return!1}function ht(e,t){this.props=e,this.context=t}(ht.prototype=new Z).isPureReactComponent=!0,ht.prototype.shouldComponentUpdate=function(e,t){return ut(this.props,e)||ut(this.state,t)};var pt=P.__b;P.__b=function(e){e.type&&e.type.__f&&e.ref&&(e.props.ref=e.ref,e.ref=null),pt&&pt(e)};var _o=P.__e;P.__e=function(e,t,o,n){if(e.then){for(var s,i=t;i=i.__;)if((s=i.__c)&&s.__c)return t.__e==null&&(t.__e=o.__e,t.__k=o.__k),s.__c(e,t)}_o(e,t,o,n)};var ft=P.unmount;function Ft(e,t,o){return e&&(e.__c&&e.__c.__H&&(e.__c.__H.__.forEach(function(n){typeof n.__c=="function"&&n.__c()}),e.__c.__H=null),(e=fo({},e)).__c!=null&&(e.__c.__P===o&&(e.__c.__P=t),e.__c=null),e.__k=e.__k&&e.__k.map(function(n){return Ft(n,t,o)})),e}function Rt(e,t,o){return e&&o&&(e.__v=null,e.__k=e.__k&&e.__k.map(function(n){return Rt(n,t,o)}),e.__c&&e.__c.__P===t&&(e.__e&&o.appendChild(e.__e),e.__c.__e=!0,e.__c.__P=o)),e}function Se(){this.__u=0,this.t=null,this.__b=null}function $t(e){var t=e.__.__c;return t&&t.__a&&t.__a(e)}function me(){this.u=null,this.o=null}P.unmount=function(e){var t=e.__c;t&&t.__R&&t.__R(),t&&32&e.__u&&(e.type=null),ft&&ft(e)},(Se.prototype=new Z).__c=function(e,t){var o=t.__c,n=this;n.t==null&&(n.t=[]),n.t.push(o);var s=$t(n.__v),i=!1,r=function(){i||(i=!0,o.__R=null,s?s(c):c())};o.__R=r;var c=function(){if(!--n.__u){if(n.state.__a){var a=n.state.__a;n.__v.__k[0]=Rt(a,a.__c.__P,a.__c.__O)}var u;for(n.setState({__a:n.__b=null});u=n.t.pop();)u.forceUpdate()}};n.__u++||32&t.__u||n.setState({__a:n.__b=n.__v.__k[0]}),e.then(r,r)},Se.prototype.componentWillUnmount=function(){this.t=[]},Se.prototype.render=function(e,t){if(this.__b){if(this.__v.__k){var o=document.createElement("div"),n=this.__v.__k[0].__c;this.__v.__k[0]=Ft(this.__b,o,n.__O=n.__P)}this.__b=null}var s=t.__a&&$e(le,null,e.fallback);return s&&(s.__u&=-33),[$e(le,null,t.__a?null:e.children),s]};var _t=function(e,t,o){if(++o[1]===o[0]&&e.o.delete(t),e.props.revealOrder&&(e.props.revealOrder[0]!=="t"||!e.o.size))for(o=e.u;o;){for(;o.length>3;)o.pop()();if(o[1]<o[0])break;e.u=o=o[2]}};(me.prototype=new Z).__a=function(e){var t=this,o=$t(t.__v),n=t.o.get(e);return n[0]++,function(s){var i=function(){t.props.revealOrder?(n.push(s),_t(t,e,n)):s()};o?o(i):i()}},me.prototype.render=function(e){this.u=null,this.o=new Map;var t=Me(e.children);e.revealOrder&&e.revealOrder[0]==="b"&&t.reverse();for(var o=t.length;o--;)this.o.set(t[o],this.u=[1,0,this.u]);return e.children},me.prototype.componentDidUpdate=me.prototype.componentDidMount=function(){var e=this;this.o.forEach(function(t,o){_t(e,o,t)})};var mo=typeof Symbol<"u"&&Symbol.for&&Symbol.for("react.element")||60103,yo=/^(?:accent|alignment|arabic|baseline|cap|clip(?!PathU)|color|dominant|fill|flood|font|glyph(?!R)|horiz|image(!S)|letter|lighting|marker(?!H|W|U)|overline|paint|pointer|shape|stop|strikethrough|stroke|text(?!L)|transform|underline|unicode|units|v|vector|vert|word|writing|x(?!C))[A-Z]/,bo=/^on(Ani|Tra|Tou|BeforeInp|Compo)/,vo=/[A-Z0-9]/g,go=typeof document<"u",wo=function(e){return(typeof Symbol<"u"&&typeof Symbol()=="symbol"?/fil|che|rad/:/fil|che|ra/).test(e)};function To(e,t,o){return t.__k==null&&(t.textContent=""),lo(e,t),typeof o=="function"&&o(),e?e.__c:null}Z.prototype.isReactComponent={},["componentWillMount","componentWillReceiveProps","componentWillUpdate"].forEach(function(e){Object.defineProperty(Z.prototype,e,{configurable:!0,get:function(){return this["UNSAFE_"+e]},set:function(t){Object.defineProperty(this,e,{configurable:!0,writable:!0,value:t})}})});var dt=P.event;function Mo(){}function Co(){return this.cancelBubble}function Po(){return this.defaultPrevented}P.event=function(e){return dt&&(e=dt(e)),e.persist=Mo,e.isPropagationStopped=Co,e.isDefaultPrevented=Po,e.nativeEvent=e};var ko={enumerable:!1,configurable:!0,get:function(){return this.class}},mt=P.vnode;P.vnode=function(e){typeof e.type=="string"&&function(t){var o=t.props,n=t.type,s={},i=n.indexOf("-")===-1;for(var r in o){var c=o[r];if(!(r==="value"&&"defaultValue"in o&&c==null||go&&r==="children"&&n==="noscript"||r==="class"||r==="className")){var a=r.toLowerCase();r==="defaultValue"&&"value"in o&&o.value==null?r="value":r==="download"&&c===!0?c="":a==="translate"&&c==="no"?c=!1:a[0]==="o"&&a[1]==="n"?a==="ondoubleclick"?r="ondblclick":a!=="onchange"||n!=="input"&&n!=="textarea"||wo(o.type)?a==="onfocus"?r="onfocusin":a==="onblur"?r="onfocusout":bo.test(r)&&(r=a):a=r="oninput":i&&yo.test(r)?r=r.replace(vo,"-$&").toLowerCase():c===null&&(c=void 0),a==="oninput"&&s[r=a]&&(r="oninputCapture"),s[r]=c}}n=="select"&&s.multiple&&Array.isArray(s.value)&&(s.value=Me(o.children).forEach(function(u){u.props.selected=s.value.indexOf(u.props.value)!=-1})),n=="select"&&s.defaultValue!=null&&(s.value=Me(o.children).forEach(function(u){u.props.selected=s.multiple?s.defaultValue.indexOf(u.props.value)!=-1:s.defaultValue==u.props.value})),o.class&&!o.className?(s.class=o.class,Object.defineProperty(s,"className",ko)):(o.className&&!o.class||o.class&&o.className)&&(s.class=s.className=o.className),t.props=s}(e),e.$$typeof=mo,mt&&mt(e)};var yt=P.__r;P.__r=function(e){yt&&yt(e),e.__c};var bt=P.diffed;P.diffed=function(e){bt&&bt(e);var t=e.props,o=e.__e;o!=null&&e.type==="textarea"&&"value"in t&&t.value!==o.value&&(o.value=t.value==null?"":t.value)};var f=(e=>(e[e.CapOfInvisibility=0]="CapOfInvisibility",e[e.ConfusedMonsters=1]="ConfusedMonsters",e[e.LandMine=2]="LandMine",e[e.TimeBomb=3]="TimeBomb",e[e.Crusher=4]="Crusher",e[e.Builder=5]="Builder",e[e.Climber=6]="Climber",e[e.Teleport=7]="Teleport",e[e.Tsunami=8]="Tsunami",e[e.Monster=9]="Monster",e[e.Slide=10]="Slide",e[e.Sokoban=11]="Sokoban",e[e.Blaster=12]="Blaster",e))(f||{}),T=(e=>(e[e.Up=0]="Up",e[e.Down=1]="Down",e[e.Left=2]="Left",e[e.Right=3]="Right",e))(T||{});function vt(e){switch(e){case 0:return"Now you see me, now you don't!";case 1:return"Monsters are dizzy!";case 2:return"Boom goes the floor!";case 3:return"Tick tock, boom o'clock!";case 4:return"Hulk smash!";case 5:return"Bob the Builder mode: ON";case 6:return"Walk on walls like a pro!";case 7:return"Beam me up, Scotty!";case 8:return"Water, water everywhere!";case 9:return"Tables have turned!";case 10:return"Slip and slide!";case 11:return"Push it real good!";case 12:return"Pew pew pew!";default:return"Mystery power activated!"}}function N(e,t){return e.activeBonuses.some(o=>o.type===t)}const C=60,M=30;function k(e,t){return{x:(e-t)*C/2,y:(e+t)*M/2}}function gt(e){switch(e){case"wave":case"obstacle":return 3;case"bonus":case"landMine":case"timeBomb":return 2;case"goal":return 2;case"monster":return 4;case"player":return 5;case"explosion":return 6;default:return 0}}function Do(e){return e.sort((t,o)=>{const n=t.position.x+t.position.y,s=o.position.x+o.position.y;if(n!==s)return n-s;const i=gt(t.type),r=gt(o.type);return i!==r?i-r:0})}const Ut=250,ae=500,Io=50,Eo=()=>Math.cos(Date.now()/1e3*Math.PI),Ao=e=>.5+(e/2+1)/2,Ie=(e,t,o,n=Ut)=>{const s=Math.min(Date.now()-o,n)/n;return{x:t.x+(e.x-t.x)*s,y:t.y+(e.y-t.y)*s}},Lo=(e,t,o)=>Date.now()-o<ae/2?t:e,So=e=>{const t=Date.now()/1e3;return Math.sin(t*2+e)*3},Gt=e=>{const t=Date.now()/50;return{x:Math.sin(t)*e,y:Math.cos(t*1.5)*e}},Ht=500,Oo=(e,t,o)=>{const n=Math.min((Date.now()-e)/Ht,1);return o?1-n:t?n:1},Bo=()=>Gt(2),No=e=>{const o=e%1e3/1e3;return Math.sin(o*Math.PI)*20},Fo=e=>Math.max(0,1-e/2e3),Ro=e=>e<ae/2?Math.max(0,1-e/2/(ae/2)*2):Math.min(1,(e/2/(ae/2)-.5)*2),$o=(e,t,o)=>{const{x:n,y:s}=k(t.x,t.y);e.fillStyle="rgba(0, 0, 0, 0.3)",e.beginPath(),e.ellipse(n,s+M/2,C/2,M/4,0,0,Math.PI*2),e.fill(),e.fillStyle="#FFD700",e.beginPath(),e.moveTo(n,s),e.lineTo(n+C/2,s+M/2),e.lineTo(n,s+M),e.lineTo(n-C/2,s+M/2),e.closePath(),e.fill(),e.fillStyle="#000000",e.font=`${o/2}px Arial`,e.textAlign="center",e.textBaseline="middle",e.fillText("★",n,s+M/2)},Uo=(e,t,o)=>{t.forEach(n=>{const{position:s,creationTime:i,isRaising:r,isDestroying:c}=n,{x:a,y:u}=k(s.x,s.y),h=Oo(i,r,c)*o*.8;if(h===0)return;const l=h/o*.2,{x:d,y:_}=k(s.x,s.y+1),{x:b,y}=k(s.x+1,s.y+1),{x:v,y:g}=k(s.x+1,s.y+1+l),{x:w,y:D}=k(s.x,s.y+1+l);e.fillStyle="rgba(0, 0, 0, 0.3)",e.beginPath(),e.moveTo(d,_),e.lineTo(b,y),e.lineTo(v,g),e.lineTo(w,D),e.closePath(),e.fill();const E=c?h/(o*.8):1;e.fillStyle=`rgba(142, 36, 170, ${E})`,e.beginPath(),e.moveTo(a,u-h),e.lineTo(a+C/2,u+M/2-h),e.lineTo(a,u+M-h),e.lineTo(a-C/2,u+M/2-h),e.closePath(),e.fill(),e.fillStyle=`rgba(106, 27, 154, ${E})`,e.beginPath(),e.moveTo(a+C/2,u+M/2-h),e.lineTo(a+C/2,u+M/2),e.lineTo(a,u+M),e.lineTo(a,u+M-h),e.closePath(),e.fill(),e.fillStyle=`rgba(74, 20, 140, ${E})`,e.beginPath(),e.moveTo(a-C/2,u+M/2-h),e.lineTo(a-C/2,u+M/2),e.lineTo(a,u+M),e.lineTo(a,u+M-h),e.closePath(),e.fill()})},Go=(e,t)=>{const o=k(0,0),n=k(t,0),s=k(0,t),i=k(t,t);e.fillStyle="#c2b280",e.beginPath(),e.moveTo(o.x,o.y),e.lineTo(n.x,n.y),e.lineTo(i.x,i.y),e.lineTo(s.x,s.y),e.closePath(),e.fill(),e.fillStyle="#5d4037",e.beginPath(),e.moveTo(i.x,i.y),e.lineTo(i.x,i.y+ye),e.lineTo(s.x,s.y+ye),e.lineTo(s.x,s.y),e.closePath(),e.fill(),e.fillStyle="#8d6e63",e.beginPath(),e.moveTo(i.x,i.y),e.lineTo(i.x,i.y+ye),e.lineTo(n.x,n.y+ye),e.lineTo(n.x,n.y),e.closePath(),e.fill()},Wt=(e,t,o)=>{e.strokeStyle="#4a4a4a",e.lineWidth=1;for(let n=0;n<=t;n++)for(let s=0;s<=t;s++){const{x:i,y:r}=k(s,n);s<t&&(e.beginPath(),e.moveTo(i,r),e.lineTo(i+C/2,r+M/2),e.stroke()),n<t&&(e.beginPath(),e.moveTo(i,r),e.lineTo(i-C/2,r+M/2),e.stroke()),N(o,f.Slide)&&Ho(e,s,n)}},Ho=(e,t,o)=>{const{x:n,y:s}=k(t,o),i=e.createLinearGradient(n-C/2,s,n+C/2,s+M);i.addColorStop(0,"rgba(200, 200, 255, 0.2)"),i.addColorStop(.5,"rgba(220, 220, 255, 0.3)"),i.addColorStop(1,"rgba(200, 200, 255, 0.2)"),e.fillStyle=i,e.beginPath(),e.moveTo(n,s),e.lineTo(n+C/2,s+M/2),e.lineTo(n,s+M),e.lineTo(n-C/2,s+M/2),e.closePath(),e.fill();for(let r=0;r<3;r++){const c=n+(Math.random()-.5)*C,a=s+(Math.random()-.5)*M,u=Math.random()*2+1;e.fillStyle="rgba(255, 255, 255, 0.7)",e.beginPath(),e.arc(c,a,u,0,Math.PI*2),e.fill()}},je=(e,t,o,n,s)=>{e.fillStyle="rgba(0, 0, 0, 0.3)",e.beginPath(),e.ellipse(t+n/2,o+s/2+5,n/2,s/4,0,0,Math.PI*2),e.fill()},Wo=e=>{const{isoX:t,isoY:o,cellSize:n,baseHeight:s,widthFactor:i,heightAnimationFactor:r}=e,c=Eo(),a=s*n+n*r*c,u=C*i,h=Ao(c),l=C*i*h,d=M*.4*h;return{entityHeight:a,entityWidth:u,shadowWidth:l,shadowHeight:d,animFactor:c,shadowX:t-l/2,shadowY:o+M/2}},Vo=(e,t,o,n,s,i,r)=>{e.fillStyle=i,e.beginPath(),e.moveTo(t,o-n-r),e.lineTo(t+s/2,o-n+M/4-r),e.lineTo(t,o+M/2-r),e.lineTo(t-s/2,o-n+M/4-r),e.closePath(),e.fill()},Yo=(e,t,o,n,s,i,r)=>{e.fillStyle=i,e.beginPath(),e.arc(t,o-n-s/2-r,s,0,Math.PI*2),e.fill()},qo=(e,t,o,n,s,i,r,c)=>{const a=s*.3;e.fillStyle=i,e.beginPath(),e.arc(t-s/3,o-n-s/2-c,a,0,Math.PI*2),e.arc(t+s/3,o-n-s/2-c,a,0,Math.PI*2),e.fill(),e.fillStyle=r,e.beginPath(),e.arc(t-s/3,o-n-s/2-c,a/2,0,Math.PI*2),e.arc(t+s/3,o-n-s/2-c,a/2,0,Math.PI*2),e.fill()},Xo=(e,t,o,n,s,i)=>{e.strokeStyle="black",e.lineWidth=2,e.beginPath(),e.arc(t,o-n+s/4-i,s/2,.1*Math.PI,.9*Math.PI),e.stroke()},jo=(e,t,o,n,s,i,r,c,a,u,h,l,d,_)=>{e.strokeStyle=u,e.lineWidth=a;const b=Math.sin(l*1e3)*Math.PI;for(let y=0;y<r;y++){const v=y/r*Math.PI*2,g=t+Math.cos(v)*(s/3),w=o-n/2+Math.sin(v)*(n/4)-_,D=2+Math.sin(l*100+y)*2,E=.1+Math.cos(l*200+y)*.05,U=g+Math.cos(v)*(c/2),G=w+Math.sin(v)*(c/2)+Math.sin(h*D+b+y)*i*E,K=g+Math.cos(v)*c,j=w+Math.sin(v)*c+Math.sin(h*D+Math.PI+b+y)*i*(E*1.5),Q=g+Math.cos(v)*c,$=w+Math.sin(v)*c+Math.sin(h*D+b+y)*i*(E*2);d&&(e.save(),e.strokeStyle="rgba(0, 0, 0, 0.3)",e.lineWidth=a*1.5,e.beginPath(),e.moveTo(g,w+M/2),e.bezierCurveTo(U,G+M/2,K,j+M/2,Q,$+M/2),e.stroke(),e.restore()),e.beginPath(),e.moveTo(g,w),e.bezierCurveTo(U,G,K,j,Q,$),e.stroke()}},Vt=e=>{const{ctx:t,isoX:o,isoY:n,cellSize:s,baseHeight:i,widthFactor:r,heightAnimationFactor:c,bodyColor:a,headColor:u,eyeColor:h,pupilColor:l,hasTentacles:d=!1,tentacleColor:_="",tentacleCount:b=0,tentacleLength:y=0,tentacleWidth:v=0,isInvisible:g=!1,seed:w=0,castShadow:D=!0,isConfused:E=!1}=e,U=Wo({isoX:o,isoY:n,cellSize:s,baseHeight:i,widthFactor:r,heightAnimationFactor:c}),{entityHeight:G,entityWidth:K,shadowWidth:j,shadowHeight:Q,animFactor:$,shadowX:te,shadowY:eo}=U,oe=So(w),Qe=E?Bo():{x:0,y:0};let ne=o,se=n;ne+=Qe.x,se+=Qe.y,D&&(t.fillStyle="rgba(0, 0, 0, 0.3)",t.beginPath(),t.ellipse(te+j/2,eo,j/2,Q/2,0,0,Math.PI*2),t.fill()),t.save(),g&&(t.globalAlpha=.5),d&&_&&b>0&&jo(t,ne,se,G,K,s,b,y,v,_,$,w,D,oe),Vo(t,ne,se,G,K,a,oe);const Ee=s*.25;return Yo(t,ne,se,G,Ee,u,oe),qo(t,ne,se,G,Ee,h,l,oe),Xo(t,ne,se,G,Ee,oe),t.restore(),{bounceOffset:oe}},Zo=(e,t,o,n=!1,s=[],i=!1,r=!1,c=!1)=>{const{position:a,previousPosition:u,moveTimestamp:h,teleportTimestamp:l,isVanishing:d,isVictorious:_}=t,b=l&&Date.now()-l<ae,y=b?Lo(a,u,l):Ie(a,u,h);let{x:v,y:g}=k(y.x,y.y);if(_){const U=No(Date.now()-h);g-=U}const w=s.some(U=>U.position.x===Math.round(y.x)&&U.position.y===Math.round(y.y));(c||w)&&w&&(g-=o*.5);const D={ctx:e,isoX:v,isoY:g,cellSize:o,baseHeight:.8,widthFactor:.6,heightAnimationFactor:.2,bodyColor:Ko(c,i),headColor:Qo(c,i),eyeColor:i?"red":"white",pupilColor:"black",isInvisible:n};d?e.globalAlpha=Fo(Date.now()-h):b&&(e.globalAlpha=Ro(Date.now()-l));const{bounceOffset:E}=Vt(D);e.globalAlpha=1,_&&Jo(e,v,g,o),c&&zo(e,v,g,o),i&&xo(e,v,g,o),r&&en(e,v,g,o,E),b&&tn(e,v,g,o,Date.now()-l)},Ko=(e,t)=>t?"#800080":e?"#FFA500":"#00FF00",Qo=(e,t)=>t?"#9932CC":e?"#FFD700":"#32CD32",Jo=(e,t,o,n)=>{e.save(),e.translate(t,o);for(let s=0;s<10;s++){const i=Math.PI*2*s/10,r=n*(.5+Math.sin(Date.now()/200+s)*.2),c=Math.cos(i)*r,a=Math.sin(i)*r;e.beginPath(),e.arc(c,a,n*.1,0,Math.PI*2),e.fillStyle=`hsl(${(Date.now()/20+s*36)%360}, 100%, 50%)`,e.fill()}e.restore()},zo=(e,t,o,n)=>{e.save(),e.translate(t,o-n*.6);const s=n*.3;e.strokeStyle="#FFD700",e.lineWidth=2,e.beginPath(),e.moveTo(-s/2,-s/2),e.lineTo(-s/2,s/2),e.moveTo(s/2,-s/2),e.lineTo(s/2,s/2);for(let r=0;r<3;r++){const c=-s/2+(r+1)*(s/3);e.moveTo(-s/2,c),e.lineTo(s/2,c)}e.stroke(),e.shadowColor="#FFD700",e.shadowBlur=5,e.stroke();const i=Math.sin(Date.now()/200)*n*.05;e.translate(0,i),e.stroke(),e.restore()},xo=(e,t,o,n)=>{e.save(),e.translate(t,o);const s=20,i=n*.8;for(let a=0;a<s;a++){const u=Math.PI*2*a/s+Date.now()/1e3,h=i*(.5+Math.sin(Date.now()/500+a)*.2),l=Math.cos(u)*h,d=Math.sin(u)*h;e.beginPath(),e.arc(l,d,n*.05,0,Math.PI*2),e.fillStyle=`rgba(128, 0, 128, ${.5+Math.sin(Date.now()/200+a)*.3})`,e.fill()}const r=n*.1,c=n*.15;e.beginPath(),e.arc(-c,-c,r,0,Math.PI*2),e.arc(c,-c,r,0,Math.PI*2),e.fillStyle="rgba(255, 0, 0, 0.8)",e.fill(),e.shadowColor="red",e.shadowBlur=10+Math.sin(Date.now()/200)*5,e.fill(),e.restore()},en=(e,t,o,n,s)=>{e.save(),e.translate(t-n/10,o-s);const i=n*.4,r=n*.1;e.fillStyle="#808080",e.beginPath(),e.rect(-r/2,-i,r,i),e.fill(),e.fillStyle="#FFD700",e.beginPath(),e.arc(0,-i,r/2,0,Math.PI*2),e.fill(),e.shadowColor="#FFD700",e.shadowBlur=5,e.fill();const c=(Math.sin(Date.now()/200)+1)*r/4;e.beginPath(),e.arc(0,-i,c,0,Math.PI*2),e.fillStyle="rgba(255, 255, 0, 0.8)",e.fill(),e.restore()},tn=(e,t,o,n,s)=>{e.save(),e.translate(t,o);const i=n*1.5,r=s/ae;if(r<.5){const c=r*2,a=i*c;e.beginPath(),e.arc(0,0,a,0,Math.PI*2);const u=e.createRadialGradient(0,0,0,0,0,a);u.addColorStop(0,"rgba(0, 255, 255, 0)"),u.addColorStop(.7,"rgba(0, 255, 255, 0.7)"),u.addColorStop(1,"rgba(0, 255, 255, 0)"),e.fillStyle=u,e.fill();for(let h=0;h<20;h++){const l=Math.random()*Math.PI*2,d=Math.random()*a,_=Math.cos(l)*d,b=Math.sin(l)*d,y=n*.05*(1-c);e.beginPath(),e.arc(_,b,y,0,Math.PI*2),e.fillStyle="rgba(0, 255, 255, "+(1-c)+")",e.fill()}}else{const c=(r-.5)*2,a=i*(1-c);e.beginPath(),e.arc(0,0,a,0,Math.PI*2);const u=e.createRadialGradient(0,0,0,0,0,a);u.addColorStop(0,"rgba(0, 255, 255, 0.7)"),u.addColorStop(.7,"rgba(0, 255, 255, 0.3)"),u.addColorStop(1,"rgba(0, 255, 255, 0)"),e.fillStyle=u,e.fill();for(let h=0;h<20;h++){const l=Math.random()*Math.PI*2,d=Math.random()*i,_=Math.cos(l)*d,b=Math.sin(l)*d,y=n*.05*c;e.beginPath(),e.arc(_,b,y,0,Math.PI*2),e.fillStyle="rgba(0, 255, 255, "+c+")",e.fill()}}e.restore()},on=(e,t,o,n)=>{t.forEach(s=>{const i=Ie(s.position,s.previousPosition,s.moveTimestamp),{x:r,y:c}=k(i.x,i.y),a={ctx:e,isoX:r,isoY:c,cellSize:o,baseHeight:.4,widthFactor:.6,heightAnimationFactor:.1,bodyColor:n?"#00FF00":"#800080",headColor:n?"#32CD32":"#9932CC",eyeColor:"white",pupilColor:n?"black":"red",hasTentacles:!n,tentacleColor:"#600060",tentacleCount:6,tentacleLength:o*.5,tentacleWidth:4,seed:s.seed,castShadow:!0};Vt(a),n&&nn(e,r,c,o)})},nn=(e,t,o,n)=>{e.save(),e.translate(t,o);const s=n*.2;e.fillStyle="#FFD700",e.beginPath(),e.moveTo(-s/2,-n*.3),e.lineTo(0,-n*.5),e.lineTo(s/2,-n*.3),e.closePath(),e.fill();for(let i=0;i<5;i++){const r=Math.random()*Math.PI*2,c=Math.random()*n*.4+n*.2,a=Math.cos(r)*c,u=Math.sin(r)*c;e.fillStyle=`rgba(255, 255, 0, ${.5+Math.random()*.5})`,e.beginPath(),e.arc(a,u,n*.05,0,Math.PI*2),e.fill()}e.restore()},R=M,sn=(e,t,o)=>{t.forEach(n=>{const{x:s,y:i}=k(n.position.x,n.position.y);je(e,s-C/4,i-M/4,C/2,M),e.fillStyle=ln(n.type),e.beginPath(),e.moveTo(s,i+R/2),e.lineTo(s+C/4,i),e.lineTo(s,i-R/2),e.lineTo(s-C/4,i),e.closePath(),e.fill(),e.beginPath(),e.arc(s,i-R/2,C/6,0,Math.PI*2),e.fill(),e.fillStyle="white",e.font=`bold ${o/3}px Arial`,e.textAlign="center",e.textBaseline="middle",e.fillText(cn(n.type),s,i-R/2)})},rn=(e,t,o)=>{t.forEach(n=>{const{x:s,y:i}=k(n.x,n.y);je(e,s-C/2,i,C,M),e.fillStyle="brown",e.beginPath(),e.moveTo(s,i+R/2),e.lineTo(s+C/4,i),e.lineTo(s,i-R/2),e.lineTo(s-C/4,i),e.closePath(),e.fill(),e.beginPath(),e.arc(s,i-R/2,C/5,0,Math.PI*2),e.fill(),e.fillStyle="white",e.font=`bold ${o/3}px Arial`,e.textAlign="center",e.textBaseline="middle",e.fillText("M",s,i-R/2)})},an=(e,t,o)=>{t.forEach(n=>{const{x:s,y:i}=k(n.position.x,n.position.y);je(e,s-C/2,i,C,M),e.fillStyle="black",e.beginPath(),e.moveTo(s,i-R),e.lineTo(s+C/4,i-R/2),e.lineTo(s,i+R/2),e.lineTo(s-C/4,i-R/2),e.closePath(),e.fill(),e.strokeStyle="orange",e.lineWidth=2,e.beginPath(),e.moveTo(s,i-R),e.quadraticCurveTo(s+C/8,i-R*1.5,s+C/4,i-R*1.25),e.stroke(),e.fillStyle="white",e.font=`bold ${o/3}px Arial`,e.textAlign="center",e.textBaseline="middle",e.fillText(n.timer.toString(),s,i-R/2)})},ln=e=>{switch(e){case f.CapOfInvisibility:return"#8A2BE2";case f.ConfusedMonsters:return"#FFA500";case f.LandMine:return"#8B4513";case f.TimeBomb:return"#000000";case f.Crusher:return"#FF69B4";case f.Builder:return"#00FFFF";case f.Climber:return"#32CD32";case f.Teleport:return"#9400D3";case f.Tsunami:return"#1E90FF";case f.Monster:return"#FF4500";case f.Slide:return"#00CED1";case f.Sokoban:return"#DAA520";case f.Blaster:return"#FF1493";default:return"#FFFF00"}},cn=e=>{switch(e){case f.CapOfInvisibility:return"I";case f.ConfusedMonsters:return"C";case f.LandMine:return"L";case f.TimeBomb:return"T";case f.Crusher:return"X";case f.Builder:return"B";case f.Climber:return"↑";case f.Teleport:return"⊷";case f.Tsunami:return"≋";case f.Monster:return"M";case f.Slide:return"⇉";case f.Sokoban:return"◊";case f.Blaster:return"⚡";default:return"?"}},un=(e,t)=>{e.save(),e.globalAlpha=.7;for(const{position:o,startTime:n,duration:s}of t){if(Date.now()-n>s)continue;const i=k(o.x+.5,o.y+.5),r=k(o.x-1,o.y-1),c=k(o.x+1*2,o.y-1),a=k(o.x+1*2,o.y+1*2),u=k(o.x-1,o.y+1*2);e.fillStyle="#FF6600",e.beginPath(),e.moveTo(r.x,r.y),e.lineTo(c.x,c.y),e.lineTo(a.x,a.y),e.lineTo(u.x,u.y),e.closePath(),e.fill();const h=32,l=C;for(let _=0;_<h;_++){const b=Math.PI*2/h*_,y=l*Math.random(),v=i.x+Math.cos(b)*y,g=i.y+Math.sin(b)*y/2;e.fillStyle=_%2===0?"#FF9933":"#FF3300",e.beginPath(),e.arc(v,g-Math.random()*M*Math.pow(_/h,.5),C/16,0,Math.PI*2),e.fill()}const d=e.createRadialGradient(i.x,i.y,0,i.x,i.y,C*2);d.addColorStop(0,"rgba(255, 255, 0, 0.8)"),d.addColorStop(1,"rgba(255, 165, 0, 0)"),e.fillStyle=d,e.beginPath(),e.ellipse(i.x,i.y,C,M,0,0,Math.PI*2),e.fill()}e.restore()},hn=(e,t,o,n)=>{e.save(),e.globalAlpha=o.duration===12?1:.5,e.font="bold 16px Arial";const{x:s,y:i}=k(t.x,t.y),r=e.measureText(vt(o.type)).width+20,c=90,a=15,u=10,h=s-r/2,l=i-n-c-a;e.fillStyle="rgba(0, 0, 0, 0.9)",e.beginPath(),e.moveTo(h+u,l),e.lineTo(h+r-u,l),e.quadraticCurveTo(h+r,l,h+r,l+u),e.lineTo(h+r,l+c-u),e.quadraticCurveTo(h+r,l+c,h+r-u,l+c),e.lineTo(h+r/2+a,l+c),e.lineTo(h+r/2,l+c+a),e.lineTo(h+r/2-a,l+c),e.lineTo(h+u,l+c),e.quadraticCurveTo(h,l+c,h,l+c-u),e.lineTo(h,l+u),e.quadraticCurveTo(h,l,h+u,l),e.closePath(),e.fill(),e.strokeStyle="rgba(255, 255, 255, 0.5)",e.lineWidth=2,e.stroke(),e.fillStyle="white",e.textAlign="center",e.fillText(vt(o.type),h+r/2,l+30),e.font="14px Arial",e.fillText(`${o.duration} steps left`,h+r/2,l+55),e.restore()},Yt=1e3,pn=(e,t,o)=>{let{tsunamiLevel:n}=e;e.tsunamiTeardownTimestamp&&(n=e.player.isVanishing?13:(1-(Date.now()-e.tsunamiTeardownTimestamp)/Yt)*13);const s=o*.8,i=[];for(let r=0;r<t;r++)for(let c=0;c<t;c++){const a=k(c,r),u=k(c+1,r),h=k(c,r+1),l=k(c+1,r+1),d=Math.min(Math.max(n/13,0),1)*s,_=d+Math.sin(Date.now()/200+c*.5)*5,b=d+Math.sin(Date.now()/200+(c+1)*.5)*5;i.push({tsunamiLevel:n,grid:{x:c,y:r},isoTop:[{x:a.x,y:a.y-_},{x:h.x,y:h.y-b},{x:l.x,y:l.y-b},{x:u.x,y:u.y-_}],isoFront:r===t-1?[{x:h.x,y:h.y-b},{x:h.x,y:h.y},{x:l.x,y:l.y},{x:l.x,y:l.y-b}]:void 0,isoSide:c===t-1?[{x:l.x,y:l.y-b},{x:l.x,y:l.y},{x:u.x,y:u.y},{x:u.x,y:u.y-_}]:void 0})}return i},fn=(e,t)=>{e.save(),e.globalAlpha=.6,Oe(e,t.isoTop,`rgba(0, 100, 255, ${t.tsunamiLevel/13})`),t.isoFront&&Oe(e,t.isoFront,`rgba(0, 39, 98, ${t.tsunamiLevel/13})`),t.isoSide&&Oe(e,t.isoSide,`rgba(0, 63, 157, ${t.tsunamiLevel/13})`),e.restore()};function Oe(e,t,o){e.fillStyle=o,e.beginPath(),e.moveTo(t[0].x,t[0].y);for(let n=1;n<t.length;n++)e.lineTo(t[n].x,t[n].y);e.closePath(),e.fill()}const _n=(e,t,o)=>{const{x:n,y:s}=k(t.x,t.y),{x:i,y:r}=k(o.x,o.y);e.save(),e.strokeStyle="rgba(0, 255, 255, 0.5)",e.lineWidth=3,e.setLineDash([5,5]),e.beginPath(),e.moveTo(n,s),e.lineTo(i,r),e.stroke(),e.restore()},dn=(e,t,o)=>{if(Date.now()-t.shotTimestamp>t.duration)return;const n=Ie(t.endPosition,t.startPosition,t.shotTimestamp,t.duration),{x:s,y:i}=k(n.x,n.y);e.save(),e.shadowColor="rgba(255, 0, 0, 0.8)",e.shadowBlur=o*.2,e.fillStyle="red",e.strokeStyle="rgba(255, 100, 100, 0.8)",e.lineWidth=2;const r=o*.6,c=o*.1;switch(e.translate(s,i),t.direction){case T.Up:e.rotate(-Math.PI/4);break;case T.Down:e.rotate(3*Math.PI/4);break;case T.Left:e.rotate(-3*Math.PI/4);break;case T.Right:e.rotate(Math.PI/4);break}e.beginPath(),e.ellipse(0,0,r/2,c/2,0,0,2*Math.PI),e.fill(),e.stroke(),e.globalAlpha=.5;for(let a=1;a<=3;a++)e.globalAlpha*=.5,e.beginPath(),e.ellipse(-a*r*.2,0,r/(2+a),c/(2+a),0,0,2*Math.PI),e.fill();e.restore()},wt=1e3,mn=13,yn=3;function bn(e,t,{gridSize:o}){const{player:n,obstacles:s}=t,r=Date.now()-n.moveTimestamp;if(r>wt)return;const c=vn(n.position,s,mn);e.save(),e.strokeStyle="purple",e.lineWidth=2,c.forEach(a=>{const u=Math.min(r/wt,1),h=a.path.length,l=Math.floor(h*u);e.beginPath();for(let d=Math.max(l-yn,0);d<l;d++){const _=a.path[d];if(_.x<0||_.y<0||_.x>=o||_.y>=o)continue;const{x:b,y}=k(_.x+.5,_.y+.5);d===0?e.moveTo(b,y):e.lineTo(b,y);const v=1-d/l;e.globalAlpha=v}e.stroke()}),e.restore()}function vn(e,t,o){const n=[],s=new Set,i=[{x:1,y:0},{x:-1,y:0},{x:0,y:1},{x:0,y:-1}],r=[{position:e,path:[e]}];for(s.add(`${e.x},${e.y}`);r.length>0;){const{position:c,path:a}=r.shift();if(a.length>o||gn(c,t))n.push({path:a,startTime:Date.now()});else for(const u of i){const h={x:c.x+u.x,y:c.y+u.y},l=`${h.x},${h.y}`;if(!s.has(l)){s.add(l);const d=[...a,h];r.push({position:h,path:d}),d.length===o&&n.push({path:d,startTime:Date.now()})}}}return n}function gn(e,t){return t.some(o=>o.position.x===e.x&&o.position.y===e.y)}const ye=20,qt=(e,t,{gridSize:o,cellSize:n})=>{if(e.save(),t.explosions.length>0){const a=Math.min(t.explosions.filter(h=>Date.now()-h.startTime<h.duration).length*2,10),u=Gt(a);e.translate(u.x,u.y)}e.translate(e.canvas.width/2,100),e.clearRect(-e.canvas.width/2,-100,e.canvas.width,e.canvas.height),Go(e,o),Wt(e,o,t);const s=t.tsunamiLevel>0||t.tsunamiTeardownTimestamp?pn(t,o,n):[];Date.now()-t.tsunamiTeardownTimestamp>Yt&&!t.player.isVanishing&&(t.tsunamiTeardownTimestamp=void 0),N(t,f.Slide)&&_n(e,t.player.previousPosition,t.player.position),bn(e,t,{gridSize:o});const i=[...s.map(a=>({position:a.grid,type:"wave",obj:a})),...t.obstacles.map(a=>({position:a.position,type:"obstacle",obj:a})),...t.bonuses.map(a=>({position:a.position,type:"bonus",obj:a})),...t.landMines.map(a=>({position:a,type:"landMine"})),...t.timeBombs.map(a=>({position:a.position,type:"timeBomb",obj:a})),...t.monsters.map(a=>({position:a.position,type:"monster",obj:a})),{position:t.player.position,type:"player",obj:t.player},{position:t.goal,type:"goal"},...t.explosions.map(a=>({position:a.position,type:"explosion",obj:a})),...t.blasterShots.map(a=>({position:Ie(a.endPosition,a.startPosition,a.shotTimestamp,a.duration),type:"blasterShot",obj:a}))],r=Do(i);for(const a of r){const{type:u,position:h}=a;switch(u){case"wave":fn(e,a.obj);break;case"obstacle":Uo(e,[a.obj],n);break;case"bonus":sn(e,[a.obj],n);break;case"landMine":rn(e,[h],n);break;case"timeBomb":an(e,[a.obj],n);break;case"monster":on(e,[a.obj],n,N(t,f.Monster));break;case"player":Zo(e,a.obj,n,t.activeBonuses.some(l=>l.type===f.CapOfInvisibility),t.obstacles,N(t,f.Monster),N(t,f.Blaster),N(t,f.Climber));break;case"goal":$o(e,h,n);break;case"explosion":un(e,[a.obj]);break;case"blasterShot":dn(e,a.obj,n);break}}const c=t.activeBonuses.sort((a,u)=>u.duration-a.duration)[0];c&&hn(e,t.player.position,c,n),e.restore()},ge=300,we=200,re=5,wn=Math.min(ge/re,we/re)/2,Tn=()=>({player:{position:{x:2,y:2},previousPosition:{x:2,y:2},moveTimestamp:Date.now(),isVictorious:!1,isVanishing:!1},goal:{x:4,y:4},obstacles:[{position:{x:1,y:1},creationTime:Date.now(),isRaising:!1,isDestroying:!1},{position:{x:3,y:3},creationTime:Date.now(),isRaising:!1,isDestroying:!1}],monsters:[{position:{x:0,y:4},previousPosition:{x:0,y:4},moveTimestamp:Date.now(),path:[],seed:Math.random(),isConfused:!1,spawnPoint:{x:0,y:4}},{position:{x:4,y:0},previousPosition:{x:4,y:0},moveTimestamp:Date.now(),path:[],seed:Math.random(),isConfused:!1,spawnPoint:{x:4,y:0}}],steps:0,monsterSpawnSteps:0,bonuses:[{type:f.CapOfInvisibility,position:{x:1,y:3}},{type:f.ConfusedMonsters,position:{x:3,y:1}}],activeBonuses:[],explosions:[],timeBombs:[],landMines:[],score:0,gameEndingState:"none",tsunamiLevel:0,blasterShots:[]}),Mn=()=>{const e=Ge(null),t=Ge(Tn());return x(()=>{const o=e.current;if(!o)return;const n=o.getContext("2d");if(!n)return;const s=()=>{n.clearRect(0,0,ge,we),n.save(),n.scale(.8,.8),n.translate(ge*.1,we*.1),Wt(n,re,t.current),qt(n,t.current,{gridSize:re,cellSize:wn}),n.restore(),t.current.monsters.forEach(i=>{const r=i.position.x+(Math.random()-.5)*.1,c=i.position.y+(Math.random()-.5)*.1;i.previousPosition={...i.position},i.position={x:Math.max(0,Math.min(re-1,r)),y:Math.max(0,Math.min(re-1,c))},i.moveTimestamp=Date.now()}),requestAnimationFrame(s)};s()},[]),p("canvas",{ref:e,width:ge,height:we})},Cn=({onStart:e,onInstructions:t})=>(x(()=>{const o=n=>{n.key==="ArrowRight"&&e()};return window.addEventListener("keydown",o),()=>{window.removeEventListener("keydown",o)}},[e]),p("div",{className:"intro",children:[p("h1",{className:"game-title",children:"Monster Steps"}),p("div",{className:"game-intro-responsive",children:[p("div",{className:"game-preview-container",children:p(Mn,{})}),p("div",{className:"game-intro-column",children:[p("div",{className:"intro-buttons",children:[p("button",{onClick:e,children:"Start Game"}),p("button",{onClick:t,children:"Instructions"})]}),p("p",{className:"intro-tip",children:"Press right arrow to start"})]})]}),p("p",{className:"author-name",children:["Created by ",p("a",{href:"https://x.com/gtanczyk",children:"Grzegorz Tańczyk"})," |"," ",p("a",{href:"https://github.com/gamedevpl/www.gamedev.pl/tree/master/games/monster-steps/",children:"Source code (GitHub)"})]})]})),Pn=({onBack:e})=>(x(()=>{const t=o=>{o.key==="Escape"&&e()};return window.addEventListener("keydown",t),()=>{window.removeEventListener("keydown",t)}},[e]),p("div",{className:"instructions",children:[p("h1",{children:"How to Play Monster Steps"}),p("ul",{children:[p("li",{children:"Use arrow keys, touch controls, or mouse clicks to move your character"}),p("li",{children:"Avoid obstacles and monsters"}),p("li",{children:"Reach the goal (green square) to complete the level"}),p("li",{children:"New monsters appear every 13 steps"}),p("li",{children:["Collect bonuses for special abilities:",p("ul",{children:[p("li",{children:"Cap of Invisibility: Temporary invisibility to monsters"}),p("li",{children:"Confused Monsters: Monsters move randomly"}),p("li",{children:"Land Mine: Place a trap for monsters"}),p("li",{children:"Time Bomb: Delayed explosion"}),p("li",{children:"Crusher: Destroy nearby obstacles"}),p("li",{children:"Builder: Create new platforms"}),p("li",{children:"Climber: Climb on walls and obstacles"}),p("li",{children:"Teleport: Instantly move to another location on the grid"}),p("li",{children:"Tsunami: Water floods the grid, slowing movement. Climb to survive!"}),p("li",{children:"Monster: Transform into a monster and hunt other monsters"}),p("li",{children:"Slide: Glide across the grid until hitting an obstacle"}),p("li",{children:"Sokoban: Push obstacles to crush monsters or create paths"}),p("li",{children:"Blaster: Shoot in the direction you're moving to eliminate monsters"})]})]}),p("li",{children:"Complete all 13 levels to win"})]}),p("h2",{children:"New Bonus Details"}),p("ul",{children:[p("li",{children:["Tsunami:",p("ul",{children:[p("li",{children:"Water gradually floods the grid over 13 steps"}),p("li",{children:"Movement becomes slower for both you and monsters"}),p("li",{children:"At the 13th step, everything not on an obstacle is eliminated"}),p("li",{children:"Use the Climber bonus to survive on obstacles"})]})]}),p("li",{children:["Monster:",p("ul",{children:[p("li",{children:"You become a monster for 13 steps"}),p("li",{children:'Monsters become vulnerable "players" during this time'}),p("li",{children:"Eliminate all monster-players to win, but be careful not to let them reach the goal!"})]})]}),p("li",{children:["Slide:",p("ul",{children:[p("li",{children:"Your movement becomes a slide in the chosen direction"}),p("li",{children:"You'll keep moving until you hit an obstacle or the edge of the grid"}),p("li",{children:"Use this to quickly traverse the grid, but plan your moves carefully!"})]})]}),p("li",{children:["Sokoban:",p("ul",{children:[p("li",{children:"Gain the ability to push obstacles"}),p("li",{children:"Use this to create new paths or crush monsters"}),p("li",{children:"Strategic obstacle placement can help block monster paths"})]})]}),p("li",{children:["Blaster:",p("ul",{children:[p("li",{children:"Equip a blaster that shoots in the direction you're moving"}),p("li",{children:"Eliminate monsters in your path"}),p("li",{children:"Use carefully to clear your way to the goal"})]})]})]}),p("h2",{children:"Tips"}),p("ul",{children:[p("li",{children:"Plan your route to avoid getting trapped"}),p("li",{children:"Use obstacles and new bonuses strategically to outmaneuver monsters"}),p("li",{children:"Combine bonuses for powerful effects (e.g., Climber during Tsunami)"}),p("li",{children:"Think ahead when using Slide or Sokoban to avoid putting yourself in danger"}),p("li",{children:"Keep track of your steps to anticipate new monster spawns"})]}),p("button",{onClick:e,children:"Back to Menu"}),p("p",{className:"instructions-tip",children:"Press Escape to return to the main menu"})]})),B=(e,t)=>e.x===t.x&&e.y===t.y,F=(e,t)=>t.some(o=>B(o,e)),_e=(e,t)=>Math.abs(e.x-t.x)+Math.abs(e.y-t.y),kn=e=>{switch(e){case"ArrowUp":case"w":return T.Up;case"ArrowDown":case"s":return T.Down;case"ArrowLeft":case"a":return T.Left;case"ArrowRight":case"d":return T.Right;default:return null}},Y=(e,t,o=1)=>{switch(t){case T.Up:return{...e,y:e.y-o};case T.Down:return{...e,y:e.y+o};case T.Left:return{...e,x:e.x-o};case T.Right:return{...e,x:e.x+o}}};function Tt(e,t){switch(e){case T.Up:return t===-1?T.Left:T.Right;case T.Down:return t===-1?T.Left:T.Right;case T.Left:return t===-1?T.Down:T.Up;case T.Right:return t===-1?T.Up:T.Down}}const Dn=(e,t,{gridSize:o})=>!(!(e.x>=0&&e.x<o&&e.y>=0&&e.y<o)||F(e,t.obstacles.filter(i=>!i.isDestroying).map(({position:i})=>i))),Ce=(e,t,{gridSize:o})=>{if(!(e.x>=0&&e.x<o&&e.y>=0&&e.y<o))return!1;const s=F(t.player.position,t.obstacles.filter(r=>!r.isDestroying).map(({position:r})=>r));if(F(e,t.obstacles.filter(r=>!r.isDestroying).map(({position:r})=>r))&&!N(t,f.Climber)&&!s&&!N(t,f.Crusher)){if(t.activeBonuses.some(r=>r.type===f.Sokoban)){const r=jt(t.player.position,e),c=Y(e,r);if(c.x>=0&&c.x<o&&c.y>=0&&c.y<o&&!F(c,t.obstacles.map(u=>u.position)))return!0}return!1}return!0},Xt=(e,t)=>{const{player:o}=e,n=[T.Up,T.Down,T.Left,T.Right];return N(e,f.Slide)?n.map(s=>{let i=o.position;for(;Ce(Y(i,s),e,t);)i=Y(i,s);return{position:i,direction:s}}).filter(s=>!B(s.position,o.position)):n.map(s=>({position:Y(o.position,s),direction:s})).filter(({position:s})=>Ce(s,e,t))};function In(e,t,o,n){return Xt(o,n).find(s=>En(e,t,Zt(n.gridSize,n.cellSize,s.direction)))}function En(e,t,o){let n=!1;for(let s=0,i=o.length-1;s<o.length;i=s++){const r=o[s].x,c=o[s].y,a=o[i].x,u=o[i].y;c>t!=u>t&&e<(a-r)*(t-c)/(u-c)+r&&(n=!n)}return n}function jt(e,t){return t.x>e.x?T.Right:t.x<e.x?T.Left:t.y>e.y?T.Down:T.Up}const An=(e,t,o,n)=>{e.save(),e.translate(e.canvas.width/2,100),t.forEach(({direction:s})=>{const i=Zt(o,n,s);e.beginPath(),e.moveTo(i[0].x,i[0].y),e.lineTo(i[1].x,i[1].y),e.lineTo(i[2].x,i[2].y),e.fillStyle="rgba(255, 255, 0, 0.5)",e.fill()}),e.restore()};function Zt(e,t,o){const n=e/3,s=Y({x:e/2,y:e/2},o,e/1.5),i=Y(s,Tt(o,-1),n),r=Y(s,Tt(o,1),n),c=k(s.x,s.y),a=k(i.x,i.y),u=k(r.x,r.y),h=Y(s,o,n),l=k(h.x,h.y),d=Math.atan2(l.y-c.y,l.x-c.x),_=Math.cos(d)*t,b=Math.sin(d)*t;return[{x:l.x+_,y:l.y+b},{x:a.x+_,y:a.y+b},{x:u.x+_,y:u.y+b}]}const Ln=(e,t,o,n,s,i,r)=>{const c=[];return e.map(a=>{let u;const h=Sn(a.position,t,o,n);s||h>13?u=We(a.position,a.spawnPoint,o,n,e)[1]||a.position:u=We(a.position,t,o,n,e)[1]||a.position;let l;return i||r?l=On(a.position,u,o,n,e):l=u,F(l,c)?l=a.position:c.push(l),{...a,previousPosition:a.position,position:l,moveTimestamp:Date.now()}})},Sn=(e,t,o,n)=>We(e,t,o,n,[]).length-1,On=(e,t,o,n,s)=>{const i=t.x-e.x,r=t.y-e.y,c={x:Math.max(0,Math.min(o-1,e.x-i)),y:Math.max(0,Math.min(o-1,e.y-r))};return!F(c,n.map(({position:a})=>a))&&!F(c,s.map(a=>a.position))?c:e},We=(e,t,o,n,s)=>{const i=[],r=[],c={position:e,g:0,h:0,f:0,parent:null};for(i.push(c);i.length>0;){let a=i[0],u=0;if(i.forEach((l,d)=>{l.f<a.f&&(a=l,u=d)}),i.splice(u,1),r.push(a),B(a.position,t))return Bn(a);const h=Nn(a.position,o);for(const l of h){if(F(l,n.map(({position:v})=>v))||F(l,s.map(v=>v.position))||r.some(v=>B(v.position,l)))continue;const d=a.g+1,_=_e(l,t),b=d+_,y=i.find(v=>B(v.position,l));y?d<y.g&&(y.g=d,y.f=b,y.parent=a):i.push({position:l,g:d,h:_,f:b,parent:a})}}return[e]},Bn=e=>{const t=[];let o=e;for(;o!==null;)t.unshift(o.position),o=o.parent;return t},Nn=(e,t)=>[{x:e.x-1,y:e.y},{x:e.x+1,y:e.y},{x:e.x,y:e.y-1},{x:e.x,y:e.y+1}].filter(n=>n.x>=0&&n.x<t&&n.y>=0&&n.y<t),Fn=(e,t)=>t.some(o=>B(o.position,e)),Rn=(e,t)=>{const o=[];return[e.filter(s=>{const i=t.find(r=>B(r,s.position));return i?(o.push({position:i,startTime:Date.now(),duration:1e3}),$n(t,i),!1):!0}),o]},$n=(e,t)=>{e.splice(e.indexOf(t),1)},Un=(e,t)=>Math.abs(e.position.x-t.position.x)<=1&&Math.abs(e.position.y-t.position.y)<=1,Be=(e,t)=>t.some(o=>Math.abs(e.x-o.position.x)<=1&&Math.abs(e.y-o.position.y)<=1);class Gn{constructor(){Ae(this,"audioContext");Ae(this,"masterVolume",.025);this.audioContext=new(window.AudioContext||window.webkitAudioContext)}createOscillator(t,o,n){const s=this.audioContext.createOscillator();return s.type=o,s.frequency.setValueAtTime(t,this.audioContext.currentTime),s.start(),s.stop(this.audioContext.currentTime+n),s}createGain(t,o,n=1){const s=this.audioContext.createGain(),i=n*this.masterVolume;return s.gain.setValueAtTime(0,this.audioContext.currentTime),s.gain.linearRampToValueAtTime(i,this.audioContext.currentTime+t),s.gain.linearRampToValueAtTime(0,this.audioContext.currentTime+t+o),s}playStep(){const t=this.createOscillator(200,"square",.1),o=this.createGain(.01,.09);t.connect(o).connect(this.audioContext.destination)}playElectricalDischarge(){const t=this.createOscillator(800,"sawtooth",.2),o=this.createGain(.01,.19);t.frequency.linearRampToValueAtTime(200,this.audioContext.currentTime+.2),t.connect(o).connect(this.audioContext.destination)}playBonusCollected(){const t=this.createOscillator(600,"sine",.15),o=this.createGain(.01,.14);t.frequency.linearRampToValueAtTime(800,this.audioContext.currentTime+.15),t.connect(o).connect(this.audioContext.destination)}playExplosion(){const t=this.audioContext.createBufferSource(),o=this.audioContext.sampleRate*.5,n=this.audioContext.createBuffer(1,o,this.audioContext.sampleRate),s=n.getChannelData(0);for(let r=0;r<o;r++)s[r]=Math.random()*2-1;t.buffer=n;const i=this.createGain(.01,.49,.5);t.connect(i).connect(this.audioContext.destination),t.start()}playStateTransition(){const t=this.createOscillator(300,"triangle",.3),o=this.createGain(.05,.25);t.frequency.linearRampToValueAtTime(600,this.audioContext.currentTime+.3),t.connect(o).connect(this.audioContext.destination)}playGameOver(){const t=this.createOscillator(440,"sine",1),o=this.createGain(.01,.99);t.frequency.linearRampToValueAtTime(220,this.audioContext.currentTime+1),t.connect(o).connect(this.audioContext.destination)}playLevelComplete(){const t=this.createOscillator(440,"sine",.5),o=this.createOscillator(550,"sine",.5),n=this.createGain(.01,.49),s=this.createGain(.01,.49);t.connect(n).connect(this.audioContext.destination),o.connect(s).connect(this.audioContext.destination),setTimeout(()=>{const i=this.createOscillator(660,"sine",.5),r=this.createGain(.01,.49);i.connect(r).connect(this.audioContext.destination)},250)}playMonsterSpawn(){const t=this.createOscillator(100,"sawtooth",.3),o=this.createGain(.01,.29);t.frequency.exponentialRampToValueAtTime(300,this.audioContext.currentTime+.3),t.connect(o).connect(this.audioContext.destination)}playTeleport(){const t=this.createOscillator(100,"sine",.5),o=this.createOscillator(200,"sine",.5),n=this.createGain(.01,.49),s=this.createGain(.01,.49);t.frequency.exponentialRampToValueAtTime(1e3,this.audioContext.currentTime+.25),o.frequency.exponentialRampToValueAtTime(2e3,this.audioContext.currentTime+.25),t.connect(n).connect(this.audioContext.destination),o.connect(s).connect(this.audioContext.destination),setTimeout(()=>{const i=this.createOscillator(2e3,"sine",.2),r=this.createGain(.01,.19);i.frequency.exponentialRampToValueAtTime(4e3,this.audioContext.currentTime+.2),i.connect(r).connect(this.audioContext.destination)},100)}playBlasterSound(){const o=this.audioContext.createOscillator();o.type="sawtooth",o.frequency.setValueAtTime(1e3,this.audioContext.currentTime),o.frequency.exponentialRampToValueAtTime(500,this.audioContext.currentTime+.15);const n=this.audioContext.createGain();n.gain.setValueAtTime(0,this.audioContext.currentTime),n.gain.linearRampToValueAtTime(this.masterVolume,this.audioContext.currentTime+.01),n.gain.exponentialRampToValueAtTime(.01,this.audioContext.currentTime+.15);const s=this.audioContext.createBuffer(1,this.audioContext.sampleRate*.15,this.audioContext.sampleRate),i=s.getChannelData(0);for(let a=0;a<s.length;a++)i[a]=Math.random()*2-1;const r=this.audioContext.createBufferSource();r.buffer=s;const c=this.audioContext.createGain();c.gain.setValueAtTime(this.masterVolume*.2,this.audioContext.currentTime),c.gain.exponentialRampToValueAtTime(.01,this.audioContext.currentTime+.15),o.connect(n).connect(this.audioContext.destination),r.connect(c).connect(this.audioContext.destination),o.start(),r.start(),o.stop(this.audioContext.currentTime+.15),r.stop(this.audioContext.currentTime+.15)}}const X=new Gn,Hn=(e,t)=>{const o={type:t,duration:13};switch(e.activeBonuses.push(o),t){case f.CapOfInvisibility:break;case f.ConfusedMonsters:break;case f.LandMine:e.landMines.push({...e.player.position});break;case f.TimeBomb:e.timeBombs.push({position:e.player.position,timer:13,shakeIntensity:0});break;case f.Crusher:break;case f.Builder:break;case f.Climber:break;case f.Teleport:break;case f.Tsunami:e.tsunamiLevel=1;break;case f.Monster:break;case f.Slide:break;case f.Sokoban:break;case f.Blaster:break}},Wn=(e,t)=>{const o=Object.values(f).filter(i=>typeof i=="number");let n;if(e.monsters.length>5){const i=[f.CapOfInvisibility,f.Crusher,f.LandMine,f.TimeBomb,f.Blaster];n=i[Math.floor(Math.random()*i.length)]}else if(e.obstacles.length>20){const i=[f.Climber,f.Slide,f.Teleport];n=i[Math.floor(Math.random()*i.length)]}else n=o[Math.floor(Math.random()*o.length)];let s;do s={x:Math.floor(Math.random()*t.gridSize),y:Math.floor(Math.random()*t.gridSize)};while(F(s,e.obstacles.map(i=>i.position))||F(s,e.monsters.map(i=>i.position))||F(s,e.bonuses.map(i=>i.position))||B(s,e.player.position)||B(s,e.goal)||_e(s,e.player.position)<3);e.bonuses.push({type:n,position:s})},Vn=(e,t)=>{const o=e.bonuses.find(n=>n.type===f.Teleport&&!B(n.position,t));o&&(e.player.previousPosition=e.player.position,e.player.position=o.position,e.player.teleportTimestamp=Date.now(),X.playTeleport())},Yn=e=>{e.tsunamiLevel++,e.tsunamiLevel>=13&&(F(e.player.position,e.obstacles.map(t=>t.position))||(e.gameEndingState="gameOver",Pe(e)),e.monsters=[],e.tsunamiLevel=0,e.tsunamiTeardownTimestamp=Date.now())},qn=e=>{const t=e.monsters.find(o=>B(e.player.position,o.position));t&&(e.monsters=e.monsters.filter(o=>o!==t),e.monsters.length===0&&(e.gameEndingState="gameOver",Pe(e)))},Kt=(e,t,o)=>{let n=e.player.position;for(;Ce(Y(n,t),e,o);)n=Y(n,t);return n},Xn=(e,t,o,n)=>{const s=e.obstacles.find(i=>B(i.position,o));if(s){const i=Y(s.position,jt(t,o));if(Dn(i,e,{gridSize:n})){s.position=i;const r=e.monsters.find(c=>B(c.position,i));r&&(e.monsters=e.monsters.filter(c=>c!==r))}else o=t}},jn=(e,t,o)=>{const n=e.player.position,s=Kt(e,t,o),i={startPosition:n,endPosition:s,direction:t,shotTimestamp:Date.now(),duration:Io*(_e(n,s)+1)};e.blasterShots.push(i),X.playBlasterSound(),e.monsters=e.monsters.filter(r=>!Zn(r.position,n,s,t))},Zn=(e,t,o,n)=>{switch(n){case T.Up:case T.Down:return e.x===t.x&&(n===T.Up&&e.y<=t.y&&e.y>=o.y||n===T.Down&&e.y>=t.y&&e.y<=o.y);case T.Left:case T.Right:return e.y===t.y&&(n===T.Left&&e.x<=t.x&&e.x>=o.x||n===T.Right&&e.x>=t.x&&e.x<=o.x)}},Kn=(e,t,o)=>{if(ce(t))return t;const n=kn(e.key);return n!==null?Qt(n,t,o):{...t}},Qt=(e,t,o)=>{if(ce(t))return t;const n={...t},s=n.player.position;let i=Y(n.player.position,e);if(N(n,f.Slide)&&(i=Kt(n,e,o)),n.activeBonuses.some(r=>r.type===f.Sokoban)&&Xn(n,s,i,o.gridSize),n.obstacles=t.obstacles.filter(r=>!r.isDestroying||Date.now()-r.creationTime<Ht),N(n,f.Crusher)&&t.obstacles.find(r=>B(i,r.position))&&(n.obstacles=t.obstacles.map(r=>B(i,r.position)?{...r,isDestroying:!0,creationTime:Date.now()}:r),X.playElectricalDischarge()),Ce(i,n,o)){if(X.playStep(),n.player.position=i,Date.now()-n.player.moveTimestamp>Ut&&(n.player.previousPosition=s,n.player.moveTimestamp=Date.now()),n.steps++,n.monsterSpawnSteps++,n.tsunamiLevel>0&&Yn(n),B(i,n.goal))return n.gameEndingState="levelComplete",Jn(n),n.score+=Qn(n),n;const r=n.bonuses.find(h=>B(h.position,i));if(r&&(X.playBonusCollected(),n.bonuses=n.bonuses.filter(h=>!B(h.position,i)),Hn(n,r.type)),(r==null?void 0:r.type)===f.Teleport&&Vn(n,r.position),o.levelUpdater(n,o),n.monsters=Ln(n.monsters,n.player.position,o.gridSize,n.obstacles,N(n,f.CapOfInvisibility),N(n,f.ConfusedMonsters),N(n,f.Monster)),N(n,f.Monster))qn(n);else if(Fn(n.player.position,n.monsters))return n.gameEndingState="gameOver",Pe(n),n;N(n,f.Blaster)&&jn(n,e,o),n.blasterShots=n.blasterShots.filter(h=>Date.now()-h.shotTimestamp<h.duration);const[c,a]=Rn(n.monsters,n.landMines);n.monsters=c,n.explosions=a,n.timeBombs=n.timeBombs.map(h=>({...h,timer:h.timer-1}));const u=n.timeBombs.filter(h=>h.timer===0);if((u.length>0||a.length>0)&&X.playExplosion(),n.explosions=[...n.explosions,...u.map(h=>({position:h.position,startTime:Date.now(),duration:1e3}))],n.timeBombs=n.timeBombs.filter(h=>h.timer>0),n.monsters=n.monsters.filter(h=>!n.explosions.some(l=>Un(h,l))),n.obstacles=n.obstacles.map(h=>Be(h.position,n.explosions)?{...h,isDestroying:!0,creationTime:Date.now()}:h),n.bonuses=n.bonuses.filter(h=>!Be(h.position,n.explosions)),Be(n.player.position,n.explosions))return n.gameEndingState="gameOver",Pe(n),n;if(n.activeBonuses=n.activeBonuses.map(h=>({...h,duration:h.duration-1})).filter(h=>h.duration>0),N(n,f.Builder)){const h={position:s,creationTime:Date.now(),isRaising:!0,isDestroying:!1};F(h.position,n.obstacles.map(({position:l})=>l))||(n.obstacles.push(h),X.playElectricalDischarge())}}return n},Qn=e=>100-e.steps+e.monsters.length*10,ce=e=>e.gameEndingState!=="none",Pe=e=>{e.player.isVanishing=!0,X.playGameOver()},Jn=e=>{e.player.isVictorious=!0,X.playLevelComplete()},zn=({level:e,score:t,steps:o})=>p("div",{className:"hud",children:[p("div",{children:["Level: ",e]}),p("div",{children:["Score: ",t]}),p("div",{children:["Steps: ",o]})]}),xn=10,es=10,ts=(e,{gridSize:t,monsterSpawnSectors:o})=>{let n=0;const s=50;for(;n<s;){const i=o.length>0?o[Math.floor(o.length*Math.random())]:{x:Math.floor(Math.random()*t),y:Math.floor(Math.random()*t)};if(os(i,e,t))return{position:i,previousPosition:i,moveTimestamp:Date.now(),path:[],seed:Math.random(),isConfused:!1,spawnPoint:i};n++}return null},os=(e,t,o)=>{if(e.x<0||e.y<0||e.x>=o||e.y>=o||F(e,t.obstacles.map(s=>s.position))||F(e,t.monsters.map(s=>s.position))||F(e,t.bonuses.map(s=>s.position))||B(e,t.goal)||_e(e,t.player.position)<xn)return!1;const n=[f.TimeBomb,f.LandMine,f.Crusher,f.Blaster];for(const s of t.bonuses)if(n.includes(s.type)&&_e(e,s.position)<es)return!1;return!0};function ns(e,t){if(e.monsterSpawnSteps>=13){const o=ts(e,t);o&&(e.monsters.push(o),e.monsterSpawnSteps=0,X.playMonsterSpawn())}}const ss=()=>{const e=W(),t=V(7,1,"The First Step","Avoid the lone monster and reach the goal in 13 steps!");return e.player=H(0,3),e.goal=A(6,3),e.monsters=[I(3,0)],e.obstacles=[m(5,2),m(5,3)],[e,t,t.levelStory]},is=()=>{const e=W(),t=V(8,2,"Now You See Me","Use the invisibility cap to sneak past the monsters!");return e.player=H(0,4),e.goal=A(7,4),e.monsters=[I(3,2),I(5,4)],e.bonuses=[L(2,4,f.CapOfInvisibility)],e.obstacles=[m(1,3),m(1,5),m(6,3),m(6,5)],[e,t,t.levelStory]},rs=()=>{const e=W(),t=V(9,3,"Bridge the Gap","Build your way to victory!");return e.player=H(0,4),e.goal=A(8,4),e.monsters=[I(4,4)],e.bonuses=[L(2,4,f.Builder)],e.obstacles=[m(3,3),m(3,4),m(3,5),m(5,3),m(5,4),m(5,5)],[e,t,t.levelStory]},as=()=>{const e=W(),t=V(9,4,"Crush and Rush","Clear the path with your crushing power!");e.player=H(0,4),e.goal=A(8,4),e.monsters=[I(4,4)],e.bonuses=[L(2,4,f.Crusher)],e.obstacles=[m(8,2),m(7,2),m(7,3),m(7,4),m(7,5),m(8,5)];for(let o=2;o<7;o++)e.obstacles.push(m(o,3)),e.obstacles.push(m(o-1,5));return[e,t,t.levelStory]},ls=()=>{const e=W(),t=V(10,5,"Tick Tock Boom","Time your bomb perfectly to clear the way!");e.player=H(0,5),e.goal=A(9,5),e.monsters=[I(3,5)],e.bonuses=[L(8,3,f.TimeBomb)],e.obstacles=[m(9,4),m(8,4),m(8,5),m(8,6),m(9,6),m(2,1),m(3,1),m(4,1),m(5,1),m(6,1),m(7,1),m(8,1)];for(let o=2;o<8;o++)e.obstacles.push(m(o,4)),e.obstacles.push(m(o,6)),e.obstacles.push(m(o-2,8));return t.monsterSpawnSectors=[A(1,9)],[e,t,t.levelStory]},cs=()=>{const e=W(),t=V(10,6,"Minesweeper's Revenge","Plant a surprise for your pursuers!");e.player=H(0,5),e.goal=A(9,5),e.monsters=[I(6,5),I(4,8),I(8,8)],e.bonuses=[L(2,5,f.LandMine)];for(let o=4;o<9;o++)o!==6&&(e.obstacles.push(m(o,4)),e.obstacles.push(m(o,6)));return[e,t,t.levelStory]},us=()=>{const e=W(),t=V(11,7,"Monsters' Mayhem","Confuse them all and make your escape!");e.player=H(0,5),e.goal=A(10,5),e.monsters=[I(3,4),I(3,6),I(6,4),I(6,6)],e.bonuses=[L(2,5,f.ConfusedMonsters)];for(let o=4;o<8;o++)e.obstacles.push(m(o,3)),e.obstacles.push(m(o,7));return[e,t,t.levelStory]},hs=["            ","            ","            ","            ","         ###","#        ###","         #  ","         #  ","         ###","            ","       #####","            "],ps=()=>{const e=W(),t=V(12,8,"Tunnel Vision","Build a path and set a trap!");e.player=H(0,6),e.goal=A(11,6),e.monsters=[I(11,11)],e.bonuses=[L(1,6,f.Builder),L(7,5,f.LandMine),L(8,3,f.Sokoban)];for(let o=0;o<12;o++)for(let n=0;n<12;n++)hs[o][n]==="#"&&e.obstacles.push(m(n,o));return t.monsterSpawnSectors=[A(11,11)],[e,t,"Use the Builder bonus to create a path and set up a trap with the Land Mine. Be strategic about where you place your obstacles and mine to catch the spawning monsters!"]},fs=()=>{const e=W(),t=V(12,9,"Ghost Bomber","Vanish, plant, and detonate!");e.player=H(0,6),e.goal=A(11,6),e.monsters=[I(3,1),I(7,11),I(10,3)],e.bonuses=[L(2,6,f.CapOfInvisibility),L(9,6,f.TimeBomb),L(7,4,f.CapOfInvisibility)];for(let o=2;o<11;o+=2)for(let n=1;n<12;n+=2)!(o===10&&n===5)&&!(o===10&&n===7)&&e.obstacles.push(m(o,n));return e.obstacles.push(m(11,5)),e.obstacles.push(m(10,6)),e.obstacles.push(m(11,7)),e.obstacles.push(m(10,8)),e.obstacles.push(m(1,3)),e.obstacles.push(m(1,9)),e.obstacles.push(m(5,6)),e.obstacles.push(m(8,4)),e.obstacles.push(m(8,8)),[e,t,"Use your invisibility wisely to sneak past the monsters and reach the time bomb. Then, strategically place and detonate the bomb to clear a path to the goal!"]},_s=()=>{const e=W(),t=V(13,10,"Surf and Climb","Ride the wave and climb to safety!");e.player=H(0,6),e.goal=A(12,6),e.monsters=[I(4,6),I(8,6),I(11,6),I(6,2),I(6,10)],e.bonuses=[L(2,6,f.Tsunami),L(4,4,f.Climber)];for(let o=1;o<12;o++)o!==2&&o!==10&&(e.obstacles.push(m(o,5)),e.obstacles.push(m(o,7)));e.obstacles.push(m(3,6)),e.obstacles.push(m(6,6)),e.obstacles.push(m(9,6));for(let o=0;o<13;o+=3)e.obstacles.push(m(o,0)),e.obstacles.push(m(o,12));return e.obstacles.push(m(11,5)),e.obstacles.push(m(11,7)),[e,t,"Collect the Tsunami bonus first, then make your way to the Climber bonus. Use the Climber to get on top of an obstacle, then activate the Tsunami to wash away the monsters. Time it right to reach the goal!"]},ds=()=>{const e=W(),t=V(14,11,"Slide and Blast","Slide through danger and blast your way to victory!");e.player=H(0,0),e.goal=A(13,13),e.monsters=[I(3,3),I(10,10),I(6,7),I(7,6),I(13,0)],e.bonuses=[L(0,2,f.Blaster),L(0,13,f.Slide)];for(let o=2;o<12;o+=3)for(let n=0;n<14;n++)n!==7&&e.obstacles.push(m(o,n));return e.obstacles.push(m(12,1)),e.obstacles.push(m(12,2)),e.obstacles.push(m(11,1)),e.obstacles.push(m(0,6)),e.obstacles.push(m(1,1)),e.obstacles.push(m(4,4)),e.obstacles.push(m(9,9)),e.obstacles.push(m(12,10)),[e,t,"Navigate to the Slide bonus to quickly traverse the level. Then, collect the Blaster to destroy the wall blocking your path to the goal. Watch out for monsters and use your bonuses strategically!"]},ue=15,Jt=["###############","#S  #     #   #","# # # ### # # #","# #   #   #   #","# ##### #### #","#     # #    #","##### # # ####","#   #   #    #","# # ####### ###","# #       # # #","# ####### # # #","#       # # # #","####### # # # #","#         # #  ","############# G"],ms=()=>{const e=W(),t=V(ue,12,"Maze of Challenges","Navigate through a treacherous maze using your wit and special abilities!");for(let s=0;s<ue;s++)for(let i=0;i<ue;i++)Jt[s][i]==="#"&&e.obstacles.push(m(i,s));const o=Mt("S");e.player=H(o.x,o.y);const n=Mt("G");return e.goal=A(n.x,n.y),e.bonuses=[L(1,5,f.Teleport),L(13,1,f.Climber),L(7,9,f.Sokoban),L(2,13,f.Blaster),L(1,13,f.Teleport)],e.monsters=[I(5,5),I(9,9),I(12,5),I(6,13)],[e,t,"Welcome to the Maze of Challenges! Your goal is to navigate through this treacherous maze and reach the exit. Use your special abilities wisely: Teleport past obstacles (now with two Teleport bonuses!), Climb over walls, Push blocks with Sokoban power, and Blast through certain walls. The second Teleport bonus is placed near the Blaster for strategic use. Be cautious of the monsters guarding key junctions. Good luck, adventurer!"]};function Mt(e){for(let t=0;t<ue;t++)for(let o=0;o<ue;o++)if(Jt[t][o]===e)return{x:o,y:t};throw new Error(`Character ${e} not found in maze layout`)}const q=16,zt=5;function Ze(){return{x:Math.floor(Math.random()*q),y:Math.floor(Math.random()*q)}}function xt(e,t){return Math.abs(e.x-t.x)+Math.abs(e.y-t.y)}function Ke(e,t){return!t.obstacles.some(o=>o.position.x===e.x&&o.position.y===e.y)&&!t.monsters.some(o=>o.position.x===e.x&&o.position.y===e.y)&&!t.bonuses.some(o=>o.position.x===e.x&&o.position.y===e.y)&&e.x!==t.player.position.x&&e.y!==t.player.position.y&&e.x!==t.goal.x&&e.y!==t.goal.y}function ys(e,t){for(let o=0;o<t;o++){let n;do n=Ze();while(!Ke(n,e));e.obstacles.push(m(n.x,n.y))}}function bs(e){const t=Object.values(f).filter(s=>typeof s=="number"),o=t[Math.floor(Math.random()*t.length)];let n;do n=Ze();while(!Ke(n,e)||xt(n,e.player.position)<zt);e.bonuses.push(L(n.x,n.y,o))}const vs=()=>{const e=W(),t=V(q,13,"The Final Countdown","Survive and thrive in this ever-changing challenge!",gs);e.player=H(0,0),e.goal=A(q-1,q-1),e.obstacles=[m(q-2,q-2),m(q-1,q-2),m(q-2,q-1)],ys(e,50);for(let o=0;o<3;o++)bs(e);return[e,t,"Welcome to the ultimate challenge! The level will dynamically evolve as you play. Use your skills wisely, collect bonuses, and make your way to the goal while avoiding the increasing dangers. Good luck!"]},gs=(e,t)=>{if(e.steps%13===0){let o;do o=Ze();while(!Ke(o,e)||xt(o,e.player.position)<zt);e.monsters.push(I(o.x,o.y)),Wn(e,t)}},A=(e,t)=>({x:e,y:t}),L=(e,t,o)=>({position:A(e,t),type:o}),I=(e,t)=>({position:A(e,t),previousPosition:A(e,t),moveTimestamp:Date.now(),path:[],seed:Math.random(),isConfused:!1,spawnPoint:A(e,t)}),H=(e,t)=>({position:A(e,t),previousPosition:A(e,t),moveTimestamp:Date.now(),isVictorious:!1,isVanishing:!1}),m=(e,t)=>({position:A(e,t),creationTime:Date.now(),isRaising:!1,isDestroying:!1}),W=()=>({player:H(0,0),goal:A(0,0),obstacles:[],monsters:[],steps:0,monsterSpawnSteps:0,bonuses:[],activeBonuses:[],explosions:[],timeBombs:[],landMines:[],score:0,gameEndingState:"none",tsunamiLevel:0,blasterShots:[]}),ws=40,V=(e,t,o,n,s=ns)=>({gridSize:e,cellSize:ws,initialMonsterCount:0,monsterSpawnSectors:[],obstacleCount:0,initialBonusCount:0,levelNumber:t,levelName:o,levelStory:n,levelUpdater:s}),Ts={1:ss,2:is,3:rs,4:as,5:ls,6:cs,7:us,8:ps,9:fs,10:_s,11:ds,12:ms,13:vs},Ms=e=>{if(e<1||e>13)throw new Error(`Invalid level number: ${e}`);return Ts[e]()},Cs=13,Ps=2e3,ks=({level:e,score:t,onGameOver:o,onLevelComplete:n,onGameComplete:s,updateScore:i,updateSteps:r})=>{const c=Ge(null),[[a,u,h],l]=ie(()=>Ms(e)),[d,_]=ie(!0),b=y=>{l([y,u,h]),i(y.score),r(y.steps)};return x(()=>{a.gameEndingState!=="none"&&setTimeout(()=>{a.gameEndingState==="levelComplete"&&(e===Cs?s():n()),a.gameEndingState==="gameOver"&&o()},Ps)},[a.gameEndingState]),x(()=>{if(!a||!u)return;const y=c.current;let v;if(y){const g=(u.gridSize+u.gridSize)*u.cellSize,w=(u.gridSize+u.gridSize)*u.cellSize/2;y.width=g,y.height=w+100;const D=y.getContext("2d");if(D){const E=()=>{qt(D,a,u),ce(a)||An(D,Xt(a,u),u.gridSize,u.cellSize),v=requestAnimationFrame(E)};E()}}return()=>{v!==null&&cancelAnimationFrame(v)}},[a,u,d]),x(()=>{if(!a||!u)return;const y=g=>{if(d){_(!1);return}if(!ce(a)){const w=Kn(g,a,u);b(w)}},v=g=>{if(d){_(!1);return}if(ce(a))return;const w=c.current;if(!w)return;const D=w.getBoundingClientRect(),E=In((g.clientX-D.left)*(w.width/D.width)-w.width/2,(g.clientY-D.top)*(w.height/D.height)-100,a,u);E&&b(Qt(E.direction,a,u))};return window.addEventListener("click",v),window.addEventListener("keydown",y),()=>{window.removeEventListener("click",v),window.removeEventListener("keydown",y)}},[a,u,d,o,n,i,r]),d?p("div",{className:"level-story",children:[p("h2",{children:["Level ",e]}),p("p",{children:h}),p("p",{children:"Press any key to start..."})]}):p("div",{className:"gameplay",children:[p(zn,{level:e,score:t,steps:(a==null?void 0:a.monsterSpawnSteps)||0}),p("div",{className:"canvas-container",children:p("canvas",{ref:c})})]})},Ds=({score:e,steps:t,onTryAgain:o,onQuit:n})=>p("div",{className:"game-over",children:[p("h1",{children:"Game Over"}),p("p",{children:["Your score: ",e]}),p("p",{children:["Steps taken: ",t]}),p("button",{onClick:o,children:"Try Again"}),p("button",{onClick:n,children:"Quit"})]}),Is=({level:e,onNextLevel:t,onQuit:o})=>p("div",{className:"level-complete",children:[p("h1",{children:["Level ",e," Complete!"]}),p("p",{children:"Congratulations! You've completed the level."}),p("button",{onClick:t,children:"Next Level"}),p("button",{onClick:o,children:"Quit"})]});function Es(){const[e,t]=ie(0),[o,n]=ie(parseInt(document.location.hash.split("level")[1]??"1")),[s,i]=ie(0),[r,c]=ie(0),a=lt(()=>{t(2)},[]),u=()=>{t(1)},h=()=>{n(1),i(0),c(0),t(2)},l=()=>{t(2)},d=()=>{t(0)},_=()=>{t(3)},b=()=>{n(o+1),t(4)},y=lt(()=>{t(2)},[]),v=()=>{X.playLevelComplete(),t(5)},g=D=>i(D),w=D=>c(D);return x(()=>{const D=E=>{E.key==="ArrowRight"?e===0?a():e===4?y():e===3?l():e===5&&h():E.key==="Escape"&&(e===1||e===3||e===5)&&d()};return window.addEventListener("keydown",D),()=>{window.removeEventListener("keydown",D)}},[e,a,y]),p("div",{className:"game-container",children:[e===0&&p(Cn,{onStart:a,onInstructions:u}),e===1&&p(Pn,{onBack:d}),e===2&&p(ks,{level:o,score:s,onGameOver:_,onLevelComplete:b,onGameComplete:v,updateScore:g,updateSteps:w}),e===3&&p(Ds,{score:s,steps:r,onTryAgain:l,onQuit:d}),e===4&&p(Is,{level:o,onNextLevel:y,onQuit:d}),e===5&&p(As,{score:s,steps:r,onPlayAgain:h,onQuit:d})]})}function As({score:e,steps:t,onPlayAgain:o,onQuit:n}){return p("div",{className:"game-complete intro",children:[p("h1",{className:"game-title",children:"Monster Steps"}),p("h2",{className:"game-complete-subtitle",children:"Congratulations!"}),p("div",{className:"game-complete-stats",children:[p("p",{children:["Final Score: ",e]}),p("p",{children:["Total Steps: ",t]})]}),p("div",{className:"intro-buttons",children:[p("button",{onClick:o,children:"Play Again"}),p("button",{onClick:n,children:"Quit"})]}),p("p",{className:"intro-tip",children:"Press right arrow to play again"})]})}To(p(Es,{}),document.body);
