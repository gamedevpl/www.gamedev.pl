import{c as B,g as Xn,r as E,j as m,R as N,u as kt,a as Wn,b as Kn}from"./index-BrSWHBGJ.js";import{d as F,m as ce,f as Zn}from"./styled-components.browser.esm-D0lx_Gcr.js";const Re=20,ee=Re*1.5,ye=5,O=20,Jn=1,Qn=5,ei=O/Qn,Bt=.5,wt=500,K=.05,be=5,ti=4,de=60,x=16,R=x*5,Lt=1e3,Oe=R*6,ni=10,ii=Re/10,si=1e3,ai=.5,oi=.05,ri=.1,ci=.1,T=x*.7,li=5;var g=(e=>(e.NEUTRAL="NEUTRAL",e.FRIENDLY="FRIENDLY",e.HOSTILE="HOSTILE",e))(g||{}),Rt=(e=>(e.LAUNCH_SITE="LAUNCH_SITE",e))(Rt||{}),_=(e=>(e.WATER="WATER",e.GROUND="GROUND",e))(_||{}),M=(e=>(e.ATTACK="ATTACK",e.DEFENCE="DEFENCE",e))(M||{});function ui(e,t){const n=[];for(let i=0;i<t;i++)for(let s=0;s<e;s++)n.push({id:`${s*x},${i*x}`,position:{x:s*x,y:i*x},rect:{left:s*x,top:i*x,right:(s+1)*x,bottom:(i+1)*x},type:_.WATER,depth:0,height:0,population:0});return n}function di(e,t,n){const i=[],s=Array(n).fill(null).map(()=>Array(t).fill(!1));for(let o=0;o<n;o++)for(let a=0;a<t;a++){const r=o*t+a;e[r].type===_.WATER&&fi(a,o,t,n,e)&&(i.push([a,o,0]),s[o][a]=!0)}for(;i.length>0;){const[o,a,r]=i.shift(),c=a*t+o;e[c].type===_.WATER?e[c].depth=r+(Math.random()-Math.random())/5:e[c].type===_.GROUND&&(e[c].height=Math.sqrt(r)+(Math.random()-Math.random())/10);const u=[[-1,0],[1,0],[0,-1],[0,1]];for(const[l,d]of u){const f=o+l,h=a+d;Ot(f,h,t,n)&&!s[h][f]&&(i.push([f,h,r+1]),s[h][f]=!0)}}}function fi(e,t,n,i,s){return[[-1,0],[1,0],[0,-1],[0,1]].some(([a,r])=>{const c=e+a,u=t+r;if(Ot(c,u,n,i)){const l=u*n+c;return s[l].type===_.GROUND}return!1})}function Ot(e,t,n,i){return e>=0&&e<n&&t>=0&&t<i}var jt={exports:{}},mi=[{value:"#B0171F",name:"indian red"},{value:"#DC143C",css:!0,name:"crimson"},{value:"#FFB6C1",css:!0,name:"lightpink"},{value:"#FFAEB9",name:"lightpink 1"},{value:"#EEA2AD",name:"lightpink 2"},{value:"#CD8C95",name:"lightpink 3"},{value:"#8B5F65",name:"lightpink 4"},{value:"#FFC0CB",css:!0,name:"pink"},{value:"#FFB5C5",name:"pink 1"},{value:"#EEA9B8",name:"pink 2"},{value:"#CD919E",name:"pink 3"},{value:"#8B636C",name:"pink 4"},{value:"#DB7093",css:!0,name:"palevioletred"},{value:"#FF82AB",name:"palevioletred 1"},{value:"#EE799F",name:"palevioletred 2"},{value:"#CD6889",name:"palevioletred 3"},{value:"#8B475D",name:"palevioletred 4"},{value:"#FFF0F5",name:"lavenderblush 1"},{value:"#FFF0F5",css:!0,name:"lavenderblush"},{value:"#EEE0E5",name:"lavenderblush 2"},{value:"#CDC1C5",name:"lavenderblush 3"},{value:"#8B8386",name:"lavenderblush 4"},{value:"#FF3E96",name:"violetred 1"},{value:"#EE3A8C",name:"violetred 2"},{value:"#CD3278",name:"violetred 3"},{value:"#8B2252",name:"violetred 4"},{value:"#FF69B4",css:!0,name:"hotpink"},{value:"#FF6EB4",name:"hotpink 1"},{value:"#EE6AA7",name:"hotpink 2"},{value:"#CD6090",name:"hotpink 3"},{value:"#8B3A62",name:"hotpink 4"},{value:"#872657",name:"raspberry"},{value:"#FF1493",name:"deeppink 1"},{value:"#FF1493",css:!0,name:"deeppink"},{value:"#EE1289",name:"deeppink 2"},{value:"#CD1076",name:"deeppink 3"},{value:"#8B0A50",name:"deeppink 4"},{value:"#FF34B3",name:"maroon 1"},{value:"#EE30A7",name:"maroon 2"},{value:"#CD2990",name:"maroon 3"},{value:"#8B1C62",name:"maroon 4"},{value:"#C71585",css:!0,name:"mediumvioletred"},{value:"#D02090",name:"violetred"},{value:"#DA70D6",css:!0,name:"orchid"},{value:"#FF83FA",name:"orchid 1"},{value:"#EE7AE9",name:"orchid 2"},{value:"#CD69C9",name:"orchid 3"},{value:"#8B4789",name:"orchid 4"},{value:"#D8BFD8",css:!0,name:"thistle"},{value:"#FFE1FF",name:"thistle 1"},{value:"#EED2EE",name:"thistle 2"},{value:"#CDB5CD",name:"thistle 3"},{value:"#8B7B8B",name:"thistle 4"},{value:"#FFBBFF",name:"plum 1"},{value:"#EEAEEE",name:"plum 2"},{value:"#CD96CD",name:"plum 3"},{value:"#8B668B",name:"plum 4"},{value:"#DDA0DD",css:!0,name:"plum"},{value:"#EE82EE",css:!0,name:"violet"},{value:"#FF00FF",vga:!0,name:"magenta"},{value:"#FF00FF",vga:!0,css:!0,name:"fuchsia"},{value:"#EE00EE",name:"magenta 2"},{value:"#CD00CD",name:"magenta 3"},{value:"#8B008B",name:"magenta 4"},{value:"#8B008B",css:!0,name:"darkmagenta"},{value:"#800080",vga:!0,css:!0,name:"purple"},{value:"#BA55D3",css:!0,name:"mediumorchid"},{value:"#E066FF",name:"mediumorchid 1"},{value:"#D15FEE",name:"mediumorchid 2"},{value:"#B452CD",name:"mediumorchid 3"},{value:"#7A378B",name:"mediumorchid 4"},{value:"#9400D3",css:!0,name:"darkviolet"},{value:"#9932CC",css:!0,name:"darkorchid"},{value:"#BF3EFF",name:"darkorchid 1"},{value:"#B23AEE",name:"darkorchid 2"},{value:"#9A32CD",name:"darkorchid 3"},{value:"#68228B",name:"darkorchid 4"},{value:"#4B0082",css:!0,name:"indigo"},{value:"#8A2BE2",css:!0,name:"blueviolet"},{value:"#9B30FF",name:"purple 1"},{value:"#912CEE",name:"purple 2"},{value:"#7D26CD",name:"purple 3"},{value:"#551A8B",name:"purple 4"},{value:"#9370DB",css:!0,name:"mediumpurple"},{value:"#AB82FF",name:"mediumpurple 1"},{value:"#9F79EE",name:"mediumpurple 2"},{value:"#8968CD",name:"mediumpurple 3"},{value:"#5D478B",name:"mediumpurple 4"},{value:"#483D8B",css:!0,name:"darkslateblue"},{value:"#8470FF",name:"lightslateblue"},{value:"#7B68EE",css:!0,name:"mediumslateblue"},{value:"#6A5ACD",css:!0,name:"slateblue"},{value:"#836FFF",name:"slateblue 1"},{value:"#7A67EE",name:"slateblue 2"},{value:"#6959CD",name:"slateblue 3"},{value:"#473C8B",name:"slateblue 4"},{value:"#F8F8FF",css:!0,name:"ghostwhite"},{value:"#E6E6FA",css:!0,name:"lavender"},{value:"#0000FF",vga:!0,css:!0,name:"blue"},{value:"#0000EE",name:"blue 2"},{value:"#0000CD",name:"blue 3"},{value:"#0000CD",css:!0,name:"mediumblue"},{value:"#00008B",name:"blue 4"},{value:"#00008B",css:!0,name:"darkblue"},{value:"#000080",vga:!0,css:!0,name:"navy"},{value:"#191970",css:!0,name:"midnightblue"},{value:"#3D59AB",name:"cobalt"},{value:"#4169E1",css:!0,name:"royalblue"},{value:"#4876FF",name:"royalblue 1"},{value:"#436EEE",name:"royalblue 2"},{value:"#3A5FCD",name:"royalblue 3"},{value:"#27408B",name:"royalblue 4"},{value:"#6495ED",css:!0,name:"cornflowerblue"},{value:"#B0C4DE",css:!0,name:"lightsteelblue"},{value:"#CAE1FF",name:"lightsteelblue 1"},{value:"#BCD2EE",name:"lightsteelblue 2"},{value:"#A2B5CD",name:"lightsteelblue 3"},{value:"#6E7B8B",name:"lightsteelblue 4"},{value:"#778899",css:!0,name:"lightslategray"},{value:"#708090",css:!0,name:"slategray"},{value:"#C6E2FF",name:"slategray 1"},{value:"#B9D3EE",name:"slategray 2"},{value:"#9FB6CD",name:"slategray 3"},{value:"#6C7B8B",name:"slategray 4"},{value:"#1E90FF",name:"dodgerblue 1"},{value:"#1E90FF",css:!0,name:"dodgerblue"},{value:"#1C86EE",name:"dodgerblue 2"},{value:"#1874CD",name:"dodgerblue 3"},{value:"#104E8B",name:"dodgerblue 4"},{value:"#F0F8FF",css:!0,name:"aliceblue"},{value:"#4682B4",css:!0,name:"steelblue"},{value:"#63B8FF",name:"steelblue 1"},{value:"#5CACEE",name:"steelblue 2"},{value:"#4F94CD",name:"steelblue 3"},{value:"#36648B",name:"steelblue 4"},{value:"#87CEFA",css:!0,name:"lightskyblue"},{value:"#B0E2FF",name:"lightskyblue 1"},{value:"#A4D3EE",name:"lightskyblue 2"},{value:"#8DB6CD",name:"lightskyblue 3"},{value:"#607B8B",name:"lightskyblue 4"},{value:"#87CEFF",name:"skyblue 1"},{value:"#7EC0EE",name:"skyblue 2"},{value:"#6CA6CD",name:"skyblue 3"},{value:"#4A708B",name:"skyblue 4"},{value:"#87CEEB",css:!0,name:"skyblue"},{value:"#00BFFF",name:"deepskyblue 1"},{value:"#00BFFF",css:!0,name:"deepskyblue"},{value:"#00B2EE",name:"deepskyblue 2"},{value:"#009ACD",name:"deepskyblue 3"},{value:"#00688B",name:"deepskyblue 4"},{value:"#33A1C9",name:"peacock"},{value:"#ADD8E6",css:!0,name:"lightblue"},{value:"#BFEFFF",name:"lightblue 1"},{value:"#B2DFEE",name:"lightblue 2"},{value:"#9AC0CD",name:"lightblue 3"},{value:"#68838B",name:"lightblue 4"},{value:"#B0E0E6",css:!0,name:"powderblue"},{value:"#98F5FF",name:"cadetblue 1"},{value:"#8EE5EE",name:"cadetblue 2"},{value:"#7AC5CD",name:"cadetblue 3"},{value:"#53868B",name:"cadetblue 4"},{value:"#00F5FF",name:"turquoise 1"},{value:"#00E5EE",name:"turquoise 2"},{value:"#00C5CD",name:"turquoise 3"},{value:"#00868B",name:"turquoise 4"},{value:"#5F9EA0",css:!0,name:"cadetblue"},{value:"#00CED1",css:!0,name:"darkturquoise"},{value:"#F0FFFF",name:"azure 1"},{value:"#F0FFFF",css:!0,name:"azure"},{value:"#E0EEEE",name:"azure 2"},{value:"#C1CDCD",name:"azure 3"},{value:"#838B8B",name:"azure 4"},{value:"#E0FFFF",name:"lightcyan 1"},{value:"#E0FFFF",css:!0,name:"lightcyan"},{value:"#D1EEEE",name:"lightcyan 2"},{value:"#B4CDCD",name:"lightcyan 3"},{value:"#7A8B8B",name:"lightcyan 4"},{value:"#BBFFFF",name:"paleturquoise 1"},{value:"#AEEEEE",name:"paleturquoise 2"},{value:"#AEEEEE",css:!0,name:"paleturquoise"},{value:"#96CDCD",name:"paleturquoise 3"},{value:"#668B8B",name:"paleturquoise 4"},{value:"#2F4F4F",css:!0,name:"darkslategray"},{value:"#97FFFF",name:"darkslategray 1"},{value:"#8DEEEE",name:"darkslategray 2"},{value:"#79CDCD",name:"darkslategray 3"},{value:"#528B8B",name:"darkslategray 4"},{value:"#00FFFF",name:"cyan"},{value:"#00FFFF",css:!0,name:"aqua"},{value:"#00EEEE",name:"cyan 2"},{value:"#00CDCD",name:"cyan 3"},{value:"#008B8B",name:"cyan 4"},{value:"#008B8B",css:!0,name:"darkcyan"},{value:"#008080",vga:!0,css:!0,name:"teal"},{value:"#48D1CC",css:!0,name:"mediumturquoise"},{value:"#20B2AA",css:!0,name:"lightseagreen"},{value:"#03A89E",name:"manganeseblue"},{value:"#40E0D0",css:!0,name:"turquoise"},{value:"#808A87",name:"coldgrey"},{value:"#00C78C",name:"turquoiseblue"},{value:"#7FFFD4",name:"aquamarine 1"},{value:"#7FFFD4",css:!0,name:"aquamarine"},{value:"#76EEC6",name:"aquamarine 2"},{value:"#66CDAA",name:"aquamarine 3"},{value:"#66CDAA",css:!0,name:"mediumaquamarine"},{value:"#458B74",name:"aquamarine 4"},{value:"#00FA9A",css:!0,name:"mediumspringgreen"},{value:"#F5FFFA",css:!0,name:"mintcream"},{value:"#00FF7F",css:!0,name:"springgreen"},{value:"#00EE76",name:"springgreen 1"},{value:"#00CD66",name:"springgreen 2"},{value:"#008B45",name:"springgreen 3"},{value:"#3CB371",css:!0,name:"mediumseagreen"},{value:"#54FF9F",name:"seagreen 1"},{value:"#4EEE94",name:"seagreen 2"},{value:"#43CD80",name:"seagreen 3"},{value:"#2E8B57",name:"seagreen 4"},{value:"#2E8B57",css:!0,name:"seagreen"},{value:"#00C957",name:"emeraldgreen"},{value:"#BDFCC9",name:"mint"},{value:"#3D9140",name:"cobaltgreen"},{value:"#F0FFF0",name:"honeydew 1"},{value:"#F0FFF0",css:!0,name:"honeydew"},{value:"#E0EEE0",name:"honeydew 2"},{value:"#C1CDC1",name:"honeydew 3"},{value:"#838B83",name:"honeydew 4"},{value:"#8FBC8F",css:!0,name:"darkseagreen"},{value:"#C1FFC1",name:"darkseagreen 1"},{value:"#B4EEB4",name:"darkseagreen 2"},{value:"#9BCD9B",name:"darkseagreen 3"},{value:"#698B69",name:"darkseagreen 4"},{value:"#98FB98",css:!0,name:"palegreen"},{value:"#9AFF9A",name:"palegreen 1"},{value:"#90EE90",name:"palegreen 2"},{value:"#90EE90",css:!0,name:"lightgreen"},{value:"#7CCD7C",name:"palegreen 3"},{value:"#548B54",name:"palegreen 4"},{value:"#32CD32",css:!0,name:"limegreen"},{value:"#228B22",css:!0,name:"forestgreen"},{value:"#00FF00",vga:!0,name:"green 1"},{value:"#00FF00",vga:!0,css:!0,name:"lime"},{value:"#00EE00",name:"green 2"},{value:"#00CD00",name:"green 3"},{value:"#008B00",name:"green 4"},{value:"#008000",vga:!0,css:!0,name:"green"},{value:"#006400",css:!0,name:"darkgreen"},{value:"#308014",name:"sapgreen"},{value:"#7CFC00",css:!0,name:"lawngreen"},{value:"#7FFF00",name:"chartreuse 1"},{value:"#7FFF00",css:!0,name:"chartreuse"},{value:"#76EE00",name:"chartreuse 2"},{value:"#66CD00",name:"chartreuse 3"},{value:"#458B00",name:"chartreuse 4"},{value:"#ADFF2F",css:!0,name:"greenyellow"},{value:"#CAFF70",name:"darkolivegreen 1"},{value:"#BCEE68",name:"darkolivegreen 2"},{value:"#A2CD5A",name:"darkolivegreen 3"},{value:"#6E8B3D",name:"darkolivegreen 4"},{value:"#556B2F",css:!0,name:"darkolivegreen"},{value:"#6B8E23",css:!0,name:"olivedrab"},{value:"#C0FF3E",name:"olivedrab 1"},{value:"#B3EE3A",name:"olivedrab 2"},{value:"#9ACD32",name:"olivedrab 3"},{value:"#9ACD32",css:!0,name:"yellowgreen"},{value:"#698B22",name:"olivedrab 4"},{value:"#FFFFF0",name:"ivory 1"},{value:"#FFFFF0",css:!0,name:"ivory"},{value:"#EEEEE0",name:"ivory 2"},{value:"#CDCDC1",name:"ivory 3"},{value:"#8B8B83",name:"ivory 4"},{value:"#F5F5DC",css:!0,name:"beige"},{value:"#FFFFE0",name:"lightyellow 1"},{value:"#FFFFE0",css:!0,name:"lightyellow"},{value:"#EEEED1",name:"lightyellow 2"},{value:"#CDCDB4",name:"lightyellow 3"},{value:"#8B8B7A",name:"lightyellow 4"},{value:"#FAFAD2",css:!0,name:"lightgoldenrodyellow"},{value:"#FFFF00",vga:!0,name:"yellow 1"},{value:"#FFFF00",vga:!0,css:!0,name:"yellow"},{value:"#EEEE00",name:"yellow 2"},{value:"#CDCD00",name:"yellow 3"},{value:"#8B8B00",name:"yellow 4"},{value:"#808069",name:"warmgrey"},{value:"#808000",vga:!0,css:!0,name:"olive"},{value:"#BDB76B",css:!0,name:"darkkhaki"},{value:"#FFF68F",name:"khaki 1"},{value:"#EEE685",name:"khaki 2"},{value:"#CDC673",name:"khaki 3"},{value:"#8B864E",name:"khaki 4"},{value:"#F0E68C",css:!0,name:"khaki"},{value:"#EEE8AA",css:!0,name:"palegoldenrod"},{value:"#FFFACD",name:"lemonchiffon 1"},{value:"#FFFACD",css:!0,name:"lemonchiffon"},{value:"#EEE9BF",name:"lemonchiffon 2"},{value:"#CDC9A5",name:"lemonchiffon 3"},{value:"#8B8970",name:"lemonchiffon 4"},{value:"#FFEC8B",name:"lightgoldenrod 1"},{value:"#EEDC82",name:"lightgoldenrod 2"},{value:"#CDBE70",name:"lightgoldenrod 3"},{value:"#8B814C",name:"lightgoldenrod 4"},{value:"#E3CF57",name:"banana"},{value:"#FFD700",name:"gold 1"},{value:"#FFD700",css:!0,name:"gold"},{value:"#EEC900",name:"gold 2"},{value:"#CDAD00",name:"gold 3"},{value:"#8B7500",name:"gold 4"},{value:"#FFF8DC",name:"cornsilk 1"},{value:"#FFF8DC",css:!0,name:"cornsilk"},{value:"#EEE8CD",name:"cornsilk 2"},{value:"#CDC8B1",name:"cornsilk 3"},{value:"#8B8878",name:"cornsilk 4"},{value:"#DAA520",css:!0,name:"goldenrod"},{value:"#FFC125",name:"goldenrod 1"},{value:"#EEB422",name:"goldenrod 2"},{value:"#CD9B1D",name:"goldenrod 3"},{value:"#8B6914",name:"goldenrod 4"},{value:"#B8860B",css:!0,name:"darkgoldenrod"},{value:"#FFB90F",name:"darkgoldenrod 1"},{value:"#EEAD0E",name:"darkgoldenrod 2"},{value:"#CD950C",name:"darkgoldenrod 3"},{value:"#8B6508",name:"darkgoldenrod 4"},{value:"#FFA500",name:"orange 1"},{value:"#FF8000",css:!0,name:"orange"},{value:"#EE9A00",name:"orange 2"},{value:"#CD8500",name:"orange 3"},{value:"#8B5A00",name:"orange 4"},{value:"#FFFAF0",css:!0,name:"floralwhite"},{value:"#FDF5E6",css:!0,name:"oldlace"},{value:"#F5DEB3",css:!0,name:"wheat"},{value:"#FFE7BA",name:"wheat 1"},{value:"#EED8AE",name:"wheat 2"},{value:"#CDBA96",name:"wheat 3"},{value:"#8B7E66",name:"wheat 4"},{value:"#FFE4B5",css:!0,name:"moccasin"},{value:"#FFEFD5",css:!0,name:"papayawhip"},{value:"#FFEBCD",css:!0,name:"blanchedalmond"},{value:"#FFDEAD",name:"navajowhite 1"},{value:"#FFDEAD",css:!0,name:"navajowhite"},{value:"#EECFA1",name:"navajowhite 2"},{value:"#CDB38B",name:"navajowhite 3"},{value:"#8B795E",name:"navajowhite 4"},{value:"#FCE6C9",name:"eggshell"},{value:"#D2B48C",css:!0,name:"tan"},{value:"#9C661F",name:"brick"},{value:"#FF9912",name:"cadmiumyellow"},{value:"#FAEBD7",css:!0,name:"antiquewhite"},{value:"#FFEFDB",name:"antiquewhite 1"},{value:"#EEDFCC",name:"antiquewhite 2"},{value:"#CDC0B0",name:"antiquewhite 3"},{value:"#8B8378",name:"antiquewhite 4"},{value:"#DEB887",css:!0,name:"burlywood"},{value:"#FFD39B",name:"burlywood 1"},{value:"#EEC591",name:"burlywood 2"},{value:"#CDAA7D",name:"burlywood 3"},{value:"#8B7355",name:"burlywood 4"},{value:"#FFE4C4",name:"bisque 1"},{value:"#FFE4C4",css:!0,name:"bisque"},{value:"#EED5B7",name:"bisque 2"},{value:"#CDB79E",name:"bisque 3"},{value:"#8B7D6B",name:"bisque 4"},{value:"#E3A869",name:"melon"},{value:"#ED9121",name:"carrot"},{value:"#FF8C00",css:!0,name:"darkorange"},{value:"#FF7F00",name:"darkorange 1"},{value:"#EE7600",name:"darkorange 2"},{value:"#CD6600",name:"darkorange 3"},{value:"#8B4500",name:"darkorange 4"},{value:"#FFA54F",name:"tan 1"},{value:"#EE9A49",name:"tan 2"},{value:"#CD853F",name:"tan 3"},{value:"#CD853F",css:!0,name:"peru"},{value:"#8B5A2B",name:"tan 4"},{value:"#FAF0E6",css:!0,name:"linen"},{value:"#FFDAB9",name:"peachpuff 1"},{value:"#FFDAB9",css:!0,name:"peachpuff"},{value:"#EECBAD",name:"peachpuff 2"},{value:"#CDAF95",name:"peachpuff 3"},{value:"#8B7765",name:"peachpuff 4"},{value:"#FFF5EE",name:"seashell 1"},{value:"#FFF5EE",css:!0,name:"seashell"},{value:"#EEE5DE",name:"seashell 2"},{value:"#CDC5BF",name:"seashell 3"},{value:"#8B8682",name:"seashell 4"},{value:"#F4A460",css:!0,name:"sandybrown"},{value:"#C76114",name:"rawsienna"},{value:"#D2691E",css:!0,name:"chocolate"},{value:"#FF7F24",name:"chocolate 1"},{value:"#EE7621",name:"chocolate 2"},{value:"#CD661D",name:"chocolate 3"},{value:"#8B4513",name:"chocolate 4"},{value:"#8B4513",css:!0,name:"saddlebrown"},{value:"#292421",name:"ivoryblack"},{value:"#FF7D40",name:"flesh"},{value:"#FF6103",name:"cadmiumorange"},{value:"#8A360F",name:"burntsienna"},{value:"#A0522D",css:!0,name:"sienna"},{value:"#FF8247",name:"sienna 1"},{value:"#EE7942",name:"sienna 2"},{value:"#CD6839",name:"sienna 3"},{value:"#8B4726",name:"sienna 4"},{value:"#FFA07A",name:"lightsalmon 1"},{value:"#FFA07A",css:!0,name:"lightsalmon"},{value:"#EE9572",name:"lightsalmon 2"},{value:"#CD8162",name:"lightsalmon 3"},{value:"#8B5742",name:"lightsalmon 4"},{value:"#FF7F50",css:!0,name:"coral"},{value:"#FF4500",name:"orangered 1"},{value:"#FF4500",css:!0,name:"orangered"},{value:"#EE4000",name:"orangered 2"},{value:"#CD3700",name:"orangered 3"},{value:"#8B2500",name:"orangered 4"},{value:"#5E2612",name:"sepia"},{value:"#E9967A",css:!0,name:"darksalmon"},{value:"#FF8C69",name:"salmon 1"},{value:"#EE8262",name:"salmon 2"},{value:"#CD7054",name:"salmon 3"},{value:"#8B4C39",name:"salmon 4"},{value:"#FF7256",name:"coral 1"},{value:"#EE6A50",name:"coral 2"},{value:"#CD5B45",name:"coral 3"},{value:"#8B3E2F",name:"coral 4"},{value:"#8A3324",name:"burntumber"},{value:"#FF6347",name:"tomato 1"},{value:"#FF6347",css:!0,name:"tomato"},{value:"#EE5C42",name:"tomato 2"},{value:"#CD4F39",name:"tomato 3"},{value:"#8B3626",name:"tomato 4"},{value:"#FA8072",css:!0,name:"salmon"},{value:"#FFE4E1",name:"mistyrose 1"},{value:"#FFE4E1",css:!0,name:"mistyrose"},{value:"#EED5D2",name:"mistyrose 2"},{value:"#CDB7B5",name:"mistyrose 3"},{value:"#8B7D7B",name:"mistyrose 4"},{value:"#FFFAFA",name:"snow 1"},{value:"#FFFAFA",css:!0,name:"snow"},{value:"#EEE9E9",name:"snow 2"},{value:"#CDC9C9",name:"snow 3"},{value:"#8B8989",name:"snow 4"},{value:"#BC8F8F",css:!0,name:"rosybrown"},{value:"#FFC1C1",name:"rosybrown 1"},{value:"#EEB4B4",name:"rosybrown 2"},{value:"#CD9B9B",name:"rosybrown 3"},{value:"#8B6969",name:"rosybrown 4"},{value:"#F08080",css:!0,name:"lightcoral"},{value:"#CD5C5C",css:!0,name:"indianred"},{value:"#FF6A6A",name:"indianred 1"},{value:"#EE6363",name:"indianred 2"},{value:"#8B3A3A",name:"indianred 4"},{value:"#CD5555",name:"indianred 3"},{value:"#A52A2A",css:!0,name:"brown"},{value:"#FF4040",name:"brown 1"},{value:"#EE3B3B",name:"brown 2"},{value:"#CD3333",name:"brown 3"},{value:"#8B2323",name:"brown 4"},{value:"#B22222",css:!0,name:"firebrick"},{value:"#FF3030",name:"firebrick 1"},{value:"#EE2C2C",name:"firebrick 2"},{value:"#CD2626",name:"firebrick 3"},{value:"#8B1A1A",name:"firebrick 4"},{value:"#FF0000",vga:!0,name:"red 1"},{value:"#FF0000",vga:!0,css:!0,name:"red"},{value:"#EE0000",name:"red 2"},{value:"#CD0000",name:"red 3"},{value:"#8B0000",name:"red 4"},{value:"#8B0000",css:!0,name:"darkred"},{value:"#800000",vga:!0,css:!0,name:"maroon"},{value:"#8E388E",name:"sgi beet"},{value:"#7171C6",name:"sgi slateblue"},{value:"#7D9EC0",name:"sgi lightblue"},{value:"#388E8E",name:"sgi teal"},{value:"#71C671",name:"sgi chartreuse"},{value:"#8E8E38",name:"sgi olivedrab"},{value:"#C5C1AA",name:"sgi brightgray"},{value:"#C67171",name:"sgi salmon"},{value:"#555555",name:"sgi darkgray"},{value:"#1E1E1E",name:"sgi gray 12"},{value:"#282828",name:"sgi gray 16"},{value:"#515151",name:"sgi gray 32"},{value:"#5B5B5B",name:"sgi gray 36"},{value:"#848484",name:"sgi gray 52"},{value:"#8E8E8E",name:"sgi gray 56"},{value:"#AAAAAA",name:"sgi lightgray"},{value:"#B7B7B7",name:"sgi gray 72"},{value:"#C1C1C1",name:"sgi gray 76"},{value:"#EAEAEA",name:"sgi gray 92"},{value:"#F4F4F4",name:"sgi gray 96"},{value:"#FFFFFF",vga:!0,css:!0,name:"white"},{value:"#F5F5F5",name:"white smoke"},{value:"#F5F5F5",name:"gray 96"},{value:"#DCDCDC",css:!0,name:"gainsboro"},{value:"#D3D3D3",css:!0,name:"lightgrey"},{value:"#C0C0C0",vga:!0,css:!0,name:"silver"},{value:"#A9A9A9",css:!0,name:"darkgray"},{value:"#808080",vga:!0,css:!0,name:"gray"},{value:"#696969",css:!0,name:"dimgray"},{value:"#696969",name:"gray 42"},{value:"#000000",vga:!0,css:!0,name:"black"},{value:"#FCFCFC",name:"gray 99"},{value:"#FAFAFA",name:"gray 98"},{value:"#F7F7F7",name:"gray 97"},{value:"#F2F2F2",name:"gray 95"},{value:"#F0F0F0",name:"gray 94"},{value:"#EDEDED",name:"gray 93"},{value:"#EBEBEB",name:"gray 92"},{value:"#E8E8E8",name:"gray 91"},{value:"#E5E5E5",name:"gray 90"},{value:"#E3E3E3",name:"gray 89"},{value:"#E0E0E0",name:"gray 88"},{value:"#DEDEDE",name:"gray 87"},{value:"#DBDBDB",name:"gray 86"},{value:"#D9D9D9",name:"gray 85"},{value:"#D6D6D6",name:"gray 84"},{value:"#D4D4D4",name:"gray 83"},{value:"#D1D1D1",name:"gray 82"},{value:"#CFCFCF",name:"gray 81"},{value:"#CCCCCC",name:"gray 80"},{value:"#C9C9C9",name:"gray 79"},{value:"#C7C7C7",name:"gray 78"},{value:"#C4C4C4",name:"gray 77"},{value:"#C2C2C2",name:"gray 76"},{value:"#BFBFBF",name:"gray 75"},{value:"#BDBDBD",name:"gray 74"},{value:"#BABABA",name:"gray 73"},{value:"#B8B8B8",name:"gray 72"},{value:"#B5B5B5",name:"gray 71"},{value:"#B3B3B3",name:"gray 70"},{value:"#B0B0B0",name:"gray 69"},{value:"#ADADAD",name:"gray 68"},{value:"#ABABAB",name:"gray 67"},{value:"#A8A8A8",name:"gray 66"},{value:"#A6A6A6",name:"gray 65"},{value:"#A3A3A3",name:"gray 64"},{value:"#A1A1A1",name:"gray 63"},{value:"#9E9E9E",name:"gray 62"},{value:"#9C9C9C",name:"gray 61"},{value:"#999999",name:"gray 60"},{value:"#969696",name:"gray 59"},{value:"#949494",name:"gray 58"},{value:"#919191",name:"gray 57"},{value:"#8F8F8F",name:"gray 56"},{value:"#8C8C8C",name:"gray 55"},{value:"#8A8A8A",name:"gray 54"},{value:"#878787",name:"gray 53"},{value:"#858585",name:"gray 52"},{value:"#828282",name:"gray 51"},{value:"#7F7F7F",name:"gray 50"},{value:"#7D7D7D",name:"gray 49"},{value:"#7A7A7A",name:"gray 48"},{value:"#787878",name:"gray 47"},{value:"#757575",name:"gray 46"},{value:"#737373",name:"gray 45"},{value:"#707070",name:"gray 44"},{value:"#6E6E6E",name:"gray 43"},{value:"#666666",name:"gray 40"},{value:"#636363",name:"gray 39"},{value:"#616161",name:"gray 38"},{value:"#5E5E5E",name:"gray 37"},{value:"#5C5C5C",name:"gray 36"},{value:"#595959",name:"gray 35"},{value:"#575757",name:"gray 34"},{value:"#545454",name:"gray 33"},{value:"#525252",name:"gray 32"},{value:"#4F4F4F",name:"gray 31"},{value:"#4D4D4D",name:"gray 30"},{value:"#4A4A4A",name:"gray 29"},{value:"#474747",name:"gray 28"},{value:"#454545",name:"gray 27"},{value:"#424242",name:"gray 26"},{value:"#404040",name:"gray 25"},{value:"#3D3D3D",name:"gray 24"},{value:"#3B3B3B",name:"gray 23"},{value:"#383838",name:"gray 22"},{value:"#363636",name:"gray 21"},{value:"#333333",name:"gray 20"},{value:"#303030",name:"gray 19"},{value:"#2E2E2E",name:"gray 18"},{value:"#2B2B2B",name:"gray 17"},{value:"#292929",name:"gray 16"},{value:"#262626",name:"gray 15"},{value:"#242424",name:"gray 14"},{value:"#212121",name:"gray 13"},{value:"#1F1F1F",name:"gray 12"},{value:"#1C1C1C",name:"gray 11"},{value:"#1A1A1A",name:"gray 10"},{value:"#171717",name:"gray 9"},{value:"#141414",name:"gray 8"},{value:"#121212",name:"gray 7"},{value:"#0F0F0F",name:"gray 6"},{value:"#0D0D0D",name:"gray 5"},{value:"#0A0A0A",name:"gray 4"},{value:"#080808",name:"gray 3"},{value:"#050505",name:"gray 2"},{value:"#030303",name:"gray 1"},{value:"#F5F5F5",css:!0,name:"whitesmoke"}];(function(e){var t=mi,n=t.filter(function(s){return!!s.css}),i=t.filter(function(s){return!!s.vga});e.exports=function(s){var o=e.exports.get(s);return o&&o.value},e.exports.get=function(s){return s=s||"",s=s.trim().toLowerCase(),t.filter(function(o){return o.name.toLowerCase()===s}).pop()},e.exports.all=e.exports.get.all=function(){return t},e.exports.get.css=function(s){return s?(s=s||"",s=s.trim().toLowerCase(),n.filter(function(o){return o.name.toLowerCase()===s}).pop()):n},e.exports.get.vga=function(s){return s?(s=s||"",s=s.trim().toLowerCase(),i.filter(function(o){return o.name.toLowerCase()===s}).pop()):i}})(jt);var hi=jt.exports,pi=1/0,gi="[object Symbol]",vi=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,Pt="\\ud800-\\udfff",yi="\\u0300-\\u036f\\ufe20-\\ufe23",bi="\\u20d0-\\u20f0",Nt="\\u2700-\\u27bf",$t="a-z\\xdf-\\xf6\\xf8-\\xff",Ei="\\xac\\xb1\\xd7\\xf7",xi="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",Ci="\\u2000-\\u206f",Fi=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",Ut="A-Z\\xc0-\\xd6\\xd8-\\xde",Ii="\\ufe0e\\ufe0f",Yt=Ei+xi+Ci+Fi,zt="['â€™]",qe="["+Yt+"]",Ai="["+yi+bi+"]",Gt="\\d+",Di="["+Nt+"]",Ht="["+$t+"]",qt="[^"+Pt+Yt+Gt+Nt+$t+Ut+"]",Ti="\\ud83c[\\udffb-\\udfff]",Si="(?:"+Ai+"|"+Ti+")",_i="[^"+Pt+"]",Vt="(?:\\ud83c[\\udde6-\\uddff]){2}",Xt="[\\ud800-\\udbff][\\udc00-\\udfff]",G="["+Ut+"]",Mi="\\u200d",Ve="(?:"+Ht+"|"+qt+")",ki="(?:"+G+"|"+qt+")",Xe="(?:"+zt+"(?:d|ll|m|re|s|t|ve))?",We="(?:"+zt+"(?:D|LL|M|RE|S|T|VE))?",Wt=Si+"?",Kt="["+Ii+"]?",Bi="(?:"+Mi+"(?:"+[_i,Vt,Xt].join("|")+")"+Kt+Wt+")*",wi=Kt+Wt+Bi,Li="(?:"+[Di,Vt,Xt].join("|")+")"+wi,Ri=RegExp([G+"?"+Ht+"+"+Xe+"(?="+[qe,G,"$"].join("|")+")",ki+"+"+We+"(?="+[qe,G+Ve,"$"].join("|")+")",G+"?"+Ve+"+"+Xe,G+"+"+We,Gt,Li].join("|"),"g"),Oi=/[a-z][A-Z]|[A-Z]{2,}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,ji=typeof B=="object"&&B&&B.Object===Object&&B,Pi=typeof self=="object"&&self&&self.Object===Object&&self,Ni=ji||Pi||Function("return this")();function $i(e){return e.match(vi)||[]}function Ui(e){return Oi.test(e)}function Yi(e){return e.match(Ri)||[]}var zi=Object.prototype,Gi=zi.toString,Ke=Ni.Symbol,Ze=Ke?Ke.prototype:void 0,Je=Ze?Ze.toString:void 0;function Hi(e){if(typeof e=="string")return e;if(Vi(e))return Je?Je.call(e):"";var t=e+"";return t=="0"&&1/e==-pi?"-0":t}function qi(e){return!!e&&typeof e=="object"}function Vi(e){return typeof e=="symbol"||qi(e)&&Gi.call(e)==gi}function Xi(e){return e==null?"":Hi(e)}function Wi(e,t,n){return e=Xi(e),t=n?void 0:t,t===void 0?Ui(e)?Yi(e):$i(e):e.match(t)||[]}var Ki=Wi,Zi=1/0,Ji="[object Symbol]",Qi=/^\s+/,je="\\ud800-\\udfff",Zt="\\u0300-\\u036f\\ufe20-\\ufe23",Jt="\\u20d0-\\u20f0",Qt="\\ufe0e\\ufe0f",es="["+je+"]",Ee="["+Zt+Jt+"]",xe="\\ud83c[\\udffb-\\udfff]",ts="(?:"+Ee+"|"+xe+")",en="[^"+je+"]",tn="(?:\\ud83c[\\udde6-\\uddff]){2}",nn="[\\ud800-\\udbff][\\udc00-\\udfff]",sn="\\u200d",an=ts+"?",on="["+Qt+"]?",ns="(?:"+sn+"(?:"+[en,tn,nn].join("|")+")"+on+an+")*",is=on+an+ns,ss="(?:"+[en+Ee+"?",Ee,tn,nn,es].join("|")+")",as=RegExp(xe+"(?="+xe+")|"+ss+is,"g"),os=RegExp("["+sn+je+Zt+Jt+Qt+"]"),rs=typeof B=="object"&&B&&B.Object===Object&&B,cs=typeof self=="object"&&self&&self.Object===Object&&self,ls=rs||cs||Function("return this")();function us(e){return e.split("")}function ds(e,t,n,i){for(var s=e.length,o=n+-1;++o<s;)if(t(e[o],o,e))return o;return-1}function fs(e,t,n){if(t!==t)return ds(e,ms,n);for(var i=n-1,s=e.length;++i<s;)if(e[i]===t)return i;return-1}function ms(e){return e!==e}function hs(e,t){for(var n=-1,i=e.length;++n<i&&fs(t,e[n],0)>-1;);return n}function ps(e){return os.test(e)}function Qe(e){return ps(e)?gs(e):us(e)}function gs(e){return e.match(as)||[]}var vs=Object.prototype,ys=vs.toString,et=ls.Symbol,tt=et?et.prototype:void 0,nt=tt?tt.toString:void 0;function bs(e,t,n){var i=-1,s=e.length;t<0&&(t=-t>s?0:s+t),n=n>s?s:n,n<0&&(n+=s),s=t>n?0:n-t>>>0,t>>>=0;for(var o=Array(s);++i<s;)o[i]=e[i+t];return o}function rn(e){if(typeof e=="string")return e;if(Cs(e))return nt?nt.call(e):"";var t=e+"";return t=="0"&&1/e==-Zi?"-0":t}function Es(e,t,n){var i=e.length;return n=n===void 0?i:n,!t&&n>=i?e:bs(e,t,n)}function xs(e){return!!e&&typeof e=="object"}function Cs(e){return typeof e=="symbol"||xs(e)&&ys.call(e)==Ji}function Fs(e){return e==null?"":rn(e)}function Is(e,t,n){if(e=Fs(e),e&&(n||t===void 0))return e.replace(Qi,"");if(!e||!(t=rn(t)))return e;var i=Qe(e),s=hs(i,Qe(t));return Es(i,s).join("")}var As=Is,Ce=1/0,Ds=9007199254740991,Ts=17976931348623157e292,it=NaN,Ss="[object Symbol]",_s=/^\s+|\s+$/g,Ms=/^[-+]0x[0-9a-f]+$/i,ks=/^0b[01]+$/i,Bs=/^0o[0-7]+$/i,Pe="\\ud800-\\udfff",cn="\\u0300-\\u036f\\ufe20-\\ufe23",ln="\\u20d0-\\u20f0",un="\\ufe0e\\ufe0f",ws="["+Pe+"]",Fe="["+cn+ln+"]",Ie="\\ud83c[\\udffb-\\udfff]",Ls="(?:"+Fe+"|"+Ie+")",dn="[^"+Pe+"]",fn="(?:\\ud83c[\\udde6-\\uddff]){2}",mn="[\\ud800-\\udbff][\\udc00-\\udfff]",hn="\\u200d",pn=Ls+"?",gn="["+un+"]?",Rs="(?:"+hn+"(?:"+[dn,fn,mn].join("|")+")"+gn+pn+")*",Os=gn+pn+Rs,js="(?:"+[dn+Fe+"?",Fe,fn,mn,ws].join("|")+")",Ae=RegExp(Ie+"(?="+Ie+")|"+js+Os,"g"),Ps=RegExp("["+hn+Pe+cn+ln+un+"]"),Ns=parseInt,$s=typeof B=="object"&&B&&B.Object===Object&&B,Us=typeof self=="object"&&self&&self.Object===Object&&self,Ys=$s||Us||Function("return this")(),zs=Hs("length");function Gs(e){return e.split("")}function Hs(e){return function(t){return t==null?void 0:t[e]}}function Ne(e){return Ps.test(e)}function vn(e){return Ne(e)?Vs(e):zs(e)}function qs(e){return Ne(e)?Xs(e):Gs(e)}function Vs(e){for(var t=Ae.lastIndex=0;Ae.test(e);)t++;return t}function Xs(e){return e.match(Ae)||[]}var Ws=Object.prototype,Ks=Ws.toString,st=Ys.Symbol,Zs=Math.ceil,Js=Math.floor,at=st?st.prototype:void 0,ot=at?at.toString:void 0;function rt(e,t){var n="";if(!e||t<1||t>Ds)return n;do t%2&&(n+=e),t=Js(t/2),t&&(e+=e);while(t);return n}function Qs(e,t,n){var i=-1,s=e.length;t<0&&(t=-t>s?0:s+t),n=n>s?s:n,n<0&&(n+=s),s=t>n?0:n-t>>>0,t>>>=0;for(var o=Array(s);++i<s;)o[i]=e[i+t];return o}function yn(e){if(typeof e=="string")return e;if(bn(e))return ot?ot.call(e):"";var t=e+"";return t=="0"&&1/e==-Ce?"-0":t}function ea(e,t,n){var i=e.length;return n=n===void 0?i:n,!t&&n>=i?e:Qs(e,t,n)}function ta(e,t){t=t===void 0?" ":yn(t);var n=t.length;if(n<2)return n?rt(t,e):t;var i=rt(t,Zs(e/vn(t)));return Ne(t)?ea(qs(i),0,e).join(""):i.slice(0,e)}function ct(e){var t=typeof e;return!!e&&(t=="object"||t=="function")}function na(e){return!!e&&typeof e=="object"}function bn(e){return typeof e=="symbol"||na(e)&&Ks.call(e)==Ss}function ia(e){if(!e)return e===0?e:0;if(e=aa(e),e===Ce||e===-Ce){var t=e<0?-1:1;return t*Ts}return e===e?e:0}function sa(e){var t=ia(e),n=t%1;return t===t?n?t-n:t:0}function aa(e){if(typeof e=="number")return e;if(bn(e))return it;if(ct(e)){var t=typeof e.valueOf=="function"?e.valueOf():e;e=ct(t)?t+"":t}if(typeof e!="string")return e===0?e:+e;e=e.replace(_s,"");var n=ks.test(e);return n||Bs.test(e)?Ns(e.slice(2),n?2:8):Ms.test(e)?it:+e}function oa(e){return e==null?"":yn(e)}function ra(e,t,n){e=oa(e),t=sa(t);var i=t?vn(e):0;return t&&i<t?e+ta(t-i,n):e}var ca=ra,la=(e,t,n,i)=>{const s=(e+(i||"")).toString().includes("%");if(typeof e=="string"?[e,t,n,i]=e.match(/(0?\.?\d{1,3})%?\b/g).map(Number):i!==void 0&&(i=parseFloat(i)),typeof e!="number"||typeof t!="number"||typeof n!="number"||e>255||t>255||n>255)throw new TypeError("Expected three numbers below 256");if(typeof i=="number"){if(!s&&i>=0&&i<=1)i=Math.round(255*i);else if(s&&i>=0&&i<=100)i=Math.round(255*i/100);else throw new TypeError(`Expected alpha value (${i}) as a fraction or percentage`);i=(i|256).toString(16).slice(1)}else i="";return(n|t<<8|e<<16|1<<24).toString(16).slice(1)+i};const q="a-f\\d",ua=`#?[${q}]{3}[${q}]?`,da=`#?[${q}]{6}([${q}]{2})?`,fa=new RegExp(`[^#${q}]`,"gi"),ma=new RegExp(`^${ua}$|^${da}$`,"i");var ha=(e,t={})=>{if(typeof e!="string"||fa.test(e)||!ma.test(e))throw new TypeError("Expected a valid hex string");e=e.replace(/^#/,"");let n=1;e.length===8&&(n=Number.parseInt(e.slice(6,8),16)/255,e=e.slice(0,6)),e.length===4&&(n=Number.parseInt(e.slice(3,4).repeat(2),16)/255,e=e.slice(0,3)),e.length===3&&(e=e[0]+e[0]+e[1]+e[1]+e[2]+e[2]);const i=Number.parseInt(e,16),s=i>>16,o=i>>8&255,a=i&255,r=typeof t.alpha=="number"?t.alpha:n;if(t.format==="array")return[s,o,a,r];if(t.format==="css"){const c=r===1?"":` / ${Number((r*100).toFixed(2))}%`;return`rgb(${s} ${o} ${a}${c})`}return{red:s,green:o,blue:a,alpha:r}},pa=hi,ga=Ki,va=As,ya=ca,ba=la,En=ha;const fe=.75,me=.25,he=16777215,Ea=49979693;var xa=function(e){return"#"+Ia(String(JSON.stringify(e)))};function Ca(e){var t=ga(e),n=[];return t.forEach(function(i){var s=pa(i);s&&n.push(En(va(s,"#"),{format:"array"}))}),n}function Fa(e){var t=[0,0,0];return e.forEach(function(n){for(var i=0;i<3;i++)t[i]+=n[i]}),[t[0]/e.length,t[1]/e.length,t[2]/e.length]}function Ia(e){var t,n=Ca(e);n.length>0&&(t=Fa(n));var i=1,s=0,o=1;if(e.length>0)for(var a=0;a<e.length;a++)e[a].charCodeAt(0)>s&&(s=e[a].charCodeAt(0)),o=parseInt(he/s),i=(i+e[a].charCodeAt(0)*o*Ea)%he;var r=(i*e.length%he).toString(16);r=ya(r,6,r);var c=En(r,{format:"array"});return t?ba(me*c[0]+fe*t[0],me*c[1]+fe*t[1],me*c[2]+fe*t[2]):r}const Aa=Xn(xa);function Da(e){return[...Ta].sort(()=>Math.random()-Math.random()).slice(0,e)}const Ta=["Elloria","Velaris","Cairndor","Morthril","Silverkeep","Eaglebrook","Frostholm","Mournwind","Shadowfen","Sunspire","Tristfall","Winterhold","Duskendale","Ravenwood","Greenguard","Dragonfall","Stormwatch","Starhaven","Ironforge","Ironclad","Goldshire","Blacksand","Ashenvale","Whisperwind","Brightwater","Highrock","Stonegate","Thunderbluff","Dunewatch","Zephyrhills","Fallbrook","Lunarglade","Stormpeak","Cragmoor","Ridgewood","Mistvale","Eversong","Coldspring","Hawke's Hollow","Pinecrest","Thornfield","Emberfall","Stormholm","Myrkwater","Windstead","Feyberry","Duskmire","Elmshade","Stonemire","Willowdale","Grimmreach","Thundertop","Nighthaven","Sunfall","Ashenwood","Brightmire","Stoneridge","Ironoak","Mithrintor","Sablecross","Westwatch","Greendale","Dragonspire","Eagle's Perch","Stormhaven","Brightforge","Silverglade","Mournstone","Opalspire","Griffon's Roost","Sunshadow","Frostpeak","Thorncrest","Goldspire","Darkhollow","Eastgate","Wolf's Den","Shrouded Hollow","Brambleshire","Onyxbluff","Skystone","Cinderfall","Emberstone","Stormglen","Highfell","Silverbrook","Elmsreach","Lostbay","Gloomshade","Thundertree","Bywater","Nighthollow","Firefly Glen","Iceridge","Greenmont","Ashenshade","Winterfort","Duskhaven"];function xn(e){return[...Sa].sort(()=>Math.random()-Math.random()).slice(0,e)}const Sa=["Unittoria","Zaratopia","Novo Brasil","Industia","Chimerica","Ruslavia","Generistan","Eurasica","Pacifika","Afrigon","Arablend","Mexitana","Canadia","Germaine","Italica","Portugo","Francette","Iberica","Scotlund","Norgecia","Suedland","Fennia","Australis","Zealandia","Argentum","Chileon","Peruvio","Bolivar","Colombera","Venezuelaa","Arcticia","Antausia"];function _a(){const e=[[1,1],[-1,1],[1,-1],[-1,-1],[1,0],[-1,0],[0,1],[0,-1]],t=Array.from({length:256},(s,o)=>o).sort(()=>Math.random()-.5),n=[...t,...t];function i(s,o,a){return s[0]*o+s[1]*a}return function(o,a){const r=Math.floor(o)&255,c=Math.floor(a)&255;o-=Math.floor(o),a-=Math.floor(a);const u=o*o*o*(o*(o*6-15)+10),l=a*a*a*(a*(a*6-15)+10),d=n[r]+c,f=n[r+1]+c;return(1+(i(e[n[d]&7],o,a)*(1-u)+i(e[n[f]&7],o-1,a)*u)*(1-l)+(i(e[n[d+1]&7],o,a-1)*(1-u)+i(e[n[f+1]&7],o-1,a-1)*u)*l)/2}}function De(e,t,n,i,s){const o=_a(),a=Math.floor(e.x/x),r=Math.floor(e.y/x),c=Math.floor(i/4),u=.5,l=.005,d=.7;for(let h=r-c;h<=r+c;h++)for(let p=a-c;p<=a+c;p++)if(p>=0&&p<i&&h>=0&&h<s){let y=p,v=h;for(let I=0;I<t;I++)Math.random()<d&&(y+=Math.random()>.5?1:-1,v+=Math.random()>.5?1:-1);y=Math.max(0,Math.min(i-1,y)),v=Math.max(0,Math.min(s-1,v));const C=Math.sqrt((y-a)*(y-a)+(v-r)*(v-r))/c,b=o(p*l,h*l);if(C<1&&b>u+C*.01){const I=h*i+p;n[I].type=_.GROUND,n[I].depth=void 0,n[I].height=(1-C)*2*(b-u)}}const f=Math.min(Math.max(r*i+a,0),i);n[f].type=_.GROUND,n[f].depth=void 0,n[f].height=1}function Ma(e,t){return{x:Math.floor(Math.random()*(e*.8)+e*.1)*x,y:Math.floor(Math.random()*(t*.8)+t*.1)*x}}function ka(e,t,n,i){if(e.x<0||e.y<0||e.x>=n||e.y>=i)return!1;const s=Math.floor(n/(Math.sqrt(t.length+1)*2));return t.every(o=>Math.abs(e.x-o.x)>s||Math.abs(e.y-o.y)>s)}function Ba(e,t,n){return t.every(i=>Math.sqrt(Math.pow(e.x-i.position.x,2)+Math.pow(e.y-i.position.y,2))>=n)}function wa(e,t,n,i,s){const o=[],a=[],r=[],c=O*3,u=xn(e*2).filter(h=>h!==t),l=5,d=Da(e*l*2),f=[];for(let h=0;h<e;h++){const p=`state-${h+1}`,y=h===0?t:u.pop(),v=La(p,y,h===0);o.push(v),o.forEach(b=>{v.strategies[b.id]=g.NEUTRAL,b.strategies[p]=g.NEUTRAL});const C=Ra(f,n,i);f.push(C),De(C,n/2,s,n,i),Oa(p,C,l,d,a,r,c,s,n,i),v.population=a.filter(b=>b.stateId===p).reduce((b,I)=>b+I.population,0)}return ja(s,a),{states:o,cities:a,launchSites:r}}function La(e,t,n){return{id:e,name:t,color:Aa(t),isPlayerControlled:n,strategies:{},lastStrategyUpdate:0,generalStrategy:n?void 0:[g.NEUTRAL,g.HOSTILE,g.FRIENDLY].sort(()=>Math.random()-.5)[0],population:0,defenceLines:[],currentDefenceLineIndex:0,lastDefenceEvaluationTimestamp:0}}function Ra(e,t,n){let i,s=10;do if(i=Ma(t,n),s--<=0)break;while(!ka(i,e,t,n));return i}function Oa(e,t,n,i,s,o,a,r,c,u){const l=[];for(let d=0;d<n;d++){const f=lt(t,l,a,30*x);l.push({position:f}),s.push({id:`city-${s.length+1}`,stateId:e,name:i.pop(),position:f,population:Math.floor(Math.random()*3e3)+1e3}),De(f,2,r,c,u)}for(const d of s){const f=r.filter(h=>{const p=h.position.x-d.position.x,y=h.position.y-d.position.y;return Math.sqrt(p*p+y*y)<R});for(const h of f){h.cityId=d.id;const p=h.position.x-d.position.x,y=h.position.y-d.position.y,v=Math.sqrt(p*p+y*y);h.population=Math.max(0,R-v)/R*Lt}d.population=f.reduce((h,p)=>h+p.population,0)}for(let d=0;d<4;d++){const f=lt(t,l,a,15*x);l.push({position:f}),o.push({type:Rt.LAUNCH_SITE,id:`launch-site-${o.length+1}`,stateId:e,position:f,mode:Math.random()>.5?M.DEFENCE:M.ATTACK}),De(f,1,r,c,u)}return l}function lt(e,t,n,i){let s,o=10;do if(s={x:e.x+(Math.random()-.5)*i,y:e.y+(Math.random()-.5)*i},o--<=0)break;while(!Ba(s,t,n));return s}function ja(e,t){const n=new Map(e.map(s=>[s.id,s])),i=[];for(t.forEach(s=>{e.filter(a=>a.cityId===s.id).forEach(a=>{a.stateId=s.stateId,i.push(a)})});i.length>0;){const s=i.splice(0,1)[0];Pa(s,n).forEach(a=>{!a.stateId&&a.type===_.GROUND&&(a.stateId=s.stateId,i.push(a))})}}function Pa(e,t){const n=[];return[{dx:-1,dy:0},{dx:1,dy:0},{dx:0,dy:-1},{dx:0,dy:1}].forEach(({dx:s,dy:o})=>{const a=`${e.position.x+s*x},${e.position.y+o*x}`,r=t.get(a);r&&n.push(r)}),n}function Cn(e){return Object.fromEntries(e.states.map(t=>[t.id,t.population]))}function ie(e){return e>=1e3?`${(e/1e3).toFixed(1)}M`:`${e.toFixed(0)}K`}function Fn(e,t){const n=[],i=new Map;e.forEach(o=>{i.set(`${o.position.x},${o.position.y}`,o)});const s=(o,a)=>{const r=i.get(`${a.x},${a.y}`);if(r&&r.stateId&&r.stateId!==t.id){const c=n.find(()=>o.id===r.id)??{...o,adjacentStateIds:new Set};n.includes(c)||n.push(c),c.adjacentStateIds.add(r.stateId)}};return e.forEach(o=>{o.stateId===t.id&&[{x:o.position.x,y:o.position.y-x},{x:o.position.x,y:o.position.y+x},{x:o.position.x-x,y:o.position.y},{x:o.position.x+x,y:o.position.y}].forEach(r=>s(o,r))}),Array.from(n)}let Na=0;function $a(e,t,n){const i=[],s=Fn(e,t),o={};s.forEach(r=>{for(const c of r.adjacentStateIds)o[c]=(o[c]||0)+1});const a=Object.values(o).reduce((r,c)=>r+c,0);return s.forEach(r=>{if(r.stateId&&r.stateId===t.id){const c=Array.from(r.adjacentStateIds).reduce((d,f)=>d+o[f],0),u=c/a,l=Math.round(n*u)/c*(Math.random()*.1+.9);l>0&&i.push({id:String(Na++),quantity:l,position:{x:r.position.x+x/2,y:r.position.y+x/2},rect:{left:r.position.x-x/2,top:r.position.y-x/2,right:r.position.x+x/2,bottom:r.position.y+x/2},stateId:t.id,order:{type:"stay"}})}}),i}function L(e,t,n,i){return Math.sqrt(Math.pow(n-e,2)+Math.pow(i-t,2))}function Ua(e,t){const n=Fn(t.sectors,e),i=Ga(n),s=[];s.push({id:`${e.id}_border`,sectors:i,isBreach:!1});const o=Ya(t,e.id);s.push({id:`${e.id}_inner`,sectors:o,isBreach:!1});const a=za(t,e.id);return s.push({id:`${e.id}_final`,sectors:a,isBreach:!1}),s}function Ya(e,t){return[...e.searchCity.byProperty("stateId",t).map(n=>se(e.searchSector.byRadius(n.position,R*2))).flat(),...e.searchLaunchSite.byProperty("stateId",t).map(n=>se(e.searchSector.byRadius(n.position,x*6))).flat()]}function za(e,t){return[...e.searchCity.byProperty("stateId",t).map(n=>se(e.searchSector.byProperty("cityId",n.id))).flat(),...e.searchLaunchSite.byProperty("stateId",t).map(n=>se(e.searchSector.byRadius(n.position,x*3))).flat()]}function Ga(e){if(e.length<3)return e;const t=[e.shift()];for(;e.length;){let n=0,i=1/0;for(let s=0;s<e.length;s++){const o=L(t[t.length-1].position.x,t[t.length-1].position.y,e[s].position.x,e[s].position.y);o<i&&(i=o,n=s)}t.push(e.splice(n,1)[0])}return t}function se(e){if(e.length<3)return e;const t=e.reduce((s,o)=>o.position.y<s.position.y?o:s,e[0]),n=e.sort((s,o)=>{const a=Math.atan2(s.position.y-t.position.y,s.position.x-t.position.x),r=Math.atan2(o.position.y-t.position.y,o.position.x-t.position.x);return a-r}),i=[n[0],n[1]];for(let s=2;s<n.length;s++){for(;i.length>1&&!Ha(i[i.length-2].position,i[i.length-1].position,n[s].position);)i.pop();i.push(n[s])}return i}function Ha(e,t,n){return(t.x-e.x)*(n.y-e.y)-(t.y-e.y)*(n.x-e.x)>0}class qa{constructor(){this.ids=[],this.values=[],this.length=0}clear(){this.length=0}push(t,n){let i=this.length++;for(;i>0;){const s=i-1>>1,o=this.values[s];if(n>=o)break;this.ids[i]=this.ids[s],this.values[i]=o,i=s}this.ids[i]=t,this.values[i]=n}pop(){if(this.length===0)return;const t=this.ids[0];if(this.length--,this.length>0){const n=this.ids[0]=this.ids[this.length],i=this.values[0]=this.values[this.length],s=this.length>>1;let o=0;for(;o<s;){let a=(o<<1)+1;const r=a+1;let c=this.ids[a],u=this.values[a];const l=this.values[r];if(r<this.length&&l<u&&(a=r,c=this.ids[r],u=l),u>=i)break;this.ids[o]=c,this.values[o]=u,o=a}this.ids[o]=n,this.values[o]=i}return t}peek(){if(this.length!==0)return this.ids[0]}peekValue(){if(this.length!==0)return this.values[0]}shrink(){this.ids.length=this.values.length=this.length}}const ut=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array],pe=3;class $e{static from(t,n=0){if(n%8!==0)throw new Error("byteOffset must be 8-byte aligned.");if(!t||t.byteLength===void 0||t.buffer)throw new Error("Data must be an instance of ArrayBuffer or SharedArrayBuffer.");const[i,s]=new Uint8Array(t,n+0,2);if(i!==251)throw new Error("Data does not appear to be in a Flatbush format.");const o=s>>4;if(o!==pe)throw new Error(`Got v${o} data when expected v${pe}.`);const a=ut[s&15];if(!a)throw new Error("Unrecognized array type.");const[r]=new Uint16Array(t,n+2,1),[c]=new Uint32Array(t,n+4,1);return new $e(c,r,a,void 0,t,n)}constructor(t,n=16,i=Float64Array,s=ArrayBuffer,o,a=0){if(t===void 0)throw new Error("Missing required argument: numItems.");if(isNaN(t)||t<=0)throw new Error(`Unexpected numItems value: ${t}.`);this.numItems=+t,this.nodeSize=Math.min(Math.max(+n,2),65535),this.byteOffset=a;let r=t,c=r;this._levelBounds=[r*4];do r=Math.ceil(r/this.nodeSize),c+=r,this._levelBounds.push(c*4);while(r!==1);this.ArrayType=i,this.IndexArrayType=c<16384?Uint16Array:Uint32Array;const u=ut.indexOf(this.ArrayType),l=c*4*this.ArrayType.BYTES_PER_ELEMENT;if(u<0)throw new Error(`Unexpected typed array class: ${i}.`);o&&o.byteLength!==void 0&&!o.buffer?(this.data=o,this._boxes=new this.ArrayType(this.data,a+8,c*4),this._indices=new this.IndexArrayType(this.data,a+8+l,c),this._pos=c*4,this.minX=this._boxes[this._pos-4],this.minY=this._boxes[this._pos-3],this.maxX=this._boxes[this._pos-2],this.maxY=this._boxes[this._pos-1]):(this.data=new s(8+l+c*this.IndexArrayType.BYTES_PER_ELEMENT),this._boxes=new this.ArrayType(this.data,8,c*4),this._indices=new this.IndexArrayType(this.data,8+l,c),this._pos=0,this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0,new Uint8Array(this.data,0,2).set([251,(pe<<4)+u]),new Uint16Array(this.data,2,1)[0]=n,new Uint32Array(this.data,4,1)[0]=t),this._queue=new qa}add(t,n,i=t,s=n){const o=this._pos>>2,a=this._boxes;return this._indices[o]=o,a[this._pos++]=t,a[this._pos++]=n,a[this._pos++]=i,a[this._pos++]=s,t<this.minX&&(this.minX=t),n<this.minY&&(this.minY=n),i>this.maxX&&(this.maxX=i),s>this.maxY&&(this.maxY=s),o}finish(){if(this._pos>>2!==this.numItems)throw new Error(`Added ${this._pos>>2} items when expected ${this.numItems}.`);const t=this._boxes;if(this.numItems<=this.nodeSize){t[this._pos++]=this.minX,t[this._pos++]=this.minY,t[this._pos++]=this.maxX,t[this._pos++]=this.maxY;return}const n=this.maxX-this.minX||1,i=this.maxY-this.minY||1,s=new Uint32Array(this.numItems),o=65535;for(let a=0,r=0;a<this.numItems;a++){const c=t[r++],u=t[r++],l=t[r++],d=t[r++],f=Math.floor(o*((c+l)/2-this.minX)/n),h=Math.floor(o*((u+d)/2-this.minY)/i);s[a]=Xa(f,h)}Te(s,t,this._indices,0,this.numItems-1,this.nodeSize);for(let a=0,r=0;a<this._levelBounds.length-1;a++){const c=this._levelBounds[a];for(;r<c;){const u=r;let l=t[r++],d=t[r++],f=t[r++],h=t[r++];for(let p=1;p<this.nodeSize&&r<c;p++)l=Math.min(l,t[r++]),d=Math.min(d,t[r++]),f=Math.max(f,t[r++]),h=Math.max(h,t[r++]);this._indices[this._pos>>2]=u,t[this._pos++]=l,t[this._pos++]=d,t[this._pos++]=f,t[this._pos++]=h}}}search(t,n,i,s,o){if(this._pos!==this._boxes.length)throw new Error("Data not yet indexed - call index.finish().");let a=this._boxes.length-4;const r=[],c=[];for(;a!==void 0;){const u=Math.min(a+this.nodeSize*4,ft(a,this._levelBounds));for(let l=a;l<u;l+=4){if(i<this._boxes[l]||s<this._boxes[l+1]||t>this._boxes[l+2]||n>this._boxes[l+3])continue;const d=this._indices[l>>2]|0;a>=this.numItems*4?r.push(d):(o===void 0||o(d))&&c.push(d)}a=r.pop()}return c}neighbors(t,n,i=1/0,s=1/0,o){if(this._pos!==this._boxes.length)throw new Error("Data not yet indexed - call index.finish().");let a=this._boxes.length-4;const r=this._queue,c=[],u=s*s;e:for(;a!==void 0;){const l=Math.min(a+this.nodeSize*4,ft(a,this._levelBounds));for(let d=a;d<l;d+=4){const f=this._indices[d>>2]|0,h=dt(t,this._boxes[d],this._boxes[d+2]),p=dt(n,this._boxes[d+1],this._boxes[d+3]),y=h*h+p*p;y>u||(a>=this.numItems*4?r.push(f<<1,y):(o===void 0||o(f))&&r.push((f<<1)+1,y))}for(;r.length&&r.peek()&1;)if(r.peekValue()>u||(c.push(r.pop()>>1),c.length===i))break e;a=r.length?r.pop()>>1:void 0}return r.clear(),c}}function dt(e,t,n){return e<t?t-e:e<=n?0:e-n}function ft(e,t){let n=0,i=t.length-1;for(;n<i;){const s=n+i>>1;t[s]>e?i=s:n=s+1}return t[n]}function Te(e,t,n,i,s,o){if(Math.floor(i/o)>=Math.floor(s/o))return;const a=e[i+s>>1];let r=i-1,c=s+1;for(;;){do r++;while(e[r]<a);do c--;while(e[c]>a);if(r>=c)break;Va(e,t,n,r,c)}Te(e,t,n,i,c,o),Te(e,t,n,c+1,s,o)}function Va(e,t,n,i,s){const o=e[i];e[i]=e[s],e[s]=o;const a=4*i,r=4*s,c=t[a],u=t[a+1],l=t[a+2],d=t[a+3];t[a]=t[r],t[a+1]=t[r+1],t[a+2]=t[r+2],t[a+3]=t[r+3],t[r]=c,t[r+1]=u,t[r+2]=l,t[r+3]=d;const f=n[i];n[i]=n[s],n[s]=f}function Xa(e,t){let n=e^t,i=65535^n,s=65535^(e|t),o=e&(t^65535),a=n|i>>1,r=n>>1^n,c=s>>1^i&o>>1^s,u=n&s>>1^o>>1^o;n=a,i=r,s=c,o=u,a=n&n>>2^i&i>>2,r=n&i>>2^i&(n^i)>>2,c^=n&s>>2^i&o>>2,u^=i&s>>2^(n^i)&o>>2,n=a,i=r,s=c,o=u,a=n&n>>4^i&i>>4,r=n&i>>4^i&(n^i)>>4,c^=n&s>>4^i&o>>4,u^=i&s>>4^(n^i)&o>>4,n=a,i=r,s=c,o=u,c^=n&s>>8^i&o>>8,u^=i&s>>8^(n^i)&o>>8,n=c^c>>1,i=u^u>>1;let l=e^t,d=i|65535^(l|n);return l=(l|l<<8)&16711935,l=(l|l<<4)&252645135,l=(l|l<<2)&858993459,l=(l|l<<1)&1431655765,d=(d|d<<8)&16711935,d=(d|d<<4)&252645135,d=(d|d<<2)&858993459,d=(d|d<<1)&1431655765,(d<<1|l)>>>0}function In(e,t=!1){return{...e,searchUnit:U(e.units),searchSector:U(e.sectors,t?void 0:"sectors"),searchCity:U(e.cities),searchLaunchSite:U(e.launchSites),searchMissile:U(e.missiles),searchInterceptor:U(e.interceptors)}}const ge={};function U(e,t){if(t&&ge[t])return ge[t];e=[...e];const n=e.length===0?void 0:new $e(e.length);for(const o of e)"rect"in o?n==null||n.add(o.rect.left,o.rect.top,o.rect.right,o.rect.bottom):"position"in o&&(n==null||n.add(o.position.x,o.position.y,o.position.x,o.position.y));n==null||n.finish();const i=new Map,s={byRect:o=>(n==null?void 0:n.search(o.left,o.top,o.right,o.bottom).map(a=>e[a]))??[],byRadius:(o,a)=>(n==null?void 0:n.neighbors(o.x,o.y,void 0,a).map(r=>e[r]))??[],byProperty:(o,a)=>{if(!i.has(o)){const r=i.set(o,new Map).get(o);e.forEach(c=>{if(o in c){const u=c[o];r.has(u)||r.set(u,[]),r.get(u).push(c)}})}return i.get(o).get(a)??[]},resetPropertyCache:()=>{i.clear()}};return t&&(ge[t]=s),s}function Wa({playerStateName:e,numberOfStates:t=3,groundWarfare:n}){const i=Math.max(200,Math.ceil(Math.sqrt(t)*10)),s=i,o=ui(i,s),{states:a,cities:r,launchSites:c}=wa(t,e,i,s,o);di(o,i,s);const u=[],l=[],d=[],f=[],p={timestamp:0,states:a,cities:r,launchSites:c,sectors:o,units:f,missiles:u,explosions:l,interceptors:d,battles:[]};if(n){const y=In(p,!0);a.forEach(v=>{v.defenceLines=Ua(v,y),v.currentDefenceLineIndex=0});for(const v of a)f.push(...$a(o,v,si))}return p}function Ka(e){var n;if(e.lastLaunchGenerationTimestamp&&e.timestamp-e.lastLaunchGenerationTimestamp>ri)return;e.lastLaunchGenerationTimestamp=e.timestamp;const t=e.sectors.filter(i=>i.cityId&&i.population>0);for(const i of e.states){const s=e.cities.filter(l=>l.stateId===i.id),o=e.launchSites.filter(l=>l.stateId===i.id),a=e.cities.filter(l=>i.strategies[l.stateId]===g.HOSTILE&&l.stateId!==i.id&&l.population>0).map(l=>({...l,isCity:!0})),r=e.missiles.filter(l=>i.strategies[l.stateId]!==g.FRIENDLY&&l.stateId!==i.id),c=e.launchSites.filter(l=>i.strategies[l.stateId]===g.HOSTILE&&l.stateId!==i.id).map(l=>({...l,isCity:!1})),u=r.filter(l=>s.some(d=>Se(l.target,d.position,O+R))||o.some(d=>Se(l.target,d.position,O))).filter(l=>(e.timestamp-l.launchTimestamp)/(l.targetTimestamp-l.launchTimestamp)>.5);for(const l of e.launchSites.filter(d=>d.stateId===i.id)){if(l.nextLaunchTarget)continue;if(a.length===0&&c.length===0&&r.length===0)break;if(u.length===0&&l.mode===M.DEFENCE||u.length>0&&l.mode===M.ATTACK){l.modeChangeTimestamp||(l.modeChangeTimestamp=e.timestamp);continue}const d=mt(u.map(v=>({...v,isCity:!1})),l.position),f=e.missiles.filter(v=>v.stateId===i.id),h=e.interceptors.filter(v=>v.stateId===i.id),p=h.filter(v=>!v.targetMissileId&&l.id===v.launchSiteId),y=Ja(h,d).filter(([,v])=>v<o.length);if(l.mode===M.DEFENCE&&y.length>0){const v=y[0][0];p.length>0?p[0].targetMissileId=v:l.nextLaunchTarget={type:"missile",missileId:v}}else if(l.mode===M.ATTACK){const v=Za(mt([...c,...a],l.position),f),C=(n=v==null?void 0:v[0])==null?void 0:n[0];if(C!=null&&C.position&&(C!=null&&C.isCity)){const b=Qa(C,t);l.nextLaunchTarget={type:"position",position:b||{x:C.position.x+(Math.random()-Math.random())*R,y:C.position.y+(Math.random()-Math.random())*R}}}else l.nextLaunchTarget=C!=null&&C.position?{type:"position",position:C==null?void 0:C.position}:void 0}}}}function Se(e,t,n){return L(e.x,e.y,t.x,t.y)<=n}function mt(e,t){return e.sort((n,i)=>L(n.position.x,n.position.y,t.x,t.y)-L(i.position.x,i.position.y,t.x,t.y))}function Za(e,t){const n=new Map;for(const i of e)n.set(i,t.filter(s=>Se(s.target,i.position,O)).length);return Array.from(n).sort((i,s)=>i[1]-s[1])}function Ja(e,t){const n=new Map;for(const i of t)n.set(i.id,0);for(const i of e)i.targetMissileId&&n.set(i.targetMissileId,(n.get(i.targetMissileId)??0)+1);return Array.from(n).sort((i,s)=>i[1]-s[1])}function Qa(e,t){const n=t.filter(s=>s.cityId===e.id);return!n||n.length===0?null:n[Math.floor(Math.random()*n.length)].position}function eo(e){var t,n;if(!(e.lastStrategyUpdateTimestamp&&e.timestamp-e.lastStrategyUpdateTimestamp>ci)){e.lastStrategyUpdateTimestamp=e.timestamp;for(const i of e.missiles.filter(s=>s.launchTimestamp===e.timestamp)){const s=e.states.find(a=>a.id===i.stateId),o=((t=e.cities.find(a=>L(a.position.x,a.position.y,i.target.x,i.target.y)<=O+R))==null?void 0:t.stateId)||((n=e.launchSites.find(a=>L(a.position.x,a.position.y,i.target.x,i.target.y)<=O))==null?void 0:n.stateId);if(s&&o&&s.id!==o){s.strategies[o]!==g.HOSTILE&&(s.strategies[o]=g.HOSTILE);const a=e.states.find(r=>r.id===o);a&&a.strategies[s.id]!==g.HOSTILE&&(a.strategies[s.id]=g.HOSTILE,e.states.forEach(r=>{r.id!==a.id&&r.strategies[a.id]===g.FRIENDLY&&a.strategies[r.id]===g.FRIENDLY&&(r.strategies[s.id]=g.HOSTILE,s.strategies[r.id]=g.HOSTILE)}))}}for(const i of e.states.filter(s=>!s.isPlayerControlled))to(i,e)}}function to(e,t){if(e.lastStrategyUpdate&&t.timestamp-e.lastStrategyUpdate<ni)return;e.lastStrategyUpdate=t.timestamp;const n=t.states.filter(a=>a.id!==e.id),i=n.filter(a=>e.strategies[a.id]===g.FRIENDLY&&a.strategies[e.id]===g.FRIENDLY);e.strategies={...e.strategies},n.forEach(a=>{a.strategies[e.id]===g.FRIENDLY&&e.strategies[a.id]===g.NEUTRAL&&(e.generalStrategy!==g.HOSTILE?e.strategies[a.id]=g.FRIENDLY:a.strategies[e.id]=g.NEUTRAL)}),n.forEach(a=>{a.strategies[e.id]===g.NEUTRAL&&e.strategies[a.id]===g.HOSTILE&&(ht(e,a,i,t)?e.strategies[a.id]=g.NEUTRAL:a.strategies[e.id]=g.HOSTILE)});const s=n.filter(a=>Object.values(a.strategies).every(r=>r!==g.HOSTILE)&&a.generalStrategy!==g.HOSTILE);if(s.length>0&&e.generalStrategy===g.FRIENDLY){const a=s[Math.floor(Math.random()*s.length)];e.strategies[a.id]=g.FRIENDLY}i.forEach(a=>{n.forEach(r=>{r.strategies[a.id]===g.HOSTILE&&e.strategies[r.id]!==g.HOSTILE&&(e.strategies[r.id]=g.HOSTILE)})}),n.filter(a=>a.strategies[e.id]!==g.FRIENDLY&&e.strategies[a.id]!==g.FRIENDLY).forEach(a=>{if(ht(a,e,i,t)){const r=t.launchSites.filter(c=>c.stateId===e.id&&!c.lastLaunchTimestamp);if(r.length>0){const c=r[Math.floor(Math.random()*r.length)],u=[...t.cities.filter(l=>l.stateId===a.id),...t.launchSites.filter(l=>l.stateId===a.id)];if(u.length>0){const l=u[Math.floor(Math.random()*u.length)];c.nextLaunchTarget={type:"position",position:l.position}}}}})}function ht(e,t,n,i){const s=i.states.filter(c=>e.strategies[c.id]===g.FRIENDLY&&c.strategies[e.id]===g.FRIENDLY&&c.id!==e.id),o=i.launchSites.filter(c=>c.stateId===e.id||s.some(u=>u.id===c.stateId)),a=i.launchSites.filter(c=>c.stateId===t.id||n.some(u=>u.id===c.stateId));return o.length<a.length?!0:i.missiles.some(c=>i.cities.some(u=>u.stateId===e.id&&L(u.position.x,u.position.y,c.target.x,c.target.y)<=O)||i.launchSites.some(u=>u.stateId===e.id&&L(u.position.x,u.position.y,c.target.x,c.target.y)<=O))}function no(e){for(const t of e.missiles){const n=(e.timestamp-t.launchTimestamp)/(t.targetTimestamp-t.launchTimestamp);t.position={x:t.launch.x+(t.target.x-t.launch.x)*n,y:t.launch.y+(t.target.y-t.launch.y)*n}}}function io(e,t){e.interceptors=e.interceptors.filter(n=>{const i=e.missiles.find(c=>c.id===n.targetMissileId);i||(n.targetMissileId=void 0);const s=i?i.position.x-n.position.x:Math.cos(n.direction),o=i?i.position.y-n.position.y:Math.sin(n.direction),a=Math.sqrt(s*s+o*o);if(n.direction=Math.atan2(o,s),i&&a<=ee*t)n.position={...i.position};else{const c=ee*t/a;n.position={x:n.position.x+s*c,y:n.position.y+o*c}}return n.tail=[...n.tail.slice(-100),{timestamp:e.timestamp,position:n.position}],ee*(e.timestamp-n.launchTimestamp)<=n.maxRange})}function so(e){for(const t of e.interceptors){const n=e.missiles.find(i=>i.id===t.targetMissileId);n&&L(t.position.x,t.position.y,n.position.x,n.position.y)<Jn&&(e.missiles=e.missiles.filter(s=>s.id!==n.id),e.interceptors=e.interceptors.filter(s=>s.id!==t.id))}}function ao(e){for(const t of e.missiles.filter(n=>n.targetTimestamp<=e.timestamp)){const n=oo(t);e.explosions.push(n),ro(e,n),co(e,n),lo(e,n),uo(e,n)}e.explosions=e.explosions.filter(t=>t.endTimestamp>=e.timestamp),e.missiles=e.missiles.filter(t=>t.targetTimestamp>e.timestamp)}function oo(e){return{id:`explosion-${Math.random()}`,missileId:e.id,startTimestamp:e.targetTimestamp,endTimestamp:e.targetTimestamp+ei,position:e.target,radius:O}}function ro(e,t){for(const n of e.searchSector.byRadius(t.position,t.radius))if(n.population){const i=Math.max(wt,n.population*Bt);n.population=Math.max(0,n.population-i)}return e}function co(e,t){const n=e.searchMissile.byRadius(t.position,t.radius).filter(i=>i.id!==t.missileId&&i.launchTimestamp<=t.startTimestamp&&i.targetTimestamp>=t.startTimestamp);for(const i of n)i.targetTimestamp=t.startTimestamp;e.interceptors=e.interceptors.filter(i=>!(i.launchTimestamp<=t.startTimestamp&&L(i.position.x,i.position.y,t.position.x,t.position.y)<=t.radius))}function lo(e,t){const n=e.searchLaunchSite.byRadius(t.position,t.radius);e.launchSites=e.launchSites.filter(i=>!n.some(s=>s.id===i.id))}function uo(e,t){const n=e.searchUnit.byRadius(t.position,t.radius);e.units=e.units.map(i=>{if(n.find(o=>o.id===i.id)){const o=Math.max(wt,i.quantity*Bt),a=Math.max(0,i.quantity-o);return{...i,quantity:a}}return i}),e.units=e.units.filter(i=>i.quantity>0)}function fo(e){for(const t of e.launchSites)t.modeChangeTimestamp&&e.timestamp>=t.modeChangeTimestamp+ye&&(t.mode=t.mode===M.ATTACK?M.DEFENCE:M.ATTACK,t.modeChangeTimestamp=void 0)}function mo(e){var t,n;for(const i of e.launchSites)if(i.nextLaunchTarget&&!(i.lastLaunchTimestamp&&e.timestamp-i.lastLaunchTimestamp<(i.mode===M.ATTACK?be:ti))){if(i.mode===M.ATTACK&&((t=i.nextLaunchTarget)==null?void 0:t.type)==="position")e.missiles.push(ho(i,i.nextLaunchTarget.position,e.timestamp));else if(i.mode===M.DEFENCE&&((n=i.nextLaunchTarget)==null?void 0:n.type)==="missile"){const s=i.nextLaunchTarget.missileId,o=e.searchMissile.byProperty("id",s)[0];o&&e.interceptors.push(po(i,e.timestamp,o))}i.lastLaunchTimestamp=e.timestamp,i.nextLaunchTarget=void 0}}function ho(e,t,n){return{id:Math.random()+"",stateId:e.stateId,launchSiteId:e.id,launch:e.position,launchTimestamp:n,position:e.position,target:t,targetTimestamp:n+L(e.position.x,e.position.y,t.x,t.y)/Re}}function po(e,t,n){return{id:Math.random()+"",stateId:e.stateId,launchSiteId:e.id,launch:e.position,launchTimestamp:t,position:e.position,direction:Math.atan2(e.position.y-n.position.y,e.position.x-n.position.x),tail:[],targetMissileId:n.id,maxRange:Oe}}function go(e){const t=e.sectors.reduce((n,i)=>(i.cityId&&(n[i.cityId]=n[i.cityId]?n[i.cityId]+(i.population??0):i.population??0),n),{});for(const n of e.cities)n.population=t[n.id];e.states=e.states.map(n=>{const i=e.cities.filter(s=>s.stateId===n.id).reduce((s,o)=>s+o.population,0);return{...n,population:i}})}function vo(e){const t=[];for(const n of e.units){for(const s of t)if(n.rect.left<s.rect.right&&n.rect.right>s.rect.left&&n.rect.top<s.rect.bottom&&n.rect.bottom>s.rect.top){s.units.push(n),s.rect={left:Math.min(s.rect.left,n.rect.left),top:Math.min(s.rect.top,n.rect.top),right:Math.max(s.rect.right,n.rect.right),bottom:Math.max(s.rect.bottom,n.rect.bottom)},s.position={x:(s.rect.left+s.rect.right)/2,y:(s.rect.top+s.rect.bottom)/2},s.size=Math.max(s.rect.right-s.rect.left,s.rect.bottom-s.rect.top);break}const i=e.states.find(s=>s.id===n.stateId);for(const s of e.searchUnit.byRect(n.rect)){if(s.stateId===n.stateId||(i==null?void 0:i.strategies[s.stateId])!==g.HOSTILE)continue;const o={units:[n,s],rect:{left:Math.min(n.rect.left,s.rect.left),top:Math.min(n.rect.top,s.rect.top),right:Math.max(n.rect.right,s.rect.right),bottom:Math.max(n.rect.bottom,s.rect.bottom)},position:{x:(Math.min(n.rect.left,s.rect.left)+Math.max(n.rect.right,s.rect.right))/2,y:(Math.min(n.rect.top,s.rect.top)+Math.max(n.rect.bottom,s.rect.bottom))/2},size:Math.max(Math.abs(n.rect.right-s.rect.left),Math.abs(n.rect.bottom-s.rect.top))};t.push(o);break}}return t}function yo(e,t,n){for(const i of t){const s=i.units.reduce((a,r)=>(a[r.stateId]=(a[r.stateId]??0)+r.quantity,a),{}),o=Object.values(s).reduce((a,r)=>a=a+r,0);o&&i.units.forEach(a=>{a.quantity=Math.max(0,a.quantity-Math.max(ai*n,s[a.stateId]/o*n*oi*a.quantity))})}return e}function An(e,t){for(const n of t)if(n.units.find(i=>i.id===e.id))return!0;return!1}const Dn=2;function Tn(e,t,n,i){const s=i.states.find(p=>p.id===t.stateId);if(!s||!e.stateId)return 0;const o=s.strategies[e.stateId];if(o!==g.HOSTILE&&e.stateId!==t.stateId)return-1e3;let a=0;Co(e,i)&&(a+=100),e.population>0&&(a+=50);const c=bo(e,t.stateId,n,s.strategies);a+=c*10;const u=Eo(e,t.stateId,n,s.strategies);a+=u*5;const l=xo(e,t.stateId,n);a+=l*20;const f=(ae(e,i)+Fo(e,i))/Dn;switch(a-=f*30,o){case g.HOSTILE:a*=1.5;break;case g.FRIENDLY:a*=.5;break;case g.NEUTRAL:a*=.25;break}const h=Ao(e,s);return a+=h,a}function bo(e,t,n,i){return n.filter(o=>Math.abs(o.position.x-e.position.x)<=x&&Math.abs(o.position.y-e.position.y)<=x&&(o.stateId===t||o.stateId&&i[o.stateId]===g.FRIENDLY)).length}function Eo(e,t,n,i){const s=n.filter(a=>Math.abs(a.position.x-e.position.x)<=x&&Math.abs(a.position.y-e.position.y)<=x);return s.filter(a=>a.stateId===t||a.stateId&&i[a.stateId]===g.FRIENDLY).length/s.length}function xo(e,t,n){const i=n.filter(u=>u.stateId===t),s=i.reduce((u,l)=>u+l.position.x,0)/i.length,o=i.reduce((u,l)=>u+l.position.y,0)/i.length,a=Math.sqrt((e.position.x-s)**2+(e.position.y-o)**2),r=Math.sqrt(x*x*2)*Math.sqrt(n.length);return 1-a/r}function Co(e,t){return t.searchLaunchSite.byRect(e.rect).filter(n=>n.stateId!==e.stateId)[0]}function ae(e,t){return t.searchUnit.byRect(e.rect).length}function Fo(e,t){return t.units.filter(n=>n.order.type==="move"&&Io(n.order.targetPosition,e)).length}function Io(e,t){return e.x>=t.rect.left&&e.x<=t.rect.right&&e.y>=t.rect.top&&e.y<=t.rect.bottom}function Ao(e,t){if(t.defenceLines[t.currentDefenceLineIndex].sectors.includes(e))return 50;for(let i=0;i<t.defenceLines.length;i++)if(t.defenceLines[i].sectors.includes(e))return 30*(t.defenceLines.length-i);return 0}function Do(e,t){for(const n of e.units){if(n.lastOrderTimestamp&&e.timestamp-n.lastOrderTimestamp<li||n.order.type==="move"&&n.order.isFallback)continue;const i=e.searchSector.byRadius(n.position,1)[0];if(!i)continue;const s=e.states.find(c=>c.id===n.stateId);if(!s)continue;if(An(n,t)){const c=t.find(u=>u.units.includes(n));if(c&&So(n,c)){const u=_o(n,e,t);if(u){n.order={type:"move",targetPosition:te(u)},n.lastOrderTimestamp=e.timestamp;continue}}}const o=To(n,s,e);if(o){n.order={type:"move",targetPosition:o.position},n.lastOrderTimestamp=e.timestamp;continue}const a=e.searchSector.byRect({left:i.rect.left-x,top:i.rect.top-x,right:i.rect.right+x,bottom:i.rect.bottom+x}).filter(c=>c.type===_.GROUND&&c.stateId),r=a.filter(c=>c.stateId!==n.stateId&&s.strategies[c.stateId]===g.HOSTILE);if(r.length>0){const c=Mo(n,r,a,e,s);n.order={type:"move",targetPosition:te(c)}}else if(_e(i,e)){const u=wo(n,s,a,e);u?n.order={type:"move",targetPosition:te(u)}:n.order={type:"stay"}}else{const u=ko(n,s,e,e.searchSector.byRadius(n.position,x*5).filter(l=>l.type===_.GROUND));u?n.order={type:"move",targetPosition:u.position}:n.order={type:"stay"}}n.lastOrderTimestamp=e.timestamp}}function To(e,t,n){return n.searchUnit.byRadius(e.position,T*2).find(s=>s.stateId!==e.stateId&&t.strategies[s.stateId]===g.HOSTILE&&s.quantity<e.quantity)}function So(e,t){const n=t.units.reduce((s,o)=>s+o.quantity,0);return e.quantity/n<.4}function _o(e,t,n){var s;return(s=t.searchSector.byRadius(e.position,x*5).filter(o=>o.stateId===e.stateId&&o.type===_.GROUND).reduce((o,a)=>{const r=Math.sqrt((e.position.x-a.position.x)**2+(e.position.y-a.position.y)**2),u=t.searchUnit.byRect(a.rect).some(d=>d.stateId!==e.stateId),l=n.some(d=>d.units.some(f=>f.rect.left<a.rect.right&&f.rect.right>a.rect.left&&f.rect.top<a.rect.bottom&&f.rect.bottom>a.rect.top));return!u&&!l&&(!o||r<o.distance)?{sector:a,distance:r}:o},void 0))==null?void 0:s.sector}function Mo(e,t,n,i,s){let o=t[0],a=-1/0;for(const r of t){const c=Tn(r,e,n,i),u=s.defenceLines[s.currentDefenceLineIndex].sectors.includes(r)?50:0,l=c+u;l>a&&(a=l,o=r)}return o}function te(e){return{x:(e.rect.left+e.rect.right)/2,y:(e.rect.top+e.rect.bottom)/2}}function ko(e,t,n,i){const o=i.filter(r=>r.stateId!==e.stateId&&r.stateId&&t.strategies[r.stateId]===g.HOSTILE).map(r=>({sector:r,value:Tn(r,e,i,n),distance:Math.sqrt((e.position.x-r.position.x)**2+(e.position.y-r.position.y)**2)}));o.sort((r,c)=>c.value!==r.value?c.value-r.value:r.distance-c.distance);const a=o[0];if(a)return{position:te(a.sector),type:"sector"}}function _e(e,t){return ae(e,t)+Me(e,t)>Dn}function Me(e,t){return t.units.filter(n=>n.order.type==="move"&&Bo(n.order.targetPosition,e)).length}function Bo(e,t){return e.x>=t.rect.left&&e.x<=t.rect.right&&e.y>=t.rect.top&&e.y<=t.rect.bottom}function wo(e,t,n,i){const s=n.filter(r=>r.stateId===e.stateId||r.stateId&&t.strategies[r.stateId]===g.FRIENDLY);s.sort((r,c)=>{const u=ae(r,i)+Me(r,i),l=ae(c,i)+Me(c,i);return u-l});const o=t.defenceLines[t.currentDefenceLineIndex].sectors,a=s.find(r=>o.includes(r)&&!_e(r,i)&&!pt(r,t,i));return a||s.find(r=>!_e(r,i)&&!pt(r,t,i))}function pt(e,t,n){return n.searchUnit.byRect(e.rect).some(s=>s.stateId!==e.stateId&&t.strategies[s.stateId]===g.NEUTRAL)}function Lo(e,t,n){const i=t.sectors.length;return t.sectors.filter(o=>{const a=n.searchUnit.byRect(o.rect);return o.stateId!==e.id||a.filter(r=>r.stateId!==o.stateId).reduce((r,c)=>r+c.quantity,0)>a.filter(r=>r.stateId===o.stateId).reduce((r,c)=>r+c.quantity,0)}).length/i>.25}function Ro(e,t){const n=e.defenceLines[e.currentDefenceLineIndex],i=t.units.filter(a=>a.stateId===e.id&&!Oo(a,n)),s=n.sectors.length,o=Math.ceil(i.length/s);for(let a=0;a<i.length;a++){const r=i[a],c=Math.floor(a/o),u=n.sectors[c%s];r.order={type:"move",isFallback:!0,targetPosition:jo(u)}}}function Oo(e,t){return t.sectors.some(n=>e.position.x>=n.rect.left&&e.position.x<=n.rect.right&&e.position.y>=n.rect.top&&e.position.y<=n.rect.bottom)}function jo(e){return{x:(e.rect.left+e.rect.right)/2,y:(e.rect.top+e.rect.bottom)/2}}function Po(e,t){const n=vo(e);yo(e.units,n,t),No(e,t,n),$o(e),Yo(e),Do(e,n),e.units=e.units.filter(i=>i.quantity>0),e.battles=n.map(i=>({...i,position:{x:(i.rect.left+i.rect.right)/2,y:(i.rect.top+i.rect.bottom)/2}}))}function No(e,t,n){for(const i of e.units){if(i.order.type!=="move"||An(i,n)&&!Uo(i,e))continue;const s={x:i.order.targetPosition.x-i.position.x,y:i.order.targetPosition.y-i.position.y},o=Math.sqrt(s.x**2+s.y**2),a=ii*t;if(o<=a)i.position=i.order.targetPosition,i.order={type:"stay"};else{const r={x:s.x/o,y:s.y/o};i.position={x:i.position.x+r.x*a,y:i.position.y+r.y*a}}i.rect={left:i.position.x-T/2,top:i.position.y-T/2,right:i.position.x+T/2,bottom:i.position.y+T/2}}}function $o(e){e.units.forEach(t=>{const n=e.searchSector.byRadius(t.position,1)[0];if(!n||n.stateId===t.stateId)return;const i=e.searchUnit.byRect(n.rect);if(Object.values(i.reduce((o,a)=>(o[a.stateId]=!0,o),{[t.stateId]:!0})).length===1){if(n.stateId=t.stateId,n.cityId){const a=e.cities.find(r=>r.id===n.cityId);a&&a.stateId!==t.stateId&&e.searchSector.byRadius(a.position,R).filter(u=>u.cityId===a.id&&u.population>0).every(u=>u.stateId===t.stateId)&&(a.stateId=t.stateId)}const o=e.searchLaunchSite.byRect(n.rect).filter(a=>a.stateId!==t.stateId)[0];o&&(o.stateId=t.stateId)}})}function Uo(e,t){if(e.order.type!=="move")return!1;const n=t.searchSector.byRadius(e.order.targetPosition,1)[0];if(!n||n.stateId!==e.stateId)return!1;const i=t.searchUnit.byRect(n.rect);for(const s of i)if(s.stateId!==e.stateId)return!1;return!0}function Yo(e){for(const t of e.states){if(e.timestamp-t.lastDefenceEvaluationTimestamp<5)continue;t.lastDefenceEvaluationTimestamp=e.timestamp;const n=t.defenceLines[t.currentDefenceLineIndex];n&&Lo(t,n,e)&&(t.currentDefenceLineIndex=Math.min(t.currentDefenceLineIndex+1,t.defenceLines.length-1),Ro(t,e))}}function zo(e,t){for(;t>0;){const n=Go(e,t>K?K:t);t=t>K?t-K:0,e=n}return e}function Go(e,t){const n=e.timestamp+t,i=In({timestamp:n,states:e.states,cities:e.cities,launchSites:e.launchSites,missiles:e.missiles,interceptors:e.interceptors,units:e.units,explosions:e.explosions,sectors:e.sectors,battles:e.battles});return Po(i,t),no(i),io(i,t),so(i),ao(i),fo(i),mo(i),go(i),Ka(i),eo(i),i}function Ho(e,t,n){const[i,s]=E.useState(()=>Wa({playerStateName:e,numberOfStates:t+1,groundWarfare:n})),o=E.useCallback((a,r)=>s(zo(a,r)),[]);return{worldState:i,updateWorldState:o,setWorldState:s}}const Sn={x:0,y:0,pointingObjects:[]},qo=(e,t)=>t.type==="move"?{x:t.x,y:t.y,pointingObjects:e.pointingObjects}:t.type==="point"&&!e.pointingObjects.some(n=>n.id===t.object.id)?{x:e.x,y:e.y,pointingObjects:[...e.pointingObjects,t.object]}:t.type==="unpoint"&&e.pointingObjects.some(n=>n.id===t.object.id)?{x:e.x,y:e.y,pointingObjects:e.pointingObjects.filter(n=>n.id!==t.object.id)}:e,Vo=E.createContext(Sn),Ue=E.createContext(()=>{});function Xo({children:e}){const[t,n]=E.useReducer(qo,Sn);return m.jsx(Vo.Provider,{value:t,children:m.jsx(Ue.Provider,{value:n,children:e})})}function Wo(){const e=E.useContext(Ue);return(t,n)=>e({type:"move",x:t,y:n})}function Ye(){const e=E.useContext(Ue);return[t=>e({type:"point",object:t}),t=>e({type:"unpoint",object:t})]}const ze={},Ko=(e,t)=>t.type==="clear"?ze:t.type==="set"?{...e,selectedObject:t.object}:e,_n=E.createContext(ze),Mn=E.createContext(()=>{});function Zo({children:e}){const[t,n]=E.useReducer(Ko,ze);return m.jsx(_n.Provider,{value:t,children:m.jsx(Mn.Provider,{value:n,children:e})})}function Jo(e){var i;const t=E.useContext(Mn);return[((i=E.useContext(_n).selectedObject)==null?void 0:i.id)===e.id,()=>t({type:"set",object:e})]}function V(e,t){const n=new CustomEvent(e,{bubbles:!0,detail:t});document.dispatchEvent(n)}function le(e,t){E.useEffect(()=>{const n=i=>{t(i.detail)};return document.addEventListener(e,n,!1),()=>{document.removeEventListener(e,n,!1)}},[e,t])}const Qo=N.memo(({sectors:e,states:t})=>{const n=E.useRef(null),[i,s]=Ye(),[o,a]=E.useState(0);return le("cityDamage",()=>{a(o+1)}),E.useEffect(()=>{const r=n.current,c=r==null?void 0:r.getContext("2d");if(!r||!c)return;const u=Math.min(...e.map(b=>b.rect.left)),l=Math.min(...e.map(b=>b.rect.top)),d=Math.max(...e.map(b=>b.rect.right)),f=Math.max(...e.map(b=>b.rect.bottom)),h=d-u,p=f-l;r.width=h,r.height=p,r.style.width=`${h}px`,r.style.height=`${p}px`;const y=Math.max(...e.filter(b=>b.type===_.WATER).map(b=>b.depth||0)),v=Math.max(...e.filter(b=>b.type===_.GROUND).map(b=>b.height||0)),C=new Map(t.map(b=>[b.id,b.color]));c.clearRect(0,0,h,p),e.forEach(b=>{const{fillStyle:I,drawSector:j}=er(b,y,v,C);c.fillStyle=I,j(c,b.rect,u,l)})},[o]),E.useEffect(()=>{const r=n.current;let c;const u=l=>{const d=r==null?void 0:r.getBoundingClientRect(),f=l.clientX-((d==null?void 0:d.left)||0),h=l.clientY-((d==null?void 0:d.top)||0),p=e.find(y=>f>=y.rect.left&&f<=y.rect.right&&h>=y.rect.top&&h<=y.rect.bottom);p&&(c&&s(c),i(p),c=p)};return r==null||r.addEventListener("mousemove",u),()=>{r==null||r.removeEventListener("mousemove",u)}},[e,i,s]),m.jsx("canvas",{ref:n,style:{opacity:.5}})});function er(e,t,n,i){const s=tr(e,t,n),o=e.stateId?i.get(e.stateId):void 0;return{fillStyle:s,drawSector:(a,r,c,u)=>{a.fillStyle=s,a.fillRect(r.left-c,r.top-u,r.right-r.left,r.bottom-r.top),o&&(a.fillStyle=`${o}80`,a.fillRect(r.left-c,r.top-u,r.right-r.left,r.bottom-r.top)),e.cityId&&e.population>0&&ir(a,r,c,u)}}}function tr(e,t,n){switch(e.type){case _.GROUND:return e.cityId?nr(e):sr(e.height||0,n);case _.WATER:return ar(e.depth||0,t);default:return"rgb(0, 34, 93)"}}function nr(e){if(e.population===0)return"rgba(0,0,0,0.7)";const t=e.population?Math.min(e.population/Lt,1):0,n=e.height?e.height/100:0,s=[200,200,200].map(o=>o-50*t+20*n);return`rgb(${s[0]}, ${s[1]}, ${s[2]})`}function ir(e,t,n,i){e.fillStyle="rgba(0, 0, 0, 0.2)",e.fillRect(t.left-n+2,t.top-i+2,t.right-t.left-4,t.bottom-t.top-4),e.fillStyle="rgba(255, 255, 255, 0.6)",e.fillRect(t.left-n+4,t.top-i+4,t.right-t.left-8,t.bottom-t.top-8)}function sr(e,t){const n=e/t;if(n<.2)return`rgb(255, ${Math.round(223+-36*(n/.2))}, 128)`;if(n<.5)return`rgb(34, ${Math.round(200-100*((n-.2)/.3))}, 34)`;if(n<.95){const i=Math.round(34+67*((n-.5)/.3)),s=Math.round(100+-33*((n-.5)/.3)),o=Math.round(34+-1*((n-.5)/.3));return`rgb(${i}, ${s}, ${o})`}else return`rgb(255, 255, ${Math.round(255-55*((n-.8)/.2))})`}function ar(e,t){const n=e/t,i=Math.round(0+34*(1-n)),s=Math.round(137+-103*n),o=Math.round(178+-85*n);return`rgb(${i}, ${s}, ${o})`}function or({state:e,sectors:t}){const n=N.useMemo(()=>{const i=t.filter(s=>s.stateId===e.id);return cr(i)},[]);return m.jsx(m.Fragment,{children:m.jsx(rr,{style:{transform:`translate(${n.x}px, ${n.y}px) translate(-50%, -50%)`,color:e.color},children:e.name})})}const rr=F.div`
  position: absolute;
  color: white;
  text-shadow: 2px 2px 0px white;
  pointer-events: none;
  font-size: x-large;
`;function cr(e){if(e.length===0)return{x:0,y:0};const t=e.reduce((n,i)=>({x:n.x+(i.rect.left+i.rect.right)/2,y:n.y+(i.rect.top+i.rect.bottom)/2}),{x:0,y:0});return{x:t.x/e.length,y:t.y/e.length}}function lr({city:e}){const[t,n]=Ye(),i=e.population;if(!i)return null;const s=ie(i);return m.jsxs(ur,{onMouseEnter:()=>t(e),onMouseLeave:()=>n(e),style:{"--x":e.position.x,"--y":e.position.y},children:[m.jsx("span",{children:e.name}),m.jsxs(dr,{children:[s," population"]})]})}const ur=F.div`
  transform: translate(calc(var(--x) * 1px), calc(var(--y) * 1px)) translate(-50%, -100%);
  position: absolute;
  width: calc(var(--size) * 1px);
  height: calc(var(--size) * 1px);
  color: white;

  &:hover > div {
    display: block;
  }
`,dr=F.div`
  display: none;
  position: absolute;
  background-color: rgba(0, 0, 0, 0.8);
  color: white;
  padding: 5px;
  border-radius: 3px;
  font-size: 12px;
  white-space: nowrap;
  left: 50%;
  transform: translateX(-50%) translateY(0%);
  pointer-events: none;
`;function fr({launchSite:e,worldTimestamp:t,isPlayerControlled:n}){const[i,s]=Jo(e),[o,a]=Ye(),r=e.lastLaunchTimestamp&&e.lastLaunchTimestamp+be>t,c=r?(t-e.lastLaunchTimestamp)/be:0,u=e.modeChangeTimestamp&&t<e.modeChangeTimestamp+ye,l=u?(t-e.modeChangeTimestamp)/ye:0;return m.jsx(mr,{onMouseEnter:()=>o(e),onMouseLeave:()=>a(e),onClick:()=>n&&s(),style:{"--x":e.position.x,"--y":e.position.y,"--cooldown-progress":c,"--mode-change-progress":l},"data-selected":i,"data-cooldown":r,"data-mode":e.mode,"data-changing-mode":u,children:m.jsx(hr,{children:e.mode===M.ATTACK?"A":"D"})})}const mr=F.div`
  transform: translate(calc(var(--x) * 1px), calc(var(--y) * 1px)) translate(-50%, -50%);
  position: absolute;
  width: 10px;
  height: 20px;
  background: rgb(255, 0, 0);
  overflow: hidden;
  cursor: pointer;
  display: flex;
  justify-content: center;
  align-items: center;
  font-weight: bold;
  font-size: 12px;
  color: white;
  transition: background-color 0.3s;

  &[data-selected='true'] {
    box-shadow: 0 0 10px 5px rgb(255, 0, 0);
  }

  &[data-cooldown='true'] {
    background: rgb(255, 165, 0);

    &::after {
      content: '';
      position: absolute;
      bottom: 0;
      left: 0;
      right: 0;
      height: calc(var(--cooldown-progress) * 100%);
      background: rgb(255, 0, 0);
    }
  }

  &[data-mode='ATTACK'] {
    background: rgb(255, 0, 0);
  }

  &[data-mode='DEFENCE'] {
    background: rgb(0, 0, 255);
  }

  &[data-changing-mode='true'] {
    background: linear-gradient(
      to right,
      rgb(255, 0, 0) 0%,
      rgb(255, 0, 0) calc(var(--mode-change-progress) * 100%),
      rgb(0, 0, 255) calc(var(--mode-change-progress) * 100%),
      rgb(0, 0, 255) 100%
    );
  }
`,hr=F.span`
  z-index: 1;
`;function kn(e,t){t===void 0&&(t=!0);var n=E.useRef(null),i=E.useRef(!1),s=E.useRef(e);s.current=e;var o=E.useCallback(function(r){i.current&&(s.current(r),n.current=requestAnimationFrame(o))},[]),a=E.useMemo(function(){return[function(){i.current&&(i.current=!1,n.current&&cancelAnimationFrame(n.current))},function(){i.current||(i.current=!0,n.current=requestAnimationFrame(o))},function(){return i.current}]},[]);return E.useEffect(function(){return t&&a[1](),a[0]},[]),a}function pr(e,t,n){if(t.startTimestamp>n||t.endTimestamp<n)return;const i=Math.pow(Math.min(Math.max(0,(n-t.startTimestamp)/(t.endTimestamp-t.startTimestamp)),1),.15);e.fillStyle=`rgb(${255*i}, ${255*(1-i)}, 0)`,e.beginPath(),e.arc(t.position.x,t.position.y,t.radius*i,0,2*Math.PI),e.fill()}function gr(e,t,n){t.launchTimestamp>n||t.targetTimestamp<n||(e.fillStyle="rgb(255, 0, 0)",e.beginPath(),e.arc(t.position.x,t.position.y,2,0,2*Math.PI),e.fill())}function vr(e,t){e.fillStyle="rgb(0, 255, 0)",e.beginPath(),e.arc(t.position.x,t.position.y,1,0,2*Math.PI),e.fill()}function gt(e,t,n){if(!(t.launchTimestamp>n))if("targetTimestamp"in t){if(t.targetTimestamp<n)return;yr(e,t,n)}else br(e,t,n)}function yr(e,t,n){const i=Math.min(Math.max(n-5,t.launchTimestamp)-t.launchTimestamp,t.targetTimestamp-t.launchTimestamp),s=t.targetTimestamp-t.launchTimestamp,o=s>0?i/s:0,a=t.launch.x+(t.position.x-t.launch.x)*o,r=t.launch.y+(t.position.y-t.launch.y)*o,c={x:a,y:r},u=e.createLinearGradient(c.x,c.y,t.position.x,t.position.y);u.addColorStop(0,"rgba(255, 255, 255, 0)"),u.addColorStop(1,"rgba(255, 255, 255, 0.5)"),e.strokeStyle=u,e.lineWidth=1,e.beginPath(),e.moveTo(c.x,c.y),e.lineTo(t.position.x,t.position.y),e.stroke()}function br(e,t,n){const s=Math.max(n-5,t.launchTimestamp),o=t.tail.filter(r=>r.timestamp>=s);if(o.length<2)return;e.beginPath(),e.moveTo(o[0].position.x,o[0].position.y);for(let r=1;r<o.length;r++)e.lineTo(o[r].position.x,o[r].position.y);e.lineTo(t.position.x,t.position.y);const a=e.createLinearGradient(o[0].position.x,o[0].position.y,t.position.x,t.position.y);a.addColorStop(0,"rgba(0, 255, 0, 0)"),a.addColorStop(1,"rgba(0, 255, 0, 0.5)"),e.strokeStyle=a,e.lineWidth=1,e.stroke()}function Er(e,t){if(Math.sqrt(Math.pow(t.position.x-t.launch.x,2)+Math.pow(t.position.y-t.launch.y,2))>Oe)for(let a=0;a<5;a++){const r=Math.PI*2/5*a,c=t.position.x+Math.cos(r)*3,u=t.position.y+Math.sin(r)*3;e.fillStyle="rgba(0, 255, 0, 0.5)",e.beginPath(),e.arc(c,u,1,0,2*Math.PI),e.fill()}}const xr="rgba(0, 255, 255, 0.1)",Cr=1;function Fr({state:e}){const t=E.useRef(null);return E.useLayoutEffect(()=>{const i=t.current;if(!i)return;const s=Math.min(...e.sectors.map(l=>l.rect.left)),o=Math.min(...e.sectors.map(l=>l.rect.top)),a=Math.max(...e.sectors.map(l=>l.rect.right)),r=Math.max(...e.sectors.map(l=>l.rect.bottom)),c=a-s,u=r-o;i.width=c,i.height=u,i.style.width=`${c}px`,i.style.height=`${u}px`},[e.sectors]),kn(()=>{const i=t.current;if(!i)return;const s=i.getContext("2d");if(!s)return;s.clearRect(0,0,i.width,i.height);const o=e.states.find(a=>a.isPlayerControlled);o&&Ir(s,o),e.missiles.forEach(a=>{gt(s,a,e.timestamp)}),e.interceptors.forEach(a=>{gt(s,a,e.timestamp)}),e.missiles.filter(a=>a.launchTimestamp<e.timestamp&&a.targetTimestamp>e.timestamp).forEach(a=>{gr(s,a,e.timestamp)}),e.interceptors.filter(a=>a.launchTimestamp<e.timestamp).forEach(a=>{vr(s,a),ee*(e.timestamp-a.launchTimestamp+1)>Oe&&Er(s,a)}),e.explosions.filter(a=>a.startTimestamp<e.timestamp&&a.endTimestamp>e.timestamp).forEach(a=>{pr(s,a,e.timestamp)}),e.battles.forEach(a=>{Dr(s,a)})}),m.jsx(Tr,{ref:t})}function Ir(e,t){const n=t.defenceLines[t.currentDefenceLineIndex];if(!n)return;e.strokeStyle=xr,e.lineWidth=Cr,e.setLineDash([5,15]),e.beginPath();let i=!0;for(let s=0;s<n.sectors.length;s++){const o=n.sectors[s],a=n.sectors[s+1];i&&(e.moveTo(o.position.x,o.position.y),i=!1),a&&Ar(o,a)?e.lineTo(a.position.x,a.position.y):(e.lineTo(o.position.x,o.position.y),e.stroke(),i=!0)}i||e.stroke(),e.setLineDash([])}function Ar(e,t){const n=Math.abs(e.position.x-t.position.x),i=Math.abs(e.position.y-t.position.y);return n<=x*3&&i<=x*3}function Dr(e,t){const{position:n,size:i}=t;e.strokeStyle="rgba(255, 0, 0, 0.5)",e.lineWidth=2;const s=1+.2*Math.sin(Date.now()/200),o=i/2*s;e.beginPath(),e.arc(n.x,n.y,o,0,2*Math.PI),e.stroke();const a=i/4,r=a/10;e.fillStyle="rgba(255, 0, 0, 0.7)",e.save(),e.translate(n.x,n.y),e.rotate(Math.PI/4),e.fillRect(-r/2,-a/2,r,a),e.restore(),e.save(),e.translate(n.x,n.y),e.rotate(-Math.PI/4),e.fillRect(-r/2,-a/2,r,a),e.restore()}const Tr=F.canvas`
  position: absolute;
  top: 0;
  pointer-events: none;
`,Sr=({worldStateRef:e})=>{const t=E.useRef(null);E.useEffect(()=>{const i=t.current;if(!i)return;const s=i.getContext("2d");if(!s)return;let o;const a=e.current;if(!a)return;const r=a.sectors,c=Math.min(...r.map(y=>y.rect.left)),u=Math.min(...r.map(y=>y.rect.top)),l=Math.max(...r.map(y=>y.rect.right)),d=Math.max(...r.map(y=>y.rect.bottom)),f=l-c,h=d-u;(i.width!==f||i.height!==h)&&(i.width=f,i.height=h,i.style.width=`${f}px`,i.style.height=`${h}px`);const p=()=>{const y=e.current;y&&(s.clearRect(0,0,i.width,i.height),s.save(),n(s,y),s.restore(),o=requestAnimationFrame(p))};return p(),()=>{cancelAnimationFrame(o)}},[e]);const n=(i,s)=>{const o={};s.units.forEach(a=>{const r=a.stateId;o[r]||(o[r]=[]),o[r].push(a)}),Object.entries(o).forEach(([a,r])=>{const c=s.states.find(l=>l.id===a),u=c?c.color:"#000000";i.fillStyle=u,i.strokeStyle="#000000",i.lineWidth=1,r.forEach(l=>{i.fillRect(l.position.x-T/2,l.position.y-T/2,T,T),i.strokeRect(l.position.x-T/2,l.position.y-T/2,T,T),i.beginPath(),i.moveTo(l.position.x-T/2,l.position.y-T/2),i.lineTo(l.position.x+T/2,l.position.y+T/2),i.moveTo(l.position.x+T/2,l.position.y-T/2),i.lineTo(l.position.x-T/2,l.position.y+T/2),i.stroke()})})};return m.jsx("canvas",{ref:t,style:{position:"absolute",top:0,left:0}})};function _r({state:e}){const t=Wo(),n=E.useRef(e);return N.useEffect(()=>{n.current=e},[e]),m.jsxs(Mr,{onMouseMove:i=>t(i.clientX,i.clientY),onClick:()=>V("world-click"),children:[m.jsx(Qo,{sectors:e.sectors,states:e.states}),e.states.map(i=>m.jsx(or,{state:i,cities:e.cities,launchSites:e.launchSites,sectors:e.sectors},i.id)),e.cities.map(i=>m.jsx(lr,{city:i},i.id)),e.launchSites.map(i=>{var s;return m.jsx(fr,{launchSite:i,worldTimestamp:e.timestamp,isPlayerControlled:i.stateId===((s=e.states.find(o=>o.isPlayerControlled))==null?void 0:s.id)},i.id)}),m.jsx(Sr,{worldStateRef:n}),m.jsx(Fr,{state:e})]})}const Mr=F.div`
  position: absolute;

  background: black;

  > canvas {
    position: absolute;
  }
`;function kr(e,t,n){return Math.max(t,Math.min(e,n))}const A={toVector(e,t){return e===void 0&&(e=t),Array.isArray(e)?e:[e,e]},add(e,t){return[e[0]+t[0],e[1]+t[1]]},sub(e,t){return[e[0]-t[0],e[1]-t[1]]},addTo(e,t){e[0]+=t[0],e[1]+=t[1]},subTo(e,t){e[0]-=t[0],e[1]-=t[1]}};function vt(e,t,n){return t===0||Math.abs(t)===1/0?Math.pow(e,n*5):e*t*n/(t+n*e)}function yt(e,t,n,i=.15){return i===0?kr(e,t,n):e<t?-vt(t-e,n-t,i)+t:e>n?+vt(e-n,n-t,i)+n:e}function Br(e,[t,n],[i,s]){const[[o,a],[r,c]]=e;return[yt(t,o,a,i),yt(n,r,c,s)]}function wr(e,t){if(typeof e!="object"||e===null)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var i=n.call(e,t||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Lr(e){var t=wr(e,"string");return typeof t=="symbol"?t:String(t)}function S(e,t,n){return t=Lr(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function bt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),n.push.apply(n,i)}return n}function D(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?bt(Object(n),!0).forEach(function(i){S(e,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):bt(Object(n)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(n,i))})}return e}const Bn={pointer:{start:"down",change:"move",end:"up"},mouse:{start:"down",change:"move",end:"up"},touch:{start:"start",change:"move",end:"end"},gesture:{start:"start",change:"change",end:"end"}};function Et(e){return e?e[0].toUpperCase()+e.slice(1):""}const Rr=["enter","leave"];function Or(e=!1,t){return e&&!Rr.includes(t)}function jr(e,t="",n=!1){const i=Bn[e],s=i&&i[t]||t;return"on"+Et(e)+Et(s)+(Or(n,s)?"Capture":"")}const Pr=["gotpointercapture","lostpointercapture"];function Nr(e){let t=e.substring(2).toLowerCase();const n=!!~t.indexOf("passive");n&&(t=t.replace("passive",""));const i=Pr.includes(t)?"capturecapture":"capture",s=!!~t.indexOf(i);return s&&(t=t.replace("capture","")),{device:t,capture:s,passive:n}}function $r(e,t=""){const n=Bn[e],i=n&&n[t]||t;return e+i}function ue(e){return"touches"in e}function wn(e){return ue(e)?"touch":"pointerType"in e?e.pointerType:"mouse"}function Ur(e){return Array.from(e.touches).filter(t=>{var n,i;return t.target===e.currentTarget||((n=e.currentTarget)===null||n===void 0||(i=n.contains)===null||i===void 0?void 0:i.call(n,t.target))})}function Yr(e){return e.type==="touchend"||e.type==="touchcancel"?e.changedTouches:e.targetTouches}function Ln(e){return ue(e)?Yr(e)[0]:e}function ke(e,t){try{const n=t.clientX-e.clientX,i=t.clientY-e.clientY,s=(t.clientX+e.clientX)/2,o=(t.clientY+e.clientY)/2,a=Math.hypot(n,i);return{angle:-(Math.atan2(n,i)*180)/Math.PI,distance:a,origin:[s,o]}}catch{}return null}function zr(e){return Ur(e).map(t=>t.identifier)}function xt(e,t){const[n,i]=Array.from(e.touches).filter(s=>t.includes(s.identifier));return ke(n,i)}function ve(e){const t=Ln(e);return ue(e)?t.identifier:t.pointerId}function H(e){const t=Ln(e);return[t.clientX,t.clientY]}const Ct=40,Ft=800;function Rn(e){let{deltaX:t,deltaY:n,deltaMode:i}=e;return i===1?(t*=Ct,n*=Ct):i===2&&(t*=Ft,n*=Ft),[t,n]}function Gr(e){var t,n;const{scrollX:i,scrollY:s,scrollLeft:o,scrollTop:a}=e.currentTarget;return[(t=i??o)!==null&&t!==void 0?t:0,(n=s??a)!==null&&n!==void 0?n:0]}function Hr(e){const t={};if("buttons"in e&&(t.buttons=e.buttons),"shiftKey"in e){const{shiftKey:n,altKey:i,metaKey:s,ctrlKey:o}=e;Object.assign(t,{shiftKey:n,altKey:i,metaKey:s,ctrlKey:o})}return t}function oe(e,...t){return typeof e=="function"?e(...t):e}function qr(){}function Vr(...e){return e.length===0?qr:e.length===1?e[0]:function(){let t;for(const n of e)t=n.apply(this,arguments)||t;return t}}function It(e,t){return Object.assign({},t,e||{})}const Xr=32;class On{constructor(t,n,i){this.ctrl=t,this.args=n,this.key=i,this.state||(this.state={},this.computeValues([0,0]),this.computeInitial(),this.init&&this.init(),this.reset())}get state(){return this.ctrl.state[this.key]}set state(t){this.ctrl.state[this.key]=t}get shared(){return this.ctrl.state.shared}get eventStore(){return this.ctrl.gestureEventStores[this.key]}get timeoutStore(){return this.ctrl.gestureTimeoutStores[this.key]}get config(){return this.ctrl.config[this.key]}get sharedConfig(){return this.ctrl.config.shared}get handler(){return this.ctrl.handlers[this.key]}reset(){const{state:t,shared:n,ingKey:i,args:s}=this;n[i]=t._active=t.active=t._blocked=t._force=!1,t._step=[!1,!1],t.intentional=!1,t._movement=[0,0],t._distance=[0,0],t._direction=[0,0],t._delta=[0,0],t._bounds=[[-1/0,1/0],[-1/0,1/0]],t.args=s,t.axis=void 0,t.memo=void 0,t.elapsedTime=t.timeDelta=0,t.direction=[0,0],t.distance=[0,0],t.overflow=[0,0],t._movementBound=[!1,!1],t.velocity=[0,0],t.movement=[0,0],t.delta=[0,0],t.timeStamp=0}start(t){const n=this.state,i=this.config;n._active||(this.reset(),this.computeInitial(),n._active=!0,n.target=t.target,n.currentTarget=t.currentTarget,n.lastOffset=i.from?oe(i.from,n):n.offset,n.offset=n.lastOffset,n.startTime=n.timeStamp=t.timeStamp)}computeValues(t){const n=this.state;n._values=t,n.values=this.config.transform(t)}computeInitial(){const t=this.state;t._initial=t._values,t.initial=t.values}compute(t){const{state:n,config:i,shared:s}=this;n.args=this.args;let o=0;if(t&&(n.event=t,i.preventDefault&&t.cancelable&&n.event.preventDefault(),n.type=t.type,s.touches=this.ctrl.pointerIds.size||this.ctrl.touchIds.size,s.locked=!!document.pointerLockElement,Object.assign(s,Hr(t)),s.down=s.pressed=s.buttons%2===1||s.touches>0,o=t.timeStamp-n.timeStamp,n.timeStamp=t.timeStamp,n.elapsedTime=n.timeStamp-n.startTime),n._active){const P=n._delta.map(Math.abs);A.addTo(n._distance,P)}this.axisIntent&&this.axisIntent(t);const[a,r]=n._movement,[c,u]=i.threshold,{_step:l,values:d}=n;if(i.hasCustomTransform?(l[0]===!1&&(l[0]=Math.abs(a)>=c&&d[0]),l[1]===!1&&(l[1]=Math.abs(r)>=u&&d[1])):(l[0]===!1&&(l[0]=Math.abs(a)>=c&&Math.sign(a)*c),l[1]===!1&&(l[1]=Math.abs(r)>=u&&Math.sign(r)*u)),n.intentional=l[0]!==!1||l[1]!==!1,!n.intentional)return;const f=[0,0];if(i.hasCustomTransform){const[P,Vn]=d;f[0]=l[0]!==!1?P-l[0]:0,f[1]=l[1]!==!1?Vn-l[1]:0}else f[0]=l[0]!==!1?a-l[0]:0,f[1]=l[1]!==!1?r-l[1]:0;this.restrictToAxis&&!n._blocked&&this.restrictToAxis(f);const h=n.offset,p=n._active&&!n._blocked||n.active;p&&(n.first=n._active&&!n.active,n.last=!n._active&&n.active,n.active=s[this.ingKey]=n._active,t&&(n.first&&("bounds"in i&&(n._bounds=oe(i.bounds,n)),this.setup&&this.setup()),n.movement=f,this.computeOffset()));const[y,v]=n.offset,[[C,b],[I,j]]=n._bounds;n.overflow=[y<C?-1:y>b?1:0,v<I?-1:v>j?1:0],n._movementBound[0]=n.overflow[0]?n._movementBound[0]===!1?n._movement[0]:n._movementBound[0]:!1,n._movementBound[1]=n.overflow[1]?n._movementBound[1]===!1?n._movement[1]:n._movementBound[1]:!1;const qn=n._active?i.rubberband||[0,0]:[0,0];if(n.offset=Br(n._bounds,n.offset,qn),n.delta=A.sub(n.offset,h),this.computeMovement(),p&&(!n.last||o>Xr)){n.delta=A.sub(n.offset,h);const P=n.delta.map(Math.abs);A.addTo(n.distance,P),n.direction=n.delta.map(Math.sign),n._direction=n._delta.map(Math.sign),!n.first&&o>0&&(n.velocity=[P[0]/o,P[1]/o],n.timeDelta=o)}}emit(){const t=this.state,n=this.shared,i=this.config;if(t._active||this.clean(),(t._blocked||!t.intentional)&&!t._force&&!i.triggerAllEvents)return;const s=this.handler(D(D(D({},n),t),{},{[this.aliasKey]:t.values}));s!==void 0&&(t.memo=s)}clean(){this.eventStore.clean(),this.timeoutStore.clean()}}function Wr([e,t],n){const i=Math.abs(e),s=Math.abs(t);if(i>s&&i>n)return"x";if(s>i&&s>n)return"y"}class X extends On{constructor(...t){super(...t),S(this,"aliasKey","xy")}reset(){super.reset(),this.state.axis=void 0}init(){this.state.offset=[0,0],this.state.lastOffset=[0,0]}computeOffset(){this.state.offset=A.add(this.state.lastOffset,this.state.movement)}computeMovement(){this.state.movement=A.sub(this.state.offset,this.state.lastOffset)}axisIntent(t){const n=this.state,i=this.config;if(!n.axis&&t){const s=typeof i.axisThreshold=="object"?i.axisThreshold[wn(t)]:i.axisThreshold;n.axis=Wr(n._movement,s)}n._blocked=(i.lockDirection||!!i.axis)&&!n.axis||!!i.axis&&i.axis!==n.axis}restrictToAxis(t){if(this.config.axis||this.config.lockDirection)switch(this.state.axis){case"x":t[1]=0;break;case"y":t[0]=0;break}}}const Kr=e=>e,At=.15,jn={enabled(e=!0){return e},eventOptions(e,t,n){return D(D({},n.shared.eventOptions),e)},preventDefault(e=!1){return e},triggerAllEvents(e=!1){return e},rubberband(e=0){switch(e){case!0:return[At,At];case!1:return[0,0];default:return A.toVector(e)}},from(e){if(typeof e=="function")return e;if(e!=null)return A.toVector(e)},transform(e,t,n){const i=e||n.shared.transform;return this.hasCustomTransform=!!i,i||Kr},threshold(e){return A.toVector(e,0)}},Zr=0,$=D(D({},jn),{},{axis(e,t,{axis:n}){if(this.lockDirection=n==="lock",!this.lockDirection)return n},axisThreshold(e=Zr){return e},bounds(e={}){if(typeof e=="function")return o=>$.bounds(e(o));if("current"in e)return()=>e.current;if(typeof HTMLElement=="function"&&e instanceof HTMLElement)return e;const{left:t=-1/0,right:n=1/0,top:i=-1/0,bottom:s=1/0}=e;return[[t,n],[i,s]]}}),Dt={ArrowRight:(e,t=1)=>[e*t,0],ArrowLeft:(e,t=1)=>[-1*e*t,0],ArrowUp:(e,t=1)=>[0,-1*e*t],ArrowDown:(e,t=1)=>[0,e*t]};class Jr extends X{constructor(...t){super(...t),S(this,"ingKey","dragging")}reset(){super.reset();const t=this.state;t._pointerId=void 0,t._pointerActive=!1,t._keyboardActive=!1,t._preventScroll=!1,t._delayed=!1,t.swipe=[0,0],t.tap=!1,t.canceled=!1,t.cancel=this.cancel.bind(this)}setup(){const t=this.state;if(t._bounds instanceof HTMLElement){const n=t._bounds.getBoundingClientRect(),i=t.currentTarget.getBoundingClientRect(),s={left:n.left-i.left+t.offset[0],right:n.right-i.right+t.offset[0],top:n.top-i.top+t.offset[1],bottom:n.bottom-i.bottom+t.offset[1]};t._bounds=$.bounds(s)}}cancel(){const t=this.state;t.canceled||(t.canceled=!0,t._active=!1,setTimeout(()=>{this.compute(),this.emit()},0))}setActive(){this.state._active=this.state._pointerActive||this.state._keyboardActive}clean(){this.pointerClean(),this.state._pointerActive=!1,this.state._keyboardActive=!1,super.clean()}pointerDown(t){const n=this.config,i=this.state;if(t.buttons!=null&&(Array.isArray(n.pointerButtons)?!n.pointerButtons.includes(t.buttons):n.pointerButtons!==-1&&n.pointerButtons!==t.buttons))return;const s=this.ctrl.setEventIds(t);n.pointerCapture&&t.target.setPointerCapture(t.pointerId),!(s&&s.size>1&&i._pointerActive)&&(this.start(t),this.setupPointer(t),i._pointerId=ve(t),i._pointerActive=!0,this.computeValues(H(t)),this.computeInitial(),n.preventScrollAxis&&wn(t)!=="mouse"?(i._active=!1,this.setupScrollPrevention(t)):n.delay>0?(this.setupDelayTrigger(t),n.triggerAllEvents&&(this.compute(t),this.emit())):this.startPointerDrag(t))}startPointerDrag(t){const n=this.state;n._active=!0,n._preventScroll=!0,n._delayed=!1,this.compute(t),this.emit()}pointerMove(t){const n=this.state,i=this.config;if(!n._pointerActive)return;const s=ve(t);if(n._pointerId!==void 0&&s!==n._pointerId)return;const o=H(t);if(document.pointerLockElement===t.target?n._delta=[t.movementX,t.movementY]:(n._delta=A.sub(o,n._values),this.computeValues(o)),A.addTo(n._movement,n._delta),this.compute(t),n._delayed&&n.intentional){this.timeoutStore.remove("dragDelay"),n.active=!1,this.startPointerDrag(t);return}if(i.preventScrollAxis&&!n._preventScroll)if(n.axis)if(n.axis===i.preventScrollAxis||i.preventScrollAxis==="xy"){n._active=!1,this.clean();return}else{this.timeoutStore.remove("startPointerDrag"),this.startPointerDrag(t);return}else return;this.emit()}pointerUp(t){this.ctrl.setEventIds(t);try{this.config.pointerCapture&&t.target.hasPointerCapture(t.pointerId)&&t.target.releasePointerCapture(t.pointerId)}catch{}const n=this.state,i=this.config;if(!n._active||!n._pointerActive)return;const s=ve(t);if(n._pointerId!==void 0&&s!==n._pointerId)return;this.state._pointerActive=!1,this.setActive(),this.compute(t);const[o,a]=n._distance;if(n.tap=o<=i.tapsThreshold&&a<=i.tapsThreshold,n.tap&&i.filterTaps)n._force=!0;else{const[r,c]=n._delta,[u,l]=n._movement,[d,f]=i.swipe.velocity,[h,p]=i.swipe.distance,y=i.swipe.duration;if(n.elapsedTime<y){const v=Math.abs(r/n.timeDelta),C=Math.abs(c/n.timeDelta);v>d&&Math.abs(u)>h&&(n.swipe[0]=Math.sign(r)),C>f&&Math.abs(l)>p&&(n.swipe[1]=Math.sign(c))}}this.emit()}pointerClick(t){!this.state.tap&&t.detail>0&&(t.preventDefault(),t.stopPropagation())}setupPointer(t){const n=this.config,i=n.device;n.pointerLock&&t.currentTarget.requestPointerLock(),n.pointerCapture||(this.eventStore.add(this.sharedConfig.window,i,"change",this.pointerMove.bind(this)),this.eventStore.add(this.sharedConfig.window,i,"end",this.pointerUp.bind(this)),this.eventStore.add(this.sharedConfig.window,i,"cancel",this.pointerUp.bind(this)))}pointerClean(){this.config.pointerLock&&document.pointerLockElement===this.state.currentTarget&&document.exitPointerLock()}preventScroll(t){this.state._preventScroll&&t.cancelable&&t.preventDefault()}setupScrollPrevention(t){this.state._preventScroll=!1,Qr(t);const n=this.eventStore.add(this.sharedConfig.window,"touch","change",this.preventScroll.bind(this),{passive:!1});this.eventStore.add(this.sharedConfig.window,"touch","end",n),this.eventStore.add(this.sharedConfig.window,"touch","cancel",n),this.timeoutStore.add("startPointerDrag",this.startPointerDrag.bind(this),this.config.preventScrollDelay,t)}setupDelayTrigger(t){this.state._delayed=!0,this.timeoutStore.add("dragDelay",()=>{this.state._step=[0,0],this.startPointerDrag(t)},this.config.delay)}keyDown(t){const n=Dt[t.key];if(n){const i=this.state,s=t.shiftKey?10:t.altKey?.1:1;this.start(t),i._delta=n(this.config.keyboardDisplacement,s),i._keyboardActive=!0,A.addTo(i._movement,i._delta),this.compute(t),this.emit()}}keyUp(t){t.key in Dt&&(this.state._keyboardActive=!1,this.setActive(),this.compute(t),this.emit())}bind(t){const n=this.config.device;t(n,"start",this.pointerDown.bind(this)),this.config.pointerCapture&&(t(n,"change",this.pointerMove.bind(this)),t(n,"end",this.pointerUp.bind(this)),t(n,"cancel",this.pointerUp.bind(this)),t("lostPointerCapture","",this.pointerUp.bind(this))),this.config.keys&&(t("key","down",this.keyDown.bind(this)),t("key","up",this.keyUp.bind(this))),this.config.filterTaps&&t("click","",this.pointerClick.bind(this),{capture:!0,passive:!1})}}function Qr(e){"persist"in e&&typeof e.persist=="function"&&e.persist()}const W=typeof window<"u"&&window.document&&window.document.createElement;function Pn(){return W&&"ontouchstart"in window}function ec(){return Pn()||W&&window.navigator.maxTouchPoints>1}function tc(){return W&&"onpointerdown"in window}function nc(){return W&&"exitPointerLock"in window.document}function ic(){try{return"constructor"in GestureEvent}catch{return!1}}const k={isBrowser:W,gesture:ic(),touch:Pn(),touchscreen:ec(),pointer:tc(),pointerLock:nc()},sc=250,ac=180,oc=.5,rc=50,cc=250,lc=10,Tt={mouse:0,touch:0,pen:8},uc=D(D({},$),{},{device(e,t,{pointer:{touch:n=!1,lock:i=!1,mouse:s=!1}={}}){return this.pointerLock=i&&k.pointerLock,k.touch&&n?"touch":this.pointerLock?"mouse":k.pointer&&!s?"pointer":k.touch?"touch":"mouse"},preventScrollAxis(e,t,{preventScroll:n}){if(this.preventScrollDelay=typeof n=="number"?n:n||n===void 0&&e?sc:void 0,!(!k.touchscreen||n===!1))return e||(n!==void 0?"y":void 0)},pointerCapture(e,t,{pointer:{capture:n=!0,buttons:i=1,keys:s=!0}={}}){return this.pointerButtons=i,this.keys=s,!this.pointerLock&&this.device==="pointer"&&n},threshold(e,t,{filterTaps:n=!1,tapsThreshold:i=3,axis:s=void 0}){const o=A.toVector(e,n?i:s?1:0);return this.filterTaps=n,this.tapsThreshold=i,o},swipe({velocity:e=oc,distance:t=rc,duration:n=cc}={}){return{velocity:this.transform(A.toVector(e)),distance:this.transform(A.toVector(t)),duration:n}},delay(e=0){switch(e){case!0:return ac;case!1:return 0;default:return e}},axisThreshold(e){return e?D(D({},Tt),e):Tt},keyboardDisplacement(e=lc){return e}});function Nn(e){const[t,n]=e.overflow,[i,s]=e._delta,[o,a]=e._direction;(t<0&&i>0&&o<0||t>0&&i<0&&o>0)&&(e._movement[0]=e._movementBound[0]),(n<0&&s>0&&a<0||n>0&&s<0&&a>0)&&(e._movement[1]=e._movementBound[1])}const dc=30,fc=100;class mc extends On{constructor(...t){super(...t),S(this,"ingKey","pinching"),S(this,"aliasKey","da")}init(){this.state.offset=[1,0],this.state.lastOffset=[1,0],this.state._pointerEvents=new Map}reset(){super.reset();const t=this.state;t._touchIds=[],t.canceled=!1,t.cancel=this.cancel.bind(this),t.turns=0}computeOffset(){const{type:t,movement:n,lastOffset:i}=this.state;t==="wheel"?this.state.offset=A.add(n,i):this.state.offset=[(1+n[0])*i[0],n[1]+i[1]]}computeMovement(){const{offset:t,lastOffset:n}=this.state;this.state.movement=[t[0]/n[0],t[1]-n[1]]}axisIntent(){const t=this.state,[n,i]=t._movement;if(!t.axis){const s=Math.abs(n)*dc-Math.abs(i);s<0?t.axis="angle":s>0&&(t.axis="scale")}}restrictToAxis(t){this.config.lockDirection&&(this.state.axis==="scale"?t[1]=0:this.state.axis==="angle"&&(t[0]=0))}cancel(){const t=this.state;t.canceled||setTimeout(()=>{t.canceled=!0,t._active=!1,this.compute(),this.emit()},0)}touchStart(t){this.ctrl.setEventIds(t);const n=this.state,i=this.ctrl.touchIds;if(n._active&&n._touchIds.every(o=>i.has(o))||i.size<2)return;this.start(t),n._touchIds=Array.from(i).slice(0,2);const s=xt(t,n._touchIds);s&&this.pinchStart(t,s)}pointerStart(t){if(t.buttons!=null&&t.buttons%2!==1)return;this.ctrl.setEventIds(t),t.target.setPointerCapture(t.pointerId);const n=this.state,i=n._pointerEvents,s=this.ctrl.pointerIds;if(n._active&&Array.from(i.keys()).every(a=>s.has(a))||(i.size<2&&i.set(t.pointerId,t),n._pointerEvents.size<2))return;this.start(t);const o=ke(...Array.from(i.values()));o&&this.pinchStart(t,o)}pinchStart(t,n){const i=this.state;i.origin=n.origin,this.computeValues([n.distance,n.angle]),this.computeInitial(),this.compute(t),this.emit()}touchMove(t){if(!this.state._active)return;const n=xt(t,this.state._touchIds);n&&this.pinchMove(t,n)}pointerMove(t){const n=this.state._pointerEvents;if(n.has(t.pointerId)&&n.set(t.pointerId,t),!this.state._active)return;const i=ke(...Array.from(n.values()));i&&this.pinchMove(t,i)}pinchMove(t,n){const i=this.state,s=i._values[1],o=n.angle-s;let a=0;Math.abs(o)>270&&(a+=Math.sign(o)),this.computeValues([n.distance,n.angle-360*a]),i.origin=n.origin,i.turns=a,i._movement=[i._values[0]/i._initial[0]-1,i._values[1]-i._initial[1]],this.compute(t),this.emit()}touchEnd(t){this.ctrl.setEventIds(t),this.state._active&&this.state._touchIds.some(n=>!this.ctrl.touchIds.has(n))&&(this.state._active=!1,this.compute(t),this.emit())}pointerEnd(t){const n=this.state;this.ctrl.setEventIds(t);try{t.target.releasePointerCapture(t.pointerId)}catch{}n._pointerEvents.has(t.pointerId)&&n._pointerEvents.delete(t.pointerId),n._active&&n._pointerEvents.size<2&&(n._active=!1,this.compute(t),this.emit())}gestureStart(t){t.cancelable&&t.preventDefault();const n=this.state;n._active||(this.start(t),this.computeValues([t.scale,t.rotation]),n.origin=[t.clientX,t.clientY],this.compute(t),this.emit())}gestureMove(t){if(t.cancelable&&t.preventDefault(),!this.state._active)return;const n=this.state;this.computeValues([t.scale,t.rotation]),n.origin=[t.clientX,t.clientY];const i=n._movement;n._movement=[t.scale-1,t.rotation],n._delta=A.sub(n._movement,i),this.compute(t),this.emit()}gestureEnd(t){this.state._active&&(this.state._active=!1,this.compute(t),this.emit())}wheel(t){const n=this.config.modifierKey;n&&(Array.isArray(n)?!n.find(i=>t[i]):!t[n])||(this.state._active?this.wheelChange(t):this.wheelStart(t),this.timeoutStore.add("wheelEnd",this.wheelEnd.bind(this)))}wheelStart(t){this.start(t),this.wheelChange(t)}wheelChange(t){"uv"in t||t.cancelable&&t.preventDefault();const i=this.state;i._delta=[-Rn(t)[1]/fc*i.offset[0],0],A.addTo(i._movement,i._delta),Nn(i),this.state.origin=[t.clientX,t.clientY],this.compute(t),this.emit()}wheelEnd(){this.state._active&&(this.state._active=!1,this.compute(),this.emit())}bind(t){const n=this.config.device;n&&(t(n,"start",this[n+"Start"].bind(this)),t(n,"change",this[n+"Move"].bind(this)),t(n,"end",this[n+"End"].bind(this)),t(n,"cancel",this[n+"End"].bind(this)),t("lostPointerCapture","",this[n+"End"].bind(this))),this.config.pinchOnWheel&&t("wheel","",this.wheel.bind(this),{passive:!1})}}const hc=D(D({},jn),{},{device(e,t,{shared:n,pointer:{touch:i=!1}={}}){if(n.target&&!k.touch&&k.gesture)return"gesture";if(k.touch&&i)return"touch";if(k.touchscreen){if(k.pointer)return"pointer";if(k.touch)return"touch"}},bounds(e,t,{scaleBounds:n={},angleBounds:i={}}){const s=a=>{const r=It(oe(n,a),{min:-1/0,max:1/0});return[r.min,r.max]},o=a=>{const r=It(oe(i,a),{min:-1/0,max:1/0});return[r.min,r.max]};return typeof n!="function"&&typeof i!="function"?[s(),o()]:a=>[s(a),o(a)]},threshold(e,t,n){return this.lockDirection=n.axis==="lock",A.toVector(e,this.lockDirection?[.1,3]:0)},modifierKey(e){return e===void 0?"ctrlKey":e},pinchOnWheel(e=!0){return e}});class pc extends X{constructor(...t){super(...t),S(this,"ingKey","moving")}move(t){this.config.mouseOnly&&t.pointerType!=="mouse"||(this.state._active?this.moveChange(t):this.moveStart(t),this.timeoutStore.add("moveEnd",this.moveEnd.bind(this)))}moveStart(t){this.start(t),this.computeValues(H(t)),this.compute(t),this.computeInitial(),this.emit()}moveChange(t){if(!this.state._active)return;const n=H(t),i=this.state;i._delta=A.sub(n,i._values),A.addTo(i._movement,i._delta),this.computeValues(n),this.compute(t),this.emit()}moveEnd(t){this.state._active&&(this.state._active=!1,this.compute(t),this.emit())}bind(t){t("pointer","change",this.move.bind(this)),t("pointer","leave",this.moveEnd.bind(this))}}const gc=D(D({},$),{},{mouseOnly:(e=!0)=>e});class vc extends X{constructor(...t){super(...t),S(this,"ingKey","scrolling")}scroll(t){this.state._active||this.start(t),this.scrollChange(t),this.timeoutStore.add("scrollEnd",this.scrollEnd.bind(this))}scrollChange(t){t.cancelable&&t.preventDefault();const n=this.state,i=Gr(t);n._delta=A.sub(i,n._values),A.addTo(n._movement,n._delta),this.computeValues(i),this.compute(t),this.emit()}scrollEnd(){this.state._active&&(this.state._active=!1,this.compute(),this.emit())}bind(t){t("scroll","",this.scroll.bind(this))}}const yc=$;class bc extends X{constructor(...t){super(...t),S(this,"ingKey","wheeling")}wheel(t){this.state._active||this.start(t),this.wheelChange(t),this.timeoutStore.add("wheelEnd",this.wheelEnd.bind(this))}wheelChange(t){const n=this.state;n._delta=Rn(t),A.addTo(n._movement,n._delta),Nn(n),this.compute(t),this.emit()}wheelEnd(){this.state._active&&(this.state._active=!1,this.compute(),this.emit())}bind(t){t("wheel","",this.wheel.bind(this))}}const Ec=$;class xc extends X{constructor(...t){super(...t),S(this,"ingKey","hovering")}enter(t){this.config.mouseOnly&&t.pointerType!=="mouse"||(this.start(t),this.computeValues(H(t)),this.compute(t),this.emit())}leave(t){if(this.config.mouseOnly&&t.pointerType!=="mouse")return;const n=this.state;if(!n._active)return;n._active=!1;const i=H(t);n._movement=n._delta=A.sub(i,n._values),this.computeValues(i),this.compute(t),n.delta=n.movement,this.emit()}bind(t){t("pointer","enter",this.enter.bind(this)),t("pointer","leave",this.leave.bind(this))}}const Cc=D(D({},$),{},{mouseOnly:(e=!0)=>e}),Ge=new Map,Be=new Map;function Fc(e){Ge.set(e.key,e.engine),Be.set(e.key,e.resolver)}const Ic={key:"drag",engine:Jr,resolver:uc},Ac={key:"hover",engine:xc,resolver:Cc},Dc={key:"move",engine:pc,resolver:gc},Tc={key:"pinch",engine:mc,resolver:hc},Sc={key:"scroll",engine:vc,resolver:yc},_c={key:"wheel",engine:bc,resolver:Ec};function Mc(e,t){if(e==null)return{};var n={},i=Object.keys(e),s,o;for(o=0;o<i.length;o++)s=i[o],!(t.indexOf(s)>=0)&&(n[s]=e[s]);return n}function kc(e,t){if(e==null)return{};var n=Mc(e,t),i,s;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(s=0;s<o.length;s++)i=o[s],!(t.indexOf(i)>=0)&&Object.prototype.propertyIsEnumerable.call(e,i)&&(n[i]=e[i])}return n}const Bc={target(e){if(e)return()=>"current"in e?e.current:e},enabled(e=!0){return e},window(e=k.isBrowser?window:void 0){return e},eventOptions({passive:e=!0,capture:t=!1}={}){return{passive:e,capture:t}},transform(e){return e}},wc=["target","eventOptions","window","enabled","transform"];function ne(e={},t){const n={};for(const[i,s]of Object.entries(t))switch(typeof s){case"function":n[i]=s.call(n,e[i],i,e);break;case"object":n[i]=ne(e[i],s);break;case"boolean":s&&(n[i]=e[i]);break}return n}function Lc(e,t,n={}){const i=e,{target:s,eventOptions:o,window:a,enabled:r,transform:c}=i,u=kc(i,wc);if(n.shared=ne({target:s,eventOptions:o,window:a,enabled:r,transform:c},Bc),t){const l=Be.get(t);n[t]=ne(D({shared:n.shared},u),l)}else for(const l in u){const d=Be.get(l);d&&(n[l]=ne(D({shared:n.shared},u[l]),d))}return n}class $n{constructor(t,n){S(this,"_listeners",new Set),this._ctrl=t,this._gestureKey=n}add(t,n,i,s,o){const a=this._listeners,r=$r(n,i),c=this._gestureKey?this._ctrl.config[this._gestureKey].eventOptions:{},u=D(D({},c),o);t.addEventListener(r,s,u);const l=()=>{t.removeEventListener(r,s,u),a.delete(l)};return a.add(l),l}clean(){this._listeners.forEach(t=>t()),this._listeners.clear()}}class Rc{constructor(){S(this,"_timeouts",new Map)}add(t,n,i=140,...s){this.remove(t),this._timeouts.set(t,window.setTimeout(n,i,...s))}remove(t){const n=this._timeouts.get(t);n&&window.clearTimeout(n)}clean(){this._timeouts.forEach(t=>void window.clearTimeout(t)),this._timeouts.clear()}}class Oc{constructor(t){S(this,"gestures",new Set),S(this,"_targetEventStore",new $n(this)),S(this,"gestureEventStores",{}),S(this,"gestureTimeoutStores",{}),S(this,"handlers",{}),S(this,"config",{}),S(this,"pointerIds",new Set),S(this,"touchIds",new Set),S(this,"state",{shared:{shiftKey:!1,metaKey:!1,ctrlKey:!1,altKey:!1}}),jc(this,t)}setEventIds(t){if(ue(t))return this.touchIds=new Set(zr(t)),this.touchIds;if("pointerId"in t)return t.type==="pointerup"||t.type==="pointercancel"?this.pointerIds.delete(t.pointerId):t.type==="pointerdown"&&this.pointerIds.add(t.pointerId),this.pointerIds}applyHandlers(t,n){this.handlers=t,this.nativeHandlers=n}applyConfig(t,n){this.config=Lc(t,n,this.config)}clean(){this._targetEventStore.clean();for(const t of this.gestures)this.gestureEventStores[t].clean(),this.gestureTimeoutStores[t].clean()}effect(){return this.config.shared.target&&this.bind(),()=>this._targetEventStore.clean()}bind(...t){const n=this.config.shared,i={};let s;if(!(n.target&&(s=n.target(),!s))){if(n.enabled){for(const a of this.gestures){const r=this.config[a],c=St(i,r.eventOptions,!!s);if(r.enabled){const u=Ge.get(a);new u(this,t,a).bind(c)}}const o=St(i,n.eventOptions,!!s);for(const a in this.nativeHandlers)o(a,"",r=>this.nativeHandlers[a](D(D({},this.state.shared),{},{event:r,args:t})),void 0,!0)}for(const o in i)i[o]=Vr(...i[o]);if(!s)return i;for(const o in i){const{device:a,capture:r,passive:c}=Nr(o);this._targetEventStore.add(s,a,"",i[o],{capture:r,passive:c})}}}}function Y(e,t){e.gestures.add(t),e.gestureEventStores[t]=new $n(e,t),e.gestureTimeoutStores[t]=new Rc}function jc(e,t){t.drag&&Y(e,"drag"),t.wheel&&Y(e,"wheel"),t.scroll&&Y(e,"scroll"),t.move&&Y(e,"move"),t.pinch&&Y(e,"pinch"),t.hover&&Y(e,"hover")}const St=(e,t,n)=>(i,s,o,a={},r=!1)=>{var c,u;const l=(c=a.capture)!==null&&c!==void 0?c:t.capture,d=(u=a.passive)!==null&&u!==void 0?u:t.passive;let f=r?i:jr(i,s,l);n&&d&&(f+="Passive"),e[f]=e[f]||[],e[f].push(o)},Pc=/^on(Drag|Wheel|Scroll|Move|Pinch|Hover)/;function Nc(e){const t={},n={},i=new Set;for(let s in e)Pc.test(s)?(i.add(RegExp.lastMatch),n[s]=e[s]):t[s]=e[s];return[n,t,i]}function z(e,t,n,i,s,o){if(!e.has(n)||!Ge.has(i))return;const a=n+"Start",r=n+"End",c=u=>{let l;return u.first&&a in t&&t[a](u),n in t&&(l=t[n](u)),u.last&&r in t&&t[r](u),l};s[i]=c,o[i]=o[i]||{}}function $c(e,t){const[n,i,s]=Nc(e),o={};return z(s,n,"onDrag","drag",o,t),z(s,n,"onWheel","wheel",o,t),z(s,n,"onScroll","scroll",o,t),z(s,n,"onPinch","pinch",o,t),z(s,n,"onMove","move",o,t),z(s,n,"onHover","hover",o,t),{handlers:o,config:t,nativeHandlers:i}}function Uc(e,t={},n,i){const s=N.useMemo(()=>new Oc(e),[]);if(s.applyHandlers(e,i),s.applyConfig(t,n),N.useEffect(s.effect.bind(s)),N.useEffect(()=>s.clean.bind(s),[]),t.target===void 0)return s.bind.bind(s)}function Yc(e){return e.forEach(Fc),function(n,i){const{handlers:s,nativeHandlers:o,config:a}=$c(n,i||{});return Uc(s,a,void 0,o)}}function zc(e,t){return Yc([Ic,Tc,Sc,_c,Dc,Ac])(e,t||{})}function Gc(e){V("translateViewport",e)}function Hc(e){le("translateViewport",e)}function qc({children:e,onGetViewportConfiguration:t}){const n=E.useRef(null),i=N.useMemo(t,[t]),[s,o]=E.useState(i.initialZoom),[a,r]=E.useState(i.initialTranslate),[c,u]=E.useState(!1),l=E.useCallback((d,f)=>{const{minX:h,minY:p,maxX:y,maxY:v}=i,C=window.innerWidth,b=window.innerHeight,I=Math.min(Math.max(f,Math.max(C/(y-h),b/(v-p))),4),j={x:Math.min(Math.max(d.x,-(y-C/I)),-h),y:Math.min(Math.max(d.y,-(v-b/I)),-p)};r(j),o(I)},[i]);return E.useEffect(()=>{l(i.initialTranslate,i.initialZoom)},[]),zc({onPinch({origin:d,delta:f,pinching:h}){var b;u(h);const p=s+f[0],y=(b=n.current)==null?void 0:b.getBoundingClientRect(),v=d[0]-((y==null?void 0:y.left)??0),C=d[1]-((y==null?void 0:y.top)??0);l({x:a.x-(v/s-v/p),y:a.y-(C/s-C/p)},p)},onWheel({event:d,delta:[f,h],wheeling:p}){d.preventDefault(),u(p),l({x:a.x-f/s,y:a.y-h/s},s)}},{target:n,eventOptions:{passive:!1}}),Hc(d=>{const f=window.innerWidth,h=window.innerHeight,p=f/2-d.x*s,y=h/2-d.y*s;l({x:p/s,y:y/s},s)}),m.jsx(Vc,{children:m.jsx(Xc,{ref:n,children:m.jsx(Wc,{style:{"--zoom":s,"--translate-x":a.x,"--translate-y":a.y},"data-is-interacting":c,children:e})})})}const Vc=F.div`
  position: absolute;
  left: 0;
  top: 0;
  width: 100%;
  height: 100%;

  background: black;
  overflow: hidden;
`,Xc=F.div`
  user-select: none;
  position: fixed;
  width: 100%;
  height: 100%;
  left: 0;
  top: 0;
`,Wc=F.div`
  transform-origin: 0px 0px;
  transform-style: preserve-3d;
  transform: scale(var(--zoom)) translate3d(calc(var(--translate-x) * 1px), calc(var(--translate-y) * 1px), 0);
  transition: transform 0.3s ease-out;

  &[data-is-interacting='true'] {
    pointer-events: none;
    will-change: transform;
    transition: none;
  }
`;function Kc({worldState:e}){const t=E.useRef(e);return m.jsx(Zo,{children:m.jsx(Xo,{children:m.jsx(qc,{onGetViewportConfiguration:E.useCallback(()=>Zc(t.current),[t]),children:m.jsx(_r,{state:e})})})})}function Zc(e){const t=e.states.find(v=>v.isPlayerControlled),n=window.innerWidth,i=window.innerHeight,s=t?e.sectors.filter(v=>v.stateId===t.id):e.sectors;let o=1/0,a=1/0,r=-1/0,c=-1/0;s.forEach(v=>{o=Math.min(o,v.rect.left),a=Math.min(a,v.rect.top),r=Math.max(r,v.rect.right),c=Math.max(c,v.rect.bottom)});const u=r-o+1,l=c-a+1,d=n/u,f=i/l,h=Math.min(d,f)*1,p=(o+r)/2,y=(a+c)/2;return e.sectors.forEach(v=>{o=Math.min(o,v.rect.left),a=Math.min(a,v.rect.top),r=Math.max(r,v.rect.right),c=Math.max(c,v.rect.bottom)}),{initialTranslate:{x:n/2-p*h,y:i/2-y*h},initialZoom:h,minX:o,minY:a,maxX:r,maxY:c}}const Un="fullScreenMessage",Yn="fullScreenMessageAction";function w(e,t,n,i="",s,o,a){V(Un,{message:e,startTimestamp:t,endTimestamp:n,messageId:i,actions:s,prompt:o,fullScreen:a??!!(s!=null&&s.length)})}function zn(e,t){V(Yn,{messageId:e,actionId:t})}function Gn(e){le(Un,t=>{e(t)})}function He(e){le(Yn,t=>{e(t)})}function Jc({worldState:e,onGameOver:t}){const[n,i]=E.useState(null),[s,o]=E.useState(!1);return E.useEffect(()=>{var h;if(s)return;const a=Cn(e),r=Object.values(a).filter(p=>p>0).length,c=e.launchSites.length===0,u=e.timestamp,l=e.states.filter(p=>a[p.id]>0&&Object.entries(p.strategies).filter(([y,v])=>a[y]>0&&v===g.HOSTILE).length>0),d=e.launchSites.some(p=>p.lastLaunchTimestamp&&u-p.lastLaunchTimestamp<de),f=de-u;if(!l.length&&!d&&f>0&&f<=10&&(n?w(`Game will end in ${Math.ceil(f)} seconds if no action is taken!`,n,n+10,"gameOverCountdown",void 0,!1,!0):i(u)),r<=1||c||!l.length&&!d&&u>de){const p=r===1?(h=e.states.find(y=>a[y.id]>0))==null?void 0:h.id:void 0;o(!0),w(["Game Over!","Results will be shown shortly..."],u,u+5,"gameOverCountdown",void 0,!1,!0),setTimeout(()=>{t({populations:a,winner:p,stateNames:Object.fromEntries(e.states.map(y=>[y.id,y.name])),playerStateId:e.states.find(y=>y.isPlayerControlled).id})},5e3)}},[e,t,n,s]),null}const Qc="/assets/player-lost-background-D2A_VJ6-.png",el="/assets/player-won-background-CkXgF24i.png",_t="/assets/draw-background-EwLQ9g28.png",tl=F.div`
  height: 100vh;
  width: 100%;
  display: flex;
  justify-content: center;
  align-items: center;
  flex-direction: column;
  position: relative;

  &::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background-image: url(${e=>e.backgroundImage});
    background-size: cover;
    background-position: center;
    background-repeat: no-repeat;
    image-rendering: pixelated;
    opacity: 0.7;
    pointer-events: none;
    z-index: 0;
  }

  > div {
    z-index: 1;
    background-color: rgba(0, 0, 0, 0.7);
    padding: 2rem;
    border-radius: 10px;
    text-align: center;
  }

  h2 {
    font-size: 3rem;
    color: #ffffff;
    margin-bottom: 1rem;
  }

  p {
    font-size: 1.5rem;
    color: #ffffff;
    margin-bottom: 2rem;
  }

  button {
    font-size: 1.5rem;
    padding: 10px 20px;
    background-color: #ff4500;
    color: #ffffff;
    border: none;
    border-radius: 5px;
    cursor: pointer;
    transition: background-color 0.3s ease;

    &:hover {
      background-color: #ff6347;
    }
  }

  a {
    display: inline-block;
    margin-top: 1rem;
    font-size: 1.2rem;
    color: #ffffff;
    text-decoration: none;
    transition: color 0.3s ease;

    &:hover {
      color: #ff4500;
    }
  }
`,nl=({setGameState:e})=>{const{state:{result:t}}=kt(),n=()=>{e(re,{stateName:t.stateNames[t.playerStateId],numberOfOpponents:Object.values(t.stateNames).length-1,groundWarfare:!1})};let i,s;return t.winner?t.winner===t.playerStateId?(i=el,s=`Congratulations! ${t.stateNames[t.playerStateId]} has won with ${ie(t.populations[t.playerStateId])} population alive.`):t.winner!==void 0?(i=Qc,s=`${t.stateNames[t.winner]} has won with ${ie(t.populations[t.winner])} population alive. Your state has fallen.`):(i=_t,s="The game has ended in an unexpected state."):(i=_t,s="It's a draw! The world is partially destroyed, but there's still hope."),m.jsx(tl,{backgroundImage:i,children:m.jsxs("div",{children:[m.jsx("h2",{children:"Game Over"}),m.jsx("p",{children:s}),m.jsx("button",{onClick:n,children:"Play Again"}),m.jsx("br",{}),m.jsx("a",{href:"/games/nukes/",children:"Back to main menu"})]})})},we={Component:nl,path:"played"};function il({worldState:e}){var u;const[t,n]=E.useState([]),[i,s]=E.useState(null);Gn(l=>{n(d=>l.messageId&&d.find(f=>f.messageId===l.messageId)?[...d.map(f=>f.messageId===l.messageId?l:f)]:[l,...d])});const o=t.sort((l,d)=>l.actions&&!d.actions?-1:!l.actions&&d.actions?1:l.startTimestamp-d.startTimestamp);if(He(l=>{n(d=>d.filter(f=>f.messageId!==l.messageId))}),E.useEffect(()=>{const l=o.find(d=>d.fullScreen&&d.startTimestamp<=e.timestamp&&d.endTimestamp>e.timestamp);s(l||null)},[o,e.timestamp]),!i)return null;const r=((l,d)=>d<l.startTimestamp?"pre":d<l.startTimestamp+.5?"pre-in":d>l.endTimestamp-.5?"post-in":d>l.endTimestamp?"post":"active")(i,e.timestamp),c=l=>Array.isArray(l)?l.map((d,f)=>m.jsx("div",{children:d},f)):l;return m.jsxs(ol,{"data-message-state":r,"data-action":(((u=i.actions)==null?void 0:u.length)??0)>0,children:[m.jsx(rl,{children:c(i.message)}),i.prompt&&i.actions&&m.jsx(cl,{children:i.actions.map((l,d)=>m.jsx(ll,{onClick:()=>zn(i.messageId,l.id),children:l.text},d))})]})}const sl=ce`
  from {
    opacity: 0;
    transform: translateX(-50%) scale(0.9);
  }
  to {
    opacity: 1;
    transform: translateX(-50%) scale(1);
  }
`,al=ce`
  from {
    opacity: 1;
    transform: translateX(-50%) scale(1);
  }
  to {
    opacity: 0;
    display: none;
    transform: translateX(-50%) scale(0.9);
  }
`,ol=F.div`
  position: fixed;
  top: 100px;
  left: 50%;
  transform: translateX(-50%);
  background-color: rgba(0, 0, 0, 0.7);
  border: 2px solid #444;
  border-radius: 10px;
  padding: 10px;
  display: flex;
  justify-content: center;
  align-items: center;
  flex-direction: column;
  text-shadow: 0px 0px 10px black;
  &:not([data-action='true']) {
    pointer-events: none;
  }
  z-index: 1;

  &[data-message-state='pre'] {
    display: none;
  }

  &[data-message-state='pre-in'] {
    display: flex;
    animation: ${sl} 0.5s ease-in-out forwards;
  }

  &[data-message-state='active'] {
    display: flex;
  }

  &[data-message-state='post-in'] {
    display: flex;
    animation: ${al} 0.5s ease-in-out forwards;
  }

  &[data-message-state='post'] {
    display: none;
  }
`,rl=F.div`
  font-size: 1.5rem;
  color: white;
  text-align: center;
  white-space: pre-line;
`,cl=F.div`
  display: flex;
  justify-content: center;
  margin-top: 2rem;
`,ll=F.button`
  font-size: 1.5rem;
  padding: 1rem 2rem;
  margin: 0 1rem;
  background-color: black;
  color: white;
  border: 2px solid white;
  border-radius: 5px;
  cursor: pointer;
  transition: background-color 0.3s ease;

  &:hover {
    background-color: rgba(255, 255, 255, 0.3);
  }

  &:active {
    background-color: rgba(255, 255, 255, 0.4);
  }
`,Hn="ALLIANCEPROPOSAL";function ul(e,t,n,i=!1){const s=`${Hn}_${e.id}_${t.id}`,o=i?`${e.name} has become friendly towards you. Do you want to form an alliance?`:`${e.name} proposes an alliance with ${t.name}. Do you accept?`,a=n.timestamp,r=a+10;w(o,a,r,s,[{id:"accept",text:"Accept"},{id:"reject",text:"Reject"}],!0)}function dl({worldState:e,setWorldState:t}){return He(n=>{if(n.messageId.startsWith(Hn)){const[,i,s]=n.messageId.split("_"),o=e.states.find(r=>r.id===i),a=e.states.find(r=>r.id===s);if(!o||!(a!=null&&a.isPlayerControlled))return;if(n.actionId==="accept"){const r=e.states.map(c=>c.id===i||c.id===s?{...c,strategies:{...c.strategies,[i]:g.FRIENDLY,[s]:g.FRIENDLY}}:c);t({...e,states:r}),w(`Alliance formed between ${o.name} and ${a.name}!`,e.timestamp,e.timestamp+5)}else n.actionId==="reject"&&w(`${a.name} has rejected the alliance proposal from ${o.name}.`,e.timestamp,e.timestamp+5)}}),null}function fl({worldState:e}){const t=e.states.find(h=>h.isPlayerControlled),[n,i]=E.useState(!1),[s,o]=E.useState({}),[a,r]=E.useState([]),[c,u]=E.useState([]),[l,d]=E.useState(!1),f=Math.round(e.timestamp*10)/10;return E.useEffect(()=>{!n&&e.timestamp>0&&(i(!0),w("The game has started!",e.timestamp,e.timestamp+3))},[f]),E.useEffect(()=>{var h,p,y,v;if(t){const C=Object.fromEntries(e.states.map(b=>[b.id,b.strategies]));for(const b of e.states)for(const I of e.states.filter(j=>j.id!==b.id))t&&I.id===t.id&&b.strategies[I.id]===g.FRIENDLY&&I.strategies[b.id]!==g.FRIENDLY&&((h=s[b.id])==null?void 0:h[I.id])!==g.FRIENDLY&&ul(b,t,e,!0),I.strategies[b.id]===g.FRIENDLY&&b.strategies[I.id]===g.FRIENDLY&&(((p=s[I.id])==null?void 0:p[b.id])!==g.FRIENDLY||((y=s[b.id])==null?void 0:y[I.id])!==g.FRIENDLY)&&w(`${I.name} has formed alliance with ${b.isPlayerControlled?"you":b.name}!`,f,f+3),b.strategies[I.id]===g.HOSTILE&&((v=s[b.id])==null?void 0:v[I.id])!==g.HOSTILE&&w(I.isPlayerControlled?`${b.name} has declared war on You!`:`${b.isPlayerControlled?"You have":b.name} declared war on ${I.name}!`,f,f+3,void 0,void 0,void 0,b.isPlayerControlled||I.isPlayerControlled);o(C)}},[f]),E.useEffect(()=>{t&&e.cities.forEach(h=>{const p=a.find(b=>b.id===h.id);if(!p)return;const y=h.population||0,v=p.population,C=Math.floor(v-y);C>0&&(h.stateId===t.id&&w(y===0?`Your city ${h.name} has been destroyed!`:[`Your city ${h.name} has been hit!`,`${C} casualties reported.`],f,f+3,void 0,void 0,!1,!0),V("cityDamage"))}),r(e.cities.map(h=>({...h})))},[f]),E.useEffect(()=>{if(t){const h=e.launchSites.filter(p=>p.stateId===t.id);c.length>0&&c.filter(y=>!h.some(v=>v.id===y.id)).forEach(()=>{w("One of your launch sites has been destroyed!",f,f+3,void 0,void 0,!1,!0)}),u(h)}},[f]),E.useEffect(()=>{if(t&&!l){const h=e.cities.filter(v=>v.stateId===t.id),p=e.launchSites.filter(v=>v.stateId===t.id);!h.some(v=>v.population>0)&&p.length===0&&(w(["You have been defeated.","All your cities are destroyed.","You have no remaining launch sites."],f,f+5,void 0,void 0,!1,!0),d(!0))}},[f]),null}function ml({worldState:e}){const[t,n]=E.useState([]);Gn(a=>{n(r=>a.messageId&&r.find(c=>c.messageId===a.messageId)?[...r.map(c=>c.messageId===a.messageId?a:c)]:[a,...r])}),He(a=>{n(r=>r.filter(c=>c.messageId!==a.messageId))});const i=a=>Array.isArray(a)?a.map((r,c)=>m.jsx("div",{children:r},c)):a,s=(a,r)=>{const l=r-a;return l>60?0:l>50?1-(l-50)/10:1},o=E.useMemo(()=>{const a=e.timestamp,r=60;return t.filter(c=>{const u=c.startTimestamp||0;return a-u<=r}).map(c=>({...c,opacity:s(c.startTimestamp||0,a)}))},[t,e.timestamp]);return m.jsx(hl,{children:o.map((a,r)=>m.jsxs(pl,{style:{opacity:a.opacity},children:[m.jsx("div",{children:i(a.message)}),a.prompt&&a.actions&&m.jsx(gl,{children:a.actions.map((c,u)=>m.jsx(vl,{onClick:()=>zn(a.messageId,c.id),children:c.text},u))})]},r))})}const hl=F.div`
  position: fixed;
  right: 0;
  max-height: 300px;
  top: 10px;
  width: 300px;
  background-color: rgba(0, 0, 0, 0.7);
  color: white;
  overflow-y: auto;
  padding: 10px;
  font-size: 10px;
  display: flex;
  flex-direction: column-reverse;
  border: 2px solid #444;
  border-radius: 10px;
  padding: 10px;
`,pl=F.div`
  margin-bottom: 10px;
  border-bottom: 1px solid rgba(255, 255, 255, 0.3);
  padding-bottom: 5px;
  text-align: left;
  transition: opacity 0.5s ease-out;
`,gl=F.div`
  display: flex;
  justify-content: flex-start;
  margin-top: 10px;
`,vl=F.button`
  font-size: 10px;
  padding: 5px 10px;
  margin-right: 10px;
  background-color: rgba(255, 255, 255, 0.2);
  color: white;
  border: 1px solid white;
`;function yl({updateWorldTime:e,currentWorldTime:t}){const[n,i]=E.useState(!1),s=E.useRef(null);kn(a=>{if(!s.current){s.current=a;return}const r=a-s.current;s.current=a,!(r<=0)&&n&&e(r/1e3)},!0);const o=a=>{const r=Math.floor(a/86400),c=Math.floor(a%86400/3600),u=Math.floor(a%3600/60),l=Math.floor(a%60);return[[r,"d"],[c,"h"],[u,"m"],[l,"s"]].filter(([d])=>!!d).map(([d,f])=>String(d)+f).join(" ")};return m.jsx(bl,{children:m.jsxs(El,{children:[m.jsxs(xl,{children:[t>0?"Current Time: ":"Game not started yet",o(t)]}),m.jsx(Z,{onClick:()=>e(1),children:"+1s"}),m.jsx(Z,{onClick:()=>e(10),children:"+10s"}),m.jsx(Z,{onClick:()=>e(60),children:"+1m"}),m.jsx(Z,{onClick:()=>i(!n),children:n?"Stop":"Start"})]})})}const bl=F.div`
  position: absolute;
  left: 50%;
  transform: translateX(-50%);
  top: 0;
  z-index: 10;
  padding: 10px;
`,El=F.div`
  display: flex;
  justify-content: center;
  align-items: center;
  flex-wrap: wrap;
  background-color: rgba(0, 0, 0, 0.7);
  border: 2px solid #444;
  border-radius: 10px;
  padding: 10px;
`,Z=F.button`
  background-color: #2c3e50;
  color: #ecf0f1;
  border: none;
  padding: 8px 12px;
  margin: 5px;
  border-radius: 5px;
  cursor: pointer;
  font-size: 14px;
  transition: background-color 0.3s;

  &:hover {
    background-color: #34495e;
  }

  &:active {
    background-color: #2980b9;
  }
`,xl=F.div`
  color: #ecf0f1;
  font-size: 16px;
  font-weight: bold;
  margin-right: 15px;
`;function Cl({worldState:e}){const t=e.states.find(r=>r.isPlayerControlled);if(!t)return null;const n=(r,c,u=!1)=>{t.strategies[r.id]=c,u&&(r.strategies[t.id]=c)},i=r=>{if(r.id===t.id)return"#4CAF50";const c=t.strategies[r.id],u=r.strategies[t.id];return c===g.FRIENDLY&&u===g.FRIENDLY?"#4CAF50":c===g.HOSTILE||u===g.HOSTILE?"#F44336":"#9E9E9E"},s=Cn(e),o=r=>{const c=e.cities.filter(h=>h.stateId===r),u=e.launchSites.filter(h=>h.stateId===r);if(c.length===0&&u.length===0){console.warn("No position information available for this state");return}const l=[...c.map(h=>h.position),...u.map(h=>h.position)],d=l.reduce((h,p)=>({x:h.x+p.x,y:h.y+p.y}),{x:0,y:0}),f={x:d.x/l.length,y:d.y/l.length};Gc(f)},a=r=>{const c=t.strategies[r.id],u=r.strategies[t.id];return m.jsxs(_l,{children:[(c===g.NEUTRAL&&u!==g.HOSTILE||c===g.FRIENDLY&&u!==g.FRIENDLY)&&m.jsx(J,{color:"#4CAF50",onClick:l=>{l.stopPropagation(),n(r,g.FRIENDLY)},disabled:c===g.FRIENDLY&&u!==g.FRIENDLY,children:"Alliance"}),(c===g.HOSTILE||u===g.HOSTILE)&&m.jsx(J,{color:"#9E9E9E",onClick:l=>{l.stopPropagation(),n(r,g.NEUTRAL)},disabled:c===g.NEUTRAL&&u!==g.NEUTRAL,children:"Peace"}),c===g.FRIENDLY&&u===g.FRIENDLY&&m.jsx(J,{color:"#9E9E9E",onClick:l=>{l.stopPropagation(),n(r,g.NEUTRAL,!0)},children:"Neutral"}),c===g.NEUTRAL&&u!==g.HOSTILE&&m.jsx(J,{color:"#F44336",onClick:l=>{l.stopPropagation(),n(r,g.HOSTILE,!0)},children:"Attack"})]})};return m.jsx(Fl,{children:e.states.map(r=>m.jsxs(Il,{relationshipColor:i(r),onClick:()=>o(r.id),children:[m.jsx(Al,{style:{color:r.color},children:r.name.charAt(0)}),m.jsxs(Dl,{children:[m.jsx(Tl,{children:r.name}),m.jsxs(Sl,{children:["ðŸ‘¤ ",ie(s[r.id])]}),r.id!==t.id?a(r):m.jsx(Ml,{children:"This is you"})]})]},r.id))})}const Fl=F.div`
  position: fixed;
  left: 0;
  bottom: 0;
  z-index: 1;
  padding: 10px;
  color: white;
  background: rgba(0, 0, 0, 0.9);
  border-top: 1px solid rgb(0, 255, 0);
  display: flex;
  justify-content: space-around;
  flex-wrap: wrap;
`,Il=F.div`
  display: flex;
  align-items: center;
  margin: 5px;
  padding: 10px;
  background: ${e=>`rgba(${parseInt(e.relationshipColor.slice(1,3),16)}, ${parseInt(e.relationshipColor.slice(3,5),16)}, ${parseInt(e.relationshipColor.slice(5,7),16)}, 0.2)`};
  border: 2px solid ${e=>e.relationshipColor};
  border-radius: 5px;
  transition: background 0.3s ease;
  cursor: pointer;
`,Al=F.div`
  width: 30px;
  height: 30px;
  display: flex;
  align-items: center;
  justify-content: center;
  background: rgba(255, 255, 255, 0.2);
  border-radius: 50%;
  margin-right: 10px;
  font-weight: bold;
`,Dl=F.div`
  display: flex;
  flex-direction: column;
`,Tl=F.span`
  font-weight: bold;
  margin-bottom: 5px;
`,Sl=F.span`
  font-size: 0.9em;
  margin-bottom: 5px;
`,_l=F.div`
  display: flex;
  flex-wrap: wrap;
  gap: 5px;
`,J=F.button`
  background-color: ${e=>e.color};
  color: white;
  border: none;
  padding: 5px 10px;
  border-radius: 3px;
  cursor: pointer;
  font-size: 0.8em;
  transition: opacity 0.3s ease;
  ${e=>e.disabled?"pointer-events: none; opacity: 0.5;":""}

  &:hover {
    opacity: 0.8;
  }
`,Ml=F.span`
  font-style: italic;
  color: #4caf50;
`,kl=({setGameState:e})=>{const{state:{stateName:t,numberOfOpponents:n,groundWarfare:i}}=kt(),{worldState:s,setWorldState:o,updateWorldState:a}=Ho(t,n,i);return m.jsxs(m.Fragment,{children:[m.jsx(Kc,{worldState:s}),m.jsx(yl,{updateWorldTime:r=>a(s,r),currentWorldTime:s.timestamp??0}),m.jsx(il,{worldState:s}),m.jsx(Cl,{worldState:s}),m.jsx(ml,{worldState:s}),m.jsx(Jc,{worldState:s,onGameOver:r=>e(we,{result:r})}),m.jsx(fl,{worldState:s}),m.jsx(dl,{worldState:s,setWorldState:o})]})},re={Component:kl,path:"playing"},Bl="/assets/play-background-BASXrsIB.png",wl=F.div`
  height: 100vh;
  width: 100%;
  display: flex;
  justify-content: center;
  align-items: center;
  flex-direction: column;
  position: relative;

  &::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background-image: url(${Bl});
    background-size: cover;
    background-position: center;
    background-repeat: no-repeat;
    image-rendering: pixelated;
    opacity: 0.7;
    pointer-events: none;
    z-index: 0;
  }

  > div {
    background-color: rgba(0, 0, 0, 0.7);
    border-radius: 10px;
    z-index: 1;
    width: 600px;
    padding: 2em;
    box-shadow: 0px 0px 5px black;
  }

  input,
  select {
    font-size: 1.2rem;
    padding: 10px;
    margin-bottom: 20px;
    border: 2px solid #ff4500;
    border-radius: 5px;
    background-color: rgba(255, 255, 255, 0.8);
  }

  button {
    font-size: 1.5rem;
    padding: 10px 20px;
    background-color: #ff4500;
    color: #ffffff;
    border: none;
    border-radius: 5px;
    cursor: pointer;
    transition: background-color 0.3s ease;

    &:hover {
      background-color: #ff6347;
    }

    &:disabled {
      background-color: #cccccc;
      cursor: not-allowed;
    }
  }

  a {
    display: inline-block;
    margin-top: 1rem;
    font-size: 1.2rem;
    color: #ffffff;
    text-decoration: none;
    transition: color 0.3s ease;

    &:hover {
      color: #ff4500;
    }
  }
`,Ll=({setGameState:e})=>{const[t,n]=E.useState(xn(1)[0]),[i,s]=E.useState(2),[o,a]=E.useState(!1),r=()=>{e(re,{stateName:t,numberOfOpponents:i,groundWarfare:o})};return m.jsx(wl,{children:m.jsxs("div",{children:[m.jsx("h2",{children:"Name your state:"}),m.jsx("input",{type:"text",placeholder:"Type your state name here",value:t,onChange:c=>n(c.currentTarget.value)}),m.jsx("br",{}),m.jsx("h2",{children:"How many opponents?"}),m.jsxs("select",{value:i,onChange:c=>s(Number(c.currentTarget.value)),children:[m.jsx("option",{value:1,children:"1"}),m.jsx("option",{value:2,children:"2"}),m.jsx("option",{value:3,children:"3"}),m.jsx("option",{value:4,children:"4"})]}),m.jsx("h2",{children:"Ground warfare? (WIP)"}),m.jsx("input",{type:"checkbox",checked:o,onChange:()=>a(!o)}),m.jsx("br",{}),m.jsx("br",{}),m.jsx("button",{onClick:r,disabled:!t,children:"Start game"}),m.jsx("br",{}),m.jsx("a",{href:"/games/nukes/",children:"Back to main menu"})]})})},Le={Component:Ll,path:"play"},Rl="/assets/intro-background-D_km5uka.png",Ol="/assets/nukes-game-title-vcFxx9vI.png",jl=ce`
  0% {
    transform: scale(1.5);
  }
  50% {
    transform: scale(1);
  }
  100% {
    transform: scale(1.5);
  }
`,Pl=ce`
  0% {
    opacity: 1;
  }
  100% {
    opacity: 0;
  }
`,Nl=F.div`
  height: 100vh;
  width: 100%;
  display: flex;
  justify-content: center;
  align-items: center;
  flex-direction: column;
  position: relative;
  overflow: hidden;

  &::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background-image: url(${Rl});
    background-size: cover;
    background-position: center;
    background-repeat: no-repeat;
    image-rendering: pixelated;
    opacity: 0.5;
    pointer-events: none;
    z-index: 0;
    animation: ${jl} 60s ease-in-out infinite;
  }

  img {
    margin-left: -10px;
    margin-top: -20px;
    margin-right: -10px;
  }

  button {
    font-size: 2.5rem;
    padding: 10px 20px;
    background-color: #ff4500;
    color: #ffffff;
    border: none;
    border-radius: 5px;
    cursor: pointer;
    transition: background-color 0.3s ease;
    margin-top: 20px;

    &:hover {
      background-color: #ff6347;
    }
  }
`,$l=F.div`
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background-color: white;
  z-index: 2;
  pointer-events: none;
  opacity: ${e=>e.isFlashing?1:0};
  animation: ${e=>e.isFlashing?Pl:"none"} 4.5s forwards;
`,Ul=F.div`
  z-index: 1;
  display: flex;
  flex-direction: column;
  align-items: center;
  background-color: rgba(0, 0, 0, 0.7);
  padding-bottom: 2em;
  border-radius: 10px;
  text-align: center;
  box-shadow: 0px 0px 5px black;
`,Yl=F.img`
  width: 600px;
  height: auto;
  image-rendering: pixelated;
`,zl=({setGameState:e})=>{const[t,n]=E.useState(!0);return E.useEffect(()=>{const i=setTimeout(()=>{n(!1)},5e3);return()=>clearTimeout(i)},[]),m.jsxs(Nl,{children:[m.jsx($l,{isFlashing:t}),!t&&m.jsxs(Ul,{children:[m.jsx(Yl,{src:Ol,alt:"Nukes game"}),m.jsx("button",{onClick:()=>e(Le),children:"Play"})]})]})},Mt={Component:zl,path:""},Gl=Zn`
:root {
  font-family: 'Press Start 2P', system-ui;
  font-size: 13px;
  line-height: 1.5;
  font-weight: 400;

  color-scheme: light dark;
  color: rgba(255, 255, 255, 0.87);
  background-color: #242424;

  font-synthesis: none;
  text-rendering: optimizeLegibility;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

input {
  font-family: 'Press Start 2P', system-ui;
}

a {
  font-weight: 500;
  color: #646cff;
  text-decoration: inherit;
}
a:hover {
  color: #535bf2;
}

body {
  margin: 0;
  display: flex;
  place-items: center;
  min-width: 320px;
  min-height: 100vh;
}

body {
  margin: 0;
  padding: 0;
  width: 100%;
  height: 100%;
  display: flex;
  justify-content: center;
  align-items: center;
  background: #101010;
  color: #eee;
}

#root {
  width: 100%;
  margin: 0;
  padding: 0;
  text-align: center;
}


h1 {
  font-size: 3.2em;
  line-height: 1.1;
}

button {
  border-radius: 8px;
  border: 1px solid transparent;
  padding: 0.6em 1.2em;
  font-size: 1em;
  font-weight: 500;
  font-family: inherit;
  background-color: #202020;
  color: #eee;
  cursor: pointer;
  transition: border-color 0.25s;
}
button:hover {
  border-color: #646cff;
}
button:focus,
button:focus-visible {
  outline: 4px auto -webkit-focus-ring-color;
}
`,Hl=[{path:Mt.path,element:m.jsx(Q,{state:Mt})},{path:Le.path,element:m.jsx(Q,{state:Le})},{path:re.path,element:m.jsx(Q,{state:re})},{path:we.path,element:m.jsx(Q,{state:we})}];function Xl(){var n;const[e]=Wn(),t=e.get("path")??"";return m.jsx(m.Fragment,{children:(n=Hl.find(i=>i.path===t))==null?void 0:n.element})}function Q({state:e}){const t=Kn();return m.jsxs(m.Fragment,{children:[m.jsx(Gl,{}),m.jsx(e.Component,{setGameState:(n,i)=>t({search:"path="+n.path},{state:i})})]})}export{Xl as NukesApp,Hl as routes};
